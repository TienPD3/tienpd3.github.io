/*!
 * 
 * SpreadJS Library 16.0.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s="./all.entry.js")}({"./all.entry.js":function(a,b,c){GC=GC||{},GC.Spread=GC.Spread||{},GC.Spread=c("./node_modules_local/@grapecity/js-sheets-common/index.js"),GC.Spread.CalcEngine=c("./node_modules_local/@grapecity/js-calc/index.js"),GC.Spread.CalcEngine.BasicFunctions=c("./node_modules_local/@grapecity/js-calc-basicfunctions/index.js"),GC.Spread.CalcEngine.AdvancedFunctions=c("./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js"),GC.Data=c("./node_modules_local/@grapecity/js-data-manager/index.js"),GC.Spread.Sheets=c("./dist/core/core.entry.js"),GC.Spread.Sheets.Bindings=c("./dist/plugins/data/data.entry.js"),GC.Spread.Sheets.Outlines=c("./dist/plugins/group/group.entry.js"),GC.Spread.Sheets.CalcEngine=c("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),GC.Spread.Sheets.ConditionalFormatting=c("./dist/plugins/conditional/conditional.entry.js"),GC.Spread.Sheets.DataValidation=c("./dist/plugins/validation/datavalidation.entry.js"),GC.Spread.Sheets.Search=c("./dist/plugins/search/search.entry.js"),GC.Spread.Sheets.Touch=c("./dist/plugins/touch/touch.entry.js"),GC.Spread.Sheets.FloatingObjects=c("./dist/plugins/floatingObject/floatingobject.entry.js"),GC.Spread.Sheets.Sparklines=c("./dist/plugins/sparkline/sparkline-wrapper.entry.js"),GC.Spread.Sheets.Comments=c("./dist/plugins/comment/comment.entry.js"),GC.Spread.Sheets.CellState=c("./dist/plugins/cellState/cellstate.entry.js"),GC.Spread.Sheets.CellTypes=c("./dist/plugins/celltype/celltypes.entry.js"),GC.Spread.Sheets.Filter=c("./dist/plugins/filter/filter.entry.js"),GC.Spread.Sheets.Tables=c("./dist/plugins/table/table.entry.js"),GC.Spread.Sheets.Fill=c("./dist/plugins/fill/fill.entry.js"),GC.Spread.Sheets.ContextMenu=c("./dist/plugins/contextMenu/context-menu.entry.js"),GC.Spread.Sheets.FormulaTextBox=c("./dist/plugins/formulaTextbox/formulaTextBox.entry.js"),GC.Spread.Sheets.OutlineColumn=c("./dist/plugins/outlineColumn/outlineColumn.entry.js"),GC.Spread.Sheets.DragMerge=c("./dist/plugins/dragMerge/dragMerge.entry.js"),GC.Spread.Sheets.StatusBar=c("./dist/plugins/statusBar/statusBar.entry.js"),GC.Spread.Sheets.AutoMerge=c("./dist/plugins/autoMerge/autoMerge.js"),GC.Spread.Sheets.Hyperlink=c("./dist/plugins/hyperlink/hyperlink.js"),GC.Spread.Sheets.NameBox=c("./dist/plugins/namebox/namebox.entry.js"),a.exports=GC.Spread},"./dist/core/celltype/basecelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/stylehelper.js"),h=c("./dist/core/core.interface.js"),i=c("./dist/core/core.enum.js"),j=c("./dist/core/celltype/celltype.ns.js"),k=c("@grapecity/js-calc"),l=d.Common.F,m=d.Common.CultureManager,n=d.Common.o,o=d.Common.l,p=d.Common.pc,q=d.Common.j,r=q.Fa,s=q.Ma,t=f.Ul.fp,u=f.Ul.ol,v=f.Ul.uWa,w=f.Ul.lZa,x=f.Ul.hZa,y=f.Ul.K_a,z=f.Ul.pL,A=f.Ul.Fxb,B=f.Ul.lHb,C=d.Common.j.Fa,D=e.GC$.extend,E=f.Ul.Ml,F="left",G="right",H="center",I="alphabetic",J=16,K="string",L="number",M=null,N=void 0,O=Math.floor,P=Math.ceil,Q=Math.sin,R=Math.cos,S=Math.tan,T=Math.PI,U=Math.abs,V="none",W="General",X="text",Y=Math.max,Z=.7,$={},_="...",function(a){a[a.top=0]="top",a[a.right=1]="right",a[a.bottom=2]="bottom",a[a.left=3]="left"}(aa||(aa={}));function ea(a){var b=a.isPrinting,c=a.printZoomFactor;return b&&typeof c===L&&1!==c}ba=function(){function a(){}return a.Gxb=function(a){var b,c,d=a.split("e")[1];if(d&&d.length>0&&("+"===d[0]?b=!0:"-"===d[0]&&(b=!1),c=d.slice(1)),void 0!==b)return{isAdd:b,length:c}},a.Apb=function(b,c,d){var e=a.Hxb,f=e[c+d];return f||(f=z(b,c,d),e[c+d]=f),f},a.Ixb=function(b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=e.font;if(d=d-1-3*f,g=e.textIndent&&0!==e.textIndent,h=e.isVerticalText,typeof c===L&&e.shrinkToFit!==!0&&!h&&!g){if(i=c<0,c=U(c),j=i?a.Apb(b,z,"-"):0,k=""+c,l=a.Gxb(k),m=void 0,n=a.Jxb(e._autoFormatter,c),l)return m=(""+l.length).length,m=Y(m,2),a.Kxb(b,d,e,m,j,l.isAdd,n);if(o=j,p=a.Apb(b,z,"0"),q=k.split("."),r=(""+Math.round(c)).length,s=p*r,o+=s,t=a.Apb(b,z,"."),u=void 0,s<=d){if(!q[1]||0===q[1].length)return e._autoFormatter;if(o=o+q[1].length*p+t,o<=d)return e._autoFormatter;if(c<.001)return m=(""+q[1].length).length,m=Y(m,2),a.Kxb(b,d,e,m,j,!1,n);for(v=d-j-s-t,w=Math.floor(v/p),w=Math.min(w,q[1].length),u="0",w>0&&(u+="."),x=0;x<w;x++)u+="0";return u}return y=Math.round(c),m=(""+(""+y).length).length,m=Y(m,2),a.Kxb(b,d,e,m,j,!0,n)}return e._autoFormatter},a.Kxb=function(b,c,d,e,f,g,h){var i,j,k,l=d.font,m=a.Apb(b,l,"0"),n=a.Apb(b,l,"E"),o=a.Apb(b,l,"+"),p=a.Apb(b,l,"-"),q=g?o:p,r=a.Apb(b,l,"."),s=c-f-e*m-n-q-m,t=s-r;if(t<=m)return g?"0E+00":s>0?"0E-00":"0";for(i=Math.floor(t/m),i=Math.min(i,h),j="0",k=0;k<i;k++)0===k&&(j+="."),j+="0";return j+=g?"E+00":"E-00"},a.Lxb=function(b,c,d,e,f){var g,h,i,j,k,l,m,n,o=e.font;if(d=d-1-3*f,g=e.textIndent||0,h=e.hAlign,i=d,1!==h&&g>0&&(i=d-8*g),j=z(b,e.font,c),i<j){for(k=a.Apb(b,o,"#"),l=Math.floor(d/k),m="",n=0;n<l;n++)m+="#";return m}return c},a.ap=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t;if(f&&"none"!==f&&h)try{h.ko(f)?(i=h.lo(f),j=void 0,E.msie&&(j=document.createElement("div"),j.appendChild(i),document.body.appendChild(j)),k=i.width,l=i.height,E.msie&&(j.removeChild(i),document.body.removeChild(j)),m=0,n=0,o=k,p=l,q=d,r=e,s=b,t=c,1===g?(o=d>=k?k:d,p=e>=l?l:e,s=d>k&&k>0?P(b+d/2-k/2):b,t=e>l&&l>0?P(c+e/2-l/2):c,q=o,r=p):2===g?e>0&&l>0&&d/e>k/l?(q=k/l*e,s=b+d/2-q/2):d>0&&k>0&&e/d>l/k&&(r=l/k*d,t=c+e/2-r/2):3===g&&(o=d>=k?k:d,p=e>=l?l:e,q=o,r=p),a.drawImage(i,m,n,o,p,s,t,q,r)):h.fo(f)}catch(a){}},a.cp=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,s,u,v,w,x,y,z,A=0,B=e&&e.sheet,C=e.sheetArea,E=e.row,F=e.col,G=c.textIndent,H=c.hAlign,I=c.isVerticalText,L=1===C&&1===B.PKJ(F),M=L?-90:c.textOrientation,N=c.borderTop||c.borderBottom||c.borderLeft||c.borderRight,O=c.font;if(M&&-90<=M&&M<=90&&(j=U(M*Math.PI/180),h=Q(j),i=R(j)),B&&typeof b===K&&b)if(k=[],l=void 0,a&&a.richText)if(m=c.formatter||c._autoFormatter,n=B.getCellType(E,F,C),o=n.T_a(m,a.text),l=D(!0,[],n.U_a(a,b,o,O,c.foreColor)),Ga(l,O,d),I)if(c.wordWrap){if(p=B.Sl(E,C),q=B.ITa.findSpan(E,F,C),q&&q.row>=E&&q.col>=F&&q.rowCount>1)for(r=E+1;r<E+q.rowCount;r++)p+=B.Sl(r,C);for(s=0,G>0&&(s=8*G),u=qa(c,0),v=qa(c,2),u>0&&(p-=u),v>0&&(p-=v),p++,k=f.Vn.M_a(b,p-3-s,O,l,I),g=0;g<k.length;g++)A+=ka(k[g].textInfos,O,d)}else A=ka(l,O,d);else{if(c.wordWrap){for(w=b.split(/\r\n|\r|\n/),g=0;g<w.length;g++)k.push(f.GXJ(w[g]));for(k=f.Vn.O_a(k,f.Vn.P_a(l)),g=0;g<k.length;g++)A=Math.max(A,ma(k[g],O,d,I,!0))}else A=la(l,O,d);1!==H&&G>0&&(A+=8*G/d),ja(B,E,F,e.sheetArea)&&(A+=pa(B))}else if(k=b.split(/\r\n|\r|\n/),x=c.font,y=t(x)/d,I)if(c.wordWrap)for(g=0;g<k.length;g++)A+=y;else A=y;else{if(c.wordWrap){if(M)return z=B.Sl(E,C),f.Vn.mHb(E,F,h,i,b,x,z);for(g=0;g<k.length;g++)A=Math.max(A,f.Vn.Xn(k[g],x,!0)/d)}else A=M?N?(y+4)/h:i*(B.dp(b,x)/d)+y*h:4===c.hAlign?B.ss._m(F,C):B.dp(b,x)/d;1!==H&&G>0&&(A+=8*G/d),ja(B,E,F,e.sheetArea)&&(A+=J)}return A},a.zRJ=function(a,b,c,d){var e,f,g,h=a.ss._m(c,d);for(e=c+1;e<a.getColumnCount(d)&&(f=a.ss.Ym(b,e,d),g=a.ss.zHb(b,e,d,1,f),C(g))&&!f.watermark&&!(f.cellType&&"1"!==f.cellType.typeName||f.cellButtons&&f.cellButtons.length>0)&&4===f.hAlign;e++)h+=a.ss._m(e,d);return h},a.ep=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,s,u,v,w,x,y,z,B,C,E,F,G,H,I,J,L=0,M=e&&e.sheet,N=c.font,O=c.isVerticalText,P=c.textIndent,S=c.vAlign,T=c.textOrientation,V=e.row,W=e.col,X=e.sheetArea;if(T&&-90<=T&&T<=90&&(v=U(T*Math.PI/180),s=Q(v),u=R(v)),M&&typeof b===K&&b)if(w=[],x=void 0,a&&a.richText)if(y=c.formatter||c._autoFormatter,z=M.getCellType(V,W,X),B=z.T_a(y,a.text),x=D(!0,[],z.U_a(a,b,B,N,c.foreColor)),Ga(x,N,d),O){if(c.wordWrap){for(C=b.split(/\r\n|\r|\n/),g=0;g<C.length;g++)w.push(f.GXJ(C[g]));for(w=f.Vn.O_a(w,f.Vn.P_a(x)),g=0;g<w.length;g++)L=Math.max(L,ma(w[g],N,d,O,!0))}else L=la(x,N,d,O);1!==S&&P>0&&(L+=8*P/d)}else if(c.wordWrap){if(h=M.Tl(W,X),k=M.ITa.findSpan(V,W,X),k&&k.row>=V&&k.col>=W&&k.colCount>1)for(l=W+1;l<W+k.colCount;l++)h+=M.Tl(l,X);for(n=0,P>0&&(n=8*P),o=qa(c,1),p=qa(c,3),p>0&&(h-=p),o>0&&(h-=o),h++,w=f.Vn.M_a(b,h-3-n,N,x),g=0;g<w.length;g++)L+=ka(w[g].textInfos,N,d)}else L=ka(x,N,d);else if(E=c.font,F=t(E)/d,O){if(c.wordWrap)for(w=b.split(/\r\n|\r|\n/),g=0;g<w.length;g++)G=w[g].length*F,L=Math.max(L,G);else L=b.length*F;1!==S&&P>0&&(L+=8*P/d)}else if(c.wordWrap){if(X=e.sheetArea,h=4===c.hAlign?this.zRJ(e.sheet,V,W,X):M.Tl(W,X),i=M.Sl(V,X),k=M.ITa.findSpan(V,W,X),k&&k.row>=V&&k.col>=W&&k.colCount>1){for(l=W+1;l<W+k.colCount;l++)h+=M.Tl(l,X);for(m=V+1;m<V+k.colCount;m++)i+=M.Sl(m,X)}if(n=0,P>0&&(n=8*P),o=qa(c,1),p=qa(c,3),q=qa(c,0),r=qa(c,2),p>0&&(h-=p),o>0&&(h-=o),q>0&&(i-=q),r>0&&(i-=r),c.cellButtons&&c.cellButtons.length>0&&(h-=sa(e,c)),1===X&&(H=M.rowFilter&&M.rowFilter(),I=!!(H&&H.Dl(V,W,X)&&H.filterButtonVisible(W)),I&&(h-=M.oK(new f.Rect(0,0,h,i),X).width)),T)return J=(i-F*u)/s,w=f.Vn.Wn(b,J,E),j=M.dp(w[0],E)/d,L=s*j+F*u;w=A(a)?[b]:f.Vn.Wn(b,h-3-n,E),L=w.length*F}else T?(j=M.dp(b,E)/d,L=s*j+F*u):L=F;return L},a.gp=function(a,b,c,d,e,f,g,h,i,j,k){var l;1===i?(a.beginPath(),l=a.createLinearGradient(b,c+1,b,c+e-2),l.addColorStop(0,h.borderLeftColor),l.addColorStop(1,h.borderRightColor),a.strokeStyle!==l&&(a.strokeStyle=l),f.borderLeft||(a.moveTo(b+.5,c),a.lineTo(b+.5,c+e)),f.borderRight||(a.moveTo(b+d-.5,c),a.lineTo(b+d-.5,c+e)),j&&!f.borderTop&&(a.moveTo(b,c+.5),a.lineTo(b+d,c+.5)),a.stroke(),h.borderBottomWidth&&!f.borderBottom&&(a.beginPath(),a.strokeStyle!==h.borderBottomColor&&(a.strokeStyle=h.borderBottomColor),a.moveTo(b+1,c+e-.5),a.lineTo(b+d,c+e-.5),a.stroke())):(a.beginPath(),l=a.createLinearGradient(b,c,b+d-2,c),l.addColorStop(0,h.borderTopColor),l.addColorStop(1,h.borderBottomColor),a.strokeStyle!==l&&(a.strokeStyle=l),f.borderTop||(a.moveTo(b,c+.5),a.lineTo(b+d,c+.5)),f.borderBottom||(a.moveTo(b,c+e-.5),a.lineTo(b+d,c+e-.5)),k&&!f.borderLeft&&(a.moveTo(b+.5,c),a.lineTo(b+.5,c+e)),a.stroke(),h.borderRightWidth&&!f.borderRight&&(a.beginPath(),a.strokeStyle!==h.borderRightColor&&(a.strokeStyle=h.borderRightColor),a.moveTo(b+d-.5,c+1),a.lineTo(b+d-.5,c+e),a.stroke()))},a.hp=function(a,b){var c;c=2===b?"active":4===b?"inactive":0===b?"disabled":"auto",e.GC$(a).css("ime-mode",c)},a.oDc=function(a,b,c,d,e,f,g){var h,i,j,k,l;return!!(b&&"SparklineExValue"===b.typeName&&(h=g.sheet,i=h&&h.parent,i&&(j=i.getSparklineEx(b.name))))&&(k=ea(g)?g.printZoomFactor:h.zoom(),l={zoomFactor:k,sheet:h,rowIndex:g.row,columnIndex:g.col},2===g.columnHeaderFitMode&&(e=h.getColumnWidth(g.col,g.sheetArea)+1),j.paint(a,b.value,c,d,e,f,l),!0)},a.Hxb={},a.Jxb=function(a,b){var c,d,e,f,g,h;return a&&a.Ud&&(c=a.Ud(b),d=c.format(b),d&&d[1]&&"decimalSeparator"===d[1].type)?(e=d[2],e&&e.type===L?(f=e.value,g=d[3],h=g&&"exponent"===g.type&&g.value&&g.value.indexOf("E")>-1,!r(f)&&h?f.length:5):0):5},a.u5=qa,a}(),b.Context=ba;function fa(a,b){var c=a>8?O((a-8)/5+2):1;return b/2-a/2+c-1}ca={9001:65087,9002:65088,10216:65087,10217:65088,10092:65087,10093:65088,10096:65087,10097:65088,12296:65087,12297:65088,9121:65089,9126:65090,12300:65089,12301:65090,65378:65089,65379:65090,40:9180,41:9181,91:9140,93:9141,65339:9140,65341:9141,123:9182,125:9183,10100:9182,10101:9183,65115:9182,65116:9183,65371:9182,65373:9183,12310:65047,12311:65048,10098:65081,10099:65082,12308:65081,12309:65082,65117:65081,65118:65082,12304:65083,12305:65084,10218:65085,10219:65086,12298:65085,12299:65086,12302:65091,12303:65092};function ga(a){var b=ca[a.charCodeAt(0)];return b?String.fromCharCode(b):a}function ha(a,b,c){return r(a.x)||(a.x+=b.width),a.width=a.width-b.width-c.width,a}function ia(a,b,c,d){var e,g=c.foreColor;g=f.Im._ob(b,g),d=r(c.opacity)?d:c.opacity,r(d)||(e=p.ec(g),e.a=d,g=p.bc(e)),a.fillStyle!==g&&(a.fillStyle=g||"#000000")}da=function(){function a(){this.allowOverflow=!1,this.typeName="0"}return a.prototype.uxb=function(b,c,d,e){var f={ctx:b,options:{rect:c,context:d,value:e}};return a.ao(d.sheet,"paintCellPadding",f),f.options.rect},a.prototype.egc=function(b,c,d){var e={context:b,options:{dom:c,cellRect:d,contentRect:d.clone(),leftExternalRect:new f.Rect(0,0,0,0),rightExternalRect:new f.Rect(0,0,0,0)}};return a.ao(b.sheet,"onCreateCellEditor",e),e.options.dom},a.prototype.TBb=function(b,c,d){var e={ctx:null,options:{rect:c.clone(),context:b,value:null,style:d}};return a.ao(b.sheet,"getCellButtonRect",e),e.options.rect},a.prototype.fgc=function(b,c,d,e){var g={context:b,options:{dom:c,cellRect:d,cellStyle:e,contentRect:d.clone(),leftExternalRect:new f.Rect(0,0,0,0),rightExternalRect:new f.Rect(0,0,0,0)}};return a.ao(b.sheet,"onActivateCellEditor",g),g},a.prototype.VBb=function(b,c,d,e){var g={context:b,contentContainer:c,editorBounds:d,cellStyle:e,contentRect:d.clone(),leftExternalRect:new f.Rect(0,0,0,0),rightExternalRect:new f.Rect(0,0,0,0)};return a.ao(b.sheet,"onUpdateContainer",g),g},a.prototype.ggc=function(b,c,d){var e={context:b,options:{dom:c,cellRect:d,contentRect:d.clone(),leftExternalRect:new f.Rect(0,0,0,0),rightExternalRect:new f.Rect(0,0,0,0)}};return a.ao(b.sheet,"onDeactivateCellEditor",e),e.options.dom},a.prototype.XBb=function(a,b,c){var d=this;d.deactivateEditor(a,b),d.ggc(b,a,c)},a.prototype.i5=function(a,b,c,d){var e,f,h,i,j,k,l,m,n,o,p=c.labelOptions;if(p&&(e=d.sheet,f=c.watermark)){if(h=p.visibility,i=e.getText(d.row,d.col,d.sheetArea),1===h||(2===h||h===N)&&""===i)return;j=e.zoom(),k=p.font,l=void 0,l=k?g.To.No(k,j):g.To.No(c.font,1),m=t(l.font),n=ya(b,c),o=void 0,xa(c,b)&&(o=Aa(b,c,l,m)),o&&(a.save(),a.textAlign=za(p.alignment),a.textBaseline="alphabetic",w(a,l.font),a.fillStyle=p.foreColor||c.foreColor||"grey",a.rect(n.x,n.y,n.width,n.height),a.clip(),a.beginPath(),a.fillText(f,o.x,o.y),a.restore())}},a.prototype.f5=function(a,b,c){var d=a.clone(),e=qa(b,0,!1,c),f=qa(b,1,!1,c),g=qa(b,2,!1,c),h=qa(b,3,!1,c);return e>0&&(d.y+=e,d.height-=e),g>0&&(d.height-=g),h>0&&(d.x+=h,d.width-=h),f>0&&(d.width-=f),f+h>=a.width&&(d.width=0),e+g>=a.height&&(d.height=0),d},a.prototype.Ama=function(b,c,d,e){var f,g=this,h=ea(e)?e.printZoomFactor:e.sheet.zoom();return c=g.f5(c,d,h),f={ctx:b,options:{rect:c,context:e}},a.ao(e.sheet,"getCellPaddingRect",f),f.options.rect},a.prototype.e5=function(a,b,c,d){var g,h,i,j,k,l,m,n,o,p,q,r,s,u=c.labelOptions;u&&(g=d.sheet,h=g.getText(d.row,d.col,d.sheetArea),i=c.watermark,j=u.visibility,1!==j&&i&&(k=u.font||c.font||g.yl.Bl(),l=g.zoom(),1!==l&&(k=g.yl.Cl(k)),m=t(k),xa(c,b)&&(n=Ba(b,c)),n&&(o=e.GC$(f.Ul.Nl("span")),o.text(i),p=(2===j||j===N)&&""===h,q=n.height-m,r=n.y+(p&&q>0?q:0),o.css({display:"block",position:"absolute",left:n.x,top:r,width:n.width,height:n.height,font:x(k),color:u.foreColor||c.foreColor||"grey",textAlign:za(u.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),e.GC$(a).append(o),p&&(s=setInterval(function(){r--,o.css("top",r),r<=n.y&&clearInterval(s)},20)))))},a.prototype.a5=function(a){var b,c,d,g=this,h=f.Ul.Nl("div");return h.style.cssText="position: absolute; margin: 0;padding: 0 ;overflow: hidden; box-sizing: content-box;resize: none;outline: none;border: 2px #5292f7 solid;box-shadow: 1px 2px 5px rgba(0,0,0,0.4);background-color: white",b=f.Ul.Nl("div"),b.style.cssText="position: absolute; outline: none; border: none",e.GC$(h).append(e.GC$(b)),c=g.createEditorElement(a,h),c&&e.GC$(b).append(e.GC$(c)),d=a.sheetArea,g.egc(a,h,a.sheet.getCellRect(a.row,a.col,1===d?-1:N,2===d?-1:N)),h},a.prototype.d5=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o;a&&a.firstChild&&(f=this,g=Fa(c),va(a,b,g,d),h=f.fgc(d,a,g,b),i=h.options.contentRect,j=h.options.cellRect,k=h.options.leftExternalRect,l=h.options.rightExternalRect,f.e5&&f.e5(a,i,b,d),m=d.sheet.zoom(),i=f.f5?f.f5(i,b,m):i,n=ha(i,k,l),o=a.firstChild,e.GC$(o).css({left:(+e.GC$(o).css("left").replace("px","")||0)+qa(b,3,!1,m),top:(+e.GC$(o).css("top").replace("px","")||0)+qa(b,0,!1,m)}),f.activateEditor(a.firstChild.firstChild,b,n,d,j,k,l))},a.prototype.updateEditorContainer=function(a,b,c,d,f,g,h){var i,j,k,l,m,n;a&&b&&(i=a.parentNode,j=i?i.parentNode:N,j&&f&&(k=e.GC$(j),l=f.width,m=f.height,l>0&&(k.width(l),n=j.lastChild,c&&"gcEditorLabel"===n.getAttribute("gcUIElement")&&e.GC$(n).width(l-qa(c,3,!0)-qa(c,1,!0)-2)),m>0&&k.height(m),r(f.x)||k.css("left",f.x+"px"),r(f.y)||k.css("top",f.y+"px")))},a.prototype.g5=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=a.firstChild,t=Fa(c);va(a,b,t,d),e=r.VBb(d,s,t,b),f=e.editorBounds,g=e.contentRect,h=e.leftExternalRect,i=e.rightExternalRect,j=s.firstChild,g=r.f5?r.f5(g,b,d.sheet.zoom()):g,k=ha(g,h,i),l=r.updateEditor(j,b,k,d,f,h,i),m={width:h.width,height:h.height},n={width:i.width,height:i.height},p=!isNaN(l&&l.width)&&l.width+m.width+n.width>f.width?l.width+m.width+n.width:f.width,q=!isNaN(l&&l.height)&&l.height+m.height+n.height>f.height?l.height+m.height+n.height:f.height,o={width:p,height:q},r.updateEditorContainer(j,l,b,d,o,m,n)},a.prototype.h5=function(a,b,c,d,e){return this.getCellAndPaddingHitInfo(a,b,c,d,e)},a.prototype.X4=function(a,b,c,d,e){var f=sa(e,c)+ra(e)+ta(e,c),g=this.getAutoFitWidth(a,b,c,d,e);return g>0&&(f+=g+qa(c,3,!1)+qa(c,1,!1)),f},a.prototype.Y4=function(a,b,c,d,e){var f=0,g=this.getAutoFitHeight(a,b,c,d,e);return g>0&&(f+=g+qa(c,0,!1)+qa(c,2,!1)),Math.max(ua(e,c),f)},a.prototype.paintValue=function(a,b,c,d,e,g,h,i){var j,k,l,m=this,n={};i.quotePrefix=h.quotePrefix,j=this.format(y(b),h.formatter||h._autoFormatter,n,i),j&&(k=new f.Rect(c,d,e,g),this.adjustRectForIconSet(h.hAlign,i.sheet,i.row,i.col,i.sheetArea,k,n.content&&this.hasInfilling(n.content)),c=k.x,e=k.width,l=m.hgc(a,j,h,i,c,d,e,g),this.paintText(a,b,c,d,e,g,h,i,j,n,N,l.externals))},a.prototype.S_a=function(a,b,c){var d=0;return a>0&&(d=8*a),b&&b.XQa(c)&&(d=0),d},a.prototype.T_a=function(a,b){return!!(!a||s(a,K)&&a===W||a&&a.formatString&&a.formatString()===W)||!(b&&(!isNaN(b)||"TRUE"===b.toUpperCase()||"FALSE"===b.toUpperCase())&&"@"!==a)},a.prototype.igc=function(a){var b,c=0;for(b=0;b<a.length;b++)c+=a[b].width;return c},a.prototype.jgc=function(a){var b,c=0;for(b=0;b<a.length;b++)c+=a[b].height;return c},a.prototype.kgc=function(b,c,d,e,f){var g={ctx:b,options:{rect:d,context:c,value:e,style:f}};a.ao(c.sheet,"beforePaintLabel",g)},a.prototype.hgc=function(b,c,d,e,g,h,i,j){var k={ctx:b,text:c,rect:new f.Rect(g,h,i,j),style:d,context:e,externals:{left:[],right:[]}};return a.ao(e.sheet,"beforePaintText",k),k},a.prototype.lgc=function(b,c,d,e,g,h,i,j,k){var l={ctx:b,style:c,context:d,textRect:new f.Rect(e,g,h,i),availRect:j};return a.ao(d.sheet,k,l),l},a.prototype.mgc=function(a,b,c,d,e,f,g,h){return this.lgc(a,b,c,d,e,f,g,h,"beforeFillTextArea")},a.prototype.ngc=function(a,b,c,d,e,f,g,h){return this.lgc(a,b,c,d,e,f,g,h,"afterFillTextArea")},a.prototype.paintText=function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q=this;a.save(),a.beginPath(),m=g.textOrientation,n=g.textIndent&&0!==g.textIndent,o=g.hAlign,p=g.isVerticalText&&4!==o,4===o&&(m=0,n=!1),b&&b.richText&&b.richText.length>0||p?q.Fpb(a,b,c,d,e,f,g,h,i,j,k,l):0!==m&&!r(m)&&-90<=m&&m<=90&&!n&&!p?q.nHb(a,b,c,d,e,f,g,h,i,j,k,l):q.N$a(a,b,c,d,e,f,g,h,i,j,k,l),a.restore()},a.prototype.oHb=function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x=b.sheet,y=b.row,z=b.col,A=e.vAlign,B=b.sheetArea;for(k=0;k<c.length;k++)if(l=c[k].text,m=d[k].lineHeight,n=1===A?0:h,o=this.pHb(a,"0"),p="",q=f,q-1-2-n<l.length*m){if(q<3*o)j.push(0),p=_;else if(r=O((q-1-2-3*o-(1===A?0:h))/m),s=0,0===A){for(t=0;t<r;t++)p+=l[t];u=p.length,p+=_,3*o+(p.length-3)*m+h>q-1-2?(p=p.substring(0,p.length-4)+_,j.push(p.split(_)[0].length)):j.push(u)}else if(1===A){for(v=0;v<P(r/2);v++)w=l.charAt(v),p+=w,s=v;for(u=p.length,p+=_,v=P(l.length-r/2);v<l.length;v++)w=l.charAt(v),p+=w;3*o+(p.length-3)*m+h>q-1-2?(p=p.replace(l[s],""),j.push(p.split(_)[0].length)):j.push(u),i[k].y=g+(f-(3*o+(p.length-3)*m))/2}else{for(j.push(0),t=l.length-1;t>=l.length-r;t--)p=l[t]+p;p=_+p,3*o+(p.length-3)*m+h>q-1-2&&(p=p.replace(l[l.length-r],"")),i[k].y=g+f-h-(3*o+(p.length-3)*m)-2}c[k].textInfos[0].text=p,x.ITa.qHb(y,z,l,B)}else x.ITa.qHb(y,z,null,B)},a.prototype.Fpb=function(a,b,c,d,e,g,h,i,j,k,l,m){var n,o,p,q,r,s,t,w,x,y,z,A,B,C,E,F,I,J,K,L,N,O,P=this,Q=new f.Rect(c,d,e,g),R=P.S_a(h.textIndent,i.sheet.outlineColumn,i.col),S=i.cellOverflowLayout&&i.cellOverflowLayout.expandedWidth,T=h.hAlign;if(3===T&&(T=u(T,b,h.formatter)),n=h.isVerticalText&&4!==T,o=!!n&&v(j),p=h.font,q=h.formatter||h._autoFormatter,r=P.T_a(q,b.text),s=D(!0,[],P.U_a(b,j,r,p,h.foreColor)),ia(a,i.sheet,h,l),b&&b.richText&&b.richText.length>0&&(t=i.sheet?i.sheet.zoom():1,w=i.printZoomFactor,w=ea(i)?w:M,P.V_a(s,p,t,w)),x=0,y=0,m&&(x=P.igc(m.left),y=P.igc(m.right)),z=x+y,A={left:x,right:y},!h.wordWrap&&h.shrinkToFit&&(4===h.hAlign?P.W_a(s,S-z,g,h,p,1,n):P.W_a(s,e-z,g,h,p,1,n)),B=P.X_a(a,j,h.font,n?g:e-z,R,n?h.vAlign:h.hAlign,h.wordWrap,n,s),C=P.Y_a(B,h,T,l),E=P.Z_a(a,h,c,d,e,g,h.wordWrap,i.cellOverflowLayout,T,R,n,B[0].textLength,C[0].lineHeight),F=!1,h.showEllipsis&&n&&!b.richText&&(F=!0),I=[],I=4===T?P.$_a(c,d,i.cellOverflowLayout.expandedWidth,g,T,h.vAlign,R,n,o,B,C,A,F):P.$_a(c,d,e,g,T,h.vAlign,R,n,o,B,C,A,F),J=B.length,K=[],F&&k&&(k.content&&1===k.content.length&&"text"===k.content[0].type||!k.content&&1===B.length&&B[0].text)&&this.oHb(a,i,B,C,h,g,d,R,I,K),1===J&&k&&!r)P.__a(a,i.sheet,j,k,I[0].x,I[0].y,e,g,T,h,E.width,E.height,R,n,B[0].textLength,i,A,Q);else{for(L=P.ogc(B),N=I[0].x,a.textAlign===H?N-=L/2:a.textAlign===G&&(N-=L),P.mgc(a,h,i,N,I[0].y,L,0,Q),O=0;O<J;O++)P.a0a(a,i.sheet,I[O].x,I[O].y,C[O],T,B[O],K[O]);P.mgc(a,h,i,N,I[0].x,L,0,Q)}},a.prototype.ogc=function(a){var b,c=a[0].textLength;for(b=0;b<a.length;b++)c=Y(c,a[b].textLength);return c},a.prototype.pHb=function(a,b){var c=0,d=a.font+b;return $[d]?c=$[d]:(c=z(a,a.font,b),$[d]=c),c},a.prototype.rHb=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=a.sheetArea,t=c,u=this.pHb(d,t),v=a.sheet,w=a.row,x=a.col,y=e,z=0,A=this.pHb(d,"0"),B=this.pHb(d,_);if(z=B,h=1===f?0:g,u>y-1-2-h){if(i="",2===f)for(j=t.length-1;j>=0;j--){if(z>y-1-2-g){k=i.length,i=_+i.substring(1,k);break}l=t.charAt(j),i=l+i,m=this.pHb(d,l),z+=m}else if(1===f){for(n=P((y-z)/A),j=0;j<n/2;j++)l=t.charAt(j),i+=l;for(i+=_,j=O(t.length-n/2);j<t.length;j++)l=t.charAt(j),i+=l;for(o=this.pHb(d,i);o>y-1-2&&i!==_;)p=i.split(_),q=p[0],r=p[1],i=q.length>r.length?q.substring(0,q.length-1)+_+r:q+_+r.substring(1,r.length),o=this.pHb(d,i)}else for(j=0;j<t.length;j++){if(z>y-1-2-g){k=i.length,i=i.substring(0,k-1)+_;break}l=t.charAt(j),i+=l,m=this.pHb(d,l),z+=m}b.content=[{value:i,type:"text"}],v.ITa.qHb(w,x,t,s)}},a.prototype.N$a=function(a,b,c,d,e,h,j,k,l,m,n,o){var p,q,s,x,y,A,B,C,D,E,F,J,K,L,M,N,P,Q,R,S,T,U,V,W,X,Z,$,_,aa,ba,ca,da,fa,ga=this,ha=0,ja=j.textIndent,ka=j.wordWrap,la=j.hAlign,ma=j.vAlign,na=j.shrinkToFit,oa=j.textDecoration,pa="left",ra=2,sa=2,ta=j.font,ua=0,va=[],wa=0,xa=k.sheet,ya=new f.Rect(c,d,e,h),za=k.cellOverflowLayout&&k.cellOverflowLayout.expandedWidth,Aa=k.offsetX;if(Aa||(Aa=0),4===la&&(oa=0,ja=0),r(k.fontInfo)&&(k.fontInfo=g.To.No(j.font,xa.zoom()),ea(k)&&(k.fontInfo=g.To.No(k.fontInfo.font,k.printZoomFactor))),p=parseInt(k.fontInfo.fontSize,10),r(k.lineHeight)&&(k.lineHeight=t(g.To.No(j.font,xa.zoom()).font,!1,v(l))),q=k.lineHeight,ia(a,xa,j,n),ja>0&&(ha=8*ja),xa.outlineColumn&&xa.outlineColumn.XQa(k.col)&&(ha=0),3===la&&(la=u(la,b,j.formatter)),s=1,w(a,ta),x=0,y=0,o&&(x=ga.igc(o.left),y=ga.igc(o.right)),A=x+y,B={left:x,right:y},!ka&&na){for(C=0,D={value:!1},E=void 0,F=0;F<3&&D.value===!1&&(J=a.measureText(l).width,C=Y(0,e-4-(1===la?0:ha)-A),4===la&&(C=Y(0,za-4-ha-A)),C<J);F++)E=g.To.No(ta,C/J,D,!0),ta=E.font,w(a,ta);E&&(s=p/E.fontSize,p=E.fontSize)}if(K=xa.parent&&xa.parent.options.numbersFitMode===i.NumbersFitMode.overflow||!1,K||(K=m&&m.content?!(!m.content||1!==m.content.length||"text"!==m.content[0].type):"string"==typeof b&&b===l),!ka&&!na&&j.showEllipsis&&K&&this.rHb(k,m,l,a,e,la,ha),ra+=ha+x,1===la||4===la?(ra=(e+x-y)/2,pa=H):2===la&&(ra=e-y-1-2,ra-=ha,pa=G),a.textAlign!==pa&&(a.textAlign=pa),L=0,ka&&(L=e-A-3-ha,4===la&&(L=za-A-3-ha),L-=1,va=f.Vn.Wn(l,L,ta,!1,a),wa=va.length,wa>1&&0!==ma&&(ua=(wa-1)*q)),M=p>8?O((p-8)/5+2):1,N=q/2-p/2+M-1,sa+=q-N,sa/=s,1===ma?sa=(h-ua)/2+q/2-N:2===ma&&(sa=h-(ua+2+N)/s),a.textBaseline!==I&&(a.textBaseline=I),P=k.cellOverflowLayout,Q=P&&P.layout,R={x:Q?Q.x:c+1,y:Q?Q.y:d+1,width:Q?Q.width:e-2,height:Q?Q.height:h-2},P&&4===la&&(ra+=(P.expandedWidth-e)/2),ra+=Aa,S=Q&&Q.width>e||4===la,T=R.x,U=R.y,V=R.width,W=R.height,ka)if(a.rect(T,U,V,W),a.clip(),a.beginPath(),X=d+sa,wa>1){for(Z=c+ra,a.textAlign===H?Z-=L/2:a.textAlign===G&&(Z-=L),ga.mgc(a,j,k,Z,X,L,q*wa,ya),F=0;F<wa;F++)a.fillText(va[F],c+ra,X),oa&&(J=a.measureText(va[F]).width,ga.ip(a,oa,c+ra,X,J,p,M)),X+=q;ga.mgc(a,j,k,Z,X,L,q*wa,ya)}else ga.Oja(a,l,m,c+ra,d+sa,la,V,ha,oa,M,p,k,j,B,ya,S);else $=z(a,a.font,l)+A,_=$>V-(c+1-T)||q>W||0!==Aa,4===la&&(_=!0),aa=qa(j,0),ba=qa(j,1),ca=qa(j,2),da=qa(j,3),_||(1===la||4===la?P&&(fa=$/2,(fa>P.backgroundLeftWidth||fa>P.backgroundRightWidth)&&(_=!0)):($+ha+aa+ca>V||ua+da+ba>W)&&(_=!0)),_&&(a.rect(T,U,V,W),a.clip(),a.beginPath()),ga.Oja(a,l,m,c+ra,d+sa,la,V,ha,oa,M,p,k,j,B,ya,S)},a.prototype.nHb=function(a,b,c,d,e,h,i,j,k,l,m,n){var o,p,q,r,s,t,v,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,P,T,V,W,X,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha=this,ja=i.wordWrap,ka=i.hAlign,la=i.vAlign,ma=i.shrinkToFit,na=i.textDecoration,oa=2,pa=2,ra=i.font,sa=[],ta=0,ua=parseInt(j.fontInfo.fontSize,10),va=j.sheet,wa=new f.Rect(c,d,e,h),xa=j.cellOverflowLayout,ya=xa&&xa.layout,za=i&&(i.borderLeft||i.borderTop||i.borderRight||i.borderBottom)&&!va.getSpan(j.row,j.col,j.sheetArea),Aa=i.textOrientation,Ba=Aa*Math.PI/180,Ca=U(Ba),Da=R(Ca),Ea=Q(Ca),Fa=S(Ca),Ga=j.lineHeight,Ia=90===Aa||Aa===-90;if(za&&(Aa>-90&&Aa<0&&(r=!1),Aa>0&&Aa<90&&(r=!0)),s={x:ya?ya.x:c+1,y:ya?ya.y:d+1,width:ya?ya.width:e-2,height:ya?ya.height:h-2},t=s.x,v=s.y,x=s.width,y=s.height,z=Ga/2*Q(Ca),A=Ga/2*R(Ca),B=ua>8?O((ua-8)/5+2):1,C=Ga/2-ua/2+B-1,l&&l.content&&l.content.length>0&&!ma&&(k=ha.sHb(a,l.content,h-4,ra)),D=va.dp(k,ra),ia(a,va,i,m),3===ka&&(ka=u(ka,b,i.formatter,Aa)),w(a,ra),E=0,F=0,n&&(E=ha.igc(n.left),F=ha.igc(n.right)),!ja&&ma)for(G=0,H={value:!1},I=0;I<3&&H.value===!1&&(G=Y(0,(h-4-2*A)/Ea),G<D);I++)ra=g.To.No(ra,G/D,H,!0).font,w(a,ra),ua=parseInt(j.fontInfo.fontSize,10),D=va.dp(k,ra),Ga=f.Ul.fp(ra),z=Ga/2*Q(Ca),A=Ga/2*R(Ca);if(J=0,K=0,ja)for(K=(h-4-2*A)/Ea,sa=f.Vn.Wn(k,K,ra,!1,a),ta=sa.length,D=va.dp(sa[0],ra),L=0;L<ta;L++)M=va.dp(sa[L],ra),M>J&&(J=M);switch(q=(ja?J:D)*Ea+2*A,h<=q&&(la=2),o=D/2*Da,p=(ja?J:D)/2*Ea,N=""+ka+la){case"00":oa+=o+z+E,pa+=p,Ia||(pa+=A),za&&(oa=(r?1:-1)*((h-pa)/Fa)+(Ga/2+2)/Ea);break;case"01":oa+=o+z+E,pa=h/2,za&&(oa=(r?1:-1)*((h-pa)/Fa)+(Ga/2+2)/Ea);break;case"02":oa+=o+z+E,pa+=p,Ia||(pa+=A),za&&(oa=(r?1:-1)*(pa/Fa)+(Ga/2+2)/Ea),pa=h-pa;break;case"10":oa=(e+E-F)/2,pa+=p,Ia||(pa+=A),za&&(oa+=(r?1:-1)*(h-pa)/Fa);break;case"11":oa=(e+E-F)/2,pa=h/2,za&&(oa+=(r?1:-1)*(h-pa)/Fa);break;case"12":oa=(e+E-F)/2,pa+=p,Ia||(pa+=A),za&&(oa+=(r?1:-1)*pa/Fa),pa=h-pa;break;case"20":oa=e-2-o-z-F,pa+=p,Ia||(pa+=A),za&&(oa=e+(r?1:-1)*((h-pa)/Fa)-(Ga/2+2)/Ea);break;case"21":oa=e-2-o-z-F,pa=h/2,za&&(oa=e+(r?1:-1)*((h-pa)/Fa)-(Ga/2+2)/Ea);break;case"22":oa=e-2-o-z-F,pa+=p,Ia||(pa+=A),za&&(oa=e+(r?1:-1)*(pa/Fa)-(Ga/2+2)/Ea),pa=h-pa}if(ja)if(P=c+oa,T=Ga/Ea,V=void 0,90===Math.abs(Aa)&&(W=qa(i,1),X=qa(i,3),Z=D*ta+W+X>x,Z&&(a.rect(t,v,x,y),a.clip())),ta>1){for($=ta%2!==0,1===ka&&(P-=$?T*(ta-1)/2:T*(ta/2)-.5*T),_=Ha(P,d+pa,D,Ba,Ga),aa=_.width+T*(ta-1),ba=_.height,ca=2===ka?_.x-T*(ta-1):_.x+T*(ta-1),da=_.y,ha.mgc(a,i,j,ca,da,aa,ba,wa),I=0;I<ta;I++)V=I,(i.textOrientation>0&&2===ka||i.textOrientation<0&&(0===ka||1===ka))&&(V=ta-I-1),ha.tHb(a,Ba,sa[V],P,d+pa,na,ua,B,C),P=2===ka?P-T:P+T;ha.mgc(a,i,j,ca,da,aa,ba,wa)}else ha.pgc(a,k,c,d,oa,pa,j,i,D,Ba,na,ua,B,Ga,C,wa);else ea=D*Ea+ua*Ea+2,fa=qa(i,0),ga=qa(i,2),Z=ea>y-(d+1-v)||Ga>y||ea+fa+ga>y,Z&&(a.rect(t,v,x,y),a.clip()),ha.pgc(a,k,c,d,oa,pa,j,i,D,Ba,na,ua,B,Ga,C,wa)},a.prototype.pgc=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this,r=Ha(c,d,i,j,n),s=r.width,t=r.height,u=r.x,v=r.y;q.mgc(a,h,g,u,v,s,t,p),q.tHb(a,j,b,c+e,d+f,k,l,m,o),q.mgc(a,h,g,u,v,s,t,p)},a.prototype.V_a=function(a,b,c,d){Ga(a,b,c,d)},a.prototype.W_a=function(a,b,c,d,e,f,h){var i,j,k,l=0,m={value:!1};for(i=0;i<3&&m.value===!1&&(j=la(a,e,f,h),l=Y(0,(h?c:b)-4),(h?d.vAlign:1!==d.hAlign&&d.textIndent)&&(l=Y(0,l-8*d.textIndent)),l<j);i++)for(k=0;k<a.length;k++)a[k].style.font=g.To.No(a[k].style.font,l/j,m,!0).font},a.prototype.U_a=function(a,b,c,d,e){var f=a.richText;return!r(f)&&c||(f=[{style:{font:d,foreColor:e},text:b}]),f},a.prototype.Z_a=function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o=h&&h.layout,p={x:o?o.x:c+1,y:o?o.y:d+1,width:o?o.width:e-2,height:o?o.height:f-2},q=p.x,r=p.y,s=p.width,t=p.height;return g?(a.rect(q,r,s,t),a.clip(),a.beginPath()):(n=this.b0a(b,i,b.vAlign,c,d,t,s,q,r,l,m,j,k,h),n&&(a.rect(q,r,s,t),a.clip(),a.beginPath())),p},a.prototype.b0a=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o,p,q=qa(a,0),r=qa(a,1),s=qa(a,2),t=qa(a,3);return m?(o=j>f-(e+1-i)||k>g,(!o&&1!==c&&j+l+q+s>f||k+t+r>g)&&(o=!0)):(o=j>g-(d+1-h)||k>f,o||(1===b?n&&(p=j/2,(p>n.backgroundLeftWidth||p>n.backgroundRightWidth)&&(o=!0)):(j+l+t+r>g||k+q+s>f)&&(o=!0))),o},a.prototype.X_a=function(a,b,c,d,e,h,i,j,k){var l,m,n,o,p;if(1!==h?d=d-3-e:d-=3,i)return f.Vn.M_a(b,d,c,k,j,a);for(l=0,m=0;m<k.length;m++)n=k[m].text,j?l+=t(k[m].style.font)*(n?n.length:0):(o=g.To.No(k[m].style.font,1),p=k[m].style.vertAlign?o.fontSize*Z+"px "+o.fontFamily:k[m].style.font,l+=z(a,p,n));return[{textLength:l,text:b,textInfos:k}]},a.prototype.__a=function(a,b,c,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s){var t,u=k.font,v=g.To.No(u,1).fontSize,w=v>8?O((v-8)/5+2):1;this.L$a(a,b,k),o?this.c0a(a,c,d,k,e,f,m,n,m,q,r,s):(t=l>h,this.Oja(a,c,d,e,f,j,l,n,k.textDecoration,w,v,q,k,r,s,t,p))},a.prototype.c0a=function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,r=this,s=c.content,t=f;if(r.mgc(a,d,j,e,t,i,i*b.length,l),s&&s.length>0)for(n=Ca(a,s,!0),o=g-h-n-2,o=o>0?o:0,p=void 0,m=0;m<s.length;m++)"fillingChar"===s[m].type?(q=Ea(a,o,s[m].value,!0),this.vWa(a,q,e,f),f+=o):"placeholder"===s[m].type?f+=s[m].value?s[m].value.length*i:0:"numberPlaceholder"===s[m].type?f+=i:(this.vWa(a,s[m].value,e,f),p=s[m].value?s[m].value.length*i:0,f+=p);else if(b)for(m=0;m<b.length;m++)f=this.vWa(a,b[m],e,f,i).y;r.ngc(a,d,j,e,t,i,f-t,l)},a.prototype.d0a=function(a){var b=F;return 1===a?b=H:2===a&&(b=G),b},a.prototype.a0a=function(a,b,c,d,e,f,g,h){var i,j,k=[],l=g.textInfos;for(i=0;i<l.length;i++)k.push(D(!0,{},e,l[i].style));for(i=0;i<l.length;i++)j=this.f0a(a,b,c,d,k[i],l[i].text,h),c=j.x,d=j.y},a.prototype.Y_a=function(a,b,c,d){var e,f,g=[],h=a.length;for(e=0;e<h;e++)f=this.g0a(b,c,d,a[e].textInfos),g.push(f);return g},a.prototype.g0a=function(a,b,c,d){var e,f,h,i,j=this,k=0,l=0;if(d)for(e=0;e<d.length;e++)f=void 0,f=d[e].style&&d[e].style.font?d[e].style.font:a.font,k=Math.max(t(f,N,v(d[e].text)),k),l=Math.max(g.To.No(f,1).fontSize,l),(d[e].style&&1===d[e].style.vertAlign||2===d[e].style.vertAlign)&&(k=Math.max(t(f,N,v(d[e].text))+2*g.To.No(f,Z).fontSize*.218,k));
return h=l>8?O((l-8)/5+2):1,i=k/2-l/2+h-1,{lineHeight:k,fontSize:l,baselineOffset:h,lineOffset:i,font:a.font,foreColor:a.foreColor,textDecoration:a.textDecoration,isVerticalText:a.isVerticalText,textAlign:j.d0a(b),textBaseline:I,opacity:c}},a.prototype.h0a=function(a,b,c){var d=0,e=0,f;for(f=0;f<a.length;f++)e+=b[f].lineHeight,d=Math.max(a[f].textLength,d);return{width:c?e:d,height:c?d:e}},a.prototype.$_a=function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o=this.h0a(j,k,h),p=o.height,q=o.width,r=[];if(h)for(n=0;n<j.length;n++)r.push(this.i0a(a,b,c,d,e,f,g,q,j[n].textLength,k[n].lineHeight,k[n].lineOffset,i,l,j[n],m)),i?a-=k[n].lineHeight:a+=k[n].lineHeight;else for(n=0;n<j.length;n++)r.push(this.j0a(a,b,c,d,e,f,g,j[n].textLength,p,k[n].lineHeight,k[n].lineOffset,l)),b+=k[n].lineHeight;return r},a.prototype.j0a=function(a,b,c,d,e,f,g,h,i,j,k,l){var m=0,n=0,o=l.left,p=l.right;return n=1===f?(d-i)/2+j-k:2===f?d-i-2+j-k:2+j-k,1===e||4===e?m=(c-h+o-p)/2:2===e?(m=c-1-2-h-p,m-=g):m=2+g+o,{x:a+m,y:b+n}},a.prototype.i0a=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p,q=0,r=0,s=m.left,t=m.right;return l?0===e?q=2+h+t-j/2:1===e?q=(c-s+t+h)/2-j/2:2===e&&(q=c-s-1-2-j/2):1===e?q=(c-h+s-t)/2+j/2:2===e?q=c-1-2-t-h+j/2:0===e&&(q=2+s+j/2),r=1===f?(d-i)/2:2===f?d-g-i-2:2+g,{x:a+q,y:b+r}},a.prototype.f0a=function(a,b,c,d,e,f,g){var h,i;return a.save(),this.L$a(a,b,e),h=e.vertAlign,i=e.isVerticalText?this.vWa(a,f,c,d,e.textDecoration,e.baselineOffset,g):this.k0a(a,c,d,e,f,h),a.restore(),i},a.prototype.L$a=function(a,b,c){ia(a,b,c);var d=c.vertAlign?this.l0a(c.font):c.font;r(c.textBaseline)||a.textBaseline===c.textBaseline?r(a.textBaseline)&&a.textBaseline!==I&&(a.textBaseline=I):a.textBaseline=c.textBaseline,c.isVerticalText?a.textAlign!==H&&(a.textAlign=H):a.textAlign!==F&&(a.textAlign=F),w(a,d)},a.prototype.l0a=function(a){var b=g.To.Ko(a),c=parseFloat(b.fontSize)*Z;return b.fontSize=c+"px",this.m0a(b)},a.prototype.m0a=function(a){var b="",c="normal",d="Calibri",e=a.fontStyle,f=a.fontSize,g=a.fontWeight,h=a.fontFamily;return b=void 0!==e?e:c,b+=void 0!==g?(b?" ":"")+g:(b?" ":"")+c,b+=(b?" ":"")+f,b+=void 0!==h?(b?" ":"")+h:(b?" ":"")+d},a.prototype.vWa=function(a,b,c,d,e,f,h){var i,j,k,l,m,n,o,p,q,r;if(b&&b.length>0)for(i=a.font,j=t(i,N,v(b)),k=fa(g.To.No(i,1).fontSize,j),l=this.pHb(a,"0"),m=l/2,n=0;n<b.length;n++)o=ga(b[n]),p=void 0!==h&&n>=h&&n<=h+2&&(h+3===b.length||0===h&&h+3<b.length||0!==h&&h+3<b.length),q=p?l:j,r=p?m:k,d=d+q-r,a.fillText(o,c,d),this.Mxb(a,e,c,d,z(a,a.font,o),g.To.No(a.font,1).fontSize,f),d+=r;return{x:c,y:d}},a.prototype.Mxb=function(a,b,c,d,e,f,g){var h,i,j,k,l;a.strokeStyle!==a.fillStyle&&(a.strokeStyle=a.fillStyle),h=0,i=0,j=.5,k=f<=12?12:f,i=O((k-12)/21+1),a.lineWidth!==i&&(a.lineWidth=i),0===(1&i)&&(j=0),l=a.textAlign,l===H?c-=e/2:l===G&&(c-=e),a.beginPath(),2===(2&b)&&(h=P(d+g-f/2)-j,a.moveTo(c,h),a.lineTo(c+e,h)),a.stroke()},a.prototype.k0a=function(a,b,c,d,e,f){var h,i,j,k,l;return r(e)?{x:b,y:c}:(h=g.To.No(a.font,1).fontSize,i=h>8?O((h-8)/5+2):1,j=0,f?(j=1===f?.74*h:.28*-h,a.fillText(e,b,c-j)):a.fillText(e,b,c),k=z(a,a.font,e),l=d.textDecoration,this.ip(a,l,b,c,k,h,i-j),{x:b+k,y:c})},a.prototype.jp=function(b,c,d,e,f,g,h,i){var j={row:i.row,col:i.col,sheet:i.sheet,sheetArea:i.sheetArea,style:h,underline:h.textDecoration,foreColor:h.foreColor};a.ao(i.sheet,"applyHyperlinkStyle",j),this.paint(b,c,d,e,f,g,h,i)},a.prototype.paint=function(a,b,c,d,e,g,h,i){var j,k,l,m,n,o,p;a&&(j=h.backColor,i.parentBackColor!==j&&na(a,c,d,e,g,i.imageLoader,h,b,i),k=i.sheetArea,2!==k&&1!==k||(l=i.visualState||0,m="columnHeader",2===k&&(m="rowHeader"),n=this.getThemeStyle(i.visualState,"gc-"+m+"-"+f.Im.Jm(l)),ba.gp(a,c,d,e,g,h,m,n,k)),o=this,p=new f.Rect(c,d,e,g),o.kgc(a,i,p,b,h),Ia(a,p,h,i),o.i5&&(o.i5(a,p,h,i),p=o.f5(p,h,ea(i)?i.printZoomFactor:i.sheet.zoom())),i.cellOverflowLayout||o.uxb(a,p,i,y(b)),p.width>0&&p.height>0&&(h&&h.showEllipsis&&i.sheet.ITa.qHb(i.row,i.col,null,i.sheetArea),o.paintContent(a,b,p.x,p.y,p.width,p.height,h,i)))},a.prototype.paintContent=function(a,b,c,d,e,g,h,i){var j,k,l,m,n=i.conditionalFormats;n&&(j=n.jp(a,y(b),c,d,e,g,h,i)),i.showBarIconOnly=j,k=i.sparkline,k&&k.paintSparkline(a,c,d,e,g),l=ba.oDc(a,y(b),c,d,e,g,i),i.cellOverflowLayout||j||l||(m=new f.Rect(c,d,e,g),this.paintValue(a,b,m.x,m.y,m.width,m.height,h,i))},a.prototype.adjustRectForIconSet=function(a,b,c,d,e,f,g){oa(a,b,c,d,e,f,g)},a.prototype.hasInfilling=function(a){for(var b=0;b<a.length;b++)if("fillingChar"===a[b].type)return!0;return!1},a.prototype.createEditorElement=function(a,b){return M},a.prototype.getEditorValue=function(a,b){return M},a.prototype.kp=function(a,b,c,d){return c},a.prototype.setEditorValue=function(a,b,c){},a.prototype.getEditingElement=function(){return M},a.prototype.parse=function(a,b,c){var e,f,g=r(b),h=r(a);try{if(e=d.Formatter&&d.Formatter.GeneralFormatter,!g&&!h&&e)return f=typeof b===K?new e(b):b,f.parse(a)}catch(a){}return h?"":""+a},a.prototype.format=function(a,b,c,e){var g,h,i,j,l,p,q=B(b);if(e&&q&&(g=e.sheet,h=g.aHb(e.row,e.col,b),r(h)||(a=h)),r(a)||""===a)return"";if(e&&e.quotePrefix&&typeof a===K)return""+a;if(!q&&typeof b===K&&"object"!=typeof a)return f.mn.un(a,b,c);if(!b||"General"===b||q)return"boolean"==typeof a||a instanceof Boolean?(k&&(a=a?k.getBoolean().boolean_true:k.getBoolean().boolean_false),(""+a).toUpperCase()):a instanceof Date?(i=m.q4(m.culture()).DateTimeFormat,j=i.shortDatePattern,0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()||(j=i.defaultDatePattern),o.Vb(a,j)):(typeof a===L&&(a=n.nb(""+a)),""+a);try{return l=d.Formatter&&d.Formatter.GeneralFormatter,l?(p=M,p=typeof b===K?f.mn.tn(b):b,p.format(a,c)):""+a}catch(b){return""+a}},a.prototype.focus=function(a,b){a&&a.focus&&a.focus()},a.prototype.getThemeStyle=function(a,b){return f.Im.Km(a,b)},a.prototype.activateEditor=function(a,b,c,d,e,f,g){},a.prototype.deactivateEditor=function(a,b){},a.prototype.selectAll=function(a,b){a&&a.select&&a.select()},a.prototype.updateEditor=function(a,b,c,d,e,f,g){},a.prototype.setImeMode=function(a,b,c){this.isImeAware(c)?this.updateImeMode(a,b,c):a&&ba.hp(a,0)},a.prototype.updateImeMode=function(a,b,c){a&&ba.hp(a,b)},a.prototype.getHitInfo=function(a,b,c,d,e){return M},a.prototype.getCellAndPaddingHitInfo=function(b,c,d,e,f){var g,h,i=this;if(f){if(g={x:b,y:c,context:f,cellStyle:d,cellRect:e,paddingHitInfo:null},a.ao(f.sheet,"getCellButtonHitInfo",g,function(){return null!==g.paddingHitInfo&&void 0!==g.paddingHitInfo}),h=g.paddingHitInfo,g.paddingHitInfo&&!r(g.paddingHitInfo.cellButtonHitInfo)&&!r(g.paddingHitInfo.cellButtonHitInfo.buttonConfig))return g.paddingHitInfo;if(g.cellRect=i.f5?i.f5(g.cellRect,d,f.sheet.zoom()):g.cellRect,a.ao(f.sheet,"getCellTextHitInfo",g,function(){return!r(g.paddingHitInfo)&&g.paddingHitInfo.isReservedLocation}),g.paddingHitInfo&&g.paddingHitInfo.isReservedLocation)return g.paddingHitInfo;if(3===f.sheetArea)return a.ao(f.sheet,"getCellPaddingHitInfo",g,function(){return!r(g.paddingHitInfo)&&g.paddingHitInfo.isReservedLocation}),g.paddingHitInfo?g.paddingHitInfo:h?h:this.getHitInfo(b,c,d,e,f)}return this.getHitInfo(b,c,d,e,f)},a.prototype.processCellAndPaddingMouseDown=function(b){return a.ao(b.sheet,"processMouseDownOnCellPadding",b),this.processMouseDown(b)},a.prototype.processMouseDown=function(a){return!1},a.prototype.YBb=function(b){return a.ao(b.sheet,"processMouseMoveOnCellPadding",b),this.processMouseMove(b)},a.prototype.processMouseMove=function(a){return!1},a.prototype.XGb=function(b){return a.ao(b.sheet,"processMouseUpOnCellPadding",b),this.processMouseUp(b)},a.prototype.processMouseUp=function(a){return!1},a.prototype.processMouseEnter=function(a){return!1},a.prototype.ZBb=function(b){return a.ao(b.sheet,"processMouseLeaveOnCellPadding",b),this.processMouseLeave(b)},a.prototype.processMouseLeave=function(a){return!1},a.prototype.isReservedKey=function(a,b){return!1},a.prototype.isEditingValueChanged=function(a,b,c){var d=c.sheet,e=c.row,f=c.col,g=c.sheetArea||i.SheetArea.viewport,h=d&&d.getValue(e,f,g,i.ValueType.richText);return h&&h.richText&&(a=a.replace(/\r\n?/g,"\n")),a===M&&(a=N),b===M&&(b=N),a!==b},a.prototype.processCompositionStart=function(a,b){return!1},a.prototype.processKeyDown=function(a,b){return!1},a.prototype.processKeyUp=function(a,b){return!1},a.prototype.getAutoFitWidth=function(a,b,c,d,e){return ba.cp(a,b,c,d,e)},a.prototype.getAutoFitHeight=function(a,b,c,d,e){return ba.ep(a,b,c,d,e)},a.prototype.Oja=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s,t=this;c&&c.content&&c.content.length>0&&(r||!p||4===f)?this.Pja(a,c.content,d,e,f,g,h,i,j,k,l,m,n,o,q):(q=q?q:z(a,a.font,b),s=d,a.textAlign===H?s-=q/2:a.textAlign===G&&(s-=q),t.mgc(a,m,l,s,e,q,l.lineHeight,o),a.fillText(b,d,e),i&&this.ip(a,i,d,e,q,k,j),t.ngc(a,m,l,s,e,q,l.lineHeight,o))},a.prototype.tHb=function(a,b,c,d,e,f,g,h,i){if(a.save(),a.textAlign="center",a.textBaseline="middle",a.translate(d,e),a.rotate(-b),a.fillText(c,0,0),f){var j=a.measureText(c).width;this.ip(a,f,0,i,j,g,h)}a.restore()},a.prototype.sHb=function(a,b,c,d){var e,f,g,h;for(a.font||w(a,d),e=Ca(a,b),f=c-e,f=f>0?f:0,g=[],h=0;h<b.length;h++)if("fillingChar"===b[h].type)g.push(Ea(a,f,b[h].value));else{if("placeholder"===b[h].type||"numberPlaceholder"===b[h].type)continue;g.push(b[h].value)}return g.join("")},a.prototype.Pja=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p,q,s,t,u,v,w;a.save(),a.textAlign!==F&&(a.textAlign=F),b=Da(JSON.parse(JSON.stringify(b))),p=this,q=Ca(a,b),s=m?m.left:0,t=m?m.right:0,u=s+t,v=f-g-q-u-2,v=v>0?v:0,r(o)?this.hasInfilling(b)?1===e||4===e?(c-=(f+s-t)/2,c+=g+s):2===e&&(c=c-f+t+2,c+=g+s):r(q)||(1===e||4===e?c-=q/2:2===e&&(c-=q)):this.hasInfilling(b)?1===e?(c=c+(o?o:q)/2-(f+s-t)/2,c+=g+s):2===e&&(c=c+(o?o:q)-f+t+2,c+=g+s):r(q)||(1===e?c=c+o/2-q/2:2===e&&(c=c+o-q)),p.mgc(a,l,k,c,d,q,k.lineHeight,n),w=this.Qja(a,b,c,d,v,h,i,j),p.ngc(a,l,k,c,d,w-c,k.lineHeight,n),a.restore()},a.prototype.Qja=function(a,b,c,d,e,f,g,h,i){var j,k,l,m=0;for($[a.font+"0"]?m=$[a.font+"0"]:(m=z(a,a.font,"0"),$[a.font+"0"]=m),j=0;j<b.length;j++)"fillingChar"===b[j].type?(a.fillText(Ea(a,e,b[j].value),c,d),f&&this.ip(a,f,c,d,e,h,g),c+=e):"placeholder"===b[j].type?c+=z(a,a.font,b[j].value):"numberPlaceholder"===b[j].type?c+=m:(k=b[j].value,k!==M&&a.fillText(k,c,d),l=z(a,a.font,k),f&&this.ip(a,f,c,d,l,h,g),c+=l);return c},a.prototype.ip=function(a,b,c,d,e,f,g){var h,i,j,k,l;a.strokeStyle!==a.fillStyle&&(a.strokeStyle=a.fillStyle),h=a.textAlign,i=0,j=0,k=.5,l=f<=12?12:f,j=O((l-12)/21+1),a.lineWidth!==j&&(a.lineWidth=j),0===(1&j)&&(k=0),h===H?c-=e/2:h===G&&(c-=e),a.beginPath(),4===(4&b)&&(i=P(d+g-f-1)-k,a.moveTo(c,i),a.lineTo(c+e,i)),2===(2&b)&&(i=P(d+g-f/2)-k,a.moveTo(c,i),a.lineTo(c+e,i)),1===(1&b)&&(i=P(d+g-1)-k,a.moveTo(c,i),a.lineTo(c+e,i)),8===(8&b)&&(i=P(d+g-1)-k,a.moveTo(c,i-j),a.lineTo(c+e,i-j),a.moveTo(c,i+j),a.lineTo(c+e,i+j)),a.stroke()},a.prototype.lp=function(a,b){var c="";4===(4&b)&&(c="overline"),2===(2&b)&&(c+=" line-through"),1===(1&b)&&(c+=" underline"),a.css("text-decoration",c)},a.prototype.gQa=function(){return M},a.prototype.isImeAware=function(a){return!1},a.prototype.isEditing=function(){return!1},a.prototype.qHJ=function(a){},a.prototype.qAb=function(a,b,c,d,e){},a.prototype.K7J=function(a,b,c,d,e){},a.prototype.toJSON=function(){var a,b={},c=this;for(a in c)c.hasOwnProperty(a)&&(b[a]=c[a]);return b},a.prototype.fromJSON=function(a){if(a)for(var b in a)r(a[b])||(this[b]=a[b])},a}(),b.Base=da,f.Zn(da),j._o[0]=da;function ja(a,b,c,d){var e,f=a.conditionalFormats;if(f)return e=a.getValue(b,c,d),f.bp(b,c,d)&&f.oRa(a,b,c,e,d).iconSet}function ka(a,b,c){var d,e,f=0;for(d=0;d<a.length;d++)e=void 0,e=a[d].style&&a[d].style.font?a[d].style.font:b,f=Math.max(t(e,N,v(a[d].text))/c,f),(a[d].style&&1===a[d].style.vertAlign||2===a[d].style.vertAlign)&&(f=Math.max(t(e,N,v(a[d].text))/c+2*g.To.No(e,Z).fontSize*.218,f));return f}function la(a,b,c,d,e){var h,i,j,k,l,m=f.Vn.bm();if(!m)return 0;for(h=0,i=0;i<a.length;i++)j=void 0,j=a[i].style&&a[i].style.font?a[i].style.font:b,a[i].style&&a[i].style.vertAlign&&(j=g.To.No(j,Z).font),w(m,j),k="",k=i===a.length-1&&e?f.Vn.Rvb(a[i].text):a[i].text,l=0,d?l=t(j)*k.length/c:r(a[i].text)||(l=z(m,j,a[i].text)/c),h+=l;return h}function ma(a,b,c,d,e){var g,h,i=f.Vn.bm();if(!i)return 0;for(g=0,h=0;h<a.length;h++)g+=la(a[h],b,c,d,e);return g}function na(a,b,c,d,e,f,h,i,j){var k,l,m,n,o,p,q,r,s=h.backColor,t=h.backgroundImage,u=h.textOrientation,v=h.isVerticalText,w=h.textIndent&&0!==h.textIndent,x=h.backgroundImageLayout,y=j.row,z=j.col,A=j.sheet,B=A.ss,C=j.sheet&&j.sheet.getSpan(y,z,j.sheetArea),D=h&&(h.borderLeft||h.borderTop||h.borderRight||h.borderBottom),E=0,F=b;a.save(),z+1<A.getColumnCount()&&(o=B.Ym(y,z+1)),z-1>=0&&(p=B.Ym(y,z-1)),q=function(a){return a!==N&&a&&-90<=a&&a<=90},r=function(){a.fillRect(b,c,d,e)},u&&0!==u&&D&&i&&!C&&!v&&!w&&(k=U(u*Math.PI/180),l=S(k),E=O(e/l),u>-90&&u<0&&(o&&!q(o.textOrientation)&&(n=o.backColor),F=b-E),u>0&&u<90&&(p&&!q(p.textOrientation)&&(n=p.backColor),F=b+E),m=function(){a.beginPath(),a.moveTo(F,c),a.lineTo(F+d,c),a.lineTo(b+d,c+e),a.lineTo(b,c+e),a.fill()}),(s||t)&&(n&&g.To.setFillStyle(a,n,b,c,d,e,r),m?g.To.setFillStyle(a,s,Math.min(F,b),c,d+E,e,m):s&&g.To.setFillStyle(a,s,b,c,d,e,r),ba.ap(a,b,c,d,e,t,x,f)),a.restore()}function oa(a,b,c,d,e,f,g){if((0===a||g)&&ja(b,c,d,e)){var h=pa(b);f.x+=h,f.width-=h}}function pa(a){return parseInt(J*a.zoom(),10)}function qa(a,b,c,d){var e=a.cellPadding,f=0,g=a.labelOptions;return c&&(e=g?g.margin:"0"),e&&(f=parseInt(wa(e)[b],10),f=typeof f===L&&f>0?f:0),d===N?f:f*d}function ra(a){var b={context:a,value:0};return da.ao(a.sheet,"getOutlineColumnOffset",b),b.value}function sa(a,b){var c={context:a,value:0,cellStyle:b};return da.ao(a.sheet,"getCellButtonAutoWidth",c),c.value}function ta(a,b){var c={context:a,value:0,cellStyle:b};return da.ao(a.sheet,"getSpecialIconsAutoWidth",c),c.value}function ua(a,b){var c={context:a,value:0,cellStyle:b};return da.ao(a.sheet,"getCellButtonAutoHeight",c),c.value}function va(a,b,c,d){var f,g,h,i,j=d&&d.sheet;j&&c&&(f=d.canvasOffset||j.mm.bG(),g=j.Dr(),h=b.backColor||"white",h.stops&&(i=h.stops,h=i[0]&&i[0].color),h.backgroundColor&&(h=h.backgroundColor),e.GC$(a).width(c.width).height(c.height).css({top:f.top+g.y+c.y-2,left:f.left+g.x+c.x-2,"background-color":h}))}function wa(a){var b,c,d,e,f=["0","0","0","0"];return typeof a===K&&(b=a.split(" ",4),c=b.length,d=void 0,e=void 0,1===c?(d=b[0],f=[d,d,d,d]):2===c?(d=b[0],e=b[1],f=[d,e,d,e]):3===c?(e=b[1],f=[b[0],e,b[2],e]):4===c&&(f=[b[0],b[1],b[2],b[3]])),f}function xa(a,b){var c,d=qa(a,0),e=qa(a,2),f=qa(a,0,!0),g=qa(a,2,!0);if(qa(a,3,!0)+qa(a,1,!0)>=b.width)return!1;if(c=a.labelOptions.alignment,c===N&&(c=a.labelOptions.alignment=0),0===c||1===c||2===c){if(d>0&&f+g<d)return!0}else if((3===c||4===c||5===c)&&d<b.height&&e>0&&f+g<e)return!0;return!1}function ya(a,b){var c=qa(b,0),d=qa(b,3,!0),e=qa(b,2,!0),f=a.clone(),g=b.labelOptions.alignment;return 0===g||1===g||2===g?c<a.height&&(f.height=c-e+1):3!==g&&4!==g&&5!==g||(f.height=a.height-e),f.x+=d,f.width-=d+qa(b,1,!0),f}function za(a){var b="left";return 1===a||4===a?b="center":2!==a&&5!==a||(b="right"),b}function Aa(a,b,c,d){var e=new f.Point(a.x,a.y),g=parseInt(c.fontSize,10),h=qa(b,0),i=qa(b,2),j=qa(b,3,!0),k=qa(b,1,!0),l=a.width,m=a.height,n=g>8?Math.floor((g-8)/5+2):1,o=d/2-g/2+n-1,p=g>8?1:2,q=d-o+qa(b,0,!0),r=q+1,s=h+i>m?h+q:m-i+q-1;switch(b.labelOptions.alignment){case 0:e.x+=j+p+1,e.y+=r;break;case 1:e.x+=j+(l-j-k)/2,e.y+=r;break;case 2:e.x+=l-k-2,e.y+=r;break;case 3:e.x+=j+p+1,e.y+=s;break;case 4:e.x+=j+(l-j-k)/2,e.y+=s;break;case 5:e.x+=l-k-2,e.y+=s}return e}function Ba(a,b){var c=qa(b,3,!0),d=qa(b,1,!0),e=qa(b,0,!0),f=qa(b,2,!0),g=a.clone(),h=b.labelOptions.alignment;return g.x=c+1,g.width-=c+d,0===h||1===h||2===h?(g.y=e,g.height=qa(b,0)-e-f):3!==h&&4!==h&&5!==h||(g.y=a.height-qa(b,2)+e,g.height=qa(b,2)-e-f),2!==h&&5!==h||(g.width-=2),g}function Ca(a,b,c){var d,e,f;if(s(b,K))return d=0,$[a.font+b]?d=$[a.font+b]:(d=z(a,a.font,b),$[a.font+b]=d),d;if(c&&b&&b[0]&&b[0].value)return b[0].value.length*t(a.font);for(e=0,f=0;f<b.length;f++)"fillingChar"!==b[f].type&&(d=0,$[a.font+b[f].value]?d=$[a.font+b[f].value]:(d=z(a,a.font,b[f].value),$[a.font+b[f].value]=d),e+=d);return e}function Da(a){var b,c,d=a[0].type,e=0,f=[a[0]];for(b=1;b<a.length;b++)c=a[b],d===X&&c.type===X?f[e].value+=c.value:(f.push(c),d=c.type,e++);return f}function Ea(a,b,c,d,e){var f;return f=d?Math.floor(b/e):Math.floor(b/z(a,a.font,c)),Array(f+1).join(c)}function Fa(a){var b=a.clone();return b.width--,b.height--,b}function Ga(a,b,c,d){var e,f,h;for(e=0;e<a.length;e++)f=void 0,a[e].style=a[e].style||{},h=a[e].style,f=h.font?g.To.No(h.font,c).font:"object"==typeof b?b.font:b,r(d)||(f=g.To.No(f,d).font),h.font=f}function Ha(a,b,c,d,e){var g=c*R(-d)+e*Q(-d),h=c*R(-d)+e*Q(-d),i=a-g/2,j=b-h/2;return new f.Rect(i,j,g,h)}function Ia(a,b,c,d){C(c.decoration)||c.decoration.cornerFold&&Ja(a,b,c.decoration.cornerFold,d)}b.paintDecoration=Ia;function Ja(a,b,c,d){var e,f,g,i,j,k,l,m,n,o,p,q,r=c.size,s=c.position,t=c.color;C(r)&&(r=6),C(s)&&(s=h.CornerPosition.leftTop),e=b.x,f=b.y,g=b.height,i=b.width,j=d.sheet,k=r*j.zoom(),a&&i>0&&g>0&&(a.save(),a.rect(e,f,i,g),a.clip(),a.fillStyle=t||"#FF3D00",a.beginPath(),a.fillStyle=t,l=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,s&h.CornerPosition.leftTop&&(l=e,m=f,n=e,o=m+k,p=l+k,q=m,a.moveTo(l,m),a.lineTo(n,o),a.lineTo(p,q),a.fill()),s&h.CornerPosition.rightBottom&&(l=e+i,m=f+g,n=l,o=m-k,p=l-k,q=m,a.moveTo(l,m),a.lineTo(n,o),a.lineTo(p,q),a.fill()),s&h.CornerPosition.leftBottom&&(l=e,m=f+g,n=e,o=m-k,p=l+k,q=m,a.moveTo(l,m),a.lineTo(n,o),a.lineTo(p,q),a.fill()),s&h.CornerPosition.rightTop&&(l=e+i,m=f,n=l,o=m+k,p=l-k,q=m,a.moveTo(l,m),a.lineTo(n,o),a.lineTo(p,q),a.fill()),a.closePath(),a.restore())}},"./dist/core/celltype/cellType.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/core/celltype/celltype.ns.js")),d(c("./dist/core/celltype/basecelltype.js")),d(c("./dist/core/celltype/textcelltype.js")),d(c("./dist/core/celltype/headercelltype.js"))},"./dist/core/celltype/celltype.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b._o={}},"./dist/core/celltype/headercelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/stylehelper.js"),h=c("./dist/core/celltype/celltype.ns.js"),i=c("./dist/core/celltype/basecelltype.js"),j=c("./dist/core/core.enum.js"),k=f.Im,l=f.Vn,m=f.Ul.wl,n=f.Ul.uWa,o=f.Ul.lZa,p=d.Common.j.Fa,q=f.Ul.K_a,r=e.GC$.extend,s="none",t=void 0,u=Math.floor,v=f.Rect;function A(a,b){return a=a||0,k.Km(a,"gc-"+b+"-"+k.Jm(a))}function B(a,b,c,d,e,f){var g=new Image,h=f;h=h.replace('url("',""),h=h.replace('")',""),g.src=h,a.drawImage(g,b,c,d,e)}function C(a,b,c,d,e,f,h,k,l){var n,o,q,r,t,u,v,w,x,y,z,A,C;function D(){a.fillRect(b+1,c+1,d-1,e-1)}if(!p(k)){if(a.save(),a.beginPath(),n=f.backColor,0===k&&n)g.To.setFillStyle(a,n,b,c,d,e,D);else try{if(n=l&&l.backgroundColor,o=l&&l.backgroundImage,q=h.sheet,r=h.row,t=h.col,u=h.sheetArea,v=void 0,w=!1,q.cellStates&&k===j.VisualState.hover&&(v=q.cellStates.getStyle(r,t,u),v&&v.backColor&&(n=v.backColor,w=!0)),!w&&o&&o.indexOf("linear-gradient")!==-1){for(x=m(o),y={degree:90,stops:[]},z=0,A=x.length;z<A;z++)C=x[z],y.stops.push({position:C.point,color:C.color});g.To.setFillStyleGradient(a,y,b,c,d,e,D)}else n?(a.fillStyle=n,D()):o&&o!==s&&B(a,b+1,c+1,d-1,e-1,o)}catch(a){}2===h.columnHeaderFitMode&&(d=h.sheet.getColumnWidth(h.col)+1),i.Context.ap(a,b,c,d,e,f.backgroundImage,f.backgroundImageLayout,h.imageLoader),a.restore()}}function D(a,b,c,d,e,g,h,j,k,l,m,n){var o,p,q,r,s;b&&(o=k.visualState||0,p=A(o,l),C(b,d,e,g,h,j,k,o,p),i.Context.gp(b,d,e,g,h,j,l,p,m,k.needTopGridline,k.needLeftGridline),q=new f.Rect(d,e,g,h),a.kgc(b,k,q,c,j),i.paintDecoration(b,q,j,k),a.i5&&(a.i5(b,q,j,k),r=k.printZoomFactor,s=k.isPrinting&&"number"==typeof r&&1!==r?r:k.sheet.zoom(),q=a.f5(q,j,s)),q.width>0&&q.height>0&&a.paintContent(b,c,q.x,q.y,q.width,q.height,j,k,n))}function E(a,b,c,d,e,f){var h,i={font:b,fillStyle:c},j=d.sheet;return 0!==d.visualState&&parseInt(f.zIndex,10)>2007&&j.vp(d.row,d.col,e)&&(h=void 0,h=j.wp(d.row,d.col,e)?a(d.visualState,"gc-columnHeader-selected"):a(d.visualState,"gc-columnHeader-highlight"),i.fillStyle=h.color,i.font=g.To.Ro(i.font,"bold")),i}function F(a,b,c,d,e,g,h,i,k,l,m,n){var o,r,s,u,v,w,x,y,z={},A=a.format(q(c),i.formatter,z),B=k.sheet;A&&(b.save(),b.beginPath(),o=B.rowFilter&&B.rowFilter(),r=k.columnHeaderFitMode,s=!!(o&&o.Dl(k.row,k.col,l)&&o.filterButtonVisible(k.col)),!s&&!n||r!==j.ColumnHeaderFitMode.normal&&r!==j.ColumnHeaderFitMode.vertical||(p(k.cornerX)||(g=k.cornerX-d),g-=B.oK(new f.Rect(d,e,g,h),l).width),u=i.foreColor,u||(u=m.color),u&&b.fillStyle!==u&&(b.fillStyle=u),v=i.textOrientation,w=i.isVerticalText,x=0===r&&B.ODJ&&0!==v&&!p(v)&&-90<=v&&v<=90&&!w,c&&c.richText&&c.richText.length>0||w?G(a,B,b,c,d,e,g,h,i,A,z,k,l,m):1===r||x?(y=E(a.getThemeStyle,i.font||b.font,b.fillStyle,k,l,m),i.foreColor=y.fillStyle,i.font=f.util.hZa(y.font),1===r&&(i.textOrientation=-90),a.nHb(b,c,d,e,g,h,i,k,A,z,t,t)):H(a,b,c,d,e,g,h,i,A,z,k,l,m),b.restore())}function G(a,b,c,d,e,f,g,h,i,j,k,l,m,o){var p,s,u,w,x,y,z,A,B,C,D,F,G,H,K,L,M,N=new v(e,f,g,h),O=E(a.getThemeStyle,i.font||c.font,c.fillStyle,l,m,o),P=i.isVerticalText,Q=i.hAlign,R=J(i),S=a.T_a(i.formatter||i._autoFormatter,d.text),T=r(!0,[],a.U_a(d,j,S,O.font,O.fillStyle));if(d&&d.richText&&d.richText.length>0&&(p=l.sheet?l.sheet.zoom():1,s=l.printZoomFactor,s=l.isPrinting&&"number"==typeof s&&1!==s?s:t,a.V_a(T,O,p,s)),u=a.hgc(c,q(d),i,l,e,f,g,h),w=a.igc(u.externals.left),x=a.igc(u.externals.right),y=w+x,z={left:w,right:x},!i.wordWrap&&i.shrinkToFit&&a.W_a(T,g-y,h,i,O,1,P),A=a.X_a(c,j,i.font,P?h:g-y,R,P?i.vAlign:i.hAlign,i.wordWrap,P,T),B=a.Y_a(A,i,Q),I(c,i,e,f,g,h,R,A[0].textLength,B[0].lineHeight),C=P?n(j):t,D=!1,i.wordWrap||i.shrinkToFit||!i.showEllipsis||!P||d.richText||(D=!0),F=a.$_a(N.x,N.y,N.width,N.height,Q,i.vAlign,R,P,C,A,B,z,D),G=[],D&&k&&(k.content&&1===k.content.length&&"text"===k.content[0].type||!k.content&&1===A.length&&A[0].text)&&a.oHb(c,l,A,B,i,h,f,R,F,G),H=A.length,1===H&&k.content&&!S)a.__a(c,b,j,k,F[0].x,F[0].y,g,h,Q,i,N.width,N.height,R,P,A[0].textLength,l,z,N);else for(K=0;K<H;K++)L=a.ogc(A),M=F[0].x,"center"===c.textAlign?M-=L/2:"right"===c.textAlign&&(M-=L),a.mgc(c,i,l,M,F[0].y,L,0,N),a.a0a(c,b,F[K].x,F[K].y,B[K],Q,A[K],G[K]),a.mgc(c,i,l,M,F[0].x,L,0,N)}function H(a,b,c,d,e,f,h,i,k,m,n,q,r){var s,t,w,x,y,z,A,B,C,D,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da=new v(d,e,f,h),ea=n.columnHeaderFitMode,fa=E(a.getThemeStyle,i.font||b.font,b.fillStyle,n,q,r);if(o(b,fa.font),b.fillStyle=fa.fillStyle,s=0,t=i.textIndent,t>0&&(s=8*t),w=parseInt(n.fontInfo.fontSize,10),x=i.hAlign,y=i.vAlign,z="left",A=2,B=a.hgc(b,k,i,n,d,e,f,h),C=a.igc(B.externals.left),D=a.igc(B.externals.right),F=C+D,G={left:C,right:D},A+=s+C,ea!==j.ColumnHeaderFitMode.stack||p(n.cornerX)||(h=n.cornerY-e,H=n.colStyle,(!H||H&&p(H.hAlign))&&(x=0)),1===x?(A=(f+C-D)/2,z="center"):2===x&&(A=f-D-1,A-=s,z="right"),b.textAlign!==z&&(b.textAlign=z),I=0,J="alphabetic",K=2,L=i.wordWrap,M=i.shrinkToFit,N=i.font,O=n.lineHeight,P=[],Q=0,!L&&M)for(R=0,S={value:!1},T=0;T<3&&S.value===!1&&(U=b.measureText(k).width,R=Math.max(0,f-4-(1===x?0:s)),R<U);T++)N=g.To.No(N,R/U,S,!0).font,o(b,N);if(V=0,L&&(V=f-F-3-s,V-=1,P=l.Wn(k,V,fa.font),Q=P.length,Q>1&&0!==y&&(I=(Q-1)*O)),W=w>8?u((w-8)/5+2):1,X=O/2-w/2+W-1,!L&&i.showEllipsis&&a.rHb(n,m,k,b,f,x,s),K+=O-X,1===y?K=(h-I)/2+O/2-X:2===y&&(K=h-I-2-X),b.textBaseline!==J&&(b.textBaseline=J),Y=i.textDecoration,Z=da.x,$=da.y,_=da.width,aa=da.height,i.wordWrap)if(b.rect(Z,$,_,aa),b.clip(),b.beginPath(),ba=e+K,Q>1){for(a.mgc(b,i,n,d+A,ba,V,O*Q,da),T=0;T<Q;T++)b.fillText(P[T],d+A,ba),Y&&(U=b.measureText(P[T]).width,a.ip(b,Y,d+A,ba,U,w,W)),ba+=O;a.mgc(b,i,n,d+A,ba,V,O*Q,da)}else a.Oja(b,k,m,d+A,e+K,x,_,s,Y,W,w,n,i,G,da);else ca=b.measureText(k).width,(ca>_||O>aa)&&(b.rect(Z,$,_,aa),b.clip(),b.beginPath()),a.Oja(b,k,m,d+A,e+K,x,_,s,Y,W,w,n,i,G,da,void 0,void 0,i.showEllipsis)}function I(a,b,c,d,e,f,g,h,i){var j=!1;j=!!b.wordWrap||(b.isVerticalText?h+g>f||i>e:h+g>e||i>f),j&&(a.rect(c,d,e,f),a.clip(),a.beginPath())}function J(a){var b=0,c=a.textIndent;return c>0&&(b=8*c),b}w=function(a){z(b,a);function b(){var b=a.call(this)||this;return b.typeName="2",b}return b.prototype.paint=function(a,b,c,d,e,f,g,h,i){D(this,a,b,c,d,e,f,g,h,"columnHeader",1,i)},b.prototype.paintContent=function(a,b,c,d,e,f,g,h,j){var k,l=i.Context.oDc(a,q(b),c,d,e,f,h);l||(k=A(h.visualState,"columnHeader"),F(this,a,b,c,d,e,f,g,h,1,k,j))},b}(i.Base),b.ColumnHeader=w,h._o[2]=w,x=function(a){z(b,a);function b(){var b=a.call(this)||this;return b.typeName="3",b}return b.prototype.paint=function(a,b,c,d,e,f,g,h){D(this,a,b,c,d,e,f,g,h,"rowHeader",2)},b.prototype.paintContent=function(a,b,c,d,e,f,g,h){var j,k=i.Context.oDc(a,q(b),c,d,e,f,h);k||(j=A(h.visualState,"rowHeader"),F(this,a,b,c,d,e,f,g,h,2,j))},b}(i.Base),b.RowHeader=x,h._o[3]=x,y=function(a){z(b,a);function b(){var b=a.call(this)||this;return b.typeName="4",b}return b.prototype.paint=function(a,b,c,d,e,f,g,h){var i,j,l,n,o,p,q,r,t,u,v,w,x,y,z,A,C;if(a){a.save(),a.rect(c,d,e,f),a.clip(),a.beginPath(),i=this,j=h.visualState||0;try{l=i.getThemeStyle(h.visualState,"gc-corner-"+k.Jm(j)),n=l&&l.backgroundColor,o=l&&l.backgroundImage,n?(a.fillStyle=n,a.fillRect(c,d,e,f)):o&&o!==s&&B(a,c,d,e,f,o)}catch(a){}if(p=i.getThemeStyle(4,"gc-corner-triangle-"+k.Jm(j)),q=p&&p.backgroundImage,r=p&&p.backgroundColor,t=a.createLinearGradient(c+e/2,d,c+e/2,d+f),q&&q.indexOf("linear-gradient")!==-1){for(u=m(q),v=0,w=u.length;v<w;v++)x=u[v],t.addColorStop(x.point,x.color);a.fillStyle=t}else r&&(t.addColorStop(.125,"#f6fafb"),t.addColorStop(1,r),a.fillStyle=t);y=a.createLinearGradient(c+e,d+1,c+e,d+f-2),y.addColorStop(0,p.borderLeftColor),y.addColorStop(1,p.borderRightColor),a.beginPath(),a.strokeStyle=y,a.moveTo(c+e-.5,d),a.lineTo(c+e-.5,d+f),a.stroke(),h.needLeftGridline&&(a.beginPath(),a.strokeStyle=p.borderLeftColor,a.moveTo(c+.5,d),a.lineTo(c+.5,d+f),a.stroke()),z=a.createLinearGradient(c,d,c+e-2,d),z.addColorStop(0,p.borderTopColor),z.addColorStop(1,p.borderBottomColor),a.beginPath(),a.strokeStyle=z,a.moveTo(c,d+f-.5),a.lineTo(c+e,d+f-.5),a.stroke(),h.needTopGridline&&(a.beginPath(),a.strokeStyle=p.borderTopColor,a.moveTo(c,d+.5),a.lineTo(c+e,d+.5),a.stroke()),a.beginPath(),A=3,C=f,e<f&&(C=e),a.moveTo(c+e-C+A,d+f-A),a.lineTo(c+e-A,d+f-A),a.lineTo(c+e-A,d+f-C+A),a.fill(),a.restore()}},b}(i.Base),b.Corner=y,h._o[4]=y},"./dist/core/celltype/textcelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),h=c("./dist/core/celltype/celltype.ns.js"),i=c("./dist/core/celltype/basecelltype.js"),j=c("./dist/core/core.enum.js"),k=c("./dist/core/util/common.js"),l=d.Common.j.Fa,m=g.Vn,n=g.Events.EditChange,o=g.Vl,p=g.Ul,q=g.uHb,r=p.lHb,s=p.Nl,t=p.Ml,u=t.msie,v=t.edge,w=t.chrome,x=p.nl,y=p.ol,z=p.Il,A=p.vl,B=p.rl(),C=p.fp,D=p.Voa,E=p.pL,F=p.Ika,G=p.hZa,H=p.K_a,I=p.Fxb,J="left",K="right",L="center",M="top",N="gcUIElement",O="none",P=".gcEditingInput",Q="gcEditingInput",R="width",S="height",T="text-align",U="hidden",V="word-wrap",W="overflow",X="vertical-align",Y="normal",Z="break-word",$="overflow-y",_="scroll",aa="word-break",ba="float",ca=window,da=document,ea=.337,fa=B.ipad,ga=B.iphone||fa||B.android,ha=null,ia=void 0,ja=Math.ceil,ka=Math.min,la=Math.sin,ma=Math.cos,na=Math.abs,oa=Math.max,pa=parseInt,qa="\xa0",ra="\u200b",sa="string",ta="number";function xa(a){return ga||0===a}function ya(a){return xa(a)?f.GC$(s("textarea")):f.GC$(s("div"))}function za(a){return a&&"DIV"===a.tagName&&"true"===a.contentEditable}function Aa(a){return za(a)?u&&parseFloat(t.version)<10?p.Woa(a):a.innerText:a.value}function Ba(a,b){za(a)?a.innerText=l(b)?"":b:a.value=b}function Ca(a){if(za(a)){var b=ca.getSelection();b.selectAllChildren(a),b.rangeCount>0&&b.collapseToEnd()}else a.selectionStart=a.selectionEnd=a.value.length}function Da(a){var b,c;return za(a)?(b=ca.getSelection(),b.rangeCount>0?(c=b.getRangeAt(0),c.startOffset):0):a.selectionStart}function Ea(a){var b,c;return za(a)?(b=ca.getSelection(),b.rangeCount>0?(c=b.getRangeAt(0),c.endOffset):0):a.selectionEnd}function Fa(a){var b=a.keyCode,c=a.shiftKey,d={106:42,107:43,109:45,110:46,111:47,173:45},e={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39},f={186:58,187:43,188:60,189:95,190:62,191:63,192:126,219:123,220:124,221:125,222:34},g=b;return b>=96&&b<=105?g=b-48:d[b]?g=d[b]:c&&f[b]?g=f[b]:!c&&e[b]?g=e[b]:!c&&b>=65&&b<=90&&(g=b+32),g}function Ga(a){return a&&"BR"===a.tagName}function Ha(a){return a&&"SPAN"===a.tagName}function Ia(a){return a&&"DIV"===a.tagName}function Ja(a){return a instanceof Text}function Ka(a){return a===ra}function La(a,b,c,d){var e=a.substr(0,b),f=a.substr(c,a.length-c);return e+d+f}function Ma(a,b,c,d,e,f){var g,h,i,j,k,l="",m=a.childNodes,n=m.length;for(g=0;g<n;g++)h=m[g],Ha(h)?l+=Ma(h,b,c,d,e,f):Ja(h)?(i=b&&b.startContainer,j=b&&b.endContainer,k=h.textContent,h===i||h===j?i!==j?h===i?(l+=La(k,c,k.length,e),f=!0):(l+=La(k,0,d,""),f=!1):l+=La(k,c,d,e):f||(l+=k)):Ga(h)&&!f&&(l+="\n");return l}function Na(a,b,c,d,e){var f,g,h=String.fromCharCode(Fa(e));return za(a)?(f=ca.getSelection(),f.rangeCount>0&&(g=f.getRangeAt(0),Ja(g.startContainer))?Ma(a,g,c,d,h):g&&g.startOffset===g.endOffset?b+h:h):La(b,c,d,h)}function Oa(a){var b=Sa(a);return b&&b.indexOf(" ")>=0&&(b=F(b," ",qa)),b}function Pa(a,b,c,d,f,g){var h,i,j,k,l,m,n,p,q,r,s,t=a.srcElement||a.target;t&&t.getAttribute(N)===Q&&13===a.keyCode&&(a.ctrlKey||a.altKey)&&(h=o.Xl(),h instanceof e.Worksheet&&(i=h.getCellType(h.Jl,h.Kl),i&&(za(t)?(c&&(t.blur(),t.focus()),j=ca.getSelection(),j.rangeCount>0&&(k=j.getRangeAt(0),l=da.createElement("br"),m=da.createTextNode(ra),k.insertNode(m),k.insertNode(l),Qa(k),n=da.createRange(),n.setStartAfter(m),n.setEndAfter(m),n.collapse(!1),j.removeAllRanges(),j.addRange(n))):(p=t.selectionStart,q=t.value,r=q.substr(0,p),s=q.substr(p,q.length-p),t.value=r+"\n"+s,t.selectionStart=p+1,t.selectionEnd=p+1),i.SCc(h.BF,ha,ha,a,b,!0))),x(a))}function Qa(a){var b,c=a.endContainer,d=c.lastChild;Ja(d)&&0===d.textContent.length&&c.removeChild(d),d=c.lastChild,b=d.previousSibling,Ka(d.textContent)&&!Ga(b)&&0===b.textContent.length&&c.removeChild(b)}function Ra(a){var b,c=a;return c?c.indexOf(ra)<0&&c.indexOf("\n")<0?c:(b=a.split("\n"),b.forEach(function(a,b,c){Ka(a[0])&&(c[b]=a.substr(1))}),b.join("\n")):c}function Sa(a){var b,c=a;return c?(b=c.length,b>0&&(c=c.replace(/\n/g,"\n"+ra)),c):c}function Ta(a){var b,c,d,e,f,g,h,i,j,k,l=ca.getSelection(),m=!1,n=0,o=0,p="";if(l.rangeCount>0){if(b=l.getRangeAt(0),
c=Da(a),d=Ea(a),e=b.startContainer,f=b.endContainer,Ia(e))m=!0,n=c;else if(g=e.childNodes,h=g.length,i=void 0,h>0)for(i=0;i<h;i++){if(j=g[i],!j.tagName||"br"!==j.tagName.toLocaleLowerCase()){e=j;break}p+="\n"}return Ia(f)&&(o=d),k=Ua(a,c,d,e,f,m,n,o),p+k.content}}function Ua(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o;if(d===e&&!f)return{content:Ra(d.textContent.slice(b,c))};for(i="",j=g,m=a.childNodes,n=h||m.length,j;j<n;j++)if(o=m[j],Ha(o)){if(k=Ua(o,b,c,d,e,f,0,0),i+=k.content,k.startFlag&&(f=!0),k.endFlag){l=!0;break}}else if(Ja(o)&&o===d)i+=o.textContent.slice(b,o.textContent.length),f=!0;else{if(Ja(o)&&o===e){i+=o.textContent.slice(0,c),l=!0;break}f&&(i+=Ga(o)?"\n":o.innerText||o.textContent)}return{content:Ra(i),startFlag:f,endFlag:l}}function Va(a,b){var c,d=a.length,e=[];for(c=0;c<d;c++)e.push(D(a[c],b));return e}function Wa(a){var b,c=a.length,d=0;for(b=0;b<c;b++)d+=a[b];return d}function Xa(a,b,c,d){var e,f,g=0,h=c;for(e=0;e<a.length;e++)w&&(h=d[e]),a[e]>b?(f=ja(a[e]/b),g+=h*f):g+=h;return g}function Ya(a,b,c){var d=Aa(a);return d&&"="===d[0]||""===d&&"="===b[0]||0===c&&"="===b[0]}!function(a){a[a.textarea=0]="textarea",a[a.editableDiv=1]="editableDiv"}(ua=b.EditorType||(b.EditorType={})),va=function(a){wa(b,a);function b(b){var c=a.call(this)||this;return c.allowOverflow=!0,c.typeName="1",c.editorType=l(b)?1:b,c}return b.prototype.getText=function(a,b){return a},b.prototype.paintValue=function(a,b,c,d,e,f,g,h){var l,m,n,o,p,q,s,t,u,v,w,x,z,A,B,C,D,E,F,G,J,K,L=this,M=h.sheet,N=M.zoom?M.zoom():1;if(b=L.getText(b,h),l={},h.quotePrefix=g.quotePrefix,n=g.formatter,o=n&&"General"!==n,p=r(n),"string"==typeof n&&(o=o&&!p),q=g.textOrientation,s=g.textIndent&&0!==g.textIndent,t=g.isVerticalText,u=e,q&&-90<=q&&q<=90&&!s&&!t&&(v=na(q*Math.PI/180),u=(f-h.lineHeight*ma(v))/la(v)),x=L.hgc(a,m,g,h,c,d,e,f),w=x.externals,z=L.igc(w.left),A=L.igc(w.right),B=g.hAlign,3===B&&(B=y(B,b,g.formatter)),2===B?u-=A:0===B&&(u-=z),C=g._autoFormatter&&g._autoFormatter.formatCached&&"General"!==g._autoFormatter.formatCached,o?D=g.formatter:C?D=g._autoFormatter:M.parent&&M.parent.options.numbersFitMode===j.NumbersFitMode.mask?D=i.Context.Ixb(a,b,u,g,N):M.parent&&M.parent.options.numbersFitMode===j.NumbersFitMode.overflow&&(D=g._autoFormatter),m=p&&(b instanceof Date||"boolean"==typeof b||b instanceof Boolean||"number"==typeof b)?L.format(b,n,{}):L.format(H(b),D,l,h),E=new k.Rect(c,d,e,f),this.adjustRectForIconSet(g.hAlign,h.sheet,h.row,h.col,h.sheetArea,E,l.content&&this.hasInfilling(l.content)),c=E.x,e=E.width,g.shrinkToFit!==!0&&!t)if(I(b)){if(M.parent){switch(F=m,M.parent.options.numbersFitMode){case j.NumbersFitMode.mask:F=this.NCc(a,m,u,g,N,h,l,M);break;case j.NumbersFitMode.overflow:F=this.Klb(a,h,b,g,M,m,l)}m=F}}else void 0===M.ITa.AIb(h.row,h.col,h.sheetArea)||g.showEllipsis||M.ITa.qHb(h.row,h.col,void 0,h.sheetArea);return G=g.labelOptions,J=g.watermark,K=!G||0!==G.visibility,J&&!m&&K?void L.paintText(a,J,c,d,e,f,g,h,J,l,ea):void((m||l.content&&l.content.length)&&L.paintText(a,b,c,d,e,f,g,h,m,l,ia,w))},b.prototype.NCc=function(a,b,c,d,e,f,g,h){var j=f.cellOverflowLayout&&f.cellOverflowLayout.expandedWidth,k=i.Context.Lxb(a,b,l(j)?c:j,d,e),m=f.row,n=f.col;return b!==k?(delete g.content,d.textIndent=0,h.ITa.qHb(m,n,h.getText(m,n,f.sheetArea),f.sheetArea)):h.ITa.qHb(m,n,void 0,f.sheetArea),k},b.prototype.Klb=function(a,b,c,d,e,f,g){var h,i,j,k,l,m=b.row,n=b.col;if(d.wordWrap&&(d.wordWrap=!1),h=E(a,d.font,f),i=e.ss._m(n),j=b.cellOverflowLayout,k=void 0,!j&&i<h)k=e.getText(m,n,b.sheetArea);else if(j&&i<h&&this.HDc(j.backgroundWidth)&&this.HDc(j.valueWidth)){if(!this.HDc(d.hAlign))return;l=void 0,l=1!==d.hAlign?j.valueWidth>j.backgroundWidth:j.valueWidth/2>j.backgroundLeftWidth||j.valueWidth/2>j.backgroundRightWidth,k=l?e.getText(m,n,b.sheetArea):void 0}return e.ITa.qHb(m,n,k,b.sheetArea),f},b.prototype.HDc=function(a){return null!==a&&void 0!==a},b.prototype.createEditorElement=function(a,b){var c,d,e=a&&a.sheet&&a.sheet.parent&&a.sheet.parent.qo,g=A(e)+1e3;return f.GC$(b).css("z-index",g),c=ya(this.editorType),f.GC$(c).css({font:"normal 11pt calibri",outline:O,resize:O,border:O,"vertical-align":"top","min-height":"0px","box-sizing":"content-box",background:"transparent"}).css(V,Y).attr({tabindex:-1,autocomplete:"off",contenteditable:!0}).css(W,U).attr(N,Q),t.safari&&f.GC$(c).css("-webkit-user-select","auto"),d=za(f.GC$(c)[0]),d&&(f.GC$(c).css("display","table-cell"),f.GC$(c).css(aa,Y)),f.GC$(c)[0]},b.prototype.getEditorValue=function(a,b){var c,d;return a&&(c=Aa(a),!l(c)&&c.length>0)?(d=Ra(c),d=d.replace(/\r\n?/g,"\n"),d.indexOf(qa)<0?d:F(d,qa," ")):ha},b.prototype.setEditorValue=function(a,b,c,d){var e,f;a&&(e=c&&c.sheet&&c.sheet.HF,f=Oa(b),u?e&&c.isImeInput||Ba(a,l(f)?d?"%":"":f):Ba(a,e?d?"%":"":f))},b.prototype.selectAll=function(a,b){if(a&&a.select)a.select();else{var c=ca.getSelection();c.selectAllChildren(a)}},b.prototype.focus=function(a,b){this.isImeAware()&&a?(a.focus(),Ca(a)):a.parentNode.parentNode.focus()},b.prototype.kp=function(a,b,c,d){var e=a&&d&&d.sheet,f={},g=z(b,c,e,d,f);return a.oja=f.formatter||ia,g},b.prototype.activateEditor=function(a,b,c,d,e,g,h){var i,j,k,m,o=d&&d.sheet;o&&(i=this,j=a,j&&(k=f.GC$(j),m=za(j),i._editingElement=j,k.attr(N)||k.attr(N,Q),B.android&&k.bind("input"+P,function(a){try{i.SCc(j,b,c,a,d,!1,e,g,h)}catch(a){}}),k.bind("keydown"+P,function(a){var f,k;try{f=a.keyCode,m&&(8===f?q.processBackspaceAndLeftArrowKeyEvent(a,!0):46===f?q.processDeleteAndRightArrowKeyEvent(a,!0):37===f?q.processBackspaceAndLeftArrowKeyEvent(a,!1):39===f&&q.processDeleteAndRightArrowKeyEvent(a,!1)),k=229===f||0===f,(!k&&!i.kK||B.android)&&i.SCc(j,b,c,a,d,!0,e,g,h),Pa(a,d,i.kK,e,g,h)}catch(a){}}),k.bind("keyup"+P,function(a){var k=a.keyCode,l=a.ctrlKey,p=a.altKey,q=229===k||0===k;(!q&&!i.kK||B.android)&&(46!==k&&8!==k&&(90!==k&&89!==k||!l||p)||(m&&"\n"===j.innerText&&f.GC$(j).empty(),i.SCc(j,b,c,a,d,!1,e,g,h)),(13!==k&&9!==k&&27!==k&&16!==k||l||p)&&o.Wq(n,{sheet:o,sheetName:o.name(),row:o.Jl,col:o.Kl,editingText:i.getEditorValue(j,d)}))}),k.bind("mousedown"+P,function(){1===o.Px&&(o.Px=2,o.Cu(1,2))}),k.bind("textInput"+P,function(a){if(a.data&&(i.probabilityAddPercentSpec||i.probabilityAddPercent)&&/^[0-9]+.?[0-9]*/.test(a.data)){var b=document.createElement("span");b.innerText="%",b.id="updateEditorImpAddPercent","#text"===j.firstChild.nodeName?j.appendChild(b):j.firstChild.appendChild(b),delete i.probabilityAddPercentSpec,delete i.probabilityAddPercent}}),k.bind("compositionstart"+P,function(){i.kK=!0,i.nK=Aa(j)}),k.bind("compositionupdate"+P,function(a){i.SCc(j,b,c,a?a:ha,d,!0,e,g,h)}),k.bind("compositionend"+P,function(a){var f,k,l,m;i.SCc(j,b,c,a?a:ha,d,!1,e,g,h),i.kK=!1,f=a.keyCode,k=a.ctrlKey,l=a.altKey,m=i.getEditorValue(j,d)||"",i.nK!==m&&(f===ia||13!==f&&9!==f||k||l)&&o.Wq(n,{sheet:o,sheetName:o.name(),row:o.Jl,col:o.Kl,editingText:m})}),m&&(k.bind("copy"+P,function(a){var b=ca.clipboardData,c=a.clipboardData,d=Ta(a.currentTarget);l(d)||(b&&b.setData?(b.setData("text",d),x(a)):c&&c.setData&&(c.setData("text/plain",d),x(a)))}),k.bind("paste"+P,function(a){var f,k,l,n,o,p,q,r,s=!1;if(m)try{f=void 0,u&&!v&&ca.clipboardData&&ca.clipboardData.getData?f=ca.clipboardData.getData("text"):a.clipboardData&&a.clipboardData.getData&&(f=a.clipboardData.getData("text/plain")),f=f.replace(/\r\n?/g,"\n"),f=Oa(f),k=ca.getSelection(),k.rangeCount>0&&(l=k.getRangeAt(0),n=l.startOffset,o=l.endOffset,n!==o&&l.deleteContents(),Ya(j,f,n)||(p=da.createElement("span"),f=f.replace(/\u200B/g,""),q=f.length,"\n"===f[q-1]&&(f="\r"===f[q-2]?f.substr(0,q-2):f.substr(0,q-1)),p.innerText=f,l.insertNode(p),r=document.createRange(),r.setStartAfter(p),r.setEndAfter(p),r.collapse(!1),k.removeAllRanges(),k.addRange(r),s=!0))}catch(a){}if(i.mK=ca.setTimeout(function(){i.SCc(j,b,c,a,d,!1,e,g,h),i.mK&&(clearTimeout(i.mK),delete i.mK)},10),s)return!1}))))},b.prototype.deactivateEditor=function(a,b){var c,d,e,g,h,i,j,k,l,m=this;if(a&&b&&b.sheet){if(c=b.sheet,m.kK&&fa&&c.CH)try{f.GC$(a).trigger("compositionend"+P)}catch(a){}if(d=c.getActualStyle(b.row,b.col,b.sheetArea).cellPadding)for(e=[J,M],g=[3,0],h=0;h<e.length;h++)i=parseInt(Za(d)[g[h]],10),i=typeof i===ta&&i>0?i:0,m.shiftPadding(a,e[h],i);f.GC$(a).unbind(P),j=c.getActiveRowIndex(),k=c.getActiveColumnIndex(),l=c.getActualStyle(j,k),c.KF(m,a,j,k,l,ia,ia,ia,ia,b.sheetArea)}m._editingElement=ha},b.prototype.shiftPadding=function(a,b,c){var d=f.GC$(a).parent();d&&(b===J?d.css({left:(+f.GC$(d).css(J).replace("px","")||0)-c}):b===M&&d.css({top:(+f.GC$(d).css(M).replace("px","")||0)-c}))},b.prototype.getEditingElement=function(){return this._editingElement},b.prototype.lK=function(a,b,c,d,e,g,h,j,n){var o,p,q,r,s,t,v,x,z,A,B,D,E,F,H,I,M,N,P,Q,ca,da,ea,fa,ga,ha,ia,la,ma,na,qa,ra,sa,ta,ua,va,wa,xa,ya,Ba=e&&e.sheet,Ca=this,Fa=Ba.options.sheetAreaOffset,Ga=a;if(Ga&&Ba&&(o=f.GC$(Ga),p=Ba.yl,q=e.preventOverflow,r=Aa(Ga),Ba.isEditing())){if(s=za(Ga),t=void 0,v=J,x=void 0,z=i.Context.u5,A=0,B=0,D=0,E=0,b&&(F=Ba.zoom(),A=z(b,0,!1,F),B=z(b,1,!1,F),D=z(b,2,!1,F),E=z(b,3,!1,F),t=y(b.hAlign,a.LF),1===t?v=L:2===t&&(v=K),o.css(T,v),b.foreColor&&o.css("color",b.foreColor),x=b.font||p.Bl(),x&&(Ba.zoom()>1&&(x=p.Cl(x)),o.css("font",G(x))),b.textDecoration&&Ca.lp(o,b.textDecoration)),H=(pa(o.css("padding-left"),10)||0)+(pa(o.css("padding-right"),10)||0),I=(pa(o.css("padding-top"),10)||0)+(pa(o.css("padding-bottom"),10)||0),c||(H+=2*+o.parent().css("left").replace("px",""),I+=2*+o.parent().css("top").replace("px","")),l(h)&&(h=c),h&&(M=Ba.am(),N=c.width,h.x+h.width-Fa.left>M.width&&(c.width=M.width-c.x,h.width=M.width-h.x),o.css(R,N-H).css(S,c.height-I),Ga.maxWidth=Fa.left+M.width-c.x-H-B,o.css("max-width",Ga.maxWidth+"px"),Ga.maxHeight=Fa.top+M.height-c.y-I-D,Ga.minWidth=pa(Ga.style.width,10),Ga.minHeight=pa(Ga.style.height,10)),P=Da(Ga),Q=Ea(Ga),g=g&&d&&d.keyCode&&Ba.mm.LH(d)&&0===P&&Q===r.length,g=g||Ba.HF,ca=g?"":r,x=Ga.style.font,x||(x=p.Cl(p.Bl())),da=C(x),d&&Ca.probabilityAddPercent&&(ea=d.key,ea&&k.NUMBER_ARRAY.indexOf(ea)!==-1&&(Ba.parent.options.enableFormulaTextbox?(ga=Ga.innerText,/[a-z]/i.test(ga)?Ca.probabilityAddPercent=!1:(fa=document.createElement("span"),fa.innerText="%",fa.id="updateEditorImpAddPercent",Ga.appendChild(fa),delete Ca.probabilityAddPercent)):(fa=document.createElement("span"),fa.innerText="%",fa.id="updateEditorImpAddPercent",Ga.firstChild.appendChild(fa),delete Ca.probabilityAddPercent))),!g&&d&&(Ba.mm.LH(d)&&8!==d.keyCode&&(ca=Na(Ga,ca,P,Q,d)),Ca.kK&&(ca=u?r:Ca.nK+d.data)),ha=[],ha=b&&b.wordWrap?m.Wn(ca,pa(Ga.style.width)-H,x):ca.split(/\r\n|\r|\n/),ia=void 0,la=void 0,ma=ha.length,Ga.minWidth=ka(Ga.minWidth,Ga.maxWidth),Ga.minHeight=ka(Ga.minHeight,Ga.maxHeight),b&&b.wordWrap||ma>0){if(na=void 0,qa=void 0,w?(qa=Va(ha,x),na=Wa(qa)):na=ma*da,b&&b.wordWrap)o.css(V,Z).css(W,U).css("max-width",Ga.style.width);else{for(ra=0,sa=[],ia=0;ia<ma;ia++)la=ja(Ba.rt(ha[ia],x)),sa.push(la),ra=oa(ra,la);ta=o.css(V),ua=pa(Ga.style.width),b||ta!==Z?ra<=Ga.minWidth?(o.css(R,Ga.minWidth).css(V,Y).css(W,U),s&&o.css(aa,Y)):ra>Ga.minWidth&&ra<=Ga.maxWidth&&!q?(o.css(R,ra).css(V,Y).css(W,U),s&&o.css(aa,Y)):ra>Ga.maxWidth&&!q&&(o.css(R,Ga.maxWidth-2).css(V,Z).css(W,U),na=Xa(sa,Ga.maxWidth,da,qa)):ra>ua&&!q&&(na=Xa(sa,ua,da,qa))}na<=Ga.minHeight?o.css(S,Ga.minHeight).css(ba,O):na>Ga.minHeight&&na<=Ga.maxHeight?o.css(S,na).css(ba,O):na>Ga.maxHeight&&o.css(S,Ga.maxHeight-1).css($,_).css(ba,J)}return t=o.css(T),va=o.width()-Ga.minWidth,l(t)||t===J||(t===L?o.css(J,Ga.originalLeft-va/2):t===K&&o.css(J,Ga.originalLeft-va)),b&&s&&(wa=b.vAlign,1===wa?o.css(X,"middle"):2===wa&&o.css(X,"bottom")),xa=pa(Ga.style.height)+I+A+D,ya=H+E+B,o.css($)===_?{width:Ga.offsetWidth+ya,height:g?0:xa}:{width:pa(Ga.style.width)+ya,height:xa}}},b.prototype.updateEditor=function(a,b,c,d,e,g,h){var i,j,m;return c=this.lK(a,b,c,ha,d,!1,e,g,h),u&&a&&(i=f.GC$(a),j=i[0].style.width,i.width(j+1).width(j)),!l(c)&&a&&(m=new k.Rect(a.style.left?parseFloat(a.style.left):0,a.style.top?parseFloat(a.style.top):0,c.width,c.height)),m},b.prototype.SCc=function(a,b,c,d,e,g,h,i,j){if(c=this.lK(a,b,c,d,e,g,h,i,j),u&&a){var k=f.GC$(a),m=k[0].style.width;k.width(m+1).width(m)}!l(c)&&a&&(l(h)?h=c:(h.x=ia,h.y=ia),this.updateEditorContainer(a,c,b,e,h,i,j))},b.prototype.updateEditorContainer=function(b,c,d,e,g,h,i){var j,k,l;e&&e.preventOverflow?(a.prototype.updateEditorContainer.call(this,b,c,d,e,g,h,i),j=b.parentNode,j&&c&&(k=f.GC$(j),l=c.width,l>0&&k.width(l))):(c&&c.width&&g&&g.width&&(g.width=c.width),c&&c.height&&g&&g.height&&(g.height=c.height),a.prototype.updateEditorContainer.call(this,b,c,d,e,g,h,i))},b.prototype.updateImeMode=function(a,b,c){this.isImeAware()&&a&&i.Context.hp(a,b)},b.prototype.isReservedKey=function(a,b){var c=a.srcElement||a.target,d=a.keyCode,e=a.ctrlKey,f=a.altKey,g=a.metaKey;return!!(c&&b&&b.isEditing&&c.getAttribute(N)===Q)&&(13===d&&(e&&!a.shiftKey||f)||90===d&&e&&!f||89===d&&e&&!f||67===d&&(e||g)&&!f||88===d&&(e||g)&&!f)},b.prototype.isImeAware=function(a){return!0},b.prototype.toJSON=function(){var a,b={},c=this;for(a in c)c.hasOwnProperty(a)&&"_editingElement"!==a&&(b[a]=c[a]);return b},b}(i.Base),b.Text=va;function Za(a){var b,c,d,e,f=["0","0","0","0"];return typeof a===sa&&(b=a.split(" ",4),c=b.length,d=void 0,e=void 0,1===c?(d=b[0],f=[d,d,d,d]):2===c?(d=b[0],e=b[1],f=[d,e,d,e]):3===c?(e=b[1],f=[b[0],e,b[2],e]):4===c&&(f=[b[0],b[1],b[2],b[3]])),f}h._o[1]=va},"./dist/core/core.definition.js":function(a,b){},"./dist/core/core.entry.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j;function k(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),c("./dist/core/core.res.en.js"),k(c("./dist/core/core.ns.js")),k(c("./dist/core/core.interface.js")),k(c("./dist/core/core.enum.js")),k(c("./dist/core/util/common.js")),k(c("./dist/core/excel-io-util/common.js")),k(c("./dist/core/excel-io-util/excel-types.js")),k(c("./dist/core/excel-io-util/range-parser.js")),k(c("./dist/core/excel-io-util/excel-helper.js")),k(c("./dist/core/excel-io-util/excel-style.js")),k(c("./dist/core/util/domUtil.js")),c("./dist/core/core.definition.js"),d=c("./dist/core/util/common.js"),Object.defineProperty(b,"getTypeFromString",{set:function(a){d.getTypeFromString=a},get:function(){return d.getTypeFromString}}),e=c("./dist/core/lc/releaseLc.js"),f=e.Soa,g=-1,1===f&&(g=Math.floor(5*Math.random()),b["G".concat("C","$")]["s".concat("d")]=g),k(c("./dist/core/util/theme.js")),k(c("./dist/core/util/basedialog.js")),k(c("./dist/core/util/imageLoader.js")),k(c("./dist/core/util/tasks.js")),0===g&&c("./dist/core/lc/lcRegister.js"),k(c("./dist/core/worksheet/stylehelper.js")),1===g&&c("./dist/core/lc/lcRegister.js"),k(c("./dist/core/worksheet/style.js")),2===g&&c("./dist/core/lc/lcRegister.js"),k(c("./dist/core/worksheet/clipboardhelper.js")),3===g&&c("./dist/core/lc/lcRegister.js"),k(c("./dist/core/worksheet/worksheet-model.js")),4===g&&c("./dist/core/lc/lcRegister.js"),k(c("./dist/core/worksheet/worksheet.js")),c("./dist/core/worksheet/worksheet-formatter.js"),k(c("./dist/core/worksheet/worksheet-actions.js")),k(c("./dist/core/worksheet/worksheet-border.js")),c("./dist/core/worksheet/worksheet-edit.js"),k(c("./dist/core/worksheet/worksheet-event.js")),c("./dist/core/worksheet/worksheet-json.js"),k(c("./dist/core/worksheet/worksheet-render.js")),c("./dist/core/worksheet/worksheet-selection.js"),c("./dist/core/worksheet/worksheet-sort.js"),k(c("./dist/core/worksheet/worksheet-ui.js")),k(c("./dist/core/worksheet/worksheet-static.js")),k(c("./dist/core/workbook/workbook.js")),k(c("./dist/core/workbook/workbook-json.js")),k(c("./dist/core/workbook/sheettabbase.js")),k(c("./dist/core/workbook/sheettab.js")),k(c("./dist/core/workbook/sheettab2007.js")),k(c("./dist/core/workbook/workbookpanelex.js")),k(c("./dist/core/util/styleManager.js")),h=c("./dist/core/celltype/cellType.entry.js"),b.CellTypes=h,i=c("./dist/core/celltype/headercelltype.js"),Object.defineProperty(h,"Corner",{set:function(a){a!==i.Corner&&(i.Corner=a)},get:function(){return i.Corner}}),Object.defineProperty(h,"ColumnHeader",{set:function(a){a!==i.ColumnHeader&&(i.ColumnHeader=a)},get:function(){return i.ColumnHeader}}),Object.defineProperty(h,"RowHeader",{set:function(a){a!==i.RowHeader&&(i.RowHeader=a)},get:function(){return i.RowHeader}}),j=c("./dist/core/celltype/textcelltype.js"),Object.defineProperty(h,"Text",{set:function(a){a!==j.Text&&(j.Text=a)},get:function(){return j.Text}}),h.vHb=i,h.wHb=j,1!==f&&2!==f||e.Gb(b)},"./dist/core/core.enum.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.pixels=0]="pixels",a[a.continuous=1]="continuous"}(d=b.ScrollType||(b.ScrollType={})),function(a){a[a.setRowCount=0]="setRowCount",a[a.setColumnCount=1]="setColumnCount",a[a.addRows=2]="addRows",a[a.deleteRows=3]="deleteRows",a[a.addColumns=4]="addColumns",a[a.deleteColumns=5]="deleteColumns",a[a.setRowHeight=6]="setRowHeight",a[a.setColumnWidth=7]="setColumnWidth",a[a.setRowVisible=8]="setRowVisible",a[a.setColumnVisible=9]="setColumnVisible",a[a.filterRows=10]="filterRows",a[a.outlineExpandRows=11]="outlineExpandRows",a[a.outlineExpandColumns=12]="outlineExpandColumns"}(e=b.AxisInfoChangeType||(b.AxisInfoChangeType={})),function(a){a[a.hide=0]="hide",a[a.show=1]="show",a[a.active=2]="active",a[a.inactive=3]="inactive"}(f=b.ScrollbarState||(b.ScrollbarState={})),function(a){a[a.none=0]="none",a[a.column=1]="column",a[a.row=2]="row",a[a.both=3]="both"}(g=b.ShowResizeTip||(b.ShowResizeTip={})),function(a){a[a.skin=0]="skin",a[a.mobile=1]="mobile"}(h=b.ScrollbarAppearance||(b.ScrollbarAppearance={})),function(a){a[a.none=0]="none",a[a.horizontal=1]="horizontal",a[a.vertical=2]="vertical",a[a.both=3]="both"}(i=b.ShowScrollTip||(b.ShowScrollTip={})),function(a){a[a.right=0]="right",a[a.down=1]="down"}(j=b.InsertShiftCell||(b.InsertShiftCell={})),function(a){a[a.normal=0]="normal",a[a.split=1]="split"}(k=b.ResizeMode||(b.ResizeMode={})),function(a){a[a.noHeaders=0]="noHeaders",a[a.rowHeaders=1]="rowHeaders",a[a.columnHeaders=2]="columnHeaders",a[a.allHeaders=3]="allHeaders"}(l=b.CopyPasteHeaderOptions||(b.CopyPasteHeaderOptions={})),function(a){a[a.noHeaders=0]="noHeaders",a[a.rowHeaders=1]="rowHeaders",a[a.columnHeaders=2]="columnHeaders",a[a.allHeaders=3]="allHeaders"}(m=b.HeaderOptions||(b.HeaderOptions={})),function(a){a[a.default=0]="default",a[a.enhanced=1]="enhanced"}(n=b.ResizeZeroIndicator||(b.ResizeZeroIndicator={})),function(a){a[a.setFormula=0]="setFormula",a[a.copyPaste=1]="copyPaste",a[a.dragFill=2]="dragFill",a[a.dragDrop=3]="dragDrop",a[a.changePartOfArrayFormula=4]="changePartOfArrayFormula",a[a.changeSheetName=5]="changeSheetName",a[a.table=6]="table",a[a.filter=7]="filter",a[a.hideSheet=8]="hideSheet",a[a.sort=9]="sort",a[a.pivotTable=10]="pivotTable",a[a.ptOverlapValue=11]="ptOverlapValue",a[a.groupProtected=12]="groupProtected",a[a.editProtected=13]="editProtected",a[a.cutProtected=14]="cutProtected",a[a.customName=15]="customName",a[a.dataObjectCellTypeInsertData=16]="dataObjectCellTypeInsertData"}(o=b.InvalidOperationType||(b.InvalidOperationType={})),function(a){a[a.cell=0]="cell",a[a.cellWithHeader=1]="cellWithHeader"}(p=b.AutoFitType||(b.AutoFitType={})),function(a){a[a.all=0]="all",a[a.values=1]="values",a[a.formatting=2]="formatting",a[a.formulas=3]="formulas",a[a.valuesAndFormatting=4]="valuesAndFormatting",a[a.formulasAndFormatting=5]="formulasAndFormatting"}(q=b.ClipboardPasteOptions||(b.ClipboardPasteOptions={})),function(a){a[a.value=1]="value",a[a.formula=2]="formula",a[a.comment=4]="comment",a[a.outline=8]="outline",a[a.sparkline=16]="sparkline",a[a.span=32]="span",a[a.style=64]="style",a[a.tag=128]="tag",a[a.bindingPath=256]="bindingPath",a[a.conditionalFormat=512]="conditionalFormat",a[a.hyperlink=1024]="hyperlink",a[a.all=2047]="all"}(r=b.CopyToOptions||(b.CopyToOptions={})),function(a){a[a.topLeft=0]="topLeft",a[a.topCenter=1]="topCenter",a[a.topRight=2]="topRight",a[a.bottomLeft=3]="bottomLeft",a[a.bottomCenter=4]="bottomCenter",a[a.bottomRight=5]="bottomRight"}(s=b.LabelAlignment||(b.LabelAlignment={})),function(a){a[a.visible=0]="visible",a[a.hidden=1]="hidden",a[a.auto=2]="auto"}(t=b.LabelVisibility||(b.LabelVisibility={})),function(a){a[a.underline=1]="underline",a[a.lineThrough=2]="lineThrough",a[a.overline=4]="overline",a[a.doubleUnderline=8]="doubleUnderline",a[a.none=0]="none"}(u=b.TextDecorationType||(b.TextDecorationType={})),function(a){a[a.left=0]="left",a[a.center=1]="center",a[a.right=2]="right",a[a.general=3]="general",a[a.centerContinuous=4]="centerContinuous"}(v=b.HorizontalAlign||(b.HorizontalAlign={})),function(a){a[a.top=0]="top",a[a.center=1]="center",a[a.bottom=2]="bottom"}(w=b.VerticalAlign||(b.VerticalAlign={})),function(a){a[a.normal=0]="normal",a[a.superscript=1]="superscript",a[a.subscript=2]="subscript"}(x=b.VertAlign||(b.VertAlign={})),function(a){a[a.smallDecrement=0]="smallDecrement",a[a.smallIncrement=1]="smallIncrement",a[a.largeDecrement=2]="largeDecrement",a[a.largeIncrement=3]="largeIncrement",a[a.thumbPosition=4]="thumbPosition",a[a.thumbTrack=5]="thumbTrack",a[a.endScroll=6]="endScroll"}(y=b.Nxb||(b.Nxb={})),function(a){a[a.normal=0]="normal",a[a.highlight=1]="highlight",a[a.selected=2]="selected",a[a.active=3]="active",a[a.hover=4]="hover",a[a.activeNotSelected=5]="activeNotSelected"}(z=b.VisualState||(b.VisualState={})),function(a){a[a.ready=0]="ready",a[a.enter=1]="enter",a[a.edit=2]="edit"}(A=b.EditorStatus||(b.EditorStatus={})),function(a){a[a.auto=1]="auto",a[a.active=2]="active",a[a.inactive=4]="inactive",a[a.disabled=0]="disabled"}(B=b.ImeMode||(b.ImeMode={})),function(a){a[a.single=0]="single",a[a.range=1]="range",a[a.multiRange=2]="multiRange"}(C=b.SelectionPolicy||(b.SelectionPolicy={})),function(a){a[a.cell=0]="cell",a[a.row=1]="row",a[a.column=2]="column"}(D=b.SelectionUnit||(b.SelectionUnit={})),function(a){a[a.data=1]="data",a[a.style=2]="style",a[a.comment=4]="comment",a[a.tag=8]="tag",a[a.sparkline=16]="sparkline",a[a.axis=32]="axis",a[a.bindingPath=64]="bindingPath",a[a.hyperlink=256]="hyperlink"}(E=b.StorageType||(b.StorageType={})),function(a){a[a.blank=0]="blank",a[a.numbers=1]="numbers",a[a.letters=2]="letters"}(F=b.HeaderAutoText||(b.HeaderAutoText={})),function(a){a[a.dragDrop=0]="dragDrop",a[a.dragFill=1]="dragFill",a[a.clear=2]="clear",a[a.paste=3]="paste",a[a.sort=4]="sort",a[a.setArrayFormula=5]="setArrayFormula",a[a.evaluateFormula=6]="evaluateFormula"}(G=b.RangeChangedAction||(b.RangeChangedAction={})),function(a){a[a.normal=0]="normal",a[a.richText=1]="richText"}(H=b.ValueType||(b.ValueType={})),function(a){a[a.stretch=0]="stretch",a[a.center=1]="center",a[a.zoom=2]="zoom",a[a.none=3]="none"}(I=b.ImageLayout||(b.ImageLayout={})),function(a){a.ThumbButton="thumbButton",a.TrackButton="trackButton",a.LeftButton="leftButton",a.RightButton="rightButton",a.UpButton="upButton",a.DownButton="downButton"}(J=b.Oxb||(b.Oxb={})),function(a){a[a.left=0]="left",a[a.center=1]="center",a[a.right=2]="right",a[a.nearest=3]="nearest"}(K=b.HorizontalPosition||(b.HorizontalPosition={})),function(a){a[a.top=0]="top",a[a.center=1]="center",a[a.bottom=2]="bottom",a[a.nearest=3]="nearest"}(L=b.VerticalPosition||(b.VerticalPosition={})),function(a){a[a.corner=0]="corner",a[a.colHeader=1]="colHeader",a[a.rowHeader=2]="rowHeader",a[a.viewport=3]="viewport"}(M=b.SheetArea||(b.SheetArea={})),function(a){a[a.none=0]="none",a[a.ascending=1]="ascending",a[a.descending=2]="descending"}(N=b.SortState||(b.SortState={})),function(a){a[a.hover=1]="hover",a[a.invalid=2]="invalid",a[a.readonly=4]="readonly",a[a.edit=8]="edit",a[a.active=16]="active",a[a.selected=32]="selected",a[a.dirty=64]="dirty",a[a.invalidFormula=128]="invalidFormula"}(O=b.CellStatesType||(b.CellStatesType={})),function(a){a[a.hover=1]="hover",a[a.invalid=2]="invalid",a[a.edit=8]="edit",a[a.active=16]="active",a[a.selected=32]="selected",a[a.dirty=64]="dirty",a[a.inserted=128]="inserted",a[a.invalidFormula=512]="invalidFormula"}(P=b.RowColumnStates||(b.RowColumnStates={})),function(a){a[a.always=0]="always",a[a.onSelected=1]="onSelected",a[a.onEditing=2]="onEditing"}(Q=b.ButtonVisibility||(b.ButtonVisibility={})),function(a){a[a.none=0]="none",a[a.custom=1]="custom",a[a.clear=2]="clear",a[a.cancel=3]="cancel",a[a.ok=4]="ok",a[a.dropdown=5]="dropdown",a[a.ellipsis=6]="ellipsis",a[a.left=7]="left",a[a.right=8]="right",a[a.plus=9]="plus",a[a.minus=10]="minus",a[a.undo=11]="undo",a[a.redo=12]="redo",a[a.search=13]="search",a[a.separator=14]="separator",a[a.spinLeft=15]="spinLeft",a[a.spinRight=16]="spinRight",a[a.collapse=17]="collapse",a[a.expand=18]="expand"}(R=b.ButtonImageType||(b.ButtonImageType={})),R.calcel=R.cancel,function(a){a[a.colorPicker=0]="colorPicker",a[a.dateTimePicker=1]="dateTimePicker",a[a.timePicker=2]="timePicker",a[a.monthPicker=3]="monthPicker",a[a.list=4]="list",a[a.slider=5]="slider",a[a.calculator=6]="calculator",a[a.workflowList=7]="workflowList",a[a.multiColumn=8]="multiColumn"}(S=b.DropDownType||(b.DropDownType={})),function(a){a[a.left=0]="left",a[a.right=1]="right",a[a.leftOfText=2]="leftOfText",a[a.rightOfText=3]="rightOfText"}(T=b.ButtonPosition||(b.ButtonPosition={})),function(a){a[a.left=0]="left",a[a.right=1]="right"}(U=b.CaptionAlignment||(b.CaptionAlignment={})),function(a){a[a.horizontal=0]="horizontal",a[a.vertical=1]="vertical"}(V=b.LayoutDirection||(b.LayoutDirection={})),function(a){a[a.inline=0]="inline",a[a.popup=1]="popup",a[a.tree=2]="tree"}(W=b.LayoutDisplayAs||(b.LayoutDisplayAs={})),function(a){a[a.year=1]="year",a[a.month=2]="month",a[a.day=3]="day"}(X=b.CalendarPage||(b.CalendarPage={})),function(a){a[a.monday=1]="monday",a[a.tuesday=2]="tuesday",a[a.wednesday=3]="wednesday",a[a.thursday=4]="thursday",a[a.friday=5]="friday",a[a.saturday=6]="saturday",a[a.sunday=7]="sunday"}(Y=b.CalendarStartDay||(b.CalendarStartDay={})),function(a){a[a.none=0]="none",a[a.group=1]="group",a[a.child=2]="child",a[a.full=3]="full"}(Z=b.GroupSort||(b.GroupSort={})),function(a){a[a.string=0]="string",a[a.array=1]="array"}($=b.DropdownListValue||(b.DropdownListValue={})),function(a){a[a.solid=1]="solid",a[a.darkGray=2]="darkGray",a[a.mediumGray=3]="mediumGray",a[a.lightGray=4]="lightGray",a[a.gray125=5]="gray125",a[a.gray0625=6]="gray0625",a[a.darkHorizontal=7]="darkHorizontal",a[a.darkVertical=8]="darkVertical",a[a.darkDown=9]="darkDown",a[a.darkUp=10]="darkUp",a[a.darkGrid=11]="darkGrid",a[a.darkTrellis=12]="darkTrellis",a[a.lightHorizontal=13]="lightHorizontal",a[a.lightVertical=14]="lightVertical",a[a.lightDown=15]="lightDown",a[a.lightUp=16]="lightUp",a[a.lightGrid=17]="lightGrid",a[a.lightTrellis=18]="lightTrellis"}(_=b.PatternType||(b.PatternType={})),function(a){a[a.mask=0]="mask",a[a.overflow=1]="overflow"}(aa=b.NumbersFitMode||(b.NumbersFitMode={})),function(a){a[a.bottom=0]="bottom",a[a.top=1]="top",a[a.left=2]="left",a[a.right=3]="right"}(ba=b.TabStripPosition||(b.TabStripPosition={})),function(a){a[a.blank=0]="blank",a[a.self=1]="self",a[a.parent=2]="parent",a[a.top=3]="top"}(ca=b.HyperlinkTargetType||(b.HyperlinkTargetType={})),function(a){a[a.tableSheet=0]="tableSheet",a[a.ganttSheet=1]="ganttSheet",a[a.customSheetTab=2]="customSheetTab"}(da=b.SheetType||(b.SheetType={})),function(a){a[a.hidden=0]="hidden",a[a.visible=1]="visible",a[a.veryHidden=2]="veryHidden"}(ea=b.SheetTabVisible||(b.SheetTabVisible={})),function(a){a[a.hide=0]="hide",a[a.show=1]="show",a[a.auto=2]="auto"}(fa=b.AllSheetsListVisibility||(b.AllSheetsListVisibility={})),function(a){a[a.normal=0]="normal",a[a.vertical=1]="vertical",a[a.stack=2]="stack"}(ga=b.ColumnHeaderFitMode||(b.ColumnHeaderFitMode={})),function(a){a[a.all=262143]="all",a[a.axis=1]="axis",a[a.style=2]="style",a[a.rowStyle=4]="rowStyle",a[a.colStyle=8]="colStyle",a[a.data=16]="data",a[a.formula=32]="formula",a[a.span=64]="span",a[a.shape=128]="shape",a[a.table=256]="table",a[a.sparkLine=512]="sparkLine",a[a.comment=1024]="comment",a[a.slicer=2048]="slicer",a[a.pivottable=4096]="pivottable",a[a.filter=8192]="filter",a[a.dataValidation=16384]="dataValidation",a[a.conditionFormat=32768]="conditionFormat",a[a.chart=65536]="chart",a[a.picture=131072]="picture"}(ha=b.UsedRangeType||(b.UsedRangeType={})),function(a){a.cellColor="cellColor",a.fontColor="fontColor",a.icon="icon",a.value="value"}(ia=b.SortBy||(b.SortBy={})),function(a){a.wholeTable="wholeTable",a.firstColumnStripe="firstColumnStripe",a.secondColumnStripe="secondColumnStripe",a.firstRowStripe="firstRowStripe",a.secondRowStripe="secondRowStripe",a.lastColumn="lastColumn",a.firstColumn="firstColumn",a.headerRow="headerRow",a.totalRow="totalRow",a.firstHeaderCell="firstHeaderCell",a.lastHeaderCell="lastHeaderCell",a.firstTotalCell="firstTotalCell",a.lastTotalCell="lastTotalCell"}(ja=b.TableStyleElement||(b.TableStyleElement={})),function(a){a[a.excel=0]="excel",a[a.ssjson=1]="ssjson",a[a.csv=2]="csv"}(ka=b.FileType||(b.FileType={})),function(a){a[a.excel=0]="excel",a[a.sjs=1]="sjs"}(la=b.OpenSaveFileType||(b.OpenSaveFileType={})),function(a){a[a.normal=0]="normal",a[a.lazy=1]="lazy",a[a.incremental=2]="incremental"}(ma=b.OpenMode||(b.OpenMode={})),function(a){a[a.copy=1]="copy",a[a.cut=2]="cut",a[a.reset=3]="reset"}(na=b.ClipboardActionType||(b.ClipboardActionType={}))},"./dist/core/core.interface.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d;!function(a){a[a.leftTop=1]="leftTop",a[a.rightTop=2]="rightTop",a[a.leftBottom=4]="leftBottom",a[a.rightBottom=8]="rightBottom"}(d=b.CornerPosition||(b.CornerPosition={}))},"./dist/core/core.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/core/core.res.en.js");b.SR={en:d}},"./dist/core/core.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_NotSupported="Not supported exception",b.Exp_PasteExtentIsNull="pasteExtent is null",b.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",b.Exp_MultipleSelections="This action won't work on multiple selections.",b.Exp_ChangePartOfArray="Cannot change part of an array.",b.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",b.Exp_SrcIsNull="The argument 'src' is null",b.Exp_DestIsNull="The argument 'dest' is null",b.Exp_InvalidCustomFunction="invalid custom function",b.Exp_InvalidCustomName="invalid custom name",b.Exp_IndexOutOfRange="Index is out of range!",b.Exp_InvalidRange="Invalid range",b.Exp_NotAFunction="Not A Function",b.Exp_ArgumentOutOfRange="ArgumentOutOfRange",b.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",b.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",b.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",b.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",b.Tip_Row="Row: ",b.Tip_Column="Column: ",b.Tip_Column_Offset="Offset: ",b.Tip_Height="Height: {0} pixels",b.Tip_Width="Width: {0} pixels",b.NewTab="New...",b.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",b.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",b.Exp_SheetNameConflict="That name is already taken. Try a different one.",b.Exp_ArrayFormulaSpan="Array formulas are not valid in merged cells.",b.Exp_DestSheetIsNull="destSheet is null",b.Exp_SheetIsNull="sheet is null.",b.Exp_OverlappingSpans="This operation will cause overlapping spans.",b.NeedCanvasSupport="You need a browser which full supports HTML5 Canvas to run SpreadJS",b.ARIA_Resize="resize",b.ARIA_First="first",b.ARIA_PreviousArrow="previous arrow",b.ARIA_NextArrow="next arrow",b.ARIA_Last="last",b.ARIA_PreviousButton="previous button",b.ARIA_NextButton="next button",b.ARIA_SheetTab="sheet tab",b.ARIA_NewSheet="new sheet",
b.ARIA_Blank="blank",b.ARIA_Scrollbar_Left_Button="scrollbar left button",b.ARIA_Scrollbar_Top_Button="scrollbar top button",b.ARIA_Scrollbar_Thumb_Button="scrollbar thumb button",b.ARIA_Scrollbar_Right_Button="scrollbar right button",b.ARIA_Scrollbar_Bottom_Button="scrollbar bottom button",b.ARIA_Scrollbar_TRACK_Button="scrollbar track button",b.ARIA_Cell="cell",b.ARIA_HasValue="has value {0}",b.ARIA_HasFormula="has formula {0}",b.ARIA_HasComment="has comment {0}",b.ARIA_RowHeader="row header",b.ARIA_ColumnHeader="column header",b.SHEET_NAME="Sheet",b.lsru=["","6465706c6f796d656e74"],b.lsde=["","64657369676e6572"],b.ls1=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279207b317d206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d2e"],b.ls2=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b6579206578706972657320696e207b307d206461792873292e"],b.ls3=["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a532e0d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e6365206f7220726571756573742061206b6579206174206763676f2e746f2f736a736b65792e"],b.ls4=["","496e76616c6964206c6963656e7365206b65792e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],b.ls5=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b65792068617320657870697265642e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20666f722068656c702e"],b.ls6=["","506f776572656420627920477261706543697479205370726561644a53204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"],b.ls7=["","457863656c20494f204c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561644a5320457863656c20494f2e2054656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e20496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],b.ls8=["","496e76616c696420457863656c20494f206c6963656e7365206b65792e200d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],b.Exp_InsertCopiedCutCells="This selection is not valid. The copy/paste area must be the same size",b.Exp_InsertCopiedCutCellsOnSpanTable="This won\u2019t work because it would move cells in a table on your worksheet or will cause some merged cells to unmerge.",b.Exp_InsertCopiedCutCellsNoRange="New cells can not be inserted as there are non-empty cells that would extend beyond the worksheet.",b.Exp_InvalidSortArrayFormulaInRange="Can't sort current range as array formula exist.",b.Exp_InvalidSortSpanInRange="Can't sort current range as span exist.",b.Exp_InvalidSortPartTableOrMultiTableInRange="Can't sort current range as part table or more than one table exist.",b.Exp_InvalidOperationInProtect="The cell or chart you're trying to change is on a protected sheet. To make a change, unprotect the sheet.",b.EXP_IO="File read and write exception.",b.EXP_FILE_FORMAT="Incorrect file format.",b.EXP_NO_PASSWORD="The Excel file cannot be opened because the workbook/worksheet is password protected.",b.EXP_INVALID_PASSWORD="The specified password is incorrect.",b.NORMAL="Normal",b.STEP={start:"start load {0}",loadFileData:"load {0}'s data to spread",loadSheetData:"load {0}'s data",startCalc:"start reCalc",loadSheetFormula:"load {0}'s formula",parseFile:"parse {0} content"}},"./dist/core/excel-io-util/common.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/core.enum.js"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),h=c("./dist/core/excel-io-util/excel-types.js"),i=/_x00[0-1][0-9A-Fa-f]_/,j=d.Common.j.Fa,k=null,l=void 0,m=h.XFileConstants.Q8,n=h.XFileConstants.yhK,o=h.XFileConstants.bbK,p=/([A-Z][A-Z.]+)\(/gi,q="_xlfn.",r="_xlfn._xlws.",s={AVERAGEIF:/\bAVERAGEIF\b\(/gi,AVERAGEIFS:/\bAVERAGEIFS\b\(/gi,CUBEKPIMEMBER:/\bCUBEKPIMEMBER\b\(/gi,CUBEMEMBER:/\bCUBEMEMBER\b\(/gi,CUBEMEMBERPROPERTY:/\bCUBEMEMBERPROPERTY\b\(/gi,CUBERANKEDMEMBER:/\bCUBERANKEDMEMBER\b\(/gi,CUBESET:/\bCUBESET\b\(/gi,CUBESETCOUNT:/\bCUBESETCOUNT\b\(/gi,CUBEVALUE:/\bCUBEVALUE\b\(/gi,COUNTIFS:/\bCOUNTIFS\b\(/gi,IFERROR:/\bIFERROR\b\(/gi,SUMIFS:/\bSUMIFS\b\(/gi,ACOT:/\bACOT\b\(/gi,ACOTH:/\bACOTH\b\(/gi,AGGREGATE:/\bAGGREGATE\b\(/gi,ARABIC:/\bARABIC\b\(/gi,BASE:/\bBASE\b\(/gi,"BETA.DIST":/\bBETA\.DIST\b\(/gi,"BETA.INV":/\bBETA\.INV\b\(/gi,"BINOM.DIST":/\bBINOM\.DIST\b\(/gi,"BINOM.DIST.RANGE":/\bBINOM\.DIST\.RANGE\b\(/gi,"BINOM.INV":/\bBINOM\.INV\b\(/gi,BITAND:/\bBITAND\b\(/gi,BITLSHIFT:/\bBITLSHIFT\b\(/gi,BITOR:/\bBITOR\b\(/gi,BITRSHIFT:/\bBITRSHIFT\b\(/gi,BITXOR:/\bBITXOR\b\(/gi,"CEILING.MATH":/\bCEILING\.MATH\b\(/gi,"CEILING.PRECISE":/\bCEILING\.PRECISE\b\(/gi,"CHISQ.DIST":/\bCHISQ\.DIST\b\(/gi,"CHISQ.DIST.RT":/\bCHISQ\.DIST\.RT\b\(/gi,"CHISQ.INV":/\bCHISQ\.INV\b\(/gi,"CHISQ.INV.RT":/\bCHISQ\.INV\.RT\b\(/gi,"CHISQ.TEST":/\bCHISQ\.TEST\b\(/gi,COMBINA:/\bCOMBINA\b\(/gi,CONCAT:/\bCONCAT\b\(/gi,"CONFIDENCE.T":/\bCONFIDENCE\.T\b\(/gi,"CONFIDENCE.NORM":/\bCONFIDENCE\.NORM\b\(/gi,COT:/\bCOT\b\(/gi,"COVARIANCE.P":/\bCOVARIANCE\.P\b\(/gi,"COVARIANCE.S":/\bCOVARIANCE\.S\b\(/gi,CSC:/\bCSC\b\(/gi,CSCH:/\bCSCH\b\(/gi,DAYS:/\bDAYS\b\(/gi,DECIMAL:/\bDECIMAL\b\(/gi,ENCODEURL:/\bENCODEURL\b\(/gi,"ERF.PRECISE":/\bERF\.PRECISE\b\(/gi,"ERFC.PRECISE":/\bERFC\.PRECISE\b\(/gi,"EXPON.DIST":/\bEXPON\.DIST\b\(/gi,"F.DIST":/\bF\.DIST\b\(/gi,"F.DIST.RT":/\bF\.DIST\.RT\b\(/gi,"F.INV":/\bF\.INV\b\(/gi,"F.INV.RT":/\bF\.INV\.RT\b\(/gi,FILTERXML:/\bFILTERXML\b\(/gi,"FLOOR.MATH":/\bFLOOR\.MATH\b\(/gi,"FLOOR.PRECISE":/\bFLOOR\.PRECISE\b\(/gi,FORMULATEXT:/\bFORMULATEXT\b\(/gi,GAMMA:/\bGAMMA\b\(/gi,"GAMMA.DIST":/\bGAMMA\.DIST\b\(/gi,"GAMMA.INV":/\bGAMMA\.INV\b\(/gi,"GAMMALN.PRECISE":/\bGAMMALN\.PRECISE\b\(/gi,"HYPGEOM.DIST":/\bHYPGEOM\.DIST\b\(/gi,IFNA:/\bIFNA\b\(/gi,IFS:/\bIFS\b\(/gi,IMCOSH:/\bIMCOSH\b\(/gi,IMCOT:/\bIMCOT\b\(/gi,IMCSCH:/\bIMCSCH\b\(/gi,IMSEC:/\bIMSEC\b\(/gi,IMSECH:/\bIMSECH\b\(/gi,IMSINH:/\bIMSINH\b\(/gi,IMTAN:/\bIMTAN\b\(/gi,ISFORMULA:/\bISFORMULA\b\(/gi,ISOWEEKNUM:/\bISOWEEKNUM\b\(/gi,"LOGNORM.DIST":/\bLOGNORM\.DIST\b\(/gi,"LOGNORM.INV":/\bLOGNORM\.INV\b\(/gi,MAXIFS:/\bMAXIFS\b\(/gi,MINIFS:/\bMINIFS\b\(/gi,"MODE.MULT":/\bMODE\.MULT\b\(/gi,"MODE.SNGL":/\bMODE\.SNGL\b\(/gi,MUNIT:/\bMUNIT\b\(/gi,"NEGBINOM.DIST":/\bNEGBINOM\.DIST\b\(/gi,"NORM.DIST":/\bNORM\.DIST\b\(/gi,"NORM.INV":/\bNORM\.INV\b\(/gi,"NORM.S.DIST":/\bNORM\.S\.DIST\b\(/gi,"NORM.S.INV":/\bNORM\.S\.INV\b\(/gi,NUMBERVALUE:/\bNUMBERVALUE\b\(/gi,PDURATION:/\bPDURATION\b\(/gi,"PERCENTILE.EXC":/\bPERCENTILE\.EXC\b\(/gi,"PERCENTILE.INC":/\bPERCENTILE\.INC\b\(/gi,"PERCENTRANK.EXC":/\bPERCENTRANK\.EXC\b\(/gi,"PERCENTRANK.INC":/\bPERCENTRANK\.INC\b\(/gi,PERMUTATIONA:/\bPERMUTATIONA\b\(/gi,PHI:/\bPHI\b\(/gi,"POISSON.DIST":/\bPOISSON\.DIST\b\(/gi,"QUARTILE.EXC":/\bQUARTILE\.EXC\b\(/gi,"QUARTILE.INC":/\bQUARTILE\.INC\b\(/gi,"RANK.AVG":/\bRANK\.AVG\b\(/gi,"RANK.EQ":/\bRANK\.EQ\b\(/gi,RRI:/\bRRI\b\(/gi,SECH:/\bSECH\b\(/gi,SHEET:/\bSHEET\b\(/gi,SHEETS:/\bSHEETS\b\(/gi,"STDEV.P":/\bSTDEV\.P\b\(/gi,"STDEV.S":/\bSTDEV\.S\b\(/gi,SWITCH:/\bSWITCH\b\(/gi,"T.DIST":/\bT\.DIST\b\(/gi,"T.DIST.2T":/\bT\.DIST\.2T\b\(/gi,"T.DIST.RT":/\bT\.DIST\.RT\b\(/gi,"T.INV":/\bT\.INV\b\(/gi,"T.INV.2T":/\bT\.INV\.2T\b\(/gi,TEXTJOIN:/\bTEXTJOIN\b\(/gi,UNICHAR:/\bUNICHAR\b\(/gi,UNICODE:/\bUNICODE\b\(/gi,"VAR.P":/\bVAR\.P\b\(/gi,"VAR.S":/\bVAR\.S\b\(/gi,WEBSERVICE:/\bWEBSERVICE\b\(/gi,"WEIBULL.DIST":/\bWEIBULL\.DIST\b\(/gi,XOR:/\bXOR\b\(/gi,"Z.TEST":/\bZ\.TEST\b\(/gi,XMATCH:/\bXLOOKUP\b\(/gi,XLOOKUP:/\bXLOOKUP\b\(/gi,RANDARRAY:/RANDARRAY\(/gi,SEQUENCE:/SEQUENCE\(/gi,SORTBY:/SORTBY\(/gi,UNIQUE:/UNIQUE\(/gi,ANCHORARRAY:/ANCHORARRAY\(/gi,SINGLE:/SINGLE\(/gi,LET:/\bLET\b\(/gi,LAMBDA:/\bLAMBDA\b\(/gi,MAP:/\bMAP\b\(/gi,REDUCE:/\bREDUCE\b\(/gi,SCAN:/\bSCAN\b\(/gi,MAKEARRAY:/\bMAKEARRAY\b\(/gi,BYCOL:/\bBYCOL\b\(/gi,BYROW:/\bBYROW\b\(/gi,ISOMITTED:/\bISOMITTED\b\(/gi,FILTER:{reg:/FILTER\(/gi,prefix:r},SORT:{reg:/SORT\(/gi,prefix:r},TEXTBEFORE:/\bTEXTBEFORE\b\(/gi,TEXTAFTER:/\bTEXTAFTER\b\(/gi,TEXTSPLIT:/\bTEXTSPLIT\b\(/gi,VSTACK:/\bVSTACK\b\(/gi,HSTACK:/\bHSTACK\b\(/gi,TOROW:/\bTOROW\b\(/gi,TOCOL:/\bTOCOL\b\(/gi,WRAPROWS:/\bWRAPROWS\b\(/gi,WRAPCOLS:/\bWRAPCOLS\b\(/gi,TAKE:/\bTAKE\b\(/gi,DROP:/\bDROP\b\(/gi,EXPAND:/\bEXPAND\b\(/gi,CHOOSEROWS:/\bCHOOSEROWS\b\(/gi,CHOOSECOLS:/\bCHOOSECOLS\b\(/gi},b.STEP_RATE={start:0,loadFileData:.1,loadSheetData:.4,loadSheetDataWithCalc:.3,startCalc:.2,loadSheetFormula:.4,loadSheetFormulaWithCalc:.3,parseFile:.1,end:1},t=function(){function a(){}return a.Ec=function(a){return!a||""===a},a.M9=function(a){return!a||" "===a},a}(),b.StringEx=t,u=function(){function a(){}return a.P9=function(a){if(t.Ec(a))return 0;for(var b=0,c=0;c<a.length&&isNaN(parseInt(a[c],10));)c++;return c<a.length&&(b=parseInt(a.substring(c),10)),b-1},a.Q9=function(a){var b,c,d,e,f=0,g=a.length;for(b=0;b<g&&(c=a[b],d=c.charCodeAt(),e=d-97,!(e>25))&&(e<0&&(e=d-65),!(e<0));b++)f=26*f+e+1;return f--,f},a.R9=function(b){var c,d,e,f,g,h;if(b<0)return"";if(c=a.S9[b])return c;for(d=b,e="",f=e.length,b+=1;b>0;b=Math.floor((b-1)/26))g=e.substring(0,f),h=e.substring(f),e=g+String.fromCharCode(65+(b-1)%26)+h;return c=""+e,a.S9[d]=c,c},a.Wfa=function(b){var c,d=function(b){var c,d,e=!0;for(c=0;c<b.length;c++){if(d=b[c],a.UaK[d])return!1;e&&/\D/.test(d)&&(e=!1)}return!e},e="'"===b[0]&&"'"===b.substr(-1);return e||(c=d(b))?b:"'"+b+"'"},a.S9=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],a.UaK={" ":!0,"'":!0,"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"\uff08":!0,"\uff09":!0,";":!0,":":!0,",":!0,"+":!0,"-":!0,"*":!0,"/":!0,"&":!0,"=":!0,"<":!0,">":!0,"\u3000":!0},a}(),b.IndexHelper=u,v=function(){function a(){}return a.qca=function(a,b){if(!j(a)){var c=parseFloat(a);if(!isNaN(c))return c}return b},a.oca=function(a,b){return"1"===a||"0"!==a&&b},a.pca=function(a,b){if(!isNaN(a)){var c=parseInt(a,10);if(!isNaN(c))return c}return b},a.rca=function(a){return Array.isArray(a)||(a=a?[a]:[]),a},a.VaK=function(a,b){return"1"===a||"t"===a||"0"!==a&&"f"!==a&&!!b},a.sca=function(a,b){var c,d,e;if(a){for(c=b.split("."),d=a;c.length;){if(e=c.shift(),j(d[e]))return;d=d[e]}return d}},a.cjK=function(a,b){return j(a)?b:a?"1":"0"},a}(),b.NodeHelper=v;function x(a,b){var c,d=b.toUpperCase(),e=s[d];return e?(c=q,e.reg&&(c=e.prefix),c+a):a}w=function(){function a(){}return a.LhK=function(a){return a.split("/").pop().slice(0,-4)},a.WaK=function(a){var b="_xlfn.";return a&&a.toLowerCase().indexOf(b)>=0?a.replace(/_xlfn\.|_xlws\./gi,""):a},a.Sha=function(a,b,c){return a.split(b).join(c)},a.Tja=function(a,b){var c,d,e,f,g,h;if(j(a)||""===a)return a;for(a.match(i)!==k&&(c=/(_x00[0-1][0-9A-Fa-f]_)/g,a=a.replace(c,function(a){return"_x005F"+a})),d=["_x0000_","_x0001_","_x0002_","_x0003_","_x0004_","_x0005_","_x0006_","_x0007_","_x0008_","_x0009_","_x000A_","_x000B_","_x000C_","_x000D_","_x000E_","_x000F_","_x0010_","_x0011_","_x0012_","_x0013_","_x0014_","_x0015_","_x0016_","_x0017_","_x0018_","_x0019_","_x001A_","_x001B_","_x001C_","_x001D_","_x001E_","_x001F_"],e=[],f=0;f<a.length;f++)g=a.charCodeAt(f),h=a[f],g>31||(10===g||13===g)&&b?e.push(h):e.push(d[g]);return e.join("")},a.addXLFNPrefix=function(a){var b,c,d;if(!a||"string"!=typeof a)return a;for(b=a.split('"'),c=0;c<b.length;c+=2)d=b[c],b[c]=d.replace(p,x);return b.join('"')},a.XaK=function(a){return a.c_||(a.c_=[]),a.c_.length+1},a.YaK=function(a){return a+"."+h.XFileConstants.r8},a.ZaK=function(a,b){var c,d,e;for(c=0,d=a;c<d.length;c++)if(e=d[c],e.Id===b)return e},a.YkK=function(b,c,d){var e,f,g=b&&a.ZaK(b.c_,c);if(g)return e=a.LhK(g.Target),f=d.drawings,f&&f[e]},a.ZkK=function(b,c){var d=g.util.JcK(b,m);if(d)return a.YkK(b.rels,d[o],c)},a.AlK=function(a){a.rels||(a.rels={n_:h.XFileConstants.cbK,xmlns:h.RelationshipConstants.k9,c_:[]})},a.$kK=function(b,c){var d,e=g.util.JcK(c,m),f=e&&a.ZaK(c.rels.c_,e[o]),i=f&&a.LhK(f.Target);if(i)return b.drawings||(b.drawings={}),d=b.drawings,d[i]||(d[i]={n_:"wsDr",r_:[5,4],c_:[],rels:{n_:h.XFileConstants.cbK,xmlns:h.RelationshipConstants.k9,c_:[]}}),d[i]},a._kK=function(b,c){var d,e,f,i=b.rels;g.util.JcK(b,m)||(c.drawing++,d=a.XaK(i),e=h.XFileConstants.abK+d,f=h.XFileConstants.Q8+c.drawing,i.c_.push({n_:h.XFileConstants.dbK,Id:e,Type:h.RelationshipConstants.E7,Target:"../drawings/"+f+"."+h.XFileConstants.r8}),b.c_||(b.c_=[]),b.c_.push({n_:m,"r:id":e}),g.util.NcK(b,h.WorkSheetNodeOrder))},a.vhK=function(b,c,d){return a.YkK(b,c,d)},a.whK=function(b,c,d){var e,f,h=g.util.JcK(c,d||n),i=h&&a.ZaK(c.rels.c_,h[o]),j=i&&a.LhK(i.Target);if(j)return b.drawings||(b.drawings={}),e=b.drawings,e[j]||(f={n_:"shapelayout","v:ext":"edit",c_:[{n_:"idmap","v:ext":"edit",data:"1"}]},e[j]={n_:"xml",r_:[10,11,12],c_:[f]}),e[j]},a.xhK=function(b,c,d){var e,f,i,j,k;d=d||n,e=b.rels,g.util.JcK(b,d)||(c.vmlDrawing++,f=c.vmlDrawing,i=a.XaK(e),j=h.XFileConstants.abK+i,k=h.XFileConstants.H8+f,e.c_.push({n_:h.XFileConstants.dbK,Id:j,Type:h.RelationshipConstants.D7,Target:"../drawings/"+k+"."+h.XFileConstants.s8}),b.c_||(b.c_=[]),b.c_.push({n_:d,"r:id":j}))},a.nkK=function(b,c,d){var e,f,g,h=a.ZaK(c.c_,b),i=h&&h.Target;if(i)return f=i.lastIndexOf("/"),f!==-1&&(i=i.substring(f+1)),f=i.lastIndexOf("."),f!==-1&&(e=i.substring(f+1)),g=d.media[i],g&&e&&(g=a.ZlK(g,e)),{blob:g,type:e}},a.ZlK=function(a,b){var c=b;return"svg"===c&&(c="svg+xml"),"data:image/"+c+";base64,"+a},a.$lK=function(a){var b,c,d=a.indexOf(";base64,");if(d!==-1)return b=a.substring(d+8),c=a.substring(11,d),{type:c,base64Content:b}},a.pkK=function(b,c,d){var e,f,g,i=a.$lK(b);if(i)return d.media||(d.media={}),e=i.type,"svg+xml"===e?e="svg":"x-icon"===e&&(e="png"),f=h.XFileConstants.R8+Object.keys(d.media).length+"."+e,d.media[f]=i.base64Content,g=h.XFileConstants.abK+a.XaK(c),c.c_.push({n_:h.XFileConstants.dbK,Id:g,Type:h.RelationshipConstants.G7,Target:"../media/"+f}),g},a.zhK=function(a,b){var c=1024*(a+1)+1;return b&&(c+=b.c_.filter(function(a){return a.n_===h.XFileConstants.AhK}).length),c},a.StringToByteArray=function(a){var b,c,d=[];if(a&&!(a instanceof Array))for(b=a.length,c=0;c<b;c+=2)d[c/2]=parseInt(a.substr(c,2),16);return d},a.Tha=function(){return"{xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx}".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},a.J9=function(a,b){var c,d=a.split("/"),e=b.split("/");for(d.pop();e.length>0;)if(c=e[0],".."===c)e.shift(),d.pop();else{if("."!==c)break;e.shift()}return d.concat(e).join("/")},a.Sja=function(a){if(!j(a)&&a.match(i)!==k){var b=/(_x005[fF])?_x00([0-1][0-9A-Fa-f])_/g;return a.replace(b,function(a,b,c){var d=0;return c&&(d=parseInt(c,16)),b?"_x00"+c+"_":String.fromCharCode(d)}).replace(/(\r)+\n/g,"\r\n")}return a},a.c$a=function(){var a,b,c,d;try{b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},c="object"===("undefined"==typeof global?"undefined":b(global))&&global&&global.Object===Object&&global,d="object"===("undefined"==typeof self?"undefined":b(self))&&self&&self.Object===Object&&self,a=c||d||Function("return this")()}catch(a){}return a},a.NZa=function(){var b=a.c$a();return b&&b.gcCultureInfo},a.$aK=function(){var b=a.c$a();return b&&b.gcCultureObj},a._aK=function(b){var c=!0,d=a.c$a(),e=d&&d.GC&&d.GC.Spread&&d.GC.Spread.Formatter&&d.GC.Spread.Formatter.GeneralFormatter;if(b&&"="!==b[0]&&!j(e))try{new e(b)}catch(a){c=!1}return c},a.ciK=function(b,c){var d;return f.GC$.each(b,function(b,e){var f,g,h=e.rels&&e.rels.c_;if(h&&h.length)for(f=0;f<h.length;f++)if(g=a.LhK(h[f].Target),g===c)return d=b,!1}),d},a.diK=function(b,c){var d,e,f,g,i,j,k,l;if(c&&c.rels&&c.c_&&c.c_.length){for(d=c.rels.c_,e={},f=0;f<d.length;f++)g=d[f],g.Type===h.RelationshipConstants.z7&&(e[g.Id]=a.LhK(g.Target));for(f=0;f<c.c_.length;f++)if(i=c.c_[f],"sheets"===i.n_)for(j=i.c_,k=0;k<j.length;k++)if(l=j[k],e[l[h.XFileConstants.bbK]]===b)return l.name}},a.eiK=function(a,b,c){var d,e=b.split(".");return f.GC$.each(a,function(a,b){var f,g,h,i,j=b.c_;if(j&&j.length)for(f=0;f<j.length;f++){for(g=0,h=j[f][e[0]],i=j[f];g<e.length&&(i=i[e[g]],i!==l);)g++;if(i===c)return d=h,!1}}),d},a.xiK=function(b,c){var d,e,f,i,j,k,l,m,n,o,p,q;for(c=g.util.naa(c),e=b.workbook,f=g.util.JcK(e,h.XFileConstants.tbK).c_,i=-1,k=0,l=f;k<l.length;k++)if(m=l[k],c===m.name){i=m[h.XFileConstants.bbK];break}if(i!==-1){for(n=g.util.McK(e.rels,h.XFileConstants.dbK),o=0,p=n;o<p.length;o++)if(q=p[o],i===q.Id){j=a.LhK(q.Target);break}j&&(d=b.sheets[j])}return d},a.NhK=function(b,c){var d=a.xiK(b,c);return d&&g.util.JcK(d,h.XFileConstants.HbK)},a.OhK=function(a,b,c,d,e){var f,g;j(d)||a&&(f=a[b],f||(f=a[b]={}),g=f[c],g||(g=f[c]={}),g.v=e.getTextIndex(d))},a.lkK=function(a,b){return a&&a.openMode&e.OpenMode.lazy&&!j(b)},a.mkK=function(a){return a&&a.openMode&e.OpenMode.incremental},a.alK=function(a){return a&&a.fileType===e.OpenSaveFileType.excel},a.blK=function(a,b,c,d){var e,f=a.getRowCount(),h=a.getColumnCount(),i=d&&d.dataEffectByInflate&&d.dataEffectByInflate[a.name()];b>f&&(e=new g.Range(f,(-1),b-f,(-1)),a.setRowCount(b),i&&Object.keys(i).forEach(function(a){i[a](e)})),c>h&&(e=new g.Range((-1),h,(-1),c-h),a.setColumnCount(c),i&&Object.keys(i).forEach(function(a){i[a](e)}))},a.clK=function(b,c,d,e){var f,g,h;void 0===d&&(d=2),f=c.to,f&&(g=+f.row.v_,h=+f.col.v_,a.blK(b,g+d,h+d,e))},a.JkK=function(b,c,d,e){c&&c.forEach(function(c){var f=c.row+(c.rowCount>0?c.rowCount:1),g=c.col+(c.colCount>0?c.colCount:1);d&&(f>=h.XmlConstants.M7||g>=h.XmlConstants.L7)||a.blK(b,f,g,e)})},a.Hea=function(a){return a=Math.min(a,h.XmlConstants.L7-1),u.R9(a)},a.KlK=function(a){return!a||j(a.fileType)||a.fileType===e.OpenSaveFileType.sjs},a}(),b.Util=w,b.SJSStylePropsToStyleProps={wholeSlicerStyle:"wholeTable",headerStyle:"headerRow",wholeTableStyle:"wholeTable",headerRowStyle:"headerRow",footerRowStyle:"totalRow",highlightFirstColumnStyle:"firstColumn",highlightLastColumnStyle:"lastColumn",firstRowStripStyle:"firstRowStripe",secondRowStripStyle:"secondRowStripe",firstColumnStripStyle:"firstColumnStripe",secondColumnStripStyle:"secondColumnStripe",firstHeaderCellStyle:"firstHeaderCell",lastHeaderCellStyle:"lastHeaderCell",firstFooterCellStyle:"firstTotalCell",lastFooterCellStyle:"lastTotalCell",reportFilterLabelsStyle:"pageFieldLabels",reportFilterValuesStyle:"pageFieldValues",firstRowStripeStyle:"firstRowStripe",secondRowStripeStyle:"secondRowStripe",firstColumnStripeStyle:"firstColumnStripe",secondColumnStripeStyle:"secondColumnStripe",subtotalColumn1Style:"firstSubtotalColumn",subtotalColumn2Style:"secondSubtotalColumn",subtotalColumn3Style:"thirdSubtotalColumn",subtotalRow1Style:"firstSubtotalRow",subtotalRow2Style:"secondSubtotalRow",subtotalRow3Style:"thirdSubtotalRow",columnSubheading1Style:"firstColumnSubheading",columnSubheading2Style:"secondColumnSubheading",columnSubheading3Style:"thirdColumnSubheading",rowSubheading1Style:"firstRowSubheading",rowSubheading2Style:"secondRowSubheading",rowSubheading3Style:"thirdRowSubheading",blankRowStyle:"blankRow",grandTotalColumnStyle:"lastColumn",grandTotalRowStyle:"totalRow",firstHeaderCellStyleL:"firstHeaderCell",firstColumnStyle:"firstColumn"}},"./dist/core/excel-io-util/excel-helper.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});function d(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}var e=function(){function a(){}return a.pointToPixel=function(a){return d(96*a/72,2)},a.pixelToPoint=function(a){return 72*a/96},a.emuToPixles=function(a,b){return d(96*a/914400,b||2)},a.pixelToEMU=function(a){return Math.round(914400*a/96)},a.getActualColumnWidth=function(a,b,c){var d,e=0;for(d=b;d<c;d++)a.getColumnVisible(d)&&(e+=a.$r(d,3));return e},a.getActualRowHeight=function(a,b,c){var d,e=0;for(d=b;d<c;d++)a.getRowVisible(d)&&(e+=a.Yr(d,3));return e},a.getImageContent=function(a,b){var c,d="png",e=a.lastIndexOf(".");return e!==-1&&(d=a.substr(e+1)),"svg"===d&&(d="svg+xml"),c=b(a,!0),c?"data:image/"+d+";base64,"+c:null},a}();b.ExcelHelper=e},"./dist/core/excel-io-util/excel-style.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d;!function(a){a[a.none=0]="none",a[a.thin=1]="thin",a[a.medium=2]="medium",a[a.dashed=3]="dashed",a[a.dotted=4]="dotted",a[a.thick=5]="thick",a[a.double=6]="double",a[a.hair=7]="hair",a[a.mediumDashed=8]="mediumDashed",a[a.dashDot=9]="dashDot",a[a.mediumDashDot=10]="mediumDashDot",a[a.dashDotDot=11]="dashDotDot",a[a.mediumDashDotDot=12]="mediumDashDotDot",a[a.slantDashDot=13]="slantDashDot"}(d=b.ExcelBorderStyle||(b.ExcelBorderStyle={}))},"./dist/core/excel-io-util/excel-types.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.XmlConstants={L7:16384,M7:1048576},b.XFileConstants={Q7:"_rels",R7:"/xl",S7:"[Content_Types].xml",abK:"rId",bbK:"r:id",cbK:"Relationships",dbK:"Relationship",yhK:"legacyDrawing",qkK:"legacyDrawingHF",yiK:"AlternateContent",ziK:"Choice",AiK:"controls",BiK:"control",AhK:"shape",T7:"bin",U7:"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings",V7:"rels",W7:"application/vnd.openxmlformats-package.relationships+xml",X7:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",Y7:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",Z7:"application/vnd.openxmlformats-officedocument.theme+xml",_7:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",a8:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",b8:"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml",c8:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",d8:"application/vnd.openxmlformats-officedocument.drawing+xml",e8:"application/vnd.openxmlformats-officedocument.drawingml.chart+xml",N0a:"application/vnd.ms-office.chartex+xml",O0a:"application/vnd.ms-office.chartstyle+xml",P0a:"application/vnd.ms-office.chartcolorstyle+xml",cpa:"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml",f8:"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml",g8:"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml",h8:"application/vnd.ms-office.drawingml.diagramDrawing+xml",i8:"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml",j8:"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml",k8:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",ebK:"application/vnd.ms-excel.threadedcomments+xml",fbK:"application/vnd.ms-excel.person+xml",gbK:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml",hbK:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml",ibK:"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml",l8:"application/vnd.ms-excel.slicer+xml",n8:"application/vnd.ms-excel.slicerCache+xml",djK:"application/vnd.ms-excel.timeline+xml",ejK:"application/vnd.ms-excel.timelineCache+xml",o8:"application/vnd.ms-office.vbaProject",p8:"application/vnd.openxmlformats-officedocument.vmlDrawing",q8:"application/vnd.ms-excel.controlproperties+xml",r8:"xml",s8:"vml",t8:"application/xml",u8:"jpg",v8:"image/jpg",jbK:"tiff",kbK:"image/tiff",w8:"jpeg",x8:"image/jpeg",lbK:"svg",mbK:"image/svg+xml",y8:"png",z8:"image/png",A8:"bmp",B8:"image/bmp",C8:"gif",D8:"image/gif",E8:"emf",F8:"image/x-emf",Wha:"wmf",Xha:"image/x-wmf",G8:"drawings",H8:"vmlDrawing",dpa:"/xl/charts",I8:"/xl/drawings",nbK:"/xl/persons",J8:"/xl/media",obK:"/xl/threadedComments",K8:"/xl/worksheets",L8:"/xl/tables",M8:"/xl/slicers",N8:"/xl/slicerCaches",fjK:"/xl/timelines",gjK:"/xl/timelineCaches",CiK:"/xl/ctrlProps",pbK:"externalLink",qbK:"/xl/externalLinks",rbK:"/xl/pivotCache",sbK:"/xl/pivotTables",tbK:"sheets",O8:"sheet",P8:"comments",epa:"chart",Q0a:"chartEx",R0a:"style",ubK:"person",S0a:"colors",Q8:"drawing",DiK:"ctrlProp",vbK:"threadedComment",R8:"image",S8:"table",T8:"slicer",U8:"slicerCache",hjK:"timeline",ijK:"timelineCache",wbK:"pivotCacheDefinition",jjK:"pivotCache",xbK:"pivotCacheRecords",ybK:"pivotTable",zbK:"External",AbK:"sheetPr",o7a:"dimension",Xkb:"extLst",BbK:"mergeCells",CbK:"mergeCell",DbK:"hyperlinks",uLc:"hyperlink",EbK:"sheetViews",FbK:"sheetFormatPr",GbK:"cols",HbK:"sheetData",IbK:"conditionalFormatting",JbK:"dataValidations",KbK:"dataValidation",LbK:"tableParts",V8:"/xl/sharedStrings.xml",W8:"/xl/theme/theme1.xml",X8:"/xl/worksheets",Y8:"/xl/workbook.xml",MbK:"/docProps/core.xml",NbK:"/docProps/app.xml",ObK:"/docProps/custom.xml",Z8:"/xl/styles.xml",_8:"/xl/theme/theme1.xml",PbK:"metadata.xml",a9:"/xl/_rels/workbook.xml.rels",QbK:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",c9:"http://schemas.openxmlformats.org/markup-compatibility/2006",d9:"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing",e9:"http://schemas.openxmlformats.org/drawingml/2006/main",g9:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac",RbK:"x14ac",SbK:"x14ac xr xr2 xr3",TbK:"xr",UbK:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision",VbK:"http://schemas.microsoft.com/office/spreadsheetml/2015/revision2",WbK:"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3",i9:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",j9:"http://schemas.openxmlformats.org/package/2006/content-types",k9:"http://schemas.openxmlformats.org/package/2006/relationships",l9:"http://schemas.openxmlformats.org/drawingml/2006/main",n9:"http://schemas.microsoft.com/office/drawing/2010/main",XbK:"http://schemas.microsoft.com/office/drawing/2016/SVG/main",o9:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",p9:"http://schemas.microsoft.com/office/excel/2006/main",q9:"http://schemas.openxmlformats.org/markup-compatibility/2006",s9:"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",r9:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",t9:"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main",YbK:"http://schemas.microsoft.com/office/spreadsheetml/2018/calcfeatures",ZbK:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",$bK:"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray",_bK:"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata",acK:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",bcK:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",ccK:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision",dcK:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",ecK:"http://purl.org/dc/elements/1.1/",fcK:"http://purl.org/dc/terms/",gcK:"http://purl.org/dc/dcmitype/",hcK:"http://www.w3.org/2001/XMLSchema-instance",icK:"application/vnd.openxmlformats-package.core-properties+xml",jcK:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",kcK:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",lcK:"application/vnd.openxmlformats-officedocument.extended-properties+xml",mcK:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",ncK:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",ocK:"application/vnd.openxmlformats-officedocument.custom-properties+xml"},b.RelationshipConstants={y7:"rId",k9:"http://schemas.openxmlformats.org/package/2006/relationships",pcK:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",qcK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",rcK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",b7:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",c7:"http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument",q7:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",r7:"http://purl.oclc.org/ooxml/officeDocument/relationships/styles",z7:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",k7:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",l7:"http://purl.oclc.org/ooxml/officeDocument/relationships/sharedStrings",o7:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",p7:"http://purl.oclc.org/ooxml/officeDocument/relationships/theme",scK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheDefinition",tcK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotCacheRecords",ucK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/pivotTable",A7:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",vcK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",B7:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",C7:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",D7:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",EiK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/ctrlProp",FiK:"http://purl.oclc.org/ooxml/officeDocument/relationships/extendedProperties",E7:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",F7:"http://purl.oclc.org/ooxml/officeDocument/relationships/drawing",wcK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",G7:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",H7:"http://purl.oclc.org/ooxml/officeDocument/relationships/image",I7:"http://schemas.microsoft.com/office/2007/relationships/slicer",J7:"http://schemas.microsoft.com/office/2007/relationships/slicerCache",apa:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",K0a:"http://schemas.microsoft.com/office/2014/relationships/chartEx",xcK:"http://purl.oclc.org/ooxml/officeDocument/relationships/chart",ycK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartUserShapes",zcK:"http://schemas.microsoft.com/office/2011/relationships/chartColorStyle",AcK:"http://schemas.microsoft.com/office/2011/relationships/chartStyle",BcK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",XgK:"http://schemas.microsoft.com/office/2011/relationships/timeline",YgK:"http://schemas.microsoft.com/office/2011/relationships/timelineCache"},b.WorkbookNodeOrder=["bookViews",b.XFileConstants.tbK,"externalReferences","definedNames","calcPr","pivotCaches","extLst"],b.WorkSheetNodeOrder=[b.XFileConstants.AbK,b.XFileConstants.o7a,b.XFileConstants.EbK,b.XFileConstants.FbK,b.XFileConstants.GbK,b.XFileConstants.HbK,"sheetProtection","autoFilter",b.XFileConstants.BbK,b.XFileConstants.IbK,b.XFileConstants.JbK,b.XFileConstants.DbK,"printOptions","pageMargins","pageSetup","headerFooter","rowBreaks","colBreaks","picture","drawing",b.XFileConstants.yhK,b.XFileConstants.qkK,b.XFileConstants.BiK,b.XFileConstants.yiK,b.XFileConstants.LbK,b.XFileConstants.Xkb];
},"./dist/core/excel-io-util/range-parser.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/excel-io-util/excel-types.js"),e=c("./dist/core/excel-io-util/common.js"),f=c("./dist/core/util/common.js"),g=d.XmlConstants.M7,h=d.XmlConstants.L7;function j(a){return a.col===-1||a.colCount===-1}function k(a){return a.row===-1||a.rowCount===-1}i=function(){function a(){}return a.CcK=function(b,c,d){var e,f=[];return null===b?f:(e=b.replace(/('.+')/g,"").split(" "),e.forEach(function(b){var e=a.DcK(b,c);!e||e.row>g||e.col>h||e.rowCount>g||e.col>h||(!d||e.row+e.rowCount!==g&&e.col+e.colCount!==h)&&f.push(e)}),f)},a.DcK=function(a,b){var c,d,i,j,k,l,m,n=f.kf(0,0,0,0),o=a.indexOf("!");if(o>-1&&(a=a.substr(o+1)),c=a.split("$").join(""),c=c.split(":"),1===c.length){if(l=c[0],d=e.IndexHelper.P9(l),i=e.IndexHelper.Q9(l),d===-1&&i===-1)return null;n.row=d,n.col=i,n.rowCount=1,n.colCount=1}else 2===c.length&&(l=c[0],m=c[1],d=e.IndexHelper.P9(l),i=e.IndexHelper.Q9(l),j=e.IndexHelper.P9(m),k=e.IndexHelper.Q9(m),n.row=d,n.col=i,n.rowCount=j-d+1,n.colCount=k-i+1,b||0!==d||n.rowCount!==g||(n.row=-1,n.rowCount=-1),b||0!==i||n.colCount!==h||(n.col=-1,n.colCount=-1));return n},a.EcK=function(a,b){var c,d,f,i,j,k;if(a)return c=b?"$":"",d=a.row,f=a.col,i=a.rowCount,j=a.colCount,k=e.IndexHelper.R9(f),1===i&&1===j?c+k+c+(d+1):d===-1||i===-1?c+k+c+"1:"+c+e.IndexHelper.R9(f+j-1)+c+g:f===-1||j===-1?c+"A"+c+(d+1)+":"+c+e.IndexHelper.R9(h)+c+(d+i):0===i&&0===j?c+k+c+(d+1):c+k+c+(d+1)+":"+c+e.IndexHelper.R9(f+j-1)+c+(d+i)},a.FcK=function(b,c){var d,e,f,g;if(b){for(d=[],e=0,f=b;e<f.length;e++)g=f[e],d.push(a.EcK(g,c));return d.join(" ")}},a.getRangeString=function(a){var b,c,d,f,i,l,m,n,o=[];for(b=0,c=a;b<c.length;b++)d=c[b],j(d)&&(d.col=0,d.colCount=h),k(d)&&(d.row=0,d.rowCount=g),f=d.row,i=d.row+d.rowCount-1,l=d.col,m=d.col+d.colCount-1,n=e.IndexHelper.R9(l)+(f+1),(d.rowCount>1||d.colCount>1)&&(n+=":"+e.IndexHelper.R9(m)+(i+1)),o.push(n);return o.join(" ")},a}(),b.range_parser=i},"./dist/core/lc/common.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/core.ns.js"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),h=g.Ul.lZa,i=c("./dist/core/lc/lcValidator.js"),j=i.umK,k=i.vmK,l="object"==typeof global&&global&&global.Object===Object&&global,m="object"==typeof self&&self&&self.Object===Object&&self,n=l||m||Function("return this")(),o=/^[\w\-]+$/i,p=/^[0-9.]+$/,q="m",r="n",s="b",t="d",u="e",v="adr",w=k("XRsZ"),x=k("HUkJ"),y=k("T&g"),z=k("Q&w"),A=k("GRz1"),B=k("XSzB"),C=k("XRwh"),D=k("WQs5"),E="JYx3Gb#8Pb5R",F=["Ivldlcneky mi pedslsgaeiycmi o edassac.","nai ies e.Ealsra.ae@rpct.o fyune sitne"];function H(){return G}function I(a,b){var c,d,e,f,g="",h=0;for(c=0;c<a.length;c++)h=Math.max(h,a[c].length);for(c=0;c<h;c++){for(b&&(d=""),f=0;f<a.length;f++)b?d+=c>=a[f].length?"00":a[f].charAt(c)+a[f].charAt(c+1):c<a[f].length&&(g+=a[f].charAt(c));b&&(e=parseInt(d,16),g+=String.fromCharCode(e),c++)}return g}function J(a,b,c){var d,e=I(["Lcnee","iesKy"]),f=H()[e],g="ZCTW";return j(f,{pK:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w==",aC:"B1"},function(e){d=K(e,g),d.hl=!!f,d.m=f?d.m:-1,b.call(a,d),N(d,a,f,c)},function(){d=K(),d.hl=!!f,d.m=f?d.m:-1,b.call(a,d),N(d,a,f,c)}),d}b.umK=J;function K(a,b){var c,d,e,f,g={isVd:function(a){var b=this;return a=1===H().Workbook.lm||a,b.s&&!b.e&&(!b.adr||!!b.adr.dsr==!!a)}},h=U(),i=function(){var g,i,j,k,l,m,n;if(!a)return!1;if(g=a[x],!g||!g.length)return!1;for(k=0,l=g.length;k<l;k++)if(i=g[k],j=i&&i[z]===b){c=i[y];break}if(!j)return!1;if(a[D]&&(f=a[D]),a[C]){if(m=new Date,n=L(a[C]),e=Math.ceil((n-m)/864e5),d=e<=0)return!1}else e=void 0;return!!(h||!a[A]&&!a[B]||S(a[A],a[B])||T(a[A],a[B]))};return g[s]=h,g.s=i(),g[q]=a?a[w]?-1:1:0,g[r]=c,g[u]=d,d||(g[t]=e),g[v]=f,g}function L(a){return new Date(M(a.substr(0,4))||0,M(a.substr(4,2))-1||0,M(a.substr(6,2))||0)}function M(a){return parseInt(a,10)}function N(a,b,c,d){var e,f,g,h,i,j;$(a)?(a&&a.adr&&a.adr.dsr!==!0&&(e=a.adr.flg||[],f={},g=a.m,h=a.d,H().Workbook.ao(b,"adlc",{flg:e,checkRs:f,m:g,d:h,fn:O}),void 0!==f.nwm&&(a.wm=f.wm,a.nwm=f.nwm,f.dis&&(i=a.disL||[],i.push(I(["",f.dis],!0)),a.disL=i),f.state&&(a[f.state[0]]=f.state[1]))),c||(f={},g=a.m,h=a.d,j=1,1!==H().Workbook.lm&&H().Workbook.ao(b,"adlc",{flg:[],checkRs:f,m:g,d:h,nl:j}),void 0!==f.nwm&&(a.wm=f.wm,a.nwm=f.nwm)),d||b.repaint&&!b.Js&&b.repaint()):aa(b,a)}function O(a,b,c){var d,e=["rs"];a&&(d=I(["",b],!0),a[d]&&a[d][c+e]&&a[d][c+e]())}function P(a,b){var c,d,e,f,g;if(!a||0!==a.indexOf("//"))return!1;if(c=a.slice(2).split("/"),c.length<1)return!1;for(d=c[0],e=0,f=b.length;e<f;e++)if(g=b[e],g===d)return!0;return!1}function Q(a,b){var c,d,e,f,g;for(c=0,d=b.length;c<d;c++){if(e=b[c],f=!1,e&&0===e.lastIndexOf("*.",0)&&(f=!0),e=f?e.slice(2):e,e===a)return!0;if(f&&(g=a.indexOf("."+e),g>0&&g===a.length-e.length-1))return!0}return!1}function R(a,b){var c,d,e,f;if(a&&4===a.split(".").length)for(c=0,d=b.length;c<d;c++)if(e=b[c],e&&(f=e.length-2,f>0&&(e===a||".*"===e.substr(f)&&a.substr(0,f)===e.substr(0,f)&&p.test(a))))return!0;return!1}function S(a,b){var c,d,e,f;return!!Y()&&(c=k(E),d=k("1agFGc#UHbw5"),e=n[c]&&n[c][d],!!e&&(e=e.toLowerCase(),f=a.split(","),!(!a||!P(e,f))))}function T(a,b){var c,d=k(E),e=k("Zdg3Ga#UHbw5"),f=n[d]&&n[d][e];return!f||(f=f.toLowerCase(),c=a.split(","),!(!a||!Q(f,c))||!(!a||!R(f,c)))}function U(){var a=k(E);return V(n[a])}function V(a){var b=k("VdgJHc#wJb59"),c=k("Zdg3Ga#UHbw5");return a&&(W(a[b])||X(a[b])||Z(a[c]))}function W(a){var b=k("MlSZto#Z");return a&&a===b}function X(a){var b=k("yXbog&w");return a&&a===b}function Y(){var a=k(E),b=k("VdgJHc#wJb59"),c=k("Udg36Y#oUddV"),d=n[a];return d&&d[b]===c}function Z(a){var b=k("4LJITMx8UMcA"),c=k("jOxo"),d=k("JYw3Gb4NOb6x"),e=k("g1Jbww#Y"),f=RegExp("^[\\w\\-]+\\."+e+"$","i");return a&&(a===b||a===c||a===d||o.test(a)||f.test(a))}function $(a){return a&&(a.isVd(!1)||a.b&&!a.hl)}function _(a,b){var c,d,e,f,g,h,i,j,k,l;G=b,d=b.Workbook.prototype,e=d.ad,d.ad=function(){var a=this;if(J(a,function(b){a.ls=b,c=b,a.ul=function(){J(a,function(b){a.ls=b,c=b})}}),!c||$(c))return e.apply(a,arguments)},d.nslc=function(){this.EDc=!0},b.PivotTableManager&&(f=b.PivotTableManager.prototype,g=f.Lla,f.Lla=function(){g.apply(this,arguments),c||this.parent||J(this,function(a){c=a})}),h=b.Worksheet.prototype,i=h.ad,h.ad=function(){if(c||this.parent||J(this,function(a){c=a}),!c||$(c))return i.apply(this,arguments)},j=b.oJ.prototype,k=j.Pw,j.Pw=function(b,d){k.apply(this,arguments),c&&(c.m===-1||!c.hl&&c.b)?a(this.kj,b,d,c):c&&c.m&&c.nwm&&(1===c.m||1===c.m&&void 0===c.d)&&a(this.kj,b,d,c)},l=j.RI,j.RI=function(b,d){l.apply(this,arguments),c&&(c.m===-1||!c.hl&&c.b)&&a(this.kj,b,d,c)}}b.Gb=_;function aa(a,b){var c,d;function e(){d.width=f.GC$(c).width(),d.height=f.GC$(c).height(),fa(d.getContext("2d"),d.width,d.height,b)}a.wmK||(a.wmK=!0,c=a.qo,a.sheets=[],a.ECJ=[],a.no(),c&&(d=document.createElement("canvas"),c.appendChild(d),e(),f.GC$(window).bind("resize",function(){setTimeout(e,100)})))}b.hyc=aa;function ba(a){var b=new d.Common.ResourceManager(e.SR);return b.getResource()[a]}function ca(a,b,c){var d,e,f,g,h,i,j,k,l=ba(I([a,"s"])),m=ba(1===H().Workbook.lm?I(["ld","se"]):I(["lr","su"])),n=ea(l,b);for(m=ea(m,b),n=n.replace("{0}",c.d),n=n.replace("{1}",m).replace("{1}",m),d=[],e=0,f=0;f<n.length;f++)"\r"!==n[f]&&"\n"!==n[f]||(d.push(n.substring(e,f)),"\r"===n[f]&&f<n.length-1&&"\n"===n[f+1]&&f++,e=f+1);for(e<n.length&&d.push(n.substring(e,n.length)),g=c.wm||[],h=[],i=0,j=g.length;i<j;i++)k=g[i],h.push(""),k instanceof Array?h.push(I(k,!0)):h.push(I(["",k],!0));return 1===c.m&&c.nwm?[].concat(h):c.wm&&c.wm.length>0?d.concat(h):d}b.e6=ca;function da(a){return ba(I([a,"sa"]))}b.xmK=da;function ea(a,b){var c,d,e,f=!0,g="";if(a)if("string"==typeof a)a=a.trim(),a&&(c=[a]);else if(Array.isArray(a)){for(d=!0,c=[],e=0;e<a.length;e++)g=a[e].trim(),c.push(g),d&&g&&(d=!1);d&&(c=null)}return c||(f=!1,c=b),I(c,f)}function fa(a,b,c,d){var e,f,g,i,j,k,l="16pt calibri";if(!d||!d.isVd(!1))for(e=d.hl?d.adr&&d.adr.dsr?"l4":d.e?"l5":"l4":"l3",f=ca(e,F,d),h(a,l),a.fillStyle="black",a.fillRect(0,0,b,c),a.fillStyle="white",g=20,i=30,j=0;j<f.length;j++)k=f[j],a.fillText(k,g,i),i+=25}},"./dist/core/lc/lcRegister.js":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/lc/releaseLc.js"),e=c("./dist/core/util/domUtil.js"),f=e.GC$.sd,g=[],e.GC$[f]=function(a,b){g.push(a),b?i(b):h||(h=setTimeout(i,5e3*Math.random()+3e3))};function i(a){if(h=null,g[0])try{var b=g[0].tc;b&&b.qo&&d.umK(b,function(c){var e,f,g,h,i,j,k,l=b.getActiveSheet();if(l&&(e=l.l,e&&(c=e),a||e||c.b||c.m!==-1||!c.d||(c.s=!1,d.hyc(b,c)),c.nwm))for(f=c.disL||[],g=0,h=f;g<h.length;g++)i=h[g],j=l[i],j&&(k=j.adrs,k&&k.apply(j))},!0)}finally{g=[]}}},"./dist/core/lc/lcValidator.js":function(a,b){var c=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="dist",c(0)}([function(a,b){(function(a){"use strict";var c,d,e,f,g,h,i,j,k,l;Object.defineProperty(b,"__esModule",{value:!0}),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},d="undefined"!=typeof window,e=String.fromCharCode,f=d&&window.Uint8Array||m,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="object"==(void 0===a?"undefined":c(a))&&a&&a.Object===Object&&a,i="object"==("undefined"==typeof self?"undefined":c(self))&&self&&self.Object===Object&&self,j=h||i;function m(a){var b,d;if("number"==typeof a)for(b=Array(a),d=0;d<a;++d)b[d]=0;else b=a.slice(0);return b.buffer=b,b.byteLength=b.length,"object"===(void 0===a?"undefined":c(a))&&a.buffer&&(b.buffer=a.buffer),b}function n(a,b,c,d){return 1==a.length?a:(a.splice(c,1,d(a.splice(b,1,d(a[c]))[0])),a)}function o(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,c=a.charCodeAt(0);return c>=65&&c<=90?a.toLowerCase():c>=97&&c<=122?a.toUpperCase():c>=48&&c<=57?e(48+(c-48+10+b)%10):a}function p(a){var b,c=a.split(""),d=function a(b){return o(b,-1)};for(b=c.length-5;b>=0;b--)n(c,b+1,b+3,d),n(c,b,b+2,d);return c.join("")}function q(a){return a.split("").reverse().join("")}function r(a){var b,c,d,e,f,h,i,j,k,l=[],m="",n=g,o=a,p=o.length%3;if(p>0)for(;p++<3;)m+="=",o+="\0";for(p=0;p<o.length;p+=3)b=o.charCodeAt(p),c=o.charCodeAt(p+1),d=o.charCodeAt(p+2),e=b<<16|c<<8|d,f=e>>18&63,h=e>>12&63,i=e>>6&63,j=63&e,l[p/3]=n.charAt(f)+n.charAt(h)+n.charAt(i)+n.charAt(j);return k=l.join(""),k=k.slice(0,k.length-m.length)+m}function s(a){var b,c,d,f,h,i,j,k,l,m,n=[],o=g,p=a;for(m=0;m<p.length;m+=4)f=o.indexOf(p.charAt(m)),h=o.indexOf(p.charAt(m+1)),i=o.indexOf(p.charAt(m+2)),j=o.indexOf(p.charAt(m+3)),k=f<<18|h<<12|i<<6|j,b=k>>>16&255,c=k>>>8&255,d=255&k,n[m/4]=e(b,c,d),64==j&&(n[m/4]=e(b,c)),64==i&&(n[m/4]=e(b));return l=n.join("")}function t(a){return(d&&window.atob||s)(a)}function u(a){return(d&&window.btoa||r)(a)}function v(a){return decodeURIComponent(Array.prototype.map.call(t(a),function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function w(a){return u(encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,function(a,b){return e(parseInt(b,16))}))}function x(a){var b,c;return a?(b=p(a),b=q(b),c=Math.ceil(b.length/2),b=b.substr(c)+b.substr(0,c),b=b.replace("#","="),b=b.replace("&","=="),v(b)):""}k=b.iDe=x;function y(a){var b,c=t(a),d=c.length,e=new f(d);for(b=0;b<d;b++)e[b]=c.charCodeAt(b);return e.buffer}function z(a){var b,c,d=new ArrayBuffer(a.length),e=new f(d);for(b=0,c=a.length;b<c;b++)e[b]=a.charCodeAt(b);return d}function A(a){return e.apply(null,new f(a))}function B(a){return a.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")}function C(a){var b,c,d,e=0,f=5381,g=0;for(b=a.length-1;b>=0;b--)c=a.charCodeAt(b),e=c+(e<<6)+(e<<16)-e,f=c+((f<<5)+f),g=c+((g<<5)-g),g&=g;return d=e^f^g,d<0&&(d=~d),d.toString(16).toUpperCase()}function D(a){return a&&JSON.parse(a)||void 0}function E(a,b){try{b="#"+b;var c=a.indexOf(b);if(c>-1)return{prefix:a.substring(0,c),licData:JSON.parse(x(a.substr(c+b.length)))}}catch(a){}return!1}function F(a){return"oncomplete"in a&&(a.then=function(b,c){a.resolve=b,a.reject=c},a.oncomplete=function(b){a.resolve(a.result)},a.onerror=function(){a.reject()}),a}l=b.attorn=function a(b,c,e,f){var g,h,i,k,l,m,n,o=d?window.msCrypto?window.msCrypto:window.crypto:void 0,p=E(b,c.aC);if(!p)return f();g=p.licData,h=p.prefix+"#"+c.aC,i=A(y(w(h+JSON.stringify(g.D))));function q(){return C(h+JSON.stringify(g.D))===g.H?e(g.D):f()}return k=x("JYx3Gb#8Pb5R"),l=x("VdgJHc#wJb59"),j[k]&&j[k][l]&&!location.protocol.match(/^https/i)?q():o&&o.subtle?(m={alg:"PS256",e:"AQAB",kty:"RSA",n:B(c.pK)},m=window.msCrypto?z(JSON.stringify(m)):m,n={name:"RSA-PSS",saltLength:32,hash:{name:"SHA-256"}},F(o.subtle.importKey("jwk",m,n,!1,["verify"])).then(function(a){F(o.subtle.verify(n,a,y(g.S),z(i))).then(function(a){return a?e(g.D):f()})},function(){return q()}),void 0):q()}}).call(b,function(){return this}())}]);a.exports={umK:c.attorn,vmK:c.iDe}},"./dist/core/lc/releaseLc.js":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/lc/common.js"),e=c("./dist/core/util/common.js"),f=e.Ul.lZa,g=["LcneNtFud\no edavldlcnekyt u pedSet.\neprr esaeaalbefreauto.\nfyuprhsdalcne orkyi nyu ucaecnimto mi.\nmi sslsgaeiycmi o edassac.","ies o on\rYune  ai ies e ornSra.hes\rTmoayky r vial o vlain\rI o ucae  ies,yu e si orprhs ofraineal\rEalu.ae@rpct.o fyune sitne"],h=Math.max;function i(a,b,c,e){var i,j,k,l,m,n,o,p,q,r,s=a.am(),t=203,u=a.parent,v="11pt calibri",w=e.hl&&e.isVd(!1)&&e.d,x=u&&u.EDc,y="";for(w?i="l2":e.e?i="l5":e.hl&&!e.d?i="l6":(i="l1",j=d.xmK(i)),s=s||a.am(),k=d.e6(i,g,e),l=0,j&&k.forEach(function(b){l=h(l,a.dp(b,v))}),a.l=k[0]?e:void 0,m=0;m<k.length&&(s.width>t||s.height>t)&&!x;m++)y=k[m],n=l||a.dp(y,v),o=10,p=20,q=s.width-n-o,r=s.height-o-p*(k.length-m),!b||c&&!c.intersect(q,r,n,p)||(b.save(),b.fillStyle="rgba(0, 0, 0, 0.5)",f(b,v),c&&(b.rect(c.x,c.y,c.width,c.height),b.clip(),b.beginPath()),b.fillText(y,q,r+p),y&&(a.l=e),b.restore())}function j(a){d.Gb(i,a)}b.Gb=j,b.Soa=1,b.umK=d.umK,b.hyc=d.hyc},"./dist/core/util/basedialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/common.js"),e=c("./dist/core/util/domUtil.js"),f=e.GC$,g=d.util.Nl,h=d.util.Ml,i=d.util.nl,j=document,k=window,l=k.Yl,m="touchstart",n="MSPointerDown",o="pointerdown",p=function(){function a(a,b,c){this.QZJ="gc-popup",this.MZJ="gc-overlay",this.AWa=null;var d=this;d.qo=a,d.zWa=c,b=b||0,d.to={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:b,backgroundColor:"rgba(0,0,0,0)"},d.uo={position:"absolute",padding:0,margin:0,height:"auto",zIndex:b+1,outline:"none"},d.ad()}return a.prototype.ad=function(){var a=this;a.vo(a.Cj)?a.xo=f("#"+a.Cj):(a.Cj=a.wo(),a.so=a.MZJ+"-"+a.Cj,a.c4=a.QZJ+"-"+a.Cj,a.xo=f(g("div")).addClass(a.c4+" ui-widget").attr({id:a.Cj,tabIndex:-1}).css(a.uo))},a.prototype.wo=function(){for(var a=0,b="gc-dialog";this.vo(b+(""+a));)a++;return b+(""+a)},a.prototype.yo=function(){if(this.xo)return this.xo},a.prototype.zo=function(){return this.qo?this.qo:j.body},a.prototype.Ao=function(a){var b=this,c=b.xo;b.Bo()||b.Co(),l.Gm(),b.vo(b.Cj)||(f(b.zo()).append(c),b.Do(),c.css("display","none")),c.show(a)},a.prototype.cXa=function(){return"block"===this.xo.css("display")},a.prototype.close=function(){var a=this;a.JZJ(),a.vo(a.Cj)&&a.xo.remove(),f("."+a.c4).isVisible()||a.Eo(),l.Hm()},a.prototype.Eo=function(){f("."+this.so).remove(),this.AWa=null},a.prototype.JZJ=function(){var a=this.Cj;[m,n,o].forEach(function(b){f(j).unbind(b+"."+a)})},a.prototype.Do=function(){var a,b,c,d,e,g,h,i,k,l,m,n=this.xo,o=this.zo();0!==n.length&&(a=f(o).offset(),b=parseInt(n.css("left"),10)+a.left,c=parseInt(n.css("top"),10)+a.top,d=n.width(),e=n.height(),isNaN(b)||isNaN(c)||isNaN(d)||isNaN(e)||(g=0,h=0,i=j.documentElement,k=i.clientWidth,l=i.clientHeight,m=n[0].getBoundingClientRect(),m.left+d>k&&(h=m.left+d-k),m.top+e>l&&(g=m.top+e-l),(b<0||c<0||g>0||h>0)&&(b-=h,c-=g,b<0&&(b=0),c<0&&(c=0),n.css({left:b-a.left+"px",top:c-a.top+"px"}))))},a.prototype.vo=function(a){return f("#"+a).length>0},a.prototype.Co=function(){var a,b,c=this,d=c.Cj,e=f(g("div")).addClass(c.so),l=c.xo;c.AWa=e,e.css(c.to),f(c.zo()).append(e),a=h&&h.mozilla,a&&(b=(new Date).valueOf()),e.bind("mousedown",function(d){if(!c.zWa){if(a){var e=(new Date).valueOf();if(e-b<100)return}c.close(),a&&c.Fo&&clearTimeout(c.Fo)}i(d)}),e.bind("contextmenu",function(a){c.zWa&&i(a)}),l.bind("contextmenu",function(a){i(a)}),[m,n,o].forEach(function(b){f(j).bind(b+"."+d,function(b){var d=b.target;c.AWa&&!c.KZJ(d)&&(c.zWa||(a?c.Fo=k.setTimeout(function(){c.close()},100):c.close()),i(b))})})},a.prototype.OZJ=function(a,b){for(var c=a;b&&b!==document.body;){if(b===c)return!0;b=b.parentNode}return!1},a.prototype.KZJ=function(a){return!!this.xo&&this.OZJ(this.xo.get(0),a)},a.prototype.Bo=function(){return f("."+this.so).length>0},a}(),b.Go=p},"./dist/core/util/common.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/core.ns.js"),g=c("./dist/core/core.enum.js"),h=c("./dist/core/excel-io-util/common.js"),i=c("@grapecity/js-calc"),j=c("./dist/core/worksheet/stylehelper.js"),k=e.GC$,l=k.extend,m=d.Common.o,n=d.Common.k.Uo,o=d.Formatter&&d.Formatter.GeneralFormatter,p=d.Formatter&&d.Formatter.lxb,q=d.Common.j.Fa,r=h.StringEx.M9,s=d.Common.u,t=!!i,u=new d.Common.ResourceManager(f.SR),v=u.getResource.bind(u),b.FallbackFontFamily='"Helvetica Neue", Arial, sans-serif',w=h.Util.addXLFNPrefix,x=window,y=document,z="boolean",A="date",B="undefined",C="function",D=void 0,E=null,F=Math.floor,G=Math.ceil,H=Math.min,I=Math.max,J=Math.round,K=parseInt,L=parseFloat,M=isNaN,N=.7,O="px",P=" ",Q=".",R="string",S="number",T="touch",U="MSPOINTER_TYPE_TOUCH",V=RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),W=RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),X="\u200b",Y=["=","+","-"];function Ia(a){return a!==D}b.isDefined=Ia;function Ja(a){return y.createElement(a)}function Ka(a){y.body&&y.body.insertBefore(a,E)}function La(a,b,c){Object.defineProperty(a,b,{get:function(){return this._ps[b]},set:function(a){var d=this._ps[b];d!==a&&(this._ps[b]=a,c&&c(b,a,d))},enumerable:!0})}function Ma(a,b){if(a.style&&a.style.vertAlign){var c=j.To.No(b,1);return c.fontSize*N+"px "+c.fontFamily}return b}b.productInfo={productVersion:"16.0.2"},b.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize"},b.getTypeFromString=function(a){var b,c,d,e=!1,f=x;if(typeof a===R){for(b=a.split(Q),c=0,d=b.length;c<d&&f;c++)f=f[b[c]];f&&c===d&&d>0&&(e=!0)}return e?f:D},b.findControl=function(a){return typeof a===R&&(a=y.getElementById(a)),k(a).data("workbook")};function Na(a){return a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!1,a.returnValue=!1),!1}function Oa(a){var b,c,d=!1;if(a)for(b=0;b<a.length;b++)if(c=a.charCodeAt(b),c>=11904&&c<12032||c>=12288&&c<40960||c>=43360&&c<43392||c>=63744&&c<64256){d=!0;break}return d}function Pa(a){return Math.random().toString(16).slice(-a)}function Qa(a){return function(b,c){return String.fromCharCode(parseInt(c,a))}}function Ra(a){if(!a||"string"!=typeof a)return!1;a=a.toLowerCase();var b=a[0];switch(b){case"b":return 0===a.indexOf("background ");case"t":return 0===a.indexOf("text ");case"a":return 0===a.indexOf("accent ");case"h":return 0===a.indexOf("hyperlink");case"f":return 0===a.indexOf("followedhyperlink");default:return!1}}b.isThemeColor=Ra;function Sa(a,b,c){var d,e,f=0,g=a.split(" ");if(g.length>=3&&(f=parseFloat(g[2]),isNaN(f)||(f/=100)),"Background 1"===a.substring(0,12)&&(d=b?243:0),"Text 1"===a.substring(0,6)&&(d=b?241:1),"Background 2"===a.substring(0,12)&&(d=b?244:2),"Text 2"===a.substring(0,6)&&(d=b?242:3),"Accent 1"===a.substring(0,8)&&(d=4),"Accent 2"===a.substring(0,8)&&(d=5),"Accent 3"===a.substring(0,8)&&(d=6),"Accent 4"===a.substring(0,8)&&(d=7),"Accent 5"===a.substring(0,8)&&(d=8),"Accent 6"===a.substring(0,8)&&(d=9),"hyperlink"===a.substring(0,8)&&(d=10),"followedHyperlink"===a.substring(0,8)&&(d=11),d!==D)return e=c||"color",{n_:e,theme:d,tint:f}}function Ta(a,b){var c=a.tint?Math.round(100*a.tint):0,d=+a.theme;return 0===d||243===d?"Background 1 "+c:1===d||241===d?"Text 1 "+c:2===d||244===d?"Background 2 "+c:3===d||242===d?"Text 2 "+c:4===d?"Accent 1 "+c:5===d?"Accent 2 "+c:6===d?"Accent 3 "+c:7===d?"Accent 4 "+c:8===d?"Accent 5 "+c:9===d?"Accent 6 "+c:10===d?"hyperlink":11===d?"followedHyperlink":void 0}Z=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,4278190080,4294967295],$={aliceblue:4293982463,antiquewhite:4294634455,aqua:4278255615,aquamarine:4286578644,azure:4293984255,beige:4294309340,bisque:4294960324,black:4278190080,blanchedalmond:4294962125,blue:4278190335,blueviolet:4287245282,brown:4289014314,burlywood:4292786311,cadetblue:4284456608,chartreuse:4286578432,chocolate:4291979550,coral:4294934352,cornflowerblue:4284782061,cornsilk:4294965468,crimson:4292613180,cyan:4278255615,darkblue:4278190219,darkcyan:4278225803,darkgoldenrod:4290283019,darkgray:4289309097,darkgreen:4278215680,darkkhaki:4290623339,darkmagenta:4287299723,darkolivegreen:4283788079,darkorange:4294937600,darkorchid:4288230092,darkred:4287299584,darksalmon:4293498490,darkseagreen:4287609999,darkslateblue:4282924427,darkslategray:4281290575,darkturquoise:4278243025,darkviolet:4287889619,deeppink:4294907027,deepskyblue:4278239231,dimgray:4285098345,dodgerblue:4280193279,feldspar:4291924597,firebrick:4289864226,floralwhite:4294966e3,forestgreen:4280453922,fuchsia:4294902015,gainsboro:4292664540,ghostwhite:4294506751,gold:4294956800,goldenrod:4292519200,gray:4286611584,green:4278222848,greenyellow:4289593135,honeydew:4293984240,hotpink:4294928820,"indianred ":4291648604,"indigo ":4283105410,ivory:4294967280,khaki:4293977740,lavender:4293322490,lavenderblush:4294963445,lawngreen:4286381056,lemonchiffon:4294965965,lightblue:4289583334,lightcoral:4293951616,lightcyan:4292935679,lightgoldenrodyellow:4294638290,lightgrey:4292072403,lightgreen:4287688336,lightpink:4294948545,lightsalmon:4294942842,lightseagreen:4280332970,lightskyblue:4287090426,lightslateblue:4286869759,lightslategray:4286023833,lightsteelblue:4289774814,lightyellow:4294967264,lime:4278255360,limegreen:4281519410,linen:4294635750,magenta:4294902015,maroon:4286578688,mediumaquamarine:4284927402,mediumblue:4278190285,mediumorchid:4290401747,mediumpurple:4287852760,mediumseagreen:4282168177,mediumslateblue:4286277870,mediumspringgreen:4278254234,mediumturquoise:4282962380,mediumvioletred:4291237253,midnightblue:4279834992,mintcream:4294311930,mistyrose:4294960353,moccasin:4294960309,navajowhite:4294958765,navy:4278190208,oldlace:4294833638,olive:4286611456,olivedrab:4285238819,orange:4294944e3,orangered:4294919424,orchid:4292505814,palegoldenrod:4293847210,palegreen:4288215960,paleturquoise:4289720046,palevioletred:4292374675,papayawhip:4294963157,peachpuff:4294957753,peru:4291659071,pink:4294951115,plum:4292714717,powderblue:4289781990,purple:4286578816,red:4294901760,rosybrown:4290547599,royalblue:4282477025,saddlebrown:4287317267,salmon:4294606962,sandybrown:4294222944,seagreen:4281240407,seashell:4294964718,sienna:4288696877,silver:4290822336,skyblue:4287090411,slateblue:4285160141,slategray:4285563024,snow:4294966010,springgreen:4278255487,steelblue:4282811060,tan:4291998860,teal:4278222976,thistle:4292394968,tomato:4294927175,turquoise:4282441936,violet:4293821166,violetred:4291829904,wheat:4294303411,white:4294967295,whitesmoke:4294309365,yellow:4294967040,yellowgreen:4288335154,transparent:16777215},_=function(){function a(){}return a.hexToARGB=function(a){return"string"==typeof a&&(a=parseInt(a,16)),{r:a>>16&255,g:a>>8&255,b:255&a,a:a>>24&255}},a.getClosestColorIndex=function(b,c){var d,e,f,g,h,i,j,k;for(c===D&&(c=64),d=-1,e=Number.MAX_VALUE,f=Math.min(a.palette.length-1,c);f>=0;f--)g=a.palette[f],h=(16711680&g)>>16,i=(65280&g)>>8,j=255&g,k=Math.abs(.3*(h-b.r))+Math.abs(.59*(i-b.g))+Math.abs(.11*(j-b.b)),k<e&&(e=k,d=f);return d},a.getHexNumString=function(a){var b,c=+a;return isNaN(c)?a+"":(a=c,b=a.toString(16),a<16&&(b="0"+b),b)},a.convertColorToHex=function(b){var c,d,e,f,g,h;if(b)return"string"!=typeof b?b:(c=b.toLowerCase(),"#"===c.substring(0,1)?7===c.length?d="FF"+c.substring(1).toUpperCase():4===c.length&&(e=c[1]+c[1]+c[2]+c[2]+c[3]+c[3],d="FF"+e.toUpperCase()):"rgb("===c.substring(0,4)?(g=c.indexOf("("),h=c.indexOf(")"),f=c.substring(g+1,h).split(","),e=a.getHexNumString(f[0])+a.getHexNumString(f[1])+a.getHexNumString(f[2]),d="FF"+e.toUpperCase()):"rgba("===c.substring(0,5)?(g=c.indexOf("("),h=c.indexOf(")"),f=c.substring(g+1,h).split(","),e=a.getHexNumString(f[3])+a.getHexNumString(f[0])+a.getHexNumString(f[1])+a.getHexNumString(f[2]),d=e.toUpperCase()):$[c]&&(d=$[c].toString(16).toUpperCase()),d)},a.convertHexColorToArgb=function(b){return a.hexToARGB(a.convertColorToHex(b))},a.getIndexedColor=function(a){var b,c,d,e;return 32767===a?"#000000":64===a||65===a?D:a<0||a>=Z.length?"#000000":Z[a]!==D?(b=Z[a],c=b>>16&255,d=b>>8&255,e=255&b,"rgb("+c+","+d+","+e+")"):void 0},a.palette=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,4278190080],a}(),b.ColorHelper=_;function Ua(a){return _.getIndexedColor(+a.indexed)}function Va(a,b){var c,d=_.convertColorToHex(a);if(d)return c=b||"color",{n_:c,rgb:d}}aa=/&#(\d+);/g,ba=/&#x([0-9A-F]+);/gi,ca=/&amp;/g,da=/&gt;/g,ea=/&lt;/g,fa=/&quot;/g,ga=/&apos;/g,ha=function(){function a(){}return a.xq=function(a){for(var b,c="";a>0;a=parseInt((a-1)/26+"",10))b=(a-1)%26,c=String.fromCharCode(65+b)+c;return c},a.ol=function(b,c,d,e){if(3===b){var f=k.getType(c);b=d&&"@"===d?0:f===z?1:f===S||f===A?2:f===R&&a.YGb(c)?2:0,e&&0!==e&&(e>0?b=0:e<0&&(b=2),e===-90?b=0:90===e&&(b=2))}return b},a.YGb=function(b){return a.ZGb.test(b)},a.bc=function(b){var c,e=k.getType(b);return b===E||b===D?b="":e===z?b=(""+b).toUpperCase():e===A?(c=0===b.getHours()&&0===b.getMinutes()&&0===b.getSeconds()&&0===b.getMilliseconds(),b=d.Common.l.Vb(b,c?"M/d/yyyy":"M/d/yyyy h:mm:ss")):b=b.richText?a.K_a(b):""+b,b},a.ql=function(a,b,c,d,e,f,g){var h,i,j,l,m,n,o=k(a),p=b,q=c,r="background-position",s="background-size",t="auto",u="0%",v="50%",w="100%";switch(f){case 0:g?o.css(r,g.position).css(s,g.size):o.css(r,u+P+u).css(s,w+P+w);break;case 1:h=v,i=v,d>p&&(h=u),e>q&&(i=u),o.css(r,h+P+i).css(s,t+P+t);break;case 2:j=0,l=0,m=p,n=q,q>0&&e>0&&p/q>d/e?(m=d/e*q,j=j+p/2-m/2):p>0&&d>0&&q/p>e/d&&(n=e/d*p,l=l+q/2-n/2),o.css(r,j+O+P+l+O).css(s,m+O+P+n+O);break;case 3:o.css(r,u+P+u).css(s,t+P+t)}},a.device=function(){var a,b,c,d,e=navigator.userAgent,f=e.match(/iPad/i);if(f)a=f[0],a&&(b="ipad"===a.toLowerCase());else if(f=e.match(/Macintosh/i),f&&(a=f[0]))try{document.createEvent("TouchEvent"),b="macintosh"===a.toLowerCase()}catch(a){}return f=e.match(/iPhone/i),f&&(a=f[0],a&&(c="iphone"===a.toLowerCase())),f=e.match(/android/i),f&&(a=f[0],a&&(d="android"===a.toLowerCase())),{ipad:b,iphone:c,android:d}},a.sl=function(){var a=navigator.platform;return a&&a.indexOf("Mac")>-1},a.tl=function(a){if(a===D||a===E)return!1;var b=""+a;return b=m.Oa(b),!M(+(""===b.trim()?NaN:b))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(b)},a.ul=function(b,c,d,e,f){var g,h,i,j,k,l,m=E,n=!1;if(b&&(g=b.formatter,g?(f?m=f:a.lHb(g)||(m=g,n=!0),typeof m===R&&o&&(m=new o(m))):m=b._autoFormatter),m&&!m.isAuto){h=E;try{if(h=m.parse(c),n&&h instanceof Date&&(i=(new o).getPreferredDisplayFormatter(c,f),i&&(h=i.parse(c))),typeof h===S)return h}catch(a){}return h===D||h===E?c:h}if(d){if(j=void 0,j={},k=void 0,l=E,o)try{l=(new o).getPreferredDisplayFormatter(c,j)}catch(a){}return k=j.value,typeof k===S?c=k:a.tl(c)&&(k=j.value=c),e&&(e.value=l),k!==D&&k!==E?k:c}return c},a.vl=function(a){for(var b,c,d=y.body,e=a;e&&e.parentElement&&e.parentElement!==d;)e=e.parentElement;return b=1e3,e&&e.parentElement===d&&(c=K(k(e).css("z-index")),M(c)||(b+=c)),b},a.wl=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(!a)return[];if(b=a.indexOf("("),c=a.lastIndexOf(")"),d=a.substring(b+1,c),!d)return[];for(e=[],f=0,g="",h=0,i=0;i<d.length;)h=d.indexOf("rgb",f),i=d.indexOf("rgb",f+1),i===-1&&(i=d.length),g=d.substring(h,i),e.push(g),f=i;for(j=[],k=0,l=e.length;k<l;k++)m=e[k],n=m.indexOf(")"),o=m.substring(0,n+1),p=L(m.substring(n+1,m.length)),M(p)&&(k===l-1?p=100:k<=1&&(p=0)),(o||0!==k)&&(p/=100,j.push({color:o,point:p}));return j},a.xl=function(b,c,d,e,f){var h,i,j,k,l,m,n,o,p,r,s,t,u,v,w,x,y,z,A,B,C=c.yl,D=0,F=[d],I=c.zoom();for(e===g.AutoFitType.cellWithHeader&&(d===g.SheetArea.viewport?F.push(1):d===g.SheetArea.rowHeader&&F.push(0)),h=0;h<F.length;h++)for(i=0,j=F[h],k=f?f:c.getRowCount(j);i>=0&&i<k;)l=c.ITa.findSpan(i,b,j),l&&(l.col<b||l.colCount>1||l.row<i)?i=l.row+l.rowCount:(m=c.getActualStyle(i,b,j),n=0,o=m.cellType||c.Al(j),o&&(p=m.font||C.Bl(),m.font=C.Cl(p),r=c.rowFilter&&c.rowFilter(),s=!(!r||!r.Dl(i,b,j)),s||3!==j||(t=c.tables?c.tables.find(i,b):E,t&&t.showHeader()&&t.headerIndex()===i&&t.rowFilter()&&t.filterButtonVisible(b-t.range().col)&&(s=!0)),u=m.formatter?m.formatter:m._autoFormatter,v={sheet:c,row:i,col:b,sheetArea:j,quotePrefix:m.quotePrefix},w={},x=c.getValue(i,b,j,g.ValueType.richText),y=c.xHb(i,b,d),z="",z=x&&x.richText?c.getText(i,b,j):q(y)?o.format(x,u,w,v):y,n=o.X4(x,z,m,I,v),s&&(A=H(I,1),B=K(""+c.defaults.rowHeight*A,10),n+=B)),n>D&&(D=n),j===g.SheetArea.viewport?i=a.El(i,b,c,j):i++);return 0===D?D=c.defaults.colWidth:D+=G(3),G(D)},a.El=function(a,b,c,d){var e,f,g,h=-1,i=c.getRowCount(d);for(e=a+1;e<i;e++){if(f=c.getText(e,b,d)){h=e;break}if(g=c.getActualStyle(e,b,d),g&&(g.cellType||g.cellButtons&&g.cellButtons.length>0)){h=e;
break}}return h},a.Fl=function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=c.yl,u=0,v=[d],w=c.zoom();for(1===e&&(3===d?v.push(2):1===d&&v.push(0)),g=0,h=!1,i=0;i<v.length;i++)for(d=v[i],j=0,k=c.getColumnCount(d);j>=0&&j<k;)l=c.ITa.findSpan(b,j,d),l&&(l.row<b||l.rowCount>1||l.col<j)?j=l.col+l.colCount:(c.getColumnWidth(j,d)>0&&(m=c.getActualStyle(b,j,d),n=m.font||t.Bl(),m.font=t.Cl(n),o=0,p=c.getCellType(b,j,d),p&&(q=c.getText(b,j,d),r=c.getValue(b,j,d,1),s={sheet:c,row:b,col:j,sheetArea:d},o=p.Y4(r,q,m,w,s)),f=c.PKJ(j),2===f?g=g+o+G(3):(g&&(o+=g,g=0),1===f&&(h=!0)),g&&(o=g),o>u&&(u=o)),3===d?j=a.Gl(b,j,c,d):j++);return h&&u<60&&(u=60),0===u?u=c.defaults.rowHeight:u+=G(3),G(u)},a.Gl=function(a,b,c,d){var e,f,g,h=-1,i=c.getColumnCount(d);for(e=b+1;e<i;e++){if(f=c.getText(a,e,d)){h=e;break}if(g=c.getActualStyle(a,e,d),g&&g.cellType){h=e;break}}return h},a.Il=function(b,c,e,f,g){var h,j,k,l,n,q,r,s,t,u;if(e&&(h=f.row,j=f.col,k=f.sheetArea,l=b.formatter?b.formatter:b._autoFormatter,n=g||{},o&&c!==E&&c!==D))if(q=void 0,l&&l.isAuto)q=typeof c===S,r=a.tl(c),!q&&r&&(c=m.Oa(c)),c=l.getPreferredEditingFormatter?l.getPreferredEditingFormatter(c).format(c):c;else if(typeof l!==R||a.lHb(l)||(l=new o(l)),l)try{c instanceof Date?(s=i&&i.Convert.Wh(c),s&&(c=s),t=d.Common.CultureManager.q4().DateTimeFormat,u=d.Common.l.Ra(c),l=new o(!p.Lc(l.formatString(),["d","y"])&&u>=0&&u<1?t.longTimePattern:0===c.getHours()&&0===c.getMinutes()&&0===c.getSeconds()&&0===c.getMilliseconds()?t.shortDatePattern:t.shortDatePattern+P+t.longTimePattern),e.Ll=!0,c=l.format(c),n.formatter=l):typeof c===S&&(c=l.getPreferredEditingFormatter?l.getPreferredEditingFormatter(c).format(c):m.nb(""+c))}catch(a){c=e.getText(h,j,k)}else c=e.getText(h,j,k);return c!==E&&c!==D&&(c=a.bc(c)),c},a.BPJ=function(b,c,e,f){var g,h,j,k,l,n;if(e&&(g=f||{},o&&c!==E&&c!==D))if(h=void 0,b&&b.isAuto)h=typeof c===S,j=a.tl(c),!h&&j&&(c=m.Oa(c)),c=b.getPreferredEditingFormatter?b.getPreferredEditingFormatter(c).format(c):c;else if(b)try{c instanceof Date?(typeof b!==R||a.lHb(b)||(b=new o(b)),k=i&&i.Convert.Wh(c),k&&(c=k),l=d.Common.CultureManager.q4().DateTimeFormat,n=d.Common.l.Ra(c),b=new o(!p.Lc(b.formatString(),["d","y"])&&n>=0&&n<1?l.longTimePattern:0===c.getHours()&&0===c.getMinutes()&&0===c.getSeconds()&&0===c.getMilliseconds()?l.shortDatePattern:l.shortDatePattern+P+l.longTimePattern),c=b.format(c),g.formatter=b):typeof c===S&&(c=m.nb(""+c))}catch(a){}return c!==E&&c!==D&&(c=a.bc(c)),c},a.PaK=function(a,b,c,d){return!q(a)&&"string"==typeof a&&!!(b||Y.indexOf(a)===-1&&a.length>0&&Y.indexOf(a[0])!==-1&&c&&!d)},a.EgK=function(b,c,d){var e,f,g="";if(b)if(e=b.getFormulaInformation(c,d,3),e&&e.hasFormula){if(g="="+e.formulaWithCulture,e.isDynamicArray)return""}else{if(f=b.getValue(c,d),q(f))return f;g=a.BPJ(b.getFormatter(c,d)||b.tq(c,d,"_autoFormatter"),f,b)||""}return g},a.KIc=function(a,b){var c,e=a,f=d.Common.CultureManager.q4(b).NumberFormat,g=f&&f.percentSymbol;return!(!g||!a)&&("object"==typeof a&&a.formatCached&&(e=a.formatCached),"object"!=typeof e&&("string"==typeof e&&(c=m.Hja(e),c.fb>0)))},a._Va=function(b){var c,d=a.Ml.msie||a.Ml.edge,e=d&&x.MSPointerEvent&&(navigator.msMaxTouchPoints||0)>1;return b?e:(c=d&&x.PointerEvent&&(navigator.maxTouchPoints||0)>1,e||c)},a.K_a=function(b){return b&&b.richText&&b.richText.length>0?(b.text||(b=a.n0a(b)),b.text):b},a.n0a=function(a){var b,c,d;if(!a)return a;if(b=a.richText,b&&b.length>0){for(c=[],d=0;d<b.length;d++)c.push(b[d].text?b[d].text:"");a.text=c.join("")}return a},a.lHb=function(a){return"string"==typeof a&&("="===a.charAt(0)||a.indexOf("{{")>=0&&a.indexOf("}}")>=0)},a.Pl=function(a,b,c,d){var e=a,f=b,g=function(a,b){var g,h,i=this;return i.hasOwnProperty("_ps")||(i._ps={}),g=i._ps,0===arguments.length?g[e]!==D?g[e]:f:(b!==!1&&d&&!d.call(i,a)||(h=g[e]!==D?g[e]:f,h!==a&&(g[e]=a,b!==!1&&c&&c.call(i,a,h))),i)};return g.isDefault=function(a){return a===f},g},a.Ql=function(a,b){var c={_ps:{}};return d.Common.j.H(a,function(a){La(c,a,b)}),c},a.Rl=function(a,b,c,d,e,f,g){var h,i=H(b,c),j=I(b,c),k=0;for(h=i;h<j&&(k+=d?f?a.getRowHeight(h,3):a.Sl(h,3,g):f?a.getColumnWidth(h,3):a.Tl(h,3,g),!(e&&k>e));h++);return k},a.eBJ=function(a,b,c,d,e){var f,g,h=H(b,c),i=I(b,c),j=0;for(f=h;f<i&&(d?(g=a.Er(f),a.getViewportTopRow(g)<=f&&a.getViewportBottomRow(g)>=f&&(j+=a.Sl(f,3))):(g=a.Fr(f),a.getViewportLeftColumn(g)<=f&&a.getViewportRightColumn(g)>=f&&(j+=a.Tl(f,3))),!(e&&j>e));f++);return j},a.Z3=function(a,b){var c,d,e=0,f=0;return a!==b&&(c=k(a).offset(),d=k(b).offset(),e=c.left-d.left,f=c.top-d.top),{FB:f,EB:e}},a.bq=function(a,b,c,d){var e,f,g,h,i=d||{};if(!a||"string"!=typeof a)return i.message=v().Exp_SheetNameInvalid,!1;for(f=0;f<a.length;f++)if(e=a.charAt(f),"*"===e||":"===e||"["===e||"]"===e||"?"===e||"\\"===e||"/"===e)return i.message=v().Exp_SheetNameInvalid,!1;if("'"===a.charAt(0)||"'"===a.charAt(a.length-1))return i.message=v().Exp_SheetNameInvalid,!1;if(!b)return!0;for(g=b.length,f=0;f<g;f++)if(h=b[f],c!==h&&a.toUpperCase()===h.name().toUpperCase())return i.message=v().Exp_SheetNameConflict,!1;return!0},a.Ika=function(a,b,c){var d,e,f;if(!a)return a;for(d=0,e=a.length,f=[];d<e;)a[d]===b?f[d]=c:f[d]=a[d],d++;return f.join("")},a.tt=function(){var b,c,d,e=a;return e.ct||(b=Ja("span"),c=b.style,d="-10000px",c.visibility="hidden",c.top=d,c.left=d,c.position="absolute",b.setAttribute("gcUIElement","gcStringWidthSpan"),y.body.insertBefore(b,E),e.ct=b),e.ct},a.fp=function(b,c,d){var e,f,g,h=a,i=h.st;if(!c)if(i){if(d&&(i=i.CJKFontCache),e=i[b])return e}else i=h.st={CJKFontCache:{}},d&&(i=i.CJKFontCache);return f=h.tt(),f.style.font=a.hZa(b),a.Ml&&a.Ml.safari&&(f.style.lineHeight="normal"),f.innerHTML=d?String.fromCharCode(20013):"H",g=f.offsetHeight,c||(i[b]=g),g},a.Pxb=function(b){var c,d,e=a,f=e.Qxb;if(f){if(f[b])return f[b]}else f=e.Qxb={};return d=e.tt(),d.style.font=b,d.innerHTML="H",c={},c.fontFamily=d.style.fontFamily,c.fontSize=d.style.fontSize,c.fontStyle=d.style.fontStyle,c.fontWeight=d.style.fontWeight,f[b]=c,c},a.Voa=function(b,c){var d=a.tt();return d.style.font=a.hZa(c),a.Ml&&a.Ml.safari&&(d.style.lineHeight="normal"),d.innerHTML=s.Ob(b||"H"),d.offsetHeight},a.iZa=function(c){var d,e,f=a;return c.indexOf(b.FallbackFontFamily)>=0?c:(c=c.replace("("+String.fromCharCode(27491)+String.fromCharCode(25991)+")","").replace("(Body)","").replace("("+String.fromCharCode(26631)+String.fromCharCode(39064)+")",""),d=f.tt(),e=d.style,e.font=c,e.fontFamily=[].concat(e.fontFamily.split(","),b.FallbackFontFamily.split(",")).join(","),e.font)},a.hZa=function(b){var c,d,e=a;return b&&e.jZa?(c=e.kZa,c||(c=e.kZa={}),d=c[b],d||(d=c[b]=e.iZa(b)),d):b},a.lZa=function(b,c){c&&(c=a.hZa(c),b.font!==c&&(b.font=c))},a.pL=function(b,c,d){return!c||q(d)?0:(a.lZa(b,c),b.measureText(d).width)},a.no=function(){var b=a,c=b.ct;c&&(k(c).remove(),b.ct=D),b.st=D,b.Qxb=D,a._0&&(a._0=D),b.kZa=D},a.Woa=function(b){var c,d=a._0;return d||(d=a._0=Ja("div")),c=b.innerHTML,d.innerHTML=c,d.innerText},a.G$a=function(a){return a&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(a)&&!(["C","c","R","r"].indexOf(a)!==-1||/^[A-Za-z]{1,3}(\$)?\d+$/.test(a)||/^[Rr]\d*[Cc]\d*$/.test(a)||a.length>=255)},a.T$a=function(a){a&&(a.j_a(!0),a.initExpression(),a.k_a())},a.l_a=function(a){var b,c,d=0,e=0,f=a.length;for(f>0&&(d=a[0].row,e=a[0].col),b=1;b<f;b++)c=a[b],d>c.row&&(d=c.row),e>c.col&&(e=c.col);return d=d<0?0:d,e=e<0?0:e,{r:d,c:e}},a.w0a=function(a){var b,c;return typeof a===R&&"/"===a.charAt(0)?(c=void 0,W.test(a)?(c=a.match(W),b=d.Common.l.Xb(L(c[1]))):V.test(a)?(c=a.match(V),b=new Date(L(c[1]))):b=a):b=a,b},a.x0a=function(a){var b;return b=!q(a)&&d.Common.l.Ska(a)?d.Common.l.Daa(a):a},a.yHb=function(a,b){var c,d,e=a.getImageData(b.x,b.y,b.width,b.height),f=e.data;for(c=0;c<f.length-4;c+=4)d=F((30*f[c]+59*f[c+1]+11*f[c+2]+50)/100),f[c]=d,f[c+1]=d,f[c+2]=d;a.putImageData(e,b.x,b.y)},a.FLJ=function(a,b,c){a.rowCount>b&&(a.rowCount=b),a.colCount>c&&(a.colCount=c)},a.EYJ=function(a,b,c,d){for(var e=c;e<c+d;e++)if(!q(a.getValue(b,e)))return!0;return!1},a.FYJ=function(a,b,c,d){for(var e=b;e<b+d;e++)if(!q(a.getValue(e,c)))return!0},a.JWb=function(a){return!a||""===a},a.P9=function(b){if(a.JWb(b))return 0;for(var c=0,d=0;d<b.length&&isNaN(parseInt(b[d],10));)d++;return d<b.length&&(c=parseInt(b.substring(d),10)),c-1},a.Q9=function(a){var b,c,d,e=0,f=a.length;for(b=0;b<f&&(c=a[b].charCodeAt(),d=c-97,!(d>25))&&(d<0&&(d=c-65),!(d<0));b++)e=26*e+d+1;return e--,e},a.GcK=function(a){var b=""+a;return"="===b.charAt(0)?b.substr(1):b},a.getFormulaString=function(a){return"string"==typeof a?(a="="===a[0]?a.substr(1):a,w(a)):a},a.naa=function(a,b){return q(a)?a:(b=b||/(&)|(<)|(>)|(")|(')/g,b.test(a)?typeof a===R?a.replace(b,function(a){switch(a){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;"}}):""+a:a)},a.oaa=function(a){var b,c;return q(a)?a:(b=typeof a===R,b?a.indexOf("&")===-1?""+a:(c=/(&amp;)|(&gt;)|(&lt;)|(&quot;)|(&apos;)/g,a.indexOf("&#")!==-1&&(a=a.replace(aa,Qa(10)).replace(ba,Qa(16))),a.replace(c,function(a){switch(a){case"&amp;":return"&";case"&gt;":return">";case"&lt;":return"<";case"&quot;":return'"';case"&apos;":return"'"}})):""+a)},a.Rha=function(a,b,c){var d,e;if(a&&typeof a===R)for(d=0;d<c.length;d++)if(e=c[d],e!==b&&(a.indexOf(e+"!")>-1||a.indexOf("'"+e+"'!")>-1))return!0;return!1},a.HcK=function(a){var b,c,d;return"string"==typeof a&&(b=a.indexOf("/OADate(")+1,c=a.indexOf(")"),0!==b&&c>b&&(d=parseFloat(a.substring(b+7,c)),isNaN(d)||(a=""+d))),a},a.gmK=function(a){var b,c,d;if(!a)return null;if(b=a,c=",",b.indexOf(c)!==-1&&(b=b.split(c)[0]),b){for(d=b.length-1;d>=0&&"/"!==b[d];)d--;d>=0&&(b=b.substring(d)),b&&"/#"===b.substring(0,2)&&(b=b.substring(2)),'"'===b[0]&&'"'===b[b.length-1]&&(b=b.substring(1,b.length-1))}return b},a.IcK=function(b,c){var d,e,f,g,h,i=c.split("&");for(d=0,e=i.length;d<e;d++){if(f=i[d].split("."),g=f[0],h=f[1],!b)return;b=a.JcK(b,g,h)}return b},a.JcK=function(a,b,c){var d,e,f,g;if(!a||!a.c_)return D;for(c=c?+c:0,d=a.c_,e=0,f=d.length;e<f;e++)if(g=d[e],g&&g.n_===b){if(0===c)return g;c--}},a.miK=function(a,b){var c,d;if(a)for(c=a.c_||[],d=0;d<c.length;d++)if(c[d][b])return c[d][b]},a.KcK=function(b,c){var d,e,f,g,h;if(!b||!b.c_)return D;for(d=b.c_,e=0,f=d.length;e<f;e++){if(g=d[e],g&&g.n_===c)return g;if(h=a.KcK(g,c),!q(h))return h}},a.LcK=function(a){return a&&a.c_?a.c_[0]:D},a.McK=function(a,b){var c,d,e,f,g;if(!a||!a.c_)return D;for(c=a.c_,d=[],e=0,f=c.length;e<f;e++)g=c[e],g&&g.n_===b&&d.push(g);return d},a.NcK=function(b,c){var d,e,f,g,h;if(b&&b.c_){for(d=[],e=0,f=c.length;e<f;e++)g=c[e],h=a.McK(b,g),h&&h.length>0&&(d=d.concat(h));b.c_=d}},a.kjK=function(a,b,c){var d,e,f;if(a&&b)for(c=c||b.name,d=0,e=a.length;d<e;d++)f=a[d],f&&f.n_===c&&(a[d]=b)},a.OcK=function(){var a="{"+Pa(8)+"-"+Pa(4)+"-"+Pa(4)+"-"+Pa(4)+"-"+Pa(12)+"}";return a.toUpperCase()},a.PcK=function(a,b,c){if(a)return Ra(a)?Sa(a,b,c):Va(a,c)},a.QcK=function(a,b){if(a){if("1"===a.auto)return"#000000";if(a.theme!==D)return Ta(a,b);if(a.rgb){var c=a.rgb;return"number"==typeof c&&(c=c.toString(16)),"#"+c.substring(2,c.length)}return a.indexed!==D?Ua(a):void 0}},a.hueToRGB=function(a,b,c){return c<0&&(c+=255),c>255&&(c-=255),c<42?a+((b-a)*c+21)/42:c<127?b:c<170?a+((b-a)*(170-c)+21)/42:a},a.ScK=function(b,c,d){var e,f,g=0,h=0,i=0;return 0===d?(g=255*c/255|0,h=g,i=g):(e=void 0,e=c<=127?(c*(255+d)+127)/255:c+d-(c*d+127)/255,f=2*c-e,g=parseInt(""+(255*a.hueToRGB(f,e,b+85)+127)/255,10),h=parseInt(""+(255*a.hueToRGB(f,e,b)+127)/255,10),i=parseInt(""+(255*a.hueToRGB(f,e,b-85)+127)/255,10)),g=g>0?g:0,h=h>0?h:0,i=i>0?i:0,g=g<255?g:255,h=h<255?h:255,i=i>255?i:255,{r:g,g:h,b:i,a:0}},a.TcK=function(a){var b=$[a];if(b!==D)return _.hexToARGB(b)},a.UcK=function(a){if(!r(a))return"="===a[0]?a:"="+a},a.VcK=function(a){return r(a)||a.length<=2?a:a.substr(1,a.length-2)},a.WcK=function(a){if(!q(a))return"="===a[0]?a.substring(1,a.length):a},a.qPa=function(a,b){if(!a||!b)return a;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},a.XcK=function(a){var b,c,d,e;if("string"==typeof a){if(b=/\[[^\]]+\]|@/,c=a.split(/\'|\"/g),c&&c.length>0)for(d=0;d<c.length;d++)if(e=c[d],d%2===0&&e.match(b))return!0;return!1}},a.A9J=function(a,b){var c=b.row,d=b.col,e=b.rowCount,f=b.colCount,g=a.getRowCount(),h=a.getColumnCount();return c===-1&&(c=0,e=g),d===-1&&(d=0,f=h),e=c+e>g?g-c:e,f=d+f>h?h-d:f,cb(c,d,e,f)},a.isInfinityNumberString=function(a){return"string"==typeof a&&(parseFloat(a)===Number.POSITIVE_INFINITY||parseFloat(a)===Number.NEGATIVE_INFINITY)},a.ZGb=/[\u0600-\u06FF\u0750-\u077F]/,a.nl=Na,a.rl=a.device,a.Ml=function(){var a,b,c,d,e,f,g;function h(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}}a=navigator.userAgent,b=h(a),c={version:D,chrome:D,webkit:D,safari:D,mozilla:D,msie:D,metroMode:D,edge:D},b.browser&&(c[b.browser]=!0,c.version=b.version),c.chrome?c.webkit=!0:c.webkit&&(c.safari=!0),d=a.indexOf("PhantomJS")>=0,d&&(c.safari=!1,c.chrome=!0),e=a.toLowerCase(),f=e.indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(e)!==E,f&&(c.mozilla=D,c.msie=!0),g=/Edge\/\d+/.exec(a),g!==E&&g.length>0&&(c.webkit=D,c.chrome=D,c.msie=!0,c.edge=!0,c.version=g[0].substr(g[0].indexOf("/")+1));function i(){var a=E,b=!1;try{new ActiveXObject("")}catch(b){a=b.name}try{b=!!new ActiveXObject("htmlfile")}catch(a){b=!1}return b="ReferenceError"===a||b!==!1,!b}return c.msie&&i()&&(c.metroMode=!0),c}(),a.browser=a.Ml,a.Nl=Ja,a.Ol=Ia,a.uWa=Oa,a.jZa=a.sl(),a.Fxb=function(a){return!q(a)&&(typeof a===S||typeof a===z||a instanceof Date||i&&a instanceof i.CalcError)},a}(),b.util=ha,b.Ul=ha,ia=ha.pL,ja=function(){function a(){}return a.Wl=function(b){return!(a.Xl()!==b||!b.mm||!b.mm.YH)},a.Xl=function(){return x&&x.Yl&&x.Yl.activeElement},a.kmb=function(b){var c,d,e,f,h,i,j,k,l,m,n;function o(a){var f,g;for(f=0;f<=2;f++)g=a.call(c,f),g&&0!==g.width&&0!==g.height&&(b.$l=!0,d._l(e,g))}if(b&&!a.Wl(b)&&b.parent&&b.parent.options.hideSelection)if(c=b.am(),d=b.yl,e=d.bm(),f=b.XCJ,h=f&&f.isEnable(g.RowColumnStates.selected,!0),i=f&&f.isEnable(g.RowColumnStates.selected,!1),j=b.getSelections(),k=void 0,l=void 0,h||i){for(m=void 0,k=0;k<j.length;k++)n=j[k],m=m?m.union(n):n;m&&d.im(m)}else{for(k=0;k<j.length;k++)n=j[k],l=b.cm(n),l.width>=0&&l.height>=0&&(l.x-=9,l.y-=9,l.width+=18,l.height+=30,d.dm(l));l=c.em(),b.$l=!0,d._l(e,l),o(c.fm),o(c.gm)}},a.Zl=function(b,c){var d=a.Xl();x.Yl.activeElement=b,b===d||c||(d&&(d.endEdit(),a.kmb(d),d.hm&&d.hm()),b&&b.yl.im())},a}(),b.Vl=ja;function Wa(a,b){var c=Ja("span");return c.className=a,b&&(c.id=b),c.style.display="none",Ka(c),c}function Xa(a,b,c,d){a.addEventListener(b,c,d)}function Ya(a){var b=a.currentStyle,c=y.defaultView;return c&&c.getComputedStyle&&(b=c.getComputedStyle(a,"")),b}function Za(a){var b,c,d,e,f,g,h,i=x.Yl;i.jm>0||(16!==a.keyCode&&(i.XCb=!0),b=ja.Xl(),c=b&&b.lm,c&&(d=k(c),d.isVisible())||b&&b.mm&&b.mm.nm&&(b.mm.nm(a),b.isEditing()||(e=a.keyCode,f=a.ctrlKey,g=a.altKey,h=a.shiftKey,90!==e&&89!==e||!f||g?86!==e||!f||g||h||a.stopPropagation&&a.stopPropagation():Na(a))))}function $a(a){var b,c=x.Yl;c.jm>0||(c.XCb=!1,b=ja.Xl(),b&&b.mm&&b.mm.om&&b.mm.om(a))}function _a(a){var b,c=x.Yl;c.jm>0||(b=ja.Xl(),b&&b.mm&&b.mm.pm&&b.mm.pm(a))}function ab(a){var b,c=x.Yl;c.jm>0||c.XCb!==!0&&(b=ja.Xl(),b&&b.mm&&b.mm.pm&&b.mm.pm(a))}function bb(a){return y.all===D&&ja.Xl()&&Na(a),!1}ka=function(){function a(){this.jm=0,this.km=[],this.XCb=!1,this.ad()}return a.prototype.rm=function(){var a="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",b="span."+a.split(P).join(Q);return la.vm?k(y).find(b).length<=0&&Ka(la.vm):la.vm=Wa(a),la.vm},a.prototype.sm=function(){var a="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",b="span."+a.split(P).join(Q);return la.wm?k(y).find(b).length<=0&&Ka(la.wm):la.wm=Wa(a),la.wm},a.prototype.tm=function(){var a="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",b="span."+a.split(P).join(Q);return la.xm?k(y).find(b).length<=0&&Ka(la.xm):la.xm=Wa(a),la.xm},a.prototype.um=function(){var a="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",b="span."+a.split(P).join(Q);return la.ym?k(y).find(b).length<=0&&Ka(la.ym):la.ym=Wa(a),la.ym},a.prototype.zm=function(){var a="gc-theme-version",b="gcDummyElement";return la.Am?k(y).find("#"+b).length<=0&&Ka(la.Am):la.Am=Wa(a,b),la.Am},a.prototype.qm=function(){la.rm(),la.sm(),la.tm(),la.um()},a.prototype.ad=function(){var a,b,c=this;c.jm=0,Xa(x,"keydown",Za,!0),Xa(x,"keyup",$a,!0),Xa(x,"compositionstart",_a,!0),Xa(x,"selectstart",bb,!0),a=ha.rl(),b=a.ipad||a.iphone,ha.browser.safari&&!b&&Xa(x,"textInput",ab,!0);function d(a,b){for(var c=!1,d=a;d;){if("gcSpread"===k(d).attr("gcUIElement")){c=b.zo()!==d;break}d=d.parentElement}return c}function e(a){var e,f,g,h=ja.Xl();if(h&&(e=la.Bm(a.target),f=h.Cw&&h.Cw.V4,c.km.forEach(function(a){a&&a(h,e)}),!e||d(e,h)))if(h.gv(D,D,f))b&&(g=h.mm,g&&g.Cm&&g.Cm()),ja.Zl(E);else if(a.cancelable)return!1}function f(a){var b=a.pointerType;b!==a[U]&&b!==T||e(a)}ha._Va()?(k(y).bind("MSPointerDown",f),k(y).bind("pointerdown",f)):k(y).bind("touchstart",e),Xa(y,"mousedown",function(a){var b=e(a);b===!1&&Na(a)},!0),k(y).bind("DOMContentLoaded",function(){la.qm()})},a.prototype.Bm=function(a){for(var b,c=a;c&&"BODY"!==c.tagName&&typeof c.getAttribute===C;){if(b=c.getAttribute("gcUIElement"),b||(b=c.gcUIElement),b)return c;c=c.parentNode}return E},a.prototype.Dm=function(a,b){var c,d,e,f,h=la.rm();return a===g.VisualState.highlight||a===g.VisualState.selected?h=la.um():a===g.VisualState.hover&&(h=la.tm()),c=h.className,k(h).removeClass(c).addClass(b),d=Ya(h),e={backgroundColor:d.backgroundColor,backgroundImage:d.backgroundImage},k(h).addClass(c),d=Ya(h),f={backgroundColor:d.backgroundColor,backgroundImage:d.backgroundImage,color:d.color,zIndex:d.zIndex},f.borderLeftColor=d.borderLeftColor,f.borderRightColor=d.borderRightColor,f.borderBottomColor=d.borderBottomColor,f.borderBottomWidth=d.borderBottomWidth,f.borderTopColor=d.borderTopColor,f.borderRightWidth=d.borderRightWidth,f.backgroundImage===e.backgroundImage&&f.backgroundColor!==e.backgroundColor&&(f.backgroundImage=D),k(h).removeClass(b),f},a.prototype.Em=function(a){var b,c=la.zm();return k(c).removeClass(c.className).addClass("gc-theme-version "+a),b=Ya(c),l({},b)},a.prototype.Fm=function(a){var b,c=la.sm();return k(c).removeClass(c.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+a),b=Ya(c),l({},b)},a.prototype.Gm=function(){var a=x.Yl;a.jm++},a.prototype.Hm=function(){var a=x.Yl;a.jm--,a.jm<0&&(a.jm=0)},a}(),la=ka.prototype,x.Yl||(x.Yl=new ka),ma=function(){function a(){}return a.Jm=function(a){var b={0:"normal",1:"highlight",2:"selected",3:"active",4:"hover",5:"activeNotSelected"};return b[a]||""},a.Km=function(b,c){var d=a.Jm(b)+c,e=a.styleCache;return e[d]||(e[d]=la.Dm(b,c)),e[d]},a.Lm=function(b){var c=b,d=a.styleCache;return d[c]||(d[c]=la.Em(b)),d[c]},a.Mm=function(b){var c="content"+b,d=a.styleCache;return d[c]||(d[c]=la.Fm(b)),d[c]},a._ob=function(a,b){var c=a.Pm;return c&&c.getColor&&(b=c.getColor(b)),b},a.Nm=function(){a.styleCache={}},a.styleCache={},a}(),b.Im=ma,na=function(){function a(a,b){this.x=a,this.y=b}return a.prototype.clone=function(){return new a(this.x,this.y)},a}(),b.Point=na,oa=function(){function a(a,b,c,d){var e=this;e.x=a,e.y=b,e.width=c,e.height=d}return a.prototype.intersect=function(a,b,c,d){var e=this;return a<e.x+e.width&&e.x<a+c&&b<e.y+e.height&&e.y<b+d},a.prototype.intersectRect=function(a){return this.intersect(a.x,a.y,a.width,a.height)},a.prototype.contains=function(a,b,c){var d=this;return c?d.x<=a&&a<=d.x+d.width&&d.y<=b&&b<=d.y+d.height:d.x<a&&a<d.x+d.width&&d.y<b&&b<d.y+d.height},a.prototype.containsRect=function(a,b){return this.contains(a.x,a.y,b)&&this.contains(a.x+a.width,a.y+a.height,b)},a.prototype.getIntersectRect=function(a){return this.getIntersect(a.x,a.y,a.width,a.height)},a.prototype.getIntersect=function(b,c,d,e){var f=this,g=f.x,h=f.y,i=f.x+f.width,j=f.y+f.height,k=b,l=c,m=b+d,n=c+e,o=I(g,k),p=I(h,l),q=H(i,m),r=H(j,n),s=o,t=p,u=q-o,v=r-p;return u>0&&v>0?new a(s,t,u,v):E},a.prototype.round=function(){var a=this;a.x=F(a.x),a.y=F(a.y),a.width=G(a.width),a.height=G(a.height)},a.prototype.clone=function(){var b=this;return new a(b.x,b.y,b.width,b.height)},a}(),b.Rect=oa,pa=function(){function a(a,b,c,d){var e=this;e.row=a,e.rowCount=c,e.col=b,e.colCount=d}return a.prototype.intersect=function(a,b,c,d){var e=this;return(a===-1||e.row===-1||e.row<a+c&&a<e.row+e.rowCount)&&(b===-1||e.col===-1||e.col<b+d&&b<e.col+e.colCount)},a.prototype.getIntersect=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o=this;return b&&o.intersect(b.row,b.col,b.rowCount,b.colCount)?(e=o.col===-1?d-1:o.col+o.colCount-1,f=b.col===-1?d-1:b.col+b.colCount-1,g=o.row===-1?c-1:o.row+o.rowCount-1,h=b.row===-1?c-1:b.row+b.rowCount-1,i=I(o.col,b.col),j=H(e,f),k=I(o.row,b.row),l=H(g,h),m=k===-1?-1:l-k+1,n=i===-1?-1:j-i+1,new a(k,i,m,n)):E},a.prototype.contains=function(a,b,c,d){var e=this,f=arguments.length,g=!1;return 2!==f&&4!==f||(2===f&&(c=1,d=1),g=(e.row===-1||e.row<=a&&a+c<=e.row+e.rowCount)&&(e.col===-1||e.col<=b&&b+d<=e.col+e.colCount)),g},a.prototype.containsRange=function(a){return this.contains(a.row,a.col,a.rowCount,a.colCount)},a.prototype.offset=function(b,c){var d=this,e=d.col,f=d.row;return e!==-1&&(e+=b),f!==-1&&(f+=c),new a(f,e,d.rowCount,d.colCount)},a.prototype.union=function(a){return db(this,a)},a.prototype.equals=function(b){var c=this;return b instanceof a&&c.row===b.row&&c.col===b.col&&c.rowCount===b.rowCount&&c.colCount===b.colCount},a.prototype.toJSON=function(){var a=this;return{row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount}},a.prototype.fromJSON=function(a){var b=this;a&&(b.row=a.row,b.col=a.col,b.rowCount=a.rowCount,b.colCount=a.colCount)},a}(),b.Range=pa;function cb(a,b,c,d){return new pa(a,b,c,d)}b.kf=cb;function db(a,b){var c,d,e,f;if(a&&b){if(c=H(a.row,b.row),d=H(a.col,b.col),e=I(a.row+a.rowCount-1,b.row+b.rowCount-1),f=I(a.col+a.colCount-1,b.col+b.colCount-1),c>=0&&d>=0)return new pa(c,d,e-c+1,f-d+1);if(c>=0)return new pa(c,(-1),e-c+1,(-1));if(d>=0)return new pa((-1),d,(-1),f-d+1)}return new pa((-1),(-1),(-1),(-1))}b.getUnionRange=db,qa=function(){function a(){}return a.Om=function(a,b){if(a&&b){var c=a.currentTheme();if(c)return c.getColor(b)}return b},a.Qm=function(a,b){if(a&&b){var c=a.currentTheme();return c?c.getFont(b):b}return E},a}(),b.Rm=qa,ra=function(){function a(){}return a.ValidationError="ValidationError",a.CellClick="CellClick",a.CellDoubleClick="CellDoubleClick",a.ColumnChanging="ColumnChanging",a.RowChanging="RowChanging",a.EnterCell="EnterCell",a.LeaveCell="LeaveCell",a.ValueChanged="ValueChanged",a.TopRowChanged="TopRowChanged",a.SheetChanging="SheetChanging",a.SheetChanged="SheetChanged",a.PivotTableChanged="PivotTableChanged",a.LeftColumnChanged="LeftColumnChanged",a.InvalidOperation="InvalidOperation",a.RangeFiltering="RangeFiltering",a.RangeFiltered="RangeFiltered",a.RangeFilterClearing="RangeFilterClearing",a.TableFilterClearing="TableFilterClearing",a.RangeFilterCleared="RangeFilterCleared",a.TableFilterCleared="TableFilterCleared",a.TableFiltering="TableFiltering",a.TableFiltered="TableFiltered",a.RangeSorting="RangeSorting",a.RangeSorted="RangeSorted",a.ClipboardChanging="ClipboardChanging",a.ClipboardChanged="ClipboardChanged",a.ClipboardPasting="ClipboardPasting",a.ClipboardPasted="ClipboardPasted",a.ColumnWidthChanging="ColumnWidthChanging",a.ColumnWidthChanged="ColumnWidthChanged",a.RowHeightChanging="RowHeightChanging",a.RowHeightChanged="RowHeightChanged",a.DragDropBlock="DragDropBlock",a.DragDropBlockCompleted="DragDropBlockCompleted",a.DragFillBlock="DragFillBlock",a.DragFillBlockCompleted="DragFillBlockCompleted",a.EditStarting="EditStarting",a.EditStarted="EditStarted",a.EditChange="EditChange",a.EditEnding="EditEnding",a.EditEnd="EditEnd",a.EditEnded="EditEnded",a.RangeGroupStateChanging="RangeGroupStateChanging",a.RangeGroupStateChanged="RangeGroupStateChanged",a.InternalSelectionChanging="InternalSelectionChanging",a.SelectionChanging="SelectionChanging",a.SelectionChanged="SelectionChanged",a.SheetTabClick="SheetTabClick",a.SheetTabDoubleClick="SheetTabDoubleClick",a.SheetNameChanging="SheetNameChanging",a.SheetNameChanged="SheetNameChanged",a.ViewZooming="ViewZooming",a.ViewZoomed="ViewZoomed",a.UserZooming="UserZooming",a.UserFormulaEntered="UserFormulaEntered",a.CellChanged="CellChanged",a.ColumnChanged="ColumnChanged",a.RowChanged="RowChanged",a.ActiveSheetChanging="ActiveSheetChanging",a.ActiveSheetChanged="ActiveSheetChanged",a.SparklineChanged="SparklineChanged",a.OutlineColumnCheckStatusChanged="OutlineColumnCheckStatusChanged",a.RangeChanged="RangeChanged",a.ButtonClicked="ButtonClicked",a.EditorStatusChanged="EditorStatusChanged",a.FloatingObjectChanged="FloatingObjectChanged",a.DrawingElementZIndexChanged="DrawingElementZIndexChanged",a.ProgressChanged="ProgressChanged",a.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",a.ShapeChanged="ShapeChanged",a.ShapeSelectionChanged="ShapeSelectionChanged",a.FormControlButtonClicked="FormControlButtonClicked",a.FormControlValueChanged="FormControlValueChanged",a.PictureChanged="PictureChanged",a.FloatingObjectRemoving="FloatingObjectRemoving",a.ShapeRemoving="ShapeRemoving",a.FloatingObjectRemoved="FloatingObjectRemoved",a.ShapeRemoved="ShapeRemoved",a.PictureSelectionChanged="PictureSelectionChanged",a.FloatingObjectLoaded="FloatingObjectLoaded",a.TouchToolStripOpening="TouchToolStripOpening",a.CommentChanged="CommentChanged",a.CommentRemoving="CommentRemoving",a.CommentRemoved="CommentRemoved",a.SlicerChanged="SlicerChanged",a.BeforeDragDrop="BeforeDragDrop",a.FormulaTextboxActiveSheetChanging="FormulaTextboxActiveSheetChanging",a.FormulaTextboxActiveSheetChanged="FormulaTextboxActiveSheetChanged",a.FormulaTextboxEditStarted="FormulaTextboxEditStarted",a.FormulaTextboxEnterCell="FormulaTextboxEnterCell",a.FormulaTextboxEditEnded="FormulaTextboxEditEnded",a.FormulaTextboxRangeChanged="FormulaTextboxRangeChanged",a.SheetMoving="SheetMoving",a.SheetMoved="SheetMoved",a.DragMerging="DragMerging",a.DragMerged="DragMerged",a.ChartClicked="ChartClicked",a.FloatingElementSelected="FloatingElementSelected",a.BeforePrint="BeforePrint",a.TableResizing="TableResizing",a.TableResized="TableResized",a.TableRowsChanged="TableRowsChanged",a.TableColumnsChanged="TableColumnsChanged",a.DropdownSpreadMouseClick="DropdownSpreadMouseClick",a.DropdownSpreadKeyboardEnter="DropdownSpreadKeyboardEnter",a.PasteEnd="PasteEnd",a.SheetTabAllSheetsListContextMenuOpening="SheetTabAllSheetsListContextMenuOpening",a.SheetTabAllSheetsListContextMenuOpened="SheetTabAllSheetsListContextMenuOpened",a.WorksheetDataChanged="WorksheetDataChanged",a}(),b.Events=ra,sa=function(){function a(a){this.kj=a}return a.prototype.no=function(){this.kj=E},a.prototype.Sm=function(a,b,c){var d,e=this.Tm,f=a<<4+b;return e?(d=e[f],d||(d=c(),e[f]=d),d):c()},a.prototype.Um=function(a,b){var c,d=this.Vm;return d&&(c=d[a])?c[b]:E},a.prototype.Wm=function(a,b,c,d){var e,f=this.Vm;f&&(f[a]||(f[a]={}),e=f[a],e[b]={d:c,i:d})},a.prototype.zHb=function(a,b,c,d,e){var f,g=this,h=g.kj;return c===D&&(c=3),f=h.xHb(a,b,c),q(f)?!q(e)&&ha.lHb(e.formatter)?ta.vn(h,e,g.ge(a,b,c,0),{},{row:a,col:b,sheet:h}):g.ge(a,b,c,d):f},a.prototype.ge=function(a,b,c,d){var e,f,g,h=this,i=h.kj,j=h.Xm;return c===D&&(c=3),j?(e=j[c],e||(e={},j[c]=e),f=e[a],f||(f={},e[a]=f),g=f[b],g===D&&(g=i.getValue(a,b,c,d),f[b]=g),g):i.getValue(a,b,c,d)},a.prototype.Ym=function(a,b,c){var d,e,f,g=this,h=g.kj,i=g.Zm;return c===D&&(c=3),i?(d=i[c],d||(d={},i[c]=d),e=d[a],e||(e={},d[a]=e),f=e[b],f||(f=h.AHb(a,b,c,!1,!0),e[b]=f),f.clone(!0)):h.AHb(a,b,c,!1,!1)},a.prototype.Sl=function(a,b){var c,d,e,f,h;return void 0===b&&(b=g.SheetArea.viewport),c=this,d=c.kj,(e=c.$m)?(f=e[b],f===D&&(f=e[b]={}),h=f[a],h===D&&(h=f[a]=d.Sl(a,b)),h):d.Sl(a,b)},a.prototype._m=function(a,b){var c,d,e,f,h;return void 0===b&&(b=g.SheetArea.viewport),c=this,d=c.kj,(e=c.an)?(f=e[b],f===D&&(f=e[b]={}),h=f[a],h===D&&(h=f[a]=d.Tl(a,b)),h):d.Tl(a,b)},a.prototype.bn=function(a){var b=this;return b.Xm?(b.cn||(b.cn=a()),b.cn):a()},a.prototype.dn=function(a){var b=this;return b.Xm?(b.gn||(b.gn=a()),b.gn):a()},a.prototype.b8J=function(){var a=this;a.in=!0,a.Tm={},a.Vm={},a.Xm={},a.Zm={},a.$m={},a.an={}},a.prototype.jn=function(){this.in=!1},a.prototype.kn=function(){var a=this;a.in=!1,a.Tm=E,a.Vm=E,a.Xm=E,a.Zm=E,a.an=E,a.$m=E,a.cn=E,a.gn=E},a}(),b.ln=sa,ta=function(){function a(){}return a.qn=function(b,c,d,e,f){var g,h,i,j;if(a.nn=!0,g=b.tables,g&&g.rn(c,d,e-c+1,f-d+1))for(h=-1,i=a.sn=[],j=0;j<=e;j++)b.getRowVisible(j)?(h++,i[j]=h):i[j]=-1},a.Nm=function(){a.sn=E,a.nn=!1},a.tn=function(b){var c=a.on;return c[b]||(c[b]=o?new o(b):E),c[b]},a.un=function(b,c,d){var e,f,g,h,i,j,k,l=a.pn,m=b+"_"+typeof b;return o?(l[c]||(l[c]={}),e=l[c],(f=e[m])?(d&&(d.conditionalForeColor=d.value=f.color,d.content=n(f.content)),f.text):(g=a.on,g[c]||(g[c]=new o(c)),h=g[c],i={},j=h.format(b,i),k=e[m]={},k.text=j,k.color=i.conditionalForeColor,k.content=i.content,d&&(d.conditionalForeColor=d.value=i.conditionalForeColor,d.content=n(i.content)),j)):""+b},a.vn=function(a,b,c,d,e){var f,g;return c&&"SparklineExValue"===c.typeName?"":(f=b.cellType||a.Al(),g=b.formatter||b._autoFormatter,f.format(c,g,d,e))},a.wn=function(){a.on={},a.pn={}},a.nn=!1,a.on={},a.pn={},a.sn=[],a}(),b.mn=ta;function eb(a){var b=a.An||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return a.An=b,b}ua=function(){function a(){}return a.Cn=function(a,b,c){var d=eb(a);d.scaleX=b,d.scaleY=c,d.translateX=d.orgTranslateX*b,d.translateY=d.orgTranslateY*c,a.setTransform(d.scaleX,d.skewX,d.skewY,d.scaleY,d.translateX,d.translateY)},a.Dn=function(a,b,c){var d=eb(a);d.orgTranslateX+=b,d.orgTranslateY+=c,d.translateX=d.orgTranslateX*d.scaleX,d.translateY=d.orgTranslateY*d.scaleY,a.setTransform(d.scaleX,d.skewX,d.skewY,d.scaleY,d.translateX,d.translateY)},a}(),b.Bn=ua,va=ua;function fb(a,b){a&&(a.Gn=b)}function gb(a,b){a&&(a.Hn=b)}function hb(a,b){a.In=b}function ib(a,b){a.Jn=b}wa=function(){function a(){}return a.npb=function(){var a=x.screen,b=a.deviceXDPI,c=x.devicePixelRatio||(b?b/a.logicalXDPI:1),d=20*c,e=J(d);return e-d>.82?e/20:J(100*c)/100},a.Kn=function(b,c,d){var e,f,g,h,i,j,k,l,m=a;if(fb(b,1),gb(b,1),e=a.npb(),(1!==e||1!==m.dpr)&&(m.dpr=e,f=c?c:d&&d.parent)){for(g=m.Fn,h=void 0,i=0;i<g.length;i++)if(f===g[i].workbook){h=g[i];break}if(h||(h={workbook:f,sheets:[],canvases:[]},g.push(h)),c)h.canvases.push(b);else{for(j=void 0,k=h.sheets,l=0;l<k.length;l++)if(k[l].sheet===d){j=k[l];break}j||(j={sheet:d,canvases:[]},k.push(j)),j.canvases.push(b)}}},a.Ln=function(a){return a&&a.Gn||1},a.Mn=function(a){return a&&a.Hn||1},a.Nn=function(a){return a.In},a.On=function(a){return a.Jn},a.Pn=function(b,c,d){var e,f,g,h=a,i=h.dpr,j=h.Ln(b),k=h.Mn(b);hb(b,c),ib(b,d),1===i&&1===j&&1===k?(b.width=c,b.height=d):(e=b.getContext("2d"),va.Cn(e,1,1),ha.Ml.mozilla?(b.width=G(c*i),b.height=G(d*i)):(b.width=J(c*i),b.height=J(d*i)),b.style.width=c+O,b.style.height=d+O,f=b.width/c,g=b.height/d,f===j&&g===k||(fb(b,f),gb(b,g)),va.Cn(e,f,g))},a.Qn=function(b,c){var d,e,f,g,h,i=a.Fn,j=b.parent;for(f=0;f<i.length;f++)if(!j||i[f].workbook===j)for(d=i[f].sheets,g=0;g<d.length;g++)if(d[g].sheet===b){for(e=d[g].canvases,h=0;h<e.length;h++)if(e[h]===c){e.splice(h,1);break}break}},a.Rn=function(b,c){var d,e,f,g=a.Fn;for(e=0;e<g.length;e++)if(g[e].workbook===b)for(d=g[e].canvases,f=0;f<d.length;f++)if(d[f]===c){d.splice(f,1);break}},a.Sn=function(b){var c,d,e,f=a.Fn,g=b.parent;for(d=0;d<f.length;d++)if(!g||f[d].workbook===g){for(c=f[d].sheets,
e=0;e<c.length;e++)c[e].sheet===b&&c.splice(e,1);return}},a.Tn=function(b){var c,d=a.Fn;for(c=0;c<d.length;c++)if(d[c].workbook===b)return void d.splice(c,1)},a.Un=function(){var b,c,d,e,f,g,h,i,j=a,k=j.npb();if(j.dpr!==k)for(b=j.Fn,c=void 0,d=void 0,e=void 0,f=void 0,j.dpr=k,g=0;g<b.length;g++){for(d=b[g],e=d.canvases,c=d.sheets,h=0;h<c.length;h++)e=e.concat(c[h].canvases);for(i=0;i<e.length;i++)f=e[i],j.Pn(f,j.Nn(f),j.On(f))}},a.dpr=1,a.Fn=[],a}(),b.En=wa;function jb(){return xa.Yn||(xa.Yn=Ja("canvas").getContext("2d")),xa.Yn}function kb(a){var b,c,d,e=[],f=0,g=P;for(b=0;b<a.length;b++)e[f]===D&&(e[f]=""),c=a.charAt(b),d="",b+1<a.length&&(d=a.charAt(b+1)),c===g&&d!==g||"-"===c&&"-"!==d?(e[f]+=c,f++):e[f]+=c;return e}b.GXJ=kb;function lb(a){for(var b=a.length-1;" "===a.charAt(b);)b--;return b!==a.length-1&&(a=a.substring(0,b+1)),a}function mb(a){var b,c=a instanceof Array?[]:{};for(b in a)a.hasOwnProperty(b)&&(c[b]="object"==typeof a[b]&&a[b]!==E?mb(a[b]):a[b]);return c}function nb(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o=[],p=e?e:jb();if(!p)return o;for(c?(h=a.length*d,g=G(b/d)):(h=ia(p,p.font,a),f=h/a.length,g=G(b/f));h>b&&a;)for(i=!1,j=g;;){if(a.length<j){o.push(a),a="";break}if(k=a.substring(0,j),l=c?j*d:ia(p,p.font,k),"-"===k.charAt(k.length-1)&&(l=c?j*d:ia(p,p.font,k)-ia(p,p.font,"-")),l===b||i&&l<b){o.push(k),a=a.substring(j),h-=l;break}if(l>b){if(1===k.length){m=a.substring(k.length),m.trim()?(o.push(k),a=a.substring(j),h-=l):(o.push(a),a="");break}j-=1,i=!0}else n=c?(b-l)/d:(b-l)/f,n=n>=1?n:1,j+=n}return a&&a.search(/^[ ]*$/)===-1&&o.push(a),o}function ob(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r=f?f:jb();if(!r)return[a];for(g=[],h=0,i=b,j=[],k=0;k<a.length;k++)if(l=a[k].style&&a[k].style.font||e,m=ha.fp(l),l=Ma(a[k],l),a[k].text&&a[k].text.length>0?h+=d?m*a[k].text.length:ia(r,l,a[k].text):h=0,h<i)j.push(a[k]);else for(h-=d?m*a[k].text.length:ia(r,l,a[k].text),n=0,o=a[k].text.length;n<o;n++){if(p=d?m:ia(r,l,a[k].text.charAt(n)),p>c&&0===n){j.length>0&&(g.push(j),j=[]),j.push({style:a[k].style,text:a[k].text.substring(0,1)}),g.push(j),j=[],q=a[k].text.substring(1,a[k].text.length),q.length&&a.splice(k+1,0,{style:a[k].style,text:q}),h=0,i=c;break}if(h+=p,h>i){j.push({style:a[k].style,text:a[k].text.substring(0,n)}),g.push(j),j=[],q=a[k].text.substring(n,a[k].text.length),q.length&&a.splice(k+1,0,{style:a[k].style,text:q}),h=0,i=c;break}n===o-1&&(j.push({style:a[k].style,text:a[k].text}),g.push(j),j=[],h=0,i=c)}return j.length>0&&g.push(j),g}function pb(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=[],u=kb(a),v=e?e:jb();if(!v)return t;for(f=ia(v,v.font,a),g=c?d:f/a.length,h=K(b/g+"",10),i=0,j=0,k=0,l=0,m=[],n=!1;l<u.length;){if(n===!1){if(o=u[l],m.push(o),j+=o.length,j<h&&l<u.length-1){l++;continue}k=j,j=0}if(p=c?m.join("").length*d:xa.Xn(m.join(""),v.font,!0,v),"-"===m.join("").charAt(m.join("").length-1)&&(p=c?m.join("").length*d:ia(v,v.font,m.join(""))-ia(v,v.font,"-")),p>b)if(q=m.pop(),0===m.length){for(r=nb(q,b,c,d,v),s=0;s<r.length-1;s++)t[i]=r[s],i++;1===r.length&&(t[i]=r[0],i++),r.length>=2?u[l]=r[r.length-1]:l++,n=!1}else n=!0,l--;else p<b&&n===!0||p===b?(n=!1,t[i]=lb(m.join("")),i++,m=[],l++):p<b&&(l++,j=k)}return 0!==m.length&&(t[i]=lb(m.join(""))),t}function qb(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,r=[],s=e?e:jb();if(!s)return r;if(0===a.length)return r.push({textLength:0,text:"",textInfos:[{style:{font:c},text:""}]}),r;for(f=0,g=[],h=0;h<a.length;h++){for(i=a[h],j=0,k=0,l=0;l<i.length;l++)m=void 0,m=i[l].style&&i[l].style.font?i[l].style.font:c,d?(k=ha.fp(m),j+=k*i[l].text.length):q(i[l].text)||(m=Ma(i[l],m),j+=ia(s,m,i[l].text));if(j>b){for(g.length>0&&(r.push({textLength:f,text:lb(sb(g)),textInfos:mb(g)}),g=[],f=0),n=ob(i,b-f,b,d,c,s),g=g.concat(n[0]),q(n[0])||r.push({textLength:f+rb(n[0],c,d,s),text:lb(sb(g)),textInfos:mb(g)}),g=[],f=0,o=1;o<n.length-1;o++)q(n[o])||r.push({textLength:rb(n[o],c,d,s),text:lb(sb(n[o])),textInfos:mb(n[o])});n.length>1&&(p=n[n.length-1],g=g.concat(p),q(p)||(f+=rb(p,c,d,s)))}else f+j>b?(r.push({textLength:f,text:lb(sb(g)),textInfos:mb(g)}),g=[],g=g.concat(i),f=j):(g=g.concat(i),f+=j)}return g.length>0&&r.push({textLength:f,text:lb(sb(g)),textInfos:mb(g)}),r}function rb(a,b,c,d){var e,f,g,h=0,i=d?d:jb();for(e=0;e<a.length;e++)f=a[e].style&&a[e].style.font||b,g=Ma(a[e],f),h+=c?ha.fp(f)*a[e].text.length:ia(i,g,a[e].text);return h}function sb(a){var b,c="";for(b=0;b<a.length;b++)c+=a[b].text;return c}function tb(a,b,c,d){var e,f,g,h,i,j=-1,k=!0;for(e=0;e<b.length;e++)if(!q(b[e].text))for(f=0;f<b[e].text.length;f++)g=b[e].text.charAt(f),h=b[e].style?b[e].style.font:c,ha.lZa(a,h),i=ha.fp(h),g===P||k?g!==P&&k&&(j=d?i:ia(a,c,g),k=!1):j=H(j,d?i:ia(a,c,g));return j}xa=function(){function a(){}return a.Wn=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=[];if(!a||0===a.length||isNaN(b))return p;if(f=e?e:jb(),!f)return p;if(ha.lZa(f,c),g=ha.fp(c),b<=0){for(h=-1,i=!0,j=0;j<a.length;j++)k=a.charAt(j),k===P||i?k!==P&&i&&(h=d?g:ia(f,f.font,k),i=!1):h=H(h,d?g:ia(f,f.font,k));if(b=h,b<=0)return[a]}for(l=a.split(/\r\n|\r|\n/),m=0;m<l.length;m++)if(n=pb(l[m],b,d,g,f))if(0===n.length)p.push("");else for(o=0;o<n.length;o++)p.push(n[o]);return p},a.oV=function(b,c,d,e,f){var g,h,i,j,k=[];if(0===c.length)return k;if(e)k=a.Wn(c,f,d,!0);else for(g=c.split(/\r\n|\r|\n/),h=0;h<g.length;h++){for(i=[],j=0;j<g[h].length;j++)i.push(g[h][j]);k.push(i)}return k},a.M_a=function(b,c,d,e,f,g){var h,i,j,k,l,m,n,o=[];if(0===b.length)return o;if(h=g?g:jb(),!h)return o;if(c<=0&&(c=tb(h,e,d,f),c<=0)){for(j=[],i=0;i<e.length;i++)q(e[i].text)||j.push({textLength:a.R_a([e[i]],d,1,f,!1,h),text:e[i].text,textInfos:[e[i]]});return j}for(k=a.N_a(b),l=a.O_a(k,a.P_a(e)),i=0;i<l.length;i++)if(m=qb(l[i],c,d,f,h))if(0===m.length)o.push("");else for(n=0;n<m.length;n++)o.push(m[n]);return o},a.N_a=function(a){var b,c=[],d=a.split(/\r\n|\r|\n/);for(b=0;b<d.length;b++)c.push(kb(d[b]));return c},a.O_a=function(a,b){var c,d,e,f,g,h,i=[],j=0,k=0;for(c=0;c<a.length;c++){for(d=[],e=0;e<a[c].length&&j<b.length;e++)if(f=a[c][e],f.length<=b[j].text.length-k)d.push([{style:b[j].style,text:f}]),k+=f.length;else{for(g=[],g.push({style:b[j].style,text:b[j].text.substring(k)}),h=f.length-(b[j].text.length-k),j++;j<b.length;j++){if(h<b[j].text.length){g.push({style:b[j].style,text:f.substring(f.length-h)}),k=h;break}if(h===b[j].text.length){g.push({style:b[j].style,text:f.substring(f.length-h)}),j++,k=0;break}g.push({style:b[j].style,text:b[j].text}),h-=b[j].text.length}d.push(g)}i.push(d)}return i},a.Xn=function(a,b,c,d){var e,f=d?d:jb();return f?(b&&ha.lZa(f,b),e=c?lb(a):a,ia(f,f.font,e)):0},a.P_a=function(a){var b,c=[];for(b=0;b<a.length;b++)c.push({style:a[b].style,text:a[b].text?a[b].text.replace(/\r\n|\r|\n/g,""):a[b].text});return c},a.R_a=function(a,b,c,d,e,f){var g,h,i,j,k,l=f?f:jb();if(!l)return 0;for(g=0,h=0;h<a.length;h++)i=void 0,i=a[h].style&&a[h].style.font?a[h].style.font:b,ha.lZa(l,i),j="",j=h===a.length-1&&e?lb(a[h].text):a[h].text,k=0,d?k=ha.fp(i)*j.length/c:q(a[h].text)||(k=ia(l,l.font,a[h].text)/c),a[h].style&&a[h].style.vertAlign&&(k*=N),g+=k;return g},a.mHb=function(b,c,d,e,f,g,h,i){var j=0,k=ha.fp(g),l=(h-4-k*e)/d,m=a.Wn(f,l,g),n=m.length,o=k/d,p=k*d;return j=(n-1)*o,j+=a.Xn(m[0],g)/2*e+p,j+=a.Xn(m[n-1],g)/2*e+p},a.Rvb=function(a){return lb(a)},a.bm=function(){return jb()},a}(),b.Vn=xa,b.Zn=function(a){a.$n=function(b,c){var d,e;for(a._n||(a._n=[]),a.tcc={},d=a._n,c.name=b,c.priority=c.priority||5e3,e=0;;e++)if(e>=d.length||c.priority>d[e].priority){d.splice(e,0,c);break}},a.ao=function(b,c,d,e){var f,g,h,i=a._n;if(i){if(f=a.tcc[c],!f)for(f=a.tcc[c]=[],g=0;g<i.length;g++)h=i[g][c],h&&f.push(h);for(g=0;g<f.length&&(f[g].call(b,d),!e||!e());g++);}}},ya=function(){function a(){this.JTa={}}return a.prototype.get=function(a,b){var c=this.JTa[a];return c?c[b]:D},a.prototype.set=function(a,b,c){var d=this.JTa[a];d||(d=this.JTa[a]={}),d[b]=c},a}(),b.KTa=ya,za=function(){function a(){}return a.processBackspaceAndLeftArrowKeyEvent=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=x.getSelection();if(!(s.rangeCount<=0)){if(c=s.anchorNode,d=s.anchorOffset,e=a.target,ha.browser.msie&&!ha.browser.edge&&b&&xb(c,d,e))return f=parseFloat(ha.browser.version)<10?Hb(e):e.innerText,g=f.slice(0,-1),e.innerHTML=g.replace(/\r/g,"").replace(/\n/g,"<br>\u200b"),s.selectAllChildren(e),s.rangeCount>0&&s.collapseToEnd(),void Na(a);if(h=s.getRangeAt(0),i=h.startContainer,j=h.endContainer,k=h.startOffset,l=h.endOffset,m=i===j&&k===l){if(n=Fb(c,d),n&&n.zeroWidthCharNode){if(o=n.zeroWidthCharNode,p=n.previousTextNode,b)if(yb(o))o.parentNode.removeChild(o);else{if(o.parentNode.removeChild(o.previousSibling),zb(p))return void Na(a);q=s.getRangeAt(0),q.setStart(o,0),q.setEnd(o,1),q.deleteContents()}r=y.createRange(),vb(p)?(r.setStart(p,1),r.setEnd(p,1)):(r.setStartAfter(p),r.setEndAfter(p)),r.collapse(!1),s.removeAllRanges(),s.addRange(r),Na(a)}}else b&&ub(s)}},a.processDeleteAndRightArrowKeyEvent=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=x.getSelection();p.rangeCount<=0||(c=p.getRangeAt(0),d=c.startContainer,e=c.endContainer,f=c.startOffset,g=c.endOffset,h=d===e&&f===g,h?(i=Gb(p),i&&i.node&&(j=i.node,k=i.offset,l=Fb(j,k),b?(m=p.getRangeAt(0),1===k?(m.setStart(j,0),m.setEnd(j,1),j.parentNode.removeChild(j.previousSibling),m.deleteContents(),l&&l.previousTextNode&&(n=l.previousTextNode,o=y.createRange(),vb(n)?(o.setStart(n,1),o.setEnd(n,1)):(o.setStartAfter(n),o.setEndAfter(n)),o.collapse(!1),p.removeAllRanges(),p.addRange(o))):0===k&&(m.setStart(j,1),m.setEnd(j,2),m.deleteContents())):(o=y.createRange(),o.setStart(j,k),o.setEnd(j,k),o.collapse(!1),p.removeAllRanges(),p.addRange(o)),Na(a))):b&&ub(p))},a}(),b.uHb=za;function ub(a){var b,c,d,e,f=a.getRangeAt(0),g=f.startContainer,h=f.startOffset,i=wb(g);i&&(b=Fb(g,h),b&&b.zeroWidthCharNode&&(c=b.zeroWidthCharNode,d=a.getRangeAt(0),d.setStart(c,1),d.deleteContents(),e=y.createRange(),e.setStart(c,1),e.setEnd(c,1),a.removeAllRanges(),a.addRange(e),Na(event)))}function vb(a){return a.textContent&&1===a.textContent.length&&a.textContent.split("")[0]===X}function wb(a){return a.textContent&&a.textContent.split("")[0]===X}function xb(a,b,c){if(1===b&&yb(c.firstChild)&&yb(c.firstChild.firstChild)){var d=c.firstChild.firstChild.lastChild,e=void 0;if(a===c)return e=d.textContent,1===e.length&&e[0]!==X&&zb(d.previousSibling);if(d===a||zb(d)&&a===d.previousSibling)return e=a.textContent,1===e.length&&e[0]!==X&&zb(a.previousSibling)}return!1}function yb(a){return a&&"SPAN"===a.tagName}function zb(a){return a&&"BR"===a.tagName}function Ab(a){return a&&"DIV"===a.tagName}function Bb(a){return a instanceof Text}function Cb(a){if(a){var b=a.childNodes;return yb(a)&&2===b.length&&zb(b[0])&&Eb(b[1])}return!1}function Db(a,b){if(a){var c=a.childNodes;return yb(a)&&zb(c[b-2])&&Eb(c[b-1])}return!1}function Eb(a){if(a&&Bb(a)){var b=a.textContent;if(1===b.length&&Jb(b[0]))return!0}return!1}function Fb(a,b){var c,d,e,f,g,h=a.childNodes.length;if(!Jb(a.textContent[0])||0!==b&&1!==b)if(0===b)d=a,a===a.parentNode.firstChild&&(d=a.parentNode),e=Kb(d,Cb),c=e&&e.lastChild;else{if(Ab(a))return 1===h&&1===b?c=a.firstChild.firstChild.lastChild:h>1&&b===h&&(c=a.lastChild),Eb(c)?{zeroWidthCharNode:c,previousTextNode:c.previousSibling.previousSibling}:Cb(c)?{zeroWidthCharNode:c,previousTextNode:Kb(d,Bb)}:E;!yb(a)||b!==h&&b!==h-1||(Cb(a)?c=a:Cb(a.lastChild)?c=a.lastChild:Db(a,b)&&(c=a.childNodes[b-1]))}else c=a;return c?(yb(c)?d=c:Bb(c)&&(f=c.previousSibling,g=c.parentNode,d=f===g.firstChild?g:f),{zeroWidthCharNode:c,previousTextNode:Kb(d,Bb)}):E}function Gb(a){var b,c,d=a.anchorNode,e=a.anchorOffset,f=d.textContent,g=f.length;if(e===g){if(b=Lb(d),c=void 0,!b)return E;if(yb(b)&&Jb(b.textContent[0])){for(;yb(b.firstChild);)b=b.firstChild;c=b.childNodes[1]}else zb(b)&&Jb(b.nextSibling.textContent[0])&&(c=b.nextSibling);return{node:c,offset:1}}return 0===e&&Jb(f[0])?{node:d,offset:0}:E}function Hb(a,b,c,d,e,f){var g,h,i,j,k,l="",m=a.childNodes,n=m.length;for(g=0;g<n;g++)h=m[g],yb(h)?l+=Hb(h,b,c,d,e,f):Bb(h)?(i=b&&b.startContainer,j=b&&b.endContainer,k=h.textContent,h===i||h===j?i!==j?h===i?(l+=Ib(k,c,k.length,e),f=!0):(l+=Ib(k,0,d,""),f=!1):l+=Ib(k,c,d,e):f||(l+=k)):zb(h)&&!f&&(l+="\n");return l}function Ib(a,b,c,d){var e=a.substr(0,b),f=a.substr(c,a.length-c);return e+d+f}function Jb(a){return a===X}function Kb(a,b){for(var c=a&&a.previousSibling;c;){if(b(c))return c;c=c.lastChild}return E}function Lb(a){for(var b,c=a;c;){if(b=c.parentNode,c!==b.lastChild)return c.nextSibling;c=b}return E}b.Rxb={touch:!1};function Mb(a){var b,c;return a&&(b=a.getActiveSheet(),b||(c=a.getActiveSheetTab(),c&&(b=c.kj))),b}b.UCJ=Mb;function Nb(a,b){var c,d;a&&(c=a.getSheetFromName(b),c?a.setActiveSheet(b):(d=a.getSheetTab(b),d&&a.setActiveSheetTab(b)))}b.eHJ=Nb;function Ob(a,b){var c,d=a.getSheetFromName(b);return d||(c=a.getSheetTab(b),c&&(d=c.kj)),d}b.VCJ=Ob;function Pb(a){return"="===a||"+"===a||"-"===a}b.AVJ=Pb;function Qb(a){var b=0;return"+"!==a[b]&&"-"!==a[b]||(b+=1),a.length>b&&"%"===a[b]?a.length>b+1&&("-"===a[b+1]||"+"===a[b+1])?NaN:+a.slice(b+1):a.length>0&&"%"===a[a.length-1]?+a.slice(0,a.length-1):+a}function Rb(a){return a&&a.length>0&&Pb(a[0])&&isNaN(Qb(a))&&!Pb(a)}b.bW=Rb,Aa=function(){function a(){}return a.RZJ=function(a){var b,c,d;if(!q(a))return b={},c=a.row+a.rowCount-1,d=a.col+a.colCount-1,b.minRow=a.row,b.minCol=a.col,b.maxRow=c,b.maxCol=d,b},a.SZJ=function(a,b){return q(b)||q(b.minRow)?a:(a.minRow=q(a.minRow)?b.minRow:H(a.minRow,b.minRow),a.minCol=q(a.minCol)?b.minCol:H(a.minCol,b.minCol),a.maxRow=q(a.maxRow)?b.maxRow:I(a.maxRow,b.maxRow),void(a.maxCol=q(a.maxCol)?b.maxCol:I(a.maxCol,b.maxCol)))},a.updateUsedRangeByData=function(a,b,c,d,e){d===e||!q(d)&&!q(e)||q(a)||(!q(d)&&q(e)&&a.removeRowAndColInfo(b,c),q(d)&&!q(e)&&a.addRowAndColInfo(b,c))},a}(),b.UsedRangeUtil=Aa,Ba=function(){function a(){var a=this;a.rowInfo={},a.colInfo={},a.wholeCols={},a.wholeRows={}}return a.prototype.getRowUsedRange=function(){var a,b,c,d,e=this,f=e.wholeRows,g=Object.keys(f);return g.length>0&&(a=+g[0],b=-1,c=+g[g.length-1],d=0),{minRow:a,minCol:b,maxRow:c,maxCol:d}},a.prototype.getColUsedRange=function(){var a,b,c,d,e=this,f=e.wholeCols,g=Object.keys(f);return g.length>0&&(b=+g[0],a=-1,d=+g[g.length-1],c=0),{minRow:a,minCol:b,maxRow:c,maxCol:d}},a.prototype.getUsedRange=function(){var a,b,c,d,e=this,f=Object.keys(e.rowInfo),g=Object.keys(e.colInfo);return f&&f.length>0&&g&&g.length>0&&(a=+f[0],b=+g[0],c=+f[f.length-1],d=+g[g.length-1]),{minRow:a,minCol:b,maxRow:c,maxCol:d}},a.prototype.addRowAndColInfo=function(a,b){var c=this,d=c.rowInfo,e=c.colInfo;q(a)||q(b)||a===-1&&b===-1||(a===-1?c.wholeCols[b]=!0:b===-1?c.wholeRows[a]=!0:(q(d[a])?d[a]=1:d[a]++,q(e[b])?e[b]=1:e[b]++))},a.prototype.removeRowAndColInfo=function(a,b){var c=this,d=c.rowInfo,e=c.colInfo;a===-1&&b===-1||(a===-1?delete c.wholeCols[b]:b===-1?delete c.wholeRows[a]:(q(d[a])||(1===d[a]?delete d[a]:d[a]--),q(e[b])||(1===e[b]?delete e[b]:e[b]--)))},a.prototype.addHeadInfo=function(a,b,c){for(var d=this,e=c?d.rowInfo:d.colInfo,f=Object.keys(e),g=f.length-1,h=+f[g];h>=a;)e[h+b]=e[h],--g,h=+f[g]},a.prototype.removeHeadInfo=function(a,b,c){var d,e,f,g=this,h=c?g.rowInfo:g.colInfo,i=Object.keys(h),j=a+b;for(d=0,e=i;d<e.length;d++)f=e[d],+f>=j&&(h[+f-b]=h[f],delete h[f])},a.prototype.dispose=function(){var a=this;a.rowInfo=D,a.colInfo=D,a.wholeCols=D,a.wholeRows=D},a}(),b.BaseUsedRange=Ba,b.NUMBER_ARRAY=["0","1","2","3","4","5","6","7","8","9"],Ca=function(){function a(){this.reset()}return a.prototype.getTextIndex=function(a){var b,c,d,e,f,g=this;if(a.richText)if(c=a.text,c===D&&(c=a.text=ha.n0a(a).text),b=g.YcK[c],b===D||g.ZcK[c]===D)b=g.uda.push(a)-1,g.YcK[c]=b,g.ZcK[c]=[],g.ZcK[c].push({i:b,v:a});else{for(d=void 0,e=0,f=g.ZcK[c].length;e<f;e++)if(g.ZcK[c][e]&&g.ZcK[c][e].v===a){d=e;break}d>=0?b=g.ZcK[c][d].i:(b=g.uda.push(a)-1,g.ZcK[c].push({i:b,v:a}))}else b=g.YcK[a],(b===D||g.ZcK[a])&&(b=g.uda.push(a)-1,g.YcK[a]=b);return b},a.prototype.getText=function(a){var b=this.uda[a];return q(b)?a:b},a.prototype.getCount=function(){return this.yoa},a.prototype.reset=function(){var a=this;a.uda=[],a.YcK={},a.ZcK={},a.yoa=0},a.prototype.rebuildSSTDict=function(){var a=this;a.uda.forEach(function(b,c){if(b.richText){var d=b.text;d===D&&(d=b.text=ha.n0a(b).text),a.YcK[d]=c}else a.YcK[b]=c})},a.prototype.cdK=function(a){if(a&&a.length>0){var b=this;b.reset(),b.uda=a}},a.prototype.bdK=function(){return this.uda},a}(),b.SharedStrings=Ca,Da={8:{"Gill Sans MT":6,Abadi:7,"Abadi Extra Light":6,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:7,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:4,"Arabic Typesetting":4,Arial:6,"Arial Black":7,"Arial Narrow":5,"Arial Nova":6,"Arial Nova Cond":6,"Arial Nova Cond Light":5,"Arial Nova Light":6,"Arial Rounded MT Bold":7,"Baskerville Old Face":5,Batang:6,BatangChe:6,"Bauhaus 93":6,"Bell MT":6,Bembo:5,"Berlin Sans FB":7,"Berlin Sans FB Demi":7,"Bernard MT Condensed":5,"Blackadder ITC":4,"Bodoni MT":5,"Bodoni MT Black":7,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":4,"Book Antiqua":6,"Bookman Old Style":7,"Bookshelf Symbol 7":8,"Bradley Hand ITC":7,"Britannic Bold":7,Broadway:7,"Browallia New":4,BrowalliaUPC:4,"Brush Script MT":6,Calibri:6,"Calibri Light":6,"Californian FB":5,"Calisto MT":6,Cambria:6,"Cambria Math":6,Candara:6,Castellar:8,Centaur:5,Century:6,"Century Gothic":6,"Century Schoolbook":6,Chiller:5,"Colonna MT":6,"Comic Sans MS":7,Consolas:6,Constantia:6,"Cooper Black":7,"Copperplate Gothic Bold":8,"Copperplate Gothic Light":8,Corbel:6,"Cordia New":4,CordiaUPC:4,"Courier New":7,"Curlz MT":6,Dante:5,DaunPenh:4,David:5,DilleniaUPC:3,DokChampa:6,Dotum:6,DotumChe:6,Dubai:6,"Dubai Light":6,"Dubai Medium":6,Ebrima:6,"Edwardian Script ITC":5,Elephant:8,"Engravers MT":7,"Eras Bold ITC":7,"Eras Demi ITC":7,"Eras Light ITC":6,"Eras Medium ITC":6,EucrosiaUPC:4,Euphemia:6,"Expo M":10,FangSong:6,"Felix Titling":6,"Footlight MT Light":6,Forte:6,"Franklin Gothic Book":6,"Franklin Gothic Demi":6,"Franklin Gothic Demi Cond":6,"Franklin Gothic Heavy":6,"Franklin Gothic Medium":6,"Franklin Gothic Medium Cond":6,FrankRuehl:5,FreesiaUPC:5,"Freestyle Script":4,"French Script MT":4,Gabriola:4,Gadugi:6,Garamond:5,Gautami:7,Georgia:8,"Georgia Pro":6,"Georgia Pro Black":8,"Georgia Pro Cond":6,"Georgia Pro Cond Black":7,"Georgia Pro Cond Light":6,"Georgia Pro Cond Semibold":6,"Georgia Pro Light":6,"Georgia Pro Semibold":7,Gigi:5,"Gill Sans MT Condensed":4,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":6,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":3,"Gill Sans Nova Cond Ultra Bold":6,"Gill Sans Nova Cond XBd":6,"Gill Sans Nova Light":6,"Gill Sans Nova Ultra Bold":9,"Gill Sans Ultra Bold":9,"Gill Sans Ultra Bold Condensed":6,Gisha:6,"Gloucester MT Extra Condensed":4,"Goudy Old Style":6,"Goudy Stout":9,Grotesque:5,"Grotesque Light":5,Gulim:6,GulimChe:6,Gungsuh:6,GungsuhChe:6,"Hadassah Friedlaender":6,Haettenschweiler:5,"Harlow Solid Italic":5,Harrington:6,"Headline R":8,HGGothicE:6,HGGothicM:6,HGGyoshotai:6,HGKyokashotai:6,HGMaruGothicMPRO:8,HGMinchoB:7,HGMinchoE:7,HGPGothicE:7,HGPGothicM:7,HGPGyoshotai:6,HGPKyokashotai:6,HGPMinchoB:6,HGPMinchoE:7,HGPSoeiKakugothicUB:8,HGPSoeiKakupoptai:8,HGPSoeiPresenceEB:7,HGSeikaishotaiPRO:7,HGSGothicE:6,HGSGothicM:6,HGSGyoshotai:5,HGSKyokashotai:5,HGSMinchoB:6,HGSMinchoE:7,HGSoeiKakugothicUB:7,HGSoeiKakupoptai:7,HGSoeiPresenceEB:7,HGSSoeiKakugothicUB:7,HGSSoeiKakupoptai:7,HGSSoeiPresenceEB:6,"High Tower Text":5,"HYGothic-Extra":7,"HYGothic-Medium":6,"HYGraphic-Medium":6,"HYGungSo-Bold":6,"HYHeadLine-Medium":6,"HYMyeongJo-Extra":7,"HYPMokGak-Bold":8,"HYPost-Light":7,"HYPost-Medium":8,"HYShortSamul-Medium":4,"HYSinMyeongJo-Medium":7,Impact:6,"Imprint MT Shadow":6,"Informal Roman":6,"Ink Free":6,IrisUPC:6,"Iskoola Pota":6,JasmineUPC:6,"Javanese Text":6,Jokerman:8,"Juice ITC":4,KaiTi:6,Kalinga:6,Kartika:6,"Khmer UI":6,KodchiangUPC:6,Kokila:6,"Kristen ITC":7,"Kunstler Script":4,"Lao UI":6,Latha:6,Leelawadee:6,"Leelawadee UI":6,"Leelawadee UI Semilight":6,"Levenim MT":6,LilyUPC:6,"Lucida Bright":7,"Lucida Calligraphy":7,"Lucida Console":8,"Lucida Fax":7,"Lucida Handwriting":8,"Lucida Sans":7,"Lucida Sans Typewriter":7,"Lucida Sans Unicode":8,"Magic R":7,Magneto:8,"Maiandra GD":7,"Malgun Gothic":6,"Malgun Gothic Semilight":7,Mangal:7,Marlett:12,"Matura MT Script Capitals":8,Meiryo:7,"Meiryo UI":7,"Microsoft GothicNeo":7,"Microsoft Himalaya":5,"Microsoft JhengHei":7,"Microsoft JhengHei Light":7,"Microsoft JhengHei UI":7,"Microsoft JhengHei UI Light":7,"Microsoft New Tai Lue":6,"Microsoft PhagsPa":6,"Microsoft Sans Serif":7,"Microsoft Tai Le":6,"Microsoft Uighur":4,"Microsoft YaHei Light":7,"Microsoft YaHei UI":7,"Microsoft YaHei UI Light":7,"Microsoft Yi Baiti":7,MingLiU:7,MingLiU_HKSCS:7,"MingLiU_HKSCS-ExtB":7,"MingLiU-ExtB":7,Miriam:7,"Miriam Fixed":7,Mistral:6,"Modern No. 20":6,"MoeumT R":7,"Mongolian Baiti":7,"Monotype Corsiva":6,MoolBoran:7,"MS Gothic":7,"MS Mincho":7,"MS Outlook":7,"MS PGothic":7,"MS PMincho":7,"MS Reference Sans Serif":8,"MS Reference Specialty":14,"MS UI Gothic":7,"MT Extra":12,"MV Boli":9,"Myanmar Text":6,Narkisim:7,"Neue Haas Grotesk Text Pro":7,"New Gulim":7,"News Gothic MT":7,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":6,"Nirmala UI Semilight":7,Nyala:7,"OCR A Extended":8,OCRB:8,"Old English Text MT":7,Onyx:5,"Palace Script MT":4,"Palatino Linotype":6,Papyrus:7,Parchment:3,Perpetua:5,"Perpetua Titling MT":7,"Plantagenet Cherokee":7,Playbill:5,PMingLiU:6,"PMingLiU-ExtB":6,"Poor Richard":7,Pristina:6,"Pyunji R":6,Raavi:7,"Rage Italic":7,Ravie:11,Rockwell:6,"Rockwell Condensed":5,"Rockwell Extra Bold":8,"Rockwell Light":7,"Rockwell Nova":7,"Rockwell Nova Cond":7,"Rockwell Nova Cond Light":7,"Rockwell Nova Extra Bold":7,"Rockwell Nova Light":7,Rod:7,"Sakkal Majalla":7,"Sanskrit Text":7,"Script MT Bold":6,"Segoe MDL2 Assets":4,"Segoe Print":8,"Segoe Script":8,"Segoe UI":6,"Segoe UI Black":7,"Segoe UI Emoji":6,"Segoe UI Historic":6,"Segoe UI Light":6,"Segoe UI Semibold":6,"Segoe UI Semilight":6,"Segoe UI Symbol":6,Selawik:6,"Selawik Light":6,"Selawik Semibold":6,"Shonar Bangla":6,"Showcard Gothic":6,Shruti:6,"Simplified Arabic":6,"Simplified Arabic Fixed":6,"SimSun-ExtB":6,"Sitka Banner":6,"Sitka Display":6,"Sitka Heading":6,"Sitka Small":8,"Sitka Subheading":6,"Sitka Text":7,"Snap ITC":10,"Source Sans Pro":6,"Source Sans Pro Black":6,"Source Sans Pro ExtraLight":6,"Source Sans Pro Light":6,"Source Sans Pro SemiBold":6,Stencil:6,Sylfaen:6,Symbol:6,Tahoma:6,"Tempus Sans ITC":7,"TH SarabunPSK":6,"Times New Roman":6,"Traditional Arabic":6,"Trebuchet MS":6,Tunga:6,"Tw Cen MT":6,"Tw Cen MT Condensed":4,"Tw Cen MT Condensed Extra Bold":5,"UD Digi Kyokasho N-B":6,"UD Digi Kyokasho NK-B":6,"UD Digi Kyokasho NK-R":6,"UD Digi Kyokasho NP-B":6,"UD Digi Kyokasho NP-R":6,"UD Digi Kyokasho N-R":6,Univers:6,"Univers Condensed":6,"Univers Condensed Light":6,"Univers Light":6,"Urdu Typesetting":6,Utsaah:6,Vani:6,Verdana:7,"Verdana Pro":6,"Verdana Pro Black":6,"Verdana Pro Cond":6,"Verdana Pro Cond Black":6,"Verdana Pro Cond Light":6,"Verdana Pro Cond SemiBold":6,"Verdana Pro Light":6,"Verdana Pro SemiBold":6,Vijaya:6,"Viner Hand ITC":7,Vivaldi:5,"Vladimir Script":5,Vrinda:6,Webdings:11,"Wide Latin":14,Wingdings:15,"Wingdings 2":12,"Wingdings 3":10,"Yet R":6,"Yu Gothic":6,"Yu Gothic Light":6,"Yu Gothic Medium":6,"Yu Gothic UI":6,"Yu Gothic UI Light":6,"Yu Gothic UI Semibold":6,"Yu Gothic UI Semilight":6,"Yu Mincho":6,"Yu Mincho Demibold":6,"Yu Mincho Light":6,"\u4eff\u5b8b":6,"\u534e\u6587\u4e2d\u5b8b":7,"\u534e\u6587\u4eff\u5b8b":5,"\u534e\u6587\u5b8b\u4f53":5,"\u534e\u6587\u5f69\u4e91":6,"\u534e\u6587\u65b0\u9b4f":6,"\u534e\u6587\u6977\u4f53":5,"\u534e\u6587\u7425\u73c0":6,"\u534e\u6587\u7ec6\u9ed1":6,"\u534e\u6587\u884c\u6977":6,"\u534e\u6587\u96b6\u4e66":5,"\u5b8b\u4f53":6,"\u5e7c\u5706":6,"\u5fae\u8f6f\u96c5\u9ed1":6,"\u5fae\u8f6f\u96c5\u9ed1 Light":6,"\u65b0\u5b8b\u4f53":6,"\u65b9\u6b63\u59da\u4f53":6,"\u65b9\u6b63\u8212\u4f53":6,"\u6977\u4f53":6,"\u7b49\u7ebf":6,"\u7b49\u7ebf Light":6,"\u96b6\u4e66":6,"\u9ed1\u4f53":6,"\u6e38\u30b4\u30b7\u30c3\u30af":6,"\uff2d\uff33 \uff30\u660e\u671d":6,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':6,"\u30e1\u30a4\u30ea\u30aa":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":6,"HG\u660e\u671dB":6,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":6},9:{"Gill Sans MT":6,Abadi:7,"Abadi Extra Light":7,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:7,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:5,"Arabic Typesetting":4,Arial:7,"Arial Black":8,"Arial Narrow":5,"Arial Nova":7,"Arial Nova Cond":6,"Arial Nova Cond Light":5,"Arial Nova Light":7,"Arial Rounded MT Bold":7,"Baskerville Old Face":6,Batang:6,BatangChe:6,"Bauhaus 93":7,"Bell MT":6,Bembo:6,"Berlin Sans FB":7,"Berlin Sans FB Demi":8,"Bernard MT Condensed":6,"Blackadder ITC":5,"Bodoni MT":6,"Bodoni MT Black":8,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":4,"Book Antiqua":6,"Bookman Old Style":7,"Bookshelf Symbol 7":9,"Bradley Hand ITC":8,"Britannic Bold":7,Broadway:8,"Browallia New":4,BrowalliaUPC:4,"Brush Script MT":6,Calibri:6,"Calibri Light":6,"Californian FB":7,"Calisto MT":6,Cambria:7,"Cambria Math":7,Candara:7,Castellar:9,Centaur:6,Century:7,"Century Gothic":7,"Century Schoolbook":7,Chiller:6,"Colonna MT":6,"Comic Sans MS":7,Consolas:7,Constantia:7,"Cooper Black":7,"Copperplate Gothic Bold":9,"Copperplate Gothic Light":9,Corbel:6,"Cordia New":4,CordiaUPC:4,"Courier New":7,"Curlz MT":6,Dante:5,DaunPenh:4,David:5,DilleniaUPC:4,DokChampa:7,Dotum:6,DotumChe:6,Dubai:6,"Dubai Light":6,"Dubai Medium":6,Ebrima:6,"Edwardian Script ITC":6,Elephant:9,"Engravers MT":8,"Eras Bold ITC":8,"Eras Demi ITC":7,"Eras Light ITC":6,"Eras Medium ITC":7,EucrosiaUPC:5,Euphemia:7,"Expo M":10,FangSong:6,"Felix Titling":7,"Footlight MT Light":7,Forte:6,"Franklin Gothic Book":7,"Franklin Gothic Demi":7,"Franklin Gothic Demi Cond":6,"Franklin Gothic Heavy":7,"Franklin Gothic Medium":7,"Franklin Gothic Medium Cond":6,FrankRuehl:5,FreesiaUPC:5,"Freestyle Script":5,"French Script MT":4,Gabriola:5,Gadugi:6,Garamond:6,Gautami:7,Georgia:8,"Georgia Pro":7,"Georgia Pro Black":9,"Georgia Pro Cond":6,"Georgia Pro Cond Black":8,"Georgia Pro Cond Light":6,"Georgia Pro Cond Semibold":7,"Georgia Pro Light":7,"Georgia Pro Semibold":7,Gigi:7,"Gill Sans MT Condensed":4,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":6,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":4,"Gill Sans Nova Cond Ultra Bold":7,"Gill Sans Nova Cond XBd":6,"Gill Sans Nova Light":6,"Gill Sans Nova Ultra Bold":10,"Gill Sans Ultra Bold":10,"Gill Sans Ultra Bold Condensed":7,Gisha:6,"Gloucester MT Extra Condensed":5,"Goudy Old Style":6,"Goudy Stout":10,Grotesque:6,"Grotesque Light":6,Gulim:6,GulimChe:6,Gungsuh:6,GungsuhChe:6,"Hadassah Friedlaender":7,Haettenschweiler:5,"Harlow Solid Italic":6,Harrington:7,"Headline R":9,HGGothicE:6,HGGothicM:6,HGGyoshotai:6,HGKyokashotai:6,HGMaruGothicMPRO:9,HGMinchoB:7,HGMinchoE:7,HGPGothicE:8,HGPGothicM:8,HGPGyoshotai:7,HGPKyokashotai:7,HGPMinchoB:7,HGPMinchoE:7,HGPSoeiKakugothicUB:9,HGPSoeiKakupoptai:9,HGPSoeiPresenceEB:8,HGSeikaishotaiPRO:7,HGSGothicE:7,HGSGothicM:7,HGSGyoshotai:6,HGSKyokashotai:6,HGSMinchoB:7,HGSMinchoE:7,HGSoeiKakugothicUB:7,HGSoeiKakupoptai:7,HGSoeiPresenceEB:7,HGSSoeiKakugothicUB:8,HGSSoeiKakupoptai:8,HGSSoeiPresenceEB:7,"High Tower Text":6,"HYGothic-Extra":8,"HYGothic-Medium":7,"HYGraphic-Medium":7,"HYGungSo-Bold":7,"HYHeadLine-Medium":7,"HYMyeongJo-Extra":8,"HYPMokGak-Bold":9,"HYPost-Light":8,"HYPost-Medium":9,"HYShortSamul-Medium":5,"HYSinMyeongJo-Medium":8,Impact:7,"Imprint MT Shadow":6,"Informal Roman":7,"Ink Free":6,IrisUPC:6,"Iskoola Pota":6,JasmineUPC:6,"Javanese Text":7,Jokerman:9,"Juice ITC":4,KaiTi:6,Kalinga:6,Kartika:6,"Khmer UI":6,KodchiangUPC:6,Kokila:6,"Kristen ITC":7,"Kunstler Script":4,"Lao UI":6,Latha:6,Leelawadee:6,"Leelawadee UI":6,"Leelawadee UI Semilight":7,"Levenim MT":6,LilyUPC:6,"Lucida Bright":7,"Lucida Calligraphy":9,"Lucida Console":8,"Lucida Fax":8,"Lucida Handwriting":9,"Lucida Sans":8,"Lucida Sans Typewriter":7,"Lucida Sans Unicode":9,"Magic R":8,Magneto:9,"Maiandra GD":8,"Malgun Gothic":7,"Malgun Gothic Semilight":8,Mangal:7,Marlett:13,"Matura MT Script Capitals":9,Meiryo:8,"Meiryo UI":8,"Microsoft GothicNeo":7,"Microsoft Himalaya":5,"Microsoft JhengHei":7,"Microsoft JhengHei Light":8,"Microsoft JhengHei UI":7,"Microsoft JhengHei UI Light":8,"Microsoft New Tai Lue":7,"Microsoft PhagsPa":7,"Microsoft Sans Serif":8,"Microsoft Tai Le":7,"Microsoft Uighur":5,"Microsoft YaHei Light":8,"Microsoft YaHei UI":7,"Microsoft YaHei UI Light":8,"Microsoft Yi Baiti":7,MingLiU:7,MingLiU_HKSCS:7,"MingLiU_HKSCS-ExtB":7,"MingLiU-ExtB":7,Miriam:7,"Miriam Fixed":7,Mistral:6,"Modern No. 20":6,"MoeumT R":8,"Mongolian Baiti":7,"Monotype Corsiva":6,MoolBoran:7,"MS Gothic":7,"MS Mincho":7,"MS Outlook":7,"MS PGothic":7,"MS PMincho":7,"MS Reference Sans Serif":9,"MS Reference Specialty":15,"MS UI Gothic":7,"MT Extra":13,"MV Boli":9,"Myanmar Text":7,Narkisim:7,"Neue Haas Grotesk Text Pro":7,"New Gulim":8,"News Gothic MT":7,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":7,"Nirmala UI Semilight":8,Nyala:7,"OCR A Extended":8,OCRB:8,"Old English Text MT":7,Onyx:5,"Palace Script MT":5,"Palatino Linotype":6,Papyrus:8,Parchment:4,Perpetua:6,"Perpetua Titling MT":8,"Plantagenet Cherokee":7,Playbill:5,PMingLiU:7,"PMingLiU-ExtB":7,"Poor Richard":8,Pristina:6,"Pyunji R":7,Raavi:7,"Rage Italic":7,Ravie:12,Rockwell:7,"Rockwell Condensed":5,"Rockwell Extra Bold":8,"Rockwell Light":7,"Rockwell Nova":7,"Rockwell Nova Cond":7,"Rockwell Nova Cond Light":7,"Rockwell Nova Extra Bold":7,"Rockwell Nova Light":7,Rod:7,"Sakkal Majalla":7,"Sanskrit Text":7,"Script MT Bold":6,"Segoe MDL2 Assets":5,"Segoe Print":9,"Segoe Script":9,"Segoe UI":6,"Segoe UI Black":7,"Segoe UI Emoji":6,"Segoe UI Historic":6,"Segoe UI Light":6,"Segoe UI Semibold":7,"Segoe UI Semilight":7,"Segoe UI Symbol":6,Selawik:6,"Selawik Light":6,"Selawik Semibold":6,"Shonar Bangla":6,"Showcard Gothic":8,Shruti:6,"Simplified Arabic":6,"Simplified Arabic Fixed":6,"SimSun-ExtB":6,"Sitka Banner":6,"Sitka Display":6,"Sitka Heading":7,"Sitka Small":8,"Sitka Subheading":7,"Sitka Text":8,"Snap ITC":10,"Source Sans Pro":6,"Source Sans Pro Black":6,"Source Sans Pro ExtraLight":6,"Source Sans Pro Light":6,"Source Sans Pro SemiBold":6,Stencil:7,Sylfaen:6,Symbol:6,Tahoma:7,"Tempus Sans ITC":8,"TH SarabunPSK":6,"Times New Roman":6,"Traditional Arabic":6,"Trebuchet MS":6,Tunga:6,"Tw Cen MT":7,"Tw Cen MT Condensed":4,"Tw Cen MT Condensed Extra Bold":6,"UD Digi Kyokasho N-B":6,"UD Digi Kyokasho NK-B":6,"UD Digi Kyokasho NK-R":6,"UD Digi Kyokasho NP-B":6,"UD Digi Kyokasho NP-R":6,"UD Digi Kyokasho N-R":6,Univers:6,"Univers Condensed":6,"Univers Condensed Light":6,"Univers Light":6,"Urdu Typesetting":6,Utsaah:6,Vani:6,Verdana:8,"Verdana Pro":6,"Verdana Pro Black":6,"Verdana Pro Cond":6,"Verdana Pro Cond Black":6,"Verdana Pro Cond Light":6,"Verdana Pro Cond SemiBold":6,"Verdana Pro Light":6,"Verdana Pro SemiBold":6,Vijaya:6,"Viner Hand ITC":8,Vivaldi:5,"Vladimir Script":6,Vrinda:6,Webdings:12,"Wide Latin":15,Wingdings:16,"Wingdings 2":14,"Wingdings 3":11,"Yet R":6,"Yu Gothic":7,"Yu Gothic Light":6,"Yu Gothic Medium":7,"Yu Gothic UI":6,"Yu Gothic UI Light":6,"Yu Gothic UI Semibold":7,"Yu Gothic UI Semilight":7,"Yu Mincho":7,"Yu Mincho Demibold":6,"Yu Mincho Light":6,"\u4eff\u5b8b":6,"\u534e\u6587\u4e2d\u5b8b":7,"\u534e\u6587\u4eff\u5b8b":6,"\u534e\u6587\u5b8b\u4f53":6,"\u534e\u6587\u5f69\u4e91":7,"\u534e\u6587\u65b0\u9b4f":7,"\u534e\u6587\u6977\u4f53":6,"\u534e\u6587\u7425\u73c0":7,"\u534e\u6587\u7ec6\u9ed1":7,"\u534e\u6587\u884c\u6977":6,"\u534e\u6587\u96b6\u4e66":5,"\u5b8b\u4f53":6,"\u5e7c\u5706":6,"\u5fae\u8f6f\u96c5\u9ed1":7,"\u5fae\u8f6f\u96c5\u9ed1 Light":7,"\u65b0\u5b8b\u4f53":6,"\u65b9\u6b63\u59da\u4f53":6,"\u65b9\u6b63\u8212\u4f53":7,"\u6977\u4f53":6,"\u7b49\u7ebf":6,"\u7b49\u7ebf Light":6,"\u96b6\u4e66":6,"\u9ed1\u4f53":6,"\u6e38\u30b4\u30b7\u30c3\u30af":7,"\uff2d\uff33 \uff30\u660e\u671d":6,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':6,
"\u30e1\u30a4\u30ea\u30aa":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":6,"HG\u660e\u671dB":6,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":6},10:{"Gill Sans MT":7,Abadi:8,"Abadi Extra Light":7,"Agency FB":5,Aharoni:5,Aldhabi:4,Algerian:8,"Ami R":5,"Angsana New":4,AngsanaUPC:4,Aparajita:5,"Arabic Typesetting":4,Arial:7,"Arial Black":9,"Arial Narrow":6,"Arial Nova":7,"Arial Nova Cond":7,"Arial Nova Cond Light":6,"Arial Nova Light":7,"Arial Rounded MT Bold":8,"Baskerville Old Face":6,Batang:7,BatangChe:7,"Bauhaus 93":7,"Bell MT":7,Bembo:6,"Berlin Sans FB":8,"Berlin Sans FB Demi":8,"Bernard MT Condensed":6,"Blackadder ITC":5,"Bodoni MT":6,"Bodoni MT Black":9,"Bodoni MT Condensed":4,"Bodoni MT Poster Compressed":5,"Book Antiqua":7,"Bookman Old Style":8,"Bookshelf Symbol 7":10,"Bradley Hand ITC":8,"Britannic Bold":8,Broadway:8,"Browallia New":5,BrowalliaUPC:5,"Brush Script MT":7,Calibri:7,"Calibri Light":7,"Californian FB":7,"Calisto MT":7,Cambria:7,"Cambria Math":7,Candara:7,Castellar:9,Centaur:6,Century:7,"Century Gothic":7,"Century Schoolbook":7,Chiller:6,"Colonna MT":7,"Comic Sans MS":8,Consolas:7,Constantia:7,"Cooper Black":8,"Copperplate Gothic Bold":9,"Copperplate Gothic Light":9,Corbel:7,"Cordia New":5,CordiaUPC:5,"Courier New":8,"Curlz MT":7,Dante:6,DaunPenh:4,David:6,DilleniaUPC:4,DokChampa:7,Dotum:6,DotumChe:7,Dubai:7,"Dubai Light":7,"Dubai Medium":7,Ebrima:7,"Edwardian Script ITC":6,Elephant:10,"Engravers MT":8,"Eras Bold ITC":8,"Eras Demi ITC":8,"Eras Light ITC":7,"Eras Medium ITC":7,EucrosiaUPC:5,Euphemia:8,"Expo M":11,FangSong:7,"Felix Titling":8,"Footlight MT Light":7,Forte:7,"Franklin Gothic Book":8,"Franklin Gothic Demi":8,"Franklin Gothic Demi Cond":7,"Franklin Gothic Heavy":8,"Franklin Gothic Medium":8,"Franklin Gothic Medium Cond":7,FrankRuehl:5,FreesiaUPC:6,"Freestyle Script":5,"French Script MT":5,Gabriola:5,Gadugi:7,Garamond:6,Gautami:8,Georgia:9,"Georgia Pro":7,"Georgia Pro Black":9,"Georgia Pro Cond":7,"Georgia Pro Cond Black":8,"Georgia Pro Cond Light":7,"Georgia Pro Cond Semibold":7,"Georgia Pro Light":7,"Georgia Pro Semibold":8,Gigi:7,"Gill Sans MT Condensed":5,"Gill Sans MT Ext Condensed Bold":4,"Gill Sans Nova":7,"Gill Sans Nova Cond":4,"Gill Sans Nova Cond Lt":4,"Gill Sans Nova Cond Ultra Bold":8,"Gill Sans Nova Cond XBd":7,"Gill Sans Nova Light":7,"Gill Sans Nova Ultra Bold":11,"Gill Sans Ultra Bold":11,"Gill Sans Ultra Bold Condensed":8,Gisha:7,"Gloucester MT Extra Condensed":5,"Goudy Old Style":7,"Goudy Stout":11,Grotesque:6,"Grotesque Light":6,Gulim:7,GulimChe:7,Gungsuh:6,GungsuhChe:7,"Hadassah Friedlaender":7,Haettenschweiler:6,"Harlow Solid Italic":6,Harrington:7,"Headline R":9,HGGothicE:7,HGGothicM:7,HGGyoshotai:7,HGKyokashotai:7,HGMaruGothicMPRO:10,HGMinchoB:8,HGMinchoE:8,HGPGothicE:8,HGPGothicM:9,HGPGyoshotai:7,HGPKyokashotai:7,HGPMinchoB:7,HGPMinchoE:8,HGPSoeiKakugothicUB:9,HGPSoeiKakupoptai:9,HGPSoeiPresenceEB:8,HGSeikaishotaiPRO:8,HGSGothicE:7,HGSGothicM:8,HGSGyoshotai:6,HGSKyokashotai:6,HGSMinchoB:7,HGSMinchoE:8,HGSoeiKakugothicUB:8,HGSoeiKakupoptai:8,HGSoeiPresenceEB:8,HGSSoeiKakugothicUB:8,HGSSoeiKakupoptai:8,HGSSoeiPresenceEB:7,"High Tower Text":6,"HYGothic-Extra":8,"HYGothic-Medium":8,"HYGraphic-Medium":8,"HYGungSo-Bold":8,"HYHeadLine-Medium":8,"HYMyeongJo-Extra":9,"HYPMokGak-Bold":9,"HYPost-Light":9,"HYPost-Medium":9,"HYShortSamul-Medium":5,"HYSinMyeongJo-Medium":8,Impact:7,"Imprint MT Shadow":7,"Informal Roman":7,"Ink Free":7,IrisUPC:7,"Iskoola Pota":7,JasmineUPC:7,"Javanese Text":8,Jokerman:9,"Juice ITC":5,KaiTi:7,Kalinga:7,Kartika:7,"Khmer UI":7,KodchiangUPC:4,Kokila:7,"Kristen ITC":8,"Kunstler Script":5,"Lao UI":7,Latha:7,Leelawadee:7,"Leelawadee UI":7,"Leelawadee UI Semilight":7,"Levenim MT":7,LilyUPC:7,"Lucida Bright":8,"Lucida Calligraphy":10,"Lucida Console":9,"Lucida Fax":9,"Lucida Handwriting":10,"Lucida Sans":9,"Lucida Sans Typewriter":8,"Lucida Sans Unicode":9,"Magic R":8,Magneto:10,"Maiandra GD":9,"Malgun Gothic":8,"Malgun Gothic Semilight":8,Mangal:8,Marlett:14,"Matura MT Script Capitals":10,Meiryo:9,"Meiryo UI":9,"Microsoft GothicNeo":8,"Microsoft Himalaya":5,"Microsoft JhengHei":8,"Microsoft JhengHei Light":8,"Microsoft JhengHei UI":8,"Microsoft JhengHei UI Light":8,"Microsoft New Tai Lue":7,"Microsoft PhagsPa":7,"Microsoft Sans Serif":8,"Microsoft Tai Le":7,"Microsoft Uighur":5,"Microsoft YaHei Light":8,"Microsoft YaHei UI":8,"Microsoft YaHei UI Light":8,"Microsoft Yi Baiti":8,MingLiU:8,MingLiU_HKSCS:8,"MingLiU_HKSCS-ExtB":8,"MingLiU-ExtB":8,Miriam:8,"Miriam Fixed":8,Mistral:7,"Modern No. 20":7,"MoeumT R":8,"Mongolian Baiti":8,"Monotype Corsiva":7,MoolBoran:8,"MS Gothic":8,"MS Mincho":8,"MS Outlook":8,"MS PGothic":8,"MS PMincho":8,"MS Reference Sans Serif":9,"MS Reference Specialty":17,"MS UI Gothic":8,"MT Extra":14,"MV Boli":10,"Myanmar Text":7,Narkisim:8,"Neue Haas Grotesk Text Pro":8,"New Gulim":8,"News Gothic MT":8,"Niagara Engraved":5,"Niagara Solid":5,"Nirmala UI":7,"Nirmala UI Semilight":8,Nyala:8,"OCR A Extended":9,OCRB:9,"Old English Text MT":8,Onyx:6,"Palace Script MT":5,"Palatino Linotype":7,Papyrus:9,Parchment:4,Perpetua:6,"Perpetua Titling MT":9,"Plantagenet Cherokee":8,Playbill:6,PMingLiU:7,"PMingLiU-ExtB":7,"Poor Richard":8,Pristina:8,"Pyunji R":7,Raavi:8,"Rage Italic":8,Ravie:13,Rockwell:7,"Rockwell Condensed":6,"Rockwell Extra Bold":9,"Rockwell Light":8,"Rockwell Nova":8,"Rockwell Nova Cond":8,"Rockwell Nova Cond Light":8,"Rockwell Nova Extra Bold":8,"Rockwell Nova Light":8,Rod:8,"Sakkal Majalla":8,"Sanskrit Text":8,"Script MT Bold":7,"Segoe MDL2 Assets":5,"Segoe Print":10,"Segoe Script":10,"Segoe UI":7,"Segoe UI Black":8,"Segoe UI Emoji":7,"Segoe UI Historic":7,"Segoe UI Light":7,"Segoe UI Semibold":7,"Segoe UI Semilight":7,"Segoe UI Symbol":7,Selawik:7,"Selawik Light":7,"Selawik Semibold":7,"Shonar Bangla":7,"Showcard Gothic":8,Shruti:7,"Simplified Arabic":7,"Simplified Arabic Fixed":7,"SimSun-ExtB":7,"Sitka Banner":7,"Sitka Display":7,"Sitka Heading":7,"Sitka Small":9,"Sitka Subheading":8,"Sitka Text":8,"Snap ITC":11,"Source Sans Pro":7,"Source Sans Pro Black":7,"Source Sans Pro ExtraLight":7,"Source Sans Pro Light":7,"Source Sans Pro SemiBold":7,Stencil:7,Sylfaen:7,Symbol:7,Tahoma:7,"Tempus Sans ITC":9,"TH SarabunPSK":7,"Times New Roman":7,"Traditional Arabic":7,"Trebuchet MS":7,Tunga:7,"Tw Cen MT":7,"Tw Cen MT Condensed":5,"Tw Cen MT Condensed Extra Bold":6,"UD Digi Kyokasho N-B":7,"UD Digi Kyokasho NK-B":7,"UD Digi Kyokasho NK-R":7,"UD Digi Kyokasho NP-B":7,"UD Digi Kyokasho NP-R":7,"UD Digi Kyokasho N-R":7,Univers:7,"Univers Condensed":7,"Univers Condensed Light":7,"Univers Light":7,"Urdu Typesetting":7,Utsaah:7,Vani:7,Verdana:8,"Verdana Pro":8,"Verdana Pro Black":7,"Verdana Pro Cond":7,"Verdana Pro Cond Black":7,"Verdana Pro Cond Light":7,"Verdana Pro Cond SemiBold":7,"Verdana Pro Light":7,"Verdana Pro SemiBold":7,Vijaya:7,"Viner Hand ITC":9,Vivaldi:6,"Vladimir Script":6,Vrinda:7,Webdings:13,"Wide Latin":16,Wingdings:17,"Wingdings 2":15,"Wingdings 3":12,"Yet R":7,"Yu Gothic":7,"Yu Gothic Light":7,"Yu Gothic Medium":7,"Yu Gothic UI":7,"Yu Gothic UI Light":7,"Yu Gothic UI Semibold":7,"Yu Gothic UI Semilight":7,"Yu Mincho":7,"Yu Mincho Demibold":7,"Yu Mincho Light":7,"\u4eff\u5b8b":7,"\u534e\u6587\u4e2d\u5b8b":8,"\u534e\u6587\u4eff\u5b8b":6,"\u534e\u6587\u5b8b\u4f53":6,"\u534e\u6587\u5f69\u4e91":7,"\u534e\u6587\u65b0\u9b4f":8,"\u534e\u6587\u6977\u4f53":6,"\u534e\u6587\u7425\u73c0":7,"\u534e\u6587\u7ec6\u9ed1":7,"\u534e\u6587\u884c\u6977":7,"\u534e\u6587\u96b6\u4e66":6,"\u5b8b\u4f53":7,"\u5e7c\u5706":7,"\u5fae\u8f6f\u96c5\u9ed1":8,"\u5fae\u8f6f\u96c5\u9ed1 Light":7,"\u65b0\u5b8b\u4f53":7,"\u65b9\u6b63\u59da\u4f53":7,"\u65b9\u6b63\u8212\u4f53":7,"\u6977\u4f53":7,"\u7b49\u7ebf":7,"\u7b49\u7ebf Light":7,"\u96b6\u4e66":7,"\u9ed1\u4f53":7,"\u6e38\u30b4\u30b7\u30c3\u30af":7,"\uff2d\uff33 \uff30\u660e\u671d":7,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':7,"\u30e1\u30a4\u30ea\u30aa":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":7,"HG\u660e\u671dB":7,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":7},11:{"Gill Sans MT":8,Abadi:9,"Abadi Extra Light":8,"Agency FB":6,Aharoni:6,Aldhabi:5,Algerian:9,"Ami R":6,"Angsana New":5,AngsanaUPC:5,Aparajita:6,"Arabic Typesetting":5,Arial:8,"Arial Black":10,"Arial Narrow":7,"Arial Nova":8,"Arial Nova Cond":8,"Arial Nova Cond Light":7,"Arial Nova Light":8,"Arial Rounded MT Bold":9,"Baskerville Old Face":7,Batang:8,BatangChe:8,"Bauhaus 93":9,"Bell MT":8,Bembo:7,"Berlin Sans FB":9,"Berlin Sans FB Demi":9,"Bernard MT Condensed":7,"Blackadder ITC":6,"Bodoni MT":7,"Bodoni MT Black":10,"Bodoni MT Condensed":5,"Bodoni MT Poster Compressed":5,"Book Antiqua":8,"Bookman Old Style":9,"Bookshelf Symbol 7":11,"Bradley Hand ITC":10,"Britannic Bold":9,Broadway:10,"Browallia New":5,BrowalliaUPC:5,"Brush Script MT":8,Calibri:7,"Calibri Light":8,"Californian FB":9,"Calisto MT":8,Cambria:8,"Cambria Math":8,Candara:8,Castellar:11,Centaur:7,Century:8,"Century Gothic":8,"Century Schoolbook":8,Chiller:7,"Colonna MT":8,"Comic Sans MS":9,Consolas:8,Constantia:8,"Cooper Black":9,"Copperplate Gothic Bold":11,"Copperplate Gothic Light":11,Corbel:8,"Cordia New":5,CordiaUPC:5,"Courier New":9,"Curlz MT":8,Dante:7,DaunPenh:5,David:7,DilleniaUPC:5,DokChampa:8,Dotum:9,DotumChe:8,Dubai:8,"Dubai Light":8,"Dubai Medium":8,Ebrima:8,"Edwardian Script ITC":7,Elephant:11,"Engravers MT":10,"Eras Bold ITC":10,"Eras Demi ITC":9,"Eras Light ITC":8,"Eras Medium ITC":9,EucrosiaUPC:6,Euphemia:9,"Expo M":13,FangSong:8,"Felix Titling":9,"Footlight MT Light":8,Forte:8,"Franklin Gothic Book":9,"Franklin Gothic Demi":9,"Franklin Gothic Demi Cond":8,"Franklin Gothic Heavy":9,"Franklin Gothic Medium":9,"Franklin Gothic Medium Cond":8,FrankRuehl:6,FreesiaUPC:7,"Freestyle Script":6,"French Script MT":5,Gabriola:6,Gadugi:8,Garamond:7,Gautami:9,Georgia:9,"Georgia Pro":8,"Georgia Pro Black":11,"Georgia Pro Cond":8,"Georgia Pro Cond Black":10,"Georgia Pro Cond Light":8,"Georgia Pro Cond Semibold":8,"Georgia Pro Light":8,"Georgia Pro Semibold":9,Gigi:7,"Gill Sans MT Condensed":5,"Gill Sans MT Ext Condensed Bold":5,"Gill Sans Nova":8,"Gill Sans Nova Cond":5,"Gill Sans Nova Cond Lt":5,"Gill Sans Nova Cond Ultra Bold":9,"Gill Sans Nova Cond XBd":8,"Gill Sans Nova Light":8,"Gill Sans Nova Ultra Bold":13,"Gill Sans Ultra Bold":13,"Gill Sans Ultra Bold Condensed":9,Gisha:8,"Gloucester MT Extra Condensed":6,"Goudy Old Style":8,"Goudy Stout":12,Grotesque:7,"Grotesque Light":7,Gulim:8,GulimChe:8,Gungsuh:7,GungsuhChe:8,"Hadassah Friedlaender":9,Haettenschweiler:7,"Harlow Solid Italic":7,Harrington:8,"Headline R":11,HGGothicE:8,HGGothicM:8,HGGyoshotai:8,HGKyokashotai:8,HGMaruGothicMPRO:11,HGMinchoB:9,HGMinchoE:9,HGPGothicE:9,HGPGothicM:10,HGPGyoshotai:8,HGPKyokashotai:8,HGPMinchoB:8,HGPMinchoE:9,HGPSoeiKakugothicUB:10,HGPSoeiKakupoptai:11,HGPSoeiPresenceEB:9,HGSeikaishotaiPRO:9,HGSGothicE:8,HGSGothicM:9,HGSGyoshotai:7,HGSKyokashotai:7,HGSMinchoB:8,HGSMinchoE:9,HGSoeiKakugothicUB:9,HGSoeiKakupoptai:9,HGSoeiPresenceEB:9,HGSSoeiKakugothicUB:9,HGSSoeiKakupoptai:10,HGSSoeiPresenceEB:8,"High Tower Text":7,"HYGothic-Extra":9,"HYGothic-Medium":9,"HYGraphic-Medium":9,"HYGungSo-Bold":9,"HYHeadLine-Medium":9,"HYMyeongJo-Extra":10,"HYPMokGak-Bold":11,"HYPost-Light":10,"HYPost-Medium":11,"HYShortSamul-Medium":6,"HYSinMyeongJo-Medium":9,Impact:8,"Imprint MT Shadow":8,"Informal Roman":8,"Ink Free":8,IrisUPC:8,"Iskoola Pota":8,JasmineUPC:8,"Javanese Text":9,Jokerman:11,"Juice ITC":6,KaiTi:8,Kalinga:8,Kartika:8,"Khmer UI":8,KodchiangUPC:5,Kokila:8,"Kristen ITC":9,"Kunstler Script":5,"Lao UI":8,Latha:8,Leelawadee:8,"Leelawadee UI":8,"Leelawadee UI Semilight":8,"Levenim MT":9,LilyUPC:8,"Lucida Bright":9,"Lucida Calligraphy":11,"Lucida Console":10,"Lucida Fax":10,"Lucida Handwriting":11,"Lucida Sans":10,"Lucida Sans Typewriter":9,"Lucida Sans Unicode":10,"Magic R":9,Magneto:12,"Maiandra GD":10,"Malgun Gothic":9,"Malgun Gothic Semilight":9,Mangal:9,Marlett:16,"Matura MT Script Capitals":11,Meiryo:9,"Meiryo UI":10,"Microsoft GothicNeo":9,"Microsoft Himalaya":6,"Microsoft JhengHei":9,"Microsoft JhengHei Light":10,"Microsoft JhengHei UI":9,"Microsoft JhengHei UI Light":10,"Microsoft New Tai Lue":9,"Microsoft PhagsPa":9,"Microsoft Sans Serif":9,"Microsoft Tai Le":9,"Microsoft Uighur":6,"Microsoft YaHei Light":10,"Microsoft YaHei UI":9,"Microsoft YaHei UI Light":10,"Microsoft Yi Baiti":9,MingLiU:9,MingLiU_HKSCS:9,"MingLiU_HKSCS-ExtB":9,"MingLiU-ExtB":9,Miriam:9,"Miriam Fixed":10,Mistral:8,"Modern No. 20":8,"MoeumT R":9,"Mongolian Baiti":9,"Monotype Corsiva":8,MoolBoran:9,"MS Gothic":9,"MS Mincho":9,"MS Outlook":9,"MS PGothic":9,"MS PMincho":9,"MS Reference Sans Serif":11,"MS Reference Specialty":19,"MS UI Gothic":9,"MT Extra":16,"MV Boli":12,"Myanmar Text":9,Narkisim:7,"Neue Haas Grotesk Text Pro":9,"New Gulim":10,"News Gothic MT":9,"Niagara Engraved":5,"Niagara Solid":6,"Nirmala UI":9,"Nirmala UI Semilight":9,Nyala:9,"OCR A Extended":10,OCRB:10,"Old English Text MT":9,Onyx:6,"Palace Script MT":6,"Palatino Linotype":8,Papyrus:10,Parchment:4,Perpetua:7,"Perpetua Titling MT":10,"Plantagenet Cherokee":9,Playbill:6,PMingLiU:8,"PMingLiU-ExtB":8,"Poor Richard":9,Pristina:9,"Pyunji R":8,Raavi:9,"Rage Italic":9,Ravie:15,Rockwell:8,"Rockwell Condensed":6,"Rockwell Extra Bold":10,"Rockwell Light":9,"Rockwell Nova":9,"Rockwell Nova Cond":9,"Rockwell Nova Cond Light":9,"Rockwell Nova Extra Bold":9,"Rockwell Nova Light":9,Rod:9,"Sakkal Majalla":9,"Sanskrit Text":9,"Script MT Bold":8,"Segoe MDL2 Assets":6,"Segoe Print":11,"Segoe Script":11,"Segoe UI":8,"Segoe UI Black":9,"Segoe UI Emoji":8,"Segoe UI Historic":8,"Segoe UI Light":8,"Segoe UI Semibold":9,"Segoe UI Semilight":8,"Segoe UI Symbol":8,Selawik:8,"Selawik Light":8,"Selawik Semibold":8,"Shonar Bangla":8,"Showcard Gothic":9,Shruti:8,"Simplified Arabic":8,"Simplified Arabic Fixed":8,"SimSun-ExtB":8,"Sitka Banner":8,"Sitka Display":8,"Sitka Heading":8,"Sitka Small":10,"Sitka Subheading":9,"Sitka Text":9,"Snap ITC":13,"Source Sans Pro":8,"Source Sans Pro Black":8,"Source Sans Pro ExtraLight":8,"Source Sans Pro Light":8,"Source Sans Pro SemiBold":8,Stencil:9,Sylfaen:8,Symbol:8,Tahoma:8,"Tempus Sans ITC":10,"TH SarabunPSK":8,"Times New Roman":8,"Traditional Arabic":8,"Trebuchet MS":8,Tunga:8,"Tw Cen MT":8,"Tw Cen MT Condensed":5,"Tw Cen MT Condensed Extra Bold":7,"UD Digi Kyokasho N-B":8,"UD Digi Kyokasho NK-B":8,"UD Digi Kyokasho NK-R":8,"UD Digi Kyokasho NP-B":8,"UD Digi Kyokasho NP-R":8,"UD Digi Kyokasho N-R":8,Univers:8,"Univers Condensed":8,"Univers Condensed Light":8,"Univers Light":8,"Urdu Typesetting":8,Utsaah:8,Vani:8,Verdana:10,"Verdana Pro":10,"Verdana Pro Black":8,"Verdana Pro Cond":8,"Verdana Pro Cond Black":8,"Verdana Pro Cond Light":8,"Verdana Pro Cond SemiBold":8,"Verdana Pro Light":8,"Verdana Pro SemiBold":8,Vijaya:8,"Viner Hand ITC":10,Vivaldi:6,"Vladimir Script":7,Vrinda:9,Webdings:15,"Wide Latin":19,Wingdings:20,"Wingdings 2":17,"Wingdings 3":13,"Yet R":8,"Yu Gothic":8,"Yu Gothic Light":8,"Yu Gothic Medium":8,"Yu Gothic UI":8,"Yu Gothic UI Light":8,"Yu Gothic UI Semibold":9,"Yu Gothic UI Semilight":8,"Yu Mincho":8,"Yu Mincho Demibold":8,"Yu Mincho Light":8,"\u4eff\u5b8b":8,"\u534e\u6587\u4e2d\u5b8b":9,"\u534e\u6587\u4eff\u5b8b":7,"\u534e\u6587\u5b8b\u4f53":7,"\u534e\u6587\u5f69\u4e91":9,"\u534e\u6587\u65b0\u9b4f":9,"\u534e\u6587\u6977\u4f53":7,"\u534e\u6587\u7425\u73c0":9,"\u534e\u6587\u7ec6\u9ed1":8,"\u534e\u6587\u884c\u6977":8,"\u534e\u6587\u96b6\u4e66":7,"\u5b8b\u4f53":8,"\u5e7c\u5706":8,"\u5fae\u8f6f\u96c5\u9ed1":9,"\u5fae\u8f6f\u96c5\u9ed1 Light":9,"\u65b0\u5b8b\u4f53":8,"\u65b9\u6b63\u59da\u4f53":8,"\u65b9\u6b63\u8212\u4f53":8,"\u6977\u4f53":8,"\u7b49\u7ebf":8,"\u7b49\u7ebf Light":8,"\u96b6\u4e66":8,"\u9ed1\u4f53":8,"\u6e38\u30b4\u30b7\u30c3\u30af":8,"\uff2d\uff33 \uff30\u660e\u671d":8,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':8,"\u30e1\u30a4\u30ea\u30aa":9,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":8,"HG\u660e\u671dB":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":8},12:{"Gill Sans MT":8,Abadi:10,"Abadi Extra Light":9,"Agency FB":6,Aharoni:7,Aldhabi:5,Algerian:10,"Ami R":7,"Angsana New":5,AngsanaUPC:5,Aparajita:6,"Arabic Typesetting":5,Arial:9,"Arial Black":11,"Arial Narrow":7,"Arial Nova":9,"Arial Nova Cond":8,"Arial Nova Cond Light":7,"Arial Nova Light":9,"Arial Rounded MT Bold":10,"Baskerville Old Face":8,Batang:9,BatangChe:8,"Bauhaus 93":9,"Bell MT":8,Bembo:8,"Berlin Sans FB":10,"Berlin Sans FB Demi":10,"Bernard MT Condensed":8,"Blackadder ITC":6,"Bodoni MT":8,"Bodoni MT Black":11,"Bodoni MT Condensed":5,"Bodoni MT Poster Compressed":6,"Book Antiqua":8,"Bookman Old Style":10,"Bookshelf Symbol 7":12,"Bradley Hand ITC":10,"Britannic Bold":10,Broadway:10,"Browallia New":6,BrowalliaUPC:6,"Brush Script MT":8,Calibri:8,"Calibri Light":8,"Californian FB":9,"Calisto MT":8,Cambria:9,"Cambria Math":9,Candara:9,Castellar:12,Centaur:8,Century:9,"Century Gothic":9,"Century Schoolbook":9,Chiller:8,"Colonna MT":8,"Comic Sans MS":10,Consolas:9,Constantia:9,"Cooper Black":10,"Copperplate Gothic Bold":11,"Copperplate Gothic Light":12,Corbel:8,"Cordia New":6,CordiaUPC:6,"Courier New":10,"Curlz MT":9,Dante:7,DaunPenh:5,David:7,DilleniaUPC:5,DokChampa:9,Dotum:8,DotumChe:8,Dubai:9,"Dubai Light":9,"Dubai Medium":9,Ebrima:9,"Edwardian Script ITC":8,Elephant:12,"Engravers MT":10,"Eras Bold ITC":10,"Eras Demi ITC":10,"Eras Light ITC":9,"Eras Medium ITC":9,EucrosiaUPC:6,Euphemia:9,"Expo M":14,FangSong:8,"Felix Titling":9,"Footlight MT Light":9,Forte:8,"Franklin Gothic Book":9,"Franklin Gothic Demi":9,"Franklin Gothic Demi Cond":8,"Franklin Gothic Heavy":9,"Franklin Gothic Medium":9,"Franklin Gothic Medium Cond":8,FrankRuehl:7,FreesiaUPC:7,"Freestyle Script":6,"French Script MT":6,Gabriola:6,Gadugi:9,Garamond:8,Gautami:10,Georgia:10,"Georgia Pro":9,"Georgia Pro Black":11,"Georgia Pro Cond":8,"Georgia Pro Cond Black":10,"Georgia Pro Cond Light":8,"Georgia Pro Cond Semibold":9,"Georgia Pro Light":9,"Georgia Pro Semibold":10,Gigi:7,"Gill Sans MT Condensed":6,"Gill Sans MT Ext Condensed Bold":6,"Gill Sans Nova":8,"Gill Sans Nova Cond":5,"Gill Sans Nova Cond Lt":5,"Gill Sans Nova Cond Ultra Bold":9,"Gill Sans Nova Cond XBd":8,"Gill Sans Nova Light":8,"Gill Sans Nova Ultra Bold":14,"Gill Sans Ultra Bold":14,"Gill Sans Ultra Bold Condensed":9,Gisha:9,"Gloucester MT Extra Condensed":6,"Goudy Old Style":8,"Goudy Stout":13,Grotesque:8,"Grotesque Light":8,Gulim:9,GulimChe:8,Gungsuh:9,GungsuhChe:8,"Hadassah Friedlaender":9,Haettenschweiler:7,"Harlow Solid Italic":7,Harrington:9,"Headline R":11,HGGothicE:8,HGGothicM:8,HGGyoshotai:8,HGKyokashotai:8,HGMaruGothicMPRO:12,HGMinchoB:9,HGMinchoE:9,HGPGothicE:10,HGPGothicM:10,HGPGyoshotai:9,HGPKyokashotai:8,HGPMinchoB:9,HGPMinchoE:9,HGPSoeiKakugothicUB:11,HGPSoeiKakupoptai:11,HGPSoeiPresenceEB:10,HGSeikaishotaiPRO:10,HGSGothicE:9,HGSGothicM:9,HGSGyoshotai:8,HGSKyokashotai:7,HGSMinchoB:9,HGSMinchoE:9,HGSoeiKakugothicUB:9,HGSoeiKakupoptai:9,HGSoeiPresenceEB:9,HGSSoeiKakugothicUB:10,HGSSoeiKakupoptai:10,HGSSoeiPresenceEB:9,"High Tower Text":8,"HYGothic-Extra":10,"HYGothic-Medium":9,"HYGraphic-Medium":9,"HYGungSo-Bold":9,"HYHeadLine-Medium":9,"HYMyeongJo-Extra":11,"HYPMokGak-Bold":11,"HYPost-Light":11,"HYPost-Medium":11,"HYShortSamul-Medium":6,"HYSinMyeongJo-Medium":10,Impact:9,"Imprint MT Shadow":8,"Informal Roman":9,"Ink Free":8,IrisUPC:8,"Iskoola Pota":8,JasmineUPC:8,"Javanese Text":9,Jokerman:11,"Juice ITC":6,KaiTi:8,Kalinga:9,Kartika:8,"Khmer UI":8,KodchiangUPC:5,Kokila:8,"Kristen ITC":10,"Kunstler Script":6,"Lao UI":8,Latha:8,Leelawadee:9,"Leelawadee UI":9,"Leelawadee UI Semilight":9,"Levenim MT":9,LilyUPC:7,"Lucida Bright":10,"Lucida Calligraphy":12,"Lucida Console":11,"Lucida Fax":11,"Lucida Handwriting":12,"Lucida Sans":11,"Lucida Sans Typewriter":10,"Lucida Sans Unicode":11,"Magic R":10,Magneto:12,"Maiandra GD":10,"Malgun Gothic":9,"Malgun Gothic Semilight":10,Mangal:9,Marlett:17,"Matura MT Script Capitals":12,Meiryo:11,"Meiryo UI":11,"Microsoft GothicNeo":9,"Microsoft Himalaya":6,"Microsoft JhengHei":10,"Microsoft JhengHei Light":10,"Microsoft JhengHei UI":10,"Microsoft JhengHei UI Light":10,"Microsoft New Tai Lue":9,"Microsoft PhagsPa":9,"Microsoft Sans Serif":10,"Microsoft Tai Le":9,"Microsoft Uighur":6,"Microsoft YaHei Light":10,"Microsoft YaHei UI":10,"Microsoft YaHei UI Light":10,"Microsoft Yi Baiti":9,MingLiU:9,MingLiU_HKSCS:9,"MingLiU_HKSCS-ExtB":9,"MingLiU-ExtB":9,Miriam:9,"Miriam Fixed":11,Mistral:8,"Modern No. 20":8,"MoeumT R":10,"Mongolian Baiti":9,"Monotype Corsiva":8,MoolBoran:7,"MS Gothic":9,"MS Mincho":9,"MS Outlook":9,"MS PGothic":9,"MS PMincho":9,"MS Reference Sans Serif":11,"MS Reference Specialty":20,"MS UI Gothic":9,"MT Extra":17,"MV Boli":12,"Myanmar Text":9,Narkisim:8,"Neue Haas Grotesk Text Pro":9,"New Gulim":10,"News Gothic MT":9,"Niagara Engraved":6,"Niagara Solid":6,"Nirmala UI":9,"Nirmala UI Semilight":10,Nyala:9,"OCR A Extended":11,OCRB:11,"Old English Text MT":9,Onyx:7,"Palace Script MT":6,"Palatino Linotype":8,Papyrus:10,Parchment:4,Perpetua:7,"Perpetua Titling MT":11,"Plantagenet Cherokee":9,Playbill:7,PMingLiU:9,"PMingLiU-ExtB":9,"Poor Richard":10,Pristina:9,"Pyunji R":9,Raavi:8,"Rage Italic":9,Ravie:16,Rockwell:9,"Rockwell Condensed":7,"Rockwell Extra Bold":11,"Rockwell Light":10,"Rockwell Nova":9,"Rockwell Nova Cond":9,"Rockwell Nova Cond Light":9,"Rockwell Nova Extra Bold":9,"Rockwell Nova Light":9,Rod:9,"Sakkal Majalla":9,"Sanskrit Text":9,"Script MT Bold":8,"Segoe MDL2 Assets":7,"Segoe Print":12,"Segoe Script":12,"Segoe UI":9,"Segoe UI Black":10,"Segoe UI Emoji":9,"Segoe UI Historic":9,"Segoe UI Light":8,"Segoe UI Semibold":9,"Segoe UI Semilight":9,"Segoe UI Symbol":9,Selawik:8,"Selawik Light":8,"Selawik Semibold":8,"Shonar Bangla":8,"Showcard Gothic":9,Shruti:8,"Simplified Arabic":8,"Simplified Arabic Fixed":8,"SimSun-ExtB":8,"Sitka Banner":8,"Sitka Display":8,"Sitka Heading":9,"Sitka Small":11,"Sitka Subheading":9,"Sitka Text":10,"Snap ITC":14,"Source Sans Pro":8,"Source Sans Pro Black":8,"Source Sans Pro ExtraLight":8,"Source Sans Pro Light":8,"Source Sans Pro SemiBold":8,Stencil:9,Sylfaen:8,Symbol:8,Tahoma:9,"Tempus Sans ITC":11,"TH SarabunPSK":8,"Times New Roman":8,"Traditional Arabic":8,"Trebuchet MS":8,Tunga:8,"Tw Cen MT":9,"Tw Cen MT Condensed":6,"Tw Cen MT Condensed Extra Bold":8,"UD Digi Kyokasho N-B":8,"UD Digi Kyokasho NK-B":8,"UD Digi Kyokasho NK-R":8,"UD Digi Kyokasho NP-B":8,"UD Digi Kyokasho NP-R":8,"UD Digi Kyokasho N-R":8,Univers:8,"Univers Condensed":8,"Univers Condensed Light":8,"Univers Light":8,"Urdu Typesetting":8,Utsaah:6,Vani:8,Verdana:10,"Verdana Pro":10,"Verdana Pro Black":8,"Verdana Pro Cond":8,"Verdana Pro Cond Black":8,"Verdana Pro Cond Light":8,"Verdana Pro Cond SemiBold":8,"Verdana Pro Light":8,"Verdana Pro SemiBold":8,Vijaya:8,"Viner Hand ITC":11,Vivaldi:7,"Vladimir Script":7,Vrinda:9,Webdings:16,"Wide Latin":20,Wingdings:22,"Wingdings 2":18,"Wingdings 3":14,"Yet R":9,"Yu Gothic":9,"Yu Gothic Light":9,"Yu Gothic Medium":9,"Yu Gothic UI":9,"Yu Gothic UI Light":9,"Yu Gothic UI Semibold":9,"Yu Gothic UI Semilight":9,"Yu Mincho":9,"Yu Mincho Demibold":8,"Yu Mincho Light":8,"\u4eff\u5b8b":8,"\u534e\u6587\u4e2d\u5b8b":10,"\u534e\u6587\u4eff\u5b8b":8,"\u534e\u6587\u5b8b\u4f53":8,"\u534e\u6587\u5f69\u4e91":9,"\u534e\u6587\u65b0\u9b4f":9,"\u534e\u6587\u6977\u4f53":8,"\u534e\u6587\u7425\u73c0":9,"\u534e\u6587\u7ec6\u9ed1":9,"\u534e\u6587\u884c\u6977":8,"\u534e\u6587\u96b6\u4e66":7,"\u5b8b\u4f53":8,"\u5e7c\u5706":8,"\u5fae\u8f6f\u96c5\u9ed1":9,"\u5fae\u8f6f\u96c5\u9ed1 Light":9,"\u65b0\u5b8b\u4f53":8,"\u65b9\u6b63\u59da\u4f53":8,"\u65b9\u6b63\u8212\u4f53":9,"\u6977\u4f53":8,"\u7b49\u7ebf":8,"\u7b49\u7ebf Light":8,"\u96b6\u4e66":8,"\u9ed1\u4f53":8,"\u6e38\u30b4\u30b7\u30c3\u30af":9,"\uff2d\uff33 \uff30\u660e\u671d":8,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':8,"\u30e1\u30a4\u30ea\u30aa":10,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":8,"HG\u660e\u671dB":8,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":8},14:{"Gill Sans MT":10,Abadi:11,"Abadi Extra Light":11,"Agency FB":8,Aharoni:8,Aldhabi:6,Algerian:11,"Ami R":8,"Angsana New":6,AngsanaUPC:6,Aparajita:8,"Arabic Typesetting":6,Arial:11,"Arial Black":13,"Arial Narrow":9,"Arial Nova":11,"Arial Nova Cond":10,"Arial Nova Cond Light":9,"Arial Nova Light":11,"Arial Rounded MT Bold":11,"Baskerville Old Face":9,Batang:10,BatangChe:10,"Bauhaus 93":11,"Bell MT":10,Bembo:9,"Berlin Sans FB":11,"Berlin Sans FB Demi":12,"Bernard MT Condensed":9,"Blackadder ITC":8,"Bodoni MT":9,"Bodoni MT Black":12,"Bodoni MT Condensed":6,"Bodoni MT Poster Compressed":6,"Book Antiqua":10,"Bookman Old Style":12,"Bookshelf Symbol 7":14,"Bradley Hand ITC":12,"Britannic Bold":12,Broadway:12,"Browallia New":7,BrowalliaUPC:7,"Brush Script MT":10,Calibri:10,"Calibri Light":10,"Californian FB":11,"Calisto MT":10,Cambria:11,"Cambria Math":11,Candara:10,Castellar:14,Centaur:9,Century:11,"Century Gothic":11,"Century Schoolbook":11,Chiller:9,"Colonna MT":10,"Comic Sans MS":12,Consolas:10,Constantia:10,"Cooper Black":11,"Copperplate Gothic Bold":14,"Copperplate Gothic Light":14,Corbel:10,"Cordia New":7,CordiaUPC:7,"Courier New":11,"Curlz MT":10,Dante:9,DaunPenh:6,David:8,DilleniaUPC:6,DokChampa:11,Dotum:10,DotumChe:10,Dubai:10,"Dubai Light":10,"Dubai Medium":10,Ebrima:10,"Edwardian Script ITC":9,Elephant:14,"Engravers MT":12,"Eras Bold ITC":12,"Eras Demi ITC":12,"Eras Light ITC":10,"Eras Medium ITC":11,EucrosiaUPC:8,Euphemia:11,"Expo M":16,FangSong:10,"Felix Titling":11,"Footlight MT Light":11,Forte:10,"Franklin Gothic Book":11,"Franklin Gothic Demi":11,"Franklin Gothic Demi Cond":10,"Franklin Gothic Heavy":11,"Franklin Gothic Medium":11,"Franklin Gothic Medium Cond":10,FrankRuehl:8,FreesiaUPC:8,"Freestyle Script":7,"French Script MT":7,Gabriola:8,Gadugi:10,Garamond:9,Gautami:11,Georgia:12,"Georgia Pro":11,"Georgia Pro Black":13,"Georgia Pro Cond":10,"Georgia Pro Cond Black":12,"Georgia Pro Cond Light":10,"Georgia Pro Cond Semibold":11,"Georgia Pro Light":10,"Georgia Pro Semibold":12,Gigi:10,"Gill Sans MT Condensed":7,"Gill Sans MT Ext Condensed Bold":7,"Gill Sans Nova":10,"Gill Sans Nova Cond":6,"Gill Sans Nova Cond Lt":6,"Gill Sans Nova Cond Ultra Bold":11,"Gill Sans Nova Cond XBd":10,"Gill Sans Nova Light":10,"Gill Sans Nova Ultra Bold":16,"Gill Sans Ultra Bold":16,"Gill Sans Ultra Bold Condensed":11,Gisha:10,"Gloucester MT Extra Condensed":7,"Goudy Old Style":10,"Goudy Stout":16,Grotesque:9,"Grotesque Light":9,Gulim:10,GulimChe:10,Gungsuh:10,GungsuhChe:10,"Hadassah Friedlaender":11,Haettenschweiler:8,"Harlow Solid Italic":9,Harrington:11,"Headline R":14,HGGothicE:10,HGGothicM:10,HGGyoshotai:10,HGKyokashotai:10,HGMaruGothicMPRO:14,HGMinchoB:11,HGMinchoE:11,HGPGothicE:11,HGPGothicM:12,HGPGyoshotai:10,HGPKyokashotai:10,HGPMinchoB:10,HGPMinchoE:11,HGPSoeiKakugothicUB:13,HGPSoeiKakupoptai:13,HGPSoeiPresenceEB:12,HGSeikaishotaiPRO:11,HGSGothicE:10,HGSGothicM:11,HGSGyoshotai:9,HGSKyokashotai:9,HGSMinchoB:10,HGSMinchoE:11,HGSoeiKakugothicUB:11,HGSoeiKakupoptai:11,HGSoeiPresenceEB:11,HGSSoeiKakugothicUB:12,HGSSoeiKakupoptai:12,HGSSoeiPresenceEB:11,"High Tower Text":9,"HYGothic-Extra":12,"HYGothic-Medium":11,"HYGraphic-Medium":11,"HYGungSo-Bold":11,"HYHeadLine-Medium":11,"HYMyeongJo-Extra":13,"HYPMokGak-Bold":13,"HYPost-Light":13,"HYPost-Medium":13,"HYShortSamul-Medium":7,"HYSinMyeongJo-Medium":12,Impact:10,"Imprint MT Shadow":10,"Informal Roman":10,"Ink Free":10,IrisUPC:10,"Iskoola Pota":10,JasmineUPC:10,"Javanese Text":11,Jokerman:14,"Juice ITC":7,KaiTi:10,Kalinga:11,Kartika:11,"Khmer UI":10,KodchiangUPC:7,Kokila:10,"Kristen ITC":11,"Kunstler Script":7,"Lao UI":10,Latha:10,Leelawadee:10,"Leelawadee UI":10,"Leelawadee UI Semilight":10,"Levenim MT":11,LilyUPC:8,"Lucida Bright":12,"Lucida Calligraphy":14,"Lucida Console":12,"Lucida Fax":13,"Lucida Handwriting":14,"Lucida Sans":13,"Lucida Sans Typewriter":11,"Lucida Sans Unicode":13,"Magic R":12,Magneto:15,"Maiandra GD":12,"Malgun Gothic":11,"Malgun Gothic Semilight":12,Mangal:11,Marlett:20,"Matura MT Script Capitals":13,Meiryo:13,"Meiryo UI":13,"Microsoft GothicNeo":11,"Microsoft Himalaya":7,"Microsoft JhengHei":11,"Microsoft JhengHei Light":12,"Microsoft JhengHei UI":11,"Microsoft JhengHei UI Light":12,"Microsoft New Tai Lue":11,"Microsoft PhagsPa":11,"Microsoft Sans Serif":11,"Microsoft Tai Le":11,"Microsoft Uighur":7,"Microsoft YaHei Light":12,"Microsoft YaHei UI":12,"Microsoft YaHei UI Light":12,"Microsoft Yi Baiti":11,MingLiU:11,MingLiU_HKSCS:11,"MingLiU_HKSCS-ExtB":11,"MingLiU-ExtB":11,Miriam:10,"Miriam Fixed":12,Mistral:10,"Modern No. 20":10,"MoeumT R":11,"Mongolian Baiti":11,"Monotype Corsiva":9,MoolBoran:8,"MS Gothic":11,"MS Mincho":11,"MS Outlook":11,"MS PGothic":11,"MS PMincho":11,"MS Reference Sans Serif":13,"MS Reference Specialty":24,"MS UI Gothic":11,"MT Extra":20,"MV Boli":14,"Myanmar Text":11,Narkisim:9,"Neue Haas Grotesk Text Pro":11,"New Gulim":12,"News Gothic MT":12,"Niagara Engraved":7,"Niagara Solid":7,"Nirmala UI":11,"Nirmala UI Semilight":11,Nyala:11,"OCR A Extended":12,OCRB:12,"Old English Text MT":11,Onyx:7,"Palace Script MT":7,"Palatino Linotype":10,Papyrus:12,Parchment:5,Perpetua:9,"Perpetua Titling MT":13,"Plantagenet Cherokee":11,Playbill:8,PMingLiU:10,"PMingLiU-ExtB":10,"Poor Richard":11,Pristina:10,"Pyunji R":10,Raavi:10,"Rage Italic":11,Ravie:19,Rockwell:10,"Rockwell Condensed":8,"Rockwell Extra Bold":13,"Rockwell Light":11,"Rockwell Nova":11,"Rockwell Nova Cond":11,"Rockwell Nova Cond Light":11,"Rockwell Nova Extra Bold":11,"Rockwell Nova Light":11,Rod:11,"Sakkal Majalla":11,"Sanskrit Text":12,"Script MT Bold":10,"Segoe MDL2 Assets":8,"Segoe Print":14,"Segoe Script":14,"Segoe UI":10,"Segoe UI Black":12,"Segoe UI Emoji":10,"Segoe UI Historic":10,"Segoe UI Light":10,"Segoe UI Semibold":11,"Segoe UI Semilight":10,"Segoe UI Symbol":10,Selawik:10,"Selawik Light":10,"Selawik Semibold":10,"Shonar Bangla":10,"Showcard Gothic":11,Shruti:11,"Simplified Arabic":10,"Simplified Arabic Fixed":11,"SimSun-ExtB":10,"Sitka Banner":10,"Sitka Display":10,"Sitka Heading":11,"Sitka Small":13,"Sitka Subheading":11,"Sitka Text":12,"Snap ITC":16,"Source Sans Pro":9,"Source Sans Pro Black":10,"Source Sans Pro ExtraLight":9,"Source Sans Pro Light":10,"Source Sans Pro SemiBold":10,Stencil:11,Sylfaen:10,Symbol:10,Tahoma:10,"Tempus Sans ITC":13,"TH SarabunPSK":7,"Times New Roman":10,"Traditional Arabic":10,"Trebuchet MS":10,Tunga:10,"Tw Cen MT":10,"Tw Cen MT Condensed":7,"Tw Cen MT Condensed Extra Bold":9,"UD Digi Kyokasho N-B":10,"UD Digi Kyokasho NK-B":10,"UD Digi Kyokasho NK-R":10,"UD Digi Kyokasho NP-B":10,"UD Digi Kyokasho NP-R":10,"UD Digi Kyokasho N-R":10,Univers:10,"Univers Condensed":10,"Univers Condensed Light":8,"Univers Light":10,"Urdu Typesetting":10,Utsaah:8,Vani:11,Verdana:12,"Verdana Pro":12,"Verdana Pro Black":10,"Verdana Pro Cond":10,"Verdana Pro Cond Black":10,"Verdana Pro Cond Light":10,"Verdana Pro Cond SemiBold":10,"Verdana Pro Light":10,"Verdana Pro SemiBold":10,Vijaya:10,"Viner Hand ITC":13,Vivaldi:8,"Vladimir Script":9,Vrinda:11,Webdings:19,"Wide Latin":24,Wingdings:26,"Wingdings 2":22,"Wingdings 3":17,"Yet R":10,"Yu Gothic":11,"Yu Gothic Light":10,"Yu Gothic Medium":11,"Yu Gothic UI":10,"Yu Gothic UI Light":10,"Yu Gothic UI Semibold":11,"Yu Gothic UI Semilight":10,"Yu Mincho":10,"Yu Mincho Demibold":10,"Yu Mincho Light":10,"\u4eff\u5b8b":10,"\u534e\u6587\u4e2d\u5b8b":12,"\u534e\u6587\u4eff\u5b8b":9,"\u534e\u6587\u5b8b\u4f53":9,"\u534e\u6587\u5f69\u4e91":11,"\u534e\u6587\u65b0\u9b4f":11,"\u534e\u6587\u6977\u4f53":9,"\u534e\u6587\u7425\u73c0":11,"\u534e\u6587\u7ec6\u9ed1":11,"\u534e\u6587\u884c\u6977":10,"\u534e\u6587\u96b6\u4e66":8,"\u5b8b\u4f53":10,"\u5e7c\u5706":10,"\u5fae\u8f6f\u96c5\u9ed1":11,"\u5fae\u8f6f\u96c5\u9ed1 Light":11,"\u65b0\u5b8b\u4f53":10,"\u65b9\u6b63\u59da\u4f53":10,"\u65b9\u6b63\u8212\u4f53":10,"\u6977\u4f53":10,"\u7b49\u7ebf":10,"\u7b49\u7ebf Light":10,"\u96b6\u4e66":10,"\u9ed1\u4f53":10,"\u6e38\u30b4\u30b7\u30c3\u30af":11,"\uff2d\uff33 \uff30\u660e\u671d":10,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':10,"\u30e1\u30a4\u30ea\u30aa":12,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":10,"HG\u660e\u671dB":10,
"HG\uff7a\uff9e\uff7c\uff6f\uff78M":10},16:{"Gill Sans MT":11,Abadi:13,"Abadi Extra Light":12,"Agency FB":9,Aharoni:9,Aldhabi:7,Algerian:13,"Ami R":9,"Angsana New":7,AngsanaUPC:7,Aparajita:8,"Arabic Typesetting":7,Arial:12,"Arial Black":14,"Arial Narrow":10,"Arial Nova":12,"Arial Nova Cond":11,"Arial Nova Cond Light":9,"Arial Nova Light":12,"Arial Rounded MT Bold":12,"Baskerville Old Face":10,Batang:10,BatangChe:11,"Bauhaus 93":12,"Bell MT":11,Bembo:10,"Berlin Sans FB":13,"Berlin Sans FB Demi":13,"Bernard MT Condensed":10,"Blackadder ITC":8,"Bodoni MT":10,"Bodoni MT Black":14,"Bodoni MT Condensed":7,"Bodoni MT Poster Compressed":7,"Book Antiqua":11,"Bookman Old Style":13,"Bookshelf Symbol 7":16,"Bradley Hand ITC":14,"Britannic Bold":13,Broadway:14,"Browallia New":8,BrowalliaUPC:8,"Brush Script MT":11,Calibri:11,"Calibri Light":11,"Californian FB":12,"Calisto MT":11,Cambria:12,"Cambria Math":12,Candara:12,Castellar:15,Centaur:10,Century:12,"Century Gothic":12,"Century Schoolbook":12,Chiller:10,"Colonna MT":11,"Comic Sans MS":13,Consolas:12,Constantia:11,"Cooper Black":13,"Copperplate Gothic Bold":15,"Copperplate Gothic Light":15,Corbel:11,"Cordia New":8,CordiaUPC:8,"Courier New":13,"Curlz MT":11,Dante:9,DaunPenh:7,David:9,DilleniaUPC:7,DokChampa:12,Dotum:11,DotumChe:11,Dubai:11,"Dubai Light":11,"Dubai Medium":11,Ebrima:11,"Edwardian Script ITC":10,Elephant:16,"Engravers MT":14,"Eras Bold ITC":14,"Eras Demi ITC":13,"Eras Light ITC":11,"Eras Medium ITC":12,EucrosiaUPC:9,Euphemia:12,"Expo M":18,FangSong:11,"Felix Titling":12,"Footlight MT Light":12,Forte:11,"Franklin Gothic Book":12,"Franklin Gothic Demi":12,"Franklin Gothic Demi Cond":11,"Franklin Gothic Heavy":12,"Franklin Gothic Medium":12,"Franklin Gothic Medium Cond":11,FrankRuehl:9,FreesiaUPC:9,"Freestyle Script":8,"French Script MT":8,Gabriola:8,Gadugi:11,Garamond:10,Gautami:13,Georgia:13,"Georgia Pro":12,"Georgia Pro Black":15,"Georgia Pro Cond":11,"Georgia Pro Cond Black":13,"Georgia Pro Cond Light":11,"Georgia Pro Cond Semibold":12,"Georgia Pro Light":12,"Georgia Pro Semibold":13,Gigi:12,"Gill Sans MT Condensed":8,"Gill Sans MT Ext Condensed Bold":7,"Gill Sans Nova":11,"Gill Sans Nova Cond":7,"Gill Sans Nova Cond Lt":6,"Gill Sans Nova Cond Ultra Bold":12,"Gill Sans Nova Cond XBd":11,"Gill Sans Nova Light":11,"Gill Sans Nova Ultra Bold":18,"Gill Sans Ultra Bold":18,"Gill Sans Ultra Bold Condensed":12,Gisha:11,"Gloucester MT Extra Condensed":8,"Goudy Old Style":11,"Goudy Stout":17,Grotesque:10,"Grotesque Light":10,Gulim:11,GulimChe:11,Gungsuh:11,GungsuhChe:11,"Hadassah Friedlaender":12,Haettenschweiler:9,"Harlow Solid Italic":10,Harrington:12,"Headline R":15,HGGothicE:11,HGGothicM:11,HGGyoshotai:11,HGKyokashotai:11,HGMaruGothicMPRO:16,HGMinchoB:12,HGMinchoE:12,HGPGothicE:12,HGPGothicM:13,HGPGyoshotai:11,HGPKyokashotai:11,HGPMinchoB:11,HGPMinchoE:12,HGPSoeiKakugothicUB:14,HGPSoeiKakupoptai:15,HGPSoeiPresenceEB:13,HGSeikaishotaiPRO:12,HGSGothicE:11,HGSGothicM:12,HGSGyoshotai:10,HGSKyokashotai:10,HGSMinchoB:11,HGSMinchoE:12,HGSoeiKakugothicUB:12,HGSoeiKakupoptai:12,HGSoeiPresenceEB:12,HGSSoeiKakugothicUB:13,HGSSoeiKakupoptai:14,HGSSoeiPresenceEB:12,"High Tower Text":10,"HYGothic-Extra":13,"HYGothic-Medium":12,"HYGraphic-Medium":12,"HYGungSo-Bold":12,"HYHeadLine-Medium":12,"HYMyeongJo-Extra":14,"HYPMokGak-Bold":15,"HYPost-Light":14,"HYPost-Medium":15,"HYShortSamul-Medium":8,"HYSinMyeongJo-Medium":13,Impact:11,"Imprint MT Shadow":11,"Informal Roman":11,"Ink Free":11,IrisUPC:11,"Iskoola Pota":11,JasmineUPC:10,"Javanese Text":12,Jokerman:15,"Juice ITC":8,KaiTi:11,Kalinga:12,Kartika:12,"Khmer UI":11,KodchiangUPC:7,Kokila:8,"Kristen ITC":13,"Kunstler Script":7,"Lao UI":11,Latha:11,Leelawadee:11,"Leelawadee UI":11,"Leelawadee UI Semilight":12,"Levenim MT":12,LilyUPC:9,"Lucida Bright":13,"Lucida Calligraphy":15,"Lucida Console":14,"Lucida Fax":14,"Lucida Handwriting":15,"Lucida Sans":14,"Lucida Sans Typewriter":13,"Lucida Sans Unicode":14,"Magic R":13,Magneto:16,"Maiandra GD":13,"Malgun Gothic":12,"Malgun Gothic Semilight":13,Mangal:12,Marlett:22,"Matura MT Script Capitals":15,Meiryo:14,"Meiryo UI":14,"Microsoft GothicNeo":12,"Microsoft Himalaya":8,"Microsoft JhengHei":13,"Microsoft JhengHei Light":13,"Microsoft JhengHei UI":13,"Microsoft JhengHei UI Light":13,"Microsoft New Tai Lue":12,"Microsoft PhagsPa":12,"Microsoft Sans Serif":13,"Microsoft Tai Le":12,"Microsoft Uighur":8,"Microsoft YaHei Light":13,"Microsoft YaHei UI":13,"Microsoft YaHei UI Light":13,"Microsoft Yi Baiti":12,MingLiU:12,MingLiU_HKSCS:12,"MingLiU_HKSCS-ExtB":12,"MingLiU-ExtB":12,Miriam:11,"Miriam Fixed":14,Mistral:10,"Modern No. 20":11,"MoeumT R":13,"Mongolian Baiti":12,"Monotype Corsiva":10,MoolBoran:8,"MS Gothic":12,"MS Mincho":12,"MS Outlook":12,"MS PGothic":12,"MS PMincho":12,"MS Reference Sans Serif":14,"MS Reference Specialty":26,"MS UI Gothic":12,"MT Extra":22,"MV Boli":16,"Myanmar Text":12,Narkisim:10,"Neue Haas Grotesk Text Pro":12,"New Gulim":13,"News Gothic MT":14,"Niagara Engraved":8,"Niagara Solid":8,"Nirmala UI":12,"Nirmala UI Semilight":13,Nyala:12,"OCR A Extended":14,OCRB:14,"Old English Text MT":12,Onyx:8,"Palace Script MT":8,"Palatino Linotype":11,Papyrus:14,Parchment:5,Perpetua:10,"Perpetua Titling MT":14,"Plantagenet Cherokee":12,Playbill:8,PMingLiU:11,"PMingLiU-ExtB":11,"Poor Richard":13,Pristina:11,"Pyunji R":11,Raavi:11,"Rage Italic":12,Ravie:21,Rockwell:11,"Rockwell Condensed":9,"Rockwell Extra Bold":14,"Rockwell Light":12,"Rockwell Nova":12,"Rockwell Nova Cond":12,"Rockwell Nova Cond Light":12,"Rockwell Nova Extra Bold":12,"Rockwell Nova Light":12,Rod:12,"Sakkal Majalla":12,"Sanskrit Text":13,"Script MT Bold":11,"Segoe MDL2 Assets":8,"Segoe Print":15,"Segoe Script":15,"Segoe UI":11,"Segoe UI Black":13,"Segoe UI Emoji":11,"Segoe UI Historic":11,"Segoe UI Light":11,"Segoe UI Semibold":12,"Segoe UI Semilight":11,"Segoe UI Symbol":11,Selawik:11,"Selawik Light":11,"Selawik Semibold":12,"Shonar Bangla":11,"Showcard Gothic":12,Shruti:13,"Simplified Arabic":11,"Simplified Arabic Fixed":13,"SimSun-ExtB":11,"Sitka Banner":11,"Sitka Display":11,"Sitka Heading":12,"Sitka Small":14,"Sitka Subheading":12,"Sitka Text":13,"Snap ITC":18,"Source Sans Pro":10,"Source Sans Pro Black":11,"Source Sans Pro ExtraLight":10,"Source Sans Pro Light":11,"Source Sans Pro SemiBold":11,Stencil:12,Sylfaen:11,Symbol:11,Tahoma:11,"Tempus Sans ITC":14,"TH SarabunPSK":8,"Times New Roman":11,"Traditional Arabic":10,"Trebuchet MS":11,Tunga:11,"Tw Cen MT":12,"Tw Cen MT Condensed":8,"Tw Cen MT Condensed Extra Bold":10,"UD Digi Kyokasho N-B":11,"UD Digi Kyokasho NK-B":11,"UD Digi Kyokasho NK-R":11,"UD Digi Kyokasho NP-B":11,"UD Digi Kyokasho NP-R":11,"UD Digi Kyokasho N-R":11,Univers:11,"Univers Condensed":11,"Univers Condensed Light":9,"Univers Light":11,"Urdu Typesetting":11,Utsaah:8,Vani:13,Verdana:13,"Verdana Pro":13,"Verdana Pro Black":11,"Verdana Pro Cond":11,"Verdana Pro Cond Black":11,"Verdana Pro Cond Light":11,"Verdana Pro Cond SemiBold":11,"Verdana Pro Light":11,"Verdana Pro SemiBold":11,Vijaya:11,"Viner Hand ITC":14,Vivaldi:9,"Vladimir Script":10,Vrinda:12,Webdings:21,"Wide Latin":26,Wingdings:28,"Wingdings 2":24,"Wingdings 3":19,"Yet R":11,"Yu Gothic":12,"Yu Gothic Light":11,"Yu Gothic Medium":12,"Yu Gothic UI":11,"Yu Gothic UI Light":11,"Yu Gothic UI Semibold":12,"Yu Gothic UI Semilight":12,"Yu Mincho":11,"Yu Mincho Demibold":11,"Yu Mincho Light":11,"\u4eff\u5b8b":11,"\u534e\u6587\u4e2d\u5b8b":13,"\u534e\u6587\u4eff\u5b8b":10,"\u534e\u6587\u5b8b\u4f53":10,"\u534e\u6587\u5f69\u4e91":12,"\u534e\u6587\u65b0\u9b4f":12,"\u534e\u6587\u6977\u4f53":10,"\u534e\u6587\u7425\u73c0":12,"\u534e\u6587\u7ec6\u9ed1":12,"\u534e\u6587\u884c\u6977":11,"\u534e\u6587\u96b6\u4e66":9,"\u5b8b\u4f53":11,"\u5e7c\u5706":11,"\u5fae\u8f6f\u96c5\u9ed1":12,"\u5fae\u8f6f\u96c5\u9ed1 Light":12,"\u65b0\u5b8b\u4f53":11,"\u65b9\u6b63\u59da\u4f53":11,"\u65b9\u6b63\u8212\u4f53":11,"\u6977\u4f53":11,"\u7b49\u7ebf":11,"\u7b49\u7ebf Light":11,"\u96b6\u4e66":11,"\u9ed1\u4f53":11,"\u6e38\u30b4\u30b7\u30c3\u30af":12,"\uff2d\uff33 \uff30\u660e\u671d":11,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':11,"\u30e1\u30a4\u30ea\u30aa":13,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":11,"HG\u660e\u671dB":11,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":11},18:{"Gill Sans MT":12,Abadi:15,"Abadi Extra Light":13,"Agency FB":10,Aharoni:10,Aldhabi:8,Algerian:14,"Ami R":10,"Angsana New":8,AngsanaUPC:8,Aparajita:10,"Arabic Typesetting":8,Arial:13,"Arial Black":16,"Arial Narrow":11,"Arial Nova":13,"Arial Nova Cond":12,"Arial Nova Cond Light":11,"Arial Nova Light":13,"Arial Rounded MT Bold":14,"Baskerville Old Face":12,Batang:12,BatangChe:12,"Bauhaus 93":14,"Bell MT":12,Bembo:12,"Berlin Sans FB":14,"Berlin Sans FB Demi":15,"Bernard MT Condensed":12,"Blackadder ITC":9,"Bodoni MT":12,"Bodoni MT Black":16,"Bodoni MT Condensed":8,"Bodoni MT Poster Compressed":8,"Book Antiqua":12,"Bookman Old Style":15,"Bookshelf Symbol 7":18,"Bradley Hand ITC":15,"Britannic Bold":15,Broadway:16,"Browallia New":9,BrowalliaUPC:9,"Brush Script MT":12,Calibri:12,"Calibri Light":12,"Californian FB":13,"Calisto MT":12,Cambria:13,"Cambria Math":13,Candara:13,Castellar:17,Centaur:12,Century:13,"Century Gothic":13,"Century Schoolbook":13,Chiller:11,"Colonna MT":12,"Comic Sans MS":15,Consolas:13,Constantia:13,"Cooper Black":14,"Copperplate Gothic Bold":17,"Copperplate Gothic Light":17,Corbel:13,"Cordia New":9,CordiaUPC:9,"Courier New":14,"Curlz MT":13,Dante:11,DaunPenh:8,David:11,DilleniaUPC:7,DokChampa:13,Dotum:13,DotumChe:12,Dubai:13,"Dubai Light":13,"Dubai Medium":13,Ebrima:13,"Edwardian Script ITC":11,Elephant:18,"Engravers MT":16,"Eras Bold ITC":16,"Eras Demi ITC":15,"Eras Light ITC":13,"Eras Medium ITC":14,EucrosiaUPC:10,Euphemia:14,"Expo M":21,FangSong:12,"Felix Titling":14,"Footlight MT Light":13,Forte:13,"Franklin Gothic Book":14,"Franklin Gothic Demi":14,"Franklin Gothic Demi Cond":12,"Franklin Gothic Heavy":14,"Franklin Gothic Medium":14,"Franklin Gothic Medium Cond":12,FrankRuehl:10,FreesiaUPC:11,"Freestyle Script":9,"French Script MT":9,Gabriola:10,Gadugi:13,Garamond:11,Gautami:14,Georgia:15,"Georgia Pro":14,"Georgia Pro Black":17,"Georgia Pro Cond":13,"Georgia Pro Cond Black":15,"Georgia Pro Cond Light":12,"Georgia Pro Cond Semibold":13,"Georgia Pro Light":13,"Georgia Pro Semibold":15,Gigi:12,"Gill Sans MT Condensed":9,"Gill Sans MT Ext Condensed Bold":8,"Gill Sans Nova":12,"Gill Sans Nova Cond":8,"Gill Sans Nova Cond Lt":7,"Gill Sans Nova Cond Ultra Bold":14,"Gill Sans Nova Cond XBd":13,"Gill Sans Nova Light":12,"Gill Sans Nova Ultra Bold":20,"Gill Sans Ultra Bold":21,"Gill Sans Ultra Bold Condensed":14,Gisha:13,"Gloucester MT Extra Condensed":9,"Goudy Old Style":12,"Goudy Stout":20,Grotesque:12,"Grotesque Light":12,Gulim:13,GulimChe:12,Gungsuh:13,GungsuhChe:12,"Hadassah Friedlaender":14,Haettenschweiler:11,"Harlow Solid Italic":11,Harrington:13,"Headline R":17,HGGothicE:12,HGGothicM:12,HGGyoshotai:12,HGKyokashotai:12,HGMaruGothicMPRO:18,HGMinchoB:13,HGMinchoE:13,HGPGothicE:14,HGPGothicM:15,HGPGyoshotai:12,HGPKyokashotai:12,HGPMinchoB:12,HGPMinchoE:13,HGPSoeiKakugothicUB:16,HGPSoeiKakupoptai:17,HGPSoeiPresenceEB:14,HGSeikaishotaiPRO:14,HGSGothicE:13,HGSGothicM:14,HGSGyoshotai:11,HGSKyokashotai:11,HGSMinchoB:12,HGSMinchoE:13,HGSoeiKakugothicUB:13,HGSoeiKakupoptai:13,HGSoeiPresenceEB:13,HGSSoeiKakugothicUB:15,HGSSoeiKakupoptai:16,HGSSoeiPresenceEB:13,"High Tower Text":12,"HYGothic-Extra":15,"HYGothic-Medium":14,"HYGraphic-Medium":14,"HYGungSo-Bold":14,"HYHeadLine-Medium":14,"HYMyeongJo-Extra":16,"HYPMokGak-Bold":17,"HYPost-Light":16,"HYPost-Medium":17,"HYShortSamul-Medium":9,"HYSinMyeongJo-Medium":15,Impact:13,"Imprint MT Shadow":12,"Informal Roman":13,"Ink Free":12,IrisUPC:12,"Iskoola Pota":12,JasmineUPC:11,"Javanese Text":14,Jokerman:17,"Juice ITC":8,KaiTi:12,Kalinga:13,Kartika:14,"Khmer UI":13,KodchiangUPC:8,Kokila:9,"Kristen ITC":14,"Kunstler Script":8,"Lao UI":13,Latha:12,Leelawadee:13,"Leelawadee UI":13,"Leelawadee UI Semilight":13,"Levenim MT":14,LilyUPC:11,"Lucida Bright":15,"Lucida Calligraphy":17,"Lucida Console":15,"Lucida Fax":16,"Lucida Handwriting":17,"Lucida Sans":16,"Lucida Sans Typewriter":14,"Lucida Sans Unicode":16,"Magic R":14,Magneto:19,"Maiandra GD":15,"Malgun Gothic":14,"Malgun Gothic Semilight":14,Mangal:14,Marlett:25,"Matura MT Script Capitals":17,Meiryo:16,"Meiryo UI":16,"Microsoft GothicNeo":13,"Microsoft Himalaya":9,"Microsoft JhengHei":14,"Microsoft JhengHei Light":15,"Microsoft JhengHei UI":14,"Microsoft JhengHei UI Light":15,"Microsoft New Tai Lue":14,"Microsoft PhagsPa":14,"Microsoft Sans Serif":14,"Microsoft Tai Le":14,"Microsoft Uighur":9,"Microsoft YaHei Light":15,"Microsoft YaHei UI":15,"Microsoft YaHei UI Light":15,"Microsoft Yi Baiti":13,MingLiU:13,MingLiU_HKSCS:13,"MingLiU_HKSCS-ExtB":13,"MingLiU-ExtB":13,Miriam:12,"Miriam Fixed":15,Mistral:12,"Modern No. 20":12,"MoeumT R":14,"Mongolian Baiti":13,"Monotype Corsiva":12,MoolBoran:9,"MS Gothic":13,"MS Mincho":13,"MS Outlook":13,"MS PGothic":13,"MS PMincho":13,"MS Reference Sans Serif":16,"MS Reference Specialty":30,"MS UI Gothic":13,"MT Extra":25,"MV Boli":18,"Myanmar Text":14,Narkisim:11,"Neue Haas Grotesk Text Pro":13,"New Gulim":15,"News Gothic MT":16,"Niagara Engraved":9,"Niagara Solid":9,"Nirmala UI":14,"Nirmala UI Semilight":14,Nyala:13,"OCR A Extended":15,OCRB:15,"Old English Text MT":13,Onyx:9,"Palace Script MT":9,"Palatino Linotype":12,Papyrus:15,Parchment:6,Perpetua:11,"Perpetua Titling MT":16,"Plantagenet Cherokee":13,Playbill:10,PMingLiU:12,"PMingLiU-ExtB":12,"Poor Richard":14,Pristina:13,"Pyunji R":13,Raavi:12,"Rage Italic":13,Ravie:24,Rockwell:13,"Rockwell Condensed":10,"Rockwell Extra Bold":17,"Rockwell Light":14,"Rockwell Nova":13,"Rockwell Nova Cond":13,"Rockwell Nova Cond Light":13,"Rockwell Nova Extra Bold":13,"Rockwell Nova Light":13,Rod:15,"Sakkal Majalla":10,"Sanskrit Text":15,"Script MT Bold":13,"Segoe MDL2 Assets":10,"Segoe Print":18,"Segoe Script":18,"Segoe UI":13,"Segoe UI Black":15,"Segoe UI Emoji":13,"Segoe UI Historic":13,"Segoe UI Light":12,"Segoe UI Semibold":14,"Segoe UI Semilight":13,"Segoe UI Symbol":13,Selawik:12,"Selawik Light":13,"Selawik Semibold":14,"Shonar Bangla":12,"Showcard Gothic":14,Shruti:14,"Simplified Arabic":13,"Simplified Arabic Fixed":14,"SimSun-ExtB":12,"Sitka Banner":12,"Sitka Display":13,"Sitka Heading":13,"Sitka Small":16,"Sitka Subheading":14,"Sitka Text":15,"Snap ITC":21,"Source Sans Pro":12,"Source Sans Pro Black":12,"Source Sans Pro ExtraLight":11,"Source Sans Pro Light":12,"Source Sans Pro SemiBold":12,Stencil:14,Sylfaen:12,Symbol:12,Tahoma:13,"Tempus Sans ITC":16,"TH SarabunPSK":9,"Times New Roman":12,"Traditional Arabic":12,"Trebuchet MS":13,Tunga:13,"Tw Cen MT":13,"Tw Cen MT Condensed":9,"Tw Cen MT Condensed Extra Bold":12,"UD Digi Kyokasho N-B":12,"UD Digi Kyokasho NK-B":12,"UD Digi Kyokasho NK-R":12,"UD Digi Kyokasho NP-B":17,"UD Digi Kyokasho NP-R":12,"UD Digi Kyokasho N-R":12,Univers:12,"Univers Condensed":12,"Univers Condensed Light":11,"Univers Light":12,"Urdu Typesetting":12,Utsaah:10,Vani:15,Verdana:15,"Verdana Pro":15,"Verdana Pro Black":12,"Verdana Pro Cond":12,"Verdana Pro Cond Black":12,"Verdana Pro Cond Light":12,"Verdana Pro Cond SemiBold":12,"Verdana Pro Light":12,"Verdana Pro SemiBold":12,Vijaya:12,"Viner Hand ITC":16,Vivaldi:10,"Vladimir Script":11,Vrinda:14,Webdings:24,"Wide Latin":30,Wingdings:32,"Wingdings 2":27,"Wingdings 3":21,"Yet R":13,"Yu Gothic":13,"Yu Gothic Light":13,"Yu Gothic Medium":13,"Yu Gothic UI":13,"Yu Gothic UI Light":13,"Yu Gothic UI Semibold":14,"Yu Gothic UI Semilight":13,"Yu Mincho":13,"Yu Mincho Demibold":13,"Yu Mincho Light":12,"\u4eff\u5b8b":12,"\u534e\u6587\u4e2d\u5b8b":15,"\u534e\u6587\u4eff\u5b8b":11,"\u534e\u6587\u5b8b\u4f53":11,"\u534e\u6587\u5f69\u4e91":14,"\u534e\u6587\u65b0\u9b4f":14,"\u534e\u6587\u6977\u4f53":11,"\u534e\u6587\u7425\u73c0":14,"\u534e\u6587\u7ec6\u9ed1":13,"\u534e\u6587\u884c\u6977":12,"\u534e\u6587\u96b6\u4e66":11,"\u5b8b\u4f53":12,"\u5e7c\u5706":12,"\u5fae\u8f6f\u96c5\u9ed1":14,"\u5fae\u8f6f\u96c5\u9ed1 Light":14,"\u65b0\u5b8b\u4f53":12,"\u65b9\u6b63\u59da\u4f53":12,"\u65b9\u6b63\u8212\u4f53":13,"\u6977\u4f53":12,"\u7b49\u7ebf":13,"\u7b49\u7ebf Light":12,"\u96b6\u4e66":12,"\u9ed1\u4f53":12,"\u6e38\u30b4\u30b7\u30c3\u30af":13,"\uff2d\uff33 \uff30\u660e\u671d":12,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':12,"\u30e1\u30a4\u30ea\u30aa":15,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":12,"HG\u660e\u671dB":12,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":12},20:{"Gill Sans MT":14,Abadi:16,"Abadi Extra Light":15,"Agency FB":11,Aharoni:11,Aldhabi:9,Algerian:16,"Ami R":11,"Angsana New":9,AngsanaUPC:9,Aparajita:11,"Arabic Typesetting":9,Arial:15,"Arial Black":18,"Arial Narrow":12,"Arial Nova":15,"Arial Nova Cond":14,"Arial Nova Cond Light":12,"Arial Nova Light":15,"Arial Rounded MT Bold":16,"Baskerville Old Face":13,Batang:16,BatangChe:14,"Bauhaus 93":15,"Bell MT":14,Bembo:13,"Berlin Sans FB":16,"Berlin Sans FB Demi":17,"Bernard MT Condensed":13,"Blackadder ITC":11,"Bodoni MT":13,"Bodoni MT Black":18,"Bodoni MT Condensed":9,"Bodoni MT Poster Compressed":8,"Book Antiqua":14,"Bookman Old Style":17,"Bookshelf Symbol 7":20,"Bradley Hand ITC":17,"Britannic Bold":17,Broadway:17,"Browallia New":10,BrowalliaUPC:10,"Brush Script MT":14,Calibri:14,"Calibri Light":14,"Californian FB":14,"Calisto MT":14,Cambria:15,"Cambria Math":15,Candara:15,Castellar:19,Centaur:13,Century:15,"Century Gothic":15,"Century Schoolbook":15,Chiller:13,"Colonna MT":14,"Comic Sans MS":16,Consolas:15,Constantia:15,"Cooper Black":16,"Copperplate Gothic Bold":19,"Copperplate Gothic Light":19,Corbel:14,"Cordia New":10,CordiaUPC:10,"Courier New":16,"Curlz MT":15,Dante:12,DaunPenh:9,David:12,DilleniaUPC:8,DokChampa:15,Dotum:16,DotumChe:14,Dubai:15,"Dubai Light":15,"Dubai Medium":15,Ebrima:15,"Edwardian Script ITC":13,Elephant:20,"Engravers MT":17,"Eras Bold ITC":18,"Eras Demi ITC":16,"Eras Light ITC":14,"Eras Medium ITC":15,EucrosiaUPC:11,Euphemia:16,"Expo M":23,FangSong:14,"Felix Titling":16,"Footlight MT Light":15,Forte:14,"Franklin Gothic Book":16,"Franklin Gothic Demi":16,"Franklin Gothic Demi Cond":14,"Franklin Gothic Heavy":16,"Franklin Gothic Medium":16,"Franklin Gothic Medium Cond":14,FrankRuehl:11,FreesiaUPC:12,"Freestyle Script":10,"French Script MT":10,Gabriola:11,Gadugi:15,Garamond:13,Gautami:16,Georgia:17,"Georgia Pro":15,"Georgia Pro Black":19,"Georgia Pro Cond":14,"Georgia Pro Cond Black":17,"Georgia Pro Cond Light":14,"Georgia Pro Cond Semibold":15,"Georgia Pro Light":15,"Georgia Pro Semibold":17,Gigi:14,"Gill Sans MT Condensed":10,"Gill Sans MT Ext Condensed Bold":9,"Gill Sans Nova":14,"Gill Sans Nova Cond":9,"Gill Sans Nova Cond Lt":8,"Gill Sans Nova Cond Ultra Bold":16,"Gill Sans Nova Cond XBd":14,"Gill Sans Nova Light":14,"Gill Sans Nova Ultra Bold":23,"Gill Sans Ultra Bold":23,"Gill Sans Ultra Bold Condensed":16,Gisha:15,"Gloucester MT Extra Condensed":10,"Goudy Old Style":14,"Goudy Stout":22,Grotesque:13,"Grotesque Light":13,Gulim:16,GulimChe:14,Gungsuh:16,GungsuhChe:14,"Hadassah Friedlaender":15,Haettenschweiler:12,"Harlow Solid Italic":13,Harrington:15,"Headline R":19,HGGothicE:14,HGGothicM:14,HGGyoshotai:14,HGKyokashotai:14,HGMaruGothicMPRO:20,HGMinchoB:15,HGMinchoE:15,HGPGothicE:16,HGPGothicM:17,HGPGyoshotai:14,HGPKyokashotai:14,HGPMinchoB:14,HGPMinchoE:15,HGPSoeiKakugothicUB:18,HGPSoeiKakupoptai:19,HGPSoeiPresenceEB:16,HGSeikaishotaiPRO:16,HGSGothicE:15,HGSGothicM:16,HGSGyoshotai:13,HGSKyokashotai:13,HGSMinchoB:14,HGSMinchoE:15,HGSoeiKakugothicUB:15,HGSoeiKakupoptai:15,HGSoeiPresenceEB:15,HGSSoeiKakugothicUB:17,HGSSoeiKakupoptai:18,HGSSoeiPresenceEB:15,"High Tower Text":13,"HYGothic-Extra":17,"HYGothic-Medium":16,"HYGraphic-Medium":16,"HYGungSo-Bold":16,"HYHeadLine-Medium":16,"HYMyeongJo-Extra":18,"HYPMokGak-Bold":19,"HYPost-Light":18,"HYPost-Medium":19,"HYShortSamul-Medium":10,"HYSinMyeongJo-Medium":17,Impact:15,"Imprint MT Shadow":14,"Informal Roman":15,"Ink Free":14,IrisUPC:14,"Iskoola Pota":14,JasmineUPC:12,"Javanese Text":16,Jokerman:19,"Juice ITC":10,KaiTi:14,Kalinga:15,Kartika:16,"Khmer UI":15,KodchiangUPC:9,Kokila:10,"Kristen ITC":16,"Kunstler Script":10,"Lao UI":15,Latha:14,Leelawadee:15,"Leelawadee UI":15,"Leelawadee UI Semilight":15,"Levenim MT":15,LilyUPC:12,"Lucida Bright":16,"Lucida Calligraphy":19,"Lucida Console":17,"Lucida Fax":18,"Lucida Handwriting":19,"Lucida Sans":18,"Lucida Sans Typewriter":16,"Lucida Sans Unicode":18,"Magic R":16,Magneto:21,"Maiandra GD":17,"Malgun Gothic":16,"Malgun Gothic Semilight":16,Mangal:16,Marlett:28,"Matura MT Script Capitals":19,Meiryo:18,"Meiryo UI":18,"Microsoft GothicNeo":15,"Microsoft Himalaya":10,"Microsoft JhengHei":16,"Microsoft JhengHei Light":17,"Microsoft JhengHei UI":16,"Microsoft JhengHei UI Light":17,"Microsoft New Tai Lue":16,"Microsoft PhagsPa":16,"Microsoft Sans Serif":16,"Microsoft Tai Le":16,"Microsoft Uighur":10,"Microsoft YaHei Light":16,"Microsoft YaHei UI":17,"Microsoft YaHei UI Light":16,"Microsoft Yi Baiti":15,MingLiU:15,MingLiU_HKSCS:15,"MingLiU_HKSCS-ExtB":15,"MingLiU-ExtB":15,Miriam:14,"Miriam Fixed":17,Mistral:13,"Modern No. 20":13,"MoeumT R":16,"Mongolian Baiti":15,"Monotype Corsiva":13,MoolBoran:10,"MS Gothic":15,"MS Mincho":15,"MS Outlook":15,"MS PGothic":15,"MS PMincho":15,"MS Reference Sans Serif":18,"MS Reference Specialty":33,"MS UI Gothic":15,"MT Extra":29,"MV Boli":20,"Myanmar Text":16,Narkisim:12,"Neue Haas Grotesk Text Pro":15,"New Gulim":17,"News Gothic MT":18,"Niagara Engraved":9,"Niagara Solid":9,"Nirmala UI":16,"Nirmala UI Semilight":16,Nyala:15,"OCR A Extended":17,OCRB:17,"Old English Text MT":15,Onyx:9,"Palace Script MT":9,"Palatino Linotype":14,Papyrus:16,Parchment:7,Perpetua:12,"Perpetua Titling MT":18,"Plantagenet Cherokee":15,Playbill:11,PMingLiU:14,"PMingLiU-ExtB":14,"Poor Richard":16,Pristina:14,"Pyunji R":14,Raavi:14,"Rage Italic":15,Ravie:27,Rockwell:15,"Rockwell Condensed":12,"Rockwell Extra Bold":19,"Rockwell Light":15,"Rockwell Nova":15,"Rockwell Nova Cond":15,"Rockwell Nova Cond Light":15,"Rockwell Nova Extra Bold":15,"Rockwell Nova Light":15,Rod:17,"Sakkal Majalla":11,"Sanskrit Text":17,"Script MT Bold":14,"Segoe MDL2 Assets":11,"Segoe Print":20,"Segoe Script":20,"Segoe UI":15,"Segoe UI Black":17,"Segoe UI Emoji":15,"Segoe UI Historic":15,"Segoe UI Light":14,"Segoe UI Semibold":15,"Segoe UI Semilight":15,"Segoe UI Symbol":15,Selawik:14,"Selawik Light":14,"Selawik Semibold":15,"Shonar Bangla":14,"Showcard Gothic":16,Shruti:16,"Simplified Arabic":14,"Simplified Arabic Fixed":16,"SimSun-ExtB":14,"Sitka Banner":14,"Sitka Display":14,"Sitka Heading":15,"Sitka Small":18,"Sitka Subheading":16,"Sitka Text":17,"Snap ITC":23,"Source Sans Pro":13,"Source Sans Pro Black":14,"Source Sans Pro ExtraLight":12,"Source Sans Pro Light":12,"Source Sans Pro SemiBold":14,Stencil:16,Sylfaen:14,Symbol:14,Tahoma:15,"Tempus Sans ITC":18,"TH SarabunPSK":10,"Times New Roman":14,"Traditional Arabic":13,"Trebuchet MS":14,Tunga:14,"Tw Cen MT":15,"Tw Cen MT Condensed":10,"Tw Cen MT Condensed Extra Bold":13,"UD Digi Kyokasho N-B":14,"UD Digi Kyokasho NK-B":14,"UD Digi Kyokasho NK-R":14,"UD Digi Kyokasho NP-B":19,"UD Digi Kyokasho NP-R":14,"UD Digi Kyokasho N-R":14,Univers:14,"Univers Condensed":14,"Univers Condensed Light":12,"Univers Light":14,"Urdu Typesetting":14,Utsaah:11,Vani:17,Verdana:17,"Verdana Pro":17,"Verdana Pro Black":14,"Verdana Pro Cond":14,"Verdana Pro Cond Black":14,"Verdana Pro Cond Light":14,"Verdana Pro Cond SemiBold":14,"Verdana Pro Light":14,"Verdana Pro SemiBold":14,Vijaya:14,"Viner Hand ITC":18,Vivaldi:12,"Vladimir Script":13,Vrinda:16,Webdings:27,"Wide Latin":33,Wingdings:36,"Wingdings 2":31,"Wingdings 3":24,"Yet R":14,"Yu Gothic":15,"Yu Gothic Light":14,"Yu Gothic Medium":15,"Yu Gothic UI":15,"Yu Gothic UI Light":14,"Yu Gothic UI Semibold":16,"Yu Gothic UI Semilight":15,"Yu Mincho":15,"Yu Mincho Demibold":14,"Yu Mincho Light":14,"\u4eff\u5b8b":14,"\u534e\u6587\u4e2d\u5b8b":17,"\u534e\u6587\u4eff\u5b8b":13,"\u534e\u6587\u5b8b\u4f53":13,"\u534e\u6587\u5f69\u4e91":15,"\u534e\u6587\u65b0\u9b4f":16,"\u534e\u6587\u6977\u4f53":13,"\u534e\u6587\u7425\u73c0":15,"\u534e\u6587\u7ec6\u9ed1":15,"\u534e\u6587\u884c\u6977":14,"\u534e\u6587\u96b6\u4e66":12,"\u5b8b\u4f53":14,"\u5e7c\u5706":14,"\u5fae\u8f6f\u96c5\u9ed1":16,"\u5fae\u8f6f\u96c5\u9ed1 Light":15,"\u65b0\u5b8b\u4f53":14,"\u65b9\u6b63\u59da\u4f53":14,"\u65b9\u6b63\u8212\u4f53":15,"\u6977\u4f53":14,"\u7b49\u7ebf":14,"\u7b49\u7ebf Light":14,"\u96b6\u4e66":14,"\u9ed1\u4f53":14,"\u6e38\u30b4\u30b7\u30c3\u30af":15,"\uff2d\uff33 \uff30\u660e\u671d":14,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':14,"\u30e1\u30a4\u30ea\u30aa":17,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":14,"HG\u660e\u671dB":14,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":14},22:{"Gill Sans MT":15,Abadi:18,"Abadi Extra Light":16,"Agency FB":11,Aharoni:12,Aldhabi:9,Algerian:17,"Ami R":12,"Angsana New":10,AngsanaUPC:10,Aparajita:12,"Arabic Typesetting":10,Arial:16,"Arial Black":19,"Arial Narrow":13,"Arial Nova":16,"Arial Nova Cond":15,"Arial Nova Cond Light":13,"Arial Nova Light":16,"Arial Rounded MT Bold":17,"Baskerville Old Face":14,Batang:17,BatangChe:15,"Bauhaus 93":16,"Bell MT":15,Bembo:14,"Berlin Sans FB":17,"Berlin Sans FB Demi":18,"Bernard MT Condensed":14,"Blackadder ITC":11,"Bodoni MT":14,"Bodoni MT Black":19,"Bodoni MT Condensed":10,"Bodoni MT Poster Compressed":9,"Book Antiqua":15,"Bookman Old Style":18,"Bookshelf Symbol 7":21,"Bradley Hand ITC":19,"Britannic Bold":18,Broadway:19,"Browallia New":11,BrowalliaUPC:11,"Brush Script MT":15,Calibri:15,"Calibri Light":15,"Californian FB":15,"Calisto MT":15,Cambria:16,"Cambria Math":16,Candara:16,Castellar:21,Centaur:14,Century:16,"Century Gothic":16,"Century Schoolbook":16,Chiller:14,"Colonna MT":15,"Comic Sans MS":18,Consolas:16,Constantia:16,"Cooper Black":17,"Copperplate Gothic Bold":21,"Copperplate Gothic Light":21,Corbel:15,"Cordia New":11,CordiaUPC:11,"Courier New":17,"Curlz MT":16,Dante:13,DaunPenh:10,David:13,DilleniaUPC:9,DokChampa:16,Dotum:17,DotumChe:15,Dubai:16,"Dubai Light":16,"Dubai Medium":16,Ebrima:16,"Edwardian Script ITC":14,Elephant:22,"Engravers MT":19,"Eras Bold ITC":19,"Eras Demi ITC":18,"Eras Light ITC":16,"Eras Medium ITC":17,EucrosiaUPC:12,Euphemia:17,"Expo M":25,FangSong:15,"Felix Titling":17,"Footlight MT Light":16,Forte:15,"Franklin Gothic Book":17,"Franklin Gothic Demi":17,"Franklin Gothic Demi Cond":15,"Franklin Gothic Heavy":17,"Franklin Gothic Medium":17,"Franklin Gothic Medium Cond":15,FrankRuehl:12,FreesiaUPC:13,"Freestyle Script":10,"French Script MT":11,Gabriola:12,Gadugi:16,Garamond:14,Gautami:17,Georgia:18,"Georgia Pro":16,"Georgia Pro Black":21,"Georgia Pro Cond":15,"Georgia Pro Cond Black":18,"Georgia Pro Cond Light":15,"Georgia Pro Cond Semibold":16,"Georgia Pro Light":16,"Georgia Pro Semibold":18,Gigi:14,"Gill Sans MT Condensed":11,"Gill Sans MT Ext Condensed Bold":10,"Gill Sans Nova":15,"Gill Sans Nova Cond":10,"Gill Sans Nova Cond Lt":9,"Gill Sans Nova Cond Ultra Bold":17,"Gill Sans Nova Cond XBd":15,"Gill Sans Nova Light":15,"Gill Sans Nova Ultra Bold":25,"Gill Sans Ultra Bold":25,"Gill Sans Ultra Bold Condensed":17,Gisha:16,"Gloucester MT Extra Condensed":11,"Goudy Old Style":15,"Goudy Stout":24,Grotesque:14,"Grotesque Light":14,Gulim:17,GulimChe:15,Gungsuh:17,GungsuhChe:15,"Hadassah Friedlaender":17,Haettenschweiler:13,"Harlow Solid Italic":14,Harrington:16,"Headline R":21,HGGothicE:15,HGGothicM:15,HGGyoshotai:15,HGKyokashotai:15,HGMaruGothicMPRO:22,HGMinchoB:16,HGMinchoE:16,HGPGothicE:17,HGPGothicM:18,HGPGyoshotai:15,HGPKyokashotai:14,HGPMinchoB:15,HGPMinchoE:16,HGPSoeiKakugothicUB:19,HGPSoeiKakupoptai:20,HGPSoeiPresenceEB:17,HGSeikaishotaiPRO:17,HGSGothicE:16,HGSGothicM:17,HGSGyoshotai:14,HGSKyokashotai:13,HGSMinchoB:15,HGSMinchoE:16,HGSoeiKakugothicUB:16,HGSoeiKakupoptai:16,HGSoeiPresenceEB:16,HGSSoeiKakugothicUB:18,HGSSoeiKakupoptai:19,HGSSoeiPresenceEB:16,"High Tower Text":14,"HYGothic-Extra":18,"HYGothic-Medium":17,"HYGraphic-Medium":17,"HYGungSo-Bold":17,"HYHeadLine-Medium":17,"HYMyeongJo-Extra":19,"HYPMokGak-Bold":21,"HYPost-Light":19,"HYPost-Medium":21,"HYShortSamul-Medium":11,"HYSinMyeongJo-Medium":18,Impact:16,"Imprint MT Shadow":15,"Informal Roman":16,"Ink Free":15,IrisUPC:15,"Iskoola Pota":15,JasmineUPC:13,"Javanese Text":17,Jokerman:21,"Juice ITC":11,KaiTi:15,Kalinga:16,Kartika:17,"Khmer UI":16,KodchiangUPC:10,Kokila:11,"Kristen ITC":17,"Kunstler Script":10,"Lao UI":16,Latha:15,Leelawadee:16,"Leelawadee UI":16,"Leelawadee UI Semilight":16,"Levenim MT":17,LilyUPC:13,"Lucida Bright":18,"Lucida Calligraphy":20,"Lucida Console":18,"Lucida Fax":19,"Lucida Handwriting":21,"Lucida Sans":19,"Lucida Sans Typewriter":17,"Lucida Sans Unicode":19,"Magic R":17,Magneto:22,"Maiandra GD":18,"Malgun Gothic":17,"Malgun Gothic Semilight":17,Mangal:17,Marlett:30,"Matura MT Script Capitals":20,Meiryo:20,"Meiryo UI":20,"Microsoft GothicNeo":16,"Microsoft Himalaya":11,"Microsoft JhengHei":17,"Microsoft JhengHei Light":18,"Microsoft JhengHei UI":17,"Microsoft JhengHei UI Light":18,"Microsoft New Tai Lue":17,"Microsoft PhagsPa":17,"Microsoft Sans Serif":17,"Microsoft Tai Le":17,"Microsoft Uighur":11,"Microsoft YaHei Light":18,"Microsoft YaHei UI":18,"Microsoft YaHei UI Light":18,"Microsoft Yi Baiti":16,MingLiU:16,MingLiU_HKSCS:16,"MingLiU_HKSCS-ExtB":16,"MingLiU-ExtB":16,Miriam:15,"Miriam Fixed":18,Mistral:14,"Modern No. 20":14,"MoeumT R":17,"Mongolian Baiti":16,"Monotype Corsiva":14,MoolBoran:11,"MS Gothic":16,"MS Mincho":16,"MS Outlook":16,"MS PGothic":16,"MS PMincho":16,"MS Reference Sans Serif":19,"MS Reference Specialty":36,"MS UI Gothic":16,"MT Extra":31,"MV Boli":21,"Myanmar Text":17,Narkisim:13,"Neue Haas Grotesk Text Pro":16,"New Gulim":18,"News Gothic MT":19,"Niagara Engraved":10,"Niagara Solid":10,"Nirmala UI":17,"Nirmala UI Semilight":17,Nyala:16,"OCR A Extended":19,OCRB:18,"Old English Text MT":16,Onyx:10,"Palace Script MT":10,"Palatino Linotype":15,Papyrus:18,Parchment:7,Perpetua:13,"Perpetua Titling MT":20,"Plantagenet Cherokee":16,Playbill:11,PMingLiU:15,"PMingLiU-ExtB":15,"Poor Richard":17,Pristina:15,"Pyunji R":15,Raavi:15,"Rage Italic":16,Ravie:29,Rockwell:16,"Rockwell Condensed":12,"Rockwell Extra Bold":20,"Rockwell Light":16,"Rockwell Nova":16,"Rockwell Nova Cond":16,"Rockwell Nova Cond Light":16,"Rockwell Nova Extra Bold":16,"Rockwell Nova Light":16,Rod:18,"Sakkal Majalla":12,"Sanskrit Text":18,"Script MT Bold":15,"Segoe MDL2 Assets":12,"Segoe Print":21,"Segoe Script":21,"Segoe UI":16,"Segoe UI Black":18,"Segoe UI Emoji":16,"Segoe UI Historic":16,"Segoe UI Light":15,"Segoe UI Semibold":17,"Segoe UI Semilight":16,"Segoe UI Symbol":16,Selawik:15,"Selawik Light":15,"Selawik Semibold":16,"Shonar Bangla":15,"Showcard Gothic":17,Shruti:17,"Simplified Arabic":15,"Simplified Arabic Fixed":17,"SimSun-ExtB":15,"Sitka Banner":15,"Sitka Display":15,"Sitka Heading":16,"Sitka Small":20,"Sitka Subheading":17,"Sitka Text":18,"Snap ITC":25,"Source Sans Pro":14,"Source Sans Pro Black":15,"Source Sans Pro ExtraLight":13,"Source Sans Pro Light":13,"Source Sans Pro SemiBold":14,Stencil:17,Sylfaen:15,Symbol:15,Tahoma:16,"Tempus Sans ITC":19,"TH SarabunPSK":11,"Times New Roman":15,"Traditional Arabic":14,"Trebuchet MS":15,Tunga:15,"Tw Cen MT":16,"Tw Cen MT Condensed":11,"Tw Cen MT Condensed Extra Bold":14,"UD Digi Kyokasho N-B":15,"UD Digi Kyokasho NK-B":15,"UD Digi Kyokasho NK-R":15,"UD Digi Kyokasho NP-B":21,"UD Digi Kyokasho NP-R":15,"UD Digi Kyokasho N-R":15,Univers:15,"Univers Condensed":15,"Univers Condensed Light":13,"Univers Light":15,"Urdu Typesetting":15,Utsaah:12,Vani:18,Verdana:18,"Verdana Pro":18,"Verdana Pro Black":15,"Verdana Pro Cond":15,"Verdana Pro Cond Black":15,"Verdana Pro Cond Light":15,"Verdana Pro Cond SemiBold":15,"Verdana Pro Light":15,"Verdana Pro SemiBold":15,Vijaya:12,"Viner Hand ITC":20,Vivaldi:12,"Vladimir Script":13,Vrinda:17,Webdings:29,"Wide Latin":36,Wingdings:39,"Wingdings 2":33,"Wingdings 3":26,"Yet R":16,"Yu Gothic":16,"Yu Gothic Light":16,"Yu Gothic Medium":16,"Yu Gothic UI":16,
"Yu Gothic UI Light":15,"Yu Gothic UI Semibold":17,"Yu Gothic UI Semilight":16,"Yu Mincho":16,"Yu Mincho Demibold":15,"Yu Mincho Light":15,"\u4eff\u5b8b":15,"\u534e\u6587\u4e2d\u5b8b":18,"\u534e\u6587\u4eff\u5b8b":14,"\u534e\u6587\u5b8b\u4f53":14,"\u534e\u6587\u5f69\u4e91":16,"\u534e\u6587\u65b0\u9b4f":17,"\u534e\u6587\u6977\u4f53":14,"\u534e\u6587\u7425\u73c0":16,"\u534e\u6587\u7ec6\u9ed1":16,"\u534e\u6587\u884c\u6977":15,"\u534e\u6587\u96b6\u4e66":13,"\u5b8b\u4f53":15,"\u5e7c\u5706":15,"\u5fae\u8f6f\u96c5\u9ed1":17,"\u5fae\u8f6f\u96c5\u9ed1 Light":17,"\u65b0\u5b8b\u4f53":15,"\u65b9\u6b63\u59da\u4f53":15,"\u65b9\u6b63\u8212\u4f53":16,"\u6977\u4f53":15,"\u7b49\u7ebf":15,"\u7b49\u7ebf Light":15,"\u96b6\u4e66":15,"\u9ed1\u4f53":15,"\u6e38\u30b4\u30b7\u30c3\u30af":16,"\uff2d\uff33 \uff30\u660e\u671d":15,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':15,"\u30e1\u30a4\u30ea\u30aa":18,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":15,"HG\u660e\u671dB":15,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":15},24:{"Gill Sans MT":16,Abadi:19,"Abadi Extra Light":18,"Agency FB":14,Aharoni:13,Aldhabi:10,Algerian:19,"Ami R":13,"Angsana New":11,AngsanaUPC:11,Aparajita:13,"Arabic Typesetting":11,Arial:18,"Arial Black":21,"Arial Narrow":15,"Arial Nova":18,"Arial Nova Cond":16,"Arial Nova Cond Light":14,"Arial Nova Light":18,"Arial Rounded MT Bold":19,"Baskerville Old Face":16,Batang:19,BatangChe:16,"Bauhaus 93":18,"Bell MT":16,Bembo:16,"Berlin Sans FB":19,"Berlin Sans FB Demi":20,"Bernard MT Condensed":16,"Blackadder ITC":13,"Bodoni MT":16,"Bodoni MT Black":21,"Bodoni MT Condensed":11,"Bodoni MT Poster Compressed":9,"Book Antiqua":16,"Bookman Old Style":20,"Bookshelf Symbol 7":24,"Bradley Hand ITC":21,"Britannic Bold":20,Broadway:21,"Browallia New":12,BrowalliaUPC:12,"Brush Script MT":16,Calibri:16,"Calibri Light":16,"Californian FB":17,"Calisto MT":16,Cambria:18,"Cambria Math":18,Candara:18,Castellar:23,Centaur:16,Century:18,"Century Gothic":18,"Century Schoolbook":18,Chiller:15,"Colonna MT":16,"Comic Sans MS":20,Consolas:18,Constantia:17,"Cooper Black":19,"Copperplate Gothic Bold":23,"Copperplate Gothic Light":23,Corbel:17,"Cordia New":12,CordiaUPC:12,"Courier New":19,"Curlz MT":17,Dante:14,DaunPenh:11,David:14,DilleniaUPC:10,DokChampa:18,Dotum:19,DotumChe:16,Dubai:17,"Dubai Light":17,"Dubai Medium":17,Ebrima:17,"Edwardian Script ITC":15,Elephant:24,"Engravers MT":21,"Eras Bold ITC":21,"Eras Demi ITC":20,"Eras Light ITC":17,"Eras Medium ITC":18,EucrosiaUPC:13,Euphemia:19,"Expo M":28,FangSong:16,"Felix Titling":19,"Footlight MT Light":18,Forte:17,"Franklin Gothic Book":19,"Franklin Gothic Demi":19,"Franklin Gothic Demi Cond":16,"Franklin Gothic Heavy":19,"Franklin Gothic Medium":19,"Franklin Gothic Medium Cond":16,FrankRuehl:13,FreesiaUPC:14,"Freestyle Script":12,"French Script MT":12,Gabriola:13,Gadugi:17,Garamond:15,Gautami:19,Georgia:20,"Georgia Pro":18,"Georgia Pro Black":23,"Georgia Pro Cond":17,"Georgia Pro Cond Black":20,"Georgia Pro Cond Light":16,"Georgia Pro Cond Semibold":18,"Georgia Pro Light":18,"Georgia Pro Semibold":20,Gigi:17,"Gill Sans MT Condensed":12,"Gill Sans MT Ext Condensed Bold":11,"Gill Sans Nova":16,"Gill Sans Nova Cond":11,"Gill Sans Nova Cond Lt":10,"Gill Sans Nova Cond Ultra Bold":19,"Gill Sans Nova Cond XBd":17,"Gill Sans Nova Light":16,"Gill Sans Nova Ultra Bold":27,"Gill Sans Ultra Bold":27,"Gill Sans Ultra Bold Condensed":19,Gisha:17,"Gloucester MT Extra Condensed":12,"Goudy Old Style":16,"Goudy Stout":26,Grotesque:15,"Grotesque Light":15,Gulim:18,GulimChe:16,Gungsuh:19,GungsuhChe:16,"Hadassah Friedlaender":18,Haettenschweiler:14,"Harlow Solid Italic":15,Harrington:18,"Headline R":23,HGGothicE:16,HGGothicM:16,HGGyoshotai:16,HGKyokashotai:16,HGMaruGothicMPRO:24,HGMinchoB:17,HGMinchoE:17,HGPGothicE:18,HGPGothicM:20,HGPGyoshotai:16,HGPKyokashotai:16,HGPMinchoB:16,HGPMinchoE:18,HGPSoeiKakugothicUB:21,HGPSoeiKakupoptai:22,HGPSoeiPresenceEB:19,HGSeikaishotaiPRO:19,HGSGothicE:17,HGSGothicM:19,HGSGyoshotai:15,HGSKyokashotai:15,HGSMinchoB:16,HGSMinchoE:18,HGSoeiKakugothicUB:17,HGSoeiKakupoptai:17,HGSoeiPresenceEB:17,HGSSoeiKakugothicUB:20,HGSSoeiKakupoptai:21,HGSSoeiPresenceEB:18,"High Tower Text":15,"HYGothic-Extra":20,"HYGothic-Medium":19,"HYGraphic-Medium":19,"HYGungSo-Bold":19,"HYHeadLine-Medium":19,"HYMyeongJo-Extra":21,"HYPMokGak-Bold":23,"HYPost-Light":21,"HYPost-Medium":23,"HYShortSamul-Medium":12,"HYSinMyeongJo-Medium":20,Impact:17,"Imprint MT Shadow":16,"Informal Roman":17,"Ink Free":16,IrisUPC:16,"Iskoola Pota":16,JasmineUPC:15,"Javanese Text":19,Jokerman:23,"Juice ITC":11,KaiTi:16,Kalinga:18,Kartika:18,"Khmer UI":17,KodchiangUPC:11,Kokila:12,"Kristen ITC":19,"Kunstler Script":11,"Lao UI":17,Latha:16,Leelawadee:17,"Leelawadee UI":17,"Leelawadee UI Semilight":18,"Levenim MT":18,LilyUPC:14,"Lucida Bright":19,"Lucida Calligraphy":22,"Lucida Console":20,"Lucida Fax":21,"Lucida Handwriting":23,"Lucida Sans":21,"Lucida Sans Typewriter":19,"Lucida Sans Unicode":21,"Magic R":19,Magneto:25,"Maiandra GD":20,"Malgun Gothic":19,"Malgun Gothic Semilight":19,Mangal:18,Marlett:33,"Matura MT Script Capitals":22,Meiryo:22,"Meiryo UI":22,"Microsoft GothicNeo":17,"Microsoft Himalaya":12,"Microsoft JhengHei":19,"Microsoft JhengHei Light":19,"Microsoft JhengHei UI":19,"Microsoft JhengHei UI Light":19,"Microsoft New Tai Lue":18,"Microsoft PhagsPa":18,"Microsoft Sans Serif":19,"Microsoft Tai Le":18,"Microsoft Uighur":12,"Microsoft YaHei Light":19,"Microsoft YaHei UI":20,"Microsoft YaHei UI Light":19,"Microsoft Yi Baiti":17,MingLiU:17,MingLiU_HKSCS:17,"MingLiU_HKSCS-ExtB":17,"MingLiU-ExtB":17,Miriam:16,"Miriam Fixed":20,Mistral:15,"Modern No. 20":16,"MoeumT R":19,"Mongolian Baiti":17,"Monotype Corsiva":15,MoolBoran:12,"MS Gothic":17,"MS Mincho":17,"MS Outlook":17,"MS PGothic":17,"MS PMincho":17,"MS Reference Sans Serif":21,"MS Reference Specialty":39,"MS UI Gothic":17,"MT Extra":34,"MV Boli":23,"Myanmar Text":18,Narkisim:14,"Neue Haas Grotesk Text Pro":17,"New Gulim":19,"News Gothic MT":21,"Niagara Engraved":11,"Niagara Solid":11,"Nirmala UI":18,"Nirmala UI Semilight":19,Nyala:17,"OCR A Extended":20,OCRB:20,"Old English Text MT":17,Onyx:10,"Palace Script MT":11,"Palatino Linotype":16,Papyrus:20,Parchment:8,Perpetua:15,"Perpetua Titling MT":22,"Plantagenet Cherokee":18,Playbill:12,PMingLiU:16,"PMingLiU-ExtB":16,"Poor Richard":19,Pristina:16,"Pyunji R":17,Raavi:16,"Rage Italic":18,Ravie:31,Rockwell:17,"Rockwell Condensed":14,"Rockwell Extra Bold":22,"Rockwell Light":18,"Rockwell Nova":17,"Rockwell Nova Cond":17,"Rockwell Nova Cond Light":17,"Rockwell Nova Extra Bold":17,"Rockwell Nova Light":17,Rod:20,"Sakkal Majalla":13,"Sanskrit Text":19,"Script MT Bold":17,"Segoe MDL2 Assets":13,"Segoe Print":23,"Segoe Script":23,"Segoe UI":17,"Segoe UI Black":20,"Segoe UI Emoji":17,"Segoe UI Historic":17,"Segoe UI Light":16,"Segoe UI Semibold":18,"Segoe UI Semilight":17,"Segoe UI Symbol":17,Selawik:17,"Selawik Light":17,"Selawik Semibold":18,"Shonar Bangla":13,"Showcard Gothic":19,Shruti:19,"Simplified Arabic":17,"Simplified Arabic Fixed":19,"SimSun-ExtB":16,"Sitka Banner":16,"Sitka Display":17,"Sitka Heading":18,"Sitka Small":22,"Sitka Subheading":19,"Sitka Text":20,"Snap ITC":28,"Source Sans Pro":15,"Source Sans Pro Black":17,"Source Sans Pro ExtraLight":15,"Source Sans Pro Light":15,"Source Sans Pro SemiBold":16,Stencil:18,Sylfaen:16,Symbol:16,Tahoma:17,"Tempus Sans ITC":21,"TH SarabunPSK":12,"Times New Roman":16,"Traditional Arabic":16,"Trebuchet MS":17,Tunga:17,"Tw Cen MT":18,"Tw Cen MT Condensed":12,"Tw Cen MT Condensed Extra Bold":16,"UD Digi Kyokasho N-B":16,"UD Digi Kyokasho NK-B":16,"UD Digi Kyokasho NK-R":16,"UD Digi Kyokasho NP-B":23,"UD Digi Kyokasho NP-R":16,"UD Digi Kyokasho N-R":16,Univers:16,"Univers Condensed":16,"Univers Condensed Light":14,"Univers Light":16,"Urdu Typesetting":16,Utsaah:13,Vani:20,Verdana:20,"Verdana Pro":20,"Verdana Pro Black":16,"Verdana Pro Cond":16,"Verdana Pro Cond Black":16,"Verdana Pro Cond Light":16,"Verdana Pro Cond SemiBold":16,"Verdana Pro Light":16,"Verdana Pro SemiBold":16,Vijaya:13,"Viner Hand ITC":22,Vivaldi:14,"Vladimir Script":15,Vrinda:18,Webdings:32,"Wide Latin":40,Wingdings:43,"Wingdings 2":36,"Wingdings 3":29,"Yet R":17,"Yu Gothic":18,"Yu Gothic Light":17,"Yu Gothic Medium":18,"Yu Gothic UI":17,"Yu Gothic UI Light":17,"Yu Gothic UI Semibold":18,"Yu Gothic UI Semilight":18,"Yu Mincho":17,"Yu Mincho Demibold":17,"Yu Mincho Light":16,"\u4eff\u5b8b":16,"\u534e\u6587\u4e2d\u5b8b":20,"\u534e\u6587\u4eff\u5b8b":15,"\u534e\u6587\u5b8b\u4f53":15,"\u534e\u6587\u5f69\u4e91":18,"\u534e\u6587\u65b0\u9b4f":19,"\u534e\u6587\u6977\u4f53":15,"\u534e\u6587\u7425\u73c0":18,"\u534e\u6587\u7ec6\u9ed1":18,"\u534e\u6587\u884c\u6977":16,"\u534e\u6587\u96b6\u4e66":14,"\u5b8b\u4f53":16,"\u5e7c\u5706":16,"\u5fae\u8f6f\u96c5\u9ed1":19,"\u5fae\u8f6f\u96c5\u9ed1 Light":18,"\u65b0\u5b8b\u4f53":16,"\u65b9\u6b63\u59da\u4f53":16,"\u65b9\u6b63\u8212\u4f53":18,"\u6977\u4f53":16,"\u7b49\u7ebf":17,"\u7b49\u7ebf Light":16,"\u96b6\u4e66":16,"\u9ed1\u4f53":16,"\u6e38\u30b4\u30b7\u30c3\u30af":18,"\uff2d\uff33 \uff30\u660e\u671d":16,'"\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"':16,"\u30e1\u30a4\u30ea\u30aa":20,"HG\uff7a\uff9e\uff7c\uff6f\uff78E":16,"HG\u660e\u671dB":16,"HG\uff7a\uff9e\uff7c\uff6f\uff78M":16}},b.unknownFontMaxDigitWidthMap={};function Sb(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}Ea=function(){function a(){}return a.pixelToPoint=function(a){return 72*a/96},a.pointToPixel=function(a){return Sb(96*a/72,2)},a.setMaxDigitWidth=function(c){var d,e,f,g,h,i,j,k,l=0;try{if(d=Ja("span"),d.style.font=c,e=d.style.fontSize,f=void 0,e.indexOf("px")!==-1?f=Math.round(a.pixelToPoint(parseFloat(e))):e.indexOf("pt")!==-1&&(f=Math.round(parseFloat(e))),!isNaN(f)&&f||(f=Math.round(a.pixelToPoint(parseFloat(c.match(/(\d|\.)+/)+"")))),g=d.style.fontFamily,g||c.split(" ").forEach(function(a){"normal"!==a&&"italic"!==a&&"bold"!==a&&a.indexOf("px")===-1&&a.indexOf("pt")===-1&&isNaN(+a)&&(g=a)}),b.unknownFontMaxDigitWidthMap[f]&&b.unknownFontMaxDigitWidthMap[f][g]?l=b.unknownFontMaxDigitWidthMap[f][g]:Da[f]&&Da[f][g]&&(l=Da[f][g]),l>0)return void(a.maxDigitWidth=l)}catch(a){}for(h="0123456789",i=0,j=jb(),j.font=c,k=0;k<h.length;k++)i=j.measureText(h.charAt(k)).width,i>l&&(l=i);return l>0&&(a.maxDigitWidth=l),a.maxDigitWidth},a.defaultColumnWidthToPixel=function(b){var c=2*Math.ceil(a.maxDigitWidth/4)+1,d=a.columnWidthToPixel(b)+c;return 8*Math.ceil(d/8)},a.columnWidthToPixel=function(b){return 0===b?0:Math.floor(Math.floor(256*b)/256*a.maxDigitWidth+.5)},a.pixelToColumnWidth=function(b){var c,d;return 0===b?0:(c=a.maxDigitWidth,d=Math.floor((b-5)/c*100+.5)/100,Math.floor((d*c+5)/c*256)/256)},a.maxDigitWidth=7,a}(),b.SJSColumnWidthHelper=Ea,Fa=function(){function a(){}return a.builtInNumberFomrat=function(){return a.dca||(a.dca={count:0}),0===a.dca.count&&a.initBuintNumberFormat(),a.dca},a.languageIndepedentNumberFormat=function(){return a.eca||(a.eca={count:0}),0===a.eca.count&&a.initLanguageIndepedentNumberFormat(),a.eca},a.formatCodeTable=function(){return a.fca||(a.fca=[]),a.fca},a.customNumberFormat=function(){return a.gca||(a.gca={count:0}),a.gca},a.getCultureInfo=function(){var a=Tb(),b=a&&a.GC&&a.GC.Spread&&a.GC.Spread.Common&&Tb().GC.Spread.Common.CultureManager.getCultureInfo();return b||Ga()},a.initBuintNumberFormat=function(){var b,c,d,e,f,g,i,j=a.dca;if(j[0]="General",j[1]="0",j[2]="0.00",j[3]="#,##0",j[4]="#,##0.00",j[9]="0%",j[10]="0.00%",j[11]="0.00E+00",j[12]="# ?/?",j[13]="# ??/??",j[14]="m/d/yyyy",j[15]="d-mmm-yy",j[16]="d-mmm",j[17]="mmm-yy",j[18]="h:mm AM/PM",j[19]="h:mm:ss AM/PM",j[20]="h:mm",j[21]="h:mm:ss",j[22]="m/d/yyyy h:mm",j[37]="#,##0 ;(#,##0)",j[38]="#,##0 ;[Red](#,##0)",j[39]="#,##0.00;(#,##0.00)",j[40]="#,##0.00;[Red](#,##0.00)",j[45]="mm:ss",j[46]="[h]:mm:ss",j[47]="mm:ss.0",j[48]="##0.0E+0",j[49]="@",j.count=49,Ga())if(b=Ga(),"zh-cn"===b)j[14]="yyyy/m/d",j[17]="mmm-yy",j[22]="yyyy/m/d h:mm",j[27]='yyyy"\u5e74"m"\u6708"',j[28]='m"\u6708"d"\u65e5"',j[29]='m"\u6708"d"\u65e5"',j[30]="m-d-yy",j[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',j[32]='h"\u65f6"mm"\u5206"',j[33]='h"\u65f6"mm"\u5206"ss"\u79d2"',j[34]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',j[35]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',j[36]='yyyy"\u5e74"m"\u6708"',j[39]="#,##0.00;-#,##0.00",j[40]="#,##0.00;[Red]-#,##0.00",j[50]='yyyy"\u5e74"m"\u6708"',j[51]='m"\u6708"d"\u65e5"',j[52]='yyyy"\u5e74"m"\u6708"',j[53]='m"\u6708"d"\u65e5"',j[54]='m"\u6708"d"\u65e5"',j[55]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',j[56]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',j[57]='yyyy"\u5e74"m"\u6708"',j[58]='m"\u6708"d"\u65e5"',j.count=58;else if("ja-jp"===b)j[14]="yyyy/m/d",j[15]="dd-mmm-yy",j[16]="dd-mmm",j[17]="mmm-yy",j[22]="yyyy/mm/dd h:mm",j[27]="[$-411]ge.m.d",j[28]='[$-411]ggge"\u5e74"m"\u6708"d"',j[29]='[$-411]ggge"\u5e74"m"\u6708"d"',j[30]="m/d/yy",j[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',j[32]='h"\u6642"mm"\u5206"',j[33]='h"\u6642"mm"\u5206"ss"\u79d2"',j[34]='yyyy"\u5e74"m"\u6708"',j[35]='m"\u6708"d"\u65e5"',j[36]="[$-411]ge.m.d",j[38]="#,##0;[Red]-#,##0",j[39]="#,##0.00;-#,##0.00",j[40]="#,##0.00;[Red]-#,##0.00",j[50]="[$-411]ge.m.d",j[51]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',j[52]='yyyy"\u5e74"m"\u6708"',j[53]='m"\u6708"d"\u65e5"',j[54]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',j[55]='yyyy"\u5e74"m"\u6708"',j[56]='m"\u6708"d"\u65e5"',j[57]="[$-411]ge.m.d",j[58]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',j.count=58;else{if(c=a.getCultureInfo(),d=c&&c.LocalNumberFormat,q(d)||Array.isArray(d)||"object"!=typeof d)return;for(e in d)isNaN(+e)||(f=d[e],h.Util._aK(f)&&(j[e]=d[e]));g=0;for(e in j)isNaN(+e)||(i=+e,i>g&&(g=i));j.count=g}},a.initLanguageIndepedentNumberFormat=function(){var b=a.eca;b[27]="m/d/yyyy",b[28]="m/d/yyyy",b[29]="m/d/yyyy",b[30]="m/d/yyyy",b[31]="m/d/yyyy",b[32]="h:mm:ss",b[33]="h:mm:ss",b[34]="m/d/yyyy",b[35]="m/d/yyyy",b[36]="m/d/yyyy",b[50]="m/d/yyyy",b[51]="m/d/yyyy",b[52]="m/d/yyyy",b[53]="m/d/yyyy",b[54]="m/d/yyyy",b[55]="m/d/yyyy",b[56]="m/d/yyyy",b[57]="m/d/yyyy",b[58]="m/d/yyyy"},a.getFormatCode=function(b){var c,d,e,f=a.builtInNumberFomrat(),g=a.customNumberFormat(),h=a.languageIndepedentNumberFormat(),i=b.numberFormatIndex;return b.numberFormat?(c=b.numberFormat,d=c.numberFormatId,e=c.numberFormatCode,f[d]&&f[d]!==e?(f[d]=e,e):(g[e]||(g[e]=d,g.count++),e)):f[i]?f[i]:h[i]?h[i]:"General"},a.getFormatId=function(b){var c,d,e,f,g,h,i,j=a._ka();if(j[b])return j[b];if(d=a.builtInNumberFomrat())for(e in d)if(d[e]===b)return c={isBuiltIn:!0,id:parseInt(e,10)},j[b]=c,c;if(f=a.customNumberFormat(),f&&f[b])return c={isBuiltIn:!1,id:f[b]},j[b]=c,c;if(g=0,f.count>0){h=0;for(i in f)f[i]>h&&(h=f[i]);g=h}return g=Math.max(a.hca,g)+1,a.hca++,f[b]=g,c={isBuiltIn:!1,id:g}},a._ka=function(){return a.ala||(a.ala={}),a.ala},a.fca=null,a.ala=null,a.dca={count:0},a.eca={count:0},a.gca={count:0},a.hca=170,a}(),b.ExtendedNumberFormatHelper=Fa;function Tb(){var a,b,c,d,e=this;try{b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},c="object"===("undefined"==typeof global?"undefined":b(global))&&global&&global.Object===Object&&global,d="object"===("undefined"==typeof self?"undefined":b(self))&&self&&self.Object===Object&&self,a=c||d||function(){return e}()}catch(a){}return a}Ga=function(){var a=Tb();return a&&a.gcCultureObj},Ha=function(){function a(a,b){this.numberFormatId=a,this.numberFormatCode=b}return a.prototype.equals=function(a){var b=this;return b===a||!!a&&(b.numberFormatId===a.numberFormatId&&b.numberFormatCode===a.numberFormatCode)},a.prototype.compose=function(a){var b=this;b.numberFormatId===D&&(b.numberFormatId=a.numberFormatId),b.numberFormatCode===D&&(b.numberFormatCode=a.numberFormatCode)},a.prototype.clone=function(){var b=this;return new a(b.numberFormatId,b.numberFormatCode)},a}(),b.ExcelNumerFormat=Ha},"./dist/core/util/domUtil.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=d.Common.j,f=d.Common.D,g=void 0,h=null,i=parseFloat,j=document,k="_nonamespace",l="events",m="get",n="set",o="width",p="height",q="left",r="right",s="top",t="bottom",u="hidden",v="block",w="none",x="position",y="visibility",z="display",A={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},B={tabIndex:{get:function(a){var b=a.getAttributeNode("tabindex"),c=/^(?:input|select|textarea|button|object)$/i,d=/^(?:a|area)$/i,e=a.nodeName;return b&&b.specified?parseInt(b.value,10):c.test(e)||d.test(e)&&a.href?0:g}}},C={option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||e<0,g=f?h:[],i=f?e+1:d.length,j=f?e:0;for(e<0&&(j=i);j<i;j++)if(c=d[j],(c.selected||j===e)&&!c.disabled&&(!c.parentNode.disabled||!O(c.parentNode,"optgroup"))){if(b=H(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c=H.makeArray(b),d=H(a).find("option").getAll();return d.forEach(function(a){a.selected=H.inArray(H(a).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},D={},E="$"+(""+Math.random()).replace(/\D/g,""),F=1,G={},[p,o].forEach(function(a){G[a]={get:function(b){var c,d,e,f=getComputedStyle(b),g=b.style,h=g[x],i=g[y],k=g[z],l=0===b.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(f[z]);if(l&&(g[x]="absolute",g[y]=u,g[z]=v),c=f&&f[a],l&&(g[x]=h,g[y]=i,g[z]=k),""===c){for(d=b.parentElement,e=j.body;d&&d!==e;)d=d.parentElement;d!==e&&(c=g[a])}return c}}});function K(a,b){var c,d;for(Array.call(this),"string"==typeof a?c=(b||j).querySelectorAll(a):a&&(c=e.Ca(a)||a instanceof HTMLCollection?a:[a]),d=0;c&&d<c.length;d++)this.push(c[d])}H=function(a,b){return a instanceof K?a:new K(a,b)},b.GC$=H,I={get:function(a){return this[a]},getAll:function(){return this},bind:function(a,b,c){var d=this;return Z(c)&&(c=b,b=g),d.forEach(function(d){var e,f,h,i,j,m,n=T(d,l,g,!0);n||(n={},T(d,l,n,!0)),e=a.split("."),f=e[0],h=e[1]||k,i=n[h],i||(i=n[h]={}),j=function(a){Z(b)||(a.data=b);var e=c.apply(d,arguments);a.result=e,e===!1&&(a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!1,a.returnValue=!1))},j.original=c,m=i[f],m||(m=i[f]=[]),m.push(j),d.addEventListener(f,j)}),d},unbind:function(a,b){var c=this;return c.forEach(function(c){var d,e,h,i,j=a.split("."),m=j[0],n=j[1]||k,o=T(c,l,g,!0),p=o&&o[n];if(b){if(p&&m&&(d=p[m]))for(h=d.length,e=0;e<h;e++)if(d[e].original===b){da(c,m,d[e]),d.splice(e,1);break}}else if(p)if(m){if(d=p[m])for(h=d.length,e=0;e<h;e++)da(c,m,d[e]);p[m]=g}else{for(i in p)if(f(p,i)&&(d=p[i]))for(h=d.length,e=0;e<h;e++)da(c,i,d[e]);o[n]=g}}),c},trigger:function(a,b){var c,d,e,h,i,j,k,m,n,o,p,q=this;for(c=0,d=q.length;c<d;c++)if(e=q[c],h=T(e,l,g,!0)){i=a.split("."),j=i[0];for(k in h)if(f(h,k)&&(m=h[k],n=m&&m[j]))for(o=0,p=n.length;o<p;o++)n[o].apply(e,[{type:j},b])}return q},css:function(a,b){var c,d,e,g=this,h=g,i=arguments.length;function j(a,b){h.forEach(function(c){c.style[a]=P(a,b)})}if(1===i){if(!Y(a))return c=g[0],d=G[a],d&&m in d?d.get(c):(e=getComputedStyle(c),e&&e[a]);h.forEach(function(b){for(var c in a)f(a,c)&&(b.style[c]=P(c,a[c]))})}else 2===i&&(Array.isArray(a)&&Array.isArray(b)&&a.length===b.length?a.forEach(function(a,c){j(a,b[c])}):j(a,b));return g},width:$(!0),height:$(),innerWidth:_(!0),innerHeight:_(),outerWidth:aa(!0),outerHeight:aa(),append:function(a){var b,c,d=[a];return a instanceof H&&(d=a.getAll()),b=this,c=b[0],d.forEach(function(a){a&&c.appendChild(a)}),b},appendTo:function(a){var b,c=a;return a instanceof H&&(c=a[0]),b=this,b.forEach(function(a){c.appendChild(a)}),b},prepend:function(a){var b=this,c=b[0];return c.insertBefore(a,c.firstChild),b},insertBefore:function(a){var b=this,c=a.parentElement;return b.forEach(function(b){c.insertBefore(b,a)}),b},addClass:function(a){var b,c,d,e,f,g=0,h=this,i=h.length,j=/\S+/g,k=/[\t\r\n]/g;for(b=(a||"").match(j)||[];g<i;g++)if(c=h[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(k," "):" ")){for(f=0,e=b[f];e;)d.indexOf(" "+e+" ")<0&&(d+=e+" "),f++,e=b[f];c.className=H.trim(d)}return this},removeClass:function(a){var b,c,d,e,f,g=0,h=this,i=h.length,j=/\S+/g,k=/[\t\r\n]/g;for(b=(a||"").match(j)||[];g<i;g++)if(c=h[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(k," "):"")){for(f=0,e=b[f];e;){for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");f++,e=b[f]}c.className=a?H.trim(d):""}return this},hasClass:function(a){var b,c=0,d=this,e=d.length,f=/[\t\r\n]/g;for(a=" "+a+" ";c<e;c++)if(b=d[c],1===b.nodeType&&(" "+b.className+" ").replace(f," ").indexOf(a)>=0)return!0;return!1},toggle:function(){var a=this,b=a[0];return b.style[z]===w?a.show():a.hide(),a},show:ba(!0),hide:ba(),attr:function(a,b){var c=this,d=c,e=arguments.length;if(1===e){if(!Y(a))return c[0].getAttribute(a);d.forEach(function(b){for(var c in a)f(a,c)&&b.setAttribute(c,a[c])})}else 2===e&&d.forEach(function(c){c.setAttribute(a,b)});return c},removeAttr:function(a){return this.forEach(function(b){b.removeAttribute(a)}),this},prop:function(a,b){var c=this,d=c,e=arguments.length;if(1===e){if(!Y(a))return Q(c[0],a);d.forEach(function(b){for(var c in a)f(a,c)&&Q(b,c,a[c])})}else 2===e&&d.forEach(function(c){Q(c,a,b)});return c},removeProp:function(a){a=A[a]||a;var b=this,c=b;return c.forEach(function(b){try{b[a]=g,delete b[a]}catch(a){}}),b},text:function(a){var b=this,c=b;return 0===arguments.length?b[0].textContent:(c.forEach(function(b){b.textContent=a}),b)},val:function(a){var b,c,d,e,f=this;{if(arguments.length)return e=H.isFunction(a),f.forEach(function(c,d){var f;1===c.nodeType&&(f=e?a.call(c,d,H(c).val()):a,f===h||f===g?f="":"number"==typeof f?f+="":H.isArray(f)&&(f=H.map(f,function(a){return a===h||a===g?"":a+""})),b=C[c.type]||C[c.nodeName.toLowerCase()],b&&n in b&&!Z(b.set(c,f,"value"))||(c.value=f))}),f;if(c=f[0],d=void 0,c)return b=C[c.type]||C[c.nodeName.toLowerCase()],b&&m in b&&(d=b.get(c,"value"),!Z(d))?d:(d=c.value,X(d)?d.replace(/\r/g,""):d===h||d===g?"":d)}},position:function(){var a,b,c,d,e=this[0];if(e){if(a={top:0,left:0},b={top:0,left:0},"fixed"===H(e).css(x))try{a=e.getBoundingClientRect()}catch(a){}else c=this.offsetParent(),a=this.offset(),d=c[0],O(d,"html")||(b=c.offset(),b.left-=d.scrollLeft,b.top-=d.scrollTop),b.top+=i(H(d).css("borderTopWidth")),b.left+=i(H(d).css("borderLeftWidth"));return{top:a.top-b.top-i(H(e).css("marginTop")),left:a.left-b.left-i(H(e).css("marginLeft"))}}},offsetParent:function(){var a=H.map(this,function(a){for(var b=j.documentElement,c=a.offsetParent||b;c&&!O(c,"html")&&"static"===H(c).css(x);)c=c.offsetParent;return c||b});return H(a)},offset:function(){var a,b,c={top:0,left:0},d=this[0],e=d&&d.ownerDocument;if(e){if(a=e.documentElement,!Z(d.getBoundingClientRect))try{c=d.getBoundingClientRect()}catch(a){}return b=N(e),{top:c.top+(b.pageYOffset||a.scrollTop)-(a.clientTop||0),left:c.left+(b.pageXOffset||a.scrollLeft)-(a.clientLeft||0)}}},scrollLeft:ca(!0),scrollTop:ca(),html:function(a){var b=this,c=b;return 0===arguments.length?b[0].innerHTML:(c.forEach(function(b){b.innerHTML=a}),b)},remove:function(){var a=this;a.forEach(function(a){var b=a.parentElement;b&&(b.removeChild(a),W([a]))})},empty:function(){return this.forEach(function(a){H(a.children).remove()}),this},find:function(a){var b=[];return X(a)&&this.forEach(function(c){var d=c.querySelectorAll(a);H.merge(b,d)}),H(b)},parent:function(){var a=[];return this.forEach(function(b){var c=b.parentElement;c&&a.push(c)}),H(a)},index:function(a){var b=this[0];return a?X(a)?H.inArray(b,H(a).getAll()):H.inArray(a,this):b&&b.parentElement?H.inArray(b,b.parentElement.children):-1},focus:function(){var a=this,b=a[0];return b!==j.activeElement&&b.focus&&b.focus(),a},isVisible:function(){var a=0;return this.forEach(function(b){var c=getComputedStyle(b);c[y]!==u&&c[z]!==w&&a++}),a>0},data:function(a,b){var c=this,d=Z(b);return d&&(c=void 0),H.each(this,function(e,f){var g=T(f,a,b);if(d)return c=g,!1}),c},removeData:function(a){return H.each(this,function(b,c){V(c,a)}),this}},J=K.prototype=[],e.Ia(J,I),H.prototype=J,H.each=e.H,H.isEmptyObject=e.za,H.isFunction=e.Aa,H.isArray=e.Ca,H.isNumeric=e.Da,H.getType=e.Ba,H.inArray=e.Ea,H.merge=e.Ga,H.map=e.Ha,H.extend=e.Ia,H.inherit=e.G,H.isPlainObject=e.Ja,H.isArraylike=e.ya,H.isWindow=e.Ka,H.makeArray=e.La,H.trim=function(a){if(a.trim)return a.trim();var b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;return a===h||a===g?"":(a+"").replace(b,"")},H.Nl=function(a,b,c,d,e){var f=H(j.createElement(a));return b&&c&&f.css(b,c),d&&f.addClass(d),e&&(e instanceof H?e.append(f):H(e).append(f)),f};function L(a){for(var b,c=M(a);a.parentElement;)a=a.parentElement,b=M(a),b>c&&(c=b);return c}b.getHostMaxZIndex=L;function M(a){var b=getComputedStyle(a).zIndex;return"auto"===b||""===b?0:+b}function N(a){return H.isWindow(a)?a:9===a.nodeType&&(a.defaultView||a.parentWindow)}function O(a,b){var c=a.nodeName;return c&&c.toLowerCase()===b.toLowerCase()}function P(a,b){return"top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(a)>=0&&isFinite(b)?("width height".split(" ").indexOf(a)>=0&&b<0&&(b=0),b+"px"):b}function Q(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g,f&&(b=A[b]||b,e=B[b]),Z(c)?e&&m in e&&(d=e.get(a,b),d!==h)?d:a[b]:e&&n in e&&(d=e.set(a,c,b),!Z(d))?d:(a[b]=c,c)}function R(a){var b,c,d,e=a.nodeType;return(!e||1===e||9===e)&&(b={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},c=a.nodeName,d=c&&b[c.toLowerCase()],!d||d!==!0&&a.getAttribute("classid")===d)}function S(a){return a.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(a,b){return b.toUpperCase()})}function T(a,b,c,d){if(R(a)){var e,f,i=E,j=X(b),k=a.nodeType,l=k?D:a,m=k?a[i]:a[i]&&i;if(m&&l[m]&&(d||l[m].data)||!j||!Z(c))return m||(k?(a[i]=m=F,F++):m=i),l[m]||(l[m]={},k||(l[m].toJSON=function(){})),(Y(b)||"function"==typeof b)&&(d?l[m]=H.extend(l[m],b):l[m].data=H.extend(l[m].data,b)),e=l[m],d||(e.data||(e.data={}),e=e.data),Z(c)||(e[S(b)]=c),j?(f=e[b],f!==h&&f!==g||(f=e[S(b)])):f=e,f}}function U(a){var b;for(b in a)if(("data"!==b||!H.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function V(a,b,c){if(R(a)){var d,e,f,g=a.nodeType,i=g?D:a,j=g?a[E]:E;if(i[j]){if(b&&(f=c?i[j]:i[j].data)){H.isArray(b)?b=b.concat(H.map(b,S)):b in f?b=[b]:(b=S(b),b=b in f?[b]:b.split(" ")),e=b.length;for(d=0;d<e;d++)delete f[b[d]];if(!(c?U:H.isEmptyObject)(f))return}(c||(delete i[j].data,U(i[j])))&&(g?W([a],!0):i!==i.window?delete i[j]:i[j]=h)}}}function W(a,b){for(var c,d,e,g,i,j,k,l,m,n=0,o=E,p=D,q=a[n];q!==h&&void 0!==q;){if((b||R(q))&&(c=q[o],d=c&&p[c])){if(e=d.events)for(g in e)if(f(e,g)&&(i=e[g]))for(j in i)if(f(i,j)&&(k=i[j]))for(l=0,m=k.length;l<m;l++)da(q,g,k[l]);p[c]&&(delete p[c],delete q[o])}n++,q=a[n]}}function X(a){return"string"==typeof a}function Y(a){return"object"==typeof a}function Z(a){return typeof a==typeof g}function $(a){var b=a;return function(a){var c,d=this,e="border-box"===d.css("box-sizing"),f=b?o:p,g=b?q:s,h=b?r:t;return 0===arguments.length?(c=Math.round(i(d.css(f)))||0,e&&(c-=i(d.css("padding-"+g))+i(d.css("padding-"+h))+i(d.css("border-"+g+"-"+o))+i(d.css("border-"+h+"-"+o))),c):(d.css(f,a),d)}}function _(a){var b=a;return function(){var a=this,c=b?q:s,d=b?r:t;return b?a.width():a.height()+i(a.css("padding-"+c))+i(a.css("padding-"+d))}}function aa(a){var b=a;return function(a){var c=b?q:s,d=b?r:t,e=this,f=b?e.innerWidth():e.innerHeight();return f+=i(e.css("border-"+c+"-"+o))+i(e.css("border-"+d+"-"+o)),a&&(f+=i(e.css("margin-"+c))+i(e.css("margin-"+d))),f}}function ba(a){var b=a;return function(a){return this.forEach(function(c){c.style[z]=b?v:w,a&&a.apply(c)}),this}}function ca(a){var b=a;return function(a){var c="scrollLeft",d="scrollTop",e=b?c:d,f=b?"pageXOffset":"pageYOffset",g=this,h=g[0],i=N(h);return Z(a)?i?f in i?i[f]:j.documentElement[e]:h[e]:(i?i.scrollTo(b?a:H(i)[c](),b?H(i)[d]():a):h[e]=a,g)}}function da(a,b,c){a.removeEventListener(b,c)}},"./dist/core/util/imageLoader.js":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/domUtil.js"),e=d.GC$,f=".gcSheet",g=function(){function a(a){this.bo=0,this.co=0,this.eo={};var b=this;b.do=a}return a.prototype.fo=function(a,b){var c,d,g,h=this;function i(){h.ho(a,!0)}function j(){h.ho(a,!1)}c=h.eo,d=c[a],d||(g=e(document.createElement("img")),b&&g.attr("crossOrigin",b),g.bind("load"+f,i),g.bind("error"+f,j),g.bind("abort"+f,j),h.bo++,c[a]={io:!1,jo:g[0],BHb:!1},g[0].src=a)},a.prototype.ko=function(a){var b=this.eo[a];return!!b&&b.io},a.prototype.CHb=function(a){var b=this.eo[a];return!!b&&b.BHb},a.prototype.lo=function(a){var b=this.eo[a];return b?b.jo:null},a.prototype.ho=function(a,b){var c=this;c.co++,c.eo[a].io=!0,c.eo[a].BHb=b,c.mo()&&c.do&&c.do()},a.prototype.mo=function(){return this.co>=this.bo},a.prototype.no=function(){var a,b,c=this.eo;if(c)for(a in c)c[a]&&(b=e(c[a].jo),b.unbind(f));this.do=null},a}(),b.oo=g},"./dist/core/util/styleManager.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/common.js"),e=c("./dist/core/celltype/celltype.ns.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/style.js"),h=c("./node_modules/util/util.js"),i=c("./dist/core/util/common.js"),j=c("./dist/core/excel-io-util/common.js"),k=c("./dist/core/excel-io-util/excel-style.js"),l=c("Common"),m=c("./dist/core/util/domUtil.js"),n=void 0,o=null,p=j.NodeHelper.oca,q=m.GC$.each,r=l.Common.j.C4,s=j.Util.NZa,t=j.Util.c$a,u=j.Util.$aK,v=d.Ul.lHb,w=function(){function a(a){var b=this;this.$cK=[],this.Ha={},a&&a.forEach(function(a){b.getTextIndex(a)})}return a.prototype.dispose=function(){this.$cK=n,this.Ha=n},a.prototype.getTextIndex=function(a){var b;return this.Ha[a]===n&&(b=this.$cK.push(a)-1,this.Ha[a]=b),this.Ha[a]},a.prototype.getText=function(a){return this.$cK[a]},a.prototype.setTextIndex=function(a,b){this.$cK[b]=a,this.Ha[a]=b},a.prototype.replaceText=function(a,b){this.$cK[a]=b},a.prototype.getCount=function(){return this.$cK.length},a.prototype.cdK=function(a){var b,c,d=this,e=d.Ha;if(a)for(d.$cK=a,b=0,c=a.length;b<c;b++)e[a[b]]=""+b},a.prototype.bdK=function(){return this.$cK},a}(),b.SimpleSharedStrings=w,x=function(){function a(){this.$cK=[]}return a.prototype.dispose=function(){this.$cK=n},a.prototype.getObjectIndex=function(a){var b=this,c=b.$cK,d=0,e=c.length,f;if(a.toJSON?f=a.toJSON():!h.isNullOrUndefined(a)&&a instanceof Object&&(f=JSON.stringify(a)),f){for(;d<e;d++)if(c[d]===f)return d;return c[d]=f,d}},a.prototype.getObject=function(a){return this.$cK[a]},a.prototype.cdK=function(a){this.$cK=a},a.prototype.bdK=function(){return this.$cK},a}();function G(a){return a?1:0}function H(a,b){var c,d;return a?(c="{",h.isNullOrUndefined(a.style)||(d=a.style,"string"==typeof d&&(d='"'+k.ExcelBorderStyle[d]+'"'),"object"!=typeof d&&(c+='"s":'+d+",")),h.isNullOrUndefined(a.color)||(c+='"c":'+b.getTextIndex(a.color)+","),c.substring(0,c.length-1)+"}"):""}function I(a,b){var c,d;if(a)return c=new g.LineBorder,d=JSON.parse(a),h.isNullOrUndefined(d.s)||(c.style=+d.s),h.isNullOrUndefined(d.c)||(c.color=b.getText(+d.c)),c}function J(){var a=t(),b=a&&a.GC&&a.GC.Spread&&a.GC.Spread.Common&&t().GC.Spread.Common.CultureManager.getCultureInfo();return b||u()}y=function(){function a(a,b){var c=this;c._cK=[],c.adK=new w(b),c.$kb=a}return a.prototype.dispose=function(){var a=this;a.adK&&(a.adK.dispose(),
a.adK=n),a._cK=n,a.$kb=n},a.prototype.bGJ=function(a){var b,c,d,e,f,g,h=this,j=h.$kb;return a.backColor===o?h.adK.getTextIndex('{"t":0}'):a.backColor!==n?(c=a.backColor,d=c,e=c,f=c,"object"==typeof c?(b="{",e.stops?(b+='"s":[',g=e.stops,g.forEach(function(a){b+='{"p":'+a.position+',"c":'+j.getTextIndex(a.color)+"},"}),b=b.substring(0,b.length-1),b+="],","path"===f.type?(b+='"t":"p"',i.isDefined(f.left)&&(b+=',"l":'+f.left),i.isDefined(f.right)&&(b+=',"r":'+f.right),i.isDefined(f.top)&&(b+=',"a":'+f.top),i.isDefined(f.bottom)&&(b+=',"c":'+f.bottom)):b+='"d":'+(e.degree?e.degree:0)):d.type!==n&&(b+='"t":'+d.type,i.isDefined(d.patternColor)&&""!==d.patternColor&&(b+=',"p":'+j.getTextIndex(d.patternColor)),i.isDefined(d.backgroundColor)&&""!==d.backgroundColor&&(b+=',"b":'+j.getTextIndex(d.backgroundColor))),b+="}"):b=""===c?'{"t":0}':j.getTextIndex(c),h.adK.getTextIndex(b)):void 0},a.prototype.NR=function(a,b){var c,d,e,f,g,i,j=this,k=j.$kb,l=j._cK;return l[a]?l[a]:(d=j.adK.getText(+a),"string"==typeof d&&"{"===d[0]?(e=JSON.parse(d),f=e.s,c={},0===e.t?o:(f&&f.length>0?(g=c.stops=[],f.forEach(function(a){var b={};h.isNullOrUndefined(a.p)||(b.position=a.p),h.isNullOrUndefined(a.c)||(b.color=k.getText(a.c)),g.push(b)}),"p"===e.t?(c.type="path",h.isNullOrUndefined(e.l)||(c.left=e.l),h.isNullOrUndefined(e.r)||(c.right=e.r),h.isNullOrUndefined(e.a)||(c.top=e.a),h.isNullOrUndefined(e.c)||(c.bottom=e.c)):h.isNullOrUndefined(e.d)||(c.degree=e.d)):h.isNullOrUndefined(e.t)?h.isNullOrUndefined(e.b)||(c=k.getText(e.b)):(i=e.t,1===i?b||h.isNullOrUndefined(e.p)?h.isNullOrUndefined(e.b)||(c=k.getText(e.b)):c=k.getText(e.p):(c.type=i,h.isNullOrUndefined(e.p)||(c.patternColor=k.getText(e.p)),h.isNullOrUndefined(e.b)||(c.backgroundColor=k.getText(e.b)))),c=m.GC$.isEmptyObject(c)?n:c,l[a]=c,c)):(c=k.getText(d),c=m.GC$.isEmptyObject(c)?n:c,l[a]=c,c))},a.prototype.ulK=function(a){a.fills=this.adK.bdK()},a.prototype.vlK=function(a){this.adK.cdK(a.fills)},a}(),z=function(){function a(a,b){var c=this;c.ddK=[],c.edK=new w,c.fdK=new w,c.$kb=a,c.gdK=b}return a.prototype.dispose=function(){var a=this;a.edK&&(a.edK.dispose(),a.edK=n),a.fdK&&(a.fdK.dispose(),a.fdK=n),a.ddK=n,a.$kb=n,a.gdK=n},a.prototype.bGJ=function(a){var b,c=this;if(!(h.isNullOrUndefined(a.font)&&h.isNullOrUndefined(a.vertAlign)&&h.isNullOrUndefined(a.textDecoration)&&a.foreColor===n&&h.isNullOrUndefined(a.themeFont)))return b="",h.isNullOrUndefined(a.font)||(b+="f:"+c.fdK.getTextIndex(a.font)+","),h.isNullOrUndefined(a.vertAlign)||(b+="v:"+a.vertAlign+","),h.isNullOrUndefined(a.textDecoration)||(b+="d:"+a.textDecoration+","),a.foreColor!==n&&(b+="c:"+c.$kb.getTextIndex(a.foreColor)+","),h.isNullOrUndefined(a.themeFont)||(b+="t:"+c.gdK.getTextIndex(a.themeFont)+","),c.edK.getTextIndex(b.substring(0,b.length-1))},a.prototype.NR=function(a){var b,c,d=this,e=d.$kb,f=d.ddK;return f[a]?f[a]:(b=d.edK.getText(+a))?(c={},b.split(",").forEach(function(a){var b=a.split(":"),f=b[0],g=b[1];switch(f){case"f":c.font=d.fdK.getText(+g);break;case"v":c.vertAlign=+g;break;case"d":c.textDecoration=+g;break;case"c":c.foreColor=e.getText(+g);break;case"t":c.themeFont=d.gdK.getText(+g)}}),f[a]=c,c):void 0},a.prototype.ulK=function(a){var b=this;a.fonts=b.edK.bdK(),a.htmlFonts=b.fdK.bdK()},a.prototype.vlK=function(a){var b=this;b.edK.cdK(a.fonts),b.fdK.cdK(a.htmlFonts)},a}(),A=function(){function a(a){var b=this;b.hdK=[],b.idK=[],b.jdK=new w,b.kdK=new w,b.$kb=a,b.jdK.getTextIndex('{"s":0}'),b.kdK.getTextIndex("l:0,r:0,t:0,b:0")}return a.prototype.dispose=function(){var a=this;a.jdK&&(a.jdK.dispose(),a.jdK=n),a.kdK&&(a.kdK.dispose(),a.kdK=n),a.hdK=n,a.idK=n,a.$kb=n},a.prototype.bGJ=function(a){var b,c=this,d=c.$kb;if(!(h.isNullOrUndefined(a.borderLeft)&&h.isNullOrUndefined(a.borderTop)&&h.isNullOrUndefined(a.borderRight)&&h.isNullOrUndefined(a.borderBottom)&&h.isNullOrUndefined(a.borderVertical)&&h.isNullOrUndefined(a.borderHorizontal)&&h.isNullOrUndefined(a.diagonalDown)&&h.isNullOrUndefined(a.diagonalUp)))return b="",h.isNullOrUndefined(a.borderLeft)||(b+="l:"+c.jdK.getTextIndex(H(a.borderLeft,d))+","),h.isNullOrUndefined(a.borderRight)||(b+="r:"+c.jdK.getTextIndex(H(a.borderRight,d))+","),h.isNullOrUndefined(a.borderTop)||(b+="t:"+c.jdK.getTextIndex(H(a.borderTop,d))+","),h.isNullOrUndefined(a.borderBottom)||(b+="b:"+c.jdK.getTextIndex(H(a.borderBottom,d))+","),h.isNullOrUndefined(a.borderVertical)||(b+="v:"+c.jdK.getTextIndex(H(a.borderVertical,d))+","),h.isNullOrUndefined(a.borderHorizontal)||(b+="h:"+c.jdK.getTextIndex(H(a.borderHorizontal,d))+","),h.isNullOrUndefined(a.diagonalUp)||(b+="u:"+c.jdK.getTextIndex(H(a.diagonalUp,d))+","),h.isNullOrUndefined(a.diagonalDown)||(b+="d:"+c.jdK.getTextIndex(H(a.diagonalDown,d))+","),c.kdK.getTextIndex(b.substring(0,b.length-1))},a.prototype.ldK=function(a){var b,c,d,e,f=this,g=f.idK;return g[a]?g[a]:(b=f.jdK,c=f.$kb,d=b.getText(+a),e=void 0,e='{"s":0}'===d?o:I(d,c),g[a]=e,e)},a.prototype.NR=function(a){var b,c,d=this,e=d.hdK;if(e[a])return e[a];if(b=d.kdK.getText(a),c={},b)return b.split(",").forEach(function(a){var b=a.split(":"),e=b[0],f=b[1];switch(e){case"l":c.borderLeft=d.ldK(f);break;case"r":c.borderRight=d.ldK(f);break;case"t":c.borderTop=d.ldK(f);break;case"b":c.borderBottom=d.ldK(f);break;case"v":c.borderVertical=d.ldK(f);break;case"h":c.borderHorizontal=d.ldK(f);break;case"u":c.diagonalUp=d.ldK(f);break;case"d":c.diagonalDown=d.ldK(f)}}),e[a]=c,c},a.prototype.ulK=function(a){var b=this;a.borderItems=b.jdK.bdK(),a.borders=b.kdK.bdK()},a.prototype.vlK=function(a){var b=this;b.kdK.cdK(a.borders),b.jdK.cdK(a.borderItems)},a}(),B=function(){function a(b,c){var d=this;d.hca=170,d.mdK=[],d.ndK=new w,d.odK=new w,d.pdK={},d.gdK=b,d.IdK=c,d.FlK={},a.initBuiltNumberFormat(),Object.keys(a.qdK).forEach(function(b){"count"!==b&&(a.rdK[a.qdK[b]]=b)}),a.initLanguageIndependentNumberFormat(),Object.keys(a.sdK).forEach(function(b){"count"!==b&&(a.rdK[a.sdK[b]]=b)})}return a.prototype.dispose=function(){var a=this;a.ndK&&(a.ndK.dispose(),a.ndK=n),a.odK&&(a.odK.dispose(),a.odK=n),a.mdK=n,a.pdK=n},a.prototype.bGJ=function(a){var b,c,d=this,e="",f=a._autoFormatter,g=a.formatter;if(!h.isNullOrUndefined(f)){if(b=d.tdK(f),!b)return;d.pdK[b.c]!==n?e+="a:"+d.pdK[b.c]+",":(c=d.odK.getTextIndex(JSON.stringify(b)),d.pdK[b.c]=c,e+="a:"+c+",")}if(!h.isNullOrUndefined(g)&&!v(g)){if(b=d.tdK(g),!b)return;d.pdK[b.c]!==n?e+="f:"+d.pdK[b.c]+",":(c=d.odK.getTextIndex(JSON.stringify(b)),d.pdK[b.c]=c,e+="f:"+c+",")}if(e)return d.ndK.getTextIndex(e.substring(0,e.length-1))},a.prototype.NR=function(a){var b,c,d=this,e=d.mdK;return e[a]?e[a]:(b=d.ndK.getText(a),c={},b.split(",").forEach(function(a){var b,e,f,g=a.split(":"),h=g[0],i=g[1];"a"===h?(b=d.fromSJSFormatString(d.odK.getText(+i)),e=l.Formatter,f=e&&e.GeneralFormatter,f&&(c._autoFormatter=new f(b.formatCached,b.customerCultureName),c._autoFormatter.isAuto=!0)):"f"===h&&(c.formatter=d.fromSJSFormatString(d.odK.getText(+i)))}),e[a]=c,c)},a.prototype.GlK=function(a){var b=this,c=b.FlK;return c[a]?c[a]:b.ljK(a)},a.prototype.ljK=function(b){if(b!==n){if(a.qdK[b]!==n)return a.qdK[b];if(a.sdK[b]!==n)return a.sdK[b]}},a.prototype.fromSJSFormatString=function(a){var b,c,d=this,e=d.FlK,g=JSON.parse(a),i=g.n,j=g.c;return h.isNullOrUndefined(g.json)||(j=JSON.parse(d.IdK.getObject(g.json))),"string"==typeof j?(e[i]=j,j):j&&!h.isNullOrUndefined(j.typeName)&&(b=f.getTypeFromString(j.typeName))?(c=new b,c.fromJSON(j),e[i]=c,c):(j=d.ljK(i)||j,e[i]=j,j)},a.prototype.tdK=function(b){var c,d,e=this,f=b;if("object"==typeof f&&(f.toJSON&&(c=f.toJSON()),f.formatCached?f=f.formatCached:c&&(f=JSON.stringify(c))),f)return d=a.rdK[f],d===n&&this.pdK[f]===n&&(d=this.hca,this.hca++),{n:d,c:f,json:c&&e.IdK.getObjectIndex(c)}},a.prototype.ulK=function(a){var b=this;a.numFmts=b.ndK.bdK(),a.formatStrings=b.odK.bdK()},a.prototype.vlK=function(a){var b,c,d=this;if(d.ndK.cdK(a.numFmts),d.odK.cdK(a.formatStrings),a.numFmts&&a.numFmts.length>0)for(b=0,c=a.numFmts.length;b<c;b++)d.NR(b)},a.initBuiltNumberFormat=function(){var b,c,d,e,f,g,i,k=a.qdK;if(k[0]="General",k[1]="0",k[2]="0.00",k[3]="#,##0",k[4]="#,##0.00",k[9]="0%",k[10]="0.00%",k[11]="0.00E+00",k[12]="# ?/?",k[13]="# ??/??",k[14]="m/d/yyyy",k[15]="d-mmm-yy",k[16]="d-mmm",k[17]="mmm-yy",k[18]="h:mm AM/PM",k[19]="h:mm:ss AM/PM",k[20]="h:mm",k[21]="h:mm:ss",k[22]="m/d/yyyy h:mm",k[37]="#,##0 ;(#,##0)",k[38]="#,##0 ;[Red](#,##0)",k[39]="#,##0.00;(#,##0.00)",k[40]="#,##0.00;[Red](#,##0.00)",k[45]="mm:ss",k[46]="[h]:mm:ss",k[47]="mm:ss.0",k[48]="##0.0E+0",k[49]="@",k.count=49,s())if(b=s(),"zh-cn"===b)k[14]="yyyy/m/d",k[17]="mmm-yy",k[22]="yyyy/m/d h:mm",k[27]='yyyy"\u5e74"m"\u6708"',k[28]='m"\u6708"d"\u65e5"',k[29]='m"\u6708"d"\u65e5"',k[30]="m-d-yy",k[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',k[32]='h"\u65f6"mm"\u5206"',k[33]='h"\u65f6"mm"\u5206"ss"\u79d2"',k[34]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',k[35]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',k[36]='yyyy"\u5e74"m"\u6708"',k[39]="#,##0.00;-#,##0.00",k[40]="#,##0.00;[Red]-#,##0.00",k[50]='yyyy"\u5e74"m"\u6708"',k[51]='m"\u6708"d"\u65e5"',k[52]='yyyy"\u5e74"m"\u6708"',k[53]='m"\u6708"d"\u65e5"',k[54]='m"\u6708"d"\u65e5"',k[55]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',k[56]='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',k[57]='yyyy"\u5e74"m"\u6708"',k[58]='m"\u6708"d"\u65e5"',k.count=58;else if("ja-jp"===b)k[14]="yyyy/m/d",k[15]="dd-mmm-yy",k[16]="dd-mmm",k[17]="mmm-yy",k[22]="yyyy/mm/dd h:mm",k[27]="[$-411]ge.m.d",k[28]='[$-411]ggge"\u5e74"m"\u6708"d"',k[29]='[$-411]ggge"\u5e74"m"\u6708"d"',k[30]="m/d/yy",k[31]='yyyy"\u5e74"m"\u6708"d"\u65e5"',k[32]='h"\u6642"mm"\u5206"',k[33]='h"\u6642"mm"\u5206"ss"\u79d2"',k[34]='yyyy"\u5e74"m"\u6708"',k[35]='m"\u6708"d"\u65e5"',k[36]="[$-411]ge.m.d",k[38]="#,##0;[Red]-#,##0",k[39]="#,##0.00;-#,##0.00",k[40]="#,##0.00;[Red]-#,##0.00",k[50]="[$-411]ge.m.d",k[51]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',k[52]='yyyy"\u5e74"m"\u6708"',k[53]='m"\u6708"d"\u65e5"',k[54]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',k[55]='yyyy"\u5e74"m"\u6708"',k[56]='m"\u6708"d"\u65e5"',k[57]="[$-411]ge.m.d",k[58]='[$-411]ggge"\u5e74"m"\u6708"d"\u65e5"',k.count=58;else{if(c=J(),d=c&&c.LocalNumberFormat,h.isNullOrUndefined(d)||Array.isArray(d)||"object"!=typeof d)return;for(e in d)isNaN(+e)||(f=d[e],j.Util._aK(f)&&(k[e]=d[e]));g=0;for(e in k)isNaN(+e)||(i=+e,i>g&&(g=i));k.count=g}},a.initLanguageIndependentNumberFormat=function(){var b=a.sdK;b[27]="m/d/yyyy",b[28]="m/d/yyyy",b[29]="m/d/yyyy",b[30]="m/d/yyyy",b[31]="m/d/yyyy",b[32]="h:mm:ss",b[33]="h:mm:ss",b[34]="m/d/yyyy",b[35]="m/d/yyyy",b[36]="m/d/yyyy",b[50]="m/d/yyyy",b[51]="m/d/yyyy",b[52]="m/d/yyyy",b[53]="m/d/yyyy",b[54]="m/d/yyyy",b[55]="m/d/yyyy",b[56]="m/d/yyyy",b[57]="m/d/yyyy",b[58]="m/d/yyyy"},a.qdK={count:0},a.sdK={count:0},a.rdK={},a}(),C=function(){function a(){var a=this;a.udK=[],a.vdK=new w}return a.prototype.dispose=function(){var a=this;a.vdK&&(a.vdK.dispose(),a.vdK=n),a.udK=n},a.prototype.bGJ=function(a,b){var c,d,e="",f=a.hAlign;if(h.isNullOrUndefined(f)||(3===b||!b)&&3===f||2===b&&1===f||1===b&&1===f||(c=[1,2,3,0,6],e+="h:"+c[f]+","),d=a.vAlign,h.isNullOrUndefined(d)||(3===b||!b)&&2===d||2===b&&1===d||1===b&&1===d||(e+="v:"+d+","),h.isNullOrUndefined(a.textOrientation)||(e+="x:"+a.textOrientation+","),h.isNullOrUndefined(a.textIndent)||(e+="i:"+a.textIndent+","),h.isNullOrUndefined(a.shrinkToFit)||(e+="s:"+G(a.shrinkToFit)+","),h.isNullOrUndefined(a.wordWrap)||(e+="w:"+G(a.wordWrap)+","),e)return this.vdK.getTextIndex(e.substring(0,e.length-1))},a.prototype.NR=function(a){var b,c,d=this,e=d.udK;return e[a]?e[a]:(b=d.vdK.getText(a),c=new g.Style,b.split(",").forEach(function(a){var b=a.split(":"),d=b[0],e=b[1];switch(d){case"h":c.hAlign=+e;break;case"v":c.vAlign=+e;break;case"x":c.textOrientation=+e;break;case"i":c.textIndent=+e;break;case"s":c.shrinkToFit=p(e);break;case"w":c.wordWrap=p(e)}}),c)},a.prototype.ulK=function(a){a.alignments=this.vdK.bdK()},a.prototype.vlK=function(a){this.vdK.cdK(a.alignments)},a}(),D=function(){function a(){var a=this;a.wdK=[],a.xdK=new w}return a.prototype.dispose=function(){var a=this;a.xdK&&(a.xdK.dispose(),a.xdK=n),a.wdK=n},a.prototype.bGJ=function(a){if(!h.isNullOrUndefined(a.locked)){var b="";return b+="l:"+G(a.locked)+",",this.xdK.getTextIndex(b.substring(0,b.length-1))}},a.prototype.NR=function(a){var b,c,d=this,e=d.wdK;return e[a]?e[a]:(b=d.xdK.getText(a),c=new g.Style,b.split(",").forEach(function(a){var b=a.split(":"),d=b[0],e=b[1];"l"===d&&(c.locked=p(e))}),c)},a.prototype.ulK=function(a){a.protections=this.xdK.bdK()},a.prototype.vlK=function(a){this.xdK.cdK(a.protections)},a}();function K(a,b){if(!a||!b)return a;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}E=function(){function a(a,b,c){var d=this;d.ydK=new w,d.zdK=new B(b,c),d.AdK=new z(a,b),d.BdK=new y(a),d.CdK=new A(a)}return a.prototype.dispose=function(){var a=this;a.ydK&&(a.ydK.dispose(),a.ydK=n),a.zdK&&(a.zdK.dispose(),a.zdK=n),a.AdK&&(a.AdK.dispose(),a.AdK=n),a.BdK&&(a.BdK.dispose(),a.BdK=n),a.CdK&&(a.CdK.dispose(),a.CdK=n)},a.prototype.FdK=function(a){var b,c,d,e=this,f="",g=e.BdK.bGJ(a);if(g!==n&&(f+="c:"+g+","),b=e.AdK.bGJ(a),b!==n&&(f+="f:"+b+","),c=e.CdK.bGJ(a),c!==n&&(f+="b:"+c+","),d=e.zdK.bGJ(a),d!==n&&(f+="j:"+d+","),f=f.substring(0,f.length-1),""!==f)return e.ydK.getTextIndex(f)},a.prototype.GdK=function(a,b,c){var d=this,e=d.ydK.getText(a);if(e)return b=b||new g.Style,e.split(",").forEach(function(a){var e,f,g,h,i=a.split(":"),j=i[0],k=i[1];switch(j){case"c":e=d.BdK.NR(+k,c),b.backColor=e;break;case"f":f=d.AdK.NR(+k),K(b,f);break;case"b":g=d.CdK.NR(+k),K(b,g);break;case"j":h=d.zdK.NR(+k),K(b,h)}}),b},a.prototype.ulK=function(){var a=this,b={};return b.cellXfs=a.ydK.bdK(),a.zdK.ulK(b),a.AdK.ulK(b),a.BdK.ulK(b),a.CdK.ulK(b),b},a.prototype.vlK=function(a){if(a){var b=this;a&&(b.ydK.cdK(a.cellXfs),b.zdK.vlK(a),b.AdK.vlK(a),b.BdK.vlK(a),b.CdK.vlK(a))}},a}(),b.SharedDxfs=E,F=function(){function a(){var a=this;a.HdK=new w,a.gdK=new w,a.IdK=new x,a.zdK=new B(a.gdK,a.IdK),a.AdK=new z(a.HdK,a.gdK),a.BdK=new y(a.HdK,['{"t":0}','{"t":5}']),a.CdK=new A(a.HdK),a.JdK=new w,a.KdK=new w,a.LdK=new w,a.ydK=new E(a.HdK,a.gdK,a.IdK),a.MdK={},a.NdK={},a.OdK={},a.PdK={},a.QdK={},a.bkK=[],a.fkK={},a.NlK={},a.OlK={},a.originCellXfs=new w,a.originNamedStylesXfs=new w,a.DlK={},a.ElK={},a.bmK={},a.PlK="__builtInStyle",a.cmK="__builtInTableStyle",a.dmK=/^(__builtInTableStyle\d+)?__builtInStyle\d+$/,a.emK=0}return a.prototype.dispose=function(){var a=this;a.HdK&&(a.HdK.dispose(),a.HdK=n),a.gdK&&(a.gdK.dispose(),a.gdK=n),a.IdK&&(a.IdK.dispose(),a.IdK=n),a.zdK&&(a.zdK.dispose(),a.zdK=n),a.AdK&&(a.AdK.dispose(),a.AdK=n),a.BdK&&(a.BdK.dispose(),a.BdK=n),a.CdK&&(a.CdK.dispose(),a.CdK=n),a.JdK&&(a.JdK.dispose(),a.JdK=n),a.KdK&&(a.KdK.dispose(),a.KdK=n),a.LdK&&(a.LdK.dispose(),a.LdK=n),a.ydK&&(a.ydK.dispose(),a.ydK=n),a.MdK={},a.NdK={},a.OdK={},a.PdK={},a.QdK={},a.fkK={},a.bkK.length=0,a.NlK={},a.OlK={},a.originCellXfs&&(a.originCellXfs.dispose(),a.originCellXfs=n),a.originNamedStylesXfs&&(a.originNamedStylesXfs.dispose(),a.originNamedStylesXfs=n),a.DlK={},a.ElK={},a.bmK={}},a.prototype.RdK=function(a,b,c,d){var e,f,g,i,j,k,l,m,o,p,q,r,s=this,t=s.gdK,u=s.IdK,w="";return c!==n&&(w+="t:"+c+","),e=s.BdK.bGJ(a),e!==n&&(w+="c:"+e+","),f=s.AdK.bGJ(a),f!==n&&(w+="f:"+f+","),g=a.hAlign,h.isNullOrUndefined(g)||!d&&((3===b||!b)&&3===g||2===b&&1===g||1===b&&1===g)||(w+="h:"+g+","),i=a.vAlign,2===b&&1===i||1===b&&1===i||(h.isNullOrUndefined(i)?d||(w+="v:0,"):w+="v:"+i+","),j=s.CdK.bGJ(a),j!==n&&(w+="b:"+j+","),h.isNullOrUndefined(a.locked)||(w+="l:"+G(a.locked)+","),h.isNullOrUndefined(a.wordWrap)||(w+="w:"+G(a.wordWrap)+","),h.isNullOrUndefined(a.showEllipsis)||(w+="se:"+G(a.showEllipsis)+","),h.isNullOrUndefined(a.XHb)||(w+="st:"+G(a.XHb)+","),h.isNullOrUndefined(a.shrinkToFit)||(w+="s:"+G(a.shrinkToFit)+","),h.isNullOrUndefined(a.tabStop)||(w+="ts:"+G(a.tabStop)+","),h.isNullOrUndefined(a.quotePrefix)||(w+="q:"+G(a.quotePrefix)+","),h.isNullOrUndefined(a.isVerticalText)||(w+="va:"+G(a.isVerticalText)+","),h.isNullOrUndefined(a.applyFont)||(w+="y:"+G(a.applyFont)+","),h.isNullOrUndefined(a.applyFill)||(w+="z:"+G(a.applyFill)+","),h.isNullOrUndefined(a.applyAlignment)||(w+="r:"+G(a.applyAlignment)+","),h.isNullOrUndefined(a.applyBorder)||(w+="e:"+G(a.applyBorder)+","),h.isNullOrUndefined(a.applyProtection)||(w+="u:"+G(a.applyProtection)+","),h.isNullOrUndefined(a.applyNumberFormat)||(w+="g:"+G(a.applyNumberFormat)+","),h.isNullOrUndefined(a.textIndent)||(w+="i:"+a.textIndent+","),k=a.imeMode,h.isNullOrUndefined(k)||1===k||(w+="im:"+k+","),h.isNullOrUndefined(a.opacity)||(w+="o:"+a.opacity+","),h.isNullOrUndefined(a.backgroundImageLayout)||(w+="bl:"+a.backgroundImageLayout+","),h.isNullOrUndefined(a.textOrientation)||(w+="x:"+a.textOrientation+","),h.isNullOrUndefined(a.backgroundImage)||(w+="bi:"+t.getTextIndex(a.backgroundImage)+","),h.isNullOrUndefined(a.watermark)||(w+="k:"+t.getTextIndex(a.watermark)+","),h.isNullOrUndefined(a.cellPadding)||(w+="p:"+t.getTextIndex(a.cellPadding)+","),h.isNullOrUndefined(a.textBaseline)||(w+="tb:"+t.getTextIndex(a.textBaseline)+","),h.isNullOrUndefined(a.labelOptions)||(w+="lo:"+t.getTextIndex(JSON.stringify(a.labelOptions))+","),h.isNullOrUndefined(a.cellType)||(l=u.getObjectIndex(a.cellType),h.isNullOrUndefined(l)||(w+="ct:"+l+",")),h.isNullOrUndefined(a.cellButtons)||(m=u.getObjectIndex(a.cellButtons),h.isNullOrUndefined(m)||(w+="cb:"+m+",")),h.isNullOrUndefined(a.dropDowns)||(o=u.getObjectIndex(a.dropDowns),h.isNullOrUndefined(o)||(w+="dd:"+o+",")),h.isNullOrUndefined(a.decoration)||(p=u.getObjectIndex(a.decoration),h.isNullOrUndefined(p)||(w+="dc:"+p+",")),!h.isNullOrUndefined(a.formatter)&&v(a.formatter)&&(q=t.getTextIndex(a.formatter),w+="fs:"+q+","),r=s.zdK.bGJ(a),r!==n&&(w+="j:"+r+","),w.substring(0,w.length-1)},a.prototype.SdK=function(a,b){var c,d,i,j,k;if(a)return c=new g.Style,d=this,i=d.gdK,j=d.IdK,k=d.QdK,a.split(",").forEach(function(a){var g,l,m,o,q,r,s,t,u,v=a.split(":"),w=v[0],x=v[1];switch(w){case"t":c.sheetId=+x;break;case"c":g=d.BdK.NR(+x),c.backColor=g;break;case"f":l=d.AdK.NR(+x),K(c,l);break;case"h":c.hAlign=+x;break;case"v":c.vAlign=+x;break;case"b":m=d.CdK.NR(+x),K(c,m);break;case"l":c.locked=p(x);break;case"w":c.wordWrap=p(x);break;case"se":c.showEllipsis=p(x);break;case"st":c.XHb=p(x);break;case"s":c.shrinkToFit=p(x);break;case"ts":c.tabStop=p(x);break;case"q":c.quotePrefix=p(x);break;case"va":c.isVerticalText=p(x);break;case"y":c.applyFont=p(x);break;case"z":c.applyFill=p(x);break;case"r":c.applyAlignment=p(x);break;case"e":c.applyBorder=p(x);break;case"u":c.applyProtection=p(x);break;case"g":c.applyNumberFormat=p(x);break;case"i":c.textIndent=+x;break;case"im":c.imeMode=+x;break;case"o":c.opacity=+x;break;case"bl":c.backgroundImageLayout=+x;break;case"x":c.textOrientation=+x;break;case"bi":c.backgroundImage=i.getText(+x);break;case"n":c.parentName=h.isNullOrUndefined(x)||!b&&0===+x?n:k[x];break;case"k":c.watermark=i.getText(+x);break;case"p":c.cellPadding=i.getText(+x);break;case"tb":c.textBaseline=i.getText(+x);break;case"lo":c.labelOptions=JSON.parse(i.getText(+x));break;case"ct":o=e._o,q=j.getObject(+x),q&&(r=q.typeName,s=void 0,t=o[q.type]||o[r]||f.getTypeFromString(r),t&&(s=new t,s.fromJSON(q,!0)),c.cellType=s);break;case"cb":c.cellButtons=JSON.parse(j.getObject(+x));break;case"dd":c.dropDowns=JSON.parse(j.getObject(+x));break;case"dc":c.decoration=JSON.parse(j.getObject(+x));break;case"fs":c.formatter=i.getText(+x);break;case"j":u=d.zdK.NR(+x),K(c,u)}}),c},a.prototype.AkK=function(a,b){var c=this;if(!h.isNullOrUndefined(a))return b&&c.BkK&&c.BkK[a]&&c.BkK[a][b]&&(a=c.BkK[a][b]),a},a.prototype.getNamedStyle=function(a,b,c){var d,e=this,f=e.JdK,h=f.getText(a);if(h!==n)return d=h?e.SdK(h,c):new g.Style,d.name=b,e.QdK[a]=b,d},a.prototype.getNamedStyleIndex=function(a,b,c,d,e){var f,g,h,i,j,k,l,m;if(a)return f=this,g=f.JdK,h=f.NdK,i=f.dmK,k=f.bmK,l=a.name,l=f.AkK(l,c),m=f.RdK(a,b,d,!0),(!e||l&&!i.test(l))&&(j=g.getTextIndex(m),h[l]=j,k[j]={parentName:a.parentName,name:l}),j},a.prototype.updateNamedStylesParentName=function(){var a=this,b=a.JdK,c=a.NdK,d=a.bmK;Object.keys(d).forEach(function(a){var e,f,g=d[a],i=g.parentName,j=g.name;h.isNullOrUndefined(i)||h.isNullOrUndefined(c[i])||(e=b.getText(+a),f=b.getTextIndex(e+(e.length>0?",n:":"n")+c[i]),c[j]=+f)})},a.prototype.getStyle=function(a){var b,c,d,e,f=this,g=f.NlK,h=g[a];return h!==n?h:(b=f.PdK,c=b[a],c!==n?c:(d=f.KdK,e=d&&d.getText(a),e!==n?(c=f.SdK(e),b[a]=c,c):void 0))},a.prototype.getStyleIndex=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,o;if(a)return d=this,f=d.NdK,g=d.JdK,h=d.KdK,i=d.dmK,"string"==typeof a?(a=d.AkK(a,c),k=f[a],j=g.getText(k),j.length&&","!==j[j.length-1]&&(j+=","),j+="d:"+k,+h.getTextIndex(j)):(l=a._id,m=d.MdK,l!==n&&(e=m[l],e!==n)?e:(o=a.name,(o===n||i.test(o))&&(o=a.parentName),o=d.AkK(o,c),j=d.RdK(a,b),j.length&&","!==j[j.length-1]&&(j+=","),j+=o!==n&&f[o]!==n?"n:"+f[o]:"n:0",e=h.getTextIndex(j),m[l]=e,e))},a.prototype.getOriginNamedStyleIndex=function(a){var b=this,c=b.originNamedStylesXfs;return+c.getTextIndex(a)},a.prototype.getOriginStyleIndex=function(a,b){var c,d,e,f,g=this,h=g.DlK,i=g.originCellXfs;return a?(d=a._id,d!==n&&(c=h[d],c!==n)?c:(e=g.NdK,f=g.RdK(a,b,void 0,!0),a.name&&(f.length&&","!==f[f.length-1]&&(f+=","),f+="d:"+e[a.name]),a.parentName&&(f.length&&","!==f[f.length-1]&&(f+=","),f+="n:"+e[a.parentName]),+i.getTextIndex(f))):+i.getTextIndex(o)},a.prototype.getOriginStyle=function(a){var b,c,d=this,e=d.originCellXfs,f=d.ElK;return f[a]!==n?f[a]:(b=e.getText(a))?(c=d.SdK(b),f[a]=c,c):o},a.prototype.getOriginNamedStyle=function(a){var b=this,c=b.originNamedStylesXfs;return c.getText(a)},a.prototype.getDxf=function(a,b,c){var d=this,e=d.ydK;return e.GdK(a,b,c)},a.prototype.getDxfIndex=function(a){var b=this,c=b.ydK;return a?c.FdK(a):n},a.prototype.addTableStyle=function(a){this.bkK.filter(function(b){return b.name===a.name}).length>0||this.bkK.push(a)},a.prototype.addDefaultStyleName=function(a,b){this.fkK[a]=b},a.prototype.getDefaultStyleName=function(a){return this.fkK[a]},a.prototype.getFormatCodeByNumFmtId=function(a){return this.zdK.GlK(a)},a.prototype.buildDummyNamedStyles=function(a){var b,c,d,e=this,f=e.KdK,g=e.PlK,h=f.$cK.length,i=e.NlK;if(h>0)for(b=0;b<h;b++)c=e.getStyle(b),d=g+b,c.name=d,a.addNamedStyle(c),i[b]=d},a.prototype.cdK=function(b,c){var d=this;b&&(b.sharedColors&&d.HdK.cdK(b.sharedColors),b.commonSharedStrings&&d.gdK.cdK(b.commonSharedStrings),b.cellXfs&&d.KdK.cdK(b.cellXfs),b.cellStyleXfs&&d.JdK.cdK(b.cellStyleXfs),b.sharedObjects&&d.IdK.cdK(b.sharedObjects),b.originCellXfs&&d.originCellXfs.cdK(b.originCellXfs),b.originNamedStylesXfs&&d.originNamedStylesXfs.cdK(b.originNamedStylesXfs),d.BdK.vlK(b),d.zdK.vlK(b),d.AdK.vlK(b),d.CdK.vlK(b),d.ydK.vlK(b.dxfs),d.fkK=r(b.defaultStyleNames)||{},a._n&&q(a._n,function(a,c){c.cdK&&c.cdK.call(d,b)}))},a.prototype.bdK=function(b){var c=this,d={sharedColors:c.HdK.bdK(),commonSharedStrings:c.gdK.bdK(),cellXfs:c.KdK.bdK(),cellStyleXfs:c.JdK.bdK(),sharedObjects:c.IdK.bdK(),namedStylesMap:c.NdK,defaultStyleNames:r(c.fkK),originCellXfs:c.originCellXfs.bdK(),originNamedStylesXfs:c.originNamedStylesXfs.bdK()};return c.zdK.ulK(d),c.AdK.ulK(d),c.BdK.ulK(d),c.CdK.ulK(d),d.dxfs=c.ydK.ulK(),c.bkK.length>0&&(d.tableStyles={n_:"tableStyles",c_:[].concat(c.bkK),defaultPivotStyle:c.getDefaultStyleName("defaultPivotStyle")||"PivotStyleLight16",defaultTableStyle:c.getDefaultStyleName("defaultTableStyle")||"TableStyleMedium2",count:c.bkK.length}),a._n&&q(a._n,function(a,b){b.bdK&&b.bdK.call(c,d)}),d},a.prototype.uia=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},a}(),b.StyleManager=F,i.Zn(F)},"./dist/core/util/tasks.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=100,e=10,f=function(){function a(a,b){this.fn=a,this.args=b}return a.prototype.dispose=function(){this.fn=void 0,this.args=void 0},a.prototype.run=function(){this.fn.apply(null,this.args)},a}(),b.Task=f,g=function(){function a(a,b){var c=this;c.tasks=[],c.nextTaskFunc=a.bind(c),c.isBusyFunc=b.bind(c)}return a.prototype.addTask=function(a,b,c){this.tasks.splice(0,0,new f(a,b))},a.prototype.pushTask=function(a,b,c){this.tasks.push(new f(a,b))},a.prototype.runNextTask=function(){var a,b=this,c=b.tasks;if(!b.isTerminated){if(c.length<1)return void(b.endingCallback&&b.endingCallback());if(b.isBusyFunc())return void setTimeout(function(){b.runNextTask()},d);a=b.nextTaskFunc(),a.run(),setTimeout(function(){b.runNextTask()},e)}},a.prototype.start=function(){var a=this;a.runNextTask()},a.prototype.terminate=function(){var a=this;a.tasks&&(a.tasks.forEach(function(a){a.dispose()}),a.tasks=[]),a.endingCallback=void 0,a.isTerminated=!0},a}(),b.Tasks=g,h=function(a){j(b,a);function b(b,c,d,e,f){var g=a.call(this,b,c)||this;return g.description=d,g.progress=e,g.sheetName=f,g}return b.prototype.dispose=function(){this.description=void 0,this.progress=void 0,this.sheetName=void 0,a.prototype.dispose.call(this)},b}(f),b.LoadTask=h,i=function(a){j(b,a);function b(b,c,d){void 0===d&&(d=function(a){});var e=a.call(this,b,c)||this;return e.progress=d,e}return b.prototype.runNextTask=function(){var a,b=this,c=b.tasks,e=b.progress;if(!b.isTerminated){if(c.length<1)return void(b.endingCallback&&b.endingCallback());if(b.isBusyFunc())return void setTimeout(function(){b.runNextTask()},d);a=b.nextTaskFunc(),a.description&&e({progress:a.progress&&a.progress(),step:a.description,sheetName:a.sheetName}),a.run(),a.dispose(),setTimeout(function(){b.runNextTask()},0)}},b.prototype.addTask=function(a,b,c,d,e){this.tasks.splice(0,0,new h(a,b,c,d,e))},b.prototype.pushTask=function(a,b,c,d,e){this.tasks.push(new h(a,b,c,d,e))},b.prototype.terminate=function(){this.progress=void 0,a.prototype.terminate.call(this)},b}(g),b.LoadTasks=i},"./dist/core/util/theme.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/common.js"),f=c("./dist/core/util/common.js"),g=d.Common.j.Fa,h=d.Common.pc,i=h.ec,j=parseInt,k=e.util.Pl,l=f.util.JcK,m=f.util.IcK,n="Gill Sans MT",o="Franklin Gothic Book",p="Trebuchet MS";function K(a){var b=a;return function(c){return 0===arguments.length?this.po[b]:(this.po[a]=i(c),this)}}q=0,r=1,s=2,t=3,u=4,v=5,w=6,x=7,y=8,z=9,A=10,B=11,C={"3DDKSHADOW":4288716960,"3DLIGHT":4293125091,ACTIVEBORDER:4290032820,ACTIVECAPTION:4288263377,APPWORKSPACE:4289440683,BACKGROUND:1044480,BTNFACE:4293980400,BTNHIGHLIGHT:4294967295,BTNSHADOW:4288716960,BTNTEXT:1044480,CAPTIONTEXT:1044480,GRAYTEXT:4285361517,HIGHLIGHT:4281571839,HIGHLIGHTTEXT:4294967295,INACTIVEBORDER:4294244348,INACTIVECAPTION:4290760155,INACTIVECAPTIONTEXT:4282601044,INFOBK:4294967265,INFOTEXT:1044480,MENU:4293980400,GRADIENTACTIVECAPTION:4290367978,HOTLIGHT:267413196,GRADIENTINACTIVECAPTION:4292338930,MENUBAR:4293980400,MENUHIGHLIGHT:4281571839,MENUTEXT:1044480,SCROLLBAR:4291348680,WINDOW:4294967295,WINDOWFRAME:4284769380,WINDOWTEXT:4278190080};function L(a){return a<=0?0:a<=.0031308?255*a*12.92+.5:a<1?255*(1.055*Math.pow(a,.4166666666666667)-.055)+.5:255}function M(a){var b,c,d,e,g,h,i,j,k,l=a.n_.split(":").pop(),m=a.val;if("sysClr"===l){if(b=C[m.toUpperCase()],void 0!==b)return f.ColorHelper.hexToARGB(b);if(c=a.lastClr)return d=4278190080+(16777215&parseInt(c,16)),f.ColorHelper.hexToARGB(d)}else{if("srgbClr"===l&&m)return d=4278190080+(16777215&parseInt(m,16)),f.ColorHelper.hexToARGB(d);if("scrgbClr"===l)return e=parseFloat(a.Yxa),g=parseFloat(a.g),h=parseFloat(a.b),{a:255,r:L(e),g:L(g),b:L(h)};if("hslClr"===l)return i=parseFloat(a.lc),j=parseFloat(a.sat),k=parseFloat(a.lum),f.util.ScK(i,k,j);if("prstClr"===l&&m)return f.util.TcK(m)}}!function(a){a[a.lt1=0]="lt1",a[a.lt2=1]="lt2",a[a.dk1=2]="dk1",a[a.dk2=3]="dk2",a[a.accent1=4]="accent1",a[a.accent2=5]="accent2",a[a.accent3=6]="accent3",a[a.accent4=7]="accent4",a[a.accent5=8]="accent5",a[a.accent6=9]="accent6",a[a.hlink=10]="hlink",a[a.folHlink=11]="folHlink"}(D||(D={}));function N(a){var b=a.toString(16).toUpperCase();return 1===b.length&&(b="0"+b),b}function O(a,b){return{n_:a,c_:[{n_:"srgbClr",val:N(b.r)+N(b.g)+N(b.b)}]}}E=function(){function a(a,b,c,d,e,f,g,h,j,k,l,m,n){this.background1=K(q),this.background2=K(r),this.textColor1=K(s),this.textColor2=K(t),this.accent1=K(u),this.accent2=K(v),this.accent3=K(w),this.accent4=K(x),this.accent5=K(y),this.accent6=K(z),this.hyperlink=K(A),this.followedHyperlink=K(B),this.Cj=a,this.po=[];for(var o=1;o<13;o++)this.po.push(i(arguments[o]))}return a.prototype.name=function(a){return 0===arguments.length?this.Cj:(this.Cj=a,this)},a.prototype.getColor=function(a){var b,c,d,e,f;if(a&&"string"==typeof a&&(b=a.split(" "),c=void 0,b)){if(d=-1,e=b.length,e>1){if(!b[0])return a;c=b[0].toLowerCase(),"background"===c?d=j(b[1],10)-1:"text"===c?d=j(b[1],10)+1:"accent"===c&&(d=j(b[1],10)+3)}else 1===e&&(c=b[0].toLowerCase(),"hyperlink"===c?d=A:"followedhyperlink"===c&&(d=B));if(d>=0&&d<=11)return e>2?(f=j(b[2],10)/100,h.bc(h.jc(this.po[d],f))):h.bc(this.po[d])}return a},a.prototype.toJSON=function(){var a=this,b=a.po;return{name:a.Cj,background1:b[q],background2:b[r],text1:b[s],text2:b[t],accent1:b[u],accent2:b[v],accent3:b[w],accent4:b[x],accent5:b[y],accent6:b[z],hyperlink:b[A],followedHyperlink:b[B]}},a.prototype.fromJSON=function(a,b){var c,d,e,f,h,i,j,k,l,m,n,o,p,C,D,E,F;function G(a,b){g(b)||(c.po[a]={a:b.a,r:b.r,g:b.g,b:b.b})}a&&(c=this,d="_colorList",e="_name",b?(E=a.name?a.name:a[e],g(E)||(c.Cj=E),F=a.colorList?a.colorList:a[d],f=F[q],h=F[r],i=F[s],j=F[t],k=F[u],l=F[v],m=F[w],n=F[x],o=F[y],p=F[z],C=F[A],D=F[B]):(g(a.name)||(c.Cj=a.name),f=a.background1,h=a.background2,i=a.text1,j=a.text2,k=a.accent1,l=a.accent2,m=a.accent3,n=a.accent4,o=a.accent5,p=a.accent6,C=a.hyperlink,D=a.followedHyperlink),G(q,f),G(r,h),G(s,i),G(t,j),G(u,k),G(v,l),G(w,m),G(x,n),G(y,o),G(z,p),G(A,C),G(B,D))},a.prototype.cdK=function(a){var b,c,d,e,f,g,h;if(a)for(b=this,c=a.c_,b.Cj=a.name,d=0,e=c.length;d<e;d++)f=c[d],f&&(g=f.n_.split(":").pop(),h=f.c_[0],b.po[D[g]]=M(h))},a.prototype.bdK=function(){var a,b,c,d=this,e={n_:"clrScheme",name:d.name()},f=[],g=d.po;for(a=0,b=g.length;a<b;a++)c=g[a],2===a?f[0]={n_:"dk1",c_:[{n_:"sysClr",val:"windowText",lastClr:N(c.r)+N(c.g)+N(c.b)}]}:0===a?f[1]={n_:"lt1",c_:[{n_:"sysClr",val:"window",lastClr:N(c.r)+N(c.g)+N(c.b)}]}:3===a?f[2]=O("dk2",c):1===a?f[3]=O("lt2",c):f.push(O(""+D[a],c));return e.c_=f,e},a.prototype.e4=function(a){var b,c,d,e;if(this.name()!==a.name())return!1;for(b=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"],c=0,d=b.length;c<d;c++)if(e=b[c],!h.Pka(this[e](),a[e]()))return!1;return!0},a}(),b.ColorScheme=E,F=function(){function a(a,b,c,d){var e,f=this;this.name=k("name"),this.colors=k("colors"),this.headerFont=k("headerFont"),this.bodyFont=k("bodyFont"),this.fmtTheme=k("fmtTheme",void 0,function(){f.Zlb={}}),e=this,e.name(a),e.colors(b?b:new E(a)),e.headerFont(c),e.bodyFont(d)}return a.prototype.getColor=function(a){return this.colors().getColor(a)},a.prototype.getFont=function(a){return"Body"===a?this.bodyFont():"Headings"===a?this.headerFont():a},a.prototype.toJSON=function(){var b=this,c=b.name();return a.f4(b)?c:{name:c,themeColor:b.colors()?b.colors().toJSON():void 0,headingFont:b.headerFont(),bodyFont:b.bodyFont()}},a.prototype.bdK=function(){var b,c,d,e=this,f=e.name();return a.f4(e)?f:(b=e.colors(),b&&(c=b.bdK()),d={n_:"themeElements",c_:[]},c&&d.c_.push(c),d.c_.push({n_:"fontScheme",
c_:[{n_:"majorFont",c_:[{n_:"latin",typeface:e.headerFont()}]},{n_:"minorFont",c_:[{n_:"latin",typeface:e.bodyFont()}]}]}),{n_:"theme",name:f,c_:[d]})},a.prototype.cdK=function(a){var b,c,d,e,f,g=this;return"string"==typeof a?void g.LgK(a):(g.LgK(a.name),b=l(a,"themeElements"),c=l(b,"clrScheme"),d=new E,d.cdK(c),g.colors(d),e=l(b,"fontScheme"),e&&(g.headerFont(m(e,"majorFont&latin").typeface),g.bodyFont(m(e,"minorFont&latin").typeface)),f=l(b,"fmtScheme"),void(f&&g.fmtTheme(f)))},a.prototype.LgK=function(a){var b,c=this;a&&"OFFICE"===a.toUpperCase().substring(0,6)&&(a="Office"),c.name(a),b=J[a],b&&(c.colors(b.colors()),c.headerFont(b.headerFont()),c.bodyFont(b.bodyFont()))},a.f4=function(a){var b,c=a.name();return!!J[c]&&(b=J[c],a.bodyFont()===b.bodyFont()&&a.headerFont()===b.headerFont()&&a.colors().e4(b.colors()))},a}(),b.Theme=F,G="#000000",H="#FFFFFF",I=function(){function a(){}return a.Default=new E("Default",H,"#EEECE1",G,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),a.Office2007=new E("Office2007",H,"#EEECE1",G,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),a.Office=new E("Office",H,"#E7E6E6",G,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),a.Apex=new E("Apex",H,"#C9C2D1",G,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),a.Aspect=new E("Aspect",H,"#E3DED1",G,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),a.Concourse=new E("Concourse",H,"#DEF5FA",G,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),a.Civic=new E("Civic",H,"#C5D1D7",G,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),a.Oriel=new E("Oriel",H,"#FFF39D",G,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),a.Origin=new E("Origin",H,"#DDE9EC",G,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),a.Paper=new E("Paper",H,"#FEFAC9",G,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),a.Solstice=new E("Solstice",H,"#E7DEC9",G,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),a.Technic=new E("Technic",H,"#D4D2D0",G,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),a.Trek=new E("Trek",H,"#FBEEC9",G,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),a.Urban=new E("Urban",H,"#DEDEDE",G,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),a.Verve=new E("Verve",H,"#D2D2D2",G,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),a.Equity=new E("Equity",H,"#E9E5DC",G,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),a.Flow=new E("Flow",H,"#DBF5F9",G,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),a.Foundry=new E("Foundry",H,"#EAEBDE",G,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),a.Median=new E("Median",H,"#EBDDC3",G,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),a.Metro=new E("Metro",H,"#D6ECFF",G,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),a.Module=new E("Module",H,"#D4D4D6",G,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),a.Opulent=new E("Opulent",H,"#F4E7ED",G,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),a}(),b.ThemeColors=I,J=function(){function a(){}return a.Default=new F("Default",I.Default,"Cambria","Calibri"),a.Office=new F("Office",I.Office,"Calibri Light","Calibri"),a.Office2007=new F("Office2007",I.Office2007,"Cambria","Calibri"),a.Apex=new F("Apex",I.Apex,"Lucida Sans","Book Antiqua"),a.Aspect=new F("Aspect",I.Aspect,"Verdana","Verdana"),a.Concourse=new F("Concourse",I.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),a.Civic=new F("Civic",I.Civic,"Georgia","Georgia"),a.Oriel=new F("Oriel",I.Oriel,"Century Schoolbook","Century Schoolbook"),a.Origin=new F("Origin",I.Origin,"Bookman Old Style",n),a.Paper=new F("Paper",I.Paper,"Constantia","Constantia"),a.Solstice=new F("Solstice",I.Solstice,n,n),a.Technic=new F("Technic",I.Technic,o,"Arial"),a.Trek=new F("Trek",I.Trek,"Franklin Gothic Medium",o),a.Urban=new F("Urban",I.Urban,p,"Georgia"),a.Verve=new F("Verve",I.Verve,"Century Gothic","Century Gothic"),a.Equity=new F("Equity",I.Equity,o,"Perpetua"),a.Flow=new F("Flow",I.Flow,"Calibri","Constantia"),a.Foundry=new F("Foundry",I.Foundry,"Rockwell","Rockwell"),a.Median=new F("Median",I.Median,"Tw Cen MT","Tw Cen MT"),a.Metro=new F("Metro",I.Metro,"Consolas","Corbel"),a.Module=new F("Module",I.Module,"Corbel","Corbel"),a.Opulent=new F("Opulent",I.Opulent,p,p),a}(),b.Themes=J},"./dist/core/workbook/sheettab.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/common.js"),f=c("./dist/core/worksheet/stylehelper.js"),g=c("./dist/core/workbook/sheettabbase.js"),h=c("./dist/core/core.enum.js"),i=d.Common.pc,j=i.ic,k=i.ec,l=null,m="blank",n="nextButton",o=function(a){p(b,a);function b(b){var c,d=a.call(this,b)||this;return d.nJc=4,d.oJc="white",c=d,c.EC=13,c.GC=12,c.HC=0,c.kw=30,c.IC=28,c.JC=28,c.KC=g.NEW_TAB_SIZE_ASIDE,c.gYJ=15,c.hYJ=28,c.LC=0,c._font="10pt Segoe UI",d}return b.prototype.NC=function(){var a=this.OC,b=a&&a.options;return b&&b.tabNavigationVisible?this.IC*(b.useTouchLayout?1.5:1):0},b.prototype.PC=function(){var a=this.OC;return a&&a.options.tabNavigationVisible?a.pJc():0},b.prototype.QC=function(){return this.JC},b.prototype.RC=function(){return this.SC?0:this.JC},b.prototype.TC=function(){var a=this,b=a.OC.options.newTabVisible;return b?this.SC?0:this.KC:0},b.prototype.UC=function(){var a,b,c,d,e,f=this,g=f.OC.xCJ(),i=f.WC,j=f.VC();for(f.TZJ()&&(j-=f.iYJ()),a=f.qJc(),b=f.Dr(),c=a?b.x+b.width-f.rJc()-f.TC()-f.RC():b.y+b.height-f.PC(),d=f.gq,e=g.length;d<e;d++)if(g[d].visible()===h.SheetTabVisible.visible&&(j+=a?i[d]:f.sJc),j>c){j=c;break}return j},b.prototype.VC=function(){var a,b,c=this,d=c.OC.options,e=c.qJc(),f=d.tabNavigationVisible;return e?(a=2*c.iYJ(),f&&(a-=c.iYJ()),2*c.NC()+c.QC()+c.XC()+a):(b=c.jYJ(),c.TZJ()&&(b=0),Math.max(c.TC(),b))},b.prototype.XC=function(){var a=this,b=a.OC;return b&&b.options.tabNavigationVisible?a.rJc()/2:0},b.prototype.getResizeBarBounds=function(){var a=this,b=a.Dr();return{x:b.x+b.width-a.rJc(),y:l,width:a.rJc(),height:l}},b.prototype.getNavButtonBounds=function(){var a,b,c,d,e,f,g,h,i,j=this,k=j.qJc();return k?(a=j.rJc()/2,b=l,c=j.NC(),d=l):(g=j.Dr(),h=j.PC(),i=j.NC(),a=g.width/2-i,b=g.height-h,c=i,d=h),e=1,f=3,{x:a,y:b,width:c,height:d,startIndex:e,endIndex:f}},b.prototype.getSheetTabBounds=function(){var a=this,b=a.Dr(),c=a.RC(),d=a.VC();return a.TZJ()&&(d-=a.iYJ()),{x:d,y:l,height:l,secondMoreTabWidth:a.RC(),moreTabPos:b.x+b.width-a.rJc()-a.TC()-c}},b.prototype.getPreMoreTabBounds=function(){var a=this,b=a.VC();return a.TZJ()&&(b-=a.iYJ()),{x:b-a.QC(),width:a.QC()}},b.prototype.getAllSheetsBounds=function(){var a,b,c,d,e,f,g,h=this,i=h.qJc(),j=h.OC.options.newTabVisible,k=h.OC.options.tabNavigationVisible,l=h.OC.options.useTouchLayout,m=h.Dr(),n=h.getNavButtonBounds(),o=h.iYJ(),p=h.jYJ();return i?(a=n.x+2*n.width,a+=h.iYJ()-h.rJc()/2,0===h.rJc()&&k&&(a-=h.iYJ()),b=m.y,c=o,d=p):l?(e=m.x,f=m.width,j&&(e=m.x+m.width/2,f=m.width/2),a=e,b=m.y,c=f,d=p):(g=j?0:h.gYJ/-2,a=(m.x+m.width)/2+g,b=5,c=o+4,d=p),{x:a,y:b,width:c,height:d}},b.prototype.YC=function(){var a=this,b=a.qJc();return b?a.ZC+a.WC[a.$C]>a._C():a.ZC+2*a.sJc>a._C()},b.prototype._C=function(){var a=this,b=a.qJc();return b?a.Dr().width-a.rJc()-a.TC()-a.RC():a.Dr().height-a.PC()},b.prototype.aD=function(){return 6},b.prototype.Via=function(){return[m,n]},b.prototype.cD=function(){return this.VC()},b.prototype.tJc=function(a,b){var c,d=this;a.save(),a.beginPath(),c=e.Im.Km(0,"gc-tabStripBackground").backgroundColor,d.eD=k(c),a.fillStyle=c,a.fillRect(b.x,b.y,b.width,b.height),a.restore()},b.prototype.uJc=function(a,b){var c,d,f,g,i=this,j=i.OC,k=j&&j.options.tabStripPosition,l=e.Im.Km(0,"gc-tabStripBackground").borderTopColor;a.save(),a.beginPath(),a.strokeStyle=l,k===h.TabStripPosition.bottom?(c=b.x,d=b.y,f=b.x+b.width,g=b.y+.5):k===h.TabStripPosition.top?(c=b.x,d=b.height-.5,f=b.x+b.width,g=b.y+b.height-.5):k===h.TabStripPosition.left?(c=b.x+b.width-.5,d=b.y,f=b.x+b.width-.5,g=b.y+b.height):k===h.TabStripPosition.right&&(c=b.x+.5,d=b.y,f=b.x+.5,g=b.y+b.height),a.moveTo(c,d),a.lineTo(f,g),a.stroke(),a.restore()},b.prototype.dD=function(a,b){var c=this;c.tJc(a,b),c.uJc(a,b)},b.prototype.fD=function(a,b,c){var d,e,f,g,h,i=this,j=i.OC.options,k=j.newTabVisible,l=i.qJc(),m=i.VC(),n=i.IC,o=c,p=0,q=n;l?(i.TZJ()&&(m-=i.iYJ()),e=i.RC(),o+=e,f=b.x+b.width-i.rJc()-i.TC(),o>f&&(o=f,g=f-e,g<m&&(g=m,o=g+n),i.gD(a,g,0,e,b.height)),d=b.height):(h=i.iYJ(),i.TZJ()&&(h=0),o=(b.width-m)/2-h,d=m,q=d),k&&i.hD(a,o,p,q,d,i.iD===-2)},b.prototype.jD=function(a,b,c,d){var e=this.QC();this.gD(a,d-e,0,e,b.height)},b.prototype.kD=function(a,b){var c,d,e=this,f=e.qJc(),h=e.vJc,i=e.NC(),j=e.PC(),k=e.lD;f?(c=e.rJc()/2+i/2,d=j/2,e.mD(a,c,d,c+h,d+h,c+h,d-h,g.NavButtonDirection.left,l,1===k),c+=i,e.mD(a,c,d,c-h,d+h,c-h,d-h,g.NavButtonDirection.right,l,2===k)):(c=(b.width-i)/2,d=b.height-j/2,e.mD(a,c,d,c+h,d+h,c-h,d+h,g.NavButtonDirection.top,l,1===k),c+=i,e.mD(a,c,d,c-h,d+h,c-h,d-h,g.NavButtonDirection.bottom,l,2===k))},b.prototype.kYJ=function(a,b){var c,d,e,f=this,g=f.OC.options,i=g.allSheetsListVisible,j=g.newTabVisible,k=g.tabNavigationVisible,l=f.qJc(),m=f.VC();f.TZJ()&&(m-=f.iYJ()),c=0,d=10,l?(c=2*f.NC()+f.iYJ(),0===f.rJc()&&k&&(c-=f.iYJ())):(e=j?f.iYJ():f.iYJ()/2,c=(b.width-m)/2+e),i!==h.AllSheetsListVisibility.hide&&f.lYJ(a,c,d,f.iD===-3)},b.prototype.nD=function(a,b){var c,d,f=this,g=f.rJc(),h=e.Im.Km(0,"gc-tabStripResizeBarInner");f.OC.options.showHorizontalScrollbar&&(a.beginPath(),a.rect(b.x+b.width-g,0,g,b.height),a.clip(),c=b.x+b.width-g/2,d=b.y+b.height/2,a.fillStyle=h.color,a.fillRect(c,d,2,2),a.fillRect(c,d-4,2,2),a.fillRect(c,d+4,2,2))},b.prototype.wJc=function(a,b,c,d,e,f,g,i){var j=this,k=j.OC,l=k.options.tabStripPosition,m=j.xJc,n=j.oJc,o=j.nJc,p=j.yJc,q=j.qJc();a.save(),i&&g&&(a.fillStyle=n,l===h.TabStripPosition.bottom?a.fillRect(b,c,d,e-o):l===h.TabStripPosition.top?a.fillRect(b,c+o,d,e):l===h.TabStripPosition.left?a.fillRect(b+m,c,d-m,e):a.fillRect(b,c,d-m,e)),g?(a.fillStyle=n,l===h.TabStripPosition.bottom?a.fillRect(b,c+1,d,e-o):l===h.TabStripPosition.top?a.fillRect(b,c+o-1,d,e):i?l===h.TabStripPosition.left?a.fillRect(b+m,c,d-m,e+1):a.fillRect(b,c,d-m,e+1):a.fillRect(b+m,c,d-2*m,e+1)):i&&(a.fillStyle=n,l===h.TabStripPosition.bottom?a.fillRect(b,c,d,1):l===h.TabStripPosition.top?a.fillRect(b,c+e,d,1):l===h.TabStripPosition.left?a.fillRect(b+m,c,d-m,e+1):a.fillRect(b,c,d-m,e+1)),a.fillStyle=f,q?a.fillRect(b+p,c+p,d-2*p+1,e-2*p):i?l===h.TabStripPosition.left?a.fillRect(b+m,c,d-m,e+1):a.fillRect(b,c,d-m,e+1):a.fillRect(b+m,c,d-2*m,e+1),a.restore()},b.prototype.zJc=function(a,b,c,d,e,f,g){var i=this,j=i.OC,k=j.options.tabStripPosition,l=i.nJc,m=i.xJc,n=i.qJc();a.save(),n?(a.beginPath(),a.lineWidth=1,a.strokeStyle=f&&f.borderLeftColor,g?k===h.TabStripPosition.bottom?(a.moveTo(b+.5,c),a.lineTo(b+.5,c+e-l),a.moveTo(b+d+.5,c),a.lineTo(b+d+.5,c+e-l)):k===h.TabStripPosition.top&&(a.moveTo(b+.5,c+l),a.lineTo(b+.5,c+e),a.moveTo(b+d+.5,c+l),a.lineTo(b+d+.5,c+e)):(a.moveTo(b+.5,c+l),a.lineTo(b+.5,c+e-l),a.moveTo(b+d+.5,c+l),a.lineTo(b+d+.5,c+e-l))):(a.beginPath(),a.lineWidth=1,a.strokeStyle=f&&f.borderLeftColor,g?k===h.TabStripPosition.left?(a.moveTo(b+m,c+.5),a.lineTo(b+m+d,c+.5),a.moveTo(b+m,c+e+.5),a.lineTo(b+m+d,c+e+.5)):(a.moveTo(b,c+.5),a.lineTo(b+d-m,c+.5),a.moveTo(b,c+e+.5),a.lineTo(b+d-m,c+e+.5)):(a.moveTo(b+m,c+.5),a.lineTo(b-m+d,c+.5),a.moveTo(b+m,c+e+.5),a.lineTo(b-m+d,c+e+.5))),a.stroke(),a.restore()},b.prototype.AJc=function(a,b,c,d,e,f,g){var i=this,j=i.OC,k=j.options.tabStripPosition,l=i.nJc,m=i.xJc;g&&(a.save(),a.beginPath(),a.strokeStyle=f&&f.borderBottomColor,a.lineWidth=2,k===h.TabStripPosition.bottom?(a.moveTo(b,c+e-l),a.lineTo(b+d+1,c+e-l)):k===h.TabStripPosition.top?(a.moveTo(b,c+l),a.lineTo(b+d+1,c+l)):k===h.TabStripPosition.left?(a.moveTo(b+m,c),a.lineTo(b+m,c+e+1)):(a.moveTo(d-m,c),a.lineTo(d-m,c+e+1)),a.stroke(),a.restore())},b.prototype.BJc=function(a,b,c,d,e,g,j,k,l,m,n){var o,p,q,r,s,t,u,v=this,w=v.OC.options.tabStripPosition,x=v.xJc,y=v.yJc,z=v.CJc,A=v.OC.yCJ(g),B=A&&A.options,C=B&&B.sheetTabColor;a.save(),a.textBaseline="top","string"==typeof k&&(o=k),p=v.qD(j,o),a.fillStyle=p,(n||m||l)&&(a.font=f.To.Ro(a.font,"bold")),q=v.EC,a.textBaseline="middle",w===h.TabStripPosition.bottom?a.fillText(g,b+q,c+e/2-1):w===h.TabStripPosition.top?a.fillText(g,b+q,c+e/2+1):(a.beginPath(),r=b+d-2*x-2*y-2-1,a.rect(b+x,c+.5,r+y,e+.5),a.clip(),a.fillText(g,b+x+y,c+e/2+2),s=a.measureText(z).width,t=a.measureText(g).width,t-s>r&&(a.beginPath(),u=void 0,u=C?k:m||l?v.oJc:i.bc(v.eD),a.fillStyle=u,a.fillRect(b+x+y+r-s,c+1.5,r,e-1.5),a.fillStyle=p,a.fillText(z,b+x+y+r-s,c+e/2+2))),a.restore()},b.prototype.oD=function(a,b,c,d,f,g,i,j,k,l){var m,n,o,p=this,q=h.VisualState.normal;j&&(q=h.VisualState.hover),l&&(q=h.VisualState.selected),i&&(q=h.VisualState.active),i&&!l&&(q=h.VisualState.activeNotSelected),m=e.Im.Km(q,"gc-tab-"+e.Im.Jm(q)),n=e.Im.Km(0,"gc-tab-"+e.Im.Jm(0)),o=p.pD(a,i,k,n,c),p.wJc(a,b,c,d,f,o,l,i),p.zJc(a,b,c,d,f,n,i),p.AJc(a,b,c,d,f,m,l),p.BJc(a,b,c,d,f,k,m,o,l,i,j)},b.prototype.mD=function(a,b,c,d,f,i,j,k,l,m){var n,o,p,q,r,s,t;a.save(),n=this,o=k===g.NavButtonDirection.left||k===g.NavButtonDirection.top,p=h.VisualState.highlight,m&&(p=h.VisualState.hover),o?(k===g.NavButtonDirection.left?(b-=2,d-=2):(c-=2,f-=2),q=n.rw(n.gq),q===-1&&(p=h.VisualState.normal)):(k===g.NavButtonDirection.right?(b+=2,d+=2):(c+=2,f+=2),r=n.rD(n.sD()),r===-1&&(p=h.VisualState.normal)),s=e.Im.Km(p,"gc-navButton-"+e.Im.Jm(p)),a.strokeStyle=this.tD(s.borderTopColor),a.beginPath(),t=o?1:-1,k===g.NavButtonDirection.left||k===g.NavButtonDirection.right?(a.moveTo(b-.5,c),a.lineTo(b-.5,c+1),a.moveTo(b+t-.5,c-1),a.lineTo(b+t-.5,c+2),a.moveTo(b+2*t-.5,c-2),a.lineTo(b+2*t-.5,c+3),a.moveTo(b+3*t-.5,c-3),a.lineTo(b+3*t-.5,c+4)):k!==g.NavButtonDirection.top&&k!==g.NavButtonDirection.bottom||(a.moveTo(b,c-.5),a.lineTo(b+1,c-.5),a.moveTo(b-1,c+t-.5),a.lineTo(b+2,c+t-.5),a.moveTo(b-2,c+2*t-.5),a.lineTo(b+3,c+2*t-.5),a.moveTo(b-3,c+3*t-.5),a.lineTo(b+4,c+3*t-.5)),a.stroke(),a.restore()},b.prototype.hD=function(a,b,c,d,f,g){var i,j,k,l=this;a.save(),a.beginPath(),i=(f-2*l.DJc)/2,j=h.VisualState.highlight,g&&(j=h.VisualState.hover),k=e.Im.Km(j,"gc-tabStripNewTab-"+e.Im.Jm(j)),a.lineWidth=1.5,a.strokeStyle=l.tD(k.borderTopColor),a.arc(b+d/2,c+f/2,i,0,2*Math.PI),a.stroke(),a.beginPath(),a.lineWidth=2,a.moveTo(b+d/2-4,c+f/2),a.lineTo(b+d/2+4,c+f/2),a.moveTo(b+d/2,c+f/2-4),a.lineTo(b+d/2,c+f/2+4),a.stroke(),a.restore()},b.prototype.lYJ=function(a,b,c,d){var f,g,i=this,j=15,k=5;i.TZJ()&&(j=0),a.save(),a.beginPath(),f=h.VisualState.highlight,d&&(f=h.VisualState.hover),g=e.Im.Km(f,"gc-tab-strip-all-sheets-"+e.Im.Jm(f)),a.strokeStyle=i.tD(g.borderTopColor),a.lineWidth=2,a.moveTo(b,c),a.lineTo(b+j,c),a.moveTo(b,c+k),a.lineTo(b+j,c+k),a.moveTo(b,c+2*k),a.lineTo(b+j,c+2*k),a.stroke(),a.restore()},b.prototype.gD=function(a,b,c,d,f){var g,i,j;a.save(),a.beginPath(),g=h.VisualState.highlight,i=this.lD,5!==i&&6!==i||(g=h.VisualState.hover),j=e.Im.Km(g,"gc-navMoreButton-"+e.Im.Jm(g)),a.fillStyle=this.tD(j.borderTopColor),a.fillRect(b+d/2,c+f/2,2,2),a.fillRect(b+d/2-4,c+f/2,2,2),a.fillRect(b+d/2+4,c+f/2,2,2),a.restore()},b.prototype.tD=function(a){var b=k(a),c=this.eD;return b.a<=.01?j(c):i.hc(c,b)?j(b):a},b}(g.DC),b.iv=o},"./dist/core/workbook/sheettab2007.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("Common"),f=c("./dist/core/util/common.js"),g=c("./dist/core/workbook/sheettabbase.js"),h=c("./dist/core/worksheet/stylehelper.js"),i=c("./dist/core/core.enum.js"),j=f.Ul.wl,k=null,l=Math.min,m=Math.max,n="#92A5C7",o="newSheet",p="linear-gradient",q=new e.Common.ResourceManager(d.SR,"Sheets"),r=q.getResource.bind(q),s=function(a){t(b,a);function b(b){var c=a.call(this,b)||this,d=c;return d.EC=12,d.GC=8,d.HC=3,d.kw=12,d.KC=48,d.gYJ=15,d.hYJ=28,d.LC=5,d._font="10pt Arial",c}return b.prototype.NC=function(){var a=this.OC,b=a&&a.options,c=0;return c=b&&b.tabNavigationVisible?a.Wv()*(b.useTouchLayout?2:1):0},b.prototype.PC=function(){var a=this.OC;return a&&a.options.tabNavigationVisible?a.Wv():0},b.prototype.VC=function(){var a,b=this,c=b.qJc();return c?4*b.NC()+b.lE()+b.iYJ():(a=b.jYJ(),b.TZJ()&&(a=0),Math.max(b.TC(),a))},b.prototype.lE=function(){var a=this,b=a.OC;return b&&b.options.tabNavigationVisible?2:0},b.prototype.getResizeBarBounds=function(){var a=this,b=a.Dr();return{x:b.x+b.width-a.rJc(),y:k,width:a.rJc(),height:k}},b.prototype.getNavButtonBounds=function(){var a,b,c,d,e,f,g,h,i,j=this,l=j.qJc();return l?(a=0,b=k,c=j.NC(),d=k):(g=j.Dr(),h=j.PC(),i=j.NC(),a=g.width/2-2*i,b=g.height-h,c=i,d=h),e=0,f=4,{x:a,y:b,width:c,height:d,startIndex:e,endIndex:f}},b.prototype.getSheetTabBounds=function(){var a=this,b=a.VC();return a.TZJ()&&(b-=a.iYJ()),{x:b,y:k,height:k,secondMoreTabWidth:0,moreTabPos:0}},b.prototype.getPreMoreTabBounds=function(){var a=this,b=a.VC();return a.TZJ()&&(b-=a.iYJ()),{x:b,width:a.HC+a.LC}},b.prototype.getAllSheetsBounds=function(){var a,b,c,d,e,f,g,h=this,i=h.qJc(),j=h.OC.options.newTabVisible,k=h.OC.options.tabNavigationVisible,l=h.OC.options.useTouchLayout,m=h.Dr(),n=h.getNavButtonBounds(),o=h.iYJ(),p=h.jYJ();return i?(a=n.x+4*n.width,a+=h.iYJ()/2-h.rJc()/2,0===h.rJc()&&k&&(a-=h.iYJ()/2),b=m.y,c=o,d=p):l?(e=m.x,f=m.width,j&&(e=m.x+m.width/2,f=m.width/2),a=e,b=m.y,c=f,d=p):(g=j?0:h.gYJ/-2,a=(m.x+m.width)/2+g,b=5,c=o+4,d=p),{x:a,y:b,width:c,height:d}},b.prototype.YC=function(){var a=this,b=a.qJc();return b?a.ZC+a.WC[a.$C]+a.TC()>a._C():a.ZC+2*a.sJc>a._C()},b.prototype._C=function(){var a=this,b=a.qJc();return b?a.Dr().width-a.rJc():a.Dr().height-a.PC()},b.prototype.aD=function(){var a=this.qJc();return a?1:4},b.prototype.Via=function(){return[o]},b.prototype.cD=function(){var a=this,b=a.qJc(),c=a.VC();return b&&(c+=a.Dr().height,a.OC.options.newTabVisible&&(c+=a.TC(),c+=a.HC)),c},b.prototype.dD=function(a,b){var c,d,e,g,h,i,k,l;if(a.save(),a.beginPath(),c=a.createLinearGradient(b.x,b.y,b.width,b.height),d=f.Im.Km(0,"gc-tabStripBackground"),e=d&&d.backgroundImage,g=d&&d.backgroundColor,e&&e.indexOf(p)!==-1)for(h=j(e),i=0,k=h.length;i<k;i++)l=h[i],c.addColorStop(l.point,l.color);else g&&(c.addColorStop(0,"#DDDDDD"),c.addColorStop(1,g));a.fillStyle=c,a.fillRect(b.x,b.y,b.width,b.height),a.restore()},b.prototype.fD=function(a,b,c){var d,e,f,h,i,j,k,l=this,m=l.OC,n=r().NewTab,o=l.qJc(),p=m.options.newTabVisible;p&&(d=void 0,e=0,f=void 0,h=void 0,i=l.iD===-2,o?(l.KC=a.measureText(n).width+l.EC,d=c,f=l.TC(),h=b.height,l.oD(a,d,e,f,h,void 0,!1,i,n,!1)):(j=l.iYJ(),l.TZJ()&&(j=0),k=g.NEW_TAB_SIZE_ASIDE,l.KC=k,d=(b.width-k)/2-j,f=k,h=k,l.EJc(a,d,e,f,h,i)))},b.prototype.EJc=function(a,b,c,d,e,g){var h,k,l,m,n,o,q,r,s,t=this;if(a.save(),a.beginPath(),h=(e-2*t.DJc)/2,k=i.VisualState.normal,g&&(k=i.VisualState.hover),l=f.Im.Km(k,"gc-tab-"+f.Im.Jm(k)),m=g?l.backgroundColor:l.backgroundImage,m&&m.indexOf(p)!==-1)for(n=a.createLinearGradient(b+.7*e,c+0,.7*e,e),o=j(m),q=0,r=o.length;q<r;q++)s=o[q],n.addColorStop(s.point,s.color);else n=m;a.lineWidth=1.5,a.strokeStyle=n,a.arc(b+d/2,c+e/2,h,0,2*Math.PI),a.stroke(),a.beginPath(),a.lineWidth=2,a.moveTo(b+d/2-4,c+e/2),a.lineTo(b+d/2+4,c+e/2),a.moveTo(b+d/2,c+e/2-4),a.lineTo(b+d/2,c+e/2+4),a.stroke(),a.restore()},b.prototype.jD=function(a,b,c,d){var e=this,f=c-1;e.oD(a,d,0,e.LC,b.height,f,e.$C===f,e.iD===f,"",!1)},b.prototype.kD=function(a,b){var c,d,e=this,f=e.qJc(),h=e.VC(),i=e.vJc,j=e.NC(),l=e.PC(),m=e.lD;a.fillStyle=n,f?a.fillRect(b.x,b.y,h-e.iYJ()-2,b.height):a.fillRect(b.x,b.height-l,b.width,l),f?(c=j/2,d=l/2,e.mD(a,c,d,c+i,d+i,c+i,d-i,g.NavButtonDirection.left,c-i,0===m),c+=j,e.mD(a,c,d,c+i,d+i,c+i,d-i,g.NavButtonDirection.left,k,1===m),c+=j,e.mD(a,c,d,c-i,d+i,c-i,d-i,g.NavButtonDirection.right,k,2===m),c+=j,e.mD(a,c,d,c-i,d+i,c-i,d-i,g.NavButtonDirection.right,c+4,3===m)):(c=b.width/2-1.5*j,d=b.height-l/2,e.mD(a,c,d,c+i,d+i,c-i,d+i,g.NavButtonDirection.top,d-i,0===m),c+=j,e.mD(a,c,d,c+i,d+i,c-i,d+i,g.NavButtonDirection.top,k,1===m),c+=j,e.mD(a,c,d,c+i,d-i,c-i,d-i,g.NavButtonDirection.bottom,k,2===m),c+=j,e.mD(a,c,d,c+i,d-i,c-i,d-i,g.NavButtonDirection.bottom,d+i,3===m))},b.prototype.kYJ=function(a,b){var c,d,e,f=this,g=f.OC.options,h=g.allSheetsListVisible,j=g.newTabVisible,k=f.qJc(),l=f.VC();f.TZJ()&&(l-=f.iYJ()),c=0,d=0,k?(c=4*f.NC()+1,d=5):(e=j?f.iYJ():f.iYJ()/2,c=(b.width-l)/2+e,d=10),h!==i.AllSheetsListVisibility.hide&&f.lYJ(a,c,d,f.iD===-3)},b.prototype.lYJ=function(a,b,c,d){var e,g,h,k,l,m,n,o,q,r,s,t,u,v,w,x,y,z,A,B,C,D;if(a.save(),a.beginPath(),e=this,g=e.qJc(),h=e.Dr(),k=e.iYJ(),l=f.Im.Km,m=l(4,"gc-all-sheets-button-hover"),n=l(0,"gc-all-sheets-button-normal"),o=n&&n.backgroundColor,q=n&&n.backgroundImage,q&&q.indexOf(p)!==-1)for(r=a.createLinearGradient(h.x+.7*h.height,h.y+0,.7*h.height,h.height),s=j(q),t=0,u=s.length;t<u;t++)v=s[t],r.addColorStop(v.point,v.color);if(g&&(d?(a.fillStyle=m.backgroundColor,a.fillRect(b+2,h.y+2,k-4,h.height-4)):(r?a.fillStyle=r:o&&(a.fillStyle=o),a.fillRect(b-k/2,h.y+1,e.jYJ(),h.height-2))),g)d?a.strokeStyle=m.color:a.strokeStyle=n.color;else{if(w=i.VisualState.normal,d&&(w=i.VisualState.hover),v=void 0,x=f.Im.Km(w,"gc-all-sheets-button-"+f.Im.Jm(w)),y=d?x.backgroundColor:x.backgroundImage,y&&y.indexOf(p)!==-1)for(z=e.iYJ(),v=a.createLinearGradient(b+.7*z,c+0,.7*z,z),s=j(y),t=0,u=s.length;t<u;t++)A=s[t],v.addColorStop(A.point,A.color);else v=y;a.strokeStyle=v}g?(B=3,C=12,D=4):(B=0,C=15,D=5),e.TZJ()&&(C=0,D=0,B=0),a.stroke(),a.lineWidth=1,a.moveTo(b+B,c),a.lineTo(b+C,c),a.moveTo(b+B,c+D),a.lineTo(b+C,c+D),a.moveTo(b+B,c+2*D),a.lineTo(b+C,c+2*D),a.stroke(),a.fill(),a.restore()},b.prototype.nD=function(a,b){var c,d=this,e=d.OC,g=d.rJc(),h=f.Im.Km,i=h(4,"gc-tabStripResizeBarInner"),j=h(0,"gc-tabStripResizeBarOuter");e.options.showHorizontalScrollbar&&(c=b.x+b.width-g,a.fillStyle=j.backgroundColor,a.fillRect(c,b.y,g,b.height),a.fillStyle=i.backgroundColor,a.fillRect(c+1,b.y+1,g-2,b.height-2),a.fillStyle=i.color,a.fillRect(c+g/2-1,b.y+4,2,b.height-8))},b.prototype.oD=function(a,b,c,d,e,g,h,j,k,l){var m,n=this,o=n.qJc(),p=i.VisualState.normal;(j||l)&&(p=i.VisualState.hover),m=f.Im.Km(p,"gc-tab-"+f.Im.Jm(p)),o?n.FJc(a,b,c,d,e,k,m,l,h,j):n.GJc(a,b,c,d,e,g,k,m,l,h,j)},b.prototype.FJc=function(a,b,c,d,e,f,g,j,k,l){var m,o,p,q=this,r=q.OC.options.tabStripPosition,s=q.HJc;a.save(),a.beginPath(),r===i.TabStripPosition.bottom?(a.moveTo(b,c),a.lineTo(b,c+e-s),a.arcTo(b,c+e,b+d,c+e,s),a.lineTo(b+d,c+e),a.lineTo(b+d+e,c),k||a.lineTo(b,c)):(a.moveTo(b,c+e),a.lineTo(b,c-s),a.arcTo(b,c,b+d,c,s),a.lineTo(b+d,c),a.lineTo(b+d+e,c+e),k||a.lineTo(b,c+e)),m=q.pD(a,j||l,f,g),a.fillStyle=m,a.fill(),a.strokeStyle=n,a.stroke(),a.textBaseline="top","string"==typeof m&&(o=m),a.fillStyle=q.qD(g,o),k&&(a.font=h.To.Ro(a.font,"bold")),p=q.EC,a.textBaseline="middle",a.fillText(f,b+p,c+e/2),a.restore()},b.prototype.GJc=function(a,b,c,d,e,f,g,j,k,l,m){var o,p,q,r,s,t,u=this,v=u.OC.options.tabStripPosition,w=u.OC.sheets,x=f===w.length-1,y=u.HJc,z=u.xJc,A=u.vJc,B=u.yJc,C=u.CJc;a.save(),a.beginPath(),v===i.TabStripPosition.left?(b+=z,d-=z,a.moveTo(b+d,c),a.lineTo(b+y,c),a.arcTo(b,c,b,c+y,y),a.lineTo(b,c+e-y),a.arcTo(b,c+e,b+y,c+e,y),x?a.lineTo(b+d,c+e):(a.lineTo(b+d-A,c+e),a.lineTo(b+d,c+e+A)),l||a.lineTo(b+d,c)):(d-=z,a.moveTo(b,c),a.lineTo(b+d-y,c),a.arcTo(b+d,c,b+d,c+y,y),a.lineTo(b+d,c+e-y),a.arcTo(b+d,c+e,b+d-y,c+e,y),x?a.lineTo(b,c+e):(a.lineTo(b+A,c+e),a.lineTo(b,c+e+A)),l||a.lineTo(b,c)),o=u.pD(a,k||m,g,j,c),a.fillStyle=o,a.fill(),a.strokeStyle=n,a.stroke(),a.textBaseline="top","string"==typeof o&&(p=o),q=u.qD(j,p),a.fillStyle=q,l&&(a.font=h.To.Ro(a.font,"bold")),a.textBaseline="middle",a.beginPath(),r=d-2*z,a.rect(b,c,r,e),a.clip(),a.fillText(g,b+z+B,c+e/2+2),s=a.measureText(C).width,t=a.measureText(g).width,t-s>r&&(a.beginPath(),a.fillStyle=o,a.fillRect(b+r-s,c+1.5,r,e-2.5),a.fillStyle=q,a.fillText(C,b+r-s,c+e/2+2)),a.restore()},b.prototype.mD=function(a,b,c,d,e,h,i,n,o,q){var r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;if(a.save(),r=this,s=r.qJc(),t=n===g.NavButtonDirection.left||n===g.NavButtonDirection.top,u=r.Dr(),v=r.NC(),w=f.Im.Km,x=w(4,"gc-navButton-hover"),y=w(0,"gc-navButton-normal"),z=y&&y.backgroundColor,A=y&&y.backgroundImage,A&&A.indexOf(p)!==-1)for(B=a.createLinearGradient(u.x+.7*u.height,u.y+0,.7*u.height,u.height),C=j(A),D=0,E=C.length;D<E;D++)F=C[D],B.addColorStop(F.point,F.color);s&&(q?(a.fillStyle=x.backgroundColor,a.fillRect(b-v/2+2,u.y+2,v-4,u.height-4)):(B?a.fillStyle=B:z&&(a.fillStyle=z),a.fillRect(b-v/2,u.y+1,v,u.height-2))),s?q?a.fillStyle=x.color:a.fillStyle=y.color:q?a.fillStyle=z:a.fillStyle=B?B:z,void 0!==o&&o!==k&&(n===g.NavButtonDirection.left||n===g.NavButtonDirection.right?a.fillRect(o,l(e,i),1,m(e,i)-l(e,i)):a.fillRect(l(d,h),o,m(d,h)-l(d,h),1)),t?n===g.NavButtonDirection.left?(b-=2,d-=2,h-=2):(c-=2,e-=2,i-=2):n===g.NavButtonDirection.right?(b+=2,d+=2,h+=2):(c+=2,e+=2,i+=2),a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.lineTo(h,i),a.lineTo(b,c),a.fill(),a.restore()},b}(g.DC),b.jv=s},"./dist/core/workbook/sheettabbase.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("Common"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),h=c("./dist/core/worksheet/stylehelper.js"),i=c("./dist/core/core.enum.js"),j=e.Common.pc,k=g.Ul.wl,l=g.Ul.bq,m=e.Common.j.Fa,n=g.Ul.Nl,o=g.Ul.fp,p=g.Ul.lZa,q=parseInt,r=window,s=document,t=null,u=Math.max,v=Math.min,w=Math.pow,x=Math.round,y="px",z="none",A=".gcTab",B="mousedown"+A,C="mousemove"+A,D="mouseup"+A,E="mouseout"+A,F="dblclick"+A,G="mousewheel"+A,H=".spliter",I="mousemove"+H,J="mouseup"+H,K=".tabNameEditor",L="keydown"+K,M="focus"+K,N="blur"+K,O="canvas",P="2d",Q="resize",R="navButton",S="tab",T="newSheet",U="blank",V="allSheets",W="black",X="white",Y=7,Z=10,$="navButton",_="sheetTab",b.NEW_TAB_SIZE_ASIDE=28,aa=new e.Common.ResourceManager(d.SR,"Sheets"),ba=aa.getResource.bind(aa);function ea(a,b,c){a.Wq(g.Events.SheetTabClick,{sheet:b,sheetName:b?b.name():t,sheetTabIndex:m(c)?-1:c})}function fa(a,b){a.Wq(g.Events.SheetMoving,b)}function ga(a,b,c,d){a.Wq(g.Events.SheetMoved,{sheet:b,sheetName:b?b.name():t,oldIndex:c,newIndex:d})}function ha(a,b,c,d){var e;if(b>c)for(e=c;e<b;e++)a-=d[e];else if(b<c)for(e=b;e<c;e++)a+=d[e];return a}function ia(a,b,c,d,e){return(c<d&&a>d||c>=d&&a<d)&&(b=ha(b,a,d,e),a=d),{index:a,position:b}}!function(a){a[a.left=0]="left",a[a.right=1]="right",a[a.top=2]="top",a[a.bottom=3]="bottom"}(ca=b.NavButtonDirection||(b.NavButtonDirection={})),da=function(){function a(a){this.Cj=a,this.SC=!1,this.LC=0,this.HC=0,this.xJc=6,this.IJc=3,this.HJc=5,this.vJc=5,this.yJc=3,this.DJc=7,this.CJc="...",this.buffer=null;var b=this;b.OC=t,b.$C=0,b.gq=0,b.ZC=70,b.lD=-1,b.iD=-1,b._font="",b.WC=[],b.sJc=0,b.uD=-1,b.vD=-1,b.wD=t,b.wlK=t,b.xD=0,b.Us(new g.Rect(0,0,200,28))}return a.prototype.getNewTabBounds=function(){var a,b,c,d,e,f,g=this,h=g.OC.options.useTouchLayout,i=g.Dr(),j=g.TC(),k=(j-2*g.DJc)/2;return h?(e=i.width,g.TZJ()||(e/=2),a=i.x,b=i.y,c=e,d=j):(f=(i.x+i.width-2*k)/2,g.TZJ()||(f-=g.iYJ()),a=f,b=(i.y+j-2*k)/2,c=2*k,d=2*k),{x:a,y:b,width:c,height:d}},a.prototype.getCanvas=function(){return this.Xs},a.prototype.qJc=function(){var a=this,b=a.OC.options.tabStripPosition;return b===i.TabStripPosition.bottom||b===i.TabStripPosition.top},a.prototype.ws=function(b){var c,d,e;b&&(c=this,d=c.Xs,d&&c.no(!0),e=n(O),g.En.Kn(e,c.OC),e.setAttribute("id",c.Cj),c.yD=c.zD(),c.JJc(),b.appendChild(c.yD[0]),b.appendChild(e),c.Xs=e,f.GC$(e).bind(B,function(a){return c.AD(a)}).bind(C,function(a){return c.BD(a)}).bind(D,function(a){return c.CD(a)}).bind(E,function(a){return c.DD(a)}).bind(F,function(a){return c.ED(a)}).bind(G,function(a){return c.Rw(a)}),c.fq(),a.ao(c,"setHost"))},a.prototype.Yv=function(a){var b,c=this;c.OC=a,a&&(b=a.options.font,b&&b.length>0&&(c._font=b),c.JJc())},a.prototype.DLc=function(a){var b=this.OC;b.suspendPaint(),this.ELc(a),b.resumePaint()},a.prototype.ELc=function(a){var b,c=this,d=-1,e=c.sD();if(!(e.length<=0))for(;;){if(b=c.PJc().tabsInfo,d===b[0].index)return;if(d=b[0].index,b[0].index>a)c.$D(e);else{if(!(b[b.length-1].index<a||b[b.length-1].index===a&&b.length>1))return;c._D(e)}}},a.prototype.Dr=function(){var a=this.Zs;return new g.Rect(a.x,a.y,a.width,a.height)},a.prototype.Us=function(a){var b=this.Zs=new g.Rect(0,0,0,0);b.x=a.x,b.y=a.y,b.width=a.width,b.height=a.height},a.prototype.TC=function(){var a=this,b=a.OC.options.newTabVisible;return b?this.KC:0},a.prototype.iYJ=function(){var a=this,b=a.OC,c=b.options.allSheetsListVisible;return c!==i.AllSheetsListVisibility.hide?this.gYJ:0},a.prototype.jYJ=function(){var a=this,b=a.OC,c=b.options.allSheetsListVisible;return c!==i.AllSheetsListVisibility.hide?this.hYJ:0},a.prototype.UC=function(){var a=this,b=a.Dr(),c=a.qJc();return c?b.x+b.width-a.rJc():b.y+b.height-a.PC()},a.prototype.VC=function(){return 0},a.prototype.rJc=function(){var a=this,b=i.TabStripPosition.bottom,c=a.OC;return c&&(b=c.options.tabStripPosition),b===i.TabStripPosition.bottom?a.kw:0},a.prototype.fq=function(){var a,b,c,d,e=this,h=e.Ws();h&&h.parentNode&&(a=f.GC$(h.parentNode),0!==a.width()&&0!==a.height()&&(b=u(a.width(),0),c=u(a.height(),0),h.style.display=z,h.width=b,h.height=c,h.style.display="",h.style.width=b+y,h.style.height=c+y,b=h.clientWidth||h.width,c=h.clientHeight||h.height,d=e.Dr(),e.Us(new g.Rect(d.x,d.y,b,c)),g.En.Pn(h,b,c),e.repaint()))},a.prototype.YC=function(){return!1},a.prototype.PC=function(){return 0},a.prototype._C=function(){return 0},a.prototype.aD=function(){return 0},a.prototype.Via=function(){return[]},a.prototype.cD=function(){return 0},a.prototype.zD=function(){return this.yD?this.yD:f.GC$(n("div"))},a.prototype.JJc=function(){var a,b,c,d=this,e=d.yD;e&&(a=d.OC,b=a?a.options.tabStripPosition:i.TabStripPosition.bottom,c=void 0,b===i.TabStripPosition.bottom?c="gc-tab-indicator-bottom":b===i.TabStripPosition.top?c="gc-tab-indicator-top":b===i.TabStripPosition.left?c="gc-tab-indicator-left":b===i.TabStripPosition.right&&(c="gc-tab-indicator-right"),e.removeClass(),e.addClass(c))},a.prototype.no=function(b){var c,d=this,e=d.Xs;e&&(c=e.parentNode,f.GC$(e).unbind(B).unbind(C).unbind(D).unbind(F).unbind(E),c&&c.removeChild(e)),f.GC$(d.yD).remove(),a.ao(d,"dispose"),b||(d.OC=t)},a.prototype.KJc=function(a,b){var c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this,x=w.OC,y=x.options.scrollbarAppearance===i.ScrollbarAppearance.mobile,z=x.options.showHorizontalScrollbar,A=w.Dr();
if(z&&!y&&(c=w.getResizeBarBounds(),x.options.showHorizontalScrollbar&&!y&&a>c.x&&a<A.x+A.width))return{type:"resize",element:Q};for(d=w.getNavButtonBounds(),e=-1,f=d.startIndex,g=d.x,h=d.endIndex,j=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],k=f;k<h;k++){if(g<a&&a<g+d.width){e=k,R=j[k];break}g+=d.width}if(e!==-1)return{type:$,element:R,index:k};if(l=w.getAllSheetsBounds(),g=l.x,m=x.options.allSheetsListVisible,n=!0,w.TZJ()&&(n=!1),m!==i.AllSheetsListVisibility.hide&&g<=a&&a<g+l.width&&n)return{type:_,element:V,position:g,index:-1};if(o=w.getPreMoreTabBounds(),g=o.x,p=0,q=w.rw(w.gq),q!==-1){if(g<=a&&a<g+o.width)return R=j[5],{type:$,element:R,index:5,position:g};p=w.LC}if(r=w.getSheetTabBounds(),s=x.xCJ(),t=w.WC,u=w.HC,v=0,g=r.x+p,w.gq>-1)for(k=w.gq;k<s.length&&k<t.length;k++)if(s[k].visible()===i.SheetTabVisible.visible){if(v=t[k],g<a&&a<g+v+u){if(r.moreTabPos>0&&a<r.moreTabPos)return{type:_,element:S,index:k,position:g};if(0===r.moreTabPos)return{type:_,element:S,index:k,position:g}}g+=v+u}if(g>r.moreTabPos&&r.moreTabPos>0&&(g=r.moreTabPos),w.rD(w.sD())!==-1){if(g<a&&a<g+r.secondMoreTabWidth)return R=j[6],{type:$,element:j[6],index:6,position:g}}else if(g<a&&a<g+r.secondMoreTabWidth)return{element:U,position:g};return g+=r.secondMoreTabWidth,x.options.newTabVisible&&g<a&&a<g+w.TC()?{type:_,element:T,position:g,index:-1}:{element:U}},a.prototype.LJc=function(a,b){var c,d,e,f,g,h,j,k,l,m,n=this,o=n.OC,p=n.getNavButtonBounds(),q=-1,r=p.x,s=p.y,t=p.startIndex,v=p.endIndex,w=["first","prevArrow","nextArrow","last","","prevButton","nextButton"];for(c=t;c<v;c++){if(r<a&&a<r+p.width&&s<b&&b<s+p.height){q=c,R=w[c];break}r+=p.width}if(q!==-1)return{type:$,element:R,index:c};if(d=n.TC(),e=o.options.allSheetsListVisible,f=n.jYJ(),g=!0,n.TZJ()&&(f=0,g=!1),s=u(d,f),h=o.xCJ(),j=n.WC,k=n.sJc,n.gq>-1)for(c=n.gq;c<h.length&&c<j.length;c++)if(h[c].visible()===i.SheetTabVisible.visible){if(s<b&&b<s+k)return{type:_,element:S,index:c,position:s};s+=k}return l=n.getNewTabBounds(),o.options.newTabVisible&&l.x<a&&a<l.x+l.width&&l.y<b&&b<l.y+l.height?{type:_,element:T,position:s,index:-1}:(m=n.getAllSheetsBounds(),e!==i.AllSheetsListVisibility.hide&&m.x<a&&a<m.x+m.width&&m.y<b&&b<m.y+m.height&&g?{type:_,element:V,position:s,index:-1}:s<b&&b<s+p.y?n.rD(n.sD())!==-1?(R=w[6],{type:$,element:w[6],index:6,position:s}):{element:U,position:s}:{element:U})},a.prototype.hitTest=function(a,b){var c,d=this,e=d.qJc();return c=e?d.KJc(a,b):d.LJc(a,b)},a.prototype.AD=function(b){var c,d,e,g,h,i,j,k=this,l={e:b,r:t};return a.ao(k,"preProcessMouseDown",l),c=l.r,m(c)?(d=f.GC$(k.Ws()).offset(),e=b.pageX-d.left,g=b.pageY-d.top,h=k.OC.zCJ(),k.FD&&k.GD(h,!1),i=k.hitTest(e,g),j=i.element,0===b.button&&(j===Q?(k.HD=!0,k.ID=b.pageX,k.tC()):j===R?k.JD(i.index):j===S?(k.KD(i.index,i.position,b),k.LD(b,i)):j===T?k.MD(i.position):j===V&&k.mYJ(b),k.xlK()),k.ND=!0,!1):c},a.prototype.xlK=function(){var a=this,b=a.OC.zCJ();b&&!b.isEditing()&&b.zt()},a.prototype.mYJ=function(a){var b=this,c=b.OC;return c.commandManager().execute({cmd:"showAllSheetsDialog",mouseEvent:a})},a.prototype.BD=function(b){var c,d,e,h,i,j,k,l,n,o,p,q,r,s,u,v,x=this,y=x.OC,z=g.UCJ(y),A={e:b,r:t};if(a.ao(x,"preProcessMouseMove",A),c=A.r,!m(c))return c;if(d=x.Xs.style,e="default",h="w-resize",x.OD&&!x.PD&&(i=Math.sqrt(w(x.OD.x-b.pageX,2)+w(x.OD.y-b.pageY,2)),i>Z&&(x.PD=!0)),x.HD)d.cursor=h,j=b.pageX-x.ID,k=z.getHDockScrollbarWidth(),l=x.OC.xs.clientWidth-k,y.options.tabStripRatio=y.Iv()+j/l,n=x.rJc()/l,o=1,y.Iv()<n?(y.options.tabStripRatio=n,x.ID=x.rJc()):y.Iv()>=o?(y.options.tabStripRatio=o,x.ID=l):x.ID=b.pageX,y.aq();else if(x.PD)x.QD(b.pageX,b.pageY),x.RD(b);else{if(x.lD=-1,x.iD=-1,p=f.GC$(x.Ws()).offset(),q=b.pageX-p.left,r=b.pageY-p.top,s=x.hitTest(q,r),u=s.element,x.OC&&x.OC.options.enableAccessibility&&(v=x.DHb(s),x.OC.EHb(v)),""===u)return d.cursor=e,x.repaint(),!1;u===Q?d.cursor=h:(d.cursor=e,u===R?x.lD=s.index:u===S?x.iD=s.index:u===T?x.iD=-2:u===V&&(x.iD=-3)),x.repaint()}return!1},a.prototype.DHb=function(a){var b,c,d=ba(),e="",f=a.element;return f===Q?e=d.ARIA_Resize:f===R?(b={first:d.ARIA_First,prevArrow:d.ARIA_PreviousArrow,nextArrow:d.ARIA_NextArrow,last:d.ARIA_Last,prevButton:d.ARIA_PreviousButton,nextButton:d.ARIA_NextButton},e=b[R]||""):f===S?(c=this.OC.ACJ(a.index).name(),e=d.ARIA_SheetTab+" "+c.replace(/([0-9]+)/," $1 ")):f===T?e=d.ARIA_NewSheet:f===U&&(e=d.ARIA_Blank),e},a.prototype.CD=function(b){var c,d=this,e={e:b,r:t};return a.ao(d,"preProcessMouseUp",e),c=e.r,m(c)?(d.HD&&(d.HD=!1,d.OC.aq()),d.SD(),d.PD&&(d.PD=!1,d.TD.remove(),d.UD(),d.yD.hide()),d.OD=t,d.VD(),d.uC(),!d.ND||(d.ND=!1,!1)):c},a.prototype.DD=function(b){var c,d,e,f=this,g={e:b,r:t};return a.ao(f,"preProcessMouseOut",g),c=g.r,m(c)?(f.VD(),d=f.lD,f.lD=-1,e=f.iD,f.iD=-1,f.lD===d&&f.iD===e||f.repaint(),!1):c},a.prototype.tC=function(){var a=this;a.WD||(f.GC$(s).bind(I,function(b){a.BD(b)}).bind(J,function(b){a.CD(b)}),a.ylK(!0),a.WD=!0)},a.prototype.ylK=function(a){var b=this,c=b.OC.getActiveSheet();c&&(c.XD=a)},a.prototype.uC=function(){if(this.WD){this.WD=!1,f.GC$(s).unbind(I).unbind(J);var a=this.OC.getActiveSheet();a&&delete a.XD}},a.prototype.JD=function(a,b){var c,d,e=this;e.VD(),c=e.sD(),c.length<=0||(d=200,a%=4,0===a?e.YD(c):1===a?(b||(e.ZD=r.setTimeout(function(){e.JD(1)},d)),e.$D(c)):2===a?(b||(e.ZD=r.setTimeout(function(){e.JD(2)},d)),e._D(c)):3===a&&e.aE(c))},a.prototype.KD=function(a,b,c){var d=this,e=d.OC,f=e.NjK,g=e.ACJ(a),h=f&&f.sheetsState;h&&0===h[g.name()]?(d.wlK!==t&&clearTimeout(d.wlK),d.wlK=setTimeout(function(){d.zlK(a,b,c),d.ylK(!0),d.wlK=t,d.xlK()})):d.zlK(a,b,c)},a.prototype.zlK=function(a,b,c){var d,e,f,g=this,h=g.OC;g.$C=a,g.ZC=b,h.suspendPaint(),d=h.getActiveSheet(),e=h.ACJ(a),e&&e.isEditing()&&e!==d&&(f=d&&d.Cw&&d.Cw.V4,!e.gv(void 0,void 0,f))||(ea(h,e,a),g.iw(a,c),h.resumePaint(),g.repaint())},a.prototype.FHb=function(a,b,c,d,e,f){var h={oldValue:c,newValue:d,sheetName:e,propertyName:"isSelected",cancel:!1,sheetIndex:f};a.Wq(g.Events.SheetChanging,h),h.cancel||(b.HHb(d),a&&a.MJc&&a.MJc.repaint(),delete h.cancel,a.Wq(g.Events.SheetChanged,h))},a.prototype.MD=function(a){var b,c,d,e,f,h=this,i=h.OC,j=h.qJc(),k=i.getActiveSheet();if((!h.bE||h.bE(k))&&(ea(i,t,t),b=i.xCJ(),c=i.getSheetCount(),d=i.vv(i.wv(c)),b.forEach(function(a){a.HHb(!1,!0)}),e=d.name(),f={sheetName:e,propertyName:"insertSheet",cancel:!1,sheetIndex:c},h.FHb(i,d,!1,!0,e,c),i.Wq(g.Events.SheetChanging,f),!f.cancel)){for(i.ow(c,1,d),i.Wq(g.Events.SheetChanged,{sheetName:d.name(),propertyName:"insertSheet",sheetIndex:c}),h.$C=c,h.ZC=a,i.BCJ(i.sheets.length-1,1,!1,!0);h.$C>h.gq&&(h.YC()||h.gq<h.jw(-1));)h.hE(h.gq)&&(h.ZC-=j?h.WC[h.gq]:h.sJc),h.gq++;h.repaint()}},a.prototype.iw=function(a,b){var c,d,e,f,h,j,k,l,m,n,o=this,p=o.OC,q=p.xCJ(),r=o.qJc(),s=p.getActiveSheet();o.pWJ&&!o.pWJ(s)||(c=!1,s&&s.Cw&&s.Cw.V4&&(c=!0),d=!!b,d&&(h=g.Ul.sl(),e=h?b.metaKey:b.ctrlKey,f=b.shiftKey),a!==p.eq?(e?(j=q[a],j.HHb()?j.HHb(!1,!0):(j.HHb(!0,!0),s&&!s.HHb()&&s.HHb(!0,!0))):f?(k=q.slice(v(p.eq,a),u(p.eq,a)+1),q.forEach(function(a){a.visible()===i.SheetTabVisible.visible&&(k.indexOf(a)!==-1?a.HHb()||a.HHb(!0,!0):a.HHb()&&a.HHb(!1,!0))})):(l=q.every(function(a){return a.visible()!==i.SheetTabVisible.visible||a.HHb()}),q[a].HHb()&&!l||q.forEach(function(a){a.HHb(!1,!0)}),j=q[a],j.HHb()||j.HHb(!0,!0),p.BCJ(a,1,c,!0)),m=o.jw(o.gq),n=!1,n=r?o.ZC+o.WC[o.$C]>o._C():o.ZC+o.sJc>=o._C(),o.$C>o.gq&&n&&m!==-1&&(o.gq=m)):f&&q.forEach(function(a){var b=a.name(),c=p.getSheetIndex(b);c!==p.eq&&a.HHb()&&a.visible()===i.SheetTabVisible.visible&&a.HHb(!1,!0)}),o.$C<o.gq&&(o.gq=o.rw(o.gq)))},a.prototype.cE=function(a,b){var c,d,e,h,j,k,l,m,o,p,r,s,u,v,w,x=this,A=x.OC,B=x.qJc(),C=A.options.tabStripPosition,D=q(g.Im.Lm("").zIndex),E=x.hitTest(a,b);if(E.element===S){if(c=x.$C,d=A.ACJ(c),E.index!==c)return;if(A.Wq(g.Events.SheetTabDoubleClick,{sheet:d,sheetName:d.name(),sheetTabIndex:c}),!A.options.tabEditable)return!1;if(e=g.Vl.Xl(),e&&e.endEdit&&!e.endEdit())return;g.Vl.Zl(t),h=f.GC$(x.Ws()).offset(),j=A.pZJ(),k=f.GC$(j).offset(),l=f.GC$(j).width(),m=n("input"),o=m.style,m.type="text",m.value=d.name(),m.setAttribute("contentEditable","true"),m.setAttribute("autocomplete","off"),o.position="absolute",o.margin="0px",o.padding="0px",p=void 0,r=void 0,s=void 0,u=void 0,v=x.WC[c],B?(u=v-x.EC-x.GC+2,s=h.top-k.top+x.aD(),p=h.left-k.left+x.ZC+x.EC):(w=x.Dr(),u=v-x.EC-x.GC+2,s=h.top-k.top+x.ZC+x.aD(),p=h.left-k.left+w.x+x.xJc+x.yJc,C===i.TabStripPosition.left&&2007===D&&(p+=x.xJc),C===i.TabStripPosition.right&&p+u>l&&(r=h.left+w.width-l+x.xJc+x.yJc)),r?o.right=r+y:p&&(o.left=p+y),o.top=s+y,o.width=u+y,o.backgroundColor=X,o.borderWidth="0px",o.outline=z,o.zIndex="1",f.GC$(m).appendTo(j),x.FD=m,f.GC$(m).addClass("gc-sheetTabEditor").bind(L,function(a){return 13===a.keyCode?(x.GD(d,!1),!1):27===a.keyCode?(x.GD(d,!0),!1):void 0}).bind(M,function(){m.selectionStart=0,m.selectionEnd=m.value.length}).bind(N,function(){x.GD(d,!1)}),m.focus()}return!1},a.prototype.ED=function(b){var c,d,e,g,h=this,i={e:b,r:t};return a.ao(h,"preProcessMouseDbClick",i),c=i.r,m(c)?(d=f.GC$(h.Ws()).offset(),e=b.pageX-d.left,g=b.pageY-d.top,h.cE(e,g)):c},a.prototype.Rw=function(a){var b,c,d=this,e=d.qJc(),f=!m(d.FD);return e||f||(m(a.wheelDelta)&&m(a.detail)&&(a.wheelDelta=a.originalEvent.wheelDelta,a.detail=a.originalEvent.detail),b=a.detail?a.detail:a.wheelDelta,c=d.sD(),b>0?d.$D(c):d._D(c)),!1},a.prototype.GD=function(a,b){var c,d,e,h=this,i=h.FD;i&&(f.GC$(i).unbind(L).unbind(M).unbind(N),c=i.value,b===!1&&(d=a.name(),c!==d&&(e={message:""},l(c,h.OC.xCJ(),a,e)&&!m(c)&&""!==c?a.getParent().commandManager().execute({cmd:"renameSheet",sheetName:d,name:c}):a.Wq(g.Events.InvalidOperation,{sheet:a,sheetName:a.name(),invalidType:5,message:e.message}))),i.parentNode.removeChild(i),delete h.FD)},a.prototype.dE=function(){return this.OC.options.allowSheetReorder},a.prototype.LD=function(a,b){var c=this;c.dE()?(c.vD=b.index,c.TD=c.eE(c.vD),c.OD=new g.Point(a.pageX,a.pageY),c.tC()):c.PD=!1},a.prototype.eE=function(a){var b,c,d=this.OC.xCJ(),e=d.length;if(!(a>=e||a<0))return b=d[a].name(),b||(b="sheet"),c=f.GC$(n("span")).text(b).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"}),c.addClass("ui-widget-header gc-tab-tip-span btn-primary"),c},a.prototype.VD=function(){var a=this.ZD;a&&(clearTimeout(a),this.ZD=t)},a.prototype.QD=function(a,b){var c,d,e=this,g=e.TD;g&&0===f.GC$(".gc-tab-tip-span").length&&(g.appendTo(s.body),g.hide()),c=g.width(),d=g.height(),g.css({left:a-c/2,top:b-d/2}),g.show()},a.prototype.RD=function(a){var b,c,d,e,g,h,j,k=this,l=k.OC,n=f.GC$(k.Ws()),o=n.position(),p=n.offset(),q=a.pageX-p.left,s=a.pageY-p.top,u=k.hitTest(q,s),v=u.element,w=k.Dr(),x=k.VC(),y=k.OC.xCJ().length,z=100,A=l.options.tabStripPosition,B=k.qJc(),C=k.TC(),D=k.yD,E=B?q:s;b=B?w.x+k._C():w.y+k._C()+C,E>b?k.wD===t&&k.uD<y&&(k.wD=r.setInterval(function(){k._D(k.sD()),k.uD===y?(k.SD(),A===i.TabStripPosition.bottom?(c=o.left+k.fE()-Y/2,d=o.top-Y/2):A===i.TabStripPosition.top?(c=o.left+k.fE()-Y/2,d=o.top+w.height):A===i.TabStripPosition.left?(c=o.left+w.width,d=o.top+k.fE()-Y/2):A===i.TabStripPosition.right&&(c=o.left-Y/2,d=o.top+k.fE()-Y/2),D.show()):(k.uD++,D.hide()),D.css({left:c,top:d})},z)):E<x?k.wD===t&&k.uD>0&&(k.wD=r.setInterval(function(){k.$D(k.sD()),0===k.uD?(k.SD(),A===i.TabStripPosition.bottom?(c=o.left+x-Y/2,d=o.top-Y/2):A===i.TabStripPosition.top?(c=o.left+x-Y/2,d=o.top+w.height):A===i.TabStripPosition.left?(c=o.left+w.width,d=o.top+C-Y/2):A===i.TabStripPosition.right&&(c=o.left-Y,d=o.top+C-Y/2),D.show()):(k.uD--,D.hide()),D.css({left:c,top:d})},z)):(k.SD(),v!==S&&k.Via().indexOf(v)===-1||(e=u.index,v===U&&(e=k.uD),(v!==S||m(e))&&(e=y),g=ia(e,u.position,k.vD,y,k.WC),h=g.index,j=g.position,k.uD=h,A===i.TabStripPosition.bottom?(c=o.left+j-Y/2,d=o.top-Y):A===i.TabStripPosition.top?(c=o.left+j-Y/2,d=o.top+w.height):A===i.TabStripPosition.left?(c=o.left+w.width,d=o.top+j-Y/2):A===i.TabStripPosition.right&&(c=o.left-Y,d=o.top+j-Y/2),D.css({left:c,top:d}),D.show()))},a.prototype.fE=function(){var a,b=this,c=b.qJc(),d=b.WC,e=b.sD(),f=b.gE(b.gq,e),g=0,h=b.VC(),i=b.sJc,j=c?h+b.LC:h;for(a=f;a<e.length;a++)g=e[a],c?(j+=d[g],j+=b.HC):j+=i;return j},a.prototype.SD=function(){var a=this.wD;a&&(clearInterval(a),this.wD=t)},a.prototype.UD=function(){var a,b,c,d=this,e=d.OC,f=d.uD,g=d.vD,h=e.xCJ();if(e.suspendPaint(),this.gVJ(h)){for(a=[],b=0;b<h.length;b++)h[b].HHb()&&(h[b].HHb(!1),a.push(h[b]));for(b=a.length-1;b>=0&&!(e.getSheetIndex(a[b].name())<=f);b--)e.commandManager().execute({cmd:"moveSheet",sheetName:a[b].name(),targetIndex:f});for(f-=1,b=0;b<a.length&&!(e.getSheetIndex(a[b].name())>f);b++)e.commandManager().execute({cmd:"moveSheet",sheetName:a[b].name(),targetIndex:f})}else c=e.ACJ(g),f!==-1&&g!==-1&&g!==f&&g!==f-1&&d.yD.isVisible()&&(g<f-1&&(f-=1),e.commandManager().execute({cmd:"moveSheet",sheetName:c.name(),targetIndex:f}));e.resumePaint()},a.prototype.gVJ=function(a){var b,c=[];for(b=0;b<a.length;b++)if(a[b].HHb()&&(c.push(a[b]),c.length>1))return!0;return!1},a.prototype.VMJ=function(a,b){var c,d=this,e=d.OC,f=d.sD();return b===e.getSheetCount()?(d.aE(f),void d.fq()):0===b?(d.YD(f),void d.fq()):(c=d.DKJ(a,b),void(c&&(b>a&&b++,d.DLc(b))))},a.prototype.DKJ=function(a,b){var c,d=this,e=d.PJc().tabsInfo,f=!1,g=!1;for(c=0;c<e.length-2;c++)if(a===e[c].index&&(f=!0),b===e[c].index&&(g=!0),f&&g)return d.fq(),!1;return!0},a.prototype.sD=function(){var a,b=[],c=this.OC.xCJ();for(a=0;a<c.length;a++)this.hE(a)&&b.push(a);return b},a.prototype.YD=function(a){a.length>0&&this.gq!==a[0]&&this.OC.startSheetIndex(a[0])},a.prototype.$D=function(a){var b,c;a.length>0&&(b=this,b.gq>a[0]&&(c=b.rw(b.gq),c!==-1&&b.OC.startSheetIndex(c)))},a.prototype._D=function(a){var b,c;a.length>0&&(b=this,b.gq<a[a.length-1]&&(c=b.rD(a),c!==-1&&b.OC.startSheetIndex(b.jw(b.gq))))},a.prototype.aE=function(a){if(a.length>0&&this.gq<a[a.length-1]){var b=this.rD(a);b!==-1&&this.OC.startSheetIndex(b)}},a.prototype.rD=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;if(a.length>0)for(b=this,c=b.qJc(),d=b.sJc,e=b._C(),f=0,g=b.WC,h=void 0,i=void 0,j=b.cD(),k=b.gE(b.gq,a),k===-1&&(k=0),h=a.length-1;h>=k;h--)if(i=a[h],l=c?g[i]:d,f+=l,h!==a.length-1&&(f+=c?b.HC:0),m=j+f,0!==h&&(m+=c?b.LC:d),m>e)return n=void 0,n=h+1<a.length?a[h+1]:a[a.length-1],b.gq<n?n:-1;return-1},a.prototype.rw=function(a){var b;for(b=a-1;b>=0;b--)if(this.hE(b))return b;return-1},a.prototype.jw=function(a){var b,c=this.OC.xCJ().length;for(b=a+1;b<c;b++)if(this.hE(b))return b;return-1},a.prototype.gE=function(a,b){var c;for(c=0;c<=b.length-1;c++)if(a===b[c])return c;return-1},a.prototype.hE=function(a){var b=this.OC.ACJ(a);return!(!b||b.visible()!==i.SheetTabVisible.visible)},a.prototype.UZJ=function(){var a=this,b=a.rw(a.gq),c=a.sD().length*a.sJc,d=a.hYJ,e=a.PC()/2,f=a.Dr().height,g=c+d+e>f;return g||b!==-1},a.prototype.VZJ=function(){var a=this,b=a.rw(a.gq),c=a.rD(a.sD());return b!==-1||c!==-1},a.prototype.TZJ=function(){var a=this,b=a.OC.options,c=b.allSheetsListVisible,d=a.qJc();if(d){if(!a.VZJ()&&c===i.AllSheetsListVisibility.auto)return!0}else if(!a.UZJ()&&c===i.AllSheetsListVisibility.auto)return!0},a.prototype.fw=function(){this.xD++},a.prototype.gw=function(){var a=this;a.xD--,a.xD<=0&&(a.xD=0,a.repaint())},a.prototype.repaint=function(a){var b=this.Ws();b&&b.getContext&&this.jp(b.getContext(P),a)},a.prototype.jp=function(a,b){var c,d,e,f,h,i,j,k,l,m,o,p,q,r=this;if(!(r.xD>0)){if(c=r.Dr(),d=r.Xs,b){if(b.x>=c.x+c.width)return;if(b.y>=c.y+c.height)return;if(b.x+b.width>c.width&&(b.width=c.width-b.x,b.width<=0))return;if(b.y+b.height>c.height&&(b.height=c.height-b.y,b.height<=0))return;if(b.width<=0||b.height<=0)return}if(f=r.buffer,f&&(!f||f.width===d.width&&f.height===d.height)&&(f||f.width===c.width&&f.height===c.height)||(f&&g.En.Rn(r.OC,f),r.buffer=f=n(O),g.En.Kn(f,r.OC),g.En.Pn(f,c.width,c.height)),!(c.width<=0||c.height<=0||b&&(b.width<=0||b.height<=0))){e=r.buffer.getContext(P),e.clearRect(0,0,c.width,c.height),g.Bn.Dn(e,-c.x,-c.y),r.iE(e,b),g.Bn.Dn(e,c.x,c.y),h=c.x>=0?0:-c.x,i=c.y>=0?0:-c.y,j=h,k=i,b&&(j=c.x+b.x,k=c.y+b.y,c=new g.Rect(j,k,b.width,b.height)),h=c.x>=0?c.x:0,i=c.y>=0?c.y:0,o=t,p=g.En.Ln(d),q=g.En.Mn(d),d&&1!==p&&(j*=p,k*=q,c.x*=p,c.y*=q,c.width*=p,c.height*=q);try{d?b?(l=u(c.width-j,0),m=u(c.height-k,0)):(l=v(c.width-j,u(d.width-c.x,3)),m=v(c.height-k,u(d.height-c.y,3))):(j=b.x,k=b.y,l=b.width,m=b.height),d?(g.Bn.Cn(a,1,1),a.clearRect(h,i,l,m),a.drawImage(r.buffer,j,k,l,m,h,i,l,m),g.Bn.Cn(a,p,q)):(e=r.buffer.getContext(P),o=e.getImageData(j,k,l,m))}catch(a){return}!d&&o&&c.width>0&&c.height>0&&a.putImageData(o,h,i)}}},a.prototype.NJc=function(a,b){var c=this,d=c.Dr();b?a.rect(b.x,b.y,b.width,b.height):a.rect(d.x,d.y,d.width,d.height),a.clip()},a.prototype.OJc=function(a){var b,c,d,e=this,f=e.OC,g=e.qJc();for(a.save(),a.font=h.To.Ro(a.font,"bold"),e.WC=[],d=f.xCJ(),c=0;c<d.length;c++)b=Math.round(a.measureText(d[c].name()).width)+e.GC+e.EC,e.WC.push(b);g||(e.sJc=o(a.font)+2*e.IJc),a.restore()},a.prototype.PJc=function(){var a,b,c,d,e,f=this,g=f.OC,h=g.xCJ(),j=f.qJc(),k=f.Dr(),l=[],m=f.VC();for(f.TZJ()&&j&&(m-=f.iYJ()),a=m,c=f.gq,j&&c>0&&f.rw(c)>=0&&(a+=f.LC),c<0&&(f.gq=0),d=f.gq;d<h.length;d++){if(e=h[d].visible(),b=f.WC[d],j){if(a>k.x+k.width)break}else if(a>k.y+k.height)break;l.push({index:d,position:a,width:b,text:h[d].name(),visible:e}),e===i.SheetTabVisible.visible&&(a+=j?b+f.HC:f.sJc)}return{tabsInfo:l,newTabStartPosition:a}},a.prototype.iE=function(a,b){var c,d,e=this,f=e.OC,g=f.options.scrollbarAppearance===i.ScrollbarAppearance.mobile,h=f.options.tabStripPosition,j=f.options.showHorizontalScrollbar;a&&f&&(c=e.Dr(),a.save(),p(a,e._font),e.NJc(a,b),a.beginPath(),e.OJc(a),d=e.PJc(),e.dD(a,c),e.fD(a,c,d.newTabStartPosition),e.kYJ(a,c),d=e.PJc(),e.jE(a,c,d.tabsInfo),e.OC&&e.OC.options.tabNavigationVisible&&e.kD(a,c),j&&!g&&h===i.TabStripPosition.bottom&&e.nD(a,c),a.beginPath(),a.restore())},a.prototype.dD=function(a,b){},a.prototype.fD=function(a,b,c){},a.prototype.QJc=function(a,b){var c,d,e=this,f=e.qJc(),g=e.VC();e.TZJ()&&(g-=e.iYJ()),f?(c=b.x+e._C(),a.rect(g,0,c-g,b.height)):(d=e.PC(),a.rect(0,g,b.width,b.height-g-d)),a.clip()},a.prototype.RJc=function(a,b,c){var d,e,f,g=this,h=g.OC,j=g.qJc(),k=g.$C,l=g.iD;for(d=c.length-1;d>=0;d--)e=c[d],e.index!==k&&e.visible===i.SheetTabVisible.visible&&(f=h.yCJ(e.text).HHb(),j?g.oD(a,e.position,0,e.width,b.height,e.index,!1,e.index===l,e.text,f):g.oD(a,0,e.position,b.width,g.sJc,e.index,!1,e.index===l,e.text,f))},a.prototype.SJc=function(a,b,c){var d,e,f=this,g=f.OC,h=g.xCJ(),i=f.qJc(),j=f.$C,k=f.gq,l=c[j-k];j>=k&&j<h.length&&l&&l.visible&&(d=g.zCJ(),d&&(e=d.HHb(),i?f.oD(a,l.position,0,l.width,b.height,j,!0,!1,l.text,e):f.oD(a,0,l.position,b.width,f.sJc,j,!0,!1,l.text,e)))},a.prototype.TJc=function(a,b){var c=this,d=c.gq,e=c.qJc(),f=c.VC();d>0&&c.rw(d)>=0&&e&&c.jD(a,b,d,f)},a.prototype.jE=function(a,b,c){var d=this,e=d.OC,f=e.xCJ();d.$C=e.TCJ(),f.length>0&&(a.save(),a.beginPath(),d.QJc(a,b),d.RJc(a,b,c),d.SJc(a,b,c),a.restore(),a.save(),a.beginPath(),d.TJc(a,b),a.restore())},a.prototype.jD=function(a,b,c,d){},a.prototype.kD=function(a,b){},a.prototype.kYJ=function(a,b){},a.prototype.nD=function(a,b){},a.prototype.mD=function(a,b,c,d,e,f,g,h,i,j){},a.prototype.oD=function(a,b,c,d,e,f,g,h,i,j){},a.prototype.Ws=function(){return this.Xs},a.prototype.kE=function(a,b){var c,d,e,f,h=a.createLinearGradient(b.x,b.y,b.width,b.height),j=g.Im.Km(i.VisualState.normal,"gc-tabStripBackground"),l=j&&j.backgroundImage,m=j&&j.backgroundColor;if(l&&l.indexOf("linear-gradient")!==-1)for(c=k(l),d=0,e=c.length;d<e;d++)f=c[d],h.addColorStop(f.point,f.color);else m&&(h.addColorStop(0,"#DDDDDD"),h.addColorStop(1,m));return h},a.prototype.pD=function(a,b,c,d,e){var f,h,i,j,l,m,n,o,p,q,r,s,t,u,v,w=this,x=w.qJc(),y=w.Dr();if(x?f=a.createLinearGradient(y.x+.7*y.height,y.y+0,.7*y.height,y.height):(h=y.y,i=0,e>=0&&(h=e,i=w.sJc),f=a.createLinearGradient(y.x+.7*i,h,.7*i,h+i)),j=w.OC.yCJ(c),""===c&&w.gq>0&&(j=w.OC.ACJ(w.gq-1)),l=j&&j.options,m=l&&l.sheetTabColor)n="rgba(0, 0, 0, 0)",a.fillStyle=n,o=a.fillStyle,a.fillStyle=g.Rm.Om(j,m),p=a.fillStyle,p!==o&&(b?(f.addColorStop(0,X),f.addColorStop(.45,"#F1F6FD"),f.addColorStop(.9,p),f.addColorStop(1,X)):f=p);else if(d)if(q=d.backgroundImage,r=d.backgroundColor,q&&q.indexOf("linear-gradient")!==-1)for(s=k(q),t=0,u=s.length;t<u;t++)v=s[t],f.addColorStop(v.point,v.color);else r&&f.addColorStop(0,r);return f},a.prototype.qD=function(a,b){var c=W;return a&&(c=a.color),b&&j.dc(j.ec(b))<127.5&&(c=X),c},a}(),b.DC=da,g.Zn(da)},"./dist/core/workbook/workbook-json.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/workbook/workbook.js"),e=c("./dist/core/worksheet/style.js"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/tasks.js"),h=c("./dist/core/excel-io-util/common.js"),i=c("./dist/core/excel-io-util/excel-types.js"),j=c("Common"),k=c("./dist/core/util/common.js"),l=c("@grapecity/js-calc"),m=c("./dist/core/util/styleManager.js"),n=c("./dist/core/util/theme.js"),o=c("./dist/core/core.enum.js"),p=c("./dist/core/core.ns.js"),q=!!l,r=e.Style.kxb,s=j.Commands.UndoManager,t=j.Common.CultureManager,u=j.Common.j.C4,v=h.IndexHelper.R9,w=k.util.JcK,x=k.util.IcK,y=h.Util.XaK,z=h.Util.YaK,A=h.Util.ZaK,B=h.Util.addXLFNPrefix,C=h.IndexHelper.Wfa,D=k.util.NcK,E=k.Ul.oaa,F=k.Ul.naa,G=h.Util.Sja,H="__builtInValidatorStyle",I="__builtInTableStyle",J=i.XFileConstants.O8,K=i.XFileConstants.tbK,L=i.XFileConstants.abK,M=i.XFileConstants.dbK,N=i.XFileConstants.bbK,O=i.XFileConstants.P8,P=j.Common.j.Fa,Q=void 0,R=new j.Common.ResourceManager(p.SR,"Sheets"),S=R.getResource.bind(R),T="normal normal normal 11pt/normal Calibri",U=f.GC$.each,V=k.Ul.Ol,W=parseFloat;function X(a,b){return a.hasOwnProperty(b)}function Y(a){var b,c,d,e;if(!a||"string"!=typeof a)return 1;if(b=a.split("."),c=b.length,c>3)return 3;if(d=W(b[0]),c<=2)return isNaN(d)?1:d;if(e=W(b[1]),d>=10)return d;if(d>=3){if(e>=20143)return 3;if(e>=20142)return 2}return 1}function Z(a){var b,c,d,e,f,g,h=this,i=a&&a.frozenColumnsAsRowHeaders,j=a&&a.frozenRowsAsColumnHeaders;if(i||j)for(q&&(b=h.Cf(),b.isAdjustSuspended()&&b.resumeAdjust()),c=h.sheets,d=c.length,e=0;e<d;e++)f=c[e],g=f.ITa,j&&V(g.TdK)&&(f.$Bb=!0,f.deleteRows(0,g.TdK)),i&&V(g.UdK)&&f.deleteColumns(0,g.UdK)}function $(a,b){var c,d,e,f,g=this,h=b&&b.frozenColumnsAsRowHeaders,i=b&&b.frozenRowsAsColumnHeaders,j=0,k=a.sheets;if(i||h)for(d in k)"string"==typeof d&&(e=k[d],f=V(e.index)?e.index:e.mi,c=g.sheets[V(f)?f:j],i&&V(e.frozenRowCount)&&(c.$Bb=!0,c.deleteRows(0,e.frozenRowCount)),h&&V(e.frozenColCount)&&c.deleteColumns(0,e.frozenColCount),j++)}function _(a,b){var c=b.sheetTabCount;V(c)&&a.DCJ(c,0)}function aa(a,b,c){return function(){var d,e,f,g=b.dataManager(),h=function(d){var e,f,h=d[1].dataView,i=g.tables[h&&h.tableName];i&&(e=i.views[h.name],e&&(f=e,e.d9J=function(){c(d),delete f.d9J},e.e9J=function(){var d,h,j,k,l,m,n,o,p,q,r,s,t,u=function(a){var b=a[1].dataView;i=g.tables[b&&b.tableName],i&&(e=i.views[b.name],e&&f!==e&&e.fetch(!0).then(function(){c(a)}))};for(d=0,h=a;d<h.length;d++)j=h[d],u(j);k=g.tables;for(l in k)if(k.hasOwnProperty(l)){m=k[l],n=m.views;for(o in n)n.hasOwnProperty(o)&&(p=n[o],delete p.e9J)}for(q=0,r=a;q<r.length;q++)if(j=r[q],s=j[1].dataView,i=g.tables[s&&s.tableName],i&&(e=i.views[s.name],f===e)){t=j[0],b.suspendPaint(),t.kj.recalcAll(!0),b.resumePaint();break}}))};for(d=0,e=a;d<e.length;d++)f=e[d],h(f)}}function ba(a,b){var c,d,e,f,g,h;if(a.length>0){for(c=b.dataManager(),d=void 0,e=0;e<a.length&&!(d=a[e][1].dataView);e++);f=c.tables[d&&d.tableName],f&&(g=f.views[d.name],g&&(h=function(a){var c=a[0],d=a[1],e=a[2];c.WWJ(d),e&&ea(b,e,c)},g.fetch().then(function(){var d,e,i,j;for(h(a[0]),d=function(a){var b=a[1].dataView;f=c.tables[b&&b.tableName],f&&(g=f.views[b.name],g&&g.fetch().then(function(){h(a)}))},e=0,i=a.slice(1);e<i.length;e++)j=i[e],d(j);b.suspendPaint(),b.ECJ[0].kj.recalcAll(!0),b.resumePaint()}).catch(aa(a,b,h))))}}function ca(a,b,c){var d,e,f=b.dataView;f&&(d=c.tables[f&&f.tableName],d&&(e=d.views[f.name],e&&e.fetch().then(function(){a.WWJ(b)})))}b.skK=ca;function da(a,b,c,d){var e,f,g,h,i,j,k,l=0,m=b.sheetTabs,n=[],o=d&&d.vLc,p=a.ECJ;if(p&&p.length&&m){for(e in m)if("string"==typeof e){if(f=m[e],g=a.ECJ[l],!g)continue;if(g.fromJSON(f,!1,c,d,!0),!o){for(h=b.formatStringNames,i=[],j=0;h&&j<h.length;j++)k=h[j],k.sheetTabName===g.name()&&i.push(k);n[l]=[g,f.addition,i]}l++}ba(n,a)}}function ea(a,b,c){var d,e;if(b)for(d=0;d<b.length;d++)e=b[d],a.E4J(a.UHb,e.name,e.formula,e.row,e.col,!0,e.comment,c)}function fa(a,b){var c,d=b.activeSheetTabIndex;V(d)&&(a.FCJ(d,0),c=a.ECJ[d],c&&c.HHb(!0,!1))}function ga(a,b,c,d,e){if(c===Q&&d===Q&&a===Q&&b===Q)return Q;var f="";return c!==Q&&(f+="$"+v(c)),a!==Q&&(f+="$"+(a+1)),f+=":",d!==Q&&(f+="$"+v(d)),b!==Q&&(f+="$"+(b+1)),e?C(e)+"!"+f:f}d.Workbook.prototype.toJSON=function(a){return this.WZJ(a)},d.Workbook.prototype.WZJ=function(a,b){var c,e,g,h,i,j,m,n,o,p,r,s,t,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=this,L={version:k.productInfo.productVersion},M=a&&a.rowHeadersAsFrozenColumns,N=a&&a.columnHeadersAsFrozenRows,O=M||N;if(O&&(a.sfc=!0),K.IHb&&(L.docProps=u(K.IHb)),q&&(c=l.Functions.setLanguagepackage,c&&(e=c(),c("en"))),this.G$J&&this.G$J.r9J(this),g=K.getSheetCount(),L.sheetCount=g,O)for(h=new d.Workbook,i=a&&a.includeAutoMergedCells,h.fromJSON(K.toJSON({includeBindingSource:!0,includeAutoMergedCells:i}),{vLc:!0}),K=h,j=0;j<g;j++)m=K.getSheet(j),n=m.getRowCount(1),o=m.getColumnCount(2),p=M&&o>0,r=N&&n>0,p&&m.addColumns(0,o),r&&m.addRows(0,n,r),p&&m.tfc(o,r?n:0),r&&m.ufc(n,p?o:0);for(K.mv=!0,K.suspendPaint(),K.suspendEvent(),q&&(s=K.Wu,s.calcOnDemand&&(s.calcOnDemand=!1,K.ucc(),s.suspend(!0),s.resume(!0),s.calcOnDemand=!0),s.forceR1C1Formula=a&&a.forceR1C1Formula,s.suspend(!0)),t=K.startSheetIndex(),t&&(L.startSheetIndex=t),U(K.options,function(a,b){"_ps"!==a&&d.Workbook.Qp[a]!==b&&(L[a]=b)}),v=K.getActiveSheetIndex(),v!==d.Workbook.ov&&(L.activeSheetIndex=v),w={},x=0;x<g;x++)m=K.getSheet(x),y=a,P(b)||x===b||(y={}),w[m.name()]=m.toJSON(y),w[m.name()].index=x;for(f.GC$.isEmptyObject(w)||(L.sheets=w),z={},A=K.getSheetTabCount(),B=K.getActiveSheetTabIndex(),C=0,D=0,E=0;E<A;E++)F=K.getSheetTab(E),G=F.toJSON(a),G?(G.index=g+E-C,z[F.name()]=G,D++):(C++,B>=E&&B--);if(L.sheetTabCount=D,B!==-1&&(L.activeSheetTabIndex=B),f.GC$.isEmptyObject(z)||(L.sheetTabs=z),H=[],I=K.Lq,I){for(J in I)X(I,J)&&H.push(I[J]);H.length>0&&(L.namedStyles=H)}return d.Workbook._n&&U(d.Workbook._n,function(b,c){c.toJson&&c.toJson.call(K,L,a)}),q&&c&&c(e),K.mv=!1,q&&(delete K.Wu.forceR1C1Formula,K.Wu.resume(!1)),K.resumeEvent(),K.resumePaint(),O&&delete a.sfc,L},d.Workbook.prototype.fromJSON=function(a,b){var c,f,g,h,i,j,l,m,n,o,p,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P=this;if(P.DLJ(),a){if(P.Xgc&&P.Xgc.terminate(),b&&b.incrementalLoading)return b.incrementalLoading===!0&&(b.incrementalLoading={}),P.Wgc(a,b);c=Y(a.version),f=c<3,g={noSchema:f,version:c},h=k.Vl.Xl(),P.mv=!0,P.suspendPaint(),P.suspendEvent(),i=t.culture(),t.culture("");try{P.T3(),P.pv=new s(P,(-1),P.options.allowUndo),q&&(P.qv(!0),P.Wu.suspendAdjust(),P.Wu.forceR1C1Formula=b&&b.forceR1C1Formula),P.lv=-1,P.clearSheets(),P.clearSheetTabs(),j=P.options,l=a.canUserEditFormula,V(l)&&(j.allowUserEditFormula=l),m=a.allowDragDrop,V(m)&&(j.allowUserDragDrop=m),n=a.allowDragFill,V(n)&&(j.allowUserDragFill=n);for(o in j)X(j,o)&&(p=a[o],V(p)&&(j[o]=p));if(P.IHb=u(a.docProps),ha(P,"preFromJson",[a,f,b]),v=a.sheetCount,V(v)||(v=d.Workbook.nv),P.sw(v,0),P.Lq={},P.aDc={},w=a.namedStyles)for(x=0,y=w;x<y.length;x++)z=y[x],A=new e.Style,r(z,P),A.fromJSON(z,f,P),P.Kq(A);if(B=0,C=void 0,D=a.sheets,E=void 0,F=void 0,G=!1,H=!0,D)for(I in D)"string"==typeof I&&(J=D[I],K=V(J.index)?J.index:J.mi,C=P.sheets[V(K)?K:B],J.isApplyRefilter=b&&b.isApplyRefilter,C.fromJSON(J,!1,g,b,!0),B++,F=J.allowUndo,G?H=H&&F===E:(E=F,G=!0));V(E)&&H&&(j.allowUndo=E),_(P,a),P.ECJ.length>0?(da(P,a,g,b),fa(P,a)):a.activeSheetTabIndex>=0&&(a.activeSheetIndex=0),L=a.activeSheetIndex,V(L)||(L=d.Workbook.ov),P.dq(L,0,Q,Q,!0),M=P.sheets[L],M&&M.HHb(!0,!1),N=a.startSheetIndex,V(N)&&P.startSheetIndex(N),O=a.backgroundImage,V(O)&&P.Ys(),d.Workbook._n&&U(d.Workbook._n,function(c,d){var e=d.fromJson;e&&e.call(P,a,f,b)}),q&&P.Wu.resumeAdjust(),$.call(P,a,b),d.Workbook.ao(P,"initCustomName")}finally{q&&(P.Wu.resumeAdjust(),delete P.Wu.forceR1C1Formula),t.culture(i),P.mv=!1,M=P.getActiveSheet(),h&&M&&M.zt(),P.resumeEvent(),P.fq(),P.resumePaint(),M&&P.Wq(k.Events.FormulaTextboxActiveSheetChanged,{oldSheet:void 0,newSheet:M}),q&&P.Wu.processDynamicRef()}}};function ha(a,b,c){d.Workbook._n&&U(d.Workbook._n,function(d,e){var f=e[b];f&&f.call.apply(f,[a].concat(c))})}d.Workbook.prototype.Wgc=function(a,b){var c,f,h,i,j,l,m,n,o,p,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P=this;P.Xgc=new g.Tasks(function(){var a,b,c,d=P.getActiveSheet();if(d&&!d.loaded)for(a=this.tasks.length-1;a>=0;a--)if(b=this.tasks[a].args[0],b&&b.ITa&&b.name&&b.name()===d.name())return c=this.tasks[a],this.tasks.splice(a,1),c;return this.tasks.pop()},function(){var a=P.getActiveSheet();return a&&(P.ku.Gw||a.isEditing()||a.mm.OG||a.mm.xG||a.mm.eG)}),c=Y(a.version),f=c<3,h={noSchema:f,version:c},i=k.Vl.Xl(),P.mv=!0,P.suspendPaint(),P.suspendEvent(),j=t.culture(),t.culture("");try{P.T3(),P.pv=new s(P,(-1),P.options.allowUndo),q&&(P.qv(!0),P.Wu.suspendAdjust()),P.lv=-1,P.clearSheets(),P.clearSheetTabs(),l=P.options,m=a.canUserEditFormula,V(m)&&(l.allowUserEditFormula=m),n=a.allowDragDrop,V(n)&&(l.allowUserDragDrop=n),o=a.allowDragFill,V(o)&&(l.allowUserDragFill=o);for(p in l)X(l,p)&&(v=a[p],V(v)&&(l[p]=v));if(P.IHb=u(a.docProps),ha(P,"preFromJson",[a,f,b]),w=a.sheetCount,V(w)||(w=d.Workbook.nv),P.sw(w,0),P.Lq={},x=a.namedStyles)for(y=0;y<x.length;y++)z=x[y],A=new e.Style,r(z,P),A.fromJSON(z,f,P),P.Kq(A);if(B=0,D=a.sheets,E=void 0,F=void 0,G=!1,H=!0,D){I={total:0,valuesLoad:0,formulaLoad:0},B=0,b.incrementLoadTask=P.Xgc,b.incrementalLoading.loadStatus=I;for(J in D)"string"==typeof J&&(K=D[J],L=V(K.index)?K.index:K.mi,C=P.sheets[V(L)?L:B],C.loading=!0,C.cq(K.name+"",!0),C.HHb(K.isSelected),C.setRowCount(K.rowCount),C.setColumnCount(K.columnCount),V(K.visible)&&C.visible(K.visible),I.total+=C.getRowCount(),P.Xgc.addTask(function(a,c){c.isApplyRefilter=b&&b.isApplyRefilter,a.Wgc(c,!1,h,b,!0)},[C,K]),B++,F=K.allowUndo,G?H=H&&F===E:(E=F,G=!0))}V(E)&&H&&(l.allowUndo=E),_(P,a),P.ECJ.length>0?(da(P,a,h,b),fa(P,a)):a.activeSheetTabIndex>=0&&(a.activeSheetIndex=0),M=a.activeSheetIndex,V(M)||(M=d.Workbook.ov),P.dq(M,0,Q,Q,!0),N=P.sheets[M],N&&N.HHb(!0,!1),O=a.startSheetIndex,V(O)&&P.startSheetIndex(O),P.Xgc.endingCallback=function(){d.Workbook._n&&U(d.Workbook._n,function(c,d){d.Wgc?P.Xgc.addTask(function(a,b,c,e){d.Wgc.call(a,b,c,e)},[P,a,f,b]):d.fromJson&&d.fromJson.call(P,a,f,b)}),P.Xgc.endingCallback=function(){var c,e,f;for(q&&P.Wu.resumeAdjust(),$.call(P,a,b),d.Workbook.ao(P,"initCustomName"),q&&P.Wu.processDynamicRef(),c=0;c<P.sheets.length;c++)delete P.sheets[c].loading;C=P.getActiveSheet(),C&&P.Wq(k.Events.FormulaTextboxActiveSheetChanged,{oldSheet:void 0,newSheet:C}),b&&b.incrementalLoading&&(e=b.incrementalLoading,P.Wq(k.Events.ProgressChanged,{loadStatus:e.loadStatus,progress:1,sheet:C}),e.loading&&e.loading(1,{sheet:C})),f=b&&b.incrementalLoading&&b.incrementalLoading.loaded,f&&f(),C&&C.repaint(),P.Xgc.endingCallback=void 0},P.Xgc.start()},P.Xgc.start()}finally{t.culture(j),P.mv=!1,N=P.getActiveSheet(),i&&N&&N.zt(),P.resumeEvent(),P.fq(),P.resumePaint()}};function ia(a,b){var c,d,e,f,g,h,j,k=ka(a),l=[],m=0,n=0,o=0,p=0,q=0;for(c=0;c<k;c++)d=la(a,c),d&&(d.VdK=c+1,e=d.tables,e&&e.all().length>0&&e.all().forEach(function(a){++m,a._id=m+""}),f=d.charts,f&&f.all().length>0&&f.all().forEach(function(a){++n,a.VdK=n}),g=d.pictures,g&&g.all().length>0&&g.all().forEach(function(a){++o,a.VdK=o}),h=d.pivotTables,
h&&h.all().length>0&&h.all().forEach(function(a){++q,a.mjK=q}),j=y(b),l.push(j),b.c_.push({n_:M,Id:L+j,Type:i.RelationshipConstants.z7,Target:z("worksheets/"+J+j)}));return ja(b),a.kkK={slicer:0,timeline:0,drawing:0,vmlDrawing:0},l}function ja(a){var b=L+y(a);a.c_.push({n_:M,Id:b,Type:i.RelationshipConstants.k7,Target:z("sharedStrings")}),b=L+y(a),a.c_.push({n_:M,Id:b,Type:i.RelationshipConstants.q7,Target:z("styles")}),b=L+y(a),a.c_.push({n_:M,Id:b,Type:i.RelationshipConstants.o7,Target:z("theme/theme1")})}d.Workbook.prototype.getSheetRelsName=function(a){var b=a.split("/").pop(),c=b.lastIndexOf(".xml");return b.substring(0,c)},d.Workbook.prototype.getSheetRelsDir=function(a){var b=a.split("/"),c=b[b.length-2];return"worksheets"!==c?c:"sheets"};function ka(a){return a.getSheetCount()+a.getSheetTabCount()}b.tkK=ka;function la(a,b){var c,d=a.getSheetCount();return b<d?a.getSheet(b):(c=a.getSheetTab(b-d),c&&c.kj)}b.bT=la;function ma(a){return a.substring(0,19)===I}function na(a){return a.substring(0,23)===H}function oa(a,b){var c=a;return c.length>255?c=c.slice(-240):(c=b+" "+c,c.length>250&&(c=a+" "+Math.random().toString(36).slice(-6))),c}function pa(a){var b,c,d=ka(a);for(b=0;b<d;b++)if(c=la(a,b).Pm)return c}function qa(a,b,c,d){var e,f,g,h,i=a.themeFont;return"Body"===i?c?f=c:(g=pa(b),f=g&&g.bodyFont()):"Headings"===i&&(d?f=d:(g=pa(b),f=g&&g.headerFont())),f&&a.font?(h=k.util.Pxb(a.font),e=h.fontWeight+" "+h.fontStyle+" "+h.fontSize+" "+f):e=a.font||T,e}function ra(){return{fileVer:"1.0",proName:"sjs",proVer:k.productInfo.productVersion}}d.Workbook.prototype.bdK=function(a){var b,c,g,j,n,p,r,s,t,v,w,x,y,z,A,C,E,G,H,I,M,N,O,R,T,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ha,ja,pa,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La=this;for(La.G$J&&La.G$J.r9J(La),b=La.ECJ.length>0&&(a&&a.fileType)===o.OpenSaveFileType.excel,c=a&&a.rowHeadersAsFrozenColumns,g=a&&a.columnHeadersAsFrozenRows,j=!a||a.includeStyles!==!1,n=c||g||b,n&&(p=new d.Workbook,r=a&&a.includeAutoMergedCells,p.fromJSON(La.toJSON({includeBindingSource:!0,includeAutoMergedCells:r}),{ukK:!0,vkK:a&&a.fileType}),La=p),s=La.options,t={},v=t.workbook={n_:"workbook",c_:[],lossless:{version:ra(),renamedStylesMap:{}},rels:{}},w={n_:"bookViews",c_:[]},v.c_.push(w),x={n_:"workbookView"},s.showHorizontalScrollbar===!1&&(x.showHorizontalScroll="0"),s.showVerticalScrollbar===!1&&(x.showVerticalScroll="0"),s.tabStripVisible===!1&&(x.showSheetTabs="0"),y=La.startSheetIndex(),y&&(x.firstSheet=y),z=La.getActiveSheetIndex(),z===-1&&(A=La.getActiveSheetTabIndex(),A!==-1&&(z=La.getSheetCount()+A)),z!==d.Workbook.ov&&(x.activeTab=z),C=s.tabStripRatio,"number"==typeof C&&.6!==C&&(x.tabRatio=1e3*C),w.c_.push(x),La.IHb&&(t.docProps=u(La.IHb)),U(La.options,function(a,b){"_ps"!==a&&d.Workbook.Qp[a]!==b&&(v.lossless[a]=b)}),q&&(E=l.Functions.setLanguagepackage,E&&(G=E(),E("en"))),H={},I=ka(La),M=La.getNamedStyles(),N=[],O=new m.StyleManager,R=new k.SharedStrings,T={styleManager:O,sharedStrings:R},V=!1,W=[{style:null}],X={},Y={},Z=v.lossless.renamedStylesMap,Object.keys(M).forEach(function(a){var b=M[a].name;b!==S().NORMAL&&W.push({style:M[a]}),X[b]=1}),$=function(a){var b,c=la(La,a);return c?(b=c.getNamedStyles(),void Object.keys(b).forEach(function(d){var e,f,g=b[d].name;if(!na(g)&&!ma(g)){for(e=g,f=u(b[d]);X[e]||e.length>255;)e=oa(e,c.name());f.name=e,V||d!==S().NORMAL?W.push({sheetId:a,style:f}):(W[0]={sheetId:a,style:b[d]},V=!0),X[e]=1,g!==e&&(Y[g]=Y[g]||{},Y[g][c.name()]=e,Z[e]=g)}})):"continue"},_=0;_<I;_++)$(_);for(O.BkK=Y,aa=h.Util.KlK(a),aa||j&&W[0]&&W[0].style?!aa||W[0]&&W[0].style||W.shift():(ba=la(La,0),ca=j&&!ba.ODJ?ba.getDefaultStyle():{},da=new e.Style,da.name=S().NORMAL,a&&a.fileType===o.OpenSaveFileType.excel&&(da.font="14.67px Calibri",da.foreColor="Text 1",da.borderLeft=new e.LineBorder,da.borderRight=new e.LineBorder,da.borderTop=new e.LineBorder,da.borderBottom=new e.LineBorder,da.name="Normal",da.backColor={type:0}),Object.keys(ca).forEach(function(a){"_id"!==a&&"name"!==a&&(da[a]=ca[a])}),W[0]={style:da}),W.forEach(function(b){O.getNamedStyleIndex(b.style,3,Q,b.sheetId,a&&a.fileType===o.OpenSaveFileType.excel)}),aa||O.getStyleIndex(W[0].style),O.updateNamedStylesParentName(),k.SJSColumnWidthHelper.setMaxDigitWidth(qa(W[0]&&W[0].style||La.sheets[0].getDefaultStyle(),La)),d.Workbook._n&&U(d.Workbook._n,function(b,c){c.preToSJSFormat&&c.preToSJSFormat.call(La,t,T,a)}),fa={n_:K,c_:[]},ha={n_:i.XFileConstants.cbK,xmlns:i.RelationshipConstants.k9},ja=ia(La,ha),t.workbook.rels=ha,pa=0;pa<I;pa++)if(ba=la(La,pa),sa=ja[pa],ba){if(ta=J+sa,ua=ba.ODJ?ba.ODJ.bdK(t,T,a):ba.bdK(t,T,a),H[ta]=ua,va=ba.name(),j&&ba.Pm&&!ea&&(t.theme=ea=ua&&ua.lossless&&ua.lossless.theme),wa=ua.lossless.definedNames||[],wa&&wa.length)for(_=0;_<wa.length;_++)xa=wa[_],wa[_]={n_:"definedName",name:xa.name,localSheetId:pa,e:xa.e,comment:xa.comment,c_:[xa.formula]};ya=ua.printInfo,ya&&(za=ya.rowStart,Aa=ya.rowEnd,Ba=ya.columnStart,Ca=ya.columnEnd,za===-1&&Aa===-1&&Ba===-1&&Ca===-1||(Da=ga(za,Aa,Ba,Ca,va),wa.push({n_:"definedName",name:"_xlnm.Print_Area",localSheetId:pa,c_:[F(B(Da))]})),Ea=ga(ya.repeatRowStart,ya.repeatRowEnd,Q,Q,va),Fa=ga(Q,Q,ya.repeatColumnStart,ya.repeatColumnEnd,va),Ga=void 0,Ea&&Fa?Ga=Fa+","+Ea:Ea?Ga=Ea:Fa&&(Ga=Fa),Ga&&wa.push({n_:"definedName",name:"_xlnm.Print_Titles",localSheetId:pa,c_:[F(B(Ga))]}),delete ua.printInfo),ua.lossless.definedNames=wa,Ha=ba.visible(),Ia=void 0,Ha===o.SheetTabVisible.hidden?Ia="hidden":Ha===o.SheetTabVisible.veryHidden&&(Ia="veryHidden"),Ja={n_:J,"r:id":L+sa,name:F(va),sheetId:sa,state:Ia,lossless:{tabSelected:ba.HHb()?"1":Q}},ja.push(sa),fa.c_.push(Ja)}return t.workbook.c_.push(fa),N.length>0&&t.workbook.c_.push({n_:"definedNames",c_:N}),f.GC$.isEmptyObject(H)||(t.sheets=H),t.styles={},d.Workbook._n&&U(d.Workbook._n,function(b,c){c.bdK&&c.bdK.call(La,t,T,a)}),t.styles=O.uia(t.styles,O.bdK(a)),t.sharedStrings=R.bdK(),O.dispose(),1!==s.referenceStyle&&P(s.iterativeCalculation)&&P(s.iterativeCalculationMaximumIterations)&&P(s.iterativeCalculationMaximumChange)||(Ka={n_:"calcPr",calcId:0},1===s.referenceStyle&&(Ka.refMode="R1C1"),s.iterativeCalculation===!0&&(Ka.iterate=1),P(s.iterativeCalculationMaximumIterations)||(Ka.iterateCount=s.iterativeCalculationMaximumIterations),P(s.iterativeCalculationMaximumChange)||(Ka.iterateDelta=s.iterativeCalculationMaximumChange),t.workbook.c_.push(Ka)),D(t.workbook,i.WorkbookNodeOrder),q&&E&&E(G),t},d.Workbook.prototype.DkK=function(a,b){var c,d=this;t.culture(""),d.T3(),b&&b.calcOnDemand&&(d.options.calcOnDemand=!0),b&&b.dynamicReferences===!1&&(d.options.dynamicReferences=!1),a===!0&&(d.options.allowDynamicArray=!0),d.pv=new s(d,(-1),d.options.allowUndo),q&&(d.qv(!0),c=d.Wu,c.suspendAdjust(),c.suspend(),c.Q$J=b&&!b.fullRecalc),d.lv=-1,d.clearSheets(),d.clearSheetTabs()},d.Workbook.prototype.WdK=function(a){var b,c,d,e,f,g,h,j=this,k=j.options,l=a.workbook.lossless;if(l){b=l.canUserEditFormula,V(b)&&(k.allowUserEditFormula=b),c=l.allowDragDrop,V(c)&&(k.allowUserDragDrop=c),d=l.allowDragFill,V(d)&&(k.allowUserDragFill=d);for(e in k)X(k,e)&&(f=l[e],V(f)&&(k[e]=f))}g=w(a.workbook,"extLst"),g&&g.c_&&g.c_[0]&&g.c_[0]["xmlns:xcalcf"]===i.XFileConstants.YbK&&(k.allowDynamicArray=!0),h=w(a.workbook,"calcPr"),h&&("R1C1"===h.refMode&&(k.referenceStyle=1),k.iterativeCalculation=1===parseInt(h.iterate,10),k.iterativeCalculationMaximumIterations=P(h.iterateCount)?100:parseInt(h.iterateCount,10),k.iterativeCalculationMaximumChange=P(h.iterateDelta)?.001:parseFloat(h.iterateDelta))},d.Workbook.prototype.XdK=function(a){var b,c,d=this,e=d.options,f=w(a.workbook,"bookViews"),g=w(f,"workbookView");g&&(g.showHorizontalScroll&&(e.showHorizontalScrollbar="0"!==g.showHorizontalScroll),g.showVerticalScroll&&(e.showVerticalScrollbar="0"!==g.showVerticalScroll),g.showSheetTabs&&(e.tabStripVisible="0"!==g.showSheetTabs),e.tabStripRatio=P(g.tabRatio)?.6:g.tabRatio/1e3,g.firstSheet&&d.startSheetIndex(+g.firstSheet),b=+g.activeTab||0,c=d.getSheetCount(),0<=b&&b<c?d.lw(d.sheets[b].name(),2):c<=b&&b<c+d.getSheetTabCount()&&d.FCJ(b-c,2))},d.Workbook.prototype.YdK=function(a,b,c,d,f,g,i){var j,l,m,n,p,q,r,s,t,u,v,x,y,z,B,C,D,E,F=this,G=f.sheetNamedStyles;g||(g={}),F.Lq={},j=i.includeUnusedStyles!==!1,l=b.styles&&b.styles.namedStylesMap,m=h.Util.KlK(i),n=!0;for(p in l)if(l.hasOwnProperty(p)){if(q=n&&(p===S().NORMAL||!m&&0===l[p]),!j&&!q&&P(a.originNamedStylesXfs.Ha[p]))continue;r=a.getNamedStyle(l[p],p,m),P(r)&&(r={foreColor:"Text 1 0",themeFont:"Body",font:"normal normal 14.7px Calibri",locked:!0,textIndent:0,wordWrap:!1,vAlign:2,hAlign:3}),q&&(n=!1,r.name="Normal",r.font=qa(r,F,d,c),k.SJSColumnWidthHelper.setMaxDigitWidth(r.font),f.defaultStyle=r),r.name=g[r.name]?g[r.name]:r.name,r.sheetId!==Q?(G[r.sheetId]||(G[r.sheetId]=[]),G[r.sheetId].push(r)):F.Kq(r)}n!==!1&&(s=w(b.workbook,K).c_,t=b.workbook.rels&&b.workbook.rels.c_,u=s[0],v=u[N],x=A(t,v),y=x&&x.Target,z=void 0,y?(B=F.getSheetRelsName(y),C=F.getSheetRelsDir(y),z=b[C]&&b[C][B]):z=b.sheets.sheet1,D=void 0,z&&(D=z.lossless&&z.lossless.defaultStyle),D||(D={hAlign:3,imeMode:1,themeFont:"Body",vAlign:0}),E=new e.Style,E.fromJSON(D,Q,Q),E.font=qa(E,F,d,c),k.SJSColumnWidthHelper.setMaxDigitWidth(E.font),f.defaultStyle=E),i&&i.fileType===o.OpenSaveFileType.excel&&a.buildDummyNamedStyles(F)},d.Workbook.prototype.kfa=function(a){var b,c,d,e,f=[],g={},h=w(a.workbook,"definedNames"),i=h&&h.c_;if(i&&i.length>0)for(b=0,c=i;b<c.length;b++)d=c[b],e=d.c_[0],e&&(d.localSheetId?(g[d.localSheetId]||(g[d.localSheetId]=[]),g[d.localSheetId].push(d)):f.push(d));return{workbookNames:f,worksheetsNames:g}};function sa(a,b){var c=b.state;"hidden"===c?a.visible(o.SheetTabVisible.hidden):"veryHidden"===c&&a.visible(o.SheetTabVisible.veryHidden)}function ta(a,b,c,d,e,f,g){var h,i,j=la(a,d),k=f.loadStatus,l=b[d];j.loading=!0,h=w(c,"sheetData"),i=h&&h.rowCount||200,k.total+=i,j.ODJ?j.ODJ.cdK(c,e,f,g):j.cdK(c,e,f,g),sa(j,l)}function ua(a){var b,c=a.getActiveSheet();return c||(b=a.getActiveSheetTab(),b&&(c=b.kj)),c}b.wkK=ua;function va(a){for(var b=0,c=ka(a);b<c;b++)delete la(a,b).loading}d.Workbook.prototype.cdK=function(a,b,c){var e,f,i,j,l,o,p,r,s,v,y,z,B,C,D,F,H,I,J,L,M,P,R,S,T,W,X,Y,$,_,aa,ca,da,ea=this;if(ea.DLJ(),a){c||(c=function(){}),e=h.Util.mkK(b),b||(b={}),b.progress||(b.progress=function(a){}),b.loadStatus={total:0,valuesLoad:0,formulaLoad:0},f=function(a){ea.IkK(k.Events.ProgressChanged,{loadStatus:b.loadStatus,progress:a.progress,sheetName:a.sheetName}),b.progress({step:a.step,sheetName:a.sheetName,progress:a.progress})},ea.Xgc&&ea.Xgc.terminate(),ea.Xgc=new g.LoadTasks(function(){var a,b,c,d=ua(ea);if(d&&!d.loaded)for(a=this.tasks.length-1;a>=0;a--)if(b=this.tasks[a].args[0],b&&b.ITa&&b.name&&b.name()===d.name())return c=this.tasks[a],this.tasks.splice(a,1),c;return this.tasks.pop()},function(){var a=ua(ea);return e&&a&&(ea.ku.Gw||a.isEditing()||a.mm.OG||a.mm.xG||a.mm.eG)},f),ea.suspendPaint(),ea.suspendEvent(),i=k.Vl.Xl(),ea.mv=!0,j=t.culture();try{if(ea.DkK(a.workbook.lossless&&a.workbook.lossless.allowDynamicArray,b),ea.WdK(a),ea.IHb=u(a.docProps),l=new m.StyleManager,l.cdK(a.styles),o=new k.SharedStrings,o.cdK(a.sharedStrings),p={},Object.keys(a).forEach(function(b){b.indexOf(O)>-1&&(p[b]=a[b])}),r=void 0,r=a.sheets&&a.sheets.sheet1&&a.sheets.sheet1.lossless&&a.sheets.sheet1.lossless.theme?a.sheets.sheet1.lossless.theme:a.theme,s=void 0,v=void 0,r&&"string"!=typeof r?r&&(z=w(r,"themeElements"),B=w(z,"fontScheme"),s=x(B,"majorFont&latin").typeface,v=x(B,"minorFont&latin").typeface):(y=new n.Theme(Q),y.cdK("string"==typeof r?r:"Office"),s=y.headerFont(),v=y.bodyFont()),C={drawings:a.drawings,tables:a.tables,charts:a.charts,media:a.media,ctrlProps:a.ctrlProps,comments:p,pivotTables:a.pivotTables,slicers:a.slicers,slicerCaches:a.slicerCaches,timelineCaches:a.timelineCaches,timelines:a.timelines,styleManager:l,sharedStrings:o,theme:a.theme,sheetNamedStyles:{},dataEffectByInflate:{}},ea.YdK(l,a,s,v,C,a.workbook.lossless&&a.workbook.lossless.renamedStylesMap,b),D=w(a.workbook,K).c_.length,V(D)||(D=d.Workbook.nv),d.Workbook._n&&U(d.Workbook._n,function(c,d){var e=d.preFromSJSFormat;e&&e.call(ea,a,C,b)}),F=w(a.workbook,"definedNames"),C.workbookNames=F&&F.c_,H=w(a.workbook,K).c_,I=a.workbook.rels&&a.workbook.rels.c_,b&&(b.incrementLoadTask=ea.Xgc),H&&I){for(J=[],L=[],M=0;M<D;M++)P=H[M],R=P[N],S=A(I,R),T=S&&S.Target,T&&(W=ea.getSheetRelsName(T),X=ea.getSheetRelsDir(T),Y=a[X][W],$=Y.lossless&&Y.lossless.addition,_=G(E(P.name)),$?(aa=ea.SCJ(_,0),ea.QCJ(M-ea.sheets.length,0,aa),J.push([aa,$])):(ca=ea.vv(_),ea.ow(M,0,ca)),L[M]=Y);for(M=0;M<D;M++)Y=L[M],Y&&ta(ea,H,Y,M,C,b,!h.Util.lkK(b,ea.NjK));ba(J,ea)}ea.XdK(a),ea.Xgc.endingCallback=function(){ea.OiK(),d.Workbook._n&&U(d.Workbook._n,function(c,d){var f=e&&d.ZdK||d.cdK;f&&ea.Xgc.addTask(function(c,d,e){f.call(ea,a,C,b)},[ea,a,b])}),ea.Xgc.endingCallback=function(){var a,e,g;l.dispose(),h.Util.lkK(b,ea.NjK)||Z.call(ea,b),a=!1,q&&(e=ea.Wu,e.resumeAdjust(),b.fullRecalc?(va(ea),a=!0,e.resume(!1)):(e.resumeWithoutCalc(),delete e.Q$J,ea.Wu.processDynamicRef())),d.Workbook.ao(ea,"initCustomName"),a||va(ea),ea.options.backgroundImage&&ea.Ys(),g=ua(ea),f({progress:1,step:"whole workbook loaded.",sheetName:g&&g.name()}),t.culture(j),ea.mv=!1,i&&g&&g.zt(),g&&g.repaint(),ea.resumeEvent(),ea.fq(),ea.resumePaint(),g&&ea.Wq(k.Events.FormulaTextboxActiveSheetChanged,{oldSheet:void 0,newSheet:g}),c()},ea.Xgc.start()},ea.Xgc.start()}catch(a){t.culture(j),ea.mv=!1,da=ua(ea),i&&da&&da.zt(),ea.resumeEvent(),ea.fq(),ea.resumePaint()}}}},"./dist/core/workbook/workbook.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/workbook/workbookpanelex.js"),e=c("./dist/core/core.ns.js"),f=c("Common"),g=c("./dist/core/util/domUtil.js"),h=c("./dist/core/util/common.js"),i=c("./dist/core/util/imageLoader.js"),j=c("./dist/core/worksheet/worksheet-actions.js"),k=c("./dist/core/workbook/sheettab.js"),l=c("./dist/core/workbook/sheettab2007.js"),m=c("./dist/core/worksheet/stylehelper.js"),n=c("./dist/core/worksheet/clipboardhelper.js"),o=c("./dist/core/worksheet/worksheet.js"),p=c("@grapecity/js-calc"),q=!!p,r=c("./dist/core/core.enum.js"),s=c("DataManager"),t=f.Common.u,u=f.Commands.UndoManager,v=f.Commands.CommandManager,w=g.GC$.each,x=g.GC$.extend,y=q,z=f.Common.j.Fa,A=h.Ul.Nl,B=h.Ul.Pl,C=h.Ul.Ql,D=h.Ul.hZa,E=f.Common.CultureManager,F=parseInt,G=window,H=document,I=null,J=Math.round,K=Math.min,L=Math.floor,M=Math.abs,N="number",O="mousedown",P="mousemove",Q="mouseup",R="mouseenter",S="mouseleave",T="scroll",U="resize",V="focus",W=".gcSpread",X=".gcSpreadInternal",Y=".gcScrollbar",Z="span",$="div",_="table",aa="px",ba="100%",ca="gc-scroll-handle",da="gc-scroll-bar",ea="none",fa="display",ga="block",ha="absolute",ia="content-box",ja="solid",ka=" ui-widget-header ui-state-default btn btn-default",la="gc-scroll-mobile-container",ma="gc-scroll-mobile-container-horizontal",na="gc-scroll-mobile-container-vertical",oa="gc-scroll-mobile-spread-hovering",pa="gc-scroll-mobile-state-hide",qa="gc-scroll-mobile-state-hover",ra=G.jQuery,sa="cultureChanged",ta="workbook",ua="gcUIElement",va="gc-no-user-select",wa="visible",xa="overflow",ya="en-US",za=80,Aa=1,Ba=new f.Common.ResourceManager(e.SR,"Sheets"),Ca=Ba.getResource.bind(Ba);function Ja(a){return a.getActiveSheet()}function Ka(a,b){return h.En.npb()%1!==0||a.zoom()%1!==0||a.parent&&a.parent.options.scrollByPixel&&b&&a.xJb&&a.xJb.ICc(h.kf(a.lq,a.qq,1,1))}function La(a,b){return G.setTimeout(function(){a.invalidateLayout(),a.repaint(),b.JHb=I;var c=a.Dr();b.rJJ(a,c.x,c.width),b.uJJ(a,c.y,c.height)},200)}function Ma(a,b,c){a.Wq(h.Events.ActiveSheetChanged,{oldSheet:b,newSheet:c})}function Na(a,b){a.Wq(h.Events.ActiveSheetChanging,b)}function Oa(a,b){a.Wq(h.Events.FormulaTextboxActiveSheetChanging,b)}function Pa(a,b,c){a.Wq(h.Events.FormulaTextboxActiveSheetChanged,{oldSheet:b,newSheet:c})}function Qa(a,b){return void 0===b&&(b=12),+parseFloat(a.toPrecision(b))}Da=100,Ea=30,Fa=40,Ga=function(){function a(a){this.yw=a}return a.Lv=function(a,b){var c,d=a.data,e=d.ku;e.KHb&&(G.clearTimeout(e.KHb),e.KHb=I),c=d.zCJ(),c&&b&&c.GCJ(d,b)},a.Mv=function(a){var b=a.data,c=b.zCJ();c&&c.HCJ(b)},a.Nv=function(a,b){var c,d,e,f,h,i,j=a.data;j&&(c=j.getActiveSheet(),c?(d=j.UJc.xR,d&&d.mR&&(c.CH=!0),c.zt()):(e=j.getActiveSheetTab(),e&&e.zt()),f=j.options.showScrollTip,1!==f&&3!==f||(h=g.GC$(a.srcElement||a.target),i=h.parent(),(h&&(h.hasClass(ca)||h.hasClass(da))||i&&(i.hasClass(ca)||i.hasClass(da)))&&j.ku.Dw(!1,a,b)))},a.Dv=function(a,b){var c,d=a.data,e=d.ku;e.KHb&&(G.clearTimeout(e.KHb),e.KHb=I),c=d.zCJ(),c&&b&&c.ICJ(d,b)},a.Ev=function(a){var b=a.data,c=b.zCJ();c&&c.JCJ(b)},a.Fv=function(a){var b,c,d,e,f,h,i=a.data;i&&(b=i.getActiveSheet(),b?(c=i.VJc.xR,c&&c.mR&&(b.CH=!0),b.zt()):(d=i.getActiveSheetTab(),d&&d.zt()),e=i.options.showScrollTip,2!==e&&3!==e||(f=g.GC$(a.srcElement||a.target),f&&(h=f.parent(),(f.hasClass(ca)||h&&h.hasClass(ca)||f.hasClass(da)||h&&h.hasClass(da))&&i.ku.Dw(!0,a))))},a.qZJ=function(a,b){var c,d,e,f=a.data,g=f.ku;g.KHb&&(G.clearTimeout(g.KHb),g.KHb=I),c=f.zCJ(),c&&b&&(c.onHorizontalDockScroll(f,b),d=f.options.showScrollTip,1!==d&&3!==d||(e=f.ku.Nw(!1,!0),f.ww(e)))},a.Gv=function(a){var b=a.data;b&&b.xw()},a.NHb=function(a){var b,c,d,e,f=Ca(),h=a.data,i=a.scrollbar;h.options.enableAccessibility&&(b=g.GC$(i.Bv()).offset(),c=i.hitTest(a.x-b.left,a.y-b.top),d={thumbButton:f.ARIA_Scrollbar_Thumb_Button,trackButton:f.ARIA_Scrollbar_TRACK_Button,leftButton:f.ARIA_Scrollbar_Left_Button,rightButton:f.ARIA_Scrollbar_Right_Button,upButton:f.ARIA_Scrollbar_Top_Button,downButton:f.ARIA_Scrollbar_Bottom_Button},e=d[c.element],h.EHb(e))},a.prototype.no=function(){this.yw=I},a.prototype.Bw=function(a,b,c,d){var e=this;a&&(e.Gw=!0,e.Hw=d?a.lq:b,e.bCb=d?a.cCb:c,e.Iw=d?b:a.qq,e.dCb=d?c:a.eCb,G.setTimeout(function(){e.Kw(a)},0))},a.prototype.Kw=function(a){var b=this;a&&b.Gw&&(b.Gw=!1,b.Lw(a))},a.prototype.Lw=function(a){var b,c,d,e,f,g,h=this;h.Mw||(h.Mw=!0,b=h.yw,a&&(c=b.options.showScrollTip,d=h.Hw,e=h.bCb,f=h.Iw,g=h.dCb,d!==a.lq||e!==a.cCb?(h.ju(a,d,e),2!==c&&3!==c||b.ww(h.Nw(!0))):f===a.qq&&g===a.eCb||(h.lu(a,f,g),1!==c&&3!==c||b.ww(h.Nw(!1)))),h.Mw=!1)},a.prototype.ju=function(a,b,c,d){var e,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,A,B,C,D,E,F,H,J,L,N,O,P,Q,R,S,T,U=this;if(U.JHb&&(G.clearTimeout(U.JHb),U.JHb=I),a){if(e=a.lq,f=a.cCb,g=!z(d),!g&&b===e&&c===f)return;if(g&&(e=d),a.lq=b,a.cCb=c,a.Xq>0)return void(e!==b&&a.Wq(h.Events.TopRowChanged,{sheet:a,sheetName:a.name(),oldTopRow:e,newTopRow:b}));if(i=!1,j=a.options,k=j.sheetAreaOffset.top,l=k+2,m=a.Zs,n=a.am(),o=n.qt,p=a.tNc(n),q=n.uNc,r=n.ot,s=n.gs,t=n.width+j.sheetAreaOffset.left,u=void 0,v=void 0,w=void 0,x=a.yl,y=x.bm(),A=a.BBJ,a.tables&&0===a.frozenRowCount()&&(B=a.tables.OHb(),B&&(B.x=B.x-2,B.width=B.width+4,B.y=k,B.height=o,a.$l=!0,x._l(y,B))),b>e||b===e&&M(c)>M(f)){if(C=void 0,D=void 0,E=a.Gr(1),E&&E.length>0&&(C=E.findRow(b)),C){for(F=E.length-1,D=E[F];D&&D.y+D.height>o+p;)F-=1,D=E[F];D&&D.row>b&&(i=!0,v=m?m.x:n.x,w=C.y+M(c),u=D.y+D.height-w-l,x.Ow(v,w,t,u,v,o),j.colHeaderVisible||(a.invalidateLayout(),x._l(y,new h.Rect(v,0,t,k))),a.invalidateLayout(),H=A?p:p+s+q,x._l(y,new h.Rect(v,o+u,t,H-u)),H-=A?0:q,x.Pw(y,new h.Rect(v,o-2,t,H+2)),this.rJJ(a,v,t))}}else{for(J=0,L=b;L<e&&J<p;L++)J+=a.Sl(L);J+=M(f)-M(c),J<p&&(i=!0,v=m?m.x:n.x,w=o,u=p-J,a.frozenTrailingRowCount()>0&&(u-=Aa),N=0,!A&&q>0&&(N=s,O=K(m.height-N-Aa,r-Aa+J),x.Ow(v,r-Aa,t,N+Aa,v,O)),P=A?0:K(J,q)-Aa,x.Ow(v,w,t,u+P,v,w+J),a.invalidateLayout(),Q=a.rowOutlines&&!a.rowOutlines.iT()?a.rowOutlines.s0a()+k+1:0,x._l(y,new h.Rect(v,w-k,t,J+k+Q+5)),R=p+P+N+2,x.Pw(y,new h.Rect(v,w-2,t,R)),this.rJJ(a,v,t))}i||(a.invalidateLayout(),a.repaint()),e!==b&&a.Wq(h.Events.TopRowChanged,{sheet:a,sheetName:a.name(),oldTopRow:e,newTopRow:b}),S=a.mm,S&&S.Qw(),T=e===a.lq&&f!==a.cCb,i&&Ka(a,T)&&(U.JHb=La(a,U))}},a.prototype.rJJ=function(a,b,c){var d=a.yl,e=d.bm();this.sJJ(a).concat(this.tJJ(a)).forEach(function(a){var f=a.layout,g=new h.Rect(b,f.y,c,f.height);d.dm(g),d.Pw(e,g)})},a.prototype.sJJ=function(a){var b,c,d,e,f,g,h,i=this,j=a.getSelections();return 1===j.length&&a.frozenRowCount()>0?(b=i.yw.options.scrollByPixel,c=a.lq,d=a.cCb,e=j[0].row,f=j[0].row+j[0].rowCount-1,b&&f===c-1?[]:(g=[],(e===c+1||e<c&&c<=f||f===c-1||b&&e===c&&0!==d)&&(h=a.Gr(0),h&&h.length>0&&g.push({layout:h[h.length-1]})),g)):[]},a.prototype.tJJ=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this,o=a.getSelections();return 1===o.length&&a.frozenTrailingRowCount()>0?(b=n.yw.options.scrollByPixel,c=a.getViewportBottomRow(1),d=o[0].row,e=o[0].row+o[0].rowCount-1,f=[],g=a.Gr(2),h=g&&g.length>0,i=h?g[0]:I,j=a.Gr(1),k=j&&j.length>0,l=k?j.findRow(c):I,m=h&&k&&i.y!==l.y+l.height,(e===c-1||d<=c&&c<e||d===c+1||b&&e===c&&m)&&h&&f.push({layout:i}),f):[]},a.prototype.lu=function(a,b,c,d){var e,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,A,B,C,D,E,F,H,J,L,N,O,P,Q,R,S,T=this;if(T.JHb&&(G.clearTimeout(T.JHb),T.JHb=I),a){if(e=a.qq,f=a.eCb,g=!z(d),!g&&b===e&&c===f)return;if(g&&(e=d),a.qq=b,a.eCb=c,a.Xq>0)return void(e!==b&&a.Wq(h.Events.LeftColumnChanged,{sheet:a,sheetName:a.name(),oldLeftCol:e,newLeftCol:b}));if(i=!1,j=a.options,k=j.sheetAreaOffset.left,l=k+2,m=a.Zs,n=a.am(),o=n.pt,p=a.wNc(n),q=n.xNc,r=n.lt,s=n.js,t=n.height+j.sheetAreaOffset.top,u=void 0,v=void 0,w=void 0,x=a.yl,y=x.bm(),A=a.CBJ,b>e||b===e&&M(c)>M(f)){if(B=void 0,C=void 0,D=a.Hr(1),D&&D.length>0&&(B=D.findCol(b)),B){for(E=D.length-1,C=D[E];C&&C.x+C.width>o+p;)E-=1,C=D[E];C&&C.col>b&&(i=!0,u=B.x+M(c),v=m?m.y:n.y,w=C.x+C.width-u-l,x.Ow(u,v,w,t,o,v),j.rowHeaderVisible||(a.invalidateLayout(),x._l(y,new h.Rect(0,v,k,t))),a.invalidateLayout(),F=A?p:p+s+q,x._l(y,new h.Rect(o+w,v,F-w,t)),F-=A?0:q,x.Pw(y,new h.Rect(o-2,v,F+2,t)),this.uJJ(a,v,t))}}else{for(H=0,J=b;J<e&&H<p;J++)H+=a.Tl(J);H+=M(f)-M(c),H<p&&(i=!0,u=o,v=m?m.y:n.y,w=p-H,a.frozenTrailingColumnCount()>0&&(w-=Aa),L=0,!A&&q>0&&(L=s,N=K(m.width-L-Aa,r-Aa+H),x.Ow(r-Aa,v,L+Aa,t,N,v)),O=A?0:K(H,q)-Aa,x.Ow(u,v,w+O,t,u+H,v),a.invalidateLayout(),P=a.columnOutlines&&!a.columnOutlines.iT()?a.columnOutlines.s0a()+k+1:0,x._l(y,new h.Rect(u-k,v,H+k+P+5,t)),Q=p+O+L+2,x.Pw(y,new h.Rect(o-2,v,Q,t)),this.uJJ(a,v,t))}i||(a.invalidateLayout(),a.repaint()),e!==b&&a.Wq(h.Events.LeftColumnChanged,{sheet:a,sheetName:a.name(),oldLeftCol:e,newLeftCol:b}),R=a.mm,R&&R.Qw(),S=e===a.qq&&f!==a.eCb,i&&Ka(a,S)&&(T.JHb=La(a,T))}},a.prototype.uJJ=function(a,b,c){var d=a.yl,e=d.bm();this.vJJ(a).concat(this.wJJ(a)).forEach(function(a){var f=a.layout,g=new h.Rect(f.x,b,f.width,c);d.dm(g),d.Pw(e,g)})},a.prototype.vJJ=function(a){var b,c,d,e,f,g,h,i=this,j=a.getSelections();return 1===j.length&&a.frozenColumnCount()>0?(b=i.yw.options.scrollByPixel,c=a.qq,d=a.eCb,e=j[0].col,f=j[0].col+j[0].colCount-1,b&&f===c-1?[]:(g=[],(e===c+1||e<c&&c<=f||f===c-1||b&&e===c&&0!==d)&&(h=a.Hr(0),h&&h.length>0&&g.push({layout:h[h.length-1]})),g)):[]},a.prototype.wJJ=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this,o=a.getSelections();return 1===o.length&&a.frozenTrailingColumnCount()>0?(b=n.yw.options.scrollByPixel,c=a.getViewportRightColumn(1),d=o[0].col,e=o[0].col+o[0].colCount-1,f=[],g=a.Hr(2),h=g&&g.length>0,i=h?g[0]:I,j=a.Hr(1),k=j&&j.length>0,l=k?j.findCol(c):I,m=h&&k&&i.x!==l.x+l.width,(e===c-1||d<=c&&c<e||d===c+1||b&&e===c&&m)&&h&&f.push({layout:i}),f):[]},a.prototype.Rw=function(a,b,c,d){var e,f,g,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,z,A=this,B=A.yw,C=!1,D=!1,E=B.VJc,F=B.UJc,G=B.options.scrollbarShowMax,H=B.options.scrollbarAppearance===r.ScrollbarAppearance.mobile;if(a){if(e=a.name(),b.ctrlKey){if(!B.options.allowUserZoom)return!0;if(f=a.zoom(),g=Qa(f-.05*c),a.isEditing()&&!a.endEdit())return;if(i={sheet:a,sheetName:a.name(),oldZoomFactor:f,newZoomFactor:g,cancel:!1},a.Wq(h.Events.ViewZooming,i),i&&i.cancel===!0)return!1;j={cmd:"zoom",sheetName:e,oldZoomFactor:f,zoomFactor:i.newZoomFactor},a.wu().execute(j),g=a.zoom(),f!==g&&(delete i.cancel,a.Wq(h.Events.ViewZoomed,i),a.Wq(h.Events.UserZooming,i))}else d=d||0,k=a.lq,l=a.cCb,m=A.ms(a,c),n=m.cj,o=m.UP,k!==n||l!==o?(H&&(E.Jwa(r.ScrollbarState.show),A.Rec(!0)),A.ju(a,n,o),a.os(),G||a.es()):C=!0,p=a.qq,q=a.eCb,s=A.Sw(a,d),t=s.dj,u=s.UP,p===t&&q===u||(H&&(F.Jwa(r.ScrollbarState.show),A.Rec(!1)),A.lu(a,t,u),a.qs(),G||a.ds());v=a.Vs(),w=a.hitTest(b.pageX-v.left,b.pageY-v.top),x=a.yt,y=x&&x.cellTypeHitInfo,y&&(y.cellRect=a.getCellRect(x.row,x.col)),z=a.mm,z.Tw(w),z.Uw(w)}return C&&0===d},a.prototype.aCb=function(a,b){var c,d,e,f,g,h,i,j,k=a.lq,l=a.cCb,m=a.parent,n=a.zoom(),o=J(b*m.options.scrollPixel*n),p=0,q=a.am().qt,r=a.jt(1).findRow(k);if(r)if(o<0){for(c=a.Rt(-1),p=-(q-r.y);k>c&&p>=o;)k--,p-=a.Sl(k);l=p-o,k===c&&l>0&&(l=0)}else if(o>0){for(d=a.ns(),p=r.y+r.height-q;k<d&&p<=o;)k++,p+=a.Sl(k);e=a.Sl(k),l=p-o-e,m.options.scrollbarMaxAlign?(f=a.am(),g=a.frozenRowCount(),h=a.getRowCount()-a.frozenTrailingRowCount()-1,i=a.PHb(a.tNc(f),g,h),d=i.cj,j=i.UP,k>d?(k=d,l=j):k===d&&M(l)>M(j)&&(l=j)):k<d&&p-o===0?(k++,l=0):k===d&&p-o<0&&(l=-e)}return{cj:k,UP:l}},a.prototype.ms=function(a,b){var c,d,e,f,g=a.lq,h=a.cCb,i=a.parent;return i&&i.options.scrollByPixel?i.ku.aCb(a,b):(c=a.frozenRowCount(),c>0&&(0===g&&b>0?g=c:b<0&&g===c-b&&(g=0)),d=a.Rt(g+b,b<0),d!==-1?g=d:g+=b,e=a._t(),f=a.ns(),a.getRowCount()-c-a.frozenTrailingRowCount()<=0||e===I?g=a.lq:(g<e?g=e:g>f&&(g=f),g===I&&(g=-1)),{cj:g,UP:h})},a.prototype._Bb=function(a,b){var c,d,e,f,g,h,i,j,k=a.qq,l=a.eCb,m=a.parent,n=a.zoom(),o=J(b*m.options.scrollPixel*n),p=0,q=a.am().pt,r=a.it(1).findCol(k);if(r)if(o<0){for(c=a.Ot(-1),p=-(q-r.x);k>c&&p>=o;)k--,p-=a.Tl(k);l=p-o,k===c&&l>0&&(l=0)}else if(o>0){for(d=a.ps(),p=r.x+r.width-q;k<d&&p<=o;)k++,p+=a.Tl(k);e=a.Tl(k),l=p-o-e,m.options.scrollbarMaxAlign?(f=a.am(),g=a.frozenColumnCount(),h=a.getColumnCount()-a.frozenTrailingColumnCount()-1,i=a.QHb(a.wNc(f),g,h),d=i.dj,j=i.UP,k>d?(k=d,l=j):k===d&&M(l)>M(j)&&(l=j)):k<d&&p-o===0?(k++,l=0):k===d&&p-o<0&&(l=-e)}return{dj:k,UP:l}},a.prototype.Sw=function(a,b){var c,d,e,f,g=a.qq,h=a.eCb,i=a.parent;return i&&i.options.scrollByPixel?i.ku._Bb(a,b):(c=a.frozenColumnCount(),c>0&&(0===g&&b>0?g=c:b<0&&g===c-b&&(g=0)),d=a.Ot(g+b,b<0),d!==-1?g=d:g+=b,e=a.$t(),f=a.ps(),a.getColumnCount()-c-a.frozenTrailingColumnCount()<=0||e===I?g=a.qq:(g<e?g=e:g>f&&(g=f),g===I&&(g=-1)),{dj:g,UP:h})},a.prototype.Dw=function(a,b,c){var d,e,f,g=this,i=g.yw,j=h.UCJ(i);j&&(f=g.Nw(a,c),a?(d=b.pageY,e=b.pageX-Da):(d=b.pageY-Fa,e=b.pageX-Ea),i.uw(t.Ob(f),e,d,!0))},a.prototype.Nw=function(a,b){var c,d=h.UCJ(this.yw);return d&&(c=d.getScrollTooltipContent(a,b)),c},a.prototype.Sec=function(a){g.GC$(a).addClass(pa)},a.prototype.Tec=function(a){g.GC$(a).removeClass(pa)},a.prototype.Uec=function(a){g.GC$(a).addClass(qa)},a.prototype.Vec=function(a){g.GC$(a).removeClass(qa)},a.prototype.Rec=function(a,b){var c,d,e,f,g;void 0===b&&(b=1e3),c=this,d=c.yw,e=a?d.WJc:d.XJc,f=d.options.scrollbarAppearance=r.ScrollbarAppearance.mobile,g=function(){c.Vec(e),c.Sec(e)},f&&(c.Wec(a),a?c.Xec=setTimeout(g,b):c.Yec=setTimeout(g,b))},a.prototype.Wec=function(a){var b=this;a&&b.Xec?(clearTimeout(b.Xec),b.Xec=null):!a&&b.Yec&&(clearTimeout(b.Yec),b.Yec=null)},a}(),Ha={allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,allowContextMenu:!0,allowUserDeselect:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabStripPosition:r.TabStripPosition.bottom,tabStripWidth:za,tabEditable:!0,newTabVisible:!0,allSheetsListVisible:r.AllSheetsListVisibility.auto,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:I,backgroundImageLayout:0,showResizeTip:r.ShowResizeTip.none,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:r.ShowScrollTip.none,grayAreaBackColor:I,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:r.ResizeZeroIndicator.enhanced,allowUserEditFormula:!0,enableFormulaTextbox:!0,referenceStyle:0,allowDynamicArray:!1,iterativeCalculation:!0,iterativeCalculationMaximumIterations:1e3,iterativeCalculationMaximumChange:.01,calcOnDemand:!1,dynamicReferences:!0,autoFitType:r.AutoFitType.cell,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:r.CopyPasteHeaderOptions.allHeaders,allowUserDragMerge:!1,rowResizeMode:r.ResizeMode.normal,columnResizeMode:r.ResizeMode.normal,scrollByPixel:!1,scrollPixel:5,enableAccessibility:!1,allowAutoCreateHyperlink:!0,scrollbarAppearance:r.ScrollbarAppearance.skin,font:I,customList:[],numbersFitMode:r.NumbersFitMode.mask,pasteSkipInvisibleRange:!1,allowAutoExtendFilterRange:!1,allowInvalidFormula:!1};function Ra(a,b){b?g.GC$(a).removeClass(pa):g.GC$(a).addClass(pa)}function Sa(a,b,c){var d,e,f=h.Im.Lm("gc-vertical-scrollbar"+ka),i=F(f.zIndex)>2007?1:0,j=b-c;j%2===0?(d=j/2,e=d-i):(d=(j-i)/2,e=d),g.GC$(a).css({"box-sizing":ia,border:ea,"border-color":ea,"border-left-style":ja,"border-left-width":i+aa,"border-left-color":f.borderLeftColor,"background-color":f.backgroundColor,width:c,padding:"0px "+d+"px 0px "+e+aa,margin:0})}function Ta(a,b,c){var d,e,f=h.Im.Lm("gc-horizontal-scrollbar"+ka),i=F(f.zIndex)>2007?1:0,j=b-c;j%2===0?(d=j/2,e=d-i):(d=(j-i)/2,e=d),g.GC$(a).css({"box-sizing":ia,border:ea,"border-color":ea,"border-top-style":ja,"border-top-width":i+aa,"border-top-color":f.borderTopColor,"background-color":f.backgroundColor,height:c,padding:e+"px 0px "+d+"px 0px",margin:0})}function Ua(a){var b=h.Im.Lm("gc-footer-corner"+ka);g.GC$(a).css({border:ea,padding:0,margin:0,"background-color":b.backgroundColor})}function Va(a,b,c,d,e){var f=a.pia(),g=b.left-c.left,h=b.top-c.top;if(d>g&&d<f.width+g&&e>h&&e<f.height+h)return{horizontalScrollBarHitInfo:{element:a.hitTest(d-g,e-h).element},x:d,y:e}}function Wa(a,b,c,d,e){var f=a.pia(),g=b.left-c.left,h=b.top-c.top;if(d>g&&d<f.width+g&&e>h&&e<f.height+h)return{verticalScrollBarHitInfo:{element:a.hitTest(d-g,e-h).element},x:d,y:e}}function Xa(a){var b=g.GC$(a);return{top:Ya(b,"borderTopWidth"),right:Ya(b,"borderRightWidth"),bottom:Ya(b,"borderBottomWidth"),left:Ya(b,"borderLeftWidth")}}function Ya(a,b){var c=a.css(b);switch(c){case"thin":return 1;case"medium":return 3;case"thick":return 5;default:return parseFloat(c)}}function Za(a){var b=g.GC$(a);return{top:parseFloat(b.css("paddingTop")),right:parseFloat(b.css("paddingRight")),bottom:parseFloat(b.css("paddingBottom")),left:parseFloat(b.css("paddingLeft"))}}function $a(a){var b=a.getBoundingClientRect().width,c=Xa(a),d=c.left,e=c.right,f=Za(a),g=f.left,h=f.right;return b-d-e-g-h}function _a(a){return!!r.SheetType[a]}Ia=function(){function a(a,b){var c,d,e=this;e.name="",e.kv=!1,e.lv=-1,e.eq=0,e.KCJ=-1,e.mv=!1,e.options=C(Ha,function(a,b,c){e.Op(a,b,c)}),e.T3(b),b&&"white"===b.backColor?e.Sxb=!0:e.Sxb=!1,c=1,b&&(d=b.sheetCount,typeof d===N&&(c=d)),"string"==typeof a&&(a=H.getElementById(a)),e.qo=a,e.ad(c,a)}return a.prototype.commandManager=function(){return this.wu},a.prototype.undoManager=function(){return this.pv},a.prototype.Txb=function(){var a=this.c8J(),b=this.Vxb;return b instanceof Array?b.concat(a):a},a.prototype.c8J=function(){var a=E.culture(),b=[],c=[],d=E.q4(ya).DateTimeFormat,e=E.q4(a).DateTimeFormat;return b=this.d8J(d),a!==ya&&(c=this.d8J(e)),b.concat(c)},a.prototype.d8J=function(a){var b=[],c,d;return this.e8J=["abbreviatedDayNames","dayNames","abbreviatedMonthNames","monthNames"],this.e8J.forEach(function(e){c=a[e],c instanceof Array&&c.length>0&&(d=e.indexOf("month")>-1||e.indexOf("Month")>-1,c=d?c.slice(0,12):c,b.push(c))}),b},a.prototype.ucc=function(){var a=this,b=y&&a.Cf();b&&b.vcc(),this.sheets.forEach(function(a){var b=a.yj();b.wcc()})},a.prototype.Op=function(a,b,c){var d,e=this,f=h.UCJ(e),g=y&&e.Cf();switch(a){
case"allowUndo":e.pv&&(e.pv.zc=b);break;case"backColor":e.Sxb=!0,f&&f.$p();break;case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":case"allowUserDragMerge":case"numbersFitMode":case"pasteSkipInvisibleRange":f&&f.$p();break;case"backgroundImage":case"backgroundImageLayout":e.Ys(),f&&f.$p();break;case"newTabVisible":case"allSheetsListVisible":case"tabNavigationVisible":d=e.MJc,d&&d.repaint();break;case"tabStripPosition":b!==c&&e.YJc(b);break;case"tabStripWidth":b!==c&&e.ZJc(b);break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":e.fq();break;case"tabStripRatio":e.aq();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":f&&(f.oq=!0,f.jq=!0,f.$p());break;case"scrollByPixel":f&&(f.oq=!0,f.jq=!0,f.cCb=0,f.eCb=0,f.$p());break;case"scrollPixel":b<=0&&(e.options.scrollPixel=c);break;case"scrollbarAppearance":e.ku&&b!==c&&e.Zec(b);break;case"calcOnDemand":g&&(!b&&g.calcOnDemand&&e.ucc(),g.calcOnDemand=b);break;case"dynamicReferences":g&&(g.dynamicReferences=b);break;case"customList":e.Vxb=b;break;case"referenceStyle":case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":e.RHb(a,b),f&&f.$p()}},a.prototype.Zec=function(a){var b,c;z(a)&&(a=r.ScrollbarAppearance.skin),b=this,c=a===r.ScrollbarAppearance.mobile,b.VJc.$ec(a),b.UJc.$ec(a),b.rZJ.$ec(a),b.$Jc(),c?b._Jc():b.aKc(),b.refresh()},a.prototype.YJc=function(a){var b=this;z(a)&&(a=r.TabStripPosition.bottom,b.options.tabStripPosition=a),b.sj&&(b.bKc(),b.v8a(),b.fq())},a.prototype.ZJc=function(a){var b=this;z(a)?(a=za,b.options.tabStripWidth=a):a<za&&(b.options.tabStripWidth=za),b.sj&&(b.v8a(),b.fq())},a.prototype.RHb=function(a,b){var c=this,d=y&&c.Cf();if(d)switch(a){case"referenceStyle":d.useR1C1=1===b;break;case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":d[a]=b}},a.prototype.ad=function(b,c){var d,e,f,g,h=this;for(y&&h.qv(),h.rv=[],h.sv=A("input"),h.jm=0,h.xD=0,h.tv={fromSheet:I,isCutting:!1},h.mmb={fromSheet:I,isCutting:!1},h.sZJ=I,h.sheets=[],h.ECJ=[],h.Lq={},h.Vxb=h.options.customList,h.pv=new u(h,(-1),h.options.allowUndo),d=h.wu=new v(h),d.iNc("beforeWorkbookExecute",function(a){h.jNc(a)}),d.addListener("workbookUndo",function(a){var b,c=a.command,d=j.Commands.aWa(c),e=h.wu[c.cmd];e&&e.canUndo()&&!d&&!c.yTa&&(b=h.getSheetFromName(c.sheetName),b&&(c.sheetId=b._id),h.undoManager().Cc(c,a.s4)),1!==a.s4&&2!==a.s4||h.kNc(a)}),j.Commands.uv(d),a.ao(h,"init"),e=0;e<b;e++)f=h.vv(h.wv(e)),h.sheets.push(f),f.Ls(h);g=h.sheets[h.eq],g&&g.isSelected(!0),h.suspendPaint(),c&&h.ws(c),h.uu=new n.S4(h),h.resumePaint()},a.prototype.hitTest=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,J,K,L,M,N=this,O=N.zCJ(),P=N.MJc,Q=N.UJc,R=N.VJc,S=g.GC$(N.getHost()).width(),T=g.GC$(N.getHost()).height();if(a<0||a>S||b<0||b>T)return I;if(d=N.oia(),e=N.options.scrollbarAppearance===r.ScrollbarAppearance.mobile){if(f=g.GC$(N.XJc).offset(),h=Va(Q,f,d,a,b))return h;if(i=g.GC$(N.WJc).offset(),j=Wa(R,i,d,a,b))return j}if(O&&(k=O.Vs(),l=O.Dr(),m=k.left-d.left,n=k.top-d.top,a>m&&a<l.width+m&&b>n&&b<l.height+n))return{worksheetHitInfo:O.hitTest(a-m,b-n,!1,c),x:a,y:b};if(o=g.GC$(P.Ws()).offset(),p=P.Dr(),q=o.left-d.left,s=o.top-d.top,a>q&&a<p.width+q&&b>s&&b<p.height+s){switch(t=P.hitTest(a-q,b-s),u={},v=t.index,w=N.ACJ(v),x=w&&w.name(),y=I,w&&_a(w.$VJ)&&(y=w.$VJ),t.type){case"navButton":u={navButton:t.element};break;case"sheetTab":u={sheetTab:{sheetName:x||t.element,sheetIndex:v}},y!==I&&(u.sheetTab.sheetType=y);break;case"resize":u={resize:!0};break;default:u={blank:!0}}return{tabStripHitInfo:u,x:a,y:b}}return z=g.GC$(Q.Bv()).offset(),A=Q.pia(),B=z.left-d.left,C=z.top-d.top,a>B&&a<A.width+B&&b>C&&b<A.height+C?{horizontalScrollBarHitInfo:{element:Q.hitTest(a-B,b-C).element},x:a,y:b}:(D=g.GC$(R.Bv()).offset(),E=R.pia(),F=D.left-d.left,G=D.top-d.top,a>F&&a<E.width+F&&b>G&&b<E.height+G?{verticalScrollBarHitInfo:{element:R.hitTest(a-F,b-G).element},x:a,y:b}:(H=g.GC$(N.cKc).offset(),J=parseInt(N.cKc.style.width.substr(0,N.cKc.style.width.indexOf("px")),10),K=parseInt(N.cKc.style.height.substr(0,N.cKc.style.height.indexOf("px")),10),L=H.left-d.left,M=H.top-d.top,a>L&&a<J+L&&b>M&&b<K+M?{footerCornerHitInfo:{element:"footerCorner"},x:a,y:b}:void 0))},a.prototype.oia=function(){var a=this,b;return b=ra?ra(a.qo).offset():g.GC$(a.qo).offset(),b?(b.top+=H.body.clientTop||0,b.left+=H.body.clientLeft||0):b={top:0,left:0},b},a.prototype.T3=function(a){var b=this.options,c=a||{};c=x(!0,{},Ha,c),w(c,function(a,c){b.hasOwnProperty(a)&&(b[a]=c)})},a.prototype.pZJ=function(){var a=this;return!a.sZJ&&a.qo&&(a.sZJ=A($),g.GC$(a.sZJ).css({position:"relative",left:0,top:0,height:0}).attr(ua,"gcLayerContainer"),g.GC$(a.qo).prepend(a.sZJ)),a.sZJ},a.prototype.wv=function(a){var b,c,d,e,f,g,h=this,i=h.getSheetCount();h.lv<i?h.lv=i:h.lv++,(z(a)||a<h.lv)&&(a=h.lv),b=!1,d=h.sheets;do for(c=(Ca().SHEET_NAME||"Sheet")+(a+1),e=d.length,f=0;f<e;f++)if(g=d[f]){if(g.name().toUpperCase()===c.toUpperCase()){a++,b=!0;break}b&&(b=!1)}while(b);return c},a.prototype.vv=function(a){return new o.Worksheet(a)},a.prototype.setHost=function(a){this.ws(a)},a.prototype.ws=function(b){var c=this;b&&(c.qo=b,c.dKc(),c.qm(),c.eKc(),c.fKc(),c.gKc(),c.hKc(),c.iKc(),c.jKc(),c.kKc(),c.lKc(),c.mKc(),c._Jc(),c.nKc(),c.oKc(),c.pKc(),c.qKc(),c.v8a(),c.fq(),c.Rv(b),a.ao(c,"setHost",b))},a.prototype.dKc=function(){var a=this,b=a.qo;ra&&ra(b).data(ta,a),g.GC$(b).data(ta,a).attr(ua,"gcSpread").addClass(va).css(xa,wa)},a.prototype.qm=function(){G.Yl.qm()},a.prototype.eKc=function(){var a=this;a.cultureChangedHandler=function(){a.Av()},H.addEventListener(sa,a.cultureChangedHandler)},a.prototype.fKc=function(){var a=this;a.rKc(),a.sKc(),a.tKc()},a.prototype.sKc=function(){var a,b,c,d,e,f=this,g=f.qo,h=A(_),i=h.style;for(h.cellSpacing="0px",h.cellPadding="0px",h.border="0",i.width=ba,i.height=ba,i.border="0",i.margin="0",i.borderCollapse="collapse",i.float="left",a=0;a<3;a++){for(b=A("tr"),c=0;c<2;c++)d=A("td"),e=d.style,e.padding="0",e.border="0",b.appendChild(d);h.appendChild(b)}g.appendChild(h),f.sj=h},a.prototype.rKc=function(){var a=this,b=a.qo,c=A($),d=c.style;d.width="0",d.height="0",d.float="left",b.appendChild(c),a.uKc=c},a.prototype.tKc=function(){var a=this,b=a.qo,c=A($),d=c.style;d.width="0",d.height="0",d.float="left",b.appendChild(c),a.vKc=c},a.prototype.gKc=function(){var a=this,b=a.qo,c=a.sj,d=c.rows[1].cells[0],e=A($);e.id=b.id+"vp",g.GC$(d).append(e),a.xs=e},a.prototype.hKc=function(){var a=this,b=a.sj,c=b.rows[1].cells[1],e=a.options,f=e.scrollByPixel,h=e.scrollbarAppearance,i=f?r.ScrollType.pixels:r.ScrollType.continuous,j=new d.hv((!1),I,I,I,I,I,i,h,function(){a.cfc(!0)}),k=A($),l=j.Bv();g.GC$(k).append(l),a.VJc=j,a.WJc=k,a.wKc=c},a.prototype.xKc=function(){var a=this,b=a.VJc.Bv();g.GC$(b).bind(T+Y,function(b,c){var e=c.scrollEventType;b.data=a,c.scrollOrientation===d.ScrollOrientation.verticalScroll&&(e===r.Nxb.smallDecrement||e===r.Nxb.smallIncrement||e===r.Nxb.largeDecrement||e===r.Nxb.largeIncrement||e===r.Nxb.thumbTrack?Ga.Dv(b,c):e===r.Nxb.thumbPosition&&Ga.Ev(b))}).bind(O+Y,function(b){b.data=a,Ga.Fv(b)}).bind(Q+Y,function(b){b.data=a,Ga.Gv(b)}).bind(P+Y,function(b){b.data=a,b.scrollbar=a.VJc,Ga.NHb(b)})},a.prototype.iKc=function(){var a,b,c,d,e=this,f=e.sj,h=f.rows[2].cells[0],i=A(_),j=i.style;for(i.cellSpacing="0",i.cellPadding="0",i.border="0",j.border="0",j.margin="0",g.GC$(i).css("user-select",ea),a=A("tr"),b=0;b<2;b++)c=A("td"),d=c.style,d.padding="0",d.border="0",a.appendChild(c);i.appendChild(a),g.GC$(h).append(i),e.yKc=i},a.prototype.jKc=function(){var a=this,b=a.qo,c=A($),d=c.style;d.width=""+a.Iv()*g.GC$(b).width()+aa,d.height=""+a.pJc()+aa,d.fontSize="10pt",d.fontFamily="Arial",a.zKc=c},a.prototype.kKc=function(){var a,b,c=this,e=c.yKc,f=e.rows[0].cells[1],h=c.options,i=h.scrollByPixel,j=h.scrollbarAppearance,k=i?r.ScrollType.pixels:r.ScrollType.continuous,l=new d.hv((!0),I,I,I,I,I,k,j,function(){c.cfc(!1)}),m=l.Bv(),n=A($);g.GC$(n).append(m),c.UJc=l,a=new d.hv((!0),I,I,I,I,I,r.ScrollType.pixels,j,function(){c.cfc(!1)}),b=a.Bv(),g.GC$(n).append(b),c.rZJ=a,c.XJc=n,c.AKc=f},a.prototype.BKc=function(){var a=this,b=a.UJc.Bv();g.GC$(b).bind(T+Y,function(b,c){var e=c.scrollEventType;b.data=a,c.scrollOrientation===d.ScrollOrientation.horizontalScroll&&(e===r.Nxb.smallDecrement||e===r.Nxb.smallIncrement||e===r.Nxb.largeDecrement||e===r.Nxb.largeIncrement||e===r.Nxb.thumbTrack?Ga.Lv(b,c):e===r.Nxb.thumbPosition&&a.xw())}).bind(O+Y,function(b){b.data=a,Ga.Nv(b)}).bind(Q+Y,function(b){b.data=a,Ga.Gv(b)}).bind(P+Y,function(b){b.data=a,b.scrollbar=a.UJc,Ga.NHb(b)})},a.prototype.tZJ=function(){var a=this,b=a.rZJ.Bv();g.GC$(b).bind(T+Y,function(b,c){var e=c.scrollEventType;b.data=a,c.scrollOrientation===d.ScrollOrientation.horizontalScroll&&(e===r.Nxb.smallDecrement||e===r.Nxb.smallIncrement||e===r.Nxb.largeDecrement||e===r.Nxb.largeIncrement||e===r.Nxb.thumbTrack?Ga.qZJ(b,c):e===r.Nxb.thumbPosition&&Ga.Mv(b))}).bind(O+Y,function(b){b.data=a,Ga.Nv(b,!0)}).bind(Q+Y,function(b){b.data=a,Ga.Gv(b)}).bind(P+Y,function(b){b.data=a,b.scrollbar=a.rZJ,Ga.NHb(b)})},a.prototype.lKc=function(){var a=this;a.CKc(),a.DKc()},a.prototype.CKc=function(){var a=this,b=a.sj,c=b.rows[0].cells[1],d=A($);g.GC$(c).append(d),a.EKc=d},a.prototype.DKc=function(){var a=this,b=a.sj,c=b.rows[2].cells[1],d=A($);g.GC$(c).append(d),a.cKc=d},a.prototype.nKc=function(){var a=this;a.ku=new Ga(a)},a.prototype.mKc=function(){var a=this;a.xKc(),a.BKc(),a.tZJ()},a.prototype._Jc=function(){var a,b,c,d=this,e=d.options,f=e.scrollbarAppearance;f===r.ScrollbarAppearance.mobile&&(a=d.qo,b=d.WJc,c=d.XJc,g.GC$(b).bind(R,function(){d.VJc.Jwa(r.ScrollbarState.active)}).bind(S,function(){d.VJc.Jwa(r.ScrollbarState.inactive)}),g.GC$(c).bind(R,function(){d.UJc.Jwa(r.ScrollbarState.active),d.rZJ.Jwa(r.ScrollbarState.active)}).bind(S,function(){d.UJc.Jwa(r.ScrollbarState.inactive),d.rZJ.Jwa(r.ScrollbarState.inactive)}),g.GC$(a).bind(R,d.ffc).bind(S,d.gfc))},a.prototype.aKc=function(){var a=this,b=a.WJc,c=a.XJc;b&&(g.GC$(b).unbind(R).unbind(S),a.ku.Wec(!0)),c&&(g.GC$(c).unbind(R).unbind(S),a.ku.Wec(!1)),g.GC$(a.qo).unbind(R,a.ffc).bind(S,a.gfc)},a.prototype.ffc=function(){g.GC$(this).find("."+la).addClass(oa)},a.prototype.gfc=function(){g.GC$(this).find("."+la).removeClass(oa)},a.prototype.oKc=function(){var a=this;a.bKc(),a.$Jc()},a.prototype.uXJ=function(){var a,b=this,c=b.MJc,d=b.options.tabStripPosition,e=b.options.tabStripVisible,f=0,g=0;return c&&e&&(a=c.Dr(),d===r.TabStripPosition.top?g=a.height:d===r.TabStripPosition.left&&(f=a.width)),{left:f,top:g}},a.prototype.vXJ=function(){var a=this,b=a.pZJ(),c=a.uXJ();g.GC$(b).css({left:c.left,top:c.top})},a.prototype.$Jc=function(){var a,b,c,d,e,f,h=this,i=h.qo;h.ku&&(a=h.options.scrollbarAppearance===r.ScrollbarAppearance.mobile,b=h.wKc,c=h.AKc,d=h.WJc,e=h.XJc,g.GC$(d).removeAttr("style"),g.GC$(e).removeAttr("style"),g.GC$(e).addClass("gc-clear-float"),a?(f=h.pZJ(),d.style.position="absolute",d.style.top="0px",d.style.left="0px",g.GC$(d).addClass(la+" "+na),g.GC$(f).append(d),e.style.position="absolute",e.style.top="0px",e.style.left="0px",g.GC$(e).addClass(la+" "+ma),g.GC$(f).append(e)):(g.GC$(b).append(d),g.GC$(c).append(e),g.GC$(d).removeClass(la+" "+pa+" "+na+" "+qa),g.GC$(e).removeClass(la+" "+pa+" "+ma+" "+qa),g.GC$(i).css("position","auto")))},a.prototype.bKc=function(){var a,b=this,c=b.sj,d=b.uKc,e=b.vKc,f=b.yKc,h=b.zKc,i=b.options.tabStripPosition,j=b.options.tabStripVisible;i===r.TabStripPosition.bottom?a=f.rows[0].cells[0]:i===r.TabStripPosition.top?a=c.rows[0].cells[0]:i===r.TabStripPosition.left?a=d:i===r.TabStripPosition.right&&(a=e),i!==r.TabStripPosition.bottom&&i!==r.TabStripPosition.top&&j?c.style.tableLayout="fixed":c.style.tableLayout="",g.GC$(a).append(h)},a.prototype.Rv=function(a){var b=this,c="tabindex",d=F(g.GC$(a).attr(c),10)||0,e=A($);g.GC$(e).css({position:ha,overflow:"hidden"}).attr(ua,"gcSheetFocusElementForTab").attr(c,d).bind(V,function(){b.Sv||h.UCJ(b).zt(),b.Sv=!1}),a.insertBefore(e,I),b.Tv=e},a.prototype.pKc=function(){var a=this,b=function(){a.Pv()};g.GC$(G).bind(U+W,b),a.oTa=b},a.prototype.qKc=function(){var a=this,b=h.UCJ(a);b&&b.ws(a.xs)},a.prototype.Uv=function(){var a=this,b=a.Tv;b&&(a.Sv=!0,b.focus())},a.prototype.SHb=function(){var a,b,c,d,e,f=this.getActiveSheet();if(f)if(h.Vl.Wl(f)){if(b=this.qo)for(c=document.activeElement,d=document.body,e=c;e;){if(e===b){a=c;break}if(e===d)break;e=e.parentElement}}else f.Xs&&(a=f.Xs);return a},a.prototype.EHb=function(a){var b=this;b.THb&&(G.clearTimeout(b.THb),b.THb=I),b.THb=G.setTimeout(function(){var c=b.SHb();c&&c.setAttribute("aria-label",a),G.clearTimeout(b.THb),b.THb=I},50)},a.prototype.no=function(){var b,c,d,e,f,i,j,k=this,l=k.UJc,n=k.VJc,o=k.rZJ,p=k.sheets,q=k.options.scrollbarAppearance===r.ScrollbarAppearance.mobile;for(k.DLJ(),h.En.Tn(k),h.Ul.no(),k.oTa&&g.GC$(G).unbind(U+W,k.oTa),k.oTa=I,k.Zv&&clearTimeout(k.Zv),l&&l.dispose(),n&&n.dispose(),o&&o.dispose(),k.mu(),k.xw(),h.Vl.Xl()===k.getActiveSheet()&&h.Vl.Zl(I),b=0;b<p.length;b++)p[b].no(!0);for(p.splice(0,p.length),c=k.ECJ,b=0;b<c.length;b++)c[b].no(!0);c.splice(0,c.length),d=k.uu,d&&(d.no(),k.uu=I),e=k.qo,i="class",j="unselectable",e&&(f=g.GC$(e),H.removeEventListener(sa,k.cultureChangedHandler),f.html("").removeAttr(ua).removeClass(va),f.attr(i)||f.removeAttr(i),f.attr(j)||f.removeAttr(j),f.data(ta)&&f.data(ta,I),ra&&ra(e).data(ta)&&ra(e).data(ta,I)),q&&k.aKc(),k.XJc=I,k.WJc=I,k.pv&&(k.pv.no(),k.pv=I),k.MJc&&(k.MJc.no(),k.MJc=I),a.ao(k,"dispose"),k.Tv&&(g.GC$(k.Tv).unbind(V),k.Tv=I),k.Wu&&(k.Wu.dispose(),k.Wu=I,k.yv=I,k.zv=I),k.bt&&(k.bt.no(),k.bt=I),m.To.no(),k.wu&&(k.wu.no(),k.wu=I),k.ku&&(k.ku.no(),k.ku=I),k.NjK&&(k.NjK.dispose(),k.NjK=I)},a.prototype.mu=function(){var a,b,c,d,e,f,h=this,i=h.sheets;for(g.GC$(h.sv).unbind(W),a=0;a<i.length;a++)b=i[a],b.mu();for(c=h.ECJ,d=0,e=c;d<e.length;d++)f=e[d],f.mu();h.rv&&(h.rv.length=0)},a.prototype.DLJ=function(){var a,b,c,d=this,e=d.ELJ;if(e)for(a=0,b=e;a<b.length;a++)c=b[a],c.close&&c.close();d.ELJ=[]},a.prototype.v8a=function(){var a=this,b=F(h.Im.Lm("").zIndex),c=b!==a.Vv;c&&a.FKc(b),a.GKc(c),a.aZ(),a.HKc()},a.prototype.FKc=function(a){this.Vv=a},a.prototype.GKc=function(a){var b=this,c=b.qo,d=b.Vv,e=c.getAttribute("id")+"_tabStrip",f=b.MJc;f&&!a?(f.JJc(),f.repaint()):(f&&f.no(),f=d>2007?new k.iv(e):new l.jv(e),b.MJc=f,f.Yv(b),f.ws(b.zKc))},a.prototype.aZ=function(){var a=this,b=a.options.scrollbarAppearance===r.ScrollbarAppearance.mobile,c=a.pJc(),d=a.Wv(),e=a.Xv();b?a.hfc():(Sa(a.WJc,e,d),Ta(a.XJc,c,d))},a.prototype.HKc=function(){var a=this;Ua(a.cKc),Ua(a.EKc)},a.prototype.Pv=function(){var a=this,b=a.Zv;b&&clearTimeout(b),a.Zv=G.setTimeout(function(){h.En.Un(),a.fq(),a.Zv=I},100)},a.prototype.fq=function(){var a=this;a.kv||(a.kv=!0,a.$v(),a.kv=!1)},a.prototype.$v=function(){var a=this,b=a.qo;b&&(a.IKc(),a.JKc(),a.KKc(),a.LKc(),a.XZJ(),a.NKc(),a.OKc(),a.PKc(),a.QKc(),a.RKc(),a.SKc(),a.vXJ(),a.TKc())},a.prototype.IKc=function(){var a,b,c,d,e,f,h,i,j,k=this,l=k.uKc;l&&(a=l.style,b=k.options,c=b.tabStripVisible,d=b.tabStripPosition,e=c?b.tabStripWidth:0,f=k.qo,h=g.GC$(f).height(),d===r.TabStripPosition.left?(i=e,j=h):(i=0,j=0),a.width=""+i+aa,a.height=""+j+aa)},a.prototype.JKc=function(){var a,b,c,d,e,f,h,i,j=this,k=j.sj;k&&(a=k.style,b=j.options,c=b.tabStripVisible,d=b.tabStripPosition,e=b.tabStripWidth,f=g.GC$(j.qo).width(),!c||d!==r.TabStripPosition.left&&d!==r.TabStripPosition.right?h=f+aa:(i=L($a(j.qo)),h=i-e+aa),a.width=h)},a.prototype.LKc=function(){var a,b,c,d,e,f,h,i,j,k=this,l=k.vKc;l&&(a=l.style,b=k.options,c=b.tabStripVisible,d=b.tabStripPosition,e=c?b.tabStripWidth:0,f=k.qo,h=g.GC$(f).height(),d===r.TabStripPosition.right?(i=e,j=h):(i=0,j=0),a.width=""+i+aa,a.height=""+j+aa)},a.prototype.KKc=function(){var a,b,c,d,e,f,h,i,j,k,l,m,n,o,p,q,s=this,t=s.qo,u=g.GC$(t),v=s.xs;v&&(a=v.style,b=u.width(),c=u.height(),d=s.Xv(),e=s.pJc(),f=s.options,h=f.showVerticalScrollbar,i=f.showHorizontalScrollbar,j=f.scrollbarAppearance,k=f.tabStripVisible,l=f.tabStripPosition,m=k?f.tabStripWidth:0,n=j===r.ScrollbarAppearance.mobile,o=l===r.TabStripPosition.left||l===r.TabStripPosition.right,p=o?L($a(t)):b,h&&!n&&(p-=d),o&&(p-=m),q=c,l===r.TabStripPosition.top?(i&&!n&&(q-=e),k&&(q-=e)):(i&&!n||k&&l===r.TabStripPosition.bottom)&&(q-=e),q<2&&(q=2),a.width=p+aa,a.height=q+aa)},a.prototype.XZJ=function(a){var b,c,d,e,f,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,A=this,B=A.qo,C=g.GC$(B),D=A.xs;D&&(z(a)&&(a=C.width()),b=g.GC$(D).height(),c=A.UJc,d=A.rZJ,e=A.VJc,f=A.options,i=f.showVerticalScrollbar,j=f.showHorizontalScrollbar,k=f.scrollbarAppearance,l=f.tabStripVisible,m=f.tabStripPosition,n=l?f.tabStripWidth:0,o=k===r.ScrollbarAppearance.mobile,p=A.Wv(),q=A.Xv(),s=A.UKc(),t=h.UCJ(A),u=t?t.getHDockScrollbarWidth():0,i?(g.GC$(A.WJc).show(),g.GC$(e.Bv()).show()):(g.GC$(A.WJc).hide(),g.GC$(e.Bv()).hide()),j?(g.GC$(A.XJc).show(),g.GC$(c.Bv()).show(),g.GC$(d.Bv()).show()):(g.GC$(A.XJc).hide(),g.GC$(c.Bv()).hide(),g.GC$(d.Bv()).hide()),0===u?g.GC$(d.Bv()).hide():g.GC$(d.Bv()).show(),v=p,w=b,e.Vo(v),e._v(w),x=a-u,m!==r.TabStripPosition.left&&m!==r.TabStripPosition.right||(x-=n),l&&!o&&m===r.TabStripPosition.bottom&&(x-=s),i&&!o&&(x-=q),x<=0&&(x=1),y=p,j||l||m!==r.TabStripPosition.bottom||(y=0),c.Vo(x),c._v(y),d.Vo(u),d._v(y))},a.prototype.UKc=function(){var a,b,c=this,d=c.xs,e=c.options,f=e.tabStripPosition,i=e.tabStripWidth,j=e.scrollbarAppearance,k=h.UCJ(c),l=g.GC$(d).width();return f===r.TabStripPosition.bottom||f===r.TabStripPosition.top?(k&&f===r.TabStripPosition.bottom&&j===r.ScrollbarAppearance.skin&&(b=k.getHDockScrollbarWidth(),l-=b),a=J(c.Iv()*l),f===r.TabStripPosition.bottom&&a===l&&(a=l-1)):a=i,a},a.prototype.NKc=function(){var a,b,c,d,e,f,h,i=this,j=i.qo,k=g.GC$(j).height(),l=i.zKc;l&&(a=l.style,b=i.options,c=b.tabStripVisible,d=b.tabStripPosition,e=i.pJc(),f=i.UKc(),h=d===r.TabStripPosition.bottom||d===r.TabStripPosition.top?e:k,c||(h=0),a.width=""+f+aa,a.height=""+h+aa)},a.prototype.OKc=function(){var a,b,c,d,e=this,f=e.EKc,h=e.cKc,i=e.options,j=i.showVerticalScrollbar,k=i.showHorizontalScrollbar,l=i.tabStripVisible,m=i.tabStripPosition,n=i.scrollbarAppearance===r.ScrollbarAppearance.mobile,o=e.Xv(),p=e.pJc();m===r.TabStripPosition.top?(a=j&&!n?o:0,b=l?p:0):(a=0,b=0),g.GC$(f).css("width",a+aa),g.GC$(f).css("height",b+aa),c=j&&!n?o:0,k||l&&m===r.TabStripPosition.bottom?(d=p,n&&(l?l&&m!==r.TabStripPosition.bottom&&(d=0):d=0)):d=0,g.GC$(h).css("width",c+aa),g.GC$(h).css("height",d+aa)},a.prototype.PKc=function(){var a,b,c,d,e,f=this;f.xs&&(a=f.sj,b=f.options,c=b.scrollbarAppearance===r.ScrollbarAppearance.mobile,d=b.showVerticalScrollbar,e=[g.GC$(f.xs).width(),f.Xv()],!c&&d||(e[1]=0),a.rows[0].cells[0].style.width=e[0]+aa,a.rows[0].cells[1].style.width=e[1]+aa)},a.prototype.RKc=function(){var a=this,b=a.options,c=b.scrollbarAppearance===r.ScrollbarAppearance.mobile;c&&a.hfc(),a.Ut(),a.Xt(),c&&(a.VJc.Jwa(r.ScrollbarState.hide),a.UJc.Jwa(r.ScrollbarState.hide))},a.prototype.SKc=function(){var a=this,b=a.options,c=b.tabStripVisible;c?g.GC$(a.zKc).show():g.GC$(a.zKc).hide(),a.MJc&&a.MJc.fq()},a.prototype.QKc=function(a){var b,c,d;void 0===a&&(a=!0),b=this,c=h.UCJ(b),c?(0===c.lq&&(c.lq=c._t()),0===c.qq&&(c.qq=c.$t()),a&&c.fq()):(d=b.getActiveSheetTab(),d&&d.fq())},a.prototype.TKc=function(){var a,b=this,c=h.UCJ(b);c&&(c.invalidateLayout(),c.repaint()),a=b.DXJ(),a&&!b.aw&&(b.aw=!0,setTimeout(function(){delete b.aw,b.$v()},1))},a.prototype.DXJ=function(){var a,b,c,d,e,f,i,j,k,l=this,m=g.GC$(l.qo),n=m.width(),o=2,p=m.width(),q=n!==p&&M(n-p)>o,r=!1,s=l.uKc,t=l.vKc,u=l.sj;return s&&t&&u&&(a=g.GC$(s).width(),b=g.GC$(t).width(),c=g.GC$(u).width(),r=M(a+c+b-p)>o),d=!1,e=l.rZJ,f=h.UCJ(l),e&&f&&(i=f.getDockScrollbarAttachedIndex(),z(i)||(j=e.Vo(),k=f.getHDockScrollbarWidth(),j!==k&&(d=!0))),q||r||d},a.prototype.hfc=function(){var a,b,c,d,e,f,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,A,B,C,D,E,G,H,I,J,K=this;z(K.qo)||(a=g.GC$(K.qo),b=h.UCJ(K),b&&(c=g.GC$(K.WJc),d=g.GC$(K.XJc),e=b.am(),f=a.width(),i=a.height(),j=2,k=K.options,l=k.tabStripVisible,m=k.showVerticalScrollbar,n=k.tabStripPosition,o=l?k.tabStripWidth:0,p=l?K.pJc():0,q=b.getHDockScrollbarWidth(),s=e.x+e.Br,t=e.y+e.Cr,u=m?c.width():0,v=i-t,n!==r.TabStripPosition.bottom&&n!==r.TabStripPosition.top||(v-=p),w=0,n!==r.TabStripPosition.right&&n!==r.TabStripPosition.left||(w+=o),x=t,y=F(c.css("padding-top")),A=F(c.css("padding-bottom")),B=v-y-A,C=f-s,0===q&&(C-=u),n!==r.TabStripPosition.left&&n!==r.TabStripPosition.right||(C-=o),D=d.height(),E=-(v+x),G=s,H=F(d.css("padding-left")),I=F(d.css("padding-right")),J=C-H-I-q,0===q?J-=j:q-=u+I+j,K.VJc.Vo(u),K.VJc._v(B),K.UJc.Vo(J),K.UJc._v(D),K.rZJ.Vo(q),K.rZJ._v(D),c.css(["height","left","right","top"],[v,"auto",w,x]),d.css(["width","top","bottom","left"],[C,"auto",E,G])))},a.prototype.Ut=function(){var a=this,b=a.zCJ(),c=a.options;b&&(b.Ut(c.scrollbarMaxAlign,c.scrollbarShowMax,a.UJc),b.uZJ(a.rZJ))},a.prototype.Xt=function(){var a=this,b=a.zCJ(),c=a.options;b&&b.Xt(c.scrollbarMaxAlign,c.scrollbarShowMax,a.VJc)},a.prototype.aq=function(){var a,b=this,c=b.qo;c&&(a=b.YZJ(),b.NKc(),b.XZJ(a),b.QKc(!1),b.RKc(),b.SKc())},a.prototype.YZJ=function(){var a,b,c=this.qo,d=c.parentNode;return d&&(b=d.style.display||getComputedStyle(d).display,"flex"===b&&(a=g.GC$(c).width())),a},a.prototype.suspendPaint=function(){var a,b,c,d,e,f,g=this,h=g.MJc,i=g.sheets,j=g.ECJ;for(g.xD++,a=0,b=i;a<b.length;a++)c=b[a],c.suspendPaint();for(d=0,e=j;d<e.length;d++)f=e[d],f.suspendPaint();h&&h.fw()},a.prototype.resumePaint=function(){var a,b,c,d,e,f,g=this,h=g.MJc,i=g.sheets,j=g.ECJ;for(g.xD-=g.xD>0?1:0,a=0,b=i;a<b.length;a++)c=b[a],c.resumePaint();for(d=0,e=j;d<e.length;d++)f=e[d],f.resumePaint();h&&h.gw()},a.prototype.OiK=function(){var a,b,c=this,d=c.getActiveSheet();try{d&&(a=d.Xq,d.Xq=0,d.x6a(),d.repaint(),d.Xq=a),c.MJc&&(b=c.MJc.xD,c.MJc.xD=0,c.MJc.repaint(),c.MJc.xD=b)}catch(a){}},a.prototype.isPaintSuspended=function(){return this.xD>0},a.prototype.Ys=function(){var a,b,c,d,e,f,j=this,k=j.options.backgroundImage,l=j.options.backgroundImageLayout,m=h.UCJ(j);if(m&&k&&(a=g.GC$(m.Ws()),b=void 0,a.css({"background-image":"url('"+k+"')","background-repeat":"no-repeat"}),!z(l))){b=j.bt,b||(b=j.bt=new i.oo(function(){j.bt&&j.Ys()}));try{b.ko(k)?(c=b.lo(k),d=m.Dr(),e=d.width,f=d.height,h.Ul.ql(m.Ws(),e,f,c.width,c.height,l)):b.fo(k)}catch(a){}}},a.prototype.hw=function(a){var b=this,c=a.name(),d=b.getSheetIndex(c);z(d)&&(d=b.getSheetCount()+b.getSheetTabIndex(c)),b.MJc.iw(d)},a.prototype.startSheetIndex=function(a){var b=this,c=b.MJc;return 0===arguments.length?c?c.gq:0:(c&&(c.hE(a)||(a=c.jw(a),a===-1&&(a=c.rw(a))),c.gq=a),b.aq(),b)},a.prototype.Iv=function(){var a,b,c,d,e,f=this,h=f.options,i=f.options.scrollbarAppearance===r.ScrollbarAppearance.mobile,j=h.tabStripPosition;return h.showHorizontalScrollbar&&!i&&j===r.TabStripPosition.bottom?(a=h.tabStripRatio,isNaN(a)?.5:(b=0,c=f.xs,d=f.MJc,c&&d&&(e=g.GC$(c).width(),b=d.rJc()/e),a<b?a=b:a>1&&(a=1),a)):1},a.prototype.destroy=function(){this.oTa&&g.GC$(G).unbind(U+W,this.oTa),this.no()},a.prototype.repaint=function(){var a,b=this,c=b.MJc;c&&c.repaint(),a=h.UCJ(b),a&&a.repaint()},a.prototype.refresh=function(){var a=this;a.qo&&(h.Im.Nm(),a.v8a(),a.fq(),a.repaint())},a.prototype.getHost=function(){return this.qo},a.prototype.invalidateLayout=function(){var a=h.UCJ(this);a&&a.invalidateLayout()},a.prototype.addNamedStyle=function(a){this.Kq(a);var b=h.UCJ(this);b&&b.$p()},a.prototype.Kq=function(a){if(a){if(!a.name)throw Error(Ca().Exp_EmptyNamedStyle);var b=a.name.toUpperCase();this.Lq[b]=a}},a.prototype.getNamedStyle=function(a){return this.Mq(a,!0)},a.prototype.Mq=function(a,b){var c,d=this.Lq;return d&&a?(a=a.toUpperCase(),c=d[a],c&&b&&this.Jq(),c):I},a.prototype.Jq=function(){var a,b,c,d=this.sheets;for(a=0,b=d;a<b.length;a++)c=b[a],c.Jq()},a.prototype.removeNamedStyle=function(a){var b,c,d=this.Lq;d&&a&&(a=a.toUpperCase(),d.hasOwnProperty(a)&&(b=d[a].formatter,b&&"string"==typeof b&&this.UHb[b]&&this.VHb(b),delete d[a],this.Jq(),c=h.UCJ(this),c&&c.$p()))},a.prototype.getNamedStyles=function(){var a=[],b=this.Lq;return b&&w(b,function(b,c){a.push(c)}),this.Jq(),a},a.prototype.getActiveSheet=function(){return this.sheets&&this.sheets.length>0?this.sheets[this.eq]:I},a.prototype.getActiveSheetTab=function(){return this.ECJ&&this.ECJ.length>0?this.ECJ[this.KCJ]:I},a.prototype.setActiveSheet=function(a){var b=this.getActiveSheet(),c=this.getActiveSheetTab();this.lw(a,2),this.WHb(b),this.LCJ(c)},a.prototype.setActiveSheetTab=function(a){var b=this.getActiveSheet(),c=this.getActiveSheetTab();"number"==typeof a?this.FCJ(a,2):"string"==typeof a&&this.MCJ(a,2),this.WHb(b),this.LCJ(c)},a.prototype.lw=function(a,b){var c,d=this.sheets;for(c=0;c<d.length;c++)if(d[c].name()===a){this.dq(c,b);break}},a.prototype.MCJ=function(a,b){var c,d=this.ECJ;for(c=0;c<d.length;c++)if(d[c].name()===a){this.FCJ(c,b);break}},a.prototype.getActiveSheetIndex=function(){return this.eq},a.prototype.getActiveSheetTabIndex=function(){return this.KCJ},a.prototype.setActiveSheetIndex=function(a){var b=this.getActiveSheet(),c=this.getActiveSheetTab();this.dq(a,2),this.WHb(b),this.LCJ(c)},a.prototype.dq=function(a,b,c,d,e){var f,g,i,j,k,l,m,n,o,p;typeof a===N&&(f=this,a!==f.eq&&(g=f.sheets[a],(g&&g.visible()===r.SheetTabVisible.visible||e)&&(i=h.Ul.rl(),(i.ipad||i.iphone)&&(j=f.mw,j&&(new Date).valueOf()-j<300)||(k=f.getActiveSheet(),l=k,l||(m=f.getActiveSheetTab(),l=m&&m.kj),n={oldSheet:l,newSheet:g,needTriggerSheetChange:!0},Oa(f,n),o={oldSheet:l,newSheet:g,cancel:!1},p=n.needTriggerSheetChange&&d,p&&Na(f,o),o.cancel===!1&&(f.eq=a,f.NCJ(),g!==k&&(k&&(k.no(!1),k.charts&&k.charts.all().forEach(function(a){a.clearflexDVs()})),g&&f.nw(g,b,!1,p,c)),f.fq(),Pa(f,l,g),p&&Ma(f,l,g)),(i.ipad||i.iphone)&&(f.mw=(new Date).valueOf())))))},a.prototype.FCJ=function(a,b,c,d){var e,f,g,i,j,k,l,m,n,o;typeof a===N&&(e=this,a!==e.KCJ&&(f=e.ECJ[a],f&&f.visible()===r.SheetTabVisible.visible&&(g=f.kj,i=h.Ul.rl(),(i.ipad||i.iphone)&&(j=e.mw,j&&(new Date).valueOf()-j<300)||(k=e.getActiveSheetTab(),l=k?k.kj:e.getActiveSheet(),m={oldSheet:l,newSheet:g,needTriggerSheetChange:!0},Oa(e,m),n={oldSheet:l,newSheet:g,cancel:!1},o=m.needTriggerSheetChange&&d,o&&Na(e,n),n.cancel===!1&&(e.KCJ=a,e.OCJ(),f!==k&&(k&&k.no(!1),e.PCJ(f,b,!1,o,c)),e.fq(),Pa(e,l,g),o&&Ma(e,l,g)),(i.ipad||i.iphone)&&(e.mw=(new Date).valueOf())))))},a.prototype.nw=function(a,b,c,d,e){var f,g,i;c||a.ws(this.xs),f=h.Vl.Xl(),g=f&&f.parent===this,i=2===b?g:1===b,h.Vl.Zl(I),!this.mv&&i&&a.zt(e),a.ds(),a.os()},a.prototype.PCJ=function(a,b,c,d,e){var f,g,i;c||a.ws(this.xs),f=h.Vl.Xl(),g=f&&f.parent===this,i=2===b?g:1===b,h.Vl.Zl(I),!this.mv&&i&&a.zt(e),a.ds(),a.os()},a.prototype.WHb=function(a){var b=this.getActiveSheet();a&&a.HHb(!1,!1),b&&b.HHb(!0,!1)},a.prototype.LCJ=function(a){var b=this.getActiveSheetTab();a&&a.HHb(!1,!1),b&&b.HHb(!0,!1)},a.prototype.addSheet=function(a,b){var c=this.getActiveSheet(),d=this.getActiveSheetTab();this.ow(a,2,b),this.WHb(c),this.LCJ(d)},a.prototype.addSheetTab=function(a,b,c){var d=this.getActiveSheet(),e=this.getActiveSheetTab(),f=this.SCJ(b,c);if(f)return this.suspendPaint(),this.QCJ(a,2,f),this.WHb(d),this.LCJ(e),this.resumePaint(),f},a.prototype.ow=function(a,b,c){var d,e,f,g,h,i,j,k,l=this;if(c||(c=l.vv(l.wv(a))),e=l.sheets,f=e.length,c.name()){for(d=0;d<f;d++)if(e[d].name()===c.name())throw Ca().Exp_NotSupported}else c.cq(l.wv(a));for(l.pw(c),g=l.getActiveSheet(),h=l.eq,i=f-a,j=[],d=0;d<i&&f>0;d++)j.push(e.pop());for(e.push(c),c.Ls(l);j.length>0;)e.push(j.pop());l.NCJ(),f=e.length,1===f?(l.xs&&c.ws(l.xs),l.eq=0):(h<0&&l.MJc&&(h=l.MJc.jw(h)),l.eq=h),k=l.getActiveSheet(),k!==g&&(g&&g.no(!1),k&&l.nw(k,b,1===f,!0),l.fq()),l.MJc&&(l.MJc.gq<0&&(l.MJc.gq=l.eq),l.MJc.repaint())},a.prototype.QCJ=function(a,b,c){var d,e,f,g,h,i,j,k,l;if(c){for(d=this,f=d.ECJ,g=f.length,e=0;e<g;e++)if(f[e].name()===c.name())throw Ca().Exp_NotSupported;for(d.pw(c),h=d.getActiveSheetTab(),i=d.KCJ,j=g-a,k=[],e=0;e<j&&g>0;e++)k.push(f.pop());for(f.push(c),c.Ls(d);k.length>0;)f.push(k.pop());g=f.length,1===g?(d.xs&&c.ws(d.xs),d.KCJ=0):(i<0&&d.MJc&&(i=d.MJc.jw(i)),d.KCJ=i),d.OCJ(),l=d.getActiveSheetTab(),l!==h&&(h&&h.no(!1),l&&d.PCJ(l,b,1===g,!0),d.fq()),d.MJc&&(d.MJc.gq<0&&(d.MJc.gq=d.KCJ),d.MJc.repaint())}},a.prototype.removeSheet=function(a){this.qw(a,2)},a.prototype.removeSheetTab=function(a){"string"==typeof a&&(a=this.getSheetTabIndex(a)),this.RCJ(a,2)},a.prototype.qw=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,s,t=this,u=t.sheets,v=t.Wu,w=t.MJc,x=u.length;if(isNaN(a)||a<0||a>=x)throw Error(Ca().Exp_IndexOutOfRange);if(c=a<=t.eq||a===x-1,d=t.getActiveSheet(),a<t.eq&&t.eq--,e=u[a],e.mu(),u.splice(a,1),x=u.length,0===x)t.eq=-1;else if(t.eq>=x)t.eq=w.rw(x);else{for(f=void 0,f=t.eq;f<x;f++)if(u[f].visible()===r.SheetTabVisible.visible){t.eq=f;break}f>=x&&(t.eq=w.rw(x))}if(t.NCJ(),c&&(g=u[t.eq],d!==g&&(d&&d.no(!1),g&&t.nw(g,b,!1,!0))),v){if(v.suspend(),e.Bj().ZZJ(),h={},i=v.imb){j=e.Bj().getSource().id;for(k in i)if(i.hasOwnProperty(k))for(h[k]=[],l=i[k];l;)m=l.ah&&l.ah.getSource().id,j!==m&&h[k].push(l),l=l.eh}n=e.yj(),n.fEc=a,v.removeSource(n),o=e.sDc,v.removeSource(o),p=e.uDc,v.removeSource(p),q=e.Vva,z(q)||v.removeSource(q);for(k in h)if(h.hasOwnProperty(k))for(l=h[k],f=0;f<l.length;f++)v.pg(l[f],parseInt(k,10));v.resume(!1)}e.no(!0,t.eq!==-1),y&&!v.Dh&&t.sheets&&t.sheets.length>0&&(s=t.sheets[0],v.initParserContext(s.yj())),w&&(w.gq>=x?t.startSheetIndex(w.rw(x)):w.gq<0?t.startSheetIndex(w.jw(-1)):t.fq())},a.prototype.RCJ=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this,n=m.ECJ,o=m.Wu,p=m.MJc,q=n.length;if(isNaN(a)||a<0||a>=q)throw Error(Ca().Exp_IndexOutOfRange);if(c=a<=m.KCJ||a===q-1,d=m.getActiveSheetTab(),a<m.KCJ&&m.KCJ--,e=n[a],e.mu(),n.splice(a,1),q=n.length,0===q)m.KCJ=-1;else if(m.KCJ>=q)m.KCJ=p.rw(q);else{for(f=void 0,f=m.KCJ;f<q;f++)if(n[f].visible()===r.SheetTabVisible.visible){m.KCJ=f;break}f>=q&&(m.KCJ=p.rw(q))}m.OCJ(),c&&(g=n[m.KCJ],d!==g&&(d&&d.no(!1),g&&m.PCJ(g,b,!1,!0),m.LCJ(d))),o&&(o.suspend(),h=e.kj,i=h.yj(),i.fEc=a,o.removeSource(i),j=h.sDc,o.removeSource(j),k=h.uDc,o.removeSource(k),l=h.Vva,z(l)||o.removeSource(l),o.resume(!1)),e.no(!0,m.KCJ!==-1),p&&(p.gq>=q?m.startSheetIndex(p.rw(q)):p.gq<0?m.startSheetIndex(p.jw(-1)):m.fq())},a.prototype.clearSheets=function(){var a,b,c,d=this,e=d.sheets,f=d.Wu,g=d.MJc;for(a=0,b=e;a<b.length;a++)c=b[a],c.mu(),c.no(!0);e.splice(0,e.length),f&&f.clearSource(),d.eq=-1,g&&(g.gq=-1,g.repaint())},a.prototype.clearSheetTabs=function(){var a,b,c,d=this,e=d.ECJ,f=d.MJc;for(a=0,b=e;a<b.length;a++)c=b[a],c.mu(),c.no(!0);e.splice(0,e.length),d.KCJ=-1,f&&(f.gq=-1,f.repaint())},a.prototype.getSheet=function(a){var b=this.sheets;return a>=0&&a<b.length?b[a]:I},a.prototype.getSheetTab=function(a){var b,c,d,e=this.ECJ;if("number"==typeof a)return a>=0&&a<e.length?e[a]:I;if("string"==typeof a)for(b=0,c=e;b<c.length;b++)if(d=c[b],d.name()===a)return d;return I},a.prototype.getSheetFromName=function(a){return this.VCJ(a)},a.prototype.VCJ=function(a){var b,c,d,e=this.sheets;for(b=0,c=e;b<c.length;b++)if(d=c[b],d.name()===a)return d;return I},a.prototype.getSheetIndex=function(a){var b,c=this.sheets;for(b=0;b<c.length;b++)if(c[b].name()===a)return b;return I},a.prototype.getSheetTabIndex=function(a){var b,c=this.ECJ;for(b=0;b<c.length;b++)if(c[b].name()===a)return b;return I},a.prototype.getSheetCount=function(){return this.sheets.length},a.prototype.getSheetTabCount=function(){return this.ECJ.length},a.prototype.setSheetCount=function(a){var b=this,c=b.getActiveSheet(),d=b.getActiveSheetTab();b.sw(a,2),b.WHb(c),b.LCJ(d)},a.prototype.sw=function(a,b){var c,d,e=this;if(a<0)throw Ca().Exp_ArgumentOutOfRange;if(0===a&&e.clearSheets(),
c=e.sheets.length,a<c)for(d=c-1;d>=a;d--)e.qw(d,b);else if(a>c)for(d=c;d<a;d++)e.ow(d,b)},a.prototype.DCJ=function(a,b){var c,d,e,f=this;if(a<0)throw Ca().Exp_ArgumentOutOfRange;if(0===a&&f.clearSheetTabs(),c=f.ECJ.length,a<c)for(d=c-1;d>=a;d--)f.RCJ(d,b);else if(a>c)for(d=c;d<a;d++)e=f.SCJ(I,r.SheetType.tableSheet),f.QCJ(d,b,e)},a.prototype.SCJ=function(b,c){var d={name:b,type:c,sheetTab:I};return a.ao(this,"createSheetTab",d,function(){return d.sheetTab!==I}),d.sheetTab},a.prototype.dataManager=function(){var a=this,b=a.HIJ;return!b&&s.DataManager&&(b=a.HIJ=new s.DataManager(a.Wu)),b},a.prototype.bind=function(a,b,c){var d,e,f,h,i,j,k,l=this,m=l.sheets;for(l.rv&&l.rv.push({type:a,data:b,fn:c}),g.GC$(l.sv).bind(a+W,b,c),d=0,e=m;d<e.length;d++)f=e[d],f.bind(a,b,c);for(h=l.ECJ,i=0,j=h;i<j.length;i++)k=j[i],k.bind(a,b,c)},a.prototype.unbind=function(a,b){var c,d,e,f,h,i,j,k,l,m=this,n=m.sheets,o=m.rv;if(o)for(c=o.length-1;c>=0;c--)d=o[c],(d.type===a||m.MAJ(d.type,a))&&o.splice(c,1);for(g.GC$(m.sv).unbind(a+W,b),e=0,f=n;e<f.length;e++)h=f[e],h.unbind(a,b);for(i=m.ECJ,j=0,k=i;j<k.length;j++)l=k[j],l.unbind(a,b)},a.prototype.MAJ=function(a,b){return 0===b.indexOf(".")&&a.substring(a.length-b.length)===b},a.prototype.unbindAll=function(){var a,b,c,d,e,f,h,i=this,j=i.sheets;for(i.rv.length=0,g.GC$(i.sv).unbind(W),a=0,b=j;a<b.length;a++)c=b[a],c.unbindAll();for(d=i.ECJ,e=0,f=d;e<f.length;e++)h=f[e],h.unbindAll()},a.prototype.Fu=function(a,b,c){var d,e,f,h,i,j,k,l=this,m=l.sheets;for(l.rv.push({type:a,data:b,fn:c}),g.GC$(l.sv).bind(a+X,b,c),d=0,e=m;d<e.length;d++)f=e[d],f.Fu(a,b,c);for(h=l.ECJ,i=0,j=h;i<j.length;i++)k=j[i],k.Fu(a,b,c)},a.prototype.Gu=function(a,b){var c,d,e,f,h,i,j,k,l,m=this,n=m.sheets,o=m.rv;for(c=0;c<o.length;c++)d=o[c],(d.type===a||m.MAJ(d.type,a))&&o.splice(c,1);for(g.GC$(m.sv).unbind(a+X,b),e=0,f=n;e<f.length;e++)h=f[e],h.Gu(a,b);for(i=m.ECJ,j=0,k=i;j<k.length;j++)l=k[j],l.Gu(a,b)},a.prototype.nu=function(){var a,b,c,d,e,f,h,i=this,j=i.sheets;for(i.rv.length=0,g.GC$(i.sv).unbind(X),a=0,b=j;a<b.length;a++)c=b[a],c.nu();for(d=i.ECJ,e=0,f=d;e<f.length;e++)h=f[e],h.nu()},a.prototype.Wq=function(a,b){0===this.jm&&g.GC$(this.sv).trigger(a,b)},a.prototype.IkK=function(a,b){g.GC$(this.sv).trigger(a,b)},a.prototype.tw=function(a,b,c,d){this.Wq(h.Events.ButtonClicked,{sheet:a,sheetName:a.name(),row:b,col:c,sheetArea:d})},a.prototype.pw=function(a){var b,c,d,e=this.rv;for(b=0,c=e;b<c.length;b++)d=c[b],a.bind(d.type,d.data,d.fn)},a.prototype.suspendEvent=function(){var a,b,c,d,e,f,g,h=this,i=h.sheets;for(h.jm++,a=0,b=i;a<b.length;a++)c=b[a],c.suspendEvent();for(d=h.ECJ,e=0,f=d;e<f.length;e++)g=f[e],g.suspendEvent()},a.prototype.resumeEvent=function(){var a,b,c,d,e,f,g,h=this,i=h.sheets;for(h.jm--,h.jm<0&&(h.jm=0),a=0,b=i;a<b.length;a++)c=b[a],c.resumeEvent();for(d=h.ECJ,e=0,f=d;e<f.length;e++)g=f[e],g.resumeEvent()},a.prototype.focus=function(a){var b,c;a===!1?h.Vl.Zl(I):(b=this.getActiveSheet(),b?b.zt():(c=this.getActiveSheetTab(),c&&c.zt()))},a.prototype.Wv=function(){return this.Vv>2007?15:18},a.prototype.Xv=function(){return this.Vv>2007?22:this.Wv()},a.prototype.cfc=function(a){var b,c,d=this,e=a?d.WJc:d.XJc,f=a?d.VJc:d.UJc,g=d.options.scrollbarAppearance===r.ScrollbarAppearance.mobile;if(e&&f&&g)switch(b=d.ku,c=f.ifc){case r.ScrollbarState.hide:b.Rec(a);break;case r.ScrollbarState.show:b.Tec(e),b.Wec(a);break;case r.ScrollbarState.active:b.Tec(e),b.Wec(a),b.Uec(e);break;case r.ScrollbarState.inactive:b.Vec(e),b.Rec(a)}},a.prototype.pJc=function(){return this.Vv>2007?28:this.Wv()},a.prototype.uw=function(a,b,c,d,e){var f,h,i="auto",j=this;j.vw||(f=g.getHostMaxZIndex(j.qo)+1,h=A($),e?g.GC$(h).addClass("gc-spread-pivot-toolTip"):g.GC$(h).addClass("gc-spread-toolTip"),g.GC$(h).addClass("ui-state-default ui-widget-content btn-default").css({position:ha,padding:"0px 3px 0px 3px",font:D("normal normal normal 11pt calibri"),"box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","white-space":"pre-wrap","z-index":f}).width(i).height(i).appendTo(H.body),j.vw=h),j.ww(a,b,c,d)},a.prototype.ww=function(a,b,c,d){var e,f,h,i,j,k,l=this,m=l.zCJ();m&&(e=l.vw,e&&(f=g.GC$(e),a?(f.html(a),f.show()):f.hide(),h=m.Vs(),d&&(c-=h.top,b-=h.left),i=m.Dr(),j=i.x+i.width-f.outerWidth(),k=i.y+i.height-f.outerHeight(),j<0?b=0:k<0?c=0:(c=K(c,k),b=K(b,j)),z(c)||f.css("top",c+h.top),z(b)||f.css("left",b+h.left)))},a.prototype.xw=function(){var a=this,b=a.vw;b&&(g.GC$(b).remove(),a.vw=I)},a.prototype.Av=function(){var b,c,d,e=this,g=e.xCJ();for(h.mn.wn(),e.invalidateLayout(),b=0,c=g.length;b<c;b++)d=g[b],d.Av();Ca(),f.Common.JLJ(),q&&p.sR(),e.repaint(),a.ao(e,"onCultureChanged")},a.prototype.getTab=function(){return this.MJc},a.prototype.changeSheetIndex=function(a,b){var c,d,e,f=this,g=f.getSheetIndex(a),h=!1;return z(g)&&(h=!0,g=f.getSheetCount()+f.getSheetTabIndex(a)),c=f.getTab(),d=f.getSheetCount()+f.getSheetTabCount(),!("number"!=typeof b||g===-1||g===b||b<0||b>=d||b%1!==0||f.aOJ(a))&&(e=f.zCJ().name(),e!==a?(f.suspendPaint(),f.cWJ(h,a),f.UD(g,b),f.cWJ(h,e),f.resumePaint()):(f.UD(g,b),c.VMJ(g,b)),!0)},a.prototype.aOJ=function(a){var b,c,d,e,f,g,h,i=this,j=i.sheets;for(b=0,c=j;b<c.length;b++)if(d=c[b],d.name()===a)return!1;for(e=i.ECJ,f=0,g=e;f<g.length;f++)if(h=g[f],h.name()===a)return!1;return!0},a.prototype.UD=function(a,b){var c,d=this,e=-1,f=d.xCJ(),g=f[a],h=d.sheets.length;if(a>b)if(a>=h&&h>b)f.splice(a,1),f.splice(h,0,g),e=h;else{for(c=a;c>b;c--)f[c]=f[c-1];f[b]=g,e=b}else if(a<b)if(a<h&&h<=b)f.splice(h,0,g),f.splice(a,1),e=h-1;else{for(c=a;c<b;c++)f[c]=f[c+1];f[b]=g,e=b}d.CCJ(f),e<h?d.eq=e:d.KCJ=e-h},a.prototype.cWJ=function(a,b){a?this.setActiveSheetTab(b):this.setActiveSheet(b)},a.prototype.setActiveSheetOrSheetTab=function(a){var b=this.getSheetIndex(a),c=!1;z(b)&&(b=this.getSheetTabIndex(a),c=!0),z(b)||this.cWJ(c,a)},a.prototype.clone=function(a,b,c,d){var e,f,g,h,i,j,k,l,m=this,n=m.getSheetFromName(a);if(z(d)&&(d=!0),!(z(n)||z(c)||m.getSheetFromName(c))){for(m.suspendPaint(),m.suspendCalcService(),e=JSON.stringify(n.toJSON({newWorkSheetName:c})),b<0&&(b=0),f=m.vv(c),m.addSheet(b,f),f.yj().q$a=!0,f.fromJSON(JSON.parse(e)),m.setActiveSheet(f.name()),g=n.tables.l$,h=f.tables.l$,k=0;k<g.length;k++)g[k].wq&&d&&(i=g[k].LZ(),h[k].p$(i)),j=h[k].range(),f.t4&&f.t4(j.row,j.col,j.rowCount,j.colCount,r.SheetArea.viewport);return i=n.wq._dataSource,i&&d&&(l=f.wq,l.bind(i)),m.resumeCalcService(),m.resumePaint(),f}},a.prototype.jNc=function(a){var b,c,d,e,f=this,g=a.command;0!==a.s4&&g.yTa||(b=g.sheetName?h.VCJ(f,g.sheetName):h.UCJ(f),b&&(c=b.getActiveRowIndex(),d=b.getActiveColumnIndex(),e=b.getSelections(),g.xC={lNc:e,mNc:{row:c,col:d}}))},a.prototype.kNc=function(b){var c,d,e,f,g,i,j,k,l,m,n=this,o=b.command,p=o.xC,q=h.UCJ(n),r=q&&q.name();if(r!==o.sheetName&&(h.eHJ(n,o.sheetName),q=h.UCJ(n)),!z(p)&&q){if(q.suspendPaint(),c=p.mNc,d=p.lNc,e=p.nNc,f=p.rNc,z(c)||q.Sr(c.row,c.col),!z(d))if(g=d.length,1===g)q.setSelection(d[0].row,d[0].col,d[0].rowCount,d[0].colCount);else for(i=0;i<g;i++)j=d[i].row,k=d[i].col,l=d[i].rowCount,m=d[i].colCount,q.RXJ(j,k,l,m);if(a.ao(n,"onCommandExecuting",q),!z(e)){for(i=0;i<e.length;i++)e[i].isSelected&&e[i].isSelected(!0);f||q.EJ()}q.showCell(c.row,c.col,3,3),q.resumePaint()}},a.prototype.changeSelectionInCommandExecuting=function(a,b,c,d,e){if(a&&a.xC){var f=a.xC,g=f.mNc;z(g)||(z(b)||(g.row=b),z(c)||(g.col=c)),z(d)||(f.lNc=d),z(e)||(f.nNc=e)}},a.prototype.OCJ=function(){var a=this.getActiveSheet();a&&a.no(!1),this.eq=-1},a.prototype.NCJ=function(){var a=this.getActiveSheetTab();a&&a.no(!1),this.KCJ=-1},a.prototype.xCJ=function(){return[].concat(this.sheets).concat(this.ECJ)},a.prototype.CCJ=function(a){var b,c,d,e,f;for(this.sheets.length=0,this.ECJ.length=0,b=this.sheets,c=this.ECJ,d=0,e=a;d<e.length;d++)f=e[d],f instanceof o.Worksheet?b.push(f):c.push(f)},a.prototype.yCJ=function(a){return this.VCJ(a)||this.getSheetTab(a)},a.prototype.ACJ=function(a){return this.xCJ()[a]},a.prototype.getActiveSheetOrSheetTab=function(){return this.zCJ()},a.prototype.zCJ=function(){return this.getActiveSheet()||this.getActiveSheetTab()},a.prototype.BCJ=function(a,b,c,d){var e=this.sheets.length;a<e?this.dq(a,b,c,d):(a-=e,this.FCJ(a,b,c,d))},a.prototype.setActiveSheetOrSheetTabIndex=function(a,b,c,d){var e=this.getActiveSheet(),f=this.getActiveSheetTab();this.BCJ(a,z(b)?2:b,c,d),this.WHb(e),this.LCJ(f)},a.prototype.getActiveSheetOrSheetTabIndex=function(){return this.TCJ()},a.prototype.TCJ=function(){var a=this.eq;return a<0&&(a=this.sheets.length+this.KCJ),a},a.prototype.LVJ=function(){var a=[].concat(this.sheets);return this.ECJ.forEach(function(b){b.kj&&a.push(b.kj)}),a},a.prototype.$dK=function(){var a,b,c=this,d=c.sheets,e=d.length,f=[];for(a=0;a<e;a++)b=d[a],b&&f.push(b.name());return f},a.Qp=Ha,a.nv=1,a.ov=0,a}(),b.Workbook=Ia,h.Zn(Ia),Ia.prototype.nextControl=B("nextControl",I),Ia.prototype.previousControl=B("previousControl",I)},"./dist/core/workbook/workbookpanelex.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/domUtil.js"),e=c("./dist/core/util/common.js"),f=c("Common"),g=c("./dist/core/core.enum.js"),h=c("./dist/core/workbook/sheettabbase.js"),i=f.Common.j.Fa,j=null,k=e.Ul.Ml,l=e.Ul.nl,m=e.Ul.Nl,n=e.Ul.Pl,o=document,p=window,q=Math.round,r=Math.ceil,s="gc-scroll-container",t="gc-scroll-corner-all",u="gc-scroll-arrow",v="gc-scrollbar-wrapper",w="gc-scroll-bar",x="gc-scroll-arrowUp",y="gc-scroll-arrowDown",z="gc-scroll-arrowLeft",A="gc-scroll-arrowRight",B="gc-scroll-mobile-track",C="gc-scroll-mobile-thumb",D="gc-scroll-mobile-state-active",E="gc-scrollbar-vertical",F="gc-scrollbar-horizontal",G="gc-no-user-select",H="width",I="height",J="gc-scrollbar-stateActive ui-state-active",K="float",L="left",M="right",N="top",O="bottom",P="margin-left",Q="position",R="border",S="padding",T="margin",U="overflow",V="display",W="outline",X="100%",Y="borderWidth",Z="boxSizing",$="absolute",_="relative",aa="margin-top",ba=".gcScrollbar",ca="mousedown"+ba,da="mouseup"+ba,ea="mousemove"+ba,fa="mouseover"+ba,ga="mouseout"+ba,ha="mousewheel",ia="inline-block",ja="content-box",ka="DOMMouseScroll",la="scroll"+ba,ma="scrollbar";function sa(a){a.preventDefault?a.preventDefault():a.returnValue=!1}!function(a){a[a.horizontalScroll=0]="horizontalScroll",a[a.verticalScroll=1]="verticalScroll"}(na=b.ScrollOrientation||(b.ScrollOrientation={})),oa=function(){function a(a,b,c,d,e,f,h,i,k){this.updateStateFn=k;var l=this;l.jfc=i,l.JB=!1,l.KB=!1,l.LB=j,l.MB=j,l.NB=300,l.OB=70,l.PB=a,l.Jwa(g.ScrollbarState.show),l.Vo("number"==typeof b?b:0),l._v("number"==typeof c?c:0),l.dw("number"==typeof d?d:0),l.cw("number"==typeof e?e:0),l.bw("number"==typeof f?f:0),l.QB="number"==typeof h?h:1,l.RB=!1,l.SB=0,l.Qb=l.bw(),l.ew()}return a.prototype.Bv=function(){return this.TB},a.prototype.Jwa=function(a){a===g.ScrollbarState.inactive&&this.JB||(this.ifc=a,this.updateStateFn&&this.updateStateFn())},a.prototype.value=function(a){var b,c=this;return 0===arguments.length?c.Qb:("number"==typeof a&&a<=c.cw()&&a>=c.bw()&&(c.Qb=a,b=(a-c.bw())*c.UB,c.scrollTo(b,!0)),c)},a.prototype.ew=function(){var a,b,c,e=this,f=0,h=0,i=!1,j=e.jfc,k=j===g.ScrollbarAppearance.mobile,l=k?0:2,n="ui-widget ui-corner-all",o=e._v(),p=e.Vo(),r=k?0:o,D=p-2*r,J=r,ba=L,ca=M,da=z,ea=A,fa=F,ga=P,ha="ui-button ui-state-default ui-corner-bl btn btn-default",ka="ui-icon ui-icon-triangle-1-w",la="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",ma="ui-icon ui-icon-grip-solid-vertical",na="ui-button ui-state-default ui-corner-br btn btn-default",oa="ui-icon ui-icon-triangle-1-e";e.VB=D,e.PB||(r=k?0:p,D=r,J=o-2*r,ba=N,ca=O,da=x,ea=y,fa=E,ga=aa,ha="ui-button ui-state-default ui-corner-tr btn btn-default",ka="ui-icon ui-icon-triangle-1-n",la="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",ma="ui-icon ui-icon-grip-solid-horizontal",na="ui-button ui-state-default ui-corner-br btn btn-default",oa="ui-icon ui-icon-triangle-1-s",e.VB=J);function pa(){e.TB=m("div"),e.WB=d.GC$(e.TB),e.WB.css([Q,L,N,U,W,S,T],[_,0,0,"hidden","none",0,0]).addClass(s+" "+t+" "+n+" "),e.PB&&e.WB.css(K,L)}function qa(a){e.XB=d.GC$.Nl("div",[Q,V,Y,S,T,Z],[$,ia,"1px",0,0,ja],u+" "+ha,a),e.YB=d.GC$.Nl("span",[V,R,S,T],["block","none",0,0],da+" "+ka,e.XB)}function ra(a){e.ZB=d.GC$.Nl("div",[Q,V,Z,R,S,T],[$,ia,ja,"none",0,0],v+" "+v,a)}function sa(a){e.$B=d.GC$.Nl("div",[],[],G+" "+la+" "+w,a),e._B=d.GC$.Nl("span",[V,R,S,T],["block","none",0,0],fa+" "+ma,e.$B)}function ua(a){e.aC=d.GC$.Nl("div",[Q,V,Y,S,T,Z],[$,ia,"1px",0,0,ja],u+" "+na,a),e.bC=d.GC$.Nl("span",[V,R,S,T],["block","none",0,0],ea+" "+oa,e.aC)}a=e.VB,b=e.cw()-e.bw(),e.dC=e.dw()*a/(b+e.dw()),e.dC>a&&(e.dC=a),e.dC<10&&(e.dC=10),c=e.dC,e.UB=0===b?1:(a-c)/b,e.PB?(f=c,h=r):(f=r,h=c),e.WB||(i=!0,pa()),k?e.WB.addClass(B):e.WB.removeClass(B),e.XB||qa(e.WB),e.ZB||ra(e.WB),e.$B?e.$B.removeAttr("style"):sa(e.ZB),k?e.$B.css(Q,$).addClass(C):e.$B.css([Q,Y,S,T,Z],[$,"1px",0,0,ja]).removeClass(C),e.aC||ua(e.WB),k?(ta(e.WB,R),ta(e.WB,T),e.PB?(e.WB.css([H,I],[p,X]),e.ZB.css([ba,H,I],[r,X,X]),e.$B.css([ba,H,I],[e.SB,q(f-l),X])):(e.WB.css([H,I,T],[X,X,0]),e.ZB.css([ba,H,I],[r,X,X]),e.$B.css([ba,H,I],[e.SB,X,q(h-l)])),e._B.remove(),e.XB.remove(),e.aC.remove()):(e.WB.css([H,I,R],[p,o,"none"]),e.ZB.css([ba,H,I],[r,D,J]),e.$B.css([ba,H,I],[e.SB,q(f-l),q(h-l)]),e.XB.css([ba,H,I],[0,r-l,r-l]),e.YB.css([H,I],[X,X]),e.aC.css([ca,H,I],[0,r-l,r-l]),e.bC.css([H,I],[X,X]),e._B.css([H,I,ga],[r-l,r-l,Math.floor((e.dC-r)/2)]),e.$B.append(e._B),e.WB.append(e.XB),e.WB.append(e.aC)),i&&e.eC()},a.prototype.eC=function(){var b=this;function c(a,c){a.bind(ca,function(a){b.fC(a,c)}).bind(da,function(a){b.gC(a,c)}).bind(fa,function(a){b.hC(a,c)}).bind(ga,function(a){b.iC(a,c)})}c(b.XB,!0),c(b.aC,!1),b.$B.bind(ca,function(a){b.jC(a)}).bind(ea,function(a){b.kC(a)}).bind(da,function(a){b.lC(a)}).bind(fa,function(a){b.mC(a)}).bind(ga,function(a){b.nC(a)}),b.ZB.bind(ca,function(a){var c,d,e=k&&k.mozilla;e&&(c=(new Date).valueOf(),d=b.oC,b.oC=c,d&&c-d<100)||b.pC(a)}).bind(da,function(a){b.qC(a)}),b.GB=function(a){b.sC(a)},b.WB.bind(ha,b.GB),b.WB.bind(ka,b.GB),a.ao(b,"initEvents",b.TB)},a.prototype.$ec=function(a){this.jfc=a},a.prototype.dispose=function(){var b=this;function c(a){a&&a.unbind(ba)}c(b.aC),c(b.$B),c(b.XB),c(b.ZB),b.WB&&(b.GB&&(b.WB.unbind(ha,b.GB),b.WB.unbind(ka,b.GB)),a.ao(b,"dispose",b.TB),b.WB.unbind(ba).remove())},a.prototype.tC=function(){var a=this;a.RB||(d.GC$(o).bind(ea,function(b){a.kC(b)}).bind(da,function(b){a.lC(b)}),a.RB=!0)},a.prototype.uC=function(){this.RB&&(this.RB=!1,d.GC$(o).unbind(ea).unbind(da))},a.prototype.fC=function(a,b){var c,d=0,e=this,f=!0;e.KB=!0,null===e.LB&&(b?(e.XB.addClass(J),d=0-e.qB(),e.vC=g.Nxb.smallDecrement):(e.aC.addClass(J),d=e.qB(),e.vC=1),c=function(){e.scrollTo(e.SB+d*e.UB,!1),e.LB=p.setTimeout(c,f?e.NB:e.OB),f=!1},c(),sa(a))},a.prototype.gC=function(a,b){var c=this,d=b?c.XB:c.aC;d.removeClass(J),c.wC(),sa(a)},a.prototype.hC=function(a,b){var c=this,d=b?c.XB:c.aC;d.addClass("gc-scroll-arrow-hover ui-state-hover"),sa(a)},a.prototype.iC=function(a,b){var c=this,d=b?c.XB:c.aC;d.removeClass("gc-scroll-arrow-hover ui-state-hover "+J),c.wC(),sa(a)},a.prototype.jC=function(a){var b,c,d,e,f,h,i=this;0===a.button&&(i.JB=!0,i.xC={x:a.pageX,y:a.pageY},i.Jwa(g.ScrollbarState.show),i.tC(),i.WB.addClass(D),i.$B.addClass(J),b=i.$B.offset(),c=i.$B.outerWidth(!0),d=i.$B.outerHeight(!0),e=i.ZB.offset(),f=i.ZB.outerWidth(!0),h=i.ZB.outerHeight(!0),i.yC={isBeyondEdge:!1,startEdgePosition:{x:e.left+a.pageX-b.left,y:e.top+a.pageY-b.top},endEdgePosition:{x:e.left+f-(c-a.pageX+b.left),y:e.top+h-(d-a.pageY+b.top)}}),sa(a)},a.prototype.kC=function(a){var b=this;b.JB&&(b.Jwa(g.ScrollbarState.active),b.zC={x:a.pageX,y:a.pageY},b.AC(),b.xC=b.zC,d.GC$(o.body).attr("unselectable","on").addClass(G)),sa(a)},a.prototype.lC=function(a){var b,c,e,f,h,i=this;i.JB=!1,i.vC=g.Nxb.thumbPosition,i.yC=null,i.WB.trigger(la,{newValue:i.Qb,oldValue:i.Qb,scrollOrientation:i.PB?na.horizontalScroll:na.verticalScroll,scrollEventType:i.vC}),b=i.Qb,c=(b-i.bw())*i.UB,e="left",f=a.target.classList,h=f&&f.contains(C),i.PB||(e="top"),h?i.Jwa(g.ScrollbarState.hide):i.Jwa(g.ScrollbarState.inactive),i.SB=c,i.$B.css(e,q(c)),i.uC(),d.GC$(o.body).removeClass(G),d.GC$(o.body).attr("unselectable")&&d.GC$(o.body).removeAttr("unselectable"),i.$B.removeClass(J),i.WB.removeClass(D),i.vC=6,i.WB.trigger(la,{newValue:i.Qb,oldValue:i.Qb,scrollOrientation:i.PB?na.horizontalScroll:na.verticalScroll,scrollEventType:i.vC}),sa(a)},a.prototype.mC=function(a){this.$B.addClass("gc-scrollbar-stateHover ui-state-hover"),sa(a)},a.prototype.nC=function(a){this.$B.removeClass("gc-scrollbar-stateHover ui-state-hover"),sa(a)},a.prototype.sC=function(a){var b,c,d,e=this;i(a.wheelDelta)&&i(a.detail)&&(a.wheelDelta=a.originalEvent.wheelDelta,a.detail=a.originalEvent.detail),b=a.detail?a.detail:a.wheelDelta/-40,c=b/3*e.qB()*e.UB,e.vC=c>=0?1:0,e.scrollTo(e.SB+c,!1),e.vC=6,d={newValue:e.Qb,oldValue:e.Qb,scrollOrientation:e.PB?na.horizontalScroll:na.verticalScroll,scrollEventType:e.vC},e.WB.trigger(la,d),sa(a)},a.prototype.pC=function(a){var b,c=this,d=!0,e=a.pageX,f=a.pageY,h=0,i=c.ZB.offset(),j=c.rB();null===c.MB&&(h=c.PB?e-i.left-c.SB:f-i.top-c.SB,b=function(){var a=0,k=c.SB;if(a=c.PB?e-i.left-k:f-i.top-k,a*h<0||a>=0&&a<c.dC)return void c.CC();if(h<0)c.vC=g.Nxb.largeDecrement,c.scrollTo(k-j*c.UB,!1);else{if(!(h>0))return void c.CC();c.vC=g.Nxb.largeIncrement,c.scrollTo(k+j*c.UB,!1)}c.MB=p.setTimeout(b,d?c.NB:c.OB),d=!1},b(),sa(a))},a.prototype.qC=function(a){this.CC(),sa(a)},a.prototype.CC=function(){var a,b=this;b.MB&&clearTimeout(b.MB),b.MB=j,b.vC=g.Nxb.endScroll,a={newValue:b.Qb,oldValue:b.Qb,scrollOrientation:b.PB?na.horizontalScroll:na.verticalScroll,scrollEventType:b.vC},b.WB.trigger(la,a)},a.prototype.wC=function(){var a,b=this;b.KB&&(b.KB=!1,b.LB&&clearTimeout(b.LB),b.LB=j,b.vC=6,a={newValue:b.Qb,oldValue:b.Qb,scrollOrientation:b.PB?na.horizontalScroll:na.verticalScroll,scrollEventType:b.vC},b.WB.trigger(la,a))},a.prototype.AC=function(){var a,b,c,d,e,f,g,h,i=this,j=i.SB,k=i.zC,l=i.yC;function m(a){return i.PB?a.x:a.y}function n(a,b){i.PB?a.x=b:a.y=b}if(c=m(k),d=m(i.xC),l&&l.isBeyondEdge){if(e=m(l.startEdgePosition),f=m(l.endEdgePosition),a=c<e,b=c>f,a||b)return;d<e&&n(i.xC,e),d>f&&n(i.xC,f)}g=c-d,h=j+g,h!==j&&(i.vC=5,i.scrollTo(h,!1))},a.prototype.scrollTo=function(a,b){var c,d,e,f,h,j,k,l,m=this,n=N,o=m.VB-m.dC;m.PB&&(n=L),c=!1,d=!1,e=!1,a>o&&(a=o,e=!0,d=!0),a<0&&(a=0,e=!0,c=!0),m.yC&&(m.yC.isBeyondEdge=e),f=m.QB===g.ScrollType.continuous?q(a/m.UB)+m.bw():a/m.UB+m.bw(),h=m.Qb,j=!1,b||(l={newValue:f,oldValue:h,scrollOrientation:m.PB?na.horizontalScroll:na.verticalScroll,scrollEventType:m.vC,isBeyondMaxEdge:d,isBeyondMinEdge:c},m.WB.trigger(la,l),j=l.ignoreUpdatePosition,l.newValue>m.cw()&&(l.newValue=m.cw()),f=l.newValue,k=l.newValueWithOffset),i(k)&&(k=f),m.Qb=f,5!==m.vC&&(a=(k-m.bw())*m.UB),m.SB=a,j||m.$B.css(n,q(a))},a.prototype.hitTest=function(a,b){var c,e,f,h,i=this,j=0,k=0,l=i.$B.outerWidth(),m=i.XB.outerWidth(),n=i.ZB.outerWidth(),o=i.$B.offset(),p=d.GC$(i.Bv()).offset(),q=o.left-p.left-18;return i.PB?a<j+n+m&&a>j+m?a<j+q+l+m&&a>q?{element:g.Oxb.ThumbButton,x:a,y:b}:{element:g.Oxb.TrackButton}:a<=j+m&&a>j?{element:g.Oxb.LeftButton,x:a,y:b}:{element:g.Oxb.RightButton,x:a,y:b}:(c=i.$B.outerHeight(),e=i.XB.outerHeight(),f=i.ZB.outerHeight(),h=o.top-p.top-18,b<k+f+e&&b>k+e?b<k+h+c+e&&b>h?{element:g.Oxb.ThumbButton,x:a,y:b}:{element:g.Oxb.TrackButton}:b<=k+e&&b>k?{element:g.Oxb.UpButton,x:a,y:b}:{element:g.Oxb.DownButton,x:a,y:b})},a.prototype.pia=function(){var a=this;return{x:0,y:0,width:a.Vo(),height:a._v()}},a.prototype.show=function(){this.ZB.show()},a.prototype.hide=function(){this.ZB.hide()},a.prototype.MDc=function(a){var b=this,c=b.WB.parent()&&b.WB.parent().parent();return c?a?c.height():c.width():j},a}(),b.hv=oa;function ta(a,b){var c=a.get(0);c&&(c.style[b]="")}e.Zn(oa),pa=oa.prototype,pa.qB=n("smallChange",1),pa.rB=n("largeChange",10),pa.dw=n("pageValue",10,function(a){a<=0&&this.dw(1)}),pa.cw=n("maximum",100,function(a){a<=0&&this.cw(0)}),pa.bw=n("minimum",0,function(a){a<=0&&this.bw(0)}),pa.Vo=n("width",0),pa._v=n("height",0),qa=function(){function a(a,b){var c=this;c.fB=!0,c.gB=!0,c.hB=18,c.iB=a&&d.GC$(a),c.jB=b&&d.GC$(b),c.ew(!0)}return a.prototype.ew=function(a){var b,c,e,f,g,h,i,l,m,n,o,p,s,t=this;function u(a){return a===$?d.GC$.Nl("div",[Q,L,N,R,S,T],[$,0,0,"none",0,0]):a===_?d.GC$.Nl("div",[Q,L,N,R,S,T],[_,0,0,"none",0,0]):j}function v(a,b){var c,e,f,g=b?t.mB:t.nB;return g?g:(c=new oa(b),e=d.GC$.Nl("div"),b?(t.oB=e,t.mB=c,e.css([Q,L,O,R,S,T],[$,0,0,"none",0,0])):(t.pB=e,t.nB=c,e.css([Q,M,N,R,S,T],[$,0,0,"none",0,0])),f=(b?t.mB:t.nB).Bv(),e.append(f),a.append(e),c)}function w(a,b,c,e,f,g){g?(t.oB.css([H,I],[b,e]),a.Vo(b),a._v(e)):(t.pB.css([H,I],[e,b]),a.Vo(e),a._v(b)),a.bw(0),a.cw(f-b),a.dw(b),a.qB(g?t.kB():t.lB()),a.rB(b),a.ew(),d.GC$(a.Bv()).bind(la,function(a,b){c.css(g?L:N,0-b.newValue)}),g?t.oB.show():t.pB.show()}function x(a){t.sB||(t.sB=u(_),t.sB.css([U,V,H],["hidden",ia,X]),a.append(t.sB))}function y(a){t.tB||(t.tB=d.GC$.Nl("div",Q,_,j,a))}t.iB&&t.jB&&(b=t.hB,c=t.jB.width(),e=t.jB.height(),f=t.iB.width(),g=t.iB.height(),h=f-b,i=g-b,l=!1,t.uB||(t.uB=u(_),t.uB.css([Q,U],[_,"hidden"]),l=!0),t.uB.css(I,g),x(t.uB),y(t.sB),a&&t.tB.append(t.jB).css([N,L],[0,0]),k.chrome&&(c=q(c),e=q(e),f=r(f),g=r(g)),m=t.vB(c,e,f,g),n=m.wB,o=m.xB,o?(n||(h+=b),p=v(t.uB,!0),w(p,h,t.tB,b,c,!0)):t.oB&&t.oB.hide(),n?(o||(i+=b),s=v(t.uB,!1),w(s,i,t.tB,b,e,!1)):t.pB&&t.pB.hide(),o||n||(h+=b,i+=b),t.fB=o,t.gB=n,t.yB=h,t.zB=i,t.sB.css(I,i),l&&(t.iB.append(t.uB),t.AB()))},a.prototype.BB=function(a){var b=this,c=b.CB(a),d=c.EB,e=c.FB;!i(d)&&b.mB&&b.lu(d),!i(e)&&b.nB&&b.ju(e)},a.prototype.lu=function(a){var b,c,d=this;d.mB.value(a),b=d.yB,c=d.jB.width(),a>=0&&a<=c-b&&d.tB.css(L,0-a)},a.prototype.ju=function(a){var b,c,d=this;d.nB.value(a),b=d.zB,c=d.jB.height(),a>=0&&a<=c-b&&d.tB.css(N,0-a)},a.prototype.vB=function(a,b,c,d){var e=this.hB,f=c,g=d-e,h={xB:!1,wB:!1};return a>c&&(h.xB=!0,h.wB=b>g),b>d&&(h.wB=!0,h.xB=a>f),h},a.prototype.CB=function(a){var b=d.GC$(a),c=this.sB,e=this.tB,f,g,h,i,k,l,m,n={EB:j,FB:j};return a?(f=b.offset(),g=e.offset(),h=c.offset(),f.leftWidth=f.left+b.outerWidth(),f.topHeight=f.top+b.outerHeight(),h.leftWidth=h.left+c.outerWidth(),h.topHeight=h.top+c.outerHeight(),i=f.left-g.left,f.left<h.left?n.EB=i:f.leftWidth>h.leftWidth&&(k=f.leftWidth-g.left-c.innerWidth(),i<k?n.EB=i:n.EB=k),l=f.top-g.top,f.top<h.top?n.FB=l:f.topHeight>h.topHeight&&(m=f.topHeight-g.top-c.innerHeight(),l<m?n.FB=l:n.FB=m),n):n},a.prototype.AB=function(){var a=this;this.tB&&(a.GB=function(b){a.HB(b)},a.tB.bind(ha,a.GB),a.tB.bind(ka,a.GB))},a.prototype.HB=function(a){var b,c,d,e,f,g,h,j=this;i(a.wheelDelta)&&i(a.detail)&&(a.wheelDelta=a.originalEvent.wheelDelta,a.detail=a.originalEvent.detail),b=a.detail?a.detail:a.wheelDelta/-40,c=b,d=j.nB,e=parseInt(j.tB.css(N),10),f=j.zB,g=j.jB.height(),g<f&&(g=f),isNaN(e)&&(e=0),h=e-c*j.lB(),h>=0&&(h=0),h<0&&0-h>g-f&&(h=0-(g-f)),h!==e&&(j.tB.css(N,h),j.gB&&d.value(0-h)),l(a)},a.prototype.dispose=function(){var a=this;a.uB&&(a.mB&&a.mB.dispose(),a.nB&&a.nB.dispose(),a.tB&&a.GB&&(a.tB.unbind(ha,a.GB),a.tB.unbind(ka,a.GB)),d.GC$(a.uB).remove())},a}(),b.IB=qa,ra=qa.prototype,ra.kB=n("horizontalSmallChange",10),ra.lB=n("verticalSmallChange",10),h.DC.$n(ma,{preProcessMouseMove:function(a){var b=this.OC,c=b.VJc.JB||b.UJc.JB;c&&(a.r=!0)}})},"./dist/core/worksheet/clipboardhelper.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/common.js"),e=c("Common"),f=c("./dist/core/worksheet/stylehelper.js"),g=c("./dist/core/worksheet/style.js"),h=c("./dist/core/core.enum.js"),i=e.Common.u,j=/<img[^>]+>/g,k=d.Ul.Ml,l=e.Common.j.Fa,m=e.Common.k.Bb,n=null;function p(a){return a&&a.options.allowCopyPasteExcelStyle}function q(a,b){var c,d;if(k.msie){for(c=[],d=0;d<a.length;d++)b&&""===a[d].trim()||c.push(a[d]);return c.join("")}return a.join("")}function r(a){for(var b="picture",c=1,d=b+(""+c);a.get(d);)c++,d=b+(""+c);return d}function s(a,b,c,d){var e,f,g=[];for(e=0,f=c;e<f;e++)g[b+e]=a.getRowHeight(b+e,d);return g}function t(a,b,c,d){var e,f,g=[];for(e=0,f=c;e<f;e++)g[b+e]=a.getColumnWidth(b+e,d);return g}function u(a,b,c){var d,e;if(b||(b="<!--"),c||(c="-->"),!a)return a;for(;;){if(d=a.indexOf(b),d<0)break;if(e=a.indexOf(c),e<0)break;a=a.substring(0,d)+a.substring(e+c.length)}return a}function v(a,b,c){var d,e=-1;if(c)for(e=0,d=0;d<b;d++)e+=c[a+d]||0;return e}function w(a,b,c){var d,e=-1;if(c)for(e=0,d=0;d<b;d++)e+=c[a+d]||0;return e}o=function(){function a(a){var b=this;b.PA=n,b.n5=n,b.G4=!1,b.tc=a,b.Nl()}return a.prototype.Nl=function(){var b,c,e,f=this,g=document.createElement("div");g.style.position="fixed",g.style.top="0px",g.style.left="0px",g.style.width="0px",g.style.height="0px",g.style.overflow="hidden",b=document.createElement("div"),b.setAttribute("contenteditable","true"),b.setAttribute("gcUIElement","gcSheetClipboard"),b.setAttribute("tabindex","-1"),b.style.position="absolute",b.style.overflow="hidden",b.style.background="white",b.style.webkitUserSelect="text",g.appendChild(b),f.KM=b,c=document.createElement("textarea"),c.setAttribute("gcUIElement","gcSheetClipboard"),f.tc&&f.tc.options.enableAccessibility&&c.setAttribute("aria-hidden","true"),c.setAttribute("tabindex","-1"),c.style.position="absolute",c.style.overflow="hidden",c.style.background="white",c.style.webkitUserSelect="text",g.appendChild(c),f.qka=c,e=f.tc.getHost(),e&&e.appendChild(g),k.msie||k.edge||(f.H4=function(b){var c,e,g,h,i,k,l,m=d.UCJ(f.tc),n=b.clipboardData;if(n)if(c=n.getData("text/html"),c=c.replace(j,""),e=f.I4(),e.innerHTML=c,g=c?f.EZa(e,!0):a.formatClipboardData(n.getData("text/plain")),e.innerHTML="",g||c&&c.indexOf("<table")>=0)m.J4(g,c);else{for(h=void 0,i=n.items,k=0;k<i.length&&(0!==i[k].type.indexOf("image")||!(h=i[k].getAsFile()));k++);h&&(l=new FileReader,l.onload=function(a){var b=new Image;b.src=a.target.result,b.onload=function(){m.J4(g,c,b.src)}},l.readAsDataURL(h))}b.preventDefault()},b.addEventListener("paste",f.H4),f.rka=function(b){var c,e,g,h=d.UCJ(f.tc),i=b.clipboardData;i&&(c=a.formatClipboardData(i.getData("text/plain")),c||(e=i.getData("text/html"),e&&(g=f.I4(),g.innerHTML=e,c=f.EZa(g,!1),g.innerHTML="")),h.J4(c,"")),b.preventDefault()},c.addEventListener("paste",f.rka))},a.prototype.no=function(){var a,b,c,d,e,f,g=this,h=g.KM;h&&(k.msie||k.edge||(h.removeEventListener("paste",g.H4),g.qka.removeEventListener("paste",g.rka)),a=h.parentElement,a&&(b=a.parentElement,b&&b.removeChild(a)),g.KM=n,g.qka=n),c=g.K4,c&&(d=c.parentElement,d&&d.removeChild(c),g.K4=n),e=g.FZa,e&&(f=e.parentElement,f&&f.removeChild(e),g.FZa=n),g.tc=n},a.prototype.ska=function(a){p(this.tc)?this.KM.innerHTML=a:this.qka.value=a},a.prototype.M4=function(){p(this.tc)?this.KM.focus():this.qka.focus()},a.prototype.N4=function(){p(this.tc)?document.execCommand("selectAll"):this.qka.select()},a.prototype.wx=function(){var b,c,d,e="",f="",g="";return p(this.tc)?(b=this.KM,b&&(c=b.getElementsByTagName("table"),c.length>0?e=c[0].outerHTML:(d=b.getElementsByTagName("img"),d.length>0&&(g=d[0].src))),f=this.EZa(this.KM,!0)):f=a.formatClipboardData(this.qka.value),{html:e,text:f,image:g}},a.Q4=function(b,c,e,f,g,i,j,l,m,o,p,q,r,u){var v,w,x,y,z,A,B,C,D,E,F,G,H=b.Tq(d.kf(e,g,f,i),j),I=RegExp(String.fromCharCode(32),"g"),J="&nbsp;",K=!1,L=!1;return j===h.SheetArea.viewport&&(e<0&&2===(2&c)&&(K=!0),g<0&&1===(1&c)&&(L=!0)),e=H.row,g=H.col,f=H.rowCount,i=H.colCount,v=p?b.options.gridline:n,w=p?{color:"#d4d4d4",showHorizontalGridline:!0,showVerticalGridline:!0}:n,x=r?s(b,e,f,j):n,y=r?t(b,g,i,j):n,z=!u&&f*i>4e3&&(k.safari||k.mozilla||d.Ul.sl()&&k.chrome),j===h.SheetArea.viewport?(A=void 0,B=void 0,C=n,D=n,E=a.Ema(b,e,f,g,i,3,m,o,l,H,I,J,v,q,x,y,u),L&&(A=r?t(b,g,i,2):n,F=b.getColumnCount(2),C=a.Ema(b,e,f,0,F,2,m,[],l,H,I,J,w,q,x,A,u)),K&&(B=r?s(b,e,f,1):n,G=b.getRowCount(1),D=a.Ema(b,0,G,g,i,1,[],o,l,H,I,J,w,q,B,y,u)),a.yb(E,C,D,u,z)):j===h.SheetArea.rowHeader?(C=a.Ema(b,e,f,g,i,2,m,o,l,H,I,J,w,q,x,y,u),a.yb(C,n,n,u,z)):j===h.SheetArea.colHeader?(D=a.Ema(b,e,f,g,i,1,m,o,l,H,I,J,w,q,x,y,u),a.yb(D,n,n,u,z)):void 0},a.yb=function(b,c,d,e,f){var g,h,i=b,j=0,k=function(a,b){var c,d=[],e=a.length;for(c=0;c<e;c++)d.push(a[c].concat(b[c]));return d};return c&&(j=c[0].length,i=k(c,b)),d&&(g=d.length,j&&(h=a.Ema(n,0,g,0,j,n,[],[],!1,n,n,n,n,!1,[],[],e),d=k(h,d)),i=d.concat(i)),f&&a.$ZJ(i),a.Fma(i,e)},a.$ZJ=function(a){var b,c=a.length;for(b=a.length-1;b>=0&&a[b].join("").search(/>\S+</)===-1;b--)c=b;a.length=c},a.Fma=function(a,b){var c,d,e="",f=a.length;for(e+=b?'<table style="border-collapse: collapse">':'<table gc-sjs-clipboard="true" style="min-width:1px;min-height:1px;">',c=0;c<f;c++){for(e+="<tr>",d=0;d<a[c].length;d++)e+=a[c][d];e+="</tr>"}return e+="</table>"},a.BUJ=function(a){return a&&a.indexOf('gc-sjs-clipboard="true"')>=0},a.Ema=function(b,c,e,f,g,h,j,o,p,q,r,s,t,u,v,w,x){var y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa;for(t&&(y=t.color,z=t.showHorizontalGridline,A=t.showVerticalGridline),B=[],C=0;C<e;C++)if(D=c+C,!(m(j,D)||x&&v&&v[D]<=0)){for(E=[],F=0;F<g;F++)if(G=f+F,!(m(o,G)||x&&w&&w[G]<=0)){if(H="",I=void 0,J=void 0,K=1,L=1,p&&b&&(I=b.getSpan(D,G,h),I&&a.isPartSpan(I,q,j,o)&&(I=n),I)){if(I.row!==D||I.col!==G)continue;J=b.getActualStyle(D,G,h),M=b.getActualStyle(I.row+I.rowCount-1,I.col+I.colCount-1,h),!J.borderRight&&M.borderRight&&(J.borderRight=M.borderRight),!J.borderBottom&&M.borderBottom&&(J.borderBottom=M.borderBottom)}H+="<td",N=b&&b.getValue(D,G,h),p&&b&&(I&&(K=I.rowCount,K>1&&(H+=" rowSpan="+K),L=I.colCount,L>1&&(H+=" colSpan="+L)),J||(J=b.getActualStyle(D,G,h)),O=a.convertVAlign,P=a.convertHAlign,Q=a.convertLineBorder,H+=x?' style="padding: 0; ':' style="',R=z,S=A,T=J.backColor,T&&(H+="background-color: "+T+";",R=!1,S=!1),U=J.foreColor,U&&(H+="color: "+U+";"),V=J.font,V&&(u&&(V=V+", "+d.FallbackFontFamily),H+="font: "+V.replace(/"/g,"'")+";"),W=J.vAlign,l(W)||(H+="vertical-align: "+O(W)+";"),X=J.hAlign,l(X)||(x&&(X=d.Ul.ol(X,N)),Y=P(X),Y&&(H+="text-align: "+Y+";")),Z=J.borderLeft,Z&&(H+="border-left: "+Q(Z)+";",S=!1),$=J.borderRight,$&&(H+="border-right: "+Q($)+";",S=!1),_=J.borderTop,_&&(H+="border-top: "+Q(_)+";",R=!1),aa=J.borderBottom,aa&&(H+="border-bottom: "+Q(aa)+";",R=!1),R&&S?H+="border: 1px solid "+y+";":R?(H+="border-top: 1px solid "+y+";",H+="border-bottom: 1px solid "+y+";"):S&&(H+="border-left: 1px solid "+y+";",H+="border-right: 1px solid "+y+";"),ba=V?d.Ul.fp(V):0,H+=a.$RJ(D,G,K,L,v,w,ba),H+='"'),H+=">",ca=void 0,da=void 0,p&&b&&(ea=J.textDecoration,ca=2===(2&ea),da=1===(1&ea),da||(da=8===(8&ea)),ca&&(H+="<s>"),da&&(H+="<u>")),fa=b?b.getText(D,G,h):"",fa?(" "!==fa[0]&&" "!==fa[fa.length-1]||"number"!=typeof N||(fa=fa.trim()),"number"!=typeof N&&(fa=i.Ob(fa).replace(r,s))):k.chrome?fa=" ":k.safari&&(fa="&nbsp;"),H+=fa,p&&(da&&(H+="</u>"),ca&&(H+="</s>")),H+="</td>",E.push(H)}B.push(E)}return B},a.$RJ=function(a,b,c,d,e,f,g){var h,i,j="",k=v(a,c,e);return k>0&&(k-=1),h=w(b,d,f),h>0&&(h-=1),k>=0&&h>=0&&(i=Math.min(g,k),j="overflow: hidden;white-space: nowrap;height: "+k+"px;line-height: "+i+"px; width: "+h+"px;max-width: "+h+"px;min-width: "+h+"px;"),j},a.prototype.I4=function(){var a,b,c=this;return c.K4||(a=document.createElement("div"),a.style.display="none",b=c.tc.getHost(),b&&b.appendChild(a),c.K4=a),c.K4},a.prototype.f8J=function(){var a,b,c=this;return c.FZa||(a=document.createElement("div"),a.style.display="none",b=c.tc.getHost(),b&&b.appendChild(a),c.FZa=a),c.FZa},a.prototype.R4=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q=this.I4();if(q.innerHTML=a,e=q.getElementsByTagName("table"),f=b.CMc(),e.length>0)for(g=this.HZa(e[0],!0),
h=0,i=c+h;h<g.length;h++,i++){if(j=g[h],f)for(;0===b.getRowHeight(i);)i++;for(k=0,l=d+k;k<j.length;k++,l++)if(m=j[k]){if(f)for(;0===b.getColumnWidth(l);)l++;b.Pq(i,l,m.style),n=m.rowSpan,o=m.colSpan,(n>1||o>1)&&(p=b.getSpan(i,l),p?(p.row=i,p.col=l,p.rowCount=n,p.colCount=o):b.addSpan(i,l,n,o))}}q.innerHTML=""},a.prototype.tCc=function(a,b,c,d){var e,f,g,h;b.shapes?(e=b.shapes.addPictureShape("",a,0,0),e.startRow(c),e.startColumn(d)):b.pictures&&(f=b.pictures,g=r(f),h=f.add(g,a,0,0),h.startRow(c),h.startColumn(d))},a.prototype.HZa=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this.f8J(),s=[],t=/ +/g;for(d=0;d<b.rows.length;d++)for(e=b.rows[d],s[d]||(s[d]=[]),f=s[d],g=0,h=0;g<e.cells.length;g++){for(i=e.cells[g];f[h];)h++;for(j=f[h]={},k=void 0,c&&(k=a.getStyleFromDOM(i),j.style=k),l=i.innerHTML,l=u(l,"<!--[if","[endif]-->"),r.innerHTML=l.replace(t," "),m=r.innerText,l.indexOf("<table")>=0&&(m=m.trim()),j.text=m,j.rowSpan=i.rowSpan,n=i.getAttribute("style"),n&&n.search(/mso-ignore:\s*colspan/)>=0?j.colSpan=1:j.colSpan=i.colSpan,o=0;o<i.rowSpan;o++)for(p=0;p<i.colSpan;p++)0===o&&0===p||(s[d+o]||(s[d+o]=[]),q=s[d+o],q[h+p]={style:k,text:"",rowSpan:1,colSpan:1});h+=i.colSpan}return r.innerHTML="",s},a.prototype.EZa=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=[];if(a)if(c=a.getElementsByTagName("table"),c.length>0)for(d=this.HZa(c[0],!1),e=RegExp(String.fromCharCode(160),"g"),f=String.fromCharCode(32),g=0,h=d.length;g<h;g++){for(i=d[g],j=0,k=i.length;j<k;j++)l=i[j]?i[j].text:"",l.indexOf("\n")>=0&&(b?(l.indexOf("\r\n")>=0&&(l=q(l.split("\r\n"),!0)),l=q(l.split("\n"),!0)):l='"'+l+'"'),m.push(l.replace(e,f)),j<k-1&&m.push("\t");g<h-1&&m.push("\r\n")}else m.push(u(a.innerText).trim());return m.join("")},a.prototype.hZ=function(a){var b=this,c=b.wx();b.PA&&b.PA.Wq(d.Events.ClipboardChanging,{sheet:b.PA,sheetName:b.PA.name(),copyData:{text:c.text,html:c.html},ranges:b.n5,cancel:!1,action:h.ClipboardActionType.reset},!0),b.PA=n,b.n5=n,b.G4=!1,b.tc.Wq("ClipboardStatusChanged",{isReset:!0,isSystemPasted:!!a})},a.isPartSpan=function(a,b,c,d){var e,f,g,h,i,j;if(!b.containsRange(a))return!0;for(e=0,f=c;e<f.length;e++)if(g=f[e],a.row<=g&&g<a.row+a.rowCount)return!0;for(h=0,i=d;h<i.length;h++)if(j=i[h],a.col<=j&&j<a.col+a.colCount)return!0;return!1},a.formatClipboardData=function(a){var b,c,d,e,f,g=[];if(a){for(b='"',c=!1,d=0;d<a.length;d++)e=d>0?a[d-1]:"",f=a[d],f===b?(c=!c,g.push(b)):c||"\n"!==f||"\r"===e?g.push(f):g.push("\r\n");return g.join("")}return""},a.convertHAlign=function(a){var b={0:"left",1:"center",2:"right"};return b[a]},a.convertVAlign=function(a){var b={0:"top",1:"middle",2:"bottom"};return b[a]},a.convertLineBorder=function(a){var b={0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"},c={9:.5,1:.5,3:.5,4:.5,7:.5,11:.5,2:1,10:1,12:1,8:1,13:1,5:1.5,6:1.5};return c[a.style]+"pt "+b[a.style]+" "+a.color},a.convertToHAlign=function(a){var b={left:0,center:1,right:2};return b[a]},a.convertToVAlign=function(a){var b={top:0,middle:1,bottom:2};return b[a]},a.convertToLineBorder=function(a,b,c){var d={none:0,solid:1,dashed:3,dotted:4,double:6};return(k.msie||k.edge)&&"2px"===c?d.solid=5:(c=Math.round(10*parseFloat(c)*3/4)/10,c<=.8?d.solid=1:c<=1?(d.solid=2,d.dashed=8):c<=1.5&&(d.solid=5)),new g.LineBorder(a,d[b])},a.convertToTextDecoration=function(a){var b={underline:1,"line-through":2,"underline line-through":3,none:0};return b[a]},a.isTransparent=function(a){return 0===e.Common.pc.ec(a).a},a.isBlack=function(a){var b=e.Common.pc.ec(a);return 0!==b.a&&0===b.r&&0===b.g&&0===b.b},a.getStyleFromDOM=function(b){var c,d,e,h,i,j,l,m,n,o,p,q,r,s,t=b.getElementsByTagName("font")[0],u=getComputedStyle(b),v=b.style,w=new g.Style,x=u.backgroundColor;return x&&!a.isTransparent(x)&&(w.backColor=x),c=u.color,t&&(c=t.color),c&&!a.isBlack(c)&&(w.foreColor=c),t?w.font=f.To.F4(getComputedStyle(t)):(d=f.To.F4(u),d&&(d=d.replace(/\/.+?\s/gi," "),w.font=d)),e=u.verticalAlign,h=a.convertToVAlign,i=a.convertToHAlign,j=a.convertToLineBorder,l=a.convertToTextDecoration,e&&(w.vAlign=h(e)),m=v.textAlign,n=u.textAlign,k.msie||k.edge?""!==m?w.hAlign=i(m):w.hAlign=i("general"):n&&(w.hAlign=i(n)),o=u.borderLeftStyle,"none"!==o&&(w.borderLeft=j(u.borderLeftColor,o,u.borderLeftWidth)),p=u.borderRightStyle,"none"!==p&&(w.borderRight=j(u.borderRightColor,p,u.borderRightWidth)),q=u.borderTopStyle,"none"!==q&&(w.borderTop=j(u.borderTopColor,q,u.borderTopWidth)),r=u.borderBottomStyle,"none"!==r&&(w.borderBottom=j(u.borderBottomColor,r,u.borderBottomWidth)),s=l(u.textDecorationLine||u.textDecoration),b.getElementsByTagName("u").length>0&&(s|=l("underline")),b.getElementsByTagName("s").length>0&&(s|=l("line-through")),0!==s&&(w.textDecoration=s),w},a}(),b.S4=o},"./dist/core/worksheet/style.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/stylehelper.js"),h=c("./dist/core/celltype/celltype.ns.js"),i=c("./dist/core/core.enum.js"),j=e.GC$.each,k=f.Ul,l=k.Ol,m=d.Common.j.C4,n=d.Common.j.Fa,o=void 0,p=null,q="autoFormatter",r="formatter",s="cellType",t="hAlign",u="vAlign",v="imeMode",w="labelOptions",x="cellButtons",y="dropDowns",z="applyFont",A="applyFill",B="applyAlignment",C="applyBorder",D="applyNumberFormat",E="applyProtection",F={borderLeft:!0,borderRight:!0,borderTop:!0,borderBottom:!0,diagonalDown:!0,diagonalUp:!0};function M(a){var b,c={};return a&&a.option&&a.option.dataSource?(b=a.option.dataSource,a.option.dataSource=o,c=m(a),c.option.dataSource=b,a.option.dataSource=b):c=m(a),c}!function(a){a[a.empty=0]="empty",a[a.thin=1]="thin",a[a.medium=2]="medium",a[a.dashed=3]="dashed",a[a.dotted=4]="dotted",a[a.thick=5]="thick",a[a.double=6]="double",a[a.hair=7]="hair",a[a.mediumDashed=8]="mediumDashed",a[a.dashDot=9]="dashDot",a[a.mediumDashDot=10]="mediumDashDot",a[a.dashDotDot=11]="dashDotDot",a[a.mediumDashDotDot=12]="mediumDashDotDot",a[a.slantedDashDot=13]="slantedDashDot"}(G=b.LineStyle||(b.LineStyle={})),function(a){a[a.conditionalFormat=1]="conditionalFormat",a[a.cell=10]="cell",a[a.table=20]="table",a[a.row=30]="row",a[a.column=40]="column",a[a.sheet=50]="sheet"}(H=b.LineBorderComposeLevel||(b.LineBorderComposeLevel={})),I=function(){function a(a,b,c){this.color=a||"black",this.style=b||0,this.level=c}return a.prototype.Uo=function(){return new a(this.color,this.style,this.level)},a.prototype.toJSON=function(){var a={},b=this,c=b.color,d=b.style;return"black"!==c&&(a.color=c),a.style=d,a},a.prototype.fromJSON=function(a,b){if(a){var c=this,d=a.color,e=a.style;l(d)&&(c.color=d),l(e)&&(c.style=e)}},a.Vo=function(a){var b=a&&a.style,c={9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3};return c[b]||0},a}(),b.LineBorder=I;function N(a){return!(!a||"object"!=typeof a)&&(!a.patternColor&&!a.stops)}function O(a){return a&&a.stops?a:a&&a.type?{type:X(i.PatternType,a.type,o),patternColor:a.patternColor,backgroundColor:a.backgroundColor}:a}function P(a){return a?new I(a.color,X(G,a.style,o)):o}function Q(a){var b,c,d,e;if(a){if(b={checkbox:"5",combobox:"7",hyperlink:"8",radioButtonList:"11",checkboxList:"12"},c=b[a.type],!c)return Z(a,!0,void 0);if(d=h._o[c])return e=new d,e.qHJ(a),e}return a}function R(a){return a?{alignment:X(i.LabelAlignment,a.alignment,o),visibility:X(i.LabelVisibility,a.visibility,o),font:a.font,foreColor:a.foreColor,margin:a.margin}:o}function S(a){return a?a.map(function(a){return{position:X(i.ButtonPosition,a.position,o),useButtonStyle:a.useButtonStyle,enabled:a.enabled,width:a.width,caption:a.caption,imageSrc:a.imageSrc,imageSize:a.imageSize,captionAlign:X(i.CaptionAlignment,a.captionAlign,o),command:a.command,imageType:X(i.ButtonImageType,a.imageType,o),visibility:X(i.ButtonVisibility,a.visibility,o),hoverBackColor:a.hoverBackColor,buttonBackColor:a.buttonBackColor}}):o}function T(a){var b,c,d,f,g,h,j,k;if(a)return b=e.GC$.extend(!0,{},a),c=a.calendarPage,n(c)||(b.calendarPage=X(i.CalendarPage,c)),d=a.startDay,n(d)||(b.startDay=i.CalendarStartDay[d]),f=a.layout,f&&(g=f.direction,n(g)||(b.layout.direction=i.LayoutDirection[g]),h=f.displayAs,n(h)||(b.layout.displayAs=i.LayoutDisplayAs[h])),j=a.valueType,n(j)||(b.valueType=i.DropdownListValue[j]),k=a.direction,n(k)||(b.direction=i.LayoutDirection[k]),b}function U(a){return a?a.map(function(a){return{type:X(i.DropDownType,a.type,o),option:T(a.option),submitCommand:a.submitCommand}}):o}function V(a){var b;return b="lineThroughUnderline"===a?i.TextDecorationType.lineThrough|i.TextDecorationType.underline:"lineThroughDoubleUnderline"===a?i.TextDecorationType.lineThrough|i.TextDecorationType.doubleUnderline:X(i.TextDecorationType,a,i.TextDecorationType.none)}J=["backColor","foreColor",t,u,"font","themeFont",r,"borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage",s,"backgroundImageLayout","tabStop","textDecoration",v,"name","parentName","watermark","cellPadding",w,"quotePrefix","diagonalDown","diagonalUp","isVerticalText",x,y,"textOrientation","decoration"],K=[z,A,B,C,D,E],L=function(){function a(){var b,c,d,e,f=[];for(b=0;b<arguments.length;b++)f[b]=arguments[b];if(c=this,c._id=a.Wo,a.Wo++,0!==f.length)if(d=f[0],1===f.length&&N(d))c.qHJ(d);else for(e=0;e<J.length;e++)c[J[e]]=f[e]}return a.kxb=function(a,b){var c=a.parentName;c&&!b.getNamedStyle(c)&&delete a.parentName},a.prototype.compose=function(a,b,c,d){this.Yo(a,b,c,d)},a.prototype.Yo=function(a,b,c,d){var e,f,g,h,i,j,k,l,n,p=this,q=a.labelOptions,r=a.cellButtons;if(a.cellButtons&&a.cellButtons.length>0)for(r=[],k=0;k<a.cellButtons.length;k++)r.push(m(a.cellButtons[k]));if(l=a.dropDowns,a.dropDowns&&a.dropDowns.length>0)for(l=[],k=0;k<a.dropDowns.length;k++)l.push(M(a.dropDowns[k]));b?(p._autoFormatter=a._autoFormatter,p.backgroundImage=a.backgroundImage,p.backgroundImageLayout=a.backgroundImageLayout,p.backColor=a.backColor,p.foreColor=a.foreColor,p.hAlign=a.hAlign,p.vAlign=a.vAlign,p.font=a.font,p.themeFont=a.themeFont,p.formatter=a.formatter,p.showEllipsis=a.showEllipsis,p.XHb=a.XHb,e=a.borderLeft,p.borderLeft=e&&e.Uo&&e.Uo()||e,p.borderLeft&&c&&(p.borderLeft.level=c),f=a.borderTop,p.borderTop=f&&f.Uo&&f.Uo()||f,p.borderTop&&c&&(p.borderTop.level=c),g=a.borderRight,p.borderRight=g&&g.Uo&&g.Uo()||g,p.borderRight&&c&&(p.borderRight.level=c),h=a.borderBottom,p.borderBottom=h&&h.Uo&&h.Uo()||h,p.borderBottom&&c&&(p.borderBottom.level=c),i=a.diagonalDown,p.diagonalDown=i&&i.Uo&&i.Uo()||i,p.diagonalDown&&c&&(p.diagonalDown.level=c),j=a.diagonalUp,p.diagonalUp=j&&j.Uo&&j.Uo()||j,p.diagonalUp&&c&&(p.diagonalUp.level=c),p.locked=a.locked,p.textIndent=a.textIndent,p.wordWrap=a.wordWrap,p.shrinkToFit=a.shrinkToFit,p.cellType=a.cellType,p.name=a.name,p.parentName=a.parentName,p.tabStop=a.tabStop,p.textDecoration=a.textDecoration,p.imeMode=a.imeMode,p.watermark=a.watermark,p.cellPadding=a.cellPadding,p.isVerticalText=a.isVerticalText,p.textOrientation=a.textOrientation,q&&(p.labelOptions={alignment:q.alignment,font:q.font,foreColor:q.foreColor,visibility:q.visibility,margin:q.margin}),p.quotePrefix=a.quotePrefix,p.cellButtons=r,p.dropDowns=l,p.decoration=a.decoration):(p.backgroundImage===o&&(p.backgroundImage=a.backgroundImage),p.backgroundImageLayout===o&&(p.backgroundImageLayout=a.backgroundImageLayout),p.backColor===o&&(p.backColor=a.backColor),p.foreColor===o&&(p.foreColor=a.foreColor),p.hAlign===o&&(p.hAlign=a.hAlign),p.vAlign===o&&(p.vAlign=a.vAlign),p.themeFont===o&&p.font===o?(p.themeFont=a.themeFont,p.font=a.font):p.themeFont!==o&&p.font===o&&(p.font=a.font),p.formatter===o&&(p.formatter=a.formatter),p.showEllipsis===o&&(p.showEllipsis=a.showEllipsis),p.XHb===o&&(p.XHb=a.XHb),p._autoFormatter===o&&(p._autoFormatter=a._autoFormatter),p.borderLeft===o&&(e=a.borderLeft,p.borderLeft=e&&e.Uo&&e.Uo()||e,p.borderLeft&&c&&(p.borderLeft.level=c)),p.borderTop===o&&(f=a.borderTop,p.borderTop=f&&f.Uo&&f.Uo()||f,p.borderTop&&c&&(p.borderTop.level=c)),p.borderRight===o&&(g=a.borderRight,p.borderRight=g&&g.Uo&&g.Uo()||g,p.borderRight&&c&&(p.borderRight.level=c)),p.borderBottom===o&&(h=a.borderBottom,p.borderBottom=h&&h.Uo&&h.Uo()||h,p.borderBottom&&c&&(p.borderBottom.level=c)),p.diagonalDown===o&&(i=a.diagonalDown,p.diagonalDown=i&&i.Uo&&i.Uo()||i,p.diagonalDown&&c&&(p.diagonalDown.level=c)),p.diagonalUp===o&&(j=a.diagonalUp,p.diagonalUp=j&&j.Uo&&j.Uo()||j,p.diagonalUp&&c&&(p.diagonalUp.level=c)),p.locked===o&&(p.locked=a.locked),p.textIndent===o&&(p.textIndent=a.textIndent),p.wordWrap===o&&(p.wordWrap=a.wordWrap),p.shrinkToFit===o&&(p.shrinkToFit=a.shrinkToFit),p.cellType===o&&(p.cellType=a.cellType),p.tabStop===o&&(p.tabStop=a.tabStop),p.textDecoration===o&&(p.textDecoration=a.textDecoration),p.imeMode===o&&(p.imeMode=a.imeMode),p.name===o&&(p.name=a.name),p.parentName===o&&(p.parentName=a.parentName),p.watermark===o&&(p.watermark=a.watermark),p.cellPadding===o&&(p.cellPadding=a.cellPadding),!p.labelOptions&&q&&(p.labelOptions={}),n=p.labelOptions,n&&q&&(n.alignment===o&&(n.alignment=q.alignment),n.font===o&&(n.font=q.font),n.foreColor===o&&(n.foreColor=q.foreColor),n.visibility===o&&(n.visibility=q.visibility),n.margin===o&&(n.margin=q.margin)),d||p.quotePrefix!==o||(p.quotePrefix=a.quotePrefix),p.isVerticalText===o&&(p.isVerticalText=a.isVerticalText),p.textOrientation===o&&(p.textOrientation=a.textOrientation),p.cellButtons===o&&(p.cellButtons=r),p.dropDowns===o&&(p.dropDowns=l),p.decoration===o&&(p.decoration=a.decoration))},a.prototype.$b=function(a){var b=this;0===arguments.length?(j(J,function(a,c){b[c]=o}),j(K,function(a,c){l(b[c])&&(b[c]=o)})):b[a]=o},a.prototype.clone=function(b){var c=this,d=c.borderLeft,e=c.borderTop,f=c.borderRight,g=c.borderBottom,h=c.diagonalDown,i=c.diagonalUp,j=new a;return j.backColor=c.backColor,j.foreColor=c.foreColor,j.hAlign=c.hAlign,j.vAlign=c.vAlign,j.font=c.font,j.themeFont=c.themeFont,j.formatter=o,j.borderLeft=d&&!b&&d.Uo()||d,j.borderTop=e&&!b&&e.Uo()||e,j.borderRight=f&&!b&&f.Uo()||f,j.borderBottom=g&&!b&&g.Uo()||g,j.locked=c.locked,j.textIndent=c.textIndent,j.wordWrap=c.wordWrap,j.shrinkToFit=c.shrinkToFit,j.backgroundImage=c.backgroundImage,j.cellType=o,j.backgroundImageLayout=c.backgroundImageLayout,j.tabStop=c.tabStop,j.textDecoration=c.textDecoration,j.imeMode=c.imeMode,j.name=c.name,j.parentName=c.parentName,j.watermark=c.watermark,j.cellPadding=c.cellPadding,j.labelOptions=c.labelOptions,j.quotePrefix=c.quotePrefix,j.diagonalDown=h&&!b&&h.Uo()||h,j.diagonalUp=i&&!b&&i.Uo()||i,j.isVerticalText=c.isVerticalText,j.showEllipsis=c.showEllipsis,j.XHb=c.XHb,j.textOrientation=c.textOrientation,j.decoration=c.decoration,W(c,j),aa(j,c.formatter,!b),ba(j,c._autoFormatter,!b),Y(j,c.cellType,!b,!0),$(j,c.cellButtons,!b,!0),_(j,c.dropDowns,!b,!0),j},a.prototype.Zo=function(a){var b,c,d,e,f,h,i,j,k=this;if(a&&a.getColor){if(ca(a,k.foreColor,function(a){k.foreColor=a}),b=k.backColor,"string"==typeof b)ca(a,b,function(a){k.backColor=a});else if(b&&(b.backgroundColor&&ca(a,b.backgroundColor,function(a){b.backgroundColor=a}),b.patternColor&&ca(a,b.patternColor,function(a){b.patternColor=a}),b.stops))for(c=function(c){ca(a,b.stops[c].color,function(a){b.stops[c].color=a})},d=0;d<b.stops.length;d++)c(d);for(e=[k.borderLeft,k.borderTop,k.borderRight,k.borderBottom,k.diagonalDown,k.diagonalUp],f=function(b,c){var d=e[b];d&&d.color&&ca(a,d.color,function(a){d.color=a})},d=0,h=e.length;d<h;d++)f(d,h)}return i=k.themeFont,j=k.font,a&&a.getFont&&(i?k.font=g.To.Io(j,a.getFont(i)):j||(k.font=g.To.Io(j,a.bodyFont()))),k},a.prototype.$o=function(a){var b,c=this,d=c._autoFormatter;d&&a!==p&&(b=d.getPreferredEditingFormatter(a),b.isAuto=!0,c._autoFormatter=b)},a.prototype.toJSON=function(a,b){var c,d,f=this,g={},h=f._autoFormatter;for(!l(h)||b&&da(q,h,a)||(h.toJSON&&(h=h.toJSON()),e.GC$.isEmptyObject(h)||(g[q]=h)),c=0;c<J.length;c++)d=J[c],h=f[d],d!==w||e.GC$.isEmptyObject(h)?d!==y&&d!==x||e.GC$.isEmptyObject(h)?!l(h)||b&&da(d,h,a)||(g[d]=h&&h.toJSON?h.toJSON():h):g[d]=h:g[w]=h;for(c=0;c<K.length;c++)d=K[c],h=f[d],l(h)&&(g[d]=h);return e.GC$.isEmptyObject(g)?o:g},a.prototype.fromJSON=function(b,c,d){var e,f,g,h,i;if(b){e=this;for(f in b)if(b.hasOwnProperty(f)){if(g=b[f],!l(g))continue;h={p:f,v:g,r:!1},h.noSchema=c,h.context=d,a.ao(e,"fromJson",h),h.r||("formatter"===f?aa(e,g,!0):"autoFormatter"===f?ba(e,g,!0):f===s?Y(e,g,!0,c):F[f]?g===p?e[f]=null:(i=new I,i.fromJSON(g,c),e[f]=i):e[f]=g)}}},a.prototype.qHJ=function(a){var b=this;b.backColor=O(a.backColor),b.foreColor=a.foreColor,b.hAlign=X(i.HorizontalAlign,a.hAlign,o),b.vAlign=X(i.VerticalAlign,a.vAlign,o),b.font=a.font,b.themeFont=a.themeFont,b.formatter=a.formatter,b.borderLeft=P(a.borderLeft),b.borderTop=P(a.borderTop),b.borderRight=P(a.borderRight),b.borderBottom=P(a.borderBottom),b.diagonalDown=P(a.diagonalDown),b.diagonalUp=P(a.diagonalUp),b.locked=a.locked,b.textIndent=a.textIndent,b.wordWrap=a.wordWrap,b.shrinkToFit=a.shrinkToFit,b.backgroundImage=a.backgroundImage,b.cellType=Q(a.cellType),b.backgroundImageLayout=X(i.ImageLayout,a.backgroundImageLayout,o),b.tabStop=a.tabStop,b.textDecoration=V(a.textDecoration),b.imeMode=X(i.ImeMode,a.imeMode,o),b.name=a.name,b.parentName=a.parentName,b.watermark=a.watermark,b.cellPadding=a.cellPadding,b.labelOptions=R(a.labelOptions),b.isVerticalText=a.isVerticalText,b.textOrientation=a.textOrientation,b.showEllipsis=a.showEllipsis,b.cellButtons=S(a.cellButtons),b.dropDowns=U(a.dropDowns),W(a,b)},a}(),b.Style=L;function W(a,b){n(a.applyFill)||(b.applyFill=a.applyFill),n(a.applyFont)||(b.applyFont=a.applyFont),n(a.applyAlignment)||(b.applyAlignment=a.applyAlignment),n(a.applyBorder)||(b.applyBorder=a.applyBorder),n(a.applyProtection)||(b.applyProtection=a.applyProtection),n(a.applyNumberFormat)||(b.applyNumberFormat=a.applyNumberFormat)}function X(a,b,c){c=c||o;var d;if(!n(b)){if(!isNaN(b))return parseInt(b,10);d=a[b]}return n(d)?c:d}function Y(a,b,c,d){var e=Z(b,c,d);a.cellType=e}function Z(a,b,c){var d,e,g,i,j=a;if(b&&a){if(d=a.gQa&&a.gQa())return j;a.toJSON&&(a=a.toJSON()),e=h._o,g=a.typeName,i=e[a.type]||e[g]||f.getTypeFromString(g),i?(j=new i,j.fromJSON(a,c)):j=o}return j}function $(a,b,c,d){var e,f;if(b===p&&(a.cellButtons=b),b){if(e=b,c)for(e=[],f=0;f<b.length;f++)e.push(m(b[f]));a.cellButtons=e}}function _(a,b,c,d){var e,f;if(b===p&&(a.dropDowns=b),b){if(e=b.slice(),c)for(e=[],f=0;f<b.length;f++)e.push(m(b[f]));a.dropDowns=e}}function aa(a,b,c){var e,g,h,i,j=b;c&&b&&"object"==typeof b&&(b.toJSON&&(b=b.toJSON()),e=d.Formatter,g=e&&e.GeneralFormatter,g&&(h=b.typeName,h?(i=f.getTypeFromString(h),i&&(j=new i,j.fromJSON(b))):j=new g(b.formatCached,b.customerCultureName))),a.formatter=j}function ba(a,b,c){var e,f,g=b;c&&b&&(b.toJSON&&(b=b.toJSON()),e=d.Formatter,f=e&&e.GeneralFormatter,f&&(g=new f(b.formatCached,b.customerCultureName),g.isAuto=!0)),a._autoFormatter=g}function ca(a,b,c){b&&(b=a.getColor(b),b&&c(b))}function da(a,b,c){return a===t?2===c?1===b:1===c?1===b:3===b:a===u?2===c?1===b:1===c?1===b:0===b:a===v?1===b:a===q?b===o:void 0}f.Zn(L),L.Wo=0},"./dist/core/worksheet/stylehelper.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/domUtil.js"),e=c("./dist/core/util/common.js"),f=document,g=Math.max,h=Math.min,i=void 0,j="#FFFFFF",k="#000000",l=Math.abs,m=Math.PI,n=Math.cos,o=Math.sin,p=Math.atan,q=Math.tan,b.Ho="11pt",r={1:[[1]],2:[[1,0,1,1],[1,1,1,0]],3:[[0,1],[1,0]],4:[[0,0,1,0],[1,0,0,0]],5:[[0,0,0,0],[0,0,1,0],[0,0,0,0],[1,0,0,0]],6:[[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0]],7:[[0],[1],[1],[0]],8:[[1,1,0,0]],9:[[0,1,1,0],[0,0,1,1],[1,0,0,1],[1,1,0,0]],10:[[0,1,1,0],[1,1,0,0],[1,0,0,1],[0,0,1,1]],11:[[0,0,1,1],[0,0,1,1],[1,1,0,0],[1,1,0,0]],12:[[0,1,1,0],[1,1,1,1],[1,0,0,1],[1,1,1,1]],13:[[0],[1],[0],[0]],14:[[1,0,0,0]],15:[[0,1,0,0],[0,0,1,0],[0,0,0,1],[1,0,0,0]],16:[[0,0,1,0],[0,1,0,0],[1,0,0,0],[0,0,0,1]],17:[[0,0,1,0],[1,1,1,1],[0,0,1,0],[0,0,1,0]],18:[[1,0,1,0],[0,0,0,1],[1,0,1,0],[0,1,0,0]]};function t(a){return a=a||0,a=g(a,0),a=h(a,1)}s=function(){function a(){}return a.Io=function(b,c){return c?a.Jo(b,c):b},a.Ko=function(b){var c,d;return b?(c=a.Lo(),c.style.font=b,d=c.style,{fontFamily:d.fontFamily,fontSize:d.fontSize,fontStyle:d.fontStyle,fontWeight:d.fontWeight}):{}},a.F4=function(a){var b,c,d,f,g,h,i,j,k,l,m;return e.Ul.Ml.safari?a.font:(b="",c="normal",d="400",f="11pt",g="Calibri",h=a.fontStyle,i=a.fontVariant,j=a.fontWeight,k=a.lineHeight,l=a.fontSize,m=a.fontFamily,h&&h!==c&&(b=h),i&&i!==c&&(b+=(b?" ":"")+i),j&&j!==c&&j!==d&&(b+=(b?" ":"")+j),l=l?l:f,b+=(b?" ":"")+l,k&&k!==c&&(b+="/"+k),m=m?m:g,b+=" "+m)},a.Jo=function(c,e){var g,h,i,j,k;if(!c&&!e)return c;if(c){if(h=e?c+"+"+e:c,i=a.Mo[h])return i;g=a.Lo(),d.GC$(g).css("font",c)}else{if(h=e,i=a.Mo[h])return i;g=a.Lo(),d.GC$(g).css("fontSize",b.Ho)}return e&&d.GC$(g).css("fontFamily",e),j=g.currentStyle,k=f.defaultView,k&&k.getComputedStyle&&(j=k.getComputedStyle(g,"")),i=a.F4(j),a.Mo[h]=i,a.Mo[i]=i,i},a.No=function(b,c,d,e){var h,i,j,k,l,m,n,o,p,q=a.Oo[c];if(!e)if(q){if(h=q[b])return h}else q=a.Oo[c]={};return i=a.Lo(),i.style.font=b,j=i.currentStyle,k=f.defaultView,k&&k.getComputedStyle&&(j=k.getComputedStyle(i,"")),l=j.fontSize,m="px",l.indexOf(m)!==-1&&(n=g(1,parseFloat(l.replace(m,""))*c),d&&1===n&&(d.value=!0),l=n+m),o=j.lineHeight,o.indexOf(m)!==-1&&(p=g(1,parseFloat(o.replace(m,""))*c),o=p+m),1===c?h={font:b,fontFamily:i.style.fontFamily,fontSize:n}:(i.style.fontSize=l,i.style.lineHeight=o,h={font:i.style.font,fontFamily:i.style.fontFamily,fontSize:n}),e||(q[b]=h),h},a.Lo=function(){var b,c,d;return a.Po?a.Po.style.cssText=a.Qo:(b="-10000px",c=e.Ul.Nl("span"),d=c.style,d.visibility="hidden",d.top=b,d.left=b,d.lineHeight="normal",d.position="absolute",d.fontWeight="normal",d.fontStretch="normal",d.fontVariant="normal",d.fontStyle="normal",f.body.insertBefore(c,null),a.Po=c,a.Qo=d.cssText),a.Po},a.no=function(){var b=a.Po;b&&(d.GC$(b).remove(),a.Po=i,a.Qo=i)},a.stringFontCatch={},a.Ro=function(b,c){var d,e=b+","+c,f=a.stringFontCatch,g=f[e];return g||(d=a.Lo(),d.style.font=b,c&&(d.style.fontWeight=c),g=f[e]=d.style.font),g},a.Mo={},a.Oo={},a.So=function(a){if(a<=0)return"none";var b="";return(1|a)===a&&(b+="underline "),(2|a)===a&&(b+="line-through "),(4|a)===a&&(b+="overline "),b.trim()},a.setFillStyle=function(b,c,d,e,f,g,h){"string"==typeof c?(b.fillStyle!==c&&(b.fillStyle=c),h()):"path"===c.type?a.setFillStylePath(b,c,d,e,f,g,h):c.stops?a.setFillStyleGradient(b,c,d,e,f,g,h):c.type&&a.setFillStylepatternFill(b,c,d,e,f,g,h)},a.setFillStylepatternFill=function(a,b,c,d,e,f,g){var h,i,l,m,n,o=r[b.type],p=o.length,q=o[0].length,s=document.createElement("canvas");for(s.width=q,s.height=p,h=s.getContext("2d"),h.fillStyle=b.backgroundColor||j,h.fillRect(0,0,q,p),h.fillStyle=b.patternColor||k,i=0;i<p;i++)for(l=0;l<q;l++)m=o[i][l],m&&h.fillRect(l,i,1,1);a.createPattern(s,"repeat"),n=a.createPattern(s,"repeat"),a.fillStyle=n,g()},a.processStops=function(a){var b,c;if(a.stops||"path"===a.type){if(b=a.stops)if(0===b.length)b=[{position:0,color:k},{position:1,color:k}];else{for(b=b.filter(function(a,b,c){return a.position<=1&&a.position>=0}),b.sort(function(a,b){return a.position-b.position}),c=0;c<b.length;c++)b[c].color=b[c].color||k;0!==b[0].position&&b.splice(0,0,{position:0,color:k}),1!==b[b.length-1].position&&b.push({position:1,color:k})}else b=[{position:0,color:j},{position:1,color:j}];a.stops=b}"path"===a.type?(a.left=t(a.left),a.right=t(a.right),a.top=t(a.top),a.bottom=t(a.bottom)):a.stops&&(delete a.type,a.degree=a.degree||0)},a.setFillStyleGradient=function(a,b,c,d,e,f,g){var h,i,k,r,s,t,u,v=b.degree||0;for(v%90===0?(i=v/180*m,k=l(v%180/180*m)-p(f/e)):(i=p(e/f*q(v/180*m)),k=l(i)-p(f/e),i=Math.round(v/180)*m+i),r=Math.sqrt(e*e+f*f)/2,h=a.createLinearGradient(c+e/2-r*n(k)*n(i),d+f/2-r*n(k)*o(i),c+e/2+r*n(k)*n(i),d+f/2+r*n(k)*o(i)),s=b.stops,t=0,u=s.length;t<u;t++)h.addColorStop(s[t].position,s[t].color||j);a.fillStyle=h,g()},a.setFillStylePath=function(a,b,c,d,e,f,g){var h,i,k,l=b.left||0,m=b.right||0,n=b.top||0,o=b.bottom||0,p=b.stops;if(l>m&&(m=l),n>o&&(o=n),l>0){for(a.save(),a.beginPath(),h=a.createLinearGradient(c+e*l,0,c,0),i=0,k=p.length;i<k;i++)h.addColorStop(p[i].position,p[i].color||j);a.fillStyle=h,a.moveTo(c,d-1),a.lineTo(c+e*l+1,d+f*n),a.lineTo(c+e*l+1,d+f*o),a.lineTo(c,d+f+1),a.clip(),g(),a.restore()}if(m<1){for(a.save(),a.beginPath(),h=a.createLinearGradient(c+e*m,0,c+e,0),i=0,k=p.length;i<k;i++)h.addColorStop(p[i].position,p[i].color||j);a.fillStyle=h,a.moveTo(c+e,d-1),a.lineTo(c+e,d+f+1),a.lineTo(c+e*m-1,d+f*o),a.lineTo(c+e*m-1,d+f*n),a.clip(),g(),a.restore()}if(n>0){for(a.save(),a.beginPath(),h=a.createLinearGradient(0,d+f*n,0,d),i=0,k=p.length;i<k;i++)h.addColorStop(p[i].position,p[i].color||j);a.fillStyle=h,a.moveTo(c,d),a.lineTo(c+e,d),a.lineTo(c+e*m,d+f*n+1),a.lineTo(c+e*l,d+f*n+1),a.clip(),g(),a.restore()}if(o<1){for(a.save(),a.beginPath(),h=a.createLinearGradient(0,d+f*o,0,d+f),i=0,k=p.length;i<k;i++)h.addColorStop(p[i].position,p[i].color||j);a.fillStyle=h,a.moveTo(c+e,d+f),a.lineTo(c,d+f),a.lineTo(c+e*l,d+f*o-1),a.lineTo(c+e*m,d+f*o-1),a.clip(),g(),a.restore()}l<m&&n<o&&(a.save(),a.beginPath(),a.fillStyle=p[0].color,a.rect(c+e*l,d+f*n,e*(m-l),f*(o-n)),a.clip(),g(),a.restore())},a}(),b.To=s},"./dist/core/worksheet/worksheet-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("Common"),f=c("Common"),g=c("./dist/core/worksheet/style.js"),h=c("./dist/core/worksheet/worksheet.js"),i=c("./dist/core/util/common.js"),j=c("./dist/core/worksheet/clipboardhelper.js"),k=c("./dist/core/util/domUtil.js"),l=c("./dist/core/core.enum.js"),m=k.GC$,n=c("./dist/core/worksheet/worksheet-static.js"),o=c("@grapecity/js-calc"),p=!!o,q=e.Common.j.Fa,r=e.Common.k.Bb,s=e.Common.u,t=s.jb,u=i.Events.CellChanged,v=i.Events.ColumnWidthChanging,w=i.Events.ColumnWidthChanged,x=i.Events.RowHeightChanging,y=i.Events.RowHeightChanged,z=i.Ul.Ml,A=i.Ul.Ol,B=m.extend,C=m.inherit,D=null,E=void 0,F=Math.max,G=Math.min,H=Math.floor,I=Math.ceil,J=Number.MAX_VALUE,K=isNaN,L="^(((ht|f)tp(s?)):\\/\\/(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|((ht|f)tp(s?)):\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})$",M="^(mailto:\\/\\/)?([A-Za-z0-9_\\-\\.\\!\\#$%&'*\\+/=?^`{|}~])+\\@([A-Za-z0-9\\-])+\\.([A-Za-z0-9\\-]){2,63}(\\?subject=.+)?$";function mb(a,b){return a.getRowCount(b)}function nb(a,b){return a.getColumnCount(b)}function ob(a){return a.rowCount}function pb(a){return a.colCount}function qb(a){var b=a.parent;return b&&b.options.allowExtendPasteRange}function rb(a){var b=a.parent;return b&&b.options.allowCopyPasteExcelStyle}function sb(a){var b=a.parent;return b&&b.options.copyPasteHeaderOptions}N=new e.Common.ResourceManager(d.SR,"Sheets"),O=N.getResource.bind(N);function tb(a,b,c,d){throw Error(s.Kb(O().Exp_InvalidAndSpace,[a,b,c,d]))}function ub(a){a.suspendPaint()}function vb(a){a.resumePaint()}function wb(a){a.suspendEvent()}function xb(a){a.resumeEvent()}function yb(a,b){a&&p&&a.suspendCalcService(b)}function zb(a,b){a&&p&&a.resumeCalcService(b)}function Ab(a,b,c,d,e){var f=a.getSpan(b,c,d);if(f&&e&&(f.row!==b||f.col!==c))return!0}function Bb(a){var b=this;b.Vw=1===(1&a),b.Ww=2===(2&a),b.Xw=8===(8&a),b.Yw=p&&16===(16&a),b.Zw=!0,b.$w=!0}function Cb(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,r,s,u,v,w,x,y;if(q(a)||""===a)return D;for((q(b)||""===b)&&(b="\r\n"),g="\n",(q(c)||""===c)&&(c="\t"),(q(d)||""===d)&&(d='"'),t(a,b)||(a+=b),h=!e,i=[],j=[],k="",m=!1,n=d.length,o=b.length,p=g.length,r=c.length,s=a.length,u=0;u<s;u++)k+=a[u],l=k.length,h&&(l===n&&d===k||l>n&&d===k.substr(l-n,n))?m&&s>=u+1+n&&d===a.substr(u+1,n)?u+=n:m?(k=k.substr(0,l-n),m=!1):(v=k,0===v.indexOf(d)&&(k=k.substr(0,l-n),m=!0)):!m&&(l===r&&c===k||l>r&&c===k.substr(l-r,r))?(k=k.substr(0,l-r),j.push(k),k=""):!m&&(l===o&&b===k||l>o&&b===k.substr(l-o,o))?(k=k.substr(0,l-o),j.push(k),i.push(j),j=[],k=""):!m&&(l===p&&g===k||l>p&&g===k.substr(l-p,p))?(k=k.substr(0,l-p),j.push(k),i.push(j),j=[],k=""):m&&s>=u+1+r&&c===a.substr(u+1,r)&&","!==c&&(u+=n);if(m){if(j.length>0){for(w=void 0,w=0;w<i.length&&i[w]!==j;w++);w>=i.length&&i.push(j)}x=""+k,x&&(x=x.replace(RegExp(c,"g"),""),t(x,b)&&(x=x.substr(0,x.length-o)),0===i.length&&i.push([x]))}return 0===i.length&&(y=a,t(a,b)&&(y=y.substr(0,y.length-o)),i.push([y])),f&&Db(i)&&/^(\s)*$/.test(a)&&a.substr(a.length-p,p)===g&&i.push([""]),i}function Db(a){var b,c;if(a){for(b=0;b<a.length&&(c=a[b],c&&1===c.length);b++);if(b===a.length)return!0}return!1}function Eb(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o=d.length,p=Hb(d);if(0!==o&&0!==p)for(f=new Bb(e),a&&(nb(a,2)<=0&&(f.Vw=!1),mb(a,1)<=0&&(f.Ww=!1)),g=f.Vw?nb(a,2):0,h=f.Ww?mb(a,1):0,i=0,p-=g,p<=0&&(p=0),o-=h,o<=0&&(i=0),o-=i,o<=0&&(o=0),f.Zw&&b+o>mb(a)&&a.setRowCount(b+o),f.$w&&c+p>nb(a)&&a.setColumnCount(c+p),j={},k=0,l=0;k<d.length;k++,l++)m=d[k],n=a.CMc(),m.length<=0||(h>0&&k<h?Fb(a,m,l,c,p,1,f,j):o>0&&l<mb(a)&&(k===h&&(l=b),Fb(a,m,l,0,g,2,f,j),m.splice(0,g),n&&(l=a._q(l-1,3)),Fb(a,m,l,c,p,3,f,j,n)))}function Fb(a,b,c,d,e,f,g,h,i){var j,k,l=nb(a,f);for(j=0,k=d;j<b.length;j++,k++)e>0&&k<l&&(i&&(k=a.Zq(k-1,3)),Gb(a,f,c,k,b[j],g,h))}function Gb(a,b,c,d,e,g,h){var j,k,l,m,n,o,p,r,s,t=e,u=D;if(g.Xw===!1&&(j={value:D},k=""+e,l=h[k],!q(e)&&l?(t=l.setValue,u=l.formatter):(t=i.Ul.ul(D,e,!g.Xw,j),u=j.value,q(e)||(h[k]={setValue:t,formatter:u}))),q(t))a.setValue(c,d,t,b);else if(""!==e)if(g.Yw&&"="===e[0]&&e.length>1)try{a.setFormula(c,d,e.substr(1))}catch(f){a.setText(c,d,e,b)}else m=a.tq(c,d,"formatter",b),g.Xw===!1&&u?m?m&&("string"==typeof m&&f.Formatter&&(m=new f.Formatter.GeneralFormatter(m)),s=m.parse&&m.parse(e),t=q(s)?t:s):(u.isAuto=!0,a.getCell(c,d,b)._w("_autoFormatter",u),n=e,o=a.getCellType(c,d,b),p=u.formatString(),o&&"7"===o.typeName&&(r={sheet:a,row:c,col:d,sheetArea:b},n=o.parse(e,p,r),t=q(n)?e:n)):m&&a.getCell(c,d,b).formatter(D),a.setValue(c,d,t,b);else a.setValue(c,d,D,b)}function Hb(a){var b,c,d=0;for(b=0;b<(a&&a.length);b++)c=a[b],d=F(c.length,d);return d}function Ib(a,b,c,d,e,f,g,h,i,j){if(!a)throw Error(O().Exp_SheetIsNull);if((b<-1||b>=mb(a))&&tb("row",b,"-1",mb(a)-1),(c<-1||c>=nb(a))&&tb("column",c,"-1",nb(a)-1),!q(d)&&""!==d){b===-1&&(b=0),c===-1&&(c=0);var k=Cb(d,e,f,g,i,j);k&&k.length>0&&Eb(a,b,c,k,h)}}function Jb(a,b,c,d,e,f,g,h,j,k,l,m,n,o){var p,r,s,t,u,v,w,x,y,A,B,C,D;if(!a)throw Error(O().Exp_SheetIsNull);return p=mb(a),r=nb(a),(b<-1||b>=p)&&tb("row",b,"-1",p-1),(c<-1||b+c>p)&&tb("rowCount",c,"-1",p-b),(d<-1||d>=r)&&tb("column",d,"-1",r-1),(e<-1||d+e>r)&&tb("columnCount",e,"-1",r-d),s=-1,t=-1,u=!1,v=!1,b===-1&&d===-1&&c===-1&&e===-1?(b=0,d=0,c=mb(a),e=nb(a),s=c-1,t=e-1):(b===-1&&(b=0,2===(2&sb(a))&&(u=!0)),d===-1&&(d=0,1===(1&sb(a))&&(v=!0)),c===-1&&(c=mb(a)-b),e===-1&&(e=nb(a)-d),s=b+c-1,t=d+e-1),(q(f)||""===f)&&(f="\r\n"),(q(g)||""===g)&&(g="\t"),(q(h)||""===h)&&(h='"'),w=RegExp(h,"g"),x=null,y=null,A=Nb(a,b,s,d,t,3,k,l,f,g,h,w,j,m,n,o),v&&(B=a.getColumnCount(2),x=Nb(a,b,s,0,B-1,2,k,l,f,g,h,w,j,m,n,o)),u&&(C=a.getRowCount(1),y=Nb(a,0,C-1,d,t,1,k,l,f,g,h,w,j,m,n,o)),
D=m&&c*e>4e3&&(z.safari||z.mozilla||i.Ul.sl()&&z.chrome),Kb(A,x,y,f,g,D)}function Kb(a,b,c,d,e,f){var g,h,i=a,j=0,k=function(a,b){var c,d=[],e=a.length;for(c=0;c<e;c++)d.push(a[c].concat(b[c]));return d};return b&&(j=b[0].length,i=k(b,a)),c&&(g=c.length,h=null,j&&(h=Nb(null,0,g-1,0,j-1,null,[],[],d,e,null,null,null,!1,!1),c=k(h,c)),i=c.concat(i)),f&&Lb(i),Mb(i,d,e)}function Lb(a){var b,c=a.length;for(b=a.length-1;b>=0&&a[b].join("").search(/\S+/)===-1;b--)c=b;a.length=c}function Mb(a,b,c){var d,e,f="",g=a.length;for(d=0;d<g;d++){for(e=0;e<a[d].length;e++)0!==e&&(f+=c),f+=a[d][e];f+=b}return f}function Nb(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q,s,t,u,v=[],w=a&&rb(a);for(q=b;q<=c;q++)if(!g||!r(g,q)){for(t=[],s=d;s<=e;s++)h&&r(h,s)||(u="",a&&!Ab(a,q,s,f,n)&&(u=a.getText(q,s,f),p&&w&&u&&(u=" "!==u[0]&&" "!==u[u.length-1]||"number"!=typeof a.getValue(q,s,f)?u.replace(/[\r\n]+/g,"\n"):u.trim())),u=Ob(u,n,w,l,k,o,m,j,i),t.push(u));v.push(t)}return v}function Ob(a,b,c,d,e,f,g,h,i){var j="";return q(a)||(j=a,b&&c||(j=j.replace(d,e+e))),f&&!j&&(j=" "),b&&c?j=j.replace(/\n/g," "):(g||j.indexOf(e)!==-1||j.indexOf(h)!==-1||j.indexOf(i)!==-1||j.indexOf("\n")!==-1)&&(j=e+j+e),j}function Pb(a,b,c,d,e,f){var g,h,i,j,k,l=D,m=Cb(a,b,c,d,e,f);if(m){for(g=m.length,h=Hb(m),i=[],j=0;j<g;j++)for(i[j]=[],k=0;k<h;k++)k<m[j].length?i[j][k]=m[j][k]:i[j][k]=D;l=i}return l}B(h.Worksheet.prototype,{autoFitColumn:function(a){0<=a&&a<nb(this)&&this.wu().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:a}],rowHeader:!1})},autoFitRow:function(a){0<=a&&a<mb(this)&&this.wu().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:a}],columnHeader:!1})},setCsv:function(a,b,c,d,e,f,g,h){var i=this;ub(i),wb(i),yb(i),Ib(i,a,b,c,d,e,'"',f,g,h),zb(i),xb(i),vb(i)},setDataToCell:function(a,b,c,d){Eb(a,b,c,d,0)},getCsv:function(a,b,c,d,e,f){return Jb(this,a,c,b,d,e,f,'"',!0)},getRangeTextHasIgnore:function(a,b,c,d,e,f){return Jb(this,a,c,b,d,"\r\n","\t",'"',!0,e,f)},copyTo:function(a,b,c,d,e,f,g){this.ax(a,b,c,d,e,f,g)},ax:function(a,b,c,d,e,f,g,h,i){var j=this;ub(j),wb(j),n.staticMembers.copyTo(j,a,b,j,c,d,e,f,g,h,0,i),xb(j),vb(j)},moveTo:function(a,b,c,d,e,f,g,h){var i=this;if(!(p&&g&l.CopyToOptions.formula)||i.Vq(a,b,e,f,!0)&&i.Vq(c,d,e,f,!0))try{ub(i),wb(i),n.staticMembers.moveTo(i,a,b,i,c,d,e,f,g,h)}finally{xb(i),vb(i)}},findSpecialNonNullCellInRange:function(a,b){for(var c,d=this.ITa.sheetModels[3],e=i.Ul.A9J(this,a),f=e.row,g=e.row+e.rowCount,h=e.col,j=e.col+e.colCount,k=d.Yea(f-1);k!==-1&&k<=g;){for(c=d.Hl(k,h-1);c!==-1&&c<=j;){if(b(this,k,c))return{row:k,col:c};c=d.Hl(k,c)}k=d.Yea(k)}return E},wXJ:function(a){var b,c,d,e,f=this,g=f.o5(a);if(g)return b="\t",c="\r\n",d='"',e=f.J5(a),Jb(f,g.row,ob(g),g.col,pb(g),c,b,d,!1,e.rows,e.cols,!0)},xXJ:function(a){var b,c,d=this,e=d.o5(a);if(e)return b=d.J5(a),c=sb(d),j.S4.Q4(d,c,e.row,ob(e),e.col,pb(e),l.SheetArea.viewport,rb(d),b.rows,b.cols,!1,!1,!1,!1)},bx:function(a,b,c){var d,e,f,g,h=this,j=h.mm,k=h.wXJ(a);if(k){d=h.tu(),d.PA=h,d.n5=a,b&&h.ODJ&&1===a.length&&a[0].row===-1&&a[0].col===-1&&(b=!1),d.G4=b,e=h.tu(),e.YHb=!0,f=h.xXJ(a),h.ex&&h.ex(),h.Sob&&h.Sob();try{if(g={sheet:h,sheetName:h.name(),copyData:{text:k,html:f},ranges:a,isCutting:b,cancel:!1,action:b?l.ClipboardActionType.cut:l.ClipboardActionType.copy},h.Wq(i.Events.ClipboardChanging,g),g&&g.cancel===!1)return j&&!c&&j.gx(rb(h)?f:k),h.Wq(i.Events.ClipboardChanged,{sheet:h,sheetName:h.name(),copyData:{text:k,html:f}}),setTimeout(function(){!j||c||h.Js||j.hx()},100),{copyText:k,copyHtml:f};d.hZ()}catch(a){}}},ix:function(a,b,c,d,e,f,g,h,i,k){var l,m,n,o,p,q,r=O().Exp_PasteSourceCellsLocked;if(g.pastedInternal=!1,g.pastedRange=D,l=!f&&!i,!a&&l)return!1;if(m=this,n=m,o=m.J5(b),m.jx(a,m.o5(b),n,f,o.rows,o.cols,k)||l){if(g.pastedInternal=!0,e&&a.options.isProtected&&a.p5(b))return m.Os(1,r),!1;g.pastedRange=m.kx(a,b,n,c,d,e)}else p=m.g8J(n,c,f,j.S4.BUJ(i)),q=m.NXJ(n,c,i),g.pastedRange=p.union(q);return m.mx(a,b,c,d,e,g,h)},mx:function(a,b,c,d,e,f,g){var h,j,k,m,n,o,p,q,r,s,t,u,v,w,x,y=this,z=O().Exp_InvalidCopyPasteSize,A=y.k9J(),B=O().Exp_PasteChangeMergeCell,C=O().Exp_ChangePartOfArray,D=y,G=f.pastedRange,I=D.CMc();if(!G)return y.Os(1,z),!1;if(!D.Y3(G.row,G.col,ob(G),pb(G),A,C,E,g,E,l.SheetArea.viewport))return!1;if(f.pastedInternal){if(h=b.length,1===h){if(j=b[0],e&&!a.Y3(j.row,j.col,ob(j),pb(j),A,C,E,E,E,l.SheetArea.viewport))return!1;if(a.qu(j.row,j.col,ob(j),pb(j)))return y.Os(1,B),!1;if(k=G.row<0?mb(D):ob(G),m=G.col<0?nb(D):pb(G),n=j.row<0?mb(a):ob(j),o=j.col<0?nb(a):pb(j),I&&(k-=D.DMc(c.row,F(k,n),!0),m-=D.DMc(c.col,F(m,o)),k=k<1?1:k,m=m<1?1:m),p=2===d,(k>n||m>o)&&!p){for(q=c.row,r=c.col,c.row<0&&n<mb(D)&&(q=0),c.col<0&&o<nb(D)&&(r=0),k%n===0&&1===m?(m=o,I||(G=f.pastedRange=new i.Range(q,r,k,m))):1===k&&m%o===0?(k=n,I||(G=f.pastedRange=new i.Range(q,r,k,m))):k%n===0&&m%o===0||(k=n,m=o,G=f.pastedRange=new i.Range(q,r,k,m)),s=H(k/n),t=H(m/o),u=0;u<s;u++)for(v=0;v<t;v++)if(!y.nx(j,G)&&D.qu(q<0?-1:q+u*n,r<0?-1:r+v*o,q<0?-1:n,r<0?-1:o))return y.Os(1,B),!1}else if(g===E&&!y.nx(j,G)&&D.qu(G.row,G.col,ob(G),pb(G)))return y.Os(1,B),!1}else if(h>1){for(w=0;w<h;w++)if(x=b[w],a.qu(x.row,x.col,ob(x),pb(x)))return y.Os(1,B),!1;if(D.qu(G.row,G.col,ob(G),pb(G)))return y.Os(1,B),!1}}else{if(D.qu(G.row,G.col,ob(G),pb(G)))return y.Os(1,B),!1;if(!D.l5(G.row,G.col,ob(G),pb(G)))return y.Os(1,z),!1}return!0},nx:function(a,b){if(a&&1===ob(a)&&1===pb(a)){var c=this.getSpan(b.row,b.col);if(c&&c.equals(b))return!0}return!1},jx:function(a,b,c,d,e,f,g){var h,i,j,k;if(a&&b&&c)try{return h=Jb(a,b.row,ob(b),b.col,pb(b),"\r\n","\t",'"',!1,e,f,!0,z.safari,!0),i=h===d,i||(i=h===d+"\r\n",!i&&z.chrome&&(i=h===d+"\t\r\n"),i||!(z.safari||z.mozilla||g)&&rb(c)||(i=h.replace(/\s/g,"")===d.replace(/\s/g,"")),i||(j=RegExp(String.fromCharCode(160),"g"),k=String.fromCharCode(32),h=h.replace(j,k),i=h.replace(/\s+$/,"")===d.replace(/\s+$/,""))),i}catch(a){return!1}return!1},kx:function(a,b,c,d,e,f){var g,h,j,k,l,m,n,o,p,q,r,s,t,u=this,v=b.length,w=c.CMc();if(1===v){if(g=b[0],h=g.row<0?0:g.row,j=g.col<0?0:g.col,k=g.row<0?mb(a):ob(g),l=g.col<0?nb(a):pb(g),m=d.row<0?0:d.row,n=d.col<0?0:d.col,o=d.row<0?mb(c):ob(d),p=d.col<0?nb(c):pb(d),q=void 0,r=void 0,w&&(q=c.DMc(m,F(o,k),!0),r=c.DMc(n,F(p,l)),o-=q,p-=r,o=o<1?1:o,p=p<1?1:p),s=2===e,f||1===o&&1===p)o=k,p=l;else if(!s&&(o%k===0&&1===p?p=l:1===o&&p%l===0?o=k:o%k===0&&p%l===0||(o=k,p=l),!u.pu(h,j,k,l,mb(a),nb(a))))return D;if(t=new i.Range(m,n,o,p),!f&&a.name()===c.name())if(t.contains(h,j,k,l)){if((h-m)%k!==0||(j-n)%l!==0)return D}else if(t.intersect(h,j,k,l)&&(o>k||p>l))return D;return w&&(o+=q,p+=r),c.l5(m,n,o,p)?(d.row===-1&&(m=-1,o=-1),d.col===-1&&(n=-1,p=-1),new i.Range(m,n,o,p)):D}return v>1?u.q5(b,d):D},q5:function(a,b){var c,d,e,f,g,h,j,k,l=this,m=l.CMc();if(a.length>1){if(c=a[0],d=a[1],e=c.rowCount,f=c.colCount,c.row===d.row&&e===d.rowCount)return g=0,h=e,a.forEach(function(a){g+=a.colCount}),m&&(h+=l.DMc(b.row,h,!0),g+=l.DMc(b.col,g)),i.kf(b.row,b.col,h,g);if(c.col===d.col&&f===d.colCount)return j=0,k=f,a.forEach(function(a){j+=a.rowCount}),m&&(j+=l.DMc(b.row,j,!0),k+=l.DMc(b.col,k)),i.kf(b.row,b.col,j,k)}return D},g8J:function(a,b,c,d){var e,f,g=b.row<0?0:b.row,h=b.col<0?0:b.col,j=new i.Range(g,h,1,1),k=Pb(c,"\r\n","\t",'"',rb(a),d);return k&&(e=k.length,f=Hb(k),e>0&&f>0&&(a.CMc()&&(e+=a.DMc(g,e,!0),f+=a.DMc(h,f)),j=new i.Range(g,h,e,f))),j},NXJ:function(a,b,c){var d,e,f,g,h,j=b.row<0?0:b.row,k=b.col<0?0:b.col,l=1,m=1,n=a.tu();return n&&(d=n.f8J(),d.innerHTML=c,e=d.getElementsByTagName("table"),f=e&&e[0],f&&(g=f.rows,g&&(l=g.length,h=g[0]&&g[0].cells,h&&(m=h.length)),l>0&&m>0&&a.CMc()&&(l+=a.DMc(j,l,!0),m+=a.DMc(k,m)))),new i.Range(j,k,l,m)},ox:function(){var a=this.tu();a&&a.hZ()},UNJ:function(a,b,c,d,e,f,g,h,j,k){var l,m,o,p,q,r,s,t,u,v,w,x,y,z,A=jb.qx(j),B=d.row<0?mb(c):ob(d),C=d.col<0?nb(c):pb(d),D=b.row<0?mb(a):ob(b),E=b.col<0?nb(a):pb(b),F=d.row,G=d.col;for(d.row<0&&D<mb(c)&&(F=0),d.col<0&&E<nb(c)&&(G=0),l=H(B/D),m=H(C/E),o=0;o<l&&l&&m;o++)for(p=0;p<m;p++)n.staticMembers.copyTo(a,b.row,b.col,c,F+D*o,G+E*p,D,E,A,k,sb(a));for(x=A&-33,s=F+D*l,t=G,u=B-D*l,v=E,w=Qb(new i.Range(b.row,b.col,u,v),a.getSpans(b)),y=function(d){w.forEach(function(a){c.addSpan(s+a.row-b.row,t+E*d+a.col-b.col,a.rowCount,a.colCount)}),n.staticMembers.copyTo(a,b.row<0?0:b.row,b.col<0?0:b.col,c,s,t+E*d,u,v,x,k,sb(a))},p=0;p<m&&u&&v;p++)y(p);for(s=F,t=G+E*m,u=D,v=C-E*m,w=Qb(new i.Range(b.row,b.col,u,v),a.getSpans(b)),z=function(d){w.forEach(function(a){c.addSpan(s+D*d+a.row-b.row,t+a.col-b.col,a.rowCount,a.colCount)}),n.staticMembers.copyTo(a,b.row<0?0:b.row,b.col<0?0:b.col,c,s+D*d,t,u,v,x,k,sb(a))},o=0;o<l&&u&&v;o++)z(o);s=F+D*l,t=G+E*m,u=B-D*l,v=C-E*m,w=Qb(new i.Range(b.row,b.col,u,v),a.getSpans(b)),u&&v&&(w.forEach(function(a){c.addSpan(s+a.row-b.row,t+a.col-b.col,a.rowCount,a.colCount)}),n.staticMembers.copyTo(a,b.row<0?0:b.row,b.col<0?0:b.col,c,s,t,u,v,x,k,sb(a)))},px:function(a,b,c,d,f,g,h,k,l,m){var o,s,t,u,v,w,x,y,z,A,B,C,E,G,I,J,K,N,P,Q,R,S,T,U;if(a&&c.name()===a.name()&&c.parent&&!a.ODJ&&!r(c.parent.sheets,a)&&c.parent!==a.parent)return void a.ox();o=c.CMc(),y=jb.qx(l),yb(a),yb(c);try{if(a&&b){if(0!==(2&y)&&f&&p&&(a.Ns(b.row,b.col,ob(b),pb(b))||c.Ns(d.row,d.col,ob(d),pb(d))))throw O().Exp_ChangePartOfArray;if(z=2===l,f)n.staticMembers.moveTo(a,b.row,b.col,c,d.row,d.col,ob(b),pb(b),y,a.rXJ),a.ox();else if(z)this.UNJ(a,b,c,d,f,g,h,k,l,m);else if(A=d.row<0?mb(c):ob(d),B=d.col<0?nb(c):pb(d),u=b.row<0?mb(a):ob(b),v=b.col<0?nb(a):pb(b),o&&(A-=c.DMc(d.row,F(A,u),!0),B-=c.DMc(d.col,F(B,v)),A=A<1?1:A,B=B<1?1:B),A>u||B>v)for(s=d.row,t=d.col,d.row<0&&u<mb(c)&&(s=0),d.col<0&&v<nb(c)&&(t=0),A%u===0&&1===B?B=v:1===A&&B%v===0?A=u:A%u===0&&B%v===0||(A=u,B=v),C=H(A/u),E=H(B/v),G=u,I=v,J=void 0,K=void 0,N=void 0,P=void 0,w=0;w<C;w++){for(J=q(N)?s<0?-1:s+w*u:N,x=0;x<E;x++)K=q(P)?t<0?-1:t+x*v:P,u=s<0?-1:G,v=t<0?-1:I,o&&(u=s<0?-1:u+c.DMc(J,G,!0),v=t<0?-1:v+c.DMc(K,I)),n.staticMembers.copyTo(a,b.row,b.col,c,J,K,G,I,y,m,sb(a)),P=K+(v<0?0:v);N=J+(u<0?0:u),P=null}else n.staticMembers.copyTo(a,b.row,b.col,c,d.row,d.col,ob(b),pb(b),y,m,sb(a))}else{if(s=d.row,t=d.col,u=ob(d),v=pb(d),Q=0===l||2===l||4===l||5===l,g&&Q)for(R=c.ITa,S=R.getSpans(i.kf(s,t,u,v)),T=S.length-1;T>=0;T--)R.do("removeSpan",S[T]);if(p&&(1&y)>0&&c.clearFormula(s,t,u,v,function(a,b){return!a.Ps||!a.Ps(b)}),U=c.tu(),g&&""!==g)c.parent&&c.parent.options.allowAutoCreateHyperlink&&1===u&&1===v&&(e.Common.q.qb(L).test(g)||e.Common.q.qb(M).test(g))&&c.setHyperlink&&c.setHyperlink(s,t,{url:g,tooltip:g}),c.setCsv(s,t,g,"\r\n","\t",16,rb(c),j.S4.BUJ(h));else if(U&&Q&&k)U.tCc(k,c,s,t);else for(w=0;w<u;w++)for(x=0;x<v;x++)c.setValue(s+w,t+x,D);U&&Q&&h&&U.R4(h,c,s,t)}}finally{zb(a,!1),zb(c,!1)}},sx:function(a){if(!this.isEditing()){var b=this.getSelections();if(b&&1===b.length)return this.options.isProtected&&this.p5(b)?(this.Os(14,this.k9J()),D):this.bx(b,!0,a)}return D},n5J:function(a){var b,c,d,e,f,g=this,h=a.length,i=g.options;if(!i.isProtected)return!1;for(b=0;b<h;b++)for(c=a[b],d=c.row;d<c.row+c.rowCount;d++)for(e=c.col;e<c.col+c.colCount;e++)if(f=g.getActualStyle(d,e),f.locked!==!1)return!0;return!1},r5:function(a,b){var c,d,e,f,g,h,i;if(a&&(c=a.length,c>1)){for(d=void 0,d=0;d<c;d++)for(e=a[d],f=d+1;f<c;f++)if(g=a[f],e.intersect(g.row,g.col,g.rowCount,g.colCount))return!1;for(h=a[0],i=void 0,d=1;d<c&&(i=a[d],h.row===i.row&&h.rowCount===i.rowCount);d++);if(d>=c)return b&&(b.inSameRow=!0),!0;for(d=1;d<c&&(i=a[d],h.col===i.col&&h.colCount===i.colCount);d++);if(d>=c)return b&&(b.inSameCol=!0),!0}return!1},o5:function(a){var b,c,d,e,f;if(a){if(b=a.length,1===b)return a[0];if(b>1){if(c=a[0],d=a[b-1],e=void 0,f=void 0,c.row===d.row&&c.rowCount===d.rowCount){for(e=0;e<b;e++)f=a[e],f.col<c.col&&(c=f),f.col>d.col&&(d=f);return i.kf(c.row,c.col,c.rowCount,d.col+d.colCount-c.col)}if(c.col===d.col&&c.colCount===d.colCount){for(e=0;e<b;e++)f=a[e],f.row<c.row&&(c=f),f.row>d.row&&(d=f);return i.kf(c.row,c.col,d.row+d.rowCount-c.row,c.colCount)}}}return D},J5:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=[],o=[];if(a&&(b=a.length,b>1&&(c=a[0],d=a[b-1],e=c.row===d.row&&c.rowCount===d.rowCount,f=c.col===d.col&&c.colCount===d.colCount,e||f)))for(a.sort(e?function(a,b){return a.col-b.col}:function(a,b){return a.row-b.row}),g=1;g<b;g++)for(h=a[g-1],i=a[g],j=e?h.col+h.colCount:h.row+h.rowCount,k=e?i.col:i.row,l=e?o:n,m=j;m<k;m++)l.push(m);return{rows:n,cols:o}},ux:function(a){var b,c,d,e,f,g,h,j=this;if(!j.isEditing()){if(b=j.getSelections(),b&&1===b.length){if(c=j.tu(),c.YHb=!0,d=b[0],d.row!==-1&&j.Nu&&j.Nu()){for(e=[],f=-1,g=0;g<d.rowCount;g++)h=d.row+g,j.Ps(h)?f!==-1&&(e.push(i.kf(f,d.col,h-f,d.colCount)),f=-1):f===-1&&(f=h);f!==-1&&e.push(i.kf(f,d.col,d.row+d.rowCount-f,d.colCount)),b=e}return j.bx(b,!1,a)}if(j.r5(b))return j.bx(b,!1,a);j.Os(1,O().Exp_MultipleSelections)}return D},vx:function(a){var b,c,d,e,f,g,h,j=this,k=j.mm;j.isEditing()||(a&&(b=a.pasteText,c=a.pasteHtml,d=void 0===a.pasteOption?j.options.clipBoardOptions:a.pasteOption,e=a.shiftCells,f=j.getSelections()[0],g=a.isFromDesigner),k&&!b&&k.gx(""),h=j.tu(),h&&(h.ZHb=!1),setTimeout(function(){var a,l,m,n,o,p;j.Js||(a=b||"",l=c||"",k&&!b&&(h&&(o=h.wx(),p=h.PA,a=o.text,l=o.html,n=o.image,m=h.n5&&h.n5[0],p&&i.Ul.FLJ(m,p.getRowCount(),p.getColumnCount())),k.hx()),(z.msie||z.edge||b||!a&&!l&&!h.ZHb)&&j.J4(a,l,n,d,e,f,m,g),j.mm.Qq(),j.Wq(i.Events.PasteEnd))},100))},J4:function(a,b,c,d,e,f,g,h){var j,k=this,l=k.tu();if(l&&(l.ZHb=!0),j=k.xx(a,d,e,b,h),!j){if(!c)return;j={pasteOption:void 0===d?k.options.clipBoardOptions:d,pastedRanges:[i.kf(k.getActiveRowIndex(),k.getActiveColumnIndex(),1,1)],clipboardText:""}}e!==E&&(j.$Hb=e),f&&(j._Hb=f),g&&(j.aIb=g),j.cmd="clipboardPaste",j.sheetName=k.name(),rb(k)&&(j.clipboardHtml=b,j.clipboardImage=c),k.wu().execute(j)},xx:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=this,q=O().Exp_InvalidPastedArea,r=p.tu(),s=r.PA,t=r.n5,u=r.G4;if(u&&s&&t&&s.options.isProtected&&s.p5(t)&&(u=!1),f={pastedRange:D,pastedInternal:!1},g=[],h=p.getSelections(),h.length>1)for(j=2===b,k=0;k<h.length;k++){if(i=h[k],!p.ix(s,t,i,b,u,a,f,E,d,e))return;if(i.containsRange(f.pastedRange)&&!i.equals(f.pastedRange)&&!j)return void p.Os(1,q);g.push(f.pastedRange)}else{if(i=h.length>0?h[0]:p.ITa.getSpan(p.Jl,p.Kl),!p.ix(s,t,i,b,u,a,f,c,d,e))return;g.push(f.pastedRange)}if(l=p.at,l&&l.jx(f.pastedInternal),f.pastedInternal||(s=D,t=D,u=!1),m=void 0===b?p.options.clipBoardOptions:b,u&&(m=p.sXJ),t&&1===t.length)for(n=0;n<g.length;n++)o=g[n],p.nx(t[0],o)&&(o.rowCount=1,o.colCount=1);return(!t||t.length>1)&&g.length>1?void p.Os(1,O().Exp_MultipleSelections):{fromSheet:s,fromRanges:t,isCutting:u,pasteOption:m,pastedRanges:g,clipboardText:a}},l5:function(a,b,c,d,e){var f=this,g=mb(f),h=nb(f);return qb(f)?-1<=a&&(e||a<g)&&-1<=b&&(e||b<h):f.pu(a,b,c,d,g,h)},p5:function(a){for(var b=0;b<a.length;b++)if(this.ou(a[b],E,l.SheetArea.viewport))return!0;return!1},yx:function(a,b,c,d,e){var f,g,h,j=this,k=j._ZJ&&1===j._ZJ.sheetArea;j.endEdit&&!j.endEdit()||k||(f={sheet:j,sheetName:j.name(),row:j.Jl,col:j.Kl,cancel:!1},j.Wq(i.Events.LeaveCell,f),f.cancel!==!0&&(g=j.Jl,h=j.Kl,q(c)&&(c=j.Jl),q(d)&&(d=j.Kl),3===a?j.zx(c,d,b):4===a?j.Rs(c,d,b):1===a?j.Ax(c,d,b,e):2===a?j.Bx(c,d,b):5===a?j.Cx():6===a&&j.Dx(),j.Ss(a,g,h,!1)))},Ex:function(a){var b,c,d,e=this;e.endEdit()&&(b={sheet:e,sheetName:e.name(),row:e.Jl,col:e.Kl,cancel:!1},e.Wq(i.Events.LeaveCell,b),b.cancel!==!0&&(c=e.Jl,d=e.Kl,3===a?e.Fx(e.Jl,e.Kl):4===a?e.Gx(e.Jl,e.Kl):1===a?e.a5J(e.Jl,e.Kl):2===a&&e.b5J(e.Jl,e.Kl),e.Ss(a,c,d,!0)))},Ss:function(a,b,c,d){var e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=this,z=y.mm,A=y.ITa.getSelections(),B=!1;d||(e=y.Tq(y.Ix()),(A.length>1||ob(e)>1||pb(e)>1)&&(B=!0),!B&&y.xJb&&y.xJb.ICc(e)&&(B=!0),y.Tr()),f=y.Jl,g=y.Kl,h=y.ITa.getSpan(f,g),y.Lr=ob(h),y.Mr=pb(h),d||(j=y.Jx(f,g),k=y.selectionPolicy(),l=y.selectionUnit(),0===k?y.ITa.do("clearSelection"):1===k&&y.ITa.do("clearSelection"),1===l?(j.col=-1,j.colCount=-1):2===l&&(j.row=-1,j.rowCount=-1),y.Kx(j.row,j.col,ob(j),pb(j),!1),m=y.ITa.getSelections(),z.h8J(A,m)&&(y.yu(A,m),y.Au(A))),y.Yq(f,g),b!==f&&(n=y.wq,n&&n.Lx()),o=y.yl,B?(p=y.am(),q=p.zr,r=p.Ar,s=p.width-q,t=p.height-r,o.Mx(q,r,s,t),o.repaint(new i.Rect(q,r,s,p.Cr)),o.repaint(new i.Rect(q,r,p.Br,t)),o.Pw(o.bm())):(u=y.ITa.getSpan(b,c),v=ob(u),w=pb(u),o.im(new i.Range(f,g,y.Lr,y.Mr).union(new i.Range(b,c,v,w)),null,null,null,null,d)),x={sheet:y,sheetName:y.name(),row:f,col:g},y.Wq(i.Events.EnterCell,x),y.Wq(i.Events.FormulaTextboxEnterCell,x),z.cs&&z.cs(f,g)},Nx:function(a,b){var c=this,d=c.getDataValidator&&c.getDataValidator(a,b),e={sheet:c,sheetName:c.name(),row:a,col:b,validator:d,validationResult:0};return c.Wq(i.Events.ValidationError,e),e.validationResult}});function Qb(a,b){var c=[];return b.forEach(function(b){var d=Rb(a,b);d&&c.push(d)}),c}function Rb(a,b){var c,d,e,f,g=a.row,h=a.col,j=a.row+a.rowCount,k=a.col+a.colCount,l=b.row,m=b.col,n=b.row+b.rowCount,o=b.col+b.colCount,p=F(g,l)<=G(j,n)&&F(h,m)<=G(k,o);return!!p&&(c=F(g,l),d=F(h,m),e=G(j,n)-c,f=G(k,o)-d,new i.Range(c,d,e,f))}function Sb(a,b){if(a.sheets){var c=i.VCJ(a,b.sheetName);if(c)return c}return a}function Tb(a,b,c,d){var e=Sb(a,c),f=new b(e,c,d);return d?f.undo(e):f.execute(e)}P={},b.Commands=P,P.Ox=function(a,b){return!!a&&(2!==a.Px&&(a.yx(b,!1),!0))},P.Qx=function(a,b,c,d){return!!a&&(2!==a.Px&&(a.yx(b,!1,c,d),!0))},P.Rx=function(a,b,c){return!!a&&(2!==a.Px&&(!(a.endEdit&&!a.endEdit())&&(a.Sx(b,c),!0)))};function Ub(a){var b=a;return function(a,c){var d=Sb(a,c);return P.Ox(d,b)}}function Vb(a,b){var c=a,d=b;return function(a,b){var e=Sb(a,b);return P.Rx(e,c,d)}}function Wb(a,b){var c,d,e,f,g=a.parent;g&&(c=g.getSheetCount(),d=void 0,e=void 0,d=e=g.getActiveSheetIndex(),b?e<c-1&&e++:e>0&&e--,d!==e&&(f=g.getActiveSheet(),g.dq(e,1),g.WHb(f),g.repaint()))}function Xb(a,b,c,d){a.Tx=!0,Yb(a)?a.Ex(b):a.yx(b,c,void 0,void 0,d),a.Tx=!1}function Yb(a){var b,c=a.ITa.getSelections().length;return c>1||(b=a.Ix(),!!(b&&c>0)&&!(a.Jl===b.row&&a.Kl===b.col&&a.Lr>=ob(b)&&a.Mr>=pb(b)))}function Zb(a,b){var c,d,e,f;return!!a.endEdit()&&(c=a.mm,c.Ux(),c.Vx(),i.Vl.Zl(D),d=!1,e=a.parent,e&&(f=b.call(e),f&&f.focus?(f.focus(),d=!0):e.Uv()),{ignoreCancelDefault:!d})}Q="navigationLeft",R="navigationRight",S="navigationUp",T="navigationDown",U="navigationHome2",V="navigationEnd2",W="navigationTop",X="navigationBottom",Y="navigationHome",Z="navigationFirst",$="navigationEnd",_="navigationLast",aa="moveToNextCell",ba="moveToPreviousCell",ca="navigationPageUp",da="navigationPageDown",ea="navigationPreviousSheet",fa="navigationNextSheet",ga="clear",ha="clearAndEditing",ia="commitInputNavigationDown",ja="commitInputNavigationUp",ka="cancelInput",la="commitArrayFormula",ma="selectionLeft",na="selectionRight",oa="selectionUp",pa="selectionDown",qa="selectionHome",ra="selectionEnd",sa="selectionPageUp",ta="selectionPageDown",ua="selectionTop",va="selectionBottom",wa="selectionFirst",xa="selectionLast",ya="copy",za="cut",Aa="paste",Ba="undo",Ca="redo",Da="resizeColumn",Ea="resizeRow",Fa="splitResizeRow",Ga="splitResizeColumn",Ha="autoFitColumn",Ia="autoFitRow",Ja="editCell",Ka="renameSheet",La="zoom",Ma="clearValues",Na="clipboardPaste",Oa="selectNextControl",Pa="selectPreviousControl",Qa="moveToNextCellThenControl",Ra="moveToPreviousCellThenControl",Sa="changeFormulaReference",Ta="moveSheet",Ua="copySheet",Va="showAllSheetsDialog",P.bT=Sb,P.h4=Tb,P.uv=function(a){var b=i.Ul.sl(),c=!b,d=b;a.register(Q,P[Q],37,!1,!1,!1,!1),a.register(R,P[R],39,!1,!1,!1,!1),a.register(S,P[S],38,!1,!1,!1,!1),a.register(T,P[T],40,!1,!1,!1,!1),a.register(U,P[U],37,c,!1,!1,d),a.register(V,P[V],39,c,!1,!1,d),a.register(W,P[W],38,c,!1,!1,d),a.register(X,P[X],40,c,!1,!1,d),a.register(Y,P[Y],36,!1,!1,!1,!1),a.register(Z,P[Z],36,!0,!1,!1,!1),a.register($,P[$],35,!1,!1,!1,!1),a.register(_,P[_],35,!0,!1,!1,!1),a.register(aa,P[aa],9,!1,!1,!1,!1),a.register(ba,P[ba],9,!1,!0,!1,!1),a.register(ca,P[ca],33,!1,!1,!1,!1),a.register(da,P[da],34,!1,!1,!1,!1),a.register(ea,P[ea],33,c,!1,!1,d),a.register(fa,P[fa],34,c,!1,!1,d),a.register(ga,P[ga],46,!1,!1,!1,!1),a.register(ha,P[ha],8,!1,!1,!1,!1),a.register(ia,P[ia],13,!1,!1,!1,!1),a.register(ja,P[ja],13,!1,!0,!1,!1),a.register(ka,P[ka],27,!1,!1,!1,!1),a.register(la,P[la],13,!0,!0,!1,!1),a.register(ma,P[ma],37,!1,!0,!1,!1),a.register(na,P[na],39,!1,!0,!1,!1),a.register(oa,P[oa],38,!1,!0,!1,!1),a.register(pa,P[pa],40,!1,!0,!1,!1),a.register(qa,P[qa],36,!1,!0,!1,!1),a.register(ra,P[ra],35,!1,!0,!1,!1),a.register(sa,P[sa],33,!1,!0,!1,!1),a.register(ta,P[ta],34,!1,!0,!1,!1),a.register(qa,P[qa],37,c,!0,!1,d),a.register(ra,P[ra],39,c,!0,!1,d),a.register(ua,P[ua],38,c,!0,!1,d),a.register(va,P[va],40,c,!0,!1,d),a.register(wa,P[wa],36,!0,!0,!1,!1),a.register(xa,P[xa],35,!0,!0,!1,!1),a.register(ya,P[ya],67,c,!1,!1,d),a.register(za,P[za],88,c,!1,!1,d),a.register(Aa,P[Aa],86,c,!1,!1,d),a.register(Ba,P[Ba],90,c,!1,!1,d),a.register(Ca,P[Ca],89,c,!1,!1,d),b&&a.register(Ca,P[Ca],90,c,!0,!1,d),a.register(Oa,P[Oa]),a.register(Pa,P[Pa]),a.register(Qa,P[Qa]),a.register(Ra,P[Ra]),a.register(Sa,P[Sa]),a.register(Da,P[Da]),a.register(Ea,P[Ea]),a.register(Ga,P[Ga]),a.register(Fa,P[Fa]),a.register(Ha,P[Ha]),a.register(Ia,P[Ia]),a.register(Ja,P[Ja]),a.register(Ka,P[Ka]),a.register(La,P[La]),a.register(Ma,P[Ma]),a.register(Na,P[Na]),a.register(Ta,P[Ta]),a.register(Ua,P[Ua]),a.register(Va,P[Va])},Wa={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",1024:"hyperlink",1:"value"},Xa=".cellEditAction",P[Q]={canUndo:!1,execute:Ub(3)},P[R]={canUndo:!1,execute:Ub(4)},P[S]={canUndo:!1,execute:Ub(1)},P[T]={canUndo:!1,execute:Ub(2)},P[la]={canUndo:!1,execute:function(a,b){var c=Sb(a,b),d=P.i8J;return d&&(c=d.fv(c)),c.fv&&c.fv(),!0}},P[ia]={canUndo:!1,execute:function(a,b){var c=Sb(a,b),d=P.i8J;return d&&(c=d.Xx(c)),Xb(c,2,!1),!0}},P[ja]={canUndo:!1,execute:function(a,b){var c=Sb(a,b),d=P.i8J;return d&&(c=d.Yx(c)),Xb(c,1,!1,!0),!0}},P[Y]={canUndo:!1,execute:function(a,b){var c=Sb(a,b);return P.Qx(c,4,D,c.frozenColumnCount()-1)}},P[U]={canUndo:!1,execute:function(a,b){var c=Sb(a,b);return P.Qx(c,4,D,-1)}},P[$]={canUndo:!1,execute:function(a,b){var c=Sb(a,b);return P.Qx(c,3,D,nb(c)-c.frozenTrailingColumnCount())}},P[V]={canUndo:!1,execute:function(a,b){var c=Sb(a,b);return P.Qx(c,3,D,nb(c))}},P[W]={canUndo:!1,execute:function(a,b){var c=Sb(a,b);return P.Qx(c,2,-1,D)}},P[X]={canUndo:!1,execute:function(a,b){var c=Sb(a,b);return P.Qx(c,1,mb(c),D)}},P[ca]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h=Sb(a,b);if(!h||2===h.Px)return!1;if(c=h.Ew(),c===D||c===h.lq)return!0;if(d=h.Gr(1,3),e=h._q(h.Jl-d.length),e<c&&(e=c),f=P.i8J){if(g=f.Zx(h,e,c),g.r)return!0;h=g.sheet}return!!h.endEdit()&&(h.Qs(e,h.getActiveColumnIndex())&&(h.Jr(e,D),h.Qr=e,h.yx()),h.mq(c,0),!0)}},P[da]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h=Sb(a,b);if(!h||2===h.Px)return!1;if(c=h.$x(),c===D||c===h.lq)return!0;if(d=h.Gr(1,3),e=h.gr(h.Jl+d.length),e<c&&(e=c),f=P.i8J){if(g=f._x(h,e,c),g.r)return!0;h=g.sheet}return!!h.endEdit()&&(h.Qs(e,h.getActiveColumnIndex())&&(h.Jr(e,D),h.Qr=e,h.yx()),h.mq(c,0),!0)}},P[fa]={canUndo:!1,execute:function(a,b){var c=Sb(a,b);Wb(c,!0)}},P[ea]={canUndo:!1,execute:function(a,b){var c=Sb(a,b);Wb(c,!1)}},P[Z]={canUndo:!1,execute:function(a,b){var c,d,e=Sb(a,b);if(!e||2===e.Px)return!1;if(c=P.i8J){if(d=c.ay(e),d.r)return!0;e=d.sheet}return e.yx(5,!1,e.Jl,e.Kl),!0}},P[_]={canUndo:!1,execute:function(a,b){var c,d,e=Sb(a,b);if(!e||2===e.Px)return!1;if(c=P.i8J){if(d=c.by(e),d.r)return!0;e=d.sheet}return e.yx(6,!1,e.Jl,e.Kl),!0}},P[Oa]={canUndo:!1,execute:function(a,b){var c=Sb(a,b);return!!c.parent&&Zb(c,c.parent.nextControl)}},P[Pa]={canUndo:!1,execute:function(a,b){var c=Sb(a,b);return!!c.parent&&Zb(c,c.parent.previousControl)}},P[aa]={canUndo:!1,execute:function(a,b){var c=Sb(a,b),d=P.i8J;return d&&(c=d.ey(c)),Xb(c,4,!0),!0}},P[ba]={canUndo:!1,execute:function(a,b){var c=Sb(a,b),d=P.i8J;return d&&(c=d.gy(c)),Xb(c,3,!0),!0}},P[Qa]={canUndo:!1,execute:function(a,b){var c,d,e=Sb(a,b),f=e.Qr,g=e.getActiveColumnIndex();return e.Tx=!0,c=e.hy(e.getActiveRowIndex(),g,!0,f),e.Tx=!1,d=!c||(c.leadingCellRow<f||c.leadingCellRow===f&&g>c.col),d?P[Oa].execute(a,b):P[aa].execute(a,b)}},P[Ra]={canUndo:!1,execute:function(a,b){var c,d,e=Sb(a,b),f=e.Qr,g=e.getActiveColumnIndex();return e.Tx=!0,c=e.iy(e.getActiveRowIndex(),g,!0,f),e.Tx=!1,d=!c||(c.leadingCellRow>f||c.leadingCellRow===f&&g<c.col),d?P[Pa].execute(a,b):P[ba].execute(a,b)}},P[ka]={canUndo:!1,execute:function(a,b){var c,d,e=Sb(a,b),f=P.i8J;return f&&(c=f.jy(e)),e.isEditing()?!!e.endEdit(!0):q(c)?(P.Yxb(e.parent),e.uu=D,e.parent.uu.hZ(),d=e,d.ex&&d.ex(),void(d.Sob&&d.Sob())):c}},P.Yxb=function(a){var b,c,d,e,f,g;if(a&&(b=a.sheets,c=a.ECJ.map(function(a){return a.kj}),d=b.concat(c)))for(e=0,f=d.length;e<f;e++)g=d[e],g&&g.at&&g.at.ky()},P[ga]={canUndo:!1,execute:function(a,b){var c,d=Sb(a,b);return!d.isEditing()&&(c=d.getSelections(),d.wu().execute({cmd:Ma,sheetName:d.name(),ranges:c}))}},P[ha]={canUndo:!1,execute:function(a,b){var c=Sb(a,b);return!c.isEditing()&&(i.Ul.sl()?(P[ga].execute(a,b),!0):(c.HF=!0,c.startEdit(!0,""),c.HF=!1,!0))}},P[ya]={canUndo:!1,execute:function(a,b){var c=Sb(a,b),d=b.copyData=c.ux(b.ignoreClipboard);return b.callback&&b.callback(),!d||E}},P[za]={canUndo:!1,execute:function(a,b){var c=Sb(a,b),d=b.cutData=c.sx(b.ignoreClipboard);return b.callback&&b.callback(),!d||E}},P[Aa]={canUndo:!1,execute:function(a,b){var c=Sb(a,b);c.vx(b)}},P[ma]={canUndo:!1,execute:Vb(37)},P[na]={canUndo:!1,execute:Vb(39)},P[oa]={canUndo:!1,execute:Vb(38)},P[pa]={canUndo:!1,execute:Vb(40)},P[qa]={canUndo:!1,execute:Vb(37,!0)},P[ra]={canUndo:!1,execute:Vb(39,!0)},P[sa]={canUndo:!1,execute:Vb(33)},P[ta]={canUndo:!1,execute:Vb(34)},P[ua]={canUndo:!1,execute:Vb(38,!0)},P[va]={canUndo:!1,execute:Vb(40,!0)},P[wa]={canUndo:!1,execute:Vb(36,!0)},P[xa]={canUndo:!1,execute:Vb(35,!0)},P[Sa]={canUndo:!1,execute:function(a,b){var c=Sb(a,b),d=c&&c.mm;if(d){ub(c);try{d.ly&&d.ly()}finally{vb(c)}}}},P[Ba]={canUndo:!1,execute:function(a){var b,c=a;return c&&(b=c.undoManager(),b&&b.canUndo()&&b.undo()),!0}},P[Ca]={canUndo:!1,execute:function(a){var b,c=a;return c&&(b=c.undoManager(),b&&b.canRedo()&&b.redo()),!0}},P[Da]={canUndo:!0,execute:function(a,b,c){return Tb(a,$a,b,c)}},P[Ea]={canUndo:!0,execute:function(a,b,c){return Tb(a,_a,b,c)}},P[Ga]={canUndo:!0,execute:function(a,b,c){return Tb(a,ab,b,c)}},P[Fa]={canUndo:!0,execute:function(a,b,c){return Tb(a,bb,b,c)}},P[Ha]={canUndo:!0,execute:function(a,b,c){return Tb(a,cb,b,c)}},P[Ia]={canUndo:!0,execute:function(a,b,c){return Tb(a,db,b,c)}},P[Ja]={canUndo:!0,execute:function(a,b,c){return Tb(a,eb,b,c)}},P[Ka]={canUndo:!0,execute:function(a,b,c){return Tb(a,fb,b,c)}},P[La]={canUndo:!0,execute:function(a,b,c){return Tb(a,gb,b,c)}},P[Ma]={canUndo:!0,execute:function(a,b,c){var d=Sb(a,b),e=d.getSelections();return d.options.isProtected&&d.p5(e)?(d.Os(13,d.k9J()),!1):Tb(a,ib,b,c)}},P[Na]={canUndo:!0,execute:function(a,b,c){return Tb(a,kb,b,c)}},P[Ta]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h=b.sheetName,j=b.targetIndex,k=a.getSheetIndex(h);return q(k)&&(k=a.getSheetCount()+a.getSheetTabIndex(h)),c=a.zCJ(),d=k,e=j,f={sheet:c,sheetName:c.name(),oldIndex:d,newIndex:e,cancel:!1},a.Wq(i.Events.SheetMoving,f),!f.cancel&&(g=a.changeSheetIndex(h,j),a.Wq(i.Events.SheetMoved,{sheet:c,sheetName:c?c.name():D,oldIndex:d,newIndex:e}),g)}},P[Ua]={canUndo:!1,execute:function(a,b){var c,d=b.sheetName,e=b.targetIndex,f=b.newName,g=b.includeBindingSource,h=a.getSheetFromName(d);return a.Wq(i.Events.SheetChanging,{sheetName:f,propertyName:"insertSheet",cancel:!1,sheetIndex:e}),a.Wq(i.Events.ActiveSheetChanging,{oldSheet:h,newSheet:c,cancel:!1}),c=a.clone(d,e,f,g),!q(c)&&(a.Wq(i.Events.SheetChanged,{sheetName:c.name(),propertyName:"insertSheet",sheetIndex:e}),a.Wq(i.Events.ActiveSheetChanged,{oldSheet:h,newSheet:c}),!0)}},P[Va]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h=a,j="gc.spread.",k="gc.spread.contextMenu.allSheets",m="sheetTab",n=[],o=h.xCJ();for(d=0;d<o.length;d++)o[d].visible()===l.SheetTabVisible.visible&&(e=o[d].name().length>21?o[d].name().substr(0,18)+"...":o[d].name(),e=s.Pb(e),f={text:e,name:j+o[d].name(),command:k,workArea:m,itemClass:"",title:o[d].name()},o[d].HHb()&&(c=d,f.itemClass="gc-ui-contextmenu-menuitem-all-sheets-select-sheets-background-color"),n.push(f));return g={items:n,mouseEvent:b.mouseEvent,cancel:!1},h.Wq(i.Events.SheetTabAllSheetsListContextMenuOpening,g),!g.cancel&&(h.contextMenu.openAllSheetsListContextMenu(n,h,b.mouseEvent,c),h.Wq(i.Events.SheetTabAllSheetsListContextMenuOpened,g),!0)}},Ya=function(){function a(a,b,c){var d=this;d.kj=a,d.my=b,d.ny=c,d.oy=[],d.Iu=[],d.py()}return a.prototype.py=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,r,s,t,u,v,w,x,y,z,A,B,C=this,F=C.my,G=C.kj;if(G&&F){if(a=C.ny,b=F.row,c=F.col,d=ob(F),e=pb(F),f=C.oy,g=!1,b===-1&&(g=!0,b=0,d=mb(G)),c===-1&&(g=!0,c=0,e=nb(G)),i=[],(64&a)>0)for(k=0;k<e;k++)i[k]=G.Aj(-1,k)||D;for(l=0;l<d;l++)for(m=b+l,(64&a)>0&&(h=G.Aj(m,-1)||D),n=0;n<e;n++){if(o=void 0,r=c+n,p&&(2&a)>0&&G.getFormulaInformation&&(o=G.getFormulaInformation(m,r,3),o.hasFormula))if(o.isArrayFormula){if(s=o.baseRange,s.row===m&&s.col===r)for(t=s.row,u=s.row+ob(s);t<u;t++)for(v=s.col,w=s.col+pb(s);v<w;v++)C.qy(f,t-b,v-c,o,2)}else C.qy(f,l,n,o.formula,2);!((1&a)>0)||o&&o.hasFormula||C.qy(f,l,n,G.getValue(m,r,3),1),(16&a)>0&&G.getSparkline&&(x=G.getSparkline(m,r),y=D,x&&(q(x.data())&&x.data(x.a$J),y=x.data()),x&&y&&C.qy(f,l,n,x,16)),(64&a)>0&&(z=void 0,g?z=G.getActualStyle(m,r,3):(j=G.Aj(m,r)||D,z=G.getCompositeStyle(m,r,3,j,h,i[n])),A=E,z&&z.toJSON&&(A=JSON.stringify(z.toJSON(3,!0))),C.qy(f,l,n,A,64)),B=G.ITa.Ky,(4&a)>0&&B&&C.qy(f,l,n,B.get(m,r),4),(128&a)>0&&C.qy(f,l,n,G.getTag(m,r,3),128),(256&a)>0&&C.qy(f,l,n,G.getBindingPath&&G.getBindingPath(m,r,3),256),(1024&a)>0&&C.qy(f,l,n,G.getHyperlink&&G.getHyperlink(l,n,3),1024)}}},a.prototype.sy=function(){return this.oy},a.prototype.qy=function(a,b,c,d,e){!q(d)&&a&&(a[b]===E&&(a[b]=[]),a[b][c]===E&&(a[b][c]={}),a[b][c][Wa[e]]=d)},a.prototype.uy=function(a){var b,c,d,e,f,g,h,i,j;if(a)for(b=this,c=b.oy,d=0,e=a.length;d<e;d++)if(f=a[d])for(g=0,h=f.length;g<h;g++)i=f[g],i&&(c[d]||(c[d]=[]),j=c[d][g],j?b.vy(i,j)&&(c[d][g]=E):c[d][g]=i)},a.prototype.vy=function(a,b){var c,d,e,f=this.ny,g=[];for(256&f&&g.push(Wa[256]),4&f&&g.push(Wa[4]),2&f&&g.push(Wa[2]),16&f&&g.push(Wa[16]),64&f&&g.push(Wa[64]),128&f&&g.push(Wa[128]),1024&f&&g.push(Wa[1024]),1&f&&g.push(Wa[1]),c=0,d=g.length;c<d;c++)if(e=g[c],a[e]!==b[e])return!1;return!0},a.prototype.wy=function(){var a,b,c,d,e,f=this,g=f.my.row,h=f.my.col,i=f.oy,j=f.Iu;if(j&&j.length>0)return j;for(j=[],g=g===-1?0:g,h=h===-1?0:h,a=0,b=i.length;a<b;a++)if(c=i[a])for(d=0,e=c.length;d<e;d++)c[d]&&j.push({row:a+g,col:d+h});return f.Iu=j,j},a}(),P.xy=Ya,P.Bu=function(a,b,c,d,e,f,g,h,i,j){a&&(b<0&&(b=0,d=mb(a)),c<0&&(c=0,e=nb(a)),a.Bu(b,c,d,e,f,g,E,E,h,i,j))};function $b(a,b){var c,d=[];return"string"==typeof b?(c=i.VCJ(a,b),c&&d.push(c)):Array.isArray(b)&&b.forEach(function(b){var c=i.VCJ(a,b);c&&d.push(c)}),d}P.bWa=function(a){return"changes"+a},P.cWa=function(a){return a&&(0!==a.length||!m.isEmptyObject(a))},P.aWa=function(a){var b,c=a.sheetName;return"string"==typeof c?b=[c]:Array.isArray(c)&&(b=c),!!b&&b.every(function(b){var c=P.bWa(b),d=a[c];return d&&0===d.length&&m.isEmptyObject(d)})},P.startTransaction=function(a,b){$b(a,b.sheetName).forEach(function(a){a.ITa.startTransaction()})},P.endTransaction=function(a,b){$b(a,b.sheetName).forEach(function(a){var c=P.bWa(a.name());b[c]=a.ITa.endTransaction()})},P.undoTransaction=function(a,b){$b(a,b.sheetName).forEach(function(a){var c=P.bWa(a.name());a.ITa.undo(b[c]),a.$p()})};function _b(a){return a instanceof h.Worksheet?a:a.kj instanceof h.Worksheet?a.kj:void 0}P.Zxb=function(a){a.forEach(function(a){var b=_b(a);b&&b.ITa.startTransaction()})},P.$xb=function(a,b){var c=[];a.forEach(function(a){var d,e,f,g=_b(a);g&&(d=g.name(),e=P.bWa(d),f=g.ITa.endTransaction(),f&&(b[e]=f,c.push(d)));
}),b.sheetNames=c},P._xb=function(a,b){a.forEach(function(a){var c,d=_b(a);d&&(c=P.bWa(d.name()),d.ITa.undo(b[c]))})};function ac(a,b){ub(a),b||wb(a)}function bc(a,b){b||xb(a),vb(a)}Za=function(){function a(a,b){this.Lz=ac,this.Mz=bc;var c=this;c.kj=a,c.VQ=b}return a.prototype.execute=function(){},a.prototype.canExecute=function(){return!0},a.prototype.canUndo=function(){return!0},a.prototype.undo=function(){return!0},a}(),P.ActionBase=Za;function cc(a,b){q(a.lq)&&(a.lq=b.lq,a.qq=b.qq)}$a=function(a){lb(b,a);function b(b,c){var d=a.call(this,b,c)||this;return cc(c,b),d}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,j,k,l,n,o,p,q,r,s=this,t=!1;if(s.canExecute()&&(a=s.VQ,b=s.kj,c=a.columns,d=a.rowHeader,e=c&&c.length,b&&e>0)){if(f=s.Sz(c),g={sheet:b,sheetName:b.name(),colList:f,header:d,cancel:!1},b.Wq(v,g),g&&g.cancel===!0)return t;a.Tz=!0,b.ITa.startTransaction(),ac(b);try{for(h=2,i=3,j=d?nb(b,h):nb(b,i),b.qq=a.qq,k=a.size,l=0;l<e;l++)for(n=c[l],o=n.firstCol,p=n.lastCol,q=o;q<=p;q++)0<=q&&q<j&&(d&&b.getColumnResizable(q,h)&&k!==b.$r(q,h)?(b.setColumnWidth(q,k,h),t=!0):!d&&b.getColumnResizable(q,i)&&k!==b.$r(q,i)&&(b.setColumnWidth(q,k,i),t=!0))}finally{xb(b),m[m.sd]({tc:b.parent}),b.Wq(w,{sheet:b,sheetName:b.name(),colList:f,header:a.rowHeader}),vb(b),r=P.bWa(b.name()),a[r]=b.ITa.endTransaction()}b.qs()}return t},b.prototype.undo=function(){var a,b,c,d,e,f,g,h,i=this,j=!1;if(i.canUndo()&&(a=i.VQ,b=i.kj,c=a.columns,d=a.rowHeader,e=c&&c.length,b&&e>0)){if(f=i.Sz(c),g={sheet:b,sheetName:b.name(),colList:f,header:d,cancel:!1},b.Wq(v,g),g&&g.cancel===!0)return j;ac(b);try{h=P.bWa(b.name()),b.ITa.undo(a[h]),b.oq=!0,b.showCell(b.getActiveRowIndex(),b.getActiveColumnIndex(),1,1),j=!0}finally{xb(b),m[m.sd]({tc:b.parent}),b.Wq(w,{sheet:b,sheetName:b.name(),colList:f,header:a.rowHeader}),vb(b)}}return j},b.prototype.Sz=function(a){var b,c,d,e,f,g,h=[];for(b=0,c=a.length;b<c;b++)for(d=a[b],e=d.firstCol,f=d.lastCol,g=e;g<=f;g++)h.push(g);return h},b.prototype.canUndo=function(){return this.VQ.Tz},b}(Za),_a=function(a){lb(b,a);function b(b,c){var d=a.call(this,b,c)||this;return cc(c,b),d}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,j,k,l,n,o,p,q,r,s=this,t=!1;if(s.canExecute()&&(a=s.kj,b=s.VQ,c=b.rows,d=c&&c.length,a&&d>0)){if(e=s.Vz(c),f={sheet:a,sheetName:a.name(),rowList:e,header:b.columnHeader,cancel:!1},a.Wq(x,f),f&&f.cancel===!0)return t;b.Tz=!0,a.ITa.startTransaction(),ac(a);try{for(g=3,h=1,i=b.columnHeader,j=i?mb(a,h):mb(a,g),a.lq=b.lq,k=b.size,l=0;l<d;l++)for(n=c[l],o=n.firstRow,p=n.lastRow,q=o;q<=p;q++)0<=q&&q<j&&(i&&a.getRowResizable(q,h)&&k!==a.Yr(q,h)?(a.setRowHeight(q,k,h),t=!0):!i&&a.getRowResizable(q,g)&&k!==a.Yr(q,g)&&(a.setRowHeight(q,k,g),t=!0))}finally{xb(a),m[m.sd]({tc:a.parent}),a.Wq(y,{sheet:a,sheetName:a.name(),rowList:e,header:b.columnHeader}),vb(a),r=P.bWa(a.name()),b[r]=a.ITa.endTransaction()}a.os()}return t},b.prototype.undo=function(){var a,b,c,d,e,f,g,h=this,i=!1;if(h.canUndo()&&(a=h.kj,b=h.VQ,c=b.rows,d=c&&c.length,a&&d>0)){if(e=h.Vz(c),f={sheet:a,sheetName:a.name(),rowList:e,header:b.columnHeader,cancel:!1},a.Wq(x,f),f&&f.cancel===!0)return i;ac(a);try{g=P.bWa(a.name()),a.ITa.undo(b[g]),a.jq=!0,a.showCell(a.getActiveRowIndex(),a.getActiveColumnIndex(),1,1),i=!0}finally{xb(a),m[m.sd]({tc:a.parent}),a.Wq(y,{sheet:a,sheetName:a.name(),rowList:e,header:b.columnHeader}),vb(a)}}return i},b.prototype.Vz=function(a){var b,c,d,e,f,g,h=[];for(b=0,c=a.length;b<c;b++)for(d=a[b],e=d.firstRow,f=d.lastRow,g=e;g<=f;g++)h.push(g);return h},b.prototype.canUndo=function(){return this.VQ.Tz},b}(Za),ab=function(a){lb(b,a);function b(b,c){var d=a.call(this)||this,e=d;return e.kj=b,e.VQ=c,d}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i=this,j=!1,k=i.VQ,l=i.kj,n=k.columns,o=k.rowHeader,p=i.Sz(n);if(l&&n&&n.length>0){if(a={sheet:l,sheetName:l.Cj,colList:p,header:o,cancel:!1},l.Wq(v,a),a&&a.cancel===!0)return j;l.ITa.startTransaction(),i.Lz(l);try{b=I(k.size),c=o?2:3,d=n[0].firstCol,e=void 0,f=void 0,g=void 0,e=l.$r(d,c),b!==e&&(f=b-e,g=l.Zq(d,c),l.setColumnWidth(d,b,c),l.setColumnWidth(g,l.$r(g,c)-f,c)),j=!0}finally{xb(l),m[m.sd]({tc:l.parent}),l.Wq(w,{sheet:l,sheetName:l.Cj,colList:p,header:k.rowHeader}),vb(l),h=P.bWa(l.name()),k[h]=l.ITa.endTransaction()}}return j},b.prototype.undo=function(){var a,b=this.kj,c=this.VQ.columns,d=!1,e=this.VQ,f=this.VQ.rowHeader,g=this.Sz(c),h={sheet:b,sheetName:b.Cj,colList:g,header:f,cancel:!1};if(b.Wq(v,h),h&&h.cancel===!0)return d;ac(b);try{a=P.bWa(b.name()),b.ITa.undo(e[a]),d=!0}finally{xb(b),m[m.sd]({tc:b.parent}),b.Wq(w,{sheet:b,sheetName:b.Cj,colList:g,header:e.rowHeader}),vb(b)}return d},b.prototype.Sz=function(a){var b,c,d,e,f,g,h=[];for(b=0,c=a.length;b<c;b++)for(d=a[b],e=d.firstCol,f=d.lastCol,g=e;g<=f;g++)h.push(g);return h},b}(Za),bb=function(a){lb(b,a);function b(b,c){var d=a.call(this)||this,e=d;return e.kj=b,e.VQ=c,d}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i=this,j=!1,k=i.VQ,l=i.kj,n=k.rows,o=k.columnHeader,p=i.Vz(n);if(l&&n&&n.length>0){if(a={sheet:l,sheetName:l.Cj,rowList:p,header:o,cancel:!1},l.Wq(x,a),a&&a.cancel===!0)return j;l.ITa.startTransaction(),i.Lz(l);try{b=I(k.size),c=o?1:3,d=n[0].firstRow,e=void 0,f=void 0,g=void 0,e=l.Yr(d,c),b!==e&&(f=b-e,g=l._q(d,c),l.setRowHeight(d,b,c),l.setRowHeight(g,l.Yr(g,c)-f,c)),j=!0}finally{xb(l),m[m.sd]({tc:l.parent}),l.Wq(y,{sheet:l,sheetName:l.Cj,rowList:p,header:k.columnHeader}),vb(l),h=P.bWa(l.name()),k[h]=l.ITa.endTransaction()}}return j},b.prototype.undo=function(){var a,b=this.kj,c=this.VQ.rows,d=!1,e=this.VQ,f=this.VQ.columnHeader,g=this.Vz(c),h={sheet:b,sheetName:b.Cj,rowList:g,header:f,cancel:!1};if(b.Wq(x,h),h&&h.cancel===!0)return d;ac(b);try{a=P.bWa(b.name()),b.ITa.undo(e[a]),d=!0}finally{xb(b),m[m.sd]({tc:b.parent}),b.Wq(y,{sheet:b,sheetName:b.Cj,rowList:g,header:e.columnHeader}),vb(b)}return d},b.prototype.Vz=function(a){var b,c,d,e,f,g,h=[];for(b=0,c=a.length;b<c;b++)for(d=a[b],e=d.firstRow,f=d.lastRow,g=e;g<=f;g++)h.push(g);return h},b}(Za),cb=function(a){lb(b,a);function b(b,c){var d=a.call(this,b,c)||this,e=d,f=b.parent;return e.Wz=c.rowHeader?2:3,A(c.autoFitType)||(c.autoFitType=f?f.options.autoFitType:0),d}return b.prototype.canExecute=function(){var a=this.VQ;return this.kj&&a.columns&&a.columns.length>0},b.prototype.execute=function(){var a,b,c,d,e,f,g,h,j,k,l,n,o,p,r,s=this,t=!1;if(s.canExecute()){if(a=s.VQ,b=s.kj,c=s.Wz,d=s.Sz(a.columns),e=2===c,f={sheet:b,sheetName:b.name(),colList:d,header:e,cancel:!1},b.Wq(v,f),f&&f.cancel===!0)return t;for(a.Tz=!0,g=nb(b,c),h=g-1,j=0,k=void 0,l=0,n=a.columns.length;l<n;l++)k=a.columns[l].col,h=h>k?k:h,j=j<k?k:j;i.mn.qn(b,0,h,mb(b)-1,j),b.ITa.startTransaction(),ac(b);try{for(o=void 0,l=0,n=a.columns.length;l<n;l++)p=a.columns[l].col,0<=p&&p<g&&b.getColumnResizable(p,c)&&(o=s.xl(p),o===b.getColumnWidth(p,c)&&q(b.getColumnWidth(p,c,!0))||(b.setColumnWidth(p,o,c),t=!0))}finally{i.mn.Nm(),xb(b),m[m.sd]({tc:b.parent}),b.Wq(w,{sheet:b,sheetName:b.name(),colList:d,header:e}),vb(b),r=P.bWa(b.name()),a[r]=b.ITa.endTransaction()}}return t},b.prototype.undo=function(){var a,b,c,d,e,f,g,h=this,i=!1;if(h.canUndo()){if(a=h.VQ,b=h.kj,c=h.Wz,d=h.Sz(a.columns),e=2===c,f={sheet:b,sheetName:b.name(),colList:d,header:e,cancel:!1},b.Wq(v,f),f&&f.cancel===!0)return i;ac(b);try{g=P.bWa(b.name()),b.ITa.undo(a[g]),i=!0}finally{xb(b),m[m.sd]({tc:b.parent}),b.Wq(w,{sheet:b,sheetName:b.name(),colList:d,header:e}),vb(b)}}return i},b.prototype.Sz=function(a){var b,c,d=[];for(b=0;b<a.length;b++)c=a[b],d.push(c.col);return d},b.prototype.xl=function(a){return i.Ul.xl(a,this.kj,this.Wz,this.VQ.autoFitType)},b.prototype.canUndo=function(){return this.VQ.Tz},b}(Za),db=function(a){lb(b,a);function b(b,c){var d=a.call(this,b,c)||this,e=d,f=b.parent;return e.Wz=c.columnHeader?1:3,A(c.autoFitType)||(c.autoFitType=f?f.options.autoFitType:0),d}return b.prototype.canExecute=function(){var a=this.VQ;return this.kj&&a.rows&&a.rows.length>0},b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,j,k,l,n=this,o=!1;if(n.canExecute()){if(a=n.VQ,b=n.kj,c=n.Vz(a.rows),d=n.Wz,e=1===n.Wz,f={sheet:b,sheetName:b.name(),rowList:c,header:e,cancel:!1},b.Wq(x,f),f&&f.cancel===!0)return o;a.Tz=!0,b.ITa.startTransaction(),ac(b);try{for(g=mb(b,d),h=void 0,i=0,j=a.rows.length;i<j;i++)k=a.rows[i].row,0<=k&&k<g&&b.getRowResizable(k,d)&&(h=n.Fl(k),h===b.getRowHeight(k,d)&&q(b.getRowHeight(k,d,!0))||(b.setRowHeight(k,h,d),o=!0))}finally{xb(b),m[m.sd]({tc:b.parent}),b.Wq(y,{sheet:b,sheetName:b.name(),rowList:c,header:e}),vb(b),l=P.bWa(b.name()),a[l]=b.ITa.endTransaction()}}return o},b.prototype.undo=function(){var a,b,c,d,e,f,g=this,h=!1;if(g.canUndo()){if(a=g.VQ,b=g.kj,c=g.Vz(a.rows),d=1===g.Wz,e={sheet:b,sheetName:b.name(),rowList:c,header:d,cancel:!1},b.Wq(x,e),e&&e.cancel===!0)return h;ac(b);try{f=P.bWa(b.name()),b.ITa.undo(a[f]),h=!0}finally{xb(b),m[m.sd]({tc:b.parent}),b.Wq(y,{sheet:b,sheetName:b.name(),rowList:c,header:d}),vb(b)}}return h},b.prototype.Vz=function(a){var b,c,d,e=[];for(b=0,c=a.length;b<c;b++)d=a[b],e.push(d.row);return e},b.prototype.Fl=function(a){return i.Ul.Fl(a,this.kj,this.Wz,this.VQ.autoFitType)},b.prototype.canUndo=function(){return this.VQ.Tz},b}(Za);function dc(a,b){"value"===b.propertyName&&a.xu(b.row,b.col,b.oldValue,b.newValue)}eb=function(a){lb(b,a);function b(b,c){var d,e,f=a.call(this,b,c)||this;return p&&c.ranges&&1===c.endEditType&&(d=b.Tq(c.ranges[0]),c.ranges[0]=d,1===ob(d)&&1===pb(d)&&(e=b.Ms(d.row,d.col,1,1),e&&e.ranges&&e.ranges.length>0&&(c.ranges=[e.ranges[0]]))),f}return b.prototype.canExecute=function(){var a,b,c=this,d=c.kj,e=c.VQ,f=e.ranges,g=e.row,h=e.col;if(f){for(a=0;a<f.length;a++)if(b=f[a],!d.Y3(b.row,b.col,ob(b),pb(b),E,E,E,E,E,e.sheetArea))return!1}else if(!d.Y3(g,h,1,1,E,E,E,E,E,e.sheetArea))return!1;return!0},b.prototype.yA=function(a){var b,c,d,e,f=this,g=f.VQ,h=g.ranges;if(h)for(b=0;b<h.length;b++)for(c=h[b],d=c.row;d<c.row+ob(c);d++)for(e=c.col;e<c.col+pb(c);e++)a(d,e);else a(g.row,g.col)},b.prototype.undo=function(){var a,b,c,d=this;if(d.canUndo()){a=d.kj,b=d.VQ,ac(a,!0);try{a.Fu(u+Xa,function(b,c){dc(a,c)}),c=P.bWa(a.name()),a.ITa.undo(b[c])}catch(a){return!1}finally{a.Gu(u+Xa),bc(a,!0)}return!0}return!1},b.prototype.execute=function(){var a,b,c=this,d=!1;if(c.canExecute()){a=c.kj,b=a.parent.LVJ(),P.Zxb(b),ac(a,!0);try{a.Fu(u+Xa,function(b,c){dc(a,c)}),c.VQ.applyResult=c.AA(),d=!0}catch(a){d=!1}finally{a.Gu(u+Xa),P.$xb(b,c.VQ),bc(a,!0)}}return d},b.prototype.zA=function(a,b){return a+"_"+b},b.prototype.BA=function(a){var b,c,d,e,f,g,h=this,i=0,j=h.kj,k=h.VQ,l=k.row,m=k.col,n=k.sheetArea,o=k.newValue,q=!k.hasOwnProperty("autoFormat")||k.autoFormat;return p&&o&&o.length>0&&"="===o[0]?j.getDataValidator&&j.getDataValidator(l,m,n)&&(b=o.substring(1),""!==b&&b!==j.getFormula(l,m,n)&&(c=j.Cf(),c&&(d=c.parse(j.yj(),b,l>=0?l:0,m>=0?m:0,!0),d&&(e=c.Hg(j.yj(),d,{row:l,col:m}),j.isValid&&!j.isValid(l,m,e,!1)&&(i=j.Nx(l,m)))))):(f=h.CA(l,m,o,q,a),g=!j.isValid||j.isValid(l,m,f,!1),g||(i=j.Nx(l,m),j.mm.j8J=!0)),i},b.prototype.AA=function(){var a,b,c,d,e,f,j,k,l,m,n,q,r,s,t,u,v,w,x,y=this,z=y.kj,A=y.VQ,B=A.sheetArea,C=A.newValue,F=A.ignoreValidate,G={tka:!1,uka:!1,_autoFormatter:E,quotePrefix:E},H=0;if(F!==!0&&(H=y.BA(G),1===H||2===H))return H;if(b=!A.hasOwnProperty("autoFormat")||A.autoFormat,c=A.row,c=c>=0?c:0,d=A.col,d=d>=0?d:0,e=p&&o&&o.Parser,l=z.ODJ&&3===B,!l&&e)if(k=z.Cf(),m=z.parent,n=m&&m.options.allowUserEditFormula,q=z.getFormatter(c,d,B),r=!1,"@"!==q&&n&&k&&i.bW(C)){"="===C[0]&&(C=C.substring(1),r=!0);try{if(s={row:c,col:d,sheetArea:B,text:C,isAllow:!0},h.Worksheet.ao(z,"applyEditingSetFormula",s),s.isAllow){if(A.ranges&&1===A.endEditType)return j=A.ranges[0],z.setArrayFormula(j.row,j.col,ob(j),pb(j),C,B),H;f=k.parse(z.yj(),C,c,d,!0)}}catch(a){if(!m||!m.options.allowInvalidFormula)throw z.Os(0,"string"==typeof a?a:a.message),a;C=r?"="+C:C}}else A.ranges&&1===A.endEditType&&(j=A.ranges[0],z.getRange(j.row,j.col,ob(j),pb(j),B).clear(1));return f||(C&&"'"===C[0]?y.Uia(c,d,!0,G):y.Uia(c,d,E,G),a=y.CA(c,d,C,b,G)),y.yA(function(b,c){if(f)try{var d=k.unparse(z.yj(B),f,b,c);z._u(b,c,d,f,E,B),z.Wq(i.Events.UserFormulaEntered,{sheet:z,sheetName:z.name(),row:b,col:c,isCircularReference:z.zCc(b,c),formula:d})}catch(a){throw z.Os(0,"string"==typeof a?a:a.message),a}else{try{z.hasFormula&&z.hasFormula(b,c,B)&&z.setFormula(b,c,D,B)}catch(a){throw z.Os(0,"string"==typeof a?a:a.message),a}try{z.uq(b,c,a,B),"string"!=typeof a&&null!==a||h.Worksheet.ao(z,"setHyperlinkWhenEditing",{url:a,row:b,col:c,sheetArea:B})}catch(a){z.setValue(b,c,C,B)}}}),t=G.tka,u=G.uka,(t||u)&&(v=z.Aj(c,d,B),w="string"==typeof v,v&&!w||(x=new g.Style,w&&(x.parentName=v),v=x),t&&(v._autoFormatter=G._autoFormatter),u&&(v.quotePrefix=G.quotePrefix),z.setStyle(c,d,v,B)),H},b.prototype.canUndo=function(){return 0===this.VQ.applyResult},b.prototype.CA=function(a,b,c,d,e){var f,g,h,j=this,k=j.kj,l=j.VQ,m=l.ignoreFormatting,n=k.getActualStyle(a,b),o={};return f="string"!=typeof c||m?c:c&&"'"===c[0]?c.substring(1):i.Ul.ul(n,c,d,o,l.editingFormatter),e.quotePrefix?(e._autoFormatter=E,e.tka=!0):(g=o.value,d&&g&&(h=D,(f!==D&&"General"!==g.formatString()||!n._autoFormatter)&&(g.isAuto=!0,h=g),h&&(e.tka=!0,e._autoFormatter=h))),f},b.prototype.Uia=function(a,b,c,d){var e,f=this,h=f.kj,i=h.Aj(a,b),j="string"==typeof i;i&&!j||(e=new g.Style,j&&(e.parentName=i),i=e),i.quotePrefix!==c&&(d.uka=!0,d.quotePrefix=c)},b}(Za);function ec(a){var b=a.parent,c=b&&b.MJc;c&&c.repaint()}function fc(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;if(o){for(b=o.createMap(),c=a.getRowCount(),d=a.getColumnCount(),e=a.Bj(),f=e.xf.id,h=function(a,c){a.ah.xf.id!==f&&b.set(c,a)},i=0;i<c;i++)for(j=0;j<d;j++)if(k=e.qg(i,j),k&&k.Ze)for(g=k.Ze,l=0;l<g.length;l++)m=k[g[l]],m&&m.forEach(h);if(n=e.ug(),n&&n.Ze)for(g=n.Ze,l=0;l<g.length;l++)m=n[g[l]],m&&m.forEach(function(a){a&&a.content.forEach(h)});return b}}function gc(a,b){a&&a.forEach(function(a){var c=a.ah.getFormula(a.row,a.column),d=a.ah.Qf(a.row,a.column);a.ah.xf.setFormula(a.row,a.column,c,d,b)})}fb=function(a){lb(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canUndo=function(){return!!this.VQ.oldName},b.prototype.canExecute=function(){var a=this,b=a.VQ;return a.kj&&b.name&&b.name!==b.oldName},b.prototype.execute=function(){var a,b,c,d,e,f,g=this,h=g.kj,j=g.VQ,k=j.name,l=!1;return g.canExecute()&&(a=h.name(),b=k,c={sheet:h,oldValue:a,newValue:b,cancel:!1},h.Wq(i.Events.SheetNameChanging,c),c.cancel===!1&&(d=h.parent.sheets,P.Zxb(d),e=null,h.parent.options&&h.parent.options.saveChangesForSheet&&(e=fc(h),gc(e,!0)),j.oldName=a,ac(h,!0),yb(h),h.cq(k),ec(h),e&&gc(e,!1),P.$xb(d,j),l=!0,j.sheetName=k,zb(h,!1),bc(h,!0),f={sheet:h,oldValue:a,newValue:b},h.Wq(i.Events.SheetNameChanged,f))),l},b.prototype.undo=function(){var a,b,c,d,e,f,g,h=this;return!(!h.canUndo()||(a=h.kj,b=h.VQ,c=b.name,d=b.oldName,e={sheet:a,oldValue:c,newValue:d,cancel:!1},a.Wq(i.Events.SheetNameChanging,e),e.cancel!==!1))&&(ac(a,!0),yb(a),f=P.bWa(a.name()),a.ITa.undo(b[f]),ec(a),b.sheetName=b.oldName,zb(a,!1),bc(a,!0),g={sheet:a,oldValue:c,newValue:d},a.Wq(i.Events.SheetNameChanged,g),!0)},b}(Za),gb=function(a){lb(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){var a=this;return a.kj&&a.kj.parent.options.allowUserZoom&&a.kj.zoom()!==a.VQ.zoomFactor},b.prototype.execute=function(){var a,b,c,d,e=this,f=e.VQ,g=!1;return e.canExecute()&&(a=e.kj,b=a.ITa,c=f.zoomFactor,b.startTransaction(),g=hc(a,c),b.ZVa(["zoomChanged",c,f.oldZoomFactor]),d=P.bWa(a.name()),f[d]=a.ITa.endTransaction()),g},b.prototype.undo=function(){var a,b=this.kj;if(this.canUndo())return!(b.isEditing()===!0&&!b.endEdit())&&(b.suspendPaint(),a=P.bWa(b.name()),b.ITa.undo(this.VQ[a]),b.resumePaint(),!0)},b}(Za);function hc(a,b){return!(a.isEditing()===!0&&!a.endEdit())&&(a.suspendPaint(),a.zoom(b),a.resumePaint(),!0)}hb=function(a){lb(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,j,k=this;k.canExecute()&&(a=k.kj,b=k.VQ.clearRange,c=a.tables&&a.tables.cIb&&a.tables.cIb(b.row,b.col,b.rowCount,b.colCount),a.isDirtySuspended()||(k.VQ.Iu=new Ya(a,a.Tq(b),3)),c&&c.length>0&&(k.VQ.tableNames=c),d=a.Tq(b),e=d.row,f=d.col,g=ob(d),h=pb(d),h>0&&g>0&&(a.ITa.startTransaction(),ac(a),a.vxb=!0,a.cg(e,f,g,h,3,257,!0),bc(a),a.vxb=!1,i=P.bWa(a.name()),k.VQ[i]=a.ITa.endTransaction(),j=k.VQ.Iu,P.Bu(a,e,f,g,h,j?j.wy():[],2,c)))},b.prototype.canExecute=function(){var a=this.VQ.clearRange;return this.kj.Y3(a.row,a.col,ob(a),pb(a),E,E,E,E,E,l.SheetArea.viewport)},b.prototype.canUndo=function(){var a=P.bWa(this.kj.name()),b=this.VQ[a];return P.cWa(b)},b.prototype.undo=function(){var a,b,c,d=this,e=d.kj;if(d.canUndo()&&e&&(a=e.Tq(d.VQ.clearRange),pb(a)>0&&ob(a)>0)){ac(e),e.vxb=!0;try{b=P.bWa(e.name()),e.ITa.undo(d.VQ[b])}finally{bc(e),e.vxb=!1}return c=d.VQ.Iu,P.Bu(e,a.row,a.col,ob(a),pb(a),c?c.wy():[],2,d.VQ.tableNames,!0),!0}return!1},b.prototype.toJSON=function(){var a=this;return{sheetName:a.kj?a.kj.name():"",command:a.VQ}},b}(Za),ib=function(a){lb(b,a);function b(b,c,d){var e,f,g=a.call(this,b,c)||this;if(!d&&(c.cachedActions=[],e=c.ranges,e&&e.length>0))for(f=0;f<e.length;f++)c.cachedActions[f]=new hb(b,{clearRange:e[f]});return g}return b.prototype.canExecute=function(){var a,b,c=this.VQ.cachedActions;if(c){for(a=0;a<c.length;a++)if(b=c[a],!b.canExecute())return!1;return!0}return!1},b.prototype.execute=function(){var a,b,c,d,e=this;if(e.canExecute()&&(a=e.VQ.cachedActions,b=e.kj,a)){for(ac(b,!0),c=0;c<a.length;c++)d=a[c],d.execute();return bc(b,!0),!0}return!1},b.prototype.canUndo=function(){var a,b,c=this.VQ.cachedActions;if(c){for(a=0;a<c.length;a++)if(b=c[a],!b.canUndo())return!1;return!0}return!1},b.prototype.undo=function(){var a,b,c,d,e=this,f=e.VQ.cachedActions;if(e.canUndo()){for(a=e.kj,b=f.length-1;b>=0;b--)if(c=f[b],ac(a,!0),d=c.undo(),bc(a,!0),!d)return!1;return!0}return!1},b}(Za),P.OA=ib,jb=function(a){lb(b,a);function b(b,c){return a.call(this,b,c)||this}return b.qx=function(a){var b=0;return 0!==a&&1!==a||(b|=1),0!==a&&2!==a||(b|=64,b|=32,b|=512),0!==a&&3!==a||(b|=2),0!==a&&4!==a||(b|=1,b|=64,b|=32,b|=512),0!==a&&5!==a||(b|=64,b|=32,b|=2,b|=512),0===a&&(b|=32,b|=16,b|=256,b|=4,b|=512,b|=128,b|=1024),b},b.prototype.canExecute=function(){var a=this,b=a.VQ,c=b.pasteExtent,d=c.targetRange,e=c.sourceRange;return b.toSheet.Y3(d.row,d.col,ob(d),pb(d),E,E,E,E,E,l.SheetArea.viewport)&&(!c.isCutting||b.fromSheet.Y3(e.row,e.col,ob(e),pb(e),E,E,E,E,D,l.SheetArea.viewport))},b.prototype.oUa=function(){var a=this,c=a.VQ.pasteExtent,d=a.VQ.io={},e=c.isCutting,f=b.qx(a.VQ.pasteOption),g=c.sourceRange,h=c.targetRange,i=a.VQ.fromSheet,j=a.VQ.toSheet;i&&g&&e&&!i.isDirtySuspended()&&(d.cA=new Ya(i,g,f)),j.isDirtySuspended()||(d.fA=new Ya(j,h,f))},b.prototype.VA=function(){return this.VQ.pasteExtent.targetRange},b.prototype.dIb=function(a,b,c,d,e,f){var g,h,i,j,k,m,n,o,p,q,r,s,t,u=!1,v=b.row,w=b.col,x=b.rowCount,y=b.colCount,z=e!==f,A=!1,B=!1,C=!1,D=!1,E=qb(e),F=!1,G=!1,H=e.CMc(),I=e.getRowCount(),J=e.getColumnCount(),K=x,L=y,M=0,N=0,P=0,Q=0;if(H&&(K-=e.EMc(v,K,!0),L-=e.EMc(w,L)),a||K%c.rowCount!==0&&L%c.colCount!==0){if(d===l.InsertShiftCell.right){if(o=c.rowCount,p=void 0,g=v,i=c.rowCount,H&&(p=e.DMc(v,o),o+=p,i+=p),!z){if(v!==c.row&&c.intersect(v,w,o,e.getColumnCount()-w))return e.Os(1,O().Exp_InsertCopiedCutCells),G=!0,{returnFunc:G};if(w>c.col&&w<=c.col+c.colCount-1&&v>c.row&&v<=c.row+c.rowCount-1)return e.Os(1,O().Exp_InsertCopiedCutCells),G=!0,{returnFunc:G};if(this.eIb(e,v,w,o,e.getColumnCount()-w))return e.Os(1,O().Exp_InsertCopiedCutCellsOnSpanTable),G=!0,{returnFunc:G}}if(v===c.row&&w<=c.col&&(H?(c.col+=c.colCount,c.col=e.Zq(c.col-1),N=e.DMc(c.col,c.colCount),c.colCount+=N):c.col=c.col+c.colCount,A=!0),h=e.getColumnCount()-c.colCount,j=c.colCount,H&&(Q=e.DMc(w,c.colCount),q=c.colCount+Q,j=q+e.FMc(J-1,q),h=J-j,A&&(c.col+=Q)),F=this.fIb(e,g,h,i,j),F&&!E)return e.Os(1,O().Exp_InsertCopiedCutCellsNoRange),G=!0,{returnFunc:G}}else if(d===l.InsertShiftCell.down){if(r=c.colCount,s=void 0,h=w,j=c.colCount,H&&(s=e.DMc(w,r),r+=s,j+=s),!z){if(w!==c.col&&c.intersect(v,w,e.getRowCount()-v,r))return e.Os(1,O().Exp_InsertCopiedCutCells),G=!0,{returnFunc:G};if(v>c.row&&v<=c.row+c.rowCount-1&&w>c.col&&w<=c.col+c.colCount-1)return e.Os(1,O().Exp_InsertCopiedCutCells),G=!0,{returnFunc:G};if(this.gIb(e,v,w,e.getRowCount()-v,r))return e.Os(1,O().Exp_InsertCopiedCutCellsOnSpanTable),G=!0,{returnFunc:G}}if(w===c.col&&v<=c.row&&(H?(c.row=c.row+c.rowCount,c.row=e._q(c.row-1),M=e.DMc(c.row,c.rowCount,!0),c.rowCount+=M):c.row=c.row+c.rowCount,B=!0),g=I-c.rowCount,i=c.rowCount,H&&(P=e.DMc(v,c.rowCount,!0),t=c.rowCount+P,i=t+e.FMc(I-1,t,!0),g=I-i,B&&(c.row+=P)),F=this.fIb(e,g,h,i,j),F&&!E)return e.Os(1,O().Exp_InsertCopiedCutCellsNoRange),G=!0,{returnFunc:G}}}else if(k=0,m=0,K%c.rowCount===0&&L%c.colCount!==0?(y=b.colCount=c.colCount,H&&(k=e.DMc(w,y),y+=k,b.colCount=y)):K%c.rowCount!==0&&L%c.colCount===0&&(x=b.rowCount=c.rowCount,H&&(m=e.DMc(v,x,!0),x+=m,b.rowCount=x)),u=!0,d===l.InsertShiftCell.right){if(n=!1,!z){if(v<=c.row&&v+x>=c.row+c.rowCount&&(n=!0),w>c.col&&w<=c.col+c.colCount-1&&v>c.row&&v<=c.row+c.rowCount-1)return e.Os(1,O().Exp_InsertCopiedCutCells),G=!0,{returnFunc:G};if(!n&&c.intersect(v,w,x,e.getColumnCount()-w))return e.Os(1,O().Exp_InsertCopiedCutCells),G=!0,{returnFunc:G};if(this.eIb(e,v,w,x,e.getColumnCount()-w))return e.Os(1,O().Exp_InsertCopiedCutCellsOnSpanTable),G=!0,{returnFunc:G};n&&w<=c.col&&(H?(c.col+=y,c.col=e.Zq(c.col-1),N=e.DMc(c.col,y),c.colCount+=N):c.col+=y,C=!0)}if(g=v,i=x,h=e.getColumnCount()-y,j=y,H&&(Q=e.FMc(J-1,y),j=y+Q+k,h=J-j),F=this.fIb(e,g,h,i,j),F&&!E)return e.Os(1,O().Exp_InsertCopiedCutCellsNoRange),G=!0,{returnFunc:G}}else if(d===l.InsertShiftCell.down){if(n=!1,!z){if(w<=c.col&&w+y>=c.col+c.colCount&&(n=!0),v>c.row&&v<=c.row+c.rowCount-1&&w>c.col&&w<=c.col+c.colCount-1)return e.Os(1,O().Exp_InsertCopiedCutCells),G=!0,{returnFunc:G};if(!n&&c.intersect(v,w,e.getRowCount()-v,y))return e.Os(1,O().Exp_InsertCopiedCutCells),G=!0,{returnFunc:G};if(this.gIb(e,v,w,e.getRowCount()-v,y))return e.Os(1,O().Exp_InsertCopiedCutCellsOnSpanTable),G=!0,{returnFunc:G};n&&v<=c.row&&(H?(c.row+=x,c.row=e._q(c.row-1),M=e.DMc(c.row,x,!0),c.rowCount+=M):c.row+=x,D=!0)}if(g=e.getRowCount()-x,i=x,h=w,j=y,H&&(P=e.FMc(I-1,x,!0),i=x+P+m,g=I-i),F=this.fIb(e,g,h,i,j),F&&!E)return e.Os(1,O().Exp_InsertCopiedCutCellsNoRange),G=!0,{returnFunc:G}}return{changePasteDataRangeCol:A,changePasteDataRangeRow:B,changePasteDataRangeCols:C,changePasteDataRangeRows:D,moveRangeHaveValue:F,returnFunc:G,selectRange:u,changePasteDataRangeRowInvisibleCount:M,changePasteDataRangeColInvisibleCount:N,invisibleRowCountInAcRange:P,invisibleColCountInAcRange:Q}},b.prototype.hIb=function(a,b,c,d,e,f,g,h,i,j){var k,m,n,o,p,r,s,t,u,v,w,x,y,z=!1,A=!1,B=c.CMc();if(a){if(b===l.InsertShiftCell.right)if(c.Vq(f,g+i,h,c.getColumnCount()-g-i,!0))if(g+i<c.getColumnCount()){if(B)if(k=h,m=i+c.FMc(c.getColumnCount()-1,i),f<0)c.moveTo(f,g,f,g+i,h,c.getColumnCount()-g-i,2047,!0);else for(n=f;n<f+k&&n<c.getRowCount();n++)0!==c.getRowHeight(n)&&c.moveTo(n,g,n,g+i,1,c.getColumnCount()-g-m,2047,!0);else c.moveTo(f,g,f,g+i,h,c.getColumnCount()-g-i,2047,!0);this.PYJ(c,f,g,f,g+i),o=c.rowFilter(),p=o&&o.range,p&&f===-1&&p.colCount>1&&g>p.col&&g<=p.col+p.colCount-1&&(p.colCount=p.colCount+e.colCount)}else g+i>c.getColumnCount()&&(z=!0,A=!0);else z=!0,A=!0;else if(b===l.InsertShiftCell.down)if(c.Vq(f+h,g,c.getRowCount()-f-h,i,!0))if(f+h<c.getRowCount()){if(B)if(r=i,s=h+c.FMc(c.getRowCount()-1,h,!0),g<0)c.moveTo(f,g,f+h,g,c.getRowCount()-f-s,e.colCount,2047,!0);else for(t=g;t<g+r&&t<c.getColumnCount();t++)0!==c.getColumnWidth(t)&&c.moveTo(f,t,f+h,t,c.getRowCount()-f-s,1,2047,!0);else q(j)||j===-1?c.moveTo(f,g,f+h,g,c.getRowCount()-f-h,i,2047,!0):(c.moveTo(j+1,g,j+1+h,g,c.getRowCount()-j-1-h,i,2047,!0),u=j-f-h,u>0&&c.moveTo(f,g,f+h,g,u,i,2047,!0));this.PYJ(c,f,g,f+h,g)}else f+h>c.getRowCount()&&(z=!0,A=!0);else z=!0,A=!0}else if(b===l.InsertShiftCell.right)if(c.Vq(f,g+e.colCount,e.rowCount,c.getColumnCount()-g-e.colCount,!0))if(g+e.colCount<c.getColumnCount()){if(B)if(v=e.rowCount,w=e.colCount+c.DMc(g,e.colCount),m=w+c.FMc(c.getColumnCount()-1,w),f<0)c.moveTo(f,g,f,g+w,e.rowCount,c.getColumnCount()-g-m,2047,!0);else for(n=f;n<f+v&&n<c.getRowCount();n++)0!==c.getRowHeight(n)?c.moveTo(n,g,n,g+w,1,c.getColumnCount()-g-m,2047,!0):v++;else c.moveTo(f,g,f,g+e.colCount,e.rowCount,c.getColumnCount()-g-e.colCount,2047,!0);this.PYJ(c,f,g,f,g+e.colCount),o=c.rowFilter(),p=o&&o.range,p&&f===-1&&p.colCount>1&&g>p.col&&g<=p.col+p.colCount-1&&(p.colCount=p.colCount+e.colCount)}else g+e.colCount>c.getColumnCount()&&(z=!0,A=!0);else z=!0,A=!0;else if(b===l.InsertShiftCell.down)if(c.Vq(f+e.rowCount,g,c.getRowCount()-f-e.rowCount,e.colCount,!0))if(f+e.rowCount<c.getRowCount()){if(B)if(x=e.colCount,y=e.rowCount+c.DMc(f,e.rowCount,!0),s=y+c.FMc(c.getRowCount()-1,y,!0),g<0)c.moveTo(f,g,f+y,g,c.getRowCount()-f-s,e.colCount,2047,!0);else for(t=g;t<g+x&&t<c.getColumnCount();t++)0!==c.getColumnWidth(t)?c.moveTo(f,t,f+y,t,c.getRowCount()-f-s,1,2047,!0):x++;else q(j)||j===-1?c.moveTo(f,g,f+e.rowCount,g,c.getRowCount()-f-e.rowCount,e.colCount,2047,!0):(c.moveTo(j+1,g,j+1+e.rowCount,g,c.getRowCount()-j-1-e.rowCount,e.colCount,2047,!0),u=j-f-e.rowCount,u>0&&c.moveTo(f,g,f+e.rowCount,g,u,e.colCount,2047,!0));this.PYJ(c,f,g,f+e.rowCount,g)}else f+e.rowCount>c.getRowCount()&&(z=!0,A=!0);else z=!0,A=!0;return{raiseInvalidOperation:z,returnFunc:A}},b.prototype.PYJ=function(a,b,c,d,e){a.Wq("shiftCellsDown",{row:d,col:e,changedRowCount:d-b,changedColCount:e-c,srcRow:b,srcColumn:c},!0)},b.prototype.xcc=function(a,b,c,d,e,f,g,h){var i=h.changePasteDataRangeRowInvisibleCount,j=h.changePasteDataRangeColInvisibleCount,k=h.invisibleRowCountInAcRange,l=h.invisibleColCountInAcRange,m=this.VQ.pasteExtent.targetRange;a&&(b.colCount-=j,b.col-=b.colCount,b.col-=l,m.colCount-=j),c&&(b.rowCount-=i,b.row-=b.rowCount,b.row-=k,m.rowCount-=i),d&&(b.colCount-=j,b.col-=f,b.col-=l,m.colCount-=j),e&&(b.rowCount-=i,b.row-=g,b.row-=k,m.rowCount-=i),h.changePasteDataRangeRowInvisibleCount=0,h.changePasteDataRangeColInvisibleCount=0,h.invisibleRowCountInAcRange=0,h.invisibleColCountInAcRange=0},b.prototype.WCJ=function(a,b){var c=[].concat(b.parent.sheets);return a&&a.ODJ&&c.push(a),b&&b!==a&&b.ODJ&&c.push(b),c},b.prototype.execute=function(){var a,c,d,e,f,g,h,j,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,F,G,H,I,J,K,L,M,N,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la=this;if(la.canExecute()){if(a=la.VQ.fromSheet,c=la.VQ.toSheet,d=la.VQ.pasteExtent,e=la.VQ.pasteOption,f=d.sourceRange,g=d.targetRange,h=d.isCutting,a&&f&&!a.pu(f.row,f.col,ob(f),pb(f),mb(a),nb(a)))return;if(!(c&&g&&c.l5(g.row,g.col,ob(g),pb(g),!0)))return;if(c.tables&&c.tables.zxb(a,f,c,g,h))return;if(c.pivotTables&&c.pivotTables.vCJ(f,g,c))return;if(j=void 0,k=void 0,m=void 0,n=void 0,a&&(m=a.tu(),j=la.$Hb,k=la.aIb,n=k&&new i.Range(k.row,k.col,k.rowCount,k.colCount)),o=void 0,p=void 0,q=void 0,r=void 0,s=void 0,la._Hb&&(o=la._Hb.row,p=la._Hb.col,q=la._Hb.rowCount,r=la._Hb.colCount),t=!1,u=!1,v=!1,w=!1,x=qb(c),y=!1,z=0,A=0,B=0,C=0,j!==E&&k){if(F=this.dIb(h,la._Hb,k,j,c,a),F.returnFunc)return;t=F.changePasteDataRangeCol,u=F.changePasteDataRangeRow,z=F.changePasteDataRangeRowInvisibleCount,A=F.changePasteDataRangeColInvisibleCount,B=F.invisibleRowCountInAcRange,C=F.invisibleColCountInAcRange,v=F.changePasteDataRangeCols,w=F.changePasteDataRangeRows,y=F.moveRangeHaveValue,s=F.selectRange,q=la._Hb.rowCount,r=la._Hb.colCount,g.rowCount+=z,g.colCount+=A}la.oUa(),G=la.WCJ(a,c),P.Zxb(G),ub(c),wb(c),c.vxb=!0,H=!1,I=void 0,J=void 0,a&&(wb(a),a.vxb=!0);try{if(x){if(K=-1,L=-1,g.row!==-1?K=g.row+ob(g):f.row===-1&&(K=mb(a)),M=mb(c),N=K-M,Q=K>M,R=O().Exp_InvalidCopyPasteSize,Q&&la.vTa(f,g))j===l.InsertShiftCell.down&&y?c.addRows(M,N+(M-o)):c.addRows(M,N);else if(y||o+g.rowCount!==M||j!==l.InsertShiftCell.down){if(y&&j===l.InsertShiftCell.down)c.addRows(M,N+(M-o));else if(Q)return H=!0,I=1,void(J=R)}else c.addRows(M,N+(M-o)-n.rowCount);if(g.col!==-1?L=g.col+pb(g):f.col===-1&&(L=nb(a)),S=nb(c),T=L>S,T&&la.vTa(f,g))j===l.InsertShiftCell.right&&y?c.setColumnCount(L+S-p):c.setColumnCount(L);else if(y||p+g.colCount!==S||j!==l.InsertShiftCell.right){if(y&&j===l.InsertShiftCell.right)c.setColumnCount(L+S-p);else if(T)return H=!0,I=1,void(J=R)}else c.setColumnCount(L+S-p-n.colCount)}if(U=j!==E&&this.hIb(s,j,c,la._Hb,n,o,p,q,r,la.b$J),H=U.raiseInvalidOperation,H&&(I=1,J=O().Exp_InsertCopiedCutCellsNoRange),U.returnFunc)return;f&&i.mn.qn(a,f.row,f.col,f.row+ob(f)-1,f.col+pb(f)-1);try{V={shiftCells:la.c$J&&j===l.InsertShiftCell.down,isCopy:!h,isFirst:!1},c.tables&&c.tables.jIb(a,g,f,D,D,D,{shiftInfo:V})}catch(a){return H=!0,I=6,void(J=a.message)}c.px(a,f,c,g,h,d.clipboardText,d.clipboardHtml,d.clipboardImage,e,!d.includeFilteredOutRow),h&&j!==E&&(W=f.row,X=f.col,Y=f.rowCount,Z=f.colCount,$=g.row,_=g.col,aa=g.rowCount,ba=g.colCount,j===l.InsertShiftCell.right&&f.row===g.row&&a.moveTo(W,X+Z,$,X,Y,c.getColumnCount()-X-Z,2047,!0),j===l.InsertShiftCell.down&&f.col===g.col&&a.moveTo(W+Y,X,W,_,c.getRowCount()-W-Y,Z,2047,!0))}finally{f&&i.mn.Nm(),xb(c),c.vxb=!1,a&&(xb(a),a.vxb=!1),vb(c),P.$xb(G,la.VQ),ca=la.VQ.io,da=b.qx(e),d.isCutting&&a&&(ea=[],a.isDirtySuspended()||(fa=new Ya(a,f,da),fa.uy(ca.cA.sy()),ca._z=fa,ea=fa.wy()),P.Bu(a,f.row,f.col,ob(f),pb(f),ea,3,E,E,j)),c&&(ga=[],c.isDirtySuspended()||(ha=new Ya(c,g,da),ha.uy(ca.fA.sy()),ca.dA=ha,ga=ha.wy()),ia=c.tables&&c.tables.cIb&&c.tables.cIb(g.row,g.col,g.rowCount,g.colCount),ja=ob(g),ka=pb(g),P.Bu(c,g.row,g.col,ja,ka,ga,3,ia,E,j),la.tableNamesObj={r:g.row,c:g.col,rc:ja,cc:ka,tableNames:ia}),la.ycc={changePasteDataRangeCol:t,changePasteDataRangeRow:u,changePasteDataRangeCols:v,changePasteDataRangeRows:w,acColCount:r,acRowCount:q,changePasteDataRangeRowInvisibleCount:z,changePasteDataRangeColInvisibleCount:A,invisibleRowCountInAcRange:B,invisibleColCountInAcRange:C},m&&delete m.YHb,H&&c.Os(I,J)}}},b.prototype.eIb=function(a,b,c,d,e){var f,g,h,i=a.ITa.getSpans(),j=a.tables.l$;for(f=0;f<i.length;f++)if(g=i[f],!(b<=g.row&&c<=g.col&&b+d>=g.row+g.rowCount&&c+e>=g.col+g.colCount||g.row>b+d||g.row+g.rowCount-1<b||g.row>b+d-1||g.row+g.rowCount-1<b||g.col+g.colCount-1<c))return!0;for(f=0;f<j.length;f++)if(h=j[f],!(b<=h.cj&&c<=h.dj&&b+d>=h.cj+h.Xj&&c+e>=h.dj+h.OZ||h.cj>b+d||h.cj+h.Xj-1<b||h.cj>b+d-1||h.cj+h.Xj-1<b||h.dj+h.OZ-1<c))return!0;return!1},b.prototype.gIb=function(a,b,c,d,e){var f,g,h,i=a.ITa.getSpans(),j=a.tables.l$;for(f=0;f<i.length;f++)if(g=i[f],!(b<=g.row&&c<=g.col&&b+d>=g.row+g.rowCount&&c+e>=g.col+g.colCount||g.col>c+e||g.col+g.colCount-1<c||g.col>c+e-1||g.col+g.colCount-1<c||g.row+g.rowCount-1<b))return!0;for(f=0;f<j.length;f++)if(h=j[f],!(b<=h.cj&&c<=h.dj&&b+d>=h.cj+h.Xj&&c+e>=h.dj+h.OZ||h.dj>c+e||h.dj+h.OZ-1<c||h.dj>c+e-1||h.dj+h.OZ-1<c||h.cj+h.Xj-1<b||c===h.dj&&e===h.OZ&&b>h.cj))return!0;return!1},b.prototype.fIb=function(a,b,c,d,e){var f,g,h,i,j,k,l,m=a.ITa.getSpans(),n=a.tables.l$;for(f=b;f<b+d;f++)for(g=c;g<c+e;g++){if(h=a.getCell(f,g),!q(h.value())||h.backColor()||h.comment()||h.tag())return!0;for(i=0;i<m.length;i++)if(j=m[i],f>=j.row&&f<=j.row+j.rowCount-1&&g>=j.col&&g<=j.col+j.colCount-1)return!0;for(k=0;k<n.length;k++)if(l=n[k],f>=l.cj&&f<=l.cj+l.Xj-1&&g>=l.dj&&g<=l.dj+l.OZ-1)return!0}return!1},b.prototype.vTa=function(a,b){var c,d,e,f,g,h,i;return!a||(c=a.row,d=a.col,e=b.row,f=b.col,g=c===-1&&d!==-1,h=d===-1&&c!==-1,i=c===-1&&d===-1,c!==-1&&d!==-1||g&&e<=0||h&&f<=0||i&&e<=0&&f<=0)},b.prototype.undo=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,z=this;if(z.canUndo()){if(a=z.VQ.fromSheet,b=z.VQ.toSheet,c=z.VQ.pasteExtent,d=c.sourceRange,e=c.targetRange,!b||!e)return!1;if(z.ycc&&(f=z.ycc,this.xcc(f.changePasteDataRangeCol,d,f.changePasteDataRangeRow,f.changePasteDataRangeCols,f.changePasteDataRangeRows,f.acColCount,f.acRowCount,f)),!b.pu(e.row,e.col,ob(e),pb(e),mb(b),nb(b)))return!1;if(a&&d){if(!a.pu(d.row,d.col,ob(d),pb(d),mb(a),nb(a)))return!1;
if(a&&a.name()===b.name()&&b.parent&&!a.ODJ&&!r(b.parent.sheets,a))return!1}g=z.VQ.io,ub(b);try{h=e.row<0?0:e.row,i=e.col<0?0:e.col,j=e.row<0?mb(b):ob(e),k=e.col<0?nb(b):pb(e),l=z.WCJ(a,b),P._xb(l,z.VQ),m=b.rowFilter(),n=m&&m.range,n&&e.row===-1&&n.col<e.col&&n.col+n.colCount>=e.col+e.colCount&&(n.colCount=n.colCount-e.colCount),o=0,p=0,q=0,s=0,a&&d&&(o=d.row<0?0:d.row,p=d.col<0?0:d.col,q=d.row<0?mb(a):ob(d),s=d.col<0?nb(a):pb(d)),t=[],u=[],v=z.tableNamesObj,v&&(b&&v.r===h&&v.c===i&&v.rc===j&&v.cc===k&&(u=v.tableNames),a&&v.r===o&&v.c===p&&v.rc===q&&v.cc===s&&(t=v.tableNames)),w=z.$Hb,b&&(x=g.dA,P.Bu(b,h,i,j,k,x?x.wy():[],3,t,!0,w)),c.isCutting&&a&&(y=g._z,P.Bu(a,o,p,q,s,y?y.wy():[],3,u,!0,w))}finally{vb(b)}}return!0},b.prototype.toJSON=function(){var a=this;return{sheetName:a.kj?a.kj.name():"",command:a.VQ}},b}(Za),kb=function(a){lb(b,a);function b(b,c,d){var e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=a.call(this,b,c)||this;if(!d){if(e=b,f=c.fromSheet,!e)throw Error(O().Exp_DestSheetIsNull);if(g=c,h=g.pastedRanges,j=e.CMc(),h&&h.length>0)if(c.cachedActions=[],k=g.fromRanges||[g.fromRange],l=k.length,m=g.isCutting,n=g.clipboardText,o=g.clipboardHtml,p=g.clipboardImage,q=g.pasteOption,r={},s=h[0],!m&&f&&f.r5(k,r)&&s.equals(f.q5(k,s))){for(t=r.inSameRow,u=r.inSameCol,t?k.sort(function(a,b){return a.col-b.col}):u&&k.sort(function(a,b){return a.row-b.row}),v=s.row,w=s.col,x=0;x<l;x++)y=k[x],z=y.rowCount,A=y.colCount,j&&(z+=b.DMc(v,z,!0),A+=b.DMc(w,A)),B={sourceRange:y,targetRange:i.kf(v,w,z,A),isCutting:m,clipboardText:n,clipboardHtml:o,clipboardImage:p,includeFilteredOutRow:!0},c.cachedActions[x]=new jb(b,{fromSheet:f,toSheet:e,pasteExtent:B,pasteOption:q}),t?w+=A:u&&(v+=z);c.s5=!0}else for(C=0;C<h.length;C++)D={sourceRange:k[0],targetRange:h[C],isCutting:m,clipboardText:n,clipboardHtml:o,clipboardImage:p},c.cachedActions[C]=new jb(b,{fromSheet:f,toSheet:e,pasteExtent:D,pasteOption:q})}return E}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,j,k,m,n,o,p=this,q=p.VQ,r=q.cachedActions,s=!1;if(p.canExecute()&&r){a=p.kj,b=a.parent.zCJ(),ac(b,!0);try{for(c=!1,d=0;d<r.length;d++)e=r[d],e.$Hb=q.$Hb,e._Hb=q._Hb,e.aIb=q.aIb,e.c$J=q.c$J,e.b$J=q.b$J,a?(f=e.VQ.pasteExtent,g=p.VQ,h=g.fromSheet,j=g.fromRanges&&g.fromRanges[d],k=f.clipboardText,m=f.clipboardHtml,!k&&h&&j&&(k=h.wXJ([j])),!m&&h&&j&&rb(a)&&(m=h.xXJ([j])),n={sheet:a,sheetName:a.name(),cellRange:e.VA(),pasteOption:e.VQ.pasteOption,pasteData:{text:k,html:m},shiftCells:q.$Hb,fromSheet:h,fromRange:j,isCutting:!!g.isCutting,cancel:!1,action:g.isCutting?l.ClipboardActionType.cut:l.ClipboardActionType.copy},o=f.clipboardImage,o&&(n.pasteData.image=o),a.Wq(i.Events.ClipboardPasting,n),n.cancel||(s=e.execute(),delete n.cancel,c=!0,a.Wq(i.Events.ClipboardPasted,n))):s=e.execute();c&&p.WA()}finally{bc(b,!0)}}return s},b.prototype.WA=function(){var a,b,c,d,e,f,g,h,i=this,j=i.VQ,k=j.cachedActions,l=i.kj;if(l&&k){if(a=l.getSelections(),b=[],c=l.parent,l.Tr(),j.s5)d=j.pastedRanges[0],l.RXJ(d.row,d.col,ob(d),pb(d));else if(k.length>1)for(e=0;e<k.length;e++)f=k[e],g=f.VA(),l.RXJ(g.row,g.col,ob(g),pb(g));else k.length>0&&(h=k[0].VA(),l.RXJ(h.row,h.col,ob(h),pb(h)),h.contains(l.Jl,l.Kl)||l.Jr(h.row,h.col));b=l.getSelections(),l.yu(a,b)&&l.Au(a),c&&j.xC&&c.changeSelectionInCommandExecuting(j,null,null,b)}},b.prototype.canExecute=function(){var a,b,c=this.VQ.cachedActions;if(c){for(a=0;a<c.length;a++)if(b=c[a],!b.canExecute())return!1;return!0}return!1},b.prototype.canUndo=function(){var a,b,c=this.VQ.cachedActions;if(c){for(a=0;a<c.length;a++)if(b=c[a],!b.canUndo())return!1;return!0}return!1},b.prototype.undo=function(){var a,b,c,d,e=this,f=e.VQ.cachedActions;if(e.canUndo()&&f){a=!0,b=e.kj.parent.zCJ(),ac(b,!0);try{for(c=f.length-1;c>=0;c--)d=f[c],a=a&&d.undo()}finally{bc(b,!0)}return a}return!1},b}(Za)},"./dist/core/worksheet/worksheet-border.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/worksheet/style.js"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/core.enum.js"),g=c("Common"),h=void 0,i=null,j=Math.sqrt,k=Math.pow,l=Math.min,m=Math.abs,n=Math.tan,o=Math.floor,p=Math.PI,q=e.GC$.inherit,r=e.GC$.isEmptyObject,s=g.Common.j.Fa,t={LEFT_TOP:0,RIGHT_TOP:1,RIGHT_BOTTOM:2,LEFT_BOTTOM:3},u={H_TOP_LEFT:0,H_TOP_Right:1,V_RIGHT_TOP:2,V_RIGHT_BOTTOM:3,H_BOTTOM_RIGHT:4,H_BOTTOM_LEFT:5,V_LEFT_BOTTOM:6,V_LEFT_TOP:7},v=function(){function a(){}return a.prototype.mE=function(a){var b=this;0===a._orientation?(a.nE&&(b.oE+=a.nE),a.pE&&(b.qE+=a.pE)):(a.nE&&(b.rE+=a.nE),a.pE&&(b.sE+=a.pE))},a.prototype.jp=function(a){var b=this.tE||"#9eb6ce",c=this.uE,d=a.lineWidth,e=a.strokeStyle;d===c&&e===b||(d!==c&&(a.lineWidth=c),e!==b&&(a.strokeStyle=b)),this.hWa(a)},a.prototype.hWa=function(a){var b,c,d=this,e=d.qE===d.oE,f=d.sE===d.rE;e&&f||(e||f?(a.beginPath(),d.vE(a),a.stroke()):(a.save(),b=Math.min(d.qE,d.oE),c=Math.min(d.sE,d.rE),a.rect(b,c,Math.abs(d.oE-d.qE),Math.abs(d.rE-d.sE)),a.clip(),a.beginPath(),d.vE(a),a.stroke(),a.beginPath(),a.restore()))},a.prototype.vE=function(a){var b=this;a.moveTo(b.qE,b.sE),a.lineTo(b.oE,b.rE)},a}(),w=function(a){D(b,a);function b(b,c,d,e,f,g,h){var i,j=a.call(this)||this,k=g%2;return k||(b!==d?(c-=.5,e-=.5):(b-=.5,d-=.5)),i=j,i.qE=b,i.sE=c,i.oE=d,i.rE=e,i.tE=f,i.uE=g,i.kIb=h,j}return b}(v),x=function(a){D(b,a);function b(b,c,d,e,f,g,h,i){var j,k=a.call(this)||this,l=g%2;return l||(b!==d?(c-=.5,e-=.5):(b-=.5,d-=.5)),j=k,j.qE=b,j.sE=c,j.oE=d,j.rE=e,j.tE=f,j.uE=g,j.wE=h,j.kIb=i,k}return b.prototype.vE=function(a){var c=this;b.yl(a,c.qE,c.sE,c.oE,c.rE,c.wE)},b.yl=function(a,b,c,d,e,f){var g,h,i=j(k(d-b,2)+k(e-c,2)),m={x:(d-b)/i,y:(e-c)/i},n=0,o=0;for(f=f&&f.length?f:[4,4];n<i;)g=l(f[o%f.length],i-n),o++,h=o%2,n+=g,h&&a.moveTo(b,c),b+=g*m.x,c+=g*m.y,h&&a.lineTo(b,c)},b}(v),y=function(a){D(b,a);function b(b,c,d,e,f,g,h,i,j){var k,l=a.call(this)||this;return g?(b-=1,d-=1):(c-=1,e-=1),k=l,k.qE=b,k.sE=c,k.oE=d,k.rE=e,k.tE=f,k.xE=g,k.uE=1,k.yE=h,k.zE=i,k.kIb=j,l}return b.prototype.vE=function(a){var b=this,c=b.xE?0:1,d=b.xE?1:0;x.yl(a,b.qE-c,b.sE-d,b.oE-c,b.rE-d,b.yE),x.yl(a,b.qE,b.sE,b.oE,b.rE,b.zE)},b}(v),z=function(a){D(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this)||this,j=i;return j.qE=b,j.sE=c,j.oE=d,j.rE=e,j.tE=f,j.iWa=g,j.kIb=h,j.AE=new w(j.qE,j.sE,j.oE,j.rE,f,1,h),j.BE=null,i}return b.prototype.hWa=function(a){this.AE&&this.AE.hWa(a),this.BE&&this.BE.hWa(a)},b.prototype.mE=function(a){var b=this;b.BE?(a.pE&&b.AE&&b.AE.mE(a),a.nE&&b.BE.mE(a)):b.AE&&b.AE.mE(a)},b.prototype.jWa=function(a){var b,c,d,e,f,g,h,i,j=this;a&&a.severX&&a.severY?(b=a.severX||0,c=a.severY||0,b=j.iWa?b:-b,d=parseInt(j.qE+(j.oE-j.qE)/2,10),e=parseInt(j.sE+(j.rE-j.sE)/2,10),f=d-b,g=e-c,h=d+b,i=e+c,j.AE=new w(j.qE,j.sE,f,g,j.tE,1,j.kIb),j.BE=new w(h,i,j.oE,j.rE,j.tE,1,j.kIb)):(j.AE=new w(j.qE,j.sE,j.oE,j.rE,j.tE,1,j.kIb),j.BE=null)},b}(v),A=function(a){D(b,a);function b(b,c,d,e,f,g){var h=a.call(this)||this,i=h,j=0,k=0;return b===d&&(j=1),c===e&&(k=1),b!==d&&c!==e?g?(j=2,i.AE=new w(b-j,c,d-j,e,f,1,g),i.BE=new w(b+j,c,d+j,e,f,1,g)):(j=2,k=2,b>d?(i.AE=new z(b-j,c,d,e-k,f,(!1),g),i.BE=new z(b,c+k,d+j,e,f,(!1),g)):(i.AE=new z(b,c+k,d-j,e,f,(!0),g),i.BE=new z(b+j,c,d,e-k,f,(!0),g))):(i.AE=new w(b-j,c-k,d-j,e-k,f,1,g),i.BE=new w(b+j,c+k,d+j,e+k,f,1,g)),i.kIb=g,i.tE=f,i.uE=1,h}return b.prototype.hWa=function(a){this.AE.hWa(a),this.BE.hWa(a)},b.prototype.mE=function(a){var b=this;a.CE?1===a.CE?b.AE.mE(a):2===a.CE&&b.BE.mE(a):(b.AE.mE(a),b.BE.mE(a))},b.prototype.jWa=function(){var a=this,b={severX:1,severY:1},c=a.AE,d=a.BE;c.jWa(b),d.jWa(b)},b}(v);function E(a,b,c,d,e,f,g){switch(f!==h&&f!==i||(f=1),f){case 1:return new w(a,b,c,d,e,1,g);case 2:return new w(a,b,c,d,e,2,g);case 5:return new w(a,b,c,d,e,3,g);case 3:return new x(a,b,c,d,e,1,[3,1],g);case 9:return new x(a,b,c,d,e,1,[8,2,2,2],g);case 4:return new x(a,b,c,d,e,1,[2,2],g);case 11:return new x(a,b,c,d,e,1,[9,3,3,3,3,3],g);case 13:return new y(a,b,c,d,e,a!==c,[11,1,5,1],[10,2,4,2],g);case 10:return new x(a,b,c,d,e,2,[9,3,3,3],g);case 12:return new x(a,b,c,d,e,2,[9,3,3,3,3,3],g);case 8:return new x(a,b,c,d,e,2,[9,3],g);case 7:return new x(a,b,c,d,e,1,[1],g);case 6:return new A(a,b,c,d,e,g)}return i}b.zF=E,B=function(){function a(){}return a.DE=function(b,c,d){var e,f;return b?c?(e=a.EE,f=e[b.style]-e[c.style],0!==f||d?f:(c.level||0)-(b.level||0)):1:c?-1:0},a.FE=function(a){if(a){if(a.isGridLine)return 1;if(a.style)return d.LineBorder.Vo(a.style)}return 0},a.GE=function(a){return a&&6===a.style},a.HE=function(a){return a&&13===a.style},a.IE=function(b,c){return b?c?a.DE(b.style,c.style)>=0?b:c:b:c},a.JE=function(a,b){a&&a.line?a.line.mE(b):a.mE&&a.mE(b)},a.KE=function(b,c,d){return b===c?0:b?c?b.isGridLine?c.isGridLine?0:-1:c.isGridLine?1:a.DE(b.style,c.style,d):1:-1},a.LE=function(a){return a&&a.style&&6===a.style.style},a.ME=function(a,b,c,d){if(a.style&&6===a.style.style)return!0;var e=0;return e+=b&&b.style&&6===b.style.style?1:0,e+=c&&c.style&&6===c.style.style?1:0,e+=d&&d.style&&6===d.style.style?1:0,e<2},a.NE=function(a,b,c,d,e,f){var g={_orientation:f?1:0,pE:0,nE:0},h=this.KE(a,c),i=this.KE(a,d);h>=0&&i>=0?0===h&&0===i?e!==-1&&1===e&&(g.nE-=e):e===-1?g.pE-=e:1===e&&(g.nE-=2*e):i>=0?(g.CE=2,g.pE+=e):h>=0&&(g.CE=1,g.pE+=e),this.JE(a,g)},a.OE=function(b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t={_orientation:i?1:0,CE:j?2:1,pE:0,nE:0},u={_orientation:i?1:0,CE:j?1:2,pE:0,nE:0},v=1===g?e:f,w=1===h?d:c,x=this.LE(w);x?(k=this.KE(b,v),0===k?(l=this.KE(b,w),0===l?1===h&&(u.nE-=h):l>0&&(h===-1?u.pE-=2*h:1===h&&(u.nE-=2*h))):k>0?(m=this.KE(b,w),0===m?1===h&&(u.nE-=h):m>0&&(h===-1?u.pE-=2*h:1===h&&(u.nE-=2*h))):(n=this.KE(b,w),0===n?h===-1?t.pE+=2*h:1===h&&(t.nE+=2*h):n>0&&(h===-1?t.pE-=3*h:1===h&&(t.nE-=3*h)))):this.KE(b,v)>=0?h===-1?u.pE-=2*h:1===h&&(u.nE-=2*h):h===-1?t.pE+=2*h:1===h&&(t.nE+=2*h),o=1===g?2:1,p=1===o?e:f,q=!1,r=0,this.LE(p)&&this.KE(p,b)>0&&(q=!0,s=a.FE(p),this.KE(p,v)>0?s>0&&(r=1===h&&this.LE(d)?s>=2?2:1:h===-1&&this.LE(c)?s>=3?2:1:3===s?3:2):r=3===s?3:2),q||this.LE(w)||!(w&&!w.isGridLine||p&&!p.isGridLine)||(q=!0,r=h===-1?2:1),q&&(h===-1?(t.pE+=h*r,u.pE+=h*r):1===h&&(t.nE+=h*r,u.nE+=h*r)),(t.pE||t.nE)&&this.JE(b,t),(u.pE||u.nE)&&this.JE(b,u)},a.PE=function(a,b,c,d,e,f){if(this.KE(a,c)>=0&&this.KE(a,d)>=0){var g={_orientation:f?1:0,pE:0,nE:0};e===-1?(g.pE-=2*e,this.LE(a)&&this.KE(b,a)>0&&(g.pE-=1)):1===e&&(g.nE-=2*e,this.LE(a)&&this.KE(b,a)>0&&(g.nE+=1)),this.JE(a,g)}},a.QE=function(b,c,d,e,f,g){var h,i,j;this.LE(b)&&(h=this.IE(d,e),h&&!h.isGridLine&&(i=a.FE(h),i>0&&(j={_orientation:g?1:0,pE:0,nE:0},f===-1?j.pE+=i*f:j.nE+=i*f,(j.pE||j.nE)&&this.JE(b,j))))},a.RE=function(b,c,d,e,f,g,h){var i,j,k,l,m=a;(c||d||e)&&(k=m.IE(d,e),m.ME(b,c,d,e)?(j=m.KE(k,b,!0))>0?(i=m.FE(k),m.LE(b)&&(m.LE(d)||m.LE(e)||m.LE(c))||3===i&&m.JE(b,{_orientation:0,pE:1})):k&&j<0?(j=m.KE(b,c,!0))>0?(i=m.FE(k),3===i||2===i?m.JE(b,{_orientation:0,pE:-2}):1===i&&m.JE(b,{_orientation:0,pE:-1})):0!==j&&m.KE(c,k,!0)>0&&(i=m.FE(k),3===i&&m.JE(b,{_orientation:0,pE:1})):0===j&&(!c||m.KE(b,c,!0)>0)&&(i=m.FE(k),3===i||2===i?m.JE(b,{_orientation:0,pE:-2}):1===i&&m.JE(b,{_orientation:0,pE:-1})):m.JE(b,{_orientation:0,pE:1})),(f||g||h)&&(l=m.IE(g,h),m.ME(b,f,g,h)?(j=m.KE(l,b,!0))>0?(i=m.FE(l),m.LE(b)&&(m.LE(g)||m.LE(h)||m.LE(f))||(3===i?m.JE(b,{_orientation:0,nE:-2}):2!==i&&1!==i||m.JE(b,{_orientation:0,nE:-1}))):j<=0&&((j=m.KE(b,f,!0))>0?(i=m.FE(l),3===i&&m.JE(b,{_orientation:0,nE:1})):0!==j&&m.JE(b,{_orientation:0,nE:-1})):m.JE(b,{_orientation:0,nE:-2}))},a.SE=function(b,c,d,e,f,g,h){var j,k,l,m,n=a;(c||d||e)&&(l=n.IE(d,e),k=n.KE(l,b,!0),n.ME(b,c,d,e)?k>0?(j=n.FE(l),n.LE(b)&&(n.LE(d)||n.LE(e)||n.LE(c))||3===j&&n.JE(b,{_orientation:1,pE:1})):k<0?(k=n.KE(b,c,!0),k>0?(j=n.FE(l),3===j||2===j?n.JE(b,{_orientation:1,pE:-2}):1===j&&n.JE(b,{_orientation:1,pE:-1})):0!==k&&n.KE(c,l,!0)>0&&(j=n.FE(l),3===j&&n.JE(b,{_orientation:1,pE:1}))):0===k&&n.KE(b,c,!0)>0&&(j=n.FE(l),3===j||2===j?n.JE(b,{_orientation:1,pE:-2}):1===j&&n.JE(b,{_orientation:1,pE:-1})):n.JE(b,{_orientation:1,pE:1})),(f||g||h)&&(m=n.IE(g,h),k=n.KE(b,m,!0),n.ME(b,f,g,h)?k<0?(j=n.FE(m),n.LE(b)&&(n.LE(g)||n.LE(h)||n.LE(f))||(3===j||2===j?n.JE(b,{_orientation:1,nE:-2}):1===j&&n.JE(b,{_orientation:1,nE:-1}))):m!==i&&k>=0&&(k=n.KE(b,f,!0),k>0?(j=n.FE(m),3===j&&n.JE(b,{_orientation:1,nE:1})):0!==k&&n.JE(b,{_orientation:1,nE:-1})):n.JE(b,{_orientation:1,nE:-2}))},a.TE=function(b,c,d,e,f,g,h,i){var j,k,l,m,n=a;i?this.SE(b,c,d,e,f,g,h):this.RE(b,c,d,e,f,g,h),j=n.LE(d),k=n.LE(e),l=n.LE(c),j&&k&&l?n.NE(b,c,d,e,-1,i):j&&!k?n.OE(b,c,f,d,e,1,-1,i,!0):!j&&k?n.OE(b,c,f,d,e,2,-1,i,!1):j&&k&&!l?n.PE(b,c,d,e,-1,i):l&&n.QE(b,c,d,e,-1,i),j=n.LE(g),k=n.LE(h),m=n.LE(f),j&&k&&m?n.NE(b,f,g,h,1,i):j&&!k?n.OE(b,c,f,g,h,1,1,i,!0):!j&&k?n.OE(b,c,f,g,h,2,1,i,!1):j&&k&&!m?n.PE(b,f,g,h,1,i):m&&n.QE(b,f,g,h,1,i)},a.EE=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],a.kWa=function(a,b){return!(!a||!b||a.color!==b.color||a.level!==b.level||a.style!==b.style)},a}(),C=function(){function a(a,b,c,d){var e=this;e.UE=!1,e.VE=!1,e.kj=a,e.Wz=d,e.lIb=b,e.pJ=c}return a.prototype.YE=function(){var a,b,c,d,e,f,g,h,i,j,k=this;if(k.ZE=[],k.k8J=[],k.l8J=[],k.aF=[],k.bF=[],k.cF={},k.dF={},k.eF={},k.fF={},k.lWa={},k.mWa={},k.C$a={},a=k.lIb,b=k.pJ,a&&a.length>0&&b&&b.length>0){for(c=k.k8J,d=a.length,e=void 0,f=0;f<d;f++)e=a[f],e.height>0&&c.push(e.row);for(c.push(c[c.length-1]+1),g=k.l8J,h=b.length,i=void 0,j=0;j<h;j++)i=b[j],i.width>0&&g.push(i.col);g.push(g[g.length-1]+1)}k.UE=!0},a.prototype.m8J=function(a,b,c,d,e,f,g,h){if(c){var i={cj:a,dj:b,hF:c.startColumn,iF:c.endColumn,Wqa:d,XHa:e,YHa:f,Vo:g,_v:h};this.aF.push(i)}},a.prototype.jF=function(a,b,c,d,e,f,g,i,j,k,l){var m,n,o,p,q,r,s,t,u,v,w=this;w.UE||w.YE(),i?w.ZE.push(i):(m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,r=void 0,s=void 0,t=void 0,u=void 0,v=void 0,g&&(m=g.borderLeft,n=g.borderTop,o=g.borderRight,p=g.borderBottom,v=g.backColor,l&&2===l.columnHeaderFitMode||(q=g.diagonalDown,r=g.diagonalUp),l&&l.sheetArea!==h&&3!==l.sheetArea||(s=g.textOrientation),t=g.isVerticalText,u=g.textIndent),!v||m||o||n||p||w.bF.push({r:a,c:b,rc:1,cc:1}),w.kF(a,b,c,d,e,f,m,n,o,p,q,r,v,!1,!1,j,k,s,t,u&&0!==u,l))},a.prototype.kF=function(a,b,c,d,e,g,i,j,k,l,o,q,r,t,u,v,w,x,y,z,A){var B,C,D,E,F,G,H,I,J,K,L,M,N=this,O=N.kj,P=O.ss,Q=!1,R=!1,S=!1,T=!1,U=function(a){return a!==h&&a&&-90<=a&&a<=90},V=U(x),W=i||j||k||l,X=0,Y=0,Z=c,$=e;b+1<O.getColumnCount()&&(G=P.Ym(a,b+1)),b-1>=0&&(H=P.Ym(a,b-1)),I=V&&!y&&!z&&A&&A.data,W&&(I&&(E=m(x*p/180),F=n(E),X=Math.floor(g/F),x>-90&&x<0&&(Z=c-X),x>0&&x<90&&(Z=c+X)),V||(G&&U(G.textOrientation)&&(E=m(G.textOrientation*p/180),F=n(E),Y=Math.floor(g/F),G.textOrientation>0&&G.textOrientation<90&&($=e+Y),G.textOrientation<0&&G.textOrientation>-90&&($=e-Y)),H&&U(H.textOrientation)&&(E=m(H.textOrientation*p/180),F=n(E),Y=Math.floor(g/F),H.textOrientation>-90&&H.textOrientation<0&&($+=Y,Z=c-Y),H.textOrientation>0&&H.textOrientation<90&&($-=Y,Z=c+Y)))),o&&!V&&N.lF(a,b,c-1,d-1,c+e,d+g,o,N.lWa),q&&!V&&N.lF(a,b,c+e,d-1,c-1,d+g,q,N.mWa),j&&g>0&&(Q=N.lF(a,b,Z,d-.5,Z+$,d-.5,j,N.eF,V)),i&&$>0&&(R=N.lF(a,b,Z-.5,d,c-.5,d+g,i,N.fF,V)),k&&$>0&&(A&&A.columnHeaderFitMode===f.ColumnHeaderFitMode.stack&&!s(A.cornerX)?(B=A.cornerX,C=A.cornerY,D=C-d,N.lF(a,b+1,Z+$-.5,d,c+e-.5,d+D,k,N.fF,V,{isMultiLine:!0,multiLinePart:"topVertical"}),N.lF(a,b+1,B,d+D-.5,c+e-.5,d+D-.5,k,N.eF,V,{isMultiLine:!0,multiLinePart:"horizontal"}),T=N.lF(a,b+1,B-.5,C,B-.5,d+g,k,N.fF,V,{isMultiLine:!0,multiLinePart:"bottomVertical"})):T=N.lF(a,b+1,Z+$-.5,d,c+e-.5,d+g,k,N.fF,V)),l&&g>0&&(A&&A.columnHeaderFitMode===f.ColumnHeaderFitMode.stack&&!s(A.cornerX)?(B=A.cornerX,S=N.lF(a+1,b,c,d+g-.5,B,d+g-.5,l,N.eF,V)):S=N.lF(a+1,b,c,d+g-.5,c+e,d+g-.5,l,N.eF,V)),r&&0!==O.ss.Sl(a)&&0!==O.ss._m(b)||(J=!S&&!t,K=!T&&!u,L=!Q&&!t,M=!R&&!u,(J||K||L||M)&&N.mF(a,b,c,d,e,g,J,K,v,w)),!Q&&!r||V||N.nF(a-1,b,N.cF),(R||r)&&N.nF(a,b-1,N.dF),!r||i||k||j||l||(N.oF(a-1,b-1,N.dF,!1),N.oF(a-1,b-1,N.cF,!0))},a.prototype.lF=function(a,b,c,d,e,f,g,h,j,k){var l,m,n,o,p;return!!g&&(l=void 0,m=void 0,k&&(l=k.isMultiLine,m=k.multiLinePart),n=this.pF(a,b,h,!0),n?l?(o=E(c,d,e,f,g.color,g.style,j),o.multiLinePart=m,n.splitLines||(n.splitLines=[]),"horizontal"===m&&(n.line=o),n.splitLines.push(o)):j||6!==n.style.style&&(6===g.style||B.DE(g,n.style)>0)?(n.line=E(c,d,e,f,g.color,g.style,j),n.style=g):n.line&&!n.splitLines&&f-d!==n.line.rE-n.line.sE&&(n.line.rE=f,n.line.sE=d):(p=E(c,d,e,f,g.color,g.style,j),p&&(n=this.pF(a,b,h),n.line=p,n.style=g,l&&(n.line.multiLinePart=m,n.splitLines=[n.line]))),n&&n.line!==i)},a.prototype.mF=function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p=this,q=3===p.Wz,r=p.kj.options.gridline;q&&r&&(k=r.color,r.showHorizontalGridline&&(g&&(l=p.pF(a,b,p.cF),l.isGridLine=!0,l.line=E(c,d+f-.5,c+e,d+f-.5,k)),i&&(m=p.pF(-1,b,p.cF,!1,!0),m.isGridLine=!0,m.line=E(c,d-.5,c+e,d-.5,k))),r.showVerticalGridline&&(h&&(n=p.pF(a,b,p.dF),n.isGridLine=!0,n.line=E(c+e-.5,d,c+e-.5,d+f,k)),j&&(o=p.pF(a,-1,p.dF,!1,!0),o.isGridLine=!0,o.line=E(c-.5,d,c-.5,d+f,k))))},a.prototype.oF=function(a,b,c,d){var e,f=this.pF(a,b,c,!0);f&&(e=f,e.line&&e.line.mE({_orientation:d?0:1,nE:-1}))},a.prototype.nF=function(a,b,c){var d,e;(a>=0&&b>=0||0===a&&b===-1||a===-1&&0===b)&&(d=c[a],d&&(e=d[b],e&&delete d[b]))},a.prototype.pF=function(a,b,c,d,e){var f,g;if(!e&&(a===-1||b===-1))return i;if(f=c[a],!f){if(d)return i;c[a]=f={}}if(g=f[b],!g){if(d)return i;f[b]=g={}}return g},a.prototype.qF=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=this,D=C.aF,F=D.length,G=C.fF,H=C.eF,I=C.dF,J=C.cF;for(a=0;a<F;a++)if(b=D[a],c=b.cj,d=b.dj,e=b.hF,f=b.Wqa,g=b.iF,h=void 0,i=b.XHa,j=b.Vo,k=b._v,l=i,m=void 0,n=f.textOrientation,o=f.borderTop,p=D[a-1],!p||p.cj!==c||p.hF!==e||p.iF!==g){for(q=e;q<g;q++)h=C.pF(c,q+1,G,!0),h&&!n?C.nF(c,q+1,G):(h=C.pF(c,q,I,!0),h&&C.nF(c,q,I));if(r=C.pF(c,d,H,!0),n&&o&&!r)for(s=void 0,s=k/Math.tan(Math.abs(n*Math.PI/180)),n>-90&&n<0&&(l=i-s),n>0&&n<90&&(l=i+s),m=l+j,t=e;t<g+1;t++)if(u=C.pF(c-1,t,J,!0),v=u&&u.line)for(u.splitLines||(u.splitLines=[],u.splitLines.push(v)),w=0;w<u.splitLines.length;w++)if(x=u.splitLines[w],y=x.qE,z=x.oE,A=x.sE,B=x.rE,l>y&&m>z&&z>l)x.oE=l;else if(l<y&&m>z)C.nF(c-1,t,C.cF);else if(l<y&&m<z&&y<m)x.qE=m;else if(l>y&&m<z){u.splitLines.splice(w,1,E(y,A,l,A,x.color),E(m,B,z,B,x.color));break}}},a.prototype.rF=function(){var a,b,c=this.ZE,d=c.length;if(d>0)for(b=0;b<d;b++)a=c[b],this.sF(a)},a.prototype.D$a=function(){var a,b,c,d,e,f,g,h;if(this.C$a={},a=this.ZE,b=a.length,b>0)for(d=0;d<b;d++)for(c=a[d],e=0;e<c.rowCount;e++)for(f=e+c.row,this.C$a[f]=this.C$a[f]||{},g=0;g<c.colCount;g++)h=g+c.col,this.C$a[f][h]=c},a.prototype.sF=function(a){var b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s=this,t=a.row,u=a.col,v=a.x,w=a.y,x=a.spanSizeInfo,y=x.styleList[0][0],z=y?y.backColor:i,A=v,C=w,D=null,E=!0,F=null,G=!0;if(1===a.rowCount){for(g=t,j=x.rowSizes[0],f=0;f<a.colCount;f++)l=0===f,n=f===a.colCount-1,h=u+f,k=x.colSizes[f],p=x.styleList[0][f],g===a.row&&h===a.col&&(q=p,D=q&&q.diagonalDown,F=q&&q.diagonalUp),p?(b=p.borderLeft,c=p.borderTop,d=p.borderRight,e=p.borderBottom,E&&(E=B.kWa(D,p.diagonalDown)),G&&(G=B.kWa(F,p.diagonalUp))):b=c=d=e=i,l?s.kF(g,h,A,C,k,j,b,c,i,e,i,i,z,!1,!0):n?s.kF(g,h,A,C,k,j,i,c,d,e,i,i,z,!1,!1):s.kF(g,h,A,C,k,j,i,c,i,e,i,i,z,!1,!0),A+=k;D=E?D:null,F=G?F:null,s.kF(a.row,a.col,a.x,a.y,a.width,a.height,i,i,i,i,D,F,i,!0,!0)}else if(1===a.colCount){for(h=u,k=x.colSizes[0],f=0;f<a.rowCount;f++)m=0===f,o=f===a.rowCount-1,g=t+f,j=x.rowSizes[f],p=x.styleList[f][0],g===a.row&&h===a.col&&(q=p,D=q&&q.diagonalDown,F=q&&q.diagonalUp),p?(b=p.borderLeft,c=p.borderTop,d=p.borderRight,e=p.borderBottom,E&&(E=B.kWa(D,p.diagonalDown)),G&&(G=B.kWa(F,p.diagonalUp))):b=c=d=e=i,m?s.kF(g,h,A,C,k,j,b,c,d,i,i,i,z,!0,!1):o?s.kF(g,h,A,C,k,j,b,i,d,e,i,i,z,!1,!1):s.kF(g,h,A,C,k,j,b,i,d,i,i,i,z,!0,!1),C+=j;D=E?D:null,F=G?F:null,s.kF(a.row,a.col,a.x,a.y,a.width,a.height,i,i,i,i,D,F,i,!0,!0)}else{for(f=0;f<a.rowCount;f++){for(g=t+f,m=0===f,o=f===a.rowCount-1,j=x.rowSizes[f],r=0;r<a.colCount;r++)h=u+r,l=0===r,n=r===a.colCount-1,k=x.colSizes[r],p=x.styleList[f][r],g===a.row&&h===a.col&&(q=p,D=q&&q.diagonalDown,F=q&&q.diagonalUp),p?(b=p.borderLeft,c=p.borderTop,d=p.borderRight,e=p.borderBottom,E&&(E=B.kWa(D,p.diagonalDown)),G&&(G=B.kWa(F,p.diagonalUp))):b=c=d=e=i,m?l?s.kF(g,h,A,C,k,j,b,c,i,i,i,i,z,!0,!0):n?s.kF(g,h,A,C,k,j,i,c,d,i,i,i,z,!0,!1):s.kF(g,h,A,C,k,j,i,c,i,i,i,i,z,!0,!0):o?l?s.kF(g,h,A,C,k,j,b,i,i,e,i,i,z,!1,!0):n?s.kF(g,h,A,C,k,j,i,i,d,e,i,i,z,!1,!1):s.kF(g,h,A,C,k,j,i,i,i,e,i,i,z,!1,!0):l?s.kF(g,h,A,C,k,j,b,i,i,i,i,i,z,!0,!0):n&&s.kF(g,h,A,C,k,j,i,i,d,i,i,i,z,!0,!1),A+=k;A=v,C+=j}D=E?D:null,F=G?F:null,s.kF(a.row,a.col,a.x,a.y,a.width,a.height,i,i,i,i,D,F,i,!0,!0)}!z||b||d||c||e||s.bF.push({r:t,c:u,rc:a.rowCount,cc:a.colCount})},a.prototype.mE=function(){var a=this,b=!1,c=!1,d=!1,e=!1;r(a.fF)||(b=!0),r(a.eF)||(c=!0),(b||c)&&(a.tF(),a.tWa()),r(a.lWa)||(d=!0),r(a.mWa)||(e=!0),(d||e)&&a.oWa(),a.bF.length>0&&a.uF()},a.prototype.E$a=function(a,b,c,d,e){var f=this,g=this.C$a[a]?this.C$a[a][b]:null;if(g)switch(e){case u.H_TOP_LEFT:return f.vF(a,b,c,d);case u.H_TOP_Right:return f.vF(a,b+g.colCount-1,c,d);case u.V_RIGHT_TOP:return f.vF(a,b+g.colCount-1,c,d);case u.V_RIGHT_BOTTOM:return f.vF(a+g.rowCount-1,b+g.colCount-1,c,d);case u.H_BOTTOM_RIGHT:return f.vF(a+g.rowCount-1,b+g.colCount-1,c,d);case u.H_BOTTOM_LEFT:return f.vF(a+g.rowCount-1,b,c,d);case u.V_LEFT_BOTTOM:return f.vF(a+g.rowCount-1,b,c,d);case u.V_LEFT_TOP:return f.vF(a,b,c,d)}return f.vF(a,b,c,d)},a.prototype.oWa=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=p.k8J,r=p.l8J,s=q.length,t=r.length,v={},w={};for(a=0;a<s;a++)for(c=q[a],b=0;b<t;b++)d=r[b],m=p.pF(c,d,p.lWa,!1),n=p.pF(c,d,p.mWa,!1),(m||n)&&(B.LE(m)&&B.LE(n)&&(m.line.jWa(),n.line.jWa()),o=[],e=p.E$a(c,d,!1,v,u.H_TOP_LEFT),e&&e.line&&!e.isGridLine&&(o=[1,1,2],p.pWa(o,e,m,!0,1)),i=p.E$a(c,d,!1,v,u.H_TOP_Right),i&&i.line&&!i.isGridLine&&(o=[1,1,2],p.pWa(o,i,n,!0,1)),f=p.E$a(c,d,!0,w,u.V_LEFT_TOP),f&&f.line&&!f.isGridLine&&(o=[1,1,2],p.pWa(o,f,m,!0,0)),j=p.E$a(c,d,!0,w,u.V_LEFT_BOTTOM),j&&j.line&&!j.isGridLine&&(o=[1,1,2],p.pWa(o,j,n,!1,0)),g=p.E$a(c+1,d,!1,v,u.H_BOTTOM_LEFT),g&&g.line&&!g.isGridLine&&(o=[-1,-2,-2],p.pWa(o,g,n,!1,1)),k=p.E$a(c+1,d,!1,v,u.H_BOTTOM_RIGHT),k&&k.line&&!k.isGridLine&&(o=[-1,-2,-2],p.pWa(o,k,m,!1,1)),h=p.E$a(c,d+1,!0,w,u.V_RIGHT_TOP),h&&h.line&&!h.isGridLine&&(o=[-1,-2,-2],p.pWa(o,h,n,!0,0)),l=p.E$a(c,d+1,!0,w,u.V_RIGHT_BOTTOM),l&&l.line&&!l.isGridLine&&(o=[-1,-2,-2],p.pWa(o,l,m,!1,0)))},a.prototype.pWa=function(a,b,c,d,e){var f,g,h=B.LE(b),i=B.HE(b),j=b.line.uE;h&&(j=3),i&&(j=2),f=a[j-1],c&&c.line&&(g={_orientation:e},d?g.pE=f:g.nE=f,c.line.mE(g))},a.prototype.uF=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=this,n=m.bF,o=n.length;for(a=0;a<o;a++){for(b=n[a],c=b.r,d=b.c,e=c,f=c-1,g=d-1,h=d,b.rc>1&&(e+=b.rc-1),b.cc>1&&(h+=b.cc-1),i=!1,j=!1,k=a+1;k<o&&(l=n[k],l.c===h+1&&l.r===c&&(j=!0),l.r===e+1&&l.c===d&&(i=!0),!i||!j)&&!(l.r>c+1&&l.c>d+1);k++);i||m.oF(e,g,m.cF,!0),j||m.oF(f,h,m.dF,!1)}},a.prototype.tF=function(){var a,b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this,C=A.kj,D=C.ITa,E=A.k8J,F=A.l8J,G=E.length,H=F.length,I={},J={};for(a=0;a<G;a++)for(c=E[a],b=0;b<H;b++){if(d=F[b],p=0,q=0,r=A.pF(c,d,A.fF,!0)){if(r.line&&r.line.kIb)continue;p++}else r=A.pF(c,d-1,A.dF,!0);if(s=A.pF(c,d,A.eF,!0),s?q++:s=A.pF(c-1,d,A.cF,!0),r||s){if(e=0===a?i:A.vF(E[a-1],d,!0,J),e&&e.line&&!e.isGridLine&&(p++,q++),f=0===b?i:A.vF(c,F[b-1],!1,I),f&&f.line&&!f.isGridLine&&(p++,q++),r)for(t=[r],r.splitLines&&r.splitLines.length>0&&(t=r.splitLines),u=0;u<t.length;u++)v=t[u],v.style=r.style,g=A.vF(c,d,!1,I),g&&g.line&&!g.isGridLine&&p++,a!==G-1&&(j=A.vF(E[a+1],d,!0,J),j&&j.line&&!j.isGridLine&&p++),0!==b&&a!==G-1&&(k=A.vF(E[a+1],F[b-1],!1,I),k&&k.line&&!k.isGridLine&&p++),a!==G-1&&(l=A.vF(E[a+1],d,!1,I),l&&l.line&&!l.isGridLine&&p++),p>0&&("topVertical"===v.multiLinePart?(w=D.QKJ(d,0),x=C.br(w),2===C.PKJ(x)&&(w=C.Zq(w)),y=C.Zq(d),g=A.vF(c,w,!1,I),j=A.vF(c,y,!0,J),k=v,l=i):"bottomVertical"===v.multiLinePart&&(e=i,f=i,g=v,j=i,k=A.vF(E[a+1],F[b-1],!1,I),l=A.vF(E[a+1],F[b],!1,I)),B.GE(r.style)?B.TE(v,e,f,g,j,k,l,!0):B.HE(r.style)||B.SE(v,e,f,g,j,k,l));s&&(h=A.vF(c,d,!0,J),h&&h.line&&!h.isGridLine&&q++,b!==H-1&&(z=F[b+1],2===C.PKJ(z)&&(z=D.QKJ(z,0),z=C.Zq(z)),m=A.vF(c,z,!1,I),m&&m.line&&!m.isGridLine&&q++),0!==a&&b!==H-1&&(n=A.vF(E[a-1],F[b+1],!0,J),n&&n.line&&!n.isGridLine&&q++),b!==H-1&&(o=A.vF(c,F[b+1],!0,J),o&&o.line&&!o.isGridLine&&q++),q>0&&(s.line&&"horizontal"===s.line.multiLinePart&&(w=D.QKJ(d,0),x=C.br(w),2===C.PKJ(x)&&(w=C.Zq(w)),f=i,e=i,h=s,m=i,n=s,o=A.vF(c,w,!0,J)),B.GE(s.style)?B.TE(s,f,e,h,m,n,o,!1):B.HE(s.style)||B.RE(s,f,e,h,m,n,o)))}}},a.prototype.F$a=function(a,b,c,d){var e=this,f=this.C$a[a]?this.C$a[a][b]:null,g=c?e.mWa:e.lWa;return f?a===f.row&&b===f.col&&d===t.LEFT_TOP?e.pF(f.row,f.col,g,!1):a===f.row&&b===f.col+f.colCount-1&&d===t.RIGHT_TOP?e.pF(f.row,f.col,g,!1):a===f.row+f.rowCount-1&&b===f.col+f.colCount-1&&d===t.RIGHT_BOTTOM?e.pF(f.row,f.col,g,!1):a===f.row+f.rowCount-1&&b===f.col&&d===t.LEFT_BOTTOM?e.pF(f.row,f.col,g,!1):void 0:e.pF(a,b,g,!1)},a.prototype.tWa=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=p.k8J,r=p.l8J,s=q.length,u=r.length;for(a=0;a<s;a++)for(c=q[a],b=0;b<u;b++)d=r[b],n=p.pF(c,d,p.fF,!0),n&&n.line&&n.line._noNeedAdjust||(n&&n.line&&B.LE(n)&&(e=p.F$a(c,d,!1,t.LEFT_TOP),f=p.F$a(c,d,!0,t.LEFT_BOTTOM),g=B.LE(e),h=B.LE(f),i=p.F$a(c,d-1,!1,t.RIGHT_BOTTOM),j=p.F$a(c,d-1,!0,t.RIGHT_TOP),k=B.LE(i),l=B.LE(j),e&&g&&(m={CE:2,_orientation:1,pE:2},n.line.mE(m)),f&&h&&(m={CE:2,_orientation:1,nE:-2},n.line.mE(m)),i&&k&&(m={CE:1,_orientation:1,nE:-2},n.line.mE(m)),j&&l&&(m={CE:1,_orientation:1,pE:2},n.line.mE(m))),o=p.pF(c,d,p.eF,!0),o&&o.line&&B.LE(o)&&(e=p.F$a(c,d,!1,t.LEFT_TOP),f=p.F$a(c,d,!0,t.RIGHT_TOP),g=B.LE(e),h=B.LE(f),i=p.F$a(c-1,d,!1,t.RIGHT_BOTTOM),j=p.F$a(c-1,d,!0,t.LEFT_BOTTOM),k=B.LE(i),l=B.LE(j),e&&g&&(m={CE:2,_orientation:0,pE:2},o.line.mE(m)),f&&h&&(m={CE:2,_orientation:0,nE:-2},o.line.mE(m)),i&&k&&(m={CE:1,_orientation:0,nE:-2},o.line.mE(m)),j&&l&&(m={CE:1,_orientation:0,pE:2},o.line.mE(m))))},a.prototype.vF=function(a,b,c,d){var e,f=d[a];return f||(f=d[a]={}),e=f[b],e===h&&(e=f[b]=this.wF(a,b,c)),e},a.prototype.wF=function(a,b,c){var d,e,f;if(a===h||a<0||b===h||b<0)return i;if(d=this,e=c?d.fF:d.eF,f=d.pF(a,b,e,!0),f)return f;if(e=c?d.dF:d.cF,c){if(--b,b<0)return i}else if(--a,a<0)return i;return f=d.pF(a,b,e,!0),f?f:i},a.prototype.paint=function(a){var b=this;b.UE&&(b.VE||(b.D$a(),b.rF(),b.qF(),b.mE(),b.VE=!0),a.save(),b.jp(a),a.restore())},a.prototype.jp=function(a){this.xF(a),this.yF(a)},a.prototype.xF=function(a){var b=this;b._d(a,b.cF),b._d(a,b.dF)},a.prototype.yF=function(a){var b=this;b._d(a,b.eF),b._d(a,b.fF),b._d(a,b.lWa),b._d(a,b.mWa)},a.prototype._d=function(a,b){var c,d,e,f,g,h;for(c in b)if(b[c]){e=b[c];for(d in e)if(e[d])if(f=e[d].line,g=e[d].splitLines,g&&g.length>0)for(h=0;h<g.length;h++)g[h]&&g[h].jp(a);else f&&f.jp(a)}},a}(),b.AF=C},"./dist/core/worksheet/worksheet-edit.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/util/domUtil.js"),h=g.GC$,i=c("Common"),j=c("./dist/core/core.enum.js"),k=c("@grapecity/js-calc"),l=!!k,m=f.Ul.Ml,n=f.Ul.rl(),o=i.Common.j.Fa,p=i.Common.u,q=i.Common.CultureManager,r=null,s=void 0,t="string",u=f.Ul.K_a,v=new i.Common.ResourceManager(d.SR,"Sheets"),w=v.getResource.bind(v),x="=",y={startEdit:function(a,b){var c=this;c.EF(c.Ws(),c.Jl,c.Kl,r,r,a,b)},editorStatus:function(){return this.Px||0},isEditing:function(){var a=this.Px;return 1===a||2===a},endEdit:function(a){return this.gv(a)},gv:function(a,b,c,d){var e,f,g,h,i=this;if(!i.isEditing())return!0;i.suspendPaint();try{return e=i.Jl,f=i.Kl,g=j.SheetArea.viewport,h=i._ZJ,h&&(e=h.row,f=h.col,g=h.sheetArea,i._ZJ=s),i.Yoa(e,f,g,a,b,c,d)}finally{i.resumePaint()}},Yoa:function(a,b,c,d,g,i,k){var l,n,p,q,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;if(void 0===c&&(c=j.SheetArea.viewport),l=this,n=l.mm,p=l.BF,q=l.name(),t=a,u=b,x=l.getCellType(t,u,c),y={sheet:l,row:t,col:u,sheetArea:c},x.isImeAware(y)||n.Qq(),p&&p.parentNode){if(w=x.getEditorValue(p,y),z={sheet:l,sheetName:q,row:t,col:u,editor:p,editingText:w,cancel:!1,committed:!d},l.Wq(f.Events.EditEnd,z),z.cancel&&!k)return;if(l.Wq(f.Events.EditEnding,z),z.cancel&&!k)return;if(A=l.parent,B=A&&A.CF,document.activeElement===(B&&B.qo)&&n.Qq(),t>=0&&u>=0&&(C=p.Ep,D=l.getFormulaInformation&&l.getFormulaInformation(t,u,3),x.isEditingValueChanged(C,w,y)||1===g||D&&D.isArrayFormula&&1!==g))if(d)x.setEditorValue(p,C,y),x.selectAll(p,y);else if(E=x.DF,o(E)&&(E=!0),F={cmd:"editCell",sheetName:q,row:t,col:u,sheetArea:c,newValue:w,autoFormat:E,editingFormatter:p.oja},1===g&&(F.ranges=[l.Ix()],F.endEditType=g),null===w||d||(G=l.tables&&l.tables.find&&(l.tables.find(t-1,u)||l.tables.find(t,u-1)),G&&l.tables.jIb(r,new f.Range(t,u,1,1),null,w,!0)),l.wu().execute(F),v=F.applyResult,2===v&&(x.focus(p,y),!k))return!1;if(l.$l=!0,H=c===j.SheetArea.colHeader?-1:s,I=c===j.SheetArea.rowHeader?-1:s,x.XBb(p,y,l.getCellRect(t,u,H,I)),x.isImeAware(y))m.msie&&9===parseFloat(m.version)?n.Qq():h(p.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(J=l.zo(),K=p;K;)K.parentNode===J?J.removeChild(K):K=K.parentNode}return l.Ll=!1,L={sheet:l,sheetName:q,row:t,col:u,editingText:w,ignoreValueChange:d,sheetArea:c,committed:!d},M=h.extend({},L),l.Wq(f.Events.EditEnded,L),l.Wq(f.Events.FormulaTextboxEditEnded,M),!(i!==!0&&M.ignore&&!k)&&(0!==l.Px&&(N=l.Px,l.Px=0,l.Cu(N,0)),l.ITa.setCellState(t,u,j.CellStatesType.edit,!1,c),e.Worksheet.ao(l,"endEdit"),l.BF=r,1!==v)},FF:function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=l.hitTest(b,c);!m||m.cellTypeHitInfo&&(m.cellTypeHitInfo.outlineColumnHitInfo||m.cellTypeHitInfo.cellButtonHitInfo)||(d=m.row,e=m.col,d>=0&&e>=0&&m.rowViewportIndex>=0&&m.colViewportIndex>=0&&!m.resizeInfo&&!m.dragInfo&&d===l.Jl&&e===l.Kl&&(f=l.isEditing(),l.EF(a,d,e),!f&&l.isEditing()&&(g=m.hitTestType,h=l.getCellType(d,e),h.tw&&(i=l.getCellRect(d,e,1===g?-1:s,2===g?-1:s),j=l.getActualStyle(d,e,g),k=h.h5(b,c,j,i,{sheet:l,row:d,col:e,sheetArea:g}),k&&k.isReservedLocation&&h.tw(l,d,e,3)))))},inputFormulaAndSelectFormulaRange:function(a,b,c,d){var g,h,i,j,k,l=this,m=l.options,n=l.getCellRect(a,b),o=l.getActualStyle(a,b),p=l.getCellType(a,b),q=l.mm;q.zt(),g={sheet:l,row:a,col:b,sheetArea:3},h=q.GF,h&&h.firstChild&&(i=h.firstChild.firstChild),i&&(l.BF=i,j=l.am(),p.isImeAware(g)&&q.JF(),p.d5(h,o,n,g),l.KF(p,i,a,b,o,s,s,s,s,3),p.g5(h,o,n,g),m.allowCellOverflow&&(k=n.clone(),k.y-=2,k.height+=4,k.x=j.kt,k.width=l.wNc(j),l.repaint(k)),e.Worksheet.ao(l,"startEdit",{element:p.getEditingElement(),row:a,col:b,sheetArea:3}),l.Px=2,l.Cw.text(d),l.Cw.caret(d.length-1),c&&l.Cw.nIb(3,4),l.Cw.S1(),f.Vl.Zl(l))},EF:function(a,b,c,d,g,i,k,p,s){var t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$;if(h[h.sd]({tc:this.parent}),!(b<0||c<0||(t=this,u=t.name(),v=t.options,t.isEditing()))){if(w=t.sr(d,g),o(w)&&(w=3),x=t.ITa,x.setCellState(b,c,j.CellStatesType.edit,!0,w),y=t.getActualStyle(b,c,w),v.isProtected&&y.locked!==!1)return x.setCellState(b,c,j.CellStatesType.edit,!1,w),void t.Os(13,t.k9J());if(z=t.getCellType(b,c,w),!z)return void x.setCellState(b,c,j.CellStatesType.edit,!1,w);if(A=!0,B={row:b,col:c,sheetArea:w,isAllow:A},e.Worksheet.ao(t,"allowStartEdit",B),!B.isAllow)return void x.setCellState(b,c,j.CellStatesType.edit,!1,w);if(C=t.mm,C.zt(),D={sheet:t,row:b,col:c,sheetArea:w},
E=z.isImeAware(D)?C.GF:z.a5(D),E&&E.firstChild&&(F=E.firstChild.firstChild),!F)return void x.setCellState(b,c,j.CellStatesType.edit,!1,w);if(G=y,H=!1,J=q.culture(),(G.formatter&&f.util.KIc(G.formatter,J)||G._autoFormatter&&G._autoFormatter.formatCached&&f.util.KIc(G._autoFormatter,J))&&(s&&s.key&&(K=s.key,L=s.code,s&&K&&f.NUMBER_ARRAY.indexOf(K)!==-1&&(H=!0),"+"!==K&&"-"!==K||(z.probabilityAddPercent=!0),"process"===K.toLowerCase()&&(!s.shiftKey&&L.length-L.replace(/[0-9]/,"").length>0&&(H=!0),!s.shiftKey&&(L.length-L.replace("Minus","").length>0||L.length-L.replace("Subtract","").length>0||L.length-L.replace("Add","").length>0)&&(z.probabilityAddPercentSpec=!0),s.shiftKey&&L.length-L.replace("Equal","").length>0&&(z.probabilityAddPercentSpec=!0))),M=E.innerText,m.msie&&(M=M.replace("\r\n","")),N=q.q4(q.culture()).NumberFormat.numberDecimalSeparator,O=RegExp("^[-]?[0-9]+(\\"+N+"[0-9]+)?$"),!s&&M&&O.test(M)&&(I=!0)),t.BF=F,P={sheet:t,sheetName:u,row:b,col:c,cancel:!1},t.Wq(f.Events.EditStarting,P),P.cancel)return n.ipad&&C.Qq(),void x.setCellState(b,c,j.CellStatesType.edit,!1,w);t._ZJ={row:b,col:c,sheetArea:w},3===w&&t.showCell(b,c,3,3),t.mIb=!0,Q=t.getValue(b,c,w),R=l&&t.getFormula(b,c,w),S=t.Px,t.HF?t.Px=1:o(Q)&&o(R)?t.Px=1:t.Px=2,t.Cu(S,t.Px),T=t.am(),U=t.getCellRect(b,c,d,g),!U||o(U.width)||o(U.height)||o(U.x)||o(U.y)||U.width<=0||U.height<=0||(z.isImeAware(D)&&C.JF(),z.d5(E,y,U,D),t.KF(z,F,b,c,y,k,p,H,I,w),V=t.zo(),z.isImeAware(D)||V.insertBefore(E,r),delete t.mIb,z.g5(E,y,U,D),z.isImeAware(D)&&i||z.focus(F,D),v.allowCellOverflow&&(W=U.clone(),W.y-=2,W.height+=4,t.XCJ&&t.XCJ.isEnable(j.RowColumnStates.edit,!1)&&(W.y=T.nt,W.height=T.jr),W.x=T.kt,W.width=t.wNc(T),t.repaint(W)),e.Worksheet.ao(t,"startEdit",{element:z.getEditingElement(),row:b,col:c,sheetArea:w}),!H&&i&&z.selectAll(F,D),H&&(X=window.getSelection(),Y=document.createRange(),Y.setStart(F,0),X.removeAllRanges(),X.addRange(Y)),I&&(X=window.getSelection(),Z=document.createElement("span"),Z.innerText="%",Y=document.createRange(),t.parent.options.enableFormulaTextbox&&t.parent.options.allowUserEditFormula?(F.firstChild.appendChild(Z),Y.setStart(F.firstChild,1),t.Cw&&t.Cw.kOJ()):(F.appendChild(Z),Y.setStart(F,1)),X.removeAllRanges(),X.addRange(Y)),f.Vl.Zl(t),$={sheet:t,sheetName:u,row:b,col:c,sheetArea:w},t.Wq(f.Events.EditStarted,$),t.Wq(f.Events.FormulaTextboxEditStarted,$))}},KF:function(a,b,c,d,e,g,h,i,j,k){var m,n,p,q,r,s,t,v,w,x,y=this,z=l&&y.getFormula(c,d,k,!0);z&&(z="="+z),m=z,n={sheet:y,row:c,col:d,sheetArea:k,isImeInput:h},z&&0!==z.length||(z=y.getValue(c,d,k,1),z&&z.richText&&(z=u(z)),p=y.parent,q=l&&p&&p.options.allowUserEditFormula,r=l&&p&&p.options.allowInvalidFormula,f.util.PaK(z,e.quotePrefix,q,r)?(z="'"+z,m=z):(m=z,z=a.kp(b,e,z,n))),b.Ep=z,o(g)||(z=g),j&&z&&(z=this.XBJ(z,e)),a.setEditorValue(b,z,n,i),y.parent&&y.parent.options.enableAccessibility&&(s=z&&"="===z[0],t=y.getText(c,d,k),v=s?z:y.getFormula(c,d,k),w=3===k&&y.comments&&y.comments.get(c,d),x=y.uSJ(c,d,t,v,w&&w.text()),b.setAttribute("aria-label",x)),b.LF=m},eSJ:function(a){var b="",c=a&&(a.formatter||a._autoFormatter);return c&&(b=typeof c===t?c:c.formatCached),b},XBJ:function(a,b){var c,d,e,f,g,h,i,j,k=q.q4(q.culture()).NumberFormat,l=k.negativeSign,m=k.numberDecimalSeparator,n=this.eSJ(b),o="%"===n[0],p=n.split(";");if(o?c=p[0].split("%")[1].split(".")[1]:p[0].indexOf("%")>-1&&(c="00"),void 0===c&&(c=""),a.split("e").length>1)return d=a.split("e")[0],e=a.split("e")[1],d+"e+"+(parseInt(e.split("+")[1],10)+2);if(a.split(m).length>1){for(f=!1,a.charAt(0)===l&&(a=a.substr(1,a.length-1),f=!0),a+=c,g=a.indexOf(m),a=a.split(m).join(""),a=a.substr(0,g+2)+m+a.substr(g+2,a.length-1),h=a.split(m),i=h[0],j=h[1];i&&"0"===i.charAt(0);)i=i.substr(1,i.length-1);for(;j&&"0"===j.charAt(j.length-1);)j=j.substr(0,j.length-1);return f&&i&&(i=l+i),i&&j?i+m+j:!i&&j?(f?l+"0"+m:"0"+m)+j:i&&!j?i:"0"}return"0"===a?a:a+c}},h.extend(e.Worksheet.prototype,y)},"./dist/core/worksheet/worksheet-event.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/worksheet/worksheet.js"),f=c("Common"),g=c("./dist/core/worksheet/worksheet-model.js"),h=c("./dist/core/util/domUtil.js"),i=c("./dist/core/util/common.js"),j=c("./dist/core/core.enum.js"),k=c("./dist/core/workbook/sheettabbase.js"),l=window,m=document,n=h.GC$.each,o=i.Ul.Ml,p=i.Ul.rl(),q=i.Ul.nl,r=i.Ul.Nl,s=f.Common.u,t=f.Common.u.Kb,u=i.kf,v=f.Common.j.Fa,w={pIb:".handler"},x="mousedown"+w.pIb,y="mouseup"+w.pIb,z="mousemove"+w.pIb,A="mousewheel"+w.pIb,B="DOMMouseScroll"+w.pIb,C="wheel"+w.pIb,D="mouseout"+w.pIb,E="dblclick"+w.pIb,F=null,G=void 0,H=isNaN,I=parseInt,J=Math.max,K=Math.floor,L=Math.min,M=Math.abs,N=Math.ceil,O="function",P="position",Q="absolute",R="border",S="overflow",T="top",U="left",V="width",W="height",X="resize",Y="hidden",Z="visible",$="none",_="tabindex",aa="gcUIElement",ba="corner",ca="sizeHiddenRow",da="sizeRow",ea="sizeCol",fa="sizeHiddenCol",ga="default",ha=p.iphone||p.ipad||p.android;function na(a,b){var c,d=[b,b];return a<3*b&&(2===a?d=[1,0]:1===a?d=[0,0]:(c=K(a/3),d=[c,c])),d}ia=new f.Common.ResourceManager(d.SR,"Sheets"),ja=ia.getResource.bind(ia),ka=30;function oa(a,b){var c=3;return wa(b)<0&&(c=1),xa(b)<0&&(c=2),!(3===c||!a.vp(b.row,b.col,c,!0))}function pa(a,b,c){var d,e,f,g,h,k,l,m,n,o=!1,p=a.am();return b&&(d=wa(b),e=xa(b),f=e<0&&b.col>=a.getFreeAreaColumnCount(j.SheetArea.rowHeader),g=d<0&&b.row>=a.getFreeAreaRowCount(j.SheetArea.colHeader),(f||g)&&(h=a.getCellRect(b.row,b.col,d,e,!0),h&&h.width>0&&h.height>0&&(k=p.x,l=p.y,(h.x<p.Br+k||h.y<p.Cr+l||h.y>=p.height-p.Bt)&&(m=new i.Rect(h.x-2,h.y-2,h.width+4,h.height+4),n=void 0,n=d<0&&e<0?p.em():d<0?p.gm(e):p.fm(d),m=m.getIntersectRect(n),c.VF(m.x,m.y,m.width,m.height),o=oa(a,b))))),o}function qa(a){return a.isEditing()}function ra(a){return a.endEdit()}function sa(a){return a.frozenRowCount()}function ta(a){return a.frozenColumnCount()}function ua(a,b){return a.getRowCount(b)}function va(a,b){return a.getColumnCount(b)}function wa(a){return a.rowViewportIndex}function xa(a){return a.colViewportIndex}function ya(a){return a.hitTestType}function za(a){return a.getActiveRowIndex()}function Aa(a){return a.getActiveColumnIndex()}function Ba(a){return a.keyCode}function Ca(a){return a.ctrlKey}function Da(a){return a.shiftKey}function Ea(a){return a.altKey}function Fa(a){return a.metaKey}function Ga(a){return a.colCount}function Ha(a){return a.rowCount}function Ia(a,b,c){return{action:a,index:b,sheetArea:c}}function Ja(a,b,c){return F===b.Zq(a,c,!0)}function Ka(a,b,c){return F===b._q(a,c,!0)}function La(a,b){return b?a.CVJ?a.startY-a.movingY:a.movingY-a.startY:a.DVJ?a.startX-a.movingX:a.movingX-a.startX}function Ma(a,b,c,d,e,f){var g={sheet:a,sheetName:b,sheetArea:e,row:c,col:d};return f&&(g.cancel=!1),g}function Na(a,b,c,d,e,f){var g=a.kj,h=Ma(g,g.name(),g.Jl,g.Kl,G,!0);return g.Wq(i.Events.LeaveCell,h),!(!h||h.cancel!==!0)||(g.Kr(b,c,d,e,f),g.Wq(i.Events.EnterCell,Ma(g,g.name(),b,c)),g.Wq(i.Events.FormulaTextboxEnterCell,Ma(g,g.name(),b,c)),void(a.cs&&a.cs(b,c)))}function Oa(a,b,c,d,e,f,g){var h,i=a.kj,j=b.call(i,f.sheetArea);return(g&&!i.getRowVisible(f.index,f.sheetArea)||!g&&!i.getColumnVisible(f.index,f.sheetArea))&&(f.index=c.call(a,f.index,f.sheetArea)),h=d.call(j,f.index),h||(h=d.call(j,e)),h}function Pa(a,b,c,d,e){var f,g,h,i=d?"movingY":"movingX",j=d?"startY":"startX";a[i]=b,f=a.DVJ||a.CVJ?a[i]>a[j]:a[i]<a[j],f&&(a[i]=a[j]),g=d?c.y+c.height:c.x+c.width,h=d?a.WUJ:a.XUJ,a[i]>g&&!h&&(a[i]=g),e!==F&&a[i]>a[j]+e&&(a[i]=a[j]+e)}function Qa(a,b){var c=a.am();return sa(a)>0&&b<c.nt+c.fs?0:a.frozenTrailingRowCount()>0&&b>c.ot?2:1}function Ra(a,b){var c=a.am();return ta(a)>0&&b<c.kt+c.hs?0:a.frozenTrailingColumnCount()>0&&b>c.lt?2:1}function Sa(a,b,c){var d=a.Gr(b);return d?d.findNearY(c):F}function Ta(a,b){var c=a.Gr(-1,j.SheetArea.colHeader);return c?c.findNearY(b):F}function Ua(a,b,c){var d=a.Hr(b);return d?d.findNearX(c):F}function Va(a,b){var c=a.Hr(-1,j.SheetArea.rowHeader);return c?c.findNearX(b):F}function Wa(a){return!a.options.isProtected||a.options.protectionOptions.allowResizeRows}function Xa(a){return!a.options.isProtected||a.options.protectionOptions.allowResizeColumns}function Ya(a,b){var c=b.row,d=b.rowCount,e=b.col,f=b.colCount,g=a.getColumnCount(),h=a.getRowCount();return f+e>g&&(f=g-e),d+c>h&&(d=h-c),{row:c,col:e,rowCount:d,colCount:f}}function Za(a,b){var c,d=a.getViewportBottomRow(a.Er(b));if(d===-1&&(d=a.ir()),b<d)for(c=d;c>b;c--)if(0!==a.getRowHeight(c))return!1;return!0}function $a(a){var b,c,d=a.ITa.getSelections();if(d.length>0)return b=0,c=a.getRowCount(),d.every(function(d){var e,f,g=Ya(a,d),h=!1;return 1===g.rowCount&&(b+=1,h=b<=1),e=g.row<c,f=g.col!==-1,f||h&&e})}function _a(a,b,c){var d=a.parent,e=d.options.rowResizeMode;return c&&0===e&&(e=1),b.action!==ca&&1===e&&(!Za(a,b.index)&&(!(!a.getRowResizable(b.index,b.sheetArea)||!a.getRowResizable(b.index+1,b.sheetArea))&&$a(a)))}function ab(a,b,c,d){return _a(a,b,d)&&1===c.length&&c[0].firstRow===c[0].lastRow}function bb(a,b){var c,d=a.getViewportRightColumn(a.Fr(b));if(d===-1&&(d=a.dr()),b<d)for(c=d;c>b;c--)if(0!==a.getColumnWidth(c))return!1;return!0}function cb(a){var b,c,d=a.ITa.getSelections();if(d.length>0)return b=0,c=a.getColumnCount(),d.every(function(d){var e,f,g=Ya(a,d),h=!1;return 1===g.colCount&&(b+=1,h=b<=1),e=g.col<c,f=g.row!==-1,f||h&&e})}function db(a,b,c){var d=a.parent,e=d.options.columnResizeMode;return c&&0===e&&(e=1),b.action!==fa&&1===e&&(!bb(a,b.index)&&(!(!a.getColumnResizable(b.index,b.sheetArea)||!a.getColumnResizable(b.index+1,b.sheetArea))&&cb(a)))}function eb(a,b,c,d){return db(a,b,d)&&1===c.length&&c[0].firstColumn===c[0].lastColumn}function fb(a,b,c,d,e){var f,g,h=b.index,i=a.am();_a(a,b,e)?(f=a._q(h,c),g=a.Sl(h,c)+a.Sl(f,c),Pa(b,d,i,!0,g)):Pa(b,d,i,!0)}function gb(a,b,c,d,e){var f,g,h=b.index,i=a.am();db(a,b,e)?(f=a.Zq(h,c),g=a.Tl(h,c)+a.Tl(f,c),Pa(b,d,i,!1,g)):Pa(b,d,i,!1)}function hb(a,b,c){var d,e,f,g,h=c?a.frozenRowCount():a.frozenColumnCount(),i=c?a.lq:a.qq,j=!1,k=i-1;if(h>0&&h<i)for(e=i-1;e>=h;){if(d=c?a.getRowVisible(e):a.getColumnVisible(e)){if(f=c?a.getRowHeight(e):a.getColumnWidth(e),e===k&&0===f)break;if(f>0){j=!0;break}}else k--;e--}for(g=j?h:b,g--;g>=0;){if(d=c?a.getRowVisible(g):a.getColumnVisible(g))return g;g--}return-1}function ib(a){var b=a.Cw;return b&&b.d$J}function jb(a){for(;a!==m.body;){var b=getComputedStyle(a).transform;if(b.match(/matrix\([^\)]+\)/))return!0;if(!a.parentNode)break;a=a.parentNode}return!1}la=function(){function a(a){var b=this;b.qo=a,b.jI=F,b.kI=F,b.lI=F,b.Fi=F,b.mI=!1,b.nI=!1}return a.prototype.tG=function(a){typeof a===O&&(this.kI=a)},a.prototype.PG=function(a){var b,c=this;H(a)||0===a?c.SG():(c.nI=a>0,a=M(a),b=c.jI,c.jI=a,b!==a&&c.oI())},a.prototype.oI=function(){var a=this;a.$b(),H(a.jI)||(a.lI=l.setInterval(function(){a.pI()},a.jI))},a.prototype.pI=function(){var a=this,b=a.kI;a.mI=!0,typeof b===O&&(a.Fi=b.call(a.qo,a.nI))},a.prototype.SG=function(){var a=this;a.$b(),a.jI=F,a.lI=F,a.Fi=F,a.mI=!1},a.prototype.$b=function(){var a=this.lI;a&&clearInterval(a)},a.prototype.no=function(){this.SG()},a}(),ma=function(){function a(a){this.qIb=0;var b=this;b.WF=0,b.XF=!1,b.Gma=!1,b.gA={},b.kj=a,b.rIb="gcEvent"+a._id}return a.prototype.no=function(){var a=this;a.YF&&a.YF.no(),a.ZF&&a.ZF.no(),a.$F=F},a.prototype._F=function(){var a=this;return a.YF||(a.YF=new la(a)),a.YF},a.prototype.aG=function(){var a=this;return a.ZF||(a.ZF=new la(a)),a.ZF},a.prototype.Vs=function(){return this.kj.Vs()},a.prototype.bG=function(){var a=h.GC$(this.kj.Ws()).position();return a||(a={top:0,left:0}),a},a.prototype.AD=function(a){var b,c,d,e,f,g,h,j,k,l,m=i.Ul.sl(),n=Ca(a),p=m&&n===!0&&0===a.button;return!(2!==a.button&&!p)||(b=this,c=b.kj,b.tC(),o&&o.msie&&a.offsetX!==G&&a.offsetY!==G&&(d=0,e=0,f=c.Xs,a.target!==f&&(g=i.Ul.Z3(a.target,f),d=g.EB,e=g.FB),f&&(h=a.pageX-(a.offsetX+d),j=a.pageY-(a.offsetY+e),f.canvasOffset={top:j,left:h})),k=c.Vs(),l=b.cG(a,a.pageX-k.left,a.pageY-k.top),qa(c)||l||b.zt(),c.dG=!0,!1)},a.prototype.tC=function(){var a=this;a.RB||(h.GC$(m).bind("mousemove.gcSheet."+a.rIb,function(b){a.BD(b)}).bind("mouseup.gcSheet."+a.rIb,function(b){a.CD(b)}),a.RB=!0)},a.prototype.uC=function(){this.RB&&(this.RB=!1,h.GC$(m).unbind("mousemove.gcSheet."+this.rIb).unbind("mouseup.gcSheet."+this.rIb))},a.prototype.cG=function(a,b,c){var d,f,g,h,j,k,l,m,n,o,p,q=this,r=q.kj,s=r.hitTest(b,c),t=s.row,u=s.col,w=s.dragInfo,x=s.formulaRangeHitInfo,y=s.cellTypeHitInfo,z=s.resizeTableHitInfo,A={hitInfo:s,e:a,r:F};if(e.Worksheet.ao(r,"processMouseDown",A),d=r.am(),b>=d.x&&c>=d.y){if(r.yt=s,A.r)return;if(q.eG=!0,s.tableSelectInfo&&!r.Cw)q.sIb(s,r);else if(s.resizeInfo){if(!ib(r)&&!ra(r))return;q.fG(s)}else if(s.dragMergeInfo){if(!ra(r))return;q.Zia&&q.Zia(s)}else if(w&&w.side&&w.side!==ba){if(!ra(r))return;q.gG&&q.gG(s),q.lG(a)}else if(w&&w.side===ba){if(!ra(r))return;q.hG&&q.hG(s)}else if(s.filterButtonHitInfo)ra(r);else if(x)x.inBorder?q.iG(s):(x.inTopLeft||x.inTopRight||x.inBottomLeft||x.inBottomRight)&&q.jG(s);else if(z)q.tIb&&q.tIb(s);else if(r.Qs(wa(s)<0?-1:t,xa(s)<0?-1:u)){if(s.tableSelectInfo&&r.Cw&&(f=r.Cw,g=this.uIb(s,r),s.tableSelectInfo.tableSelection=g,f.vIb(g)),q.n8J&&q.n8J(r,s))return;if(h=za(r),j=Aa(r),y){if(k=r.getCellType(y.row,y.col,ya(s)),y.sheet||(y.sheet=r),q.Sia(k,y)&&(l=y.sheetArea,(v(l)||3===l)&&(t!==h||u!==j))){r.suspendPaint();try{if(!ra(r))return;if(m=Ma(r,r.name(),h,j,G,!0),r.Wq(i.Events.LeaveCell,m),m&&m.cancel===!0)return;n=r.ITa.getSelections(),o=r.ITa.getSpan(t,u),p=[new i.Range(o.row,o.col,o.rowCount,o.colCount)],r.Wq(i.Events.FloatingElementSelected,{type:"worksheet"}),r.yu(n,p),r.Sr(t,u,G,G,1),r.Wq(i.Events.EnterCell,Ma(r,r.name(),t,u)),r.Wq(i.Events.FormulaTextboxEnterCell,Ma(r,r.name(),t,u)),r.Au(n),r.Uja=!0,q.cs&&q.cs(t,u)}finally{r.resumePaint()}}k.processCellAndPaddingMouseDown(y)}if(y&&y.isReservedLocation)return!0;q.lG(a),q.Ala(r,s,t,u)}}},a.prototype.Ala=function(a,b,c,d){var e,f,g=this;try{if(g.mG=b,qa(a)&&!ra(a))return}finally{g.mG=F}v(c)||v(d)||(3===ya(b)&&g.cs&&g.cs(c,d),a.Wq(i.Events.FloatingElementSelected,{type:"worksheet"}),e=a.ITa.getSelections(),g.nG(b,e),f=a.ITa.getSelections(),a.yu(e,f))},a.prototype.Sia=function(a,b){return a&&b&&b.isReservedLocation&&(!a.activeOnClick||a.activeOnClick())},a.prototype.oG=function(a){var b,c=this.kj;return!c||(b=c.am(),v(a.x)||v(a.y)||v(a.width)||v(a.height)||a.x+a.width>b.pt+c.wNc(b)+b.js||a.y+a.height>b.qt+c.tNc(b)+b.gs)},a.prototype.pG=function(a,b,c,d,e){var f,g,i,j,k,l,m,n,o=this.kj;for(g=0,i=a.options,j=i.length;g<j;g++)if(k=i[g],k.selected){f=d[g].value;break}l=!1,o.options.isProtected&&(m=o.getActualStyle(b,c),m&&(l=m.locked)),f===G||l||(n={cmd:"editCell",sheetName:o.name(),row:b,col:c,newValue:f,autoFormat:!0,ignoreFormatting:e},o.wu().execute(n)),h.GC$(a).hide()},a.prototype.qG=function(){var a,b=this;b.rG&&(a=b.rG.sG,3!==a&&2!==a||b.aG().tG(b.uG),3!==a&&1!==a||b._F().tG(b.vG))},a.prototype.wG=function(){var a=this;a.xG&&a.yG(),a.$ia&&a._ia&&a._ia(),a.zG&&a.AG&&a.AG(),a.BG&&a.CG&&a.CG(),a.DG&&a.EG(),a.FG&&a.GG(),a.HG&&a.IG(),a.wIb&&a.xIb&&a.xIb()},a.prototype.uG=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.JG();k||(b=j.rG,c=j.kj,d=b.KG,e=c.getViewportTopRow(d),f=c.getViewportBottomRow(d),a?f<ua(c)-c.frozenTrailingRowCount()-1?c.mq(c._q(e)):(g=c.Gr(d),g&&g.length>0&&(h=c.am(),i=g[g.length-1],i.y+i.height>=h.qt+c.tNc(h)&&c.mq(c._q(e)))):e>sa(c)&&c.mq(c.gr(e))),j.wG()},a.prototype.vG=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.LG();k||(b=j.kj,c=j.rG,d=c.MG,e=b.getViewportLeftColumn(d),f=b.getViewportRightColumn(d),a?f<va(b)-b.frozenTrailingColumnCount()-1?b.rq(b.Zq(e)):(g=b.Hr(d),g&&g.length>0&&(h=b.am(),i=g[g.length-1],i.x+i.width>=h.pt+b.wNc(h)&&b.rq(b.Zq(e)))):e>ta(b)&&b.rq(b.br(e))),j.wG()},a.prototype.JG=function(){var a,b,c,d,e,f,g=this.kj,h=g.am(),i=sa(g),j=g.frozenTrailingRowCount(),k=this.$F,l=this.rG,m=l.KG;if(0===m){if(k.y>h.qt)return g.mq(g._t()),l.KG=1,!0}else if(1===m){if(a=g.Gr(1),a&&a.length>0){if(b=a[0],i>0&&k.y<h.qt&&b.row<=g._t())return l.KG=0,!0;if(b=a[a.length-1],j>0&&k.y>h.ot&&b.row>=g.ir()&&b.y+b.height<=h.ot)return l.KG=2,!0}}else if(2===m&&(a=g.Gr(1),a&&a.length>0&&k.y<h.ot)){if(b=a[a.length-1],b.y+b.height>h.ot){for(c=g.tNc(h),d=ua(g)-j-1,e=0,f=d;f>=i;f--)if(e+=g.Sl(f),e>c){d=L(f+1,d);break}g.mq(g._q(d-1))}return l.KG=1,!0}return!1},a.prototype.LG=function(){var a,b,c,d,e,f,g=this.kj,h=g.frozenTrailingColumnCount(),i=ta(g),j=g.am(),k=this.$F,l=this.rG,m=l.MG;if(0===m){if(k.x>j.pt)return g.rq(g.$t()),l.MG=1,!0}else if(1===m){if(a=g.Hr(1),a&&a.length>0){if(b=a[0],i>0&&k.x<j.pt&&b.col<=g.$t())return l.MG=0,!0;if(b=a[a.length-1],h>0&&k.x>j.lt&&b.col>=g.dr()&&b.x+b.width<=j.lt)return l.MG=2,!0}}else if(2===m&&(a=g.Hr(1),a&&a.length>0&&k.x<j.lt)){if(b=a[a.length-1],b.x+b.width>j.lt){for(c=g.wNc(j),d=va(g)-h-1,e=0,f=d;f>=i;f--)if(e+=g.Tl(f),e>c){d=L(f+1,d);break}g.rq(g.Zq(d-1))}return l.MG=1,!0}return!1},a.prototype.NG=function(){var a,b,c,d,e,f,g,h,i,k,l,m,n,o,p=this;(p.OG||p.O3||p.lV)&&(a=p.kj,b=a.am(),c=p.rG,v(c)||(d=c.KG,e=c.MG,f=p.$F,g=F,d>=0&&e>=0?(g=b.Ft(d,e),0===d&&a.lq===a.frozenRowCount()&&(h=b.Ft(1,e),g.height+=h.height),0===e&&a.qq===a.frozenColumnCount()&&(h=b.Ft(d,1),g.width+=h.width)):d>=0?g=b.fm(d):e>=0&&(g=b.gm(e)),g&&(i=a.parent,k=i&&i.options.scrollbarAppearance===j.ScrollbarAppearance.mobile,l=0,m=0,n=!1,o=!1,f.x<=g.x?(l=f.x-g.x,k&&(o=!0)):f.x>=g.x+g.width?(l=f.x-(g.x+g.width),0===l&&(l=50),k&&(o=!0)):k&&f.x===g.x+g.width-1&&(l=50,o=!0),f.y<=g.y?(m=f.y-g.y,k&&(n=!0)):f.y>=g.y+g.height&&(m=f.y-(g.y+g.height),k&&(n=!0)),i&&k&&(n&&(i.VJc.Jwa(j.ScrollbarState.show),i.ku.Rec(!0)),o&&(i.UJc.Jwa(j.ScrollbarState.show),i.ku.Rec(!1))),p._F().PG(p.QG(l)),p.aG().PG(p.QG(m)))))},a.prototype.RG=function(){this._F().SG(),this.aG().SG()},a.prototype.fG=function(a){var b,c,d,e,f,h,i=this,j=g.yp.prototype,k=i.kj,l=a.resizeInfo;l.action===da||l.action===ca?(b=Oa(i,k.Jt,i.TG,j.findRow,a.row,l,!0),l.startY=b.y+(l.CVJ?b.height:0)):(c=Oa(i,k.Kt,i.UG,j.findCol,a.col,l,!1),l.startX=c.x+(l.DVJ?c.width:0)),d=k.parent,e=a.x,f=a.y,d&&(h=d.options.showResizeTip,(1!==h||l.action!==ea&&l.action!==fa)&&(2!==h||l.action!==da&&l.action!==ca)&&3!==h||(f-ka<0?f+=ka/2:f-=ka,d.uw(s.Ob(i.VG()),e,f))),i.isResizing=!0,i.OG=!0,i.ctrl&&(i.fCb=!0)},a.prototype.WG=function(){var a,b,c,d=this,e=d.kj,f=e.yt,g=f.resizeInfo,h=d.$F,i=h.x,j=h.y,k=e.am(),l=e.parent,m=g.sheetArea;g&&d.OG&&d.isResizing&&(f.x===i&&f.y===j||(g.action===da||g.action===ca?fb(e,g,m,j,d.fCb):gb(e,g,m,i,d.fCb),a=e.yl,b=a.bm(),a.Mx(k.x,k.y,k.width,k.height),a.Pw(b),l&&(c=l.options.showResizeTip,(1!==c||g.action!==ea&&g.action!==fa)&&(2!==c||g.action!==da&&g.action!==ca)&&3!==c||l.ww(d.XG(g)))))},a.prototype.YG=function(){var a,b,c,d,e,f,g,i,j,k,l,m,n=this;n.isResizing=!1,n.OG=!1,a=!0,b=n.kj,c=b.yt,d=c.resizeInfo,d&&(n.xw(),d.action===da||d.action===ca?v(d.movingY)?a=!1:(e=J(0,La(d,!0)/b.zoom()),f=[],g="resizeRow",b.tp(d.index)?h.GC$.each(b.ITa.getSelections(),function(a,c){if(c.col===-1)if(1===d.sheetArea)f.push({firstRow:d.index,lastRow:d.index});else{var e=b.Tq(c);f.push({firstRow:e.row,lastRow:e.row+Ha(e)-1})}}):f.push({firstRow:d.index,lastRow:d.index}),ab(b,d,f,n.fCb)&&(g="splitResizeRow"),i=1===d.sheetArea,b.wu().execute({cmd:g,sheetName:b.name(),rows:f,size:e,columnHeader:i})):v(d.movingX)?a=!1:(e=J(0,La(d)/b.zoom()),j=[],k="resizeColumn",b.sp(d.index)?h.GC$.each(b.ITa.getSelections(),function(a,c){if(c.row===-1){var e=b.Tq(c);2===d.sheetArea?j.push({firstCol:d.index,lastCol:d.index}):j.push({firstCol:e.col,lastCol:e.col+Ga(e)-1})}}):j.push({firstCol:d.index,lastCol:d.index}),eb(b,d,j,n.fCb)&&(k="splitResizeColumn"),l=2===d.sheetArea,b.wu().execute({cmd:k,sheetName:b.name(),columns:j,size:e,rowHeader:l})),m=b.hitTest(n.$F.x,n.$F.y),m&&n.Tw(m),a||b.repaint(),n.fCb=!1)},a.prototype.ZG=function(a,b){var c,d,e,f,g,h,i,j,k=0,l=0,m=0,n=0,o=this,p=o.kj,q=p.wq,r=sa(p),s=ta(p),t=ya(a),u=1===t&&p.ODJ&&p.ODJ.options.isDesignMode&&a.row<p.ITa.getFreeAreaRowCount(t);if(o.o4=o.$G=p.ITa.getSelections(t),p.isCtrlPressed(t)||o.shift||(u?p.Tr(t):p.Tr()),0===t){if(!o.shift&&(d=r?p.ar():p.lq,g=s?p.$q():p.qq,c=Na(o,d,g,1,1,b)))return;p.isCtrlPressed(t)||p.Tr(),p.Ur(-1,-1,ua(p),va(p),!0)}else if(1===t)if(u)h=p.ITa.getSpan(a.row,a.col,1),p.ITa.e$J(h.row,h.col,h.rowCount,h.colCount),p.Ur(h.row,h.col,h.rowCount,h.colCount,!0,1),o.f$J=!0;else{if(!o.shift&&(d=r?p.ar():p.lq,e=o._G(d,a.col,!1),c=Na(o,e.row,e.col,1,xa(a),b)))return;o.shift||p.n_a?(k=L(p.Kl,a.col),n=M(p.Kl-a.col)+1,p.Kx(-1,k,ua(p),n,!0)):p.Ur(-1,p.Kl,ua(p),1,!0)}else if(2===t){if(!o.shift){if(i=s?p.$q():p.qq,e=o._G(a.row,i,!0),f=p.Jl!==e.row,c=Na(o,e.row,e.col,wa(a),1,b))return;f&&q&&q.Lx()}o.shift||p.n_a?(l=L(p.Jl,a.row),m=M(p.Jl-a.row)+1,p.Kx(l,-1,m,va(p),!0)):p.Ur(p.Jl,-1,1,va(p),!0)}else if(3===t)if(H(a.row)||H(a.col))qa(p)&&(j=p.getCellRect(p.Jl,p.Kl,p.Nr,p.Pr),p.yl.VF(j.x,j.y,j.width,j.height));else{if(!o.shift&&(p.Jl!==a.row||p.Kl!==a.col)){if(f=p.Jl!==a.row,c=Na(o,a.row,a.col,wa(a),xa(a),b))return;f&&q&&q.Lx()}o.shift?p.aH(a.row,a.col,!0):(h=p.ITa.getSpan(a.row,a.col),p.n_a||p.Ur(h.row,h.col,Ha(h),Ga(h),!0))}},a.prototype.bH=function(a){if(a&&(3!==ya(a)||!H(a.row)&&!H(a.col))){var b=this;b.OG=!0,b.xG=!0,b.rG={KG:wa(a),MG:xa(a),sG:ya(a)},b.qG()}},a.prototype.ayb=function(a,b){var c,d=this,e=d.kj,f=e.getSpan(a,b),g=a,h=b,j=1,k=1,l=e.selectionUnit(),m=!1;return 1===l?(h=-1,k=-1,g=f?f.row:g,j=f?f.rowCount:j):2===l?(g=-1,j=-1,h=f?f.col:h,k=f?f.colCount:k):m=!0,c=f&&m?f:new i.Range(g,h,j,k)},a.prototype.nG=function(a,b){var c=this,d=c.kj,e=a.row,f=a.col;d.n_a=c.I0a(e,f,b,ya(a))&&d.parent.options.allowUserDeselect,d.n_a&&(d.s_a=d.Jl,d.t_a=d.Kl,d.p_a=c.ayb(e,f)),c.ZG(a),c.bH(a)},a.prototype.I0a=function(a,b,c,d){var e=this,f=e.kj,g=e.o_a(a,b,c,d);return g&&2===f.selectionPolicy()},a.prototype.o_a=function(a,b,c,d){var e,f,g,h=this.kj,i=h.getRowCount(),j=h.getColumnCount();if(!h.isCtrlPressed(d))return!1;for(e=!1,f=c.length,g=0;g<f;g++)if(3===d){if(c[g].contains(a,b,1,1)){e=!0;break}}else if(2===d){if(c[g].contains(a,-1,1,j)||c[g].contains(a,0,1,j)){e=!0;break}}else if(1===d&&(c[g].contains(-1,b,i,1)||c[g].contains(0,b,i,1))){e=!0;break}return e},a.prototype.yG=function(){var a,b=this;b.rG&&b.OG&&b.j8J!==!0&&(a=b.rG.sG,3===a?b.cH():2===a?b.dH():1===a&&b.eH())},a.prototype.cH=function(){var a,b,c,d,e=this,f=e.kj,g=e.fH(),h=e.gH();if(g>=0&&h>=0&&f.Qs(g,h)){if(e.NG(),a=f.ITa.getSelections(),b=f.Jx(g,h,f.Jl,f.Kl),1===a.length&&(c=a[0],!f.n_a&&b.equals(c)))return;f.aH(g,h,!0),d=f.ITa.getSelections(),f.n_a?f.Wq(i.Events.InternalSelectionChanging,{sheet:this,sheetName:f.name(),oldSelections:a,newSelections:b}):f.yu(a,d)}},a.prototype.dH=function(){var a,b,c,d,e,f,g,h,i=this,j=i.kj,k=i.fH(!0);if(k>=0&&j.Qs(k,-1)){if(a=L(j.Jl,k),b=J(j.Jl,k)-a+1,c=-1,d=va(j),e=j.selectionPolicy(),0===e)return;f=j.selectionUnit(),2===f&&(a=-1,b=-1),g=j.ITa.getSelections(),j.Kx(a,c,b,d,!0),h=j.ITa.getSelections(),j.yu(g,h)}i.NG()},a.prototype.eH=function(){var a,b,c,d,e,f,g,h,i,j,k=this,l=k.kj,m=k.rG.sG,n=k.fH(!0,m),o=k.gH(!0,m);if(k.f$J&&n<l.ITa.getFreeAreaRowCount(m))a=l.ITa.g$J(),b=l.Jx(n,o,a.row,a.col,G,1),l.Ur(b.row,b.col,b.rowCount,b.colCount,!0,1);else if(k.f$J=!1,o>=0&&l.Qs(-1,o)){if(c=L(l.Kl,o),d=J(l.Kl,o)-c+1,e=-1,f=ua(l),g=l.selectionPolicy(),0===g)return;h=l.selectionUnit(),1===h&&(c=-1,d=-1),i=l.ITa.getSelections(),l.Kx(e,c,f,d,!0),j=l.ITa.getSelections(),l.yu(i,j)}k.NG()},a.prototype.hH=function(){var a,b,c,d,e=this;e.rG=F,e.RG(),e.j8J=F,e.OG=!1,e.xG=!1,e.m9J=e.f$J,e.f$J=!1,a=e.kj,0!==a.ITa.getSelections().length&&(a.n_a&&(a.n_a=!1,b=a.p_a,a.p_a=null,a.u_a(a.ITa.getSelections(),b),delete a.s_a,delete a.t_a),a.Uja?delete a.Uja:(c=!e.$G,c||(d=a.ITa.getSelections(),c=e.h8J(e.$G,d)),c&&a.Au(e.o4,e.shift)),e.$G=a.ITa.getSelections())},a.prototype.iH=function(){var a=this.kj,b=Qa(a,this.$F.y),c=this.rG.KG,d=a.Gr(1);return 0===b&&c>0&&d.length>0&&d[0].row>a._t()?b=1:2===b&&c<2&&d.length>0&&d[d.length-1].row<a.ir()&&(b=1),b},a.prototype.jH=function(){var a=this.kj,b=Ra(a,this.$F.x),c=this.rG.MG,d=a.Hr(1);return 0===b&&c>0&&d.length>0&&d[0].col>a.$t()?b=1:2===b&&c<2&&d.length>0&&d[d.length-1].col<a.dr()&&(b=1),b},a.prototype.fH=function(a,b,c){var d,e,f,g,h,i,k,l,m;if(void 0===b&&(b=j.SheetArea.viewport),d=this.kj,e=d.ITa,f=this.$F.y,b===j.SheetArea.colHeader){if(g=Ta(d,f))return h=e.getFreeAreaRowCount(b),c&&h>0&&g.row>=h?h-1:g.row}else if(i=this.iH(),g=Sa(d,i,f)){if(k=d.am(),l=g.row,1===i&&f<k.qt){if(m=d._t(),l>m)return d._q(l-1)||l;if(l===m&&a)return 0}else if(0===i&&f<k.nt&&a)return 0;return 1===i&&f>k.ot&&l>d.hr()?d.gr(l)||l:l}return-1},a.prototype.gH=function(a,b,c){var d,e,f,g,h,i,k,l,m;if(void 0===b&&(b=j.SheetArea.viewport),d=this.kj,e=d.ITa,f=this.$F.x,b===j.SheetArea.rowHeader){if(g=Va(d,f))return h=e.getFreeAreaColumnCount(b),c&&h>0&&g.col>=h?h-1:g.col}else if(i=this.jH(),g=Ua(d,i,f)){if(k=d.am(),l=g.col,1===i&&f<k.pt){if(m=d.$t(),l>m)return d.Zq(l-1)||l;if(l===m&&a)return 0}else if(0===i&&f<k.kt&&a)return 0;return 1===i&&f>k.lt&&l>d.cr()?d.br(l)||l:l}return-1},a.prototype.QG=function(a){var b,c=0;return H(a)||0===a||(b=a<0,c=N(500/M(a)),c=J(20,10*c),c>200&&(c=200),b&&(c=-c)),c},a.prototype.TG=function(a,b){var c=this.kj,d=c.gr(a,b);return d!==F?d:a},a.prototype.UG=function(a,b){var c=this.kj,d=c.br(a,b);return d!==F?d:a},a.prototype.kH=function(a,b,c){for(var d=this.kj;a>b;)if(a--,d.getRowVisible(a,c))return a;return a},a.prototype.lH=function(a,b,c){for(var d=this.kj;a>b;)if(a--,d.getColumnVisible(a,c))return a;return a},a.prototype.EVJ=function(a,b,c){for(var d=this.kj;a<b;)if(a++,d.getColumnVisible(a,c))return a;return a},a.prototype.FVJ=function(a,b,c){for(var d=this.kj;a<b;)if(a++,d.getRowVisible(a,c))return a;return a},a.prototype.mH=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=F;if(!Wa(a))return C;if(g=this,h=a.options.reversalTrailingResizeOrder,i=a.BBJ,j=2===wa(b),k=j&&i,l=h&&k,m=j&&!i||l,n=a.Gr(wa(b),d),!n||H(b.row)||H(b.col)){if(H(b.row)&&1===wa(b))for(A=3,B=0;B<A&&(C=g.h$J(a,B,c,d,e),C===F);B++);}else a.getRowVisible(b.row,d)||(b.row=this.TG(b.row,d)),o=n.findRow(b.row),o&&(p=na(o.height,c),q=p[0],r=p[1],s=!(l&&n[n.length-1].row===o.row),o.y+o.height-r<=e&&e<=o.y+o.height+r&&s?(C=Ia(da,b.row,d),t=n[n.length-1].row,t>=0&&(u=a.ir(d),C.index===u&&C.index!==t&&o.y+o.height-r/2<=e&&(C=Ia(g.nH(a,t,d),t,d))),j&&Ka(C.index,a,d)&&(C.WUJ=!0),l&&(v=g.FVJ(C.index,n[n.length-1].row,d),C=Ia(g.nH(a,v,d),v,d),C.CVJ=l)):o.y-q<=e&&e<o.y+q&&(f.Common.k.Cb(n,o)>0||m)&&(w=g.kH(b.row,0,d),C=Ia(g.nH(a,w,d),w,d),l&&(C=Ia(da,b.row,d),x=n[0].row,x>=0&&(y=a._q(x-1,d,!0),C.index===y&&C.index!==x&&e<o.y+q/2&&(C=Ia(g.nH(a,x,d),x,d))),C.CVJ=l))),!C&&1===wa(b)&&n.length>0&&(o=n[0],J(0,o.y-c)<=e&&e<=o.y+c&&(z=hb(a,b.row,!0),z>=0&&(C=Ia(g.nH(a,z,d),z,d))));return C&&!a.getRowResizable(C.index,d)&&(C=F),C},a.prototype.h$J=function(a,b,c,d,e){var f=this,g=F,h=2===b,i=a.Gr(b,d),j=i[h?0:i.length-1],k,l;return v(j)||0!==j.height||(k=h?j.y:j.y+j.height,l=j.row,J(0,k-c)<=e&&e<=k+c&&(g=Ia(f.nH(a,l,d),l,d),h&&(g.CVJ=!0))),g},a.prototype.nH=function(a,b,c){var d=a.parent;return d&&1===d.options.resizeZeroIndicator&&a.getRowVisible(b)&&0===a.Yr(b,c)?ca:da},a.prototype.oH=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=F;if(!Xa(a))return E;if(g=this,h=a.options.reversalTrailingResizeOrder,i=a.CBJ,j=2===xa(b),k=j&&i,l=h&&k,m=j&&!i||l,n=a.Hr(xa(b),d),!n||H(b.col)||H(b.row)){if(H(b.col)&&1===xa(b))for(C=3,D=0;D<C&&(E=g.i$J(a,D,c,d,e),E===F);D++);}else a.getColumnVisible(b.col,d)||(b.col=this.UG(b.col,d)),o=n.findCol(b.col),o&&(p=na(o.width,c),q=p[0],r=p[1],s=a.getColumnWidth(b.col,d),t=a.zoom(),s*=t,u=!(l&&n[n.length-1].col===o.col),o.x+s-r<=e&&e<=o.x+s+r&&u?(E=Ia(ea,b.col,d),v=n[n.length-1].col,v>=0&&(w=a.dr(d),E.index===w&&E.index!==v&&o.x+s-r/2<=e&&(E=Ia(g.pH(a,v,d),v,d))),j&&Ja(E.index,a,d)&&(E.XUJ=!0),l&&(x=g.EVJ(E.index,n[n.length-1].col,d),E=Ia(g.pH(a,x,d),x,d),E.DVJ=l)):o.x-q<=e&&e<o.x+q&&(f.Common.k.Cb(n,o)>0||m)&&(y=g.lH(b.col,0,d),E=Ia(g.pH(a,y,d),y,d),l&&(E=Ia(ea,b.col,d),z=n[0].col,z>=0&&(A=a.Zq(z-1,d,!0),E.index===A&&E.index!==z&&e<o.x+q/2&&(E=Ia(g.pH(a,z,d),z,d))),E.DVJ=l))),!E&&1===xa(b)&&n.length>0&&(o=n[0],J(0,o.x-c)<=e&&e<=o.x+c&&(B=hb(a,b.col,!1),B>=0&&(E=Ia(g.pH(a,B,d),B,d))));return E&&a.RKJ&&a.SKJ(b,E.index)&&(E=F),E&&!a.getColumnResizable(E.index,d)&&(E=F),E},a.prototype.i$J=function(a,b,c,d,e){var f=this,g=F,h=2===b,i=a.Hr(b,d),j=i[h?0:i.length-1],k,l;return v(j)||0!==j.width||(k=h?j.x:j.x+j.width,l=j.col,J(0,k-c)<=e&&e<=k+c&&(g=Ia(f.pH(a,l,d),l,d),h&&(g.DVJ=!0))),g},a.prototype.pH=function(a,b,c){var d=a.parent;return d&&1===d.options.resizeZeroIndicator&&a.getColumnVisible(b)&&0===a.$r(b,c)?fa:ea},a.prototype.ur=function(a,b,c,d){var e,f,g,h,i,k,l,m=this,n=m.kj,o=n.parent,p=n.options,q=p.colHeaderVisible,r=p.rowHeaderVisible,s=F;return o&&!o.options.allowUserResize||(g=n.am(),wa(a)<0&&xa(a)>=0&&q&&a.row>=n.getFreeAreaRowCount(j.SheetArea.colHeader)?(s=m.oH(n,a,d,1,b),s||(s=m.mH(n,a,d,1,c))):wa(a)>=0&&xa(a)<0&&r&&a.col>=n.getFreeAreaRowCount(j.SheetArea.rowHeader)?(s=m.mH(n,a,d,2,c),s||(s=m.oH(n,a,d,2,b))):wa(a)<0&&xa(a)<0?n.ir(2)===F&&M(c-g.Cr)<=d?(h=n.Gr(1),h&&h.length>0&&(e=h[h.length-1].row,e>=0&&n.getRowResizable(e,2)&&(s=Ia(m.nH(n,e,2),e,2)))):n.dr(1)===F&&M(b-g.Br)<=d&&(i=n.Hr(1),i&&i.length>0&&(f=i[i.length-1].col,f>=0&&n.getColumnResizable(f,1)&&(s=Ia(m.pH(n,f,1),f,1)))):wa(a)>=0&&xa(a)>=0&&(e=ua(n,1)-1,f=va(n,2)-1,k=n.options.sheetAreaOffset.top,l=n.options.sheetAreaOffset.left,e>=0&&0===g.Cr&&k<=c&&c<=d+k&&q?s=Ia(m.nH(n,e,1),e,1):f>=0&&0===g.Br&&l<=b&&b<=d+l&&r&&(s=Ia(m.pH(n,f,2),f,2)))),s},a.prototype.qH=function(a,b,c,d){var e,f,g,h,i=this.kj,j=i.am(),k=j.Ft(1,1);if(1===b)if(e=i.Hr(b),e&&e.length>0){if(f=e[e.length-1],f.x+f.width<=c&&c<k.x+k.width)return!0}else if(k.contains(c,d))return!0;if(1===a)if(g=i.Gr(a),g&&g.length>0){if(h=g[g.length-1],h.y+h.height<=d&&d<k.y+k.height)return!0}else if(k.contains(c,d))return!0;return!1},a.prototype.BD=function(a){var b=this.Vs();this.sH(a,a.pageX-b.left,a.pageY-b.top)},a.prototype.DD=function(){var a,b,c,d,e,f,g=this.kj,h=g.yt;h&&(a=h.cellTypeHitInfo,a&&(b=g.getCellType(a.row,a.col,ya(h)),b.ZBb(a))),this.OG||(g.Uja=G,c={x:-1e4,y:-1e4,rowViewportIndex:F,colViewportIndex:F,row:-1,col:-1,resizeInfo:F,hitTestType:F},this.Uw(c),h&&(d=h.row,e=h.col,f=g.getActualStyle(d,e),g.QAJ&&(clearTimeout(g.QAJ),delete g.QAJ),g.parent&&f&&f.showEllipsis&&g.parent.xw()))},a.prototype.sH=function(a,b,c){var d,e,f,g,h,j,k,l,m,n,o,p,q,r,t=this;return t.$F={e:a,x:b,y:c},d=t.kj,t.eG&&!i.Vl.Wl(d)&&i.Vl.Zl(d),t.eG&&t.OG?void(t.isResizing?t.WG():t.$ia?t._ia&&t._ia():t.zG?t.AG&&t.AG():t.BG?t.CG&&t.CG():t.DG?t.EG():t.FG?t.GG():t.HG?t.IG():t.wIb?t.xIb&&t.xIb():t.xG&&t.yG()):(e=d.hitTest(b,c),t.yIb(d,e,t),void(e&&(0===t.qIb&&e.tableSelectInfo&&t.eG&&t.zIb(d,t,e),f=d.parent,g=e.row,h=e.col,j=d.sr(e.rowViewportIndex,e.colViewportIndex),m=e.pivotTableInfo,n=!v(m)&&m.options.showToolTip,f?(l=d.getActualStyle(g,h,j),o=d.getCellRect(g,h,e.rowViewportIndex,e.colViewportIndex),!n||d.isEditing&&d.isEditing()?(clearTimeout(d.QAJ),delete d.QAJ,k=d.AIb(g,h,j),k&&l.XHb!==!1&&j?f.uw(s.Ob(k),o.x+o.width+5,o.y+o.height+5,!1):(q=f.options.showScrollTip&&(f.VJc.JB||f.UJc.JB||f.rZJ.JB),q||f.xw())):(k=m.jOc(g,h),p="gc-spread-pivot-toolTip",clearTimeout(d.QAJ),delete d.QAJ,f.xw(),k&&l.XHb!==!1&&(d.QAJ=setTimeout(function(a,b){f.uw(k,a,b+15,!1,p)}.bind(void 0,e.x,e.y),700)))):(clearTimeout(d.QAJ),delete d.QAJ),t.Tw(e),f&&f.options.enableAccessibility&&(r=d.DHb(e),f.EHb(r)),t.Uw(e))))},a.prototype.yIb=function(a,b,c){var d,e,f,g,h;1===c.qIb?(d=c.BIb.row,e=c.BIb.col,f=b.col,g=a.getSelections()[0],a.Kx(d,e>f?f:e,g.rowCount,e-f>0?e-f+1:f-e+1,!0)):2===c.qIb&&(d=c.BIb.row,e=c.BIb.col,h=b.row,g=a.getSelections()[0],a.Kx(d>h?h:d,e,d-h>0?d-h+1:h-d+1,g.colCount,!0))},a.prototype.zIb=function(a,b,c){var d,e=a.getActiveRowIndex(),f=a.getActiveColumnIndex();
b.BIb={row:e,col:f},d=c.tableSelectInfo.action,"tableColSelect"===d?b.qIb=1:"tableRowSelect"===d&&(b.qIb=2)},a.prototype.Tw=function(a){var b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s=this,t=s.kj,u=t.Ws();u&&(b=t.yt,d=!b||a.row!==b.row||a.col!==b.col||ya(a)!==ya(b)||a.resizeInfo&&!b.resizeInfo||!a.resizeInfo&&b.resizeInfo||a.resizeInfo&&a.resizeInfo.action!==b.resizeInfo.action||a.dragInfo&&!b.dragInfo||!a.dragInfo&&b.dragInfo||a.dragInfo&&a.dragInfo.action!==b.dragInfo.action||a.resizeTableHitInfo&&!b.resizeTableHitInfo||!a.cellTypeHitInfo&&b.cellTypeHitInfo,b&&d&&(e=b.cellTypeHitInfo,e&&(c=t.getCellType(e.row,e.col,ya(b)),c.ZBb(e))),f=a.resizeInfo,g=a.dragMergeInfo,h=a.dragInfo,j=a.formulaRangeHitInfo,k=a.cellTypeHitInfo,l=t.yl,m=a.resizeTableHitInfo,n=a.tableSelectInfo,n?"tableRowSelect"===n.action?u.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI4cHgiIGhlaWdodD0iOHB4IiB2aWV3Qm94PSIwIDAgOCA4IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA4IDgiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHg9IjAiIHk9IjAiCiAgICBocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFnQUFBQUlDQVFBQUFCdUJuWUFBQUFBQkdkQlRVRUFBTEdQQy94aEJRQUFBQ0JqU0ZKTgpBQUI2SmdBQWdJUUFBUG9BQUFDQTZBQUFkVEFBQU9wZ0FBQTZtQUFBRjNDY3VsRThBQUFBQW1KTFIwUUEvNGVQekw4QUFBQUhkRWxOClJRZm1BeDBHTURRVFpSbFpBQUFBUzBsRVFWUUkxMlhOc1ExQVVBQkYwZU9qVWxFYXdTNFM0Mmh0d0JCS0kyQXVJcUhReUhmcW0vZDQKNVZxbGo5eGlWSkRwSlFnYW5jdVF1RC9kYVE0aXFjTm10YXRWSnYxdlZIejdBRU5GRE9OV3daY3lBQUFBSlhSRldIUmtZWFJsT21OeQpaV0YwWlFBeU1ESXlMVEF6TFRJNVZEQTJPalE0T2pVeUt6QXdPakF3VkVsRUpBQUFBQ1YwUlZoMFpHRjBaVHB0YjJScFpua0FNakF5Ck1pMHdNeTB5T1ZRd05qbzBPRG8xTWlzd01Eb3dNQ1VVL0pnQUFBQUFTVVZPUks1Q1lJST0iIC8+Cjwvc3ZnPgo=) 8 4,auto":"tableColSelect"===n.action?u.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI4cHgiIGhlaWdodD0iOHB4IiB2aWV3Qm94PSIwIDAgOCA4IiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA4IDgiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHg9IjAiIHk9IjAiCiAgICBocmVmPSJkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFnQUFBQUlDQVFBQUFCdUJuWUFBQUFBQkdkQlRVRUFBTEdQQy94aEJRQUFBQ0JqU0ZKTgpBQUI2SmdBQWdJUUFBUG9BQUFDQTZBQUFkVEFBQU9wZ0FBQTZtQUFBRjNDY3VsRThBQUFBQW1KTFIwUUEvNGVQekw4QUFBQUhkRWxOClJRZm1BeDBHTlRobnBLRTNBQUFBVGtsRVFWUUkxMlhJTVFwQVVBQUEwUGQ5UlprZHdlNFFWanVUZ3pBN25LTllETCtVb3V5ODhRR1QKMjIyQ0hBUVJBVElmdjRocXZVNkxRMm5QSkkwQmpCb0pDb3ZUYVZZUThkaFVOcXVMRjkwZUQzQ2dxdzV5QUFBQUpYUkZXSFJrWVhSbApPbU55WldGMFpRQXlNREl5TFRBekxUSTVWREEyT2pVek9qVTJLekF3T2pBd21XaEVBQUFBQUNWMFJWaDBaR0YwWlRwdGIyUnBabmtBCk1qQXlNaTB3TXkweU9WUXdOam8xTXpvMU5pc3dNRG93TU9nMS9Md0FBQUFBU1VWT1JLNUNZSUk9IiAvPgo8L3N2Zz4K) 8 4,auto":"tableCornerSelect"===n.action?u.style.cursor="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSIxMHB4IiBoZWlnaHQ9IjEwcHgiIHZpZXdCb3g9IjAgMCAxMCAxMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAgMTAiIHhtbDpzcGFjZT0icHJlc2VydmUiPiAgPGltYWdlIGlkPSJpbWFnZTAiIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCIgeD0iMCIgeT0iMCIKICAgIGhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQW9BQUFBS0NBUUFBQUFuT3djMkFBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFDQmpTRkpOCkFBQjZKZ0FBZ0lRQUFQb0FBQUNBNkFBQWRUQUFBT3BnQUFBNm1BQUFGM0NjdWxFOEFBQUFBbUpMUjBRQS80ZVB6TDhBQUFBSGRFbE4KUlFmbUF4MEdOd1BrbVNxUkFBQUFZRWxFUVZRSTExM01zUTJETUJRRTBDZTZVRUxDQnBHeUhOUFEyeVVNeFFRWkFjVXhCV0FCZDkzVAovMGVsTitsYzB2djZDNW96anBJc2lZVnJYc0tGbndab3hKMkR0eWh0RHdjdlpvdDhMTGVDbjd5MzVHTytZeXZlTHg4R3FWQmVBYnlQCk1QNG1OSW4zQUFBQUpYUkZXSFJrWVhSbE9tTnlaV0YwWlFBeU1ESXlMVEF6TFRJNVZEQTJPalUxT2pBekt6QXdPakF3anE0VmhBQUEKQUNWMFJWaDBaR0YwWlRwdGIyUnBabmtBTWpBeU1pMHdNeTB5T1ZRd05qbzFOVG93TXlzd01Eb3dNUC96clRnQUFBQUFTVVZPUks1QwpZSUk9IiAvPgo8L3N2Zz4K) 10 5,auto":"tableSelect"===n.action?u.style.cursor="move":"default"===n.action&&(u.style.cursor=""):f?f.action===ea?u.style.cursor=i.CursorResource.ResizeCol:f.action===da?u.style.cursor=i.CursorResource.ResizeRow:f.action===fa?u.style.cursor=i.CursorResource.ResizeHiddenCol:f.action===ca?u.style.cursor=i.CursorResource.ResizeHiddenRow:u.style.cursor=ga:g?g.left||g.right?u.style.cursor="w-resize":(g.top||g.bottom)&&(u.style.cursor="n-resize"):h&&"drag"===h.action?h.side===ba?u.style.cursor="crosshair":h.side?u.style.cursor="move":u.style.cursor=ga:j?(j.inBorder?u.style.cursor="move":j.inTopLeft?u.style.cursor="nw-resize":j.inTopRight?u.style.cursor="ne-resize":j.inBottomLeft?u.style.cursor="sw-resize":j.inBottomRight&&(u.style.cursor="se-resize"),o=s.isFormulaRangeHovering,p=s.o8J,q=p&&p.paramRange,r=j.paramRange,s.isFormulaRangeHovering=!0,s.o8J={paramRange:r},o&&r.index===q.index||l.uH()):m?u.style.cursor="se-resize":(k&&(c=t.getCellType(k.row,k.col,ya(a)),k.sheet=t,d&&c.processMouseEnter(k),c.YBb(k)),!d&&k&&k.isReservedLocation||(u.style.cursor=ga),s.isFormulaRangeHovering&&(s.isFormulaRangeHovering=!1,s.o8J=F,l.uH())))},a.prototype.CD=function(a){var b=this,c=b.kj;return b.uC(),!c.dG||(c.dG=!1,b.vH(a),!1)},a.prototype.vH=function(a){var b,c,d,e=this,f=e.kj,g=i.Vl.Xl();e.eG=!1,e.qIb=0,g&&g!==f&&g.endEdit&&(g.Cw&&g.Cw.V4||(g.endEdit(),g.repaint())),i.Vl.Zl(f),e.isResizing?e.YG():e.$ia?e.aja&&e.aja():e.zG?e.wH&&e.wH(a):e.BG?e.xH&&e.xH():e.DG?e.yH():e.FG?e.zH():e.HG?e.AH():e.wIb?e.CIb&&e.CIb():f.yt&&(b=f.yt,c=b.cellTypeHitInfo,!b.filterButtonHitInfo&&!b.resizeInfo&&b.row>=0&&b.col>=0&&(c&&(d=f.getCellType(c.row,c.col,ya(b)),c.sheet||(c.sheet=f),c.isPivotTable=!!b.pivotTableInfo,d.XGb(c)),c&&c.isReservedLocation||f.Wq(i.Events.CellClick,Ma(f,f.name(),b.row,b.col,ya(b))),e.hH(),f.fCc&&f.gCc&&f.gCc())),e._BJ=!1,e.lG(a)},a.prototype.UF=function(a,b,c){var d,e=this.kj;e.isEditing&&e===i.Vl.Xl()&&(d=e.Ws(),Da(a)||Ca(a)||e.FF(d,b,c))},a.prototype.nm=function(a){var b,c,d,f,g,h,j,k,l,m,n,o=this,p=o.kj;if(p){if(b=za(p),c=Aa(p),d=p.getCellType(b,c),f={isEditing:qa(p),sheet:p,row:b,col:c,sheetArea:3},g={sheet:p,row:b,col:c,sheetArea:3},d&&d.isReservedKey(a,f))return void(qa(p)||d.processKeyDown(a,g));if(h={e:a,r:F,c:f},e.Worksheet.ao(p,"preProcessKeyDown",h),h.r)return}if(j=!(qa(p)||Ca(a)||Fa(a)||34!==Ba(a)&&33!==Ba(a)&&37!==Ba(a)&&39!==Ba(a)&&9!==Ba(a)&&13!==Ba(a)&&38!==Ba(a)&&40!==Ba(a)),p.CH&&(p.CH=!1,p.yl.DH()),l=Ba(a),m=13===l,n=27===l,p.fCc&&p.hCc&&(m||n)?p.hCc(n):k=j?o.FH?o.tlK:o.tlK=o.EH(a):o.EH(a),j&&k&&i.Vl.Wl(p)){if(o.Uoa=new Date,o.FH)return o.GH<25&&o.GH++,void q(a);o.FH=!0,o.GH=1,o.HH(a,!0)}},a.prototype.VG=function(){var a,b,c=this.kj,d=c.yt,e=d.resizeInfo;return e.action===da||e.action===ca?(a=c.getRowHeight(e.index),t(ja().Tip_Height,[a])):(b=c.getColumnWidth(e.index),t(ja().Tip_Width,[b]))},a.prototype.XG=function(a){var b=this.kj;return a.action===da||a.action===ca?t(ja().Tip_Height,[J(0,K((a.movingY-a.startY)/b.zoom()))]):t(ja().Tip_Width,[J(0,K((a.movingX-a.startX)/b.zoom()))])},a.prototype.HH=function(a,b){var c=this;if(c.FH){if(new Date-c.Uoa>(c.GH>1?100:600))return void c.Ux();b||(c.tlK=c.EH(a)),c.FH&&(c.WF=l.setTimeout(function(){c.HH(a)},b?500:20))}},a.prototype.IH=function(a,b){var c,d,e,f=this.kj,g=f.Ws();if(g){f.HF=!0;try{c=qa(f),f.EF&&f.EF(g,f.Jl,f.Kl,F,F,!0,F,b,a),!c&&qa(f)&&(d=f.getCellType(f.Jl,f.Kl),!d.tw||32!==Ba(a)||Ca(a)||Da(a)||Ea(a)||d.tw(f,f.Jl,f.Kl,3),d.JH&&d.JH(a))}finally{f.HF=!1,e=f.tu(),e.YHb&&delete e.YHb}}},a.prototype.EH=function(a){var b,c,d,f,g,i,j,k,m,n,o,p,r=this,s=r.kj;if(r.lG(a),qa(s)||27!==Ba(a)||Ea(a)||Ca(a)||Da(a)||!s.KH||(h.GC$(s.KH).remove(),s.KH=F),b=s.tu(),qa(s)||27!==Ba(a)||Ea(a)||Ca(a)||Da(a)||!b.YHb||delete b.YHb,qa(s)||34!==Ba(a)&&33!==Ba(a)&&35!==Ba(a)&&36!==Ba(a)&&38!==Ba(a)&&40!==Ba(a)||q(a),qa(s)||37!==Ba(a)&&39!==Ba(a)||q(a),qa(s)&&Ca(a)&&(89===Ba(a)||90===Ba(a)))return q(a),!1;if(c=s.wu(),d=c.getShortcutKey(Ba(a),Ca(a),Da(a),Ea(a),Fa(a)),f=c.getCommands(d))for(g=0;g<f.length;g++)if(i={sheetName:s.name()},j=f[g].execute(s.parent,i),j||i.lDc)return j.ignoreCancelDefault||q(a),!0;return k={e:a,r:F},e.Worksheet.ao(s,"processKeyDown",k),!!k.r||(r.LH(a)&&(m=s.Cw,m&&m.MH&&m.NH(),n=qa(s),n||(o=l.Yl.Bm(a.target),p=o&&"gcAttachedFormulaTextBox"===o.getAttribute(aa),p||r.IH(a))),!1)},a.prototype.Ux=function(){var a=this;a.FH=!1,a.tlK=G,a.GH=0,a.WF>0&&(clearTimeout(a.WF),a.WF=0)},a.prototype.om=function(a){var b,c,d,e,f,g,h,i,j=this;if(j.Ux(),b=j.kj){if(c=za(b),d=Aa(b),e=b.getCellType(c,d),f={isEditing:qa(b),sheet:b,row:c,col:d,sheetArea:3},g={sheet:b,row:c,col:d,sheetArea:3},e&&e.isReservedKey(a,f))return void(qa(b)||e.processKeyUp(a,g));if(h=b.Cw,h&&h.BH(a))return;if(i=b.parent&&b.parent.CF,i&&i.BH(a))return}j.lG(a)},a.prototype.pm=function(a){var b=this,c=b.kj,d={e:a,r:F};e.Worksheet.ao(c,"processCompositionStart",d),d.r||this.IH(a,!0)},a.prototype.LH=function(a){return!(Ca(a)||Ea(a)||Fa(a))&&(Ba(a)>=65&&Ba(a)<=90||Ba(a)>=48&&Ba(a)<=59||Ba(a)>=96&&Ba(a)<=105||Ba(a)>=186&&Ba(a)<=192||Ba(a)>=220&&Ba(a)<=222||219===Ba(a)||Ba(a)>=106&&Ba(a)<=111||32===Ba(a)||61===Ba(a)||173===Ba(a)||229===Ba(a)||0===Ba(a)||8===Ba(a))},a.prototype.lG=function(a){var b,c=this,d=c.kj,e=i.Ul.sl(),f=e?Fa(a):Ca(a);c.ctrl=f&&!Da(a),c.shift=Da(a)&&!f,c.isPressShiftKey=Da(a),c.zG===!0&&(c.PH=f,b=Da(a),c.j$J&&(b=!Da(a)),c.OH=b,d.yl.QH&&d.yl.QH()),c.RH=f},a.prototype.Vx=function(){var a=this;a.shift=!1,a.ctrl=!1,a.zG=!1,a.OH=!1,a.PH=!1,a.RH=!1},a.prototype.Qw=function(a){var b,c,d,e,f,g,i,k,l,m,n,o,p,q,r,s,t;a&&a.sheet?(b=a.sheet,c=a.editor,d=a.canvasOffset):(b=this.kj,c=b.BF),qa(b)&&(k=j.SheetArea.viewport,l=b._ZJ,l?(e=l.row,f=l.col,v(l.sheetArea)||(k=l.sheetArea)):(e=b.Jl,f=b.Kl),k===j.SheetArea.rowHeader?i=-1:k===j.SheetArea.colHeader&&(g=-1),m=b.getCellType(e,f,k),n=b.am(),o=b.getActualStyle(e,f,k),p=b.getCellRect(e,f,g,i),c&&c.parentNode&&(q=c.parentNode.parentNode,r=!1,k===j.SheetArea.rowHeader?r=p.x>=n.x&&p.y>=n.y+n.Cr&&p.x+p.width<=n.pt&&p.y+p.height<=n.ot+n.gs:k===j.SheetArea.colHeader?r=p.x>=n.x+n.Br&&p.y>=n.y&&p.x+p.width<=n.lt+n.js&&p.y+p.height<=n.qt:k===j.SheetArea.viewport&&(r=p.x>=n.kt&&p.y>=n.nt&&p.x+p.width<=n.lt+n.js&&p.y+p.height<=n.ot+n.gs),p&&p.width>0&&p.height>0&&r?(s={sheet:b,row:e,col:f,sheetArea:k,canvasOffset:d},m.g5(q,o,p,s)):h.GC$(q).css({top:-1e4,left:-1e4})),t=b.Cw,t&&t.SH())},a.prototype.TH=function(a,b){var c,d;if(!a)return F;for(c=a.firstChild;c;){if(c.id===b||c.name===b)return c;if(d=this.TH(c,b))return d;c=c.nextSibling}return F},a.prototype.h8J=function(a,b){var c,d,e,f=!0;if(a.length===b.length)for(c=0;c<a.length;c++){if(d=a[c],e=b[c],d.row!==e.row||d.col!==e.col||Ha(d)!==Ha(e)||Ga(d)!==Ga(e)){f=!0;break}f=!1}return f},a.prototype.UH=function(a,b,c,d){var e,f,g,i,j,k,m,n,p=this,q=p.kj,s={sheet:q,row:b,col:c,sheetArea:3},t=q.zo(),u=a.isImeAware(s),w=ha?Q:"fixed";return d&&p.VH(),u&&!p.GF&&(e=a.a5(s),f=e.style,p.WH||(p.WH={overflow:Z,border:$,position:Q}),p.WH.overflow=f.overflow,p.WH.border=f.border,p.WH.position=f.position,h.GC$(e).css([P,S,T,U,V,W,R],[w,Y,"0px","0px","0px","0px",$]),q.KF&&e.firstChild&&(g=e.firstChild.firstChild,q.KF(a,g,b,c,q.getActualStyle(b,c),G,G,G,G,3),i=a.getEditorValue(g,s),o.safari&&(""===i||v(i))&&a.setEditorValue(g," ",s)),t&&t.insertBefore(e,F),p.GF=e),p.XH||(e=r("div"),h.GC$(e).css([P,S,T,U,V,W],[w,Y,"0px","0px","0px","0px"]),p.XH=e,j=r("textarea"),h.GC$(j).attr(aa,"gcSheetFocusInput").attr(_,-1).css([P,S,R,X],[Q,Y,$,$]),j.value=" ",e.insertBefore(j,F),p.YH=j,k=r("div"),h.GC$(k).css(P,Q).css(S,Y).attr(aa,"gcSheetFocusInput").attr(_,-1),e.insertBefore(k,F),p.ZH=k,t&&t.insertBefore(e,F)),m=l.location!==l.parent.location,n=l.scrollX>0||l.scrollY>0,(ha||(o.mozilla||o.chrome||o.safari)&&m||n)&&(p.GF&&p.$H(q,p.GF),p.$H(q,p.XH)),u?p.GF:p.YH},a.prototype.JF=function(){var a=this;a.GF&&a.WH&&h.GC$(a.GF).css(S,a.WH.overflow).css(R,a.WH.border).css(P,a.WH.position)},a.prototype.VH=function(){var a=this;a.GF&&(a.GF.parentElement&&a.GF.parentElement.removeChild(a.GF),a.GF.comboBox&&(a.GF.comboBox=F),a.GF=F)},a.prototype.zt=function(a){i.Vl.Wl(this.kj)||this._H(!0,!0,a)},a.prototype.Cm=function(){var a=this.ZH;a&&a.focus()},a.prototype.Qq=function(){this._H(!0,!0)},a.prototype.aI=function(){this.bI&&(clearTimeout(this.bI),this.bI=F)},a.prototype._H=function(a,b,c){var d,e,f,g,h,j,k,n,q,r,s,t;0===arguments.length&&(a=!0),d=this,d.Gma||(d.XF=!1,d.aI(),e=d.kj,f=za(e),g=Aa(e),h=e.getCellType(f,g),d.UH(h,f,g,b),j={sheet:e,row:f,col:g,sheetArea:3},k=h.isImeAware(j)&&d.GF.firstChild?d.GF.firstChild.firstChild:d.YH,n=k,b&&!o.msie&&h.setImeMode(n,e.getActualStyle(f,g).imeMode,j),m.body.focus(),q=function(){var a=function(){try{h.isImeAware(j)?(h.focus(n,j),h.selectAll(n,j)):(k.focus(),k.select())}catch(a){}};b&&o.msie&&h.setImeMode(n,e.getActualStyle(f,g).imeMode,j),a()},r=p,s=o.metroMode||r.ipad||r.iphone||r.android,!e.CH&&!s||!a&&h.isImeAware(j)?e._enhanceIme===!1||c||d.FLc(e)||q():!qa(e)&&s?b&&(t=d.GF&&d.GF.firstChild&&d.GF.firstChild.firstChild,h.setImeMode(t,e.getActualStyle(f,g).imeMode,j)):d.bI=l.setTimeout(function(){d.FLc(e)||(d.aI(),qa(e)||e._enhanceIme===!1||c||q())},200),i.Vl.Wl(e)||d.FLc(e)||i.Vl.Zl(e),d.p8J(e)||d.cs&&d.cs(e.Jl,e.Kl))},a.prototype.$H=function(a,b){var c,d,e,f,g,i,j,k,m,n,o=za(a),p=Aa(a),q=a.Nr,r=a.Pr,s=a.getCellRect(o,p,q,r),t=this,u=a.Vs(),v=t.bG(),w=t.GF,x=0,y=0;w&&(e=h.GC$(w),x=parseInt(e.css(W),10),y=parseInt(e.css(V),10)),c=s.y+v.top-2,d=s.x+v.left-2,f=l.pageYOffset,g=l.pageXOffset,i="fixed"===b.style.position&&!jb(b),i&&(c-=f,d-=g),j=i?0:f-u.top+v.top,k=l.innerHeight+j-x,m=i?0:g-u.left+v.left,n=l.innerWidth+m-y,(H(c)||c<j||c>k)&&(c=j),(H(d)||d<m||d>n)&&(d=m),h.GC$(b).css(T,c).css(U,d)},a.prototype.cI=function(a){var b,c,d,e,f=this;f.aI(),qa(f.kj)||f.XF&&m.activeElement===f.ZH||(b=f.kj,a?(c=a.row,d=a.col):(c=b.Jl,d=b.Kl),e=b.getCellType(c,d),f.UH(e,c,d,!1),f.ZH.focus(),f.XF=!0)},a.prototype.dI=function(a,b){var c=this;c.XF&&(c.XF=!1,!b&&c._H(a))},a.prototype.gx=function(a){var b=this.kj,c=b.tu();c&&(c.ska(a),c.M4(),this.Gma=!0,a&&c.N4())},a.prototype.hx=function(){var a=this,b=a.kj.tu();b&&b.ska(""),a.Gma=!1,a._H(!0,!1)},a.prototype.MF=function(){var a,b=this;b.aI(),a=b.GF,a&&(h.GC$(a).remove(),b.GF=G),a=b.XH,a&&(h.GC$(a).remove(),b.YH=G,b.XH=F,b.ZH=F)},a.prototype.uw=function(a,b,c,d){var e=this.kj.parent;e&&e.uw(s.Ob(a),b,c,d)},a.prototype.ww=function(a,b,c,d){var e=this.kj.parent;e&&e.ww(a,b,c,d)},a.prototype.xw=function(){var a=this.kj.parent;a&&a.xw()},a.prototype.Uw=function(a){var b,c,d,e,f,g,h,i,k,l,m,n,o,p;function q(a,b){var c=!1;return a||b?a&&b&&(c=a.action===b.action&&a.index===b.index&&a.sheetArea===b.sheetArea):c=!0,c}b=this,c=b.kj,d=c.hCb,e=c.iCb,f=c.yt,g=!1,f||(g=!0),g||a||(g=!0),g||(g=a.col!==f.col||a.row!==f.row||xa(a)!==xa(f)||wa(a)!==wa(f)||ya(a)!==ya(f)||!q(a.resizeInfo,f.resizeInfo)),c.yt=a,g&&(h=c.XCJ,i=h&&h.isEnable(j.RowColumnStates.hover,!0),k=h&&h.isEnable(j.RowColumnStates.hover,!1),l=a.hitTestType,f&&!v(f.hitTestType)&&(c.hCb=null,c.iCb=null,c.ITa.setCellState(d,e,j.CellStatesType.hover,!1,f.hitTestType),i&&c.YCJ(d,f.rowViewportIndex,f.colViewportIndex),k&&c.ZCJ(e,f.rowViewportIndex,f.colViewportIndex),i||k||c.DIb&&c.DIb(j.CellStatesType.hover,d,e,f.hitTestType,f.rowViewportIndex,f.colViewportIndex)),a&&!v(l)&&(m=void 0!==a.row&&void 0!==a.col&&l===j.SheetArea.viewport,c.hCb=a.row,c.iCb=a.col,a.resizeInfo||(c.ITa.setCellState(a.row,a.col,j.CellStatesType.hover,!0,l),i&&m&&c.YCJ(a.row,a.rowViewportIndex,a.colViewportIndex),k&&m&&c.ZCJ(a.col,a.rowViewportIndex,a.colViewportIndex),i||k||c.DIb&&c.DIb(j.CellStatesType.hover,a.row,a.col,l,a.rowViewportIndex,a.colViewportIndex))),c.fI=!0,n=c.yl,o=pa(c,f,n),p=pa(c,a,n),o=o||p,c.fI=!1,(o||c.RKJ)&&n.im(),c.ODJ&&c.ODJ.options.isDesignMode&&1===l&&n.im(G,G,G,G,1))},a.prototype._G=function(a,b,c){var d=this.gI(a,b,c);return this.hI(d)},a.prototype.gI=function(a,b,c){var d=this.kj.ITa.getSpan(a,b),e=Ha(d),f=Ga(d);return 1===e&&1===f?d:c&&1===e||!c&&1===f?d:(c?b++:a++,this.gI(a,b,c))},a.prototype.hI=function(a){var b,c,d,e=this.kj,f=a.row,g=ua(e);for(b=f;b<g&&e.getRowVisible(b)!==!0;b++);for(b<g&&(f=b),c=a.col,d=va(e),b=c;b<d&&e.getColumnVisible(b)!==!0;b++);return b<d&&(c=b),u(f,c,Ha(a),Ga(a))},a.prototype.p8J=function(a){var b,c,d=a.floatingObjects&&a.floatingObjects.all(),e=a.shapes&&a.shapes.all();if(!v(d))for(b=0;b<d.length;b++)if(d[b].isSelected())return!0;if(!v(e))for(c=0;c<e.length;c++)if(e[c].isSelected())return!0},a.prototype.FLc=function(a){return"function"==typeof a.isShapeTextEditorOpened&&a.isShapeTextEditorOpened()},a.prototype.k$J=function(a){var b,c,d,e,f,g,h,i,j,k=this.kj,l=a.resizeInfo;return l?(b=k.ITa.getSelections(),l.action===da||l.action===ca?(c=[],k.tp(l.index)?n(b,function(a,b){var d,e;if(b.col===-1)for(d=k.Tq(b),e=0;e<Ha(d);e++)c.push({row:d.row+e})}):c.push({row:l.index}),k.wu().execute({cmd:"autoFitRow",sheetName:k.name(),rows:c,columnHeader:1===l.sheetArea})):(d=[],k.sp(l.index)?n(b,function(a,b){var c,e;if(b.row===-1)for(c=k.Tq(b),e=0;e<Ga(c);e++)d.push({col:c.col+e})}):d.push({col:l.index}),k.wu().execute({cmd:"autoFitColumn",sheetName:k.name(),columns:d,rowHeader:2===l.sheetArea})),!0):(e=a.row,f=a.col,g=a.hitTestType,h=k.rr(a.rowViewportIndex,a.colViewportIndex,a.hitTestType,a.row,a.col),h&&(e=h.row,f=h.col),i=void 0,j=k.getFormula&&k.getFormula(e,f,g,!0),j&&(i="="+j),k.EF(k.Xs,e,f,a.rowViewportIndex,a.colViewportIndex,!1,i,!1),!1)},a}(),b.iI=ma,e.Worksheet.$n("eventHandler",{beforeSetHost:function(){var a=this;a.mm=new ma(a)},dispose:function(a){var b,c,d,e,f=this,g=f.mm;g&&(g.uC(),b=g.rIb,h.GC$(f.Ws()).unbind(x+"."+b).unbind(y+"."+b).unbind(z+"."+b).unbind(A+"."+b).unbind(D+"."+b).unbind(E+"."+b),o.mozilla&&(c="onwheel"in document?C:B,h.GC$(f.Ws()).unbind(c+"."+b)),g.no(),g.MF()),d=f.BF,d&&h.GC$(d).remove(),e=f.NF,e&&(e.close(),f.NF=null),a.clearCache!==!1&&(f.OF=F,f.PF=F,f.QF=F,f.RF=F,f.SF=F,f.TF=F,f.mm=F)},setHost:function(a){var b,c,d,f;function g(a,c){var d=b.Vs(),e=c.pageX-d.left,f=c.pageY-d.top,g=b.hitTest(e,f),h=g.dragInfo;g.tableSelectInfo||(h&&a.cyb&&"corner"===h.side?a.cyb():a.UF(c,e,f))}a&&(b=this,c=b.mm,b.OF=function(a){var d={e:a,r:F};if(e.Worksheet.ao(b,"preProcessMouseDown",d),!d.r)return c.AD(a)},b.PF=function(a){var d={e:a,r:F};e.Worksheet.ao(b,"preProcessMouseMove",d),d.r||c.RB||c.BD(a)},b.QF=function(a){var d={e:a,r:F};if(e.Worksheet.ao(b,"preProcessMouseUp",d),!d.r&&!b.XD){if(c.RB)return;return c.CD(a)}},b.RF=function(a){var c,d,f,g,h,i,j,k,m,n,p,q;if(a=a||l.event,c={e:a,r:F},e.Worksheet.ao(b,"preProcessMouseWheel",c),!c.r)return d=b.parent,f=d&&d.options.scrollByPixel,g=a.detail?a.detail:a.wheelDelta/-40,h=0,"wheel"===a.type?(i=17,j=o.mozilla&&+o.version>=88?i:1,g=a.deltaY/j,h=a.deltaX/j,f||(M(g)>=M(h)?h=0:g=0)):(k=(new Date).valueOf(),m=a.wheelDeltaY,n=a.wheelDeltaX,f||(M(m)>=M(n)?n=0:m=0),p=!b.nka||k-b.nka>200,(o.safari||o.chrome)&&(j=o.safari?-4:-40,v(m)||(p?(g=m/j,g=(g>=0?1:-1)*K(M(g)),b.oka=0):(g=m/j,b.oka+=g,g=(g>=0?1:-1)*K(M(b.oka)),b.oka-=g)),v(n)||(p?(h=n/j,h=(h>=0?1:-1)*K(M(h)),b.pka=0):(h=n/j,b.pka+=h,h=(h>=0?1:-1)*K(M(b.pka)),b.pka-=h))),b.nka=k),(0!==g||0!==h)&&(q=b.parent.ku.Rw(b,a,I(g,10)||0,I(h,10)||0),d.xw(),!!q&&void 0)},b.SF=function(a){var d={e:a,r:F};if(e.Worksheet.ao(b,"preProcessMouseOut",d),!d.r)return c.DD(a)},b.TF=function(a){var d,f,h={e:a,r:F};e.Worksheet.ao(b,"preProcessMouseDbClick",h),h.r||(d=b.yt,d&&(f=!1,3===ya(d)?g(c,a):f=c.k$J(d),f||b.Wq(i.Events.CellDoubleClick,Ma(b,b.name(),d.row,d.col,ya(d)))))},d=c.rIb,a.bind(x+"."+d,function(a){return b.OF(a)}).bind(y+"."+d,function(a){return b.QF(a)}).bind(z+"."+d,function(a){return b.PF(a)}).bind(A+"."+d,function(a){return b.RF(a)}).bind(D+"."+d,function(a){return b.SF(a)}).bind(E+"."+d,function(a){return b.TF(a)}),o.mozilla&&(f="onwheel"in document?C:B,a.bind(f+"."+d,function(a){return b.RF(a)})))}}),k.DC.$n("worksheet-event",{preProcessMouseMove:function(a){var b,c=this.OC.getActiveSheet();c&&(b=c.mm,b&&b.eG&&b.OG&&b.isResizing&&(b.BD(a.e),a.r=!1))}})},"./dist/core/worksheet/worksheet-formatter.js":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/domUtil.js"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/worksheet/style.js"),g=c("./dist/core/util/common.js"),h=c("Common"),d.GC$.extend(e.Worksheet.prototype,{getFormatter:function(a,b,c){return this.tq(a,b,"formatter",c)},setFormatter:function(a,b,c,d){var e=this.Iq(a,b,d);e||(e=new f.Style),e.formatter=c,this.setStyle(a,b,e,d)}}),e.Worksheet.$n("formatter",{settingText:function(a){var b,c=g.util.tl(a.value),d=h.Formatter&&h.Formatter.GeneralFormatter;d&&c&&(b={},(new d).getPreferredDisplayFormatter(a.value,b),"number"==typeof b.value&&(a.value=b.value))}})},"./dist/core/worksheet/worksheet-json.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/worksheet/style.js"),g=f.Style.kxb,h=c("./dist/core/util/common.js"),i=c("./dist/core/util/theme.js"),j=c("./dist/core/util/domUtil.js"),k=c("./dist/core/worksheet/stylehelper.js"),l=c("./dist/core/core.enum.js"),m=c("@grapecity/js-calc"),n=c("./dist/core/excel-io-util/common.js"),o=c("./dist/core/excel-io-util/range-parser.js"),p=c("./dist/core/excel-io-util/excel-types.js"),q=c("./dist/core/core.ns.js"),r=void 0,s=new d.Common.ResourceManager(q.SR,"Sheets"),t=s.getResource.bind(s),u=h.UsedRangeUtil.updateUsedRangeByData,v={L7:16384,M7:1048576},w=!!m,x=d.Common.CultureManager,y=e.Worksheet._n,z=h.util.Ol,A=j.GC$.each,B=j.GC$.isEmptyObject,C=d.Common.D,D=d.Common.j.Fa,E=n.IndexHelper.R9,F=n.IndexHelper.Q9,G=n.IndexHelper.P9,H=h.util.oaa,I=n.Util.ZaK,J=h.util.NcK,K=h.util.JcK,L=h.util.IcK,M=h.util.McK,N=h.util.naa,O=h.util.QcK,P=h.util.PcK,Q=o.range_parser.DcK,R=o.range_parser.CcK,S=o.range_parser.EcK,T=o.range_parser.FcK,U=d.Common.u,V=n.Util.Hea,W=n.Util.KlK,X=p.XFileConstants.bbK,Y=p.XFileConstants.AbK,Z=p.XFileConstants.o7a,$=p.XFileConstants.Xkb,_=p.XFileConstants.BbK,aa=p.XFileConstants.DbK,ba=p.XFileConstants.EbK,ca=p.XFileConstants.FbK,da=p.XFileConstants.GbK,ea=p.XFileConstants.HbK,fa="string",ga=parseInt,ha=isNaN,ia=void 0,ja=null,ka="1",la="0",ma=d.Common.j.C4,function(a){a[a.bottomRight=0]="bottomRight",a[a.topRight=1]="topRight",a[a.bottomLeft=2]="bottomLeft",a[a.topLeft=3]="topLeft"}(na||(na={}));function oa(a,b){return D(a)?b:D(b)?a:Math.max(a,b)}function pa(a,b,c,d){var e,f;if(a.dataTable&&(b.dataTable||(b.dataTable={}),e=a.dataTable[c])){if(b.dataTable[c]||(b.dataTable[c]={}),f=e[d],!f)return;b.dataTable[c][d]||(b.dataTable[c][d]={}),f.formula&&(b.dataTable[c][d].formula=f.formula)}}function qa(a,b,c,d,e){var f,g,i,j=a.ITa,k=j.XTa(),m=j.XTa(l.SheetArea.colHeader),n=j.YTa(!0),o=j.YTa(!0,l.SheetArea.colHeader),p=j.zl(),q=j.zl(l.SheetArea.colHeader),r=k.getColumnCount();for(!e&&D(b.colHeaderData)?b.colHeaderData={}:j.TdK=c,m.setRowCount(c),f=0;f<c;f++)for(m.setNode(f,-1,k.RTa(f,-1)),o.Kp(f,n.Jp(f)),g=d;g<r;g++)m.setNode(f,g,k.RTa(f,g)),e||pa(b.data,b.colHeaderData,f,g);i=p.getSpans(h.kf(0,0,c,r)),i.forEach(function(a){q.add(a)}),a.frozenRowCount(0)}function ra(a,b,c,d,e){var f,g,i,j=a.ITa,k=j.XTa(),m=j.XTa(l.SheetArea.rowHeader),n=j.YTa(!1),o=j.YTa(!1,l.SheetArea.rowHeader),p=j.zl(),q=j.zl(l.SheetArea.rowHeader),r=k.getRowCount();for(!e&&D(b.rowHeaderData)?b.rowHeaderData={}:j.UdK=c,m.setColumnCount(c),f=0;f<c;f++)for(m.setNode(-1,f,k.RTa(-1,f)),o.Kp(f,n.Jp(f)),g=d;g<r;g++)m.setNode(g,f,k.RTa(g,f)),e||pa(b.data,b.rowHeaderData,g,f);i=p.getSpans(h.kf(0,0,r,c)),i.forEach(function(a){q.add(a)}),a.frozenColumnCount(0)}function sa(a,b){switch(a){case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":return 0===b;case"rowCount":return 200===b;case"columnCount":return 20===b;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===b;case"visible":return b===!0}return!1}function ta(a,b){return z(a)?a:b}function ua(a,b,c){z(c)&&b.call(a,c,!1)}function va(a,b,c,d,e,f){y&&A(y,function(g,h){var i=h.fromJson;i&&i.call(a,b,c,d,!z(e)||e,f)})}function wa(a,b){var c,d,e,f,g,h,i,j,k,l=a.ITa.bIb.anchors;for(c in l)if(d=+c,e=l[c],f=b[d],e&&f)for(g in e)h=+g,i=e[g],i&&(j=f[h],j&&(k={row:i.row,rowCount:i.rowCount,col:i.col,colCount:i.colCount,isDynamicArray:!0},i.isValid||(k.isInvalid=!0),j.arrayInfo=k))}function xa(a,b){var c=L(b,Y+"&tabColor");c&&(a.sheetTabColor=O(c))}function ya(a,b,c){Ia(a,b,c),n.Util.lkK(c,a.parent&&a.parent.NjK)&&za(a,c)}function za(a,b){w&&a.Wu.resumeAdjust(),Ma(a,b)}function Aa(a){var b,c,d,f=K(a,Z);return f&&f.ref&&(d=Q(f.ref),d&&(b=d.row+d.rowCount!==e.MAX_ROW_COUNT?d.row+d.rowCount:e.Worksheet.Rp,c=d.col+d.colCount!==e.MAX_COLUMN_COUNT?d.col+d.colCount:e.Worksheet.Sp)),{rowCount:b,colCount:c}}function Ba(a,b){var c,d=a.defaults,e=K(b,ca);e&&(c=e.defaultColWidth,isNaN(c)?(d.colWidth=h.SJSColumnWidthHelper.defaultColumnWidthToPixel(8),d._isExcelDefaultColumnWidth=!0):d.colWidth=h.SJSColumnWidthHelper.columnWidthToPixel(parseFloat(c)),d.rowHeight=h.SJSColumnWidthHelper.pointToPixel(e.defaultRowHeight))}function Ca(a,b,c,d,g,i){var j,k,m,o,p,q,r,s,t,u,v,w,x,y,z,A=L(b,"sheetViews&sheetView"),B=a.ITa,C=a.options,E=!g||g.includeStyles!==!1,F=n.Util.alK(g),G=K(b,ea),H=b.lossless,I=0,J=0;A&&(r=A.topLeftCell,r&&(o=r&&Q(r),I=o?o.row:0,J=o?o.col:0),A.zoomScale&&a.zoom(A.zoomScale/100),s=C.gridline,t=b.lossless&&b.lossless.gridline,t?(s.showHorizontalGridline=!!D(t.showHorizontalGridline)||t.showHorizontalGridline,s.showVerticalGridline=!!D(t.showVerticalGridline)||t.showVerticalGridline):"0"===A.showGridLines&&(s.showHorizontalGridline=!1,s.showVerticalGridline=!1),t&&!D(t.color)?s.color=t.color:A.colorId&&(s.color=h.ColorHelper.getIndexedColor(A.colorId)),"0"===A.showRowColHeaders&&(C.rowHeaderVisible=!1,C.colHeaderVisible=!1),"1"===A.showFormulas&&(C.showFormulas=!0),"1"===A.tabSelected&&a.HHb(!0,!1),u=M(A,"pane"),v=3,E&&u&&u.length>0&&u.forEach(function(e){var f,h,i,j,k=e.state;"frozen"!==k&&"frozenSplit"!==k||(e.topLeftCell&&(m=e.topLeftCell),f=e.xSplit,h=e.ySplit,i=I,j=J,h&&(p=+h+i,a.getRowCount()<=p&&(c=oa(c,p+1))),f&&(q=+f+j,a.getColumnCount()<=q&&(d=oa(d,q+1))),Ga(a,b,g,p,q),h&&f?(o=Q(m),I=o.row||0,J=o.col||0):h&&!f?(o=Q(m),I=o.row||0,J=j):!h&&f&&(o=Q(m),I=i,J=o.col))}),E&&Ha(a,b),c=oa(oa(c,G&&G.rowCount),p),d=oa(oa(d,G&&G.colCount),q),a.setRowCount(c),a.setColumnCount(d),E&&(H&&H.defaultStyle?(w=new f.Style,w.fromJSON(H.defaultStyle,ia,a),a.setDefaultStyle(w)):i.defaultStyle&&a.setDefaultStyle(i.defaultStyle)),x=M(A,"selection"),x&&x.length>0&&x.forEach(function(b){var e,f,g,h=b.activeCell;h&&(e=Q(h),j=e.row,k=e.col,c=oa(c,e.row+1),d=oa(d,e.col+1)),f=b.panel,g=b.sqref,!g||f&&f!==v||(B.selectionModel.selections=R(g),F&&n.Util.JkK(a,B.selectionModel.selections,ia,i))})),y=H?ta(H.rowHeaderColCount,e.Worksheet.Tp):e.Worksheet.Tp,z=H?ta(H.colHeaderRowCount,e.Worksheet.Vp):e.Worksheet.Vp,a.setColumnCount(y,l.SheetArea.rowHeader),a.setRowCount(z,l.SheetArea.colHeader),a.Kr(j||0,k||0,ia,ia,!0),a.showCell(I,J,l.VerticalPosition.top,l.HorizontalPosition.left)}function Da(a,b,c,d,f,g){var i,j=!f||f.includeStyles!==!1,k=a.ITa,l=k.YTa(!1,3),m=K(b,da),n=m&&m.c_,o=k.XTa(3),p=o.l$J,q=W(f);n&&n.length>0&&n.forEach(function(b,f){var i,k,m,n=b.width,r=b.hidden,s=b.outlineLevel,t=o.RTa(-1,f,!0),v=t&&t.style,w=+b.min,x=+b.max,y=ja;for(D(n)||(y=h.SJSColumnWidthHelper.columnWidthToPixel(parseFloat(n)),"1"===r&&0===y&&(y=ia)),r="1"===r&&D(s)?r:ja,q?b.t!==ia?i=c.getOriginNamedStyle(b.t):b.e!==ia&&(i=ma(c.getOriginStyle(b.e))):i=c.getStyle(b.style),p&&u(p.style,-1,f,v,i),i=j&&i?i:ja,1===w&&x===e.MAX_COLUMN_COUNT&&(g.dataEffectByInflate[a.name()]||(g.dataEffectByInflate[a.name()]={}),g.dataEffectByInflate[a.name()].setColumnInfo=function(b){var c,d,e;if(!(b.col<0||b.colCount<=0))for(c=b.col,d=0,e=b.colCount;d<e;d++)y!==ja&&l.setSize(c+d,y),r!==ja&&a.setColumnVisible(c+d,!1),i!==ja&&a.setStyle(-1,c+d,i)}),x=x===e.MAX_COLUMN_COUNT?oa(w,d):+b.max,k=w;k<=x;k++)m=k-1,y!==ja&&l.setSize(m,y),r!==ja&&a.setColumnVisible(m,!1),i!==ja&&a.setStyle(-1,m,i)}),i=b.lossless&&b.lossless.colInfos,i&&i.forEach(function(b,c){D(b)||(b.colTag&&(a.setTag(-1,c,b.colTag),delete b.colTag),l.Kp(c,b))})}function Ea(a,b){var c,d,e=K(b,_);e&&(c=a.spanModels[3],d=e.c_,d.forEach(function(a){var b=Q(a.ref);c.find(b.row,b.col)||c.add(b)}))}function Fa(a,b){var c,d,e,f=K(b,aa);f&&(c=f.c_,c&&(d=a.ITa.sheetModels[3].dataTable,e=b.rels&&b.rels.c_||[],c.forEach(function(b){var c,f,g,h,i,j,k,l=b.ref.split(":"),m=G(l[0]),n=F(l[0]),o=H(b.tooltip);b[X]&&(f=I(e,b[X]),c=H(f&&f.Target)),g=H(b.location),g&&(c?c=c+"#"+g:("#"===g[0]&&(g=g.substr(1)),c="sjs://"+g)),h=d[m]&&d[m][n]&&d[m][n].style,i="hyperlink","string"==typeof h?(j=a.Hq(h),i=j&&j.foreColor):i=h&&h.foreColor,k=b.lossless||{},a.setHyperlink(m,n,{url:c,tooltip:o,linkColor:i,visitedLinkColor:k.visitedLinkColor||"followedHyperlink",drawUnderline:!!D(k.drawUnderline)||k.drawUnderline,command:k.command,target:k.target||0},3)})))}function Ga(a,b,c,d,e){a.frozenRowCount(d),a.frozenColumnCount(e)}function Ha(a,b){var c=b.lossless;c&&(ua(a,a.frozenTrailingRowCount,c.frozenTrailingRowCount),ua(a,a.frozenTrailingColumnCount,c.frozenTrailingColCount),a.BBJ=!z(c.frozenTrailingRowStickToEdge)||c.frozenTrailingRowStickToEdge,a.CBJ=!z(c.frozenTrailingColumnStickToEdge)||c.frozenTrailingColumnStickToEdge,D(c.frozenlineColor)||(a.options.frozenlineColor=c.frozenlineColor))}function Ia(a,b,c){var d=c&&c.frozenColumnsAsRowHeaders,e=c&&c.frozenRowsAsColumnHeaders,f=a.frozenRowCount(),g=a.frozenColumnCount();f>0&&e&&qa(a,ia,f,g,!0),g>0&&d&&ra(a,ia,g,f,!0)}function Ja(a,b){var c,d,e,f=K(b,"sheetProtection"),g=a.protectionOptions;if(f)for(c in f)if(f.hasOwnProperty(c))switch(d=f[c],e="0"===d,c){case p.XFileConstants.O8:a.isProtected="1"===d;break;case"selectLockedCells":g.allowSelectLockedCells=e;break;case"selectUnlockedCells":g.allowSelectUnlockedCells=e;break;case"autoFilter":g.allowFilter=e;break;case"sort":g.allowSort=e;break;case"insertColumns":g.allowInsertColumns=e;break;case"insertRows":g.allowInsertRows=e;break;case"deleteColumns":g.allowDeleteColumns=e;break;case"deleteRows":g.allowDeleteRows=e;break;case"objects":g.allowEditObjects=e;break;default:"1"===f[c]||"0"===f[c]?g[c]="0"===f[c]:"n_"!==c&&"c_"!==c&&(g[c]=f[c])}a.isProtected&&g.allowEditObjects===!0&&"1"===f.objects&&(g.allowEditObjects=!1)}function Ka(a,b){var c={sheetAreaOffset:function(b){!D(b.left)&&(a.sheetAreaOffset.left=b.left),!D(b.top)&&(a.sheetAreaOffset.top=b.top)}};b&&b.sheetOptions&&Object.keys(b.sheetOptions).forEach(function(d){D(b.sheetOptions[d])||(c[d]&&"function"==typeof c[d]?c[d](b.sheetOptions[d]):a[d]=b.sheetOptions[d])})}function La(a){return{rowHeaderAutoText:a.rowHeaderAutoText,colHeaderAutoText:a.colHeaderAutoText,rowHeaderAutoTextIndex:a.rowHeaderAutoTextIndex,colHeaderAutoTextIndex:a.colHeaderAutoTextIndex,allowCellOverflow:a.allowCellOverflow,clipBoardOptions:a.clipBoardOptions,selectionBackColor:a.selectionBackColor,selectionBorderColor:a.selectionBorderColor,sheetAreaOffset:{left:a.sheetAreaOffset.left,top:a.sheetAreaOffset.top}}}function Ma(a,b){var c,d=b&&b.frozenColumnsAsRowHeaders,e=b&&b.frozenRowsAsColumnHeaders;
(d||e)&&(c=a.ITa,e&&z(c.TdK)&&(a.$Bb=!0,a.deleteRows(0,c.TdK)),d&&z(c.UdK)&&a.deleteColumns(0,c.UdK))}function Na(a,b,c,d,e,f){var g,i,j,k,l,m;if(!a)return!1;if(c.col=Math.max(a.getActiveColumnIndex(),0),c.row=Math.max(a.getActiveRowIndex(),0),g=e>0,i=f>0,0===d){if(!g||!i)return!1}else if(1===d){if(!i)return!1;g&&(c.col=f,c.row=0)}else if(2===d){if(!g)return!1;i&&(c.col=0,c.row=e)}if(c.col=Math.min(p.XmlConstants.L7,c.col),c.row=Math.min(p.XmlConstants.M7,c.row),b)if(j=void 0,k=a.getSelections())for(l=0;l<k.length;l++)m=k[l],"object"==typeof m&&(j=new h.Range(m.row>0?m.row:0,m.col>0?m.col:0,m.rowCount>0?m.rowCount:p.XmlConstants.M7,m.colCount>0?m.colCount:p.XmlConstants.L7),b.push(j));else b.push(new h.Range(c.row,c.col,1,1));return!0}function Oa(a,b,c){var d,e,f,g,i,j,k,l,m,o,q,r,s,t,u,v,w,x,y=a.getSelections();if(y&&0!==y.length)for(d=c?a.frozenRowCount():0,e=c?a.frozenColumnCount():0,f=[],g=new h.Range(0,0,1,1),i=0,j=1,k=-1,l=3;l>=0;l--)if(f.length=0,Na(a,f,g,l,d,e)){for(j=f.length,i=0;i<j;i++)m=f[i],m.col!==-1&&m.colCount!==-1||(m=new h.Range(m.row,0,m.rowCount,p.XmlConstants.L7)),m.row!==-1&&m.rowCount!==-1||(m=new h.Range(0,m.col,p.XmlConstants.M7,m.colCount)),g.col>=m.col&&g.col<=m.col+m.colCount-1&&g.row>=m.row&&g.row<=m.row+m.rowCount-1&&(k=i);if(k<0&&j>0&&(g.row=f[0].row,g.col=f[0].col),o=""+V(g.col)+(g.row+1),q="",e>0&&d>0&&(1===l||2===l))q=o;else{for(i=0;i<j;i++)r=f[i],s=Math.min(p.XmlConstants.M7,r.row+1),t=Math.min(r.col,p.XmlConstants.L7),q+=""+V(t)+s,(r.colCount>1||r.rowCount>1)&&(u=Math.min(t+r.colCount-1,p.XmlConstants.L7),v=Math.min(s+r.rowCount-1,p.XmlConstants.M7),w=""+V(u)+v,q+=":"+w),q+=" ";q=q.trim()}n.StringEx.M9(q)||3===l&&(e>0||d>0||3!==l)||(x={n_:"selection"},3!==l&&(x.pane=na[l]),x.activeCell=o,0!==k&&0===l&&(x.activeCellId=""+k),x.sqref=q,b.c_.push(x))}}function Pa(a,b,c,d){var e,f;e=b&&b.theme?b.theme:d.theme,f=new i.Theme((void 0)),c&&e?e&&f.cdK(e):f.cdK("Office"),a.currentTheme(f)}function Qa(a,b){a&&(a[b]=2)}j.GC$.extend(e.Worksheet.prototype,{qI:function(a,b,c,d,e){var f,g;a[b]||(a[b]={}),f=a[b],f[c]||(f[c]={}),g=f[c],e&&!D(g.value)||(g.value=d)},_dK:function(a,b,c,d,e){var f,g,h=K(a,ea),i=h[b];switch(i||(i=h[b]={}),f=i[c],f||(f=i[c]={}),g=typeof d){case"boolean":f.b=d?1:0;break;case"string":f.v=e.getTextIndex(d);break;case"object":d&&d.richText?f.v=e.getTextIndex(d):f.v=d;break;default:f.n=d}},ufc:function(a,b){var c,d,f,g,h=this,i=h.ITa,j=i.XTa(),k=i.XTa(l.SheetArea.colHeader),m=i.YTa(!0),n=i.YTa(!0,l.SheetArea.colHeader),o=i.zl(),p=i.zl(l.SheetArea.colHeader),q=h.rowFilter(),r=j.getColumnCount();for(c=0;c<a;c++)for(j.setNode(c,-1,k.RTa(c,-1)),m.Kp(c,n.Jp(c)),d=b;d<r;d++)f=k.RTa(c,d),f||(f={}),f.style=h.getActualStyle(c,d,l.SheetArea.colHeader),j.setNode(c,d,f),g=h.getFormula(c,d,l.SheetArea.colHeader),g&&h.setFormula(c,d,g,l.SheetArea.viewport);p.getSpans().forEach(function(a){o.add(a)}),q&&q.range&&q.range.row===-1&&(q.qKJ=!0),h.frozenRowCount(a),i.dWa(e.Worksheet.Vp,r,l.SheetArea.colHeader),i.fWa(!1,l.SheetArea.colHeader),i.eWa(l.SheetArea.colHeader),h.Bj(l.SheetArea.colHeader).clearAll()},tfc:function(a,b){var c,d,f,g,h=this,i=h.ITa,j=i.XTa(),k=i.XTa(l.SheetArea.rowHeader),m=i.YTa(!1),n=i.YTa(!1,l.SheetArea.rowHeader),o=i.zl(),p=i.zl(l.SheetArea.rowHeader),q=j.getRowCount();for(c=0;c<a;c++)for(j.setNode(-1,c,k.RTa(-1,c)),m.Kp(c,n.Jp(c)),d=b;d<q;d++)f=k.RTa(d,c),f||(f={}),f.style=h.getActualStyle(d,c,l.SheetArea.rowHeader),j.setNode(d,c,f),g=h.getFormula(d,c,l.SheetArea.rowHeader),g&&h.setFormula(d,c,g,l.SheetArea.viewport);p.getSpans().forEach(function(a){o.add(a)}),h.frozenColumnCount(a),i.dWa(q,e.Worksheet.Tp,l.SheetArea.rowHeader),i.fWa(!1,l.SheetArea.rowHeader),i.eWa(l.SheetArea.rowHeader),h.Bj(l.SheetArea.rowHeader).clearAll()},toJSON:function(a){var b,c,d,f,g,i,j,m,n,o,p,q,r,s,t,u,v,w,x,z,E,F,G,H,I=this,J=a&&a.ignoreStyle;!a||a.sfc||I.ODJ||(b=I.getRowCount(l.SheetArea.colHeader),c=I.getColumnCount(l.SheetArea.rowHeader),d=a.rowHeadersAsFrozenColumns,f=a.columnHeadersAsFrozenRows,g=d&&c>0,i=f&&b>0,g&&I.addColumns(0,c),i&&I.addRows(0,b,i),g&&I.tfc(c,i?b:0),i&&I.ufc(b,g?c:0)),j=I.getRowCount(),m=I.getColumnCount(),n=I.getRowCount(l.SheetArea.colHeader),o=I.getColumnCount(l.SheetArea.rowHeader),p={name:a&&a.newWorkSheetName||I.name(),isSelected:I.HHb(),rowCount:j,columnCount:m,activeRow:I.Jl,activeCol:I.Kl,zoomFactor:I.zoom(),rowHeaderColCount:o,colHeaderRowCount:n,visible:I.visible()},q=I.getDockScrollbarAttachedIndex(),D(q)||(p.dockScrollbarAttachedIndex=q),J||(p.frozenRowCount=I.frozenRowCount(),p.frozenColCount=I.frozenColumnCount(),p.frozenTrailingRowCount=I.frozenTrailingRowCount(),p.frozenTrailingColCount=I.frozenTrailingColumnCount(),p.frozenTrailingRowStickToEdge=I.BBJ,p.frozenTrailingColumnStickToEdge=I.CBJ,p.theme=I.Pm.toJSON()),r=I.ITa,s=r.toJSON(a);for(t in s)p[t]=s[t];y&&A(y,function(b,c){c.toJson&&c.toJson.call(I,p,a)}),u={};for(v in p)C(p,v)&&(w=p[v],D(w)||sa(v,w)||(u[v]=w));if(wa(I,p.data.dataTable),A(I.options,function(a,b){var c,d,f,g=b;"gridline"===a&&(g={},c=b.color,d=b.showHorizontalGridline,f=b.showVerticalGridline,c&&c!==h.Im.Lm("gc-gridlineColor").borderTopColor&&(g.color=c),d===!1&&(g.showHorizontalGridline=d),f===!1&&(g.showVerticalGridline=f)),"sheetAreaOffset"===a&&(g={},b.left&&(g.left=b.left),b.top&&(g.top=b.top)),"_ps"===a||D(g)||e.Worksheet.Qp[a]===g||"object"==typeof g&&B(g)||(u[a]=g)}),x=[],z=I.Lq,z){for(E in z)C(z,E)&&(F=z[E],F&&(G=F.toJSON(),H=F.font,B(G)||(H&&(G.font=k.To.Jo(H)),x.push(G))));x.length>0&&(u.namedStyles=x)}return u},fromJSON:function(a,b,c,d,h){var j,k,m,n,o,p,q,r,s,t,u,v,y,A,B,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$;if(c&&(j=c.noSchema,k=c.version),a){m=this,n=m.ITa,o=d&&d.ignoreStyle,m.T3(),e.Worksheet.ao(m,"preFromJson"),m.suspendPaint(),n.Jgc(),n.Kgc(),p=x.culture(),x.culture(""),q=ta(a.rowCount,e.Worksheet.Rp),r=ta(a.columnCount,e.Worksheet.Sp);try{if(m.cq(a.name+"",!0),m.HHb(a.isSelected),m.setRowCount(q),m.setColumnCount(r),m.Lq={},s=a.namedStyles)for(t=0;t<s.length;t++)u=s[t],v=new f.Style,g(u,m),v.fromJSON(u,j,m),m.Kq(v);y=m.options;for(A in y)if(C(y,A)&&(B=a[A],"protectionOptions"===A?B=B||a.protectionOption:"allowCellOverflow"===A&&(B=z(a[A])?a[A]:!k||k>=11),z(B)))if("object"==typeof B)for(E in B)C(B,E)&&(y[A][E]=B[E]);else"borderWidth"===A?(y.sheetAreaOffset.left=B,y.sheetAreaOffset.top=B):y[A]=B;if(F=ta(a.activeRow,m.Jl),G=ta(a.activeCol,m.Kl),m.Kr(F,G,ia,ia,!0),o||(ua(m,m.frozenRowCount,a.frozenRowCount),ua(m,m.frozenColumnCount,a.frozenColCount),ua(m,m.frozenTrailingRowCount,a.frozenTrailingRowCount),ua(m,m.frozenTrailingColumnCount,a.frozenTrailingColCount),m.BBJ=!z(a.frozenTrailingRowStickToEdge)||a.frozenTrailingRowStickToEdge,m.CBJ=!z(a.frozenTrailingColumnStickToEdge)||a.frozenTrailingColumnStickToEdge),!o){if(H=a.colStyles)for(I in H)ha(I)||m.setStyle(-1,ga(I,10),H[I],l.SheetArea.viewport);if(J=a.rowStyles)for(K in J)ha(K)||m.setStyle(ga(K,10),-1,J[K],l.SheetArea.viewport)}L=ta(a.rowHeaderColCount,e.Worksheet.Tp),M=ta(a.colHeaderRowCount,e.Worksheet.Vp),m.setColumnCount(L,l.SheetArea.rowHeader),m.setRowCount(M,l.SheetArea.colHeader),m.XSa(ta(a._zoomFactor||a.zoomFactor,m.zoom())),a.visible===!1?a.visible=l.SheetTabVisible.hidden:a.visible===!0&&(a.visible=l.SheetTabVisible.visible),ua(m,m.visible,a.visible),N=m.uja,O={sheet:m,setValidator:function(a,b,c){N&&N.vja(a,b,c)},ignoreStyle:o},a.isApplyRefilter||m.yWJ(a),n.fromJSON(a,j,O,m.Wu&&m.Wu.allowDynamicArray),m.defaults=n.defaults,N&&N.QV(!0),P=a.dockScrollbarAttachedIndex,D(P)||m.setDockScrollbarAttachedIndex(P),Q=a.theme,Q&&!o&&(R=Q,typeof R!==fa&&z(R)&&(S="_themeColor",T="_name",U=R.themeColor||R[S],V=new i.ColorScheme(U.name||U[T]),V.fromJSON(U,j),R=new i.Theme(R.name||R.Cj,V,R.headingFont||R.Vaa,R.bodyFont||R.Waa)),m.currentTheme(R)),va(m,a,j,d,b,h),W=d&&d.frozenColumnsAsRowHeaders&&!m.ODJ,X=d&&d.frozenRowsAsColumnHeaders&&!m.ODJ,Y=X?a.frozenRowCount||0:0,Z=W?a.frozenColCount||0:0,X&&Y>0&&qa(m,a,Y,Z),W&&Z>0&&ra(m,a,Z,Y),w&&($=m.yj(),Y>0&&($.pDc=Y),Z>0&&($.qDc=Z)),h||(Y>0&&m.deleteRows(0,Y),Z>0&&m.deleteColumns(0,Z)),m.clearPendingChanges()}finally{x.culture(p),n.Lgc(),m.resumePaint()}}},Wgc:function(a,b,c,d,h){var j,k,m,n,o,p,q,r,s,t,u,v,y,A,B,D,E,F,G,H,I,J,K,L;if(c&&(j=c.noSchema,k=c.version),a){m=this,n=m.ITa,o=d.ignoreStyle,m.T3(),e.Worksheet.ao(m,"preFromJson"),n.Jgc(),n.Kgc(),p=x.culture(),x.culture("");try{if(m.Lq={},q=a.namedStyles)for(r=0;r<q.length;r++)s=q[r],t=new f.Style,g(s,m),t.fromJSON(s,j,m),m.Kq(t);u=m.options;for(v in u)if(C(u,v)&&(y=a[v],"protectionOptions"===v?y=y||a.protectionOption:"allowCellOverflow"===v&&(y=z(a[v])?a[v]:!k||k>=11),z(y)))if("object"==typeof y)for(A in y)C(y,A)&&(u[v][A]=y[A]);else"borderWidth"===v?(u.sheetAreaOffset.left=y,u.sheetAreaOffset.top=y):u[v]=y;if(B=ta(a.activeRow,m.Jl),D=ta(a.activeCol,m.Kl),m.Kr(B,D,ia,ia,!0),o||(ua(m,m.frozenRowCount,a.frozenRowCount),ua(m,m.frozenColumnCount,a.frozenColCount),ua(m,m.frozenTrailingRowCount,a.frozenTrailingRowCount),ua(m,m.frozenTrailingColumnCount,a.frozenTrailingColCount),m.BBJ=!z(a.frozenTrailingRowStickToEdge)||a.frozenTrailingRowStickToEdge,m.CBJ=!z(a.frozenTrailingColumnStickToEdge)||a.frozenTrailingColumnStickToEdge),!o){if(E=a.colStyles)for(F in E)ha(F)||m.setStyle(-1,ga(F,10),E[F],l.SheetArea.viewport);if(G=a.rowStyles)for(H in G)ha(H)||m.setStyle(ga(H,10),-1,G[H],l.SheetArea.viewport)}I=ta(a.rowHeaderColCount,e.Worksheet.Tp),J=ta(a.colHeaderRowCount,e.Worksheet.Vp),m.setColumnCount(I,l.SheetArea.rowHeader),m.setRowCount(J,l.SheetArea.colHeader),m.XSa(ta(a._zoomFactor||a.zoomFactor,m.zoom())),K=m.uja,L={sheet:m,setValidator:function(a,b,c){K&&K.vja(a,b,c)},ignoreStyle:o,incrementalLoading:d.incrementalLoading,incrementLoadTask:d.incrementLoadTask},a.isApplyRefilter||m.yWJ(a),n.fromJSON(a,j,L,m.Wu&&m.Wu.allowDynamicArray,function(){var c,e,f,g,k,l,q,r,s,t,u;m.defaults=n.defaults,K&&K.QV(!0),c=a.theme,c&&!o&&(e=c,typeof e!==fa&&z(e)&&(f="_themeColor",g="_name",k=e.themeColor||e[f],l=new i.ColorScheme(k.name||k[g]),l.fromJSON(k,j),e=new i.Theme(e.name||e.Cj,l,e.headingFont||e.Vaa,e.bodyFont||e.Waa)),m.currentTheme(e)),va(m,a,j,d,b,h),q=d&&d.frozenColumnsAsRowHeaders&&!m.ODJ,r=d&&d.frozenRowsAsColumnHeaders&&!m.ODJ,s=r?a.frozenRowCount||0:0,t=q?a.frozenColCount||0:0,r&&s>0&&qa(m,a,s,t),q&&t>0&&ra(m,a,t,s),w&&(u=m.yj(),s>0&&(u.pDc=s),t>0&&(u.qDc=t)),h||(s>0&&m.deleteRows(0,s),t>0&&m.deleteColumns(0,t)),m.clearPendingChanges(),x.culture(p),n.Lgc(),m.loaded=!0})}finally{}}},bdK:function(a,b,c){var d,e,f,g,i,j,k,m,o,q,s,t,u,w,x,z,B,C,F,G,H,I,K,L,M,O,Q,R,T,U,V,ea,fa,ga,ha,ja,ma,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,Ma,Na,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab=this,Bb=Ab.options,Cb=!c||c.includeStyles!==!1;for(Bb.sheetTabColor&&(d={n_:Y,c_:[P(Bb.sheetTabColor,ia,"tabColor")]}),e=Ab.getRowCount(l.SheetArea.colHeader)||1,f=Ab.getColumnCount(l.SheetArea.rowHeader)||1,g=Ab.ODJ&&(c&&c.fileType)===l.OpenSaveFileType.excel,i=c&&c.rowHeadersAsFrozenColumns,j=c&&c.columnHeadersAsFrozenRows,(i||j||g)&&(k=i&&f>0,m=(j||g)&&e>0,k&&Ab.addColumns(0,f),m&&Ab.addRows(0,e,m),k&&Ab.tfc(f,m?e:0),m&&Ab.ufc(e,k?f:0)),o=Ab.Jl,q=Ab.Kl,s=Bb.gridline,t=Bb.frozenlineColor,u=Ab.zoom(),w=Ab.frozenRowCount(),x=Ab.frozenColumnCount(),z=Ab.getViewportLeftColumn(1),B=Ab.getViewportTopRow(1),Ab.ODJ?C="A1":z!==ia&&B!==ia&&(w||x?x&&!w?C="A"+(B+1):!x&&w&&(C=S(h.kf(0,z,1,1))):C=S(h.kf(B,z,1,1))),F=s&&s.color&&s.color!==h.Im.Lm("gc-gridlineColor").borderTopColor?s&&s.color:ia,F&&(F=h.ColorHelper.getClosestColorIndex(h.ColorHelper.convertHexColorToArgb(F))),G={n_:"sheetView",showGridLines:!s||s.showVerticalGridline!==!1&&s.showHorizontalGridline!==!1?ia:"0",showRowColHeaders:Bb.rowHeaderVisible===!1&&Bb.colHeaderVisible===!1?"0":ia,defaultGridColor:F?0:ia,colorId:F,showFormulas:Bb.showFormulas?"1":ia,topLeftCell:C?C:ia,zoomScale:1===u?ia:Math.round(100*u),workbookViewId:0,tabSelected:Ab.HHb()?"1":ia,c_:[]},H=0,I=0,K=3,L="1",M="A",Cb&&(x>0||w>0)&&(x>0?(H=x,M=E(z)):H=0,w>0?(I=w,L=B+1+""):I=0,x>0&&0===w?K=1:0===x&&w>0?K=2:x>0&&w>0&&(K=0),O={n_:"pane",xSplit:x>0?x:ia,ySplit:w>0?w:ia,topLeftCell:M+L==="A1"?S(h.kf(H,I,1,1)):M+L,activePane:na[K],state:"frozen"},G.c_.push(O)),Oa(Ab,G,Cb),Q=b.styleManager,R=b.sharedStrings,T=Ab.ITa,U=T.bdK(Q,R,c),V=U.sheetData,ea=U.hyperlinks,fa=U.rowHeaderData,ga=U.colHeaderData,ha=U.rowHeaderColInfos,ja=U.colHeaderRowInfos,ma=U.rowHeaderSpan,oa=U.colHeaderSpan,pa=U.defaults,qa=U.selectionPolicy,ra=U.selectionUnit,sa=U.rowInfos,Cb&&(ta=Ab.frozenTrailingRowCount(),ua=Ab.frozenTrailingColumnCount(),va=Ab.BBJ,wa=Ab.CBJ),xa=!Ab.ODJ&&Ab.getDefaultStyle(),ya=Cb&&xa&&xa.toJSON(),za=La(Bb),Aa={rowHeaderData:fa,colHeaderData:ga,rowHeaderColInfos:ha,colHeaderRowInfos:ja,rowHeaderSpan:ma,colHeaderSpan:oa,rowInfos:sa,colHeaderRowCount:e,rowHeaderColCount:f,gridline:s,frozenlineColor:t,defaults:pa,selectionPolicy:qa,selectionUnit:ra,frozenTrailingRowCount:ta,frozenTrailingColCount:ua,frozenTrailingRowStickToEdge:va,frozenTrailingColumnStickToEdge:wa,defaultStyle:ya,sheetOptions:za},Cb&&(Aa.theme=Ab.Pm.bdK()),Ba=T.YTa(!1,3).bdK(c),Ca=T.defaults,Da=Ca.colWidth,Ea=Ca.rowHeight,Fa={n_:ca,defaultRowHeight:h.SJSColumnWidthHelper.pixelToPoint(Ea),defaultColWidth:h.SJSColumnWidthHelper.pixelToColumnWidth(Da),customHeight:Math.abs(76-Ea)>=2?"1":ia},Ga=c&&c.includeEmptyRegionCells===!1,Ha=0,Ia=0,Ja=Ab.getRowCount(),Ka=Ab.getColumnCount(),Ga&&(Ma=l.UsedRangeType.all-l.UsedRangeType.colStyle-l.UsedRangeType.rowStyle-l.UsedRangeType.style-l.UsedRangeType.axis,Na=Ab.getUsedRange(Ma),Na&&(Ha=Na.row,Ia=Na.col,Ja=Na.row+Na.rowCount,Ka=Na.col+Na.colCount)),Pa=[],Qa=Aa.colInfos=[],Ra=W(c),Sa=T.XTa(3),Ta=Ia;Ta<Ka;Ta++)Ua=Sa.RTa(-1,Ta),Va=Ua&&Ua.style,Wa=Ba[Ta],Xa=Ab.getTag(-1,Ta),(Wa||Va||Xa)&&(Ya=Wa&&Wa.size,Za=Wa&&Wa.visible,$a=void 0,_a=void 0,ab=void 0,Cb&&Va&&(Ra?"string"==typeof Va?$a=Q.getOriginNamedStyleIndex(Va):Va!==ia&&(_a=Q.getOriginStyleIndex(Va)):("string"==typeof Va&&0===Va.indexOf(Q.PlK)&&(bb=Va,Va=Ab.Mq(bb,!1),Va||(cb=Ab.parent,Va=cb&&cb.Mq(bb,!1))),ab=Q.getStyleIndex(Va))),(!D(Ya)&&Ya!==Da||Za===!1||Va||$a!==ia||_a!==ia)&&(Pa[Ta]={width:D(Ya)?h.SJSColumnWidthHelper.pixelToColumnWidth(Da):h.SJSColumnWidthHelper.pixelToColumnWidth(Ya),hidden:Za===!1?"1":ia,customWidth:D(Ya)||Ya===Da?ia:1,style:ab,t:$a,e:_a}),Xa&&(Ba[Ta]=Ba[Ta]?Ba[Ta]:{},Ba[Ta].colTag=Xa),Qa[Ta]=Ba[Ta]);for(eb=[],fb=Ab.ITa.spanModels[3].spans,gb={},Ta=0;Ta<fb.length;Ta++)hb=fb[Ta],hb&&(eb.push({n_:p.XFileConstants.CbK,ref:S(hb)}),gb[o+","+q]=hb);for(Cb&&eb.length>0&&(db={n_:_,c_:eb}),ib={n_:p.XFileConstants.cbK,xmlns:p.RelationshipConstants.k9,c_:[]},ea.length>0&&(jb={n_:aa},kb=[],ea.forEach(function(a){var b,c,d,e,f,g,i={n_:p.XFileConstants.uLc,lossless:{}},j=gb[a.row+","+a.col];b=S(j?j:h.kf(a.row,a.col,1,1)),i.ref=b,c=a.hyperlink,d=c.url,d&&(e="sjs://",d.substring(0,e.length)===e?i.location=N(d.replace(e,"")):(f=p.XFileConstants.abK+n.Util.XaK(ib),ib.c_.push({n_:p.XFileConstants.dbK,Id:f,Target:d,Type:p.RelationshipConstants.wcK,TargetMode:p.XFileConstants.zbK}),i[X]=f),g=a.value,"string"==typeof g&&(i.display=N(g))),c.tooltip&&(i.tooltip=N(c.tooltip)),D(c.visitedLinkColor)||(i.lossless.visitedLinkColor=c.visitedLinkColor),D(c.drawUnderline)||(i.lossless.drawUnderline=c.drawUnderline),D(c.command)||(i.lossless.command=c.command),D(c.target)||(i.lossless.target=c.target),kb.push(i)}),jb.c_=kb),Ta=Ha;Ta<Ja;Ta++)lb=Ab.getTag(Ta,-1),(V[Ta]||lb||Ab.getRowVisible(Ta)===!1)&&(V[Ta]||(V[Ta]={r:Ta+1}),Ab.getRowVisible(Ta)===!1&&(V[Ta].v="1"),lb&&(V[Ta].lossless={tag:lb}));for(Ab.options.isProtected&&(mb={n_:"sheetProtection",sheet:ka}),nb=Ab.options.protectionOptions,Object.keys(nb).forEach(function(a){mb||(mb={n_:"sheetProtection"});var b=nb[a]?la:ka;switch(a){case"allowSelectLockedCells":mb.selectLockedCells=b;break;case"allowSelectUnlockedCells":mb.selectUnlockedCells=b;break;case"allowFilter":mb.autoFilter=b;break;case"allowSort":mb.sort=b;break;case"allowInsertColumns":mb.insertColumns=b;break;case"allowInsertRows":mb.insertRows=b;break;case"allowDeleteColumns":mb.deleteColumns=b;break;case"allowDeleteRows":mb.deleteRows=b;break;case"allowEditObjects":mb.objects=b;break;default:nb[a]===!0?mb[a]=la:nb[a]===!1?mb[a]=ka:mb[a]=nb[a]}}),ob=Ab.getRowCount()||1,pb=Ab.getColumnCount()||1,qb={n_:Z,ref:S(h.kf(0,0,ob,pb))},rb={n_:ba,c_:[G]},sb={n_:$,c_:[]},tb={n_:"worksheet",c_:[d,qb,rb,Fa,V,mb,db,jb,sb],rels:ib,tempCols:Pa,lossless:Aa},y&&A(y,function(a,d){d.bdK&&d.bdK.call(Ab,tb,b,c)}),ub=[],Ta=0;Ta<Pa.length;Ta++)if(vb=Pa[Ta]){if(wb=Ta,wb>=v.L7)break;for(xb=Ta+1,yb=wb;xb<Pa.length&&(zb=Pa[xb],zb&&xb===yb+1&&xb<v.L7&&zb.style===vb.style&&zb.hidden===vb.hidden&&zb.outlineLevel===vb.outlineLevel&&zb.collapsed===vb.collapsed&&Math.abs(zb.width-vb.width)<=1e-4&&zb.t===vb.t&&zb.e===vb.e);)yb=xb,Ta=xb,xb++;Wa={n_:"col",min:wb+1+"",max:yb+1+""},vb.style!==r&&(Wa.style=vb.style+""),vb.t!==r&&(Wa.t=vb.t+""),vb.e!==r&&(Wa.e=vb.e+""),isNaN(vb.width)||vb.width===r||(Wa.width=vb.width+""),Wa.hidden=vb.hidden,vb.collapsed&&(Wa.collapsed="1"),!isNaN(vb.width)&&Math.abs(vb.width-Ab.defaults.colWidth)>1e-4&&(Wa.customWidth="1"),"number"==typeof vb.outlineLevel&&0!==vb.outlineLevel&&(Wa.outlineLevel=vb.outlineLevel+""),ub.push(Wa)}return ub.length>0&&tb.c_.push({n_:da,c_:ub}),delete tb.tempCols,J(tb,p.WorkSheetNodeOrder),tb},vlK:function(a,b,c,d){var e,f,g,h,i,j,k,m,n,o=this,p=o.options,q=K(a,ea),r=a.lossless;xa(p,a),e=Aa(a),f=e.rowCount,g=e.colCount,q&&(c.fileType===l.OpenSaveFileType.excel?(D(q.rowCount)||(f=Math.max(q.rowCount,f||0)),D(q.colCount)||(g=Math.max(q.colCount,g||0))):(D(q.rowCount)||(f=q.rowCount),D(q.colCount)||(g=q.colCount))),h=o.parent,i=h&&h.getSheetIndex(o.name()),j=b.sheetNamedStyles,j[i]&&j[i].forEach(function(a){delete a.sheetId,o.addNamedStyle(a)}),k=o.ITa,Ba(k,a),Ca(o,a,f,g,c,b),m=!c||c.includeStyles!==!1,Pa(o,r,m,b),n=b.styleManager,Da(o,a,n,g,c,b),Ka(p,r),k.cdK(q,b,c,r,function(){m&&Ea(k,a),Fa(o,a),Ja(p,a),y&&A(y,function(e,f){f.cdK&&f.cdK.call(o,a,b,c,d)});var e=h&&h.NjK,f=e&&e.sheetsState;d?(o.BHb=!0,Qa(f,o.name()),ya(o,a,c)):c.incrementLoadTask.addTask(function(a,b,c,d){a.BHb=!0,Qa(d,a.name()),ya(a,b,c)},[o,a,c,f])},d,o.Wu&&o.Wu.allowDynamicArray)},cdK:function(a,b,c,d){var e,f,g=this;d?g.vlK(a,b,c,d):(c||(c={}),c.progress||(c.progress=function(a){}),c.loadStatus||(c.loadStatus={total:0,valuesLoad:0,formulaLoad:0}),e=n.Util.lkK(c,g.parent&&g.parent.NjK),f=0===c.incrementLoadTask.tasks.length,c.incrementLoadTask.addTask(function(a,b,c){g.vlK(a,b,c)},[a,b,c],U.Kb(t().STEP.loadSheetData,[g.name()]),function(){var a=c.loadStatus.valuesLoad/c.loadStatus.total;return e?.2:c.fullRecalc?a*n.STEP_RATE.loadSheetDataWithCalc+ +n.STEP_RATE.parseFile+n.STEP_RATE.loadFileData:a*n.STEP_RATE.loadSheetData+n.STEP_RATE.parseFile+n.STEP_RATE.loadFileData},g.name()),f&&c.incrementLoadTask.start())}})},"./dist/core/worksheet/worksheet-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),oa=this&&this.__assign||function(){return oa=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},oa.apply(this,arguments)},pa=this&&this.__rest||function(a,b){var c,d,e={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.indexOf(c)<0&&(e[c]=a[c]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(d=0,c=Object.getOwnPropertySymbols(a);d<c.length;d++)b.indexOf(c[d])<0&&(e[c[d]]=a[c[d]]);return e};Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/worksheet/style.js"),f=c("Common"),g=c("@grapecity/js-calc"),h=c("@grapecity/js-calc"),i=c("./dist/core/util/common.js"),j=c("./dist/core/util/common.js"),k=c("./dist/core/util/domUtil.js"),l=c("./dist/core/core.enum.js"),m=c("./dist/core/celltype/celltype.ns.js"),n=c("./dist/core/excel-io-util/common.js"),o=c("./dist/core/excel-io-util/excel-types.js"),p=!!g,q=k.GC$.each,r=k.GC$.isEmptyObject,s=k.GC$.extend,t=RegExp("^\\d*(\\.\\d+)?\\*$"),u=null,v=void 0,w="string",x=Math.min,y=Math.floor,z=Math.max,A=Math.ceil,B="dirtyNodes",C="undo",D="rowInfos",E="colInfos",F="default_size",G=f.Common.A,H=f.Common.B,I=f.Common.j.Fa,J=f.Common.u,K=j.util.K_a,L=j.util.n0a,M=j.util.lHb,N=f.Common.j.C4,O=f.Common.j.Na,P=200,Q=20,R="bindingPath",S=j.UsedRangeUtil.SZJ,T=j.UsedRangeUtil.RZJ,U=j.UsedRangeUtil.updateUsedRangeByData,V=new f.Common.ResourceManager(d.SR,"Sheets"),W=V.getResource.bind(V);function qa(a,b){return I(a)?b:a}function ra(a,b){return a.hasOwnProperty(b)}function sa(a){return"number"==typeof a}function ta(a){return a.rowCount}function ua(a){return a.colCount}function va(a,b,c,d){var e=c;Object.defineProperty(a,b,{get:function(){return e},set:function(a){var c=e;e=a,d(this,a,b,c)}})}function wa(a,b){a.cache={},b&&b.forEach(function(b){xa(a,b)})}function xa(a,b){var c,d;if(a.Ef=z(a.Ef,b.row+ta(b)-1),a.Ff=z(a.Ff,b.col+ua(b)-1),!a.suspendUpdatingCache)for(c=0;c<b.rowCount;c++)for(d=0;d<b.colCount;d++)a.cache[b.row+c+"_"+(b.col+d)]=b}function ya(a,b){var c,d;if(!a.suspendUpdatingCache)for(c=0;c<b.rowCount;c++)for(d=0;d<b.colCount;d++)a.cache[b.row+c+"_"+(b.col+d)]=v}X=function(){function a(){va(this,"spans",[],wa),this.Ff=-1,this.Ef=-1,this.cache={},this.suspendUpdatingCache=!1}return a.prototype.find=function(a,b){return this.cache[a+"_"+b]||u},a.prototype.get=function(a,b){return this.find(a,b)||j.kf(a,b,1,1)},a.prototype.remove=function(a,b){var c=this.spans.indexOf(a);c>=0?(b&&(b[0].push("spans"),b[1]=[].concat(this.spans)),this.removeSpan(c,1),b&&(b[2]=[].concat(this.spans))):b&&(b.length=0)},a.prototype.removeSpan=function(a,b){for(var c=0;c<b;c++)ya(this,this.spans[a+c]);this.spans.splice(a,b)},a.prototype.update=function(a,b){var c=this;ya(c,c.spans[a]),c.spans[a]=b,xa(c,b)},a.prototype.add=function(a,b){b&&(b[0].push("spans"),b[1]=[].concat(this.spans)),xa(this,a),this.spans.push(a),b&&(b[2]=[].concat(this.spans))},a.prototype.Zz=function(a,b,c,d,e,f,g){var h,i,k,l,m,n,o,p=this,q=!1;for(g&&(h=[].concat(p.spans)),i=p.spans.length,o=[],n=0;n<i;n++)k=p.spans[n],m=k.col,l=k.row,(a===-1||a<=l&&l<a+e)&&(b===-1||b<=m&&m<b+f)?(o.push(j.kf(a===-1?l:c+l-a,b===-1?m:d+m-b,ta(k),ua(k))),q=!0):(a===-1||c<=l&&l<c+e)&&(b===-1||d<=m&&m<d+f)&&(p.removeSpan(n,1),n--,i--,q=!0);for(n=0;n<o.length;n++){if(k=o[n],!p.LTa(p.spans,0,p.spans.length,k))throw Error(W().Exp_OverlappingSpans);p.add(k)}g&&(q?(g[0].push("spans"),g[1]=h,g[2]=[].concat(p.spans)):g.length=0)},a.prototype.LTa=function(a,b,c,d){for(var e=b;e<c&&e<a.length;e++)if(a[e].intersect(d.row,d.col,ta(d),ua(d)))return!1;return!0},a.prototype.getSpans=function(a){var b,c,d,e=this.spans;if(!a)return[].concat(e);for(b=[],c=0;c<e.length;c++)d=e[c],d.intersect(a.row,a.col,ta(a),ua(a))&&b.push(d);return b},a.prototype.qu=function(a,b,c,d){var e,f,g=this.spans;for(e=0;e<g.length;e++)if(f=g[e],f.intersect(a,b,c,d)&&(a!==-1&&(f.row<a||f.row+ta(f)>a+c)||b!==-1&&(f.col<b||f.col+ua(f)>b+d)))return!0;return!1},a.prototype.MTa=function(a,b,c,d){var e,f,g=!1,h=this.spans;for(e=0,f=h.length;e<f;e++){if(a>=0||b>=0)for(;e<f&&!h[e].intersect(a,b,c,d);)e++;if(e<f){g=!0;break}}return g},a.prototype.$b=function(a,b,c,d,e){var f,g,h,i,j,k=this.spans,l=!1;for(e&&(f=[].concat(k)),g=0;g<k.length;g++)h=k[g],i=h.row,j=h.col,(a===-1||a<=i&&i<a+c)&&(b===-1||b<=j&&j<b+d)&&(this.removeSpan(g,1),g--,l=!0);e&&(l?(e[0].push("spans"),e[1]=f,e[2]=[].concat(this.spans)):e.length=0)},a.prototype.aB=function(a,b,c,d,e,f,g){var h,i,k,l,m,n,o,p,q,r=this,s=!1;for(g&&(h=[].concat(r.spans)),i=[],k=[],l=r.spans.length,p=0;p<l;p++)m=r.spans[p],n=m.row,o=m.col,(a===-1||a<=n&&n<a+e)&&(b===-1||b<=o&&o<b+f)?(q=j.kf(a===-1?n:c+n-a,b===-1?o:d+o-b,ta(m),ua(m)),k.push(q),s=!0):(a===-1||c<=n&&n<c+e)&&(b===-1||d<=o&&o<d+f)?s=!0:i.push(m);if(s){if(k.length>0)for(p=0;p<k.length;p++){if(q=k[p],!r.LTa(i,0,i.length,q))throw Error(W().Exp_OverlappingSpans);i.push(q)}for(r.spans.length=0,r.cache={},p=0;p<i.length;p++)r.add(i[p]);g&&(g[0].push("spans"),g[1]=h,g[2]=[].concat(r.spans))}else g&&(g.length=0)},a.prototype.NTa=function(a,b,c){var d,e,f,g,h,i,k,l,m,n=this,o=n.spans;for(n.suspendUpdatingCache=!0,d=!1,c&&(e=[].concat(o)),f=o.length,g=0;g<f;g++)h=o[g],i=h.row,k=h.col,l=ta(h),m=ua(h),i>=a?(n.update(g,j.kf(i+b,k,l,m)),d=!0):a<i+l&&(n.update(g,j.kf(i,k,l+b,m)),d=!0);n.suspendUpdatingCache=!1,d&&wa(n,o),c&&(d?(c[0].push("spans"),c[1]=e,c[2]=[].concat(n.spans)):c.length=0)},a.prototype.OTa=function(a,b,c){var d,e,f,g,h,i,k,l,m,n=this,o=n.spans;for(n.suspendUpdatingCache=!0,d=!1,c&&(e=[].concat(o)),f=o.length,g=0;g<f;g++)h=o[g],i=h.row,k=h.col,l=ta(h),m=ua(h),k>=a?(n.update(g,j.kf(i,k+b,l,m)),d=!0):a<k+m&&(n.update(g,j.kf(i,k,l,m+b)),d=!0);n.suspendUpdatingCache=!1,d&&wa(n,o),c&&(d?(c[0].push("spans"),c[1]=e,c[2]=[].concat(n.spans)):c.length=0)},a.prototype.PTa=function(a,b,c){var d,e,f,g,h,i,k,l,m,n,o,p,q=this,r=q.spans;for(q.suspendUpdatingCache=!0,d=!1,c&&(e=[].concat(r)),f=[],g=r.length,h=0;h<g;h++)i=r[h],k=i.row,l=i.col,m=ta(i),n=ua(i),k>=a?k<a+b?k+m<=a+b?(f.push(h),d=!0):(q.update(h,j.kf(a,l,k+m-(a+b),n)),d=!0):(q.update(h,j.kf(k-b,l,m,n)),d=!0):a<k+m&&(o=j.kf(k,l,m-x(k+m-a,b),n),q.update(h,o),1===o.rowCount&&1===o.colCount&&f.push(h),d=!0);for(h=f.length-1;h>=0;h--)p=f[h],q.removeSpan(p,1);q.suspendUpdatingCache=!1,d&&wa(q,r),c&&(d?(c[0].push("spans"),c[1]=e,c[2]=[].concat(q.spans)):c.length=0)},a.prototype.QTa=function(a,b,c){var d,e,f,g,h,i,k,l,m,n,o,p,q=this,r=q.spans;for(q.suspendUpdatingCache=!0,d=!1,c&&(e=[].concat(r)),f=[],g=r.length,h=0;h<g;h++)i=r[h],k=i.row,l=i.col,m=ta(i),n=ua(i),l>=a?l<a+b?l+n<=a+b?(f.push(h),d=!0):(q.update(h,j.kf(k,a,m,l+n-(a+b))),d=!0):(q.update(h,j.kf(k,l-b,m,n)),d=!0):a<l+n&&(o=j.kf(k,l,m,n-x(l+n-a,b)),q.update(h,o),1===o.rowCount&&1===o.colCount&&f.push(h),d=!0);for(h=f.length-1;h>=0;h--)p=f[h],q.removeSpan(p,1);q.suspendUpdatingCache=!1,d&&wa(q,r),c&&(d?(c[0].push("spans"),c[1]=e,c[2]=[].concat(q.spans)):c.length=0)},a.prototype.toJSON=function(){var a=[].concat(this.spans);return 0===a.length?v:a},a.prototype.fromJSON=function(a,b,c){var d,e,f,g,h,i,k;if(a)for(this.spans=[],d=a,e=0;e<d.length;e++)f=d[e],g=ta(f),h=ua(f),i=I(b)?g:x(g,b),k=I(c)?h:x(h,c),this.add(j.kf(f.row,f.col,i,k))},a}(),Y=function(){function a(){Array.apply(this,arguments)}return a.prototype.pop=function(){return u},a.prototype.push=function(a){return 0},a.prototype.splice=function(a,b){var c,d=[];for(c=2;c<arguments.length;c++)d[c-2]=arguments[c];return u},a.prototype.slice=function(a,b){return null},a}(),Y.prototype=[],Z=function(a){na(b,a);function b(){var b=a.call(this)||this;return b.headingOverflowLayouts=u,b.trailingOverflowLayouts=u,b}return b.prototype.find=function(a){var b,c,d=this,e=d.length,f=[];for(c=0;c<e;c++)b=d[c],b.contains(a)&&f.push(b);return f},b}(Y),b.np=Z,$=function(){function a(a,b,c,d,e,f,g,h,i){var j=this;j.column=a,j.startColumn=b,j.endColumn=c,j.valueWidth=d,j.columnWidth=e,j.backgroundWidth=f,j.backgroundLeftWidth=g,j.backgroundRightWidth=h,j.expandedWidth=i}return a.prototype.contains=function(a){return a>=this.startColumn&&a<=this.endColumn},a}(),b.op=$;function za(a,b,c){var d,e,f,g,h=j.kf(-1,-1,-1,-1);return a&&(d=a.col,e=a.row,f=e===-1,g=d===-1,h.row=f?0:e,h.rowCount=f?b:ta(a),h.col=g?0:d,h.colCount=g?c:ua(a)),h}_=function(){function a(){this.selections=[],this.selectionPolicy=2,this.selectionUnit=0}return a.prototype.getProperty=function(a){return this[a]},a.prototype.setProperty=function(a,b,c){c&&(c[0].push(a),c[1]=this[a],c[2]=b),this[a]=b},a.prototype.clear=function(a){a&&(a.push(["selections",this.get()]),a.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=[],this.activeSelectedRangeIndex=-1},a.prototype.add=function(a,b,c,d,e,f){e&&(e.push(["selections",this.get()]),e.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex]));var g=this,h=g.selectionPolicy,i=g.selectionUnit;0===h?(c=x(c,1),d=x(d,1),g.clear()):1===h&&g.clear(),1===i?(b=-1,d=-1):2===i&&(a=-1,c=-1),g.selections.push(j.kf(a,b,c,d)),f!==!1&&(g.activeSelectedRangeIndex=g.selections.length-1)},a.prototype.get=function(){return[].concat(this.selections)},a.prototype.set=function(a,b){b&&(b.push(["selections",this.get()]),b.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=a,this.activeSelectedRangeIndex>=a.length&&(this.activeSelectedRangeIndex=0)},a.prototype.toJSON=function(){var a,b=this,c={},d=b.selectionPolicy,e=b.selectionUnit,f=b.activeSelectedRangeIndex,g=b.selections.length;for(2!==d&&(c.selectionPolicy=d),0!==e&&(c.selectionUnit=e),0!==f&&(c.activeSelectedRangeIndex=f),c.length=g,a=0;a<g;a++)c[a]=b.selections[a];return r(c)?v:c},a.prototype.fromJSON=function(a,b,c){var d,e,f,g,h,i,k,l,m=b||P,n=c||Q;if(a){for(f=this,f.clear(),g=a.selectionPolicy,h=a.selectionUnit,i=a.length,I(i)&&(i=1),k=0;k<i;k++)l=a[k],d=x(l?ta(l):1,m),e=x(l?ua(l):1,n),f.selections.push(j.kf(l?l.row:0,l?l.col:0,d,e));f.activeSelectedRangeIndex=a.activeSelectedRangeIndex||0,I(g)||(f.selectionPolicy=g),I(h)||(f.selectionUnit=h)}},a.prototype.sp=function(a){var b,c,d,e=this.selections;for(b=0;b<e.length;b++)if(c=e[b],d=c.col===-1?0:c.col,c.row===-1&&a>=d&&a<d+ua(c))return!0;return!1},a.prototype.tp=function(a){var b,c,d,e=this.selections;for(b=0;b<e.length;b++)if(c=e[b],d=c.row===-1?0:c.row,c.col===-1&&a>=d&&a<d+ta(c))return!0;return!1},a.prototype.vp=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o=!1,p=this.selections,q=f?1:0;for(g=0,h=p.length;g<h&&(i=p[g],j=za(i,d,e),k=j.row,l=j.col,m=k-q<=a&&a<k+ta(j)+q,n=l-q<=b&&b<l+ua(j)+q,3===c||I(c)?o=m&&n:2===c?o=m:1===c?o=n:0===c&&(o=i.row===-1&&i.col===-1),!o);g++);return o},a.prototype.wp=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=this.selections,q=!1;for(f=0;f<p.length&&(g=p[f],h=g.row,i=g.col,j=ta(g),k=ua(g),l=i===-1,m=h===-1,I(c)||3===c||(2===c?(n=m?0:h,q=l&&a>=n&&a<n+j):1===c?(o=l?0:i,q=m&&b>=o&&b<o+k):0===c&&(q=m&&l&&j===d&&k===e),!q));f++);return q},a}();function Aa(a,b,c,d,e,f){var g,h,i=a.length,j=!1,k=[];for(h=0;h<i;h++)if(g=a[h],j=I(b)||I(c)?I(b)?I(c)?I(d)?g.containsY(e):g.containsX(d):g.col===c:g.row===b:g.contains(b,c)){if(!f)return g;k.push(g)}return f&&k.length>0?k:u}function Ba(a,b,c){var d=u,e=a.length,f=!I(b);return e>0&&(d=f?a.findX(b):a.findY(c),d||(d=f&&b<a[0].x||!f&&c<a[0].y?a[0]:a[e-1])),d}aa=function(a){na(b,a);function b(){return a.call(this)||this}return b.prototype.findCell=function(a,b){var c,d,e=this.length;for(d=0;d<e;d++)if(c=this[d],c.contains(a,b))return c;return u},b.prototype.amK=function(){this.xn={}},b.prototype.FW=function(a,b){this.xn[a]=b},b.prototype.findRow=function(a){var b,c,d,e=this.xn;if(e)return e[a];for(b=this.length,d=0;d<b;d++)if(c=this[d],c.row===a)return c;return u},b.prototype.findCol=function(a){var b,c,d=this.length;for(c=0;c<d;c++)if(b=this[c],b.col===a)return b;return u},b.prototype.findLargestRow=function(a){var b,c,d,e,f=this.length;if(0===f)return u;for(b=0,d=0;d<f;d++)e=this[d],e.row===a&&e.height>b&&(b=e.height,c=d);return O(c)&&this[c]},b.prototype.findLargestCol=function(a){var b,c,d,e,f=this.length;if(0===f)return u;for(b=0,d=0;d<f;d++)e=this[d],e.col===a&&e.width>b&&(b=e.width,c=d);return O(c)&&this[c]},b.prototype.findLargestRange=function(a,b){var c,d,e,f,g,h,i,j,k,l=this.length;if(0===l)return u;for(c=a.row,d=a.col,e=a.rowCount,f=a.colCount,h=0,i=0;i<l;i++)if(b)for(j=a.row;j<c+e;j++)k=this[i],k.row===j&&k.height>h&&(h=k.height,g=i);else for(j=a.col;j<d+f;j++)k=this[i],k.col===j&&k.width>h&&(h=k.width,g=i);return O(g)&&this[g]},b.prototype.findX=function(a,b){return Aa(this,v,v,a,v,b);
},b.prototype.findY=function(a){return Aa(this,v,v,v,a)},b.prototype.findNearX=function(a){return Ba(this,a)},b.prototype.findNearY=function(a){return Ba(this,v,a)},b.prototype.findXByExactY=function(a,b,c){var d,e,f,g,h,i=this.findX(a,!0);if(!Array.isArray(i))return i;for(d=i.length,e=c.y,f=c.height,g=d-1;g>=0;g--)if(h=i[g],b>e+h.y*f)return h},b}(Y),b.yp=aa,ba=function(){function a(a,b,c,d,e,f,g,h,i,j){var k=this;k.rowCount=g,k.colCount=h,k.row=a,k.col=b,k.x=c,k.y=d,k.width=e,k.height=f,k.isAutoMerge=i,k.offsetX=j}return a.prototype.contains=function(a,b){var c=this;return a<c.row+ta(c)&&c.row<=a&&b<c.col+ua(c)&&c.col<=b},a.prototype.intersect=function(a){var b=this;return(b.x<0||a.x<b.x+b.width&&b.x<a.x+a.width)&&(b.y<0||a.y<b.y+b.height&&b.y<a.y+a.height)},a.prototype.containsX=function(a){return this.x<=a&&a<this.x+this.width},a.prototype.containsY=function(a){return this.y<=a&&a<this.y+this.height},a}(),b.zp=ba;function Ca(a,b){var c=a.valuesLoad/a.total;return b?.4*c+.1:.3*c+.1}function Da(a,b,c,d,e,f,g,h,i,k,l){var m,n,o,p,q,r,s,t,u,v,w,x,y,z=e&&e.incrementLoadTask;if(z&&!z.isTerminated){for(m=z.isBusyFunc,g=g||0,n=g,o=!1,p=30,q=new Date;n<c;){if(r=b[n])for(s=0;s<d;s++)t=r[s],t&&(o=!0,La(t,a.RTa(n,s,!0),f,n,s,e,i,k,l));if(n++,m&&m())break;if(u=new Date,u-q>p)break}if(o){if(v=e&&e.sheet,0!==g&&v.parent.getActiveSheet()===v)for(w=g;w<n;w++)if(v.as.viewport[1].findRow(w)){v.repaint();break}x=e&&e.incrementalLoading,x&&(x.loadStatus.valuesLoad+=n-g,y=Ca(x.loadStatus,e.doNotRecalculateAfterLoad),v.parent&&v.parent.Wq(j.Events.ProgressChanged,{loadStatus:x.loadStatus,progress:y,sheet:v}),x.loading&&x.loading(y,{sheet:v}))}n<c?e.incrementLoadTask.pushTask(Da,[a,b,c,d,e,f,n,h,i]):h&&e.incrementLoadTask.pushTask(h,[])}}function Ea(a,b,c,d,e,f,g,h,i){var j,k,l,m;for(j=0;j<c;j++)if(k=b[j])for(l=0;l<d;l++)m=k[l],m&&La(m,a.RTa(j,l,!0),f,j,l,e,g,h,i)}function Fa(a,b,c,d,e,f,g,i,j,k,l){var m,o,q,r,s,t,u,w,x,y,z,A,B,C,D,E,F,G,H,K,L,M,O,P,Q,R,S,T,V=n.Util.mkK(e);if(!c)return void(g&&setTimeout(g,0));for(m=a.l$J,o=e&&e.includeStyles===!1,q=n.Util.KlK(e),r=d.styleManager,s=e&&e.incrementLoadTask,t=s.isBusyFunc,u=!1,w=30,V&&(x=new Date),f=f||0,y=f,z=c.rowCount,A=c.colCount;y<z;)if(B=c[y]){for(C=a.RTa(y,-1,!0),D=C&&C.style,E=void 0,C&&!o&&(q?B.t!==v?E=r.getOriginNamedStyle(B.t):B.e!==v&&(E=N(r.getOriginStyle(B.e))):E=r.getStyle(B.s),C.style=E),C&&B.lossless&&B.lossless.tag&&(C.tag=B.lossless.tag),m&&U(m.style,y,-1,D,C&&C.style),F=0;F<A;F++)G=B[F],G!==v&&(u=!0,H=a.RTa(y,F,!0),K=void 0,L=void 0,L=G,L.v!==v?(M=L.v,K="number"==typeof M?d.sharedStrings.getText(M):M&&(M._calcError||M._error&&!I(M._code))?p&&h.CalcError.parse(M._calcError||M._error):M):K=L.b!==v?!!L.b:L.n,I(L.f)&&m&&U(m.data,y,F,H.value,K),I(K)||(H.value=K),O=H.style,q||(I(L.s)&&(E||l[F])?L.s=0:0!==L.s||E||l[F]||(L.s=v)),o||(P=void 0,q?L.t!==v?P=r.getOriginNamedStyle(L.t):L.e!==v&&(P=N(r.getOriginStyle(L.e))):P=r.getStyle(L.s),H.style=P),m&&U(m.style,y,F,O,H.style),L.lossless&&(I(L.lossless.bindingPath)||(H.bindingPath=L.lossless.bindingPath),I(L.lossless.tag)||(H.tag=L.lossless.tag)),y>-1&&cb(H,K,!!L.f||!!L.g||!!L.si,H.style,j,v,k));if(y++,!i&&t&&t())break;if(V&&(Q=new Date,!i&&Q-x>w))break}else y++;if(u){if(0!==f&&b.parent.getActiveSheet()===b)for(R=f;R<y;R++)if(b.as.viewport[1].findRow(R)){b.repaint();break}e.loadStatus.valuesLoad+=y-f,!i&&V&&(S=e.loadStatus.valuesLoad/e.loadStatus.total,T=+(e.fullRecalc?.3*S+.2:.4*S+.2).toFixed(5),e.incrementLoadTask.progress&&e.incrementLoadTask.progress({progress:T,sheetName:b.name(),step:J.Kb(W().STEP.loadSheetData,[b.name()])}))}y<z?e.incrementLoadTask.pushTask(Fa,[a,b,c,d,e,y,g,v,j,k,l]):i?g():g&&e.incrementLoadTask.pushTask(g,[])}function Ga(a,b,c,d,e,f,g,h,i){var j,k,l;c>=0&&d>=0?(f[c]||(f[c]={}),j=f[c],k=j[d],j[d]=e,l=e&&e.value,i.l$J&&(l&&"SparklineExValue"===l.typeName&&(l=u),U(i.l$J.data,c,d,k&&k.value,l),U(i.l$J.style,c,d,k&&k.style,e&&e.style))):c>=0&&d===-1&&a>=0&&b===-1?g[c]=e:d>=0&&c===-1&&b>=0&&a===-1&&(h[d]=e)}function Ha(a,b,c,d,e,f,g){if(c>=0&&d>=0){f[c]||(f[c]={}),f[c].rs="e";var h=f[c];h.originalItem=g,h[d]=e}}function Ia(a,b,c){var d,e,f,g,h,i={};for(d in a)a[d]&&(e=y(d),!isNaN(e)&&e>=b&&(f=a[e],g=a[e+c],h=i[e],g&&(i[e+c]=g),h?a[e+c]=h:(delete a[e],a[e+c]=f)))}function Ja(a,b,c){var d,e,f;for(d in a)a[d]&&(e=Math.floor(d),!isNaN(e)&&e>=b&&(f=a[e],delete a[e],e>=b+c&&(a[e-c]=f)))}function Ka(a){var b,c=15;return a>-10&&a<10&&(b=""+a,(b.indexOf("000000000000")>1||b.indexOf("999999999999")>1)&&(c=14)),f.Common.o.Lma(a,h.Functions.CALC_PRECISION||c)}ca=function(){function a(a,b,c,d){var e=this;e.Xj=a,e.OZ=b,I(c)||(e.m$J=c),I(d)||(e.n$J=d),e.ad()}return a.prototype.ad=function(){var a=this;a.dataTable={},a.rowDataArray=[],a.columnDataArray=[],a.defaultDataNode=u,a.Ap={},a.gga=0,a.Ff=-1,a.Ef=-1},a.prototype.o$J=function(){var a=this;a.l$J={data:new j.BaseUsedRange,style:new j.BaseUsedRange}},a.prototype.p$J=function(a){var b=this,c=b.l$J,d={};if(!I(c))return a&l.UsedRangeType.data&&S(d,c.data.getUsedRange()),a&l.UsedRangeType.style&&S(d,c.style.getUsedRange()),a&l.UsedRangeType.rowStyle&&S(d,c.style.getRowUsedRange()),a&l.UsedRangeType.colStyle&&S(d,c.style.getColUsedRange()),d},a.prototype.getRowCount=function(){return this.Xj},a.prototype.getColumnCount=function(){return this.OZ},a.prototype.setRowCount=function(a){this.Xj=a},a.prototype.setColumnCount=function(a){this.OZ=a},a.prototype.getFreeAreaRowCount=function(){return this.m$J},a.prototype.getFreeAreaColumnCount=function(){return this.n$J},a.prototype.setFreeAreaRowCount=function(a){this.m$J=a},a.prototype.setFreeAreaColumnCount=function(a){this.n$J=a},a.prototype.Cp=function(a,b,c,d,e){var f,g,h,i,j,k,l=this,m=l.Ap;if(!(l.gga>0)){if(f=this.Ap.JPJ,g=a+"_"+b,f&&f[g]){if(f[g].oldCalcValue===c.IV)return;delete f[g]}a>=0&&b>=0&&(d&&(d.type="updateDirty",d.row=a,d.col=b,d.skipUndo=e,m[a]?m[a][b]||(d.isEmptyCol=!0):d.isEmptyRow=!0),m[a]||(m[a]={}),h=m[a],h[b]||(h[b]={}),i=h[b],"n"!==h.rs&&(h.rs="e"),j=c.Dp,k=c.Ep,I(j)||(d&&(d.originalItem=h.originalItem),h.originalItem=j),I(k)||(d&&(d.oldValue=i.oldValue,e&&(d.oldCalcValue=k)),i.oldValue=k))}},a.prototype.gWa=function(a){var b=this.Ap,c=a.row,d=a.col;a.skipUndo&&(this.Ap.JPJ=this.Ap.JPJ||{},this.Ap.JPJ[c+"_"+d]=a),a.isEmptyRow&&b?delete b[c]:a.isEmptyCol&&b[c]?delete b[c][d]:(a.hasOwnProperty("originalItem")&&(I(a.originalItem)&&!I(b[c].originalItem)?delete b[c].originalItem:b[c].originalItem=a.originalItem),a.hasOwnProperty("oldValue")&&b[c]&&(I(a.oldValue)&&!I(b[c][d].oldValue)?delete b[c][d].oldValue:b[c][d].oldValue=a.oldValue))},a.prototype.getValue=function(a,b,c){var d=this.RTa(a,b);return d&&!I(d.value)?1!==c?K(d.value):I(d.value.richText)?d.value:s(!0,{},d.value):u},a.prototype.setValue=function(a,b,c,d,e,f){var g,h=this.RTa(a,b,!0,d?d[0]:v);!h||I(h.value)&&I(c)||h.value===c?d&&(d.length=0):(g=h.value,h.value=c,this.Cp(a,b,{Ep:g,IV:c},e,f),d&&(d[0].push("value"),d[1]=g,d[2]=c),this.l$J&&(c&&"SparklineExValue"===c.typeName&&(c=u),U(this.l$J.data,a,b,g,c)))},a.prototype.getStyle=function(a,b,c){var d=this.RTa(a,b),e=d&&d.style;return e&&c&&e.clone&&(e=e.clone(!0)),e},a.prototype.setStyle=function(a,b,c,d){var e,f=this.RTa(a,b,!0,d?d[0]:v);f&&f.style!==c?(e=f.style,f.style=c,d&&(d[0].push("style"),d[1]=e,d[2]=c),this.l$J&&U(this.l$J.style,a,b,e,c)):d&&(d.length=0)},a.prototype.getCellState=function(a,b){var c=this.RTa(a,b);return c?c.cellState:u},a.prototype.setCellState=function(a,b,c,d){var e,f,g=this.getCellState(a,b)||0;e=d?g|c:g&~c,0!==e?(f=this.RTa(a,b,!0,v,!0),f&&(f.cellState=e)):(f=this.RTa(a,b),f&&delete f.cellState,r(f)&&(Xa(this.dataTable,a,b),r(this.dataTable[a])&&delete this.dataTable[a]))},a.prototype.getValueForKey=function(a,b,c){var d=this.RTa(a,b);return d&&d[c]},a.prototype.setValueForKey=function(a,b,c,d,e){var f,g=this.RTa(a,b,!0,e?e[0]:v);g&&g[c]!==d?(f=g[c],g[c]=d,e&&(e[0].push(c),e[1]=f,e[2]=d),this.q$J(a,b,c,f,d)):e&&(e.length=0)},a.prototype.q$J=function(a,b,c,d,e){var f=this,g=f.l$J;c===R&&g&&U(g.data,a,b,d,e)},a.prototype.NTa=function(a,b,c){var d,e=this,f=e.Xj,g=e.dataTable,h=e.Ap;if(0<=a&&a<=f&&b>=0){if(G(g,f,a,b),G(e.rowDataArray,f,a,b),G(h,f,a,b),e.Xj+=b,!c)for(d=0;d<b;d++)g[a+d]={rs:"n"},h[a+d]={rs:"n"};this.l$J&&(this.l$J.data.addHeadInfo(a,b,!0),this.l$J.style.addHeadInfo(a,b,!0))}},a.prototype.STa=function(a,b,c){var d,e,f=this,g=f.Xj;if(0<=a&&a<g&&b>0){if(a+b>g&&(b=g-a),c)for(d=0;d<b;d++)e=a+d,c.push([["dataTable",e],f.dataTable[e]]),c.push([["rowDataArray",e],f.rowDataArray[e]]),c.push([[B,e],f.Ap[e]]);H(f.dataTable,g,a,b),H(f.rowDataArray,g,a,b),H(f.Ap,g,a,b),f.Xj-=b,this.l$J&&(this.l$J.data.removeHeadInfo(a,b,!0),this.l$J.style.removeHeadInfo(a,b,!0))}},a.prototype.OTa=function(a,b){var c,d,e,f=this,g=f.OZ,h=f.Ap;if(0<=a&&a<=g&&b>=0){for(c=0;c<f.Xj;c++)d=f.dataTable[c],d&&a<g&&(G(d,g,a,b),e=h[c],e&&Ia(e,a,b));G(f.columnDataArray,g,a,b),f.OZ+=b,this.l$J&&(this.l$J.data.addHeadInfo(a,b,!1),this.l$J.style.addHeadInfo(a,b,!1))}},a.prototype.TTa=function(a,b,c){var d,e,f,g,h,i,j,k=this,l=k.OZ,m=k.Ap;if(0<=a&&a<l&&b>0){for(d=0;d<k.Xj;d++)if(e=k.dataTable[d]){if(c)for(f=0;f<b;f++)g=a+f,c.push([["dataTable",d,g],e[g]]),k.Ap[d]&&c.push([[B,d,g],k.Ap[d][g]]);H(e,l,a,b),h=m[d],Ja(h,a,b)}if(c)for(i=0;i<b;i++)j=a+i,c.push([["columnDataArray",j],k.columnDataArray[j]]);H(k.columnDataArray,l,a,b),a+b>l&&(b=l-a),k.OZ-=b,this.l$J&&(this.l$J.data.removeHeadInfo(a,b,!1),this.l$J.style.removeHeadInfo(a,b,!1))}},a.prototype.r$J=function(a,b,c,d){var e=this,f=a[b];return c&&(f||(f=a[b]={}),!d&&b>e.Ef&&(e.Ef=b)),f},a.prototype.s$J=function(a,b,c,d){if(a){var e=this,f=a[b];return c&&(f||(f=a[b]={}),!d&&e.Ff<b&&(e.Ff=b)),f}},a.prototype.RTa=function(a,b,c,d,e){var f,g=this,h=g.dataTable,i=g.columnDataArray,j=g.rowDataArray,k=u;return a<g.Xj&&b<g.OZ&&(a>=0&&b>=0?(f=g.r$J(h,a,c,e),k=g.s$J(f,b,c,e),d&&d.push("dataTable",a,b)):a===-1&&b>=0?(k=i[b],c&&(k||(k=i[b]={}),!e&&g.Ff<b&&(g.Ff=b)),d&&d.push("columnDataArray",b)):a>=0&&b===-1?(k=j[a],c&&(k||(k=j[a]={}),!e&&g.Ef<a&&(g.Ef=a)),d&&d.push("rowDataArray",a)):a===-1&&b===-1&&(k=g.defaultDataNode,c&&!k&&(k=g.defaultDataNode={}),d&&d.push("defaultDataNode"))),k},a.prototype.setNode=function(a,b,c){var d,e=this,f=e.dataTable,g=e.columnDataArray,h=e.rowDataArray;a<e.Xj&&b<e.OZ&&(a>=0&&b>=0?(d=f[a],d||(d=f[a]={}),d[b]=c):a===-1&&b>=0?g[b]=c:b===-1&&a>=0&&(h[a]=c))},a.prototype._f=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r;e&&(f=[],g=[]),h=this,i=h.dataTable,j=h.rowDataArray,k=h.columnDataArray,l=h.Ap,m=h.RTa(a,b,v,f),n=l[a]&&l[a][b],o=l[a]&&l[a].originalItem,p=h.RTa(c,d,v,g),q=l[c]&&l[c][d],r=l[c]&&l[c].originalItem,e&&(e.push([f,m]),e.push([g,p])),m?Ga(a,b,c,d,m,i,j,k,h):p&&Ga(a,b,c,d,u,i,j,k,h),p?Ga(c,d,a,b,p,i,j,k,h):m&&Ga(c,d,a,b,u,i,j,k,h),n?Ha(a,b,c,d,n,l,o):q&&Ha(a,b,c,d,u,l,o),q?Ha(c,d,a,b,q,l,r):n&&Ha(c,d,a,b,u,l,r)},a.prototype.Yea=function(a){a++;for(var b=this.Xj,c=this.dataTable;a>=0&&a<b&&!c[a];)a++;return a<b?a:-1},a.prototype.Hl=function(a,b){var c=this,d=u,e=c.OZ;if(a>=0&&a<c.Xj&&(d=c.dataTable[a]),d){for(b++;b>=0&&b<e&&!d[b];)b++;if(b<e)return b}return-1},a.prototype.EIb=function(a){var b,c,d,e,f,g,h=a.row,i=a.col,j=a.rowCount,k=a.colCount,l=this;for(b=h,c=0;c<j;c++,b++)for(d=i,e=0;e<k;e++,d++)f=l.RTa(b,d),g=void 0,f&&(g=f.value,f.value=u,l.l$J&&U(l.l$J.data,b,d,g,u))},a.prototype.MSb=function(a,b,c){var d=c&&c.getFormatter(a,b);return!!M(d)&&d},a.prototype.clear=function(a,b,c,d,e,g,h){var i,j,k,l,m,n,o,p,q,r=this,s=r.Xj,t=r.OZ,w=[],y=[],z=!!h,A=[];if(a>=0&&b>=0){if(c=x(c,s-a),d=x(d,t-b),c>0&&d>0)for(k=a;k<a+c;k++)if(!g||f.Common.k.Cb(g,k)<0)for(j=b;j<b+d;j++)z&&(l=[]),i=r.RTa(k,j,v,l),i&&(w.push(i),y.push({r:k,c:j}),z&&A.push(l),(1&e)>0&&!I(i.value)&&(m=void 0,z&&(m={}),r.Cp(k,j,{Ep:i.value},m),m&&h.push(m)))}else if(a>=0&&b===-1){if(c=x(c,s-a),c>0)for(k=a;k<a+c;k++)z&&(l=[]),i=r.RTa(k,-1,v,l),i&&(w.push(i),y.push({r:k,c:j}),z&&A.push(l))}else if(a===-1&&b>=0){if(d=x(d,t-b),d>0)for(j=b;j<b+d;j++)z&&(l=[]),i=r.RTa(-1,j,v,l),i&&(w.push(i),y.push({r:k,c:j}),z&&A.push(l))}else a===-1&&b===-1&&(z&&(l=[]),i=r.RTa(-1,-1,v,l),i&&(w.push(i),y.push({r:k,c:j}),z&&A.push(l)));for(r.l$J&&(n=r.l$J.style,o=r.l$J.data),p=function(a){if(i=w[a]){var b=z?[]:v;(8&e)>0&&(b&&b.push(["tag",i.tag]),i.tag=u),(2&e)>0&&(b&&b.push(["style",i.style]),n&&U(n,y[a].r,y[a].c,i.style,u),i.style=u),(1&e)>0&&(b&&b.push(["value",i.value]),o&&U(o,y[a].r,y[a].c,i.value,u),i.value=u),(16&e)>0&&(b&&b.push(["sparkline",i.sparkline]),i.sparkline=u),(64&e)>0&&(b&&b.push(["bindingPath",i.bindingPath]),o&&U(o,y[a].r,y[a].c,i.bindingPath,u),i.bindingPath=u),(256&e)>0&&(b&&b.push(["hyperlink",i.hyperlink]),i.hyperlink=u),(4&e)>0&&(b&&b.push(["comment",i.comment]),i.comment=u),z&&b.forEach(function(b){var c=[].concat(A[a]);c.push(b[0]),b[0]=c,h.push(b)})}},q=0;q<w.length;q++)p(q)},a.prototype.toJSON=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,s,t,w,x,y,z,A,B,C,D,E=c&&c.parent&&!r(c.parent.UHb);function F(a,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,s,t;return e?(i={},j=!1,k=e.value,I(k)||(i.value=k,j=!0),b&&b.saveAsView&&(l=void 0,h?l=h:E&&(l=c&&c.getFormatter(a,d)),l&&M(l)&&(m=c.aHb(a,d,l,k),I(m)||(i.value=m,j=!0))),n=b&&b.ignoreStyle,n||(o=e.style,o&&!r(o)&&("string"==typeof o?(i.style=o,j=!0):(p=o.toJSON(f,g),p&&(p.name=v,p.fontForColumnWidth=o.fontForColumnWidth,i.style=p,j=!0)))),q=e.bindingPath,I(q)||(i.bindingPath=q,j=!0),s=e.tag,I(s)||(i.tag=s,j=!0),t=e.hyperlink,I(t)||(i.hyperlink=N(t),delete i.hyperlink.isVisited,j=!0),j===!0?i:u):u}if(d=this,e={},f={},g=d.Xj,h=d.OZ,i=d.dataTable,j=d.rowDataArray,k=d.columnDataArray,b&&b.saveAsView)for(n=0,o=3===a&&E;n<g;)if(p=i[n],p||o){for(q={},s=!1,t=0;t<h;)w=void 0,p&&p[t]?w=F(n,t,p[t]):o&&(x=this.MSb(n,t,c),x&&(p||(p=d.r$J(i,n,!0)),w=F(n,t,d.s$J(p,t,!0),3,!1,x))),I(w)||(q[t]=w,s=!0),t++;s&&(f[n]=q),n++}else n++;else for(l=d.Yea(-1);l>=0;){for(q={},s=!1,m=d.Hl(l,-1);m>=0;)y=d.RTa(l,m),y&&(w=F(l,m,y),r(w)||(q[m]=w,s=!0)),m=d.Hl(l,m);s&&(f[l]=q),l=d.Yea(l)}for(r(f)||(e.dataTable=f),z=[],l=0;l<g;l++)ra(j,l)&&j[l]&&(A=F(l,-1,j[l]),r(A)||(z[l]=A));for(z.length>0&&(e.rowDataArray=z),B=[],m=0;m<h;m++)ra(k,m)&&k[m]&&(C=F(-1,m,k[m]),r(C)||(B[m]=C));return B.length>0&&(e.columnDataArray=B),D=F(-1,-1,d.defaultDataNode,a,!0),r(D)||(e.defaultDataNode=D),e},a.prototype.fromJSON=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=c&&c.incrementalLoading;if(!a)return void(s&&g&&setTimeout(g,0));if(h=this,h.ad(),h.gga++,i=a.dataTable,l=h.Xj,m=h.OZ,i?s&&3===f?Da(h,i,l,m,c,b,v,g,h.l$J,d,e):Ea(h,i,l,m,c,b,h.l$J,d,e):s&&g&&setTimeout(g,0),p=a.rowDataArray||a.Hf)for(j=0;j<l;j++)ra(p,j)&&p[j]&&La(p[j],h.RTa(j,-1,!0),b,j,-1,c,h.l$J);if(q=a.columnDataArray||a.If)for(k=0;k<m;k++)ra(q,k)&&q[k]&&La(q[k],h.RTa(-1,k,!0),b,-1,k,c,h.l$J);r=a.defaultDataNode||a.Jf,r&&La(r,h.RTa(-1,-1,!0),b,-1,-1,c,h.l$J),h.gga--},a.prototype.bdK=function(a,b,c,d,f,g){var h,i,k,m,n,p,q,s,t,w,x,y,z,A,B,C,D,E,F,G,H,J,K,L,O,P,Q,R,S,T,U,V,W,X,Y,Z,$=this,_=0,aa=0,ba=$.Xj,ca=$.OZ,da=$.dataTable,ea=[],fa=g&&g.includeStyles===!1,ga=g&&g.saveAsView,ha=g&&g.includeEmptyRegionCells===!1,ia=a&&a.parent&&!r(a.parent.UHb),ja=g&&g.fileType===l.OpenSaveFileType.excel;for(ha&&(h=l.UsedRangeType.all-l.UsedRangeType.colStyle-l.UsedRangeType.rowStyle-l.UsedRangeType.style-l.UsedRangeType.axis,i=a.getUsedRange(h),i&&(_=i.row,aa=i.col,ba=i.row+i.rowCount,ca=i.col+i.colCount)),k={n_:o.XFileConstants.HbK,rowCount:$.Xj,colCount:$.OZ},m={sheetData:k,hyperlinks:ea},n=!a.ODJ&&a.getDefaultStyle(3),Object.keys(b).forEach(function(a){var c,e=b[a],f=e&&e.size,g=!I(f)&&f!==d,h=e&&e.visible===!1?1:v;(g===!0||h)&&(c=k[a]={},c.h=g&&f!==v?+j.SJSColumnWidthHelper.pixelToPoint(f).toFixed(2):v,c.v=h)}),p=_;p<ba;p++)if(q=k[p]||{r:p+1},s=da[p],t=void 0,w=$.RTa(p,-1),x=w&&w.style,I(x)||fa||(ja?("string"==typeof x&&0===x.indexOf(c.PlK)&&(y=x,x=a.Mq(y,!1),x||(z=a.parent,x=z&&z.Mq(y,!1))),q.s=c.getStyleIndex(x)):"string"==typeof x?q.t=c.getOriginNamedStyleIndex(x):x!==v&&(q.e=c.getOriginStyleIndex(x)),t=!0),s){for(A=aa;A<ca;A++)if(B=s[A],C={},B){if(I(B.tag)||(C.tag=B.tag),D=$.getStyle(-1,A,!0),E=u,F=void 0,G=void 0,H=void 0,J=void 0,K=void 0,L=void 0,O=B.value,P=$.getStyle(p,A,!0),Q=B.hyperlink,R=!1,ga&&(S=$.MSb(p,A,a),!S&&ia&&(S=a.getFormatter(p,A)),M(S)&&(T=a.aHb(p,A,S,O),!I(T)))){switch(U=typeof T){case"boolean":H=T?1:0;break;case"string":F=f.getTextIndex(T);break;case"object":T instanceof Date?(T=j.util.x0a(T),P.formatter="M/d/yyyy",F=f.getTextIndex(T)):F=T;break;default:G=isFinite(T)?T:v}R=!0}if(!fa)if(ja){if(V=Q||"string"==typeof O&&"/OADate"===O.substring(0,7)||O!==u&&void 0!==O&&(D||x),P?E=gb(a,P):V&&(E=new e.Style),E){if(E.parentName)for(W=gb(a,E.parentName),W&&hb(a,E,W);W&&W.parentName;)W=gb(a,W.parentName),W&&hb(a,E,W);x&&hb(a,E,x),D&&hb(a,E,D),n&&hb(a,E,n),E=fb(O,E)}}else"string"==typeof P?K=c.getOriginNamedStyleIndex(P):P!==v&&(L=c.getOriginStyleIndex(P));if(I(O)&&(K===v&&L===v&&I(E)||fa)&&I(Q))r(C)||(q[A]={lossless:C},t=!0);else{if(t=!0,!R&&!I(O))switch(X=typeof O){case"boolean":H=O?1:0;break;case"string":F=f.getTextIndex(O);break;case"object":F=O&&O.richText?f.getTextIndex(O):O&&O instanceof Date?f.getTextIndex(O.toISOString()):O;break;default:G=isFinite(O)?O:v}I(Q)||(ja&&(E?"string"==typeof E&&(E=a.Hq(E)):E=new e.Style,I(Q.linkColor)?Q.linkColor===v&&E.foreColor||(E.foreColor="hyperlink"):E.foreColor=Q.linkColor,Q.drawUnderline&&I(E.textDecoration)?E.textDecoration=1:1!==(1&E.textDecoration)&&(E.textDecoration+=1)),ea.push({row:p,col:A,value:B.value,hyperlink:N(Q)})),E&&(J=c.getStyleIndex(E,3,a.name())),Y=B.bindingPath,I(Y)||(C.bindingPath=Y),Z={s:J,v:F,n:G,b:H,t:K,e:L},r(C)||(Z.lossless=C),q[A]=Z}}t&&(k[p]=q)}else t&&(k[p]=q);return m},a.prototype.cdK=function(a,b,c,d,e,f,g,h,i){var j,k,l,m=this,n={};if(b)for(j=b.colCount,k=0;k<j;k++)l=m.RTa(-1,k),l&&l.style&&(n[k]=1);Fa(this,a,b,c,d,e,f,g,h,i,n)},a}(),da=function(){function a(){this.infos=[],this.KkK=[]}return a.prototype.$CJ=function(a,b){var c=this.infos,d=c[a];return!d&&b&&(d=c[a]={}),d},a.prototype.uL=function(a,b){var c=this.infos,d=c.length;0<=a&&a<=d&&b>0&&G(c,d,a,b)},a.prototype.UTa=function(a,b,c){var d,e,f=this.infos,g=f.length;if(0<=a&&a<g&&b>0){if(b=x(b,g-a),c)for(d=0;d<b;d++)e=a+d,c.push([["infos",e],f[e]]);H(f,g,a,b)}},a.prototype.VTa=function(){return this.infos.length},a.prototype.Hp=function(){return this.infos},a.prototype.Jp=function(a){return this.infos[a]},a.prototype.Kp=function(a,b,c){var d=this.infos[a];this.infos[a]=b,c&&(c[0].push("infos",a),c[1]=d,c[2]=b)},a.prototype.getSize=function(a){var b=this.infos[a],c=u;return b&&(b.visible===!1?c=0:sa(b.size)&&(c=y(b.size))),c},a.prototype.getColumnHeaderFitMode=function(a){var b=this.infos[a],c=l.ColumnHeaderFitMode.normal;return b&&(c=b.columnHeaderFitMode||c),c},a.prototype.setColumnHeaderFitMode=function(a,b,c){var d=this.$CJ(a,!0),e=d.columnHeaderFitMode;e!==b&&(d.columnHeaderFitMode=b),c&&(c[0].push("infos",a,"columnHeaderFitMode"),c[1]=e)},a.prototype.getActualSize=function(a){var b=this.infos[a];return b?y(b.size):u},a.prototype.setSize=function(a,b,c){var d=this.$CJ(a,!0),e=d.size;e!==b&&(d.size=b),c&&(c[0].push("infos",a,"size"),c[1]=e,c[2]=b)},a.prototype.getStarSize=function(a){var b=this.infos[a];return b?b.starSize:v},a.prototype.setStarSize=function(a,b,c){var d=this.$CJ(a,!0),e=d.starSize;I(b)&&I(e)||(e!==b&&(I(b)?delete d.starSize:d.starSize=b),c&&(c[0].push("infos",a,"starSize"),c[1]=e,c[2]=b))},a.prototype.getScrollOffsetX=function(a){var b=this.Jp(a),c=0;return b&&sa(b.scrollOffsetX)&&(c=b.scrollOffsetX),c},a.prototype.setScrollOffsetX=function(a,b,c){var d=this.$CJ(a,!0);c&&(b+=d.scrollOffsetX||0),d.scrollOffsetX=b},a.prototype.getScrollContentWidth=function(a){var b=this.Jp(a),c=this.getSize(a),d=c;return b&&sa(b.scrollContentWidth)&&(d=b.scrollContentWidth),z(d,c)},a.prototype.setScrollContentWidth=function(a,b){var c=this.$CJ(a,!0),d=this.getSize(a);b<d&&(b=d),c.scrollContentWidth=b},a.prototype.getHiddenRows=function(){return this.KkK},a.prototype.bdK=function(a){return this.infos},a.prototype.cdK=function(a,b){var c,d,e,f,g,h=this,i=a;if(i)for(c=a.rowCount,d=0;d<c;d++)e=i[d],e&&(f=void 0,g=void 0,e.h!==v&&(f=Math.round(j.SJSColumnWidthHelper.pointToPixel(e.h))),e.v&&(I(e.l)||0===e.l)&&(g=!1,h.KkK.push(d)),g===!1&&0===f&&(f=v),I(f)||h.setSize(+d,f),I(g)||h.setVisible(+d,g))},a.prototype.toJSON=function(a){var b,c,d,e,f,g,h,j,k=this.infos,l=[];if(a&&a.ignoreStarSize)for(b=0;b<k.length;b++)I(k[b])||(c=k[b],d=c.cellType,e=pa(c,["cellType"]),l[b]=N(e),d&&(d.toJSON&&(d=d.toJSON()),f=m._o,g=d.typeName,h=f[d.type]||f[g]||i.getTypeFromString(g),h&&(j=new h,j.fromJSON(d,a),l[b].cellType=j)),delete l[b].starSize);else for(b=0;b<k.length;b++)I(k[b])||(l[b]=k[b]);return l.length>0?l:v},a.prototype.fromJSON=function(a){a&&(this.infos=a)},a}(),ea=da.prototype,q({visible:!0,resizable:!0,pageBreak:!1},function(a,b){var c=a[0].toUpperCase()+a.substr(1);ea["get"+c]=function(c){var d=b,e=this.infos[c];return e&&!I(e[a])&&(d=e[a]),d},ea["set"+c]=function(b,c,d){var e=this.$CJ(b,!0),f=e[a];f!==c&&(e[a]=c),d&&(d[0].push("infos",b,a),d[1]=f,d[2]=c)}});function La(a,b,c,d,f,g,j,k,l){var m,n,o,q,r,s,t,x,y,z,A,B,C;a&&(m=a.value,n=a.formula,m!==v&&(m=m,m!==u&&(m._calcError||m._error&&!I(m._code))&&(o=p&&h.CalcError.parse(m._calcError||m._error),o!==v&&(o=L(o),m=o)),I(n)&&j&&U(j.data,d,f,b.value,m),b.value=m),q=a.style,r=g&&g.sheet,q!==v&&g&&!g.ignoreStyle&&(s=u,t=b.style,typeof q===w?(b.style=q,s=r&&(r.Mq(q,!1)||r.parent&&r.parent.Mq(q,!1))):q&&(s=new e.Style,s.fromJSON(q,c),s.name=v,b.style=s),j&&U(j.style,d,f,t,b.style),s&&s.validator&&g&&g.setValidator&&g.setValidator(d,f,s.validator)),x=a.visualState,x!==v&&(b.visualState=x),y=a.bindingPath,y!==v&&(b.bindingPath=y),z=a.tag,z!==v&&z!==u&&(A=z.typeName,typeof A===w&&(B=i.getTypeFromString(A),B&&(z=new B,z.fromJSON&&z.fromJSON(a.tag))),b.tag=z),C=a.hyperlink,C!==v&&(b.hyperlink=N(C)),d>-1&&f>-1&&cb(b,m,!!n,q,k,v,l))}fa=20,ga=62,ha=40,ia=20;function Ma(a,b,c){var d,e,f,g,h,i,k,m,n,o,p,q,r,s,t,u,v=b[0];if("selectionModel"!==v[0]){for(d=v[0],e=b[1],f=null,b.length>2&&(f=b[2]),f=c?f:e,g=a,h=0;h<v.length-1;h++)i=v[h],i===B?g=g.Ap:(g[i]||(g[i]={}),g=g[i]);k=v.length,m=v[k-1],n=a.sheetModels[3],o=n.l$J,p=g[v[h]],"sheetModels"===d||"colInfos"===d||"rowInfos"===d?c&&f!==g[v[h]]?g[v[h]]=f:c||(g[v[h]]=e):"spanModels"===d?(g.cache={},g.spans=[],f.forEach(function(a){g.add(j.kf(a.row,a.col,a.rowCount,a.colCount))})):(g[v[h]]=b[1],q=void 0,r=v[k-2],s=v[1],"size"===m?q=v[0]===D?l.AxisInfoChangeType.setRowHeight:l.AxisInfoChangeType.setColumnWidth:"visible"===m&&(q=v[0]===D?l.AxisInfoChangeType.setRowVisible:l.AxisInfoChangeType.setColumnVisible),I(q)||a.Cgc({type:q,index:r,sheetArea:s})),"style"===m?(t=o&&o.style,t&&U(t,v[k-3],v[k-2],p,g[v[h]]),g&&(p&&p.quotePrefix||g.style&&g.style.quotePrefix)&&(p&&p.quotePrefix)!==(g.style&&g.style.quotePrefix)&&cb(g,g.value,!!g.formula,g.style,a.QaK)):"value"===m&&(u=o&&o.data,u&&U(u,v[k-3],v[k-2],p,g[v[h]]),g&&p!==g.value&&cb(g,g.value,!!g.formula,g.style,a.QaK))}}function Na(a,b,c){var d=a.WTa>0?[["selectionModel"],v]:v;a.selectionModel.setProperty(b,c,d),d&&a.zTa.push(d)}function Oa(a,b,c,d,e){void 0===e&&(e=!1);var f=a[b];return e?void(f&&delete f[c]):(f||(f=a[b]={}),void(f[c]=d))}function Pa(a,b,c,d){Oa(a,b,c,{value:d})}function Qa(a,b,c,d,e,f){Oa(a,b,c,{value:d,oldValue:e,isAnchorCell:f})}function Ra(a,b,c,d){var e,f=a[b],g=f&&f[c];return g?g.value:(e=d.getValue(b,c),Pa(a,b,c,e),e)}function Sa(a,b){return[a,b].join(",")}function Ta(a,b){a.indexOf(b)===-1&&a.push(b)}function Ua(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]===b&&a[d][1]===c)return void 0!==a[d][2];return!0}function Va(a,b,c){var d=a[b];return d&&d[c]}function Wa(a,b){var c=b.split(",").map(function(a){return+a}),d=c[0],e=c[1],f=a[d];return f&&f[e]}function Xa(a,b,c,d){var e=a[b];e&&delete e[c],d&&r(e)&&delete a[b]}ja=5e5,ka=function(){function a(a){this.modelManager=a,this.anchors={},this.cells={},this.invalidAnchors={}}return a.prototype.no=function(){this.modelManager=u},a.prototype.getAnchorCell=function(a,b){return Va(this.anchors,a,b)},a.prototype.getAnchorItem=function(a,b){return Va(this.cells,a,b)},a.prototype.getAnchorInfo=function(a,b,c){var d,e,f,g,h=this,i=h.anchors,j=h.getAnchorCell(a,b);if(j)return j;if(d=h.getAnchorItem(a,b)){e=d.anchorRefs;for(f in e)if(e[f]&&(g=Wa(i,f),c||g.isValid))return g}},a.prototype.isCellHasItsOwnValue=function(a,b,c){var d,e,f,g,h=this,i=h.getAnchorItem(a,b);if(i){if(!I(i.value)||i.FIb)return!0;d=i.anchorRefs,e=h.anchors;for(f in d)if(c!==f&&d[f]&&(g=Wa(e,f),g&&g.isValid))return!0}return!1},a.prototype.removeRef=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,s=this,t=s.cells,v=b.isValid,w=b.row,x=b.col,y=b.rowCount,z=b.colCount,A=1;for(g=0,h=w;g<y;g++,h++){for(i=x+A;A<z;A++,i++){if(j=Va(t,h,i),k=j&&j.anchorRefs,l=!0,v){if(m=a.getValue(h,i),n=j&&j.value,I(n)){if(o=j&&j.FIb,p=!o||o===c,k)for(q in k)if(q!==c&&k[q]){l=!1;break}p?Qa(d,h,i,u,m,b.row===h&&b.col===i):n=m}e&&Pa(e,h,i,n)}k&&(delete k[c],l&&f&&r(k)&&Xa(t,h,i,!0))}A=0}},a.prototype.GIb=function(a,b,c,d,e){var f,g,h,i=a.getRowCount(),k=a.getColumnCount();return!(b+d>i||c+e>k)&&(!(d*e>ja)&&(f=a.getSheet(),g=j.kf(b,c,d,e),!f.ITa.getSpans(g).length&&(h=f.tables,!(h&&h.rn&&h.rn(b,c,d,e)))))},a.prototype.setArray=function(a,b,c,d,e,f,g){var i,j,k,l,m,n,o,q,r,s,t,v,w,x,y,z,A,B,C,D,E,F,G,H,J,K,L=this,M=Sa(b,c),N=L.anchors,O=Va(N,b,c),P=L.cells;if(O&&!f)return i=L.updateItem(a,b,c),j=i[0],k=i[1],[O,j,k];if(l={},m={},n=!1,O&&O.isValid&&(n=!0,L.removeRef(a,O,M,l,m,!0)),o=O,O={row:b,col:c,rowCount:d,colCount:e,values:f,isValid:!1},Oa(N,b,c,O),q=a.getCalcService().HIb,O.HIb=q,r=o&&o.HIb===q&&(d!==o.rowCount||e!==o.colCount),s=a.q$a,t=s&&Va(L.invalidAnchors,b,c))Qa(l,b,c,p&&h.Errors.Spill,u,O.row===b&&O.col===c),L.IIb(b,c,d,e,P,s,m,a,M,!0);else if(f){if(v=Ra(m,b,c,a),w=!r&&L.GIb(a,b,c,d,e),w&&(L.IIb(b,c,d,e,P,s,m,a,M),!s&&!g))for(x=1,y=0,z=b;y<d;y++,z++){for(A=c+x;x<e;x++,A++)if(B=Ra(m,z,A,a),!I(B)&&L.isCellHasItsOwnValue(z,A,M)){if(w=!1,!n)break;Oa(l,z,A,B,!0)}if(!n&&!w)break;x=0}if(w)for(C=a.getCalcSourceModel(),D=a.getCalcService(),y=0,z=b;y<d;y++,z++)for(E=f[y],x=0,A=c;x<e;x++,A++)B=Ra(m,z,A,a),F=E&&E[x],G=F,I(F)?G=0:p&&(h.Convert.Ca(F)||h.Convert.Fh(F))&&(G=1===F.getRowCount()&&1===F.getColumnCount()?h.Convert.Ca(F)?F.getValue(0,0):F.getValue(0,0,0):h.Errors.Calc),!C.t$J||D.u$J||z===b&&A===c||(H=C&&C.usedRange,H&&(J=void 0,K=void 0,s?(J=I(F)?void 0:G,K=B):(J=B,K=G),U(H,z,A,J,K))),Qa(l,z,A,G,B,O.row===z&&O.col===A),(y||x)&&(Va(P,z,A).FIb=M);else Qa(l,b,c,p&&h.Errors.Spill,v,O.row===b&&O.col===c);O.isValid=w,o&&w!==o.isValid&&L.modelManager.JIb(b,c,!w)}return[O,l,[o]]},a.prototype.IIb=function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o=1;for(k=0;k<c;k++){for(l=a+k;o<d;o++)m=b+o,n=!j&&Va(e,l,m),n||(n={anchorRefs:{}},f&&!j||(n.value=Ra(g,l,m,h)),Oa(e,l,m,n)),n.anchorRefs[i]=!0;o=0}},a.prototype.updateItem=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o;if(void 0===e&&(e={}),void 0===f&&(f=[]),g=Sa(b,c),h=this,i=h.anchors,j=Va(i,b,c),j&&(h.removeRef(a,j,g,e,v,!0),Xa(e,b,c),Xa(i,b,c,!0)),k=h.cells,l=Va(k,b,c),l&&l.value!==d){h.modelManager.KIb(b,c,l.value),l.value=d,delete l.FIb,m=l.anchorRefs;for(n in m)m[n]&&(o=Wa(i,n),Ta(f,o))}if(j||l)return[j&&e,f]},a.prototype.LIb=function(a,b){Oa(this.invalidAnchors,a,b,!0)},a.prototype.MIb=function(){this.invalidAnchors={}},a.prototype.NIb=function(a,b,c){var d,e,f,g,h,i,j,k=this,l=k.anchors,m=[];for(d in l)if(l.hasOwnProperty(d)){e=+d,f=e>=b,g=l[d];for(h in g)g.hasOwnProperty(h)&&(i=+h,f||(j=g[h],f=j&&j.rowCount+e>=b),f&&m.push([e,i]))}m.length&&m.forEach(function(b){k.updateItem(a,b[0],b[1],v)})},a.prototype.NTa=function(a,b,c){this.NIb(a,b,c)},a.prototype.PTa=function(a,b,c){this.NIb(a,b,c)},a.prototype.OIb=function(a,b){var c,d,e,f,g,h,i,j=this,k=j.anchors,l=[];for(c in k)if(k.hasOwnProperty(c)){d=+c,e=k[c];for(f in e)e.hasOwnProperty(f)&&(g=+f,h=g>=b,h||(i=e[f],h=i&&i.colCount+g>=b),h&&l.push([d,g]))}l.length&&l.forEach(function(b){j.updateItem(a,b[0],b[1],v)})},a.prototype.OTa=function(a,b,c){this.OIb(a,b)},a.prototype.QTa=function(a,b,c){this.OIb(a,b)},a}(),b.PIb=ka;function Ya(a,b,c,d,e){var f,g,i,j,k,l,m,n,o=a.XTa(3),p=a.bIb,q=p.anchors,r=[];for(f in q)if(q.hasOwnProperty(f)&&(g=q[f]))for(i in g)g.hasOwnProperty(i)&&(j=g[i],j&&(k=j.row,l=j.col,m=j.rowCount,n=j.colCount,(e?k+m:l+n)>=b&&(j.isValid&&o.EIb(j),(e?k:l)<b&&r.push(j))));r.length&&h.markAnchorCellDirty(r,a.kj.Bj(),p)}b.clearSpillValuesOnAddRemove=Ya;function Za(a){return a?a.filter(function(a){return!a.isAutoMerge}):a}la=function(){function a(b,c,d,e,f,g){var h,i,j,k,l,m;this.QIb=[],h=this,h.kj=b,i=new ca(c,d,c,d),h.sheetModels=[v,new ca(e,d,0,0),new ca(c,f,0,0),i],i.o$J(),j=h.rowInfos=[],j[0]=j[1]=new da,j[2]=j[3]=new da,k=h.colInfos=[],k[0]=k[2]=new da,k[1]=k[3]=new da,h.spanModels=[v,new X,new X,new X],h.selectionModel=new _,l=h.colHeaderSelectionModel=new _,l.selectionPolicy=1,h.bIb=new ka(h),h.name=g||"",h.isSelected=!1,h.zoomFactor=1;function n(a,b,c,d){h.WTa>0&&h.zTa.push([["defaults",c],d,b]),h.kj.$p()}m=h.defaults={},va(m,"rowHeight",fa,n),va(m,"colWidth",ga,n),va(m,"rowHeaderColWidth",ha,n),va(m,"colHeaderRowHeight",ia,n),va(m,"_isExcelDefaultColumnWidth",!1,n),h.WTa=0,a.ao(this,"init"),h.Dgc(c,d),h.QaK={}}return a.prototype.getUsedRange=function(a){var b=this,c={};return S(c,b.v$J(a)),S(c,b.sheetModels[3].p$J(a)),S(c,b.L7J(a)),S(c,b.M7J(a)),c},a.prototype.v$J=function(a){var b,c,d,e,f,g,h;if(a&l.UsedRangeType.span&&(b=this,c=b.spanModels[l.SheetArea.viewport],d=c.spans,!I(d)&&d.length>0)){for(e={},f=0,g=d;f<g.length;f++)h=g[f],S(e,T(h));return e}},a.prototype.L7J=function(a){var b,c,d,e,f,g,h,i,j,k,m,n,o,p,q=!(a&l.UsedRangeType.axis);if(a&l.UsedRangeType.data||!q){if(b=q?function(a){return!I(a)&&!I(a.name)}:function(a){return!I(a)},c=this,d=c.colInfos[3].infos,e=c.kj,f=e.getRowCount(),g={},h=Object.keys(d),i=h.length,i>0){for(m=0,n=h;m<n.length;m++)if(o=n[m],b(d[o])){j=+o;break}for(p=i-1;p>=0;p--)if(b(d[h[p]])){k=+h[p];break}I(j)||I(k)||(f=f>0?f-1:f,S(g,{minRow:0,minCol:j,maxRow:f,maxCol:k}))}return g}},a.prototype.M7J=function(a){var b,c,d,e,f,g,h,i,j,k,m,n,o;if(a&l.UsedRangeType.axis){if(b=this,c=b.rowInfos[3].infos,d=b.kj,e=d.getColumnCount(),f={},i=Object.keys(c),j=i.length,j>0){for(k=0,m=i;k<m.length;k++)if(n=m[k],!I(c[n])){g=+n;break}for(o=j-1;o>=0;o--)if(!I(c[i[o]])){h=+i[o];break}I(g)||I(h)||(e=e>0?e-1:e,S(f,{minRow:g,minCol:0,maxRow:h,maxCol:e}))}return f}},a.prototype.RaK=function(a,b,c,d,e){if(!(3!==c||a<0||b<0)&&this.kj&&this.kj.hasFormula!==v){var f=this.XTa(3).RTa(a,b,!!e);cb(f,d,this.kj.hasFormula(a,b,c),f&&f.style,this.QaK,this.kj.parent)}},a.prototype.VkK=function(a,b,c){if(!(3!==c||a<0||b<0)){var d=this.XTa(3).RTa(a,b);d&&ab(d)}},a.prototype.Dgc=function(a,b){var c=this;c.Cgc({type:l.AxisInfoChangeType.setRowCount,count:a}),c.Cgc({type:l.AxisInfoChangeType.setColumnCount,count:b})},a.prototype.Cgc=function(a){var b,c,d,e,f,g,h,i,j,k=this,m=k.kj,n=a.type,o=a.sheetArea,p=void 0===o?l.SheetArea.viewport:o;if(p===l.SheetArea.viewport){if(I(k.Egc)&&(k.Egc=[]),I(k.Fgc)&&(k.Fgc=[]),k.Mgc)return void k.Ngc(a);switch(b=k.Egc,c=k.Fgc,n){case l.AxisInfoChangeType.deleteRows:d=a.index,e=a.count,b.splice(d,e);break;case l.AxisInfoChangeType.deleteColumns:d=a.index,e=a.count,c.splice(d,e);break;case l.AxisInfoChangeType.setRowHeight:case l.AxisInfoChangeType.setRowVisible:d=a.index,f=a.value,b[d]=f;break;case l.AxisInfoChangeType.setColumnWidth:case l.AxisInfoChangeType.setColumnVisible:d=a.index,f=a.value,c[d]=f;break;case l.AxisInfoChangeType.filterRows:for(g=a.index,h=0,i=g;h<i.length;h++)d=i[h],f=m.getRowHeight(d),b[d]=f;break;case l.AxisInfoChangeType.outlineExpandRows:for(g=a.index,j=0;j<g.length;j++)d=g[j],f=m.getRowHeight(d),b[d]=f;break;case l.AxisInfoChangeType.outlineExpandColumns:for(g=a.index,j=0;j<g.length;j++)d=g[j],f=m.getColumnWidth(d),c[d]=f}}},a.prototype.Ggc=function(a){if(this.Egc){var b=this.Egc[a];return I(b)?this.defaults.rowHeight:b}},a.prototype.Hgc=function(a){if(this.Fgc){var b=this.Fgc[a];return I(b)?this.defaults.colWidth:b}},a.prototype.Jgc=function(){this.Mgc=[]},a.prototype.Lgc=function(){var a,b,c,d=this,e=d.Mgc;
if(d.Mgc=u,e)for(a=0,b=e;a<b.length;a++)c=b[a],d.Cgc(c)},a.prototype.Ngc=function(a){this.Mgc&&this.Mgc.push(a)},a.prototype.Kgc=function(){var a=this;a.Egc=u,a.Fgc=u},a.prototype.SaK=function(){this.QaK=u},a.prototype.no=function(b){if(b!==!1){var c=this;c.kj=u,c.sheetModels=u,c.bIb&&(c.bIb.no(),c.bIb=u),c.Kgc(),c.SaK()}a.ao(this,"dispose",{clearCache:b})},a.prototype.addRows=function(b,c,d,e){var f,g=this;g.WTa>0&&(f={row:b,rowCount:c,type:"addRows"},g.zTa.push(f)),g.XTa(3).NTa(b,c,e),g.XTa(2).NTa(b,c,e),g.zl(3).NTa(b,c),g.zl(2).NTa(b,c),g.YTa(!0,3).uL(b,c),p&&g.bIb.NTa(g.kj.yj(),b,c),d||a.ao(g,"addRows",{row:b,rowCount:c,changes:g.zTa}),g.Cgc({type:l.AxisInfoChangeType.addRows,index:b,count:c})},a.prototype.ZTa=function(b,c){var d=this,e=b.row,f=b.rowCount;Ya(d,e,f,c,!0),c?d.addRows(e,f,!0,!c):d.deleteRows(e,f,!0),a.ao(d,"undoAddRows",{row:e,rowCount:f})},a.prototype.deleteRows=function(b,c,d){var e,f,g,h,i,j,k,m,n,o=this;if(o.WTa>0&&(f=[],g=[],h=[["spanModels",3],v],i=[["spanModels",2],v],j=[],e={row:b,rowCount:c,type:"deleteRows"},o.zTa.push(e)),o.XTa(3).STa(b,c,f),o.XTa(2).STa(b,c,g),o.zl(3).PTa(b,c,h),o.zl(2).PTa(b,c,i),o.YTa(!0,3).UTa(b,c,j),p&&o.bIb.PTa(o.kj.yj(),b,c),d||a.ao(o,"deleteRows",{row:b,rowCount:c,changes:o.zTa}),e){for(k=e.changes=[],m=["sheetModels",3],n=0;n<f.length;n++)f[n][0]=m.concat(f[n][0]),k.push(f[n]);for(m=["sheetModels",2],n=0;n<g.length;n++)g[n][0]=m.concat(g[n][0]),k.push(g[n]);for(h.length>0&&k.push(h),i.length>0&&k.push(i),m=[D,3],n=0;n<j.length;n++)j[n][0]=m.concat(j[n][0]),k.push(j[n])}o.Cgc({type:l.AxisInfoChangeType.deleteRows,index:b,count:c})},a.prototype.$Ta=function(a,b){var c,d,e,f=this,g=a.row,h=a.rowCount;if(Ya(f,g,h,!b,!0),b)f.deleteRows(g,h,!0);else for(f.addRows(g,h,!0,!0),c=a.changes,d=c.length-1;d>=0;d--)Ma(f,c[d]);e=f.kj&&f.kj.Ts,e&&e.splice(e.length-h,h)},a.prototype.addColumns=function(b,c,d){var e,f=this;f.WTa>0&&(e={col:b,colCount:c,type:"addColumns"},f.zTa.push(e)),f.XTa(3).OTa(b,c),f.XTa(1).OTa(b,c),f.zl(3).OTa(b,c),f.zl(1).OTa(b,c),f.YTa(!1,3).uL(b,c),p&&f.bIb.OTa(f.kj.yj(),b,c),d||a.ao(f,"addColumns",{col:b,colCount:c,changes:f.zTa}),f.Cgc({type:l.AxisInfoChangeType.addColumns,index:b,count:c})},a.prototype._Ta=function(a,b){var c=this,d=a.col,e=a.colCount;Ya(c,d,e,b,!1),b?c.addColumns(d,e,!0):c.deleteColumns(d,e,!0)},a.prototype.deleteColumns=function(b,c,d){var e,f,g,h,i,j,k,m,n,o=this;if(o.WTa>0&&(f=[],g=[],h=[["spanModels",3],v],i=[["spanModels",1],v],j=[],e={col:b,colCount:c,type:"deleteColumns"},o.zTa.push(e)),o.XTa(3).TTa(b,c,f),o.XTa(1).TTa(b,c,g),o.zl(3).QTa(b,c,h),o.zl(1).QTa(b,c,i),o.YTa(!1,3).UTa(b,c,j),p&&o.bIb.QTa(o.kj.yj(),b,c),d||a.ao(o,"deleteColumns",{col:b,colCount:c,changes:o.zTa}),e){for(k=e.changes=[],m=["sheetModels",3],n=0;n<f.length;n++)f[n][0]=m.concat(f[n][0]),k.push(f[n]);for(m=["sheetModels",1],n=0;n<g.length;n++)g[n][0]=m.concat(g[n][0]),k.push(g[n]);for(h.length>0&&k.push(h),i.length>0&&k.push(i),m=[E,3],n=0;n<j.length;n++)j[n][0]=m.concat(j[n][0]),k.push(j[n])}o.Cgc({type:l.AxisInfoChangeType.deleteColumns,index:b,count:c})},a.prototype.aUa=function(a,b){var c,d,e=this,f=a.col,g=a.colCount;if(Ya(e,f,g,!b,!1),b)e.deleteColumns(f,g,!0);else for(e.addColumns(f,g,!0),c=a.changes,d=c.length-1;d>=0;d--)Ma(e,c[d])},a.prototype.getRowCount=function(a){return this.XTa(a).getRowCount()},a.prototype.setRowCount=function(a,b,c){var d=this,e=d.getRowCount(b);d.WTa>0&&d.zTa.push({oldRowCount:e,sheetArea:b,type:"setRowCount"}),3===b||2===b?(e>a&&d.deleteRows(a,e-a,c),d.XTa(3).setRowCount(a),d.XTa(2).setRowCount(a),d.kj.Wq(j.Events.WorksheetDataChanged,{type:"count"})):1===b&&(e>a&&d.YTa(!0,b).UTa(a,e-a),d.XTa(b).setRowCount(a)),d.Cgc({type:l.AxisInfoChangeType.setRowCount,count:a,sheetArea:b})},a.prototype.PMJ=function(a){var b=this;b.XTa(3).setRowCount(a),b.XTa(2).setRowCount(a),b.Cgc({type:l.AxisInfoChangeType.setRowCount,count:a,sheetArea:3})},a.prototype.bUa=function(a,b){b?this.setRowCount(a.rowCount,a.sheetArea,!0):this.setRowCount(a.oldRowCount,a.sheetArea,!0)},a.prototype.getColumnCount=function(a){return this.XTa(a).getColumnCount()},a.prototype.setColumnCount=function(a,b,c){var d=this,e=d.getColumnCount(b);d.WTa>0&&d.zTa.push({oldColCount:e,sheetArea:b,type:"setColumnCount"}),3===b||1===b?(e>a&&d.deleteColumns(a,e-a,c),d.XTa(3).setColumnCount(a),d.XTa(1).setColumnCount(a),d.kj.Wq(j.Events.WorksheetDataChanged,{type:"count"})):2===b&&(e>a&&d.YTa(!1,b).UTa(a,e-a),d.XTa(b).setColumnCount(a)),d.Cgc({type:l.AxisInfoChangeType.setColumnCount,count:a,sheetArea:b})},a.prototype.cUa=function(a,b){b?this.setColumnCount(a.colCount,a.sheetArea,!0):this.setColumnCount(a.oldColCount,a.sheetArea,!0)},a.prototype.getLastNonNullRow=function(a,b){var c=b?0:this.YTa(!0,a).VTa()-1;return z(this.XTa(a).Ef,this.zl(a).Ef,c)},a.prototype.getLastNonNullCol=function(a,b){var c=b?0:this.YTa(!1,a).VTa()-1;return z(this.XTa(a).Ff,this.zl(a).Ff,c)},a.prototype.getFreeAreaRowCount=function(a){var b=this.XTa(a);return b&&b.getFreeAreaRowCount()},a.prototype.getFreeAreaColumnCount=function(a){var b=this.XTa(a);return b&&b.getFreeAreaColumnCount()},a.prototype.setFreeAreaRowCount=function(a,b){this.XTa(b).setFreeAreaRowCount(a)},a.prototype.setFreeAreaColumnCount=function(a,b){this.XTa(b).setFreeAreaColumnCount(a)},a.prototype.$Gb=function(){var a=this,b=a.kj,c=0!==b.Dr().height&&a._Gb(!0,b.defaults.rowHeight),d=0!==b.Dr().width&&a._Gb(!1,b.defaults.colWidth);function e(a,c){var d,e,f,g,h=c.length;for(d=0;d<h;d++)e=c[d][0],f=c[d][1],g=c[d][2],g!==f&&(a?b.kq(e,3,"height",f,g):b.pq(e,3,"width",f,g))}c&&e(!0,c),d&&e(!1,d)},a.prototype._Gb=function(a,b){var c,d,e,f,g,h,i,j,k,m,n,o,p,q,r,s,u,v,w=this,x=w.kj,z=[],B=x.zoom(),C=a?x.getRowCount():x.getColumnCount(),D=w.YTa(a,3),E=0,F=0;if(x.Gt&&(F=a?x.Gt().height:x.Gt().width),a){if(x.options.colHeaderVisible)for(d=0;d<x.getRowCount(1);d++)E+=A(B*x.getRowHeight(d,1));c=x.Dr().height-x.options.sheetAreaOffset.top-F-E}else{if(x.options.rowHeaderVisible)for(d=0;d<x.getColumnCount(2);d++)E+=A(B*x.getColumnWidth(d,2));c=x.Dr().width-x.options.sheetAreaOffset.left-F-E}for(e=[],f=[],g=[],h=0,i=a?x.getRowVisible:x.getColumnVisible,d=0;d<C;d++)if(j=i.call(x,d),k=x.ITa.getSize(a,3,d),m=x.ITa.getStarSize(a,3,d),t.test(m))n="*"===m?1:parseFloat(m.replace("*","")),j&&n>0?(h+=n,e.push(d),f.push(n),g.push(k)):z.push([d,0,k]);else if(k=sa(k)?Math.floor(k):b,j&&(c-=A(B*k),c<1))return;if(!(h+z.length===0||c<1)){for(o=e.length,d=0;d<o-1;d++)if(p=c/h/B,n=f[d],k=y(p*n),q=A(B*k),z.push([e[d],k,g[d]]),c-=q,h-=n,q<1||c<1)return;for(r=A((c-1e-4)/B),z.push([e[o-1],r,g[o-1]]),d=0;d<z.length;d++)s=z[d][0],u=z[d][1],D.setSize(s,u),v=a?l.AxisInfoChangeType.setRowHeight:l.AxisInfoChangeType.setColumnWidth,w.Cgc({type:v,index:s});return z}},a.prototype.setCellState=function(a,b,c,d,e){var f=this.XTa(e);f&&f.setCellState(a,b,c,d)},a.prototype.toJSON=function(a){var b,c,d,e,f=this,g={},h=f.kj;return g.data=f.XTa(3).toJSON(3,a,f.kj),g.rowHeaderData=f.XTa(2).toJSON(2,a),g.colHeaderData=f.XTa(1).toJSON(1,a),g.rows=f.YTa(!0,3).toJSON(a),g.columns=f.YTa(!1,3).toJSON(a),g.rowHeaderColInfos=f.YTa(!1,2).toJSON(a),g.colHeaderRowInfos=f.YTa(!0,1).toJSON(a),h.filterRowsVisibleInfo&&!h.filterRowsVisibleInfo.empty&&f.updateToJsonRowInfo(h.filterRowsVisibleInfo.rowsVisibleInfo,g,h),g.leftCellIndex=h.getViewportLeftColumn(1),g.topCellIndex=h.getViewportTopRow(1),b=a&&a.ignoreStyle,b||(g.spans=Za(f.zl(3).toJSON()),g.rowHeaderSpan=Za(f.zl(2).toJSON()),g.colHeaderSpan=Za(f.zl(1).toJSON())),g.selections=f.selectionModel.toJSON(),c=f.defaults,d={colHeaderRowHeight:c.colHeaderRowHeight,colWidth:c.colWidth,rowHeaderColWidth:c.rowHeaderColWidth,rowHeight:c.rowHeight,_isExcelDefaultColumnWidth:c._isExcelDefaultColumnWidth},e=d.rowHeight===fa&&d.colWidth===ga&&d.rowHeaderColWidth===ha&&d.colHeaderRowHeight===ia,e||(g.defaults=d),g},a.prototype.updateToJsonRowInfo=function(a,b,c){var d,e,f,g;for(I(b.rows)&&(b.rows=[]),d=b.rows,e=c.getRowCount(),f=0;f<e;f++)g=a[f]===!1,g&&(I(d[f])?d[f]={}:d[f]=oa({},d[f]),d[f].visible=!1,d[f].isFilter=!0)},a.prototype.fromJSON=function(a,b,c,d,e){var f,g,h,j,k,m,n,o,p,q,r,s,t,u=this,x=u.QaK;if(u.XTa(3).fromJSON(a.data,b,c,x,d,3,e),u.XTa(2).fromJSON(a.rowHeaderData,b,c,x),u.XTa(1).fromJSON(a.colHeaderData,b,c,x),u.kj.showCell(a.topCellIndex||0,a.leftCellIndex||0,l.VerticalPosition.top,l.HorizontalPosition.left),u.YTa(!0,3).fromJSON(a.rows),u.YTa(!1,3).fromJSON(a.columns),u.YTa(!1,2).fromJSON(a.rowHeaderColInfos),u.YTa(!0,1).fromJSON(a.colHeaderRowInfos),a&&a.rows)for(f=Object.keys(a.rows),g=0,h=f;g<h.length;g++)j=h[g],k=a.rows[j],I(k)||u.Cgc({type:l.AxisInfoChangeType.setRowHeight,index:+j});if(a&&a.columns)for(f=Object.keys(a.columns),m=0,n=f;m<n.length;m++)j=n[m],k=a.columns[j],I(k)||u.Cgc({type:l.AxisInfoChangeType.setColumnWidth,index:+j});o=c&&c.ignoreStyle,o||(u.zl(3).fromJSON(a.spans,u.getRowCount(),u.getColumnCount()),u.zl(2).fromJSON(a.rowHeaderSpan),u.zl(1).fromJSON(a.colHeaderSpan)),u.selectionModel.fromJSON(a.selections,a.rowCount,a.columnCount),p=a.tag,p!==v&&(q=p.typeName,typeof q===w&&(r=i.getTypeFromString(q),r&&(p=new r,p.fromJSON&&p.fromJSON(a.tag))),u.do("setValueForKey",-1,-1,"tag",p,3)),s=a.defaults,s!==v&&(t=u.defaults,t.colHeaderRowHeight=qa(s.colHeaderRowHeight,ia),t.colWidth=qa(s.colWidth,ga),t.rowHeaderColWidth=qa(s.rowHeaderColWidth,ha),t.rowHeight=qa(s.rowHeight,fa),t._isExcelDefaultColumnWidth=s._isExcelDefaultColumnWidth)},a.prototype.bdK=function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=l.defaults.rowHeight,n=l.YTa(!0,3).bdK(c),o=l.XTa(3).bdK(l.kj,n,a,m,b,c),p=o.sheetData,q=o.hyperlinks,r=l.XTa(2).toJSON(2,c),s=l.XTa(1).toJSON(1,c),t=l.YTa(!1,2).toJSON(c),v=l.YTa(!0,1).toJSON(c),w=l.getValueForKey(-1,-1,"tag",3);return c&&c.includeStyles===!1||(d=Za(l.zl(2).toJSON()),e=Za(l.zl(1).toJSON())),f=l.defaults,g={colHeaderRowHeight:f.colHeaderRowHeight,rowHeaderColWidth:f.rowHeaderColWidth},h=n.map(function(a){return a&&a.starSize?{starSize:a.starSize}:u}),i=l.selectionModel.selectionPolicy,j=l.selectionModel.selectionUnit,k=g.rowHeaderColWidth===ha&&g.colHeaderRowHeight===ia,{sheetData:p,hyperlinks:q,rowHeaderData:r,colHeaderData:s,rowHeaderColInfos:t,colHeaderRowInfos:v,rowHeaderSpan:d,colHeaderSpan:e,rowInfos:h,tag:w,defaults:k?void 0:g,selectionPolicy:i,selectionUnit:j}},a.prototype.cdK=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n=this;n.YTa(!0,3).cdK(a,c),n.XTa(3).cdK(n.kj,a,b,c,v,e,f,n.QaK,g),d&&(n.XTa(2).fromJSON(d.rowHeaderData,v,c),n.XTa(1).fromJSON(d.colHeaderData,v,c),n.YTa(!1,2).fromJSON(d.rowHeaderColInfos),n.YTa(!0,1).fromJSON(d.colHeaderRowInfos),c&&c.includeStyles===!1||(n.zl(2).fromJSON(d.rowHeaderSpan),n.zl(1).fromJSON(d.colHeaderSpan)),h=n.YTa(!0,3),i=d.rowInfos||[],i.forEach(function(a,b){I(a&&a.starSize)||h.setStarSize(b,a.starSize)}),j=d.defaults,j!==v&&(k=n.defaults,k.colHeaderRowHeight=qa(j.colHeaderRowHeight,ia),k.rowHeaderColWidth=qa(j.rowHeaderColWidth,ha)),l=d.selectionPolicy,l!==v&&(n.selectionModel.selectionPolicy=+l),m=d.selectionUnit,m!==v&&(n.selectionModel.selectionUnit=+m))},a.prototype.startTransaction=function(){if(0===this.WTa){this.zTa=[];var b=this.kj,c=!b.isEventSuspended();c&&(this.zTa.events=[]),a.ao(this,"startTransaction")}this.WTa++},a.prototype.endTransaction=function(){var b,c;return this.WTa--,0===this.WTa?(a.ao(this,"endTransaction"),b=this.zTa,this.zTa=v,c=b.events,c&&0===c.length&&delete b.events,b):[]},a.prototype.dUa=function(){var a=this.zTa;if(a)return a.calc||(a.calc=[]),a.calc},a.prototype.JIb=function(a,b,c){var d=this.zTa;d&&d.push({type:"setIsValid",value:[a,b,c]})},a.prototype.KIb=function(a,b,c){var d=this.zTa;d&&d.push({type:"dirtyItem",value:[a,b,c]})},a.prototype.RIb=function(a,b){var c,d,e,f=a.value;f&&(c=this.bIb,d=c.getAnchorCell(f[0],f[1]),d&&(e=f[2],b&&(e=!e),d.isValid=e))},a.prototype.SIb=function(a,b){var c,d,e,f,g,h=a.value;h&&(c=h[0],d=h[1],e=b?h[3]:h[2],f=this.bIb,g=f.getAnchorItem(c,d),g&&(g.value=e))},a.prototype.applyChange=function(a,b,c){var d,e,f,g,h,i=this,j=a.type;!j&&a.length>0?(Ma(i,a,b),d=a[0][1],e=a[0][3],f=a[0][4],d>0&&e>=0&&f>=0&&(g=i.XTa(d),h=g.RTa(e,f),h&&La(h,h,!1,e,f,{},g.l$J))):"addRows"===j?i.ZTa(a,b):"addColumns"===j?i._Ta(a,b):"deleteRows"===j?i.$Ta(a,b):"deleteColumns"===j?i.aUa(a,b):"setRowCount"===j?i.bUa(a,b):"setColumnCount"===j?i.cUa(a,b):"setZoomFactor"===j?i.fUa(b?a.newValue:a.value):"updateDirty"===j?c.push(a):"setName"===j?b?i.pZa(a.newValue):i.pZa(a.value):"sortRange"===j?i.yxb(a,b):"setIsValid"===j?i.RIb(a,b):"dirtyItem"===j?i.SIb(a,b):"sheetProperty"===j&&i.kj[a.pname](b?a.value:a.oldValue)},a.prototype.applyChanges=function(b,c,d){var e,f,g,h,i;function j(a,b,c,d,e){e?a.setArrayFormula(b,c,e.rowCount,e.colCount,d):a.setFormula(b,c,d)}function k(a,b){var c,e,f,g,h,i;if(b)for(c in b)if(!isNaN(c)){e=parseInt(c,10),f=b[c];for(g in f)isNaN(g)||(h=parseInt(g,10),d?(i=f[g].formula!==f[g].oldFormula?f[g].formula:null,j(a,e,h,i,i?f[g].arrayInfo:null)):j(a,e,h,f[g].oldFormula,f[g].oldArrayInfo))}}if(e=this,f=[],c)if(d)for(g=0;g<c.length;g++)h=c[g],e.applyChange(h,d,f);else for(g=c.length-1;g>=0;g--)h=c[g],e.applyChange(h,d,f);i=e.kj,i.Oq={},i.Jq(),k(i,c&&c.formulas),a.ao(e,"applyChanges",{command:b,changes:c,isUndo:!d}),f.length>0&&i.fyb()},a.prototype.undo=function(b){var c,d,e,f,g,h,i,j,k=[],l=b&&b.events;if(l&&this.YVa(l,!0),b)for(c=b.length-1;c>=0;c--)d=b[c],e=d.type,e?"addRows"===e?this.ZTa(d):"addColumns"===e?this._Ta(d):"deleteRows"===e?this.$Ta(d):"deleteColumns"===e?this.aUa(d):"setRowCount"===e?this.bUa(d):"setColumnCount"===e?this.cUa(d):"setZoomFactor"===e?this.fUa(d.value):"updateDirty"===e?(this.gWa(d),k.push(d)):"setName"===e?this.pZa(d.value):"sortRange"===e?this.yxb(d):"setIsValid"===e?this.RIb(d):"dirtyItem"===e&&this.SIb(d):d.skipUndo||Ma(this,d);f=this.kj,f.Oq={},f.Jq(),g=k.length>0,g&&(h=f.Wu,h&&h.suspend(),k.forEach(function(a){f.eyb(a.row,a.col,3,!1)})),i=b&&b.tableChanges,i&&i.length>0&&(a.ao(this,C,{tableChanges:i}),b.tableChanges.isRestored=!0),j=b&&b.calc,j&&j.length&&f.gUa(j),g&&(h&&h.resume(!1),f.fyb()),delete this.XTa(3).Ap.JPJ,b&&a.ao(this,C,b),l&&this.YVa(l,!1)},a.prototype.do=function(a){var b,c,d,e=[];for(b=1;b<arguments.length;b++)e[b-1]=arguments[b];c=this,a&&(d=c[a],d&&d.apply(c,e))},a.prototype.XTa=function(a){return I(a)&&(a=3),this.sheetModels[a]},a.prototype.dWa=function(a,b,c){var d=0,e=0;I(c)&&(c=3,d=a,e=b),this.sheetModels[c]=new ca(a,b,d,e)},a.prototype.ZVa=function(a){var b=this,c=b.zTa,d=c&&c.events;d&&d.push(a)},a.prototype.YVa=function(a,b){var c,d,e,f,g=this.kj;for(g.TIb=!0,c=a.length-1;c>=0;c--)d=a[c],e=d[0],f=void 0,"cellChanged"!==e||b?"rowChanged"!==e||b?"columnChanged"!==e||b?"zoomChanged"!==e||b?"rowChanging"===e&&b?f=g.pCb:"columnChanging"===e&&b?f=g.qCb:"tableRowsChanged"!==e||b?"tableColumnsChanged"!==e||b?"rangeChanged"!==e||b||(f=g.Acc):f=g.VIb:f=g.UIb:f=g.gyb:f=g.pq:f=g.kq:f=g.Bq,f&&([].splice.call(a,c,1),f.apply(g,[].slice.call(d,1)));g.TIb=!1},a.prototype.getValue=function(b,c,d,e,f){if(I(d)&&(d=3),!e){var g={row:b,col:c,sheetArea:d,isValueGet:!1,value:v};if(a.ao(this,"getValue",g,function(){return g.isValueGet}),g.isValueGet)return g.value}return this.XTa(d).getValue(b,c,f)},a.prototype.setValue=function(b,c,d,e,f,g,h,i,k){var l,m,n,o,q,r,s,t,u,x,y,z,A;I(e)&&(e=3),m=this,n=m.kj,o=!g&&!n.isEventSuspended(),o&&(l=n.getValue(b,c,e,1)),q=!1,p&&n.getCalcService().allowDynamicArray&&!m.WIb&&3===e&&(m.QIb.push(m.bIb.updateItem(n.yj(),b,c,d)),q=!0),k||m.RaK(b,c,e,d,!0),r=!1,f||(s={row:b,col:c,value:d,sheetArea:e,isValueSet:!1,changes:m.zTa},a.ao(m,"setValue",s,function(){return s.isValueSet}),r=s.isValueSet),r||(t=void 0,u=void 0,m.WTa>0&&(!h||n.parent&&n.parent.options.saveChangesForSheet)&&(t=[["sheetModels",e],v],u={sheetArea:e}),m.XTa(e).setValue(b,c,d,t,u,i),i&&t&&Ua(this.dUa(),b,c)&&(t.skipUndo=!0),t&&t.length>0&&m.zTa.push(t),u&&u.type&&m.zTa.push(u),n.fyb()),o?(x=l!==d,y=!1,z=void 0,typeof d===w&&(z=j.util.w0a(d),z instanceof Date&&(y=!0),l instanceof Date&&(x=l.valueOf()!==z.valueOf())),x&&n.Bq("value",b,c,e,l,y&&z?z:d),n.Wq(j.Events.WorksheetDataChanged,{type:"value"})):n.aPJ(n,[{row:b,col:c}],0),q&&m.applyDynamicChanges(),A=n.getCellType(b,c,e),A&&A.qAb(n,b,c,d,e)},a.prototype.applyDynamicChanges=function(){var a,b,c,d,e,f=this,g=f.QIb,i=f.kj;if(!f.WIb&&g.length){for(f.WIb=!0,a=i.yj(),b=i.Bj(),c=0,d=g;c<d.length;c++)e=d[c],e&&(h.setSpillValues(e[0],a),h.markAnchorCellDirty(e[1],b,f.bIb));g.length=0,f.WIb=!1}},a.prototype.getDynamicArrayInfo=function(a,b){return this.bIb.getAnchorInfo(a,b)},a.prototype.getStyle=function(a,b,c){return this.XTa(c).getStyle(a,b,this.WTa>0)},a.prototype.setStyle=function(a,b,c,d){var e,f,g;I(d)&&(d=3),c&&c.cellType&&c.cellType.K7J(this.kj,a,b,c,d),e=this.WTa>0?[["sheetModels",d],v]:v,f=this.XTa(d).getStyle(a,b,!1),this.XTa(d).setStyle(a,b,c,e),this.kj.Wq(j.Events.WorksheetDataChanged,{type:"style"}),e&&e.length>0&&this.zTa.push(e),g=this.kj.parent,d===l.SheetArea.viewport&&db(f,c,g)&&this.RaK(a,b,d,this.getValue(a,b,d,!0),!1)},a.prototype.getValueForKey=function(a,b,c,d){return this.XTa(d).getValueForKey(a,b,c)},a.prototype.setValueForKey=function(a,b,c,d,e){I(e)&&(e=3);var f=this.WTa>0?[["sheetModels",e],v]:v;this.XTa(e).setValueForKey(a,b,c,d,f),f&&f.length>0&&this.zTa.push(f)},a.prototype.clear=function(b,c,d,e,f,g,h){var i,k,m,n,o,q,r,s,t,w,x,y,z,A,B,C;if(I(h)&&(h=3),i=this.WTa>0?[]:v,k=this,m=!1,n=k.kj,p&&!k.WIb&&3===h){for(o=n.yj(),q=k.QIb,r=k.bIb,s={},t=[],w=0;w<d;w++)for(x=0;x<e;x++)r.updateItem(o,b+w,c+x,u,s,t);q.push([s,t]),m=!0}for(this.XTa(h).clear(b,c,d,e,f,g,i),this.kj.Wq(j.Events.WorksheetDataChanged,{type:l.StorageType[f]}),w=0;w<d;w++)for(x=0;x<e;x++)this.RaK(b+w,c+x,h,u,!1);if(a.ao(this,"clear",{row:b,col:c,rowCount:d,colCount:e,type:f,ignoredRowList:g,sheetArea:h,changes:this.zTa}),i)for(y=["sheetModels",h],z=0,A=i.length;z<A;z++)B=i[z],B[0]=y.concat(B[0]),this.zTa.push(B);for(m&&this.applyDynamicChanges(),w=0;w<d;w++)for(x=0;x<e;x++)C=n.getCellType(b+w,c+x,h),C&&C.qAb(n,b+w,c+x,u,h)},a.prototype.swapNode=function(a,b,c,d,e){var f,g,h,i,j;if(I(e)&&(e=3),f=this.WTa>0?[]:v,this.XTa(e)._f(a,b,c,d,f),f)for(g=["sheetModels",e],h=0,i=f.length;h<i;h++)j=f[h],j[0]=g.concat(j[0]),this.zTa.push(j)},a.prototype.Cp=function(a,b,c,d){var e;this.WTa>0&&(e={sheetArea:d},I(d)&&(e.sheetArea=3)),this.XTa(d).Cp(a,b,c,e),e&&this.zTa.push(e)},a.prototype.gWa=function(a){this.XTa(a.sheetArea).gWa(a)},a.prototype.hUa=function(a){return this.XTa(a).Ap},a.prototype._CJ=function(a,b,c){var d,e=this.hUa(c),f=e[a];return!(!f||!(d=f[b]))},a.prototype.aDJ=function(a,b,c){var d,e,f=this.XTa(c).Ap;for(d=0;d<b;d++)e=a+d,e in f&&delete f[e]},a.prototype.bDJ=function(a,b){var c,d,e=this.kj,f=e.Ts;if(f)for(c=f.length-1;c>=0;c--)d=f[c].row,a<=d&&d<a+b&&f.splice(c)},a.prototype.iUa=function(a){this.XTa(a).Ap={}},a.prototype.vfc=function(a,b,c,d){var e=this.hUa(),f,g,h;if(e)for(f in e)ra(e,f)&&(g=e[f],h=parseInt(f,10),g&&"n"===g.rs&&(a||b&&c<=h&&h<c+d)&&(e[f]={}))},a.prototype.wfc=function(b,c,d,e,f){var g,h,i,j,k,l,m,n=this,o=n.hUa(),p=n.kj,s=p.tables;if(!r(o)){if(g=[],c>=0)for(h=c;h<c+e;h++)g.push(h);else for(i in o)ra(o,i)&&g.push(parseInt(i,10));j=[],k=[],s&&(j=s.xfc(c,d,e,f),k=s.yfc(c,d,e,f),j.length>0&&a.ao(this,"clearPendingChanges",{tableList:j})),q(g,function(a,c){var e,g,h;if(l=o[c],l&&"e"===l.rs)if(e=k.length,b)if(s&&0!==e&&s.zfc(k,c,-1))for(g=p.getColumnCount(),h=0;h<g;h++)s&&0!==e&&s.zfc(k,c,h)||(m=l[h],m&&delete l[h]);else o[c]={};else for(h=d;h<d+f;h++)s&&0!==e&&s.zfc(k,c,h)||(m=l[h],m&&delete l[h])})}},a.prototype.Afc=function(){var a,b=this,c=b.hUa();for(a in c)ra(c,a)&&c[a]&&"e"===c[a].rs&&(c[a]={})},a.prototype.jUa=function(a){this.XTa(a).gga++},a.prototype.kUa=function(a){var b,c=this.XTa(a);c.gga--,b=c.gga,b<0&&(c.gga=0)},a.prototype.getName=function(){return this.name||""},a.prototype.setName=function(a){var b=this;b.WTa>0&&b.zTa.push({type:"setName",value:b.name}),b.name=a},a.prototype.XIb=function(){return this.isSelected},a.prototype.GHb=function(a){this.isSelected=a},a.prototype.pZa=function(a){this.kj.name(a)},a.prototype.yxb=function(a,b){var c,d;c=a.byRows?a.row:a.column,b||(d=[],a.array.map(function(a,b){d[a-c]=b+c})),this.kj.sortRange(a.row,a.column,a.rowCount,a.columnCount,a.byRows,a.sortInfo,u,d)},a.prototype.getZoomFactor=function(){return this.zoomFactor},a.prototype.setZoomFactor=function(a){var b=this;b.WTa>0&&b.zTa.push({type:"setZoomFactor",value:b.zoomFactor}),b.zoomFactor=a},a.prototype.fUa=function(a){this.kj.zoom(a)},a.prototype.zl=function(a){return I(a)&&(a=3),this.spanModels[a]},a.prototype.eWa=function(a){I(a)&&(a=3),this.spanModels[a]=new X},a.prototype.getSpans=function(a,b,c){var d=this.zl(b).getSpans(a);return c&&(d=d.filter(function(a){return!a.isAutoMerge})),d},a.prototype.getSpan=function(a,b,c){return this.zl(c).get(a,b)},a.prototype.AIb=function(a,b,c){var d,e;return I(c)&&(c=3),d=this.XTa(c),d&&d.RTa?(e=d.RTa(a,b),e&&e.tipContent?e.tipContent:null):null},a.prototype.qHb=function(a,b,c,d){I(d)&&(d=3);var e=this.XTa(d).RTa(a,b);!c&&e?delete e.tipContent:c&&e?e.tipContent=c:c&&!e&&(e=this.XTa(d).RTa(a,b,!0),e.tipContent=c)},a.prototype.MTa=function(a,b,c,d,e){return this.zl(e).MTa(a,b,c,d)},a.prototype.qu=function(a,b,c,d,e){return this.zl(e).qu(a,b,c,d)},a.prototype.findSpan=function(a,b,c){return this.zl(c).find(a,b)},a.prototype.removeSpan=function(a,b){I(b)&&(b=3);var c=this.WTa>0?[["spanModels",b],v]:v;this.zl(b).remove(a,c),c&&c.length>0&&this.zTa.push(c)},a.prototype.addSpan=function(a,b){I(b)&&(b=3);var c=this.WTa>0?[["spanModels",b],v]:v;this.zl(b).add(a,c),this.kj.Wq(j.Events.WorksheetDataChanged,{type:"span"}),c&&c.length>0&&this.zTa.push(c)},a.prototype.clearSpan=function(a,b,c,d,e){I(e)&&(e=3);var f=this.WTa>0?[["spanModels",e],v]:v;this.zl(e).$b(a,b,c,d,f),this.kj.Wq(j.Events.WorksheetDataChanged,{type:"span"}),f&&f.length>0&&this.zTa.push(f)},a.prototype.moveSpan=function(a,b,c,d,e,f,g){I(g)&&(g=3);var h=this.WTa>0?[["spanModels",g],v]:v;this.zl(g).aB(a,b,c,d,e,f,h),this.kj.Wq(j.Events.WorksheetDataChanged,{type:"span"}),h&&h.length>0&&this.zTa.push(h)},a.prototype.copySpan=function(a,b,c,d,e,f,g){I(g)&&(g=3);var h=this.WTa>0?[["spanModels",g],v]:v;this.zl(g).Zz(a,b,c,d,e,f,h),this.kj.Wq(j.Events.WorksheetDataChanged,{type:"span"}),h&&h.length>0&&this.zTa.push(h)},a.prototype.e$J=function(a,b,c,d){this.colHeaderSelectionModel.x$J=new j.Range(a,b,c,d)},a.prototype.g$J=function(){return this.colHeaderSelectionModel.x$J},a.prototype.addSelection=function(a,b,c,d,e,f){var g,h,i;if(1===f)this.colHeaderSelectionModel.add(a,b,c,d,v);else if(g=this.WTa>0?[]:v,this.selectionModel.add(a,b,c,d,g,e),g)for(h=0;h<g.length;h++)i=g[h],i[0]=["selectionModel"].concat(i[0]),this.zTa.push(i)},a.prototype.getSelections=function(a){return 1===a?this.colHeaderSelectionModel.get():this.selectionModel.get()},a.prototype.setSelections=function(a,b){var c,d,e;if(1===b)this.colHeaderSelectionModel.set(a,v);else if(c=this.WTa>0?[]:v,this.selectionModel.set(a,c),c)for(d=0;d<c.length;d++)e=c[d],e[0]=["selectionModel"].concat(e[0]),this.zTa.push(e)},a.prototype.clearSelection=function(a){var b,c,d;if(1===a)this.colHeaderSelectionModel.clear(v);else if(b=this.WTa>0?[]:v,this.selectionModel.clear(b),b)for(c=0;c<b.length;c++)d=b[c],d[0]=["selectionModel"].concat(d[0]),this.zTa.push(d)},a.prototype.getActiveSelectedRangeIndex=function(){return this.selectionModel.getProperty("activeSelectedRangeIndex")},a.prototype.setActiveSelectedRangeIndex=function(a){var b=this.WTa>0?[["selectionModel"],v]:v;this.selectionModel.setProperty("activeSelectedRangeIndex",a,b),b&&this.zTa.push(b)},a.prototype.getSelectionPolicy=function(){return this.selectionModel.getProperty("selectionPolicy")},a.prototype.setSelectionPolicy=function(a){Na(this,"selectionPolicy",a)},a.prototype.getSelectionUnit=function(){return this.selectionModel.getProperty("selectionUnit")},a.prototype.setSelectionUnit=function(a){Na(this,"selectionUnit",a)},a.prototype.sp=function(a){return this.selectionModel.sp(a)},a.prototype.tp=function(a){return this.selectionModel.tp(a)},a.prototype.vp=function(a,b,c,d,e,f){return this.selectionModel.vp(a,b,c,d,e,f)},a.prototype.wp=function(a,b,c,d,e){return this.selectionModel.wp(a,b,c,d,e)},a.prototype.YTa=function(a,b){I(b)&&(b=3);var c=a?this.rowInfos:this.colInfos;return c[b]},a.prototype.fWa=function(a,b){I(b)&&(b=3);var c=a?this.rowInfos:this.colInfos;c[b]=new da},a.prototype.getPageBreak=function(a,b,c){var d=this.YTa(a,b);return d.getPageBreak(c)},a.prototype.setPageBreak=function(a,b,c,d){var e,f;I(b)&&(b=3),e=this.WTa>0?[[a?D:E,b],v]:v,f=this.YTa(a,b),f.setPageBreak(c,d,e),e&&this.zTa.push(e)},a.prototype.getVisible=function(a,b,c){var d=this.YTa(a,b);return d.getVisible(c)},a.prototype.setVisible=function(a,b,c,d){var e,f,g,h=this;I(b)&&(b=3),e=h.WTa>0?[[a?D:E,b],v]:v,f=h.YTa(a,b),f.setVisible(c,d,e),e&&h.zTa.push(e),g=a?l.AxisInfoChangeType.setRowVisible:l.AxisInfoChangeType.setColumnVisible,h.Cgc({type:g,index:c,sheetArea:b})},a.prototype.getResizable=function(a,b,c){var d=this.YTa(a,b);return d.getResizable(c)},a.prototype.setResizable=function(a,b,c,d){var e,f;I(b)&&(b=3),e=this.WTa>0?[[a?D:E,b],v]:v,f=this.YTa(a,b),f.setResizable(c,d,e),e&&this.zTa.push(e)},a.prototype.getSize=function(a,b,c){var d=this.YTa(a,b);return d.getSize(c)},a.prototype.getColumnHeaderFitMode=function(a,b,c){var d=this.YTa(a,b);return d.getColumnHeaderFitMode(c)},a.prototype.setColumnHeaderFitMode=function(a,b,c,d){var e,f,g,h,i,j,k,m,n,o=this,p=60,q=o.kj,r=q.getRowCount(1);if(I(b)&&(b=3),o.WTa&&(e=[[E,b],v],f=[[D,b],v]),h=o.YTa(a,b),i=h.getColumnHeaderFitMode(c),h.setColumnHeaderFitMode(c,d,e),k=!1,d===l.ColumnHeaderFitMode.vertical?(j=p,q.RKJ&&2===i&&q.RKJ--):d===l.ColumnHeaderFitMode.stack?(o.TKJ(c,b),q.RKJ||(q.RKJ=0),2!==i&&q.RKJ++):d===l.ColumnHeaderFitMode.normal&&(j=q.defaults.colHeaderRowHeight,q.RKJ&&2===i&&q.RKJ--),j){for(m=o.YTa(!0,b),n=0;n<r;n++)k||(g=q.getRowHeight(n,b),j=z(j,g)),j!==g&&(m.setSize(n,F,f),f&&(o.zTa.push(f),f=[[D,b],v]));q.defaults.colHeaderRowHeight=j}e&&o.zTa.push(e)},a.prototype.TKJ=function(a,b){var c,d,e,f,g,h,i,j=this,k=j.kj,m=j.YTa(!0,b);if(j.WTa&&(c=[[D,b],v]),e=j.kj.defaults.rowHeight||ia,g=j.getRowCount(l.SheetArea.colHeader),h=j.UKJ(a),!j.VKJ(a)){for(i=0;i<g;i++)d=e*h,f=k.getRowHeight(i,b),d=z(d,f),d!==f&&(m.setSize(i,F,c),c&&(j.zTa.push(c),c=[[D,b],v]));k.defaults.colHeaderRowHeight=d}},a.prototype.VKJ=function(a){var b=this,c=b.kj,d=c.frozenColumnCount()-1,e=c.frozenTrailingColumnCount(),f=b.getColumnCount()-1;return a===d||a===f||a===f-e},a.prototype.WKJ=function(a){var b,c,d=this,e=d.kj,f=e.frozenColumnCount(),g=e.frozenTrailingColumnCount(),h=d.getColumnCount();return f&&(b=a===f),g&&(c=a===h-g),b||c},a.prototype.UKJ=function(a,b){var c,d,e,f,g,h,i,j,k=this,m=l.SheetArea.colHeader,n={},o=k.kj,p=o.getColumnCount();for(b||(b=k.YTa(!1,m).infos),c=d=e=b[a]&&b[a].columnHeaderFitMode===l.ColumnHeaderFitMode.stack?a:a-1,f=e;f>=0;f--){if(o.getColumnWidth(f,m)){if(b[f]&&b[f].columnHeaderFitMode===l.ColumnHeaderFitMode.stack&&!k.MTa(-1,f,-1,1,l.SheetArea.colHeader)){if(k.WKJ(f)){c=f;break}c=f;continue}break}c=f,n[f]=!0}for(f=e;f<p;f++){if(o.getColumnWidth(f,m)){if(b[f]&&b[f].columnHeaderFitMode===l.ColumnHeaderFitMode.stack&&!k.MTa(-1,f,-1,1,l.SheetArea.colHeader)){if(k.VKJ(f))break;d=f;continue}break}if(d=f,n[f]=!0,k.VKJ(f))break}return g=Object.keys(n).length,h=d-c-g+1,i=1,j=o.Zq(d,m,!0),!j||k.VKJ(d)||k.MTa(-1,j,-1,1,l.SheetArea.colHeader)?h:h+i},a.prototype.XKJ=function(a,b,c){var d,e,f,g=this,h=0,i=g.kj,j=i.ITa;for(b||(b=g.YTa(!1,l.SheetArea.colHeader).infos),d=g.YKJ(a),e=a-1;e>=d;e--)if(f=i.getColumnWidth(e)){if(!b[e]||b[e].columnHeaderFitMode!==l.ColumnHeaderFitMode.stack||j.MTa(-1,e,-1,1,l.SheetArea.colHeader)){if(c&&b[e]&&b[e].columnHeaderFitMode===l.ColumnHeaderFitMode.vertical&&!j.MTa(-1,e,-1,1,l.SheetArea.colHeader))continue;return h}h++}return h},a.prototype.QKJ=function(a,b){var c,d,e=this,f=e.kj,g=f.getColumnCount();for(d=a+1;d<g;d++)if(c=e.getColumnHeaderFitMode(!1,1,d),c===b)return d;return u},a.prototype.YKJ=function(a){var b=this,c=b.kj,d=c.frozenColumnCount(),e=c.frozenTrailingColumnCount(),f=b.getColumnCount();return a<d?0:a<f-e?d:f-e},a.prototype.getStarSize=function(a,b,c){var d=this.YTa(a,b);return d.getStarSize(c)},a.prototype.getActualSize=function(a,b,c){var d=this.YTa(a,b);return d.getActualSize(c)},a.prototype.setSize=function(a,b,c,d){var e,f,g,h=this;I(b)&&(b=3),e=h.WTa>0?[[a?D:E,b],v]:v,f=h.YTa(a,b),f.setSize(c,d,e),this.kj.Wq(j.Events.WorksheetDataChanged,{type:"size"}),e&&h.zTa.push(e),h.setStarSize(a,b,c,u),g=a?l.AxisInfoChangeType.setRowHeight:l.AxisInfoChangeType.setColumnWidth,h.Cgc({type:g,index:c,value:d,sheetArea:b})},a.prototype.setStarSize=function(a,b,c,d){var e,f;I(b)&&(b=3),e=this.WTa>0?[[a?D:E,b],v]:v,f=this.YTa(a,b),f.setStarSize(c,d,e),e&&!I(e[1])&&this.zTa.push(e)},a.prototype.VTa=function(a,b){var c=this.YTa(a,b);return c.VTa()},a.prototype.Hp=function(a,b){var c=this.YTa(a,b);return c.Hp()},a.prototype.Jp=function(a,b,c){var d=this.YTa(a,b);return d.Jp(c)},a.prototype.setItem=function(a,b,c,d){var e,f,g,h=this;I(b)&&(b=3),e=h.WTa>0?[[a?D:E,b],v]:v,f=h.YTa(a,b),f.Kp(c,d,e),d&&(I(d.size)||(g=a?l.AxisInfoChangeType.setRowHeight:l.AxisInfoChangeType.setColumnWidth,h.Cgc({type:g,index:c,value:d.size,sheetArea:b})),I(d.visible)||(g=a?l.AxisInfoChangeType.setRowVisible:l.AxisInfoChangeType.setColumnVisible,h.Cgc({type:g,index:c,sheetArea:b}))),e&&h.zTa.push(e)},a}(),b.lUa=la,j.Zn(la);function $a(a,b){return!b&&!I(a)&&"string"==typeof a}ma=["=","+","-"];function _a(a,b,c,d){if(b&&b.quotePrefix)return!1;if(c&&c[a])return!0;if(ma.indexOf(a[0])!==-1&&a.length>1){var e={value:a,isInvalid:!1,allowDynamicArray:d};if(la.ao(v,"isInvalidFormula",e),e.isInvalid)return c&&(c[a]=!0),!0}}function ab(a){I(a.cellState)||(a.cellState&=~l.CellStatesType.invalidFormula)}function bb(a){I(a.cellState)&&(a.cellState=0),a.cellState|=l.CellStatesType.invalidFormula}function cb(a,b,c,d,e,f,g){if(!I(a))return $a(b,c)?(f&&d&&"string"==typeof d&&(d=eb(d,f)),f&&I(g)&&(g=f.options.allowDynamicArray),_a(b,d,e,g)?void bb(a):void ab(a)):void ab(a)}function db(a,b,c){if(!I(a)||!I(b))return"string"==typeof a&&(a=eb(a,c)),"string"==typeof b&&(b=eb(b,c)),(a&&a.quotePrefix)!==(b&&b.quotePrefix)}function eb(a,b){var c,d,e,f,g;if(b){if(c=b.getNamedStyle(a))return c;for(d=0,e=b.sheets;d<e.length;d++)if(f=e[d],g=f.getNamedStyle(a))return g;return u}}function fb(a,b){var c,d,f;if("string"==typeof a&&"/OADate"===a.substring(0,7)&&!b.formatter){if(I(b)&&(b=new e.Style),b._autoFormatter)return b.formatter=b._autoFormatter.formatCached,b;c=a.indexOf("("),d=a.indexOf(")"),c!==-1&&d!==-1&&(f=parseInt(a.substring(c+1,d),10),f<1?b.formatter="h:mm:ss":f>1&&(b.formatter="M/d/yyyy"))}return b}function gb(a,b){if("object"==typeof b)return b;if("string"==typeof b){var c=a.Hq(b);return c?c:new e.Style}}function hb(a,b,c){c&&(c=gb(a,c),ib(b,c))}function ib(a,b){a.backColor===v&&b.backColor!==v&&b.applyFill!==!1&&(a.backColor=b.backColor),b.applyFont!==!1&&(a.foreColor===v&&b.foreColor!==v&&(a.foreColor=b.foreColor),a.themeFont===v&&a.font===v?(a.themeFont=b.themeFont,a.font=b.font):a.themeFont!==v&&a.font===v&&(a.font=b.font),a.textDecoration===v&&b.textDecoration!==v&&(a.textDecoration=b.textDecoration)),b.applyAlignment!==!1&&(a.hAlign===v&&b.hAlign!==v&&(a.hAlign=b.hAlign),a.vAlign===v&&b.vAlign!==v&&(a.vAlign=b.vAlign),a.textIndent===v&&b.textIndent!==v&&(a.textIndent=b.textIndent),a.wordWrap===v&&b.wordWrap!==v&&(a.wordWrap=b.wordWrap),a.isVerticalText===v&&b.isVerticalText!==v&&(a.isVerticalText=b.isVerticalText),a.shrinkToFit===v&&b.shrinkToFit!==v&&(a.shrinkToFit=b.shrinkToFit),a.textOrientation===v&&b.textOrientation!==v&&(a.textOrientation=b.textOrientation)),a.formatter===v&&b.formatter!==v&&b.applyNumberFormat!==!1&&(a.formatter=b.formatter),b.applyBorder!==!1&&(a.borderLeft===v&&b.borderLeft!==v&&(a.borderLeft=jb(b.borderLeft)),a.borderTop===v&&b.borderTop!==v&&(a.borderTop=jb(b.borderTop)),a.borderRight===v&&b.borderRight!==v&&(a.borderRight=jb(b.borderRight)),a.borderBottom===v&&b.borderBottom!==v&&(a.borderBottom=jb(b.borderBottom)),
a.diagonalUp===v&&b.diagonalUp!==v&&(a.diagonalUp=jb(b.diagonalUp)),a.diagonalDown===v&&b.diagonalDown!==v&&(a.diagonalDown=jb(b.diagonalDown))),a.locked===v&&b.applyProtection!==!1&&(a.locked=b.locked),a.quotePrefix===v&&b.quotePrefix!==v&&(a.quotePrefix=b.quotePrefix)}function jb(a){if(!a)return a;var b={};return I(a.color)||(b.color=a.color),I(a.style)||(b.style=a.style),I(a.level)||(b.level=a.level),b}},"./dist/core/worksheet/worksheet-render.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/stylehelper.js"),h=c("./dist/core/worksheet/worksheet-model.js"),i=c("./dist/core/worksheet/worksheet-border.js"),j=c("./dist/core/core.enum.js"),k=function(a){return a.getSparkline},l=d.Common.k,m=f.Ul.ol,n=f.Ul.fp,o=f.Ul.lZa,p=f.Ul.lHb,q=d.Common.j.Fa,r=f.Ul.Fxb,s=g.Ho,t=g.To.No,u=null,v=void 0,w=Math.min,x=Math.max,y=Math.abs,z=Math.sin,A=Math.cos,B=Math.tan,C=Math.floor,D=Math.round,E=parseInt,F="black",G="transparent",H="rowHeader",I="columnHeader",J="white",K="number";function _(a){return a.height}function aa(a){return a.width}function ba(a,b,c,d,e,f,g){a.beginPath(),a.lineWidth=b,a.strokeStyle=c,a.moveTo(d,e),a.lineTo(f,g),a.stroke()}L=2,M=100;function ca(a,b){var c,d,e=0;return"string"==typeof a&&(c=a.split(" ",4),d=c.length,1===d?e=2*E(c[0]):2===d||3===d?e=2*E(c[1]):4===d&&(e=E(c[1])+E(c[3]))),e*b}function da(a,b,c,d,e,g,h,i){var j,k,l,m,o,p,r,s,u,v=e.zoom(),w=c.font,x=c.textIndent,B=c.textOrientation,C=c.isVerticalText,D=c.textIndent&&0!==c.textIndent,E=0!==B&&!q(B);return w=w?t(w,v).font:d,typeof i===K&&1!==i&&(w=t(w,i).font),o=0,p=a,a&&p.richText?o=fa(p.richText,w,v):a&&E&&!C&&!D?(k=y(B*Math.PI/180),l=z(k),m=A(k),c.wordWrap?(r=e.ss,s=r.Sl(g),o=f.Vn.mHb(g,h,l,m,b,w,s)):(u=n(w),o=f.Vn.Xn(b,w)*m+u*l)):o=f.Vn.Xn(b,w),o+=ha(e,x,g,h)+L,j=o+ca(c.cellPadding,v)}function ea(a,b,c){if(a&&-90<=a&&a<=90){var d=C(c/B(y(a*Math.PI/180)));return d+b+4}}function fa(a,b,c){return ga(a,b,c),f.Vn.R_a(a,b,1)}function ga(a,b,c){var d,e,f,g,h;for(d=0,e=a;d<e.length;d++)f=e[d],g=void 0,f.style=f.style||{},h=f.style,g=h.font?t(h.font,c).font:b,h.font=g}function ha(a,b,c,d){if(!q(c)&&!q(d)&&a.outlineColumn){var e=a.outlineColumn.LRa(c,d);if(e)return e}return b?8*b:0}function ia(a,b,c,d,e,f,g,i,k){var l,m,n,o,p,s,t,v,w,x,y,z,A,B,C,D,E,F,G,H;if(r(e.data)&&a.parent&&a.parent.options.numbersFitMode!==j.NumbersFitMode.overflow)return u;if(l=a.ss,m=aa(e),n=aa(e),p=e.style,t=e.text,v=e.printZoomFactor,w=p.watermark,x=p.wordWrap,y=p.textOrientation,B=a.options.allowCellOverflow,b.findCell(f,g))return u;if(p.cellButtons&&p.cellButtons.length>0)return u;if(C=p.cellType||c,D=a.parent&&a.parent.options.numbersFitMode,E=D===j.NumbersFitMode.mask||D===j.NumbersFitMode.overflow&&!r(e.data),!C.allowOverflow||!t&&!w||!y&&x&&E)return u;if(t||(t=w),!B&&!y)return u;if(z=da(e.data,t,p,d,a,f,g,v),z<=n)return u;if(90===Math.abs(y)&&x)return u;for(F=g,G=g,s=g+(k?1:-1);(k?s<=i:s>=i)&&!b.findCell(f,s)&&(A=l.Ym(f,s),o=l.zHb(f,s,3,1,A),H=A.textOrientation,q(o)||H&&y)&&!A.watermark&&!(A.cellType&&"1"!==A.cellType.typeName||A.cellButtons&&A.cellButtons.length>0)&&(k?G=s:F=s,n+=l._m(s),!(z<=n));s+=k?1:-1);return k&&G===g||!k&&F===g?u:new h.op(g,F,G,z,m,n,k?-1:n,k?n:-1)}N=function(){function a(a,b,c){var d=this;d.kj=a,d.pJ=a.Hr(c),d.qJ=a.Ir(b,c,j.SheetArea.viewport,!0),d.yI=t(a.yl.Bl(),a.zoom()).font,d.Rq=a.Al(),d.rJ={}}return a.prototype.nJ=function(a,b,c){var d,e,g,i,j,k=this,l=k.rJ[a];if(l)return l;if(d=k.pJ,e=d.length,g=new h.np,b||(b=f.Vn.bm()),e>0){for(g.headingOverflowLayouts=k.sJ(a,b),j=0;j<e;j++)i=this._WJ(a,j,b,c),i&&g.push(i);g.trailingOverflowLayouts=k.wJ(a,b)}return k.rJ[a]=g,g},a.prototype._WJ=function(a,b,c,d){var e,g,h,i,k,l,n,o,p,s,t,u,v,w,x,y,z,A,B,C,D,E,F=this,G=F.kj,H=G.ss,I=F.pJ,J=I.length;if(0!==J&&(v=I[0].col,w=I[J-1].col,c||(c=f.Vn.bm()),i=I[b],!(aa(i)<=0)&&(k=i.col,l=H.Ym(a,k),n=H.zHb(a,k,3,1),e=l.textOrientation,g=l.isVerticalText,h=l.textIndent&&0!==l.textIndent,x=l&&(l.borderLeft||l.borderTop||l.borderRight||l.borderBottom),(!q(n)||l.watermark)&&(y=G.parent&&G.parent.options.numbersFitMode,!((l.shrinkToFit||!e&&l.wordWrap&&(y===j.NumbersFitMode.mask||y===j.NumbersFitMode.overflow&&!r(n))||g)&&4!==l.hAlign||4!==l.hAlign&&G.options.allowCellOverflow===!1||(z=G.conditionalFormats,z&&(A=z.oRa(G,a,k,n,3),B=A&&A.dataBar,C=A&&A.iconSet,B&&B.showBarOnly||C&&C.showIconOnly)))))))return o=H._m(k),p=H.Sl(a),D=l.cellType||F.Rq,E={},t=f.mn.vn(G,l,n,E,{row:a,col:k,sheet:G}),E&&E.content&&E.content.length>0&&!l.shrinkToFit&&e&&(t=D.sHb(c,E.content,p-4,l.font)),s=l.hAlign,3===s&&(s=m(s,n,l.formatter,e)),!x||!e||g&&4!==s||h?0===s?u=F.tJ({data:n,style:l,width:o,text:t,printZoomFactor:d},a,k,w):2===s?u=F.uJ({data:n,style:l,width:o,text:t,printZoomFactor:d},a,k,v):1===s?u=F.vJ({data:n,style:l,width:o,text:t,printZoomFactor:d},a,k,v,w):4===s&&(u=F.ARJ({data:n,style:l,width:o,text:t,printZoomFactor:d},a,k,0,G.getColumnCount()-1)):0>e&&e>-90?u=F.YIb({data:n,style:l,width:o,text:t,printZoomFactor:d},a,k,v):0<e&&e<90&&(u=F.YIb({data:n,style:l,width:o,text:t,printZoomFactor:d},a,k,w,!0)),u},a.prototype.aXJ=function(a){var b,c,d,e,f,g=this,h=g.pJ,i=h.length,j=g.kj,k=j.ss;for(f=i-1;f>=0;f--)if(b=h[f],e=b.col,c=k.Ym(a,e),d=k.zHb(a,e,3,1),d||c.watermarks)return this._WJ(a,f)},a.prototype.tJ=function(a,b,c,d){var e=this;return ia(e.kj,e.qJ,e.Rq,e.yI,a,b,c,d,!0)},a.prototype.uJ=function(a,b,c,d){var e=this;return ia(e.kj,e.qJ,e.Rq,e.yI,a,b,c,d)},a.prototype.YIb=function(a,b,c,d,e){var f,g,i,j,k,l,m=this,n=m.kj,o=m.qJ,p=m.Rq,q=m.yI,r=n.ss,s=aa(a),t=aa(a),v=a.style,w=a.text,x=a.printZoomFactor,y=v.watermark,z=v.wordWrap,A=v.textOrientation,B=v&&(v.borderLeft||v.borderTop||v.borderRight||v.borderBottom),C=v.isVerticalText,D=v.textIndent&&0!==v.textIndent,E=n.options.allowCellOverflow;if(o.findCell(b,c))return u;if(v.cellButtons&&v.cellButtons.length>0)return u;if(j=v.cellType||p,!j.allowOverflow||!w&&!y||!A&&z)return u;if(w||(w=y),!E&&!A)return u;if(g=!B||C||D?da(a.data,w,v,q,n,b,c,x):ea(A,r._m(c),r.Sl(b)),g<=t)return u;for(k=c,l=c,f=c+(e?1:-1);(e?f<=d:f>=d)&&!o.findCell(b,f)&&(i=r.Ym(b,f),!i.watermark)&&!(i.cellType&&"1"!==i.cellType.typeName||i.cellButtons&&i.cellButtons.length>0)&&(e?l=f:k=f,t+=r._m(f),!(g<=t));f+=e?1:-1);return e&&l===c||!e&&k===c?u:new h.op(c,k,l,g,s,t,e?-1:t,e?t:-1)},a.prototype.vJ=function(a,b,c,d,e){var f,g,i,k,l,m,n,o,p,s,t,v,w,x,y,z,A,B,C,D,E,F,G;if(r(a.data)&&this.kj.parent&&this.kj.parent.options.numbersFitMode!==j.NumbersFitMode.overflow)return u;if(f=this,g=f.kj,i=g.ss,k=f.qJ,l=aa(a),m=aa(a),o=a.style,s=a.text,t=a.printZoomFactor,v=o.textOrientation,w=o.watermark,x=o.wordWrap,A=g.options.allowCellOverflow,k.findCell(b,c))return u;if(o.cellButtons&&o.cellButtons.length>0)return u;if(B=o.cellType||f.Rq,!B.allowOverflow||!s&&!w||!v&&x&&g.parent&&g.parent.options.numbersFitMode!==j.NumbersFitMode.overflow)return u;if(s||(s=w),!A&&!v)return u;if(y=da(a.data,s,o,f.yI,g,b,c,t),y<=m)return u;if(90===Math.abs(v)&&x)return u;for(C=c,D=m/2,p=c-1;p>=d&&!k.findCell(b,p)&&(z=i.Ym(b,p),n=i.zHb(b,p,3,1,z),E=z.textOrientation,q(n)||E&&v)&&!z.watermark&&!(z.cellType&&"1"!==z.cellType.typeName||z.cellButtons&&z.cellButtons.length>0)&&(C=p,D+=i._m(p),!(y/2<=D));p--);for(F=c,G=m/2,p=c+1;p<=e&&!k.findCell(b,p)&&(z=i.Ym(b,p),n=i.zHb(b,p,3,1,z),E=z.textOrientation,q(n)||E&&v)&&!z.watermark&&!(z.cellType&&"1"!==z.cellType.typeName||z.cellButtons&&z.cellButtons.length>0)&&(F=p,G+=i._m(p),!(y/2<=G));p++);return C===F?u:new h.op(c,C,F,y,l,D+G,D,G)},a.prototype.dSJ=function(a,b,c){var d=a.Ym(b,c),e=a.zHb(b,c,3,1,d);return!(!d.textOrientation&&!q(e))&&(!d.watermark&&!(d.cellType&&"1"!==d.cellType.typeName||d.cellButtons&&d.cellButtons.length>0))},a.prototype.ARJ=function(a,b,c,d,e){var f,g,i,k,l,m,n,o,p,s,t,v,w,x=this,y=x.kj,z=y.ss,A=x.qJ,B=aa(a),C=a.style,D=C.shrinkToFit,E=a.text,F=a.printZoomFactor,G=C.watermark,H=C.wordWrap;if(A.findCell(b,c))return u;if(C.cellButtons&&C.cellButtons.length>0)return u;for(E||(E=G),i=da(a.data,E,C,x.yI,y,b,c,F),l=c,m=c,n=z._m(c),o=l+1;o<=e&&(k=z.Ym(b,o),f=z.zHb(b,o,3,1,k),q(f)&&4===k.hAlign&&q(y.getSpan(b,o)))&&!k.watermark&&!(k.cellType&&"1"!==k.cellType.typeName||k.cellButtons&&k.cellButtons.length>0);o++)m=o,n+=z._m(o);if(p=(i-n)/2,r(a.data)&&this.kj.parent&&this.kj.parent.options.numbersFitMode!==j.NumbersFitMode.overflow&&(p=0),s=l,t=n/2,v=m,w=n/2,!D&&!H&&y.options.allowCellOverflow!==!1){for(g=c-1;g>=d&&p>0&&(this.dSJ(z,b,g)&&!A.findCell(b,g))&&(s=g,t+=z._m(g),!(p<=t-n/2));g--);for(g=m+1;g<=e&&p>0&&(this.dSJ(z,b,g)&&!A.findCell(b,g))&&(v=g,w+=z._m(g),!(p<=w-n/2));g++);}return new h.op(c,s,v,i,B,t+w,t,w,n)},a.prototype.sJ=function(a,b){var c,d,e,g,h,i,k,l,n,o,p,r,s,t,u,w,x=this,y=x.kj,z=y.ss,A=x.pJ;if(0===A.length)return[];for(c=A[0].col,d=A[A.length-1].col,e=y.ITa,u=[],b||(b=f.Vn.bm()),w=1;w<M;w++){if(n=c-w,n<0)return u;if(e.findSpan(a,n)||y.xJb&&y.xJb.zJb(a,n,j.SheetArea.viewport))return u;if(h=z.zHb(a,n,3,1),i=z._m(n),i>0&&!q(h)){if(g=z.Ym(a,n),l=g.hAlign,4!==l&&y.options.allowCellOverflow===!1)continue;3===l&&(l=m(l,h,v,g.textOrientation)),k=z.Sl(a),s=g.cellType||x.Rq,t={},p=f.mn.vn(y,g,h,t,{row:a,col:n,sheet:y}),t&&t.content&&t.content.length>0&&!g.shrinkToFit&&g.textOrientation&&(p=s.sHb(b,t.content,k-4,g.font)),r={data:h,style:g,width:i,text:p},0<g.textOrientation&&g.textOrientation<90?o=x.YIb(r,a,n,d,!0):0===l?o=x.tJ(r,a,n,d):1===l?o=x.vJ(r,a,n,c,d):4===l&&(o=x.ARJ(r,a,n,c,d)),o&&o.endColumn>=c&&u.push(o)}}return u},a.prototype.wJ=function(a,b){var c,d,e,g,h,i,k,l,n,o,p,r,s,t,u,w,x,y=this,z=y.kj,A=z.ss,B=y.pJ;if(0===B.length)return[];for(c=B[0].col,d=B[B.length-1].col,e=z.ITa,p=z.getColumnCount(),w=[],b||(b=f.Vn.bm()),x=1;x<M;x++){if(r=d+x,r>=p)return w;if(e.findSpan(a,r)||z.xJb&&z.xJb.zJb(a,r,j.SheetArea.viewport))return w;if(h=A.zHb(a,r,3,1),i=A._m(r),i>0&&!q(h)){if(g=A.Ym(a,r),l=g.hAlign,4!==l&&z.options.allowCellOverflow===!1)continue;3===l&&(l=m(l,h,v,g.textOrientation)),k=A.Sl(a),n=g.cellType||y.Rq,o={},t=f.mn.vn(z,g,h,o,{row:a,col:r,sheet:z}),o&&o.content&&o.content.length>0&&!g.shrinkToFit&&g.textOrientation&&(t=n.sHb(b,o.content,k-4,g.font)),u={data:h,style:g,width:i,text:t},0>g.textOrientation&&g.textOrientation>-90?s=y.YIb(u,a,r,c,!1):2===l?s=y.uJ(u,a,r,c):1===l?s=y.vJ(u,a,r,c,d):4===l&&(s=y.ARJ(u,a,r,0,d)),s&&s.startColumn<=d&&w.push(s)}}return w},a}(),b.xJ=N;function ja(a){var b=a.parent,c={nps:!0};return e.Worksheet.ao(a,"needPaintSelection",c),(f.Vl.Wl(a)||b&&!b.options.hideSelection)&&c.nps}b.needPaintSelection=ja;function ka(a){var b=a.parent;return b&&b.options.backColor||J}O=function(){function a(a){this.kj=a}return a.prototype.bm=function(){var a=this.kj,b=u,c=a.Ws();return c&&c.getContext&&(b=c.getContext("2d")),b},a.prototype.vI=function(){var a,b=this,c=b.kj,d=c.Dr(),e=c.Xs,g=aa(e),h=_(e),i=b.wI;return i&&aa(i)===g&&_(i)===h||(i&&f.En.Qn(c,i),b.wI=i=f.Ul.Nl("canvas"),i.getContext&&(b.xI=i.getContext("2d"),f.En.Kn(i,u,c),f.En.Pn(i,aa(d),_(d)))),a=b.xI,a&&(a.beginPath(),o(a,b.Cl(b.Bl())),a.name="bufferContext"),a},a.prototype.Bl=function(){return this.yI||(this.yI=s+" "+this.kj.currentTheme().bodyFont()),this.yI},a.prototype.us=function(){this.yI=u},a.prototype.zI=function(a){var b,c=this.kj,d=c.parent,e=d?d.options.grayAreaBackColor||f.Im.Mm("gc-grayArea").backgroundColor:"gray",g=f.Rm.Om(c,e);return a?(b=d?d.options.backgroundImage:u,b&&(g=G),g):g},a.prototype.Cl=function(a){var b=this.kj,c=b.zoom();return 1===c?a:t(a,c).font},a.prototype.Mx=function(a,b,c,d,e){var g,h,i,j,k,l=this,m=l.wI,n=l.bm();c<=0||d<=0||!m||!n||(e||(e=l.kj.Dr()),g=f.En.Ln(m),h=f.En.Mn(m),1!==g&&(a*=g,b*=h,c*=g,d*=h,e=new f.Rect(e.x*g,e.y*h,aa(e)*g,_(e)*h)),i=e.getIntersect(a,b,c,d),i&&(i.round(),a=i.x,b=i.y,c=aa(i),d=_(i),j=aa(m),j&&a+c>j&&(a=j-c,a<0&&(c+=a,a=0)),k=_(m),k&&b+d>k&&(b=k-d,b<0&&(d+=b,b=0)),f.Bn.Cn(n,1,1),n.clearRect(a,b,c,d),n.drawImage(m,a,b,c,d,a,b,c,d),f.Bn.Cn(n,g,h)))},a.prototype.dm=function(a,b){a&&this.Mx(a.x,a.y,aa(a),_(a),b)},a.prototype.Ow=function(a,b,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;if(c>0&&d>0)try{h=this,i=h.kj,j=h.bm(),k=i.Ws(),l=h.vI(),m=h.wI,n=c,o=d,p=e,q=g,r=n,s=o,t=f.En.Ln(k),u=f.En.Mn(k),a=D(a*t),b=D(b*u),c=D(c*t),d=D(d*u),p=D(p*t),q=D(q*u),r=D(r*t),s=D(s*u),v=aa(m),w=_(m),v&&a+c>v&&(a=v-c,a<0&&(c+=a,a=0)),w&&b+d>w&&(b=w-d,b<0&&(d+=b,b=0)),v&&p+r>v&&(p=v-r,p<0&&(r+=p,p=0)),w&&q+s>w&&(q=w-s,q<0&&(s+=q,q=0)),f.Bn.Cn(j,1,1),f.Bn.Cn(l,1,1),j.clearRect(p,q,r,s),j.drawImage(m,a,b,c,d,p,q,r,s),l.clearRect(p,q,r,s),l.drawImage(k,p,q,r,s,p,q,r,s),f.Bn.Cn(j,t,u),f.Bn.Cn(l,t,u)}catch(a){}},a.prototype.im=function(a,b,c,d,e,g){var h,i,k,l,m,n,o,p,r,s,t,u,v,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V=this,W=V.kj,X=q(e)||3===e;if(c||(c=V.bm()),h=!1,i=f.kf(-1,-1,-1,-1),k=W.ITa,a&&(i=W.options.allowCellOverflow||W.RKJ?f.kf(a.row,0,a.rowCount,W.getColumnCount(e)):f.kf(a.row,a.col,a.rowCount,a.colCount),X&&!g)){if(i.col>=0){for(m=i.col,n=i.col+i.colCount-1,o=W.getRowCount(1),p=0;p<o;p++)l=k.findSpan(p,i.col,1),l?m=w(l.col,m):W.p_a&&(m=w(W.p_a.col,m)),l=k.findSpan(p,i.col+i.colCount-1,1),l?n=x(l.col+l.colCount-1,n):W.p_a&&(n=x(W.p_a.col+W.p_a.colCount-1,n));i.col=m,i.colCount=n-m+1}if(i.row>=0){for(r=i.row,s=i.row+i.rowCount-1,t=W.getColumnCount(2),u=0;u<t;u++)l=k.findSpan(i.row,u,2),l?r=w(l.row,r):W.p_a&&(r=w(W.p_a.row,r)),l=k.findSpan(i.row+i.rowCount-1,u,2),l?s=x(l.row+l.rowCount-1,s):W.p_a&&(s=x(W.p_a.row+W.p_a.rowCount-1,s));i.row=r,i.rowCount=s-r+1}}if(v=W.cm(i,e),W.cellStates&&W.cellStates.hasIntersectInSelectionState(i.row,i.col,i.rowCount,i.colCount)&&W.repaint(v),y=W.XCJ,z=y&&y.isEnable(j.RowColumnStates.selected,!0),A=y&&y.isEnable(j.RowColumnStates.selected,!1),a&&(B=void 0,(z||A)&&(B=W.Ir(W.Er(a.row),W.Fr(a.col),j.SheetArea.viewport,!1)),z&&(C=a.row,D=a.rowCount,B&&B.length>0&&(E=B.findLargestRange(a,!0),E&&(F=f.kf(E.row,E.col,E.rowCount,E.colCount),G=a.union(F),C=G.row,D=G.rowCount)),H=W.cm(f.kf(C,-1,D,-1),e),v.x=w(v.x,H.x),v.y=w(v.y,H.y),v.width=x(v.width,H.width),v.height=x(v.height,H.height)),A&&(I=a.col,J=a.colCount,B&&B.length>0&&(K=B.findLargestRange(a,!1),K&&(L=f.kf(K.row,K.col,K.rowCount,K.colCount),G=a.union(L),I=G.col,J=G.colCount)),H=W.cm(f.kf(-1,I,-1,J),e),v.x=w(v.x,H.x),v.y=w(v.y,H.y),v.width=x(v.width,H.width),v.height=x(v.height,H.height))),M=aa(v),N=_(v),O=v.x,P=v.y,M>=0||N>=0){if(Q=-9,R=-9,S=18,T=30,v.x+=Q,v.y+=R,v.width+=S,v.height+=T,b&&(v=v.getIntersectRect(b),!v))return;U=W.am(),N>0&&!g&&(W.$l=!0,V.jp(c,new f.Rect(U.x,x(U.nt,P),U.Br,N),d)),M>0&&!g&&(W.$l=!0,V.jp(c,new f.Rect(x(U.kt,O),U.y,M,U.Cr),d)),i.row!==-1||i.col!==-1||g||(W.$l=!0,V.jp(c,U.em(),d)),M>0&&N>0&&((z||A)&&(W.$l=!0),V.jp(c,v,d)),h=!0}return h},a.prototype.VF=function(a,b,c,d,e){var g,h=this,i=h.kj;i.Xq<=0&&(g=h.bm(),g&&(e||(i.$l=!0),h.jp(g,new f.Rect(a,b,c,d))))},a.prototype.repaint=function(a){var b,c=this,d=c.kj;d.Xq>0||(b=c.bm(),b&&(d.$l=!0,c.jp(b,a)))},a.prototype.jp=function(a,b,c){var d=this;a&&d.kj.Xq<=0&&(c||d._l(a,b),d.Pw(a,b))},a.prototype._l=function(a,b,c){var d,e,g,h=this,i=h.kj;a&&i.Xq<=0&&(d=h.vI(),e=d?d:a,g=i.Dr(),b||(b=g),b&&b.round(),c&&c.round(),i.$l&&(i.$l=!1,d&&(d.clearRect(b.x,b.y,aa(b),_(b)),c&&d.clearRect(c.x,c.y,aa(c),_(c)),f.Bn.Dn(d,-g.x,-g.y)),h.AI(e,b),c&&h.AI(e,c),d&&f.Bn.Dn(d,g.x,g.y)),d&&(h.dm(b),c&&h.dm(c)))},a.prototype.Pw=function(a,b){var c,d,f,g,h,i=this,j=i.kj,k=j.CH;if(a&&!(j.Xq>0)&&(b&&b.round(),c=j.am(),e.Worksheet.ao(j,"beforePaintAdornment",{ctx:a,clipRect:b}),!j.fI)){if(k){for(d=c.em(),i.dm(d),g=0;g<=2;g++)d=c.fm(g),d&&0!==aa(d)&&0!==_(d)&&i.dm(d);for(h=0;h<=2;h++)d=c.gm(h),d&&0!==aa(d)&&0!==_(d)&&i.dm(d)}else if(j.ODJ&&j.ODJ.options.isDesignMode)for(h=0;h<=2;h++)d=c.gm(h),d&&0!==aa(d)&&0!==_(d)&&(f=b,f&&!d.intersectRect(f)||i.BI(a,-1,h,f,1));for(g=0;g<=2;g++)for(h=0;h<=2;h++)d=c.Ft(g,h),d&&0!==aa(d)&&0!==_(d)&&(f=b,(k&&(1!==g||1!==h)||j.parent&&j.parent.options.allowUserDragMerge)&&(i.dm(d),f=d),f&&!d.intersectRect(f)||i.BI(a,g,h,f));i.CI(a),e.Worksheet.ao(j,"paintAdornment",{ctx:a,clipRect:b})}},a.prototype.dD=function(a,b){var c=this.kj,d=c.parent,e=d?d.options:{},g=ka(c),h=f.Rm.Om(c,g),i=e.backgroundImage;i&&(h=G),a.save(),a.fillStyle=h,a.fillRect(b.x,b.y,aa(b),_(b)),a.restore()},a.prototype.z0a=function(a){var b=this.kj,c=b.am();return 0===c.Cr&&a===b.ar(3)},a.prototype.A0a=function(a){var b=this.kj,c=b.am();return 0===c.Br&&a===b.$q(3)},a.prototype.JaK=function(a,b,c,d){var e=this,f=e.kj,g=0===d.width,h=0===d.height,i=f.options,j=i.sheetAreaOffset.top,k=i.sheetAreaOffset.left,l=c.Ft(a,b);return l&&(h&&e.z0a(f.jCb(a))&&(l.y=l.y-j,l.height=l.height+j),g&&e.A0a(f.kCb(b))&&(l.x=l.x-k,l.width=l.width+k)),l},a.prototype.DI=function(a,b,c,d){var e,f,g,h,i,j,k,l=this,m=l.kj,n=m.options,o=m.am(),p=n.sheetAreaOffset.top,q=n.sheetAreaOffset.left,r=0!==o.Cr,s=0!==o.Br,t=m.Gt&&m.Gt()||{x:n.sheetAreaOffset.left,y:n.sheetAreaOffset.top,width:0,height:0},u=0===t.width,v=0===t.height;for(f=0;f<=2;f++)h=o.gm(f),h&&(r&&v&&(h.y=h.y-p,h.height=h.height+p,!s&&u&&(h.x=h.x-q,h.width=h.width+q)),g=b?h.getIntersectRect(b):h,g&&l.EI(a,f,g,c,d));for(e=0;e<=2;e++)for(i=o.fm(e),i&&(s&&u&&(i.x=i.x-q,i.width=i.width+q,!r&&v&&(i.y=i.y-p,i.height=i.height+p)),g=b?i.getIntersectRect(b):i,g&&l.FI(a,e,g,c,d)),f=0;f<=2;f++)j=l.JaK(e,f,o,t),j&&(g=b?j.getIntersectRect(b):j,g&&l.GI(a,e,f,g,c,d));k=o.em(),k&&(g=b?k.getIntersectRect(b):k,g&&l.HI(a,g,c,d))},a.prototype.II=function(a){var b,c=this,d=c.kj,e=d.am(),f=e.zr,g=e.Ar,h=aa(e),i=e.ot,j=e.gs,k=e.zNc,l=e.xNc,m=e.ANc,n=e.uNc;n>0&&(a.fillStyle=c.zI(!1),a.fillRect(f,m,h,n)),l>0&&(a.fillStyle=c.zI(!1),a.fillRect(k,g,l,m),b=d.BBJ,b&&a.fillRect(k,i,l,j))},a.prototype.B0a=function(a,b){var c=this,d=c.kj,e=c.zI(!1),f=d.options,g=f.sheetAreaOffset.left,h=f.sheetAreaOffset.top,i=b.x,j=b.y,k=aa(b),l=_(b);a.save(),g>0&&ba(a,g,e,i+g/2,h>0?j+h:j,i+g/2,j+x(0,l)),h>0&&ba(a,h,e,g>0?i+g:i,j+h/2,i+x(0,k),j+h/2),g>0&&h>0&&(a.fillStyle=c.zI(!1),a.fillRect(i,j,g,h)),a.beginPath(),a.restore()},a.prototype.AI=function(a,b){var c,d=this,f=d.kj;!a||f.Xq>0||(c=f.Dr(),a.save(),b?a.rect(b.x,b.y,aa(b),_(b)):a.rect(c.x,c.y,aa(c),_(c)),a.clip(),a.beginPath(),d.dD(a,c),e.Worksheet.ao(f,"paint",{ctx:a,clipRect:b}),d.B0a(a,c),d.DI(a,b,!1),d.II(a),d.KI(a),e.Worksheet.ao(f,"paintSheetEnd",{ctx:a,clipRect:b}),a.beginPath(),a.restore())},a.prototype.LI=function(a,b,c){var d,e,g=this,h=g.kj;a&&(d=h.Dr(),a.save(),e=b||new f.Rect(d.x,d.y,aa(d),_(d)),a.rect(e.x,e.y,aa(e),_(e)),a.clip(),a.beginPath(),g.dD(a,d),g.DI(a,e,!0,c),a.beginPath(),a.restore())},a.prototype.CI=function(a){var b,c,d,e,f,g,h,i,j,k=this.kj,l=k.mm,m=k.yt;if(l&&l.isResizing&&m&&(h=m.resizeInfo)){if(i=k.am(),j=F,a.save(),a.strokeStyle!==j&&(a.strokeStyle=j),1!==a.lineWidth&&(a.lineWidth=1),a.beginPath(),"sizeRow"===h.action||"sizeHiddenRow"===h.action)for(c=x(0,h.startY-.5),e=h.movingY-.5,f=i.x+aa(i),b=i.x;b<f;b+=2)a.moveTo(b,c),a.lineTo(b+1,c),a.moveTo(b,e),a.lineTo(b+1,e);else for(b=x(0,h.startX-.5),d=h.movingX-.5,g=i.y+_(i),c=i.y;c<g;c+=2)a.moveTo(b,c),a.lineTo(b,c+1),a.moveTo(d,c),a.lineTo(d,c+1);a.stroke(),a.beginPath(),a.restore()}},a.prototype.HI=function(a,b,c,d){var e,f,g,h,j,k,l,m=this.kj;a.beginPath(),e=m.am().em(),f=e.x,g=e.y,h=aa(e),j=_(e),k=m.getActualStyle(-1,-1,0),this.SI(a,[{data:u,row:-1,col:-1,x:f,y:g,width:h,height:j,style:k.clone()}],0,c,d),l=new i.AF(m,m.Gr(0,0),m.Hr(0,0),0),l.jF(0,0,f,g,h,j),l.paint(a)},a.prototype.KI=function(a){var b,c,d,e,g,h,i,j,k,l=this.kj,m=l.frozenRowCount(),n=l.frozenColumnCount(),o=l.frozenTrailingRowCount(),p=l.frozenTrailingColumnCount();(m||n||o||p)&&(b=l.am(),c=b.pt,d=b.qt,e=b.lt,g=b.ot,h=b.x,i=b.y,j=aa(b),k=_(b),a.save(),a.strokeStyle=f.Rm.Om(l,l.options.frozenlineColor),a.lineWidth=1,a.beginPath(),n&&(a.moveTo(c-.5,i),a.lineTo(c-.5,i+k)),m&&(a.moveTo(h,d-.5),a.lineTo(h+j,d-.5)),p&&(a.moveTo(e-.5,i),a.lineTo(e-.5,i+k)),o&&(a.moveTo(h,g-.5),a.lineTo(h+j,g-.5)),a.stroke(),a.restore())},a.prototype.EI=function(a,b,c,d,e){this.TI(a,-1,b,1,c,d,e)},a.prototype.FI=function(a,b,c,d,e){this.TI(a,b,-1,2,c,d,e)},a.prototype.GI=function(a,b,c,d,e,f){var g,h,i=this.kj,j=i.getCalcService&&i.getCalcService(),k=j&&j.jh;for(g in k)k[g].getSource().startCalculation();if(this.TI(a,b,c,3,d,e,f),(!j||!j.calcOnDemand)&&k)for(g in k)k[g].getSource().endCalculation();h=this.kj.at,h&&h.UI(a,d,b,c)},a.prototype.ZIb=function(a,b,c,d,e){var g,h,i,j=this,k=j.kj,l=k.getRangeRect(b,c,f.kf(e.row,e.col,e.rowCount,e.colCount));l=l.getIntersectRect(k.am().Ft(b,c)),l&&(l.round(),g=e.isValid,a.save(),a.lineWidth=1,a.strokeStyle="mediumblue",g||a.setLineDash([6,2]),h=l.x+.5,i=l.y+.5,a.strokeRect(h,i,aa(l),_(l)),a.beginPath(),a.restore())},a.prototype.BI=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,r,s,t,u,v,w,x,y,z,A,B,C,D,F,G,H,I,J,K=q(e)||3===e,L=this,M=L.kj;if(ja(M)){if(!M.addSelection)return;if(j=M.ITa,k=M.mm,l=j.getSelections(e),m=l.length,d=L.VI(b,c,d),!d)return;if(n=f.Im.Lm("gc-selection"),o=E(n.zIndex),K&&(o>2007&&L.WI(a,b,c,d),p=j.$Ib=j.bIb.getAnchorInfo(M.getActiveRowIndex(),M.getActiveColumnIndex()),p&&L.ZIb(a,b,c,d,p)),r=L.XI(b,c,l,d),s=r.length,t=void 0,s<=0)return;for(u=K&&L.XI(b,c,[M.p_a],d)[0],v=!1,w=void 0,w=0;w<s;w++)if(t=r[w],!d.containsRect(t)){v=!0;break}if(u&&!d.containsRect(u)&&(v=!0),a.save(),v&&(a.rect(d.x,d.y,aa(d),_(d)),a.clip()),a.beginPath(),s>0)for(i=f.Rm.Om(M,M.getSelectionBackColor()),a.fillStyle!==i&&(a.fillStyle=i),g=0,h=0,o>2007&&(g=1,h=-3),w=0;w<s;w++)t=r[w],a.fillRect(t.x+g,t.y+g,aa(t)+h,_(t)+h);M.fCc||(x=M.Jl,y=M.Kl,1===e?(z=j.g$J()||l[0],x=z.row,y=z.col):u&&(x=M.s_a,y=M.t_a),A=M.getCellRect(x,y,b,c),B=void 0,C=void 0,D=void 0,F=void 0,A&&A.intersectRect(d)&&(B=A.x,C=A.y,D=aa(A),F=_(A),g=1,h=-2,o>2007&&(g=0,h=0),L.Mx(B+g,C+g,D+h,F+h),m>1&&(a.strokeStyle=f.Rm.Om(M,M.getSelectionBorderColor()),a.lineWidth=1,a.strokeRect(B+1.5,C+1.5,D-4,F-4)))),a.restore(),a.save(),a.beginPath(),1===m&&(K&&k&&k.BG&&k.ZI&&k.ZI()&&!k.$I&&(G=k._I&&k._I(),H=M.getRangeRect(b,c,G),I=aa(H),J=_(H),H&&I>0&&J>0&&(a.fillStyle=n&&n.color,a.fillRect(H.x,H.y,I,J))),t&&aa(t)>=0&&_(t)>=0&&(L.YI(d,M,b,c,o),L.aJ(a,b,c,t,d,l[0],e))),u&&(a.save(),v&&(a.rect(d.x,d.y,aa(d),_(d)),a.clip()),a.beginPath(),a.fillStyle="rgba(255,255,255,0.4)",a.fillRect(u.x+g,u.y+g,aa(u)+h,_(u)+h),a.fillStyle=i,a.strokeStyle="rgb(124,124,124)",a.lineWidth=1,a.strokeRect(u.x-.5,u.y-.5,aa(u),_(u)),a.restore()),a.beginPath(),a.restore()}},a.prototype.YI=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=b.frozenTrailingRowCount(),r=b.frozenTrailingColumnCount(),s=b.getSelections(),t=b.am(),u=b.getRowCount()-q-1,v=b.getColumnCount()-r-1,w=b.Hr(1,3),x=b.Gr(1,3);1===s.length&&e>2007&&(f=b.frozenRowCount(),g=b.frozenColumnCount(),h=s[0],i=h.row,j=h.col,k=h.rowCount,l=h.colCount,f>0&&(i>=f&&b.gr(i)<f?(a.y-=2,a.height+=2):i+k<=f&&b._q(i+k-1)===b.lq&&(a.height+=2)),g>0&&(j>=g&&b.br(j)<g?(a.x-=2,a.width+=2):j+l<=g&&b.Zq(j+l-1)===b.qq&&(a.width+=2)),0===i&&0===j&&(a.x-=2,a.y-=2,a.width+=2,a.height+=2),i===-1&&(i=0,k=b.getRowCount()),j===-1&&(j=0,l=b.getColumnCount()),m=!1,n=!1,o=x.findRow(u),p=w.findCol(v),o&&o.y+_(o)<t.qt+b.tNc(t)&&(m=!0),p&&p.x+aa(p)<t.pt+b.wNc(t)&&(n=!0),m&&i+k-1===u&&(a.height+=2),n&&j+l-1===v&&(a.width+=2))},a.prototype.WI=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=this,G=F.kj,H=G.ITa.getSelections(),I=G.am(),J=I.kt,K=I.nt,L=H.length,M=0!==I.Cr,N=0!==I.Br;if(!(L<=0)){if(e=H[0],f=e.row,g=e.rowCount,h=e.col,i=e.colCount,f===-1&&(f=0),h===-1&&(h=0),g===-1&&(g=G.getRowCount()),i===-1&&(i=G.getColumnCount()),a.save(),a.beginPath(),a.lineWidth=2,a.strokeStyle=G.getSelectionBorderColor(),j=d.x,k=d.y,l=aa(d),m=_(d),n=G.frozenRowCount(),M&&(1!==L||0!==n||G.lq<=f||G.lq>=f+g))for(o=F.bJ(c),p=0,q=o.length;p<q;p++)r=o[p],s=0,t=0,u=r.x,v=r.x+aa(r),r.x<j+l&&j<r.x+aa(r)&&(1===L&&(0===n&&G.lq===f||n>0&&0===f)&&(s=-1,t=1),r.x<j&&(s=0,u=j),r.x+aa(r)>j+l&&(t=0,v=j+l),a.moveTo(u+s-1,K-1),a.lineTo(v+t,K-1),a.stroke());if(w=G.frozenColumnCount(),N&&(1!==L||0!==w||G.qq<=h||G.qq>=h+i))for(x=F.cJ(b),y=0,z=x.length;y<z;y++)A=x[y],B=0,C=0,D=A.y,E=A.y+_(A),A.y<k+m&&k<A.y+_(A)&&(1===L&&(0===w&&G.qq===h||w>0&&0===h)&&(B=-1,C=1),A.y<k&&(B=0,D=k),A.y+_(A)>k+m&&(C=0,E=k+m),a.moveTo(J-1,D+B-1),a.lineTo(J-1,E+C),a.stroke());a.beginPath(),a.restore()}},a.prototype.bJ=function(a){var b,c,d,e,g,h,i,j,k,l,m,n,o=this.kj,p=o.ITa.getSelections(),q=p.length,r=o.Hr(a),s=[],t={};for(c=0;c<q;c++)if(d=p[c])if(e=d.col,e===-1)g=o.Hr(0,3),h=o.Hr(1,3),i=o.Hr(2,3),j=-1,k=-1,g.length>0&&(j=g[0].x,k=g[g.length-1].x+g[g.length-1].width-j,s.push(new f.Rect(j,(-1),k,(-1)))),h.length>0&&(j=h[0].x,k=h[h.length-1].x+h[h.length-1].width-j,s.push(new f.Rect(j,(-1),k,(-1)))),i.length>0&&(j=i[0].x,k=i[i.length-1].x+i[i.length-1].width-j,s.push(new f.Rect(j,(-1),k,(-1))));else if(r&&(l=r.findCol(e),m=r.findCol(e+d.colCount-1),l||m)){if(n=new f.Rect((-1),(-1),(-1),(-1)),l?n.x=l.x:n.x=r[0].x,m?n.width=m.x+aa(m)-n.x:n.width=r[r.length-1].x+r[r.length-1].width-n.x,b=[n.x,n.width].join("_"),t[b])continue;t[b]=!0,s.push(n)}return s},a.prototype.cJ=function(a){var b,c,d,e,g,h,i,j,k,l,m,n,o=this.kj,p=o.ITa.getSelections(),q=p.length,r=o.Gr(a),s=[],t={};for(c=0;c<q;c++)if(d=p[c])if(e=d.row,e===-1)g=o.Gr(0,3),h=o.Gr(1,3),i=o.Gr(2,3),j=-1,k=-1,g.length>0&&(j=g[0].y,k=g[g.length-1].y+g[g.length-1].height-j,s.push(new f.Rect((-1),j,(-1),k))),h.length>0&&(j=h[0].y,k=h[h.length-1].y+h[h.length-1].height-j,s.push(new f.Rect((-1),j,(-1),k))),i.length>0&&(j=i[0].y,k=i[i.length-1].y+i[i.length-1].height-j,s.push(new f.Rect((-1),j,(-1),k)));else if(r&&(l=r.findRow(e),m=r.findRow(e+d.rowCount-1),l||m)){if(n=new f.Rect((-1),(-1),(-1),(-1)),l?n.y=l.y:n.y=r[0].y,m?n.height=m.y+_(m)-n.y:n.height=r[r.length-1].y+r[r.length-1].height-n.y,b=[n.y,n.height].join("_"),t[b])continue;t[b]=!0,s.push(n)}return s},a.prototype.aJ=function(a,b,c,d,e,g,h){var i,j,k=this,l=k.kj,m=l.parent,n=l.mm,o=d.x,p=d.y,r=aa(d),s=_(d),t=l.getViewportTopRow(b),u=l.getViewportLeftColumn(c),v=l.getViewportBottomRow(b),w=l.getViewportRightColumn(c),x=0,y=0,z=l.am(),A=0!==z.Cr,B=0!==z.Br;B||g.col!==u&&g.col!==-1||(x=2),A||g.row!==t&&g.row!==-1||(y=2),g.row+g.rowCount===v+1&&(e.height=e.height+1),g.col+g.colCount===w+1&&(e.width=e.width+1),r>=0&&s>=0&&(!e||d.intersect(e.x-1,e.y-1,aa(e)+2,_(e)+2))&&(a.save(),e&&!e.containsRect(d)&&(a.rect(e.x-x,e.y-y,aa(e),_(e)),a.clip()),a.beginPath(),a.strokeStyle=f.Rm.Om(l,l.getSelectionBorderColor()),a.lineWidth=2,r>0&&s>0?(n&&n.BG?(i=n.dJ,2===i?(a.moveTo(o+.5,p-.5),a.lineTo(o+r-1,p-.5)):3===i?(a.moveTo(o+.5,p+s-.5),a.lineTo(o+r-1,p+s-.5)):0===i?(a.moveTo(o-.5,p+.5),a.lineTo(o-.5,p+s-1)):1===i&&(a.moveTo(o+r-.5,p+.5),a.lineTo(o+r-.5,p+s-1))):(j=m&&m.Vv,j>2007?a.rect(o-1,p-1,r+1,s+1):a.rect(o-.5,p-.5,r,s)),a.stroke(),(q(h)||3===h)&&m&&m.options.allowUserDragFill&&k.eJ&&k.eJ(a,b,c,d,e)):0!==r&&0!==s||a.strokeRect(o-1,p-1,r+1,s+1),a.beginPath(),a.restore())},a.prototype.VI=function(a,b,c){var d,e,f,g,h,i=this.kj,j=i.am();return a>=0&&b>=0?d=j.Ft(a,b):a===-1?d=j.gm(b):b===-1&&(d=j.fm(a)),1===b&&(e=i.Hr(b),f=e.length>0?e[e.length-1]:u,f&&(d.width=w(aa(d),f.x+aa(f)-j.pt))),1===a&&(g=i.Gr(a),h=g.length>0?g[g.length-1]:u,h&&(d.height=w(_(d),h.y+_(h)-j.qt))),c=c?c.getIntersect(d.x,d.y,aa(d),_(d)):d},a.prototype.XI=function(a,b,c,d){var e,f,g,h,i=this.kj,j=i.ITa,k=c.length,l=[],m=i.sr(a,b);for(h=0;h<k;h++)f=c[h],f&&(e=j.findSpan(f.row,f.col,m),e&&e.containsRange(f)&&(f=e),g=i.getRangeRect(a,b,f),g&&g.x<=d.x+aa(d)&&g.y<=d.y+_(d)&&d.x<=g.x+aa(g)&&d.y<=g.y+_(g)&&l.push(g));return l},a.prototype.fJ=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n;if(a.save(),d=b.x,e=b.y,f=aa(b),g=_(b),h=[6,6],a.setLineDash)a.beginPath(),a.lineWidth=2,a.strokeStyle=c,a.setLineDash(h),a.rect(d,e,f-1,g-1),a.stroke();else{for(a.beginPath(),a.lineWidth=2,a.strokeStyle=c,i=h[0],j=h[1],k=void 0,l=void 0,m=void 0,n=void 0,k=d,l=e,m=f;m>0;)if(m>=i+j)a.moveTo(k,l),a.lineTo(k+i,l),k=k+i+j,m=m-i-j;else{if(m>=i){a.moveTo(k,l),a.lineTo(k+i,l),m=m-i-j;break}if(m>0){a.moveTo(k,l),a.lineTo(k+m,l),m=m-i-j;break}}for(k=d+f-1,l=e+1,n=g-1,m<0&&(m=y(m),m>j&&(a.moveTo(k,l-2),a.lineTo(k,l+(m-j))),l+=m,n-=m);n>0;)n>=i+j?(a.moveTo(k,l),a.lineTo(k,l+i),l=l+i+j,n=n-i-j):n>=i?(a.moveTo(k,l),a.lineTo(k,l+i),n=n-i-j):n>0&&(a.moveTo(k,l),a.lineTo(k,l+n),n=n-i-j);for(k=d+f-2,l=e+g-1,m=f-1,n<0&&(n=y(n),n>j&&(a.moveTo(k+2,l),a.lineTo(k-(n-j),l)),k-=n,m-=n);m>0;)if(m>=i+j)a.moveTo(k,l),a.lineTo(k-i,l),k=k-i-j,m=m-i-j;else{if(m>=i){a.moveTo(k,l),a.lineTo(k-i,l),m=m-i-j;break}if(m>0){a.moveTo(k,l),a.lineTo(k-m,l),m=m-i-j;break}}for(k=d,l=e+g-2,n=g-1,m<0&&(m=y(m),m>j&&(a.moveTo(k,l+2),a.lineTo(k,l-(m-j))),l-=m,n-=m);n>0;)n>=i+j?(a.moveTo(k,l),a.lineTo(k,l-i),l=l-i-j,n=n-i-j):n>=i?(a.moveTo(k,l),l-i===e?a.lineTo(k,l-i-1):a.lineTo(k,l-i),n=n-i-j):n>0&&(l>e&&(a.moveTo(k,l),a.lineTo(k,l-n)),n=n-i-j);a.stroke()}a.beginPath(),a.restore()},a.prototype._Ib=function(a,b,c,d,e,f,g){var h,i,j,k,l;e&&0!==b.length&&(h=b[0].col-1,i=b[b.length-1].col+1,j=c.zHb(d.row,h,g,1),h>=0&&f.isValid&&!f.isValid(d.row,h,j)&&a.push({style:f.getDataValidator(d.row,h).highlightStyle(),x:b[0].x-f.getColumnWidth(h),y:d.y,width:f.getColumnWidth(h),height:d.height}),k=c.zHb(d.row,i,g,1),f.isValid&&!f.isValid(d.row,i,k)&&(l=b[b.length-1],a.push({style:f.getDataValidator(d.row,i).highlightStyle(),x:l.x+l.width,y:d.y,width:f.getColumnWidth(i),height:d.height})))},a.prototype.aJb=function(a,b,c){var d,e,f,g,h=b.ss,i=a.row,j=a.col,k={},l={},m=[],n=a.rowCount,o=a.colCount;for(d=0;d<o;d++)l[d]=b.Tl(d+j,c);for(e=0;e<n;e++){if(k[e]=b.Sl(e+i,c),f=[],k[e]>0)for(g=0;g<o;g++)f.push(l[g]>0?h.Ym(i+e,j+g,c):v);m.push(f)}return{rowSizes:k,colSizes:l,styleList:m}},a.prototype.TI=function(a,b,d,f,g,h,m){var n,o,r,s,t,u,v,w,x,y,z,A,B,C,E,F,G,H,I,J,K,L,M,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka;if(q(f)&&(f=3),n=this,o=n.kj,r=o.parent,s=r&&r.options.resizeZeroIndicator,t=o.Gr(b,f),u=o.Hr(d,f),v=o.options.sheetAreaOffset,w=o.Gt&&o.Gt()||{x:v.left,y:v.top,width:0,height:0},x=n.JaK(b,d,o.am(),w),y=!1,z=t.length,A=u.length,!(z<0||A<0)){for(B=o.Ir(b,d,f,!0),C=B.length>0,H=o.ss,K=0,L=0,M=0,O=0,R=new i.AF(o,t,u,f),S=[],T=[],U=[],W=[],X=!h&&3===f&&r&&r.options.highlightInvalidData,a.save(),a.beginPath(),Y=[],Z=-1,$=-1,ba=o.ar(3),ca=o.$q(3),da=o.am(),ea=0===da.Cr&&0===w.height,fa=0===da.Br&&0===w.width,ga=!!k(this.kj),ha=!1,ia=c("SheetsCalc"),ja=o.getActiveRowIndex(),ka=o.getActiveColumnIndex(),la=this.Bcc(f,o,ja,ka),ma=0;ma<z;ma++)for(E=t[ma],n._Ib(W,u,H,E,X,o,f),na=0;na<A;na++)if(F=u[na],G=C&&B.findCell(E.row,F.col),G?(I=G.row,J=G.col,K=G.x,L=G.y,M=aa(G),O=_(G),G.isAutoMerge&&(oa=n.bJb(G,b,d,f),K=oa.x,L=oa.y,M=oa.width,O=oa.height),G.spanSizeInfo||(G.spanSizeInfo=n.aJb(G,o,f))):(I=E.row,J=F.col,K=F.x,M=aa(F),F.y===-1?L=E.y:(L=D(F.y*E.height+E.y),y=!0),_(F)===-1?O=_(E):(O=E.height+E.y-L,y=!0)),1===s&&(b===-1&&o.getColumnVisible(J)&&0===o.$r(J)&&(($<0||$!==J-1)&&Y.push({x1:K,y1:L,x2:K,y2:L+O,horizontal:!1}),$=J),d===-1&&o.getRowVisible(I)&&0===o.Yr(I)&&((Z<0||Z!==I-1)&&Y.push({x1:K,y1:L,x2:K+M,y2:L,horizontal:!0}),Z=I)),(!g||!(K+M<=g.x||K>=g.x+aa(g)||L+O<=g.y||L>=g.y+_(g))||y&&!(y&&K>g.x+aa(g)))&&0!==M&&0!==O&&!(1===f&&na<A-1&&u[na+1].x-K===0||(pa=!1,G&&l.Bb(S,G)))){if(qa=!1,P=H.zHb(I,J,f,1),ra=o.jZ&&o.jZ(),!h&&la&&0===I&&J>=la.dj&&la.cj+la.Xj>o.lq&&J<la.dj+la.OZ){if(P=o.getCell(la.cj,J).text()+"",pa=!0,qa=la.filterButtonVisible(),ra)for(sa=0;sa<ra.length;sa++)if(ra[sa].col===J&&ra[sa].rowFilter.sj===la){this.cJb(ra[sa],1,0,!0);break}}else if(ra&&ra.length>0&&(ta=ra.length-1,ua=ra[ta].rowFilter&&ra[ta].rowFilter.sj))for(sa=ra.length-1;sa>=0;sa--)if(ra[sa].tableColumnHeaderFilter&&ra[sa].col===J){this.cJb(ra[sa],3,ua.cj,!1);break}Q=H.Ym(I,J,f),X&&o.isValid&&!o.isValid(I,J,P)&&W.push({style:o.getDataValidator(I,J).highlightStyle(),x:K,y:L,width:M,height:O}),3===f&&(va=Q.formatter,ia&&va&&p(va)&&(!h||o.pivotTables&&o.pivotTables.findPivotTable(I,J))&&(wa=o.parent&&o.parent.dJb(va),wa&&(xa=wa.getExpression(),P=o.B4J(va,xa,I,J)))),pa&&(Q.hAlign=0),
V={data:P,row:I,col:J,x:K,y:L,width:M,sparkline:ga&&o.getSparkline(I,J),height:O,style:Q,colStyle:o.getStyle(-1,J,f),cellLayout:G,tableFilter:qa,columnHeaderFitMode:1===f&&o.PKJ(J),offsetX:F.offsetX,sheetArea:f},V.columnHeaderFitMode!==j.ColumnHeaderFitMode.normal&&na<A-1&&(ya=o.Zq(F.col,f,!0),ya&&(za=u.findCol(ya),za&&za.y!==-1&&(V.cornerX=za&&za.x,V.columnHeaderFitMode===j.ColumnHeaderFitMode.stack?V.cornerY=D((za&&za.y)*E.height)+E.y:V.cornerY=E.height+E.y))),T.push(V),G&&S.push(G),V.style&&4===V.style.hAlign&&(ha=!0),R.jF(I,J,K,L,M,O,Q,G,I===ba&&ea,J===ca&&fa,V)}if(T.length>0){if(3===f&&(o.options.allowCellOverflow||ha)&&(Aa=H.Sm(b,d,function(){return new N(o,b,d)}),U=n.hJ(a,Aa,T,R,m),U.length>0)){for(Ba=g.x,Ca=g.x+g.width,ma=0;ma<U.length;ma++)Da=U[ma],Da&&(Ea=Da.row,Fa=Da.col,Ga=Da.cellOverflowLayout&&Da.cellOverflowLayout.layout,Ga&&(Ha=Ga.x,Ia=Ha+Ga.width,Ha<Ba&&(Ba=Ha),Ia>Ca&&(Ca=Ia)),R.jF(Ea,Fa,Da.x,Da.y,Da.width,Da.height,Da.style,Da.cellLayout,Ea===ba&&ea,Fa===ca&&fa,Da));T=T.concat(U),h||(g.x=Ba,g.width=Ca-Ba,x&&(g=g?x.getIntersectRect(g):x))}1===f&&y&&n.ZKJ(T,u,R,g,h,x,ba,ca,ea,fa),g&&(Ja=o.printInfo&&o.printInfo(),h&&Ja&&(Ja.columnStart()>0||Ja.rowStart()>0)&&!Ja.showBorder()?a.rect(g.x-(Ja.columnStart()>0?2:0),g.y-(Ja.rowStart()>0?2:0),aa(g)+(Ja.columnStart()>0?4:0),_(g)+(Ja.rowStart()>0?4:0)):a.rect(g.x,g.y,aa(g),_(g)),a.clip()),n.SI(a,T,f,h,m)}e.Worksheet.ao(o,"paintViewport",{ctx:a,rowViewportIndex:b,colViewportIndex:d,sheetArea:f,clipRect:g,isPrinting:h}),R.paint(a),Y.length>0&&n.iJ(a,Y,1,3),W.length>0&&(Ka=x.getIntersectRect(g),a.rect(Ka.x,Ka.y,aa(Ka),_(Ka)),a.clip(),n.jJ(a,W)),a.restore()}},a.prototype.cJb=function(a,b,c,d){a.sheetArea=b,a.row=c,a.tableColumnHeaderFilter=d},a.prototype.Bcc=function(a,b,c,d){if(b.tables&&1===a&&0===b.frozenRowCount()){var e=b.tables.find(c,d);if(e&&e.MZ&&e.cj<b.lq)return e}return null},a.prototype.bJb=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o=a.row,p=a.col,q=a.x,r=a.y,s=a.width,t=a.height,u=this.kj,v=u.am();return 1!==b||3!==d&&2!==d||(e=v.fm(b),g=u.frozenRowCount(),h=u.getRowCount(d)-u.frozenTrailingRowCount()-1,i=e.y,j=e.height,r<i&&g<=o&&o<=h&&(t-=i-r,r=i),r+t>i+j&&g<=o+a.rowCount-1&&o+a.rowCount-1<=h&&(t-=r+t-(i+j))),1!==c||3!==d&&1!==d||(e=v.gm(c),k=u.frozenColumnCount(),l=u.getColumnCount(d)-u.frozenTrailingColumnCount()-1,m=e.x,n=e.width,q<m&&k<=p&&p<=l&&(s-=m-q,q=m),q+s>m+n&&k<=p+a.colCount-1&&p+a.colCount-1<=l&&(s-=q+s-(m+n))),new f.Rect(q,r,s,t)},a.prototype.iJ=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(0!==b.length)for(e=0,f=b.length;e<f;e++)g=b[e],h=g.x1,i=g.y1,j=g.x2,k=g.y2,l=g.horizontal,a.beginPath(),a.save(),a.lineWidth=c,a.strokeStyle=this.kJ(a,l,h,i,j,k),a.fillStyle=this.lJ(a,l,h,i,j,k),l?(m=-3,n=1,o=-1,p=-2,a.fillRect(h,i+m,j-h-1,d+2*c),i+=.5,k+=.5,a.moveTo(h+o,i+m),a.lineTo(j+p,k+m),a.moveTo(h+o,i+n),a.lineTo(j+p,k+n)):(q=-3,r=1,s=0,t=-1,a.fillRect(h+q,i+s,d+2*c,k-i-1),h+=.5,j+=.5,a.moveTo(h+q,i+s),a.lineTo(j+q,k+t),a.moveTo(h+r,i+s),a.lineTo(j+r,k+t)),a.stroke(),a.restore()},a.prototype.lJ=function(a,b,c,d,e,g){var h,i,j,k,l,m=b?H:I,n=f.Im.Km(0,"gc-"+m+"-normal"),o=n&&n.backgroundColor,p=n&&n.backgroundImage;if(!b&&p&&p.indexOf("linear-gradient")!==-1)for(i=f.Ul.wl(p),h=a.createLinearGradient(c,d,e,g),j=0,k=i.length;j<k;j++)l=i[j],h.addColorStop(l.point,l.color);else o&&(h=o);return h},a.prototype.kJ=function(a,b,c,d,e,g){var h=a.createLinearGradient(c,d,e,g),i=b?H:I,j=f.Im.Km(0,"gc-"+i+"-normal");return b?(h.addColorStop(0,j.borderTopColor),h.addColorStop(1,j.borderBottomColor)):(h.addColorStop(0,j.borderLeftColor),h.addColorStop(1,j.borderRightColor)),h},a.prototype.jJ=function(a,b){var c,d,e,f,g,h,i,j,k,l=this,m=l.kj,n=m.vu();if(b)for(c=b.length,d=0;d<c;d++)e=b[d],f=e.x,g=e.y,h=e.width,i=e.height,j=e.style,k=j.type,0===k&&this.hyb(a,f,g,h,i,j),1===k&&this.iyb(a,f,g,h,i,j),2===k&&this.jyb(a,f,g,h,i,j,n)},a.prototype.hyb=function(a,b,c,d,e,f){var g=f.color,h=b-4,i=c-4,j=d+8,k=e+8,l=.5522848,m=j/2*l,n=k/2*l,o=h+j,p=i+k,q=h+j/2,r=i+k/2;a.save(),a.lineWidth=2,a.strokeStyle=g,a.beginPath(),a.moveTo(h,r),a.bezierCurveTo(h,r-n,q-m,i,q,i),a.bezierCurveTo(q+m,i,o,r-n,o,r),a.bezierCurveTo(o,r+n,q+m,p,q,p),a.bezierCurveTo(q-m,p,h,r+n,h,r),a.closePath(),a.stroke(),a.restore()},a.prototype.iyb=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o;b-=.5,c-=.5,m=Math.min(d/2,e/2),n=f.color,o=f.position,a.save(),a.lineWidth=2,a.strokeStyle=n,a.beginPath(),a.rect(b,c,d,e),a.stroke(),a.restore(),a.save(),a.beginPath(),0===o?(g=b,h=c,i=b,j=h+m,k=g+m,l=h):2===o?(g=b+d,h=c+e,i=g,j=h-m,k=g-m,l=h):3===o?(g=b,h=c+e,i=b,j=h-m,k=g+m,l=h):1===o&&(g=b+d,h=c,i=g,j=h+m,k=g-m,l=h),a.moveTo(g,h),a.lineTo(i,j),a.lineTo(k,l),a.fillStyle=n,a.fill(),a.closePath(),a.restore()},a.prototype.jyb=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r;if(b-=.5,c-=.5,h=this.kj,i=h.zoom(),l=15,m=15,n=f.image,o=f.position,p=3,q=f.color,a.save(),a.beginPath(),a.lineWidth=2,a.strokeStyle=q,a.rect(b,c,d,e),a.stroke(),n&&"none"!==n&&g){4===o?j=b-(l+p):5===o&&(j=b+d+p);try{g.ko(n)?(r=g.lo(n),k=c+e/2-m/2,a.drawImage(r,j,k,l,m)):g.fo(n)}catch(a){}}else 4===o?j=b-(l+p)*i:5===o&&(j=b+d+p*i),k=c+e/2-m*i/2,a.translate(j,k),a.scale(.015*i,.015*i),a.beginPath(),a.moveTo(512,0),a.bezierCurveTo(229.248,0,0,229.184,0,512),a.bezierCurveTo(0,794.816,229.248,1024,512,1024),a.bezierCurveTo(794.752,1024,1024,794.752,1024,512),a.bezierCurveTo(1024,229.24800000000005,794.752,0,512,0),a.closePath(),a.moveTo(783.488,692.992),a.lineTo(692.9920000000001,783.4879999999999),a.lineTo(512,602.496),a.lineTo(331.00800000000004,783.4879999999999),a.lineTo(240.51200000000006,692.992),a.lineTo(421.504,512),a.lineTo(240.512,330.944),a.lineTo(331.008,240.44800000000004),a.lineTo(512,421.44),a.lineTo(692.992,240.384),a.lineTo(783.4879999999999,330.88),a.lineTo(602.496,512),a.lineTo(783.488,692.992),a.closePath(),a.fillStyle=q,a.fill(),a.stroke();a.restore()},a.prototype.SI=function(a,b,c,d,g,h,i,j,l){var m,p,q,r,s,v,w,x,y,z,A,B,C,D,E,G,H,I,J,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,ba,ca,da,ea,fa,ga,ha,ia,ja,la,ma,na;for(void 0===i&&(i=0),void 0===j&&(j=0),void 0===l&&(l=1),m=this,p=m.kj,q=3===c,r=(h?h.zoom():p.zoom())*l,s=t(m.Bl(),r),v=p.getDefaultStyle(c),w=p.Al(c),x=m.kj.conditionalFormats,y=ka(p),z=p.$q(2),A=p.ar(1),B=h?h.vu():p.vu(),a.save(),a.beginPath(),a.fillStyle=v&&v.foreColor||F,o(a,s.font),a.textAlign=q?"right":"center",E=b.length,ca=[],ea={sheet:p,row:-1,col:-1,fontInfo:u,lineHeight:-1,imageLoader:B,conditionalFormats:x,sheetArea:c,parentBackColor:y},fa=[],C=0;C<E;C++)G=b[C],I=G.data,R=G.tableFilter,J=G.row,L=G.col,M=G.x,N=G.y,O=aa(G),P=_(G),1!==c||fa[J]||(fa[J]=p.getRowHeight(J,c)),Q=G.style,W=G.cellOverflowLayout,S=G.columnHeaderFitMode,T=G.cornerX,U=G.cornerY,ba=G.offsetX,V=G.colStyle,Z=Q.font?t(Q.font,r):s,d&&typeof g===K&&1!==g&&(Z=t(Z.font,g)),Q.font=Z.font,O>0&&P>0&&(H=Q.cellType||w,M--,N--,O++,P++,q?ea.sparkline=G.sparkline:(Y=d?0:m.mJ(J,L,c),ea.visualState=Y),$=n(Z.font),ea.lineHeight=$,ea.row=J+i,ea.col=L+j,ea.fontInfo=Z,ea.cellOverflowLayout=W,ga=fa.length&&P!==fa[J]+1,ea.needTopGridline=1===c&&J===A||0===c||ga,ea.needLeftGridline=2===c&&L===z||0===c||ga,ea.isPrinting=d,ea.printZoomFactor=g,ea.columnHeaderFitMode=S,ea.cornerX=T,ea.cornerY=U,ea.offsetX=ba,ea.colStyle=V,H.jp(a,I,M,N,O,P,Q,ea,R),W&&!ea.showBarIconOnly&&(ha=new f.Rect(M,N,O,P),ia=H.Ama?H.Ama(a,ha,Q,ea):ha,ca.push({cellType:H,data:I,x:ia.x,y:ia.y,width:ia.width,height:ia.height,style:Q,richText:X,options:{sheet:p,row:J,col:L,fontInfo:Z,lineHeight:$,cellOverflowLayout:W,parentBackColor:y,imageLoader:B}})));if(E=ca.length,E>0)for(ja=p.isEditing(),la=p.Jl,ma=p.Kl,D=0;D<E;D++)da=ca[D],I=da.data,ea=da.options,ja&&ea.row===la&&ea.col===ma||(na=k(this.kj),na&&I&&"SparklineExValue"===I.typeName||m.BWa(a,da));for(a.restore(),E=b.length,C=0;C<E;C++)G=b[C],e.Worksheet.ao(p,"paintCell",{ctx:a,sheetArea:c,cell:G,isPrinting:d})},a.prototype.BWa=function(a,b){var c,d,e=b.cellType,g=b.data,h=b.x,i=b.y,j=aa(b),k=_(b),l=b.style,m=b.options,n=m.cellOverflowLayout;n&&e.uxb&&(c=n.layout,d=new f.Rect(c?c.x:h,c?c.y:i,c?c.width:j,c?c.height:k),e.uxb(a,d,m,g)),e.paintValue&&e.paintValue(a,g,h,i,j,k,l,m)},a.prototype.mJ=function(a,b,c){var d=this.kj,e=0;return ja(d)&&(3===c||q(c)?!d.isEditing()&&d.wt(a,b)?e=3:d.vp(a,b,c)&&(e=2):(d.vp(a,b,c)&&(e=1,d.wp(a,b,c)&&(e=2)),d.xt(a,b,c)&&(e=4))),e},a.prototype.hJ=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,v,w,x,y,z=this.kj,A=z.ss,B=c.length,C=[],D={},E=[],F=function(x){var y,B,F,G,H,I,J,K,L,M,N,O,P,Q,R;if(g=c[x],j=g.row,k=g.col,l=g.y,n=_(g),s=b.nJ(j,a,e),t=s.headingOverflowLayouts,v=s.trailingOverflowLayouts,!D[j]){for(y={},B=0,F=s;B<F.length;B++)G=F[B],y[G.column]=!1;t&&t.forEach(function(a){y[a.column]=!1}),v&&v.forEach(function(a){y[a.column]=!1}),D[j]=y}for(H=D[j],w=s.find(k),I=0;I<w.length;I++)if(J=w[I]){if(K=z.getCellRect(j,J.column,u,u,!0),!H[J.column]){if(L=J.column,i=A.Ym(j,L),i.showEllipsis)continue;h=A.zHb(j,L,3,1,i),m=J.columnWidth,o=J.backgroundWidth,p=J.backgroundLeftWidth<0?K.x:J.backgroundRightWidth<0?K.x+aa(K)-o:4===i.hAlign?K.x+J.expandedWidth/2-J.backgroundLeftWidth:K.x+aa(K)/2-J.backgroundLeftWidth,r={data:h,row:j,col:L,x:K.x,y:l,width:m,height:n,cellOverflowLayout:J,style:i},C.push(r),J.layout=new f.Rect(p,l,o,n),i=A.Ym(j,L),d.m8J(j,L,J,i,K.x,l,m,n),H[J.column]=!0}J.column===k&&H[J.column]&&E.push(x)}if(t)for(M=0;M<t.length;M++)if(N=t[M],N&&!H[N.column]&&N.contains(g.col)){if(k=N.column,i=A.Ym(j,k),i.showEllipsis)continue;h=A.zHb(j,k,3,1,i),m=N.columnWidth,o=N.backgroundWidth,O=z.getCellRect(j,N.endColumn,u,u,!0),p=O.x+aa(O)-o,r={data:h,row:j,col:k,x:p,y:l,width:m,height:n,style:i,cellOverflowLayout:N},C.push(r),N.layout=new f.Rect(p,l,o,n),H[N.column]=!0,d.m8J(j,k,N,i,p,l,m,n)}if(v)for(P=0;P<v.length;P++)if(Q=v[P],Q&&!H[Q.column]&&Q.contains(g.col)){if(k=Q.column,i=A.Ym(j,k),i.showEllipsis)continue;h=A.zHb(j,k,3,1,i),m=Q.columnWidth,o=Q.backgroundWidth,R=z.getCellRect(j,Q.startColumn,u,u,!0),p=R.x,q=R.x+o-m,r={data:h,row:j,col:k,x:q,y:l,width:m,height:n,style:i,cellOverflowLayout:Q},C.push(r),Q.layout=new f.Rect(p,l,o,n),d.m8J(j,k,Q,i,p,l,m,n),H[Q.column]=!0}};for(x=0;x<B;x++)F(x);if(E.length>0)for(y=E.length-1;y>=0;y--)c.splice(E[y],1);function G(a,b){var c=a.row,d=b.row,e=a.col,f=b.col;return c!==d?c-d:e!==f?e-f:void 0}return C.length>0&&C.sort(G),C},a.prototype.ZKJ=function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,w=this,x=[],y=w.$KJ(a[0].col,a[0].x),z=[];for(k=0;k<y.length;k++)z.push(y[k]);for(k=0;k<b.length;k++)z.push(b[k]);for(c.pJ=z,l=[],m=c.pJ.length,o=0;o<m;o++)n=c.pJ[o],n.width>0&&l.push(n.col);if(l.push(l[l.length-1]+1),c.l8J=l,x=w._KJ(y,a),x.length>0){for(p=d.x,q=d.x+d.width,k=x.length-1;k>=0;k--)r=x[k],r&&(s=r.overflowLayout,s&&(t=s.x,u=t+s.width,t<p&&(p=t),u>q&&(q=u)),a.unshift(r),c.jF(r.row,r.col,r.x,r.y,r.width,r.height,r.style,v,r.row===g&&i,r.col===h&&j,r));e||(d.width=q-p,f&&(d=d?f.getIntersectRect(d):f))}},a.prototype.$KJ=function(a,b){var c,d,e,f,g,i=new h.yp,k=this,l=k.kj,m=l.ss,n=l.ITa,o=a,p=[],r=[],s=[],t=[],u=o,v=b,w=l.getColumnCount()-l.frozenTrailingColumnCount(),x=l.frozenColumnCount()-1;for(e=o-1;e>x;e--)if(p[e]=c=m._m(e),c){if(r[e]=n.getColumnHeaderFitMode(!1,j.SheetArea.colHeader,e),s[e]=n.MTa(-1,e,-1,1,j.SheetArea.colHeader),t[e]=l.aLJ(e,v,w,u,p,r,s,t),r[e]===j.ColumnHeaderFitMode.normal)break;u=e,v-=c}for(f=u;f<o;f++)p[f]||(p[f]=m._m(f)),q(r[f])&&(r[f]=n.getColumnHeaderFitMode(!1,j.SheetArea.colHeader,f)),d=p[f],g=l.aLJ(f,v,w,u,p,r,s,t),t[f]=g,i.push(g),v+=d;return i},a.prototype._KJ=function(a,b){var c,d,e,f,g,h,i,k,l,m,n,o=this,p=o.kj,q=p.ITa,r=p.ss,s=p.Gr(1,1),t=[],u=s.length,v=a.length,w=function(n){var o,u;for(c=s[n],o=function(o){var s,u,w,x,y=a[o];if(y){if(d=c.row,e=y.col,k=y.x,l=y.y===-1?c.y:D(y.y*c.height+c.y),h=aa(y),i=_(y)===-1?_(c):c.height+c.y-l,g=r.zHb(d,e,1,1,f),f=r.Ym(d,e,1),m={data:g,row:d,col:e,x:k,y:l,width:h,height:i,style:f,overflowLayout:y,columnHeaderFitMode:q.getColumnHeaderFitMode(!1,j.SheetArea.colHeader,e),SheetArea:1},f.showEllipsis&&m.columnHeaderFitMode!==j.ColumnHeaderFitMode.stack)return"continue";m.columnHeaderFitMode===j.ColumnHeaderFitMode.stack&&(o===v-1?(s=b[0].col,u=b.filter(function(a){return a.row===n&&a.col===s})[0],m.cornerX=u&&u.x,m.cornerY=u&&u.y):(w=p.Zq(e,1,!0),w&&(x=a.findCol(w),x&&x.y!==-1&&(m.cornerX=x.x,m.cornerY=D(x.y*c.height)+c.y)))),t.push(m)}},u=0;u<v;u++)o(u)};for(n=0;n<u;n++)w(n);return t},a}(),b.oJ=O,P=".cutCopyIndicator",Q=f.Events.CellChanged,R=f.Events.ClipboardChanged,S=f.Events.ValueChanged,T=f.Events.ColumnChanged,U=f.Events.RowChanged,V=f.Events.RangeChanged,W=f.Events.ClipboardPasting,X=f.Events.ClipboardPasted,Y=f.Events.DragMerging,Z=f.Events.FloatingElementSelected,$=function(){function a(a){var b=this;b.yJ=!1,b.zJ=!1,b.kj=a,b.AJ()}return a.prototype.jx=function(a){var b=this;return 0===arguments.length?b.zJ:void(b.zJ=a)},a.prototype.BJ=function(a,b){var c,d=this;return 0===arguments.length?d.yJ:void((d.yJ!==a||a||b)&&(d.yJ=a,c=d.kj,c&&(c.$p(),q(d.MCc)||clearTimeout(d.MCc),d.MCc=setTimeout(function(){if(!d.yJ){var a=c.tu();a&&a.hZ(b)}d.MCc=u}))))},a.prototype.AJ=function(){var a=this,b=a.kj,c=!1,d="resizable",e="isVisible";function g(){a.yJ&&a.BJ(!1)}function h(a,b,c){a||b===d||b===c||b===e||g()}b.Fu(R+P,function(){a.BJ(!0)}),b.Fu(S+P,g),b.Fu(Q+P,function(a,b){b.isUndo||"tag"===b.propertyName||b.klK||g()}),b.Fu(T+P,function(a,b){h(b.isUndo,b.propertyName,"width")}),b.Fu(U+P,function(a,b){h(b.isUndo,b.propertyName,"height")}),b.Fu(V+P,function(a,b){b.isUndo||6===b.action||3===b.action||g()}),b.Fu(W+P,function(){c=a.BJ()}),b.Fu(X+P,function(b,d){var e,f,g,h,i=d.cellRange,j=d.sheet.tu(),k=j.n5,l=c;if(i&&k&&j.PA){if(a.jx()){for(f=0,g=k;f<g.length;f++)if(h=g[f],h.intersect(i.row,i.col,i.rowCount,i.colCount)&&!h.equals(i)){l=!1;break}}else l=!1,e=!0;a.BJ(l,e)}}),b.Fu(Y+P,g),b.Fu(Z+P,function(a,c){"worksheet"!==c.type&&(b.endEdit(),f.Vl.kmb(b))})},a.prototype.UI=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o,p,r,s,t=this;if(t.yJ&&(e=t.kj,g=e.yl,h=e.parent,i=h?h.options:{},j=e.tu(),k=j.n5,l=i.cutCopyIndicatorVisible,q(l)&&(l=!0),m=f.Rm.Om(e,i.cutCopyIndicatorBorderColor||"blue"),l&&j.PA===e&&k&&(n=g.VI(c,d,u),o=g.XI(c,d,k,b),o&&n))){for(a.save(),a.rect(n.x,n.y,aa(n),_(n)),a.clip(),p=0,r=o;p<r.length;p++)s=r[p],g.fJ(a,s,m);a.beginPath(),a.restore()}},a.prototype.rI=function(){this.BJ(!1)},a.prototype.sI=function(){this.BJ(!1)},a.prototype.tI=function(){this.BJ(!1)},a.prototype.uI=function(){this.BJ(!1)},a.prototype.ky=function(){this.BJ(!1)},a.prototype.no=function(){var a=this.kj;a.Gu(Q+P),a.Gu(R+P),a.Gu(S+P),a.Gu(T+P),a.Gu(U+P),a.Gu(V+P),a.Gu(W+P),a.Gu(X+P),a.Gu(Y+P),a.Gu(Z+P)},a}(),b.CJ=$,e.Worksheet.$n("render",{init:function(){var a=this;a.yl=new O(a),a.at=new $(a)},dispose:function(a){var b,c=this;a.clearCache!==!1&&(c.yl&&(c.yl.kj=u,c.yl=u),b=c.at,b&&(b.no(),c.at=u))},onLayoutChanged:function(a){var b,c=this,d=c.at;d&&(b=a.changeType,"addRows"===b?d.rI():"deleteRows"===b?d.sI():"addColumns"===b?d.tI():"deleteColumns"===b&&d.uI())}})},"./dist/core/worksheet/worksheet-selection.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/worksheet/worksheet.js"),e=c("./dist/core/util/common.js"),f=c("Common"),g=c("./dist/core/util/domUtil.js"),h=c("./dist/core/core.enum.js"),i=f.Common.j.Fa,j=f.Common.k.ac,k=null,l=Math.max,m=Math.min,n="gc-selection";function o(a,b){return a.getColumnCount(b)}function p(a,b){return a.getRowCount(b)}function q(a){return a.rowCount}function r(a){return a.colCount}function s(a,b,c){var d,e,f=[],g=a.length;for(e=0;e<g;e++)d=a[e],e===b?f=f.concat(c):f.push(d);return f}function t(a,b,c){for(var d=c-1;d>=0;d--)if(a.getColumnVisible(b+d))return b+d;return b+c-1}function u(a,b,c){for(var d=c-1;d>=0;d--)if(a.getRowVisible(b+d))return b+d;return b+c-1}g.GC$.extend(d.Worksheet.prototype,{addSelection:function(a,b,c,d){this.RXJ(a,b,c,d,!1)},RXJ:function(a,b,c,d,f){var g,h,i=this,k=a,l=b,m=c,n=d;k!==-1&&l!==-1&&(g=i.ITa.getSpans(),g&&j(g)>0&&(h=i.su(g,e.kf(a,b,c,d)),k=h.row,l=h.col,m=q(h),n=r(h))),i.ITa.do("addSelection",k,l,m,n,f),i.$p()},setSelection:function(a,b,c,d){this.DJ(a,b,c,d,2)},DJ:function(a,b,c,d,f){var g,h,i,j=this,k=p(j),m=o(j);a>=k&&(a=k-1),b>=m&&(b=m-1),g=l(0,a),h=l(0,b),j.Tr(),i=2===f?e.Vl.Wl(j):1===f,j.Kr(g,h,j.Er(g),j.Fr(h),!i),j.RXJ(a,b,c,d)},getSelections:function(){return this.ITa.getSelections()},clearSelection:function(a){var b,c;void 0===a&&(a=1),b=this,b.Tr(),c=2===a?e.Vl.Wl(b):1===a,b.Kr(0,0,b.Er(0),b.Fr(0),!c),d.Worksheet.ao(b,"clearSelection"),b.$p()},Tr:function(a){this.ITa.do("clearSelection",a)},Qs:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,q=n.options,r=q.protectionOptions,s=r.allowSelectLockedCells!==!1,t=r.allowSelectUnlockedCells!==!1;if(!q.isProtected||s&&t)return!0;if(!s&&!t)return!1;if(d=c?c.locked:n.tq(a,b,"locked"),e=b<0,f=a<0,s===d&&(f||e)){for(g=f?p(n):1,a=f?0:a,h=e?o(n):1,b=e?0:b,i=n.ITa,j=a+g-1,k=b+h-1,l=void 0,m=void 0,l=a;l<=j;l++)for(m=b;m<=k;m++)if(c=i.getStyle(l,m),c&&s!==c.locked)return!1;if(f)for(l=a;l<=j;l++)if(c=i.getStyle(l,-1),c&&s!==c.locked)return!1;if(e)for(m=b;m<=k;m++)if(c=i.getStyle(-1,m),c&&s!==c.locked)return!1}return s===d},SZa:function(a,b,c,d){var e,f,g=this;for(a=a<0?0:a,b=b<0?0:b,e=a;e<a+c;e++)for(f=b;f<b+d;f++)if(g.tq(e,f,"locked"))return!0},ZZa:function(){var a,b=this.getSelections();for(a=0;a<b.length;a++)if(b[a].col!==-1)return!1;return!0},$Za:function(){var a,b=this.getSelections();for(a=0;a<b.length;a++)if(b[a].row!==-1)return!1;return!0},selectionPolicy:function(a){var b=this,c=b.ITa;return 0===arguments.length?c.getSelectionPolicy():(c.do("setSelectionPolicy",a),b)},selectionUnit:function(a){var b=this,c=b.ITa;return 0===arguments.length?c.getSelectionUnit():(c.do("setSelectionUnit",a),b)},getSelectionBackColor:function(){return this.options.selectionBackColor||e.Im.Lm(n).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||e.Im.Lm(n).borderTopColor},m_a:function(a){return a?void(this.options.m_a=a):this.options.m_a},EJ:function(){var a,b,c=this,d=c.ITa.getSelections();j(d)>0&&(a={selections:d},b=c.ITa.getActiveSelectedRangeIndex(),0!==b&&(a.activeSelectedRangeIndex=b),c.FJ=a,c.Tr(),c.yl.im())},GJ:function(){var a=this,b=a.FJ,c=b&&b.selections;c&&(a.ITa.do("setSelections",c),a.ITa.do("setActiveSelectedRangeIndex",b.activeSelectedRangeIndex||0))},Ax:function(a,b,c,d){var e,f,g,h,i=this,j=i.tables;c||d?(e=j&&j._7J(a,b),e||(e=i.HJ(a,b,c,i.Rr||0))):e=i.HJ(a,b,c,i.Rr||0),e&&(f=e.row,g=e.col,h=e.leadingCellCol,i.IJ(f,g)&&(i.Qr=f,i.Rr=h,i.Jr(f,g)))},HJ:function(a,b,c,d){var e,f,g=this,h=p(g),j=o(g),l=a;return 0===l&&!c||0===h||0===j?k:(f=g.JJ(l,d),c||g.KJ(f),l=f.r,e=f.c,l<0&&c&&(e=g.br(e),(e<0||i(e))&&(e=g.br(j)),d=e,f=g.JJ(h,e),l=f.r,e=f.c,e===b&&l<=a)?k:{row:l,col:e,leadingCellCol:d})},Bx:function(a,b,c){var d,e,f,g=this,h=g.LJ(a,b,c,g.Rr||0);!h||h.row===a&&h.col===b||(d=h.row,e=h.col,f=h.leadingCellCol,g.IJ(d,e)&&(g.Qr=d,g.Rr=f,g.Jr(d,e)))},LJ:function(a,b,c,d){var e,f,g=this,h=p(g),j=o(g),k=a;if((k!==h-1||c)&&0!==h&&0!==j&&(f=g.MJ(k,d),c||g.KJ(f),k=f.r,e=f.c,!(k===h&&c&&(e=g.Zq(e),(e>=j||i(e))&&(e=g.Zq(-1)),d=e,f=g.MJ(-1,e),k=f.r,e=f.c,e===b&&k>=a))))return{row:k,col:e,leadingCellCol:d}},Dx:function(){var a,b,c=this,d=c.NJ();d&&(a=d.row,b=d.col,c.Qr=a,c.Rr=b,c.Jr(a,b))},NJ:function(){var a,b,c,d,e,f=this,g=f.ir(),h=f.dr(),i=h;if(!g&&!i)return k;if(a=f.options,b=a.protectionOptions,c=b.allowSelectLockedCells!==!1,d=b.allowSelectUnlockedCells!==!1,!a.isProtected||c&&d)return{row:g,col:i};if(!c&&!d)return k;for(;g!==k&&g>=0;g=f.gr(g))for(i=h;i!==k&&i>=0;i=f.br(i))if(e=f.tq(g,i,"locked"),c===e)return{row:g,col:i};return k},Cx:function(){var a,b,c=this,d=c.OJ();d&&(a=d.row,b=d.col,c.Qr=a,c.Rr=b,c.Jr(a,b))},OJ:function(){var a,b,c,d,e,f=this,g=f._q(f.frozenRowCount()-1),h=f.Zq(f.frozenColumnCount()-1),i=h,j=f.ir(),l=f.dr();if(g===k||i===k)return k;if(a=f.options,b=a.protectionOptions,c=b.allowSelectLockedCells!==!1,d=b.allowSelectUnlockedCells!==!1,!a.isProtected||c&&d)return{row:g,col:i};if(!c&&!d)return k;for(;g!==k&&g<=j;g=f._q(g))for(i=h;i!==k&&i<=l;i=f.Zq(i))if(e=f.tq(g,i,"locked"),c===e)return{row:g,col:i};return k},zx:function(a,b,c){var d,e,f,g,h=this,i=h.tables;c?(d=i&&i.eJb(a,b),d||(d=h.iy(a,b,c,h.Qr||0))):d=h.iy(a,b,c,h.Qr||0),d&&(e=d.row,f=d.col,g=d.leadingCellRow,h.IJ(e,f)&&(h.Qr=g,h.Rr=f,h.Jr(e,f)))},iy:function(a,b,c,d){var e,f,g,h=this,j=p(h),l=o(h),m=b;if(0===m&&!c||0===j||0===l)return k;for(f=h.PJ(d,m),g=d,c||h.KJ(f),e=f.r,m=f.c;m<0&&c;){if(e=h.gr(e,3,!0),(e<0||i(e))&&(e=h.gr(j,3,!0)),d=e,f=h.PJ(d,l),e=f.r,m=f.c,e===a&&m<b)return k;if(e===a&&m===b){if(d===g)return k;f=h.PJ(d,m),e=f.r,m=f.c}}return{row:e,col:m,leadingCellRow:d}},KJ:function(a){var b,c=this,d=!1;a.r<0?a.r=c.ar():a.r>=p(c)&&(a.r=c.ir(),d=!0),a.c<0?a.c=c.$q():a.c>=o(c)&&(a.c=c.dr(),d=!0),d&&(b=c.ITa.getSpan(a.r,a.c),b.row!==a.r&&(a.r=b.row),b.col!==a.c&&(a.c=b.col))},Fx:function(a,b){for(var c,d,e=this,f=e.ITa,g=f.getActiveSelectedRangeIndex(),h=-1,i=e.Tq(e.Ix()),j=i.row,k=i.col,l=i.col+r(i)-1,m=a,n=b;;){if(c=e.QJ(m,n),m=c.r,n=c.c,n>=k)break;if(h===g&&m===a&&n<=b)return;m--,m>=j?n=l+1:(d=e.Tq(e.Ix(3)),h=f.getActiveSelectedRangeIndex(),j=d.row,k=d.col,l=d.col+r(d)-1,m=d.row+q(d)-1,n=d.col+r(d))}m>=0&&(e.Jr(m,n),e.Qr=m,e.Rr=n)},Gx:function(a,b){for(var c,d,e=this,f=e.ITa,g=f.getActiveSelectedRangeIndex(),h=-1,i=e.Tq(e.Ix()),j=i.col,k=i.row+q(i)-1,l=i.col+r(i)-1,m=a,n=b;;){if(c=e.RJ(m,n),m=c.r,n=c.c,n<=l)break;if(h===g&&m===a&&n>=b)return;m++,m<=k?n=j-1:(d=e.Tq(e.Ix(4)),h=f.getActiveSelectedRangeIndex(),j=d.col,k=d.row+q(d)-1,l=d.col+r(d)-1,m=d.row,n=d.col-1)}m>=0&&(e.Jr(m,n),e.Qr=m,e.Rr=n)},a5J:function(a,b){for(var c,d,e=this,f=e.ITa,g=f.getActiveSelectedRangeIndex(),h=-1,i=e.Tq(e.Ix()),j=i.row,k=i.row+q(i)-1,l=i.col,m=a,n=b;;){if(c=e.c5J(m,n),m=c.r,n=c.c,m>=j)break;if(h===g&&n===b&&m<=a)return;n--,n>=l?m=k+1:(d=e.Tq(e.Ix(1)),h=f.getActiveSelectedRangeIndex(),j=d.row,k=d.row+q(d)-1,l=d.col,m=d.row+q(d),n=d.col+r(d)-1)}n>=0&&(e.Jr(m,n),e.Qr=m,e.Rr=n)},b5J:function(a,b){for(var c,d,e=this,f=e.ITa,g=f.getActiveSelectedRangeIndex(),h=-1,i=e.Tq(e.Ix()),j=i.row,k=i.row+q(i)-1,l=i.col+r(i)-1,m=a,n=b;;){if(c=e.d5J(m,n),m=c.r,n=c.c,m<=k)break;if(h===g&&n===b&&m>=a)return;n++,n<=l?m=j-1:(d=e.Tq(e.Ix(2)),h=f.getActiveSelectedRangeIndex(),k=d.row+q(d)-1,l=d.col+r(d)-1,m=d.row-1,n=d.col)}n>=0&&(e.Jr(m,n),e.Qr=m,e.Rr=n)},Rs:function(a,b,c){var d,e,f,g,h=this,i=h.tables;c?(d=i&&i.fJb(a,b),d||(d=h.hy(a,b,c,h.Qr||0))):d=h.hy(a,b,c,h.Qr||0),!d||d.row===a&&d.col===b||(e=d.row,f=d.col,g=d.leadingCellRow,h.IJ(e,f)&&(h.Qr=g,h.Rr=f,h.Jr(e,f)))},hy:function(a,b,c,d){var e,f,g,h=this,j=p(h),l=o(h),m=b;if(m===l-1&&!c||0===j||0===l)return k;for(f=h.SJ(d,m),g=d,c||h.KJ(f),e=f.r,m=f.c;m===l&&c;){if(!(a!==j-1||a!==e||h.getRowVisible(e,3)&&h.Sl(e,3)>0))return k;if(e=h._q(e,3,!0),(e>=j||i(e))&&(e=h._q(-1,3,!0)),d=e,f=h.SJ(d,-1),e=f.r,m=f.c,e===a&&m>b)return k;if(e===a&&m===b){if(d===g)return k;f=h.SJ(d,m),e=f.r,m=f.c}}return{row:e,col:m,leadingCellRow:d}},PJ:function(a,b){for(var c,d,f,g=this,h=b;h>=0&&(c=a,h--,!(h<0));)if(g.getColumnVisible(h)&&(d=g.ITa.getSpans(e.kf(c,h,1,1)),d&&j(d)>0&&(f=d[0],h>=f.col&&(h=f.col,c=f.row)),g.IJ(c,h)))return{r:c,c:h};return{r:c,c:h}},QJ:function(a,b){for(var c,d,e=this;b>=0&&(b--,!(b<0));){if(c=e.ITa.findSpan(a,b)){if(d=e.Ix(),!(d.row<=c.row&&c.row+q(c)<=d.row+q(d)&&d.col<=c.col&&c.col+r(c)<=d.col+r(d)))continue;if(c.row!==a||c.col!==b)continue;b>=c.col&&(b=c.col,a=c.row)}if(e.IJ(a,b))return{r:a,c:b}}return{r:a,c:b}},SJ:function(a,b){for(var c,d,f,g,h=this,i=o(h),k=b;k<i&&(c=a,d=h.ITa.getSpan(c,k),k=d.col+r(d),!(k>=i));)if(h.getColumnVisible(k)&&(f=h.ITa.getSpans(e.kf(c,k,1,1)),f&&j(f)>0&&(g=f[0],k>g.col?k=l(k,g.col+r(g)):c=g.row),h.IJ(c,k)))return{r:c,c:k};return{r:c,c:k}},RJ:function(a,b){for(var c,d,e,f=this,g=f.ITa,h=o(f);b<h&&(c=g.getSpan(a,b),b=c.col+r(c),!(b>=h));){if(d=g.findSpan(a,b)){if(e=f.Ix(),!(e.row<=d.row&&d.row+q(d)<=e.row+q(e)&&e.col<=d.col&&d.col+r(d)<=e.col+r(e)))continue;if(d.row!==a||d.col!==b)continue;b>d.col?b=l(b,d.col+r(d)):a=d.row}if(f.IJ(a,b))return{r:a,c:b}}return{r:a,c:b}},IJ:function(a,b){var c,d,e,f=this;return!!f.Qs(a,b)&&(c=a>=0&&a<p(f)&&b>=0&&b<o(f)&&f.getRowVisible(a)&&f.getColumnVisible(b)&&f.Sl(a)>0&&f.Tl(b)>0,d=!!f.Tx,c===!0&&d===!0&&(e=f.tq(a,b,"tabStop"),e===!1&&(c=!1)),c)},JJ:function(a,b){for(var c,d,f=this;a>=0&&(a--,!(a<0));)if(f.getRowVisible(a)&&(c=f.ITa.getSpans(e.kf(a,b,1,1)),c&&j(c)>0&&(d=c[0],a>=d.row&&(a=d.row,b=d.col)),f.IJ(a,b)))return{r:a,c:b};return{r:a,c:b}},c5J:function(a,b){for(var c,d,e=this;a>=0&&(a--,!(a<0));){if(c=e.ITa.findSpan(a,b)){if(d=e.Ix(),!(d.row<=c.row&&c.row+q(c)<=d.row+q(d)&&d.col<=c.col&&c.col+r(c)<=d.col+r(d)))continue;if(c.row!==a||c.col!==b)continue;a>=c.row&&(b=c.col,a=c.row)}if(e.IJ(a,b))return{r:a,c:b}}return{r:a,c:b}},MJ:function(a,b){for(var c,d,f,g=this,h=p(g);a<h&&(c=g.ITa.getSpan(a,b),a=c.row+q(c),!(a>=h));)if(d=g.ITa.getSpans(e.kf(a,b,1,1)),g.getRowVisible(a)&&(d&&j(d)>0&&(f=d[0],a>f.row?a=l(a,f.row+q(f)):b=f.col),g.IJ(a,b)))return{r:a,c:b};return{r:a,c:b}},d5J:function(a,b){for(var c,d,e,f=this,g=f.ITa,h=p(f);a<h&&(c=g.getSpan(a,b),a=c.row+q(c),!(a>=h));){if(d=g.findSpan(a,b)){if(e=f.Ix(),!(e.row<=d.row&&d.row+q(d)<=e.row+q(e)&&e.col<=d.col&&d.col+r(d)<=e.col+r(e)))continue;if(d.col!==b||d.row!==a)continue;a>d.row?a=l(a,d.row+q(d)):b=d.col}if(f.IJ(a,b))return{r:a,c:b}}return{r:a,c:b}},Ur:function(a,b,c,d,e,f){var g=this;g.ITa.do("addSelection",a,b,c,d,k,f),e&&g.Xq<=0&&g.yl.im(k,k,k,k,f)},aH:function(a,b,c){var d=this,e=d.Jx(a,b,d.Jl,d.Kl),f=e.row,g=e.col,h=q(e),i=r(e),j=d.selectionPolicy(),k=d.selectionUnit();0!==j&&(1===j&&d.ITa.do("clearSelection"),1===k?(g=-1,i=-1):2===k&&(f=-1,h=-1),d.Kx(f,g,h,i,c))},Jx:function(a,b,c,d,f,g){var h,l,m,n,o,p=this;return i(c)&&(c=p.Jl),i(d)&&(d=p.Kl),h=p.ITa,l=h.getSpan(c,d,g),m=h.getSpan(a,b,g),f&&l.equals(m)?new e.Range(l.row,l.col,1,1):(n=l.union(m),o=p.ITa.getSpans(k,g),o&&j(o)>0&&(n=p.TJ(o,n)),n)},Kx:function(a,b,c,d,f){var g,h,i,k,l,m,n=this,o=n.ITa,p=n.Ix();if(j(o.getSelections())>0?(h=e.kf(a,b,c,d),n.n_a?(g=n.p_a,n.p_a=h):(i=o.getSelections(),i[o.getActiveSelectedRangeIndex()]=h,o.do("setSelections",i))):n.n_a||o.do("addSelection",a,b,c,d),f&&n.Xq<=0){if(k=n.Ix(),!n.n_a&&k.row===p.row&&k.col===p.col&&q(k)===q(p)&&r(k)===r(p))return;l=n.yl,n.n_a&&(m=n.p_a,g&&g.containsRange(m)?m=g:g&&(m=g.union(m)),m=m.union(e.kf(n.getActiveRowIndex(),n.getActiveColumnIndex(),1,1)),p=m.union(p),k=m.union(k)),p.containsRange(k)?l.im(p):k.containsRange(p)?l.im(k):(l.im(p),l.im(k),l.im(n.p_a))}},kyb:function(a){var b=[];return a&&(b=this.ITa.getSpans(a)),b},lyb:function(a,b){var c=a.row,d=a.col,e=a.rowCount,f=a.colCount,g=b.row,h=b.col,i=b.rowCount,j=b.colCount,k=c+e,l=d+f,m=g+i,n=h+j,o=!1,p=!1,q;return a.intersect(g,h,i,j)&&(q=c>g||d>h||k<m||l<n,o=q,p=!q),b.myb=b.myb||p,o},nyb:function(a,b,c,d){var e,f=[],g=[];for(e=0;e<a.length;e++)g=this.oyb(a[e],b,c,d),f=f.concat(g);return f},oyb:function(a,b,c,d){var e,f,g,h,i,j=[],k=b.length;for(j.push(a),h=k-1;h>=0;h--)for(f=b[h],i=0;i<j.length;)e=j[i],this.lyb(e,f)?(g=this.v_a(e,f,c,d),j=s(j,i,g),i+=g.length):i++;return j},pyb:function(a,b){var c=b.row,d=b.col,e=b.rowCount,f=b.colCount;return a.intersect(c,d,e,f)},qyb:function(a,b){var c,d,e=a.length,f=[];for(d=e-1;d>=0;d--)c=a[d],this.pyb(c,b)||f.push(c);return f},ryb:function(a){var b=!1,c=this.ITa.getSpans(a);return 1===c.length&&(b=a.equals(c[0])),b},syb:function(a,b){var c,d,e,f,g=a,h=b.length,i=g.length,j=!0;for(e=h-1;e>=0;e--){for(d=b[e],f=i-1;f>=0;f--)if(c=g[f],c.equals(d)){j=!1;break}j&&g.push(d)}return g},tyb:function(a){var b,c,d,e,f=a.length,g=[];for(c=f-1;c>=0;c--)b=a[c],b.myb&&(delete b.myb,g.push(c));for(d=g.length,e=0;e<d;e++)a.splice(g[e],1)},v_a:function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s;return b=this.Tq(b),f=[],g=a.getIntersect(b,c,d),a&&g?(h=a.row>=0?a.row:0,i=a.col>=0?a.col:0,j=a.rowCount,k=a.colCount,l=g.row,m=g.col,n=g.rowCount,o=g.colCount,p=h+j,q=i+k,r=l+n,s=m+o,p-r>0&&f.push(e.kf(r,i,p-r,k)),q-s>0&&f.push(e.kf(l,s,n,q-s)),m-i>0&&f.push(e.kf(l,i,n,m-i)),l-h>0&&f.push(e.kf(h,i,l-h,k))):f.push(a),f},u_a:function(a,b){var c,d,e,f,g,h,i,k,l,m,n,o=[],p=this.getRowCount(3),q=this.getColumnCount(3),r=this.deselectIgnoreSpan();if(a&&a.length>0){for(d=a.length,e=[],f=[],g=[],h=void 0,i=void 0,c=!1,k=d-1;k>=0;k--)h=a[k],r||!this.ryb(h)||this.pyb(h,b)?(e=this.v_a(h,b,p,q),r||(i=this.kyb(h),i.length>0&&(e=this.nyb(e,i,p,q),g=this.qyb(i,b),f=this.syb(f,g),this.tyb(f))),l=j(e),!c&&l>0&&(this.setSelection(e[l-1].row,e[l-1].col,1,1),c=!0),o=e.concat(o)):f=this.syb(f,[h]);r||(o=f.concat(o))}for(this.Tr(),m=o.length,this.suspendPaint(),n=0;n<m;n++)this.RXJ(o[n].row,o[n].col,o[n].rowCount,o[n].colCount);c||this.setActiveCell(this.Jl,this.Kl),this.resumePaint()},Sx:function(a,b){var c,d,e,f,g,h,i,k,l,m=this,n=m.ITa.getSelections();if(!(j(n)<=0)&&(c=m.Ix(),d=m.UJ(c,a,b))){if(e=d.row,f=d.col,g=q(d),h=r(d),i=m.selectionPolicy(),k=m.selectionUnit(),0===i)return;1===i&&m.ITa.do("clearSelection"),1===k?(f=-1,h=-1):2===k&&(e=-1,g=-1),m.Kx(e,f,g,h,!0),l=m.ITa.getSelections(),m.mm.h8J(n,l)&&(m.yu(n,l),m.Au(n))}},UJ:function(a,b,c,d,e){var f=this,g=f.Tq(a),h=k;return 37===b?h=c?f.q8J(g,!1,d,e):f.r8J(g,d,e):39===b?h=c?f.s8J(g,!1,d,e):f.t8J(g,d,e):38===b?h=c?f.u8J(g,!1,d,e):f.v8J(g,d,e):40===b?h=c?f.w8J(g,!1,d,e):f.x8J(g,d,e):36===b?h=c?f.y8J(g,d,e):f.z8J(g,d,e):35===b?h=c?f.A8J(g,d,e):f.B8J(g,d,e):33===b?h=f.C8J(g,d,e):34===b&&(h=f.D8J(g,d,e)),h&&(a.row<0&&(h.row=-1,h.rowCount=f.getRowCount()),a.col<0&&(h.col=-1,h.colCount=f.getColumnCount())),h},r8J:function(a,b,c){for(var d,f,g,h,i,j,n,o,p,s,t=this,v=a.row,w=a.col,x=q(a),y=r(a),z=w+y-1,A=0,B=u(t,v,x);z>A;)if(z--,t.IJ(B,z)&&(d=t.Jx(B,z,b,c),f=m(v,d.row),g=m(w,d.col),h=l(v+x-1,d.row+q(d)-1),i=m(w+y-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,f!==v||g!==w||j!==x||n!==y))return o=t.qq,p=t.Kl,w<p?g<=o&&t.rq(g):w===p&&i<=o&&t.rq(i),s=t.parent&&t.parent.options.scrollByPixel,s&&g===o&&0!==t.eCb&&t.rq(g,0),e.kf(f,g,j,n);return k},q8J:function(a,b,c,d){var f,g,h,j,k,n,o,p=this,s=a.row,t=a.col,u=p.frozenColumnCount(),v=u?p.Zq(u-1):p.$q(),w=b?v:p.$q();if(!i(w))return(u<=0||b)&&p.rq(w),f=p.Jx(s,w,c,d),g=m(s,f.row),h=m(t,f.col),j=l(s+q(a)-1,f.row+q(f)-1),k=m(t+r(a)-1,f.col+r(f)-1),n=j-g+1,o=k-h+1,e.kf(g,h,n,o)},lCb:function(a){var b,c,d,e,f,g=this,h=g.parent&&g.parent.options.scrollByPixel;if(h){for(d=g.ss,e=g.Fr(a),f=g.getViewportWidth(e);0<=a&&(f-=d._m(a),!(f<0));a--);b=a,c=f}else b=g.hKJ(a,2).col,c=0;return{dj:b,UP:c}},t8J:function(a,b,c){for(var d,f,g,h,i,j,n,p,s,t,v=this,w=a.row,x=a.col,y=q(a),z=r(a),A=x,B=o(v)-1,C=u(v,w,y);A<B;)if(A++,v.IJ(C,A)&&(d=v.Jx(C,A,b,c),f=m(w,d.row),g=l(x,d.col),h=l(w+y-1,d.row+q(d)-1),i=l(x+z-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,f!==w||g!==x||j!==y||n!==z))return p=v.Aw(),s=v.Kl,x<s?g>=p&&(t=v.lCb(g),v.rq(t.dj,t.UP)):x===s&&i>=p&&(t=v.lCb(i),v.rq(t.dj,t.UP)),e.kf(f,g,j,n);return k},s8J:function(a,b,c,d){var f,g,h,j,k,n,o,p,s=this,t=a.row,u=a.col,v=s.lr();if(!i(v))return s.rq(v),f=s.dr(),b||(f+=s.frozenTrailingColumnCount()),g=s.Jx(t,f,c,d),h=m(t,g.row),j=l(u,g.col),k=l(t+q(a)-1,g.row+q(g)-1),n=l(u+r(a)-1,g.col+r(g)-1),o=k-h+1,p=n-j+1,e.kf(h,j,o,p)},v8J:function(a,b,c){for(var d,f,g,h,i,j,n,o,p,s,u=this,v=a.row,w=a.col,x=q(a),y=r(a),z=v+x-1,A=0,B=t(u,w,y);z>A;)if(z--,u.IJ(z,B)&&(d=u.Jx(z,B,b,c),f=m(v,d.row),g=m(w,d.col),h=m(v+x-1,d.row+q(d)-1),i=l(w+y-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,f!==v||g!==w||j!==x||n!==y))return o=u.lq,p=u.Jl,v<p?f<=o&&u.mq(f):v===p&&h<=o&&u.mq(h),s=u.parent&&u.parent.options.scrollByPixel,s&&f===o&&0!==u.cCb&&u.mq(f,0),e.kf(f,g,j,n);return k},u8J:function(a,b,c,d){var f,g,h,j,k,n,o,p=this,s=a.row,t=a.col,u=p.frozenRowCount(),v=u?p._q(u-1):p.ar(),w=b?v:p.ar();if(!i(w))return(u<=0||b)&&p.mq(w),f=p.Jx(w,t,c,d),g=m(s,f.row),h=m(t,f.col),j=m(s+q(a)-1,f.row+q(f)-1),k=l(t+r(a)-1,f.col+r(f)-1),n=j-g+1,o=k-h+1,e.kf(g,h,n,o)},mCb:function(a){var b,c,d,e,f,g=this,h=g.parent&&g.parent.options.scrollByPixel;if(h){for(d=g.ss,e=g.Er(a),f=g.getViewportHeight(e);0<=a&&(f-=d.Sl(a),!(f<0));a--);b=a,c=f}else b=g.ms(a,2),c=0;return{
cj:b,UP:c}},x8J:function(a,b,c){for(var d,f,g,h,i,j,n,o,s,u,v=this,w=a.row,x=a.col,y=q(a),z=r(a),A=w,B=p(v)-1,C=t(v,x,z);A<B;)if(A++,v.IJ(A,C)&&(d=v.Jx(A,C,b,c),f=l(w,d.row),g=m(x,d.col),h=l(w+y-1,d.row+q(d)-1),i=l(x+z-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,f!==w||g!==x||j!==y||n!==z))return o=v.Fw(),s=v.Jl,w<s?f>=o&&(u=v.mCb(f),v.mq(u.cj,u.UP)):w===s&&h>=o&&(u=v.mCb(h),v.mq(u.cj,u.UP)),e.kf(f,g,j,n);return k},w8J:function(a,b,c,d){var f,g,h,j,k,n,o,p,s=this,t=a.row,u=a.col,v=s.kr();if(!i(v))return s.mq(v),f=s.ir(),b||(f+=s.frozenTrailingRowCount()),g=s.Jx(f,u,c,d),h=l(t,g.row),j=m(u,g.col),k=l(t+q(a)-1,g.row+q(g)-1),n=l(u+r(a)-1,g.col+r(g)-1),o=k-h+1,p=n-j+1,e.kf(h,j,o,p)},z8J:function(a,b,c){for(var d,f,g,h,i,j,n,o=this,p=a.row,s=a.col,t=q(a),u=r(a),v=o.frozenColumnCount()-1,w=o.Kl,x=p+t-1;v<w;)if(v++,o.IJ(x,v)){if(s<=v&&s+u-1===o.Kl)break;return d=o.Jx(x,v,b,c),f=m(p,d.row),g=m(s,d.col),h=l(p+t-1,d.row+q(d)-1),i=m(s+u-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,o.rq(o.$q()),e.kf(f,g,j,n)}return k},y8J:function(a,b,c){return a=this.q8J(a,!0,b,c),a=this.u8J(a,!0,b,c)},B8J:function(a,b,c){for(var d,f,g,h,i,j,n,p=this,s=a.row,t=a.col,u=q(a),v=r(a),w=o(p),x=p.Kl,y=s+u-1;w>x;)if(w--,p.IJ(y,w)){if(t+v-1>=w&&t===p.Kl)break;return d=p.Jx(y,w,b,c),f=m(s,d.row),g=l(t,d.col),h=l(s+u-1,d.row+q(d)-1),i=l(t+v-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,p.rq(p.lr()),e.kf(f,g,j,n)}return k},A8J:function(a,b,c){return a=this.s8J(a,!0,b,c),a=this.w8J(a,!0,b,c)},C8J:function(a,b,c){var d,f,g,h,n,o,p,s,t,u,v=this,w=a.row,x=a.col,y=q(a),z=v.Ew();return i(z)?k:(d=v.Gr(1),f=v.mq(z),g=-1,f?g=v._q(w+y-1-j(d)):v.frozenRowCount()<=0&&(g=v.ar()),g<v.lq?g=v.lq:g>=v.Fw()&&(g=v.gr(v.Fw())),h=v.Jx(g,x,b,c),n=m(w,h.row),o=m(x,h.col),p=m(w+y-1,h.row+q(h)-1),s=l(x+r(a)-1,h.col+r(h)-1),t=p-n+1,u=s-o+1,e.kf(n,o,t,u))},D8J:function(a,b,c){var d,f,g,h,n,o,p,s,t,u=this,v=a.row,w=a.col,x=q(a),y=u.$x();return i(y)?k:(d=u.Gr(1),u.mq(y),f=u.gr(v+x-1+j(d)),f<u.lq?f=u.lq:f>=u.Fw()&&(f=u.lq>=u.kr()?u.Fw():u.gr(u.Fw())),g=u.Jx(f,w,b,c),h=l(v,g.row),n=m(w,g.col),o=l(v+x-1,g.row+q(g)-1),p=l(w+r(a)-1,g.col+r(g)-1),s=o-h+1,t=p-n+1,e.kf(h,n,s,t))},Ew:function(){var a,b,c,d,e,f=this,g=f.Gr(1);if(!g||j(g)<=0)return k;for(a=f.frozenRowCount(),b=a?f._q(a-1):f.ar(),c=0,d=f.lq,e=f.am();d>b&&(d--,c+=f.Sl(d),!(c>f.tNc(e))););return d},zw:function(){var a,b,c,d,e,f=this,g=f.Hr(1);if(!g||j(g)<=0)return k;for(a=f.frozenColumnCount(),b=a?f.Zq(a-1):f.$q(),c=0,d=f.qq,e=f.am();d>b&&(d--,c+=f.Tl(d),!(c>f.wNc(e))););return d},$x:function(){var a,b=this.Gr(1),c=j(b);return b&&c>0?(a=b[c-1].row,this.ir()<=a?this.lq:a):k},kr:function(){var a,b,c,d,e,f,g=this;if(g.ir()===g.Fw()&&(a=g.am(),b=g.Gr(1),c=j(b),b&&c>=1&&(d=b[c-1],d.y+d.height<=a.qt+g.tNc(a))))return g.lq;e=g.lq;try{return g.lq=g.ir(),f=g.Ew(),f=g._q(f)}catch(a){}finally{g.lq=e}},lr:function(){var a,b,c,d,e,f,g=this;if(g.dr()===g.Aw()&&(a=g.am(),b=g.Hr(1),c=j(b),b&&c>=1&&(d=b[c-1],d.x+d.width<=a.pt+a.width)))return g.qq;for(a=g.am(),e=0,f=g.dr();f>0&&(e+=g.Tl(f),!(e>g.wNc(a)));)f--;return f>0&&(f=g.Zq(f)),f},Fw:function(){var a=this.Gr(1),b=j(a);return a&&b>0?a[b-1].row:k},Aw:function(){var a=this.Hr(1),b=j(a);return a&&b>0?a[b-1].col:k},hr:function(){var a,b,c=this,d=c.Gr(1),e=j(d);return d&&e>0?(a=c.am(),b=e-1,d[b].y+d[b].height<=a.qt+c.tNc(a)?d[b].row:d[l(b-1,0)].row):k},cr:function(){var a,b,c=this,d=c.Hr(1),e=j(d);return d&&e>0?(a=c.am(),b=e-1,d[b].x+d[b].width<=a.pt+c.wNc(a)?d[b].col:d[l(b-1,0)].col):k},ir:function(a){i(a)&&(a=3);var b=p(this,a);return 3!==a&&2!==a||(b-=this.frozenTrailingRowCount()),this.gr(b,a)},dr:function(a){i(a)&&(a=3);var b=o(this,a);return 3!==a&&1!==a||(b-=this.frozenTrailingColumnCount()),this.br(b,a)},TJ:function(a,b){var c,d,e;if(a)for(c=0,d=j(a);c<d;c++)if(e=a[c],b.intersect(e.row,e.col,q(e),r(e)))return a.splice(c,1),c--,this.TJ(a,b.union(e));return b},Ix:function(a){var b,c=this,d=c.ITa,f=j(d.getSelections()),g=e.kf(-1,-1,0,0);return f<=0?g:(b=d.getActiveSelectedRangeIndex(),3===a||1===a?(b--,b<0&&(b=f-1),d.do("setActiveSelectedRangeIndex",b)):4!==a&&2!==a||(b++,b>=f&&(b=0),d.do("setActiveSelectedRangeIndex",b)),b=d.getActiveSelectedRangeIndex(),b>=0&&(g=d.getSelections()[b]),g)}}),d.Worksheet.$n("selection",{init:function(){this.ITa.do("addSelection",0,0,1,1),this.ITa.setCellState(0,0,h.CellStatesType.active,!0,h.SheetArea.viewport)}})},"./dist/core/worksheet/worksheet-sort.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/worksheet.js"),h=c("@grapecity/js-calc"),i=!!h,j=c("./dist/core/core.ns.js"),k=new d.Common.ResourceManager(j.SR,"Sheets"),l=k.getResource.bind(k),m=d.Common.l.Ra,n=d.Common.k,o=d.Common.j.Fa,p="boolean",q="string",r="number",s="backColor",t="fontColor",u=void 0;function v(a,b,c){for(var d=a[c-b];d<c;)d=a[d-b];return d}function w(a,b){return"object"==typeof a?JSON.stringify(a):(a=b.getColor(a),d.Common.pc.bc(d.Common.pc.ec(a)))}function x(a,b){return a instanceof Date&&b instanceof Date?m(a)===m(b):typeof a===q&&typeof b===q?a.toLowerCase()===b.toLowerCase():a===b}function y(a,b,c,d,e){var f,g,h,i=a.currentTheme();return o(b)||(g=e?b.backColor:b.foreColor,o(g)||(g=w(g,i))),o(c)||(h=e?c.backColor:c.foreColor,o(h)||(h=w(h,i))),g=g||"",h=h||"",f=g===h?0:g===d?1:h===d?-1:0}function z(a,b){var c,d,e,f,g;return a instanceof Date&&(a=m(a)),b instanceof Date&&(b=m(b)),c=typeof a,d=typeof b,e=c===q,f=d===q,g=d===r,c===d||c!==r&&!g?!(c!==p||!f)||(!e||d!==p)&&(e&&f?a.toLowerCase()>b.toLowerCase():a>b):g}function A(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,p,q,s,t,u,v,w=e,A=a,B=b;if(w)for(h=0;h<w.length&&(w[h]&&(i=w[h].ascending,j=w[h].index,0<=j&&(k=void 0,l=void 0,m=d?A:j,n=d?j:A,p=d?B:j,q=d?j:B,f?(k=f[m][n],l=f[p][q]):(k=c.getValue(m,n),l=c.getValue(p,q)),w[h].compareFunction?(g=w[h].compareFunction(k,l),i||(g*=-1)):o(w[h].color)?(u=o(k)||""===k||typeof k===r&&isNaN(k),v=o(l)||""===l||typeof l===r&&isNaN(l),u||v?u&&v?g=0:u&&!v?g=1:!u&&v&&(g=-1):g=x(k,l)?0:z(k,l)?i?1:-1:i?-1:1):(s=void 0,t=void 0,s=c.getActualStyle(m,n,3,!1,!1,!0),t=c.getActualStyle(p,q,3,!1,!1,!0),g=y(c,s,t,w[h].color,w[h].isBackColor),i||(g*=-1)))),0===g);h++);return g}function B(a,b,c,d,e){var f,g,h,i,j,k,l,m=a.length;if(m<=1)return a;for(f=Math.floor(m/2),g=a[f],h=[],i=[],j=[],k=0;k<m;k++)f!==k?(l=A(a[k],g,b,c,d,e),l<0?h.push(a[k]):l>0?i.push(a[k]):j.push(a[k])):j.push(a[k]);return B(h,b,c,d,e).concat(j,B(i,b,c,d,e))}function C(a,b,c){var d,e,f=[];if(b)for(d=c.length-1;d>=0;d--)e=c[d],0===a.getRowHeight(e)&&(c.splice(d,1),f.push({mi:d,Qb:e}));else for(d=c.length-1;d>=0;d--)e=c[d],0===a.getColumnWidth(e)&&(c.splice(d,1),f.push({mi:d,Qb:e}));return f}function D(a,b){var c,d;for(c=a.length-1;c>=0;c--)d=a[c],b.splice(d.mi,0,d.Qb)}function E(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o=f?d:e,p=f?b:c,q=[];for(j=0;j<o;j++)q[j]=p+j;for(k=h.ignoreHidden?C(a,f,q):[],l=q.concat([]),m=!1,q=B(q,a,f,g,i),n=0;n<q.length;n++)if(q[n]!==l[n]){m=!0;break}return D(k,q),{array:q,isChanged:m}}function F(a,b,c,d,e,f,g,h,i){var j,k,l,m,n=f?d:e,o=f?b:c,p=f?a.rowOutlines:a.columnOutlines,q=p.gJb(o,n),r=p.hJb(q,h.groupSort);if(!r){for(j=[],k=0;k<n;k++)j.push(o+k);r=[j]}for(k=0;k<r.length;k++)r[k]=B(r[k],a,f,g,i);return l=p.iJb(r,q,h.groupSort),m=l.array,l.isChanged&&G(a,f,l,m,q,o,n),{array:m,isChanged:l.isChanged}}function G(a,b,c,d,e,f,g){var h,i,j=b?a.rowOutlines:a.columnOutlines,k=[],l=[];if(b){for(h=f;h<f+g;h++)a.Ps(h)||a.rowOutlines&&a.rowOutlines.isCollapsed(h)||(a.getRowVisible(h,3,!0)?0===a.getRowHeight(h)&&(k.push(h),a.setRowHeight(h,a.defaults.rowHeight)):(l.push(h),a.setRowVisible(h,!0)));for(j.jJb(c.groupSwap,c.array,e.start),h=0;h<l.length;h++)i=n.Cb(d,l[h])+f,a.setRowVisible(i,!1);for(h=0;h<k.length;h++)i=n.Cb(d,k[h])+f,a.setRowHeight(i,0)}else{for(h=f;h<f+g;h++)a.columnOutlines&&a.columnOutlines.isCollapsed(h)||(a.getColumnVisible(h,3)?0===a.getColumnWidth(h)&&(k.push(h),a.setColumnWidth(h,a.defaults.colWidth)):(l.push(h),a.setColumnVisible(h,!0)));for(j.jJb(c.groupSwap,c.array,e.start),h=0;h<l.length;h++)i=n.Cb(d,l[h])+f,a.setColumnVisible(i,!1);for(h=0;h<k.length;h++)i=n.Cb(d,k[h])+f,a.setColumnWidth(i,0)}}function H(a,b,c){var d=a.qg(b,c,!1);d&&d.hasListeners()&&d.Yg()}function I(a,b,d,e){var f,g,h=c("SheetsCalc");h&&(f=h.CalcOperatorAdjustor.zj(a.xf,a.xf,a.Kf(b,d),b,d,0,0),a.Rf(b,d,f,e),g=a.qg(b,d,!!f),g&&g.og())}function J(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,r,s,t,u,w,x,y=a.ITa,z=y.Ky,A=z&&z.sV.length>0,B=f?b:c,C=f?b+d:c+e,D=f?c:b,E=f?c+e:b+d;for(w=B;w<C;w++)if(u=v(h,B,w),w!==u)for(f?(m=w,o=u):(n=w,p=u),x=D;x<E;x++)f?(n=x,p=x):(m=x,o=x),g&&(q=i[m][n],r=i[o][p]),A&&(s=z.get(m,n),t=z.get(o,p)),k&&l&&(H(k,m,n),H(k,o,p),k._f(m,n,o,p),I(k,m,n),I(k,o,p)),y.do("swapNode",m,n,o,p),a.uja&&a.wja(m,n,o,p),A&&z.qUa(s,m,n,t,o,p),g&&(i[m][n]=r,i[o][p]=q),j.push({row:m,col:n}),j.push({row:o,col:p})}function K(a,b,c,d,e,f,h,j,k,l,m){var n,o,p,q,r,s,t,v=[],w=a.ITa.WTa;if(w>0&&b&&(a.ITa.WTa=0,[].push.apply(a.ITa.zTa,[{row:c,column:d,rowCount:e,columnCount:f,byRows:h,sortInfo:j,type:"sortRange",array:l.concat([])}])),n=i&&a.Bj(),o=i&&a.yj(),J(a,c,d,e,f,h,k,l,m,v,n,o),k)for(p=c;p<c+e;p++)for(q=d;q<d+f;q++)a.setValue(p,q,m[p][q]);if(n){for(r=c;r<c+e;r++)for(s=d;s<d+f;s++)t=n.Kf(r,s),t&&n.fg(r,s,t,u);a.getCalcService().recalcRange(o,c,d,e,f)}return g.Worksheet.ao(a,"sortRangeChanged",{column:d,columnCount:f}),w>0&&(a.ITa.WTa=w),v}function L(a,b,c,d,e,f,g,h,j,k){var l,m,n,o,p,q;a.suspendPaint(),a.suspendEvent(),i&&a.suspendCalcService();try{if(k)for(m=[],n=b;n<b+d;n++)for(m[n]=[],o=c;o<c+e;o++)m[n][o]=a.getValue(n,o);return p=void 0,q=void 0,j?p=j:0===h.groupSort?(q=E(a,b,c,d,e,f,g,h,m),p=q.array):(q=F(a,b,c,d,e,f,g,h,m),p=q.array),!!p&&(l=K(a,q&&q.isChanged,b,c,d,e,f,g,k,p,m),!0)}finally{i&&a.resumeCalcService(!1),a.resumeEvent(),a.resumePaint(),a.Bu(b,c,d,e,l,4,u,u,u,!!j)}}function M(a,b){var c,d,e,f,g,h,i=[];for(c=0,d=b;c<d.length;c++)e=d[c],e.compareFunction?(f=e,i.push({index:f.index,ascending:f.ascending,compareFunction:f.compareFunction})):e.order&&e.hasOwnProperty(s)?(f=e,g="top"!==f.order,h=o(f.backColor)?"":w(f.backColor,a.currentTheme()),i.push({index:f.index,ascending:g,color:h,isBackColor:!0})):e.order&&e.hasOwnProperty(t)?(f=e,g="top"!==f.order,h=o(f.fontColor)?"":w(f.fontColor,a.currentTheme()),i.push({index:f.index,ascending:g,color:h,isBackColor:!1})):(e.color&&(e.color=w(e.color,a.currentTheme())),i.push(e));return i}e.GC$.extend(g.Worksheet.prototype,{sortRange:function(a,b,c,d,e,g,h,j,k){var m,n,o,p,q,r,s,t,u,v,w,x=this,y=x.getRowCount(),z=x.getColumnCount();if(a===-1&&(a=0),c===-1&&(c=y),b===-1&&(b=0),d===-1&&(d=z),a<0||a>=y||b<0||b>=z||c<0||a+c>y||d<0||b+d>z||!g)return!1;if(h=x.kJb(f.kf(a,b,c,d),e,h),m=e?c:d,n=e?a:b,o=e?x.rowOutlines:x.columnOutlines,!j&&h.groupSort>0){if(!o)return!1;p=o.gJb(n,m),e?(c=p.count,a=p.start):(d=p.count,b=p.start)}return i&&!x.Vq(a,b,c,d,!1)?(k&&x.Os(7,l().Exp_InvalidSortArrayFormulaInRange),!1):(q=x.ITa.getSpans(f.kf(a,b,c,d)),q&&q.length>0?(k&&x.Os(7,l().Exp_InvalidSortSpanInRange),!1):(r=x.tables,!r||(s=r.s$(a,b,c,d),t=1===s.length&&s[0].dataRange().equals(f.kf(a,b,c,d)),s.length<=0||t)?(u=x.wq,v=u&&u._dataSource||t&&s[0]&&s[0].LZ(),w=L(x,a,b,c,d,e,M(x,g),h,j,v),w&&0!==h.groupSort&&x.xr&&x.xr.reFilter(),w):(k&&x.Os(7,l().Exp_InvalidSortPartTableOrMultiTableInRange),!1)))},kJb:function(a,b,c){var d,e=this,f=e.Tq(a),g=b?f.rowCount:f.colCount,h=b?f.row:f.col,i=b?e.rowOutlines:e.columnOutlines;return o(c)&&(c={}),e.outlineColumn&&e.outlineColumn.ZQa()&&b&&(d=e.outlineColumn.YQa.columnIndex,f.col<=d&&d<=f.col+f.colCount||(c.groupSort=0)),o(c.groupSort)&&(o(c.ignoreHidden)?c.groupSort=i&&i.lJb(h,g)?1:0:c.groupSort=0),0===c.groupSort?c.ignoreHidden=!!o(c.ignoreHidden)||c.ignoreHidden:c.ignoreHidden=!1,c},hK:function(){var a=this.options;return!a.isProtected||a.protectionOptions.allowSort},wja:function(a,b,c,d){var e=this,f=e.getDataValidator(a,b),g=e.getDataValidator(c,d);e.setDataValidator(a,b,g),e.setDataValidator(c,d,f)}})},"./dist/core/worksheet/worksheet-static.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/util/common.js"),f=c("Common"),g=c("./dist/core/core.enum.js"),h=c("@grapecity/js-calc"),i=!!h,j=c("./dist/core/util/domUtil.js"),k=f.Common.j.Fa,l=j.GC$.each,m=null,n=void 0,o=Math.min,p=Math.max,q=new f.Common.ResourceManager(d.SR,"Sheets"),r=q.getResource.bind(q);function s(a,b){return a.getRowCount(b)}function t(a,b){return a.getColumnCount(b)}function u(a,b,c){return a.$r(b,c)}function v(a,b,c){return a.Yr(b,c)}function w(a,b,c,d){a.setColumnWidth(b,c,d)}function x(a,b,c,d){a.setRowHeight(b,c,d)}function y(a,b,c,d,e){return a.getActualStyle(b,c,d,n,n,n,e)}function z(a,b){return a.getDefaultStyle(b)}function A(a,b,c){a.setDefaultStyle(b,c)}function B(a,b,c,d,e){a.Pq(b,c,d,e)}function C(a,b,c,d){throw Error(f.Common.u.Kb(r().Exp_InvalidAndSpace,[a,b,c,d]))}function D(a,b,c){return b&&c.Ps&&c.Ps(a)}function E(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,p,q,u;if(!a)throw Error(r().Exp_SrcIsNull);if(!d)throw Error(r().Exp_DestIsNull);j=s(a),k=t(a),l=s(d),m=t(d),(b<-1||b>=j)&&C("from row index",b,"-1",j-1),(c<-1||c>=k)&&C("from column index",c,"-1",k-1),(e<-1||e>=l)&&C("to row index",e,"-1",l-1),(f<-1||f>=m)&&C("to column index",f,"-1",m-1),n=c,c<0&&(n=0,h=k),p=f<0?0:f,(h<1||n+h>k||p+h>m)&&C("column count",h,"1",o(k-n,m-p)),q=b,b<0&&(q=0,g=j),u=e<0?0:e,(g<1||q+g>j||u+g>l)&&C("row count",g,"1",o(j-q,l-u))}function F(a){if(!a)return a;if("number"==typeof a||"string"==typeof a||"boolean"==typeof a||k(a))return a;if(a.clone)return a.clone();if(a instanceof Date)return new Date(a.valueOf());var b,c,d;b=a instanceof Object?new a.constructor:new a.constructor(a.valueOf());for(c in a)a.hasOwnProperty(c)&&(d=a[c],a.hasOwnProperty(c)&&b[c]!==d&&("object"==typeof d?b[c]=F(d):b[c]=d));return b.toString=a.toString,b.valueOf=a.valueOf,b}function G(a,b,c,d,f,g,h,i,j){var k,l,m,o,p,q,r,s,t,u,v=a.getSpans(n,j),w=d.getSpans(n,j),x=[];if(v)for(k=0;k<v.length;k++)l=v[k],m=l.row,o=l.col,p=l.rowCount,q=l.colCount,b===-1?c<=o&&o+q<=c+i&&x.push(e.kf(m,g+o-c,p,q)):c===-1?b<=m&&m+p<=b+h&&x.push(e.kf(f+m-b,o,p,q)):b<=m&&m<b+h&&c<=o&&o<c+i&&x.push(e.kf(f+m-b,g+o-c,p,q));if(w)for(k=0;k<w.length;k++)l=w[k],m=l.row,o=l.col,r=void 0,s=o>=g&&o<g+i,t=m>=f&&m<f+h,r=b===-1?s:c===-1?t:t&&s,r&&(u=d.findSpan(m,o,j),u&&u.row===m&&u.col===o&&d.do("removeSpan",u,j));for(k=0;k<x.length;k++)d.do("addSpan",x[k],j)}function H(a,b,c,d,e,f,g,h,i,j){var k,l=a.conditionalFormats,m=d.conditionalFormats,n=W(a,d);l&&m&&!a.mJb&&(k=l.XA(b,c,m,e,f,g,h,n,j),i&&l.YA(b,c,g,h,k,n))}function I(a,b,c,d,e,f,g,h,i,j){var k,l;b<0&&(b=0,g=o(s(a),s(d))),e<0&&(e=0),c<0&&(c=0,h=o(t(a),t(d))),f<0&&(f=0),k=!(a===d&&a.name()===d.name()),k?(l=d.ZA,l&&(i?a.ZA.count()>0&&l.$A(a,b,c,e,f,g,h):l._A(a,b,c,e,f,g,h,n,j))):(l=a.ZA,l&&(i?l.count()>0&&l.aB(b,c,e,f,g,h):l.Zz(b,c,e,f,g,h,n,j)))}function J(a,b,c,d,e,f){var g,h,i;b<0&&(b=0,e=o(t(a),t(c))),d<0&&(d=0),g=a.columnOutlines,h=c.columnOutlines,i=!(a===c&&a.name()===c.name()),i?g&&h&&h.bB(g,b,d,e,f):g&&g.cB(b,d,e,f)}function K(a,b,c,d,e,f){var g,h,i;b<0&&(b=0,e=o(s(a),s(c))),d<0&&(d=0),g=!(a===c&&a.name()===c.name()),h=a.rowOutlines,i=c.rowOutlines,g?h&&i&&i.bB(h,b,d,e,f):h&&h.cB(b,d,e,f)}function L(a,b,c,d,e,f,g,h,i,j){var k=!(a===d&&a.name()===d.name()),l=a.ITa,m=l.zl(j);k?(G(l,b,c,d.ITa,e,f,g,h,j),i&&m&&l.do("clearSpan",b,c,g,h,j)):i?l.do("moveSpan",b,c,e,f,g,h,j):l.do("copySpan",b,c,e,f,g,h,j)}function M(a,b,c,d,e,f,g,h,i){var j=b,k=c;j<0&&(j=0,g=o(s(a),s(d))),e<0&&(e=0),k<0&&(k=0,h=o(t(a),t(d))),f<0&&(f=0),b<0&&L(a,-1,k,d,-1,f,-1,h,i,1),c<0&&L(a,j,-1,d,e,-1,g,-1,i,2),L(a,j,k,d,e,f,g,h,i)}function N(a,b,c,d,e,f,h,i,j){var l,p,q,r,z,A,C,D,E,F,G,H,I,J,K,L;for(b<0&&(b=0,e=o(t(a),t(c))),d<0&&(d=0),l=!i&&c.CMc(),p=1,q=[],r=0,z=0;r<e&&r<t(c,p);r++)l&&0===c.getColumnWidth(d+r)?e++:(A={},(64&f)>0&&(C=u(a,z+b),k(C)||(A.size=C,h&&w(a,r+b,a.defaults.colWidth)),D=a.getColumnVisible(z+b),k(D)||(A.visible=D,h&&a.setColumnVisible(r+b,!0)),E=y(a,-1,z+b,n,j),A.style=E,h&&B(a,-1,r+b,m),E=y(a,-1,z+b,p,j),A.headerStyle=E,h&&B(a,-1,r+b,m,p),F=a.PKJ(z+b),k(F)||(A.columnHeaderFitMode=F,h&&a.bLJ(r+b,g.ColumnHeaderFitMode.normal))),(128&f)>0&&(G=a.getTag(-1,z+b),k(G)||(A.tag=G,h&&a.setTag(-1,r+b,n))),q[z+b]=A,z++);for(r=0,z=0;r<e&&r<t(c,p);r++)l&&0===c.getColumnWidth(d+r)?e++:(A=q[z+b],(64&f)>0&&(C=A.size,k(C)||w(c,r+d,C),D=A.visible,k(D)||c.setColumnVisible(r+d,D),E=A.style,E?B(c,-1,r+d,E.clone()):B(c,-1,r+d,m),E=A.headerStyle,E?B(c,-1,r+d,E.clone(),p):B(c,-1,r+d,m,p),F=A.columnHeaderFitMode,k(F)||c.bLJ(r+d,F)),(128&f)>0&&(G=A.tag,k(G)||c.setTag(-1,r+d,G)),z++);for(H=s(c,p),I=o(s(a,p),H),J=0,K=0;J<I&&J<H;J++)l&&0===c.getRowHeight(J,p)?I++:(L=v(a,K,p),k(L)||(h&&x(a,J,a.defaults.colHeaderRowHeight,p),x(c,J,L,p)),K++)}function O(a,b,c,d,e,f,g,h,i,j){var l,p,q,r,z,A,C,E,F,G,H,I,J,K,L,M,N;for(b<0&&(b=0,e=o(s(a),s(c))),d<0&&(d=0),l=!i&&c.CMc(),p=2,q=[],r=0,z=0;r<e&&d+r<s(c,p);r++)l&&0===c.getRowHeight(d+r)?e++:h||!D(d+r,g,c)?(A={},(64&f)>0&&(C=v(a,z+b),k(C)||(A.size=C,h&&x(a,r+b,a.defaults.rowHeight)),E=a.getRowVisible(z+b),k(E)||(A.visible=E,h&&a.setRowVisible(r+b,!0)),F=y(a,z+b,-1,n,j),A.style=F,h&&B(a,r+b,-1,m),F=y(a,z+b,-1,p,j),A.headerStyle=F,h&&B(a,r+b,-1,m,p)),(128&f)>0&&(G=a.getTag(z+b,-1),k(G)||(A.tag=G,h&&a.setTag(r+b,-1,n))),q[z+b]=A,z++):z++;for(H=c.rowFilter&&c.rowFilter()&&c.rowFilter().extendedRange,r=0,z=0;r<e&&d+r<s(c,p);r++)I=d+r,l&&0===c.getRowHeight(I)?e++:h||!D(I,g,c)?(A=q[z+b],(64&f)>0&&(C=A.size,k(C)||x(c,I,C),E=A.visible,k(E)||(H&&H.intersect(I,-1,1,0)?c.filterRowsVisibleInfo.rowsVisibleInfo[I]=!!E:c.setRowVisible(I,E)),F=A.style,F?B(c,I,-1,F.clone()):B(c,I,-1,m),F=A.headerStyle,F?B(c,I,-1,F.clone(),p):B(c,I,-1,m,p)),(128&f)>0&&(G=A.tag,k(G)||c.setTag(I,-1,G)),z++):z++;for(J=t(c,p),K=o(t(a,p),J),L=0,M=0;L<K&&L<J;L++)l&&0===c.getColumnWidth(L,p)?K++:(N=u(a,M,p),k(N)||(h&&w(a,L,a.defaults.rowHeaderColWidth,p),w(c,L,N,p)),M++)}function P(a,b,c,d){var e,f,g;a===b&&a.name()===b.name()||((64&c)>0&&(e=z(a),A(b,d?e:e.clone()),e=z(a,1),A(b,d?e:e.clone(),1),e=z(a,2),A(b,d?e:e.clone(),2),d&&(A(a,m),A(a,m,1),A(a,m,2))),f=b.defaults,g=a.defaults,f.colWidth=g.colWidth,f.rowHeight=g.rowHeight,f.rowHeaderColWidth=g.rowHeaderColWidth,f.colHeaderRowHeight=g.colHeaderRowHeight,d&&(g.colWidth=62,g.rowHeight=20,g.rowHeaderColWidth=40,g.colHeaderRowHeight=20))}function Q(a,b,c,d,f,g,h,i,j,l,m,n,p){var q,r,u,v,w,x,y,z,A,B,C,E,G,H,I,J,K,L,M,N,O,P,Q=!(a===d&&a.name()===d.name()),R=!p&&d.CMc();if(2===(2&l)&&b<0)if(A=c,B=g,q=o(s(a,1),s(d,1)),r=i,c<0&&(A=0,r=t(a)),g<0&&(B=0),C=r,Q)for(u=0,y=0;u<q&&u<s(d,1);u++)if(R&&0===d.getRowHeight(u,1))q++;else{for(v=0,z=0,r=C;v<r&&v<t(d,1);v++)R&&0===d.getColumnWidth(B+v,1)?r++:(x=m(a,y,A+z,1),n(d,u,B+v,F(x),1),z++);y++}else{for(w=new e.KTa,u=0;u<q;u++)for(v=0;v<r;v++)x=m(a,u,A+v,1),k(x)||w.set(u,v,F(x));for(u=0,y=0;u<q&&u<s(d,1);u++)if(R&&0===d.getRowHeight(u,1))q++;else{for(v=0,z=0,r=C;v<r&&v<t(d,1);v++)R&&0===d.getColumnWidth(B+v,1)?r++:(n(d,u,B+v,w.get(y,z),1),z++);y++}}if(1===(1&l)&&c<0)if(E=b,G=f,q=h,r=o(t(a,2),t(d,2)),b<0&&(E=0,q=s(a)),f<0&&(G=0),C=r,Q)for(u=0,y=0;u<q&&u<s(d,2);u++)if(R&&0===d.getRowHeight(G+u,2))q++;else{for(v=0,z=0,r=C;v<r&&v<t(d,2);v++)R&&0===d.getColumnWidth(v,2)?r++:(x=m(a,E+y,z,2),n(d,G+u,v,F(x),2),z++);y++}else{for(w=new e.KTa,u=0;u<q;u++)for(v=0;v<r;v++)x=m(a,E+u,v,2),k(x)||w.set(u,v,F(x));for(u=0,y=0;u<q&&u<s(d,2);u++)if(R&&0===d.getRowHeight(G+u,2))q++;else{for(v=0,z=0,r=C;v<r&&v<t(d,2);v++)R&&0===d.getColumnWidth(v,2)?r++:(n(d,G+u,v,w.get(y,z),2),z++);y++}}if(H=b,I=c,J=f,K=g,L=h,M=i,N=s(d),O=t(d),b<0&&(H=0,L=o(s(a),N)),c<0&&(I=0,M=o(t(a),O)),f<0&&(J=0),g<0&&(K=0),P=M,Q)for(y=0,u=0;u<L&&J+u<N;u++)if(R&&0===d.getRowHeight(J+u))L++;else if(D(J+u,j,d))y++;else{for(z=0,v=0,M=P;v<M&&K+v<O;v++)R&&0===d.getColumnWidth(K+v)?M++:(x=m(a,H+y,I+z,3),n(d,J+u,K+v,F(x),3),z++);y++}else{w=new e.KTa;try{for(u=0;u<L;u++)for(v=0;v<M;v++)x=m(a,H+u,I+v,3),k(x)||w.set(u,v,F(x));for(y=0,u=0;u<L&&J+u<N;u++)if(R&&0===d.getRowHeight(J+u))L++;else if(D(J+u,j,d))y++;else{for(z=0,v=0,M=P;v<M&&K+v<O;v++)R&&0===d.getColumnWidth(K+v)?M++:(n(d,J+u,K+v,w.get(y,z),3),z++);y++}}catch(a){}}}function R(a){return[a.row,a.col].join(",")}function S(a,b,c,d,f,g,h,i,j,l,n,o,p){var q;n&&(q=e.kf(b,c,h,i)),Q(a,b,c,d,f,g,h,i,j,l,function(a,b,c,e){var f,g,h,i,j,l,p,r,t=3===e,u=a.ITa,v={};return t?(g=(n||o)&&u.getDynamicArrayInfo(b,c),g&&g.isValid?(f=m,n&&(h=R(g),v[h]||(v[h]=g,i=g.row,j=g.col,q.contains(i,j,1,1)&&u.XTa(3).EIb(g)))):f=a.getValue(b,c,e,1)):(f=u.getValue(b,c,e,!0,1),1===e&&k(f)&&d.MXJ&&(l=a.wq,l&&l._dataSource&&(p=u.Jp(!1,3,c),r=a.options.colHeaderAutoTextIndex,p&&(r>=0&&b===r||r===-1&&b===s(a,e)-1)&&(f=p.displayName||p.name)))),n&&(t?a.uq(b,c,m,e,!1):a.ITa.do("setValue",b,c,m,e,!0,!0)),f},function(a,b,c,d,e){k(d)?a.uq(b,c,m,e,!!a.I9J):a.uq(b,c,d,e,!!a.I9J)},p)}function T(a,b,c){var d,e,f,g=a.Tq(b),h=g.row,i=g.col,j=g.rowCount,k=g.colCount;for(d=0;d<j;d++)for(e=c[h+d]=c[h+d]||{},f=0;f<k;f++)e[i+f]=!0}function U(a,b,c,d,f,g,h,i,j,l,o,p,q){var r,s,t,u,v,w,x,y,z={};if(a===d&&a.tables)for(r=e.kf(b,c,h,i),s=e.kf(f,g,h,i),t=a.tables,u=t.all(),v=void 0,t.h9J&&(u=u.concat(t.h9J)),w=0,x=u.length;w<x;w++)y=u[w],v=y.XkK?y.XkK:y.range(),v.containsRange(r)&&v.containsRange(s)?T(a,r,z):v.intersect(s.row,s.col,s.rowCount,s.colCount)&&T(a,v,z);Q(a,b,c,d,f,g,h,i,j,l,function(a,b,c,d){var e=(3===d||k(d))&&z[b]&&z[b][c],f=a.getCompositeStyle(b,c,d,n,n,n,n,e,n,n,p);return o&&B(a,b,c,m,d),f},function(a,b,c,d,e){B(a,b,c,d,e)},q)}function V(a,b,c,d,e,f,g,h,i,j,k){var l,n,o,p=a.uja.Dja;for(l in p)n=p[l],n&&(o=n.condition(),o&&o.initExpression());Q(a,b,c,d,e,f,g,h,i,0,function(b,c,e){var f=b.getDataValidator(c,e,3);return f&&(j&&b.setDataValidator(c,e,m),W(a,d)&&(f.Nja=!0)),f},function(b,c,e,f){b.setDataValidator(c,e,f),W(a,d)&&f&&delete f.Nja},k)}function W(a,b){return a===b&&a.name()===b.name()}function X(a,b,c,d,e,f,g,h,i,j,k){Q(a,b,c,d,e,f,g,h,i,0,function(a,b,c){var d=a.ITa.Ky,e=d&&d.get(b,c);return e&&j&&d.remove(b,c),e},function(a,b,c,d){var e=a.ITa.Ky;e&&e.Cz(b,c,d)},k)}function Y(a,b,c,d,e,f,g,h,i,j,l,m){Q(a,b,c,d,e,f,g,h,i,j,function(a,b,c,d){var e=a.getTag(b,c,d);return!k(e)&&l&&a.setTag(b,c,n),e},function(a,b,c,e,f){d.setTag(b,c,e,f)},m)}function Z(a,b,c,d,e,f,g,h,i,j,k){var l,o,q,r,s,t,u,v,w=[],x=[],y={},z={},A=!k&&d.CMc();if(A){for(l=g,o=h,l+=d.DMc(e,l,!0),o+=d.DMc(f,o),q=d.getRowCount(),r=d.getColumnCount(),s=0,t=0;s<l&&s+e<q;s++)0!==d.getRowHeight(e+s)&&(y[t]=s,t++);for(u=0,v=0;u<o&&u+f<r;u++)0!==d.getColumnWidth(f+u)&&(z[v]=u,v++)}return Q(a,b,c,d,e,f,g,h,i,0,function(d,e,f){var g,h,i=d.getBindingPath&&d.getBindingPath(e,f);return i&&(g=e-p(0,b),h=f-p(0,c),A&&(g=y[g],h=z[h]),w.push({row:g,col:h,value:d.getValue(e,f)})),j&&a.setBindingPath&&a.setBindingPath(e,f,m),i},function(a,b,c,d){a.setBindingPath&&a.setBindingPath(b,c,n),x.push({sheet:a,r:b,c:c,value:d})},k),{savedValues:w,bindingPathInfos:x}}function $(a){a.forEach(function(a){var b=a.sheet,c=a.r,d=a.c,e=a.value;b.setBindingPath&&b.setBindingPath(c,d,e)})}function _(a,b,c,d,e,f,g,h,i,j,l,m){Q(a,b,c,d,e,f,g,h,i,j,function(a,b,c,d){var e=a.getHyperlink&&a.getHyperlink(b,c,d);return!k(e)&&l&&a.setHyperlink&&a.setHyperlink(b,c,n),e},function(a,b,c,e,f){d.setHyperlink&&d.setHyperlink(b,c,e,f)},m)}function aa(a,b,d,e,f,g,h,i){var j=c("SheetsCalc");j&&j.CalcOperatorAdjustor.moveFormula(a,b,d,e,f,g,h,i)}function ba(a,b,d,e,f,g,h,i){var j,k,m,n,o,p,q,r,s,t=c("SheetsCalc");if(t){if(j=t.uyb,n=a.ITa.dUa(),!a.parent||!a.parent.sheets)return o=a.getCustomNames(),void(o&&l(o,function(c,l){k=l.getExpression(),m=j(a,a,b,d,e,f,g,h,i,k),m!==k&&l.fg(m,n)}));for(p=a.parent.sheets,q=a.parent.getCustomNames(),q&&l(q,function(c,l){k=l.getExpression(),m=j(null,a,b,d,e,f,g,h,i,k),m!==k&&l.fg(m,n)}),r=function(c){var o=p[c].getCustomNames();o&&l(o,function(l,o){k=o.getExpression(),m=j(p[c],a,b,d,e,f,g,h,i,k),m!==k&&o.fg(m,n)})},s=0;s<p.length;s++)r(s)}}function ca(a,b,d,f,g,h,k,l,n,q,r,u,v,w){var x,y,z,A,B,C,F,G,L,Q,R,T,W,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa;if(E(a,b,d,f,g,h,k,l,u),(1&n)>0&&(2&n)>0&&(C=a.pivotTables,C&&(B=C.dB(e.kf(p(0,b),p(0,d),b<0?o(s(a),s(f)):k,d<0?o(t(a),t(f)):l),u))),u&&f.MXJ&&b<0)for(y=d,z=l,d<0&&(y=0,z=o(t(a),t(f))),F=h,h<0&&(F=0),x=!0,G=0;G<z;G++)L=a.ITa.Jp(!1,3,y+G),Q=a.ITa.Jp(!1,3,F+G),R=L&&L.name,T=Q&&Q.name,L&&Q&&R&&T||(x=!1),Q=j.GC$.extend(!0,{},f.ITa.Jp(!1,3,F+G)||{}),Q.displayName=L&&L.displayName,Q.name=L&&L.name,f.ITa.do("setItem",!1,3,F+G,Q);(64&n)>0&&(U(a,b,d,f,g,h,k,l,q,r,u,v,w),a.mJb||a.uja&&V(a,b,d,f,g,h,k,l,q,u,w)),(512&n)>0&&H(a,b,d,f,g,h,k,l,u,w),(1&n)>0&&(2&n)>0&&(ca=a.tables,ca&&(W=ca.dB(e.kf(p(0,b),p(0,d),b<0?o(s(a),s(f)):k,d<0?o(t(a),t(f)):l),u))),da=i,da&&(a.suspendCalcService(),f.suspendCalcService()),ea=[],fa=m,ga=[],(256&n)>0&&(fa=Z(a,b,d,f,g,h,k,l,q,u,w),ea=fa.savedValues,ga=fa.bindingPathInfos);try{if(ha=f.pivotTables,(1&n)>0&&(2&n)>0&&ha&&ha.eB(B,a,p(0,b),p(0,d),f,p(0,g),p(0,h),k,l,u),(1&n)>0&&!x){if(S(a,b,d,f,g,h,k,l,q,r,u,(2&n)>0,w),i&&0===(2&n)&&f.clearFormula(g,h,k,l,function(a,b){return!q||!a.Ps||!a.Ps(b)}),(256&n)>0)for($(ga),ia=ea.length,ja=g<0?0:g,ka=h<0?0:h,la=0;la<ia;la++)ma=ea[la],!u&&D(ja+ma.row,q,f)||f.setValue(ja+ma.row,ka+ma.col,ma.value)}else(256&n)>0&&$(ga);na=f.tables,(1&n)>0&&(2&n)>0&&na&&na.eB(W,p(0,b),p(0,d),p(0,g),p(0,h),u),i&&(u?(a.mJb||ba(a,b,d,f,g,h,k,l),(2&n)>0&&aa(a,b,d,f,g,h,k,l)):(2&n)>0&&(oa=c("SheetsCalc"),oa&&oa.vyb(a,b,d,f,g,h,k,l,q,w)),(1&n)>0&&(2&n)>0&&na&&na.R3(W))}finally{da&&(a.resumeCalcService(!1),f.resumeCalcService(!1))}if((4&n)>0&&X(a,b,d,f,g,h,k,l,q,u,w),(128&n)>0&&Y(a,b,d,f,g,h,k,l,q,r,u,w),(1024&n)>0&&_(a,b,d,f,g,h,k,l,q,r,u,w),(16&n)>0&&I(a,b,d,f,g,h,k,l,u,w),(8&n)>0&&(b<0&&J(a,d,f,h,l,u),d<0&&K(a,b,f,g,k,u)),(32&n)>0&&(u||1!==k||1!==l)&&M(a,b,d,f,g,h,k,l,u),b<0&&g<=0&&N(a,d,f,h,l,n,u,w,v),d<0&&h<=0&&O(a,b,f,g,k,n,q,u,w,v),b<0&&g<=0&&d<0&&h<=0&&P(a,f,n,u),u&&a.MXJ&&b<0)for(y=d,z=l,d<0&&(y=0,z=o(t(a),t(f))),G=0;G<z;G++)a.getDataColumnName&&a.getDataColumnName(y+G)&&a.ITa.do("setItem",!1,3,y+G,m)}b.staticMembers={copyTo:function(a,b,c,d,e,f,g,h,i,j,k,l){ca(a,b,c,d,e,f,g,h,i,j,k,!1,n,l)},moveTo:function(a,b,c,d,e,f,g,h,i,j){var k=3;a===d&&a.ODJ&&(k=0),ca(a,b,c,d,e,f,g,h,i,n,k,!0,j)}}},"./dist/core/worksheet/worksheet-ui.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/worksheet/worksheet.js"),e=c("./dist/core/worksheet/style.js"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),h=c("Common"),i=c("./dist/core/core.enum.js"),j=c("@grapecity/js-calc"),k=c("./dist/core/worksheet/clipboardhelper.js"),l=!!j,m=g.util.tt,n=void 0,o=null,p=h.Common.j.Fa,q=d.Worksheet.prototype;function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return parseInt(a,10)}function v(a){return Math.abs(a)}function w(a,b){var c=a,d=b;return function(a){var b,e,f=this,g=f.sheet,h=f.row,i=f.col,j=f.sheetArea;if(0===arguments.length)return c.call(g,h,i,j);if(h>=0&&i>=0)for(b=h;b<h+f.rowCount;b++)for(e=i;e<i+f.colCount;e++)x(g,b,e,j)&&d.call(g,b,e,a,j);return f}}function x(a,b,c,d){var e=a.getRowCount(d),f=a.getColumnCount(d);return c<0&&0<=b&&b<e||b<0&&0<=c&&c<f||0<=b&&b<e&&0<=c&&c<f||b===-1&&c===-1}function y(a,b,c,d,f,g){var h,i;x(a,b,c,g)&&(h=a.Aj(b,c,g),h||(h=new e.Style),"string"==typeof h&&(i=h,h=new e.Style,h.parentName=i),"font"===d&&z(a,h,f),h[d]=f,a.setStyle(b,c,h,g))}function z(a,b,c){var d,e,f,g,h;p(b.themeFont)||(d=m(),e=d.style,f=b.font,e.font=f,g=f&&e.fontFamily,e.font=c,h=c&&e.fontFamily,h!==g&&(b.themeFont=n))}r=function(){function a(a,b,c,d,e,f){var g=this;b<0&&(b=d=-1),c<0&&(c=e=-1),g.sheet=a,g.row=b,g.rowCount=p(d)?1:d,g.col=c,g.colCount=p(e)?1:e,g.sheetArea=p(f)?3:f}return a.prototype.tag=function(a){var b=this,c=b.sheet,d=b.row,e=b.col,f=b.rowCount,g=b.colCount,h=b.sheetArea,i,j;if(0===arguments.length)return c.getTag(d,e,h);if(d>=0&&e>=0)for(i=d;i<d+f;i++)for(j=e;j<e+g;j++)c.setTag(i,j,a,h);else if(d>=0)for(i=d;i<d+f;i++)c.setTag(i,-1,a,h);else if(e>=0)for(j=e;j<e+g;j++)c.setTag(-1,j,a,h);return b},a.prototype.width=function(a){var b,c=this,d=c.sheet,e=c.row,f=c.col,g=c.sheetArea;if(0!==arguments.length){if(e<0)for(b=0;b<c.colCount;b++)d.setColumnWidth(b+f,a,g);return c}if(e<0)return d.getColumnWidth(f,g)},a.prototype.height=function(a){var b,c=this,d=c.sheet,e=c.row,f=c.col,g=c.sheetArea;if(0!==arguments.length){if(f<0)for(b=0;b<c.rowCount;b++)d.setRowHeight(b+e,a,g);return c}if(f<0)return d.getRowHeight(e,g)},a.prototype.visible=function(a){var b,c,d=this,e=d.sheet,f=d.row,g=d.col,h=d.sheetArea;if(0!==arguments.length){if(g<0&&f>=0)for(b=0;b<d.rowCount;b++)e.setRowVisible(b+f,a,h);else if(g>=0&&f<0)for(c=0;c<d.colCount;c++)e.setColumnVisible(c+g,a,h);return d}return g<0&&f>=0?e.getRowVisible(f,h):g>=0&&f<0?e.getColumnVisible(g,h):void 0},a.prototype.resizable=function(a){var b,c,d=this,e=d.sheet,f=d.row,g=d.col,h=d.sheetArea;if(0!==arguments.length){if(g<0&&f>=0)for(b=0;b<d.rowCount;b++)e.setRowResizable(b+f,a,h);else if(g>=0&&f<0)for(c=0;c<d.colCount;c++)e.setColumnResizable(c+g,a,h);return d}return g<0&&f>=0?e.getRowResizable(f,h):g>=0&&f<0?e.getColumnResizable(g,h):void 0},a.prototype.tq=function(a){var b=this;return b.sheet.tq(b.row,b.col,a,b.sheetArea)},a.prototype._w=function(a,b){var c=this,d=c.sheet,e=c.sheetArea;return c.NGa(function(c,f){y(d,c,f,a,b,e)}),c},a.prototype.NGa=function(a){var b,c,d=this,e=d.sheet,f=d.row+d.rowCount,g=d.col+d.colCount;if(e.suspendPaint(),d.row>=0&&d.col>=0)for(b=d.row;b<f;b++)for(c=d.col;c<g;c++)a.call(d,b,c);else if(d.row>=0)for(b=d.row;b<f;b++)a.call(d,b,-1);else if(d.col>=0)for(c=d.col;c<g;c++)a.call(d,-1,c);else d.row===-1&&d.col===-1&&d.rowCount===-1&&d.colCount===-1&&a.call(d,-1,-1);e.resumePaint()},a.prototype.setStyleName=function(a){var b=this;b.NGa(function(c,d){b.sheet.setStyleName(c,d,a)})},a.prototype.setStyle=function(a){var b=this;b.NGa(function(c,d){b.sheet.setStyle(c,d,a.clone())})},a.prototype.clear=function(a){var b=this;b.sheet.clear(b.row,b.col,b.rowCount,b.colCount,b.sheetArea,a)},a.prototype.setBorder=function(a,b){var c,d,e,f,h,i,j,k,l,m,n,o=this,p=o.sheet,q=o.sheetArea;p.suspendPaint();try{if(c=new g.Range(o.row,o.col,o.rowCount,o.colCount),d=p.Tq(c,q),e=d.row,f=d.col,h=d.rowCount,i=d.colCount,j=void 0,k=void 0,l=b.all,m=b.outline,n=b.inside,b.left||l||m)for(j=0;j<h;j++)p.getCell(e+j,f,q).borderLeft(a);if(b.top||l||m)for(k=0;k<i;k++)p.getCell(e,f+k,q).borderTop(a);if(b.right||l||m)for(j=0;j<h;j++)p.getCell(e+j,f+i-1,q).borderRight(a);if(b.bottom||l||m)for(k=0;k<i;k++)p.getCell(e+h-1,f+k,q).borderBottom(a);if(b.diagonalUp)for(j=0;j<h;j++)for(k=0;k<i;k++)p.getCell(e+j,f+k,q).diagonalUp(a);if(b.diagonalDown)for(j=0;j<h;j++)for(k=0;k<i;k++)p.getCell(e+j,f+k,q).diagonalDown(a);if(b.innerHorizontal||l||n)for(j=0;j<h-1;j++)for(k=0;k<i;k++)p.getCell(e+j,f+k,q).borderBottom(a),p.getCell(e+j+1,f+k,q).borderTop(a);if(b.innerVertical||l||n)for(k=0;k<i-1;k++)for(j=0;j<h;j++)p.getCell(e+j,f+k,q).borderRight(a),p.getCell(e+j,f+k+1,q).borderLeft(a)}finally{p.resumePaint()}},a.prototype.toHtml=function(a,b){void 0===a&&(a=i.HeaderOptions.noHeaders),void 0===b&&(b=!0);var c=this;return c.sheetArea===i.SheetArea.corner?"":k.S4.Q4(c.sheet,a,c.row,c.rowCount,c.col,c.colCount,c.sheetArea,b,[],[],!0,!0,b,!0)},a.Pl=w,a}(),b.CellRange=r,r.prototype.value=w(q.getValue,q.setValue),r.prototype.text=w(q.getText,q.setText),r.prototype.Yw=w(function(a,b){return l&&this.getFormula(a,b)},function(a,b,c,d){l&&this.setFormula(a,b,c,d)}),r.prototype.formula=function(a,b){return b?void(l&&this.sheet.P5J(this.row,this.col,this.rowCount,this.colCount,a)):0===arguments.length?this.Yw():this.Yw(a)},r.prototype.styleName=w(q.getStyleName,q.setStyleName),f.GC$.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp","locked","textIndent","wordWrap","showEllipsis","shrinkToFit","backgroundImage","backgroundImageLayout","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions","quotePrefix","isVerticalText","cellButtons","dropDowns","textOrientation"],function(a,b){
r.prototype[b]=function(a){return 0===arguments.length?this.tq(b):this._w(b,a)}});function A(a){return a=a.replace(/[^\:]+\!/g,""),a=a.replace(/\$/g,"")}function B(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,p,q,r=a.split(":"),s=r[0],t=r[1],u=/([A-Z]+)(\d+)?(\D+)?/;if(isNaN(+s)){if(d=s.match(u),e=d[3])return o;b=d[1],c=d[2]}else c=s;if(s&&!t){if(b&&c)return f=C(c),g=D(b),[f,g,1,1]}else if(s&&t){if(h=void 0,i=void 0,isNaN(+t)){if(j=t.match(u),e=j[3])return o;h=j[1],i=j[2]}else i=t;if(!b&&c&&!h&&i)return k=C(c),l=C(i),f=Math.min(k,l),m=v(k-l)+1,[f,-1,m,-1];if(b&&!c&&h&&!i)return n=D(b),p=D(h),g=Math.min(n,p),q=v(n-p)+1,[-1,g,-1,q];if(b&&c&&h&&i)return k=C(c),l=C(i),n=D(b),p=D(h),f=Math.min(k,l),m=v(k-l)+1,g=Math.min(n,p),q=v(n-p)+1,[f,g,m,q]}return o}b.xCc=B;function C(a){return u(a)-1}function D(a){var b,c,d=64,e=26,f=0,g=a.length;for(b=0;b<g;b++)c=a[b].charCodeAt(0)-d,f+=Math.pow(e,g-b-1)*c;return f-1}b.yCc=D,f.GC$.extend(q,{getRange:function(){var a,b,d,e,f,g,h,i,j,k,m=arguments[0];if(t(m)){if(g=m.toUpperCase(),h=this.parent&&1===this.parent.options.referenceStyle)return o;if(f=arguments[1],g=A(g),g.split(",").length>1)return o;if(l){if(i=c("SheetsCalc"),j=i.formulaToRange(this,g,n,n,f),!j)return o;a=j.row,b=j.col,d=j.rowCount,e=j.colCount}else{if(k=B(g),!k)return o;a=k[0],b=k[1],d=k[2],e=k[3]}}else s(m)&&(a=m,b=arguments[1],d=arguments[2],e=arguments[3],f=arguments[4]);return new r(this,a,b,d,e,f)},getCell:function(a,b,c){return p(b)&&(b=-1),new r(this,a,b,1,1,c)}})},"./dist/core/worksheet/worksheet.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/util/common.js"),f=c("./dist/core/util/imageLoader.js"),g=c("./dist/core/util/tasks.js"),h=c("./dist/core/worksheet/style.js"),i=c("./dist/core/worksheet/worksheet-model.js"),j=c("./dist/core/util/domUtil.js"),k=c("./dist/core/celltype/textcelltype.js"),l=c("./dist/core/celltype/headercelltype.js"),m=c("./dist/core/core.enum.js"),n=c("Common"),o=c("@grapecity/js-calc"),p=!!o,r=c("./dist/core/util/theme.js"),s=c("./dist/core/worksheet/stylehelper.js"),t=e.util.n0a,u=e.util.lHb,v=n.Common.j.Fa,w=e.util.Nl,x=e.util.Pl,y=e.util.Ql,z=e.util.bq,A=j.GC$.each,B=j.GC$.isEmptyObject,C=n.Common.D,D=e.util.x0a,E=e.util.w0a,F=RegExp("^\\d*(\\.\\d+)?\\*$"),G=n.Common.u,H=document,I=parseInt,J=parseFloat,K=isNaN,L=null,M=void 0,N=Math.min,O=Math.max,P=Math.floor,Q=Math.ceil,R=Math.abs,S=Math.round,T="undefined",U="string",V="width",W="height",X="black",Y="tag",Z="onLayoutChanged",$="beforeLayoutChanged",_="onPaintSuspend",aa="isVisible",ba="starSize",ca="resizable",da=".gcSheet",ea=".gcSheetInternal",fa="columnHeaderFitMode",b.MAX_ROW_COUNT=1048576,b.MAX_COLUMN_COUNT=16384,ga={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0,cellType:!0,formatter:!0},ha=new n.Common.ResourceManager(d.SR,"Sheets"),ia=ha.getResource.bind(ha),ja=e.UsedRangeUtil.SZJ;function pa(a,b){var c,d,e,f,g,h=[],i=a.ITa.hUa();if(i)for(c in i)if(C(i,c)&&(d=i[c],d&&(b||"n"!==d.rs||(e={row:+c,item:a.getDataItem&&a.getDataItem(+c)},h.push(e)),b&&"e"===d.rs)))for(f in d)if(!K(f)&&(g=d[f])){e={row:+c,item:a.getDataItem&&a.getDataItem(+c)},e.originalItem=d.originalItem,h.push(e);break}return h}function qa(a,b,c,d){var e,f=0;for(e=b;e<=c;e++)f+=a._m(e,d);return f}function ra(a,b,c,d){var e,f=0;for(e=b;e<=c;e++)f+=a.Sl(e,d);return f}function sa(a,b){return a.getColumnCount(b)}function ta(a,b){return a.getRowCount(b)}function ua(a){return a.frozenTrailingColumnCount()}function va(a){return a.frozenTrailingRowCount()}function wa(a){return a.BBJ}function xa(a){return a.CBJ}function ya(a){return a.frozenColumnCount()}function za(a){return a.frozenRowCount()}function Aa(a,b){var c=e.util.Pxb(a.font),d=e.util.Pxb(b.font);return c.fontStyle+" "+c.fontWeight+" "+d.fontSize+" "+d.fontFamily}function Ba(a,b,c){Object.defineProperty(a,b,{get:function(){return this["_"+b]},set:function(a){var d=this["_"+b];d!==a&&(this["_"+b]=a,c&&c(b,a,d))}})}!function(a){a[a.dirty=1]="dirty",a[a.insert=2]="insert",a[a.delete=4]="delete"}(ka=b.ClearPendingChangeType||(b.ClearPendingChangeType={}));function Ca(a,b,c,d){return{row:b,col:c,newValue:a.getValue(b,c),oldValue:d}}!function(a){a[a.setFormula=0]="setFormula",a[a.copyPaste=1]="copyPaste",a[a.dragFill=2]="dragFill",a[a.dragDrop=3]="dragDrop",a[a.changePartOfArrayFormula=4]="changePartOfArrayFormula",a[a.changeSheetName=5]="changeSheetName",a[a.table=6]="table",a[a.hideSheet=7]="hideSheet",a[a.pivotTable=8]="pivotTable",a[a.PTOverlapPT=9]="PTOverlapPT"}(la=b.InvalidType||(b.InvalidType={})),ma={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:X,rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:L,selectionBackColor:L,selectionBorderColor:L,allowCellOverflow:!0,showFormulas:!1,isProtected:!1,protectionOptions:{},gridline:{},reversalTrailingResizeOrder:!1,keepUnknownFormulas:!1,sheetAreaOffset:{left:0,top:0}};function Da(a){var b,c,d,e;if(a)for(b=a.sheets,c=b.length,e=0;e<c;e++)d=b[e],d.jCJ===!0&&delete d.jCJ}function Ea(a){return a===!1}function Fa(a){if(B(a))return!0;for(var b in a)if(!v(a[b])&&!B(a[b]))return!1;return!0}na=function(){function a(b){var c=this;c._id=a.Np,a.Np++,c.options=y(ma,function(a,b,d){c.Op(a,b,d)}),c.ad(b),c.Xgc=new g.Tasks(function(){return this.tasks.pop()},function(){var a=c.parent;return a&&a.ku.Gw||c.mm.OG||c.mm.xG||c.mm.eG})}return a.prototype.sortRange=function(a,b,c,d,e,f,g,h,i){return!1},a.prototype.Op=function(b,c,d){var e,f,g,h,i=this,j=i.parent;switch(b){case"allowCellOverflow":case"showFormulas":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":case"reversalTrailingResizeOrder":i.$p();break;case"sheetAreaOffset":e=function(a,b){b<0&&(i.options.sheetAreaOffset[a]=0),i.$p()},f=i.options.sheetAreaOffset,["left","top"].forEach(function(a){var b=c[a];Ba(f,a,e),f[a]=b});break;case"gridline":g=function(){i.$p()},h=i.options.gridline,["color","showHorizontalGridline","showVerticalGridline"].forEach(function(a){var b=c[a];Ba(h,a,g),h[a]=b});break;case"isProtected":c&&j&&j.undoManager().PY(function(a){return a.sheetId!==i._id}),i._p(),a.ao(i,"onProtectChanged"),i.$p();break;case"protectionOptions":i._p(),a.ao(i,"onProtectChanged");break;case"sheetTabColor":j&&j.aq();break;case"keepUnknownFormulas":i.options.keepUnknownFormulas=c}},a.prototype.getUsedRange=function(b){var c,d,f,g,h,i,j;return v(b)?L:(c=this,d=c.ITa,f=d.getUsedRange(b)||{},g=c.getRowCount(),h=c.getColumnCount(),b&m.UsedRangeType.formula&&p&&(i=c.Bj(),j=i.usedRange,v(j)||ja(f,j.getUsedRange())),ja(f,c.rowOutlines.getUsedRange(b)),ja(f,c.columnOutlines.getUsedRange(b)),a.ao(c,"getUsedRange",{type:b,range:f}),f&&Object.keys(f).length>0?(f.minRow<0&&(f.minRow=0,f.maxRow=g-1),f.minCol<0&&(f.minCol=0,f.maxCol=h-1),f.maxRow>g&&(f.maxRow=g-1),f.maxCol>h&&(f.maxCol=h-1),new e.Range(f.minRow,f.minCol,f.maxRow-f.minRow+1,f.maxCol-f.minCol+1)):L)},a.prototype.name=function(a){var b=this,c=b.parent;if(0===arguments.length)return b.ITa?b.ITa.getName():"";if(!z(a,c?c.sheets:null,b))throw ia().Exp_NotSupported;return b.cq(a),c&&c.aq(),b},a.prototype.isSelected=function(a){return this.HHb(a)},a.prototype.HHb=function(a,b){var c,d,f,g=this,h=g.parent,i=!!g.ITa&&g.ITa.XIb();return v(a)?i:(a!==i&&(c=g.name(),d=h&&h.getSheetIndex(c),f=void 0,b&&(f={oldValue:i,newValue:a,sheetName:c,propertyName:"isSelected",cancel:!1,sheetIndex:d},h&&h.Wq(e.Events.SheetChanging,f)),(!b||f&&f.cancel===!1)&&(g.ITa.GHb(a),h&&h.MJc&&h.MJc.repaint(),b&&h&&h.Wq(e.Events.SheetChanged,{oldValue:i,newValue:a,sheetName:c,propertyName:"isSelected",sheetIndex:d}))),g)},a.prototype.cq=function(b,c){var d=this,e=d.name();c||a.ao(d,"beforeSetName",{oldName:e,newName:b}),this.ITa.do("setName",b),c||a.ao(d,"setName",{oldName:e,newName:b})},a.prototype.addRows=function(b,c,d){var e,f,g,h;if(!(c<=0)){e=this,f=ta(e),(b<0||b>f)&&(b=f),e.suspendPaint();try{if(g="addRows",!e.pCb(b,3,g,c,f))return;if(0===e.ITa.WTa&&e.parent&&e.parent.pv.clear(),e.nJb(!1),h={changeType:"addingRows",row:b,rowCount:c,canAdd:!0},a.ao(e,Z,h),!h.canAdd)return;v(h.newRow)||(b=h.newRow),this.ITa.do("addRows",b,c),e.jq=!0,a.ao(e,Z,{changeType:g,row:b,oldValue:f,rowCount:c,rowExpand:d}),a.ao(e,Z,{changeType:"addRows2",row:b,oldValue:f,rowCount:c}),e.tables&&e.tables.LNb(!0,b),e.kq(b,3,g,c,f)}finally{e.nJb(!0),e.resumePaint()}}},a.prototype.nJb=function(a){var b=this,c=b.Jl,d=b.Kl;b.ITa.setCellState(c,d,m.CellStatesType.active,a,m.SheetArea.viewport)},a.prototype.deleteRows=function(b,c){var d,e,f,g,h,i,j,k=this,l=ta(k);if(!(0>b||b>=l||c<=0)){k.suspendPaint();try{if(d="deleteRows",!k.pCb(b,3,d,c,l))return;if(0===k.ITa.WTa&&k.parent&&k.parent.pv.clear(),k.nJb(!1),e={changeType:"deletingRows",row:b,rowCount:c,canDelete:!0},a.ao(k,Z,e),!e.canDelete)return;if(k.Acc(b,c,0,this.getColumnCount()),k.ITa.do("deleteRows",b,c),f=k.lq,f>=0){for(g=-1,h=za(k),i=f;i>=h;i--)if(k.getRowVisible(i)&&k.Sl(i)>0){g=i;break}g===-1&&(g=0),f!==g&&k.mq(g)}j=ta(k),k.getActiveRowIndex()>=j&&k.setActiveCell(j-1,k.getActiveColumnIndex()),k.jq=!0,a.ao(k,Z,{changeType:d,row:b,oldValue:l,rowCount:c}),k.tables&&k.tables.LNb(!0,b),k.kq(b,3,d,c,l)}finally{k.nJb(!0),k.resumePaint()}}},a.prototype.addColumns=function(b,c){var d,e,f,g;c<=0||(d=this,e=sa(d),(b<0||b>e)&&(b=e),f="addColumns",d.qCb(b,3,f,c,e)&&(0===d.ITa.WTa&&d.parent&&d.parent.pv.clear(),g={changeType:"addingColumns",col:b,colCount:c,canAdd:!0},a.ao(d,Z,g),g.canAdd&&(d.nJb(!1),d.ITa.do("addColumns",b,c),d.oq=!0,a.ao(d,Z,{changeType:f,col:b,oldValue:e,colCount:c}),a.ao(d,Z,{changeType:"addColumns2",col:b,oldValue:e,colCount:c}),d.tables&&d.tables.LNb(!1,b),d.pq(b,3,f,c,e),d.nJb(!0),d.$p())))},a.prototype.deleteColumns=function(b,c){var d,e,f,g,h,i,j,k=this,l=sa(k);if(!(0>b||b>=l||c<=0)&&(d="deleteColumns",k.qCb(b,3,d,c,l)&&(0===k.ITa.WTa&&k.parent&&k.parent.pv.clear(),e={changeType:"deletingColumns",col:b,colCount:c,canDelete:!0},a.ao(k,Z,e),e.canDelete))){if(k.nJb(!1),k.Acc(0,this.getRowCount(),b,c),k.ITa.do("deleteColumns",b,c),f=k.qq,f>=0){for(g=-1,h=ya(k),i=f;i>=h;i--)if(k.getColumnVisible(i)&&k.Tl(i)>0){g=i;break}g===-1&&(g=0),f!==g&&k.rq(g)}j=sa(k),k.getActiveColumnIndex()>=j&&k.setActiveCell(k.getActiveRowIndex(),j-1),k.oq=!0,a.ao(k,Z,{changeType:d,col:b,oldValue:l,colCount:c}),a.ao(k,Z,{changeType:"deleteColumns2",col:b,oldValue:l,colCount:c}),k.tables&&k.tables.LNb(!1,b),k.pq(b,3,d,c,l),k.nJb(!0),k.$p()}},a.prototype.frozenTrailingRowCount=function(a,b){var c=this;return 0===arguments.length?c.BNc:(a>=0&&(v(b)&&(b=!0),c.BNc=a,c.BBJ=b,c.jq=!0,c.$p()),c)},a.prototype.frozenTrailingColumnCount=function(a,b){var c=this;return 0===arguments.length?c.CNc:(a>=0&&(v(b)&&(b=!0),c.CNc=a,c.CBJ=b,c.oq=!0,c.$p()),c)},a.prototype.getFrozenTrailingState=function(a){var b=this;return a?b.BBJ:b.CBJ},a.prototype.wNc=function(a){var b=xa(this),c=a.er;return b?c+a.xNc:c},a.prototype.tNc=function(a){var b=wa(this),c=a.jr;return b?c+a.uNc:c},a.prototype.getRowCount=function(a){return 0===a?0:this.ITa.getRowCount(a)},a.prototype.getColumnCount=function(a){return 0===a?0:this.ITa.getColumnCount(a)},a.prototype.setRowCount=function(b,c){var d,e;v(c)&&(c=3),d=this,e={changeType:"settingRowCount",rowCount:b,sheetArea:c,canSet:!0},a.ao(d,Z,e),e.canSet&&d.setRowCountCore(b,c)},a.prototype.setRowCountCore=function(b,c){var d,e;b=I(b,10),K(b)||(v(c)&&(c=3),d=this,e=d.getRowCount(c),b<0||b===e||(3===c||2===c?(d.ITa.do("setRowCount",b,c),za(d)>b&&d.frozenRowCount(b)):1===c&&d.ITa.do("setRowCount",b,c),a.ao(d,Z,{changeType:"setRowCount",row:e,rowCount:b,sheetArea:c}),d.jq=!0,d.Jl>=b&&(3===c||2===c)&&d.setActiveCell(b-1,d.getActiveColumnIndex()),d.$p(),d.clearPendingChanges()))},a.prototype.setColumnCount=function(b,c){var d,e;b=I(b,10),K(b)||(d=this,e=d.getColumnCount(c),b<0||b===e||(v(c)&&(c=3),3===c||1===c?(d.ITa.do("setColumnCount",b,c),ya(d)>b&&d.frozenColumnCount(b)):2===c&&d.ITa.do("setColumnCount",b,c),a.ao(d,Z,{changeType:"setColumnCount",row:e,colCount:b,sheetArea:c}),d.oq=!0,d.Kl>=b&&(3===c||1===c)&&d.setActiveCell(d.getActiveRowIndex(),b-1),d.$p(),d.clearPendingChanges()))},a.prototype.getFreeAreaRowCount=function(a){var b=this.ITa;return b.getFreeAreaRowCount(a)},a.prototype.getFreeAreaColumnCount=function(a){var b=this.ITa;return b.getFreeAreaColumnCount(a)},a.prototype.setFreeAreaRowCount=function(a,b){var c=this.ITa;c.setFreeAreaRowCount(a,b)},a.prototype.setFreeAreaColumnCount=function(a,b){var c=this.ITa;c.setFreeAreaColumnCount(a,b)},a.prototype.yWJ=function(a){var b,c,d,e,f;if(!v(a)&&(b=a.rows,d=!1,this.filterRowsVisibleInfo)){if(e=this.filterRowsVisibleInfo.rowsVisibleInfo||{},b&&b.length>0)for(f=0;f<b.length;f++)c=b[f],c&&c.isFilter&&(c.visible=!0,delete c.isFilter,e[f]=!1,d=!0);d&&(this.filterRowsVisibleInfo.rowsVisibleInfo=e,this.filterRowsVisibleInfo.empty=!1)}},a.prototype.aHb=function(a,b,d){var e=this;return q||(q=c("SheetsCalc")),q?e.C4J(a,b,d):M},a.prototype.xHb=function(a,b,c){var d,e,f=this;if(f.options.showFormulas&&3===c){if(d=f.getFormula(a,b,3,!0))return"="!==d[0]&&(d="="+d),d;if(e=f.ITa&&f.ITa.bIb&&f.ITa.bIb.getAnchorInfo(a,b))return""}},a.prototype.getText=function(a,b,c){var d,e,f;return v(c)&&(c=3),d=this,e=d.xHb(a,b,c),v(e)?(f=d.getValue(a,b,c),d.dNJ(a,b,f,c,!0)):e},a.prototype.setText=function(b,c,d,e){var f,g,h,i,j,k,l=this;v(e)&&(e=3),f=d,g={value:d},a.ao(l,"settingText",g),d=g.value,h=d,i=l.getCellType(b,c,e),j=l.getFormatter&&l.getFormatter(b,c,e),i&&j&&!u(j)&&(k={sheet:l,row:b,col:c,sheetArea:e},h=i.parse(f,j,k),h=v(h)?d:h),l.uq(b,c,h,e),l.$p()},a.prototype.getValue=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q;return 0===c?L:(v(c)&&(c=3),f=this,g=f.options,h=f.ITa,i=h.getRowCount(c),j=h.getColumnCount(c),k=f.vq(h,a,b,c,d),1===c?v(k)&&(m=f.wq,m&&m._dataSource&&(n=f.ITa.Jp(!1,3,b),o=g.colHeaderAutoTextIndex,n&&(o>=0&&a===o||o===-1&&a===i-1)&&(k=n.displayName||n.name)),v(k)&&(l=g.colHeaderAutoTextIndex,(l<0||l>=i)&&(l=i-1),a===l&&(p=g.colHeaderAutoText,2===p?k=e.util.xq(b+1):1===p&&(k=b+1)))):2===c&&v(k)&&(l=g.rowHeaderAutoTextIndex,(l<0||l>=j)&&(l=j-1),b===l&&(q=g.rowHeaderAutoText,2===q?k=e.util.xq(a+1):1===q&&(k=a+1))),k)},a.prototype.setValue=function(a,b,c,d,e){this.uq(a,b,c,d,e);var f=this.parent,g=f&&f.getActiveSheet();g&&g.jCJ===!0?g.$p():this.$p(),Da(f)},a.prototype.eyb=function(a,b,c,d){var e=this;!d&&p&&e.zq(a,b,c),e.t4&&e.t4(a,b,1,1,c)},a.prototype.fyb=function(){var a=this.conditionalFormats;a&&a.Nm()},a.prototype.aPJ=function(a,b,c){if(a&&a.parent&&a.parent.sheets){var d=a.parent.sheets,e=a._id;d.forEach(function(a){var d=a.cameraShapes;d&&d.length>0&&d.forEach(function(d){var f,g,h,i;if(d.cameraImageCache&&(f=d.Fmb,g=f.znb.nJJ,g&&(a._id===e||g.sheet&&g.sheet._id===e)))for(h=0;h<b.length;h++){if(i=g.cellRange,void 0!==b[h].row&&void 0===b[h].col&&2===c&&b[h].row>=i.row&&b[h].row<i.row+i.rowCount){d.cameraImageCache=null,f.znb.oJJ&&f.qnb();break}if(void 0===b[h].row&&void 0!==b[h].col&&1===c&&b[h].col>=i.col&&b[h].col<i.col+i.colCount){d.cameraImageCache=null,f.znb.oJJ&&f.qnb();break}if(0===c){if(void 0===b[h].rowCount&&void 0===b[h].colCount&&i.contains(b[h].row,b[h].col)){d.cameraImageCache=null;break}if(void 0!==b[h].rowCount&&void 0!==b[h].colCount&&i.intersect(b[h].row,b[h].col,b[h].rowCount,b[h].colCount)){d.cameraImageCache=null;break}}}})})}},a.prototype.uq=function(a,b,c,d,e){var f,g,h,i;0!==d&&(v(d)&&(d=3),f=this,g=f.ITa,h=g.getRowCount(d),i=g.getColumnCount(d),a<0||a>=h||b<0||b>=i||(c=D(c),c=t(c),g.do("setValue",a,b,c,d),f.eyb(a,b,d,e),f.fyb()))},a.prototype.AHb=function(a,b,c,d,e,f){var g=this,h;return h=g.getActualStyle(a,b,c,d,e,f),Ga(g,a,b,h,c),h},a.prototype.getActualStyle=function(a,b,c,d,f,g,i){var j,k,l,m,o,p,q,r,s,t,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,N,O,P,Q;if(v(c)&&(c=3),0===c)return new h.Style;if(a===-1&&b===-1)return this.getDefaultStyle(c);if(j=this,q=j.Cq,B="__spreadJSDefault",C="__undefined",D=this.ITa,3===c&&j.pivotTables&&(E=j.pivotTables.findPivotTable(a,b)||L,F=E&&E.WNc(a,b)),m=D.getStyle(a,b,c),o=D.getStyle(a,-1,c),p=D.getStyle(-1,b,c),m=m?m:L,o=o?o:L,p=p?p:L,i&&(a===-1&&(o=L),b===-1&&(p=L)),y=C,G=j.parent&&j.parent.GBb,m&&(y=m.charAt?m:B+m._id),z=C,o&&(z=o.charAt?o:B+o._id),A=C,p&&(A=p.charAt?p:B+p._id),x=q[c],r=x[y],H=j.tables,I=3===c&&H&&!g?H.find(a,b):L,I||E||j.ODJ||(r||(r=x[y]={}),t=r[z],t?w=t[A]:t=r[z]={}),w||(l=j.getCompositeStyle(a,b,c,m,o,p,I,M,g,F,i,E)),(3===c||a<j.getFreeAreaRowCount(c))&&!d&&(J=j.conditionalFormats,J&&(k=J.Eq(k,a,b,c))),(3===c||a<j.getFreeAreaRowCount(c))&&!d&&(v(k)||v(k.foreColor))&&(K=k&&k.formatter||w&&w.formatter||l&&l.formatter,K&&!g&&!u(K))){try{N=n.Formatter&&n.Formatter.GeneralFormatter,N&&typeof K===U&&(K=e.mn.tn(K))}catch(a){}(K.hasFormattedColor&&K.hasFormattedColor()||n.Formatter&&K instanceof n.Formatter.FormatterBase)&&(O={conditionalForeColor:L},K.format(j.getValue(a,b,c),O),O.conditionalForeColor&&(v(k)&&(k=new h.Style),k.foreColor=O.conditionalForeColor))}if(k)s=w?w:l,k.Yo(s),k.font&&s&&s.font&&k.font!==s.font&&(k.font=Aa(k,s)),l=k;else if(w)return!j.cellStates||d||G||(P=j.cellStates.getStyle(a,b,c,L,w.locked),P&&(P.Yo(w),w=P,w.Zo(j.Pm))),f?w:w.clone(!0);return i||(v(l.locked)&&(l.locked=!0),l=l.Zo(j.Pm)),k||I||E||j.ODJ||(t[A]=l.clone(!0)),!j.cellStates||d||G||(Q=j.cellStates.getStyle(a,b,c,L,l.locked),Q&&(Q.Yo(l),l=Q,l=l.Zo(j.Pm))),l},a.prototype.tq=function(a,b,c,d){var f,g,i,j,k,l,m,o,p,q,r,s,t,u,w,x;if(0===d)return M;if(v(d)&&(d=3),f=this,k=f.ITa,m=!1,3===d){if("foreColor"===c){p=f.tq(a,b,"formatter",d);try{q=n.Formatter&&n.Formatter.GeneralFormatter,q&&typeof p===U&&(p=e.mn.tn(p))}catch(a){}p&&(p.hasFormattedColor&&p.hasFormattedColor()||n.Formatter&&p instanceof n.Formatter.FormatterBase)&&(r={conditionalForeColor:L},p.format(f.getValue(a,b),r),r.conditionalForeColor&&(l=r.conditionalForeColor,m=!0))}s=f.conditionalFormats,s&&s.count()>0&&(t=s.Fq(a,b,c,d),m=t.v5,l=t.Fi)}for(u=0;!m&&u<=4;)if(0===u?g=k.getStyle(a,b,d):1===u?(w=f.tables,x=3===d&&w?w.find(a,b):L,x&&ga[c]&&(g=x.Gq(a,b,c))):g=2===u?k.getStyle(a,-1,d):3===u?k.getStyle(-1,b,d):f.getDefaultStyle(d),u++,g&&g.charAt&&typeof g===U&&(g=f.Hq(g)),g){if("font"===c&&g.themeFont&&!o&&(o=g.themeFont),g[c]!==M){l=g[c],m=!0;break}for(i=g.parentName;i&&(j=f.Hq(i));){if(j[c]!==M){l=j[c],m=!0;break}i=j.parentName}}return"locked"===c?!!v(l)||l:m||o?("foreColor"!==c&&"backColor"!==c&&"font"!==c&&"borderLeft"!==c&&"borderTop"!==c&&"borderRight"!==c&&"borderBottom"!==c||(g=new h.Style,g[c]=l,"font"===c&&o&&(g.themeFont=o),g.Zo(f.Pm),l=g[c]),l):M},a.prototype.getStyle=function(a,b,c){return this.Iq(a,b,c,!0)},a.prototype.Iq=function(a,b,c,d){var e,f,g,i;if(v(c)&&(c=3),0!==c){if(e=this.ITa,f=e.getStyle(a,b,c),f instanceof h.Style)return d&&this.Jq(),f;if(typeof f===U&&(g=this.Hq(f),g!==L&&g!==M))return i=new h.Style,i.Yo(g,!1),d&&this.Jq(),i}return L},a.prototype.addNamedStyle=function(a){this.Kq(a),this.$p()},a.prototype.Kq=function(a){if(a){if(!a.name)throw Error(ia().Exp_EmptyNamedStyle);var b=a.name.toUpperCase();this.Lq[b]=a}},a.prototype.getNamedStyle=function(a){return this.Mq(a,!0)},a.prototype.Mq=function(a,b){var c,d=this.Lq;return d&&a?(a=a.toUpperCase(),c=d[a],c&&b&&this.Jq(),c):L},a.prototype.Jq=function(){this.Cq=[{},{},{},{}]},a.prototype.removeNamedStyle=function(a){var b,c=this.Lq;c&&a&&(a=a.toUpperCase(),C(c,a)&&(b=c[a].formatter,b&&"string"==typeof b&&this.parent.UHb[b]&&this.parent.VHb(b),delete c[a],this.Jq(),this.$p()))},a.prototype.getNamedStyles=function(){var a=[],b=this.Lq;return b&&A(b,function(b,c){a.push(c)}),this.Jq(),a},a.prototype.setStyle=function(a,b,c,d){var e,f;v(d)&&(d=3),c&&c.backColor&&"object"==typeof c.backColor&&s.To.processStops(c.backColor),e=this,e.Nq(a,b,c,d),a===-1&&b===-1&&(e.Oq[d]=L),a!==-1&&b!==-1||(f=c&&c.validator,f&&f.condition()&&4===f.condition().conType()&&f.condition().getExpected(this,a<0?0:a,b<0?0:b)),e.Jq(),e.$p()},a.prototype.Pq=function(a,b,c,d){var e,f,g=this;g.options.isProtected?(e=g.getStyle(a,b,d),f=void 0,c?(f=e?e.locked:M,c.locked!==f&&(c.locked=f),g.setStyle(a,b,c,d)):e&&(f=e.locked,f!==M&&(c=new h.Style,c.locked=f),g.setStyle(a,b,c,d))):g.setStyle(a,b,c,d)},a.prototype.getStyleName=function(a,b,c){var d=this.Aj(a,b,c);return d instanceof h.Style?d.name:d},a.prototype.setStyleName=function(a,b,c,d){if(typeof c===U){v(d)&&(d=3);var e=this;this.Nq(a,b,c,d),a===-1&&b===-1&&(e.Oq[d]=L),e.Jq(),e.$p()}},a.prototype.Aj=function(a,b,c){v(c)&&(c=3);var d;return 0!==c&&(d=this.ITa.getStyle(a,b,c)),d||L},a.prototype.getNamedStyleName=function(a,b,c){var d=this.Aj(a,b,c);return"string"==typeof d?d:M},a.prototype.Nq=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p;if(v(d)&&(d=3),0!==d){if(f=this,g=f.Aj(a,b,d),h=f.ITa,i=h.getRowCount(d),j=h.getColumnCount(d),a<-1||a>=i||b<-1||b>=j)return;k=c,l=h.getStyle(a,b,d),typeof k===U&&(k=f.Hq(k)),m=k&&k.formatter,m&&u(m)&&f.oJb(a,b,m),h.do("setStyle",a,b,c,d),n=g&&g.cellType&&g.cellType.typeName||L,o=c&&c.cellType&&c.cellType.typeName||L,a===f.Jl&&b===f.Kl&&n!==o&&e.Vl.Wl(f)&&f.mm.Qq(),p="[styleinfo]",a!==-1&&b!==-1?f.Bq(p,a,b,d,l,c):a!==-1&&b===-1?f.kq(a,d,p,c,l):a===-1&&b!==-1&&f.pq(b,d,p,c,l)}},a.prototype.oJb=function(a,b,d){var e=this;q||(q=c("SheetsCalc")),q&&e.D4J(a,b,d)},a.prototype.getDefaultStyle=function(a){var b,c,d,e,f,g,i;return v(a)&&(a=3),b=this,c=b.Oq,(d=c[a])?d:0!==a?(e=b.ITa,f=e.getStyle(-1,-1,a),typeof f===U&&(f=b.Hq(f)),f||(f=new h.Style,e.do("setStyle",-1,-1,f,a)),f=f,g=1===a||2===a,typeof f.hAlign===T&&(f.hAlign=g?1:3),typeof f.vAlign===T&&(f.vAlign=g?1:0),typeof f.imeMode===T&&(f.imeMode=1),f.font||typeof f.themeFont!==T||(f.themeFont="Body"),c[a]=f,f):(i=new h.Style,i.locked=!0,c[a]=i,i)},a.prototype.setDefaultStyle=function(a,b){v(b)&&(b=3);var c=this;0!==b&&c.ITa.do("setStyle",-1,-1,a,b),c.Oq[b]=L,c.Jq(),c.$p()},a.prototype.Hq=function(a){var b,c,d=this.Mq(a,!1);return d||(b=this.parent,d=b&&b.Mq(a,!1)),c=L,d&&(c=d.clone(!0),this.OUJ(c)),c},a.prototype.OUJ=function(a){if(a){var b=a.applyFont,c=a.applyFill,d=a.applyBorder,e=a.applyAlignment,f=a.applyNumberFormat,g=a.applyProtection;Ea(b)&&(delete a.foreColor,delete a.textDecoration,delete a.themeFont,delete a.font),Ea(c)&&delete a.backColor,Ea(d)&&(delete a.borderLeft,delete a.borderTop,delete a.borderRight,delete a.borderBottom,delete a.diagonalDown,delete a.diagonalUp),Ea(e)&&(delete a.textIndent,delete a.wordWrap,delete a.hAlign,delete a.vAlign,delete a.isVerticalText,delete a.shrinkToFit,delete a.textOrientation),Ea(f)&&delete a.formatter,Ea(g)&&delete a.locked}},a.prototype.getCompositeStyle=function(a,b,c,d,e,f,g,i,j,k,l,m){var n,o,p,q;if(v(c)&&(c=3),o=this,p=new h.Style,q=!1,0!==c){if(q=o.QRJ(a,b,c,p,q,d),i)return p;q=o.RRJ(a,b,c,p,q,g,j),n=o.SRJ(a,b,c,p,q,m,j,k),q=n.changed,p=n.destInfo,q=o.TRJ(a,c,p,q,e),q=o.URJ(b,c,p,q,f)}return o.VRJ(c,p,q,l),p},a.prototype.QRJ=function(a,b,c,d,e,f){var g,h,i,j=this,k=j.ITa,l=k.getRowCount(c),m=k.getColumnCount(c);if(0<=a&&a<l&&0<=b&&b<m&&(i=f!==M?f:k.getStyle(a,b,c),i&&i.charAt&&(i=j.Hq(i)),i))for(d.Yo(i,!0,10),e=!0,g=i.parentName;g&&(h=j.Hq(g));)d.Yo(h,!1,10,!0),g=h.parentName;return e},a.prototype.RRJ=function(a,b,c,d,e,f,g){var h=this,i=h.tables;return f!==M||g||(f=3===c&&i?i.find(a,b):L),f&&!g&&(f.Yo(a,b,d),e=!0),e},a.prototype.SRJ=function(a,b,c,d,e,f,g,h){var i,j=this,k=j.pivotTables;return f!==M||g||(f=3===c&&k?k.findPivotTable(a,b):L,h=f&&f.WNc(a,b)),h&&(h.parentName&&(i=j.Hq(h.parentName),i&&h.Yo(i)),h.Yo(d),d=h,e=!0),f&&(f.VNc(a,b,d),e=!0),{changed:e,destInfo:d}},a.prototype.TRJ=function(a,b,c,d,e){var f=this,g=f.ITa,h=g.getRowCount(b),i,j,k;if(0<=a&&a<h&&(i=e!==M?e:g.getStyle(a,-1,b),i&&i.charAt&&(i=f.Hq(i)),i))for(c.Yo(i,!d,30),d=!0,j=i.parentName;j&&(k=f.Hq(j));)c.Yo(k,!1,30,!0),j=k.parentName;return d},a.prototype.URJ=function(a,b,c,d,e){var f=this,g=f.ITa,h=g.getColumnCount(b),i,j,k;if(0<=a&&a<h&&(i=e!==M?e:g.getStyle(-1,a,b),i&&i.charAt&&(i=f.Hq(i)),i))for(c.Yo(i,!d,40),d=!0,j=i.parentName;j&&(k=f.Hq(j));)c.Yo(k,!1,40,!0),j=k.parentName;return d},a.prototype.VRJ=function(a,b,c,d){var e,f,g=this,h=g.getDefaultStyle(a);if(h&&h.charAt&&(h=g.Hq(h)),h&&!d)for(b.Yo(h,!c,50),e=h.parentName;e&&(f=g.Hq(e));)b.Yo(f,!1,50,!0),e=f.parentName;return c},a.prototype.getCellType=function(a,b,c){return this.tq(a,b,"cellType",c)||this.Al(c)},a.prototype.Al=function(a){v(a)&&(a=3);var b=this.Rq;return b||(b=this.Rq=new k.Text),3===a?b:1===a?new l.ColumnHeader:2===a?new l.RowHeader:0===a?new l.Corner:b},a.prototype.setCellType=function(a,b,c,d){var e=this.Iq(a,b,d);e||(e=new h.Style),e.cellType=c,this.setStyle(a,b,e,d)},a.prototype.Sq=function(a,b,c,d,f){var g,h,i,j,k,l,m=this;if(v(f)&&(f=3),g=m.ITa,g.do("clearSpan",a,b,c,d,f),h=e.kf(a,b,c,d),i=m.Tq(h,f),j=m.Fia(i,f),g.do("addSpan",j,f),3===f){for(k=m.getSelections(),l=0;l<k.length;l++)k[l].intersect(a,b,c,d)&&(k[l]=k[l].union(h));g.do("setSelections",k)}m.$p()},a.prototype.Fia=function(a,b){var c=this.getRowCount(b),d=this.getColumnCount(b),f=a.row,g=a.col,h=a.rowCount,i=a.colCount;return f+h>c&&(h=c-f),g+i>d&&(i=d-g),e.kf(f,g,h,i)},a.prototype.addSpan=function(b,c,d,e,f){var g,h,i,j,k,l=this;if((1!==d||1!==e)&&0!==f&&(g=l.getRowCount(f),h=l.getColumnCount(f),!(b>=g||c>=h||b<-1||c<-1)&&(i=!0,p&&(3===f||v(f))&&(i=l.Vq(b,c,d,e,!1),l.pivotTables&&(i=i&&l.pivotTables.iBJ(b,c,d,e))),i))){if(j=l.ITa,j.qu(b,c,d,e,f))throw Error(ia().Exp_InvalidRange);l.wyb&&l.wyb(b,c,d,e),l.Sq(b,c,d,e,f),k={sheet:l,row:b,col:c,rowCount:d,colCount:e,sheetArea:f,changeType:"addSpan"},a.ao(l,Z,k),l.Wq("spanChanged",k)}},a.prototype.removeSpan=function(b,c,d){var e,f,g,h=this;v(d)&&(d=3),e=h.ITa,f=e.findSpan(b,c,d),f&&f.row===b&&f.col===c&&e.do("removeSpan",f,d),g={sheet:h,row:b,col:c,sheetArea:d,changeType:"removeSpan"},a.ao(h,Z,g),h.Wq("spanChanged",g),h.$p()},a.prototype.getSpans=function(a,b){return 0===b?[]:this.ITa.getSpans(a,b,!0)},a.prototype.getSpan=function(a,b,c){return 0===c?L:this.ITa.findSpan(a,b,c)},a.prototype.repaint=function(a){this.Xq<=0&&this.yl&&this.yl.repaint(a)},a.prototype.YCJ=function(a,b,c,d){var f,g=a,h=1,i=this.eXJ(a,b,c,d);i&&(g=i.row,h=i.rowCount),f=this.cm(new e.Range(g,(-1),h,(-1))),f.y-=2,f.height+=4,this.repaint(f)},a.prototype.ZCJ=function(a,b,c,d){var f,g=a,h=1,i=this.fXJ(a,b,c,d);i&&(g=i.col,h=i.colCount),f=this.cm(new e.Range((-1),g,(-1),h)),f.x-=2,f.width+=4,this.repaint(f)},a.prototype.vZJ=function(a,b){var c=this,d=c.am(),f=c.cm(new e.Range((-1),a,(-1),1));f.y=d.y,f.height=d.height,b&&(f.x-=2,f.width+=4),c.repaint(f)},a.prototype.eXJ=function(a,b,c,d){var e,f,g,h,j=this,k=j.it(c),l=k.length;if(0===l)return L;if(e=j.Ir(b,c,m.SheetArea.viewport,d)){if(e.length>l)for(e=new i.yp,f=k[0].col,g=f;g<l;g++)h=j.rr(b,c,m.SheetArea.viewport,a,k[g].col),h&&e.push(h);return e.findLargestRow(a)}return L},a.prototype.fXJ=function(a,b,c,d){var e,f,g,h,j=this,k=j.jt(b),l=k.length;if(0===l)return L;if(e=j.Ir(b,c,m.SheetArea.viewport,d)){if(e.length>l)for(e=new i.yp,f=k[0].row,g=f;g<l;g++)h=j.rr(b,c,m.SheetArea.viewport,k[g].row,a),h&&e.push(h);return e.findLargestCol(a)}return L},a.prototype.Yq=function(a,b){var c,d,e,f,g,h,i,j,k,l,n,o,p,q,r,s,t,u=this,v=u.parent,w=v&&v.options.scrollbarAppearance===m.ScrollbarAppearance.mobile,x=!1,y=!1,z=v&&v.options.scrollByPixel,A=za(u),B=ya(u),C=B?u.Zq(B-1):u.$q(),D=A?u._q(A-1):u.ar();if(b<u.qq&&b>=C?(x=!0,u.rq(u.br(b+1),0)):z&&b===u.qq&&0!==u.eCb&&(x=!0,u.rq(b,0)),b>u.cr()&&b<=u.dr()){for(c=0,d=b,e=u.am(),f=u.wNc(e),g=u.ITa.findSpan(a,d),g&&(d=g.col+g.colCount-1);d>u.qq&&(c+=u.Tl(d),!(c>f));)d--;h=void 0,i=void 0,z?(d===u.qq&&c<f&&(c+=u.Tl(d)),h=d,i=f-c):(h=u.Zq(d),i=0),x=!0,u.rq(h,i)}if(a<u.lq&&a>=D?(y=!0,u.mq(u.gr(a+1),0)):z&&a===u.lq&&0!==u.cCb&&(y=!0,u.mq(a,0)),a>u.hr()&&a<=u.ir()){for(j=0,k=a,l=u.ITa.findSpan(k,b),l&&(k=l.row+l.rowCount-1),n=u.am(),o=u.tNc(n);k>u.lq&&(j+=u.Sl(k),!(j>o));)k--;p=void 0,q=void 0,z?(k===u.lq&&j<o&&(j+=u.Sl(k)),p=k,q=o-j):(p=u._q(k),q=0),y=!0,u.mq(p,q)}z||b!==u.dr()||u.rq(u.lr(),0),w&&(r=v.VJc,s=v.UJc,t=v.ku,y&&(r.Jwa(m.ScrollbarState.show),t.Rec(!0)),x&&(s.Jwa(m.ScrollbarState.show),t.Rec(!1)))},a.prototype.hitTest=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,w,x,y,z,A,B,C,D,E,F=this;if(F.am(),e={x:a,y:b},f=F.rowOutlines,g=F.columnOutlines,f&&(h=f.hitTest(F,a,b)),!h&&g&&(h=g.hitTest(F,a,b)),h)e.outlineHitInfo=h;else{if(i=F.nr(b),j=F.or(a),e.rowViewportIndex=i,e.colViewportIndex=j,e.row=F.pr(b,i),e.col=F.qr(a,j,b,i,e.row),e.hitTestType=F.sr(i,j),i>=0&&i<=2&&j>=0&&c!==!0&&(k=F.rr(i,j,e.hitTestType,e.row,e.col),k&&(e.row=k.row,e.col=k.col)),l=F.mm,m=F.xr,n=m&&m.hitTest(e,a,b),o=F.tables,p=void 0,!o||i===-1&&j===-1||(p=i===-1?o.find(F.getActiveRowIndex(),F.getActiveColumnIndex()):o.find(e.row,e.col)),n||(q=p&&p.xr,n=q&&q.hitTest(e,a,b)),r=o&&!n&&o.pJb(a,b,e))return e.tableSelectInfo=r,r.table&&r.table.xr&&(e.filterButtonHitInfo=n),e;s=l.Yia&&l.Yia(e,a,b),s?e.dragMergeInfo=s:(t=l.tr&&l.tr(e,a,b),t?e.dragInfo=t:(u=e.col,e.col=F.qr(a,j),e.cLJ=u,w=l.ur(e,a,b,5),w?e.resizeInfo=w:(e.col=u,delete e.cLJ,x=l.vr?l.vr(e,a,b):L,x?e.formulaRangeHitInfo=x:(y=F.ITa.Ky,z=y&&y.hitTest(a,b),z?e.commentHitInfo=z:(A=F.wr,B=A&&A.hitTest(a,b,d),C=void 0,F.shapes&&(C=F.shapes.hitTest(a,b)),C?e.shapeHitInfo=C:B?e.floatingObjectHitInfo=B:n?e.filterButtonHitInfo=n:(D=p&&!p.qJb()&&l.rJb&&l.rJb(e,p),D?e.resizeTableHitInfo=D:e.cellTypeHitInfo=F.yr(e,a,b)))))))}return E=F.pivotTables&&F.pivotTables.findPivotTable(e.row,e.col),v(E)||(e.pivotTableInfo=E),e},a.prototype.getCellRect=function(a,b,c,d,f){var g,h,i,j,k,l,m,n,o,p,q=3;return c===-1?q=1:d===-1&&(q=2),g=this,h=g.am(),c===-1&&d===-1?new e.Rect(h.zr,h.Ar,h.Br,h.Cr):(i=g.Dr(),v(c)&&(c=g.Er(a)),v(d)&&(d=g.Fr(b)),j=g.Gr(c,q).findRow(a),k=g.Hr(d,q).findCol(b),l=g.Ir(c,d,q,f).findCell(a,b),l?new e.Rect(l.x-i.x,l.y-i.y,l.width,l.height):j&&k?(m=k.x-i.x,n=j.y-i.y,o=k.width,p=j.height,k.height!==-1&&k.y!==-1&&(p=j.height*k.height,n=j.height*k.y),new e.Rect(m,n,o,p)):new e.Rect)},a.prototype.Jr=function(a,b,c){var d,f,g,h,i,j,k,l=this,n=l.mm,o=!1,p=l.Jl,q=l.Kl;v(a)||(l.Jl=a,o=!0),v(b)||(l.Kl=b,o=!0),d=l.XCJ,f=d&&d.isEnable(m.RowColumnStates.active,!0),g=d&&d.isEnable(m.RowColumnStates.active,!1),f&&(l.YCJ(p,l.Nr,l.Pr),l.YCJ(a,l.Nr,l.Pr)),g&&(l.ZCJ(q,l.Nr,l.Pr),l.ZCJ(b,l.Nr,l.Pr)),l.ITa.setCellState(p,q,m.CellStatesType.active,!1,m.SheetArea.viewport),f||g||l.DIb&&l.DIb(m.CellStatesType.active,p,q,m.SheetArea.viewport),l.ITa.setCellState(a,b,m.CellStatesType.active,!0,m.SheetArea.viewport),f||g||l.DIb&&l.DIb(m.CellStatesType.active,a,b,m.SheetArea.viewport),!c&&n&&o&&(n.Qq(),h=l.ITa,i=h.getDynamicArrayInfo(a,b),j=h.$Ib,i!==j&&(h.$Ib=i,l.Xq<=0&&(k=void 0,i&&j?k=e.getUnionRange(i,j):(i=i||j,k=e.kf(i.row,i.col,i.rowCount,i.colCount)),l.yl.im(k))))},a.prototype.gCb=function(a,b,c,d,e){var f=a.getCellRect(b,c,d,e),g=f.x,h=f.y,i=f.width,j=f.height;return f.x=g-2,f.y=h-2,f.width=i+4,f.height=j+4,f},a.prototype.Kr=function(a,b,c,d,f){var g,h=this,i=h.Jl,j=h.Kl,k=h.ITa,l=k.getSpan(a,b);h.Lr=l.rowCount,h.Mr=l.colCount,h.Xq<=0&&(g=k.getSpan(i,j),h.yl.im(e.kf(i,j,g.rowCount,g.colCount))),h.Nr=c,h.Pr=d,h.Jr(a,b,f),h.Qr=a,h.Rr=b},a.prototype.setActiveCell=function(a,b,c,d){this.Sr(a,b,c,d,2)},a.prototype.Sr=function(a,b,c,d,f){var g,h,i,j=this,k=ta(j),l=sa(j);a<0?a=0:a>=k&&(a=O(0,k-1)),b<0?b=0:b>=l&&(b=O(0,l-1)),j.Tr(),g=2===f?e.Vl.Wl(j):1===f,j.Kr(a,b,c,d,!g),h={sheet:j,sheetName:j.name(),row:a,col:b},j.Wq(e.Events.FormulaTextboxEnterCell,h),i=j.ITa.getSpan(a,b),j.Ur(i.row,i.col,i.rowCount,i.colCount),j.$p()},a.prototype.getActiveRowIndex=function(){return this.Jl},a.prototype.getActiveColumnIndex=function(){return this.Kl},a.prototype.getRowResizable=function(a,b){return this.ITa.getResizable(!0,b,a)},a.prototype.setRowResizable=function(a,b,c){this.Vr(a,b,ca,!0,c)},a.prototype.Vr=function(a,b,c,d,e){var f,g,h,i;switch(v(e)&&(e=3),
c!==W&&c!==V||!F.test(b)||(c=ba),f=this,g=f.ITa,c){case ca:h=g.getResizable(d,e,a);break;case"pageBreak":h=g.getPageBreak(d,e,a);break;case aa:h=g.getVisible(d,e,a);break;case W:h=g.getSize(d,e,a);break;case V:h=g.getSize(d,e,a);break;case fa:h=g.getColumnHeaderFitMode(d,e,a)}if(i=!0,i=d?f.pCb(a,e,c,b,h):f.qCb(a,e,c,b,h),!i)return i;switch(c){case ca:g.do("setResizable",d,e,a,b);break;case"pageBreak":g.do("setPageBreak",d,e,a,b);break;case aa:g.do("setVisible",d,e,a,b),d&&p&&3===e&&h!==b&&f.recalcRows([a]);break;case W:g.do("setSize",d,e,a,b),!p||3!==e||h===b||0!==h&&0!==b||f.recalcRows([a]);break;case V:g.do("setSize",d,e,a,b),!p||3!==e||h===b||0!==h&&0!==b||f.recalcCols([a]);break;case ba:g.do("setStarSize",d,e,a,b);break;case fa:g.do("setColumnHeaderFitMode",d,e,a,b)}return d?f.kq(a,e,c,b,h):f.pq(a,e,c,b,h),!0},a.prototype.getColumnResizable=function(a,b){return this.ITa.getResizable(!1,b,a)},a.prototype.setColumnResizable=function(a,b,c){this.Vr(a,b,ca,!1,c)},a.prototype.getRowHeight=function(a,b,c){var d,e,f,g,h,i,j,k=this;if(v(b)&&(b=3),c)return k.ITa.getStarSize(!0,b,a);if(3===b||2===b){if(d=k.getRowCount(b),a<0||a>=d)return 0;for(e=k.Wr,f=0;f<e.length;f++)if(g=e[f],!g.Xr(a))return 0}return h=k.defaults,i=h.rowHeight,1===b&&(i=h.colHeaderRowHeight),j=k.ITa.getSize(!0,b,a),j||0===j?j:P(i)},a.prototype.Yr=function(a,b){var c,d,e,f;return v(b)&&(b=3),c=this,d=c.defaults,e=d.rowHeight,1===b&&(e=d.colHeaderRowHeight),f=c.ITa.getActualSize(!0,b,a),f||0===f?f:P(e)},a.prototype.setRowHeight=function(a,b,c){this.Vr(a,b,W,!0,c)&&(this.jq=!0,this.$p())},a.prototype.getRowVisible=function(a,b,c){var d,e,f,g=this;if(v(b)&&(b=3),!c&&(3===b||2===b))for(d=g.Wr,e=0;e<d.length;e++)if(f=d[e],!f.Xr(a))return!1;return this.ITa.getVisible(!0,b,a)},a.prototype.setRowVisible=function(a,b,c){var d=this;d.Vr(a,b,aa,!0,c)&&(d.jq=!0,d.$p())},a.prototype.getColumnWidth=function(a,b,c){var d,e,f,g,h,i,j,k=this;if(v(b)&&(b=3),c)return k.ITa.getStarSize(!1,b,a);if(d=k.defaults,e=d.colWidth,2===b&&(e=d.rowHeaderColWidth),3===b||1===b){if(f=k.getColumnCount(b),a<0||a>=f)return 0;for(g=k.Zr,h=0;h<g.length;h++)if(i=g[h],!i.Xr(a))return 0}return j=this.ITa.getSize(!1,b,a),j||0===j?j:P(e)},a.prototype.$r=function(a,b){var c,d,e,f;return v(b)&&(b=3),c=this,d=c.defaults,e=d.colWidth,2===b&&(e=d.rowHeaderColWidth),f=c.ITa.getActualSize(!1,b,a),f||0===f?f:P(e)},a.prototype.setColumnWidth=function(a,b,c){this.Vr(a,b,V,!1,c)&&(this.oq=!0,this.$p())},a.prototype.getColumnVisible=function(a,b){var c,d,e,f=this;if(v(b)&&(b=3),3===b||1===b)for(c=f.Zr,d=0;d<c.length;d++)if(e=c[d],!e.Xr(a))return!1;return f.ITa.getVisible(!1,b,a)},a.prototype.setColumnVisible=function(a,b,c){var d=this;d.Vr(a,b,aa,!1,c)&&(d.oq=!0,d.$p())},a.prototype.zoom=function(a){var b,c=this;return 0===arguments.length?c.ITa.getZoomFactor():(a=J(a),!K(a)&&isFinite(a)&&(a>4?a=4:a<.25&&(a=.25),b=c.ITa.getZoomFactor(),c.XSa(a),c.eCb=c.eCb/b*a,c.cCb=c.cCb/b*a,c.oq=!0,c.jq=!0,c.$p()),c)},a.prototype.XSa=function(b){this.ITa.do("setZoomFactor",b),a.ao(this,Z,{changeType:"zoomSheet"})},a.prototype.x6a=function(){var a=this;a._r=L,a.as={colHeader:L,viewport:L},a.bs={rowHeader:L,viewport:L,colHeader:L}},a.prototype.invalidateLayout=function(){var b,c,d=this,f=d.mm;d.ITa.$Gb(),d.x6a(),a.ao(d,$,{changeType:"invalidateLayout"}),d.oq&&(d.ds(),d.oq=!1),d.jq&&(d.es(),d.jq=!1),d.x6a(),a.ao(d,Z,{changeType:"invalidateLayout"}),f&&f.cs&&e.Vl.Wl(d)&&!f.p8J(d)&&f.cs(d.Jl,d.Kl),d.$l=!0,b=d.parent,b&&b.options.enableAccessibility&&(c=d.DHb(),b.EHb(c))},a.prototype.$p=function(){var a=this;a.Xq<=0&&(a.invalidateLayout(),a.repaint())},a.prototype.getViewportHeight=function(a){var b=this,c=b.am();return 0===a?c.fs:1===a?b.tNc(c):2===a?c.gs:0},a.prototype.getViewportWidth=function(a){var b=this.am();return 0===a?b.hs:1===a?this.wNc(b):2===a?b.js:0},a.prototype.getViewportTopRow=function(a){var b=this,c=za(b);return 0===a?0:1===a?O(c,b.lq):2===a?O(c,ta(b)-va(b)):-1},a.prototype.getViewportTopRowOffset=function(){return this.cCb},a.prototype.getViewportBottomRow=function(a){var b,c,d,e,f,g,h=this;if(2===a)return ta(h)-1;for(b=h.getViewportTopRow(a),c=h.getViewportHeight(a),d=1===a?h.cCb:0,e=0,f=ta(h)-va(h),0===a&&(f=N(za(h),f)),g=b;g<f&&d<c;g++,e++)d+=h.Sl(g);return b+e-1},a.prototype.jCb=function(a){var b,c,d=this,e=d.jt(a);for(b=0;b<e.length;b++)if(c=e[b],c.height>0)return c.row;return-1},a.prototype.getViewportLeftColumn=function(a){var b=this,c=ya(b);return 0===a?0:1===a?O(c,b.qq):2===a?O(c,sa(b)-ua(b)):-1},a.prototype.getViewportLeftColumnOffset=function(){return this.eCb},a.prototype.getViewportRightColumn=function(a){var b,c,d,e,f,g,h=this;if(2===a)return sa(h)-1;for(b=h.getViewportLeftColumn(a),c=h.getViewportWidth(a),d=0,e=1===a?h.eCb:0,f=sa(h)-ua(h),0===a&&(f=N(ya(h),f)),g=b;g<f&&e<c;g++,d++)e+=h.Tl(g);return b+d-1},a.prototype.kCb=function(a){var b,c=this,d=c.getViewportLeftColumn(a),e=c.getViewportRightColumn(a);for(b=d;b<e+1;b++)if(b>-1&&c.getColumnVisible(b,3)&&c.Tl(b,3)>0)return b;return-1},a.prototype.showCell=function(a,b,c,d){this.jKJ(a,b,c,d)},a.prototype.jKJ=function(a,b,c,d,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u=this;a<0||a>=ta(u)||b<0||b>=sa(u)||(j=u.parent&&u.parent.options.scrollByPixel,k=u.parent&&u.parent.options.scrollbarMaxAlign,l=u.Fr(b),m=u.Er(a),n=u.getViewportTopRow(m),o=u.cCb,p=u.getViewportLeftColumn(l),q=u.eCb,1===l&&v(g)&&(h=u.hKJ(b,d,j,k),b=h.col,g=h.offset),1===m&&v(f)&&(i=u.iKJ(a,c,j,k),a=i.row,f=i.offset),r=!1,s=!1,1!==m||a===n&&f===o||(a=N(a,u.ns()),u.lq=a,u.cCb=f,u.os(),r=!0),1!==l||b===p&&g===q||(b=N(b,u.ps()),u.qq=b,u.eCb=g,u.qs(),s=!0),(r||s)&&(t=u.parent,t&&!t.options.scrollbarShowMax&&(u.oq=!0,u.jq=!0),u.$p(),r&&u.Wq(e.Events.TopRowChanged,{sheet:u,sheetName:u.name(),oldTopRow:n,newTopRow:a}),s&&u.Wq(e.Events.LeftColumnChanged,{sheet:u,sheetName:u.name(),oldLeftCol:p,newLeftCol:b})))},a.prototype.Er=function(a){var b=this;return a<za(b)?0:a>=ta(b)-va(b)?2:1},a.prototype.Fr=function(a){var b=this;return a<ya(b)?0:a>=sa(b)-ua(b)?2:1},a.prototype.iKJ=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o=this,p=o.ss,q=o.Er(a),r=o.getViewportTopRow(q),s=o.cCb,t=za(o),u=o.ir();if(0===b)if(d){for(f=u,e=o.getViewportHeight(q);t<=f;f--)if(e-=p.Sl(f),e<0){a<=f?s=0:(a=f,s=e);break}}else s=0;else if(1===b){if(g=!1,h=!1,d){for(f=u,i=P(o.getViewportHeight(q)/2),e=i;t<=f;f--)if(e-=p.Sl(f),e<0){a>=f&&(f--,e+=i,h=!0);break}if(h)for(;t<=f;f--)if(e-=p.Sl(f),e<0){a=f,s=e,g=!0;break}}if(!g){for(e=P((o.getViewportHeight(q)-p.Sl(a))/2);t<a;a--)if(e-=p.Sl(a-1),e<0){a-=1,s=e;break}e>0&&a===t&&(s=0)}}else if(2===b){for(e=o.getViewportHeight(q)-p.Sl(a);t<a;a--)if(e-=p.Sl(a-1),e<0){a-=1,s=e;break}e>0&&a===t&&(s=0)}else if(3===b)if(a>r){if(j=o.am(),k=o.getCellRect(a,o.Kl),l=j.Ft(1,1),m=j.Ft(1,0),n=j.Ft(1,2),l.containsRect(k,!0)||m.containsRect(k,!0)||n.containsRect(k,!0))a=r;else for(e=o.getViewportHeight(q)-p.Sl(a);r<a;a--)if(e-=p.Sl(a-1),e<0){a-=1,s=e;break}}else s=0;return!c&&s<0&&(s=0,a<u&&(a+=1)),{row:a,offset:s}},a.prototype.hKJ=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.ss,t=r.Fr(a),u=r.getViewportLeftColumn(t),v=r.eCb,w=ya(r),x=r.dr();if(0===b)if(d){for(f=r.getViewportWidth(t),g=x;w<=g;g--)if(f-=s._m(g),f<0){a<=g?v=0:(a=g,v=f);break}}else v=0;else if(1===b){if(h=!1,i=!1,d){for(j=P(r.getViewportWidth(t)/2),f=j,g=x;w<=g;g--)if(f-=s._m(g),f<0){a>=g&&(g--,f+=j,i=!0);break}if(i)for(;w<=g;g--)if(f-=s._m(g),f<0){a=g,v=f,h=!0;break}}if(!h){for(f=P((r.getViewportWidth(t)-s._m(a))/2);w<a;a--)if(f-=s._m(a-1),f<0){a-=1,v=f;break}f>0&&a===w&&(v=0)}}else if(2===b){for(f=r.getViewportWidth(t)-s._m(a);w<a;a--)if(f-=s._m(a-1),f<0){a-=1,v=f;break}f>0&&a===w&&(v=0)}else if(3===b)if(a>u){if(k=r.am(),l=k.pt,m=k.qt,n=k.er,o=k.jr,p=r.getCellRect(r.Jl,a),q=new e.Rect(l,m,n,o),q.containsRect(p,!0))a=u;else for(f=r.getViewportWidth(t)-s._m(a);u<a;a--)if(f-=s._m(a-1),f<0){a-=1,v=f;break}}else v=0;return!c&&v<0&&(v=0,a<x&&(a+=1)),{col:a,offset:v}},a.prototype.ms=function(a,b){var c=this,d=c.ss,e=c.Er(a),f=c.getViewportTopRow(e),g;if(0!==b)if(1===b)for(g=P((c.getViewportHeight(e)-d.Sl(a))/2);0<a&&(g-=d.Sl(a-1),!(g<0));a--);else if(2===b)for(g=c.getViewportHeight(e)-d.Sl(a);0<a&&(g-=d.Sl(a-1),!(g<0));a--);else if(3===b&&!(a<f||f===-1))for(g=c.getViewportHeight(e)-d.Sl(a);f<a&&(g-=d.Sl(a-1),!(g<0));a--);return a},a.prototype.showColumn=function(a,b){this.showCell(this.lq,a,0,b)},a.prototype.showRow=function(a,b){this.showCell(a,this.qq,b,0)},a.prototype.suspendEvent=function(){this.jm++},a.prototype.resumeEvent=function(){this.jm--,this.jm<0&&(this.jm=0)},a.prototype.isEventSuspended=function(){return this.jm>0},a.prototype.currentTheme=function(a){var b=this;return 0===arguments.length?(b.Pm||b.ts(),b.Pm):(typeof a===U&&(a=r.Themes[a]?r.Themes[a]:new r.Theme(a)),b.Pm=a,b.yl.us(),b.Jq(),b.$p(),b)},a.prototype.P3=function(){var a=e.Im.Lm(""),b=I(a.zIndex),c=r.Themes.Office2007;return b>2007&&(c=r.Themes.Office),c},a.prototype.ts=function(){this.Pm=this.P3(),this.Jq()},a.prototype.reset=function(){var a=this;a.vs(),a.$p()},a.prototype.vs=function(){var b,c,d,f=this,g=f.HHb();f.Pp(),f.Nr=0,f.Pr=0,f.T3(),f._r=L,f.as={colHeader:L,viewport:L},f.bs={rowHeader:L,viewport:L,colHeader:L},f.lq=0,f.cCb=0,f.qq=0,f.eCb=0,f.frozenRowCount(0),f.frozenColumnCount(0),f.frozenTrailingRowCount(0),f.frozenTrailingColumnCount(0),a.ao(f,"beforeSetHost"),b=f.parent,b&&(c=b.getActiveSheet(),d=b.getActiveSheetTab(),(c&&f.name()===c.name()||d&&f.name()===d.name())&&f.ws(b.xs)),f.Cq=[{},{},{},{}],f.ss=new e.ln(f),f.Oq={},p&&f.resetCalc(),f.ITa=new i.lUa(f,a.Rp,a.Sp,a.Vp,a.Tp,f.name()),f.defaults=f.ITa.defaults,f.HHb(g),f.ts(),f.Lq={},f.oq=!0,f.jq=!0,f.parent&&f.parent.xD?f.Xq=f.parent.xD:f.Xq=0,f.parent&&f.parent.jm?f.jm=f.parent.jm:f.jm=0,f.gga=0,f.Js=!1,f.Ks=L,f.Wr=[],f.Zr=[],f.TIb=!1,f.sXJ=m.ClipboardPasteOptions.all,f.tXJ=m.CopyToOptions.all,f.rXJ=!0,f.MXJ=!0,a.ao(f,"init")},a.prototype.T3=function(){var a=this;A(ma,function(b,c){if(!v(c)){var d=c;"gridline"===b?d={color:e.Im.Lm("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof d&&(d=j.GC$.extend({},c)),a.options[b]=d}})},a.prototype.Ls=function(b){var c,d=this;for(d.parent=b,c=d.Xq;c<b.xD;c++)d.suspendPaint();d.jm=b.jm,a.ao(d,"attach",b)},a.prototype.sJb=function(a,b){return a.row===b.row&&a.col===b.col&&a.rowCount===b.rowCount&&a.colCount===b.colCount},a.prototype.tJb=function(a,b,c,d,e){var f,g,h=this.Ms(b,c,d,e).ranges;for(f=0;f<h.length;f++)for(g=0;g<a.length;g++)if(this.sJb(a[f],h[g]))return!0;return!1},a.prototype.uJb=function(a,b,c,d,e){var f,g=!1;return void 0!==e?0===e?(f=this.Ms(a,b,c,this.getColumnCount()-b).ranges,f.length>0&&(a-1>0&&(g=this.tJb(f,a-1,b,1,this.getColumnCount()-b)),g||(g=this.tJb(f,a+c,b,1,this.getColumnCount()-b)),g||(g=this.tJb(f,a,b,c,1)))):(f=this.Ms(a,b,this.getRowCount()-a,d).ranges,f.length>0&&(a-1>0&&(g=this.tJb(f,a-1,b,this.getRowCount()-a,1)),g||(g=this.tJb(f,a+c,b,this.getRowCount()-a,1)),g||(g=this.tJb(f,a,b,1,d)))):g=!0,g},a.prototype.Y3=function(a,b,c,d,f,g,h,i,j,k){var l,m=this;return!h&&m.options.isProtected&&m.ou(e.kf(a,b,c,d),j,k)?(f&&m.Os(1,f),!1):(l=this.uJb(a,b,c,d,i),!(p&&l&&!m.Vq(a,b,c,d))||(g&&m.Os(1,g),!1))},a.prototype.clear=function(a,b,c,d,e,f,g,h,i){0!==e&&this.cg(a,b,c,d,e,f,g,h,i)},a.prototype.cg=function(b,c,d,e,f,g,h,i,j,k){var l,m,n,o,q,r,s,t,u,w,x,y,z,A,B,C=this,D=p;try{if(D&&C.suspendCalcService(),C.suspendPaint(),l=C.defaults,m=void 0,n=void 0,o=void 0,q=void 0,r=3,s={changeType:"clear",row:b,col:c,rowCount:d,colCount:e,sheetArea:f,type:g,ignoreTable:i,ignorePivotTable:j,canClear:!0},a.ao(C,Z,s),!s.canClear)return;if(v(f)||f===r){if(D&&!C.Vq(b,c,d,e))return!1;if(1&g&&C.getDataSource&&C.getDataSource()){for(C.suspendEvent(),m=b;m<b+d;m++)if(!(h&&C.Ps&&C.Ps(m)))for(n=c;n<c+e;n++)C.setValue(m,n,L,f);C.resumeEvent()}}for(t=C.ITa,u=D&&C.Bj(),m=b===-1?0:b,w=b===-1?t.getRowCount(f):d,n=c===-1?0:c,x=c===-1?t.getColumnCount(f):e,y=[],z=m;z<w+m;z++)h&&C.Ps&&C.Ps(z)&&y.push(z);if(t.do("clear",m,n,w,x,g,y,f),u&&1&g&&!k&&(u.Sg(m,n,w,x),u.clear(m,n,w,x,t.dUa())),8&g&&!(b>=0&&c>=0))if(c>=0)for(q=0;q<x;q++)C.setTag(-1,n+q,L,f);else if(b>=0)for(o=0;o<w;o++)h&&C.Ps&&C.Ps(m+o)||C.setTag(m+o,-1,L,f);else C.setTag(-1,-1,L,f);if(256&g&&!(b>=0&&c>=0))if(c>=0)for(q=0;q<x;q++)C.setHyperlink(-1,n+q,L,f);else if(b>=0)for(o=0;o<w;o++)h&&C.Ps&&C.Ps(m+o)||C.setHyperlink(-1,-1,L);if(2&g&&!(b>=0&&c>=0))if(c>=0)for(q=0;q<x;q++)C.setStyle(-1,n+q,L,f);else if(b>=0)for(o=0;o<w;o++)h&&C.Ps&&C.Ps(m+o)||C.setStyle(m+o,-1,L,f);else C.setStyle(-1,-1,L,f);if(32&g){if(b<0)for(q=0;q<x;q++)C.setColumnVisible(n+q,!0,f),C.setColumnResizable(n+q,!0,f),C.setColumnWidth(n+q,2===f?l.rowHeaderColWidth:l.colWidth,f);if(c<0)for(o=0;o<w;o++)h&&C.Ps&&C.Ps(m+o)||(C.setRowVisible(m+o,!0,f),C.setRowResizable(m+o,!0,f),C.setRowHeight(m+o,1===f?l.colHeaderRowHeight:l.rowHeight,f))}for((v(f)||f===r)&&D&&1===(1&g)&&(A=C.Bj(),A&&A.Ag(b,c,d,e)),B=[],o=0;o<w;o++)for(q=0;q<x;q++)B.push({row:m+o,col:n+q});C.Bu(b,c,w,x,B,2,f)}finally{C.resumePaint(),D&&C.resumeCalcService(!1)}},a.prototype._p=function(){var a,b,c,d,e=this,f=e.options,g=f.protectionOptions;f.isProtected&&g&&(a=g.allowSelectLockedCells,b=g.allowSelectUnlockedCells,(a===!1&&b!==!1||a!==!1&&b===!1)&&(c=e.Jl,d=e.Kl,e.Qs(c,d)||(e.Tr(),e.Rs(c,d,!0),e.Ss(4,c,d))))},a.prototype.setArray=function(a,b,c,d){var e,f,g,h,i=this,k=p;if(d=k&&d,e=ta(i),f=sa(i),c&&0<=a&&a<e&&0<=b&&b<f){k&&i.suspendCalcService(),i.suspendPaint();try{A(c,function(c,k){j.GC$.isArray(k)?A(k,function(j,k){g=a+c,h=b+j,g<e&&h<f&&(d?i.setFormula(g,h,k):i.setValue(g,h,k,3,!0))}):(g=a+c,h=b,g<e&&h<f&&(d?i.setFormula(g,h,k):i.setValue(g,h,k,3,!0)))})}finally{k&&i.resumeCalcService(),i.resumePaint()}}},a.prototype.getArray=function(a,b,c,d,e){var f,g,h=this,i=[],j=ta(h),k=sa(h);if(e=e&&p,0<=a&&a<j&&0<=b&&b<k)for(a+c>j&&(c=j-a),b+d>k&&(d=k-b),f=0;f<c;f++)for(i[f]=[],g=0;g<d;g++)e?i[f][g]=h.getFormula(a+f,b+g):i[f][g]=h.getValue(a+f,b+g);return i},a.prototype.setTag=function(a,b,c,d){var e,f,g,h,i,j;if(v(d)&&(d=3),e=this,0!==d){if(f=e.ITa,g=f.getRowCount(d),h=f.getColumnCount(d),a<-1||a>=g||b<-1||b>=h)return;c=D(c),i=void 0,j=e.jm>0,j||(i=e.getTag(a,b,d)),f.do("setValueForKey",a,b,Y,c,d),i!==c&&(a!==-1&&b!==-1?j?e.aPJ(e,[{row:a,col:b}],0):e.Bq(Y,a,b,d,i,c):a!==-1&&b===-1?e.kq(a,d,Y,c,i):a===-1&&b!==-1&&e.pq(b,d,Y,c,i))}},a.prototype.getTag=function(a,b,c){var d,e=this;return v(c)&&(c=3),0!==c?(d=e.ITa.getValueForKey(a,b,Y,c),E(d)):L},a.prototype.tag=function(a){var b,c=this;return 0===arguments.length?(b=c.ITa.getValueForKey(-1,-1,Y,3),E(b)):(c.ITa.do("setValueForKey",-1,-1,Y,D(a),3),c)},a.prototype.getParent=function(){return this.parent},a.prototype.getDirtyRows=function(){return pa(this,!0)},a.prototype.getInsertRows=function(){return pa(this,!1)},a.prototype.getDeletedRows=function(){var a=[],b=this.Ts;return b&&A(b,function(b,c){c&&!j.GC$.isFunction(c)&&a.push({row:c.row,originalItem:c.data})}),a},a.prototype.hasPendingChanges=function(){var a,b=this,c=b.Ts;return!!(c&&c.length>0)||(a=b.ITa.hUa(),!Fa(a))},a.prototype.clearPendingChanges=function(b){var c,d,e,f,g,h=this;return v(b)||B(b)?(h.ITa.iUa(),h.Ts=[],void a.ao(h,"clearPendingChanges")):(c=b.row,d=b.col,e=b.rowCount,f=b.colCount,g=b.clearType,g=g||ka.dirty,(1&g)===ka.dirty&&h.Bfc(c,d,e,f),(2&g)===ka.insert&&h.Cfc(c,d,e,f),void((4&g)===ka.delete&&h.Dfc(c,d,e,f)))},a.prototype.Bfc=function(b,c,d,e){var f=this,g=f.ITa,h=f.Efc(b,c,d,e),i=f.Ffc(c,e);h?(g.Afc(),a.ao(f,"clearPendingChanges")):g.wfc(i,b,c,d,e)},a.prototype.Cfc=function(a,b,c,d){var e=this,f=e.ITa,g=e.Efc(a,b,c,d),h=e.Ffc(b,d);f.vfc(g,h,a,c)},a.prototype.Dfc=function(a,b,c,d){var e,f,g,h,i=this;if(i.Efc(a,b,c,d))return void(i.Ts=[]);if(i.Ffc(b,d)&&(e=i.Ts))for(f=[],A(e,function(b,d){if(d){var e=d.row;a<=e&&e<a+c&&f.push(b)}}),g=f.length,h=g-1;h>=0;h--)i.Ts.splice(f[h],1)},a.prototype.Ffc=function(a,b){return v(a)||a===-1||0===a&&this.getColumnCount()===b},a.prototype.Gfc=function(a,b){return v(a)||a===-1||0===a&&b===this.getRowCount()},a.prototype.Efc=function(a,b,c,d){return this.Ffc(a,c)&&this.Ffc(b,d)},a.prototype.getDirtyCells=function(a,b,c,d){var e,f,g,h,i,j,k,l=this;if(v(a)&&(a=-1),v(b)&&(b=-1),(v(c)||c<=0)&&(c=1),(v(d)||d<=0)&&(d=1),e=[],f=l.ITa.hUa(),!B(f)){if(g=[],a>=0)for(h=a;h<a+c;h++)g.push(h);else for(i in f)C(f,i)&&g.push(I(i));A(g,function(a,c){var g,h;if(j=f[c],j&&"e"===j.rs)if(b>=0)for(g=b;g<b+d;g++)k=j[g],k&&e.push(Ca(l,c,g,k.oldValue));else for(h in j)K(h)||(k=j[h],k&&e.push(Ca(l,c,I(h),k.oldValue)))})}return e},a.prototype.suspendDirty=function(){this.gga++,this.ITa.jUa()},a.prototype.resumeDirty=function(){var a=this;a.gga--,a.gga<0&&(a.gga=0),a.ITa.kUa()},a.prototype.isDirtySuspended=function(){return this.gga>0},a.prototype.ad=function(a){this.Us(new e.Rect(0,0,0,0)),this.vs(),this.cq(a)},a.prototype.MVJ=function(){return this},a.prototype.Vs=function(){var a,b=this,c=b.Ws(),d={top:0,left:0};return c&&c.parentElement&&(d=j.GC$(c).offset(),d&&(d.top+=H.body.clientTop||0,d.left+=H.body.clientLeft||0)),a=c&&c.canvasOffset,a&&(d=a),d},a.prototype.ws=function(b){var c,d,f,g,h;b&&(c=this,c.Js=!1,d=c.Xs,d&&c.no(!1),f=w("canvas"),g=c.parent&&c.parent.options.enableAccessibility,h=g?"":ia().NeedCanvasSupport,j.GC$(f).attr("id",b.getAttribute("id")+"_vp").attr("gcUIElement","gcWorksheetCanvas").html(h).appendTo(b),e.En.Kn(f,L,c),c.Xs=f,c.fq(),c.repaint(),c.parent&&c.parent.Ys(),a.ao(c,"setHost",j.GC$(f)))},a.prototype.vJb=function(a,b,c,d,e,f,g,h,i){var j,k,l=this;for(j=c;j<d;j++)k=l.getText(b,j,i),a.push('"'+k+'"');for(j=e;j<f;j++)k=l.getText(b,j,i),a.push('"'+k+'"');for(j=g;j<h;j++)k=l.getText(b,j,i),a.push('"'+k+'"')},a.prototype.wJb=function(){var a,b,c,d,e,f=this,g=f.getViewportTopRow(1),h=f.getViewportBottomRow(1),i=f.getViewportLeftColumn(1),j=f.getViewportRightColumn(1),k=h-g+1,l=j-i+1,n=f.getRowCount(m.SheetArea.colHeader),o=f.getColumnCount(m.SheetArea.rowHeader),p=f.frozenColumnCount(),q=ua(f),r=f.getColumnCount(),s=f.frozenRowCount(),t=va(f),u=f.getRowCount(),v=[];for(a=0;a<n;a++)b=[],f.vJb(b,a,0,p,i,i+l,r-q,r,m.SheetArea.colHeader),v.push(b.join(","));for(a=0;a<s;a++){for(c=[],d=0;d<o;d++)e=f.getText(a,d,m.SheetArea.rowHeader),c.push('"'+e+'"');f.vJb(c,a,0,p,i,i+l,r-q,r),v.push(c.join(","))}for(a=g;a<g+k;a++){for(c=[],d=0;d<o;d++)e=f.getText(a,d,m.SheetArea.rowHeader),c.push('"'+e+'"');f.vJb(c,a,0,p,i,i+l,r-q,r),v.push(c.join(","))}for(a=u-t;a<u;a++){for(c=[],d=0;d<o;d++)e=f.getText(a,d,m.SheetArea.rowHeader),c.push('"'+e+'"');f.vJb(c,a,0,p,i,i+l,r-q,r),v.push(c.join(","))}return v.join(";")},a.prototype.DHb=function(a){var b,c,d,f,g,h,i,j,k=this;return e.util.sl()?k.wJb():(b=k.Jl,c=k.Kl,d=m.SheetArea.viewport,!a||v(a.row)||v(a.col)||(b=a.row,c=a.col,d=a.hitTestType),f=ia(),g="",h=k.getText(b,c,d),d===m.SheetArea.rowHeader?g=f.ARIA_RowHeader+" ":d===m.SheetArea.colHeader?g=f.ARIA_ColumnHeader+" ":(v(d)||d===m.SheetArea.viewport)&&(i=k.getFormula(b,c),j=k.comments&&k.comments.get(b,c)),g+k.uSJ(b,c,h,i,j&&j.text()))},a.prototype.uSJ=function(a,b,c,d,f){var g=ia(),h=g.ARIA_Cell+" "+e.util.xq(b+1)+(a+1)+" ";return v(c)||""===c||(h+=G.Kb(g.ARIA_HasValue,[c])+", "),v(d)||(h+=G.Kb(g.ARIA_HasFormula,[d])+", "),v(f)||(h+=G.Kb(g.ARIA_HasComment,[f])),h},a.prototype.fq=function(){var a,b,c,d,f,g,h,i,k=this,l=k.Ws();l&&l.parentNode&&(a=getComputedStyle(l.parentNode),b=a.width,c=a.height,d=b.indexOf("px"),d>0&&(b=b.substring(0,d)),d=c.indexOf("px"),d>0&&(c=c.substring(0,d)),f=I(b),g=I(c),K(f)&&(f=j.GC$(l.parentNode).width()),K(g)&&(g=j.GC$(l.parentNode).height()),0!==f&&0!==g&&(h=O(f,0),i=O(g,0),l.style.display="none",l.style.display="",l.width=h,l.height=i,l.style.width=h+"px",l.style.height=i+"px",h=l.clientWidth||l.width,i=l.clientHeight||l.height,k.Zs.width=h,k.Zs.height=i,e.En.Pn(l,h,i),k.invalidateLayout()))},a.prototype.destroy=function(){this.no(!0)},a.prototype.no=function(b,c){var d,f,g,h=this;h.Js!==!0&&(e.En.Sn(h),h.isEditing&&h.isEditing()&&h.Yoa(h.Jl,h.Kl,m.SheetArea.viewport),a.ao(h,"dispose",{clearCache:b,isSheetDestroy:!0,hasActiveSheet:c}),d=h.Xs,d&&(f=d.parentNode,f&&f.removeChild(d),h.Xs=L),h.$s(),h.ITa&&h.ITa.no(b),b!==!1&&(h.Js=!0,g=h.at,g&&g.no(),h.parent=L,h.ITa=L,h.ss&&(h.ss.no(),h.ss=L),h.bt&&(h.bt.no(),h.bt=L),e.Vl.Wl(h)&&e.Vl.Zl(L,!0),h.uu&&(h.uu.hZ(),h.uu=L),h.Wr=L,h.Zr=L))},a.prototype.$s=function(){var a=this.dt;a&&(j.GC$(a).remove(),this.dt=M)},a.prototype.vq=function(a,b,c,d,e){var f,g,h,i,j;return v(d)&&(d=3),3===d&&this.mIb&&(f=a.getDynamicArrayInfo(b,c),f&&f.isValid&&(b!==f.row||c!==f.col))?L:(this.loading||0===d||(g=p&&this.Bj(d),g&&(h=g.getCalcService(),h.calcOnDemand&&!h.IsSuspended()&&(i=g.qg(b,c),i&&i.$l===!0&&(i.$l=!1,delete i.dh,delete i.eh,g.recalculateCell(i),this.yj().yBJ())))),j=a.getValue(b,c,d,this.loading,e),j=E(j))},a.prototype.Tq=function(a,b){var c,d,f,g,h,i;return v(b)&&(b=3),c=e.kf(-1,-1,-1,-1),a&&(d=this,f=a.row,g=a.col,h=a.rowCount,i=a.colCount,g===-1&&(g=0,i=d.getColumnCount(b)),f===-1&&(f=0,h=d.getRowCount(b)),c.col=g,c.row=f,c.colCount=i,c.rowCount=h),c},a.prototype.getRangeRect=function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=new e.Rect((-1),(-1),(-1),(-1)),v=this,w=v.am(),x=v.sr(a,b);if(0===w.width||0===w.height)return u;if(d=v.Gr(a,x),f=v.Hr(b,x),!f||0===f.length||!d||0===d.length)return u;g=v.Tq(c),h=v.ss,i=g.row,j=g.row+g.rowCount-1,k=g.col,l=g.col+g.colCount-1,m=za(v),n=ta(v)-va(v)-1,o=ya(v),p=sa(v)-ua(v)-1,q=f[0].col,r=f[f.length-1].col,s=d[0].row,t=d[d.length-1].row;function y(a,b){for(;a>b;)if(a--,v.getColumnVisible(a))return a;return a}function z(a,b){for(;a<b;)if(a++,v.getColumnVisible(a))return a;return a}function A(a,b){for(;a>b;)if(a--,v.getRowVisible(a))return a;return a}function B(a,b){for(;a<b;)if(a++,v.getRowVisible(a))return a;return a}return k<q&&(k=y(q,k)),l>r&&(l=z(r,l)),i<s&&(i=A(s,i)),j>t&&(j=B(t,j)),l<k||j<i?u:(0===b?k<o&&(u.x=w.kt+qa(h,0,k-1),u.width=qa(h,k,l)):1===b||b===-1?k<=p&&l>=o&&(k<q?u.x=f[0].x-qa(h,k,q-1,x):u.x=f[0].x+qa(h,q,k-1,x),u.width=qa(h,k,l,x)):2===b&&l>p&&(k<q?u.x=w.lt-qa(h,k,q-1):u.x=w.lt+qa(h,q,k-1),u.width=qa(h,k,l)),0===a?i<m&&(u.y=w.nt+ra(h,0,i-1),u.height=ra(h,i,j)):1===a||a===-1?i<=n&&j>=m&&(i<s?u.y=d[0].y-ra(h,i,s-1,x):u.y=d[0].y+ra(h,s,i-1,x),u.height=ra(h,i,j,x)):2===a&&j>n&&(i<s?u.y=w.ot-ra(h,i,s-1):u.y=w.ot+ra(h,s,i-1),u.height=ra(h,i,j)),u)},a.prototype.isIntersectWithArrayFormula=function(a){var b,c,d=p&&this.Bj();if(d)for(b=a.row;b<a.row+a.rowCount;b++)for(c=a.col;c<a.col+a.colCount;c++)if(d.dg(b,c,1,1))return!0;return!1},a.prototype.setRangeActiveCells=function(a,b){this.Jr(a,b),this.repaint()},a.prototype.cm=function(a,b){var c,d,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=new e.Rect((-1),(-1),(-1),(-1)),t=r.am();if(0===t.width||0===t.height)return s;if(c=r.Tq(a,b),d=ya(r),f=za(r),g=ua(r),h=va(r),i=r.ss,j=c.row,k=c.row+c.rowCount-1,l=c.col,m=c.col+c.colCount-1,n=ta(r,b),o=sa(r,b),l<d)s.x=t.kt+qa(i,0,l-1,b),s.width=qa(i,l,N(m,d-1),b),d<=m&&m<o-g?(p=r.it(1),p&&p.length>0&&(s.width+=qa(i,p[0].col,N(m,p[p.length-1].col),b)+r.eCb)):m>=o-g&&(p=r.it(2),p&&p.length>0&&(s.width=p[0].x-s.x,s.width+=qa(i,o-g,N(m,o-1),b)));else if(l<o-g){if(p=r.it(1),!p||0===p.length||l>p[p.length-1].col||m<p[0].col)return s;s.x=t.pt+qa(i,p[0].col,l-1,b)+r.eCb,d<=m&&m<o-g?s.width=qa(i,O(l,p[0].col),N(m,p[p.length-1].col),b):m>=o-g&&(p=r.it(2),p&&p.length>0&&(s.width=p[0].x-s.x,s.width+=qa(i,o-g,N(m,o-1),b)))}else l<o&&(p=r.it(2),p&&p.length>0&&(s.x=t.lt+qa(i,p[0].col,l-1,b),s.width=qa(i,l,N(m,o-1),b)));if(j<f)s.y=t.nt+ra(i,0,j-1,b),s.height=ra(i,j,N(k,f-1),b),f<=k&&k<n-h?(q=r.jt(1),q&&q.length>0&&(s.height+=ra(i,q[0].row,N(k,q[q.length-1].row),b)+r.cCb)):k>=n-h&&(q=r.jt(2),q&&q.length>0&&(s.height=q[0].y-s.y,s.height+=ra(i,n-h,N(k,n-1),b)));else if(j<n-h){if(q=r.jt(1),!q||0===q.length||j>q[q.length-1].row||k<q[0].row)return s;s.y=t.qt+ra(i,q[0].row,j-1,b)+r.cCb,f<=k&&k<n-h?s.height=ra(i,O(j,q[0].row),N(k,q[q.length-1].row),b):k>=n-h&&(q=r.jt(2),q&&q.length>0&&(s.height=q[0].y-s.y,s.height+=ra(i,n-h,N(k,n-1),b)))}else j<n&&(q=r.jt(2),q&&q.length>0&&(s.y=t.ot+ra(i,q[0].row,j-1,b),s.height+=ra(i,j,N(k,n-1),b)));return s},a.prototype.Ws=function(){return this.Xs},a.prototype.rt=function(a,b){return this.dp(a,b)+1},a.prototype.dp=function(a,b){var c="",d=this.yl;return c=b?b:d.Cl(d.Bl()),e.Vn.Xn(a,c)},a.prototype.or=function(a){var b=this,c=b.am(),d=L,e=c.pt,f=b.wNc(c),g=c.lt,h=c.js;return c.zr<a&&a<c.zr+c.Br?d=-1:c.kt<a&&a<c.kt+c.hs?d=0:e<a&&a<e+f?d=1:g<a&&a<g+h&&(d=2),d},a.prototype.nr=function(a){var b=this,c=b.am(),d=L,e=c.qt,f=b.tNc(c),g=c.ot,h=c.gs;return c.Ar<a&&a<c.Ar+c.Cr?d=-1:c.nt<a&&a<c.nt+c.fs?d=0:e<a&&a<e+f?d=1:g<a&&a<g+h&&(d=2),d},a.prototype.pr=function(a,b){var c,d;if(c=b===-1?this.ut():this.jt(b),c&&(d=c.findY(a)))return d.row},a.prototype.qr=function(a,b,c,d,e){var f,g,h;if(f=b===-1?this.vt():d===-1?this.dLJ(b):this.it(b)){if(h=void 0,d!==-1||v(e)?h=f.findX(a):(g=this.ut().findRow(e),h=f.findXByExactY(a,c,g)),h)return h.col;if(f[0]&&(f=this.yl.$KJ(f[0].col,f[0].x),f&&(h=d!==-1||v(e)?f.findX(a):f.findXByExactY(a,c,g)),h))return h.col}},a.prototype.SKJ=function(a,b){var c,d,e,f,g,h,i,j=a.cLJ;return j!==a.col||(c=this,f=a.colViewportIndex,g=a.y,h=a.row,e=this.dLJ(f),d=this.ut().findRow(h),b===j&&(j=c.Zq(j,1)),i=e.findCol(j),i&&g<i.y*d.height+d.y)},a.prototype.wt=function(a,b){var c=this;return c.Jl<=a&&a<c.Jl+c.Lr&&c.Kl<=b&&b<c.Kl+c.Mr},a.prototype.sp=function(a){return this.ITa.sp(a)},a.prototype.tp=function(a){return this.ITa.tp(a)},a.prototype.vp=function(a,b,c,d){var e=this,f=ta(e),g=sa(e);return this.ITa.vp(a,b,c,f,g,d)},a.prototype.wp=function(a,b,c){var d=this,e=ta(d),f=sa(d);return this.ITa.wp(a,b,c,e,f)},a.prototype.xt=function(a,b,c){var d,e,f,g,h,i,j=this,k=j.yt;if(k&&!k.resizeInfo&&!v(c)){if(g=k.hitTestType,h=k.row,i=k.col,1===c)return d=!1,e=j.ITa.findSpan(h,i,1),!e&&j.xJb&&(e=j.xJb.zJb(h,i,1)),e&&(d=e.contains(a,b,1,1)),f=a===h&&b===i||d,g===c&&f;if(2===c)return d=!1,e=j.ITa.findSpan(h,i,2),!e&&j.xJb&&(e=j.xJb.zJb(h,i,2)),e&&(d=e.contains(a,b,1,1)),f=a===h&&b===i||d,g===c&&f;if(3===c)return g===c&&a===h&&b===i;if(0===c)return g===c}return!1},a.prototype.sr=function(a,b){return a>=0&&a<=2&&b>=0?3:a>=0&&a<=2&&b<0?2:a<0&&b>=0?1:a<0&&b<0?0:L},a.prototype.zt=function(a){var b=this.mm;b&&b.zt(a)},a.prototype.zo=function(){var a,b=this,c=b.parent,d=c&&c.qo;return d||(a=b.Xs,d=a&&a.parentElement),d},a.prototype.Pp=function(){var a=this,b=0,c=0,d=1,e=1;a.Jl=b,a.Kl=c,a.Lr=d,a.Mr=e,a.Qr=b,a.Rr=c},a.prototype.Sl=function(a,b,c){var d=this,e=d.getRowHeight(a,b),f=d.zoom();return 1!==f&&(e*=f),c?e:Q(e)},a.prototype.Tl=function(a,b,c){var d=this,e=d.getColumnWidth(a,b),f=d.zoom();return 1!==f&&(e*=f),c?e:Q(e)},a.prototype.At=function(){var a,b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.Dr(),t=r.options,u=t.sheetAreaOffset.left,v=t.sheetAreaOffset.top,w=new e.Rect(s.x+u,s.y+v,O(0,s.width-u),O(0,s.height-v)),x=w.width,y=w.height,z=wa(r),A=xa(r),B={x:w.x,y:w.y,width:w.width,height:w.height,Br:0,Cr:0,hs:0,fs:0,js:0,gs:0,Bt:0,Ct:0,Dt:0,Et:0,kt:0,nt:0,lt:0,ot:0,pt:0,qt:0,jr:0,er:0,zNc:0,ANc:0,uNc:0,xNc:0,zr:0,Ar:0,em:function(){var a=this;return new e.Rect(a.x,a.y,a.Br,a.Cr)},gm:function(a){var b=this;return 0===a?new e.Rect(b.kt,b.y,b.hs,b.Cr):1===a?new e.Rect(b.pt,b.y,r.wNc(b),b.Cr):2===a?new e.Rect(b.lt,b.y,b.js,b.Cr):L},fm:function(a){var b=this;return 0===a?new e.Rect(b.x,b.nt,b.Br,b.fs):1===a?new e.Rect(b.x,b.qt,b.Br,r.tNc(b)):2===a?new e.Rect(b.x,b.ot,b.Br,b.gs):L},Ft:function(a,b){var c=this;if(0===a){if(0===b)return new e.Rect(c.kt,c.nt,c.hs,c.fs);if(1===b)return new e.Rect(c.pt,c.nt,r.wNc(c),c.fs);if(2===b)return new e.Rect(c.lt,c.nt,c.js,c.fs)}else if(1===a){if(0===b)return new e.Rect(c.kt,c.qt,c.hs,r.tNc(c));if(1===b)return new e.Rect(c.pt,c.qt,r.wNc(c),r.tNc(c));if(2===b)return new e.Rect(c.lt,c.qt,c.js,r.tNc(c))}else if(2===a){if(0===b)return new e.Rect(c.kt,c.ot,c.hs,c.gs);if(1===b)return new e.Rect(c.pt,c.ot,r.wNc(c),c.gs);if(2===b)return new e.Rect(c.lt,c.ot,c.js,c.gs)}return L}};if(r.Gt&&(a=r.Gt(),b=0,a.width>0&&(B.x+=a.width+b,x-=a.width+b),a.height>0&&(B.y+=a.height+b,y-=a.height+b)),t.rowHeaderVisible)for(g=r.getColumnCount(2),f=0;f<g;f++)B.Br+=r.Tl(f,2);if(t.colHeaderVisible)for(d=r.getRowCount(1),c=0;c<d;c++)B.Cr+=r.Sl(c,1);if(h=ya(r),h>0)for(g=sa(r),f=0;f<h&&f<g;f++)r.getColumnVisible(f)&&(B.hs+=r.Tl(f));if(i=za(r),i>0)for(d=ta(r),c=0;c<i&&c<d;c++)r.getRowVisible(c)&&(B.fs+=r.Sl(c));if(j=ua(r),j>0)for(g=sa(r),f=O(h,g-j);f<g;f++)B.js+=r.Tl(f);if(k=va(r),k>0)for(d=ta(r),c=O(i,d-k);c<d;c++)B.gs+=r.Sl(c);if(B.zr=B.x,B.Ar=B.y,B.kt=B.zr+B.Br,B.nt=B.Ar+B.Cr,B.pt=B.kt+B.hs,B.qt=B.nt+B.fs,x-=B.Br,y-=B.Cr,x-=B.hs,y-=B.fs,x-=B.js,y-=B.gs,x-=B.xNc,y-=B.uNc,y-=B.Bt,d=ta(r),g=sa(r),l=0,m=g-j,m>0)for(l+=r.eCb,f=O(h,r.qq);f<m&&l<x;f++)l+=r.Tl(f);if(n=O(0,x),l<n?(B.xNc=n-l,B.er=l,n=l):B.er=n,o=0,p=d-k,p>0)for(o+=r.cCb,c=O(i,r.lq);c<p&&o<y;c++)o+=r.Sl(c);return q=O(0,y),o<q?(B.uNc=q-o,B.jr=o,q=o):B.jr=q,B.lt=B.pt+n,B.ot=B.qt+q,A?(B.zNc=B.pt+B.er,B.lt+=B.xNc):B.zNc=B.lt+B.js,z?(B.ANc=B.qt+B.jr,B.ot+=B.uNc):B.ANc=B.ot+B.gs,B.Dt=B.zr,B.Et=B.y+B.height-B.Bt,B},a.prototype.am=function(){var a=this;return a._r||(a._r=a.At()),a._r},a.prototype.Hr=function(a,b){return v(b)||3===b?this.it(a):2===b?this.vt():1===b?1!==this.getRowCount(m.SheetArea.colHeader)?this.it(a):this.dLJ(a):L},a.prototype.vt=function(){var a=this;return a.bs.rowHeader||(a.bs.rowHeader=a.Ht()),a.bs.rowHeader},a.prototype.it=function(a){var b=this;return b.bs.viewport||(b.bs.viewport={}),b.bs.viewport[a]||(b.bs.viewport[a]=b.It(a)),b.bs.viewport[a]},a.prototype.dLJ=function(a){var b=this;return b.bs.colHeader||(b.bs.colHeader={}),b.bs.colHeader[a]||(b.bs.colHeader[a]=b.eLJ(a)),b.bs.colHeader[a]},a.prototype.Ht=function(){var a,b,c=new i.yp,d=this.am(),e=d.zr,f=this.getColumnCount(2);for(b=0;b<f;b++)a=this.Tl(b,2),c.push(new i.zp((-1),b,e,(-1),a,(-1))),e+=a;return c},a.prototype.It=function(a){var b,c,d,e,f,g,h,j,k=this,l=new i.yp,m=k.am(),n=sa(k),o=k.ss,p=ya(k),q=ua(k);if(0===a)for(c=m.kt,n=N(p,n),b=0;b<n;b++)d=o._m(b),e=new i.zp((-1),b,c,(-1),d,(-1)),e.offsetX=k.getColumnScrollOffsetX(b),l.push(e),c+=d;else if(1===a)for(f=xa(k),g=k.eCb,c=m.pt+g,n=f?n-q:n+q,h=k.wNc(m)-g,j=O(p,k.qq),b=j;h>0&&b<n;b++)d=o._m(b),e=new i.zp((-1),b,c,(-1),d,(-1)),e.offsetX=k.getColumnScrollOffsetX(b),l.push(e),c+=d,h-=d;else if(2===a)for(c=m.lt,b=O(p,n-q);b<n;b++)d=o._m(b),e=new i.zp((-1),b,c,(-1),d,(-1)),e.offsetX=k.getColumnScrollOffsetX(b),l.push(e),c+=d;return l},a.prototype.eLJ=function(a){var b,c,d,e,f,g,h,j,k,l,n,o,p=this,q=new i.yp,r=p.am(),s=sa(p),t=p.ss,u=ya(p),w=ua(p),x=p.ITa,y=[],z=[],A=[],B=[];if(0===a)for(c=r.kt,s=N(u,s),b=0;b<s;b++)y[b]=d=t._m(b),z[b]=x.getColumnHeaderFitMode(!1,m.SheetArea.colHeader,b),A[b]=x.MTa(-1,b,-1,1,m.SheetArea.colHeader),e=p.aLJ(b,c,s,0,y,z,A,B),B[b]=e,q.push(e),c+=d;else if(1===a){for(f=xa(p),g=p.eCb,c=r.pt+g,s=f?s-w:s+w,h=p.wNc(r)-g,j=O(u,p.qq),k=j,l=void 0,n=j-1;n>=0;n--)if(y[n]=l=t._m(n),l){if(z[n]=x.getColumnHeaderFitMode(!1,m.SheetArea.colHeader,n),z[n]===m.ColumnHeaderFitMode.normal)break;k=n}for(b=k;h>0&&b<s;b++)y[b]||(y[b]=t._m(b)),v(z[b])&&(z[b]=x.getColumnHeaderFitMode(!1,m.SheetArea.colHeader,b)),d=y[b],A[b]=x.MTa(-1,b,-1,1,m.SheetArea.colHeader),e=p.aLJ(b,c,s,j,y,z,A,B),B[b]=e,b>=j&&(q.push(e),c+=d,h-=d);h<=0&&b<s&&2===x.getColumnHeaderFitMode(!1,m.SheetArea.colHeader,b-1)&&(o=p.aLJ(b,c,s,j,y,z,A,B),B[b]=o,q.push(o))}else if(2===a)for(c=r.lt,j=O(u,s-w),b=j;b<s;b++)y[b]=d=t._m(b),z[b]=x.getColumnHeaderFitMode(!1,m.SheetArea.colHeader,b),A[b]=x.MTa(-1,b,-1,1,m.SheetArea.colHeader),e=p.aLJ(b,c,s,j,y,z,A,B),B[b]=e,q.push(e),c+=d;return q},a.prototype.aLJ=function(a,b,c,d,e,f,g,h){var j,k,l,n,o,p,q,r,s,t,u,w,x,y,z,A,B=this,C=B.ITa,D=B.ss,E=a,F=-1,G=-1,H=f[a],I=e[a],J=g[a],K=B.ODJ,L=K&&K.options&&K.options.defaultStackRowHeight;if(H!==m.ColumnHeaderFitMode.normal&&!C.VKJ(a)&&!J&&!C.MTa(-1,a+1,-1,1,m.SheetArea.colHeader))for(H===m.ColumnHeaderFitMode.stack&&(E=a+1,I+=D._m(E));(C.getColumnHeaderFitMode(!1,m.SheetArea.colHeader,E)!==m.ColumnHeaderFitMode.normal||!D._m(E))&&E<c-1&&!C.MTa(-1,E+1,-1,1,m.SheetArea.colHeader);)if(j=C.getColumnHeaderFitMode(!1,m.SheetArea.colHeader,E),j===m.ColumnHeaderFitMode.vertical&&D._m(E)){
if(H===m.ColumnHeaderFitMode.vertical)break;if(k=B.Zq(E,m.SheetArea.viewport),l=B.br(E,m.SheetArea.viewport,!0),n=C.getColumnHeaderFitMode(!1,m.SheetArea.colHeader,l),o=C.getColumnHeaderFitMode(!1,m.SheetArea.colHeader,k),!(n!==m.ColumnHeaderFitMode.normal&&o!==m.ColumnHeaderFitMode.normal&&k<c)||C.MTa(-1,k+1,-1,1,m.SheetArea.colHeader))break;E++,I+=D._m(E)}else E++,I+=D._m(E);for(E=a-1;E>=d&&!e[E]&&!g[E];)E--;return p=B.ITa.YKJ(a),q=f[E],q!==m.ColumnHeaderFitMode.normal&&e[E]&&!g[E]&&!g[a]&&E>=p?(r=h[E],r===M&&(s=b-B.Tl(E),r=h[E]=B.aLJ(E,s,c,d,e,f,g,h)),q===m.ColumnHeaderFitMode.stack?(t=function(a){for(var b=B.br(a,m.SheetArea.viewport,!0);b>=p&&B.PKJ(b)===m.ColumnHeaderFitMode.stack;)b=B.br(b,m.SheetArea.viewport,!0);return!!(b>=p&&B.PKJ(b)!==m.ColumnHeaderFitMode.normal&&h[b||0]&&h[b||0].y!==-1)&&h[b||0]},u=t(a),v(L)?(x=C.XKJ(a),y=C.UKJ(a),F=x/y):(w=C.XKJ(a,M,!0),F=L*w/B.defaults.colHeaderRowHeight,F=N(F,1)),u&&v(L)?(z=u.height>0?u.height:1,G=(1-F)*z,F=1-G):G=1-F):q===m.ColumnHeaderFitMode.vertical&&(H!==m.ColumnHeaderFitMode.normal?(F=r.y,G=r.height):(G=-1,F=-1))):(G=-1,F=-1),A=new i.zp((-1),a,b,F,I,G),A.offsetX=B.getColumnScrollOffsetX(a),A},a.prototype.Gr=function(a,b){return v(b)||3===b||2===b?this.jt(a):1===b?this.ut():L},a.prototype.Jt=function(a){var b,c,d=new i.yp;for(b=0;b<3;b++)c=this.Gr(b,a),c&&c.length>0&&(d=j.GC$.merge(d,c));return d},a.prototype.Kt=function(a){var b,c,d=new i.yp;for(b=0;b<3;b++)c=this.Hr(b,a),c&&c.length>0&&(d=j.GC$.merge(d,c));return d},a.prototype.ut=function(){var a=this;return a.as.colHeader||(a.as.colHeader=a.Lt()),a.as.colHeader},a.prototype.jt=function(a){var b=this;return b.as.viewport||(b.as.viewport={}),b.as.viewport[a]||(b.as.viewport[a]=b.Mt(a)),b.as.viewport[a]},a.prototype.Lt=function(){var a,b,c=new i.yp,d=this.am(),e=d.Ar,f=this.getRowCount(1);for(b=0;b<f;b++)a=this.Sl(b,1),c.push(new i.zp(b,(-1),(-1),e,(-1),a)),e+=a;return c},a.prototype.Mt=function(a){var b,c,d,e,f,g,h,j,k,l,m,n,o,p=this,q=new i.yp;if(q.amK(),b=za(p),c=va(p),d=p.am(),e=ta(p),j=p.ss,0===a)for(g=d.nt,e=N(b,e),f=0;f<e;f++)h=j.Sl(f),k=new i.zp(f,(-1),(-1),g,(-1),h),q.push(k),q.FW(f,k),g+=h;else if(1===a)for(l=wa(p),m=p.cCb,g=d.qt+m,e=l?e-c:e+c,n=p.tNc(d)-m,o=O(b,p.lq),f=o;n>0&&f<e;f++)h=j.Sl(f),k=new i.zp(f,(-1),(-1),g,(-1),h),q.push(k),q.FW(f,k),g+=h,n-=h;else if(2===a)for(g=d.ot,f=O(b,e-c);f<e;f++)h=j.Sl(f),k=new i.zp(f,(-1),(-1),g,(-1),h),q.push(k),q.FW(f,k),g+=h;return q},a.prototype.Ir=function(a,b,c,d){var f,g,h,j,k,l,m=this,n=m.getRowCount(c),o=m.getColumnCount(c),p=m.Gr(a,c),q=m.Hr(b,c),r=new i.yp;return p&&p.length>0&&q&&q.length>0&&(f=p[0].row,g=q[0].col,h=p[p.length-1].row,j=q[q.length-1].col,k=m.ITa.getSpans(e.kf(f,g,h-f+1,j-g+1),c),d&&m.xJb&&(l=m.xJb.yJb(c),k=k.concat(l)),k.length>0&&m.Nt(k,f,g,h,j,r,n,o,c,p,q)),r},a.prototype.rr=function(a,b,c,d,e){var f,g,h,j,k=this,l=k.getRowCount(c),m=k.getColumnCount(c),n=k.Gr(a,c),o=k.Hr(b,c),p=new i.yp;return n&&n.length>0&&o&&o.length>0?(f=n[0].row,g=o[0].col,h=k.getSpan(d,e,c),h&&(j=[],j.push(h),k.Nt(j,f,g,h.row+h.rowCount,h.col+h.colCount,p,l,m,c,n,o)),p.length>0?p[0]:L):L},a.prototype.Nt=function(a,b,c,d,e,f,g,h,j,k,l){var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=a.length;if(!(G<=0)){for(m=this,o=d+1,p=e+1,q=[],r=[],s=[],t=[],u=0,v=0,n=b-1;n>=0;n--)q[n]=m.Sl(n,j),v-=q[n],t[n]=v;for(v=0,n=b;n<o;n++)t[n]=v,q[n]=m.Sl(n,j),v+=q[n];for(n=c-1;n>=0;n--)r[n]=m.Tl(n,j),u-=r[n],s[n]=u;for(u=0,n=c;n<p;n++)s[n]=u,r[n]=m.Tl(n,j),u+=r[n];for(w=0;w<G;w++)if(x=a[w],x.intersect(b,c,d-b+1,e-c+1)){if(y=x.row+x.rowCount,y>o){for(n=o;n<y;n++)q.push(m.Sl(n,j)),t.push(t[n-1]+q[n]);o=y}if(z=x.col+x.colCount,z>p){for(n=p;n<z;n++)r.push(m.Tl(n,j)),s.push(s[n-1]+r[n]);p=z}for(A=s[x.col],B=t[x.row],C=0,D=0,E=void 0,F=void 0,F=x.col;F<x.col+x.colCount&&F<h;F++)C+=r[F];for(E=x.row;E<x.row+x.rowCount&&E<g;E++)D+=q[E];f.push(new i.zp(x.row,x.col,l[0].x+A,k[0].y+B,C,D,x.rowCount,x.colCount,x.isAutoMerge))}}},a.prototype.qs=function(){var a,b,c,d=this,e=d.parent,f=d.Ot(d.qq),g=d.eCb;f!==-1&&f!==d.qq&&(d.qq=f),a=e&&e.UJc,a&&(b=a.QB===m.ScrollType.pixels,c=b?d.Agc(f)-g:d.Qt(f),a.value(c))},a.prototype.wZJ=function(){var a,b,c=this,d=c.parent,e=d&&d.rZJ;e&&(a=this.getDockScrollbarAttachedIndex(),v(a)||(b=-this.getColumnScrollOffsetX(a),e.value(b)))},a.prototype.os=function(){var a,b,c,d=this,e=d.parent,f=d.Rt(d.lq),g=d.cCb;f!==-1&&f!==d.lq&&(d.lq=f),a=e&&e.VJc,a&&(b=a.QB===m.ScrollType.pixels,c=b?d.Bgc(f)-g:d.Tt(f),a.value(c))},a.prototype.ds=function(){var a,b=this,c=b.parent;c&&c.UJc&&(a=c.options.scrollByPixel,c.UJc.QB=a?m.ScrollType.pixels:m.ScrollType.continuous),c&&c.aq&&(c.options.scrollbarAppearance===m.ScrollbarAppearance.mobile&&c.hfc(),c.options.scrollIgnoreHidden&&(b.Vt=b.Wt(!0)),c.aq())},a.prototype.es=function(){var a,b=this,c=b.parent;c&&c.VJc&&(a=c.options.scrollByPixel,c.VJc.QB=a?m.ScrollType.pixels:m.ScrollType.continuous),c&&c.Xt&&(c.options.scrollbarAppearance===m.ScrollbarAppearance.mobile&&c.hfc(),c.options.scrollIgnoreHidden&&(b.Yt=b.Zt(!0)),c.Xt())},a.prototype.$t=function(){var a=this,b=0,c=ya(a);return b=c>0?a.Zq(c-1):a.$q()},a.prototype._t=function(){var a=this,b=0,c=za(a);return b=c>0?a._q(c-1):a.ar()},a.prototype.$q=function(a){return this.Zq(-1,a)},a.prototype.Zq=function(a,b,c){for(var d=this,e=d.getColumnCount(b),f=c?e-1:e-1-ua(d);a<f;)if(a++,d.getColumnVisible(a,b)&&d.Tl(a,b)>0)return a;return L},a.prototype.br=function(a,b,c){for(var d=this,e=c?0:ya(d);a>e;)if(a--,d.getColumnVisible(a,b)&&d.Tl(a,b)>0)return a;return L},a.prototype.ar=function(a){return this._q(-1,a)},a.prototype._q=function(a,b,c){for(var d=this,e=d.getRowCount(b),f=c?e-1:e-1-va(d);a<f;)if(a++,d.getRowVisible(a,b)&&d.Sl(a,b)>0)return a;return L},a.prototype.gr=function(a,b,c){for(var d=this,e=c?0:za(d);a>e;)if(a--,d.getRowVisible(a,b)&&d.Sl(a,b)>0)return a;return L},a.prototype.au=function(){this.jq=!0,this.os()},a.prototype.bu=function(){this.oq=!0,this.qs()},a.prototype.Bgc=function(a){var b,c,d=this,e=za(d),f=ta(d)-va(d)-e,g=e,h=g+f-1,i=0;if(a<=g)return i;for(a>h&&(a=h),b=g;b<a;b++)c=d.Sl(b),i+=c;return i},a.prototype.Agc=function(a){var b,c,d=this,e=ya(d),f=sa(d)-ua(d)-e,g=e,h=g+f-1,i=0;if(a<=g)return i;for(a>h&&(a=h),b=g;b<a;b++)c=d.Tl(b),i+=c;return i},a.prototype.Tt=function(a){var b,c=this.parent;return c&&c.options.scrollIgnoreHidden?(b=this.Zt().visibleIndex,b[a]):a},a.prototype.cu=function(a){var b,c=this.parent;return c&&c.options.scrollIgnoreHidden?(b=this.Zt().originalIndex,b[a]):a},a.prototype.Qt=function(a){var b,c=this.parent;return c&&c.options.scrollIgnoreHidden?(b=this.Wt().visibleIndex,b[a]):a},a.prototype.du=function(a){var b,c=this.parent;return c&&c.options.scrollIgnoreHidden?(b=this.Wt().originalIndex,b[a]):a},a.prototype.Wt=function(a){var b,c,d,e,f,g,h,i,j=this;if(j.Vt&&!a)return j.Vt;if(b=ya(j),c=sa(j)-ua(j)-b,d=b,e=d+c-1,f=j.ss,g={visibleIndex:{},originalIndex:{}},e-d+1<=0)return g;for(h=0,i=d;i<=e;i++)g.originalIndex[h]=i,g.visibleIndex[i]=h,f._m(i)>0&&h++;for(i--,h--;f._m(i)<=0&&i>=d;)g.originalIndex[h]=i,g.visibleIndex[i]=h,i--;return g},a.prototype.Zt=function(a){var b,c,d,e,f,g,h,i,j=this;if(j.Yt&&!a)return j.Yt;if(b=za(j),c=ta(j)-va(j)-b,d=b,e=d+c-1,f=j.ss,g={visibleIndex:{},originalIndex:{}},e-d+1<=0)return g;for(h=0,i=d;i<=e;i++)g.originalIndex[h]=i,g.visibleIndex[i]=h,f.Sl(i)>0&&h++;for(i--,h--;f.Sl(i)<=0&&i>=d;)g.originalIndex[h]=i,g.visibleIndex[i]=h,i--;return g},a.prototype.Rt=function(a,b){var c,d=this,e=za(d),f=ta(d)-va(d)-1;if(b){if(a>f&&(a=f),c=d.gr(a+1),c!==L&&c>=e)return c}else if(a<e&&(a=e),c=d._q(a-1),c!==L&&c<=f)return c;return-1},a.prototype.Ot=function(a,b){var c,d=this,e=ya(d),f=sa(d)-ua(d)-1;if(b){if(a>f&&(a=f),c=d.br(a+1),c!==L&&c>=e)return c}else if(a<e&&(a=e),c=d.Zq(a-1),c!==L&&c<=f)return c;return-1},a.prototype.eu=function(a,b,c){var d,e,f,g,h;if(c<b)return c;for(d=0,e=this.ss,f=c,g=c;g>=b;g--)if(h=e.Sl(g),!(h<=0)){if(d+=h,d>a)break;f=g}return f},a.prototype.PHb=function(a,b,c){var d,e,f=0,g=c,h=0;for(d=c;d>=b;d--)if(e=this.Sl(d),!(e<=0)&&(f+=e,g=d,f>=a)){h=a-f;break}return{cj:g,UP:h}},a.prototype.fu=function(a,b,c){var d,e,f,g,h;if(c<b)return c;for(d=0,e=this.ss,f=c,g=c;g>=b;g--)if(h=e._m(g),!(h<=0)){if(d+=h,d>a)break;f=g}return f},a.prototype.QHb=function(a,b,c){var d,e,f=0,g=c,h=0;for(d=c;d>=b;d--)if(e=this.Tl(d),!(e<=0)&&(g=d,f+=e,f>=a)){h=a-f;break}return{dj:g,UP:h}},a.prototype.gu=function(){var a,b,c,d=this,e=d.am(),f=d.Hr(1,3),g=0,h=0;if(f)for(a=0;a<f.length;a++)b=f[a].width,g+=b,b>0&&h++;return h=0===h?1:h,c=g/h,0===c?1:P(d.wNc(e)/c)},a.prototype.hu=function(){var a,b,c,d=this,e=d.am(),f=d.Gr(1,3),g=0,h=0;if(f)for(a=0;a<f.length;a++)b=f[a].height,g+=b,b>0&&h++;return h=0===h?1:h,c=g/h,0===c?1:P(d.tNc(e)/c)},a.prototype.ns=function(a){var b,c,d,e,f,g,h;return v(a)&&(a=3),b=this,c=b.parent,d=za(b),e=va(b),c&&c.options.scrollbarMaxAlign?(f=b.am(),b.eu(b.tNc(f),d,ta(b)-e-1)):(g=b.getRowCount(a),3!==a&&2!==a||(g-=e),h=b.gr(g,a),h===L&&(h=d),h)},a.prototype.ps=function(a){var b,c,d,e,f,g;return v(a)&&(a=3),b=this,c=b.parent,d=ya(b),c&&c.options.scrollbarMaxAlign?(e=b.am(),b.fu(b.wNc(e),d,sa(b)-ua(b)-1)):(f=b.getColumnCount(a),3!==a&&1!==a||(f-=ua(b)),g=b.br(f,a),g===L&&(g=d),g)},a.prototype.iu=function(){var b,c,d,e,f=this,g=za(f),h=ya(f),i=ta(f)-va(f)-1,j=sa(f)-ua(f)-1,k=f.ITa,l=k.getLastNonNullRow(3);return l>g&&(g=l),b=k.getLastNonNullCol(3),b>h&&(h=b),c=k.getLastNonNullRow(2),c>g&&(g=c),d=k.getLastNonNullCol(1),d>h&&(h=d),e=a._n,e&&A(e,function(a,b){var c,d=b.lastNonNullRowAndCol;d&&(c=d.call(f),g=O(g,c.lastNonNullRow),h=O(h,c.lastNonNullCol))}),g>i&&(g=i),h>j&&(h=j),{lastNonNullRow:g,lastNonNullCol:h}},a.prototype.getLastNonNullRow=function(){return this.iu().lastNonNullRow},a.prototype.getLastNonNullColumn=function(){return this.iu().lastNonNullCol},a.prototype.mq=function(a,b,c){var d,e=this,f=e.lq,g=e.cCb,h=e.ns(),i=!v(c);f>=e.getRowCount()&&a>h&&(a=h),a>=e._t()&&a<=h&&(i||a!==f||b!==g)&&(d=e.parent,d&&(d.ku&&d.ku.ju(e,a,b||0,c),e.os()),d&&!d.options.scrollbarShowMax&&e.es(),e.invalidateLayout())},a.prototype.rq=function(a,b,c){var d,e=this,f=e.qq,g=e.eCb,h=e.ps(),i=!v(c);f>=e.getColumnCount()&&a>h&&(a=h),a>=e.$t()&&a<=h&&(i||a!==f||b!==g)&&(d=e.parent,d&&(d.ku&&d.ku.lu(e,a,b||0,c),e.qs()),d&&!d.options.scrollbarShowMax&&e.ds(),e.invalidateLayout())},a.prototype.yr=function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=a.row,n=a.col,o=a.hitTestType;return v(m)||v(n)?L:(d=l.getSpan(m,n,o),d&&(m=d.row,n=d.col),l.xJb&&(e=l.xJb.zJb(m,n,o),e&&(m=e.row,n=e.col)),f=l.AHb(m,n,o),g=1===o?-1:M,h=2===o?-1:M,i=l.getCellRect(m,n,g,h,!0),j={sheet:l,row:m,col:n,sheetArea:o},k=f.cellType||l.Al(o),k.h5(b,c,f,i,j))},a.prototype.mu=function(){this.unbindAll(),this.nu()},a.prototype.ou=function(a,b,c){var d,e,f,g,h,i,j,k=this.Tq(a),l=k.row,m=k.col,n=l+k.rowCount,o=m+k.colCount;for(e=l;e<n;e++)for(f=m;f<o;f++)if(g=this.getSpan(e,f,c),h=g?g.row:e,i=g?g.col:f,d=this.getActualStyle(h,i,c),j=b&&this.Ps(e,c),d.locked===!0&&!j)return!0;return!1},a.prototype.pu=function(a,b,c,d,e,f){if(-1<=a&&a<e&&-1<=b&&b<f){if(a===-1&&b===-1)return!0;if(a===-1){if(0!==d&&b+d<=f)return!0}else if(b===-1){if(0!==c&&a+c<=e)return!0}else if(0!==d&&b+d<=f&&0!==c&&a+c<=e)return!0}return!1},a.prototype.qu=function(a,b,c,d){var e,f,g,h=this;return!(a<0&&b<0)&&(a<0&&(e=h.ITa.zl(1),e&&e.spans&&e.spans.length>0)?h.ITa.qu(-1,b,-1,d,1):b<0&&(f=h.ITa.zl(2),f&&f.spans&&f.spans.length>0)?h.ITa.qu(a,-1,c,-1,2):(g=h.ITa.zl(3),!!(g&&g.spans&&g.spans.length>0)&&h.ITa.qu(a,b,c,d,3)))},a.prototype.suspendPaint=function(){var b=this,c=b.Xq;b.Xq++,0===c&&a.ao(b,_,{suspend:!0})},a.prototype.resumePaint=function(){var b=this;b.Xq--,b.Xq<=0&&(b.Xq=0,a.ao(b,_,{suspend:!1}),b.cDJ()&&b.$p())},a.prototype.cDJ=function(){var a=this.parent;return!a||a.getActiveSheet()===this},a.prototype.isPaintSuspended=function(){return this.Xq>0},a.prototype.su=function(a,b){var c,d,e=this,f=a&&a.length;for(c=0;c<f;c++)if(d=a[c],b.intersect(d.row,d.col,d.rowCount,d.colCount))return a.splice(c,1),e.su(a,b.union(d));return b},a.prototype.getClipboardHelperObj=function(){var a=this.tu();return{isCutting:a.G4,ranges:a.n5,showInsertCopyPasteCells:a.YHb}},a.prototype.resetFloatingObjectHelperData=function(a){this.CR&&this.CR.remove(a)},a.prototype.tu=function(){var a=this,b=a.parent;return a.uu||(a.uu=b&&b.uu),a.uu},a.prototype.vu=function(){if(!this.bt){var a=this;a.bt=new f.oo(function(){a.bt&&(a.parent&&a.parent.Xgc&&a.parent.Xgc.endingCallback||a.repaint())})}return this.bt},a.prototype.wu=function(){var a=this,b=a.parent;if(b)return b.commandManager()},a.prototype.Os=function(a,b){this.Wq(e.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:a,message:b})},a.prototype.Bq=function(a,b,c,d,f,g){var h,i;0===this.jm&&(h={sheet:this,sheetName:this.name(),row:b,col:c,sheetArea:d,propertyName:a,oldValue:f,newValue:g,isUndo:this.TIb},this.Wq(e.Events.CellChanged,h),i=this.ITa,i.ZVa(["cellChanged",a,b,c,d,g,f]))},a.prototype.xu=function(a,b,c,d){this.Wq(e.Events.ValueChanged,{sheet:this,sheetName:this.name(),row:a,col:b,oldValue:c,newValue:d})},a.prototype.qCb=function(a,b,c,d,f){var g,h,i;if(0===this.jm){if(g={sheet:this,sheetName:this.name(),col:a,sheetArea:b,propertyName:c,newValue:d,oldValue:f,cancel:!1},"addColumns"!==c&&"deleteColums"!==c||(g.count=d),this.Wq(e.Events.ColumnChanging,g),g.cancel===!0)return!1;h=this.ITa,h.ZVa(["columnChanging",a,b,c,f,d])}return i=this.getDockScrollbarAttachedIndex(),v(i)||this.xZJ(),!0},a.prototype.pq=function(a,b,c,d,f){var g,h,i;0===this.jm?(g={sheet:this,sheetName:this.name(),col:a,sheetArea:b,propertyName:c,newValue:d,oldValue:f,isUndo:this.TIb},"addColumns"!==c&&"deleteColumns"!==c||(g.count=d),this.Wq(e.Events.ColumnChanged,g),h=this.ITa,h.ZVa(["columnChanged",a,b,c,f,d])):this.aPJ(this,[{col:a}],1),i=this.yZJ,v(i)||this.zZJ()},a.prototype.Acc=function(a,b,c,d){var f,g,h,i,j=[];if(this.tables){for(f=this.tables.Ccc(a,b,c,d),g=0;g<f.length;g++)j.push(f[g].name());j.length>0&&(h={isUndo:this.TIb,sheet:this,sheetName:this.name(),row:a,col:c,rowCount:b,colCount:d,tableNames:j,action:2},this.Wq(e.Events.RangeChanged,h),i=this.ITa,i.ZVa(["rangeChanged",a,b,c,d]))}},a.prototype.pCb=function(a,b,c,d,f){var g,h;if(0===this.jm){if(g={sheet:this,sheetName:this.name(),row:a,sheetArea:b,propertyName:c,newValue:d,oldValue:f,cancel:!1},"addRows"!==c&&"deleteRows"!==c||(g.count=d),this.Wq(e.Events.RowChanging,g),g.cancel===!0)return!1;h=this.ITa,h.ZVa(["rowChanging",a,b,c,f,d])}return!0},a.prototype.kq=function(a,b,c,d,f){var g,h;0===this.jm?(g={sheet:this,sheetName:this.name(),row:a,sheetArea:b,propertyName:c,newValue:d,oldValue:f,isUndo:this.TIb},"addRows"!==c&&"deleteRows"!==c||(g.count=d),this.Wq(e.Events.RowChanged,g),h=this.ITa,h.ZVa(["rowChanged",a,b,c,f,d])):this.aPJ(this,[{row:a}],2)},a.prototype.gyb=function(a,b){b!==a&&(this.Wq(e.Events.ViewZoomed,{sheet:this,sheetName:this.name(),oldZoomFactor:a,newZoomFactor:b}),this.Wq(e.Events.UserZooming,{sheet:this,sheetName:this.name(),oldZoomFactor:a,newZoomFactor:b}))},a.prototype.yu=function(a,b){return!(this.n_a||!this.mm.h8J(a,b))&&(this.Wq(e.Events.SelectionChanging,{sheet:this,sheetName:this.name(),oldSelections:a,newSelections:b}),!0)},a.prototype.Au=function(a,b){this.Wq(e.Events.SelectionChanged,{sheet:this,sheetName:this.name(),oldSelections:a,newSelections:this.getSelections(),shiftKey:b})},a.prototype.Bu=function(a,b,c,d,f,g,h,i,j,k,l){var m={sheet:this,sheetName:this.name(),row:a,col:b,rowCount:c,colCount:d,changedCells:f,action:g},n={sheet:this,sheetName:this.name(),row:a,col:b,rowCount:c,colCount:d,changedCells:f,isUndo:!!k,action:g};h&&(m.sheetArea=h,n.sheetArea=h),i&&(m.value=i),(f&&f.length>0||l!==M)&&(j&&j.length>0&&(n.tableNames=j),this.Wq(e.Events.RangeChanged,n),this.Wq(e.Events.FormulaTextboxRangeChanged,m))},a.prototype.Cu=function(a,b){var c={sheet:this,sheetName:this.name(),oldStatus:a,newStatus:b};this.Wq(e.Events.EditorStatusChanged,c)},a.prototype.Du=function(){return this.b4||(this.b4=j.GC$(w("input"))),this.b4},a.prototype.CMc=function(){var a=this;return a.parent&&a.parent.options.pasteSkipInvisibleRange},a.prototype.DMc=function(a,b,c){var d,e=this,f=0,g=e.getColumnWidth,h=e.getColumnCount();for(c&&(g=e.getRowHeight,h=e.getRowCount()),a=a<0?0:a,d=a;d<a+b;d++)d<h&&0===g.call(e,d)&&(f++,b++);return f},a.prototype.FMc=function(a,b,c){var d,e=this,f=0,g=e.getColumnWidth;for(c&&(g=e.getRowHeight),a=a<0?0:a,d=a;d>a-b&&d>0;d--)0===g.call(e,d)&&(f++,b++);return f},a.prototype.EMc=function(a,b,c){var d,e=this,f=0,g=e.getColumnWidth;for(c&&(g=e.getRowHeight),a=a<0?0:a,d=a;d<a+b;d++)0===g.call(e,d)&&f++;return f},a.prototype.bind=function(a,b,c){this.Du().bind(a+da,b,c)},a.prototype.unbind=function(a,b){this.Du().unbind(a+da,b)},a.prototype.Wq=function(a,b,c){this.updateEventsData&&this.updateEventsData(a,b),(0===this.jm||c)&&this.Du().trigger(a,b)},a.prototype.unbindAll=function(){this.unbind(da)},a.prototype.Fu=function(a,b,c){a.indexOf(".")>=0?this.bind(a,b,c):this.bind(a+ea,b,c)},a.prototype.Gu=function(a,b){a.indexOf(".")>=0?this.unbind(a,b):this.unbind(a+ea,b)},a.prototype.nu=function(){this.unbind(ea)},a.prototype.Dr=function(){var a=this.Zs;return new e.Rect(a.x,a.y,a.width,a.height)},a.prototype.Us=function(a){this.Zs=new e.Rect(a.x,a.y,a.width,a.height)},a.prototype.scroll=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=this,o=n.parent;o&&(c=o.options,d=c.scrollByPixel,e=c.scrollPixel,f=o.ku,g=c.scrollbarShowMax,h=c.showHorizontalScrollbar,i=c.showVerticalScrollbar,0!==b&&(j=f._Bb(n,Math.round(b)/e),k=j.dj,l=d?j.UP:0,k===n.qq&&l===n.eCb||(f.lu(n,k,l),h&&(n.qs(),g||(n.oq=!0)))),0!==a&&(m=f.aCb(n,Math.round(a)/e),k=m.cj,l=d?m.UP:0,k===n.lq&&l===n.cCb||(f.ju(n,k,l),i&&(n.os(),g||(n.jq=!0)))))},a.prototype.isCtrlPressed=function(a){return this.mm&&this.mm.ctrl},a.prototype.deselectIgnoreSpan=function(){return!1},a.prototype.ICJ=function(a,b){var c,d,e,f,g,h,i,j,k,l,n,o,p,q,r,s,t,u=this,w=u.zoom(),x=b.newValue,y=b.oldValue,z=b.scrollEventType,A=a.options.scrollByPixel,B=a.options.scrollPixel;if(y=b.oldValue=v(y)?0:A?S(y):I(y+"",10),u.jq=!1,e=u._t(),f=u.ns(),g=a.options.scrollbarShowMax,h=0,A){for(x=S(x),i=x-y,z!==m.Nxb.thumbTrack&&(i*=B*w,x=y+i,x<0&&(x=0)),g||(u.jq=!0,z===m.Nxb.smallIncrement&&x===y?x+=B*w:b.ignoreUpdatePosition=!0),j=u.frozenRowCount(),k=u.getRowCount()-u.frozenTrailingRowCount()-j,l=j,n=l+k-1,o=0,p=0,q=l;q<=n;q++)if(p=u.Sl(q),o+=p,o>=x){h=o-x-p,c=q;break}v(c)&&(c=n,h=-u.Sl(n),x=o)}else c=I(x+"",10),c=u.cu(c),z===m.Nxb.largeDecrement||z===m.Nxb.smallDecrement?(z===m.Nxb.largeDecrement&&(c=u.Ew()),d=u.Rt(c,!0),d!==-1&&d!==c&&(c=d),g||(u.jq=!0,b.ignoreUpdatePosition=!0)):z!==m.Nxb.largeIncrement&&z!==m.Nxb.smallIncrement||(z===m.Nxb.largeIncrement&&(c=u.Fw(),c===u.lq&&c++),g||(u.jq=!0,z===m.Nxb.smallIncrement&&x===y&&c++),d=u.Rt(c),d!==-1&&d!==c&&(c=d)),c<e&&(c=e),c>f&&(c=f);r=A?S(x):u.Tt(c),b.newValue!==r&&(b.newValue=r),s=r,t=u.Sl(c),0!==t&&(s+=R(h)/t),b.newValueWithOffset=A?r:s,(y!==r||A)&&a.ku.Bw(u,c,h)},a.prototype.JCJ=function(a){var b,c,d,e=this,f=a.VJc,g=f.QB===m.ScrollType.pixels;g||(b=e.cu(f.value()),c=e._t(),d=e.ns(),b<c?f.value(e.Tt(c)):b>d&&f.value(e.Tt(d))),a.xw(),a.options.scrollbarShowMax||(a.ku.scrolling?e.jq=!0:a.Xt())},a.prototype.GCJ=function(a,b){var c,d,e,f,g,h,i,j,k,l,n,o,p,q,r,s,t,u=this,w=u.zoom(),x=b.newValue,y=b.oldValue,z=b.scrollEventType,A=a.options.scrollByPixel,B=a.options.scrollPixel;if(y=b.oldValue=v(y)?0:A?S(y):I(y+"",10),u.oq=!1,e=u.$t(),f=u.ps(),g=a.options.scrollbarShowMax,h=0,A){for(x=S(x),i=x-y,z!==m.Nxb.thumbTrack&&(i*=B*w,x=y+i,x<0&&(x=0)),g||(u.oq=!0,z===m.Nxb.smallIncrement&&x===y?x+=B*w:b.ignoreUpdatePosition=!0),j=u.frozenColumnCount(),k=u.getColumnCount()-u.frozenTrailingColumnCount()-j,l=j,n=l+k-1,o=0,p=0,q=l;q<=n;q++)if(p=u.Tl(q),o+=p,o>=x){h=o-x-p,c=q;break}v(c)&&(c=n,h=-u.Tl(n),x=o)}else c=I(x+"",10),c=u.du(c),z===m.Nxb.largeDecrement||z===m.Nxb.smallDecrement?(z===m.Nxb.largeDecrement&&(c=u.zw()),d=u.Ot(c,!0),d!==-1&&d!==c&&(c=d),g||(u.oq=!0,b.ignoreUpdatePosition=!0)):z!==m.Nxb.largeIncrement&&z!==m.Nxb.smallIncrement||(z===m.Nxb.largeIncrement&&(c=u.Aw(),c===u.qq&&c++),g||(u.oq=!0,z===m.Nxb.smallIncrement&&x===y&&c++),d=u.Ot(c),d!==-1&&d!==c&&(c=d)),c<e&&(c=e),c>f&&(c=f);r=A?S(x):u.Qt(c),b.newValue!==r&&(b.newValue=r),s=r,t=u.Tl(c),0!==t&&(s+=R(h)/t),b.newValueWithOffset=A?r:s,(y!==r||A)&&a.ku.Bw(u,c,h,!0)},a.prototype.HCJ=function(a){var b,c,d,e,f=this,g=a.UJc;f&&g&&(b=g.QB===m.ScrollType.pixels,b||(c=f.du(g.value()),d=f.$t(),e=f.ps(),c<d?g.value(f.Qt(d)):c>e&&g.value(f.Qt(e))),a.xw(),a.options.scrollbarShowMax||(a.ku.scrolling?f.oq=!0:a.Ut()))},a.prototype.onHorizontalDockScroll=function(a,b){var c,d,e,f=this.AZJ;v(f)||(c=b.oldValue,d=b.newValue,e=d-c,this.scrollColumnView(f,-e))},a.prototype.Ut=function(a,b,c){var d,e,f,g,h,i,j,k,l,n,o,p,q=this,r=c&&c.QB===m.ScrollType.pixels,s=q.frozenColumnCount(),t=q.getColumnCount()-q.frozenTrailingColumnCount()-s,u=s,v=q.am(),w=q.wNc(v),x=0===t?u:u+t-1,y=q.qq,z=q.eCb,A=0;a?(r?(e=q.QHb(w,u,x),f=e.dj,g=e.UP,d=f,A=g):d=q.fu(w,u,x),x=d):r&&(A=-q.Tl(x)),b?r&&!a&&(A=-q.Tl(x)):(h=q.iu(),i=h.lastNonNullCol,j=q.fu(w,u,i),j===u&&(j++,j>x&&(j=x)),x=y>j?y<x?y:x:j,A=z),y>x?(q.qq=x,q.eCb=r?A:0):y===x&&A>z&&(q.eCb=r?A:0),k=q.Ot(q.qq),k!==-1&&k!==q.qq&&(q.qq=k),c&&(l=0,n=0,o=0,p=0,r?(l=q.Agc(u),n=q.Agc(x)-A,o=w,p=q.Agc(q.qq)-q.eCb):(l=q.Qt(u),n=q.Qt(x),o=q.gu(),p=q.Qt(q.qq),o<1&&(o=1)),c.bw(l),c.cw(n),c.dw(o),c.ew(),c.value(p))},a.prototype.uZJ=function(a){var b,c,d,e,f,g,h;a&&(b=this.getDockScrollbarAttachedIndex(),v(b)||(c=this.getColumnWidth(b),d=this.getColumnScrollWidth(b),e=0,f=d-c,g=c,h=-this.getColumnScrollOffsetX(b),a.bw(e),a.cw(f),a.dw(g),a.ew(),a.value(h)))},a.prototype.Xt=function(a,b,c){var d,e,f,g,h,i,j,k,l,n,o,p,q=this,r=c&&c.QB===m.ScrollType.pixels,s=q.frozenRowCount(),t=q.getRowCount()-q.frozenTrailingRowCount()-s,u=s,v=q.am(),w=0===t?u:u+t-1,x=q.lq,y=q.cCb,z=0,A=q.tNc(v);a?(r?(e=q.PHb(A,u,w),f=e.cj,g=e.UP,d=f,z=g):d=q.eu(A,u,w),w=d):r&&(z=-q.Sl(w)),b?r&&!a&&(z=-q.Sl(w)):(h=q.iu(),i=h.lastNonNullRow,j=q.eu(A,u,i),j===u&&(j++,j>w&&(j=w)),w=x>j?x<w?x:w:j,z=y),x>w?(q.lq=w,q.cCb=r?z:0):x===w&&z>y&&(q.cCb=r?z:0),k=q.Rt(q.lq),k!==-1&&k!==q.lq&&(q.lq=k),c&&(l=0,n=0,o=0,p=0,r?(l=q.Bgc(u),n=q.Bgc(w)-z,o=A,p=q.Bgc(q.lq)-q.cCb):(l=q.Tt(u),n=q.Tt(w),o=q.hu(),p=q.Tt(q.lq),o<1&&(o=1)),c.bw(l),c.cw(n),c.dw(o),c.ew(),c.value(p))},a.prototype.Av=function(){var a,b,c,d,e=this,f=e.getRowCount(),g=e.getColumnCount();for(a=0;a<f;a++)for(b=0;b<g;b++)c=e.getValue(a,b),c instanceof Date&&(d=e.getStyle(a,b),d&&d.$o(c),e.Nq(a,b,d))},a.prototype.bLJ=function(a,b){var c=this;1===c.getRowCount(m.SheetArea.colHeader)&&(c.Vr(a,b,fa,!1,m.SheetArea.colHeader),c.oq=!0,c.$p())},a.prototype.PKJ=function(a){var b=this;return b.ITa.getColumnHeaderFitMode(!1,1,a)},a.prototype.dNJ=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o;return v(d)&&(d=3),f=this,e||(g=f.xHb(a,b,d),v(g))?(h=f.getCellType(a,b,d),i=c,j=f.tq(a,b,"formatter",d),j||(j=f.tq(a,b,"_autoFormatter",d)),j||(k=f.pivotTables,l=3===d&&k?k.findPivotTable(a,b):L,l&&(m=l.WNc(a,b),j=m&&m.formatter)),"General"===j&&(j=M),n={},o=f.tq(a,b,"quotePrefix",d),i=h.format(i,j,n,{sheet:f,row:a,col:b,sheetArea:d,quotePrefix:o}),i&&"string"==typeof i&&(i=i.replace(/\r\n?/g,"\n")),i):g},a.prototype.isRowFilterOut=function(a){return this.Ps(a)},a.prototype.getHDockScrollbarWidth=function(){var a,b,c,d,e,f=this.getDockScrollbarAttachedIndex(),g=this.CBJ,h=0;return g&&!v(f)&&(a=this.frozenTrailingColumnCount(),b=this.getColumnCount(),c=b-a,d=b-1,(f>=c||f<=d)&&(e=this.am(),h=e.js)),h},a.prototype.getDockScrollbarAttachedIndex=function(){return this.AZJ},a.prototype.setDockScrollbarAttachedIndex=function(a){this.AZJ=a,this.oq=!0,this.$p()},a.prototype.xZJ=function(){var a=this.getDockScrollbarAttachedIndex(),b=this.ITa,c=b.YTa(!1,m.SheetArea.viewport),d=c.$CJ(a);this.yZJ=d},a.prototype.zZJ=function(){var a=this.ITa,b=a.YTa(!1,m.SheetArea.viewport),c=b.Hp(),d=this.yZJ,e=c.indexOf(d);e===-1&&(e=L),this.setDockScrollbarAttachedIndex(e)},a.prototype.setScrollableColumnIndexInFrozenTrailingColumnArea=function(a){var b,c,d,e;a>=0&&(b=this.getColumnCount(),c=this.frozenTrailingColumnCount(),d=b-c,e=b-1,a+=d,a<=e&&this.setDockScrollbarAttachedIndex(a))},a.prototype.getColumnScrollWidth=function(a){var b=this.ITa,c=b.YTa(!1,m.SheetArea.viewport);return c.getScrollContentWidth(a)},a.prototype.setColumnScrollWidth=function(a,b){var c=this.ITa,d=c.YTa(!1,m.SheetArea.viewport);d.setScrollContentWidth(a,b),this.oq=!0,this.$p()},a.prototype.getColumnScrollOffsetX=function(a){var b=this.ITa,c=b.YTa(!1,m.SheetArea.viewport);return c.getScrollOffsetX(a)},a.prototype.setColumnScrollOffsetX=function(a,b){var c=this.ITa,d=c.YTa(!1,m.SheetArea.viewport);d.setScrollOffsetX(a,b),this.wZJ(),this.x6a(),this.vZJ(a)},a.prototype.scrollColumnView=function(a,b){var c=this.ITa,d=c.YTa(!1,m.SheetArea.viewport),e=this.getColumnWidth(a),f=this.getColumnScrollWidth(a),g=this.getColumnScrollOffsetX(a),h=g+b;h>0?b=-g:h<e-f&&(b=e-f-g),d.setScrollOffsetX(a,b,!0),this.wZJ(),this.x6a(),this.vZJ(a)},a.prototype.getScrollTooltipContent=function(a,b){var c,d,f="",g=this.qq+1;return a?f=ia().Tip_Row+(this.lq+1):(c=this.getDockScrollbarAttachedIndex(),b&&!v(c)&&(g=this.getDockScrollbarAttachedIndex()+1),1!==this.options.colHeaderAutoText&&(g=e.util.xq(g)),f=ia().Tip_Column+g,b&&!v(c)&&(d=S(this.getColumnScrollOffsetX(c)),f+=" "+ia().Tip_Column_Offset+": "+d)),f},a.prototype.expandSelection=function(a,b){for(var c=new e.Range(b.row,b.col,b.rowCount,b.colCount),d=new e.Range(b.row,b.col,b.rowCount,b.colCount),f=!0,g=!0,h=!0,i=!0;f||g||h||i;)f&&e.util.EYJ(a,c.row-1,c.col-1,c.colCount+2)&&(c.row=c.row-1,c.rowCount=c.rowCount+1),g&&e.util.EYJ(a,c.row+c.rowCount,c.col-1,c.colCount+2)&&(c.rowCount=c.rowCount+1),h&&e.util.FYJ(a,c.row-1,c.col-1,c.rowCount+2)&&(c.col=c.col-1,c.colCount=c.colCount+1),i&&e.util.FYJ(a,c.row-1,c.col+c.colCount,c.rowCount+2)&&(c.colCount=c.colCount+1),f=!1,g=!1,h=!1,i=!1,d.row===c.row?d.rowCount===c.rowCount-1&&(g=!0):(f=!0,d.rowCount===c.rowCount-2&&(g=!0)),d.col===c.col?d.colCount===c.colCount-1&&(i=!0):(h=!0,d.colCount===c.colCount-2&&(i=!0)),d.row=c.row,d.col=c.col,d.rowCount=c.rowCount,d.colCount=c.colCount;return c},a.prototype.deleteBlankContent=function(a,b){1===b.rowCount&&1===b.colCount||(e.util.EYJ(a,b.row,b.col,b.colCount)||(b.row=b.row+1,b.rowCount=b.rowCount-1),e.util.EYJ(a,b.row+b.rowCount-1,b.col,b.colCount)||(b.rowCount=b.rowCount-1),e.util.FYJ(a,b.row,b.col,b.rowCount)||(b.col=b.col+1,b.colCount=b.colCount-1),e.util.FYJ(a,b.row,b.col+b.colCount-1,b.rowCount)||(b.colCount=b.colCount-1))},a.prototype.l5J=function(){return!1},a.prototype.k9J=function(){return ia().Exp_InvalidOperationInProtect},a.prototype.AIb=function(a,b,c){return this.s9J(a,b,c)},a.prototype.s9J=function(a,b,c){return this.ITa.AIb(a,b,c)},a.Np=1,a.Qp=ma,a.Rp=200,a.Sp=20,a.Tp=1,a.Vp=1,a}(),b.Worksheet=na,e.Zn(na),oa=na.prototype,oa.visible=x("visible",m.SheetTabVisible.visible,function(a){var b,c=this,d=c.parent,e=d.sheets,f=e.length,g=j.GC$.inArray(c,e),h=d.getActiveSheetIndex(),i="visible";if(a!==!0&&a!==!1&&a!==m.SheetTabVisible.visible&&a!==m.SheetTabVisible.hidden&&a!==m.SheetTabVisible.veryHidden&&(c._ps[i]=m.SheetTabVisible.visible),a===!0?c._ps[i]=m.SheetTabVisible.visible:a===!1&&(c._ps[i]=m.SheetTabVisible.hidden),a===m.SheetTabVisible.visible||a===!0)h<0?(d.dq(g,1),d.MJc&&d.MJc.gq<0&&(d.MJc.gq=g)):d.aq();else if(g===h){for(b=g+1;b<f&&e[b].visible()!==m.SheetTabVisible.visible;)b++;if(b>=f)for(b=g-1;b>=0&&e[b].visible()!==m.SheetTabVisible.visible;)b--;d.MJc&&b<d.MJc.gq&&(d.MJc.gq=b),b<0?(c.no(!1),d.eq=b,d.fq()):d.dq(b,1)}else d.aq()}),oa.frozenColumnCount=x("frozenColumnCount",0,function(a){var b=this;b.qq<a?b.qq=a:""!==a&&0!==a&&null!==a||(b.qq=0),b.oq=!0,b.$p()},function(a){return a>=0}),oa.frozenRowCount=x("frozenRowCount",0,function(a){var b=this;b.lq<a?b.lq=a:""!==a&&0!==a&&null!==a||(b.lq=0),b.jq=!0,b.$p()},function(a){return a>=0});function Ga(a,b,c,d,e){if((b!==-1||c!==-1)&&(v(e)&&(e=3),3===e)){var f=a.tables&&a.tables.find(b,c);f&&f.NZ&&b===f.footerIndex()&&na.ao(a,"composeTableFooterList",{table:f,row:b,col:c,style:d})}}},"./dist/plugins/autoMerge/autoMerge.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/autoMerge/autoMerge.res.en.js"),b.SR={en:f},g=d.util.JcK,h=d.range_parser.EcK,i=d.XFileConstants.BbK,j=new e.Common.ResourceManager(b.SR,"AutoMerge"),k=j.getResource.bind(j),function(a){a[a.free=0]="free",a[a.restricted=1]="restricted"}(l=b.AutoMergeMode||(b.AutoMergeMode={})),function(a){a[a.none=0]="none",a[a.column=1]="column",a[a.row=2]="row",a[a.columnRow=3]="columnRow",a[a.rowColumn=4]="rowColumn"}(m=b.AutoMergeDirection||(b.AutoMergeDirection={})),function(a){a[a.source=0]="source",a[a.merged=1]="merged"}(n=b.SelectionMode||(b.SelectionMode={})),o=function(a){t(b,a);function b(b,c){var d=a.call(this,b.row,b.col,b.rowCount,b.colCount)||this;return d.sheetArea=c,d.isAutoMerge=!0,d}return b}(d.Range),p=void 0,q=null;function u(a,b,c){return c+"_"+a+"_"+b}function v(a,b,c){return b===a||(b===d.SheetArea.viewport?c&&a===d.SheetArea.rowHeader||!c&&a===d.SheetArea.colHeader:b===d.SheetArea.rowHeader?c&&a===d.SheetArea.viewport:b===d.SheetArea.colHeader&&(!c&&a===d.SheetArea.viewport))}function w(a,b,c){a.clearSpan(b.row,b.col,b.rowCount,b.colCount,c)}function x(a,b,c){var e,f,g,h,i,j,k,l,m,n;return c===d.SheetArea.viewport&&!a.options.allowCellOverflow&&(e=b.row,f=b.col,g=b.rowCount,h=b.colCount,i=a.frozenRowCount(),j=a.frozenColumnCount(),k=a.frozenTrailingRowCount(),l=a.frozenTrailingColumnCount(),m=a.getRowCount(),n=a.getColumnCount(),(0===i||e!==-1&&i<=e)&&(0===j||f!==-1&&j<=f)&&(0===k||e!==-1&&e+g<=m-k)&&(0===l||f!==-1&&f+h<=n-l))?((f===-1||0===f&&h===n)&&(f=a.getViewportLeftColumn(1),h=a.getViewportRightColumn(1)-f+1),(e===-1||0===e&&g===m)&&(e=a.getViewportTopRow(1),g=a.getViewportBottomRow(1)-e+1),d.kf(e,f,g,h)):a.Tq(b,c)}r=function(){function a(a){this.kj=a,this.AJb=[],this.xn={},this.Ny=[]}return a.prototype.no=function(){this.kj=q},a.prototype.add=function(a,b,c,e,f){var g,h,i,j;for(void 0===e&&(e=d.SheetArea.viewport),void 0===f&&(f=n.source),g=this.all(),h=0,i=g;h<i.length;h++)if(j=i[h],j.sheetArea===e&&j.range.intersect(a.row,a.col,a.rowCount,a.colCount))throw Error(k().Exp_RangeIsIntersected);this.AJb.push({range:a,direction:b,mode:c,sheetArea:e,selectionMode:f})},a.prototype.remove=function(a,b){var c,e,f,g;for(void 0===b&&(b=d.SheetArea.viewport),c=this.AJb,e=this.kj.ITa,f=0;f<c.length;f++)if(g=c[f],g.sheetArea===b&&g.range.equals(a)){w(e,a,b),c.splice(f,1);break}},a.prototype.clear=function(a){var b,c,d,e,f,g,h,i,j,k=this.AJb,l=this.kj.ITa;for(b=0;b<k.length;b++)c=k[b],a!==p&&a!==c.sheetArea||w(l,c.range,c.sheetArea);if(a===p)this.AJb=[],this.xn={},this.Ny=[];else{for(d=this.AJb,b=d.length-1;b>=0;b--)d[b].sheetArea===a&&d.splice(b,1);e=this.xn,f=[];for(g in e)e[g].sheetArea===a&&f.push(g);for(h=0,i=f;h<i.length;h++)g=i[h],delete e[g];for(j=this.Ny,b=j.length-1;b>=0;b--)j[b].sheetArea===a&&j.splice(b,1)}},a.prototype.all=function(){return this.AJb},a.prototype.ICc=function(a){return this.AJb.some(function(b){return b.range.containsRange(a)})},a.prototype.RUa=function(a){this.AJb=a,this.BJb()},a.prototype.zJb=function(a,b,c){void 0===c&&(c=d.SheetArea.viewport);var e=this.xn[u(a,b,c)];return e?d.kf(e.row,e.col,e.rowCount,e.colCount):q},a.prototype.yJb=function(a){return void 0===a&&(a=d.SheetArea.viewport),this.Ny.filter(function(b){return b.sheetArea===a})},a.prototype.BJb=function(a,b){var c,e,f,g,h,i,j,k;for(this.xn={},this.Ny=[],c=this.AJb,e=this.kj,f=e.ITa,g=function(c){var g,i=c.direction,j=c.mode,k=c.sheetArea,l=b?e.Tq(c.range,k):x(e,c.range,k),o=c.selectionMode===n.merged;
(o||a)&&w(f,l,k),g=void 0,i===m.column?g=A(e,j,l,k):i===m.row?g=C(e,j,l,k):i===m.columnRow?g=F(e,j,l,k):i===m.rowColumn&&(g=I(e,j,l,k)),g&&(d.GC$.extend(h.xn,g.cache),h.Ny=h.Ny.concat(g.spans),o&&g.spans.forEach(function(a){f.addSpan(a,k)}))},h=this,i=0,j=c;i<j.length;i++)k=j[i],g(k)},a.prototype.rI=function(a,b,c){var e,f,g,h,i,j;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0))for(e=this.AJb,f=0,g=e;f<g.length;f++)h=g[f],v(h.sheetArea,c,!0)&&(i=h.range,j=i.row,a<=j?i.row+=b:j<a&&a<j+i.rowCount&&(i.rowCount+=b))},a.prototype.tI=function(a,b,c){var e,f,g,h,i,j;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0))for(e=this.AJb,f=0,g=e;f<g.length;f++)h=g[f],v(h.sheetArea,c,!1)&&(i=h.range,j=i.col,a<=j?i.col+=b:j<a&&a<j+i.colCount&&(i.colCount+=b))},a.prototype.GR=function(a,b,c){var e,f,g,h,i,j,k,l,m;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0)){for(e=this.AJb,f=[],g=0;g<e.length;g++)h=e[g],v(h.sheetArea,c,!0)&&(i=h.range,j=i.row,k=i.rowCount,a<j?(l=a+b-j,l<=0?j-=b:(j-=l,i.rowCount-=l),j<0&&(i.rowCount+=j,j=0),i.row=j):j<=a&&a<j+k&&(i.rowCount-=Math.min(b,j+k-a)),0===i.rowCount&&f.push(g));for(m=f.length-1;m>=0;m--)e.splice(f[m],1)}},a.prototype.HR=function(a,b,c){var e,f,g,h,i,j,k,l,m;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0)){for(e=this.AJb,f=[],g=0;g<e.length;g++)h=e[g],v(h.sheetArea,c,!1)&&(i=h.range,j=i.col,k=i.colCount,a<j?(l=a+b-j,l<=0?j-=b:(j-=l,i.colCount-=l),j<0&&(i.colCount+=j,j=0),i.col=j):j<=a&&a<j+k&&(i.colCount-=Math.min(b,j+k-a)),0===i.colCount&&f.push(g));for(m=f.length-1;m>=0;m--)e.splice(f[m],1)}},a.prototype.CJb=function(a,b){var c,e,f;for(void 0===b&&(b=d.SheetArea.viewport),c=this.AJb,e=c.length-1;e>=0;e--)f=c[e].range,f.row!==-1&&v(c[e].sheetArea,b,!0)&&(f.row>a-1?c.splice(e,1):f.row+f.rowCount-1>a-1&&(f.rowCount=a-1-f.row+1))},a.prototype.DJb=function(a,b){var c,e,f;for(void 0===b&&(b=d.SheetArea.viewport),c=this.AJb,e=c.length-1;e>=0;e--)f=c[e].range,f.col!==-1&&v(c[e].sheetArea,b,!1)&&(f.col>a-1?c.splice(e,1):f.col+f.colCount-1>a-1&&(f.colCount=a-1-f.col+1))},a.prototype.toJSON=function(){return this.AJb.map(function(a){var b=a.range;return{range:{row:b.row,col:b.col,rowCount:b.rowCount,colCount:b.colCount},direction:a.direction,mode:a.mode,sheetArea:a.sheetArea,selectionMode:a.selectionMode}})},a.prototype.fromJSON=function(a){var b,c,e,f,g,h;if(a)for(b=this.AJb,c=0,e=a;c<e.length;c++)f=e[c],g=f.range,h=f.selectionMode,h===p&&(h=n.source),b.push({range:d.kf(g.row,g.col,g.rowCount,g.colCount),direction:f.direction,mode:f.mode,sheetArea:f.sheetArea,selectionMode:h})},a}(),d.GC$.extend(d.lUa.prototype,{EJb:function(a){var b,c=this,e=c.zTa;!e||!a&&e.originalAutoMerge||(b=c.xJb.all().map(function(a){var b=a.range;return{range:d.kf(b.row,b.col,b.rowCount,b.colCount),direction:a.direction,mode:a.mode,sheetArea:a.sheetArea,selectionMode:a.selectionMode}}),a?e.currentAutoMerge=b:e.originalAutoMerge=b)},GJb:function(a){a&&this.xJb.RUa(a)},HJb:function(a,b){this.EJb(),this.xJb.rI(a,b),this.EJb(!0)},IJb:function(a,b){this.EJb(),this.xJb.GR(a,b),this.EJb(!0)},JJb:function(a,b){this.EJb(),this.xJb.tI(a,b),this.EJb(!0)},KJb:function(a,b){this.EJb(),this.xJb.HR(a,b),this.EJb(!0)},LJb:function(a,b){this.EJb(),this.xJb.CJb(a,b),this.EJb(!0)},MJb:function(a,b){this.EJb(),this.xJb.DJb(a,b),this.EJb(!0)}}),s="autoMerge",d.lUa.$n(s,{init:function(){this.xJb=new r(this.kj)},applyChanges:function(a){var b,c=a.changes,d=a.isUndo;c&&(b=d?c.originalAutoMerge:c.currentAutoMerge,b&&this.GJb(b))},undo:function(a){var b=a.originalAutoMerge;b&&this.GJb(b)},dispose:function(a){var b=this,c=a&&a.clearCache;c!==!1&&b.xJb&&(b.xJb.no(),b.xJb=q)}});function y(a,b){var c,e,f,j=[],k=a.spans;if(k)for(c=0;c<k.length;c++)e=k[c],e&&j.push({n_:d.XFileConstants.CbK,ref:h(e)});f=g(b,i),j.length>0&&(f?f.c_=f.c_.concat(j):(b.c_.push({n_:i,c_:j}),d.util.NcK(b,[d.XFileConstants.AbK,d.XFileConstants.o7a,d.XFileConstants.EbK,d.XFileConstants.FbK,d.XFileConstants.GbK,d.XFileConstants.HbK,"sheetProtection","autoFilter",i,d.XFileConstants.IbK,d.XFileConstants.JbK,d.XFileConstants.uLc,"printOptions","pageMargins","pageSetup","headerFooter","rowBreaks","colBreaks","picture","drawing","legacyDrawing",d.XFileConstants.AiK,d.XFileConstants.yiK,d.XFileConstants.LbK,d.XFileConstants.Xkb])))}function z(a,b){var c,e,f=a.yJb(d.SheetArea.viewport);f.length>0&&(b.spans?b.spans=b.spans.concat(f):b.spans=f),c=a.yJb(d.SheetArea.rowHeader),c.length>0&&(b.rowHeaderSpan?b.rowHeaderSpan=b.rowHeaderSpan.concat(c):b.rowHeaderSpan=c),e=a.yJb(d.SheetArea.colHeader),e.length>0&&(b.colHeaderSpan?b.colHeaderSpan=b.colHeaderSpan.concat(e):b.colHeaderSpan=e)}d.Worksheet.$n(s,{init:function(){var a=this,b=a.xJb=a.ITa.xJb;a.unbind(d.Events.TopRowChanged+"."+s),a.unbind(d.Events.LeftColumnChanged+"."+s),a.bind(d.Events.TopRowChanged+"."+s,function(){var c,e,f,g,h,i,j,k,l=b.all();if(l.length>0)for(c=a.frozenColumnCount(),e=a.getColumnCount()-a.frozenTrailingColumnCount()-1,f=0,g=l;f<g.length;f++)h=g[f],i=h.sheetArea,j=h.range,i===d.SheetArea.viewport?((j.col===-1||j.col<c)&&a.repaint(a.getRangeRect(1,0,j)),(j.col===-1||j.col<=e&&j.col+j.colCount>=c)&&a.repaint(a.getRangeRect(1,1,j)),(j.col===-1||j.col+j.colCount>e)&&a.repaint(a.getRangeRect(1,2,j))):i===d.SheetArea.rowHeader&&(k=a.am(),a.repaint(k.fm(1)))}),a.bind(d.Events.LeftColumnChanged+"."+s,function(){var c,e,f,g,h,i,j,k,l=b.all();if(l.length>0)for(c=a.frozenRowCount(),e=a.getRowCount()-a.frozenTrailingRowCount()-1,f=0,g=l;f<g.length;f++)h=g[f],i=h.sheetArea,j=h.range,i===d.SheetArea.viewport?((j.row===-1||j.row<c)&&a.repaint(a.getRangeRect(0,1,j)),(j.row===-1||j.row<=e&&j.row+j.rowCount>=c)&&a.repaint(a.getRangeRect(1,1,j)),(j.row===-1||j.row+j.rowCount>e)&&a.repaint(a.getRangeRect(2,1,j))):i===d.SheetArea.colHeader&&(k=a.am(),a.repaint(k.gm(1)))})},dispose:function(a){a.clearCache!==!1&&(this.xJb=q,this.unbind(d.Events.TopRowChanged+"."+s),this.unbind(d.Events.LeftColumnChanged+"."+s))},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=a.rowCount,e=a.col,f=a.colCount,g=a.sheetArea,h=this.ITa;"addRows"===b?h.HJb(c,d):"deleteRows"===b?h.IJb(c,d):"addColumns"===b?h.JJb(e,f):"deleteColumns"===b?h.KJb(e,f):"setRowCount"===b?h.LJb(d,g):"setColumnCount"===b&&h.MJb(f,g),"invalidateLayout"===b&&this.Xq<=0&&this.xJb.BJb()},toJson:function(a,b){var c,d=b&&b.ignoreStyle;d||(c=this.xJb,a.autoMergeRangeInfos=c.toJSON(),b&&b.includeAutoMergedCells&&(c.BJb(!0,!0),z(c,a)))},fromJson:function(a,b,c){var d=c&&c.ignoreStyle;d||this.xJb.fromJSON(a.autoMergeRangeInfos)},bdK:function(a,b,c){var d,e,f,g=c&&c.includeStyles===!1;g||(a.lossless.autoMerge={},d=this.xJb,a.lossless.autoMerge.autoMergeRangeInfos=d.toJSON(),e=d.kj.ODJ,c&&c.includeAutoMergedCells&&!e&&(f={},d.BJb(!0,!0),z(d,f),y(f,a)))},cdK:function(a,b,c){var d=c&&c.includeStyles===!1;!d&&a.lossless&&a.lossless.autoMerge&&this.xJb.fromJSON(a.lossless.autoMerge.autoMergeRangeInfos)}}),d.Workbook.$n(s,{onCultureChanged:function(){k()}}),d.GC$.extend(d.Worksheet.prototype,{autoMerge:function(a,b,c,e,f){void 0===b&&(b=m.column),void 0===c&&(c=l.free),void 0===e&&(e=d.SheetArea.viewport),void 0===f&&(f=n.source);var g=this.xJb;return 0===arguments.length?g.all():void(a&&(this.ITa.EJb(),b===m.none?g.remove(a,e):g.add(a,b,c,e,f),this.$p()))}});function A(a,b,c,e){var f,g,h,i,j,k,m,n,r={},s=[],t=c.row,u=c.row+c.rowCount-1,v=c.col,w=c.col+c.colCount-1;for(f=v;f<=w;f++)if(a.getColumnVisible(f,e)&&!(a.getColumnWidth(f,e)<=0)){for(g=b===l.restricted,h=g&&f>v,i=void 0,j=t;j<=u;)if(!a.getRowVisible(j,e)||a.getRowHeight(j,e)<=0)j++;else{if(k=a._q(j,e,!0),k===q||k>u)break;if(E(a,j,f,k,f,e)){if(h&&!B(a,r,j,f,k,f,e)){i&&(m=new o(i,e),s.push(m),H(r,i,m),i=p),j=k;continue}n=k-j+1,i?i.rowCount+=n-1:i=d.kf(j,f,n,1)}else i&&(m=new o(i,e),s.push(m),H(r,i,m),i=p);j=k}i&&(m=new o(i,e),s.push(m),H(r,i,m),i=p)}return{cache:r,spans:s}}function B(a,b,c,d,e,f,g){var h=a.br(d,g,!0),i=b[u(c,h,g)];return i&&i.sheetArea===g&&i.row<=c&&e<=i.row+i.rowCount-1}function C(a,b,c,e){var f,g,h,i,j,k,m,n,r={},s=[],t=c.row,u=c.row+c.rowCount-1,v=c.col,w=c.col+c.colCount-1;for(f=t;f<=u;f++)if(a.getRowVisible(f,e)&&!(a.getRowHeight(f,e)<=0)){for(g=b===l.restricted,h=g&&f>t,i=void 0,j=v;j<=w;)if(!a.getColumnVisible(j,e)||a.getColumnWidth(j,e)<=0)j++;else{if(k=a.Zq(j,e,!0),k===q||k>w)break;if(E(a,f,j,f,k,e)){if(h&&!D(a,r,f,j,f,k,e)){i&&(m=new o(i,e),s.push(m),H(r,i,m),i=p),j=k;continue}n=k-j+1,i?i.colCount+=n-1:i=d.kf(f,j,1,n)}else i&&(m=new o(i,e),s.push(m),H(r,i,m),i=p);j=k}i&&(m=new o(i,e),s.push(m),H(r,i,m),i=p)}return{cache:r,spans:s}}function D(a,b,c,d,e,f,g){var h=a.gr(c,g,!0),i=b[u(h,d,g)];return i&&i.sheetArea===g&&i.col<=d&&f<=i.col+i.colCount-1}function E(a,b,c,d,e,f){var g=a.ITa,h=a.getText(b,c,f),i=a.getText(d,e,f),j="[object Object]",k=""===h&&""===i&&!a.ODJ,l=h===j&&i===j;return!k&&!l&&(h===i&&(!g.findSpan(b,c,f)&&!g.findSpan(d,e,f)))}function F(a,b,c,e){var f,g,h,i,j,k,l,m=A(a,b,c,e),n=m.cache,p=m.spans,r=c.row,s=c.row+c.rowCount-1,t=c.col,v=c.col+c.colCount-1;for(f=r;f<=s;f++)if(a.getRowVisible(f,e)&&!(a.getRowHeight(f,e)<=0))for(g=t;g<=v;g++)if(a.getColumnVisible(g,e)&&!(a.getColumnWidth(g,e)<=0)){if(h=a.Zq(g,e,!0),h===q||h>v)break;E(a,f,g,f,h,e)&&(i=n[u(f,g,e)],j=n[u(f,h,e)],i&&j?i.row===f&&j.row===f&&i.rowCount===j.rowCount&&(i.colCount+=h-g,G(p,j),H(n,j,i)):i?1===i.rowCount&&(i.colCount+=h-g,H(n,new d.Range(f,h,1,1),i)):j?1===j.rowCount&&(j.col=g,j.colCount+=h-g,H(n,new d.Range(f,g,1,1),j)):(k=new d.Range(f,g,1,h-g+1),l=new o(k,e),p.push(l),H(n,k,l)))}return{cache:n,spans:p}}function G(a,b){var c,d;for(c=0;c<a.length;c++)if(d=a[c],d.sheetArea===b.sheetArea&&d.equals(b)){a.splice(c,1);break}}function H(a,b,c){var d,e,f=c.sheetArea;for(d=0;d<b.rowCount;d++)for(e=0;e<b.colCount;e++)a[u(b.row+d,b.col+e,f)]=c}function I(a,b,c,e){var f,g,h,i,j,k,l,m=C(a,b,c,e),n=m.cache,p=m.spans,r=c.row,s=c.row+c.rowCount-1,t=c.col,v=c.col+c.colCount-1;for(f=t;f<=v;f++)if(a.getColumnVisible(f,e)&&!(a.getColumnWidth(f,e)<=0))for(g=r;g<=s;g++)if(a.getRowVisible(g,e)&&!(a.getRowHeight(g,e)<=0)){if(h=a._q(g,e,!0),h===q||h>s)break;E(a,g,f,h,f,e)&&(i=n[u(g,f,e)],j=n[u(h,f,e)],i&&j?i.col===f&&j.col===f&&i.colCount===j.colCount&&(i.rowCount+=h-g,G(p,j),H(n,j,i)):i?1===i.colCount&&(i.rowCount+=h-g,H(n,new d.Range(h,f,1,1),i)):j?1===j.colCount&&(j.row=g,j.rowCount+=h-g,H(n,new d.Range(g,f,1,1),j)):(k=new d.Range(g,f,h-g+1,1),l=new o(k,e),p.push(l),H(n,k,l)))}return{cache:n,spans:p}}},"./dist/plugins/autoMerge/autoMerge.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_RangeIsIntersected="The range should not intersect with exsit ranges."},"./dist/plugins/cellState/cellStateManager.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__assign||function(){return o=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},o.apply(this,arguments)},p=this&&this.__rest||function(a,b){var c,d,e={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.indexOf(c)<0&&(e[c]=a[c]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(d=0,c=Object.getOwnPropertySymbols(a);d<c.length;d++)b.indexOf(c[d])<0&&(e[c[d]]=a[c[d]]);return e};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=d.Common.j.Fa,g=e.GC$.extend,h=void 0,i="cellState",j=[e.CellStatesType.readonly,e.CellStatesType.invalid,e.CellStatesType.dirty,e.CellStatesType.invalidFormula,e.CellStatesType.selected,e.CellStatesType.active,e.CellStatesType.hover,e.CellStatesType.edit];function q(a){var b=a.row,c=a.col,d=a.rowCount,f=a.colCount;return new e.Range(b,c,d,f)}k=function(){function a(a,b){this.kj=a,this.io=b,this.xn=[];for(var c=1;c<=3;c++)this.sCb(c)}return a.prototype.sCb=function(a){this.xn[a]=[]},a.prototype.tCb=function(a){return this.xn[a]},a.prototype.uCb=function(a,b){this.xn[b]=a},a.prototype.NJb=function(a,b){var c,d,e;for(c=0,d=a.length;c<d;c++)if(e=a[c],e.range.equals(b))return c;return-1},a.prototype.Fb=function(a,b){var c,d=this,e=d.tCb(b),f=this.NJb(e,a);f>-1&&(c=e[f],d.OJb(f,c.range,c.style,e,b),e.splice(f,1))},a.prototype.Sb=function(a,b,c){var d=this,e=d.tCb(c),f=d.NJb(e,a),g={range:a,style:b};d.vCb({index:f,cache:e,range:a,style:b,sheetArea:c}),f===-1?e.push(g):e[f]=g},a.prototype.zR=function(a){var b=this.tCb(a),c=this.io;return b.map(function(a){var b=a.range,d=a.style;return{range:q(b),style:d.clone(),state:c}})},a.prototype.Gq=function(a,b,c){var d,e,f,g=this.tCb(c),h=[];for(e=g.length,f=0;f<e;f++)d=g[f],v(a,b,d.range)&&h.push(d);return h.length>0?h:null},a.prototype.PJb=function(a,b,c){var d,e,f,g=this,h=g.tCb(c);if(h&&h.length>0)for(d=0,e=h;d<e.length;d++)if(f=e[d].range,v(a,b,f))return!0;return!1},a.prototype.wCb=function(a,b,c,d,g,h){var i,j,k,l,m=this,n=m.kj,o=m.tCb(g);if(o&&0===o.length)return!1;if(m.io===e.CellStatesType.dirty&&(f(d)||(d&m.io)>0))return n.QJb(b,c,g);if(m.io===e.CellStatesType.selected&&(f(d)||(d&m.io)>0)){for(i=m.kj.getSelections(),j=0,k=i;j<k.length;j++)if(l=k[j],v(b,c,l))return!0;return!1}return m.io===e.CellStatesType.invalid?!(!n.isValid||!(f(d)||(d&m.io)>0))&&!n.isValid(b,c,n.getValue(b,c,g)):m.io===e.CellStatesType.readonly?h&&m.kj.options.isProtected:(m.io&a)>0},a.prototype.xCb=function(a,b){var c=this,d=this.tCb(b);this.yCb({cache:d,sheetArea:b,collection:c,state:c.io,range:a}),this.uCb(r(this.kj,d,a),b)},a.prototype.toJSON=function(){var a,b,c=this,d={};for(b=0;b<=3;b++)a=c.tCb(b),a&&a.length>0&&(d[b]=s(a));return d},a.prototype.fromJSON=function(a,b,c){var d,e,f,g=this;for(g.xn=[],e=1;e<=3;e++)g.sCb(e);for(f in a)a.hasOwnProperty(f)&&(d=g.tCb(f),t(d,a[f],b,c))},a.prototype.zCb=function(a){var b=p(a,[]),c=this,d=c.kj.ITa;d.ACb(o({type:"rangeChange",state:c.io},b))},a.prototype.vCb=function(a){var b=a.index,c=a.cache,d=a.range,e=a.style,f=a.sheetArea,g=this,h=g.kj.ITa;b!==-1&&(e=c[b].style),h.ACb({type:"add",index:b,cache:c,state:g.io,range:d,style:e,sheetArea:f})},a.prototype.OJb=function(a,b,c,d,e){var f=this,g=f.kj.ITa;g.ACb({type:"remove",index:a,range:b,style:c,cache:d,state:f.io,sheetArea:e})},a.prototype.yCb=function(a){var b=p(a,[]),c=this,d=c.kj.ITa;d.ACb(o({type:"clear",state:c.io},b))},a.prototype.rI=function(a,b){var c,d,e=this,f=function(d){c=e.tCb(d),c&&c.length>0&&c.forEach(function(f,g){var h=f.range,i=h.row,j=h.rowCount;a<=i?(h.row=i+b,e.zCb({cache:c,range:h,row:i,index:g,sheetArea:d})):i<a&&a<i+j&&(h.rowCount=h.rowCount+b,e.zCb({cache:c,range:h,rowCount:j,index:g,sheetArea:d}))})};for(d=0;d<=3;d++)f(d)},a.prototype.GR=function(a,b){var c,d,e=this,f=function(d){c=e.tCb(d),c&&c.length>0&&c.forEach(function(f,g){var h,i=f.range,j=i.row,k=i.rowCount;a<j?(h=a+b-j,h<=0?j-=b:(j-=h,i.rowCount-=h),j<0&&(i.rowCount=k+j,j=0),i.row=j,e.zCb({cache:c,range:i,row:j,rowCount:k,index:g,sheetArea:d})):j<=a&&a<j+k&&(i.rowCount=i.rowCount-Math.min(b,j+k-a),e.zCb({cache:c,range:i,rowCount:k,index:g,sheetArea:d}))})};for(d=0;d<=3;d++)f(d)},a.prototype.tI=function(a,b){var c,d,e=this,f=function(d){c=e.tCb(d),c&&c.length>0&&c.forEach(function(f,g){var h=f.range,i=h.col,j=h.colCount;a<=i?(h.col=i+b,e.zCb({cache:c,range:h,col:i,index:g,sheetArea:d})):i<a&&a<i+h.colCount&&(h.colCount=j+b,e.zCb({cache:c,range:h,colCount:j,index:g,sheetArea:d}))})};for(d=0;d<=3;d++)f(d)},a.prototype.HR=function(a,b){var c,d,e=this,f=function(d){c=e.tCb(d),c&&c.length>0&&c.forEach(function(f,g){var h,i=f.range,j=i.col,k=i.colCount;a<j?(h=a+b-j,h<=0?j-=b:(j-=h,i.colCount-=h),j<0&&(i.colCount+=j,j=0),i.col=j,e.zCb({cache:c,range:i,col:j,colCount:k,index:g,sheetArea:d})):j<=a&&a<j+k&&(i.colCount-=Math.min(b,j+k-a),e.zCb({cache:c,range:i,colCount:k,index:g,sheetArea:d}))})};for(d=0;d<=3;d++)f(d)},a.prototype.hyc=function(){this.xn=[],this.kj=null},a}(),l=function(){function a(a){this.kj=a,this.CCb={}}return a.prototype.getCollection=function(a,b){var c=this;return!c.CCb[a]&&b&&(c.CCb[a]=new k(c.kj,a)),c.CCb[a]},a.prototype.hasIntersectInSelectionState=function(a,b,c,d){var f,g,h,i,j=this,k=j.CCb[e.CellStatesType.selected];if(k&&(f=k.tCb(e.SheetArea.viewport),f&&f.length>0))for(g=0,h=f;g<h.length;g++)if(i=h[g].range,i.intersect(a,b,c,d))return!0;return!1},a.prototype.getState=function(a,b,c){var d=this.kj.ITa.XTa(c);return d.getCellState(a,b)||0},a.prototype.remove=function(a,b,c){void 0===c&&(c=e.SheetArea.viewport);var d=this.CCb[b];d.Fb(a,c)},a.prototype.all=function(a,b){var c,d;if(void 0===b&&(b=e.SheetArea.viewport),c=[],f(a))for(d in this.CCb)this.CCb.hasOwnProperty(d)&&(c=c.concat(this.CCb[d].zR(b)));else c=this.CCb[a].zR(b);return c},a.prototype.add=function(a,b,c,d){var g,i,j;if(e.CellStatesType[b]===h)throw Error("Unmatched Cell State Type");f(d)&&(d=3),g=this.getCollection(b,!0),g.Sb(q(a),c,d),i=this.kj,d===e.SheetArea.viewport?i.repaint(i.cm(a)):(j=i.am(),d===e.SheetArea.colHeader&&i.repaint(new e.Rect(j.pt,j.Ar,i.wNc(j),j.Cr)),d===e.SheetArea.rowHeader&&i.repaint(new e.Rect(j.zr,j.qt,j.Br,i.tNc(j))))},a.prototype.clear=function(a,b){this.DCb(a,b)},a.prototype.DCb=function(a,b){for(var c in this.CCb)this.CCb.hasOwnProperty(c)&&this.CCb[c].xCb(a,b)},a.prototype.RJb=function(a,b,c,d,e,f){var g=this,h=g.kj,i=g.CCb[a];i&&i.PJb(b,c,d)&&e!==-1&&f!==-1&&h.repaint(h.gCb(h,b,c,e,f))},a.prototype.getStyle=function(a,b,c,d,g){var h,i,k,l,m,n,o,p,q,r,s,t,u,v;if(f(c)&&(c=3),h=new e.Style,i=[],m=this,n=m.kj,o=n.ITa,p=o.getSpan(a,b,c),f(p)||(a=p.row,b=p.col),q=f(d)?m.getState(a,b,c):m.getState(a,b,c)&d,!f(q)){for(r=0,s=j;r<s.length;r++)t=s[r],l=m.CCb[t],l&&l.wCb(q,a,b,d,c,g)&&(k=l.Gq(a,b,c),k&&k.length>0&&(i=i.concat(k)));if(i.length>0){for(u=i.length,v=u-1;v>=0;v--)h.Yo(i[v].style);return h}}return null},a.prototype.destroy=function(){for(var a in this.CCb)this.CCb.hasOwnProperty(a)&&this.CCb[a].hyc();delete this.CCb,delete this.kj},a.prototype.toJSON=function(){var a,b,c={};for(b in this.CCb)this.CCb.hasOwnProperty(b)&&(a=this.CCb[b],c[b]=a.toJSON());return c},a.prototype.fromJSON=function(a,b,c){var d,e,f,g=this;for(e in a)a.hasOwnProperty(e)&&(f=parseInt(e,10),d=g.getCollection(f,!0),d.fromJSON(a[f],b,c))},a.prototype.rI=function(a,b){for(var c in this.CCb)this.CCb.hasOwnProperty(c)&&this.CCb[c].rI(a,b)},a.prototype.GR=function(a,b){for(var c in this.CCb)this.CCb.hasOwnProperty(c)&&this.CCb[c].GR(a,b)},a.prototype.tI=function(a,b){for(var c in this.CCb)this.CCb.hasOwnProperty(c)&&this.CCb[c].tI(a,b)},a.prototype.HR=function(a,b){for(var c in this.CCb)this.CCb.hasOwnProperty(c)&&this.CCb[c].HR(a,b)},a}(),b.CellStateManager=l;function r(a,b,c){var d=[],e=a.getRowCount(3),f=a.getColumnCount(3);return b.forEach(function(b){d=d.concat(u(a,b.style,b.range,c,e,f))}),d}function s(a){var b,c,d,e,f,g,h,i,j,k,l=[];for(c=0,d=a.length;c<d;c++)b=a[c],e=b.style,f=b.range,g=f.row,h=f.col,i=f.colCount,j=f.rowCount,k={range:{row:g,col:h,colCount:i,rowCount:j},style:e.toJSON()},l.push(k);return l}function t(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p;for(h=0,i=b.length;h<i;h++)g=b[h],j=g.range,k=j.row,l=j.col,m=j.rowCount,n=j.colCount,o=g.style,p=new e.Style,p.fromJSON(o,c,d),f={style:p,range:new e.Range(k,l,m,n)},a.push(f)}function u(a,b,c,d,e,f){var g=a.v_a(c,d,e,f);return g.map(function(a){return{range:a,style:b}})}function v(a,b,c){return c.contains(a,b)}m={init:function(){this.cellStates=new l(this)},dispose:function(a){var b=this;b.cellStates&&a.clearCache!==!1&&(b.cellStates.destroy(),b.cellStates=null)},onLayoutChanged:function(a){var b,c,d=a.changeType,f=a.row,g=a.rowCount,h=a.col,i=a.colCount,j=a.sheetArea,k=this.cellStates;if("addRows"===d)k.rI(f,g);else if("deleteRows"===d)k.GR(f,g);else if("addColumns"===d)k.tI(h,i);else if("deleteColumns"===d)k.HR(h,i);else if("clear"===d&&(3===j&&2===(2&a.type)&&k.DCb(new e.Range(f,h,g,i),j),3===j&&1===(1&a.type)))for(b=f;b<f+g;b++)for(c=h;c<h+i;c++)this.ITa.XTa(j).setCellState(b,c,e.CellStatesType.invalid,!1)},toJson:function(a,b){(!b||b&&!b.ignoreStyle)&&(a.cellStates=this.cellStates.toJSON())},fromJson:function(a,b,c){var d=this,e=c&&!c.ignoreStyle||!c;a&&a.cellStates&&e&&(d.cellStates=new l(d),d.cellStates.fromJSON(a.cellStates,b,c))},bdK:function(a,b,c){var d=c&&c.includeStyles===!1;d||(a.lossless.cellStates=this.cellStates.toJSON())},cdK:function(a,b,c){var d=c&&c.includeStyles===!1;!d&&a.lossless&&a.lossless.cellStates&&this.cellStates.fromJSON(a.lossless.cellStates,h,c)}},n={DIb:function(a,b,c,d,e,f){d&&d<=3&&d>0&&this.cellStates.RJb(a,b,c,d,e,f)},QJb:function(a,b,c){var d=this,e=d.ITa.hUa(c);return e&&e[a]&&e[a][b]}},g(e.Worksheet.prototype,n),e.Worksheet.$n(i,m);function w(a){var b=a.range,c=a.style;return b.constructor.name===Object&&(b=new e.Range(0,0,1,1),b.fromJSON(a.range),c=new e.Style,c.fromJSON(a.style)),{range:b,style:c}}g(e.lUa.prototype,{ACb:function(a){var b,c=this,d=c.zTa;d&&(b=void 0,b=d.originalCellStates?d.originalCellStates:[],b.push(a),d.originalCellStates=b)},FCb:function(a,b){var c=this;a&&a.length>0&&a.forEach(function(a){var d=a.type,e=p(a,["type"]);switch(d){case"rangeChange":c.GCb(o({},e),b);break;case"add":c.HCb(o({},e),b);break;case"clear":c.ICb(o({},e),b);break;case"remove":c.SJb(o({},e),b)}})},ICb:function(a,b){var c=a.cache,d=a.sheetArea,e=a.collection,f=a.state,g=a.range;"Object"===e.constructor.name&&(e=this.kj.cellStates.getCollection(f,!0),c=c.map(function(a){return w(a)})),b?e.uCb(r(this.kj,c,g),d):e.uCb(c,d)},SJb:function(a,b){var c=a.cache,d=a.range,e=a.sheetArea,f=a.state,g=a.style,h=a.index;"Object"===d.constructor.name&&(c=this.kj.cellStates.getCollection(f,!0).tCb(e)),b?c.splice(h,1):c.splice(h,0,w({range:d,style:g}))},HCb:function(a,b){var c,d,e=a.cache,f=a.range,g=a.sheetArea,h=a.state,i=a.style,j=a.index;"Object"===f.constructor.name&&(e=this.kj.cellStates.getCollection(h,!0).tCb(g)),c=w({range:f,style:i}),b?j===-1?e.push(c):e[j]=c:j===-1?(e.forEach(function(a,b){var e=a.range,f=a.style;e===c.range&&f===c.style&&(d=b)}),e.splice(d,1)):e[j].style=c.style},GCb:function(a,b){var c,d=a.cache,f=a.range,g=a.state,i=a.sheetArea,j=a.index,k=a.row,l=a.col,m=a.rowCount,n=a.colCount;"Object"===f.constructor.name&&(d=this.kj.cellStates.getCollection(g,!0).tCb(i),c=new e.Range(0,0,0,0),c.fromJSON(f),f=c),b?d[j].range=f:(f=d[j].range,k!==h&&(f.row=k),l!==h&&(f.col=l),m!==h&&(f.rowCount=m),n!==h&&(f.colCount=n))}}),e.lUa.$n(i,{applyChanges:function(a){var b=a.changes,c=a.isUndo,d=b&&b.originalCellStates;d&&this.FCb(d,!c)},undo:function(a){var b=a.originalCellStates;b&&this.FCb(b)}})},"./dist/plugins/cellState/cellstate.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/cellState/cellStateManager.js")),d(c("./dist/plugins/cellState/stateManager.js"))},"./dist/plugins/cellState/stateManager.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m;Object.defineProperty(b,"__esModule",{value:!0}),e=c("Common"),f=c("Core"),g=e.Common.j.Fa,h=e.Common.j.Na,i=f.GC$.extend,j="states",d={},d[f.RowColumnStates.hover]=function(a,b,c,d){var e,g,h=this,i=c?a===h.hCb:b===h.iCb;return!!i&&(e=h.xt(h.hCb,h.iCb,f.SheetArea.viewport),g=d&&d.some(function(a){return!(!a.contains(h.hCb,h.iCb)||!e)}),!!g)},d[f.RowColumnStates.active]=function(a,b,c,d){var e,f=this,g=c?a===f.Jl:b===f.Kl;return!!g&&(e=h(f.Jl)&&h(f.Kl)&&d&&d.some(function(a){return!!a.contains(f.Jl,f.Kl)}),!!e)},d[f.RowColumnStates.selected]=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o,p,q,r,s=this,t=this.parent.options.hideSelection;if(t&&(e=f.Vl.Xl()===this,!e))return!1;for(g=s.getSelections(),h=!1,i=0,j=g;i<j.length;i++)for(k=j[i],l=0,m=d;l<m.length;l++)n=m[l],k.intersect(n.row,n.col,n.rowCount,n.colCount)&&(o=k.row===-1?0:k.row,p=k.rowCount===-1?s.getRowCount():k.rowCount,q=k.col===-1?0:k.col,r=k.colCount===-1?s.getColumnCount():k.colCount,c&&a>=o&&a<o+p?h=!0:!c&&b>=q&&b<q+r&&(h=!0));return h},d[4]=function(a,b,c,d){return!1},d[f.RowColumnStates.edit]=function(a,b,c,d){var e,g,i,j=this,k=j.Jl,l=j.Kl,m=c?a===k:b===l;return!!m&&(e=j.cellStates,g=(e.getState(k,l,f.SheetArea.viewport)&f.RowColumnStates.edit)===f.RowColumnStates.edit,!!g&&(i=h(k)&&h(l)&&d&&d.some(function(a){return!!a.contains(k,l)}),!!i))},d[f.RowColumnStates.invalid]=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o,p=this,q=c?p.dDJ(a,-1):p.dDJ(-1,b);if(q&&q.length>0&&d)for(e=0,g=d;e<g.length;e++)if(h=g[e],c){for(i=h.col===-1?0:h.col,j=h.colCount===-1?p.getColumnCount():h.colCount,k=i;k<i+j;k++)if(l=p.isValid(a,k,p.getValue(a,k,f.SheetArea.viewport)),!l)return!0}else for(m=h.row===-1?0:h.row,n=h.rowCount===-1?p.getRowCount():h.rowCount,o=m;o<m+n;o++)if(l=p.isValid(o,b,p.getValue(o,b,f.SheetArea.viewport)),!l)return!0;return!1},d[f.RowColumnStates.dirty]=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o,p,q,r,s=this;if(!d||0===d.length)return!1;for(e=s.ITa.hUa(),g=0,h=d;g<h.length;g++){i=h[g];for(j in e)if(e[j]){k=+j,l=e[j];for(m in l)if(l[m]){if(n=+m,o=i.row===-1?0:i.row,p=i.rowCount===-1?this.getRowCount(f.SheetArea.viewport):i.rowCount,q=i.col===-1?0:i.col,r=i.colCount===-1?this.getColumnCount(f.SheetArea.viewport):i.colCount,c&&k===a&&(n>=q&&n<q+r||"n"===l[m]))return!0;if(!c&&n===b&&(k>=o&&k<o+p||"n"===l[m]))return!0}}}return!1},d[f.RowColumnStates.inserted]=function(a){var b,c,d,e=this.getInsertRows();for(b=0,c=e;b<c.length;b++)if(d=c[b],d.row===a)return!0},d[256]=function(a){return!1},d[f.RowColumnStates.invalidFormula]=function(a,b,c,d){var e,g,h,i,j,k=this;if(!d||0===d.length)return!1;for(e=k.cellStates,g=function(d,g,h){return!!((c?a===g:b===h)&&e.getState(g,h)&f.CellStatesType.invalidFormula)},h=0;h<d.length;h++)if(i=d[h],j=k.findSpecialNonNullCellInRange(i,g))return!0;return!1},k=d,l=function(){function a(a){this.eDJ={},this.getStateMethods={},this.context=a,i(this.getStateMethods,k)}return a.prototype.enableState=function(a,b){var c=this.eDJ;g(c[a])&&(c[a]={row:!1,column:!1}),b?c[a].row=!0:c[a].column=!0},a.prototype.disableState=function(a,b){var c=this.eDJ;g(c[a])||(b?c[a].row=!1:c[a].column=!1)},a.prototype.isEnable=function(a,b){var c=this.eDJ;return!g(c[a])&&(b?c[a].row:c[a].column)},a.prototype.getState=function(a,b,c,d,e){var f=this.context,g=this.getStateMethods[c];if("function"==typeof g)return g.call(f,a,b,d,e)?c:0},a.prototype.destroy=function(){delete this.context,delete this.eDJ},a.prototype.fromJSON=function(a){this.eDJ=i({},a)},a.prototype.toJSON=function(){return i({},this.eDJ)},a}(),b.fDJ=l;function n(a,b){if(b){var c=new l(a);return c.fromJSON(b),c}}m={init:function(){this.XCJ=new l(this)},dispose:function(a){var b=this;b.XCJ&&a.clearCache!==!1&&(b.XCJ.destroy(),b.XCJ=null)},toJson:function(a){a.states=this.XCJ.toJSON()},fromJson:function(a){var b=n(this,a&&a.states);b&&(this.XCJ=b)},cdK:function(a){var b=n(this,a&&a.lossless&&a.lossless.states);b&&(this.XCJ=b)},bdK:function(a){a.lossless||(a.lossless={}),a.lossless.states=this.XCJ.toJSON()}},f.Worksheet.$n(j,m)},"./dist/plugins/celltype/buttoncelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=e.Events.SelectionChanged,g=d.Common.j.Fa,h=e.Ul.nl,i=e.CellTypes.Context,j=e.CellTypes.Text,k=e.CellTypes.Base,l=e.GC$,m=l.each,n=null,o=void 0,p="_isFirstMouseUp",q="_mouseupToken";function x(a,b,c,d){var e,f=a.ITa;f&&(f.do("setValueForKey",b,c,p,o,d),e=f.getValueForKey(b,c,q,d),e&&(clearTimeout(e),f.do("setValueForKey",b,c,q,o,d)))}r="#707070",s="#34B4E3",t=".buttonCellType",u={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:n,buttonState:0},v=function(a){w(b,a);function b(){var b,c=a.call(this)||this;return c.typeName="6",b=c,m(u,function(a,c){b["_"+a]=c}),c}return b.prototype.paintValue=function(a,b,c,d,f,g,h,i){var k,l,m,n,o,p,q,t,u,v,w,x;a&&(k=this,l=k._marginLeft,m=k._marginTop,n=c+l,o=d+m,p=f-l-k._marginRight,q=g-m-k._marginBottom,t=n+p>c&&n<c+f&&o+q>d&&o<d+g,p-2>0&&q-2>0&&t&&(a.save(),(n<c||n+p>c+f||o<d||o+q>d+g)&&(a.rect(c,d,f,g),a.clip()),a.beginPath(),u=r,u&&a.strokeStyle!==u&&(a.strokeStyle=u),a.strokeRect(n+.5,o+.5,p-1,q-1),v=void 0,w=k._buttonState,x=k._text,2===w?v=s:(v=k._buttonBackColor,v||(v={degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]})),a.fillStyle!==v&&(a.fillStyle=v),e.To.setFillStyle(a,v,c,d,f,g,function(){a.fillRect(n+1,o+1,p-2,q-2)}),a.restore(),x&&j.prototype.paintValue.call(k,a,x,n,o,p,q,h,i)))},b.prototype.getText=function(a,b){return a},b.prototype.tw=function(a,b,c,d){var e=a.parent;e&&e.tw(a,b,c,d)},b.prototype.getHitInfo=function(a,b,c,d,e){var f,h,i,j,k,l,m=this;return e&&(f=e.sheetArea,(g(f)||3===f)&&d)?(h=d.x+m._marginLeft,i=d.x+d.width-m._marginRight,j=d.y+m._marginTop,k=d.y+d.height-m._marginBottom,l={x:a,y:b,row:e.row,col:e.col,cellRect:d,sheetArea:f,sheet:e.sheet,cellStyle:c},h<=a&&a<=i&&j<=b&&b<=k&&(l.isReservedLocation=!0),l):n},b.prototype.processMouseDown=function(a){var b=this,c=a&&a.sheet;return!(!c||!a.isReservedLocation||b.uK)&&(b.uK=!0,b._buttonState=2,c.repaint(a.cellRect),!0)},b.prototype.processMouseUp=function(a){var b,c,d,e,f,g=this,h=a&&a.sheet;if(g.uK&&h&&a.isReservedLocation){if(g._buttonState=0,h.repaint(a.cellRect),g.uK=!1,b=a.row,c=a.col,d=a.sheetArea,e=h.ITa.getValueForKey(b,c,p,d),!e)return g.tw(h,b,c,d),h.ITa.do("setValueForKey",b,c,p,!0,d),f=setTimeout(function(){x(h,b,c,d)},250),h.ITa.do("setValueForKey",b,c,q,f,d),!0;x(h,b,c,d)}return!1},b.prototype.processMouseLeave=function(a){var b=this,c=a&&a.sheet;c&&b.uK&&(b._buttonState=0,c.repaint(a.cellRect),b.uK=!1)},b.prototype.processKeyDown=function(a,b){var c,d=b.sheet,e=this;return!(!d||e.vK)&&(c=d.getCellRect(b.row,b.col),e._buttonState=2,d.repaint(c),d.Fu(f+t,function(){d.Gu(f+t),e.vK=!1,e._buttonState=0,d.repaint(c)}),e.vK=!0,!0)},b.prototype.processKeyUp=function(a,b){var c,d,e,g=b.sheet,h=this;return!(!g||!h.vK)&&(c=b.row,d=b.col,e=g.getCellRect(c,d),h._buttonState=0,g.repaint(e),g.Gu(f+t),h.tw(g,c,d,b.sheetArea),h.vK=!1,!0)},b.prototype.isReservedKey=function(a,b){return 32===a.keyCode&&!a.ctrlKey&&!a.shiftKey&&!a.altKey},b.prototype.getAutoFitWidth=function(a,b,c,d,e){var f=this,g=i.cp(a,f._text,c,d,e);return g+f._marginLeft+f._marginRight},b.prototype.getAutoFitHeight=function(a,b,c,d,e){var f=this,g=i.ep(a,f._text,c,d,e);return g+f._marginTop+f._marginBottom},b.prototype.JH=function(a){this.isReservedKey(a)&&h(a)},b.prototype.isImeAware=function(a){return!1},b.prototype.toJSON=function(){var a,b=this,c={typeName:b.typeName};return m(u,function(d,e){"buttonState"!==d&&(a=b["_"+d],a!==e&&(c[d]=a))}),c},b.prototype.fromJSON=function(a){var b=this;m(u,function(c){var d=a[c];g(d)||(b["_"+c]=d)})},b.prototype.a5=function(a){},b.prototype.gQa=function(){},b}(k),b.Button=v,m(u,function(a){v.prototype[a]=function(b){return 0===arguments.length?this["_"+a]:(this["_"+a]=b,this)}}),e.CellTypes._o[6]=v},"./dist/plugins/celltype/cellbuttons.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/celltype/celltypes.ns.js"),g=e.Common.j.Fa,h=d.To.No,i=d.Ul.fp,j=d.En.npb,k=void 0,l=null,m=Math.max,n=parseInt,o="#707070",p="#34B4E3",q="#e6e6e6",r="lightgray",s="#CACACA",t="_isFirstMouseUp",u="_mouseupToken",v="_leaveCell",w=0,x=2,y=0,z=2,A=3,B=d.CellTypes.Base,C=d.CellTypes.Context,D="gc-cell-button-canvas",E="gc-editor-",F=E+"left-cellbuttons",G=E+"right-cellbuttons",H=E+"left-of-text-cellbuttons",I=E+"right-of-text-cellbuttons",J="leftButtonArea",K="rightButtonArea",L="leftOfTextButtonArea",M="rightOfTextButtonArea",N="_cellButtonParam",O={},P=d.GC$,Q=[d.ButtonPosition.left,d.ButtonPosition.right,d.ButtonPosition.leftOfText,d.ButtonPosition.rightOfText],
R=new e.Common.ResourceManager(f.SR,"CellTypes"),S=R.getResource.bind(R),function(a){a[a.topLeft=0]="topLeft",a[a.topCenter=1]="topCenter",a[a.topRight=2]="topRight",a[a.MiddleLeft=3]="MiddleLeft",a[a.MiddleCenter=4]="MiddleCenter",a[a.MiddleRight=5]="MiddleRight",a[a.bottomLeft=6]="bottomLeft",a[a.bottomCenter=7]="bottomCenter",a[a.bottomRight=8]="bottomRight"}(T||(T={}));function V(a){switch(a){case J:return d.ButtonPosition.left;case K:return d.ButtonPosition.right;case L:return d.ButtonPosition.leftOfText;case M:return d.ButtonPosition.rightOfText}}function W(a){switch(a){case d.ButtonPosition.left:return J;case d.ButtonPosition.right:return K;case d.ButtonPosition.leftOfText:return L;case d.ButtonPosition.rightOfText:return M}}function X(a){var b,c,d=a.split(" ");for(c=0;c<d.length;c++)if(d[c].indexOf(E)>=0){b=d[c];break}switch(b){case F:return J;case G:return K;case H:return L;case I:return M}}function Y(a){switch(a){case J:return F;case K:return G;case L:return H;case M:return I}}function Z(a,b,c,d){var e,f=a.ITa;f&&(f.do("setValueForKey",b,c,t,k,d),e=f.getValueForKey(b,c,u,d),e&&(clearTimeout(e),f.do("setValueForKey",b,c,u,k,d)))}function $(a,b,c){var e,f;switch(c){case T.topLeft:return new d.Rect(a.x,a.y,Math.min(b.width,a.width),Math.min(b.height,a.height));case T.topCenter:return e=(a.width-b.width)/2,e=Math.max(0,e),new d.Rect(a.x+e,a.y,Math.min(b.width,a.width),Math.min(b.height,a.height));case T.topRight:return e=a.width-b.width,e=Math.max(0,e),new d.Rect(a.x+e,a.y,Math.min(b.width,a.width),Math.min(b.height,a.height));case T.MiddleLeft:return f=(a.height-b.height)/2,f=Math.max(0,f),new d.Rect(a.x,a.y+f,Math.min(b.width,a.width),Math.min(b.height,a.height));case T.MiddleCenter:return e=(a.width-b.width)/2,e=Math.max(0,e),f=(a.height-b.height)/2,f=Math.max(0,f),new d.Rect(a.x+e,a.y+f,Math.min(b.width,a.width),Math.min(b.height,a.height));case T.MiddleRight:return e=a.width-b.width,e=Math.max(0,e),f=(a.height-b.height)/2,f=Math.max(0,f),new d.Rect(a.x+e,a.y+f,Math.min(b.width,a.width),Math.min(b.height,a.height));case T.bottomLeft:return f=a.height-b.height,f=Math.max(0,f),new d.Rect(a.x,a.y+f,Math.min(b.width,a.width),Math.min(b.height,a.height));case T.bottomCenter:return e=(a.width-b.width)/2,e=Math.max(0,e),f=a.height-b.height,f=Math.max(0,f),new d.Rect(a.x+e,a.y+f,Math.min(b.width,a.width),Math.min(b.height,a.height));case T.bottomRight:return e=a.width-b.width,e=Math.max(0,e),f=a.height-b.height,f=Math.max(0,f),new d.Rect(a.x+e,a.y+f,Math.min(b.width,a.width),Math.min(b.height,a.height))}}function _(a,b,c){var d,e=[];for(d=0;d<a.length;d++)e.push({width:va(a[d].button,b,c),height:wa(a[d].button,c)});return e}function aa(a,b,c,d,e,f){var h,i,j,k,l,m=[],n=[];for(h=0;h<a.length;h++)i=b[a[h].index],g(i)?n.push(a[h]):m.push(i);for(j=da(m),h=0;h<n.length;h++)k=va(n[h].button,c,d),l=!f||j.width+k<=f.width,l&&(j.width+=k);return j.height=j.height?j.height:f?f.height:0,j}function ba(a,b,c,e,f,h,i,k,l,m,n,o){var p,q,r,s,t,u,v,w,x,y,z,A=xa(b,c,i,k,!0,[a]);if(A.length>0){switch(ma(A,b,i),a){case d.ButtonPosition.left:p=F;break;case d.ButtonPosition.right:p=G;break;case d.ButtonPosition.leftOfText:p=H;break;case d.ButtonPosition.rightOfText:p=I;break;default:return}switch(q=aa(A,m,f,e,!0,h),r="0",s=j(),t=d.Ul.Ml,(t.mozilla||s>1)&&(r="1px"),u=q.width,v=q.height,w=W(a),g(l.canvasSizes)&&(l.canvasSizes={}),x=l.canvasSizes,x[w]={width:u,height:v},y={width:u+"px",height:v+"px",display:"block",position:"absolute",bottom:r,overflow:"hidden",paddingTop:"0"},z=ca(p,u,v,y),a){case d.ButtonPosition.left:z.style.left="0";break;case d.ButtonPosition.right:z.style.right="0";break;case d.ButtonPosition.leftOfText:z.style.left=x[L].width+"px";break;case d.ButtonPosition.rightOfText:z.style.right=x[M].width+"px";break;default:return}n.appendChild(z)}}function ca(a,b,c,d){var e,f=document.createElement("canvas");f.className=a+" "+D;for(e in d)d.hasOwnProperty(e)&&(f.style[e]=d[e]);return f.width=b,f.height=c,f}function da(a){var b,c,e,f,g;if(a.length<=0)return new d.Rect(0,0,0,0);for(b=a[0].x,c=a[0].y,e=a[0].x+a[0].width,f=a[0].y+a[0].height,g=1;g<a.length;g++)b=Math.min(b,a[g].x),c=Math.min(c,a[g].y),e=Math.max(e,a[g].x+a[g].width),f=Math.max(f,a[g].y+a[g].height);return new d.Rect(b,c,e-b,f-c)}function ea(a){var b=d.Ul.Ml,c=j();return 1!==c?b.mozilla?Math.ceil(a*c):Math.round(a*c):a}function fa(a,b,c,e,f,h,i,j){var k,l,m,n,o,p,q;if(!g(a))for(g(j[c])&&(j[c]={}),ma(b,e.sheet,e.row),k=a.getContext("2d"),l=aa(b,i,f,e,!0),k.setTransform(parseFloat(a.style.width)/l.width,0,0,parseFloat(a.style.height)/l.height,0,0),m=0,n=0,o=new d.Rect(0,0,parseFloat(a.style.width),parseFloat(a.style.height)),p=0;p<b.length&&(q=sa(k,m,n,va(b[p].button,f,e),e.sheet.getRowHeight(e.row),b[p].button,f,e,h,j[c],b[p].index,o),!g(q));p++)m+=q.width}function ga(a,b,c,d,e,f){var h,i,j,k,l;g(f.eventListeners)&&(f.eventListeners={}),g(f.eventListeners[b])&&(f.eventListeners[b]={}),h=f.eventListeners[b],i=h.mouseDownListener=function(f){var g={x:f.offsetX,y:f.offsetY,context:c,cellRect:e,cellStyle:d,buttonArea:b};Da(Ca(g,!0),!0,a)},a.addEventListener("mousedown",i),j=h.mouseUpListener=function(f){var g={x:f.offsetX,y:f.offsetY,context:c,cellRect:e,cellStyle:d,buttonArea:b};Ea(Ca(g,!0),!0,a)},a.addEventListener("mouseup",j),k=h.mouseMoveListener=function(f){var g={x:f.offsetX,y:f.offsetY,context:c,cellRect:e,cellStyle:d,buttonArea:b};Fa(Ca(g,!0),!0,a)},a.addEventListener("mousemove",k),l=h.mouseLeaveListener=function(f){var g={x:f.offsetX,y:f.offsetY,context:c,cellRect:e,cellStyle:d,buttonArea:b};g.x<0&&(g.x=0),g.x>=parseFloat(a.style.width)&&(g.x=parseFloat(a.style.width)-1),Ga(Ca(g,!0),!0,a)},a.addEventListener("mouseleave",l)}function ha(a,b,c,e,f,h,i,j,k,l,m,n){var o,p,q,r,s,t,u,v=xa(b,c,i,j,!0,[a]);if(v.length>0){switch(o=void 0,p=void 0,a){case d.ButtonPosition.left:o=F,p=J;break;case d.ButtonPosition.right:o=G,p=K;break;case d.ButtonPosition.leftOfText:o=H,p=L;break;case d.ButtonPosition.rightOfText:o=I,p=M;break;default:return}if(q=n.querySelector("."+o),g(q))return;switch(r=parseFloat(q.style.width),s=h.options.contentRect,t=h.options.leftExternalRect,u=h.options.rightExternalRect,a){case d.ButtonPosition.left:s.x+=r,s.width-=r;break;case d.ButtonPosition.right:s.width-=r;break;case d.ButtonPosition.leftOfText:t.width+=r;break;case d.ButtonPosition.rightOfText:u.width+=r}fa(q,v,p,e,f,k,l,m),ga(q,p,e,f,h.options.cellRect,k)}}function ia(a,b,c,e,f,g,h){var i,j,k,l,m,n,o=xa(b,c,e,f,!0,[a]);if(o&&o.length>0)switch(i=W(a),j=g&&g[i]&&g[i].width||0,k=h.contentContainer,l=h.contentRect,m=h.leftExternalRect,n=h.rightExternalRect,a){case d.ButtonPosition.left:ka(k,"left",j),l.x+=j,l.width-=j;break;case d.ButtonPosition.leftOfText:ka(k,"left",j),m.width+=j;break;case d.ButtonPosition.right:l.width-=j;break;case d.ButtonPosition.rightOfText:n.width+=j;break;default:return}}function ja(a){return+a.replace("px","")||0}function ka(a,b,c){var d=0;a.style[b]&&(d=ja(a.style[b])),d+=c,a.style[b]=d-1+"px"}function la(a,b){g(b.mouseDownListener)||a.removeEventListener("mousedown",b.mouseDownListener),g(b.mouseUpListener)||a.removeEventListener("mouseup",b.mouseUpListener),g(b.mouseMoveListener)||a.removeEventListener("mousemove",b.mouseMoveListener),g(b.mouseLeaveListener)||a.removeEventListener("mouseleave",b.mouseLeaveListener)}function ma(a,b,c){var d,e,f=b.vu();for(d=0;d<a.length;d++)e=La(a[d].button,c),e&&f.fo(e)}function na(a){var b=a.isPrinting,c=a.printZoomFactor;return b&&"number"==typeof c&&1!==c}function oa(a,b){var c=a.x,d=a.y;return 2===b.columnHeaderFitMode&&b.cornerX&&(a.y=b.cornerY-1,a.width=b.cornerX-c,a.height=a.height-d-1),a}d.CellTypes.Base.$n("cellButton",{beforePaintLabel:function(a){var b,c,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u=a.options.context,v=a.options.style;if(!u.cellOverflowLayout&&v.cellButtons&&v.cellButtons.length>0&&(b=a.options.context.sheet,c=u.row,e=u.col,f=xa(b,v.cellButtons,c,e,!1,[d.ButtonPosition.left,d.ButtonPosition.right]),f&&f.length>0)){if(h=Ia(v),ma(f,b,a.options.context.row),i=a.ctx,!i)return;for(j=oa(a.options.rect,u),i.save(),i.rect(j.x,j.y,j.width,j.height),i.clip(),i.beginPath(),k=j.x,l=j.x+j.width,m=Aa(b,u.row,u.col,u.sheetArea),g(m.layout)&&(m.layout={}),n=m.layout,o=xa(b,v.cellButtons,c,e,!1,[d.ButtonPosition.left]),p=0;p<o.length&&(q=sa(i,k,j.y,va(o[p].button,h,u),j.height,o[p].button,h,u,m,n,o[p].index,j),!g(q));p++)k+=q.width;for(r=k,s=xa(b,v.cellButtons,c,e,!1,[d.ButtonPosition.right]),k=l,p=s.length-1;p>=0&&(t=va(s[p].button,h,u),k-=t,q=sa(i,k,j.y,t,j.height,s[p].button,h,u,m,n,s[p].index,j),!g(q));p--);i.restore(),j.x=r,j.width=k-r}},beforePaintText:function(a){var b,c,e,f,g=a.context,h=a.style;!g.cellOverflowLayout&&h.cellButtons&&h.cellButtons.length>0&&(b=a.context.sheet,c=g.row,e=g.col,f=a.externals,f.left=f.left.concat(_(xa(b,h.cellButtons,c,e,!1,[d.ButtonPosition.leftOfText]),h,g)),f.right=f.right.concat(_(xa(b,h.cellButtons,c,e,!1,[d.ButtonPosition.rightOfText]),h,g)))},beforeFillTextArea:function(a){var b,c,e,f,g,h,i,j,k=a.style,l=k.cellButtons;k.cellButtons&&k.cellButtons.length>0&&(b=a.ctx,c=a.availRect,e=a.textRect,f=a.context,g=f.sheet,h=f.row,i=f.col,j=xa(g,l,h,i,!1,[d.ButtonPosition.leftOfText]),qa(b,j,c,e,k,f,!0))},afterFillTextArea:function(a){var b,c,e,f,g,h,i,j,k=a.style,l=k.cellButtons;k.cellButtons&&k.cellButtons.length>0&&(b=a.ctx,c=a.availRect,e=a.textRect,f=a.context,g=f.sheet,h=f.row,i=f.col,j=xa(g,l,h,i,!1,[d.ButtonPosition.rightOfText]),qa(b,j,c,e,k,f,!1))},onCreateCellEditor:function(a){var b,c,e,f,h,i,j,k,l,m,n,o,p,q,r=a.options.dom;if(r&&r.children&&(b=r.children[0],b&&b.children&&(c=b.children[0]))){if(e=a.context,f=e.sheet,h=e.row,i=e.col,j=a.options.cellStyle,g(j)&&(j=f.getActualStyle(h,i)),k=j.cellButtons,g(k)||k&&k.length<=0)return;for(l=a.options.cellRect,m=new d.Rect(l.x,l.y,l.width,l.height),n=Aa(f,h,i,e.sheetArea),g(n.layout)&&(n.layout={}),o=n.layout,p=!1,q=0;q<k.length;q++)k[q].position!==d.ButtonPosition.leftOfText&&k[q].position!==d.ButtonPosition.rightOfText||(p=!0);for(p&&(b.style.overflow="hidden"),q=0;q<Q.length;q++)ba(Q[q],f,k,e,j,m,h,i,n,o,r,b)}},onActivateCellEditor:function(a){var b,c,d,e,f,h,i=a.context,j=i.sheet,k=i.row,l=i.col,m=a.options.cellStyle,n=m.cellButtons;if(!(g(n)||n.length<=0))for(b=Aa(j,k,l,i.sheetArea),g(b.editorLayout)&&(b.editorLayout={}),c=b.layout,d=b.editorLayout,e=Ia(m),f=a.options.dom,h=0;h<Q.length;h++)ha(Q[h],j,n,i,e,a,k,l,b,c,d,f)},onDeactivateCellEditor:function(a){var b,c,d,e,f,h,i,j=a.context,k=j.sheet,l=j.row,m=j.col,n=k.getActualStyle(l,m,j.sheetArea),o=n.cellButtons;if(o&&o.length>0)for(b=Aa(j.sheet,l,m,j.sheetArea),c=b.eventListeners,d=a.options.dom,e=d.querySelectorAll("."+D),f=0;f<e.length;f++)h=e[f],i=X(h.className),g(i)||g(c)||g(c[i])||(la(h,c[i]),delete b.eventListeners[i])},onUpdateContainer:function(a){var b,c=a.context,d=c.sheet,e=c.row,f=c.col,h=Aa(c.sheet,e,f,c.sheetArea),i=h.canvasSizes,j=a.cellStyle.cellButtons;if(!(g(j)||j.length<=0))for(a.context.preventOverflow=!0,b=0;b<Q.length;b++)ia(Q[b],d,j,e,f,i,a)},getCellButtonHitInfo:function(a){a.paddingHitInfo=Ca(a)},processMouseDownOnCellPadding:function(a){Da(a)},processMouseUpOnCellPadding:function(a){Ea(a)},processMouseMoveOnCellPadding:function(a){Fa(a)},processMouseLeaveOnCellPadding:function(a){Ga(a)},getCellButtonAutoHeight:function(a){var b,c,e=a.context.sheet,f=a.context.row,g=a.context.col,h=a.cellStyle;h.cellButtons&&0!==h.cellButtons.length&&(b=xa(e,h.cellButtons,f,g,!1,[d.ButtonPosition.left,d.ButtonPosition.right]),c=0,b.forEach(function(b){var d=C.ep(l,b.button.caption,h,e.zoom(),a.context)-2,g=La(b.button,f);g&&(d=m(d,ya(b.button))),c=m(d,c)}),a.value=c+1*x)},getCellButtonAutoWidth:function(a){var b,c,e=a.context.sheet,f=a.context.row,g=a.context.col,h=a.cellStyle;h.cellButtons&&0!==h.cellButtons.length&&(b=xa(e,h.cellButtons,f,g,!1,[d.ButtonPosition.left,d.ButtonPosition.right,d.ButtonPosition.leftOfText,d.ButtonPosition.rightOfText]),c=0,b.forEach(function(b){c+=va(b.button,h,a.context,!1)}),a.value=c)}});function pa(a,b,c){switch(c){case d.ButtonPosition.leftOfText:return new d.Rect(a.x,a.y,b.x-a.x,a.height);case d.ButtonPosition.rightOfText:return new d.Rect(b.x+b.width,a.y,a.x+a.width-b.x-b.width,a.height)}}function qa(a,b,c,e,f,h,i){var j,k,l,m,n,o,p,q;if(a&&!(b.length<=0)){if(f=Ia(f),j=h.sheet,ma(b,j,h.row),k=pa(c,e,i?d.ButtonPosition.leftOfText:d.ButtonPosition.rightOfText),a.save(),a.rect(k.x,k.y,k.width,k.height),a.clip(),a.beginPath(),l=Aa(j,h.row,h.col,h.sheetArea),m=Ia(f),g(l.layout)&&(l.layout={}),i)for(n=k.x+k.width,o=b.length-1;o>=0&&(p=va(b[o].button,m,h),n-=p,q=sa(a,n,c.y,va(b[o].button,m,h),k.height,b[o].button,m,h,l,l.layout,b[o].index,c),!g(q));o--);else for(n=k.x,o=0;o<b.length&&(q=sa(a,n,c.y,va(b[o].button,m,h),k.height,b[o].button,m,h,l,l.layout,b[o].index,c),!g(q));o++)n+=q.width;a.restore()}}function ra(a,b,c,e,f){if(!(a+c<f.x||a>f.x+f.width||b+e<f.y||b>f.y+f.height))return a+c>f.x+f.width&&(c=f.x+f.width-a),b+e>f.y+f.height&&(e=f.y+f.height-b),a<f.x&&(a=f.x),b<f.y&&(b=f.y),new d.Rect(a,b,c,e)}function sa(a,b,c,e,f,h,i,j,k,l,m,n){var o,p=y;if(k.buttonDownIndex===m?p=z:k.buttonHoverIndex===m&&(p=A),o=ra(b,c,e,f,n),!g(o))return ta(a,o.x,o.y,o.width,o.height,h,i,j,p,n),l[m]=new d.Rect(o.x,o.y,o.width,o.height),l[m].offsetX=o.x-n.x,l[m].offsetY=o.y-n.y,j.cornerY&&(l[m].offsetY+=j.cornerY),l[m]}function ta(a,b,c,e,f,h,i,j,m,n){var t,u,v,y,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,U,V,W,X,Y,Z;a.save(),a.beginPath(),t=h.useButtonStyle,u=na(j),v=j.printZoomFactor,y=u?v:j.sheet.zoom(),D=t?x*y:0,b+=D,c+=D,e-=2*D,f-=2*D,E=o,F=h.hoverBackColor||r,E&&a.strokeStyle!==E&&(a.strokeStyle=E),t&&a.strokeRect(b+.5,c+.5,e-1,f-1),G=Ma(h.enabled,j.row),t?h.enabled===!1?H=h.buttonBackColor||q:m===z?H=p:m===A||j.visualState===d.VisualState.hover?H=F:(I=a.createLinearGradient(b+e/2,c,b+e/2,c+f),I.addColorStop(.125,"#F6FAFB"),I.addColorStop(1,"#D2DBEB"),H=h.buttonBackColor||I):(H=h.buttonBackColor||"white",m===A&&(h.enabled||g(h.enabled))&&(H=F)),J=i.font,J&&a.font!==J&&(a.font=J),a.fillStyle!==H&&(a.fillStyle=H),b+=1,c+=1,e-=2,f-=2,a.rect(b,c,e,f),a.clip(),a.beginPath(),a.fillRect(b,c,e,f),K=new d.Rect(b,c,e,f),L=new d.Rect(b,c,e,f),M=w*y,N=La(h,j.row),h.caption&&N&&(O=(C.cp(l,h.caption,i,y,j)+2*x)*y,P=ya(h)*y,Q=new d.Rect(0,0,O+P+M,f),R=new d.Rect(b,c,e,f),S=$(R,Q,T.MiddleCenter),h.captionAlign===d.CaptionAlignment.left?(L=new d.Rect(S.x,c,O,f),K=S.x+O+M<b+e-2?new d.Rect(S.x+O+M,c,Math.max(0,P),f):new d.Rect(0,0,0,0)):(K=new d.Rect(S.x,c,Math.min(P,e),f),L=S.x+P+M<b+e-2?new d.Rect(S.x+P+M,c,Math.min(e-2-P-M,O),f):new d.Rect(0,0,0,0))),h.caption&&(U=(C.cp(l,h.caption,i,y,j)+2*x)*y,V=(C.ep(l,h.caption,i,y,j)+2*x)*y,W=new d.Rect(0,0,U,V),X=$(L,W,T.MiddleCenter),Y=new B,i=i.clone(),G===!1&&(i.foreColor=s),i.cellButtons=k,Z=u?0:2,Y.paintValue(a,h.caption,X.x,X.y-Z,X.width,X.height,i,j)),N&&ua(a,h,K.x,K.y,K.width,K.height,N,j,n),a.restore()}function ua(a,b,c,e,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w;a.save(),a.rect(c+2,e+2,f-4,g-4),a.clip(),a.beginPath(),k=i.sheet,l=k.vu(),l.ko(h)?l.CHb(h)&&(m=na(i)?i.printZoomFactor:k.zoom(),n=new d.Rect(c,e,f,g),o=ya(b)-2,p=za(b)-2,q=new d.Rect(0,0,o*m,p*m),r=$(n,q,T.MiddleCenter),s=l.lo(h),t=s.width,u=s.height,d.Ul.Ml.msie&&b.imageType&&(b.imageType===d.ButtonImageType.custom?(O[h]||(s.style.position="absolute",s.style.left="-10000px",s.style.top="-100000px",document.body.appendChild(s),O[h]={width:s.width,height:s.height},document.body.removeChild(s)),t=O[h].width,u=O[h].height):(t=12,u=12)),j&&d.Ul.Ml.msie&&r.x+r.width>j.x+j.width?(v=j.x+j.width-r.x,v>0&&(w=t/(o*m),a.drawImage(s,0,0,v*w,u,r.x,r.y,v,p*m))):a.drawImage(s,0,0,t,u,r.x,r.y,o*m,p*m)):l.fo(h),a.restore()}function va(a,b,c,d){var e,f,h,i,j,k;return void 0===d&&(d=!0),e=na(c)?c.printZoomFactor:c.sheet.zoom(),f=2*x+3,g(a.width)?(h=C.cp(l,a.caption,b,e,c),i=a.useButtonStyle,j=La(a,c.row),j&&(h=ya(a)+h,f=(i?f:0)+w),d?(h+f+7)*e:h+f+7):(k=m(1,a.width),isNaN(k)&&(k=1),d?k*e:k)}function wa(a,b,c){var d,e,f,g,h;return void 0===c&&(c=!0),d=b.sheet,e=na(b)?b.printZoomFactor:d.zoom(),f=d.getRowHeight(b.row),g=a.imageSize?a.imageSize.height:l,h=m(1,g?g:f),isNaN(h)&&(h=1),c?h*e:h}function xa(a,b,c,e,f,h){var i,j,k,l,m,n=[];if(!b||0===b.length)return[];for(i=!1,j=a.ITa.getValueForKey(c,e,v),a.getActiveRowIndex()===c&&a.getActiveColumnIndex()===e&&j!==!0&&(i=!0),k=0;k<b.length;k++)for(l=b[k].visible,m=0;m<h.length;m++)(b[k].position===h[m]||g(b[k].position)&&h[m]===d.ButtonPosition.right)&&(l&&"function"==typeof l?l(c)&&n.push({index:k,button:b[k]}):b[k].visibility===d.ButtonVisibility.onEditing&&f?n.push({index:k,button:b[k]}):b[k].visibility!==d.ButtonVisibility.onEditing&&i?n.push({index:k,button:b[k]}):(b[k].visibility===d.ButtonVisibility.always||g(b[k].visibility))&&n.push({index:k,button:b[k]}));return n}function ya(a){var b;return a.imageSize&&("string"==typeof a.imageSize.width&&(b=n(a.imageSize.width)),"number"==typeof a.imageSize.width&&(b=a.imageSize.width)),(b===l||isNaN(b)||b<0)&&(b=16),b}function za(a){var b;return a.imageSize&&("string"==typeof a.imageSize.height&&(b=n(a.imageSize.height)),"number"==typeof a.imageSize.height&&(b=a.imageSize.height)),(b===l||isNaN(b)||b<0)&&(b=16),b}function Aa(a,b,c,e,f){var g,h={isMouseDownReservedLocation:!1};return e===d.SheetArea.corner?h:(g=a.ITa.getValueForKey(b,c,N,e),g||f||(g=h,Ba(a,b,c,e,g)),g)}function Ba(a,b,c,d,e){a.ITa.setValueForKey(b,c,N,e,d)}function Ca(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;if(void 0===b&&(b=!1),c=a.context.row,e=a.context.col,f=a.cellRect,g=a.cellStyle,h=a.context,i={x:a.x,y:a.y,row:c,col:e,cellRect:f,cellStyle:g,sheetArea:a.context.sheetArea,sheet:a.context.sheet,context:h},j=i.sheet,a.cellStyle.locked!==!1&&j.options.isProtected&&!j.ODJ)return null;if(k=Aa(j,i.row,i.col,i.sheetArea,!0),l=a.cellStyle.cellButtons,!k||!l||l.length<=0)return null;if(m=k.layout,b&&(m=k.editorLayout[a.buttonArea]),!m)return null;n=-1,o=i.x,p=i.y;for(q in m)if(m.hasOwnProperty(q)&&(r=void 0,s=m[q],r=b?new d.Rect(s.x,s.y,s.width,s.height):new d.Rect(f.x+s.offsetX,f.y+s.offsetY,s.width,s.height),r&&r.contains(o,p))){n=+q;break}return n!==-1?i.cellButtonHitInfo={hitButtonIndex:n,buttonConfig:l[n],buttonArea:a.buttonArea}:(t=j.getCellType(i.row,i.col),t&&(u=aa(xa(j,l,c,e,b,[d.ButtonPosition.left]),m,g,h,!1),v=aa(xa(j,l,c,e,b,[d.ButtonPosition.right]),m,g,h,!1),w=new d.Rect(f.x+u.width,f.y,f.width-u.width-v.width,f.height),x=t.getHitInfo(i.x,i.y,g,w,h),x&&x.isReservedLocation&&(i.isReservedLocation=!0))),i}function Da(a,b,c){var e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u;return void 0===b&&(b=!1),!(!a||!a.cellButtonHitInfo)&&(e=a.sheet,h=a.row,i=a.col,j=a.sheetArea,h===e.Jl&&i===e.Kl||j!==d.SheetArea.viewport||e.endEdit()?(a.cellButtonHitInfo.buttonConfig&&(f=a.cellButtonHitInfo.buttonConfig.hasOverLay),k=Aa(e,h,i,a.sheetArea),a.cellButtonHitInfo&&(m=a.cellButtonHitInfo.hitButtonIndex,l=a.cellButtonHitInfo.buttonConfig),n=Ma(l&&l.enabled,a.row),!!(e&&(!k.isMouseDownReservedLocation||f)&&l&&(n||g(n))&&m>=0)&&(k.buttonDownIndex=m,k.isMouseDownReservedLocation=!0,b&&c?(o=a.cellStyle,p=k.layout,q=a.context,r=k.editorLayout,s=a.cellButtonHitInfo&&a.cellButtonHitInfo.buttonArea,t=o.cellButtons,s&&(u=xa(e,t,h,i,!0,[V(s)]),fa(c,u,s,q,o,k,p,r))):e.repaint(a.cellRect),!0)):void 0)}function Ea(a,b,c){var d,e,f,g,h,i,j,k,m,n,o,p,q,r,s,v;if(void 0===b&&(b=!1),a){if(d=a&&a.sheet,e=a.row,f=a.col,g=Aa(d,a.row,a.col,a.sheetArea),h=a.cellButtonHitInfo,g.isMouseDownReservedLocation&&d){if(h&&h.hitButtonIndex>=0&&h.buttonConfig.command&&(i=h.buttonConfig.command,b||d.getActiveRowIndex()===e&&d.getActiveColumnIndex()===f||d.DJ(e,f,1,1,2),"string"==typeof i?d.getParent().commandManager().execute({cmd:i,row:e,col:f,sheetName:d.name(),sheetArea:a.sheetArea}):"function"==typeof i&&i.call(l,d,e,f,a.sheetArea)),b&&g.buttonDownIndex>=0&&c&&(g.buttonDownIndex=-1,j=a.cellStyle,k=g.layout,m=a.context,n=g.editorLayout,o=h&&h.buttonArea,p=j.cellButtons,o&&(q=xa(d,p,e,f,!0,[V(o)]),fa(c,q,o,m,j,g,k,n))),g.buttonDownIndex=-1,b||d.repaint(a.cellRect),g.isMouseDownReservedLocation=!1,r=a.sheetArea,s=d.ITa.getValueForKey(e,f,t,r),!s)return Ja(d,e,f,r),d.ITa.do("setValueForKey",e,f,t,!0,r),v=setTimeout(function(){Z(d,e,f,r)},250),d.ITa.do("setValueForKey",e,f,u,v,r),!0;Z(d,e,f,r)}return!1}}function Fa(a,b,c){var d,e,f,h,i,j,k,l,m,n,o;if(void 0===b&&(b=!1),a)return d=a&&a.sheet,e=Aa(d,a.row,a.col,a.sheetArea),f=-1,a.cellButtonHitInfo&&(f=a.cellButtonHitInfo.hitButtonIndex),f!==(g(e.buttonHoverIndex)?-1:e.buttonHoverIndex)?(e.buttonHoverIndex=f,b?(h=a.cellStyle,i=e.layout,j=a.context,k=e.editorLayout,l=h.cellButtons,m=a.row,n=a.col,c&&(o=c.parentElement,Ha(l,d,m,n,o,j,h,e,i,k))):d.repaint(a.cellRect),!0):void 0}function Ga(a,b,c){var d,e,f,g,h,i,j,k,l,m;void 0===b&&(b=!1),a&&a.cellButtonHitInfo&&(d=a&&a.sheet,e=Aa(d,a.row,a.col,a.sheetArea),b?(e.buttonHoverIndex=-1,a.cellButtonHitInfo.hitButtonIndex>=0&&(f=a.cellStyle,g=e.layout,h=a.context,i=e.editorLayout,j=f.cellButtons,k=a.row,l=a.col,c&&(m=c.parentElement,Ha(j,d,k,l,m,h,f,e,g,i)))):(d&&(e.buttonHoverIndex=-1,e.buttonDownIndex=-1,e.isMouseDownReservedLocation=!1),d.repaint(a.cellRect)))}function Ha(a,b,c,d,e,f,g,h,i,j){var k,l,m,n;for(k=0;k<Q.length;k++)l=W(Q[k]),m=e.querySelector("."+Y(l)),n=xa(b,a,c,d,!0,[V(l)]),fa(m,n,l,f,g,h,i,j)}function Ia(a){var b=a.clone(!0);return b.hAlign=d.HorizontalAlign.left,b.vAlign=d.VerticalAlign.center,b.wordWrap=!1,b.isVerticalText=!1,b.shrinkToFit=!1,b.formatter="General",b.textIndent=0,b}function Ja(a,b,c,d){var e=a.parent;e&&e.tw(a,b,c,d)}U="cellButtons",d.Worksheet.$n(U,{setHost:function(){var a=this;a.bind(d.Events.EnterCell+"."+U,function(b,c){Ka(a,c.row,c.col,!1,c.sheetArea)}),a.bind(d.Events.LeaveCell+"."+U,function(b,c){Ka(a,c.row,c.col,!0,c.sheetArea)}),a.bind(d.Events.TopRowChanged+"."+U,function(b,c){Ka(a,c.row,c.col,!0,c.sheetArea)})},dispose:function(a){var b=this;b.unbind(d.Events.EnterCell+"."+U),b.unbind(d.Events.LeaveCell+"."+U),b.unbind(d.Events.TopRowChanged+"."+U)},processMouseDown:function(a){var b=a.hitInfo.cellTypeHitInfo;b&&b.cellButtonHitInfo&&Da(b)&&(a.r=!0)}}),d.Workbook.$n(U,{onCultureChanged:function(){S()}});function Ka(a,b,c,d,e){var f,g,h=a.AHb(b,c,e);if(h&&h.cellButtons&&h.cellButtons.length>0&&(f=h.cellButtons.filter(function(a){return 1===a.visibility}),f.length>0)){d&&a.ITa.do("setValueForKey",b,c,v,!0,e);try{g=a.getCellRect(b,c,1===e?-1:void 0,2===e?-1:void 0),a.repaint(g)}finally{d&&a.ITa.do("setValueForKey",b,c,v,k,e)}}}function La(a,b){var c,e,f=null,h=a.imageType;if(g(a.imageType))return null;switch(c=Ma(a.enabled,b),e=c||g(c),h){case d.ButtonImageType.dropdown:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case d.ButtonImageType.left:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case d.ButtonImageType.right:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case d.ButtonImageType.clear:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case 3:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";
break;case d.ButtonImageType.ok:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case d.ButtonImageType.plus:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case d.ButtonImageType.minus:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case d.ButtonImageType.redo:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case d.ButtonImageType.undo:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case d.ButtonImageType.search:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case d.ButtonImageType.separator:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case d.ButtonImageType.spinLeft:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case d.ButtonImageType.spinRight:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case d.ButtonImageType.ellipsis:f=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case d.ButtonImageType.expand:f=e?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case d.ButtonImageType.collapse:f=e?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case d.ButtonImageType.custom:f=a.imageSrc}return f}function Ma(a,b){return"function"==typeof a?a(b):a}},"./dist/plugins/celltype/celltypes.entry.js":function(a,b,c){"use strict";var d,e,f,g,h;function i(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.CellTypes.Base,f=d.CellTypes.Context,g=d.CellTypes.EditorType,h=d.CellTypes._o,b.Base=e,b.Context=f,b.EditorType=g,b._o=h,b.vHb=d.CellTypes.vHb,b.wHb=d.CellTypes.wHb,Object.defineProperty(b,"Corner",{set:function(a){a!==b.vHb.Corner&&(b.vHb.Corner=a)},get:function(){return b.vHb.Corner}}),Object.defineProperty(b,"ColumnHeader",{set:function(a){a!==b.vHb.ColumnHeader&&(b.vHb.ColumnHeader=a)},get:function(){return b.vHb.ColumnHeader}}),Object.defineProperty(b,"RowHeader",{set:function(a){a!==b.vHb.RowHeader&&(b.vHb.RowHeader=a)},get:function(){return b.vHb.RowHeader}}),Object.defineProperty(b,"Text",{set:function(a){a!==b.wHb.Text&&(b.wHb.Text=a)},get:function(){return b.wHb.Text}}),i(c("./dist/plugins/celltype/checkboxcelltype.js")),i(c("./dist/plugins/celltype/buttoncelltype.js")),i(c("./dist/plugins/celltype/hyperlinkcelltype.js")),i(c("./dist/plugins/celltype/comboboxcelltype.js")),c("./dist/plugins/celltype/cellbuttons.js"),i(c("./dist/plugins/celltype/editor/colorpicker.js")),i(c("./dist/plugins/celltype/editor/timepicker.js")),i(c("./dist/plugins/celltype/editor/calendar.js")),i(c("./dist/plugins/celltype/editor/calculator.js")),i(c("./dist/plugins/celltype/editor/monthPicker.js")),i(c("./dist/plugins/celltype/editor/listControl.js")),i(c("./dist/plugins/celltype/dropdown-action.js")),i(c("./dist/plugins/celltype/radiochecklistcelltype.js")),i(c("./dist/plugins/celltype/celltypes.ns.js")),i(c("./dist/plugins/celltype/rangecelltype.js")),i(c("./dist/plugins/celltype/dataobjectcelltype.js")),i(c("./dist/plugins/celltype/editor/popupControl.js"))},"./dist/plugins/celltype/celltypes.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/celltype/celltypes.res.en.js");b.SR={en:d}},"./dist/plugins/celltype/celltypes.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OK="OK",b.Cancel="Cancel",b.Calendar_ShortWeeks_1="MON",b.Calendar_ShortWeeks_2="TUE",b.Calendar_ShortWeeks_3="WED",b.Calendar_ShortWeeks_4="THU",b.Calendar_ShortWeeks_5="FRI",b.Calendar_ShortWeeks_6="SAT",b.Calendar_ShortWeeks_7="SUN",b.Calendar_Weeks_1="Monday",b.Calendar_Weeks_2="Tuesday",b.Calendar_Weeks_3="Wednesday",b.Calendar_Weeks_4="Thursday",b.Calendar_Weeks_5="Friday",b.Calendar_Weeks_6="Saturday",b.Calendar_Weeks_7="Sunday",b.Calendar_ShortMonths_1="JAN",b.Calendar_ShortMonths_2="FEB",b.Calendar_ShortMonths_3="MAR",b.Calendar_ShortMonths_4="APR",b.Calendar_ShortMonths_5="MAY",b.Calendar_ShortMonths_6="JUN",b.Calendar_ShortMonths_7="JUL",b.Calendar_ShortMonths_8="AUG",b.Calendar_ShortMonths_9="SEP",b.Calendar_ShortMonths_10="OCT",b.Calendar_ShortMonths_11="NOV",b.Calendar_ShortMonths_12="DEC",b.Calendar_Months_1="JANUARY",b.Calendar_Months_2="FEBRUARY",b.Calendar_Months_3="MARCH",b.Calendar_Months_4="APRIL",b.Calendar_Months_5="MAY",b.Calendar_Months_6="JUNE",b.Calendar_Months_7="JULY",b.Calendar_Months_8="AUGUST",b.Calendar_Months_9="SEPTEMBER",b.Calendar_Months_10="OCTOBER",b.Calendar_Months_11="NOVEMBER",b.Calendar_Months_12="DECEMBER",b.Calendar_Time_AM="AM",b.Calendar_Time_PM="PM",b.Calendar_EraName_1="M",b.Calendar_EraName_2="T",b.Calendar_EraName_3="S",b.Calendar_EraName_4="H",b.Calendar_FirstYear="1",b.Calendar_Today="Today",b.Calendar_LastMonth="Go to previous month",b.Calendar_NextMonth="Go to next month",b.Calendar_LastYear="Go to previous year",b.Calendar_NextYear="Go to next year",b.Calendar_LastTenYear="Go to previous ten years",b.Calendar_NextTenYear="Go to next ten years",b.Quarter_Format_1="Q1",b.Quarter_Format_2="Q2",b.Quarter_Format_3="Q3",b.Quarter_Format_4="Q4",b.ThemeColor="Theme Colors",b.StandardColor="Standard Colors",b.Calculator_DivideByZeroInfo="Cannot divide by zero.",b.Calculator_InvalidInputInfo="Invalid Input.",b.Calculator_SqrtParameterException="Invalid input for function.",b.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",b.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array.",b.DataObject_MeetLock="Cannot insert data because there's a locked cell in the way.",b.DataObject_MeetSpan="Cannot insert data because there's a merged cell in the way.",b.DataObject_MeetTable="Cannot insert data because a table in the way."},"./dist/plugins/celltype/checkboxcelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=e.Ul.Nl,g=d.Common.j.Fa,h=e.Ul.fp,i=e.Ul.nl,j=e.CellTypes.Context,k=e.CellTypes.Base,l=e.GC$,m=l.each,n=e.Ul.hZa,o=null,p=void 0,q=Math.max,r=parseInt,s="position",t="absolute",u="font",v="left",w="right",x="top",y="alphabetic",z=".gcEditingInput",A="background-color",B="white",C="green",D="div",E="normal 11pt calibri",F="width",G="height",H="_isFirstMouseUp",I="_mouseupToken";function O(a,b,c,d){var e,f=a.ITa;f&&(f.do("setValueForKey",b,c,H,p,d),e=f.getValueForKey(b,c,I,d),e&&(clearTimeout(e),f.do("setValueForKey",b,c,I,p,d)))}!function(a){a[a.top=0]="top",a[a.bottom=1]="bottom",a[a.left=2]="left",a[a.right=3]="right"}(J=b.CheckBoxTextAlign||(b.CheckBoxTextAlign={})),K=12,L={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!1,boxSize:K},M=function(a){N(b,a);function b(){var b,c=a.call(this)||this;return c.typeName="5",
c._boxSize=K,b=c,m(L,function(a,c){b["_"+a]=c}),c}return b.prototype.paintValue=function(a,b,c,d,f,i,j,k){var l,m,n,o,p,q,s,t,u,x,z,A,D,E,F,G,H,I,J,K,L,M,N,O,P,S,T;a&&(a.save(),a.rect(c,d,f,i),a.clip(),a.beginPath(),l=j.hAlign,m=j.font,n=j.foreColor,o=this,p=o._textAlign,q=o.getText(b,k),s=0,t=0,u=k.sheet,u&&(s=u.dp(q,m),t=h(m),q&&(x=q.split(/\r\n|\r|\n/),t*=x.length)),z=u.zoom(),A=k.isPrinting,D=k.printZoomFactor,A&&"number"==typeof D&&1!==D&&(z=D),++c,++d,--f,--i,E=this.lJJ(t,z),F=E.radius,G=E.scaleFactor,H=new e.Rect(c,d,f,i),I=Q(p,j,H,s,z*G),J=R(p,j,H,t,z*G),K=r(""+(c+I)),L=r(""+(d+J)),M=v,N=K+1,1===l?(M="center",N+=F):2===l&&(M=w,N+=2*F),m&&a.font!==m&&e.Ul.lZa(a,m),n&&(a.fillStyle=n),O=j.textDecoration,P=parseInt(k.fontInfo.fontSize,10),S=P>8?Math.floor((P-8)/5+2):1,T=t/2-P/2+S-1,a.textBaseline!==y&&(a.textBaseline=y),2===p?(a.textAlign=w,a.fillText(q,K+1-2,L+F+t/2-T),O&&o.ip(a,O,K+1-2,L+F+t/2-T,s,P,S)):0===p&&(a.textAlign=M,a.fillText(q,N,L-2-T),O&&o.ip(a,O,N,L-2-T,s,t)),a.save(),a.strokeStyle="black",a.strokeRect(K+.5,L+.5,2*F+.05,2*F+.05),a.fillStyle=B,a.fillRect(K+1,L+1,2*F-1,2*F-1),o._isThreeState&&g(b)?(a.beginPath(),a.fillStyle=C,a.rect(K+3*z,L+3*z,2*(F-2.5*z),2*(F-2.5*z)),a.fill()):!!b==!0&&(a.beginPath(),a.lineWidth=2.5*z,a.moveTo(K+3*z,L+F),a.lineTo(K+F,L+2*F-3.5*z),a.lineTo(K+2*F-1.5*z,L+3*z),a.stroke()),a.restore(),n&&(a.fillStyle=n),3===p?(a.textAlign=v,a.fillText(q,K+1+2*F+2,L+F+t/2-T),O&&o.ip(a,O,K+1+2*F+2,L+F+t/2-T,s,P,S)):1===p&&(a.textAlign=M,a.fillText(q,N,L+2*F+2+t-T),O&&o.ip(a,O,N,L+2*F+2+t-T,s,P,S)),a.restore())},b.prototype.lJJ=function(a,b){var c=this,d=c._boxSize,e=K/2,f=1;return"auto"===d&&(e=a/4,f=a/2/K),"number"==typeof d&&d>0&&(e=b*d/2,f=d/K),{radius:e,scaleFactor:f}},b.prototype.Voa=function(a,b,c){var d,e=this,f=b.font,g=e.getText(a,c),i=0,j=c.sheet;return j&&(i=h(f),g&&(d=g.split(/\r\n|\r|\n/),i*=d.length)),i},b.prototype.getText=function(a,b){return this.sK(a)},b.prototype.focus=function(a,b){a&&a.parentNode.focus()},b.prototype.createEditorElement=function(a,b){var c,d,g,h,i,j,k=a&&a.sheet&&a.sheet.parent&&a.sheet.parent.qo,m=e.Ul.vl(k)+1e3;return l(b).css("z-index",m).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),c=l(b.firstChild),c.css("overflow","hidden"),d=l(f("input")),d.attr("type","checkbox"),d.attr("class","gc-checkbox-cell-type-input"),g=this.fJc(a),h=g/K,d.css("transform","scale("+h+")"),c.append(d),i=l(f("span")),i.css(s,t).css(u,n(E)).css("cursor","default").css("white-space","nowrap"),c.append(i),j=l(f(D)),j.css(s,t).css(A,C).css("width",2*(g/2-2.5)).css("height",2*(g/2-2.5)),c.append(j),o},b.prototype.fJc=function(a){var b,c,d=a.sheet,e=d.zoom();return"number"==typeof this._boxSize&&this._boxSize>0?this._boxSize*e:"auto"===this._boxSize?(b=d.getStyle(a.row,a.col),c="",c=b&&b.font?b.font:E,e*h(c)/2):K/2},b.prototype.rK=function(a){var b;return b=this._isThreeState?!g(a)&&(!!a!=!0||o):!a},b.prototype.setEditorValue=function(a,b,c){var d,e,f,h,i,j,k,m,n;a&&(d=a.parentNode.children,e=d[0],f=d[1],h=d[2],e&&f&&h&&(i=this,j=c&&c.sheet,k=j&&j.HF,m=void 0,n=void 0,k||(n=i.rK(b)),i._isThreeState?g(n)?(m=!1,l(h).show()):(m=!!n,l(h).hide()):m=!!n,e.checked=m,l(f).text(i.sK(n))))},b.prototype.getEditorValue=function(a,b){if(a){var c=a.parentNode.children,d=c[0],e=c[1],f=c[2];if(d&&e&&f&&(!this._isThreeState||!l(f).isVisible()))return d.checked}return o},b.prototype.tw=function(a,b,c,d){var e=a.parent;e&&e.tw(a,b,c,d)},b.prototype.activateEditor=function(a,b,c,d){var e,f,g=d&&d.sheet;a&&g&&(e=l(a.parentNode.parentNode),f=this,e.bind("mousedown"+z,function(a){i(a)}),e.bind("mouseup"+z,function(){T(f,a,b,c,d)}),e.bind("keydown"+z,function(a){var b=a.keyCode;if(!a.ctrlKey&&!a.shiftKey&&!a.altKey){if(32===b)return f.tK=!0,i(a),!1;8===b&&i(a)}}),e.bind("keyup"+z,function(e){!f.tK||32!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey||(f.tK=!1,T(f,a,b,c,d))}),l(a).bind("click",function(a){i(a)}))},b.prototype.updateEditor=function(a,b,c,d){var e,f,g,i,j,k,m,o,p,q,r,s,t,w,y,z,A,B,C,D,E,F,G,H,I,J,L,M,N,O,P,S=d&&d.sheet;a&&S&&(e=S.yl,f=a.parentNode,g=f.children,i=g[0],j=g[1],k=g[2],i&&j&&k&&(l(f).width(c.width).height(c.height),m=l(j),o=m.text(),p=b.foreColor,q=b.font,r=b.hAlign,s=b.textDecoration,p&&m.css("color",p),t=void 0,t=q?q:e.Bl(),w=S.zoom(),w>1&&(t=e.Cl(t)),m.css(u,n(t)),y=S.rt(o,t),z=h(t),o&&(A=o.split(/\r\n|\r|\n/),z*=A.length),B=this,C=B._textAlign,D=this.fJc(d),E=D/K,F=Q(C,b,c,y,w*E),G=R(C,b,c,z,w*E),l(i).css("margin-left",F).css("margin-top",G),H=i.offsetLeft,I=i.offsetTop,J=i.offsetWidth,L=i.offsetHeight,M=0,N=0,0===C?(M=H,1===r?M=H+D/2-y/2:2===r&&(M=H+D-y),N=I-z,M-=(E-1)*K/2,N-=(E-1)*K/2):1===C?(M=H,1===r?M=H+D/2-y/2:2===r&&(M=H+D-y),N=I+L,M-=(E-1)*K/2,N+=(E-1)*K/2):2===C?(M=H-y-2,N=I+D/2-z/2,M-=(E-1)*K/2,N-=(E-1)*K/2):(M=H+J+2,N=I+D/2-z/2,M+=(E-1)*K/2,N-=(E-1)*K/2),m.css(v,M).css(x,N),B._isThreeState?(O=H+(J-k.offsetWidth)/2,P=I+(L-k.offsetHeight)/2,l(k).css(v,O).css(x,P).toggle().toggle()):l(k).hide(),s&&B.lp(m,s)))},b.prototype.sK=function(a){var b=this,c=b._caption;return b._isThreeState&&g(a)?b._textIndeterminate||c:!!a==!0?b._textTrue||c:b._textFalse||c},b.prototype.getHitInfo=function(a,b,c,d,e){if(e){var f=e.sheetArea;if(g(f)||3===f)return{x:a,y:b,row:e.row,col:e.col,cellRect:d,sheetArea:3,isReservedLocation:!0,sheet:e.sheet,cellStyle:c}}return o},b.prototype.processMouseDown=function(a){return!!a&&void(a.isReservedLocation&&(this.uK=!0))},b.prototype.processMouseUp=function(a){var b,c,d,e,f,g=this,h=a&&a.sheet;if(h&&g.uK&&a.isReservedLocation){if(g.uK=!1,b=a.row,c=a.col,d=a.sheetArea,e=h.ITa.getValueForKey(b,c,H,d),!e)return S(g,h,b,c,d),h.ITa.do("setValueForKey",b,c,H,!0,d),f=setTimeout(function(){O(h,b,c,d)},250),h.ITa.do("setValueForKey",b,c,I,f,d),!0;O(h,b,c,d)}return!1},b.prototype.processMouseLeave=function(a){return!!a&&void(this.uK=!1)},b.prototype.isReservedKey=function(a,b){return 32===a.keyCode&&!a.ctrlKey&&!a.shiftKey&&!a.altKey},b.prototype.processKeyUp=function(a,b){return S(this,b.sheet,b.row,b.col,b.sheetArea),!0},b.prototype.getAutoFitWidth=function(a,b,c,d,e){var f=this,g=f._textAlign,h=j.cp(a,f.sK(a),c,d,e),i=f.Voa(a,c,e),k=2*f.lJJ(i,d).radius;return 0===g||1===g?h=q(h,k):h+=k,h+5+2},b.prototype.getAutoFitHeight=function(a,b,c,d,e){var f=this,g=f._textAlign,h=j.ep(a,f.sK(a),c,d,e),i=f.Voa(a,c,e),k=2*f.lJJ(i,d).radius;return 0===g||1===g?h+=k:h=q(h,k),h+5},b.prototype.JH=function(a){this.isReservedKey(a)&&i(a)},b.prototype.isImeAware=function(a){return!1},b.prototype.gQa=function(){},b.prototype.qHJ=function(a){var b={caption:a.caption,textTrue:a.textTrue,textIndeterminate:a.textIndeterminate,textFalse:a.textFalse,textAlign:a.textAlign&&J[a.textAlign],isThreeState:a.isThreeState,boxSize:a.boxSize};this.fromJSON(b)},b.prototype.toJSON=function(){var a,b=this,c={typeName:b.typeName};return m(L,function(d,e){a=b["_"+d],a!==e&&(c[d]=a)}),c},b.prototype.fromJSON=function(a){var b=this;m(L,function(c){var d=a[c];g(d)||(b["_"+c]=d)})},b}(k),b.CheckBox=M;function P(a){return 5*a}function Q(a,b,c,d,e){var f=P(e),g=b.hAlign,h=c.x-1,i=c.width+1,j=0,k=0;return 0===a||1===a?(k=h+f,1===g?k=h+i/2-K*e/2:2===g&&(k=h+i-f-K*e)):2===a?(j=K*e+d,k=h+f+d,1===g?k=h+i/2-j/2+d:2===g&&(k=h+i-f-j+d)):(j=K*e+d,k=h+f,1===g?k=h+i/2-j/2:2===g&&(k=h+i-f-j)),k-h}function R(a,b,c,d,e){var f=P(e),g=b.vAlign,h=c.y-1,i=c.height+1,j=0,k=0;return 0===a?(j=K*e+d,k=h+f+d,1===g?k=h+i/2-j/2+d:2===g&&(k=h+i-f-j+d)):1===a?(j=K*e+d,k=h+f,1===g?k=h+i/2-j/2:2===g&&(k=h+i-f-j)):(k=h+f,1===g?k=h+i/2-K*e/2:2===g&&(k=h+i-f-K*e)),k-h}function S(a,b,c,d,e){var f=b.getValue(c,d,e),g=a.rK(f),h={cmd:"editCell",sheetName:b.name(),row:c,col:d,newValue:g,autoFormat:!0};b.wu().execute(h),a.tw(b,c,d,e)}function T(a,b,c,d,e){var f=e&&e.sheet,g=a.getEditorValue(b,e);a.setEditorValue(b,g,e),a.updateEditor(b,c,d,e),a.tw(f,f.Jl,f.Kl,e.sheetArea)}m(L,function(a){M.prototype[a]=function(b){return 0===arguments.length?this["_"+a]:("boxSize"===a?("number"==typeof b&&b>0&&(this["_"+a]=b),"auto"===b&&(this["_"+a]=b)):this["_"+a]=b,this)}}),e.CellTypes._o[5]=M},"./dist/plugins/celltype/comboboxcelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=e.CellTypes.Base,g=e.Ul.Nl,h=d.Common.j.Fa,i=d.Common.pc,j=e.Ul,k=j.nl,l=e.GC$,m=l.each,n=j.hZa,o=j.Fxb,p=j.eBJ,q=document,r=null,s=void 0,t=Math.max,u=parseInt,v="click",w="keydown",x="mouseover",y="mouseout",z="string",A="number",B="position",C="absolute",D="font",E="left",F="top",G="gcUIElement",H="tabindex",I="none",J="width",K="height",L="outline",M="box-sizing",N="color",O="background-color",P="z-index",Q="display",R="content-box",S="white",T="black",U="title",V="div",W="span",X="text",Y="value",Z="border",$="min-width",_=j.K_a;function qa(a,b){a.appendChild(b)}function ra(a,b){a.removeChild(b)}function sa(a){return a&&a.parentNode.parentNode.comboBox}!function(a){a[a.text=0]="text",a[a.index=1]="index",a[a.value=2]="value"}(aa=b.EditorValueType||(b.EditorValueType={})),ba=17,ca=20,da=0,ea=1,fa=1,ga=ea,ha=18,ia="EndEdit.gcEditingInput",ja=18,ka="lightgrey",la="#1E90FF",ma={editorValueType:0,items:r,itemHeight:22,editable:!1,maxDropDownItems:ca},na=function(){function a(a,b,c,d,f,i,j){var k,m,n,o,p,q,r,u,z=this;z.KK=a,k=a.firstChild,l(a).bind(w,function(a){z.LK(a)}).css([P,E,F,J,K,"overflow"],[i||0,b,c,d,f,"visible"]).attr([G],["gcComboBox"]),m=t(0,d-ba),z._editable=!1,z.MK=n=g(V),z.NK=o=g("textarea"),z.PK=n,qa(k,n),ta(n),ta(o),l(o).bind("keyup",function(){var a,b=z.PK.value;z._text=b,a=z.QK(b),z.editorValue(a),z.RK(b),z.SK()}).bind(x,function(){z.TK()}).bind(y,function(){z.SK()}),l(n).bind(v,function(){z.IK?z.Wq(ia,{isMouse:!0}):z.UK()}).bind(x,function(){z.TK()}).bind(y,function(){z.SK()}),z.VK(0,0,m,f),p=z.WK=g(V),qa(k,p),l(p).css([Z,B,O,M],[I,C,S,R]).attr(G,"gcDropDownButton").bind(v,function(){var a,b;!h(z.JK)&&(a=z.JK,z.JK=s,b=(new Date).valueOf(),b-a<100)||(z.IK?z.Wq(ia,{isMouse:!0}):z.UK())}),q=g("canvas"),z.Xs=q,z.XK(m,0,d-m,f),qa(p,q),r=z.YK=g(V),qa(k,r),z.ZK=!1,z.jOc=j||d,l(r).css([B,Z,O,P,L,Q,"cursor",M,K,$],[C,"1px solid",S,i||0,I,I,"default",R,f,z.jOc+"px"]),l(r).attr(G,"gcDropDownWindow").attr(H,-1),z.$K(0,f-2*da),z._K=0,u=z.aL=g(V),qa(r,u),z.bL=new e.IB(r,u),z._itemHeight=22,z.cL=ca,z.dL=-1,z._editorValueType=0,z._items=[],z.e$a=ka,z.v4J=""}return a.prototype.getComboBox=function(){return this.KK},a.prototype.dispose=function(){var a=this;l(a.KK).unbind(w),l(a.NK).unbind("keyup").unbind(x).unbind(y),l(a.MK).unbind(v).unbind(x).unbind(y),l(a.WK).unbind(v),l(a.aL).find("div").forEach(function(a){l(a).unbind(x).unbind(y).unbind(v)}),a.bL.dispose()},a.prototype.updateLocationAndSize=function(a,b,c,d){var e=this,f=t(0,c-ba);e.VK(0,0,f,d),e.XK(f,0,c-f,d),e.$K(0,d-2*da)},a.prototype.updateStyle=function(a,b,c){var d=this;c=n(c),a=a?a:s,l(d.PK).css(O,a).css(N,b).css(D,c),l(d.WK).css(O,a).css(N,b).css(D,c),l(d.YK).css(O,a).css(N,b).css(D,c),d.v4J=b,l(d.KK).css(O,"transparent"),d.e$a=i.Pka(i.ec(a),i.ec(ka))?S:ka},a.prototype.updateImeMode=function(a){l(this.PK).css("ime-mode",a)},a.prototype.editorValueType=function(a){return 0===arguments.length?this._editorValueType:(this._editorValueType=a,this)},a.prototype.editorValue=function(a){var b,c=this;return 0===arguments.length?c.fL:(a!==c.fL&&(c.fL=a,b=c.gL(a),c.text(b),c.RK(b,!0,a)),c)},a.prototype.gL=function(a){var b,c=this,d=c._items,e=d.length,f=c._editorValueType,g,i,j;if(c.HK=!0,1===f)g=d[a],b=g&&va(g,X)?g.text:g,b===s&&(b=a,c.HK=!1);else if(0===f){for(b=a,j=0;j<e&&(g=d[j],!(g&&va(g,X)&&g.text===a||g===a));j++);j>=e&&(c.HK=!1)}else if(2===f){for(i=0;i<e;i++)if(g=d[i],g&&va(g,Y)&&g.value===a){b=g.text;break}i>=e&&(b=a,c.HK=!1)}return h(a)&&(b=""),b},a.prototype.QK=function(a){var b,c,d,e=this,f=e._items,g=f.length,h=e._editorValueType,i=a;if(1===h)for(c=0;c<g;c++)b=f[c],(b&&va(b,X)&&b.text===a||b===a)&&(i=c);else if(2===h)for(d=0;d<g;d++)b=f[d],b&&va(b,X)&&b.text===a?i=b.value:b===a&&(i=s);return i},a.prototype.RK=function(a,b,c){var d,e,f,g,i,j,k,l=-1;if(!h(a)&&""!==a)for(e=this._items,f=e.length,d=0;d<f;d++)if(g=e[d],i=void 0,j=void 0,i=va(g,X)?g.text:g,va(g,Y)&&(j=g.value),k=b?i:(""+i).substr(0,a.length),k===a){if(l=d,h(c))break;if(!h(j)&&j===c)break}this.hL(l)},a.prototype.SK=function(){l(this.PK).removeAttr(U)},a.prototype.TK=function(){var a=this,b=a.Xn(a._text),c=l(a.PK),d=c.width();b>d+ea?c.attr(U,a._text):c.removeAttr(U)},a.prototype.VK=function(a,b,c,d){c-=da,d-=2*da,l(this.PK).css(E,a).css(F,b).css(J,c-ea).css(K,d-fa)},a.prototype.editable=function(a){var b,c,d,e,f,g=this;return 0===arguments.length?g._editable:g._editable!==a?(g._editable=a,b=g.KK.firstChild,c=g.PK,d=l(c),e={left:u(d.css(E)),top:u(d.css(F)),width:u(d.css(J)),height:u(d.css(K))},f={backColor:d.css(O),foreColor:d.css(N),font:c.style.font},ra(b,c),g.PK=a?g.NK:g.MK,qa(b,g.PK),l(g.PK).css(O,f.backColor).css(N,f.foreColor).css(D,f.font),g.VK(e.left,e.top,e.width,e.height),g):void 0},a.prototype.text=function(a){var b=this,c=b.PK;return 0===arguments.length?b._text:void(a!==b._text&&(b._text=a,b._editable?c.value=a:c.textContent=a))},a.prototype.focus=function(){var a=this,b=a.PK;b.focus(),a._editable&&(b.selectionStart=b.value.length)},a.prototype.selectAll=function(){var a=this;a._editable&&a.PK.select()},a.prototype.XK=function(a,b,c,d){var e,f,g,h,i;c-=da,d-=2*da,e=this,f=e.Xs,l(e.WK).css(E,a).css(F,b).css(J,c).css(K,d),l(f).attr(J,c).attr(K,d),g=f.width,h=f.height,i=f.getContext("2d"),i.beginPath(),i.lineWidth=2,i.fillStyle=T,i.moveTo(g-ba+4,(h-2)/2-2.5),i.lineTo(g-ba+7,(h-2)/2+3.5),i.lineTo(g-ba+10,(h-2)/2-2.5),i.fill()},a.prototype.showDropDownList=function(){var a=this,b=a.bL;a.ZK=!0,l(a.YK).bind(w,function(b){a.LK(b)}).show(),a.iL=!1,a.jL(),this.adjustPosition(),a.iL&&b.lB(l(a.aL.children).height()),b.ew(!1),a.kL(la,S),a.lL(a.dL),a.focus()},a.prototype.adjustPosition=function(){var a,b,c,d,e,f,g,h,i,j,k=this,m=l(k.YK);if(m){if(a=parseInt(m.css("left"),10),b=parseInt(m.css("top"),10),c=m.width(),d=m.height(),isNaN(a)||isNaN(b)||isNaN(c)||isNaN(d))return;e=0,f=0,g=q.documentElement,h=g.clientWidth,i=g.clientHeight,j=m[0].getBoundingClientRect(),d>i&&(m.css("max-height",Math.round(.8*i)+"px"),d=Math.round(.8*i)),c>h&&(m.css("max-width",Math.round(.8*h)+"px"),c=Math.round(.8*h)),j.left+c>h&&(f=j.left+c-h),j.top+d>i&&(e=j.top+d-i),(a<0||b<0||e>0||f>0)&&(a-=f,b-=e,a<0&&(a-=22),m.css({left:a+"px",top:b+"px"}))}},a.prototype.shiftPadding=function(a,b){var c=this.KK.firstChild;a===E?l(c).css({left:(+l(c).css(E).replace("px","")||0)-b}):a===F&&l(c).css({top:(+l(c).css(F).replace("px","")||0)-b})},a.prototype.closeDropDownList=function(){var a=this;a.ZK=!1,l(a.YK).unbind(w).hide(),a.kL("",a.v4J),a.focus()},a.prototype.UK=function(){this.ZK?this.closeDropDownList():this.showDropDownList()},a.prototype.listHeight=function(a){var b=this,c=l(b.YK);return 0===arguments.length?c.height():void(a>0&&(c.height(a),b.bL.ew(!1)))},a.prototype.$K=function(a,b){l(this.YK).css(E,a).css(F,b)},a.prototype.items=function(a){var b,c,d,e,f,g=this;if(0===arguments.length)return g._items;if(a){for(g._items=a,b=g.aL,c=void 0,l(b).find("div").forEach(function(a){l(a).unbind(x).unbind(y).unbind(v)}),c=b.firstChild;c;)ra(b,c),c=b.firstChild;for(g._K=0,d=0,e=a.length;d<e;d++)f=a[d],g.mL(va(f,X)?f.text:f);return g}},a.prototype.mL=function(a){var b=this,c=g(V),d=g(W);d.textContent=""+a,d.style.padding="0 "+ha+"px 0 "+ga+"px",d.style.textOverflow="ellipsis",d.style.whiteSpace="nowrap",qa(c,d),qa(b.aL,c),b._K++,l(c).bind(v,function(){var a=l(c).index();b.selectedIndex(a),b.closeDropDownList(),b.Wq(ia,{isMouse:!0})}).bind(x,function(){var a=l(c);c.oldBackColor=a.css(O),a.css(O,b.e$a)}).bind(y,function(){l(c).css(O,c.oldBackColor||"")}).css($,b.jOc+"px")},a.prototype.nL=function(){var a=this;a.Po=g(W),l(a.Po).css([Q,D],[I,a.YK.style.font]).appendTo(q.body)},a.prototype.oL=function(){ra(q.body,this.Po)},a.prototype.pL=function(a){return this.Po.textContent=a,l(this.Po).width()+2+ga},a.prototype.kL=function(a,b){var c=this,d=c.dL;0<=d&&d<c._K&&l(c.aL.children[d]).css([O,N],[a,b])},a.prototype.LK=function(a){var b,c,d,e=this,f=a.keyCode,g=a.which;(a.ctrlKey||a.shiftKey||a.altKey||a.metaKey||37===g||39===g)&&9!==g&&e.editable()||(b=e._K,c=e.dL,d=0,38===g||40===g?(c>=0&&c<b&&(d=c+(38===g?-1:1)),d>=0&&d<b&&e.selectedIndex(d),e.ZK&&e.lL(d),k(a)):13===g||37===g||39===g||9===g?(e.selectedIndex(e.dL),e.ZK&&e.closeDropDownList(),e.Wq(ia,{keyCode:f,shiftKey:a.shiftKey}),e.ZK&&k(a)):27===g?(e.closeDropDownList(),e.Wq(ia,{keyCode:f}),k(a)):e.editable()||32!==g||k(a))},a.prototype.getSelectedValue=function(a,b,c){var d,e=b[a];return h(e)||(1===c?d=a:0===c?d=va(e,X)?e.text:e:2===c&&va(e,Y)&&(d=e.value)),d},a.prototype.hL=function(a){var b=this;b.kL("",b.v4J),b.dL=a,b.kL(la,S),b.lL(a)},a.prototype.selectedIndex=function(a){var b,c=this;return 0===arguments.length?c.dL:void(0<=a&&a<c._K&&(c.hL(a),b=c.getSelectedValue(c.dL,c._items,c._editorValueType),h(b)||c.editorValue(b)))},a.prototype.itemCountPerPage=function(a){return 0===arguments.length?this.cL:void(a>0&&(this.cL=a))},a.prototype.Xn=function(a){this.nL();var b=this.pL(a);return this.oL(),b},a.prototype.itemHeight=function(a){return 0===arguments.length?this._itemHeight:void(a>0&&(this._itemHeight=a))},a.prototype.jL=function(){var a,b,c,d,e,f=this;f.nL(),a=f._items[0],b=t(f._itemHeight,l(f.Po).text(h(a)?"":a).height()),l(f.aL.children).css(K,b),d=f._K,e=f.cL,d<=e?c=d*b:(c=e*b,f.iL=!0),f.listHeight(c),f.oL()},a.prototype.lL=function(a){if(a>=0&&a<this._K){var b=this.aL.children[a];this.bL.BB(b)}},a.prototype.bind=function(a,b,c){l(this.KK).bind(a,b,c)},a.prototype.unbind=function(a,b){l(this.KK).unbind(a,b)},a.prototype.Wq=function(a,b){l(this.KK).trigger(a,b)},a}();function ta(a){l(a).css(["margin","overflow","resize",B,"padding",L,O,"white-space",M,Z],[0,"hidden",I,C,fa+"px 0px 0px "+ea+"px",I,S,"nowrap",R,I]).attr(G,"gcComboBoxEditor").attr(H,-1)}oa=function(a){pa(b,a);function b(){var b,c=a.call(this)||this;return c.typeName="7",c.DF=!1,c.GK=!1,b=c,m(ma,function(a,c){"items"===a&&(c=[]),b["_"+a]=c}),c}return b.prototype.isReservedKey=function(a,b){return this.GK},b.prototype.paintValue=function(b,c,d,f,g,h,i,j){var k,l,m,n,p,q,r,s,u,v,w,x=this,y=j.sheet,z=y.zoom?y.zoom():1,A=ba,B=t(0,g-A-1);3===i.hAlign&&(i.hAlign=0),i.wordWrap&&(i.wordWrap=!1),k=j.isPrinting,l=j.printZoomFactor,k&&"number"==typeof l&&1!==l&&(z=l),B>0&&h>0&&(m={},n=void 0,j.quotePrefix=i.quotePrefix,p=i.formatter&&"General"!==i.formatter,q=i._autoFormatter&&i._autoFormatter.formatCached&&"General"!==i._autoFormatter.formatCached,r=void 0,s=this.getItemValue(c),r=p?i.formatter:q?i._autoFormatter:e.CellTypes.Context.Ixb(b,s,B+1,i,z),n=this.format(_(c),r,m,j),n&&(u=new e.Rect(d,f,g,h),a.prototype.adjustRectForIconSet.call(this,i.hAlign,j.sheet,j.row,j.col,j.sheetArea,u,m.content&&a.prototype.hasInfilling.call(this,m.content)),d=u.x,g=u.width,v=i.isVerticalText,o(s)&&!v&&i.shrinkToFit!==!0&&(w=e.CellTypes.Context.Lxb(b,n,B+1,i,z),n!==w&&(delete m.content,i.textIndent=0),n=w),this.paintText(b,x.getText(c,j),d,f,B,h,i,j,n,m))),b.save(),(A>g||A>h)&&(b.rect(d,f,g,h),b.clip()),b.beginPath(),b.lineWidth=2,b.fillStyle=T,b.moveTo(d+g-A+3,f+(h-2)/2-2.5),b.lineTo(d+g-A+6,f+(h-2)/2+3.5),b.lineTo(d+g-A+9,f+(h-2)/2-2.5),b.fill(),b.restore()},b.prototype.getText=function(a,b){return a},b.prototype.createEditorElement=function(a,b){var c,d,e,f,g=a&&a.sheet,h=g&&g.parent,i=h&&h.qo,k=j.vl(i)+1e3,l=g.defaults,m=this,n=g.getActualStyle(a.row,a.col).cellPadding,o=0;return n&&(o=parseFloat(ua(n)[3])||0),c=0,d=g.getSpan(a.row,a.col),c=d?p(g,d.col,d.col+d.colCount,!1):g.Tl(a.col)-o,e=new na(b,0,0,l.colWidth,l.rowHeight,k,c),e.editorValueType(m._editorValueType),e.items(m._items),e.itemHeight(m._itemHeight),e.itemCountPerPage(m._maxDropDownItems),e.editable(m._editable),f=e.getComboBox(),Object.defineProperty(f,"comboBox",{get:function(){return this.ixb},set:function(a){this.ixb!==a&&(this.ixb&&this.ixb.dispose(),this.ixb=a)}}),f.comboBox=e,r},b.prototype.getEditorValue=function(a,b){var c=sa(a);return c&&(this.DF=!c.HK),c&&c.editorValue()},b.prototype.setEditorValue=function(a,b,c){var d=sa(a);d&&d.editorValue(b)},b.prototype.focus=function(a,b){var c=sa(a);c&&c.focus()},b.prototype.selectAll=function(a,b){var c=sa(a);c&&c.selectAll()},b.prototype.activateEditor=function(a,b,c,d){var e=this,f=d.sheet,g=sa(a);g&&(g.editorValueType(e._editorValueType),g.items(e._items),g.itemHeight(e._itemHeight),g.itemCountPerPage(e._maxDropDownItems),g.editable(e._editable),g.bind(ia,function(a,b){var c,d,e,h,i,j=b.keyCode,k=b.shiftKey;if(j){if(c=f.wu(),d=c.getShortcutKey(j,!1,k||!1,!1,!1),e=c.getCommands(d))for(h=0,i=e.length;h<i;h++)if("navigationLeft"!==e[h].Cj&&"navigationRight"!==e[h].Cj||(f.Px=1),e[h].execute(f.parent,{sheetName:f.name()}))return!0}else b.isMouse&&g.IK&&f.endEdit()})),e.GK=!0},b.prototype.deactivateEditor=function(a,b){var c,d,e,f,g,h;if(a&&(c=sa(a))){if(d=b.sheet.getActualStyle(b.row,b.col,b.sheetArea).cellPadding)for(e=[E,F],f=[3,0],g=0;g<e.length;g++)h=parseInt(ua(d)[f[g]],10),h=typeof h===A&&h>0?h:0,c.shiftPadding(e[g],h);c.unbind(ia),c.closeDropDownList(),c.IK=!1}this.GK=!1},b.prototype.updateImeMode=function(a,b){if(this.isImeAware()){var c=sa(a);c&&c.updateImeMode(b)}},b.prototype.updateEditor=function(a,b,c,d){var e,f,g=a&&d&&d.sheet;g&&(e=sa(a),b&&e&&(f=g.yl,e.updateStyle(b.backColor,b.foreColor||T,f.Cl(b.font||f.Bl()))),c&&e&&e.updateLocationAndSize(c.x,c.y,c.width,c.height))},b.prototype.format=function(a,b,c,d){var e,g;return h(a)?"":(e=this,g=e.getItemValue(a),f.prototype.format.call(e,g,b,c))},b.prototype.getItemValue=function(a){var b,c,d,e,f,g=this,h=g._editorValueType,i=g._items;if(i)if(d=i.length,1===h){if(e=u(a),0<=e&&e<d&&(b=i[e],b!==s&&b!==r))return c=va(b,X)?b.text:b}else if(2===h)for(f=0;f<d;f++)if(b=i[f],b&&va(b,Y)&&b.value===a)return c=b.text;return a},b.prototype.parse=function(a,b,c){var d,e,g,h=this,i=h._editorValueType,j=h._items,k=f.prototype.parse.call(h,a,b);if(j){if(g=j.length,0===i)return k;if(1===i){for(e=0;e<g;e++)if(d=j[e],d&&va(d,X)&&d.text===k||d===k)return e}else if(2===i)for(e=0;e<g;e++)if(d=j[e],d&&va(d,X)&&d.text===k)return d.value}return k},b.prototype.getHitInfo=function(a,b,c,d,e){var f,g,i,j,k,l;return e?(f=e.sheetArea,g=e.sheet,(h(f)||3===f)&&d&&(i=ua(c.cellPadding),j=parseInt(i[1],10)||0,k=d.x+d.width-j,l={x:a,y:b,row:e.row,col:e.col,cellStyle:c,cellRect:d,sheetArea:f,sheet:g},k-ba<=a&&a<k)?(l.isReservedLocation=!0,l):r):r},b.prototype.processMouseDown=function(a){var b,c=a.sheet,d=a.sheetArea;(h(d)||3===d)&&a.isReservedLocation&&c&&(a.row===c.Jl&&a.col===c.Kl||c.setActiveCell(a.row,a.col),c.startEdit(),b=sa(c.BF),b&&(j.Ml.mozilla&&(b.JK=(new Date).valueOf()),b.showDropDownList(),b.IK=!0))},b.prototype.getAutoFitWidth=function(a,b,c,d,f){c&&c.wordWrap&&(c.wordWrap=!1);var g=e.CellTypes.Context.cp(a,b,c,d,f);return g+ba},b.prototype.getAutoFitHeight=function(a,b,c,d,f){return c&&c.wordWrap&&(c.wordWrap=!1),e.CellTypes.Context.ep(a,b,c,d,f)},b.prototype.isImeAware=function(a){return!0},b.prototype.gQa=function(){},b.prototype.qHJ=function(a){var b={editorValueType:a.editorValueType&&aa[a.editorValueType],items:a.items,itemHeight:a.itemHeight,maxDropDownItems:a.maxDropDownItems,editable:a.editable};this.fromJSON(b)},b.prototype.toJSON=function(){var a,b=this,c={typeName:b.typeName};return m(ma,function(d,e){a=b["_"+d];var f="items"===d?a&&a.length>0:a!==e;f&&(c[d]=a)}),c},b.prototype.fromJSON=function(a){var b=this;m(ma,function(c){var d=a[c];h(d)||(b["_"+c]=d)})},b}(f),b.ComboBox=oa;function ua(a){var b,c,d,e,f=["0","0","0","0"];return typeof a===z&&(b=a.split(" ",4),c=b.length,d=void 0,e=void 0,1===c?(d=b[0],f=[d,d,d,d]):2===c?(d=b[0],e=b[1],f=[d,e,d,e]):3===c?(e=b[1],f=[b[0],e,b[2],e]):4===c&&(f=[b[0],b[1],b[2],b[3]])),f}function va(a,b){return a.hasOwnProperty(b)}m(ma,function(a){oa.prototype[a]=function(b){return 0===arguments.length?this["_"+a]:(this["_"+a]=b,this)}}),e.CellTypes._o[7]=oa},"./dist/plugins/celltype/dataobjectcelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-calc"),e=c("Common"),f=c("Core"),g=c("./dist/plugins/celltype/celltypes.ns.js"),h=new e.Common.ResourceManager(g.SR,"CellTypes"),i=h.getResource.bind(h),j=f.CellTypes.Text,k=e.Common.j.Fa,l=void 0;function o(a){return a&&"object"==typeof a&&!(a instanceof d.CalcError)&&!(a instanceof Date)&&!Array.isArray(a)}function p(a){return o(a)?q(a,""):[]}function q(a,b){var c,d,e,g,h,i,j=[],k=Object.keys(a);for(c=0,d=k;c<d.length;c++)e=d[c],g=a[e],h=b?b+"."+e:e,"function"!=typeof g&&(o(g)?(i=q(g,h),j.push({text:e,value:g,path:h,layout:{displayAs:f.LayoutDisplayAs.popup},items:i})):j.push({text:e,value:g,path:h}));return j}m=function(a){n(b,a);function b(b){var c=a.call(this)||this;return c.typeName="18",c.Yc=b,c}return b.prototype.qAb=function(a,b,c,d,e){var g=a.getStyle(b,c,e);g||(g=new f.Style,g.cellType=this),a.ITa.do("setStyle",b,c,g,e)},b.prototype.K7J=function(a,b,d,e,g){var h=a.getValue(b,d,g),j=p(h);j.length>0?(e.formatter=this.Yc,e.cellButtons=[{command:"openList",imageType:f.ButtonImageType.custom,imageSrc:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+RGF0YSBvYmplY3QgY2VsbCB0eXBlPC90aXRsZT4KICAgIDxnIGlkPSJEYXRhLW9iamVjdC1jZWxsLXR5cGUiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0xMyw4LjcxNDI4NTcxIEwxMywxMS41NzE0Mjg2IEMxMywxMi4zNjA0OTExIDEwLjk4NTgxNzMsMTMgOC41LDEzIEM2LjAxNDE4MjY5LDEzIDQsMTIuMzYwNDkxMSA0LDExLjU3MTQyODYgTDQsOC43MTQyODU3MSBDNCw5LjUwMzM0ODIxIDYuMDE0MTgyNjksMTAuMTQyODU3MSA4LjUsMTAuMTQyODU3MSBDMTAuOTg1ODE3MywxMC4xNDI4NTcxIDEzLDkuNTAzMzQ4MjEgMTMsOC43MTQyODU3MSBaIE0xMyw1LjE0Mjg1NzE0IEwxMyw4IEMxMyw4Ljc4OTA2MjUgMTAuOTg1ODE3Myw5LjQyODU3MTQzIDguNSw5LjQyODU3MTQzIEM2LjAxNDE4MjY5LDkuNDI4NTcxNDMgNCw4Ljc4OTA2MjUgNCw4IEw0LDUuMTQyODU3MTQgQzQsNS45MzE5MTk2NCA2LjAxNDE4MjY5LDYuNTcxNDI4NTcgOC41LDYuNTcxNDI4NTcgQzEwLjk4NTgxNzMsNi41NzE0Mjg1NyAxMyw1LjkzMTkxOTY0IDEzLDUuMTQyODU3MTQgWiBNOC41LDMgQzEwLjk4NTgxNzMsMyAxMywzLjYzOTUwODkzIDEzLDQuNDI4NTcxNDMgQzEzLDUuMjE3NjMzOTMgMTAuOTg1ODE3Myw1Ljg1NzE0Mjg2IDguNSw1Ljg1NzE0Mjg2IEM2LjAxNDE4MjY5LDUuODU3MTQyODYgNCw1LjIxNzYzMzkzIDQsNC40Mjg1NzE0MyBDNCwzLjYzOTUwODkzIDYuMDE0MTgyNjksMyA4LjUsMyBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjMzY3RkNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+"}],e.dropDowns=[{type:f.DropDownType.list,option:{items:j,dropDownAlignment:0,dropDownDirection:3},submitCommand:function(d,e,g){var h,j,l,m=c("SheetsCalc"),n=g.sheetArea;for(h=g.col+1;h<d.getColumnCount(n);h++){if(d.options.isProtected&&d.getCell(g.row,h,n).locked()){d.Os(16,i().DataObject_MeetLock);break}if(d.ITa.findSpan(g.row,h,n)){d.Os(16,i().DataObject_MeetSpan);break}if(3===n&&d.tables&&d.tables.find(g.row,h)||d.pivotTables&&d.pivotTables.findPivotTable(g.row,h)){d.Os(16,i().DataObject_MeetTable);break}if(k(d.getValue(g.row,h,n))){j=m.rangesToFormula([new f.Range(g.row,g.col,1,1)],b,h,15,1===a.parent.options.referenceStyle),l=g.path,d.wu().execute({cmd:"editCell",sheetName:d.name(),row:g.row,col:h,sheetArea:n,newValue:"="+j+'."'+l+'"',autoFormat:!1});break}}}}]):(e.cellButtons=l,e.dropDowns=l),e.formatter&&f.util.lHb(e.formatter)&&a.oJb(b,d,e.formatter)},b.prototype.paint=function(b,c,d,e,f,g,h,i){(this.Yc!==h.formatter||this.f9J)&&(this.qAb(i.sheet,i.row,i.col,c,i.sheetArea),this.f9J=!1),a.prototype.paint.call(this,b,c,d,e,f,g,h,i)},b.prototype.toJSON=function(){return{typeName:this.typeName,format:this.Yc}},b.prototype.fromJSON=function(a){this.Yc=a.format,this.f9J=!0},b}(j),b.DataObject=m,f.CellTypes._o[18]=m},"./dist/plugins/celltype/dropdown-action.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),b.commands=d.Commands,e=c("./dist/plugins/celltype/editor/calculator.js"),f=c("./dist/plugins/celltype/editor/listControl.js"),g=c("./dist/plugins/celltype/editor/slider.js"),h=c("./dist/plugins/celltype/editor/timepicker.js"),i=c("./dist/plugins/celltype/editor/monthPicker.js"),j=c("./dist/plugins/celltype/editor/colorpicker.js"),k=c("./dist/plugins/celltype/editor/popupControl.js"),l=c("./dist/plugins/celltype/editor/calendar.js"),m=c("Common"),n=c("./dist/plugins/celltype/editor/baseControl.js"),o=c("./dist/plugins/celltype/editor/workflowPicker.js"),p=c("./dist/plugins/celltype/editor/multiColumnPicker.js"),q=m.Common.j.Fa,r=m.Common.o,s=m.Common.l,t=null,u=window,v=u.Yl,w="openColorPicker",x="openDateTimePicker",y="openTimePicker",z="openCalculator",A="openMonthPicker",B="openList",C="openSlider",D="openWorkflowList",E="openMultiColumn",F=document,G="_cellButtonParam";function J(a,b){return F.createElement(a,b)}function K(a){return{canUndo:!1,execute:function(b,c,k){var m,n,r,s,u,v,F,G,H,I=d.VCJ(b,c.sheetName);if(!I||b.zCJ().name()!==c.sheetName)return!1;if(m=c.row,n=c.col,(q(m)||q(n))&&(m=I.getActiveRowIndex(),n=I.getActiveColumnIndex()),r=c.sheetArea,q(r)&&(r=3),m<0||m>=I.getRowCount(r)||n<0||n>=I.getColumnCount(r))return!1;switch(I.showCell(m,n,d.VerticalPosition.nearest,d.HorizontalPosition.nearest),s=1===r?-1:void 0,u=2===r?-1:void 0,v=I.getCellRect(m,n,s,u),F=J("div"),G=L(I,m,n,r),(q(c.row)||q(c.col))&&(c.row=I.getActiveRowIndex(),c.col=I.getActiveColumnIndex()),a){case w:H=new j.ColorPicker(F);break;case x:G=M(G,"date"),H=new l.Calendar(F);break;case y:G=M(G,"date"),H=new h.TimePicker(F);break;case z:G=M(G,"number"),G=""+G,H=new e.Calculator(F);break;case A:G=M(G,"date"),H=new i.MonthPicker(F);break;case B:H=new f.List(F),H.formula=I.getFormula(c.row,c.col);break;case C:G=M(G,"number"),H=new g.Slider(F);break;case D:H=new o.WorkFlow(F),"string"!=typeof G&&G!==t&&(G=""+G);break;case E:H=new p.MultiColumn(F,t,I)}return Q(H,a,G,v,I,c),!0}}}d.Commands[w]=K(w),d.Commands[x]=K(x),d.Commands[y]=K(y),d.Commands[z]=K(z),d.Commands[A]=K(A),d.Commands[B]=K(B),d.Commands[C]=K(C),d.Commands[D]=K(D),d.Commands[E]=K(E);function L(a,b,c,d){var e,f;return a.isEditing()?(e=a.getCellType(b,c),f={sheet:a,row:b,col:c,sheetArea:d},e.getEditorValue(a.BF,f)):a.getValue(b,c,d)}function M(a,b){return"date"===b?"string"==typeof a?(a=s.Qa(a),a===t&&(a=new Date)):a instanceof Date||(a=new Date):"number"===b&&("string"==typeof a?a=r.Qa(a):"number"!=typeof a&&(a=0)),a}function N(a,b,c,e){var f,g,h,i,j,k,l=c.row,m=c.col;(q(l)||q(m))&&(l=a.getActiveRowIndex(),m=a.getActiveColumnIndex()),f=c.sheetArea,q(f)&&(f=3),b&&b.submitCommand?"string"==typeof b.submitCommand?a.getParent().commandManager().execute({cmd:b.submitCommand,sheetName:a.name(),row:l,col:m,newValue:e.value}):"function"==typeof b.submitCommand&&(g={},g.row=c.row,g.col=c.col,g.sheetArea=f,g.path=e.path,b.submitCommand.call(null,a,e.value,g)):(a.getParent().commandManager().execute({cmd:"editCell",sheetName:a.name(),row:l,col:m,newValue:e.text,autoFormat:!e.noAutoFormat,sheetArea:f,isUndo:!1}),a.isEditing()&&a.Kl===m&&a.Jl===l&&(h=a.getCellType(l,m),i={sheet:a,row:l,col:m,
sheetArea:d.SheetArea.viewport},j=a.AHb(l,m,f),k=a.getCellRect(l,m),a.BF.LF=e.value,h.updateEditor(a.BF,j,k,i),h.setEditorValue(a.BF,e.text,i)))}function O(a){var b=-1;switch(a){case w:b=d.DropDownType.colorPicker;break;case x:b=d.DropDownType.dateTimePicker;break;case y:b=d.DropDownType.timePicker;break;case z:b=d.DropDownType.calculator;break;case A:b=d.DropDownType.monthPicker;break;case B:b=d.DropDownType.list;break;case C:b=d.DropDownType.slider;break;case D:b=d.DropDownType.workflowList;break;case E:b=d.DropDownType.multiColumn}return b}function P(a,b,c,d,e){var f,g=b.cellButtons;a&&g&&g.length>0&&(f=a.ITa.getValueForKey(c,d,G,e),f&&f.isMouseDownReservedLocation&&(f.buttonDownIndex=-1,f.isMouseDownReservedLocation=!1,a.repaint(a.getCellRect(c,d))))}H=0;function Q(a,b,c,d,e,f){var g,h,i,j,l,m,o,p,r,s,t,u,w,x,y,z,A,B,C,D,E;v.Gm(),g=e.parent,h=e.zo(),j=f.row,l=f.col,m=f.sheetArea,o=e.AHb(j,l,m),p=O(b),r=o.dropDowns,t=r&&r.length>0,t&&(u=r.filter(function(a){return a.type===p})[0],u&&(void 0!==u.option&&null!==u.option&&(i=u.option),s=u)),a.setOptions(i),a.setValue(c),w=h.getBoundingClientRect(),x=d.x+w.left,y=d.y+w.top,z=R(g),z&&(x+=z.x,y+=z.y),A=new k.Rectangle(x,y,d.width,d.height),B=a.getOptions(),C=B&&!q(B.dropDownAlignment)?B.dropDownAlignment:k.DropDownAlignment.Far,D=B&&!q(B.dropDownDirection)?B.dropDownDirection:void 0,E=new k.PopupControl(a.getContainer(),A,{align:C,hostElement:h,direction:D}),H+=1,t&&a.dEc(),E.open(),a.scrollToSelect(),t&&a.refresh(),a.on(n.BaseDropdown.Event_ValueChanged,function(a){a.notCloseDropDown||E.close(),S(f,a)&&N(e,s,f,a)}),g&&(g.ELJ=g.ELJ||[],g.ELJ.push(E)),a.getContainer().addEventListener("contextmenu",function(a){a.stopPropagation(),a.preventDefault()}),E.on("close",function(){P(e,o,j,l,m),a&&a.dispose(),H-=1,E=null;var b=g.ELJ.indexOf(E);g.ELJ.splice(b,1),v.Hm()})}function R(a){var b,c,d,e;if(a&&(b=a.options.tabStripVisible,b&&(c=a.options.tabStripPosition,0!==c))){switch(d={x:0,y:0},e=a.MJc.Zs,c){case 1:d.y=e.height;break;case 2:d.x=e.width}return d}}function S(a,b){return b.notSubmit!==!0&&(3===a.sheetArea||a.cmd!==z||!isNaN(b.value))}I={init:function(){this.commandManager().register(w,d.Commands[w]),this.commandManager().register(x,d.Commands[x]),this.commandManager().register(y,d.Commands[y]),this.commandManager().register(z,d.Commands[z]),this.commandManager().register(A,d.Commands[A]),this.commandManager().register(B,d.Commands[B]),this.commandManager().register(C,d.Commands[C]),this.commandManager().register(D,d.Commands[D]),this.commandManager().register(E,d.Commands[E])}},d.Workbook.$n("registerOpendropdownCommand",I),d.Worksheet.$n("registerOpendropdownCommand",{preProcessMouseWheel:function(a){H>0&&!this.fCc&&(a.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(a,b,c){"use strict";var d,e,f,g=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/celltype/editor/eventbase.js"),e=function(a){g(b,a);function b(b){var c=a.call(this)||this;return c.xo=b,c}return b.prototype.init=function(a,b,c){this.qo=this.xo.querySelector("."+b),this.qo?this.RemoveChilds(this.qo):(this.qo=this.CreateElement(a,b,c),this.xo.appendChild(this.qo))},b.prototype.GetContainer=function(){return this.xo},b.prototype.RemoveChilds=function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},b.prototype.CreateElement=function(a,b,c,d){var e,f=document.createElement(a);if(b&&(f.className=b),c)for(e in c)c[e]&&f.setAttribute(e,c[e]);return d&&d.appendChild(f),f},b}(d.EventBase),b.BaseControl=e,f=function(a){g(b,a);function b(b){var c=a.call(this)||this;return c.qo=b,c}return b.prototype.getOptions=function(){return this.$z},b.prototype.updateStyle=function(a,b,c){},b.prototype.scrollToSelect=function(){},b.prototype.getContainer=function(){return this.qo},b.prototype.refresh=function(){},b.prototype.dEc=function(){},b.prototype.dispose=function(){},b.Event_ValueChanged="ValueChangedEvent",b}(d.EventBase),b.BaseDropdown=f},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/celltype/editor/baseControl.js"),e=c("Core"),f=c("./node_modules/util/util.js"),g=Math.min,h=Math.max,i=null,j=".baseSpreadNS",k=800,l=400,m=100,n=function(a){o(b,a);function b(b,c,d){var e=a.call(this,b)||this;return e.setOptions(c),e.lCc=d,e}return b.prototype.setOptions=function(a){var b,c,d=this;d.$z=a,a&&(b=d.qo,c=document.createElement("div"),c.setAttribute("class","gc-base-spread-div"),b.appendChild(c),this.iCc=c,this.jCc=this.kCc(c))},b.prototype.setValue=function(a){var b,c=this;c.$z&&(b=c.jCc,setTimeout(function(){var a=window.Yl;a.Hm(),b&&b.focus(!0)},1e3))},b.prototype.dEc=function(){var a,b,c,d,g,h=this;h.iCc&&(a=h.qo,b=h.$z,b&&(c=b.width,d=b.height),g=h.mAa(c,d),f.isNullOrUndefined(c)&&(c=g.width),f.isNullOrUndefined(d)&&(d=g.height),e.GC$(a).width(c).height(d))},b.prototype.refresh=function(){this.jCc&&this.jCc.refresh()},b.prototype.dispose=function(){var a=this;a.lCc&&(a.lCc.zt(),a.lCc=i),a.iCc&&(a.iCc=i),a.jCc&&(a.jCc.unbind(e.Events.DropdownSpreadMouseClick+j),a.jCc.unbind(e.Events.DropdownSpreadKeyboardEnter+j),a.jCc.no(),a.jCc=i)},b.prototype.mAa=function(a,b){var c,d,e,i,j,n,o,p,q=this,r=q.jCc,s=r.getActiveSheet(),t=s.getColumnCount(),u=0;for(c=0;c<t;c++)u+=s.getColumnWidth(c,3);return d=u,e=s.getRowCount(3)+s.getRowCount(1),i=s.getRowHeight(0,3)*e,d<k&&f.isNullOrUndefined(a)||d<=a?r.options.showHorizontalScrollbar=!1:(j=0,r.UJc&&(j=r.UJc._v()),i+=j),i<l&&f.isNullOrUndefined(b)||i<b?r.options.showVerticalScrollbar=!1:(n=0,o=r.VJc,o&&(p=o.MDc(!1),n=p?p:r.Xv()),d+=n),{width:g(d,k),height:g(h(i,m),l)}},b.prototype.kCc=function(a){var b,c,d,f=new e.Workbook(a,{sheetCount:1});return f.EDc=!0,b=f.options,b.allowUserDragDrop=!1,b.allowUserDragFill=!1,b.allowUserResize=!1,b.allowUserZoom=!1,b.tabStripVisible=!1,b.allowContextMenu=!1,b.allowUserDeselect=!1,b.scrollbarMaxAlign=!0,c=f.getActiveSheet(),c.fCc=!0,d=this,f.bind(e.Events.DropdownSpreadMouseClick+j,function(a,b){d.submitData(b)}),f.bind(e.Events.DropdownSpreadKeyboardEnter+j,function(a,b){d.submitData(b)}),f},b.prototype.submitData=function(a){},b}(d.BaseDropdown),b.BaseSpreadPicker=n;function p(a,b,c){var d={sheet:a};f.isNullOrUndefined(c)||(d.isEsc=c),a.Wq(b,d)}e.GC$.extend(e.Worksheet.prototype,{gCc:function(){p(this,e.Events.DropdownSpreadMouseClick)},hCc:function(a){p(this,e.Events.DropdownSpreadKeyboardEnter,a)}})},"./dist/plugins/celltype/editor/calculator.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/celltype/editor/baseControl.js"),e=c("./dist/plugins/celltype/celltypes.ns.js"),f=c("Common"),g=c("Core"),h=g.En.npb,i=new f.Common.ResourceManager(e.SR,"CellTypes"),j=i.getResource.bind(i),k='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',l=Math.floor,m=Math.abs,n=Math.pow,o=Math.round,p=Math.sqrt,q=Math.max,r=["0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"];function y(a){var b=parseInt(window.getComputedStyle(a)["font-size"].replace("px",""),0);return isNaN(b)&&(b=0),b}s=function(){function a(){}return a.Init=function(){a.GetBrowserType();var b=void 0!==a.edge;a.IsIE=void 0!==a.ie||b},a.GetBrowserType=function(){try{var b=navigator.userAgent.toLowerCase();window.ActiveXObject?a.ie=b.match(/msie ([\d.]+)/)[1]:b.indexOf("edge")!==-1?a.edge=b.match(/edge\/([\d.]+)/)[1]:b.indexOf("firefox")!==-1&&(a.firefox=b.match(/firefox\/([\d.]+)/)[1]),b.indexOf("rv:")!==-1&&b.indexOf("firefox")===-1&&(a.ie=b.match(/rv:([\d.]+)/)[1])}catch(a){}},a}(),s.Init(),t=function(){function a(){}return a.IsErrorText=function(a){return a===j().Calculator_DivideByZeroInfo||a===j().Calculator_InvalidInputInfo||a===j().Calculator_SqrtParameterException||a===j().Calculator_OverFlowInfo},a}(),b.CalculatorErrorInfo=t,u=function(){function a(){}return a.IsDotContained=function(a){var b=a+"";return b.indexOf(".")!==-1},a.GetDotPosition=function(a){var b=a+"",c=0,d=0;for(d=b.length;d>0;d--){if("."===b.substring(d-1,d))return c;c++}return 0===d?0:c},a.FormatOutput=function(b){var c,d,e;if(null===b||void 0===b)return null;if(c=b+"",d=0,e=c.length,a.IsDotContained(c))for(;"0"===c.substring(e-1,e)&&""!==c&&c.indexOf("e")===-1;)c=c.substring(d,e-1),e--;return c},a.FormatResult=function(b){var c,d,e,f,g,h,i;return isNaN(b)&&(b=0),c=b+"",d="",b<0&&(d="-",c=c.substring(1,c.length)),e=c.length,f="",g=c.indexOf("e"),g!==-1&&(f=c.substring(g,e),c=c.substring(0,g),e=c.length),a.IsDotContained(c)&&e>16&&(h=0,parseFloat(c)>1?(h=a.GetDotPosition(c)-(e-16),c=(""+c).substring(0,17)):(h=a.GetDotPosition(c)-(e-17),c=(""+c).substring(0,18)),c=h>0?""+o(parseFloat(c)*n(10,h))/n(10,h):""+o(parseFloat(c))),e=c.length,!a.IsDotContained(c)&&e>15&&(h=e-15,c=""+o(parseFloat(c)/n(10,h))*n(10,h)),c=d+c+f,i=parseFloat(c),a.IsOverFlow(""+i)?j().Calculator_OverFlowInfo:i},a.SingleMathOperation=function(b,c){var d,e=parseFloat(b);if(isNaN(e)&&(e=0),"SQRT"===c){if(e<0)return j().Calculator_InvalidInputInfo;e=p(e)}if("POW"===c&&(e=n(e,2)),"1/x"===c){if(0===e)return j().Calculator_DivideByZeroInfo;d=a.GetDotPosition(""+e),e=n(10,d)/(n(10,d)*e)}return a.FormatResult(e)},a.DoubleMathOperation=function(b,c,d){var e,f,g,h,i=parseFloat(b),k=parseFloat(c);if(a.IsDotContained(""+i)||a.IsDotContained(""+k)){if(f=0,g=0,a.IsDotContained(""+i)&&(f=a.GetDotPosition(""+i)),a.IsDotContained(""+k)&&(g=a.GetDotPosition(""+k)),h=q(f,g),"+"===d&&(i*=n(10,h),k*=n(10,h),e=(i+k)/n(10,h)),"-"===d&&(i*=n(10,h),k*=n(10,h),e=(i-k)/n(10,h)),"*"===d&&(i*=n(10,f),k*=n(10,g),e=i*k/n(10,f+g)),"/"===d){if(i*=n(10,h),k*=n(10,h),0===k)return j().Calculator_DivideByZeroInfo;e=i/k}"%"===d&&(i*=n(10,f),k*=n(10,g),e=i*k/n(10,f+g+2))}else{if("+"===d&&(e=i+k),"-"===d&&(e=i-k),"*"===d&&(e=i*k),"/"===d){if(0===k)return j().Calculator_DivideByZeroInfo;e=i/k}"%"===d&&(e=i*k/100)}return a.FormatResult(e)},a.IsOverFlow=function(a){var b=parseFloat(a);if(0!==b){if(b>7.9e28)return!0;if(b<1e-28&&b>-1e-28)return!0;if(b<-7.9e28)return!0}return!1},a}(),v=function(){function a(a,b,c,d,e,f,g,h,i,j,k){var l=this;l.Fi=a,l.XHa=b,l.YHa=c,l.JCb=d,l.KCb=e,l.Jb=f,l.LCb=g,l.MCb=h,l.NCb=i,l.OCb=j,l.PCb=k,l.QCb=r}return a.prototype.RCb=function(){var a=this;a.Fi="",a.XHa=null,a.YHa=null,a.JCb=null,a.KCb=0,a.MCb=!1,a.NCb=!1},a.prototype.Click=function(a){var b,c=this;return a>=0&&a<=11&&(c.OCb&&(c.SCb(a),c.OCb=!1),c.TCb(a),10!==a&&(c.PCb="ClickNumericButton")),(a>=12&&a<=19||27===a)&&(c.OCb?(c.SCb(a),c.OCb=!1):(c.UCb(a),c.PCb="ClickMathButton")),24===a&&(c.OCb&&(c.SCb(a),c.OCb=!1),c.VCb()),25!==a&&26!==a||(c.SCb(a),c.OCb=!1),c.OCb?null:(b={},b.outputText=c.WCb(),t.IsErrorText(c.Fi)&&(c.OCb=!0),b.result=void 0===c.Fi||null===c.Fi?"":c.Fi,b.x=c.XHa,b.y=c.YHa,b.operation=c.JCb,b.token=c.KCb,b.count=c.Jb,b.memoryNumber=c.LCb,b.isBSCanUse=c.MCb,b.isEqualClicked=c.NCb,b.isOperationInvalid=c.OCb,b.lastOperation=c.PCb,b)},a.prototype.TCb=function(a){var b=this;if(null!==b.Fi&&void 0!==b.Fi||(b.Fi=""),!(b.Jb>14&&10!==a))switch(11!==a&&10!==a&&(0!==a||b.Fi+""!="0"&&""!==b.Fi)&&b.Jb++,10!==a&&(b.MCb=!0),b.KCb){case 0:a>=0&&a<=9&&("ClickNumericButton"!==b.PCb&&void 0!==b.PCb&&null!==b.PCb&&(b.Fi="0"),"0"===b.Fi&&0!==a?b.Fi=""+a:"0"!==b.Fi&&(b.Fi=b.Fi+""+a)),10===a&&((""+b.Fi).indexOf("e")===-1?""!==b.Fi&&"0"!==b.Fi&&((""+b.Fi).indexOf("-")===-1?b.Fi="-"+b.Fi:b.Fi=(""+b.Fi).substring(1,(""+b.Fi).length)):b.Fi-0>0?b.Fi="-"+b.Fi:b.Fi=b.Fi.substring(1,b.Fi.length)),11===a&&("ClickNumericButton"!==b.PCb&&void 0!==b.PCb&&null!==b.PCb&&(b.Fi="0."),""===b.Fi||u.IsDotContained(b.Fi)?""!==b.Fi&&u.IsDotContained(b.Fi)||(b.Fi="0."):b.Fi=b.Fi+"."),b.KCb=1;break;case 1:a>=0&&a<=9&&("ClickNumericButton"!==b.PCb&&void 0!==b.PCb&&null!==b.PCb&&(b.Fi="0"),"0"===b.Fi&&0===a||("0"===b.Fi&&0!==a?b.Fi=""+a:b.Fi=b.Fi+""+a)),10===a&&((""+b.Fi).indexOf("e")===-1?""!==b.Fi&&"0"!==b.Fi&&((""+b.Fi).indexOf("-")===-1?b.Fi="-"+b.Fi:b.Fi=(""+b.Fi).substring(1,(""+b.Fi).length)):b.Fi-0>0?b.Fi="-"+b.Fi:b.Fi=b.Fi.substring(1,b.Fi.length)),11===a&&("ClickNumericButton"!==b.PCb&&void 0!==b.PCb&&null!==b.PCb?b.Fi="0.":u.IsDotContained(b.Fi)||(""===b.Fi?b.Fi="0.":b.Fi=b.Fi+".")),b.NCb||(b.YHa=b.Fi);break;case 2:a>=0&&a<=9&&(b.Fi="",b.Fi=b.Fi+a),11===a&&(b.Fi="0."),10===a&&(b.Fi="0"),b.KCb=3,b.YHa=b.Fi;break;case 3:a>=0&&a<=9&&("ClickNumericButton"!==b.PCb&&void 0!==b.PCb&&null!==b.PCb&&(b.Fi="0"),"0"===b.Fi&&0===a||("0"===b.Fi&&0!==a?b.Fi=""+a:b.Fi=b.Fi+""+a)),10===a&&((""+b.Fi).indexOf("e")===-1?""!==b.Fi&&"0"!==b.Fi&&((""+b.Fi).indexOf("-")===-1?b.Fi="-"+b.Fi:b.Fi=(""+b.Fi).substring(1,(""+b.Fi).length)):b.Fi-0>0?b.Fi="-"+b.Fi:b.Fi=b.Fi.substring(1,b.Fi.length)),11===a&&("ClickNumericButton"!==b.PCb&&null!==b.PCb?b.Fi="0.":u.IsDotContained(b.Fi)||(""===b.Fi?b.Fi="0.":b.Fi=b.Fi+".")),b.YHa=b.Fi}},a.prototype.UCb=function(a){var b=this;switch(b.Jb=0,b.MCb=!1,b.NCb&&(b.NCb=!1),b.Fi=u.FormatOutput(b.Fi),b.KCb){case 0:""===b.Fi&&(b.Fi=0),(a>=16&&a<=18&&17!==a||27===a)&&(b.Fi=""+u.SingleMathOperation(b.Fi,b.QCb[a]),t.IsErrorText(b.Fi)||(b.XHa=b.Fi),b.KCb=1),a>=12&&a<=15&&(b.JCb=a,b.XHa=b.Fi,b.KCb=2),17===a&&b.RCb();break;case 1:(a>=16&&a<=18&&17!==a||27===a)&&(b.Fi=""+u.SingleMathOperation(b.Fi,b.QCb[a]),t.IsErrorText(b.Fi)||(null!==b.JCb&&void 0!==b.JCb&&null!==b.YHa&&void 0!==b.YHa?b.YHa=b.Fi:b.XHa=b.Fi)),19===a&&(null!==b.JCb&&void 0!==b.JCb&&null!==b.YHa&&void 0!==b.YHa?(b.Fi=""+u.DoubleMathOperation(""+b.XHa,""+b.YHa,b.QCb[b.JCb]),t.IsErrorText(b.Fi)||(b.XHa=b.Fi)):"-0."===b.Fi&&(b.Fi="0."),b.NCb=!0,b.MCb=!1),a>=12&&a<=15&&(b.JCb=a,b.XHa=b.Fi,b.KCb=2),17===a&&(null!==b.JCb&&void 0!==b.JCb?(b.YHa=b.Fi,b.Fi=""+u.DoubleMathOperation(""+b.XHa,""+b.YHa,b.QCb[17]),b.YHa=b.Fi):b.RCb());break;case 2:(a>=16&&a<=18&&17!==a||27===a)&&(b.Fi=""+u.SingleMathOperation(b.Fi,b.QCb[a]),t.IsErrorText(b.Fi)||(b.KCb=3,b.YHa=b.Fi)),19===a&&(b.YHa=b.XHa,b.Fi=""+u.DoubleMathOperation(""+b.XHa,""+b.XHa,b.QCb[b.JCb]),t.IsErrorText(b.Fi)||(b.XHa=b.Fi,b.KCb=1,b.MCb=!1),b.NCb=!0),a>=12&&a<=15&&(b.JCb=a,b.YHa=b.Fi),17===a&&(b.Fi=u.DoubleMathOperation(""+b.XHa,""+b.XHa,b.QCb[17]),t.IsErrorText(b.Fi)||(b.YHa=b.Fi,b.KCb=3));break;case 3:a>=16&&a<=18&&17!==a&&(b.Fi=""+u.SingleMathOperation(b.Fi,b.QCb[a]),t.IsErrorText(b.Fi)||(b.YHa=b.Fi)),a>=12&&a<=15&&(b.YHa=b.Fi,b.Fi=""+u.DoubleMathOperation(""+b.XHa,""+b.YHa,b.QCb[b.JCb]),t.IsErrorText(b.Fi)||(b.XHa=b.Fi,b.YHa=null,b.JCb=a,b.KCb=2)),17===a&&(b.Fi=u.DoubleMathOperation(""+b.XHa,""+b.YHa,b.QCb[17]),t.IsErrorText(b.Fi)||(b.YHa=b.Fi)),19===a&&(b.YHa=b.Fi,b.Fi=""+u.DoubleMathOperation(""+b.XHa,""+b.YHa,b.QCb[b.JCb]),t.IsErrorText(b.Fi)||(b.XHa=b.Fi,b.KCb=1,b.MCb=!1),b.NCb=!0)}b.Fi+=""},a.prototype.VCb=function(){var a,b,c=this;if(c.Jb>0&&c.Jb--,(0===c.KCb||1===c.KCb||3===c.KCb)&&c.MCb===!0)switch(c.Fi+="",a=0,b=c.Fi.length,b>0&&(c.Fi=c.Fi.substring(a,b-1)),"-0"===c.Fi&&(c.Fi="0"),"-"===c.Fi&&(c.Fi=""),""===c.Fi&&(c.MCb=!1),c.KCb){case 0:c.XHa=c.Fi;break;case 1:c.XHa=c.Fi;break;case 3:c.YHa=c.Fi}},a.prototype.SCb=function(a){var b=this;b.Jb=0,b.MCb=!1,b.Fi="",25===a&&(1===b.KCb&&(null===b.JCb||void 0===b.JCb||b.NCb||(b.YHa=0)),2===b.KCb&&(b.KCb=3)),26===a&&b.RCb()},a.prototype.WCb=function(){var a=this,b="";return b=""===a.Fi||null===a.Fi||void 0===a.Fi?"0":a.Fi},a.prototype.XCb=function(a){var b=a.keyCode;switch(a.shiftKey&&(b|=65536),a.ctrlKey&&(b|=131072),a.altKey&&(b|=262144),b){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(!s.IsIE)return 12;break;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===b&&s.firefox||187===b&&!s.firefox?19:-1}},a}(),w=function(a){x(b,a);function b(b){var c,d=a.call(this,b)||this,e=d;return e.qo=document.createElement("div"),e.qo.classList.add("gc-calculator-container"),e.qo.innerHTML=k,c=e.qo.querySelector(".okbtn"),c.textContent=j().OK,b.appendChild(d.qo),e.YCb(),e.ZCb(),e.$Cb(),e._Cb(),e.aDb("0"),d}return b.prototype.setValue=function(a){var b,c=this;a=c.bDb(a);try{if(!c.Na(a))throw Error(j().Calculator_InvalidInputInfo);a=""===a?"0":a,c.Fi=c.cDb(a),c._text=c.dDb(a),c.XHa=parseFloat(c.Fi),c.YHa=null,c.JCb=null,c.KCb=0,c.Jb=c.eDb(parseFloat(c.Fi)),c.Jb>0?c.MCb=!0:c.MCb=!1,c.NCb=!1,c.OCb=!1,c.PCb=null}catch(a){c._text=j().Calculator_InvalidInputInfo,c.Fi="",c.XHa=null,c.YHa=null,c.OCb=!0}return c.fDb(c.OCb),c.aDb(c._text),b={},b.outputText=c._text,b.result=c.Fi,b.x=c.XHa,b.y=c.YHa,b.operation=c.JCb,b.token=c.KCb,b.count=c.Jb,b.memoryNumber=c.LCb,b.isBSCanUse=c.MCb,b.isEqualClicked=c.NCb,b.isOperationInvalid=c.OCb,b.lastOperation=c.PCb,c.gDb=new v(c.Fi,c.XHa,c.YHa,c.JCb,c.KCb,c.Jb,c.LCb,c.MCb,c.NCb,c.OCb,c.PCb),c},b.prototype.setOptions=function(){},b.prototype.scrollToSelect=function(){var a=this.qo.querySelector(".gc-main-screen .gc-main");this.kDb(a)},b.prototype.YCb=function(){var a=this;a.hDb="0",a._text=a.hDb,a.Fi="",a.XHa=0,a.YHa=0,a.JCb=null,a.KCb=0,a.Jb=0,a.LCb=null,a.MCb=!1,a.NCb=!1,a.OCb=!1,a.PCb=null},b.prototype.ZCb=function(){var a=this;a.gDb=new v(this.Fi,a.XHa,a.YHa,a.JCb,a.KCb,a.Jb,a.LCb,a.MCb,a.NCb,a.OCb,a.PCb)},b.prototype.$Cb=function(){var a=this;a.fDb(a.OCb)},b.prototype._Cb=function(){var a=this,c=this,e=c.qo,f=function(f){for(var g,h,i=f.srcElement||f.target;i&&!i.classList.contains("button");)i=i.parentElement;i&&(i.getAttribute("data-value")?(g=i.getAttribute("data-value"),h=b.iDb(g),e.focus(),h!==-1&&c.jDb(h)):i.classList.contains("okbtn")&&("ClickNumericButton"===c.PCb&&c.jDb(19),a.fire(d.BaseDropdown.Event_ValueChanged,{value:c._text,text:c._text})))},g=function(a){c.XCb(a)!==!0&&(a.preventDefault(),a.stopPropagation())};e.addEventListener("click",f),e.addEventListener("keydown",g),e.addEventListener("contextmenu",function(a){a.preventDefault(),a.stopPropagation()})},b.prototype.aDb=function(a){var b=this.qo.querySelector(".gc-main-screen .gc-main"),c=b.value;null!==c&&void 0!==c&&(""+c).replace(/\r\n/g,"\n")!==(""+a).replace(/\r\n/g,"\n")&&(b.value=a,this.kDb(b))},b.prototype.kDb=function(a){var b=this;if(null!==b.lDb&&void 0!==b.lDb||(b.lDb=y(a)),b.mDb(a))for(;b.mDb(a);)b.nDb(a);else b.oDb(a)},b.prototype.mDb=function(a){var b,c,d,e,f,i,j=h();return 1===j&&a.scrollWidth>a.clientWidth||1!==j&&Math.abs(a.scrollWidth-a.clientWidth)>1||!(!g.Ul.Ml.edge&&!g.Ul.Ml.msie)&&(!(a.clientWidth<=0)&&(b=window.getComputedStyle(a),c=b.fontWeight,d=b.fontSize,e=b.fontFamily,f=c+" "+d+" "+e,i=g.Vn.Xn(a.value,f),i+40>a.clientWidth))},b.prototype.nDb=function(a){var b=y(a);a.style.fontSize=b-1+"px"},b.prototype.oDb=function(a){for(var b=this,c=y(a);!b.mDb(a)&&c<b.lDb;)if(++c,a.style.fontSize=c+"px",b.mDb(a)){for(;b.mDb(a);)b.nDb(a);break}},b.prototype.bDb=function(a){if(void 0===a||"string"!=typeof a&&!(a instanceof String))throw Error(a+" type is not a string.");return null!==a&&void 0!==a||(a=""),""+a},b.prototype.pDb=function(a,b){var c,d,e,f;if(0===b.length)return"";for(c="",d=0,e=0,d=0;d<b.length;d++){for(f=!1,e=0;e<a.length;e++)b.substring(d,d+1)===a.substring(e,e+1)&&(f=!0);f===!0&&(c+=b.substring(d,d+1))}return c},b.prototype.Na=function(a){if(this.pDb("-.0123456789",a)!==a)return!1;var b=a.indexOf("-");return(b===-1||0===b)&&(a.indexOf("-")===a.lastIndexOf("-")&&a.indexOf(".")===a.lastIndexOf("."))},b.prototype.cDb=function(a){var b,c,d,e,f,g=parseFloat(a),h=!1;if(g<0&&(h=!0),b=m(g),c=l(b),d=u.GetDotPosition(""+b),e=(b*n(10,d)-c*n(10,d))/n(10,d),c>999999999999999)throw Error(j().Calculator_InvalidInputInfo);if(999999999999999===c){if(0===e)return c;throw Error(j().Calculator_InvalidInputInfo)}return f=0===c?15:15-(""+c).length,e=o(e*n(10,f))/n(10,f),d=u.GetDotPosition(""+e),b=(c*n(10,d)+e*n(10,d))/n(10,d),c=l(b),d=u.GetDotPosition(""+b),e=(b*n(10,d)-c*n(10,d))/n(10,d),0===e&&(b=c),h?"-"+b:""+b},b.prototype.dDb=function(a){var b=""+a;return""===b&&(b="0"),b},b.prototype.eDb=function(a){var b=m(a),c=l(b),d=u.GetDotPosition(""+b),e=(b*n(10,d)-c*n(10,d))/n(10,d),f=0===c?0:(""+c).length,g=0===e?0:d;return f+g},b.prototype.fDb=function(a){for(var b=10;b<=18;b++)this.qDb(b,a);this.qDb(27,a)},b.prototype.qDb=function(a,b){var c=r[a],d=this.qo.querySelector('[data-value="'+c.toLowerCase()+'"]');d&&(b?d.classList.add("disabled"):d.classList.remove("disabled"))},b.iDb=function(a){var b=-1;switch(a){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":b=parseInt(a,10);break;case"+/-":b=10;break;case".":b=11;break;case"+":b=12;break;case"-":b=13;break;case"*":b=14;break;case"/":b=15;break;case"sqrt":b=16;break;case"%":b=17;break;case"1/x":b=18;break;case"=":b=19;break;case"MC":b=20;break;case"MR":b=21;break;case"MS":b=22;break;case"M+":b=23;break;case"BS":b=24;break;case"CE":b=25;break;case"C":b=26;break;case"pow":b=27;break;default:b=-1}return b},b.prototype.jDb=function(a){var b=this,c=b.gDb.Click(a);null!==c&&void 0!==c&&(null!==c.result&&void 0!==c.result&&(b.Fi=c.result),null!==c.outputText&&void 0!==c.outputText&&(b.hDb=c.outputText,b._text=b.hDb,b.aDb(b.hDb)),null!==c.isOperationInvalid&&void 0!==c.isOperationInvalid&&c.isOperationInvalid!==b.OCb&&(b.OCb=c.isOperationInvalid,b.fDb(b.OCb)),c.memoryNumber!==b.LCb&&(b.LCb=c.memoryNumber),c.lastOperation!==b.PCb&&(b.PCb=c.lastOperation))},b.prototype.XCb=function(a){var b=this.gDb.XCb(a);return null===b||void 0===b||b!==-1&&void this.jDb(b)},b}(d.BaseDropdown),b.Calculator=w},"./dist/plugins/celltype/editor/calendar.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/celltype/editor/eventbase.js"),e=c("./dist/plugins/celltype/editor/timepicker.js"),f=c("./dist/plugins/celltype/editor/baseControl.js"),g=c("./dist/plugins/celltype/celltypes.ns.js"),h=c("Common"),i=c("Core"),j=new h.Common.ResourceManager(g.SR,"CellTypes"),k=j.getResource.bind(j),l=h.Common.j,m=l.Fa,n=document;function xa(a){return n.createElement(a)}o="gc-calendar-container",p="gc-date-time-container",q="gc-date-part-container",r="gc-time-part-container",s="gc-ok-button-container",t="gc-date-container",u="gc-week-container",v="gc-today-container",w="gc-content-container",x="gc-header-container",y="gc-header-title",z="gc-content-td-date",A="gc-content-td-time",B="gc-date-time-vertical-partline",C="gc-date-time-horizontal-partline",D="gc-year-page",E="gc-year-select-div",F="gc-month-page",G="gc-day-page",H="gc-left-arrow",I="gc-right-arrow",J="gc-is-focused",K="gc-cl-select",L="gc-cl-is-selected",M="gc-cl-disabled-text",N="gc-cl-select-container",O="gc-focus-part-indicator",P="gc-cl-datepicker",Q="gc-cl-dropdown",R="gc-cl-datepicker-filter",S="gc-cl-datepicker-filter-month",
T="gc-cl-grid-align-spread",U="gc-cl-align-middle",V="gc-cl-button-icon-container",W="gc-cl-datepicker-month",X="gc-cl-day",Y="gc-cl-week",Z="gc-cl-show-inline-block",$="gc-cl-p-bottom-x-small",_="gc-cl-shrink-none",aa="gc-cl-grow",ba="gc-cl-grid",ca="gc-uiButton",da="gc-cl-button",ea="gc-cl-button-brand",fa="year-index",ga="month-index",ha="week-index",ia="day-index",function(a){a[a.Date=1]="Date",a[a.Time=2]="Time"}(ja||(ja={})),ka=function(){function a(){}return a.initResource=function(){a.resource={shortWeeks:[k().Calendar_ShortWeeks_1,k().Calendar_ShortWeeks_2,k().Calendar_ShortWeeks_3,k().Calendar_ShortWeeks_4,k().Calendar_ShortWeeks_5,k().Calendar_ShortWeeks_6,k().Calendar_ShortWeeks_7],shortMonths:[k().Calendar_ShortMonths_1,k().Calendar_ShortMonths_2,k().Calendar_ShortMonths_3,k().Calendar_ShortMonths_4,k().Calendar_ShortMonths_5,k().Calendar_ShortMonths_6,k().Calendar_ShortMonths_7,k().Calendar_ShortMonths_8,k().Calendar_ShortMonths_9,k().Calendar_ShortMonths_10,k().Calendar_ShortMonths_11,k().Calendar_ShortMonths_12],weeks:[k().Calendar_Weeks_7,k().Calendar_Weeks_1,k().Calendar_Weeks_2,k().Calendar_Weeks_3,k().Calendar_Weeks_4,k().Calendar_Weeks_5,k().Calendar_Weeks_6],months:[k().Calendar_Months_1,k().Calendar_Months_2,k().Calendar_Months_3,k().Calendar_Months_4,k().Calendar_Months_5,k().Calendar_Months_6,k().Calendar_Months_7,k().Calendar_Months_8,k().Calendar_Months_9,k().Calendar_Months_10,k().Calendar_Months_11,k().Calendar_Months_12],timePrefix:[k().Calendar_Time_AM,k().Calendar_Time_PM],eraNames:[k().Calendar_EraName_1,k().Calendar_EraName_2,k().Calendar_EraName_3,k().Calendar_EraName_4],earFirstYear:k().Calendar_FirstYear,today:k().Calendar_Today,lastMonth:k().Calendar_LastMonth,nextMonth:k().Calendar_NextMonth,lastYear:k().Calendar_LastYear,nextYear:k().Calendar_NextYear,lastTenYears:k().Calendar_LastTenYear,nextTenYears:k().Calendar_NextTenYear}},a.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},a}(),la=function(){function a(){this.yearTds=[]}return a}(),ma=function(){function a(){this.monthTds=[]}return a}(),na=function(){function a(){this.weekThs=[],this.dayTds=[]}return a}(),oa=function(){function a(){this.calendarYearSection=new la,this.calendarMonthSection=new ma,this.calendarDaySection=new na,this.timeItemLIs=[]}return a}(),pa=function(){function a(){}return a.dateEqual=function(a,b,c){if(!a&&!b)return!0;if(!a)return!1;if(!b)return!1;try{return c?a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()&&a.getHours()===b.getHours()&&a.getMinutes()===b.getMinutes()&&a.getSeconds()===b.getSeconds():a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()}catch(a){return!1}},a.getMonthMaxDay=function(a,b){return[1,3,5,7,8,10,12].indexOf(b)!==-1?31:[4,6,9,11].indexOf(b)!==-1?30:a%4===0&&a%100!==0?29:28},a.isValidEraDate=function(a){return!(a<this.eraMin||a>this.eraMax)},a.addMilliseconds=function(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds());return c.setMilliseconds(c.getMilliseconds()+b),new Date(c.valueOf())},a.getEraDate=function(b){var c,d,e={};if(e.era=-1,e.eraYear=-1,!a.isValidEraDate(b))return e;for(c=0;c<a.eraCount;c++)if(d=c+1!==a.eraCount?a.eraDates[c+1]:a.addMilliseconds(a.eraMax,1),b<d){e.era=c,e.eraYear=b.getFullYear()-a.eraDates[c].getFullYear()+1;break}return e},a.getEraYearString=function(b){var c=new Date(b,5,30),d=a.getEraDate(c);return d.era===-1||d.eraYear===-1?""+b:""+b+"\u5e74"},a.getShortEraYearString=function(b){var c,d=new Date(b,11,31),e=a.getEraDate(d);return e.era===-1||e.eraYear===-1?"":(c=1===e.eraYear?ka.resource.earFirstYear:e.eraYear,ka.resource.eraNames[e.era]+c+"\u5e74")},a.getDateLocaleLabel=function(a){var b=a.getHours(),c=a.getMinutes(),d=b<12?ka.resource.timePrefix[0]:ka.resource.timePrefix[1],e=0===b||12===b?"12":""+b%12,f=c<10?"0"+c:""+c;return d+" "+e+":"+f},a.eraCount=4,a.eraMax=new Date(2087,11,31,23,59,59),a.eraMin=new Date(1868,8,8),a.eraDates=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)],a}(),qa=function(){function a(a,b,c,d){this.year=a,this.selected=!!b,this.disabled=!!c,this.focused=!!d}return a.prototype.getLabel=function(){return""+this.year},a}(),ra=function(){function a(a,b,c,d){this.month=a,this.selected=!!b,this.disabled=!!c,this.focused=!!d}return a.prototype.getLabel=function(){return ka.resource.shortMonths[this.month]},a}(),sa=function(){function a(a,b,c,d){this.date=a,this.selected=!!b,this.disabled=!!c,this.focused=!!d}return a.prototype.getLabel=function(){return""+this.date.getDate()},a}(),ta=function(){function a(a){this.owner=a,this.calendarPage=i.CalendarPage.month,this.oldSelectedData=null,this.selectedDate=new Date,this.focusDate=new Date(this.selectedDate.valueOf()),this.focusDateTimeIndex=-1,ka.initResource()}return a.getMonthName=function(a){return ka.resource.months[a]},a.getShortMonthName=function(a){return ka.resource.shortMonths[a]},a.prototype.updateDayItems=function(){var a,b,c,d,e,f,g,h,i,j;for(this.dayItems=[],a=this.focusDate.getFullYear(),b=this.focusDate.getMonth(),c=new Date(a,b,1),d=c.getDay(),e=this.owner.rDb,f=d-e,g=(f<0?f+7:f)%7,h=g;h>0;h--)i=new Date(a,b,1),i.setDate(i.getDate()-h),j=new sa(i,(!1),(!0),(!1)),this.dayItems.push(j);for(h=1;h<=42-g;h++)i=new Date(a,b,h),j=new sa(i),i.getMonth()!==b&&(j.disabled=!0),pa.dateEqual(i,this.selectedDate)&&(j.selected=!0),pa.dateEqual(i,this.selectedDate)&&(j.selected=!0),pa.dateEqual(i,this.focusDate)&&(j.focused=!0),this.dayItems.push(j)},a.prototype.updateMonthItems=function(){var a,b,c=this.selectedDate,d=this.focusDate;for(this.monthItems=[],a=0;a<12;a++)b=new ra(a),b.selected=c&&c.getMonth()===a&&c.getFullYear()===d.getFullYear(),b.focused=d&&d.getMonth()===a,this.monthItems.push(b)},a.prototype.updateYearItems=function(){var a,b;for(this.yearItems=[],a=this.focusDateYearRangeStart-1;a<=this.focusDateYearRangeEnd+1;a++)b=new qa(a),b.selected=this.selectedDate&&this.selectedDate.getFullYear()===a,b.focused=this.focusDate&&this.focusDate.getFullYear()===a,b.disabled=a<this.focusDateYearRangeStart||a>this.focusDateYearRangeEnd,this.yearItems.push(b)},a.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},a.prototype.getShortWeekName=function(a){var b=ka.resource.shortWeeks,c=this.owner.rDb;return a=(c+a-1)%7,b[a]},a.prototype.getCurrentMonthName=function(){var b=this.focusDate.getMonth();return a.getMonthName(b)},a}(),ua=function(a){wa(b,a);function b(b){var c=a.call(this)||this;return c.sDb=40,c.tDb=100,c.uDb=!1,c.tc=b,c}return Object.defineProperty(b.prototype,"host",{get:function(){return this.tc.getContainer()},enumerable:!0,configurable:!0}),b.prototype.createCalendarDom=function(){var a,b,c,d,e,f,g,h=this.tc;this.vDb=new oa,a=xa("div"),a.tabIndex=0,a.classList.add(o),h.JK?a.classList.add(p):a.classList.add(t),b=xa("table"),c=xa("tr"),d=xa("td"),d.classList.add(z),h.JK&&d.classList.add(A),d.appendChild(this.wDb()),c.appendChild(d),b.appendChild(c),a.appendChild(b),h.JK&&(e=xa("tr"),f=xa("td"),d.appendChild(this.xDb()),d.appendChild(this.yDb()),f.appendChild(this.zDb()),f.appendChild(this.ADb()),e.appendChild(f),b.appendChild(e)),this.vDb.outterContainerDiv=a,g=this.host,g&&(g.innerHTML="",g.appendChild(a))},b.prototype.ADb=function(){var a,b=xa("div");return b.classList.add(s),a=xa("button"),a.textContent=k().OK,a.className=da+" "+ea+" "+ca,b.appendChild(a),this.vDb.okButton=a,b},b.prototype.xDb=function(){var a=xa("div");return a.classList.add(B),a},b.prototype.zDb=function(){var a=xa("div");return a.classList.add(C),a},b.prototype.wDb=function(){var a=xa("div");return a.className=q+" "+P+" "+Q,a.tabIndex=0,a.appendChild(this.BDb()),a.appendChild(this.CDb()),a.appendChild(this.DDb()),this.vDb.dateContainerDiv=a,a},b.prototype.BDb=function(){var a=xa("div");return a.classList.add(D),a.appendChild(this.EDb()),a.appendChild(this.FDb()),a},b.prototype.EDb=function(){var a,b,c,d,e,f,g,h,i=xa("div");return i.className=x+" "+R+" "+ba,a=xa("div"),a.className=S+" "+ba+" "+T+" "+aa,b=xa("div"),b.classList.add(U),c=xa("button"),c.className=da+" "+V,c.title=k().Calendar_LastTenYear,c.setAttribute("type","button"),d=xa("div"),d.classList.add(H),c.appendChild(d),e=xa("span"),e.classList.add(U),f=xa("button"),f.className=da+" "+V,f.title=k().Calendar_NextTenYear,f.setAttribute("type","button"),g=xa("div"),g.classList.add(I),f.appendChild(g),a.appendChild(c),a.appendChild(e),a.appendChild(f),h=this.vDb.calendarYearSection,h.headerDiv=i,h.lastYearRangeButton=c,h.focusDateYearRangeName=e,h.nextYearRangeButton=f,i.appendChild(a),i},b.prototype.FDb=function(){var a,b=xa("table");return b.className=w+" "+W,a=xa("div"),a.appendChild(b),this.vDb.calendarYearSection.currentYearRangeTable=b,this.GDb(),a},b.prototype.GDb=function(){var a,b,c,d,e,f=this.vDb.calendarYearSection,g=xa("tbody");for(a=0;a<3;a++){for(b=xa("tr"),c=0;c<4;c++)d=xa("td"),d.setAttribute(fa,""+(4*a+c)),e=xa("span"),e.classList.add(X),e.setAttribute(fa,""+(4*a+c)),e.innerText=""+(4*a+c+1),d.appendChild(e),b.appendChild(d),f.yearTds.push(d);g.appendChild(b)}f.currentYearRangeTable.appendChild(g)},b.prototype.CDb=function(){var a=xa("div");return a.classList.add(F),a.appendChild(this.HDb()),a.appendChild(this.IDb()),a},b.prototype.HDb=function(){var a,b,c,d,e,f,g,h,i=xa("div");return i.className=x+" "+R+" "+ba,a=xa("div"),a.className=S+" "+ba+" "+T+" "+aa,b=xa("div"),b.classList.add(U),c=xa("button"),c.className=da+" "+V,c.title=k().Calendar_LastYear,c.setAttribute("type","button"),d=xa("div"),d.classList.add(H),c.appendChild(d),e=xa("span"),e.className=y+" "+U,f=xa("button"),f.className=da+" "+V,f.title=k().Calendar_NextYear,f.setAttribute("type","button"),g=xa("div"),g.classList.add(I),f.appendChild(g),a.appendChild(c),a.appendChild(e),a.appendChild(f),h=this.vDb.calendarMonthSection,h.headerDiv=i,h.lastYearButton=c,h.currentYearName=e,h.nextYearButton=f,i.appendChild(a),i},b.prototype.IDb=function(){var a,b=xa("table");return b.className=w+" "+W,a=xa("div"),a.appendChild(b),this.vDb.calendarMonthSection.currentYearTable=b,this.JDb(),a},b.prototype.JDb=function(){var a,b,c,d,e,f=this.vDb.calendarMonthSection,g=xa("tbody");for(a=0;a<3;a++){for(b=xa("tr"),c=0;c<4;c++)d=xa("td"),d.setAttribute(ga,""+(4*a+c+1)),e=xa("span"),e.classList.add(X),e.setAttribute(ga,""+(4*a+c+1)),e.innerText=""+(4*a+c+1),d.appendChild(e),b.appendChild(d),f.monthTds.push(d);g.appendChild(b)}f.currentYearTable.appendChild(g)},b.prototype.DDb=function(){var a=xa("div");return a.classList.add(G),a.appendChild(this.KDb()),a.appendChild(this.LDb()),a.appendChild(this.MDb()),a.appendChild(this.NDb()),a},b.prototype.KDb=function(){var a,b,c,d,e,f,g,h,i,j,l,m,n,o,p,q,r,s=xa("div");for(s.className=x+" "+R+" "+ba,a=xa("div"),a.className=S+" "+ba+" "+T+" "+aa,b=xa("div"),b.classList.add(U),c=xa("button"),c.className=da+" "+V,c.title=k().Calendar_LastMonth,c.setAttribute("type","button"),d=xa("div"),d.classList.add(H),c.appendChild(d),e=xa("span"),e.className=y+" "+U,f=xa("button"),f.className=da+" "+V,f.title=k().Calendar_NextMonth,f.setAttribute("type","button"),g=xa("div"),g.classList.add(I),f.appendChild(g),a.appendChild(c),a.appendChild(e),a.appendChild(f),h=xa("div"),h.className=E+" "+_,i=xa("div"),i.classList.add(N),j=xa("select"),j.classList.add(K),l=new Date,m=l.getFullYear()-this.tDb,n=l.getFullYear()+this.sDb,o=m;o<=n;o++)p=xa("option"),p.text=""+o,p.value=""+o,j.options.add(p);return q=xa("div"),q.classList.add(N),i.appendChild(j),h.appendChild(i),s.appendChild(h),s.appendChild(a),r=this.vDb.calendarDaySection,r.headerDiv=s,r.lastMonthButton=c,r.currentMonthName=e,r.nextMonthButton=f,r.yearSelect=j,s},b.prototype.LDb=function(){var a,b,c,d,e,f,g=xa("div");for(g.className=u+" "+R+" "+ba,a=xa("table"),a.className=w+" "+W,b=xa("thead"),c=xa("tr"),d=0;d<7;d++)e=xa("th"),e.setAttribute(ha,""+d),f=xa("span"),f.classList.add(Y),f.setAttribute(ha,""+d),f.innerText=this.tc._data.getShortWeekName(d),e.appendChild(f),c.appendChild(e),this.vDb.calendarDaySection.weekThs.push(e);return b.appendChild(c),a.appendChild(b),g.appendChild(a),g},b.prototype.MDb=function(){var a,b,c,d,e,f,g=this.vDb.calendarDaySection,h=xa("div"),i=xa("div"),j=xa("table");for(j.className=w+" "+W,a=xa("tbody"),b=0;b<6;b++){for(c=xa("tr"),d=0;d<7;d++)e=xa("td"),e.setAttribute(ia,""+(7*b+d)),f=xa("span"),f.classList.add(X),f.setAttribute(ia,""+(7*b+d)),e.appendChild(f),c.appendChild(e),g.dayTds.push(e);a.appendChild(c)}return j.appendChild(a),i.appendChild(j),h.appendChild(i),g.dayContentTable=j,h},b.prototype.NDb=function(){var a,b,c,d,e,f=xa("div");return f.classList.add(v),a=xa("table"),a.classList.add(w),b=xa("tbody"),c=xa("tr"),d=xa("td"),e=xa("i"),e.className=Z+" "+$,e.innerText=ka.resource.today,d.appendChild(e),c.appendChild(d),b.appendChild(c),a.appendChild(b),f.appendChild(a),this.vDb.calendarDaySection.todayTd=d,this.vDb.calendarDaySection.todayTable=a,f},b.prototype.yDb=function(){var a=this,b=xa("div");return b.className=r+" "+P+" "+Q,b.tabIndex=0,this.vDb.timeContainerDiv=b,this.ODb=new e.TimePicker(b),this.ODb.setOptions({step:{minute:30},height:260}),this.ODb.on(f.BaseDropdown.Event_ValueChanged,function(b){a.PDb(b)}),b},b.prototype.updateCalendarDom=function(){this.QDb(),this.tc.JK&&this.RDb()},b.prototype.QDb=function(){switch(this.tc._data.calendarPage){case i.CalendarPage.year:this.SDb();break;case i.CalendarPage.month:this.TDb();break;case i.CalendarPage.day:this.UDb()}},b.prototype.VDb=function(){var a,b,c,d,e,f=this.tc._data,g=this.vDb.calendarDaySection,h=!1;for(g.currentMonthName.innerText=f.getCurrentMonthName(),a=f.focusDate.getFullYear(),b=g.yearSelect,c=0;c<b.options.length;c++)if(""+a===b.options[c].value){b.selectedIndex=c,h=!0;break}d=this.sDb+this.tDb+1,h?b.options[d]&&b.selectedIndex<=d-1&&b.options[d].remove():(e=xa("option"),e.text=""+a,e.value=""+a,b.options[d]=e,b.selectedIndex=d)},b.prototype.SDb=function(){var a,b,c,d,e,f,g,h,i=this.tc._data,j=this.vDb.calendarYearSection;if(i.updateYearItems(),j.focusDateYearRangeName.innerText=""+i.focusDateYearRangeStart+" - "+i.focusDateYearRangeEnd,a=j.yearTds,b=i.yearItems,0!==b.length)for(c=0;c<3;c++)for(d=0;d<4;d++)e=4*c+d,f=b[e],g=a[e],h=g.querySelector("span"),h.innerText=f.getLabel(),f.disabled?g.classList.add(M):g.classList.remove(M),f.selected?g.classList.add(L):g.classList.remove(L),f.focused?h.classList.add(J):h.classList.remove(J)},b.prototype.TDb=function(){var a,b,c,d,e,f,g,h,i,j=this.tc._data,k=this.vDb.calendarMonthSection;for(j.updateMonthItems(),a=j.focusDate.getFullYear(),b=j.monthItems,c=k.monthTds,k.currentYearName.innerText=""+a,d=0;d<3;d++)for(e=0;e<4;e++)f=4*d+e,g=b[f],h=c[f],i=h.querySelector("span"),i.innerText=g.getLabel(),g.selected?h.classList.add(L):h.classList.remove(L),g.focused?i.classList.add(J):i.classList.remove(J)},b.prototype.UDb=function(){this.VDb(),this.WDb()},b.prototype.WDb=function(){var a,b,c,d,e,f,g,h,i=this.tc._data;if(i.updateDayItems(),a=i.dayItems,0!==a.length)for(b=this.vDb.calendarDaySection.dayTds,c=0;c<6;c++)for(d=0;d<7;d++)e=7*c+d,f=a[e],g=b[e],h=g.querySelector("span"),h.innerText=f.getLabel(),f.disabled?g.classList.add(M):g.classList.remove(M),f.focused?h.classList.add(J):h.classList.remove(J),f.selected?g.classList.add(L):g.classList.remove(L)},b.prototype.RDb=function(){this.ODb.setValue(this.tc._data.selectedDate)},b.prototype.attachEvent=function(){this.XDb(),this.attachDateEvent(),this.tc.JK&&this.attachTimeEvent()},b.prototype.XDb=function(){var a=this;this.vDb.outterContainerDiv.addEventListener("keydown",function(b){a.YDb(b)})},b.prototype.YDb=function(a){return 9===a.keyCode?(this.tc.JK&&(this.tc._data.calendarActivePart===ja.Date?this.setCalendarActivePart(ja.Time):this.setCalendarActivePart(ja.Date)),void a.preventDefault()):void(this.tc._data.calendarActivePart===ja.Date&&this.ZDb(a))},b.prototype.ZDb=function(a){switch(this.tc._data.calendarPage){case i.CalendarPage.year:this.$Db(a);break;case i.CalendarPage.month:this._Db(a);break;case i.CalendarPage.day:this.aEb(a)}},b.prototype.$Db=function(a){var b=this.tc._data,c=b.focusDate;switch(a.keyCode){case 13:b.selectedDate=new Date(c.valueOf()),this.showCalendarPage(i.CalendarPage.month);break;case 32:b.selectedDate=new Date(c.valueOf());break;case 37:this.bEb();break;case 39:this.cEb();break;case 38:this.bEb(4);break;case 40:a.ctrlKey||a.metaKey?this.dEb():this.cEb(4);break;case 36:c.setFullYear(b.focusDateYearRangeStart);break;case 35:c.setFullYear(b.focusDateYearRangeEnd);break;case 33:this.eEb();break;case 34:this.fEb()}b.updateYearRange(),this.QDb()},b.prototype._Db=function(a){var b=this.tc._data,c=b.focusDate;switch(a.keyCode){case 13:b.selectedDate=new Date(c.valueOf()),this.showCalendarPage(i.CalendarPage.day);break;case 32:b.selectedDate=new Date(c.valueOf());break;case 37:this.gEb();break;case 39:this.hEb();break;case 38:a.ctrlKey||a.metaKey?this.iEb():this.gEb(4);break;case 40:a.ctrlKey||a.metaKey?this.jEb():this.hEb(4);break;case 36:c.setMonth(0);break;case 35:c.setMonth(11);break;case 33:this.bEb();break;case 34:this.cEb()}this.QDb()},b.prototype.aEb=function(a){var b=this.tc._data,c=b.focusDate,d=c.getFullYear(),e=c.getMonth(),f=c.getDate(),g=pa.getMonthMaxDay(d,e+1);switch(a.keyCode){case 13:return b.selectedDate=new Date(c.valueOf()),void this.lEb();case 32:b.selectedDate=new Date(c.valueOf());break;case 37:c.setDate(f-1);break;case 39:c.setDate(f+1);break;case 38:c.setDate(f-7);break;case 40:c.setDate(f+7);break;case 36:c.setDate(1);break;case 35:c.setDate(g);break;case 33:a.shiftKey?this.gEb(12):this.gEb();break;case 34:a.shiftKey?this.hEb(12):this.hEb()}b.selectedDate=new Date(c.valueOf()),this.QDb()},b.prototype.attachDateEvent=function(){var a=this;this.vDb.dateContainerDiv.addEventListener("click",function(b){var c=b.target;(!c||c!==a.vDb.calendarDaySection.yearSelect&&c.parentElement!==a.vDb.calendarDaySection.yearSelect)&&a.setCalendarActivePart(ja.Date)}),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},b.prototype.attachYearEvent=function(){var a=this;this.vDb.calendarYearSection.lastYearRangeButton.addEventListener("click",function(b){a.eEb(),a.QDb()}),this.vDb.calendarYearSection.nextYearRangeButton.addEventListener("click",function(b){a.fEb(),a.QDb()}),this.vDb.calendarYearSection.currentYearRangeTable.addEventListener("click",function(b){a.mEb(b)})},b.prototype.eEb=function(){var a=this.tc._data;a.focusDateYearRangeStart-=10,a.focusDateYearRangeEnd=a.focusDateYearRangeStart+9,a.focusDate.setFullYear(a.focusDate.getFullYear()-10)},b.prototype.fEb=function(){var a=this.tc._data;a.focusDateYearRangeStart+=10,a.focusDateYearRangeEnd=a.focusDateYearRangeStart+9,a.focusDate.setFullYear(a.focusDate.getFullYear()+10)},b.prototype.dEb=function(){this.showCalendarPage(i.CalendarPage.month)},b.prototype.mEb=function(a){var b,c,d,e=a.srcElement||a.target;if(e){if(b=+e.getAttribute(fa),c=this.tc._data.yearItems,0===c.length)return;d=c[b],this.tc._data.focusDate.setFullYear(d.year),this.dEb()}},b.prototype.attachMonthEvent=function(){var a=this;this.vDb.calendarMonthSection.lastYearButton.addEventListener("click",function(b){a.bEb(),a.QDb()}),this.vDb.calendarMonthSection.nextYearButton.addEventListener("click",function(b){a.cEb(),a.QDb()}),this.vDb.calendarMonthSection.currentYearName.addEventListener("click",function(b){a.iEb()}),this.vDb.calendarMonthSection.currentYearTable.addEventListener("click",function(b){a.nEb(b)})},b.prototype.bEb=function(a){var b=a?a:1,c=Math.max(this.tc._data.focusDate.getFullYear()-b,0);this.tc._data.focusDate.setFullYear(c)},b.prototype.cEb=function(a){var b=a?a:1,c=Math.min(this.tc._data.focusDate.getFullYear()+b,9999);this.tc._data.focusDate.setFullYear(c)},b.prototype.iEb=function(){this.tc._data.updateYearRange(),this.showCalendarPage(i.CalendarPage.year)},b.prototype.jEb=function(){this.showCalendarPage(i.CalendarPage.day)},b.prototype.nEb=function(a){var b,c=a.srcElement||a.target;c&&(b=+c.getAttribute(ga),this.tc._data.focusDate.setMonth(b-1),this.jEb())},b.prototype.attachDayEvent=function(){var a=this,b=this.vDb.calendarDaySection;b.lastMonthButton.addEventListener("click",function(b){a.gEb(),a.uDb||a.QDb()}),b.nextMonthButton.addEventListener("click",function(b){a.hEb(),a.uDb||a.QDb()}),b.currentMonthName.addEventListener("click",function(b){a.oEb()}),b.todayTable.addEventListener("click",function(b){a.pEb()}),b.dayContentTable.addEventListener("click",function(b){a.qEb(b)}),b.yearSelect.addEventListener("change",function(b){a.rEb(b)}),this.vDb.calendarDaySection.yearSelect.addEventListener("keydown",function(a){a.stopPropagation()})},b.prototype.gEb=function(a){var b,c,d=this.tc._data,e=a?a:1,f=d.focusDate.getFullYear(),g=d.focusDate.getMonth()-e,h=d.focusDate.getDate();g<0&&(g+=12,f-=1),b=pa.getMonthMaxDay(f,g+1),c=new Date(f,g,Math.min(h,b)),d.focusDate=c},b.prototype.hEb=function(a){var b,c,d=this.tc._data,e=a?a:1,f=d.focusDate.getFullYear(),g=d.focusDate.getMonth()+e,h=d.focusDate.getDate();g>11&&(g-=12,f+=1),b=pa.getMonthMaxDay(f,g+1),c=new Date(f,g,Math.min(h,b),d.focusDate.getHours(),d.focusDate.getMinutes(),d.focusDate.getSeconds()),d.focusDate=c},b.prototype.oEb=function(){this.showCalendarPage(i.CalendarPage.month)},b.prototype.qEb=function(a){var b,c,d,e,f,g,h=this.tc._data,i=a.srcElement||a.target;if(i){if(b=i.getAttribute(ia),m(b))return;if(c=h.dayItems,0===c.length)return;d=c[+b],e=d.date,f=h.selectedDate,g=f?new Date(f.valueOf()):new Date,h.selectedDate=new Date(e.getFullYear(),e.getMonth(),e.getDate(),g.getHours(),g.getMinutes(),g.getSeconds(),g.getMilliseconds()),h.focusDate=new Date(h.selectedDate.valueOf()),this.QDb(),this.tc.JK||this.lEb()}this.vDb.dateContainerDiv.focus()},b.prototype.pEb=function(){var a=this.tc,b=a._data.selectedDate,c=b?new Date(b.valueOf()):null,d=new Date;c&&(d.setHours(c.getHours()),d.setMinutes(c.getMinutes()),d.setSeconds(0)),a._data.selectedDate=d,a._data.focusDate=new Date(d.valueOf()),this.QDb(),a.JK||this.lEb()},b.prototype.rEb=function(a){var b=a.srcElement||a.target;b&&(this.tc._data.focusDate.setFullYear(+b.value),this.updateCalendarDom())},b.prototype.attachTimeEvent=function(){var a=this;this.vDb.timeContainerDiv.addEventListener("click",function(b){a.setCalendarActivePart(ja.Time)}),this.vDb.okButton.addEventListener("click",function(b){a.lEb()})},b.prototype.PDb=function(a){var b=this.tc._data,c=b.selectedDate?new Date(b.selectedDate.valueOf()):new Date,d=a.value;c.setHours(d.getHours()),c.setMinutes(d.getMinutes()),c.setSeconds(d.getSeconds()),b.selectedDate=c,b.focusDate=new Date(c.valueOf())},b.prototype.lEb=function(){var a=this.tc._data;this.fire(f.BaseDropdown.Event_ValueChanged,{oldValue:a.oldSelectedData,newValue:a.selectedDate}),a.oldSelectedData=a.selectedDate},b.prototype.showCalendarPage=function(a){var b=this.host.querySelector("."+D),c=this.host.querySelector("."+F),d=this.host.querySelector("."+G);switch(b.style.display="none",c.style.display="none",d.style.display="none",a){case i.CalendarPage.year:b.style.display="";break;case i.CalendarPage.month:c.style.display="";break;case i.CalendarPage.day:d.style.display=""}this.tc._data.calendarPage=a,this.updateCalendarDom()},b.prototype.setCalendarActivePart=function(a){switch(this.tc._data.calendarActivePart=a,this.vDb.dateContainerDiv.classList.remove(O),this.tc.JK&&this.vDb.timeContainerDiv.classList.remove(O),a){case ja.Date:this.tc.JK&&this.vDb.dateContainerDiv.classList.add(O),this.vDb.outterContainerDiv.focus();break;case ja.Time:this.tc.JK&&this.vDb.timeContainerDiv.classList.add(O),this.vDb.outterContainerDiv.focus()}},b.Event_GetHost="GetHost",b}(d.EventBase),va=function(a){wa(b,a);function b(b,c){var d=a.call(this,b)||this;return d.rDb=7,d.JK=!0,d._data=new ta(d),d.yl=new ua(d),d.yl.on(f.BaseDropdown.Event_ValueChanged,function(a){var b=(new h.Common.CultureInfo).DateTimeFormat,c=new h.Formatter.GeneralFormatter(b.defaultDatePattern).format(a.newValue);d.fire(f.BaseDropdown.Event_ValueChanged,{text:c,value:a.newValue})}),d.yl.on(ua.Event_GetHost,function(a){a.host=d.qo}),d.yl.createCalendarDom(),d.yl.attachEvent(),d.setValue(new Date),d.yl.showCalendarPage(i.CalendarPage.day),d.yl.setCalendarActivePart(ja.Date),c&&d.setOptions(c),d}return b.prototype.setOptions=function(a){var b,c;a&&(a.showTime||(this.JK=a.showTime,this.yl.createCalendarDom(),this.yl.attachEvent()),b=a&&a.calendarPage?a.calendarPage:i.CalendarPage.day,c=a&&a.startDay?a.startDay:i.CalendarStartDay.saturday,c!==this.rDb&&(this.rDb=c,this.qo.innerHTML="",this.yl.createCalendarDom(),this.yl.attachEvent()),this.yl.showCalendarPage(b),this.yl.setCalendarActivePart(ja.Date))},b.prototype.setValue=function(a){if(!isNaN(a.valueOf())){var b=this._data;b.selectedDate=a,b.oldSelectedData=new Date(a.valueOf()),b.focusDate=new Date(a.valueOf()),b.updateYearRange()}},b.prototype.scrollToSelect=function(){this.yl.updateCalendarDom()},b}(f.BaseDropdown),b.Calendar=va},"./dist/plugins/celltype/editor/colorpicker.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/celltype/editor/listControl.js"),e=c("Core"),f=c("./dist/plugins/celltype/editor/baseControl.js"),g=c("./dist/plugins/celltype/celltypes.ns.js"),h=c("Common"),i=h.Common.j.Fa,j="group-name",k=new h.Common.ResourceManager(g.SR,"CellTypes"),l=k.getResource.bind(k),m=function(a){n(b,a);function b(b,c){var d=a.call(this,b)||this;return d.ad(),d.setOptions(c),d}return b.prototype.setOptions=function(a){if(!a)return void this.VF();if(this.options=this.options||{},!i(a.colorBlockSize)){var b=parseInt(a.colorBlockSize,10);!isNaN(b)&&b>=0&&(this.options.colorBlockSize=a.colorBlockSize)}i(a.groups)||(this.options.groups=a.groups),this.VF()},b.prototype.setValue=function(a){i(a)||(this.BYa=a,this.sEb=null,this.VF())},b.prototype.ad=function(){var a,c=this,d=b.DefaultColorGroup(),e=[];for(a=0;a<d.length;a++)e.push({name:d[a].name,colors:d[a].colors,needScaleColor:d[a].needScaleColor});this.options={colorBlockSize:b.DefaultCellWidth,groups:e},this.tEb=document.createElement("div"),this.tEb.classList.add("gc-color-picker-outer-div"),this.tEb.addEventListener("click",function(a){c.uEb(a)}),this.qo.appendChild(this.tEb)},b.prototype.VF=function(){this.tEb.innerHTML="",new d.List(this.tEb,this.vEb()),this.wEb()},b.prototype.wEb=function(){var a,b,c,d=this.tEb.querySelectorAll(".gc-color-picker-color-cell");if(d.length>0)for(a=0;a<d.length;a++)d[a].classList.remove("selected"),b=d[a].getAttribute("color"),c=d[a].getAttribute(j),this.BYa===b&&(!this.sEb||this.sEb&&this.sEb===c)&&d[a].classList.add("selected")},b.prototype.xEb=function(){var a,b,c,d,e=0,f=this.options.groups;for(a=0;a<f.length;a++)for(b=f[a],c=0;c<b.colors.length;c++)d=b.colors[c],e=Math.max(e,d.length);return e},b.prototype.vEb=function(){var a,c,d,e=[],f=this.options.colorBlockSize||b.DefaultCellWidth,g=this.xEb(),h=this.options.groups;for(a=0;a<h.length;a++)c=this.yEb(h[a],f,g),e.push(c),h[a].needScaleColor&&(d=this.zEb(h[a].colors[0]),e.push(this.yEb(d,f,g)));return{items:e}},b.prototype.zEb=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p={},q=[];q.length=5,b=5,c=[-5,-15,-25,-35,-50],d=[-10,-25,-50,-75,-90],e=[80,60,40,-25,-50],f=document.createElement("span"),g=a.length,f.style.display="none",document.body.appendChild(f);try{for(h=0;h<g;h++)for(i=this.AEb(a[h],f),j=i[0],k=i[1],l=i[2],m=this.BEb(j,k,l),n=0;n<5;n++)q[n]||(o=[],o.length=g,q[n]=o),1===m?q[n][h]=this.CEb(j,k,l,c[n]):m>=.8?q[n][h]=this.CEb(j,k,l,d[n]):0===m?q[n][h]=this.CEb(j,k,l,Math.abs(c[b-n-1])):m<=.2?q[n][h]=this.CEb(j,k,l,Math.abs(d[b-n-1])):q[n][h]=this.CEb(j,k,l,e[n]);p.colors=q}finally{document.body.removeChild(f)}return p},b.prototype.AEb=function(a,b){var c,d,e,f,g;return b.style.color=a,f=window.getComputedStyle(b).color,g=f.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),c=parseInt(g[0],10),d=parseInt(g[1],10),e=parseInt(g[2],10),[c,d,e]},b.prototype.CEb=function(a,b,c,d){var e,f,g;return d/=100,e=this.DEb(a,b,c),f=parseInt(""+(d>0?(240-e.luminosity)*d:e.luminosity*d),10),g=this.EEb(e.hue,e.luminosity+f,e.saturation),this.FEb(g.r,g.g,g.b)},b.prototype.GEb=function(a){var b=a.toString(16);return 1===b.length?"0"+b:b},b.prototype.FEb=function(a,b,c){return"#"+this.GEb(a)+this.GEb(b)+this.GEb(c)},b.prototype.EEb=function(a,b,c){var d,e,f,g,h;return 0===c?d=e=f=parseInt(""+255*b/240,10):(g=void 0,h=void 0,h=b<=120?(b*(240+c)+120)/240:b+c-(b*c+120)/240,g=2*b-h,d=parseInt(""+(255*this.fc(g,h,a+80)+120)/240,10),e=parseInt(""+(255*this.fc(g,h,a)+120)/240,10),f=parseInt(""+(255*this.fc(g,h,a-80)+120)/240,10)),{a:255,r:d,g:e,b:f}},b.prototype.fc=function(a,b,c){return c<0&&(c+=240),c>240&&(c-=240),c<40?a+((b-a)*c+20)/40:c<120?b:c<160?a+((b-a)*(160-c)+20)/40:a},b.prototype.BEb=function(a,b,c){var d=this.DEb(a,b,c);return d.luminosity/240},b.prototype.DEb=function(a,b,c){var d,e,f,g,h,i=Math.max(Math.max(a,b),c),j=Math.min(Math.min(a,b),c),k=i+j,l=parseInt(""+(240*k+255)/510,10),m=i-j;return 0===m?(d=0,e=160):(d=l<=120?parseInt(""+(240*m+k/2)/k,10):parseInt(""+(240*m+(510-k)/2)/(510-k),10),f=(40*(i-a)+m/2)/m,g=(40*(i-b)+m/2)/m,h=(40*(i-c)+m/2)/m,e=a===i?parseInt(""+(h-g),10):b===i?parseInt(""+(80+f-h),10):parseInt(""+(160+g-f),10),e<0&&(e+=240),e>240&&(e-=240)),{luminosity:l,saturation:d,hue:e}},b.prototype.yEb=function(a,b,c){var d=this,f={items:function(){var e,f,g,h,i,k=document.createElement("div");for(k.classList.add("gc-color-picker-group-row"),k.style.width=(b+7)*c+"px",e=0;e<a.colors.length;e++){for(f=document.createElement("div"),f.classList.add("gc-color-picker-color-row"),g=a.colors[e],h=0;h<g.length;h++)i=document.createElement("div"),i.setAttribute(j,a.name),i.setAttribute("color",g[h]),i.style.backgroundColor=g[h],i.style.width=b+"px",i.style.height=b+"px",i.classList.add("gc-color-picker-color-cell"),d.BYa===g[h]&&d.sEb===a.name&&i.classList.add("selected"),f.appendChild(i);k.appendChild(f)}return k},layout:{direction:e.LayoutDirection.horizontal,displayAs:e.LayoutDisplayAs.inline}};return a.name&&(f.text=a.name),f},b.prototype.uEb=function(a){var b,c,d=a.srcElement||a.target;d&&(b=d.getAttribute("color"),c=d.getAttribute(j),b&&c&&(this.BYa=b,this.sEb=c,this.HEb(b),this.wEb()))},b.prototype.HEb=function(a){this.fire(f.BaseDropdown.Event_ValueChanged,{value:a,text:a})},b.DefaultCellWidth=10,b.DefaultColorGroup=function(){return[{name:l().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:l().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},b}(f.BaseDropdown),b.ColorPicker=m},"./dist/plugins/celltype/editor/eventbase.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(){this.IEb={}}return a.prototype.on=function(a,b){var c=this.IEb[a];null!==c&&void 0!==c||(c=this.IEb[a]=[]),c.push(b)},a.prototype.off=function(a,b){var c,d;
if(a){if(c=this.IEb[a],null===c||void 0===c)return;b?(d=c.indexOf(b),c.splice(d,1)):c=[],this.IEb[a]=c}else this.IEb={}},a.prototype.fire=function(a,b){var c=this,d=this.IEb[a];null!==d&&void 0!==d&&d.forEach(function(a){try{a.call(c,b)}catch(a){}})},a}();b.EventBase=d},"./dist/plugins/celltype/editor/listControl.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/celltype/editor/popupControl.js"),e=c("./dist/plugins/celltype/editor/baseControl.js"),f=c("Common"),g=c("Core"),h=f.Common.j.Fa,i=f.Common.k.Cb,j=document;function L(a){return j.createElement(a)}function M(a,b){return a.substring(0,b)+a.substring(b+1,a.length)}function N(a,b){if(f.Common.k.Bb(a,b))return!0;if(f.Common.l.Ska(b))for(var c=0;c<a.length;c++)if(a[c]-b===0)return!0;return!1}function O(a,b){var c,d=f.Common.l.Ska(b);for(c=a.length-1;c>=0;c--)(a[c]===b||d&&a[c]-b===0)&&a.splice(c,1)}function P(a){var b,c,d,e,f;if(h(a)||0===a.length)return[];for(b=[],c=0,d=0;d<a.length;d++)e=a.charAt(d),"\\"===e?(f=a.charAt(d+1),","!==f&&"\\"!==f||(a=M(a,d))):","===e&&(b.push(a.substring(c,d)),c=d+1);return b.push(a.substring(c,a.length)),b}function Q(a){var b,c,d=[];for(b=0;b<a.length;b++)c=a[b],c&&"string"==typeof c&&(c=c.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),d[b]=c;return d.join(",")}k=function(){function a(){this.JEb=new WeakMap}return a.prototype.set=function(a,b,c){var d=this.JEb.get(a);d||this.JEb.set(a,d={}),d[b]=c},a.prototype.get=function(a,b){var c=this.JEb.get(a);return c&&c[b]},a.prototype.clear=function(){this.JEb=new WeakMap},a}(),l="gc-list-control",m="gc-list-control-container",n="gc-list-control-group",o="gc-list-control-group-text",p="gc-list-control-item",q="gc-list-control-hassubitem",r="gc-list-control-selected-item",s="gc-list-control-item-text",t="gc-list-control-item-text-ellipsis",u="gc-list-control-item-ellipsis",v="gc-list-control-item-icon",w="gc-list-control-emptyicon",x="gc-list-control-subitem",y="gc-list-alignment-horizontal",z="gc-list-alignment-vertical",A="gc-list-control-item-wrap",B="gc-list-control-noitem",C="gc-list-control-listseparator",D="gc-list-control-item-bigicon",E="gc-list-control-item-bigtext",F="hide-children",G="gc-list-control-tree",H="gc-list-control-tree-text",I="gc-list-control-tree-content",J=function(a){K(b,a);function b(b,c,d){var e=a.call(this,b)||this;return e.qo=L("div"),e.qo.classList.add(l),b.appendChild(e.qo),e.xn=new k,e.TJb=d&&d.TJb||{Qb:void 0},e.bHb={items:[],doms:[]},e.setOptions(c),e}return b.prototype.setOptions=function(a){h(a)||(this.$z=R(a),this.qo.innerHTML="",this.yl())},b.prototype.setValue=function(a){if(this.$z&&this.$z.multiSelect)if("string"==typeof a)a=P(a);else if(h(a))a=[];else if(f.Common.j.Ca(a)){if(1!==this.$z.valueType){a=a.slice(0);for(var b=0;b<a.length;b++)a[b]=""+a[b]}}else a=[a];this.TJb.Qb=a,this.KEb()},b.prototype.scrollToSelect=function(){},b.prototype.updateStyle=function(a,b,c){this.qo.style.font=c},b.prototype.yl=function(){var a=L("div");a.classList.add(m),this.SXa(a,this.$z),this.qo.appendChild(a),this.LXa()},b.prototype.SXa=function(a,b){if(b&&(this.LEb(a,b.layout),b.items))if(Array.isArray(b.items))this.MEb(a,b.items);else{var c=b.items();c instanceof HTMLElement&&(a.appendChild(c),a.classList.add(p),this.LEb(c,b.layout))}},b.prototype.LEb=function(a,b){b&&b.direction===g.LayoutDirection.horizontal?a.classList.add(y):a.classList.add(z)},b.prototype.MEb=function(a,b){var c,d,e,f,i,j,k,l,m,r,s=b.some(function(a){return!!a.icon});for(c=0;c<b.length;c++)b[c].items?(d=b[c],d.layout&&d.layout.displayAs===g.LayoutDisplayAs.inline?(e=L("div"),e.classList.add(n),f=L("span"),f.innerText=d.text,(h(d.text)||""===d.text)&&f.classList.add(F),f.classList.add(o),e.appendChild(f),Array.isArray(d.items)?this.SXa(e,d):(i=d.items(),i instanceof HTMLElement&&(j=L("div"),j.classList.add(p),this.LEb(i,d.layout),j.appendChild(i),e.appendChild(j))),a.appendChild(e)):d.layout&&d.layout.displayAs===g.LayoutDisplayAs.tree?(k=L("div"),k.classList.add(G),l=L("div"),l.classList.add(p),l.classList.add(q),f=L("span"),f.innerText=d.text,f.classList.add(H),l.appendChild(f),d.layout.collapsible&&(m=L("span"),m.classList.add(x),l.appendChild(m),this.NEb(l)),k.appendChild(l),r=L("div"),r.classList.add(I),Array.isArray(d.items)?this.SXa(r,d):(i=d.items(),i instanceof HTMLElement&&(j=L("div"),j.classList.add(p),this.LEb(i,d.layout),j.appendChild(i),r.appendChild(j))),k.appendChild(r),a.appendChild(k)):this.OEb(a,b[c],!1,!0)):this.OEb(a,b[c],s)},b.prototype.OEb=function(a,b,c,d){var e,f,g,j,k,l,m;void 0===d&&(d=!1),e=L("div"),e.classList.add(p),this.$z.textEllipsis&&e.classList.add(u),"-"===b.text?(e.classList.add(B),f=L("div"),f.classList.add(C),e.appendChild(f)):(c&&(g=L("div"),g.classList.add(v),b.icon?g.style.backgroundImage="url("+b.icon+")":g.classList.add(w),e.appendChild(g)),j=L("span"),j.classList.add(s),this.$z.textEllipsis&&j.classList.add(t),j.innerText=b.text,h(b.text)&&(j.innerText=h(b.value)?"":b.value),e.appendChild(j),k=h(b.value)?null:b.value,l=i(this.bHb.items,k),l<0&&(l=this.bHb.items.length,this.bHb.doms.push([]),this.bHb.items.push(k)),this.bHb.doms[l].push(e),this.xn.set(e,"items",b),d&&(m=L("span"),m.classList.add(x),e.classList.add(q),this.xn.set(e,"sub-items",b),e.appendChild(m),this.PEb(e))),a.appendChild(e)},b.prototype.GHb=function(a,b){var c,d=this.bHb.doms[a];if(b)for(c=0;c<d.length;c++)d[c].classList.contains(q)||d[c].classList.add(r);else for(c=0;c<d.length;c++)d[c].classList.contains(r)&&d[c].classList.remove(r)},b.prototype.KEb=function(){var a,b,c,d,e=this,f=e.$z;for(h(e.formula)?f&&f.multiSelect?(b=e.TJb.Qb,a=b):a=[e.TJb.Qb]:a=["="+e.formula],c=0;c<e.bHb.items.length;c++)d=e.bHb.items[c],f&&f.multiSelect&&1!==f.valueType&&(d=""+d),N(a,d)?e.GHb(c,!0):e.GHb(c,!1)},b.prototype.LXa=function(){var a=this;this.qo.querySelector("."+m).addEventListener("click",function(b){var c,d,g,i,j,k=a.QEb(b.target,"."+p);if(k){if(k.classList.contains(q))return void a.UJb(b);c=a.xn.get(k,"items"),d=a.$z,!c&&f.Common.j.Aa(d&&d.onItemSelected)&&(c={value:d.onItemSelected(b)}),h(c)||(g=c.value,i=c.path,d&&d.multiSelect&&(j=a.TJb.Qb,j=j.slice(0),d.multiSelect&&1!==d.valueType&&(g=""+g),N(j,g)?O(j,g):f.Common.k.Sb(j,g),a.TJb.Qb=g=j,a.KEb(),1!==d.valueType&&(g=Q(g))),a.fire(e.BaseDropdown.Event_ValueChanged,{path:i,value:g,text:g,notCloseDropDown:d&&d.multiSelect,noAutoFormat:!0}))}})},b.prototype.QEb=function(a,b){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(a){for(var b=(this.document||this.ownerDocument).querySelectorAll(a),c=b.length;c>=0&&b.item(c)!==this;)--c;return c>-1});for(var c=a;c&&!c.matches(b);)c=c.parentElement;return c},b.prototype.UJb=function(a){var c,f,g,h,i,j=this,k=this.QEb(a.target,"."+p);k.classList.contains(q)&&(c=this.xn.get(k,"sub-items"),c&&c.items&&(f=L("div"),g=this.$z,c.multiSelect=g&&g.multiSelect,c.valueType=g&&g.valueType,c.onItemSelected=g&&g.onItemSelected,h=new b(f,c,this),h.KEb(),i=new d.PopupControl(f,k,{align:d.DropDownAlignment.Near,hostElement:k,direction:d.DropDownDirection.Right}),i.open(),h.on(e.BaseDropdown.Event_ValueChanged,function(a){j.fire(e.BaseDropdown.Event_ValueChanged,a),j.$z&&j.$z.multiSelect?j.KEb():i.close()}),this.xn.set(k,"sub-items-popup",i),a.stopPropagation(),a.preventDefault()))},b.prototype.PEb=function(a){var b=this;a.addEventListener("mouseenter",function(a){b.UJb(a)}),a.addEventListener("mouseleave",function(a){var c,d=a.target;d.classList.contains(q)&&(c=b.xn.get(d,"sub-items-popup"),c&&(c.close(),b.xn.set(d,"sub-items-pop",void 0)))})},b.prototype.NEb=function(a){var b=this;a.addEventListener("click",function(a){var c,d=a.target,e=b.QEb(d,"."+q);e&&(c=e.parentElement.querySelector("."+I),c&&(e.parentElement.classList.contains(F)?e.parentElement.classList.remove(F):e.parentElement.classList.add(F),a.stopPropagation(),a.preventDefault()))})},b}(e.BaseDropdown),b.List=J;function R(a){if(a.hasOwnProperty("items"))R(a.items);else if(Array.isArray(a))for(var b=0;b<a.length;b++)a[b].hasOwnProperty("items")?R(a[b]):a[b].hasOwnProperty("text")&&!a[b].hasOwnProperty("value")&&(a[b].value=a[b].text);return a}},"./dist/plugins/celltype/editor/monthPicker.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/celltype/editor/baseControl.js"),e=c("./dist/plugins/celltype/celltypes.ns.js"),f=c("Common"),g=f.Common.j.Fa,h=new f.Common.ResourceManager(e.SR,"CellTypes"),i=h.getResource.bind(h),j=document;function t(a){return j.createElement(a)}k="gc-month-picker-separator",l="gc-month-picker-year-item",m="gc-month-picker-month-item",n="gc-month-picker-qtr-item",o="selected",p="data-month",q="data-qtr",r=function(a){s(b,a);function b(b,c){var d=a.call(this,b)||this;return d.setOptions(c),d.LXa(),d}return b.prototype.setOptions=function(a){var b,c,d,e=this,f=new Date,h={startYear:f.getFullYear()-10,stopYear:f.getFullYear(),height:300};a&&(g(a.startYear)||(b=parseInt(a.startYear,10),isNaN(b)||(h.startYear=b)),!g(a.stopYear)&&a.stopYear>0&&(c=parseInt(a.stopYear,10),isNaN(c)||(h.stopYear=c)),h.stopYear<h.startYear&&(h.stopYear=a.startYear),g(a.height)||(d=parseInt(a.height,10),isNaN(d)||(h.height=d))),h.height=Math.max(1,h.height),e.$z=h,e.qo.innerHTML="",e.REb()},b.prototype.setValue=function(a){var b,c,d,e,f,g=this;a&&(b=a.getMonth()+1,c=a.getFullYear()),"number"==typeof b?(e=g.qo.querySelector("["+p+"='"+c+"-"+b+"']"),e&&(e.classList.add(o),g.SEb&&g.SEb.classList.remove(o),g.SEb=e)):"number"==typeof d&&(f=g.qo.querySelector("["+q+"='"+c+"-"+d+"']"),f&&(f.classList.add(o),g.SEb&&g.SEb.classList.remove(o),g.SEb=f))},b.prototype.scrollToSelect=function(){var a,b=this.SEb;b&&(a=b.offsetTop,this.qo.scrollTop=a)},b.prototype.TEb=function(a,b){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(a){for(var b=(this.document||this.ownerDocument).querySelectorAll(a),c=b.length;c>=0&&b.item(c)!==this;)--c;return c>-1});for(var c=a;c&&!c.matches(b);)c=c.parentElement;return c},b.prototype.LXa=function(){var a=this;this.qo.addEventListener("click",function(b){var c,e,g,h,i,j,k,l,r,s=a,t=s.TEb(b.target,"."+m+",."+n);t&&(t.getAttribute(q)||(t.classList.add(o),s.SEb&&s.SEb.classList.remove(o),s.SEb=t,c=null,e=null,g=null,t.getAttribute(p)&&(h=t.getAttribute(p),i=h.split("-"),c=+i[1],g=+i[0]),j=new Date(g,c-1,1,0,0,0,0),k=f.Common.CultureManager.q4().DateTimeFormat,l=new f.Formatter.GeneralFormatter(k.shortDatePattern),r=l.format(j),s.fire(d.BaseDropdown.Event_ValueChanged,{text:r,value:j})))})},b.prototype.REb=function(){var a,b,c,d,e=this;for(this.$z.height>=0?e.qo.style.maxHeight=this.$z.height+"px":e.qo.style.height="auto",e.qo.classList.add("gc-month-picker-container"),a=e.$z.startYear;a<=e.$z.stopYear;a++)b=document.createElement("div"),e.UEb(b),c=document.createElement("div"),c.classList.add("gc-month-picker-year-container"),e.VEb(a,c),d=document.createElement("div"),d.classList.add("gc-month-picker-month-container"),e.WEb(a,1,d),e.WEb(a,2,d),e.WEb(a,3,d),e.WEb(a,4,d),b.appendChild(c),b.appendChild(d),this.qo.appendChild(b)},b.prototype.UEb=function(a){var b=t("div");b.classList.add(k),a.appendChild(b)},b.prototype.VEb=function(a,b){var c=t("div");c.classList.add(l),c.innerText=""+a,b.appendChild(c)},b.prototype.WEb=function(a,b,c){var d=document.createElement("div"),e=t("div"),f=t("div"),g=t("div"),h=t("div");switch(e.classList.add(m),f.classList.add(m),g.classList.add(m),h.classList.add(n),b){case 1:e.innerText=i().Calendar_ShortMonths_1,e.setAttribute(p,a+"-1"),f.innerText=i().Calendar_ShortMonths_2,f.setAttribute(p,a+"-2"),g.innerText=i().Calendar_ShortMonths_3,g.setAttribute(p,a+"-3"),h.innerText=i().Quarter_Format_1,h.setAttribute(q,a+"-1");break;case 2:e.innerText=i().Calendar_ShortMonths_4,e.setAttribute(p,a+"-4"),f.innerText=i().Calendar_ShortMonths_5,f.setAttribute(p,a+"-5"),g.innerText=i().Calendar_ShortMonths_6,g.setAttribute(p,a+"-6"),h.innerText=i().Quarter_Format_2,h.setAttribute(q,a+"-2");break;case 3:e.innerText=i().Calendar_ShortMonths_7,e.setAttribute(p,a+"-7"),f.innerText=i().Calendar_ShortMonths_8,f.setAttribute(p,a+"-8"),g.innerText=i().Calendar_ShortMonths_9,g.setAttribute(p,a+"-9"),h.innerText=i().Quarter_Format_3,h.setAttribute(q,a+"-3");break;case 4:e.innerText=i().Calendar_ShortMonths_10,e.setAttribute(p,a+"-10"),f.innerText=i().Calendar_ShortMonths_11,f.setAttribute(p,a+"-11"),g.innerText=i().Calendar_ShortMonths_12,g.setAttribute(p,a+"-12"),h.innerText=i().Quarter_Format_4,h.setAttribute(q,a+"-4")}d.appendChild(e),d.appendChild(f),d.appendChild(g),d.appendChild(h),c.appendChild(d),b<4&&this.UEb(c)},b}(d.BaseDropdown),b.MonthPicker=r},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("SheetsCalc"),f=c("@grapecity/js-calc"),g=c("@grapecity/js-calc"),h=c("Common"),i=c("./dist/plugins/celltype/editor/baseControl.js"),j=c("./dist/plugins/celltype/editor/baseSpreadPicker.js"),k=c("./node_modules/util/util.js"),l=c("./dist/plugins/celltype/celltypes.ns.js"),m=new h.Common.ResourceManager(l.SR,"CellTypes"),n=m.getResource.bind(m),o=!!f;function r(a){a.suspendPaint(),a.suspendEvent(),a.suspendCalcService()}function s(a){a.resumeCalcService(),a.resumeEvent(),a.resumePaint()}function t(a,b){var c,d,e,f,g,h=a[0],i=[];if(k.isArray(h))for(c=a,d=u(a,b),e=function(a,b){var e=c[a],f={};d.forEach(function(a,b){f[a]=e[b]}),i.push(f)},f=0,g=c.length;f<g;f++)e(f,g);else i=a;return i}function u(a,b){var c=[];return b&&b.length>0?b.forEach(function(a){c.push(a.name)}):c=a.shift(),c}p=function(a){q(b,a);function b(b,c,d){return a.call(this,b,c,d)||this}return b.prototype.setOptions=function(b){var c,e,f,g,h,i,j;if(a.prototype.setOptions.call(this,b),c=this,c.$z=b,b&&(e=c.jCc,f=b.dataSource,g=b.bindingInfos,h=e.getActiveSheet(),f)){i=!0,r(h),h.options.isProtected=!0,h.options.rowHeaderVisible=!1,h.selectionPolicy(d.SelectionPolicy.single),h.selectionUnit(d.SelectionUnit.row);try{c.oCc(h,f,g)}catch(a){i=!1,c.dispose()}finally{i&&h&&(j=new d.Style,j.XHb=!1,h.setStyle(-1,-1,j,d.SheetArea.viewport),s(h))}}},b.prototype.setValue=function(b){var c,d,e,f=this;f.$z&&(a.prototype.setValue.call(this,b),c=f.jCc,d=c.getActiveSheet(),e=f.pCc(b),d.setSelection(e,-1,1,-1))},b.prototype.dispose=function(){a.prototype.dispose.call(this)},b.prototype.oCc=function(a,b,c){if(b){var d=this,e=d.rCc(b);e&&(a.setDataSource(t(e,c)),c&&a.bindColumns(c))}},b.prototype.rCc=function(a){var b,c,f,h,i,j,l,m,p,q=a,r=this.lCc;if(k.isString(q)){if(o){if(c=e.formulaToExpression(r,q),f=r.getCalcService().Hg(r.yj(),c,g.pf(0,0),!0),h=g.Convert.Fh(f)||g.Convert.Ca(f),i=!1,j=void 0,h&&(j=g.Convert.Ph(f,0,!1,!1,!1),j.isError||j.isConvertError||(i=!0)),!i)throw Error(n().MultiColumn_InvalidDataSource);b=j}}else q instanceof d.Range?b=r.getArray(q.row,q.col,q.rowCount,q.colCount):k.isArray(q)?b=q:q.zXJ&&(l=r.parent,m=l&&l.dataManager().BXJ,p=m&&m[q.zXJ],b=p&&p.CXJ());return b},b.prototype.pCc=function(a){var b,c,d,e,f,g,h,i,j,l,m,n=this,o=0;if(a)if(b=n.jCc,c=b.getActiveSheet(),d=Object.keys(a),e=d.length,f=c.getDataSource(),g=f.length,h=!1,i=n.$z.key,k.isNullOrUndefined(i))for(j=0;j<g;j++){for(l=f[j],h=!0,m=0;m<e;m++)if(i=d[m],l[i]!==a[i]&&void 0!==l[i]){h=!1;break}if(h){o=j;break}}else for(j=0;j<g;j++)if(l=f[j],l[i]===a){o=j;break}return o},b.prototype.submitData=function(a){var b,c,d,e,f,g=this,h=a.sheet,j=a.isEsc;j?b={notSubmit:!0}:(c=h.getSelections()[0],d=c.row,d>-1&&(e=h.getDataItem(d),f=g.$z.key,k.isNullOrUndefined(f)||(e=e[f]),b={value:e,text:e})),k.isNullOrUndefined(b)||g.fire(i.BaseDropdown.Event_ValueChanged,b)},b}(j.BaseSpreadPicker),b.MultiColumn=p},"./dist/plugins/celltype/editor/popupControl.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/celltype/editor/baseControl.js"),function(a){a[a.Down=0]="Down",a[a.Up=1]="Up",a[a.Left=2]="Left",a[a.Right=3]="Right"}(e=b.DropDownDirection||(b.DropDownDirection={})),function(a){a[a.Near=0]="Near",a[a.Center=1]="Center",a[a.Far=2]="Far"}(f=b.DropDownAlignment||(b.DropDownAlignment={})),function(a){a[a.None=0]="None",a[a.Flip=1]="Flip",a[a.Slide=2]="Slide"}(g=b.DropDownAdjustment||(b.DropDownAdjustment={})),h=function(){function a(a,b,c,d){this.XHa=a,this.YHa=b,this.Vo=c,this._v=d}return a.CreateFromDom=function(b){return new a(b.left,b.top,b.width,b.height)},Object.defineProperty(a.prototype,"x",{get:function(){return this.XHa},set:function(a){this.XHa=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this.YHa},set:function(a){this.YHa=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this.Vo},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this._v},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"left",{get:function(){return this.XHa},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"right",{get:function(){return this.XHa+this.Vo},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"top",{get:function(){return this.YHa},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bottom",{get:function(){return this.YHa+this._v},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Location",{get:function(){return{X:this.XHa,Y:this.YHa}},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Size",{get:function(){return{width:this.Vo,height:this._v}},enumerable:!0,configurable:!0}),a.prototype.Offset=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a];1===b.length&&"number"==typeof b[0].X&&"number"==typeof b[0].X?(this.XHa+=b[0].X,this.YHa+=b[0].Y):2===b.length&&"number"==typeof b[0]&&"number"==typeof b[1]&&(this.XHa+=b[0],this.YHa+=b[1])},a}(),b.Rectangle=h,i="ribbon-dropdowngroup-popup",j=function(a){k(b,a);function b(b,c,d){var h=a.call(this,null)||this;return h.sourceElement=b,h.target=c,h.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:e.Down,align:f.Near,horAdj:g.Flip|g.Slide,verAdj:g.Flip|g.Slide},h.globalMousedownEventHandler=function(a){var b,c;if(h.cXa){for(b=a.target,c=b;c&&c!==h.sourceElement;)c=c.parentElement;c||(h.close(),a.stopPropagation(),a.preventDefault())}},h.windowResizeEventHandler=function(){h.cXa&&h.close()},h.$z=h.defaultOption,h.cXa=!1,d&&h.mergeOption(d),h.XEb=null===h.$z.hostElement||void 0===h.$z.hostElement||!(h.$z.hostElement instanceof HTMLElement),h}return b.prototype.open=function(){this.cXa||(this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.cXa=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},b.prototype.beforeOpen=function(){this.bindEvent()},b.prototype.dispose=function(){var a=this;this.$z.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.$z.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(b){document.removeEventListener(b,a.globalMousedownEventHandler,!0)})),this.XEb?(this.sourceElement.classList.remove(i),this.sourceElement.style.display=this.YEb,this.sourceElement.style.position=this.xC):this.ZEb&&this.ZEb.parentNode&&(this.$z.hostElement.removeChild(this.ZEb),this.ZEb=null)},b.prototype.close=function(){this.cXa&&(this.cXa=!1,this.dispose(),this.fire("close"))},b.prototype.mergeOption=function(a){for(var b in a)void 0!==a[b]&&(this.$z[b]=a[b])},b.prototype.clearPosition=function(){this.$Eb.style.top=this.$Eb.style.bottom=this.$Eb.style.left=this.$Eb.style.right=""},b.prototype.calcPosition=function(){var a,b,c,d,e,f,g,i,j,k,l,m,n=this.target instanceof h;a=n?this.target:h.CreateFromDom(this.target.getBoundingClientRect()),b=new h(0,0,window.innerWidth,window.innerHeight),c=this.calculateDropDownLocation(b,a,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.$z.direction,this.$z.align,this.$z.horAdj,this.$z.verAdj),d=this.$Eb.offsetParent,e=d.getBoundingClientRect(),f=document.body,g=d.offsetWidth===f.offsetWidth&&d.offsetHeight===f.offsetHeight,i=document.documentElement,j=(window.pageXOffset||i.scrollLeft)-(i.clientLeft||0),k=(window.pageYOffset||i.scrollTop)-(i.clientTop||0),l=c.X-(g?-j:e.left),m=c.Y-(g?-k:e.top),n&&(l<0&&(l=0),m<0&&(m=0)),this.$Eb.style.left=l+"px",this.$Eb.style.top=m+"px"},b.prototype.calculateDropDownLocation=function(a,b,c,d,i,j,k){var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A={X:a.x,Y:a.y};switch(a.Offset(-A.X,-A.Y),b.Offset(-A.X,-A.Y),l=b.left,m=b.right,n=b.top,o=b.bottom,p=n,q=a.height-o,r=l,s=a.width-m,t=(k&g.Flip)===g.Flip,u=(j&g.Flip)===g.Flip,v=(k&g.Slide)===g.Slide,w=(j&g.Slide)===g.Slide,d){case e.Up:c.height>p&&t&&(d=e.Down);break;case e.Down:c.height>q&&t&&(d=e.Up);break;case e.Left:c.width>r&&u&&(d=e.Right);break;case e.Right:c.width>s&&u&&(d=e.Left)}switch(x=0,y=0,d){case e.Up:y=n-c.height;break;case e.Down:y=o;break;case e.Left:x=l-c.width;break;case e.Right:x=m}return d===e.Up||d===e.Down?i===f.Near?x=l:i===f.Center?x=l-(c.width-b.width)/2:i===f.Far&&(x=m-c.width):d!==e.Right&&d!==e.Left||(i===f.Near?y=n:i===f.Center?y=n-(c.height-b.height)/2:i===f.Far&&(y=o-c.height)),z=new h(x,y,c.width,c.height),w&&(z.width>a.width?z.x=0:(z.x=Math.max(z.x,0),z.x=Math.min(z.x,a.width-z.width))),v&&(z.height>a.height?z.y=0:(z.y=Math.max(z.y,0),z.y=Math.min(z.y,a.height-z.height))),z.Offset(A),z.Location},b.prototype.render=function(){this.XEb?(this.xC=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.YEb=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(i),this.$Eb=this.sourceElement):(this.ZEb=document.createElement("div"),this.ZEb.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.ZEb.classList.add(i),this.ZEb.appendChild(this.sourceElement),this.$z.hostElement.appendChild(this.ZEb),this.$Eb=this.ZEb)},b.prototype.bindEvent=function(){var a=this;this.$z.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(b){document.addEventListener(b,a.globalMousedownEventHandler,!0)})),this.$z.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},b}(d.BaseControl),b.PopupControl=j},"./dist/plugins/celltype/editor/slider.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/celltype/editor/baseControl.js"),e=c("Common"),f=c("Core"),g=e.Common.j.Fa,h=e.Common.u.Ob,i=null;function s(a){var b=a.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return a.toFixed(Math.max(0,(b[1]||"").length-parseInt(b[2],10)))}function t(a){var b=s(a||0),c=0;return b.indexOf(".")>=0&&(c=b.length-b.indexOf(".")-1),c}j=function(){function a(){}return a.isEmpty=function(a){return void 0===a||a===i||""===a||Array.isArray(a)&&0===a.length},a.isEmptyObject=function(a){var b,c=!0;for(b in a)if(b){c=!1;break}return c},a.pauseEvent=function(a){a.stopPropagation(),a.preventDefault()},a.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},a.allKeys=function(b){var c,d=[];if(!a.isObject(b))return[];for(c in b)b.hasOwnProperty(c)&&d.push(c);return d},a.parseStyleObject=function(b){var c,d,e,f,g,h,i;if(!a.isObject(b))return"";for(c="",d=a.allKeys(b),e=0,f=d.length;e<f;e++)g=d[e],h=b[g],i=g.replace(/([A-Z])/g,"-$1"),c+=i.toLowerCase()+": "+h+"; ";return c.trim()},a.extend=function(b,c,d){var e,f,g,h,i;for(void 0===d&&(d={}),e=a.allKeys(b),f=a.allKeys(c),g=0,h=f.length;g<h;g++)i=f[g],d[i]=c[i];for(g=0,h=e.length;g<h;g++)i=e[g],void 0===d[i]&&(d[i]=b[i]);return d},a.noop=function(){},a.measureWidth=function(a,b){var c=0,d=document.createElement("span");d.classList.add(b);try{d.innerText=a,d.style.display="none",document.body.appendChild(d),c=f.GC$(d).width()}finally{document.body.removeChild(d)}return c},a}(),k=function(){function a(a,b){this.xo=b,this.vFb={},this.vFb=j.extend(this.vFb,a)}return a.prototype.render=function(){var a,b;return this.vFb.included?(a=this.wFb(),b=this.xo.querySelector("."+this.vFb.className),b===i&&(b=document.createElement("div"),b.classList.add(""+this.vFb.className),this.xo.appendChild(b)),void b.setAttribute("style",j.parseStyleObject(a))):i},a.prototype.setLength=function(a){this.vFb.length=a,this.render()},a.prototype.wFb=function(){return this.vFb.direction===f.LayoutDirection.vertical?{bottom:this.vFb.offset+"%",height:this.vFb.length+"%"}:{left:this.vFb.offset+"%",width:this.vFb.length+"%"}},a}(),l=function(){function a(a,b){this.xo=b,this.xFb={},this.xFb=j.extend(this.xFb,a)}return a.prototype.render=function(){var a,b,c,d,e=this.xo.querySelector("."+this.xFb.className);if(e===i){for(e=document.createElement("div"),e.className=""+this.xFb.className,a=this.yFb(),b=0,c=a.length;b<c;b++)d=this.zFb(a[b]),e.appendChild(d);this.xo.appendChild(e)}},a.prototype.zFb=function(a){var b=document.createElement("span"),c=this.xFb.max-this.xFb.min,d=Math.abs(a-this.xFb.min)/c*100+"%",e=this.xFb.direction===f.LayoutDirection.vertical?{bottom:d}:{left:d};return b.classList.add(this.xFb.prefixCls+"-dot"),b.setAttribute("style",j.parseStyleObject(e)),b.setAttribute("key",""+a),b},a.prototype.yFb=function(){var a,b,c=Object.keys(this.xFb.marks).map(function(a){return+a});if(c.sort(function(a,b){return a-b}),a=c,this.xFb.dots)for(b=this.xFb.min;b<=this.xFb.max;b+=this.xFb.step)a.indexOf(b)===-1&&a.push(b);return a},a}(),m=function(){function a(a,b){this.xo=a,this.AFb={},this.exb="",this.AFb=j.extend(this.AFb,b),this.exb='\n        <div class="'+this.AFb.prefixCls+"-tooltip "+this.AFb.prefixCls+'-tooltip-placement-top">\n            <div class="'+this.AFb.prefixCls+'-tooltip-content">\n                <div class="'+this.AFb.prefixCls+'-tooltip-arrow"></div>\n                <div class="'+this.AFb.prefixCls+'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        '}return a.prototype.render=function(a,b){var c,d,f,g,i,k;this.AFb.offset=a,c=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip"),d=new e.Formatter.GeneralFormatter(this.AFb.formatString).format(b),j.isEmpty(c)&&(f=h(d),this.exb=this.exb.replace(/{{value}}/,f),g=document.createElement("div"),g.innerHTML=this.exb,this.xo.appendChild(g.firstElementChild),c=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip")),i=c.querySelector("."+this.AFb.prefixCls+"-tooltip-inner"),i.textContent=d,k=this.BFb(d),c.setAttribute("style",j.parseStyleObject(k)),this.AFb.tooltipVisible?this.show():this.hide()},a.prototype.show=function(){var a=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip");j.isEmpty(a)||(a.style.display="inline-block")},a.prototype.hide=function(){var a=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip");j.isEmpty(a)||(a.style.display="none")},a.prototype.BFb=function(a){var b=j.measureWidth(a,this.AFb.prefixCls+"-tooltip");return b=0===b?12:b/2+4,this.AFb.direction===f.LayoutDirection.vertical?{left:"-"+b+"px",bottom:"calc("+this.AFb.offset+"% + 10px)"}:{top:"-28px",left:"calc("+this.AFb.offset+"% - "+(b+4)+"px)"}},a}(),n=function(){function a(a,b){this.xo=b,this.CFb={},this.DFb=!1,this.EFb=i,this.CFb=j.extend(this.CFb,a),this.EFb=new m(this.xo,this.FFb())}return a.prototype.render=function(){var a,b=this,c=this.GFb(),d=this.BFb(),e=this.CFb.tabIndex||0;(this.CFb.disabled||e===i)&&(e=i),a=this.xo.querySelector("."+this.CFb.className),a===i&&(a=document.createElement("div"),a.className=c,this.xo.appendChild(a),a.setAttribute("role","slider"),a.setAttribute("aria-valuemin",""+this.CFb.min),a.setAttribute("aria-valuemax",""+this.CFb.max),a.setAttribute("aria-valuenow",""+this.CFb.value),a.setAttribute("aria-disabled",this.CFb.disabled+""),a.addEventListener("blur",function(){b.HFb(!1)}),a.addEventListener("mouseenter",function(){b.EFb.show()}),a.addEventListener("keydown",function(){b.HFb(!1)}),a.addEventListener("mousedown",function(){a.focus(),b.EFb.show()}),document.addEventListener("mouseup",function(){document.activeElement===a&&(b.HFb(!0),b.EFb.hide())})),a.tabIndex=e,a.setAttribute("style",j.parseStyleObject(d))},a.prototype.setOffset=function(a,b){this.CFb.offset=a,this.render(),this.EFb.render(a,b)},a.prototype.HFb=function(a){this.DFb=a},a.prototype.GFb=function(){return this.DFb?this.CFb.className+" "+this.CFb.prefixCls+"-handle-click-focused":""+this.CFb.className},a.prototype.BFb=function(){return this.CFb.direction===f.LayoutDirection.vertical?{bottom:this.CFb.offset+"%"}:{left:this.CFb.offset+"%"}},a.prototype.FFb=function(){return{prefixCls:"gc-slider",tooltipVisible:this.CFb.tooltipVisible,direction:this.CFb.direction,offset:this.CFb.offset,formatString:this.CFb.formatString}},a}(),o=function(){function a(a,b){this.xo=b,this.IFb={},this.IFb=j.extend(this.IFb,a)}return a.prototype.render=function(){var a,b,c,d,e,f=this.xo.querySelector("."+this.IFb.className);if(f===i){for(f=document.createElement("div"),f.className=""+this.IFb.className,a=this.JFb(),this.VJb(a),b=0,c=a.length;b<c;b++)d=a[b],e=this.KFb(d),e!==i&&f.appendChild(e);this.xo.appendChild(f)}},a.prototype.VJb=function(a){var b,c,d,e;for(this.WJb=0,b=1,c=a.length;b<c;b++)d=this.IFb.marks[a[0]],d&&(e=j.measureWidth(d.label,this.IFb.className+"-text"),(!this.WJb||this.WJb<e)&&(this.WJb=e))},Object.defineProperty(a.prototype,"maxWidth",{get:function(){return this.WJb},enumerable:!0,configurable:!0}),a.prototype.JFb=function(){var a=j.allKeys(this.IFb.marks);return a.sort(function(a,b){return a-b})},a.prototype.KFb=function(a){var b,c,d,e,f=this,g=this.IFb.marks[a],k=j.isObject(g)?g.label:g;return j.isEmptyObject(k)?i:(b=this.IFb.className+"-text",c=this.LFb(a),d=j.extend(c,g.style),
e=document.createElement("span"),e.classList.add(b),e.setAttribute("style",j.parseStyleObject(d)),e.setAttribute("key",""+a),e.addEventListener("mousedown",function(b){f.IFb.onClickLabel(b,a)}),e.innerHTML=h(k),e)},a.prototype.LFb=function(a){var b=this.IFb.max-this.IFb.min;return this.IFb.direction===f.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(a-this.IFb.min)/b*100+"%"}:{left:(a-this.IFb.min)/b*100+"%",transform:"translateX(-50%)"}},a}(),p=function(){function a(a,b,c,d){this.xo=a,this.MFb=b,this.NFb=c,this.$z=d,this.Tyb=i,this.OFb=i,this.Tyb=new l(this.PFb(),this.xo),this.OFb=new o(this.QFb(),this.xo)}return a.prototype.render=function(){var a=document.createElement("div");a.className=this.$z.prefixCls+"-rail",this.xo.appendChild(a),this.MFb.render(),this.Tyb.render(),this.NFb.render(),this.OFb.render(),this.OFb.maxWidth&&this.$z.direction===f.LayoutDirection.vertical&&(this.xo.style.paddingRight=this.OFb.maxWidth+"px")},a.prototype.calcValueByPosition=function(a){var b=a-this.RFb();return this.trimAlignValue(this.SFb(b))},a.prototype.trimAlignValue=function(a){return j.isEmpty(a)?i:this.TFb(a)},a.prototype.calcOffset=function(){var a=Math.max(this.$z.value-this.$z.min,0)/(this.$z.max-this.$z.min);return 100*a},a.prototype.getKeyboardValueMutator=function(a){var b=this;switch(a.keyCode){case 38:case 39:return function(a){return b.calculateNextValue("increase",a)};case 40:case 37:return function(a){return b.calculateNextValue("decrease",a)};case 35:return function(a){return b.$z.max};case 36:return function(a){return b.$z.min}}},a.prototype.calculateNextValue=function(a,b){var c={increase:function a(b,c){return b+c},decrease:function a(b,c){return b-c}},d=Object.keys(this.$z.marks).indexOf(b+""),e=c[a](d,1),f=Object.keys(this.$z.marks)[e];return this.$z.step?c[a](b,this.$z.step):!j.isEmptyObject(this.$z.marks)&&this.$z.marks[f]?this.$z.marks[f]:b},a.prototype.TFb=function(a){var b=isFinite(this.UFb(a))?this.UFb(a):0;return this.$z.step===i?b:parseFloat(b.toFixed(this.Yrb()))},a.prototype.Yrb=function(){var a,b;if(g(this.$z.precision)){a=Math.max(t(this.$z.max),t(this.$z.min),t(this.$z.step));for(b in this.$z.marks)a=Math.max(t(parseFloat(b)),a);this.$z.precision=a}return this.$z.precision},a.prototype.UFb=function(a){var b,c,d,e,f=Object.keys(this.$z.marks).map(parseFloat);return this.$z.step!==i&&(b=Math.ceil((this.$z.max-this.$z.min)/this.$z.step),c=Math.min((a-this.$z.min)/this.$z.step,b),d=Math.round(c)*this.$z.step+this.$z.min,f.push(Math.min(d,this.$z.max))),e=f.map(function(b){return Math.abs(a-b)}),f[e.indexOf(Math.min.apply(Math,e))]},a.prototype.PFb=function(){return{prefixCls:this.$z.prefixCls,className:this.$z.prefixCls+"-step",direction:this.$z.direction,marks:this.$z.marks,dots:this.$z.dots,step:this.$z.step,included:this.$z.included,max:this.$z.max,min:this.$z.min}},a.prototype.QFb=function(){var a=this;return{className:this.$z.prefixCls+"-mark",onClickLabel:this.$z.disabled?j.noop:function(b,c){a.VFb(b,c)},direction:this.$z.direction,marks:this.$z.marks,included:this.$z.included,max:this.$z.max,min:this.$z.min}},a.prototype.VFb=function(a,b){},a.prototype.RFb=function(){var a=this.xo.getBoundingClientRect();return this.$z.direction===f.LayoutDirection.vertical?a.top:a.left},a.prototype.WFb=function(){var a=this.xo.getBoundingClientRect();return this.$z.direction===f.LayoutDirection.vertical?a.height:a.width},a.prototype.SFb=function(a){var b=this.$z.min,c=this.$z.max,d=Math.abs(Math.max(a,0)/this.WFb());return this.$z.direction===f.LayoutDirection.vertical&&(d=Math.max(1-d,0)),d*(c-b)+b},a}(),q=function(a){r(b,a);function b(b,c){var e=a.call(this,b)||this;return e.MFb=i,e.NFb=i,e.XFb=i,e.YFb=function(a){j.pauseEvent(a),0===a.button&&(document.addEventListener("mouseup",e.ZFb,!1),document.addEventListener("pointerup",e.ZFb,!1),document.addEventListener("MSPointerUp",e.ZFb,!1),document.addEventListener("mousemove",e._Fb,!1),document.addEventListener("pointermove",e._Fb,!1),document.addEventListener("MSPointerMove",e._Fb,!1),e._Fb(a))},e._Fb=function(a){j.pauseEvent(a);var b=e.aGb(a);e.bGb!==b&&(e.setValue(b),e.$Fb.onChange(b))},e.ZFb=function(a){e._Fb(a),document.removeEventListener("mousemove",e._Fb),document.removeEventListener("mouseup",e.ZFb),document.removeEventListener("pointermove",e._Fb),document.removeEventListener("pointerup",e.ZFb),document.removeEventListener("MSPointerMove",e._Fb),document.removeEventListener("MSPointerUp",e.ZFb);var b=e.aGb(a);e.bGb=b,e.$Fb.onAfterChange(e.$Fb.value),e.fire(d.BaseDropdown.Event_ValueChanged,{value:b,text:""+b,notCloseDropDown:!0}),j.pauseEvent(a)},e.cGb=function(a){j.pauseEvent(a);var b=a.target||a.srcElement;document.addEventListener("touchend",e.dGb,!1),b.classList.contains(e.$Fb.prefixCls+"-handle")?document.addEventListener("touchmove",e.eGb,!1):e.eGb(a)},e.eGb=function(a){var b,c;j.pauseEvent(a),b=a.targetTouches[0],c=e.aGb(b),e.bGb!==c&&(e.setValue(c),e.$Fb.onChange(c))},e.dGb=function(a){var b,c;document.removeEventListener("touchmove",e.eGb),document.removeEventListener("touchend",e.dGb),b=a.changedTouches[0],c=e.aGb(b),e.bGb=c,e.$Fb.onAfterChange(e.$Fb.value),e.fire(d.BaseDropdown.Event_ValueChanged,{value:c,text:""+c,notCloseDropDown:!0}),j.pauseEvent(a)},e.init(c),e}return b.prototype.setValue=function(a){if(!this.$Fb.disabled){var b=parseFloat(a);isNaN(b)?b=this.$Fb.min:(b=Math.max(this.$Fb.min,b),b=Math.min(this.$Fb.max,b)),this.$Fb.value=b,this.bGb=this.$Fb.value,this.MFb.setLength(this.calcOffset()),this.NFb.setOffset(this.calcOffset(),b)}},b.prototype.calcOffset=function(){var a=Math.max(this.$Fb.value-this.$Fb.min,0)/(this.$Fb.max-this.$Fb.min);return a=Math.min(a,1),100*a},b.prototype.setOptions=function(a){this.init(a)},b.prototype.init=function(a){var b,c;this.fGb(a),this.gGb(),this.qo.innerHTML="",b=document.createElement("div"),b.className="gc-slider-container",this.qo.appendChild(b),this.$Fb.direction===f.LayoutDirection.vertical?(b.classList.add(this.$Fb.prefixCls+"-vertical"),b.style.height=this.$Fb.height+"px"):b.style.width=this.$Fb.width+"px",c=document.createElement("div"),c.className=this.GFb(),b.appendChild(c),this.MFb=new k(this.hGb(),c),this.NFb=new n(this.iGb(),c),this.XFb=new p(c,this.MFb,this.NFb,this.jGb()),this.XFb.render(),this.QQ(c)},b.prototype.QQ=function(a){var b=this;this.$Fb.disabled||(a.addEventListener("mousedown",this.YFb),a.addEventListener("pointerdown",this.YFb),a.addEventListener("MSPointerDown",this.YFb),a.addEventListener("touchstart",this.cGb),a.addEventListener("keyup",function(a){var c,e,f;if(j.pauseEvent(a),c=b.XFb.getKeyboardValueMutator(a),!j.isEmpty(c)){if(e=c(b.$Fb.value),f=b.XFb.trimAlignValue(e),f===b.$Fb.value)return;b.setValue(f),b.$Fb.onChange(f),b.$Fb.onAfterChange(f),b.fire(d.BaseDropdown.Event_ValueChanged,{value:f,text:""+f,notCloseDropDown:!0})}}))},b.prototype.aGb=function(a){var b=0;return b=this.$Fb.direction===f.LayoutDirection.vertical?this.XFb.calcValueByPosition(a.clientY):this.XFb.calcValueByPosition(a.clientX)},b.prototype.sYa=function(){var a=function(a){};return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:f.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:a,onAfterChange:a,formatString:"General"}},b.prototype.gGb=function(){(j.isEmpty(this.$Fb)||j.isEmptyObject(this.$Fb))&&(this.$Fb={}),this.$Fb=j.extend(this.sYa(),this.$Fb)},b.prototype.fGb=function(a){var b=this;a&&(g(a.scaleVisible)||(this.$Fb.dots=a.scaleVisible),g(a.direction)||(this.$Fb.direction=a.direction),g(a.formatString)||(this.$Fb.formatString=a.formatString),this.kGb(a.min,"min"),this.kGb(a.max,"max"),this.kGb(a.step,"step"),this.kGb(a.width,"width"),this.kGb(a.height,"height"),this.$Fb.step<=0&&(this.$Fb.step=1),this.$Fb.min>this.$Fb.max&&(this.$Fb.max=this.$Fb.min),g(a.tooltipVisible)||(this.$Fb.tooltipVisible=a.tooltipVisible),this.$Fb.marks={},a.marks&&a.marks.forEach(function(a){var c,d=parseFloat(a);isNaN(d)||d>=b.$Fb.min&&d<=b.$Fb.max&&(c=new e.Formatter.GeneralFormatter(b.$Fb.formatString),b.$Fb.marks[d]={label:c.format(d)})}))},b.prototype.kGb=function(a,b){if(!g(a)){var c=parseFloat(a);isNaN(c)||(this.$Fb[b]=c)}},b.prototype.hGb=function(){return{className:this.$Fb.prefixCls+"-track",included:this.$Fb.included,direction:this.$Fb.direction,offset:0,length:0}},b.prototype.iGb=function(){return{prefixCls:this.$Fb.prefixCls,className:this.$Fb.prefixCls+"-handle",direction:this.$Fb.direction,disabled:this.$Fb.disabled,min:this.$Fb.min,max:this.$Fb.max,value:this.$Fb.value,offset:0,tabIndex:0,tooltipVisible:this.$Fb.tooltipVisible,formatString:this.$Fb.formatString}},b.prototype.jGb=function(){return{prefixCls:this.$Fb.prefixCls,min:this.$Fb.min,max:this.$Fb.max,value:this.$Fb.value,disabled:this.$Fb.disabled,direction:this.$Fb.direction,dots:this.$Fb.dots,step:this.$Fb.step,included:this.$Fb.included,marks:this.$Fb.marks}},b.prototype.GFb=function(){var a=""+this.$Fb.prefixCls;return this.$Fb.direction===f.LayoutDirection.vertical&&(a+="  "+this.$Fb.prefixCls+"-vertical"),j.isEmptyObject(this.$Fb.marks)||(a+=" "+this.$Fb.prefixCls+"-with-marks"),this.$Fb.disabled&&(a+=" "+this.$Fb.prefixCls+"-disabled"),a},b}(d.BaseDropdown),b.Slider=q},"./dist/plugins/celltype/editor/timepicker.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/celltype/editor/listControl.js"),e=c("./dist/plugins/celltype/editor/baseControl.js"),f="undefined",g=c("Common"),h=g.Common.j.Fa,i=function(a){j(b,a);function b(b,c){var d=a.call(this,b)||this;return d.ad(),d.setOptions(c),d}return b.prototype.setOptions=function(a){var b,c,d,e;return a?(b=this.pGb(a.min),null!==b&&(this.$z.min=b),c=this.pGb(a.max),null!==c&&(this.$z.max=c),d=this.pGb(a.step),null!==d&&(this.$z.step=d),h(a.formatString)||(this.$z.formatString=a.formatString),h(a.height)||(e=parseInt(a.height,10),isNaN(e)||(this.$z.height=e)),this.$z.height=Math.max(1,this.$z.height),void this.VF()):void this.VF()},b.prototype.setValue=function(a){void 0!==a&&(this.KEb={hour:a.getHours(),minute:a.getMinutes(),second:a.getSeconds()},this.cHb=a,this.wEb(),this.scrollToSelect())},b.prototype.scrollToSelect=function(){var a,b=this.tEb.querySelector(".selected");null!==b&&(a=b.offsetTop,this.xo.scrollTop=a)},b.prototype.ad=function(){var a=this;this.$z={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.tEb=document.createElement("div"),this.tEb.classList.add("gc-time-picker-outer-div"),this.tEb.addEventListener("click",function(b){a.uEb(b)}),this.qo.appendChild(this.tEb)},b.prototype.pGb=function(a){var b,c,d,e=null;return h(a)||(e={},h(a.hour)||(b=parseInt(a.hour,10),isNaN(b)||(e.hour=b)),h(a.minute)||(c=parseInt(a.minute,10),isNaN(c)||(e.minute=c)),h(a.second)||(d=parseInt(a.second,10),isNaN(d)||(e.second=d))),e},b.prototype.VF=function(){this.tEb.innerHTML="",new d.List(this.tEb,this.qGb()),this.wEb()},b.prototype.wEb=function(){var a,b,c,d,e=this.tEb.querySelectorAll(".gc-time-picker-li");if(e.length>0)for(a=0;a<e.length;a++)e[a].classList.remove("selected"),b=+e[a].getAttribute("hour"),c=+e[a].getAttribute("minute"),d=+e[a].getAttribute("second"),this.rGb(this.KEb,{hour:b,minute:c,second:d})&&e[a].classList.add("selected")},b.prototype.qGb=function(){var a=this;return{items:function(){var b,c,d=a.sGb(),e=document.createElement("div");for(e.classList.add("gc-time-picker-container"),a.xo=e,a.$z.height<0?e.style.height="auto":e.style.maxHeight=a.$z.height+"px",b=document.createElement("ul"),b.classList.add("gc-time-picker-ul"),c=0;c<d.length;c++)b.appendChild(a.tGb(d[c]));return 24*d.length>a.$z.height&&a.$z.height>=0?e.style.overflowY="scroll":e.style.overflowY="hidden",e.appendChild(b),e}}},b.prototype.tGb=function(a){var b=document.createElement("li");return b.classList.add("gc-time-picker-li"),b.setAttribute("hour",""+a.hour),b.setAttribute("minute",""+a.minute),b.setAttribute("second",""+a.second),b.innerText=this.uGb(a),b},b.prototype.sGb=function(){for(var a=this.vGb(this.$z.min),b=this.vGb(this.$z.max),c=[];a<=b;)c.push({hour:a.getHours(),minute:a.getMinutes(),second:a.getSeconds()}),a=this.wGb(a,this.$z.step);return c},b.prototype.wGb=function(a,b){return typeof b.hour!==f&&a.setHours(a.getHours()+b.hour),typeof b.minute!==f&&a.setMinutes(a.getMinutes()+b.minute),typeof b.second!==f&&a.setSeconds(a.getSeconds()+b.second),a},b.prototype.uGb=function(a){var b,c,d=new Date;return d.setHours(a.hour),d.setMinutes(a.minute),d.setSeconds(a.second),b=new g.Formatter.GeneralFormatter(this.$z.formatString),c=b.format(d),c&&""!==c&&null!==c?c:this.xGb(d)},b.prototype.xGb=function(a){var b=a.getHours(),c=a.getMinutes(),d=b<12?"AM":"PM",e=0===b||12===b?"12":""+b%12,f=c<10?"0"+c:""+c;return d+" "+e+":"+f},b.prototype.vGb=function(a){var b=new Date;return b.setHours(a.hour||0),b.setMinutes(a.minute||0),b.setSeconds(a.second||0),b},b.prototype.rGb=function(a,b){return!(!a||!b)&&(a=this.yGb(a),b=this.yGb(b),a.hour===b.hour&&a.minute===b.minute&&a.second===b.second)},b.prototype.yGb=function(a){return{hour:a.hour||0,minute:a.minute||0,second:a.second||0}},b.prototype.uEb=function(a){var b,c,d,f,h,i,j=a.target;j&&(b=+j.getAttribute("hour"),c=+j.getAttribute("minute"),d=+j.getAttribute("second"),f=this.cHb||new Date,f.setHours(b),f.setMinutes(c),f.setSeconds(d),f.setMilliseconds(0),h=(new g.Common.CultureInfo).DateTimeFormat,i=new g.Formatter.GeneralFormatter(h.defaultDatePattern).format(f),this.fire(e.BaseDropdown.Event_ValueChanged,{value:f,text:i}),this.KEb={hour:b,minute:c,second:d},this.wEb())},b}(e.BaseDropdown),b.TimePicker=i},"./dist/plugins/celltype/editor/workflowPicker.js":function(a,b,c){"use strict";var d,e,f,g,h,i=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/celltype/editor/baseControl.js"),e=c("./dist/plugins/celltype/editor/listControl.js"),f=c("Common"),g=f.Common.j.Fa,h=function(a){i(b,a);function b(b,c){var f=a.call(this,b)||this;return f.FP=new e.List(b),f.FP.on(d.BaseDropdown.Event_ValueChanged,function(a){f.fire(d.BaseDropdown.Event_ValueChanged,a)}),f.setOptions(c),f}return b.prototype.setOptions=function(a){this.$z=a},b.prototype.setValue=function(a){if(this.$z){var b=j(this.$z,a);this.FP.setOptions(b)}},b.prototype.updateStyle=function(a,b,c){this.FP.updateStyle(a,b,c)},b}(d.BaseDropdown),b.WorkFlow=h;function j(a,b){var c,d,e,f={items:[]},h=a.items,i=h.filter(function(a){return a.value===b})[0];if(g(i)&&h&&h.length>0)c=f.items,c.push({text:h[0].value,value:h[0].value});else if(i&&i.transitions&&i.transitions.length>0)for(d=function(a){var b,c,d=i.transitions[a];"number"==typeof d&&h[d]&&(d=h[d].value),b=h.filter(function(a){return a.value===d})[0],b&&(c=f.items,c.push({text:b.value,value:b.value}))},e=0;e<i.transitions.length;e++)d(e);return f}},"./dist/plugins/celltype/hyperlinkcelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=e.CellTypes.Context,g=f.u5,h=e.CellTypes.Base,i=e.Ul.Nl,j=d.Common.j.Fa,k=d.Common.u.NIc,l=e.Ul.fp,m=e.Ul.Ml,n=m.mozilla,o=e.GC$,p=o.each,q=null,r=Math.max,s=Math.min,t=Math.floor,u=window.open,v="position",w="absolute",x="margin",y="font",z="left",A="top",B="padding",C="border",D="box-sizing",E="background-color",F="content-box",G="default",H="white",I="div",J="hyperlinkInfo";function O(a,b){a.removeChild(b)}!function(a){a[a.blank=0]="blank",a[a.self=1]="self",a[a.parent=2]="parent",a[a.top=3]="top"}(K=b.HyperLinkTargetType||(b.HyperLinkTargetType={})),L={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},M=function(a){N(b,a);function b(){var b,c=a.call(this)||this;return c.typeName="8",b=c,c._id=c.wK(),p(L,function(a,c){b["_"+a]=c}),c._onAction=function(a){var b=a&&a.sheet,c=a.row,d=a.col,e=a.sheetArea,f=b.getValue(c,d,e),g=P(this._target);f&&u(k(f),g)},c}return b.prototype.wK=function(){var a,b;return j(this._id)&&(this._id="0"),a=parseInt(this._id,10),b="id_"+a,a++,this._id=a+"",b},b.prototype.Eka=function(a,b,c,d,e,f,g,h,i,j){var k,l,o,p,q,r,s,u,v,w=1,x=z,y=g.hAlign,A=g.vAlign,B=h.lineHeight,C=i.length;for(w+=b,1===y?(w=e/2,x="center"):2===y&&(w=e-1,w-=b,x="right"),a.textAlign!==x&&(a.textAlign=x),k=1,l="alphabetic",o=parseInt(h.fontInfo.fontSize,10),p=o>8?t((o-8)/5+2):1,q=B/2-o/2+p-1,k+=B-q,1===A?B<f&&(k=n?(f-j)/2+1:m.msie?(f-j)/2+.5:(f-j)/2,t(k)!==k&&(k+=.5),k+=B/2-q):2===A&&(k=f-j-2.5-q),a.textBaseline!==l&&(a.textBaseline=l),r=d+k,s=0;s<C;s++)a.fillText(i[s],c+w,r),u=a.measureText(i[s]).width,v=g.textDecoration,v&&this.ip(a,v,c+w,r,u,o,p),r+=B},b.prototype.Fka=function(a,b,c,d,f,g,h,i,j){var k,l,m,n,o,p,q,s=h.hAlign,u=h.vAlign,v=i.lineHeight,w=j.length,x=0,y=0,z=0,A=0;for(2!==s&&(z=1),2===h.vAlign&&(A=-2.5),A-=r(0,Math.round(v/9)-1),a.strokeStyle!==a.fillStyle&&(a.strokeStyle=a.fillStyle),o=i.fontInfo.fontSize,p=t((o-12)/21+1),a.lineWidth=p,a.beginPath(),q=0;q<w;q++)k=a.measureText(j[q]).width,n=Q(new e.Rect(c,d,f,g),k,v*w,s,u,b),l=z+c+n.x,m=l+k,x=A+d+n.y+v,t(x)===x&&(x+=.5),y=x,a.moveTo(l,x),a.lineTo(m,y),a.stroke(),A+=v},b.prototype.paintValue=function(a,b,c,d,f,g,h,i){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=this;if(a&&(k=C.getText(b,i),!j(k))){for(k+="",l=k.split(/\r\n|\r|\n/),m=0;m<l.length;)l[m]=l[m].replace(/\s+/g," "),m++;k=l.join("\r\n"),n=!1,o=i.sheet.ITa,p=i.row,q=i.col,r=i.sheetArea,s=o.getValueForKey(p,q,J,r),s&&(C._id===s.id?n=s.visited:o.do("setValueForKey",p,q,J,void 0,r)),a.save(),a.beginPath(),t=n?C._visitedLinkColor:C._linkColor,t&&a.fillStyle!==t&&(a.fillStyle=t),u=h.font,u&&a.font!==u&&e.Ul.lZa(a,u),v=V(h),i.sheet.outlineColumn&&i.sheet.outlineColumn.XQa(i.col)&&(v=0),w=h.wordWrap,x=[],y=0,z=0,w?(A=f-3-v,A-=1,x=e.Vn.Wn(k,A,u),y=x.length,y>1&&0!==h.vAlign&&(B=i.lineHeight,z=(y-1)*B)):x.push(k),a.rect(c,d,f,g),a.clip(),a.beginPath(),C.Eka(a,v,c,d,f,g,h,i,x,z),C.Fka(a,v,c,d,f,g,h,i,x),a.restore()}},b.prototype.getText=function(a,b){return this._text||a},b.prototype.tw=function(a,b,c,d){if(!a.HF){var e=a.parent;e&&e.tw(a,b,c,d)}},b.prototype.getHitInfo=function(a,b,c,d,e){var f,g=this;return e&&(f=e.sheetArea,j(f)&&(f=3),c&&d)?{x:a,y:b,row:e.row,col:e.col,cellStyle:c,cellRect:d,sheetArea:f,isFocusAware:!0,sheet:e.sheet,isReservedLocation:U(a,b,c,d,e,g._text)}:q},b.prototype.processMouseDown=function(a){var b=a&&a.sheet,c=this;b&&!b.isEditing()&&a.isReservedLocation&&(c.AK=!0)},b.prototype.processMouseUp=function(a){var b,c=a&&a.sheet;c&&!c.isEditing()&&(b=this,a.isReservedLocation&&b.AK&&b.Eia(a),b.AK=!1)},b.prototype.processMouseMove=function(a){var b,c=a.row,d=a.col,e=a.sheet,f=this;!e||e.isEditing()&&e.getActiveRowIndex()===c&&e.getActiveColumnIndex()===d||(b=e.Ws(),a.isReservedLocation?b&&(f.BK(e,a),b.style.cursor="pointer"):(f.CK(e),b&&(b.style.cursor=G)))},b.prototype.processMouseLeave=function(a){var b,c=a.sheet,d=this;d.AK=!1,d.CK(c),c&&(b=c.Ws(),b&&(b.style.cursor=G))},b.prototype.BK=function(a,b){var c,d,e,f,g,h,i=this;i._linkToolTip&&(c=i.DK(),d=o(c),d.text(i._linkToolTip),e=a.mm.bG(),f=e.left+b.x,g=e.top+b.y+20,0===d.parent().length&&(h=a&&a.zo(),h&&h.insertBefore(c,q),d.css(A,g).css(z,f)))},b.prototype.CK=function(a){var b,c=this;c.EK&&(b=a&&a.zo(),b&&c.EK.parentElement===b&&O(b,c.EK),c.EK=q)},b.prototype.DK=function(){var a,b=this;return b.EK||(a=i(I),o(a).css(v,w).css(x,0).css(B,2).css(C,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(D,F).css(E,H).css(y,"9pt Arial"),b.EK=a),b.EK},b.prototype.isReservedKey=function(a,b){return 32===a.keyCode&&!a.ctrlKey&&!a.shiftKey&&!a.altKey},b.prototype.processKeyUp=function(a,b){var c=b.sheet,d=this;return!!c&&(d.Eia(b),!0)},b.prototype.getAutoFitWidth=function(a,b,c,d,e){return W(this._text||a,c,d,e,!0)},b.prototype.getAutoFitHeight=function(a,b,c,d,e){return W(this._text||a,c,d,e)},b.prototype.isImeAware=function(a){return!1},b.prototype.Eia=function(a){var b=a&&a.sheet,c=this,d=a.row,e=a.col,f=a.sheetArea,g=c.onClickAction();g.call(this,a),b.ITa.do("setValueForKey",d,e,J,{id:c._id,visited:!0},f),b.repaint(b.getCellRect(d,e,1===f?-1:q,2===f?-1:q)),c.tw(b,d,e,f)},b.prototype.onClickAction=function(a){return 0===arguments.length?this._onAction:(a&&(this._onAction=a),this)},b.prototype.qHJ=function(a){var b={linkColor:a.linkColor,visitedLinkColor:a.visitedLinkColor,text:a.text,linkToolTip:a.linkToolTip,target:a.target&&K[a.target],activeOnClick:a.activeOnClick};this.fromJSON(b)},b.prototype.toJSON=function(){var a,b=this,c={typeName:b.typeName};return p(L,function(d,e){a=b["_"+d],a!==e&&(c[d]=a)}),c},b.prototype.fromJSON=function(a){var b=this;p(L,function(c){var d=a[c];j(d)||(b["_"+c]=d)})},b.prototype.a5=function(a){},b.prototype.gQa=function(){var a,c=this,d=new b;return p(L,function(b,e){a=c["_"+b],a!==e&&(d["_"+b]=a)}),d._onAction=c._onAction,d},b}(h),b.HyperLink=M;function P(a){return["_blank","_self","_parent","_top"][a]}function Q(a,b,c,d,e,f){var g=0,h=0,i=a.width,j=a.height;return g=f=f||0,1===d?g=(i-b)/2:2===d&&(g=i-b-f),1===e?h=(j-c)/2:2===e&&(h=j-c),{x:g,y:h}}function R(a,b,c,d){var e=T(a,c),f=e.width;return f+=(1!==b&&!j(d))==!0?d:0,e.width=f,e}function S(a,b,c,d,e,f){var g=T(a,d),h=Q(e,g.width,g.height,b,c,f);return g.x=h.x,g.y=h.y,g}function T(a,b){var c=l(b),d=Math.max(0,e.Vn.Xn(a,b,!0)),f=a.split(/\r\n|\r|\n/).length*c;return{x:0,y:0,width:d,height:f}}function U(a,b,c,d,f,g){var h,i,k,l,m,n,o,p,q,r,t,u=f.sheet,v=u.yl;if(j(c))return!1;if(g||(h=u.getValue(f.row,f.col,f.sheetArea),j(h)||(g=h+"")),!g)return!1;for(d=c.cellType.f5(d,c,u.zoom()),g=g.replace(/\s+/g," "),i=c&&c.font?c.font:v.Bl(),i=v.Cl(i),k=[g],l=V(c),c.wordWrap&&(k=e.Vn.Wn(g,d.width-3-l,i),g=k.join("\r\n")),m=S(g,c.hAlign,c.vAlign,i,d,l),n=d.y+m.y,o=0;o<k.length;o++)if(p=S(k[o],c.hAlign,c.vAlign,i,d,l),q=d.x+p.x,r=s(q+p.width,d.x+d.width),t=n,n=s(t+p.height,d.y+d.height),q<=a&&a<r&&t<=b&&b<n)return!0;return!1}function V(a){return 8*(a.textIndent||0)}function W(a,b,c,d,f){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=d&&d.sheet;if(w){if(j=w.yl,k=b.font||j.Bl(),c>1&&(k=j.Cl(k)),l=V(b),b.wordWrap||f){if(b.wordWrap){if(m=d.row,n=d.col,o=d.sheetArea,p=0,q=w.ITa.findSpan(m,n,o)){if(q.row>=m&&q.rowCount<=1&&q.col>=n&&n===q.col&&(p=w.Tl(n,o),q.colCount>1))for(r=n+1;r<n+q.colCount;r++)p+=w.Tl(r,o)}else p=w.Tl(n,o);if(h=g(b,1),i=g(b,3),i>0&&(p-=i),h>0&&(p-=h),s=e.Vn.Wn(a,p-3-l,k),f&&a.split(/\r\n|\r|\n/).length>1){for(t=0,u=0;u<s.length;u++)t=Math.max(t,R(s[u],b.hAlign,k,V(b)).width);return t}f||(a=s.join("\r\n"))}}else a=a.replace(/\s+/g," ");return v=R(a,b.hAlign,k,V(b)),f?v.width:v.height}return 0}p(L,function(a){M.prototype[a]=function(b){return 0===arguments.length?this["_"+a]:(this["_"+a]=b,this)}}),e.CellTypes._o[8]=M},"./dist/plugins/celltype/radiochecklistcelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=e.Common.j.C4,g=e.Common.l.Ra,h=Math.floor,i=Math.max,j=Math.ceil,k="left",l="alphabetic",m=null,n=void 0,o=e.Common.j.Fa,p=d.Ul.lZa,q=d.CellTypes.Base,r=d.GC$,s=r.each,t=d.Ul.fp,u="text",v="value",w="string",x="number",y=12;function J(a,b){return a.hasOwnProperty(b)}function K(a,b){return a instanceof Date&&b instanceof Date?g(a)===g(b):!o(a)&&!o(b)&&a.toString&&b.toString?""+a==""+b:a===b}function L(a){var b,c,d,e,f=["0","0","0","0"];return typeof a===w&&(b=a.split(" ",4),c=b.length,d=void 0,e=void 0,1===c?(d=b[0],f=[d,d,d,d]):2===c?(d=b[0],e=b[1],f=[d,e,d,e]):3===c?(e=b[1],f=[b[0],e,b[2],e]):4===c&&(f=[b[0],b[1],b[2],b[3]])),f}!function(a){a[a.horizontal=0]="horizontal",a[a.vertical=1]="vertical"}(z=b.Direction||(b.Direction={})),function(a){a[a.left=2]="left",a[a.right=3]="right"}(A=b.TextAlign||(b.TextAlign={})),B={items:m,direction:z.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:A.right,boxSize:y},C=function(a){I(b,a);function b(){var b,c=a.call(this)||this;return c.typeName="11",c.defaultPadding=5,b=c,s(B,function(a,c){"items"===a&&(c=[]),b["_"+a]=c}),c}return b.prototype.paintValue=function(a,b,c,e,f,g,j,l){var m,n,o,q,r,s,v,w,x,B,C,D,E,F,G,H,I,K,L,M,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha=this;if(a){for(a.save(),a.rect(c+1,e+1,f-2,g-2),a.clip(),a.beginPath(),m=0,n=0,o=l.sheet,q=o.zoom(),r=j.font,s=l.isPrinting,v=l.printZoomFactor,s&&"number"==typeof v&&1!==v&&(q=v),w=Q(ha._boxSize,r,q),x=ha.defaultPadding*q,B=w/2,C=new d.Rect(c+1,e+1,f-2,g-2),D=U(ha,o,j,f-2,g-2),E=D[0],F=D[1],G=O(ha,o,j,E,F),H=N(ha,o,j,E,F),I=P(ha,o,j,E,F),K=R(ha,j),L=c+S(j,C,q,G),M=e+T(j,C,q,H),V=j.font,V&&a.font!==V&&p(a,l.fontInfo.font),j.foreColor&&(a.fillStyle=j.foreColor),W=j.textDecoration,X=l.fontInfo.fontSize,Y=X>8?h((X-8)/5+2):1,Z=0,n=t(j.font),Z=n/2-X/2+Y-1,$=L,_=M,aa=0,ba=0,X>w&&(aa=ha.iJc(w),ba=(K-Z-y)/2+1),ca=0;ca<ha._items.length;ca++)L>c+f||M>e+g||(da=J(ha._items[ca],u)?ha._items[ca].text:ha._items[ca],m=o.dp(da,j.font),a.textAlign=k,ea=ha._direction===z.vertical?I[h(ca/E)]:I[ca%F],fa=0,ha._textAlign===A.left?(ha.zGb(a,ha._items[ca],b,m,L,M+aa,ea,K,Z),L=L+ea+x,a.save(),ha.AGb(a,b,ha._items[ca],L,M+ba,B),a.restore(),fa=w):(a.save(),ha.AGb(a,b,ha._items[ca],L,M+ba,B),L=L+w+x,a.restore(),ha.zGb(a,ha._items[ca],b,m,L,M+aa,ea,K,Z),fa=ea),W&&(ga=this.dHb(),ha.ip(a,W,L-(ha._textAlign===A.right?0:ea+x)+ga.paddingLeft,M+K-Z-ga.paddingBottom,m,X,Y)),ha._direction===z.vertical?(M+=i(K,w)+ha._itemSpacing.vertical*q,(ca+1)%E===0&&($=$+ea+w+x+ha._itemSpacing.horizontal*q,M=e+T(j,C,q,H)),L=$):(L=L+fa+ha._itemSpacing.horizontal*q,(ca+1)%F===0&&(L=c+S(j,C,q,G),_=_+i(K,w)+ha._itemSpacing.vertical*q),M=_));a.restore()}},b.prototype.iJc=function(a){return(a-y)/2},b.prototype.getText=function(a,b){return a},b.prototype.zGb=function(a,b,c,d,e,f,g,h,i){var j=J(b,u)?b.text:b;a.textBaseline!==l&&(a.textBaseline=l),a.fillText(j,e,f+h-i)},b.prototype.getItemsBound=function(a,b,c,e){var f,g,j,k,l,m,n,o,p,q,r,s,t,v,w,x,y,B,C,D=this,E=a.zoom(),F=a.getActualStyle(b,c,e),G=d.To.No("11pt "+a.currentTheme().bodyFont(),E),H=G;for(F.font&&(H=d.To.No(F.font,E)),F.font=H.font,f=1===e?-1:void 0,g=2===e?-1:void 0,j=a.getCellRect(b,c,f,g),k=j.width,l=j.height,m=U(D,a,F,k-1,l),n=m[0],o=m[1],p=P(D,a,F,n,o),q=Q(D._boxSize,H.font,E),r=D.defaultPadding*E,s=i(R(D,F),q),t=O(D,a,F,n,o),v=N(D,a,F,n,o),w=S(F,j,E,t),x=T(F,j,E,v),y=[],B=function(b){var c,e,f,g,i=J(D._items[b],u)?D._items[b].text:D._items[b],k=a.dp(i,F.font),l=h(b/o),m=b%o;D._direction===z.vertical&&(l=b%n,m=h(b/n)),c=new d.Rect,e=0,f=p.filter(function(a,b){return b<m}),f.forEach(function(a){e+=a}),c.x=w+e+m*(q+r+D._itemSpacing.horizontal*E)+j.x,c.y=x+l*s+D._itemSpacing.vertical*E*l+j.y,g=D.dHb(),c.width=(D._textAlign!==A.right||g.hasMargin?p[m]:k)+q+r,c.height=s,c.x>j.x+j.width||c.y>j.y+j.height?y[b]=null:y[b]=c},C=0;C<D._items.length;C++)B(C);return y},b.prototype.AGb=function(a,b,c,d,e,f){},b.prototype.dHb=function(){return{hasMargin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},b.prototype.getAutoFitWidth=function(a,b,c,d,e){var f=e&&e.sheet,g=V(c),h=U(this,f,c),i=h[0],j=h[1];return(O(this,f,c,i,j)+g)/f.zoom()},b.prototype.getAutoFitHeight=function(a,b,c,d,e){var f=e&&e.sheet,g=U(this,f,c),h=g[0],i=g[1];return N(this,f,c,h,i)/f.zoom()},b.prototype.getHitInfo=function(a,b,c,e,f){var g,h,i,j,k,l,n,p,q,r,s,t,u=this;return f?(g=f.sheetArea,h=f.sheet,e=c.cellType.f5(e,c,h.zoom()),(o(g)||3===g)&&e?(i={x:a,y:b,row:f.row,col:f.col,cellStyle:c,cellRect:e,sheetArea:g,sheet:h},j=h.zoom(),c.font&&(c.font=d.To.No(c.font,j).font),k=U(u,h,c,e.width-1,e.height-2),l=k[0],n=k[1],p=O(u,h,c,l,n),q=N(u,h,c,l,n),r=e.x+S(c,e,j,p),s=e.y+T(c,e,j,q),t=new d.Rect(r,s,p,q),t.contains(i.x,i.y)&&(i.isReservedLocation=!0),i):m):m},b.prototype.processMouseDown=function(a){return!!a&&void(a.isReservedLocation&&(this.uK=!0))},b.prototype.processMouseLeave=function(b){return a.prototype.processMouseLeave.call(this,b),!!b&&void(this.uK=!1)},b.prototype.processMouseUp=function(a){var b,c,d,e,f,g;return!!a&&(b=this,c=a.sheet,!!(b.uK&&c&&a.isReservedLocation&&(b.uK=!1,d=a.row,e=a.col,f=a.sheetArea,g=W(b,a)))&&(M(b,c,d,e,g.value,f),!0))},b.prototype.rK=function(a,b){return Y(a,b,this._items,!0)},b.prototype.triggerButtonClicked=function(a,b,c,d){var e=a.parent;e&&e.tw(a,b,c,d)},b.prototype.qHJ=function(a){var b={items:a.items,direction:a.direction&&z[a.direction],maxColumnCount:a.maxColumnCount,maxRowCount:a.maxRowCount,isFlowLayout:a.isFlowLayout,itemSpacing:a.itemSpacing,textAlign:a.textAlign&&A[a.textAlign],boxSize:a.boxSize};this.fromJSON(b)},b.prototype.toJSON=function(){var a,b=this,c={typeName:b.typeName};return s(B,function(d,e){a=b["_"+d];var g="items"===d?a&&a.length>0:a!==e;g&&("object"==typeof a?c[d]=f(a):c[d]=a)}),c},b.prototype.fromJSON=function(a){var b=this;s(B,function(c){var d=a[c];o(d)||(b["_"+c]=d)})},b}(q),D=function(a){I(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.AGb=function(a,b,c,d,e,f){var g=J(c,v)?c.value:c;a.beginPath(),a.fillStyle="white",a.arc(d+f,e+f,f,0,2*Math.PI),a.fill(),a.beginPath(),a.strokeStyle="black",a.arc(d+f,e+f,f,0,2*Math.PI),a.stroke(),b!==m&&K(b,g)&&(a.beginPath(),a.strokeStyle="black",a.arc(d+f,e+f,.5*f,0,2*Math.PI),a.fillStyle="black",a.fill(),a.stroke())},b}(C),b.RadioButtonList=D,E=function(a){I(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.typeName="12",b}return b.prototype.AGb=function(a,b,c,d,e,f){a.strokeStyle="black",a.strokeRect(d+.5,e+.5,2*f+.05,2*f+.05),a.fillStyle="white",a.fillRect(d+1,e+1,2*f-1,2*f-1);var g=X(c,b);b!==m&&g&&(a.beginPath(),a.lineWidth=2.5,a.moveTo(d+3,e+f),a.lineTo(d+f,e+2*f-3.5),a.lineTo(d+2*f-1.5,e+3),a.stroke())},b.prototype.rK=function(a,b){return Y(a,b,this._items,!1)},b}(C),b.CheckBoxList=E,function(a){a[a.single=0]="single",a[a.multiple=1]="multiple"}(F=b.SelectionMode||(b.SelectionMode={})),G={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:m,itemSpacing:{horizontal:5,vertical:5},selectionMode:F.multiple},H=function(a){I(b,a);function b(){var b,c=a.call(this)||this;return c.typeName="13",c.defaultPadding=0,b=c,s(G,function(a,c){"items"===a&&(c=[]),b["_"+a]=c}),b._boxSize=0,delete b.boxSize,c}return b.prototype.zGb=function(a,b,c,d,e,f,g,h,i){var j,k,m,n,o;a.save(),a.beginPath(),j=X(b,c),k=J(b,u)?b.text:b,m=this._selectedBackColor,n=this._selectedForeColor,j&&(a.fillStyle=m,a.fillRect(e+1,f+1,g-1,h-1),a.fillStyle=n),a.textAlign="center",a.textBaseline!==l&&(a.textBaseline=l),o=this.dHb(),a.fillText(k,e+o.paddingLeft+(g-o.paddingLeft-o.paddingRight)/2,f+o.paddingTop+h-o.paddingTop-o.paddingBottom-i),
a.restore()},b.prototype.rK=function(a,b){return Y(a,b,this._items,this._selectionMode===F.single)},b.prototype.dHb=function(){var a,b=0,c=0,d=0,e=0;return this._padding&&(a=L(this._padding),b=parseInt(a[0],10),b=typeof b===x&&b>0?b:0,e=parseInt(a[1],10),e=typeof e===x&&e>0?e:0,c=parseInt(a[2],10),c=typeof c===x&&c>0?c:0,d=parseInt(a[3],10),d=typeof d===x&&d>0?d:0),{hasMargin:!0,paddingTop:b,paddingBottom:c,paddingLeft:d,paddingRight:e}},b.prototype.iJc=function(a){return 0},b.prototype.toJSON=function(){var b,c=this,d=a.prototype.toJSON.call(this);return s(G,function(a,e){b=c["_"+a];var g="items"===a?b&&b.length>0:b!==e;g&&("object"==typeof b?d[a]=f(b):d[a]=b)}),d},b.prototype.fromJSON=function(b){a.prototype.fromJSON.call(this,b);var c=this;s(G,function(a){var d=b[a];o(d)||(c["_"+a]=d)})},b}(C),b.ButtonList=H;function M(a,b,c,d,e,f){var g=b.getValue(c,d,f),h=a.rK(g,e),i={cmd:"editCell",sheetName:b.name(),row:c,col:d,newValue:h,autoFormat:!0};b.wu().execute(i),a.triggerButtonClicked(b,c,d,f)}function N(a,b,c,d,e){var f=b.zoom(),g=Q(a._boxSize,c.font,f),h=R(a,c),j=i(h,g),k=d;return a._items.length<d&&(k=a._items.length),j*k+a._itemSpacing.vertical*f*(k-1)}function O(a,b,c,d,e){var f=b.zoom(),g=Q(a._boxSize,c.font,f),h=a.defaultPadding*f,i=P(a,b,c,d,e),j=0;return i.forEach(function(a){j+=a}),j+=e*(g+h)+(e-1)*a._itemSpacing.horizontal*f}function P(a,b,c,d,e){var f,g,i,j,k,l=[];for(f=0;f<a._items.length;f++)g=J(a._items[f],u)?a._items[f].text:a._items[f],i=b.dp(g,c.font),j=a.dHb(),j.hasMargin&&(i=i+j.paddingLeft+j.paddingRight),k=h(f%e),a._direction===z.vertical&&(k=h(f/d)),l[k]===n?l[k]=i:l[k]=Math.max(l[k],i);return l}function Q(a,b,c){var d=y*c;return"number"==typeof a&&a>=0?d=a*c:"auto"===a&&(d=t(b)/2),d}function R(a,b){var c=t(b.font),d=a.dHb();return d.hasMargin&&(c=c+d.paddingTop+d.paddingBottom),c}function S(a,b,c,d){var e=V(a)*c,f=e;return 1===a.hAlign?f=(b.width-d)/2:2===a.hAlign&&(f=b.width-e-d),f}function T(a,b,c,d){var e=2*c,f=e;return 1===a.vAlign?b.height-e>d&&(f=(b.height-d-e)/2+e):2===a.vAlign&&(f=b.height-d-e),f}function U(a,b,c,d,e){var f,g,h,k;if(a._direction===z.vertical){if(a._isFlowLayout){if(e!==n)for(f=a._items.length;f>0;){if(g=N(a,b,c,f,j(a._items.length/f)),!(g>e))return f=i(f,1),[f,j(a._items.length/f)];f-=1}return[a._items.length,1]}return f=i(1,a._maxRowCount),[f,j(a._items.length/f)]}if(a._isFlowLayout){if(d!==n)for(h=a._items.length;h>0;){if(k=O(a,b,c,j(a._items.length/h),h),!(k>d))return h=i(h,1),[j(a._items.length/h),h];h-=1}return[1,a._items.length]}return h=i(1,a._maxColumnCount),[j(a._items.length/h),h]}function V(a){var b=a.textIndent;return 1===a.hAlign||0===b||b===m||b===n?2:8*b}function W(a,b){var c,e,f=b.cellRect.width,g=b.cellRect.height,j=b.sheet,k=j.zoom(),l=j.getStyle(b.row,b.col),m=l&&l.font,n=U(a,j,b.cellStyle,f-1,g),o=n[0],p=n[1],q=P(a,j,b.cellStyle,o,p),r=Q(a._boxSize,m,k),s=a.defaultPadding*k,t=i(R(a,b.cellStyle),r),w=O(a,j,b.cellStyle,o,p),x=N(a,j,b.cellStyle,o,p),y=S(b.cellStyle,b.cellRect,k,w),B=T(b.cellStyle,b.cellRect,k,x),C=function(c){var e,f,g,i,l,m,n=J(a._items[c],u)?a._items[c].text:a._items[c],w=j.dp(n,b.cellStyle.font),x=h(c/p),C=c%p;if(a._direction===z.vertical&&(x=c%o,C=h(c/o)),e=new d.Rect,f=0,g=q.filter(function(a,b){return b<C}),g.forEach(function(a){f+=a}),e.x=y+f+C*(r+s+a._itemSpacing.horizontal*k),e.y=B+x*t+a._itemSpacing.vertical*k*x,i=a.dHb(),e.width=(a._textAlign!==A.right||i.hasMargin?q[C]:w)+r+s,e.height=t,l=b.x-b.cellRect.x,m=b.y-b.cellRect.y,e&&e.contains(l,m))return{value:{value:J(a._items[c],v)?a._items[c].value:a._items[c]}}};for(c=0;c<a._items.length;c++)if(e=C(c),"object"==typeof e)return e.value}function X(a,b){var c,d=!1,e=J(a,v)?a.value:a;if(b!==m)if(Array.isArray(b)){for(c=0;c<b.length;c++)if(K(b[c],e)){d=!0;break}}else d=K(b,e);return d}function Y(a,b,c,d){var e,f,g,h,i;if(d)return b;for(a===m&&(a=[]),Array.isArray(a)||(a=[a]),e={},c.forEach(function(a){e[J(a,v)?a.value:a]=!0}),f=a.length-1;f>=0;f--)e[a[f]]||a.splice(f,1);if(g=a.slice(),h=g.indexOf(b),h===-1)g.push(b);else for(f=g.length-1;f>=0;f--)K(g[f],b)&&g.splice(f,1);return i=[],c.forEach(function(a){g.indexOf(a.value)!==-1&&i.push(a.value)}),i}s(B,function(a){C.prototype[a]=function(b){var c,d,e,f,g,h,i="_"+a,j=this;if(0===arguments.length)return j[i];if("items"===a){for(c=[],d=0;d<b.length;d++)e=b[d],o(e.text)||o(e.value)?o(e.text)?o(e.value)?o(e)||"object"==typeof e||c.push({text:e,value:e}):(e.text=e.value,c.push(e)):(e.value=e.text,c.push(e)):c.push(e);b=c}if("itemSpacing"===a)f=j[i],j[i]={horizontal:f.horizontal,vertical:f.vertical},o(b.horizontal)||(g=parseInt(b.horizontal,10),isNaN(g)||(j[i].horizontal=g)),o(b.vertical)||(h=parseInt(b.vertical,10),isNaN(h)||(j[i].vertical=h));else if("boxSize"===a){if(o(b))return j[i];"number"==typeof b&&b>=0&&(j[i]=b),"auto"===b&&(j[i]=b)}else j[i]=b;return j}}),d.CellTypes._o[11]=D,d.CellTypes._o[12]=E,s(G,function(a){H.prototype[a]=function(b){var c,d,e,f,g,h,i="_"+a,j=this;if(0===arguments.length)return j[i];if("items"===a){for(c=[],d=0;d<b.length;d++)e=b[d],o(e.text)||o(e.value)?o(e.text)?o(e.value)?o(e)||"object"==typeof e||c.push({text:e,value:e}):(e.text=e.value,c.push(e)):(e.value=e.text,c.push(e)):c.push(e);b=c}return"itemSpacing"===a?(f=j[i],j[i]={horizontal:f.horizontal,vertical:f.vertical},o(b.horizontal)||(g=parseInt(b.horizontal,10),isNaN(g)||(j[i].horizontal=g)),o(b.vertical)||(h=parseInt(b.vertical,10),isNaN(h)||(j[i].vertical=h))):j[i]=b,j}}),d.CellTypes._o[13]=H},"./dist/plugins/celltype/rangecelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Bindings"),f=c("Sparkline"),g=c("@grapecity/js-calc"),h=c("SheetsCalc"),i=d.CellTypes.Base,j=d.CellTypes.Context,k=null,l=Math.floor;function q(a){return a.map(function(a){return{start:a.start,size:a.size}})}m=function(){function a(){this.Uu=0,this.SV=0,this.Xj=0,this.OZ=0}return a.prototype.YE=function(a,b){var c=this,d=b.row,e=b.col,f=b.rowCount,g=b.colCount;return c.Uu=d,c.SV=e,c.Xj=f,c.OZ=g,c.Ny=c.yJb(a,b),c.XJb=c.YJb(a,b),c},a.prototype.ZJb=function(){return this.XJb},a.prototype.YJb=function(a,b){var c,d,e,f,g,h,i,j=this,k=b.row,l=b.col,m=b.rowCount,n=b.colCount,o=0,p=[],q=0,r=[],s=0,t=k+m,u=l+n;for(c=k;c<t;c++)s=a.getRowHeight(c),q+=s,r.push(s);for(d=l;d<u;d++)s=a.getColumnWidth(d),o+=s,p.push(s);return s=0,e=r.map(function(a){var b=s/q,c=a/q;return s+=a,{start:b,size:c}}),s=0,f=p.map(function(a){var b=s/o,c=a/o;return s+=a,{start:b,size:c}}),g=j.yJb(a,b),h=j.$Jb(a,b,g,e,f),i=j._Jb(a,b),{rowCount:m,colCount:n,rowSize:e,colSize:f,cellStyleList:h,sparklines:i,totalHeight:q,totalWidth:o}},a.prototype.aKb=function(a,b,c,e,f){var g,h,i,j,k,l,m,n,o=null;for(g=0,h=f;g<h.length;g++)if(i=h[g],j=i.rowOffset,k=i.colOffset,l=i.rowCount,m=i.colCount,n=new d.Range(j+c,k+e,l,m),n.contains(a,b)){o=i;break}return o},a.prototype.bKb=function(a,b,c){var d,e=[0,0],f=e[0],g=e[1],h=a.rowOffset,i=a.colOffset,j=a.rowCount,k=a.colCount,l=h+j,m=i+k;for(d=h;d<l;d++)g+=b[d]?b[d].size:0;for(d=i;d<m;d++)f+=c[d]?c[d].size:0;return{width:f,height:g}},a.prototype.$Jb=function(a,b,c,d,e){var f,g,h,i,j,k=b.row,l=b.col,m=b.rowCount,n=b.colCount,o=[];for(f=k;f<k+m;f++){for(g=[],h=l;h<l+n;h++)i=this.aKb(f,h,k,l,c),i&&i.rowOffset+k===f&&i.colOffset+l===h?(j=this.bKb(i,d,e),g.push({style:a.getActualStyle(f,h,3,!0),spanWidth:j.width,spanHeight:j.height,isSpan:!0,span:i})):i?g.push({style:a.getActualStyle(f,h,3,!0),isSpan:!0}):g.push({style:a.getActualStyle(f,h,3,!0)});o.push(g)}return o},a.prototype.yJb=function(a,b){var c,d,e,f=a.ITa.getSpans(),g=[],h=b.row,i=b.col,j=b.rowCount,k=b.colCount;for(c=0,d=f;c<d.length;c++)e=d[c],e.intersect(h,i,j,k)&&g.push({rowOffset:e.row-h,colOffset:e.col-i,rowCount:e.rowCount,colCount:e.colCount});return g},a.prototype._Jb=function(a,b){var c,d,e,f,g=b.row,h=b.col,i=b.colCount,j=b.rowCount,k=[];for(c=g;c<g+j;c++){for(d=[],e=h;e<h+i;e++)f=a.getSparkline(c,e),f?d.push(f.clone()):d.push(null);k.push(d)}return k},a.prototype.toJSON=function(){var a=this.ZJb(),b=a.rowCount,c=a.colCount,d=a.rowSize,e=a.colSize,f=a.cellStyleList,g=a.sparklines,h=a.totalWidth,i=a.totalHeight,j=q(d),k=q(e),l=f.map(function(a){return a.map(function(a){if(a){var b=a.style,c=a.spanWidth,d=a.spanHeight,e=a.isSpan,f=a.span;return{style:b.toJSON(),spanWidth:c,spanHeight:d,isSpan:e,span:f}}return null})}),m=g.map(function(a){return a.map(function(a){if(a)return{sparklineType:a.sparklineType(),sp:a.toJSON(),setting:a.setting().toJSON()}})});return{rowCount:b,colCount:c,rowSize:j,colSize:k,cellStyleList:l,sparklines:m,totalWidth:h,totalHeight:i}},a.prototype.fromJSON=function(a){var b,c,e,g,h,i,j,k,l,m,n,o;a&&(b=a.rowCount,c=a.colCount,e=a.rowSize,g=a.colSize,h=a.cellStyleList,i=a.sparklines,j=a.totalWidth,k=a.totalHeight,l=q(e),m=q(g),n=h.map(function(a){return a.map(function(a){var b,c,e,f,g,h;return a?(b=a.style,c=a.spanWidth,e=a.spanHeight,f=a.isSpan,g=a.span,h=null,b&&(h=new d.Style,h.fromJSON(b)),{style:h,spanWidth:c,spanHeight:e,span:g,isSpan:f}):null})}),o=i.map(function(a){return a.map(function(a){if(a){var b=new f.Sparkline,c=new f.SparklineSetting(a.setting);return b.fromJSON(a.sp),b.setting(c),b.sparklineType(a.sparklineType),b}})}),this.XJb={rowCount:b,colCount:c,rowSize:l,colSize:m,cellStyleList:n,sparklines:o,totalWidth:j,totalHeight:k})},a.prototype.no=function(){this.XJb=null},a}(),b.QCc=m,n=function(){function a(){}return a.prototype.YE=function(a,b,c){var e=this;return e.my=b,e._OJ=new d.Worksheet,e.dKb=a.parent&&a.parent.options.allowDynamicArray,e._OJ.getCalcService&&(e._OJ.getCalcService().allowDynamicArray=e.dKb,e.E8J=e.F8J(a)),e.UHJ(a,c),e},a.prototype.F8J=function(a){var b,c,d,e,f,g,h,i,j=this.my,k=j.row,l=j.col,m=j.colCount,n=j.rowCount,o=[],p=a.Bj&&a.Bj();for(b=k;b<k+n;b++)for(c=l;c<l+m;c++)d=a.getFormula(b,c),d&&(e=p&&p.Qf(b,c),e&&e.isDynamicArray&&(f=e.row,g=e.col,h=e.rowCount,i=e.colCount,h>1&&o.push({row:f+1,col:g,rowCount:h-1,colCount:i}),i>1&&o.push({row:f,col:g+1,rowCount:1,colCount:i-1})));return o},a.prototype.hKb=function(){var a,b,c,d,e,f,g,h=this,i=h.E8J,j=this._OJ;for(a=0,b=i;a<b.length;a++)c=b[a],d=c.row,e=c.col,f=c.rowCount,g=c.colCount,j.clear(d,e,f,g,3,1)},a.prototype.iKb=function(a){var b,c=this._OJ;c.suspendEvent(),b=new e.CellBindingSource(a),this.hKb(),c.setDataSource(b),c.resumeEvent()},a.prototype.UHJ=function(a,b){var c=this,d=c._OJ,e=a.toJSON({includeBindingSource:!0,ignoreFormula:!!b});delete e.charts,delete e.shapes,d.suspendCalcService(),d.fromJSON(JSON.parse(JSON.stringify(e))),d.resumeCalcService(),this.jKb()},a.prototype.jKb=function(){var a,b,c=this,d=c.my,e=d.row,f=d.col,g=d.colCount,h=d.rowCount,i=[],j=[],k=[];for(a=e;a<e+h;a++){for(k=[],b=f;b<f+g;b++)k.push(c.kKb(a,b,3));j.push(k)}this.lKb=j},a.prototype.mKb=function(){var a=this.my,b=a.row,c=a.col;return{baseRow:b,baseCol:c}},a.prototype.nKb=function(a){var b,c,d,e,f,g,h,i,j=this._OJ,k=this.my,l=k.row,m=k.col,n=k.colCount,o=k.rowCount,p=[];for(b=l;b<l+o;b++){for(c=[],d=void 0,e=void 0,f=m;f<m+n;f++)g=j.getText(b,f),h=j.getValue(b,f,3,1),i=j.getBindingPath(b,f),d=this.oKb(b,f,3),e=this.pKb(j,b,f,h,a),c.push({value:h,formatStyle:d,text:g,validStyle:e,bindingPath:i});p.push(c)}return p},a.prototype.kKb=function(a,b,c){var d,e=this._OJ.uja;return e&&(d=this._OJ.getDataValidator(a,b,c))?d.highlightStyle():null},a.prototype.pKb=function(a,b,c,d,e){if(e&&a.isValid&&!a.isValid(b,c,d)){var f=this.my,g=f.row,h=f.col;return this.lKb[b-g][c-h]}return null},a.prototype.oKb=function(a,b,c){var e=this._OJ.conditionalFormats;return e?e.Eq(new d.Style,a,b,c):null},a.prototype.getCellValueInfo=function(a){var b,c,d,e=this.my,f=e.row,g=e.col,h=e.colCount,i=e.rowCount,j=[],l=a.ITa;for(b=f;b<f+i;b++){for(c=[],d=g;d<g+h;d++)c.push({bindPath:a.getBindingPath(b,d),formula:a.getFormula(b,d),value:l.getValue(b,d,3,k,1)});j.push(c)}return j},a.prototype.setValueToDataStruct=function(a,b,c,d){d[a]||(d[a]={}),d[a][b]=c},a.prototype.toJSON=function(){var a=this._OJ,b=this.dKb,c=this.E8J.map(function(a){var b=a.row,c=a.col,d=a.rowCount,e=a.colCount;return{row:b,col:c,rowCount:d,colCount:e}}),d=this.my,e=d.row,f=d.col,g=d.rowCount,h=d.colCount;return{spillRanges:c,allowDynamicArray:b,range:{row:e,col:f,rowCount:g,colCount:h},templatejson:JSON.stringify(a.toJSON({includeBindingSource:!0}))}},a.prototype.fromJSON=function(a){var b,c,e,f,g,h,i;a&&(b=this,c=b._OJ=new d.Worksheet,c.suspendCalcService&&c.suspendCalcService(),b.E8J=a.spillRanges,b.dKb=a.allowDynamicArray,c.getCalcService&&(c.getCalcService().allowDynamicArray=b.dKb),c.fromJSON(JSON.parse(a.templatejson)),b.hKb(),e=a.range,f=e.row,g=e.col,h=e.rowCount,i=e.colCount,b.my=new d.Range(f,g,h,i),this.jKb(),c.resumeCalcService&&c.resumeCalcService())},a.prototype.no=function(){this._OJ.no(),this._OJ=null,this.my=null},a}(),b.RCc=n,o=function(a){p(b,a);function b(b,c,e,f,g){var h,i=a.call(this)||this;return i.allowOverflow=!1,i.typeName="16",h=1===arguments.length?new d.Range(0,0,b.getRowCount(),b.getColumnCount()):new d.Range(c,e,f,g),b&&h&&(i._R=(new m).YE(b,h),i.G8J=(new n).YE(b,h)),i}return b.prototype.getAutoFitWidth=function(){return this._R.XJb.totalWidth},b.prototype.getAutoFitHeight=function(){return this._R.XJb.totalHeight},b.prototype.updateTemplate=function(a,b){a&&b&&(this._R.YE(a,b),this.G8J.YE(a,b))},b.prototype.paintContent=function(a,b,c,d,e,f,g,h){var i,j=this.G8J,k=this._R;j&&k&&(i=this._R.ZJb(),g.cellPadding&&(h.needTopGridline=!0,h.needLeftGridline=!0),r(a,{x:c,y:d,width:e,height:f},b,h,j,i))},b.prototype.toJSON=function(){return{typeName:this.typeName,layout:this._R.toJSON(),resolver:this.G8J.toJSON()}},b.prototype.fromJSON=function(a){a.layout&&(this._R=new m,this._R.fromJSON(a.layout)),a.resolver&&(this.G8J=new n,this.G8J.fromJSON(a.resolver))},b}(i),b.RangeTemplate=o,d.CellTypes._o[16]=o;function r(a,b,c,e,f,i,m){var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da;for(void 0===m&&(m=1),n=b.x,o=b.y,p=b.width,q=b.height,r=e.sheet,s=e.sheetArea,t=e.isPrinting,u=e.needTopGridline,v=e.needLeftGridline,w=[],x=[],y=!0,z=[],A=r.vu(),B=i.rowCount,C=i.colCount,D=i.rowSize,E=i.colSize,F=i.cellStyleList,G=i.sparklines,f.iKb(c),H=f.mKb(),I=H.baseRow,J=H.baseCol,K=f._OJ,L=K.Pm,K.Us(new d.Rect(0,0,p,q)),M=new d.AF(K,K.Gr(1,3),K.Hr(1,3),3),N=f.nKb(y),o+=1,q-=1,n+=1,p-=1,O=0,P=0,D=D.map(function(a){var b=a.size*q,c=l(b);return P+=b-c,P>=1&&(c++,P--),{start:l(a.start*q),size:c}}),E=E.map(function(a){var b=a.size*p,c=l(b);return O+=b-c,O>=1&&(c++,O--),{start:l(a.start*p),size:c}}),Q=K.conditionalFormats,R=0;R<B;R++)for(S=0;S<C;S++)if(F[R][S]){if(T=F[R][S],U=T.style,V=T.isSpan,W=T.span,X=!1,Y=N[R][S],V&&!W)continue;if(U=U.clone(!0),Z=l(n+E[S].start),$=l(o+D[R].start),_=void 0,aa=void 0,ba=V?W.colCount:1,ca=V?W.rowCount:1,_=E[S+ba]?E[S+ba].start:p,da=l(_-E[S].start),aa=D[R+ca]?D[R+ca].start:q,ea=l(aa-D[R].start),Y.formatStyle&&(Y.formatStyle.Yo(U),U=Y.formatStyle),U.Zo(L),fa=k,V){for(fa={row:R,col:S,x:l(Z),y:l($),width:l(da),height:l(ea),rowCount:ca,colCount:ba},ga={},ha={},ia=[],ja=void 0,ka=void 0,la=0,ma=0,ja=0;ja<ba-1;ja++)na=E[S+ja],oa=na?na.size:0,ha[ja]=oa,la+=oa;for(ha[ja]=l(da)-la,ka=0;ka<ca-1;ka++)pa=D[R+ka],oa=pa?pa.size:0,ga[ka]=oa,ma+=oa;for(ga[ka]=l(ea)-ma,ka=0;ka<ca;ka++){for(qa=[],ra=0;ra<ba;ra++)F[ka+R]&&F[ka+R][S+ra]&&qa.push(F[ka+R][S+ra].style);ia.push(qa)}fa.spanSizeInfo={styleList:ia,rowSizes:ga,colSizes:ha}}M.jF(R,S,l(Z),l($),l(da),l(ea),U,fa,u&&0===R,v&&0===S),sa=U.formatter,sa&&d.util.lHb(sa)&&(ta=r.parent&&r.parent.dJb(sa),ta&&(ua=ta.getExpression(),ua&&(va=h.evaluateFormula(r,sa.replace("@",JSON.stringify(Y.value))),va instanceof g.CalcError||(Y.value=va)))),wa=null,G[R][S]&&(wa=G[R][S].clone(),wa&&(wa.oZa=K.name(),wa.rKb=wa.sKb(K),wa.tKb=wa.uKb(K),wa.vKb=K)),Y&&Y.value&&"SparklineExValue"===Y.value.typeName&&(z.push({value:Y.value,x:Z,y:$,width:da,height:ea,option:e}),X=!0),Y.validStyle&&x.push({style:Y.validStyle,x:Z,y:$,width:da,height:ea}),w.push({data:X?null:Y.value,row:R,col:S,x:Z,y:$,width:da,height:ea,style:U,sparkline:wa,baseRow:R+I,baseCol:S+J,conditionalFormats:Q,imageLoader:A,cellLayout:{row:R,col:S,x:Z,y:$,width:da,height:ea}})}for(a.save(),u&&(o-=2,q+=4),v&&(n-=2,p+=4),a.rect(n,o,p,q),a.clip(),w.length>0&&K.yl.SI(a,w,s,t,1,r,I,J,m),M.paint(a),x.length>0&&K.yl.jJ(a,x),a.restore(),R=0;R<z.length;R++)xa=z[R],ya=xa.value,za=xa.x,Aa=xa.y,Ba=xa.width,Ca=xa.height,Da=xa.option,j.oDc(a,ya,za,Aa,Ba,Ca,Da)}b.paintRangeTemplate=r},"./dist/plugins/comment/comment-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("Core"),g=e.GC$,h=e.Events,i=d.Common.j.Fa,j=f.Commands.ActionBase,k="deleteComment",l="deleteCommentByKey",m="deactivateComment",n="moveComment",o="moveCommentUp",p="moveCommentDown",q="moveCommentLeft",r="moveCommentRight",s="changeComment",t="changeCommentTransaction",u=null,v=f.Commands.h4;function B(a,b,c){var d,f=!1,g=a.ITa.Ky.JU();return g?(d=g.location(),a.wu().execute({cmd:n,sheetName:a.name(),row:g.nT,col:g.oT,oldValue:d.clone(),newValue:new e.Point(d.x+b,d.y+c),propertyName:"location"})):f}function C(a){var b=a.comment;b&&(i(a.row)||i(a.col))&&(a.row=b.nT,a.col=b.oT)}w=function(a){A(b,a);function b(b,c){var d=a.call(this)||this;return C(c),d.kj=b,d.VQ=c,d}return b.prototype.execute=function(){var a,b,c,d,e,g,i=this;return!!i.canExecute()&&(a=i.kj,i.Lz(a,!0),b=a.comments.get(i.VQ.row,i.VQ.col),c=a.ITa,d=c.Ky,e={sheet:a,sheetName:a.name(),comment:b,cancel:!1},a.Wq(h.CommentRemoving,e),e.cancel||(c.startTransaction(),d.remove(b.nT,b.oT),d.rV=u,a.GJ(),a.Wq(h.CommentRemoved,{sheet:a,sheetName:a.name(),comment:b}),g=f.Commands.bWa(a.name()),i.VQ[g]=c.endTransaction()),i.Mz(a,!0),!0)},b.prototype.undo=function(){var a,b=this,c=b.kj;return b.Lz(c,!0),a=f.Commands.bWa(c.name()),c.ITa.undo(b.VQ[a]),c.EJ(),b.Mz(c,!0),!0},b}(j),b.CommentDeleteUndoAction=w,x=function(a){A(b,a);function b(b,c){var d=a.call(this)||this;return C(c),d.kj=b,d.VQ=c,d}return b.prototype.execute=function(){var a,b=this,c=b.VQ,d=b.kj,e=d.comments.get(c.row,c.col);return!(!b.canExecute()||!e)&&(b.Lz(d,!0),a=c.propertyName,e[a](c.newValue),"location"===a&&(c.displayMode?e.displayMode(c.displayMode):c.displayMode=e.displayMode()),b.Mz(d,!0),!0)},b.prototype.undo=function(){var a,b=this,c=b.VQ,d=b.kj;return b.Lz(d,!0),a=d.comments.get(c.row,c.col),!!a&&(a[c.propertyName](c.oldValue),b.Mz(d,!0),!0)},b.prototype.toJSON=function(){return this.VQ},b}(j),b.CommentPropertyUndoAction=x,f.Commands.ChangeComment=x;function D(a,b){var c,d,e;if((b?a.canUndo():a.canExecute())&&(c=a.KV)){for(d=0;d<c.length;d++)e=c[d],e&&(b?e.undo():e.execute());return!0}return!1}y=function(a){A(b,a);function b(b,c){var d,e,f=a.call(this)||this,g=f;if(g.KV=[],g.kj=b,g.VQ=c,d=c.commands)for(e=0;e<d.length;e++)g.add(d[e]);return f}return b.prototype.execute=function(){return D(this,!1)},b.prototype.undo=function(){return D(this,!0)},b.prototype.add=function(a){this.KV.push(a)},b}(j),f.Commands[l]={canUndo:!1,execute:function(a,b){var c=f.Commands.bT(a,b),d=c.ITa.Ky.JU();return!!d&&c.wu().execute({cmd:k,sheetName:c.name(),row:d.nT,col:d.oT})}},f.Commands[m]={canUndo:!1,execute:function(a,b){var c=f.Commands.bT(a,b),d=c.ITa.Ky;return!!d.JU()&&(d.vQ(),c.GJ(),c.repaint(),!0)}},f.Commands[o]={canUndo:!1,execute:function(a,b){var c=f.Commands.bT(a,b);return B(c,0,-1)}},f.Commands[p]={canUndo:!1,execute:function(a,b){var c=f.Commands.bT(a,b);return B(c,0,1)}},f.Commands[q]={canUndo:!1,execute:function(a,b){var c=f.Commands.bT(a,b);return B(c,-1,0)}},f.Commands[r]={canUndo:!1,execute:function(a,b){var c=f.Commands.bT(a,b);return B(c,1,0)}},f.Commands[k]={canUndo:!0,execute:function(a,b,c){return v(a,w,b,c)}},f.Commands[n]={canUndo:!0,execute:function(a,b,c){return v(a,x,b,c)}},f.Commands[s]={canUndo:!0,execute:function(a,b,c){return v(a,x,b,c)}},f.Commands[t]={canUndo:!0,execute:function(a,b,c){return v(a,y,b,c)}},z=function(a){var b=e.Ul.sl();a.register(l,f.Commands[l],b?8:46,!1,!1,!1,!1),a.register(m,f.Commands[m],27,!1,!1,!1,!1),a.register(o,f.Commands[o],38,!1,!1,!1,!1),a.register(p,f.Commands[p],40,!1,!1,!1,!1),a.register(q,f.Commands[q],37,!1,!1,!1,!1),a.register(r,f.Commands[r],39,!1,!1,!1,!1),a.register(k,f.Commands[k]),a.register(s,f.Commands[s]),a.register(t,f.Commands[t]),a.register(n,f.Commands[n])},f.Commands.uT=z},"./dist/plugins/comment/comment-touch.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/comment/comment.js"),f=c("Touch"),d.Rxb.touch&&(g=d.GC$,h=d.Ul.nl,i=function(){function a(a,b){var c=this;c.NS=a,c.LV=b,c.kT=b.kT,c.kj=c.kT.kj,c.hQ=new f.TP(c.kj)}return a.prototype.OS=function(a){var b,c=new f.oP(a.X,a.Y),d=g(this.NS).offset();return d&&(b=document.body,c.X+=d.left+b.clientLeft||0,c.Y+=d.top+b.clientTop||0),c},a.prototype.jQ=function(a){a.DO=35},a.prototype.lQ=function(a){var b=this,c=b.OS(a.rN);b.LV.iV({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}),b.hQ.OP()},a.prototype.pQ=function(a){var b,c,d=this,e=a.dP.rO,f=d.kj,h=f.parent;1!==e&&h&&h.options.allowUserZoom?(f.mm.lV=!1,b=d.LV,g(b.TU).remove(),d.hQ.PP(e)):(c=d.OS(a.rN),d.LV.BD({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}))},a.prototype.qQ=function(a){var b,c=this,d=a.dP.rO,e=c.kj,f=e.parent;1!==d&&f&&f.options.allowUserZoom?c.hQ.SP(d):(b=c.OS(a.rN),c.LV.CD({target:a.GP,isTouch:!0,button:0,pageX:b.X,pageY:b.Y,stopPropagation:function(){}}))},a.prototype.sQ=function(a){var b=this,c=b.kT,d=b.kj;try{d.suspendPaint(),3===c.commentState()?c.commentState(1):1===c.commentState()&&c.commentState(2)}finally{d.resumePaint()}},a}(),j=function(){function a(a,b,c,d){var e,g=this,h=g.kT=b.kT;g.yM=new f.jR(g),g.DQ=new f.kR(a,"Comment"+h.nT+h.oT,g.yM,2,200),g.BQ=c,g.CQ=d,e=g.DQ,e._M=function(){return 3!==h.commentState()},e.bN=function(){return!0},e.dN=function(a){return d.jQ(a)},e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)}}return a.prototype.EQ=function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},a.prototype.FQ=function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},a.prototype.GQ=function(a){return this.yM.GQ()},a.prototype.HQ=function(a){return this.yM.HQ()},a.prototype.IQ=function(a){return this.yM.IQ()},a}(),k=function(a){n(b,a);function b(b,c,d){return a.call(this,b,c,d,new i(b,c))||this}return b}(j),l=function(a){n(b,a);function b(b,c,d){return a.call(this,b,c,d,new m(b,c))||this}return b}(j),m=function(a){n(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.lQ=function(a){var b=this,c=b.OS(a.rN);b.LV.hV({target:a.GP,isTouch:!0,button:0,pageX:c.X,pageY:c.Y,stopPropagation:function(){}}),b.hQ.OP()},b}(i),e.GV.$n("touch",{init:function(a){var b=this,c=b.kT.kj,d=c.parent.BQ;b.wR=new k(a[0],b,d),b.wR.EQ(),b.MV=new l(a[1],b,d),b.MV.EQ()},detachEditor:function(a){var b=this,c=b.kT.kj;b.MV=new l(a,b,c.parent.BQ),b.MV.EQ()},preProcessMouseDownEdit:function(a){var b=a.e,c=this.MV;c&&!b.isTouch&&c.GQ(b)&&(h(b),a.r=!0)},preProcessMouseDownDragResize:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.GQ(b)&&(h(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=b.isTouch,d=this.wR,e=this.MV;d&&!c&&d.IQ(b)&&(h(b),a.r=!0),e&&!c&&e.IQ(b)&&(h(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=b.isTouch,d=this.wR,e=this.MV;d&&!c&&d.HQ(b)&&(h(b),a.r=!0),e&&!c&&e.HQ(b)&&(h(b),a.r=!0)},dispose:function(){var a=this;a.wR.FQ(),a.wR=null,a.MV.FQ(),a.MV=null}}))},"./dist/plugins/comment/comment.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/comment/comment.js")),d(c("./dist/plugins/comment/comment-actions.js")),c("./dist/plugins/comment/comment-touch.js")},"./dist/plugins/comment/comment.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("Core"),g=e.Commands,h=null,i=void 0,j=Math.max,k=Math.min,l=Math.floor,m=Math.atan2,n=Math.abs,o="default",p=e.GC$.extend,q=e.Ul.Nl,r=d.Common.k,s="comment",t=e.Vl,u=e.En,v=e.Ul,w=e.Events,x=v.nl,y=v.Rl,z=v.eBJ,A=v.Voa,B=parseFloat,C=d.Common.u,D=e.Bn,E=f.ExcelHelper.getActualColumnWidth,F=f.ExcelHelper.pointToPixel,G=f.ExcelHelper.pixelToPoint,H=f.ExcelHelper.getActualRowHeight,I=d.Common.j.Fa,J=f.Ul.JcK,K=f.Ul.McK,L=f.Ul.LcK,M=f.Ul.oaa,N=f.Ul.naa,O=f.Ul.QcK,P=f.Ul.PcK,Q=f.IndexHelper.R9,R=f.Util.XaK,S=f.Util.xiK,T=7,U=document,V=window,W=f.UsedRangeUtil.SZJ,X=f.XFileConstants.abK,Y=f.XFileConstants.dbK,Z=f.XFileConstants.P8,$={oGc:"mouse",pGc:"move",qGc:"DOMMouseScroll",rGc:"left",Lcc:"top",sGc:"right",tGc:"bottom",uGc:"width",vGc:"height",wGc:"position",xGc:"absolute",yGc:"overflow",zGc:"visible",AGc:"z-index",BGc:"hidden",CGc:"box-sizing",DGc:"content-box",EGc:"padding",FGc:"px",GGc:"div",HGc:".comment",IGc:".floatBlockCanvas",JGc:".hostContainer",KGc:".lineCanvasContainer",LGc:".host",MGc:".editor",NGc:"gc-spread-",OGc:"className",PGc:"cursor",QGc:"text",RGc:701,SGc:898,TGc:"gc-no-user-select",UGc:" ",VGc:"unselectable",WGc:"on",XGc:"comment_editor",YGc:"comment_indicator",ZGc:"font-family",$Gc:"font-style",_Gc:"font-size",aHc:"font-weight",bHc:"color",cHc:"textArea",dHc:".lineCanvas",eHc:".commentDocument",fHc:"-resize",gHc:"line-height",hHc:"background-color",iHc:"text-align",jHc:"mousedown",kHc:"mousemove",lHc:"mouseup",mHc:"mousewheel",nHc:"text-decoration",LkK:"black"},function(a){a[a.none=0]="none",a[a.single=1]="single",a[a.double=2]="double",a[a.singleaccounting=3]="singleaccounting",a[a.doubleaccounting=4]="doubleaccounting"}(_||(_={}));function ta(a,b){return new f.Point(a,b)}function ua(a,b,c,d){return new f.Rect(a,b,c,d)}function va(a){return a.height}function wa(a){return a.width}function xa(a,b){var c=a.options;return!c.isProtected||c.protectionOptions.allowEditObjects||b&&!b.locked()}function ya(a,b){var c=a.options;return!c.isProtected||c.protectionOptions.allowEditObjects||b&&!b.lockText()}function za(a){var b=96,c=72,d=37.7952755905512;try{return a.indexOf("pt")!==-1?parseFloat(a.replace("pt","")):a.indexOf("in")!==-1?parseFloat(a.replace("in",""))*c:a.indexOf("cm")!==-1?parseFloat(a.replace("cm",""))*d*c/b:parseFloat(a)}catch(a){return 0}}function Aa(a){var b,c,d,e,f,g,h,i=a.itemsData,j=a.collapseIndexMap={},k=i.length,l=!1;if(0===a.direction){for(b=k-1;b>=0;b--)if(c=i[b],c&&1===c.count&&c.info&&c.info.collapsed){for(d=c.index+c.count,e=b+1;e<k;e++)f=i[e],f&&f.info&&f.info.level>c.info.level&&f.index===d&&(d=f.index+f.count);for(g=c.index+1;g<d;g++)j[g]=!0}}else for(b=0;b<k;b++)if(c=i[b],c&&1===c.count&&c.info&&c.info.collapsed){if(d=c.index-1,d<0&&c.info.level===-1)break;for(h=b-1;h>=0;h--)f=i[h],f&&f.info&&f.info.level>c.info.level&&f.index+f.count-1===d&&(d=f.index-1);for(g=d+1;g<c.index;g++)j[g]=!0}}function Ba(a,b){if(!b)return!1;if(b.items)return b.items[a]&&b.items[a].viewCollapsed;if(!b.itemsData)return!1;b.collapseIndexMap||Aa(b);var c=b.collapseIndexMap;return!!c[a]}function Ca(a,b,c,d){var e=a[b];return e?d&&Ba(b,d)?0:e.visible===!1?0:e.size:c}function Da(a,b,c,d){var e=a[b];return e?d&&Ba(b,d)?0:e.visible===!1?0:e.size:c}function Ea(a,b,c){function d(a){var d,e,f=J(a,"ClientData");return(!f||"Note"===f.ObjectType)&&(d=parseInt(J(f,"Row").c_[0],10),e=parseInt(J(f,"Column").c_[0],10),d===b&&e===c)}return a.filter(d)[0]}function Fa(a,b){for(var c,d,e=a.defaults.rowHeight,g=0,h=0,i=a.getRowCount()||f.XmlConstants.M7;g<b&&h<i;)c=a.ITa.getSize(!0,3,h)||e,g+=c,h++;return d=g-b,d>0?(h--,d=c-d):d=b-g,{row:h,rowOffset:d}}function Ga(a,b){for(var c,d,e=a.defaults.colWidth,g=0,h=0,i=a.getColumnCount()||f.XmlConstants.L7;g<b&&h<i;)c=a.ITa.getSize(!1,3,h)||e,g+=c,h++;return d=g-b,d>0?(h--,d=c-d):d=b-g,{col:h,colOffset:d}}function Ha(a,b){if(!I(b))return"double";if(a)switch(a.toLowerCase()){case"solid":return"solid";case"1 1":return"dotted";case"dash":case"dashdot":case"longdash":case"longdashdot":case"longdashdotdot":return"dashed"}return"solid"}function Ia(a,b){var c,d,e,f,g=b.location()||{x:9,y:-18},h=b.nT,i=b.oT,j=a.getSpan(h,i);return j&&(i=j.col+j.colCount-1),c=E(a,0,i+1),d=H(a,0,h),e=["position:absolute"],f=G(c+g.x+T),f>=0&&e.push("margin-left:"+f+"pt"),f=G(d+g.y+T),f>=0&&e.push("margin-top:"+f+"pt"),f=G(b.width()-2*T)+"pt",f&&e.push("width:"+f),f=G(b.height()-2*T)+"pt",f&&e.push("height:"+f),e.push("z-index:"+b.zIndex()),e.push("visibility:"+(1===b.displayMode()?"visible":"hidden")),e.join(";")}function Ja(a){var b=f.ColorHelper.convertColorToHex(a);return b&&"string"==typeof b&&b.length>2?"#"+b.substring(2).toLowerCase():a}function Ka(a,b){var c=(a||"").trim().split(b);return{key:c[0],value:c[1]}}e.GC$.extend(f.Worksheet.prototype,{RP:function(a){var b,c,d,e,f,g=this,h=g.nQ&&g.nQ();if(g.cDJ()&&!g.fI)for(b=g.am(),c=void 0,d=0;d<=2;d++)for(e=0;e<=2;e++)c=b.Ft(d,e),c&&0!==wa(c)&&0!==va(c)&&(a&&!c.intersectRect(a)||(f=g.ITa.Ky,h&&f&&h.fT(f)))}}),aa=e.CellRange,aa.prototype.comment=function(a){var b=this,c=b.sheet,d=b.row,e=b.col;return 0===arguments.length?c.ITa.Ky.get(d,e):(a instanceof ha&&c.ITa.Ky.Cz(d,e,a),b)},ba=function(a,b){var c,d;a.ITa.Ky.iT()||(c=a.Vs(),d=a.hitTest(b.pageX-c.left,b.pageY-c.top),d&&Oa(a,d))},ca=function(a,b){b.bind(w.FloatingElementSelected+$.HGc,function(a,c){if("comments"!==c.type){var d=b.ITa.Ky;d.vQ(),d.tT(h)}}),a.bind($.jHc+$.HGc,function(a){b.ITa.Ky.vQ(),ba(b,a)}).bind($.mHc+$.HGc,function(a){ba(b,a)}).bind($.kHc+$.HGc,function(a){ba(b,a)})},da=function(a,b){b.unbind($.HGc),a.unbind($.HGc)};function La(a,b,c,d,e){var f,g,h,i,j,k,l=this,m=l.ITa.Ky;if(a&&m)for(g=m.all(),h=0;h<g.length;h++)f=g[h],i=f.nT,j=f.oT,i===b&&j===c||i>=b&&i<b+d&&j>=c&&j<c+e&&m.remove(i,j);f=m.get(b,c),f&&(k=m.pT(f),k&&k.qT())}function Ma(){var a=this,b=a.nQ&&a.nQ();b&&b.rT(a)}function Na(a,b,c){var d=this,e=d.nQ&&d.nQ();e&&e.sT(a,b,c)}function Oa(a,b){var c,d=-1,e=-1;if(b&&b.rowViewportIndex>=0&&b.colViewportIndex>=0&&(d=b.row,e=b.col),a.parent){if(d<0||e<0)return;c=a.ITa.Ky.get(d,e),a.ITa.Ky.tT(c)}}function Pa(a,b){return a&&a.getRowHeight(b)}function Qa(a,b){return a&&a.getColumnWidth(b)}function Ra(a,b){return a&&a.getViewportLeftColumn(b)}function Sa(a,b){return a&&a.getViewportTopRow(b)}w.CommentChanged="CommentChanged",function(a){a[a.active=1]="active",a[a.edit=2]="edit",a[a.normal=3]="normal"}(ea=b.CommentState||(b.CommentState={})),function(a){a[a.alwaysShown=1]="alwaysShown",a[a.hoverShown=2]="hoverShown"}(fa=b.DisplayMode||(b.DisplayMode={})),ga=function(){function a(a,b,c,d){var e=this;arguments.length<=1?e.top=e.right=e.bottom=e.left=a||0:(e.top=a,e.right=b,e.bottom=c,e.left=d)}return a.prototype.clone=function(){
var b=this;return new a(b.top,b.right,b.bottom,b.left)},a.prototype.toString=function(){var a=this,b="",c=[$.Lcc,$.sGc,$.tGc,$.rGc];return c.forEach(function(c){b+=a[c]+$.FGc+$.UGc}),b.trim()},a}(),b.Padding=ga,ha=function(){function a(a){var b=this;b.nT=-1,b.oT=-1,b.text(a||""),b.zIndex($.SGc)}return a.prototype.clone=function(){var b=this,c=new a;return ja.forEach(function(a){var d=b[a]();b[a].isDefault&&b[a].isDefault(d)||c[a](d&&d.clone?d.clone():d)}),c.kj=b.kj,c.nT=b.nT,c.oT=b.oT,c},a.prototype.toJSON=function(){var a=this,b={rowIndex:a.nT,colIndex:a.oT};return ja.forEach(function(c){var d=a[c]();a[c].isDefault&&a[c].isDefault(d)||(b[c]=d&&d.clone?d.clone():d)}),b},a.prototype.bdK=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=q.kj,s={n_:"fill",color2:"#ffffe1"},t=q.opacity();return I(t)||1===t||(s.opacity=Math.floor(65535*t)+"f"),b=["Left","Center","Right"][q.horizontalAlign()||0]||"Left",c={n_:"ClientData",ObjectType:"Note",c_:[{n_:"Row",c_:[q.nT]},{n_:"Column",c_:[q.oT]},{n_:"AutoFill",c_:["False"]}]},q.dynamicMove()===!1&&c.c_.push({n_:"MoveWithCells"}),q.dynamicSize()===!1&&c.c_.push({n_:"SizeWithCells"}),q.locked()===!1&&c.c_.push({n_:"Locked",c_:["False"]}),q.lockText()===!1&&c.c_.push({n_:"LockText",c_:["False"]}),"Left"!==b&&c.c_.push({n_:"TextHAlign",c_:[b]}),1===q.displayMode()&&c.c_.push({n_:"Visible"}),d=q.padding(),d&&(e=[G(d.left)+"pt",G(d.top)+"pt",G(d.right)+"pt",G(d.bottom)+"pt"].join(",")),f={n_:"textbox",style:"mso-direction-alt:auto"+(q.autoSize()?";mso-fit-shape-to-text:t":""),c_:[{n_:"div",style:"text-align:"+b}]},g={n_:"shape",id:"_x0000_s"+a,type:"#_x0000_t202",style:Ia(r,q),fillcolor:Ja(q.backColor()),strokecolor:Ja(q.borderColor()),strokeweight:G(q.borderWidth()||1)+"pt",c_:[s,{n_:"shadow",color:"black",obscured:"t"},{n_:"path","o:connecttype":"none"},f,c]},e?f.inset=e:g["o:insetmode"]="auto",h=[],Za(q.fontWeight())&&h.push({n_:"b"}),$a(q.fontStyle())&&h.push({n_:"i"}),i=q.textDecoration(),1&i?h.push({n_:"u"}):8&i?h.push({n_:"u",val:"double"}):2&i&&h.push({n_:"strike"}),j=q.fontSize()||"9pt",j=j.indexOf("px")!==-1?G(parseFloat(j)):j.replace("pt",""),j&&h.push({n_:"sz",val:j}),k=q.foreColor(),k?(k=P(k),h.push(k)):h.push({n_:"color",indexed:"81"}),q.fontFamily()&&h.push({n_:"rFont",val:q.fontFamily()}),h.push({n_:"family",val:"2"}),l={n_:"t"},m=q.text(),n=I(m)?"":m,o=n.length!==n.trim().length,o&&(l["xml:space"]="preserve"),l.c_=[N(n)],p={n_:"comment",ref:Q(q.oT)+(q.nT+1),authorId:"0",c_:[{n_:"text",c_:[{n_:"r",c_:[{n_:"rPr",c_:h},l]}]}]},{vmlDrawingData:g,commentData:p}},a.prototype.fromJSON=function(a,b){if(a){var c=this;ja.forEach(function(b){var d=a[b];d!==i&&("location"===b?c.location(new f.Point(d.x,d.y),!1):"padding"===b?c.padding(new ga(d.top,d.right,d.bottom,d.left),!1):c[b](d,!1))}),a.rowIndex!==i&&(c.nT=a.rowIndex),a.colIndex!==i&&(c.oT=a.colIndex)}},a.prototype.cdK=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q;b&&(g=this,h=E(a,0,g.oT+1),i=H(a,0,g.nT),j=J(b,"text"),k=j.c_,k&&(l=1===k.length,m=[],k.forEach(function(b){var j,k,r,s,t,u,v,w,x,y,z,A,B,C,D,G,K,M,N,P,Q,R,S,U=J(b,"rPr");U&&l&&(k=J(U,"rFont"),k&&(j=k.val),j&&g.fontFamily(j),r=0,s=J(U,"u"),s&&(t=s.val,u=1,t&&(u=_[t]),r|=2===u?8:1),J(U,"strike")&&(r|=2),r&&g.textDecoration(r),J(U,"b")&&g.fontWeight("bold"),J(U,"i")&&g.fontStyle("italic"),j=J(U,"color"),j&&(v=O(j),g.foreColor(v)),j=J(U,"sz").val,j&&g.fontSize(j+"pt")),w=J(b,"t"),w?w.c_&&m.push(w.c_[0]):"t"===b.n_&&b.c_&&m.push(b.c_[0]),j=c.fillcolor,j&&g.backColor(j.split(" ")[0]),j=c.strokecolor,j&&g.borderColor(j.split(" ")[0]),j=c.strokeweight,j&&g.borderWidth(F(parseFloat(j.replace("pt","")))),j=c.style,j&&(x=j.split(";"),x.forEach(function(a){var b=Ka(a,":"),c=b.key,d=b.value;if(!I(d))switch(c){case"margin-left":n=za(d);break;case"margin-top":o=za(d);break;case"width":p=d;break;case"height":q=d;break;case"z-index":g.zIndex(parseInt(d,10))}})),j=J(c,"fill"),j&&(y=j.opacity,y&&("f"===y.substr(-1)?g.opacity(parseFloat(y.substr(0,y.length-1))/65535):g.opacity(parseFloat(y)))),j=J(c,"stroke"),j&&g.borderStyle(Ha(j.dashstyle,j.linestyle)),j=J(c,"textbox"),j&&(z=j.style,z&&z.indexOf("mso-fit-shape-to-text:t")!==-1&&g.autoSize(!0),A=[0,0,0,0],j.inset&&j.inset.trim().split(",").forEach(function(a,b){var c=a||["0.1in","0.05in"][b%2];A[b]=F(parseFloat(c.replace("pt","")))}),g.padding(new ga(A[1],A[2],A[3],A[0]))),B=J(c,"ClientData"),J(B,"SizeWithCells")&&g.dynamicSize(!1),J(B,"MoveWithCells")&&g.dynamicMove(!1),j=J(B,"Locked"),j&&g.locked(_a(j.c_[0],!0)),j=J(B,"LockText"),j&&g.lockText(_a(j.c_[0],!0)),j=L(J(B,"TextHAlign")),j&&(C=["left","center","right"].indexOf(j.toLowerCase()),C!==-1&&g.horizontalAlign(C)),J(B,"Visible")&&g.displayMode(1),j=L(J(B,"Anchor")),j?(K=j.split(",").map(function(a){return parseInt(a,10)}),M=E(a,0,K[0])+K[1]-T,N=H(a,0,K[2])+K[3]-T,P=E(a,0,K[4])+K[5]+T,Q=H(a,0,K[6])+K[7]+T,g.location(new f.Point(M-h,N-i),!1),g.width(P-M),g.height(Q-N),K&&(D=K[6]+1,G=K[4]+1)):(R=F(n)-h-T,S=F(o)-i-T,g.location(new f.Point(R,S)),g.width(F(parseFloat(p.replace("pt","")))+2*T),g.height(F(parseFloat(q.replace("pt","")))+2*T),D=Fa(a,g.location().y+i+g.height()).row+2,G=Ga(a,g.location().x+h+g.width()).col+2),f.Util.alK(d)&&f.Util.blK(a,D,G,e)}),g.text(M(m.join("")))))},a}(),b.Comment=ha,ia={},ja=[];function Ta(a,b,c){return ja.push(a),e.Ul.Pl(a,b,Ua(a),c)}function Ua(a){var b=a;return function(a,c){var d=this,e=d.kj;e&&(e.ITa.UUa({type:"property",comment:d,name:b,value:c,newValue:a}),e.cDJ()&&e.Xq<=0&&(e.RP(),"indicatorColor"!==b&&"indicatorSize"!==b||e.repaint(e.getCellRect(d.nT,d.oT))),e.Wq(w.CommentChanged,{sheet:e,sheetName:e.name(),comment:d,propertyName:b}))}}ka=[[$.QGc,""],["location",ta(9,-18)],[$.uGc,160,function(a){return a>0}],[$.vGc,100,function(a){return a>0}],["fontFamily","Arial"],["fontStyle","normal"],["fontSize","9pt",function(a){return/^\d+pt$/.test(a)&&parseInt(a,10)>0}],["fontWeight","normal"],["textDecoration",0],["foreColor","black"],["locked",!0],["lockText",!0],["horizontalAlign",0],["autoSize",!1],["dynamicSize",!0,function(a){return"boolean"==typeof a&&this.dynamicMove()}],["dynamicMove",!0,function(a){return a||this.dynamicSize(!1),!0}],["backColor","#FFFFE1"],["opacity",1,function(a){return a>=0&&a<=1}],["borderWidth",1,function(a){return a>=1}],["borderStyle","solid"],["borderColor","black"],["padding"],["showShadow",!1],["displayMode",2],["commentState",3],["zIndex",-1],["ignoreDefaultLocation",!1],["indicatorColor","red",function(a){return"string"==typeof a}],["indicatorSize",6,function(a){return"number"==typeof a&&a>1}]],ka.forEach(function(a){ia[a[0]]=Ta(a[0],a[1],a[2])}),la=ia.zIndex,ia.zIndex=function(){var a,b,c=la.apply(this,arguments);return 0===arguments.length&&c===$.SGc&&(a=this.kj.comments.wTa,b=this.mi,c=$.SGc-(a-1-b)),c},ma=ia.commentState,ia.commentState=function(a,b){var c,d=ma.apply(this,arguments);return b&&(c=this.kj,c.Bq("comment",null,null,f.SheetArea.viewport,this,this)),d},p(ha.prototype,ia);function Va(a,b,c,d,e){var f=ua(b,c,d,d);f.cursor=e,a.push(f)}function Wa(a,b,c,d){f.GC$(a.DT).css(b,c),f.GC$(a.ET).css(b,d)}function Xa(a,b){var c,d=a.length,e=0;for(c=0;c<d;c++)e+=A(a[c],b);return e}function Ya(a,b){a&&a.RF(b)}function Za(a){var b=a;if(b){if("number"==typeof b)return b>400;if("string"==typeof b)return b.toLowerCase().indexOf("bold")!==-1||parseInt(b,10)>400}return!1}function $a(a){var b=a;return!!b&&["italic","oblique"].indexOf(b.toLowerCase().trim())!==-1}na=function(){function a(a,b){var c,d=this,e=a&&a.kj;d.WE=1,d.aS=1,d.kT=a,d.vT(),d._zoomFactor=e.zoom(),d.wT=b,d.BF=b.xT,d.ad(),c=d.yT(d.zT(),a.width(),a.height()),d.AT=ta(c.x,c.y),d.BT(),d.CT()}return a.prototype.ad=function(){var b=this,c=b.kT.kj;b.FT=$.NGc+"floatBlockCanvas",b.GT=$.NGc+"host-container",b.HT=$.NGc+"host",b.IT=$.NGc+"lineCanvas",b.JT=q($.GGc),f.GC$(b.JT).addClass($.NGc+"floatBlockCanvas-container").css([$.wGc,$.yGc,$.CGc],[$.xGc,$.BGc,$.DGc]),b.DT=q("canvas"),u.Kn(b.DT,null,c),f.GC$(b.DT).addClass(b.FT).css([$.rGc,$.Lcc,$.wGc],[0,0,$.xGc]),b.ET=q($.GGc),f.GC$(b.ET).addClass(b.GT).css([$.wGc,$.CGc,$.yGc],[$.xGc,$.DGc,$.BGc]),b.qo=q($.GGc),f.GC$(b.qo).addClass(b.HT+$.UGc+$.TGc).css([$.rGc,$.Lcc,$.uGc,$.vGc,$.wGc,"word-wrap","word-break","white-space",$.yGc,$.CGc,$.VGc,$.gHc],[0,0,"100%","100%",$.xGc,"break-word","normal","pre-wrap",$.BGc,$.DGc,$.WGc,"normal"]),f.GC$(b.ET).append(b.qo),f.GC$(b.JT).append(b.DT).append(b.ET),b.KT=q($.GGc),f.GC$(b.KT).addClass($.NGc+"lineCanvas-container").css([$.wGc,$.yGc,"pointer-events"],[$.xGc,$.BGc,"none"]),b.LT=q("canvas"),u.Kn(b.LT,h,c),f.GC$(b.LT).addClass(b.IT).css([$.rGc,$.sGc,$.wGc],[0,0,$.xGc]),f.GC$(b.KT).append(b.LT),b.MT=[],b.NT=7,b.qS=!1,b.kv=!1,a.ao(b,"init",[b.DT,b.qo])},a.prototype.OT=function(){var a=this,b=a.kT.kj;!a.PT&&b&&b.nQ&&(a.PT=b.nQ().PT),a.PT&&(a.PT.appendChild(a.KT),a.QT(),a.PT.appendChild(a.JT),a.RT(a.DT,$.IGc),a.RT(a.ET,$.JGc),a.ST()?a.TT():a.UT(),a.AT=a.zT(),a.VT())},a.prototype.WT=function(){var a=this;a.JT&&a.KT&&a.PT&&(a.XT(a.DT,$.IGc),a.XT(a.ET,$.JGc),a.YT(),a.ZT(),a.$T(),f.GC$(a.JT).remove(),f.GC$(a.KT).remove())},a.prototype._T=function(){return this.kT.width()*this._zoomFactor},a.prototype.aU=function(){return this.kT.height()*this._zoomFactor},a.prototype.zT=function(){var a=this,b=a.kT;return b!==a.wT.bU||b.commentState()!==ea.normal||b.ignoreDefaultLocation()?a.cU(b.location()):(b._3=a.cU(ta(9,-18)),b._3)},a.prototype.cU=function(a){var b,c,d=this,e=d.kT,f=e&&e.kj,g=d._zoomFactor,i=ta(0,0);return f&&(b=d.dU(f,e.nT,e.oT,d.WE,d.aS),b.x!==h&&void 0!==b.x&&b.y!==h&&void 0!==b.y&&wa(b)&&va(b)&&(c=f.am(),i.x=b.x+wa(b)+a.x*g-c.Br,i.y=b.y+a.y*g-c.Cr)),i},a.prototype.dU=function(a,b,c,d,e){var f,g,j,k,l=this,m=ua(0,0,0,0),n=a.am(),o=Sa(a,d),p=Ra(a,e),q=l._zoomFactor,r=y(a,p,c,!1,i,i,!0);return p===a.qq&&(r+=a.eCb),f=y(a,o,b,!0,i,i,!0),o===a.lq&&(f+=a.cCb),b>=o?m.y=f:m.y=-f,c>=p?m.x=r:m.x=-r,g=a.getSpan(b,c),g!==i&&g!==h?(m.height=0===d?z(a,b,b+g.rowCount,!0)||y(a,b,b+g.rowCount,!0):y(a,b,b+g.rowCount,!0),m.width=0===e?z(a,c,c+g.colCount,!1)||y(a,c,c+g.colCount,!1):y(a,c,c+g.colCount,!1)):(m[$.vGc]=Pa(a,b)*q,m[$.uGc]=Qa(a,c)*q),m.x+=n.Br,m.y+=n.Cr,j=n.hs,k=n.fs,1===d?m.y+=k:2===d&&(m.y+=k+a.tNc(n)),1===e?m.x+=j:2===e&&(m.x+=j+a.wNc(n)),m},a.prototype.eU=function(a){var b,c,d=this,e=d.kT,f=e&&e.kj,g=d._zoomFactor,j=ta(0,0);return f&&(b=d.dU(f,e.nT,e.oT,d.WE,d.aS),b.x!==h&&b.x!==i&&b.y!==h&&b.y!==i&&wa(b)&&va(b)&&(c=f.am(),j.x=(a.x-(b.x+wa(b)-c.Br))/g,j.y=(a.y-(b.y-c.Cr))/g)),j},a.prototype.fU=function(){var a=this;a.AT=a.zT(),a.BT(),a.CT(),a.VT()},a.prototype.gU=function(){var a=this,b=a.yT(a.zT(),a.kT.width(),a.kT.height());a.AT=ta(b.x,b.y),a.CT()},a.prototype.hU=function(){var a,b=this,c=b.kT;c.dynamicMove()?c.dynamicSize()?b.iU():(b.jU(),b.CT()):(b.BT(),b.CT(),a=b.eU(b.AT===c._3?b.zT():b.AT),c.location(a))},a.prototype.qT=function(){var a=this;a.AT=a.zT(),a.VT()},a.prototype.jU=function(){var a=this,b=a.kT,c=a.kU();a.AT=c,b.location(a.eU(c),!1),a.VT()},a.prototype.kU=function(){var a,b,c,d,e,f,g,h=this,j=h.kT,k=j&&j.kj,l=h._zoomFactor,m=Ra(k,h.aS),n=Sa(k,h.WE),o=0;for(a=0;a<h.aS;a++)o+=k.getViewportWidth(a);for(b=y(k,m,h.lU,!1,i,i,!0),m<h.lU?o+=b:o-=b,c=Qa(k,h.lU),c<h.mU&&(h.mU=c),o+=h.mU*l,d=0,e=0;e<h.aS;e++)d+=k.getViewportHeight(e);return f=y(k,n,h.nU,!0,i,i,!0),n<h.nU?d+=f:d-=f,g=Pa(k,h.nU),g<h.oU&&(h.oU=g),d+=h.oU*l,ta(o,d)},a.prototype.pU=function(){var a,b,c,d,e=this,f=e.kT,g=f&&f.kj,h=y(g,e.lU,e.mT,!1,i,!0),j=Qa(g,e.lU);j<e.mU&&(e.mU=j),a=Qa(g,e.mT),a<e.qU&&(e.qU=a),h=h-e.mU+e.qU,b=y(g,e.nU,e.lT,!0,i,!0),c=Pa(g,e.nU),c<e.oU&&(e.oU=c),d=Pa(g,e.lT),d<e.rU&&(e.rU=d),b=b-e.oU+e.rU,f.width(h),f.height(b)},a.prototype.iU=function(){var a=this;a.pU(),a.jU()},a.prototype.BT=function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.kT,n=m&&m.kj,o=l._zoomFactor;if(l.AT){for(a=Ra(n,l.aS),b=Sa(n,l.WE),0===l.aS?c=l.AT.x:1===l.aS?c=l.AT.x-n.getViewportWidth(0):2===l.aS&&(c=l.AT.x-(n.getViewportWidth(0)+n.getViewportWidth(1))),0===l.WE?d=l.AT.y:1===l.WE?d=l.AT.y-n.getViewportHeight(0):2===l.WE&&(d=l.AT.y-(n.getViewportHeight(0)+n.getViewportHeight(1))),e=ta(c,d),f=0,g=0,h=a;h<n.getColumnCount();h++){if(i=Qa(n,h)*o,!(f+i<e.x)){l.lU=h,l.mU=(e.x-f)/o;break}f+=i}for(j=b;j<n.getRowCount();j++){if(k=Pa(n,j)*o,!(g+k<e.y)){l.nU=j,l.oU=(e.y-g)/o;break}g+=k}}},a.prototype.CT=function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.kT,n=m&&m.kj,o=l._zoomFactor;if(l.AT){for(a=Ra(n,l.aS),b=Sa(n,l.WE),0===l.aS?c=l.AT.x+l._T():1===l.aS?c=l.AT.x+l._T()-n.getViewportWidth(0):2===l.aS&&(c=l.AT.x+l._T()-(n.getViewportWidth(0)+n.getViewportWidth(1))),0===l.WE?d=l.AT.y+l.aU():1===l.WE?d=l.AT.y+l.aU()-n.getViewportHeight(0):2===l.WE&&(d=l.AT.y+l.aU()-(n.getViewportHeight(0)+n.getViewportHeight(1))),e=ta(c,d),f=0,g=0,h=a;h<n.getColumnCount();h++){if(i=Qa(n,h)*o,!(f+i<e.x)){l.mT=h,l.qU=(e.x-f)/o;break}f+=i}for(j=b;j<n.getRowCount();j++){if(k=Pa(n,j)*o,!(g+k<e.y)){l.lT=j,l.rU=(e.y-g)/o;break}g+=k}}},a.prototype.rI=function(a,b){var c=this,d=c.kT;a<=c.nU?d.dynamicMove()&&(c.nU+=b,c.lT+=b):a>c.nU&&a<=c.lT&&d.dynamicSize()&&(c.lT+=b),c.iU()},a.prototype.tI=function(a,b){var c=this,d=c.kT;a<=c.lU?d.dynamicMove()&&(c.lU+=b,c.mT+=b):a>c.lU&&a<=c.mT&&d.dynamicSize()&&(c.mT+=b),c.iU()},a.prototype.GR=function(a,b){var c=this,d=c.kT,e=a+b-1;a<c.nU?e<c.nU?d.dynamicMove()&&(c.nU-=b,c.lT-=b):e<c.lT&&d.dynamicMove()&&(d.dynamicSize()?c.lT-=b:c.lT-=c.nU-a+1,c.nU=a,c.oU=0):a<=c.lT&&(e<c.lT?d.dynamicSize()&&(c.lT-=b):d.dynamicSize()&&(c.lT=a,c.rU=0)),c.iU()},a.prototype.HR=function(a,b){var c=this,d=c.kT,e=a+b-1;a<c.lU?e<c.lU?d.dynamicMove()&&(c.lU-=b,c.mT-=b):e<c.mT&&d.dynamicMove()&&(d.dynamicSize()?c.mT-=b:c.mT-=c.lU-a+1,c.lU=a,c.mU=0):a<=c.mT&&(e<c.mT?d.dynamicSize()&&(c.mT-=b):d.dynamicSize()&&(c.mT=a,c.qU=0)),c.iU()},a.prototype.VT=function(){var a,b=this,c=b.kT,d=c.kj;b.sU()&&(a=d.zoom(),b._zoomFactor!==a?(b._zoomFactor=a,b.AT=b.kU()):(b._zoomFactor=a,b.AT!==c._3||1!==c.displayMode()&&2!==c.commentState()||(b.AT=b.zT())),b.vT(),b.tU(),b.uU(),b.vU(),b.wU(),v.Ml.chrome&&b.xU())},a.prototype.tU=function(){var a=this,b=a.kT.kj,c=b.parent&&b.parent.options.useTouchLayout;c?a.NT=11:a.NT=7},a.prototype.vT=function(){var a=this,b=a.kT,c=b.kj;a.WE=c.Er(b.nT),a.aS=c.Fr(b.oT)},a.prototype.uU=function(){var a=this,b=a.kT,c=2===b.commentState()?a.BF:a.qo;a.yU(),a.zU(c),a.AU(c),a.BU(c),a.CU()},a.prototype.AU=function(a){var b=this,c=b.kT;a===b.qo&&(a.innerHTML=C.Ob(c.text()))},a.prototype.BU=function(a,b){var c,d,e,g,h,i,l,m,o,p,q,r,s,t,v,w,x,y,z,A,C,D,E,F,G,H,I,J,K,L,M=this,N=M.kT,O=b||2===N.commentState()||1===N.displayMode()?M.zT():M.AT,P=M._zoomFactor;O&&(c=M.kv?M.yT(O,N.width(),N.height()):M.yT(O),M.DU(c),d=wa(c)*P,e=va(c)*P,g=c.x,h=c.y,i=g+d,l=h+e,m=M.NT,o=M.EU(M.WE,M.aS),p=2*(m+N.borderWidth()),g<o.x?(Wa(M,$.rGc,g-o.x,g+m-o.x),d+=g-o.x,g=o.x):(Wa(M,$.rGc,0,m),i>o.x+wa(o)&&(d+=o.x+wa(o)-1-i)),d=k(wa(o)-1,d),d<0&&(q=N.kj,r=N.oT,s=q.br(q.getColumnCount()-q.CNc),t=q.getViewportRightColumn(1),q.CBJ===!1&&r===s&&r===t&&(g=o.x+wa(o)-1-N.width(),d=N.width())),h<o.y?(Wa(M,$.Lcc,h-o.y,h+m-o.y),e+=h-o.y,h=o.y):(Wa(M,$.Lcc,0,m),l>o.y+va(o)&&(e+=o.y+va(o)-1-l)),e=k(va(o)-1,e),v=f.GC$(M.JT),v.css({left:g,top:h}),w=v.height(),x=v.width(),y=M.EkK(d,e),z=!1,y&&(d=y.adjustedWidth,e=y.adjustedHeight,z=y.needReposition),e<=0&&w<=0||d<=0&&x<=0||((n(e-w)>1||n(d-x)>1)&&(v.css({width:d,height:e}),u.Pn(M.DT,d,e)),A=f.GC$(M.ET),C=A.width(),D=A.height(),E=j(0,d-p),F=j(0,e-p),(n(D-F)>1||n(C-E)>1)&&f.GC$(M.ET).css({width:E,height:F}),G=f.GC$(a),H=G.width(),I=G.height(),J=E,K=F,L=N.padding(),L&&(J-=Math.ceil(B(L.left)+B(L.right)),K-=Math.ceil(B(L.top)+B(L.bottom))),(n(I-K)>1||n(H-J)>1)&&f.GC$(a).css({width:j(0,J),height:j(0,K)}),z&&M.BU(a,!0)))},a.prototype.DU=function(a){var b,c,d,e,f=this,g=f.kT,h=f.AT;a.x===h.x&&a.y===h.y&&wa(a)===g.width()&&va(a)===g.height()||(b=f.eU(ta(a.x,a.y)),c=wa(a),d=va(a),e=g.location(),b.x===e.x&&b.y===e.y||g.location(b,!1),c!==g.width()&&g.width(c,!1),d!==g.height()&&g.height(d,!1),g.dynamicMove()&&(f.AT=ta(a.x,a.y)))},a.prototype.CU=function(){var a=this,b=a.kT,c=b&&b.kj;xa(c)?(a.RT(a.DT,$.IGc),a.RT(a.ET,$.JGc),a.QT(),a.UT(),a.TT()):(b.locked()?(a.XT(a.DT,$.IGc),a.FU(a.DT),a.XT(a.ET,$.JGc),a.FU(a.ET),a.DT.style.cursor=o,a.ET.style.cursor=o):(a.RT(a.DT,$.IGc),a.RT(a.ET,$.JGc)),b.lockText()?(a.YT(),a.FU(a.qo),a.$T(),a.FU(a.BF),(b.locked()||b.commentState()!==ea.active)&&b.commentState(3),a.qo.style.cursor=b.locked()?o:$.pGc):(a.UT(),a.TT()),a.QT())},a.prototype.yU=function(){var a=this,b=a.kT,c=a.wT,d=b&&b.kj;switch(b.commentState()){case ea.active:c.GU(b),a.ST()&&a.HU(),d.getSelections().length>0&&d.EJ(),t.Zl(d);break;case ea.edit:c.GU(b),a.ST()||a.IU(),d.getSelections().length>0&&d.EJ(),t.Zl(h);break;case ea.normal:b===c.JU()&&(c.vQ(),0===d.getSelections().length&&d.GJ())}},a.prototype.zU=function(a){var b,c,g,h,i;function j(a,b,c){var e,f;return c?(e=d.Common.pc,f=e.ec(a),f.a=b,e.bc(f)):a}b=this,c=b.kT,g=f.GC$(a),g.css("font-family",c.fontFamily()).css("font-style",c.fontStyle()).css("font-size",parseInt(c.fontSize(),10)*b._zoomFactor+"pt").css("font-weight",c.fontWeight()),g.css("text-decoration",e.To.So(c.textDecoration())),h={0:"left",1:"center",2:"right",3:"general"},g.css("text-align",h[c.horizontalAlign()]),c.padding()?g.css($.EGc,""+c.padding()):g.css($.EGc,"0px"),g.css("background-color",j(c.backColor(),c.opacity(),a===b.qo)).css("color",c.foreColor()),f.GC$(b.ET).css("border-width",c.borderWidth()).css("border-style",c.borderStyle()).css("border-color",c.borderColor()),i=b.wT.KU(c),f.GC$(b.KT).css($.AGc,i),f.GC$(b.JT).css($.AGc,i)},a.prototype.xU=function(){var a,b,c,d=this,e=this.kT.kj,g=f.GC$(d.ET);e&&g&&(a=e.Vs(),b=a.left-l(a.left)>=.5?.5:0,c=a.top-l(a.top)>=.5?.5:0,g.css($.rGc,B(g.css($.rGc))+b),g.css($.Lcc,B(g.css($.Lcc))+c))},a.prototype.vU=function(){var a,b,c,d,e,g,h,i,j,l=this,m=l.kT,o=m.kj,p=l.dU(o,m.nT,m.oT,l.WE,l.aS),q=o.am(),r=p.x+wa(p)-q.Br,s=p.y-q.Cr,t=ta(r,s),v=f.GC$(l.JT).position(),w=f.GC$(l.ET).position(),x=f.GC$(l.ET);a=v.left+w.left>t.x?ta(v.left+w.left,v.top+w.top):v.top+w.top+x.height()<t.y?ta(v.left+w.left+x.width(),v.top+w.top+x.height()):ta(v.left+w.left+x.width(),v.top+w.top),b=l.NT,c=n(t.x-a.x)+2*b,d=n(t.y-a.y)+2*b,e=k(t.x,a.x)-b,g=k(t.y,a.y)-b,h=e+c,i=g+d,j=l.EU(l.WE,l.aS),e<j.x&&(c-=j.x-e,e=j.x),h>j.x+wa(j)&&(c-=h-(j.x+wa(j))),c=k(wa(j),c),g<j.y&&(d-=j.y-g,g=j.y),i>j.y+va(j)&&(d-=i-(j.y+va(j))),d=k(va(j),d),f.GC$(l.KT).css($.rGc,e).css($.Lcc,g).css($.uGc,c).css($.vGc,d),u.Pn(l.LT,c,d),t.x=t.x-e,t.y=t.y-g,a.x=a.x-e,a.y=a.y-g,l.LU(t,a)},a.prototype.LU=function(a,b){var c,d,e,f=this;f.MU||(f.MU=f.LT.getContext("2d")),c=f.MU,d=f.kT.borderColor(),c.strokeStyle=d,c.clearRect(0,0,u.Nn(f.LT),u.On(f.LT)),c.beginPath(),c.moveTo(a.x,a.y),c.lineTo(b.x,b.y),c.stroke(),c.save(),D.Dn(c,a.x,a.y),c.fillStyle=d,c.beginPath(),e=m(b.y-a.y,b.x-a.x),c.rotate(e),c.moveTo(0,0),c.lineTo(7,-4),c.lineTo(7,4),c.lineTo(0,0),c.fill(),D.Dn(c,-a.x,-a.y),c.closePath(),c.restore()},a.prototype.wU=function(){var a,b,c,d,e,g,h,i=this,j=i.kT,k=j.kj;i.NU=i.kT.commentState(),i.OU||(i.OU=i.DT.getContext("2d")),a=i.OU,b=u.Nn(i.DT),c=u.On(i.DT),d=f.GC$(i.ET).outerWidth(),e=f.GC$(i.ET).outerHeight(),g=i.NT,a.clearRect(0,0,b,c),i.kT.showShadow()&&(i.QU(a,b,c),h=2*(g+2),a.clearRect(g,g,b-h,c-h),i.PU(a,g,d,e)),xa(k,j)&&i.RU(a,g,b,c,d,e),a.restore()},a.prototype.PU=function(a,b,c,d){a.save(),a.fillStyle=$.LkK,a.fillRect(b+2,d+b,c,2),a.fillRect(c+b,b+2,2,d),a.restore()},a.prototype.QU=function(a,b,c){var d,e,f;switch(a.save(),a.strokeStyle=$.LkK,this.NU){case ea.active:for(a.beginPath(),e=0;e<c;e++)for(d=e%2===0?1:3;d<b;)a.moveTo(d,e),a.lineTo(d+1,e+1),d+=4;a.stroke(),a.closePath();break;case ea.edit:for(a.beginPath(),d=0,e=0,f=4;d<b+c;)a.moveTo(d+f,0),a.lineTo(0,e+f),d+=f,e+=f;a.stroke(),a.closePath()}a.restore()},a.prototype.RU=function(a,b,c,d,e,g){var i=this,j=i.MT;i.NU!==ea.active&&i.NU!==ea.edit||(j.splice(0,j.length),Va(j,0,0,b,"nw"+$.fHc),Va(j,c-b,0,b,"ne"+$.fHc),Va(j,0,d-b,b,"sw"+$.fHc),Va(j,c-b,d-b,b,"se"+$.fHc),g>=3*b?(Va(j,0,l(d/2-b/2),b,"w"+$.fHc),Va(j,c-b,l(d/2-b/2),b,"e"+$.fHc)):(j.push(h),j.push(h)),e>=3*b?(Va(j,l(c/2-b/2),0,b,"n"+$.fHc),Va(j,l(c/2-b/2),d-b,b,"s"+$.fHc)):(j.push(h),j.push(h)),a.restore(),a.fillStyle="white",a.strokeStyle="#939393",a.lineWidth=1,D.Dn(a,.5,.5),f.GC$.each(j,function(b,c){if(c){var d=c.x,e=c.y,f=wa(c),g=va(c);a.beginPath(),a.fillRect(d,e,f-1,g-1),a.strokeRect(d,e,f-1,g-1),a.stroke(),a.closePath()}}),D.Dn(a,-.5,-.5))},a.prototype.SU=function(){var a,b,c,d=this,e=d.EU(d.WE,d.aS);d.TU?f.GC$(d.TU).remove():d.TU=q($.GGc),a=f.GC$(d.TU),b=f.GC$(d.ET),a.addClass("gc-spread-moveResizeContainer").css([$.wGc,$.rGc,$.Lcc,$.uGc,$.vGc,"border"],[$.xGc,d.AT.x+d.NT-e.x,d.AT.y+d.NT-e.y,b.outerWidth()-2,b.outerHeight()-2,"gray solid thin"]),d.UU?f.GC$(d.UU).remove():d.UU=q($.GGc),c=f.GC$(d.UU),c.bind("mousemove",function(a){d.BD(a)}).bind($.lHc,function(a){d.CD(a)}).css([$.wGc,$.yGc,$.Lcc,$.rGc,$.uGc,$.vGc,"background",$.AGc],[$.xGc,$.BGc,e.y,e.x,wa(e),va(e),"rgba(255,255,255,0.01)",901]),c.append(d.TU),d.PT&&d.PT.appendChild(d.UU)},a.prototype.VU=function(a){var b,c,d,e,g,h,i,j,k,l=this,m=l.NT,n=l._zoomFactor,o=l.wT,p=o.WU;if(p.XU){if(b=l.YU(),c=a.pageX/n-p.x+b.x,d=a.pageY/n-p.y+b.y,0===c&&0===d)return;e=l.EU(l.WE,l.aS),h=f.GC$(l.TU),p.H8J<0?(i=p.$U.x+c,j=p.$U.y+d,g=l.cU(ta(i,j)),h.css([$.rGc,$.Lcc],[g.x+m-e.x,g.y+m-e.y])):(k=l._U(c,d,p.H8J),g=l.cU(ta(k.x,k.y)),h.css([$.rGc,$.Lcc,$.uGc,$.vGc],[g.x+m-e.x,g.y+m-e.y,wa(k)*n-2*m-2,va(k)*n-2*m-2]))}},a.prototype.IU=function(){var a,b=this,c=b.kT;b.ST()||(a=b.wT.xT,f.GC$(b.qo).remove(),b.YT(),f.GC$(a).remove(),f.GC$(b.ET).append(a),b.aV(a),b.BU(a),f.GC$(a).focus(),a.selectionStart=a.value.length,b.TT(),2!==c.commentState()&&c.commentState(2,!0))},a.prototype.HU=function(){var b,c=this,d=c.kT,e=d.kj;c.ST()&&(b=c.wT.xT,c.$T(),f.GC$(b).remove(),f.GC$(c.ET).append(c.qo),c.aV(c.qo),c.UT(),a.ao(c,"detachEditor",c.qo),2===d.commentState()&&d.commentState(3),f.GC$(b).val()!==d.text()&&e.wu().execute({cmd:"changeComment",sheetName:e.name(),row:d.nT,col:d.oT,oldValue:d.text(),newValue:f.GC$(b).val(),propertyName:$.QGc}))},a.prototype.bV=function(a){var b=this,c=b.kT.kj,d=-1;return 0===a||2===a?d=c.getViewportHeight(a):1===a&&(d=y(c,c.getViewportBottomRow(0)+1,Sa(c,2)+1,!0)),d},a.prototype.cV=function(a){var b=this,c=b.kT.kj,d=-1;return 0===a||2===a?d=c.getViewportWidth(a):1===a&&(d=y(c,c.getViewportRightColumn(0)+1,Ra(c,2)+1,!1)),d},a.prototype.EU=function(a,b){var c=this,d=c.kT.kj,e=d.am(),f=e.Ft(a,b),g=d.wNc(e),h=d.tNc(e);return 0===a&&0===b||0===a&&2===b||2===a&&0===b||2===a&&2===b?f=ua(0,0,e.hs+g+e.js,e.fs+h+e.gs):0===a&&1===b||2===a&&1===b?f=ua(e.hs,0,g,e.fs+h+e.gs):1===a&&0===b||1===a&&2===b?f=ua(0,e.fs,e.hs+g+e.js,h):1===a&&1===b&&(f=ua(e.hs,e.fs,g,h)),f},a.prototype.aV=function(a){var b=this,c=b.kT,d=f.GC$(a);a!==b.BF&&a!==b.qo||(a===b.BF?a.value=c.text():a.innerHTML=C.Ob(c.text()),d.css([$.ZGc,$.$Gc,$._Gc,$.aHc,$.bHc,$.hHc,$.iHc,$.nHc],[c.fontFamily(),c.fontStyle(),c.fontSize(),c.fontWeight(),c.foreColor(),c.backColor(),c.horizontalAlign(),c.textDecoration()]),c.padding()?d.css($.EGc,""+c.padding()):d.css($.EGc,"0px"))},a.prototype.sU=function(){return!(!this.JT||!this.JT.parentNode)},a.prototype.ST=function(){var a=this;return a.sU()&&a.kT===a.wT.JU()&&f.GC$(a.ET).find($.cHc).length>0},a.prototype.dV=function(){var a,b=this,c=b.kT.kj,d=h;return b.sU()&&(a=c.am(),d=ua(b.AT.x+a.zr+a.Br,b.AT.y+a.Ar+a.Cr,b._T(),b.aU())),d},a.prototype.eV=function(){var a,b,c,d,e,f,g,i=this,j=i.kT,k=i._zoomFactor;return i.sU()&&(a=i.dV())?(b=void 0,c=void 0,d=void 0,e=void 0,f=(i.NT+j.borderWidth())*k,g=f,b=a.x+f,c=a.y+g,d=wa(a)-2*f,e=va(a)-2*g,ua(b,c,d,e)):h},a.prototype.fV=function(a){var b,c=this,d=c.kT,e=d.kj,f=a.target,g=c.wT.WU,h=f.style,i=o;g.XU?f[$.OGc]!==c.HT&&f[$.OGc]!==c.FT&&f[$.OGc]!==c.IT&&f[$.OGc]!==$.NGc+"floatPanel"||(i=g.H8J>=0?"crosshair":$.pGc):f[$.OGc]===c.HT?!xa(e)&&d.lockText()?d.locked()||(i=$.pGc):i=$.QGc:f[$.OGc]!==c.FT&&f[$.OGc]!==c.GT||xa(e,d)&&(b=c.gV(a),i=b>=0&&b<c.MT.length?c.MT[b].cursor:$.pGc),h[$.PGc]=i},a.prototype.hV=function(b){var c,d=this,e=d.kT,f=e&&e.kj;if(f&&f.endEdit()&&e&&f.comments.get(e.nT,e.oT)&&(c={e:b,r:h},a.ao(d,"preProcessMouseDownEdit",c),!c.r))return f.Wq(w.FloatingElementSelected,{type:"comments"}),d.wT.GU(e),e.commentState(2,!0),d.CD(b),x(b)},a.prototype.iV=function(b){var c,d,e,f,g,i=this,j=i.kT,k=j&&j.kj,l=i._zoomFactor,m=i.wT,n=m.WU;k.endEdit()&&(c={e:b,r:h},a.ao(i,"preProcessMouseDownDragResize",c),c.r||(k.Wq(w.FloatingElementSelected,{type:"comments"}),n.x=b.pageX/l,n.y=b.pageY/l,n.$U=ua(j.location().x,j.location().y,j.width(),j.height()),n.H8J=i.gV(b),i.tC(),n.XU=!0,i.fV(b),m.GU(j),j.commentState(ea.active,!0),xa(k,j)&&(i.eS={},i.eS.jV=Sa(k,i.WE),i.eS.kV=Ra(k,i.aS),i.SU(),n.H8J<0?i.qS=!0:i.kv=!0),d=k.mm,e=k.Vs(),f=ta(b.pageX-e.left,b.pageY-e.top),g=k.hitTest(f.x,f.y),d.rG={KG:g.rowViewportIndex,MG:g.colViewportIndex,sG:g.hitTestType},d.$F=f,d.qG(),d.lV=!0,b.stopPropagation()))},a.prototype.yT=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,o=this,p=o.kT,q=p&&p.kj,r=o.NT,s=o._zoomFactor,t=o.aS,u=o.WE,v=o.EU(u,t),w=void 0!==b?b*s:o._T(),x=void 0!==c?c*s:o.aU(),z=a.x,A=a.y,B=q.am(),C=o.dU(q,0,0,u,t),D=a.x+(0-(C.x-B.Br))+w-r,E=a.y+(0-(C.y-B.Cr))+x-r,F=0,G=0,H=0,I=0;return 0===t?(F=0-r,H=wa(B)-B.Br):1===t?(d=y(q,q.getViewportRightColumn(0)+1,Ra(q,1),!1),F=v.x-r-d,e=o.cV(2),H=e):2===t&&(F=0-r,H=0),z<F&&(o.kv?w-=F-z:D+=F-z,z=F),1!==t&&2!==t||(H+=y(q,0,q.getColumnCount(),!1,D)),D>H&&(o.kv?w-=D-H:o.qS?z-=D-H:(f=o.wT.bU&&!p.ignoreDefaultLocation()?9:p.location().x,g=2*n(f)+Qa(q,p.oT)+p.width(),h=z-g,h>F?z=h:z<H?w-=D-H:(h=z-g,i=D-g,i>F?h<F?(w-=F-h,z=F):z=h:(h=z-(D-H),h<F?(w-=F-h,z=F):z=h)))),0===u?(G=0-r,I=va(B)-B.Cr):1===u?(j=y(q,q.getViewportBottomRow(0)+1,Sa(q,1),!0),G=v.y-r-j,k=o.bV(2),I=k):(G=0-r,I=0),A<G&&(o.kv?x-=G-A:E+=G-A,A=G),1!==u&&2!==u||(I+=y(q,0,q.getRowCount(),!0,E)),E>I&&(o.kv?x-=E-I:o.qS?A-=E-I:E>I&&(l=E-I,m=A-l,m<G?(x-=G-m,A=G):A=m)),ua(z,A,w/s,x/s)},a.prototype.YU=function(){var a=this,b=a.kT.kj,c=a.eS,d=c.jV,e=c.kV,f=Sa(b,a.WE),g=Ra(b,a.aS),h=y(b,d,f,!0),i=y(b,e,g,!1),j=e<g?i:-i,k=d<f?h:-h;return ta(j,k)},a.prototype.mV=function(a){var b,c,d,e,f,h,i,j,k,l,m=this,n=m.kT,o=n&&n.kj,p=m._zoomFactor,q=m.wT,r=q.WU,s=g.ChangeComment;if(r.XU){if(b=m.YU(),c=a.pageX/p-r.x+b.x,d=a.pageY/p-r.y+b.y,0===c&&0===d)return;e=void 0,f=void 0,r.H8J<0?(i=r.$U.x+c,j=r.$U.y+d,e=m.cU(ta(i,j)),f=m.yT(e),h=m.eU(ta(f.x,f.y)),h.x===n.location().x&&h.x===n.location().y||o.wu().execute({cmd:"moveComment",sheetName:o.name(),row:n.nT,col:n.oT,oldValue:n.location().clone(),newValue:h,propertyName:"location"})):(n.autoSize(!1),k=m._U(c,d,r.H8J),e=m.cU(ta(k.x,k.y)),f=m.yT(e,wa(k),va(k)),h=m.eU(ta(f.x,f.y)),l=[],h.x===n.location().x&&h.y===n.location().y||l.push(new s(o,{cmd:"changeComment",sheetName:o.name(),row:n.nT,col:n.oT,oldValue:n.location().clone(),newValue:h,propertyName:"location"})),wa(f)!==n.width()&&l.push(new s(o,{cmd:"changeComment",sheetName:o.name(),row:n.nT,col:n.oT,oldValue:n.width(),newValue:f.width,propertyName:$.uGc})),va(f)!==n.height()&&l.push(new s(o,{cmd:"changeComment",sheetName:o.name(),row:n.nT,col:n.oT,oldValue:n.height(),newValue:f.height,propertyName:$.vGc})),l.length>0&&o.wu().execute({cmd:"changeCommentTransaction",sheetName:o.name(),commands:l}))}},a.prototype.BD=function(b){var c,d,e,f,g,i=this,j=i.kT.kj,k={e:b,r:h};if(a.ao(i,"preProcessMouseMove",k),!(k.r||(this.fV(b),j.getSelections()&&j.getSelections().length>0)))return c=i.wT,d=b.target,e=j.mm,f=j.Vs(),g=ta(b.pageX-f.left,b.pageY-f.top),d&&c.WU.XU&&(i.TU&&i.VU(b),1===i.WE&&(e.$F.y=g.y),1===i.aS&&(e.$F.x=g.x),e.NG()),x(b)},a.prototype.CD=function(b){var c,d,e,g=this,i=g.kT.kj,j={e:b,r:h};if(a.ao(g,"preProcessMouseUp",j),!(j.r||i.getSelections()&&i.getSelections().length>0))return c=b.target,d=g.wT,e=i.mm,e.lV=!1,e.RG(),c&&(g.mV(b),g.UU&&(f.GC$(g.UU).remove(),g.UU=null,g.qS=!1,g.kv=!1),g.uC(),d.WU.XU=!1,g.fV(b)),x(b)},a.prototype.gV=function(a){var b,c,d,e,g,h=this,i=h.MT;if(i.length>0&&(h.NU===ea.active||h.NU===ea.edit))for(b=h.DT,c=a.pageX-f.GC$(b).offset().left,d=a.pageY-f.GC$(b).offset().top,e=0;e<i.length;e++)if(g=i[e],g&&g.contains(c,d))return e;return-1},a.prototype._U=function(a,b,c){var d,e,f=this,g=-1,h=-1;switch(c){case 0:g=0,h=0;break;case 1:g=2,h=0;break;case 2:g=0,h=2;break;case 3:g=2,h=2;break;case 4:g=0,h=1;break;case 5:g=2,h=1;break;case 6:g=1,h=0;break;case 7:g=1,h=2}return d=f.nV(a,g),e=f.oV(b,h),ua(d.x,e.y,d.w,e.h)},a.prototype.nV=function(a,b){var c,d,e=this,f=2*e.NT,g=e.wT.WU,h=wa(g.$U)-f;return 0===b?h-=a:2===b&&(h+=a),c=g.$U.x,h>=0?0===b&&(c+=a):0===b?c+=wa(g.$U)-f:2===b&&(c+=h),d=wa(g.$U),1!==b&&(d=n(h)+f),{x:c,w:d}},a.prototype.oV=function(a,b){var c,d,e=this,f=2*e.NT,g=e.wT.WU,h=va(g.$U)-f;return 0===b?h-=a:2===b&&(h+=a),c=g.$U.y,h>=0?0===b&&(c+=a):0===b?c=va(g.$U)-f:2===b&&(c+=h),d=va(g.$U),1!==b&&(d=n(h)+f),{y:c,h:d}},a.prototype.FU=function(a){var b,c,d=this,e=d.kT.kj;if(a){switch(b=i,a){case d.DT:b=$.IGc;break;case d.ET:b=$.JGc;break;case d.KT:b=$.KGc;break;case d.qo:b=$.LGc;break;case d.BF:b=$.MGc}b&&(f.GC$(a).unbind($.mHc+b).unbind($.qGc+b),c=function(a){e.RF(a),x(a)},f.GC$(a).bind($.mHc+b,c).bind($.qGc+b,c))}},a.prototype.RT=function(a,b){var c,d=this,e=d.kT,g=e&&e.kj;d.XT(a,b),c=function(a){Ya(g,a)},f.GC$(a).bind($.jHc+b,function(a){d.iV(a)}).bind($.kHc+b,function(a){d.BD(a)}).bind($.lHc+b,function(a){d.CD(a)}).bind($.mHc+b,c).bind($.qGc+b,c)},a.prototype.XT=function(a,b){f.GC$(a).unbind(b)},a.prototype.QT=function(){var a,b,c=this,d=c.kT,e=d&&d.kj,g=c.wT;c.ZT(),e&&(a=e.Vs(),b=function(a){e.RF(a)},f.GC$(c.LT).bind($.jHc+$.dHc,function(b){var d,h,i=e.ITa.Ky.hitTest(b.pageX-a.left,b.pageY-a.top);i?(d=i.comment,h=g.pT(d),i.area===$.XGc?h.hV(b):i.area===$.YGc&&h.iV(b),f.GC$(h.JT).css($.AGc,parseInt(f.GC$(c.KT).css($.AGc)+1,10))):e.OF(b)}).bind($.kHc+$.dHc,function(b){var d,f,i,j=e.ITa.Ky.hitTest(b.pageX-a.left,b.pageY-a.top),k=c.LT.style;j?(d=j.comment,f=g.pT(d),f.BD(b),j.area===$.XGc?k.cursor=$.QGc:j.area===$.YGc&&(k.cursor=$.pGc)):(e.PF(b),c.wT.tT(h),i=e.Ws(),i&&(k.cursor=i.style.cursor))}).bind($.lHc+$.dHc,function(b){var c,d,f=e.ITa.Ky.hitTest(b.pageX-a.left,b.pageY-a.top);f?(c=f.comment,d=g.pT(c),d.CD(b)):e.QF(b)}).bind("dblclick"+$.dHc,function(a){e.TF(a)}).bind($.mHc+$.dHc,b).bind($.qGc+$.dHc,b))},a.prototype.ZT=function(){var a=this;f.GC$(a.LT).unbind($.dHc)},a.prototype.UT=function(){var a,b=this,c=b.kT,d=c&&c.kj;c.commentState()!==ea.edit&&b.qo&&(b.YT(),a=function(a){Ya(d,a)},f.GC$(b.qo).bind($.jHc+$.LGc,function(a){b.hV(a)}).bind($.kHc+$.LGc,function(a){b.BD(a)}).bind($.lHc+$.LGc,function(a){b.CD(a)}).bind($.mHc+$.LGc,a).bind($.qGc+$.LGc,a))},a.prototype.YT=function(){var a=this,b=a.kT;b.commentState()!==ea.edit&&a.qo&&f.GC$(a.qo).unbind($.LGc)},a.prototype.TT=function(){var a=this,b=a.kT,c=b&&b.kj,d=a.BF;b.commentState()===ea.edit&&d&&(this.$T(),f.GC$(d).bind($.jHc+$.MGc,function(a){a.stopPropagation()}).bind($.kHc+$.MGc,function(a){a.stopPropagation()}).bind($.lHc+$.MGc,function(a){a.stopPropagation()}).bind("keydown"+$.MGc,function(a){27!==a.keyCode&&9!==a.keyCode||(b.commentState(ea.active,!0),x(a),t.Zl(c))}).bind("focusout"+$.MGc,function(){f.GC$(d).val()!==b.text()&&c.wu().execute({cmd:"changeComment",sheetName:c.name(),row:b.nT,col:b.oT,oldValue:b.text(),newValue:f.GC$(d).val(),propertyName:$.QGc})}))},a.prototype.EkK=function(a,b){var c,d,e,g,h,i,m,n,o,p,q,r,s,t,u,v,w,x,y,z,B,D=this,E=D.kT,F=D.NT,G=E.padding(),H=2*(F+E.borderWidth());if(!(!E.autoSize()||D.kv||D.y$J||b<=0)){if(D.y$J=!0,c=E.kj,d=c.am(),e=c.zo()&&c.zo().getBoundingClientRect(),E.commentState()===ea.edit?(g=D.BF,h=g.value):(g=D.qo,h=C.Pb(g.innerHTML)),i=g.style,m="",i.font?m+=i.font:(E.fontStyle()&&(m+=$.UGc+E.fontStyle()),E.fontWeight()&&(m+=$.UGc+E.fontWeight()),E.fontSize()&&(m+=$.UGc+parseInt(E.fontSize(),10)*D._zoomFactor+"pt"),E.fontFamily()&&(m+=$.UGc+E.fontFamily())),n=g.getBoundingClientRect(),o=E.location().x<0,p=!1,q=A("M",m),r=5,s=q,t=r,u=d.x+d.width-(n.left-e.left),v=d.y+d.height-(n.top-e.top),o&&(u=n.left-e.left+n.width-d.x,p=!0),w=f.Vn.Wn(h,u,m),w&&w.length>0){for(x=0,y=0;y<w.length;y++)z=c.rt(w[y],m),x<z&&(x=z);B=Xa(w,m),
G&&(x+=(G.left||0)+(G.right||0),B+=(G.top||0)+(G.bottom||0)),t=l(k(u,j(x,r))),s=l(k(v,B))}return 2===E.commentState()&&E.text(g.value),b=s+H,a=t+H,E.width(t,!1),E.height(s,!1),p&&E.location().x+t<=0&&(p=!1),D.y$J=!1,{adjustedWidth:a,adjustedHeight:b,needReposition:p}}},a.prototype.$T=function(){var a=this,b=a.BF;b&&f.GC$(b).unbind($.MGc)},a.prototype.tC=function(){var a=this,b=a.wT.WU;b.XU||(f.GC$(U).bind($.kHc+$.eHc,function(b){a.BD(b)}).bind($.lHc+$.eHc,function(b){a.CD(b)}),b.XU=!0)},a.prototype.uC=function(){var a=this.wT.WU;a.XU&&(a.XU=!1,f.GC$(U).unbind($.eHc))},a}(),b.GV=na,e.Zn(na),oa=function(){function a(a){var b=this;b.kj=a,b.WU={XU:!1,x:0,y:0,$U:h,H8J:-1},b.xT=h,b.bU=h,b.rV=h,b.sV=[],b.wTa=0,b.jT=[],b.tV(),b.uV(),b.xn={}}return a.prototype.getUsedRange=function(){var a,b,c,d,e,f=this,g=f.all(),h={};if(g)for(a=void 0,b=void 0,c=0,d=g;c<d.length;c++)e=d[c],a=e.nT,b=e.oT,W(h,{minRow:a,minCol:b,maxRow:a,maxCol:b});return h},a.prototype.dispose=function(a){var b=this,c=b.all();c.forEach(function(a){b.hT(a)}),b.Uka(),a!==!1&&(b.kj=h)},a.prototype.add=function(a,b,c){var d,e,g=this,i=g.kj,j=i.getSpan(a,b);return!j||j.row===a&&j.col===b?(d=g.get(a,b),e="string"==typeof c?new ha(c):c,g.Cz(a,b,e),i.Bq("comment",a,b,f.SheetArea.viewport,d,e),i.Wq(w.WorksheetDataChanged,{type:"comment"}),e):h},a.prototype.Cz=function(a,b,c,d){var e=this,f=e.kj,g=e.sV;e.vV(a,b),c&&(c.nT=a,c.oT=b,c.kj=f,g.push(c),c.mi=e.wTa,f.ITa.UUa({type:"add",row:a,col:b,comment:c}),e.wTa++,e.JUa(a,b,c),d||f.$p())},a.prototype.get=function(a,b){return this.xn[a+"_"+b]||h},a.prototype.JUa=function(a,b,c){this.xn[a+"_"+b]=c},a.prototype.VUa=function(a,b,c){var d=a.nT,e=a.oT;this.get(d,e)===a&&this.JUa(d,e,i),this.kj.ITa.UUa({type:"rowcol",comment:a,row:d,col:e,newRow:b,newCol:c}),a.nT=b,a.oT=c,this.JUa(b,c,a)},a.prototype.remove=function(a,b){var c=this,d=c.vV(a,b),e=c.kj;d&&(e.Bq(s,a,b,f.SheetArea.viewport,d,i),e.Wq(w.WorksheetDataChanged,{type:"comment"}),e.$p())},a.prototype.vV=function(a,b){var c,d=this,e=d.kj,f=d.get(a,b);return f&&(e.ITa.UUa({type:"remove",row:a,col:b,comment:f}),d.hT(f),r.Fb(d.sV,f),c=d.pT(f),c&&(na.ao(c,"dispose"),r.Fb(d.jT,c)),d.JUa(a,b,i)),f},a.prototype.clear=function(a){var b,c,d,e,f=this,g=f.kj,h=f.sV;for(g.suspendPaint(),b=h.length-1;b>=0;b--)c=h[b],d=c.nT,e=c.oT,(!a||d>=a.row&&d<a.row+a.rowCount&&e>=a.col&&e<a.col+a.colCount)&&f.remove(d,e);g.resumePaint()},a.prototype.all=function(){return this.sV.concat()},a.prototype.qUa=function(a,b,c,d,e,f){(a||d)&&(a&&this.VUa(a,e,f),d&&this.VUa(d,b,c))},a.prototype.getOuterContainer=function(a){var b=this.pT(a);return b?b.JT:h},a.prototype.tV=function(){var a=q($.cHc);f.GC$(a).addClass("gc-comment-editor").css($.rGc,0).css($.Lcc,0).css($.wGc,$.xGc).css("margin",0).css($.EGc,0).css("word-wrap","break-word").css("word-break","normal").css($.yGc,$.BGc).css("resize","none").css("outline","none").css("border","0px").css($.CGc,$.DGc).css($.gHc,"normal").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this.xT=a},a.prototype.uV=function(){var a=this,b=a.kj;b&&(b.Fu(w.ColumnChanged+$.HGc,function(b,c){var d=c.propertyName;d!==$.uGc&&"isVisible"!==d||a.wV()}),b.Fu(w.RowChanged+$.HGc,function(b,c){var d=c.propertyName;d!==$.vGc&&"isVisible"!==d||a.wV()}),b.Fu(w.ColumnWidthChanged+$.HGc,function(){a.wV()}),b.Fu(w.RowHeightChanged+$.HGc,function(){a.wV()}),b.Fu(w.CommentChanged+$.HGc,function(b,c){if(c){var d=c.propertyName,e=c.comment,f=a.pT(e);f&&("location"===d?f.fU():d!==$.uGc&&d!==$.vGc||f.gU())}}))},a.prototype.Uka=function(){var a=this,b=a.kj;b&&b.Gu($.HGc)},a.prototype.pT=function(a){var b,c,d=this,e=d.jT;if(a)for(b=0;b<e.length;b++)if(c=e[b],c.kT===a)return c;return h},a.prototype.iT=function(){return 0===this.sV.length},a.prototype.xV=function(){var a,b,c,d=this,e=d.sV;if(e.length>0){for(a=e[0].zIndex(),b=1;b<e.length;b++)c=e[b],a<c.zIndex()&&(a=c.zIndex());return a}return 0},a.prototype.rI=function(a,b){var c,d,e,f,g=this,h=g.sV,i=g.jT;for(c=0;c<h.length;c++)d=h[c],a<=d.nT&&g.VUa(d,d.nT+b,d.oT);for(e=0;e<i.length;e++)f=i[e],f.sU()&&f.rI(a,b)},a.prototype.tI=function(a,b){var c,d,e,f,g=this,h=g.sV,i=g.jT;for(c=0;c<h.length;c++)d=h[c],a<=d.oT&&g.VUa(d,d.nT,d.oT+b);for(e=0;e<i.length;e++)f=i[e],f.sU()&&f.tI(a,b)},a.prototype.GR=function(a,b){var c,d,e,f,g,h=this,i=h.sV,j=h.jT;for(c=i.length-1;c>=0;c--)d=i[c],e=d.nT,f=d.oT,e>=a&&e<a+b&&h.remove(e,f);for(c=0;c<i.length;c++)d=i[c],a<d.nT&&h.VUa(d,d.nT-b,d.oT);for(c=0;c<j.length;c++)g=j[c],g.sU()&&g.GR(a,b)},a.prototype.HR=function(a,b){var c,d,e,f,g,h=this,i=h.sV,j=h.jT;for(c=i.length-1;c>=0;c--)d=i[c],e=d.nT,f=d.oT,f>=a&&f<a+b&&h.remove(e,f);for(c=0;c<i.length;c++)d=i[c],a<d.oT&&h.VUa(d,d.nT,d.oT-b);for(c=0;c<j.length;c++)g=j[c],g.sU()&&g.HR(a,b)},a.prototype.JU=function(){return this.rV},a.prototype.GU=function(a){var b=this;a&&a!==b.rV&&(b.vQ(),b.rV=a)},a.prototype.vQ=function(){var a,b=this,c=b.rV;c&&(a=b.pT(c),!a||a.qS||a.kv||(a.ST()&&a.HU(),c.commentState(ea.normal),b.rV=h))},a.prototype.Ao=function(a){var b=this,c=b.pT(a);c||(c=new na(a,b),b.jT.push(c)),c.OT()},a.prototype.tT=function(a){var b=this,c=b.rV;if(c)if(1===c.displayMode()){if(c.commentState()===ea.edit)return}else if(c.commentState()===ea.edit||c.commentState()===ea.active)return;a!==b.bU&&(b.bU&&b.hT(b.bU),a&&2===a.displayMode()?b.WU.XU||a.yV||(b.bU=a,a.yV=V.setTimeout(function(){b.Ao(a)},200)):b.bU=h)},a.prototype.hT=function(a){var b=this,c=b.pT(a);c&&c.sU()&&(c.WT(),a===b.rV&&b.kj.GJ()),clearTimeout(a.yV),delete a.yV},a.prototype.zV=function(){var a=this.kj.nQ&&this.kj.nQ();a&&f.GC$(a.PT).show()},a.prototype.AV=function(){var a=this.kj.nQ&&this.kj.nQ();a&&f.GC$(a.PT).hide()},a.prototype.BV=function(a,b,c){var d,e=this.pT(a);return!(!e||!(d=e.dV()))&&d.contains(b,c)},a.prototype.CV=function(a,b,c){var d,e=this.pT(a);return!(!e||!(d=e.eV()))&&d.contains(b,c)},a.prototype.hitTest=function(a,b){var c,d,e=this,f=h;for(c=0;c<e.sV.length;c++)d=e.sV[c],xa(e.kj,d)&&e.BV(d,a,b)&&(f?d.zIndex()>f.zIndex()&&(f=d):f=d);return f?{x:a,y:b,comment:f,area:e.CV(f,a,b)?$.XGc:$.YGc}:h},a.prototype.KU=function(a){var b=this,c=b.xV();return a===b.bU?c+2:a===b.rV?c+1:a.zIndex()},a.prototype.wV=function(){this.jT.forEach(function(a){a.hU()})},a.prototype.fromJSON=function(a,b){var c,d,e,f=this;if(a&&0!==a.length){for(f.wTa=0,c=0;c<a.length;c++)d=a[c],e=new ha,e.fromJSON(d,b),3!==e.commentState()&&(f.rV=e),f.kj.ITa.Ky.Cz(e.nT,e.oT,e,!0);f.kj.$p()}},a.prototype.cdK=function(a,b,c,d){var e,g,h,i,j,k,l,m,n=this;if(a&&b){for(n.wTa=0,e=J(a,"commentList"),g=K(b,"shape"),e=e.c_,h=0;h<e.length;h++)i=e[h],j=new ha,k=j.nT=f.IndexHelper.P9(i.ref),l=j.oT=f.IndexHelper.Q9(i.ref),m=Ea(g,k,l),i.lossless&&(j.showShadow(i.lossless.showShadow),j.indicatorSize(i.lossless.indicatorSize),j.indicatorColor(i.lossless.indicatorColor),j.ignoreDefaultLocation(i.lossless.ignoreDefaultLocation)),j.cdK(n.kj,i,m,c,d),3!==j.commentState()&&(n.rV=j),n.kj.ITa.Ky.Cz(j.nT,j.oT,j,!0);n.kj.$p()}},a.prototype.toJSON=function(){var a,b,c=this.sV;if(!c||0===c.length)return i;for(a=[],b=0;b<c.length;b++)a.push(c[b].toJSON());return 0===a.length?i:a},a}(),pa=function(){function a(a){var b=this;b.kj=h,b.oQ=!0,b.PT=b.DV(),a.appendChild(b.PT)}return a.prototype.no=function(){this.kj=h},a.prototype.DV=function(){var a=q($.GGc);return f.GC$(a).addClass("gc-comment-layoutPanel"+$.UGc+$.TGc).css([$.wGc,$.rGc,$.Lcc,$.vGc,$.uGc,$.yGc,$.AGc,$.VGc],[$.xGc,0,0,0,0,$.zGc,$.RGc,$.WGc]),a},a.prototype.rT=function(a){var b,c,d,e=this;a.ITa.Ky.iT()||(b=a.am(),f.GC$(e.PT).css($.rGc,b.x+b.Br).css($.Lcc,b.y+b.Cr),e.kj!==a&&(e.kj&&(c=e.kj.ITa,d=c.Ky.JU(),d&&d.commentState()===ea.edit&&d.commentState(ea.active,!0)),e.kj=a))},a.prototype.sT=function(a,b,c){var d,e,g,h=c.row,i=c.col,j=c.x,k=c.y,l=wa(c),m=va(c),n=this;b===f.SheetArea.viewport&&n.kj&&(d=n.kj.ITa.Ky.get(h,i),d&&(e=this.kj,g=(d.indicatorSize()||6)*(e?e.zoom():1),a&&l>0&&m>0&&(a.save(),a.rect(j,k,l,m),a.clip(),a.fillStyle=d.indicatorColor()||"red",a.beginPath(),a.moveTo(j+l-g,k),a.lineTo(j+l,k),a.lineTo(j+l,k+g),a.lineTo(j+l-g,k),a.fill(),a.restore())))},a.prototype.fT=function(a){var b,c,d,e,f,g,i;if(!this.oQ)return void a.AV();for(a.zV(),b=this.kj,c=a.all(),d=0;d<c.length;d++)e=c[d],f=a.pT(e),this.EV(a,e)?(1===e.displayMode()&&e===a.bU&&(a.bU=h),f&&f.sU()?f.VT():a.Ao(e)):f&&f.sU()&&a.hT(e);g=a.JU(),g&&(i=a.pT(g),i&&i.sU()&&b.getSelections().length>0&&b.ITa.do("clearSelection"))},a.prototype.EV=function(a,b){var c=a.kj;if(c&&Qa(c,b.oT)&&Pa(c,b.nT))switch(b.displayMode()){case 1:return!0;case 2:if(3!==b.commentState())return a&&b!==a.bU&&(a.bU=b),!0;if(b===a.bU)return!0}return!1},a}(),qa=e.lUa,e.GC$.extend(qa.prototype,{UUa:function(a){var b,c=this.zTa;c&&(b=c.commentChanges,b||(b=c.commentChanges=[]),b.push(a))},aeK:function(a,b){var c,d,e,f,g,h,i=this,j=i.Ky;if(a)for(c=0;c<a.length;c++)d=a[c],e=d.comment,"add"===d.type?(f=new ha,f.fromJSON(e),e=f,e.commentState(3)):e=j.get(e.rowIndex,e.colIndex),"add"===d.type?j.Cz(d.row,d.col,e):"remove"===d.type?j.vV(d.row,d.col):"property"===d.type?(g=d.name,h=d.newValue,"commentState"!==g&&e[g](h)):"rowcol"===d.type&&j.VUa(e,d.newRow,d.newCol);else b&&"changeComment"===b.cmd&&"commentState"!==b.propertyName&&(e=j.get(b.row,b.col),e[b.propertyName](b.newValue))},XUa:function(a){var b,c,d,e,f,g,h;if(a)for(b=this,c=b.Ky,d=a.length-1;d>=0;d--)e=a[d],f=e.comment,"add"===e.type?c.vV(e.row,e.col):"remove"===e.type?c.Cz(e.row,e.col,e.comment):"property"===e.type?(g=e.name,h=e.value,f[g](h)):"rowcol"===e.type&&c.VUa(f,e.row,e.col)},wyb:function(a,b,c,d){var e,f,g=this;for(e=0;e<c;e++)for(f=0;f<d;f++)0===e&&0===f||g.getCell(a+e,b+f).comment()&&g.comments.remove(a+e,b+f)}}),qa.$n("comments",{init:function(){this.Ky=new oa(this.kj)},applyChanges:function(a){var b=this,c=a.command,d=a.changes,e=a.isUndo,f=d&&d.commentChanges;(f||c)&&(e?b.XUa(f):b.aeK(f,c))},undo:function(a){var b=a.commentChanges;b&&this.XUa(b)},dispose:function(a){var b=this,c=a&&a.clearCache;b.Ky&&b.Ky.dispose(c),c!==!1&&(b.Ky=h)}}),ra={getUsedRange:function(a){var b,c,d;a.type&f.UsedRangeType.comment&&(b=this,c=b.comments,d=c.getUsedRange(),W(a.range,d))},init:function(){var a=this;a.comments=a.ITa.Ky,a.nQ=function(){var b=a.parent;if(b)return b.gT||(b.gT=new pa(b.pZJ())),b.gT.kj=a,a.parent.gT}},dispose:function(a){a.clearCache!==!1&&(this.nQ=h,this.comments=h),da(this,f.GC$(this.Ws()))},setHost:function(a){if(a){var b=this.ITa.Ky;b&&b.uV(),ca(a,this)}},onLayoutChanged:function(a){var b=this,c=b.ITa.Ky,d=a.changeType,g=a.row,h=a.rowCount,i=a.col,j=a.colCount;"addRows"===d?c.rI(g,h):"deletingRows"===d?c.GR(g,h):"addColumns"===d?c.tI(i,j):"deletingColumns"===d?c.HR(i,j):a.sheetArea===f.SheetArea.viewport&&("clear"===d?4===(4&a.type)&&c.clear(new e.Range(g,i,h,j)):"addSpan"===d?La.call(b,!0,g,i,h,j):"removeSpan"===d&&La.call(b,!1,g,i))},paint:function(a){this.ITa.Ky.iT()||(Ma.call(this),this.RP(a.clipRect))},paintCell:function(a){a.isPrinting||a.sheetArea!==f.SheetArea.viewport||Na.call(this,a.ctx,a.sheetArea,a.cell)},toJson:function(a,b){var c=b&&b.ignoreStyle;c||(a.comments=this.ITa.Ky.toJSON())},fromJson:function(a,b,c){var d,e=c&&c.ignoreStyle;e||a&&(d=b?a.commentManager:a.comments,d&&this.ITa.Ky.fromJSON(d,b))},lastNonNullRowAndCol:function(){var a,b,c,d,e=0,f=0,g=this.ITa.Ky;if(g&&(a=g.jT,a&&a.length>0))for(b=0,c=a.length;b<c;b++)d=a[b],d&&d.kT&&(d.lT>e&&(e=d.lT),d.mT>f&&(f=d.mT));return{lastNonNullRow:e,lastNonNullCol:f}},clearSelection:function(){this.ITa.Ky.vQ()},processKeyDown:function(a){var b=this,c=b.ITa.Ky.JU();c&&b.mm.LH(a.e)&&ya(b,c)&&(c.commentState(2,!0),a.r=!0)},cdK:function(a,b,c){var d,e,g,h,i,j,k,l,m,n,o,p=J(a,"legacyDrawing"),q=a.rels,r=c&&c.includeStyles===!1;if(p&&!r){for(d=this,e=q.c_,g=p&&p["r:id"],i=0,j=e;i<j.length;i++)if(k=j[i],l=k.Target,l.indexOf(Z)>0){h=l.split("/").pop().slice(0,-4);break}m=f.Util.vhK(q,g,b),n=b.comments&&b.comments[h],o=d.comments,o.cdK(n,m,c,b)}},bdK:function(a,b,c){var d,e,g,h,i,j;!a||c&&c.includeStyles===!1||(d=a.rels,e=this.comments&&this.comments.all(),g=this.parent.kkK,d&&e&&e.length>0&&(h=R(d),i=X+h,j=this.VdK,d.c_.push({n_:Y,Id:i,Type:f.RelationshipConstants.C7,Target:"../"+f.XFileConstants.P8+j+"."+f.XFileConstants.r8}),f.Util.xhK(a,g)))}},f.Worksheet.$n("comments",ra),sa={init:function(){g.uT(this.commandManager())},dispose:function(){this.gT&&(this.gT.no(),this.gT=h)},bdK:function(a,b,c){var d,e,g,h,i,j,k,l,m,n,o,p=this,q=p.sheets;if(!c||c.includeStyles!==!1)for(d=0;d<q.length;d++)if(e=q[d],g=S(a,e.name()),h=e.comments,i=h&&h.all(),i&&i.length>0)for(j=f.Util.whK(a,g),j.c_.push({n_:"shapetype",id:"_x0000_t202",coordsize:"21600,21600",spt:"202",path:"m,l,21600r21600,l21600,xe",c_:[{n_:"stroke",joinstyle:"miter"},{n_:"path",gradientshapeok:"t","o:connecttype":"rect"}]}),k=a[Z+e.VdK]={n_:Z,r_:[13,14,15,16],c_:[{n_:"authors",c_:[{n_:"author",c_:["Author"]}]},{n_:"commentList",c_:[]}]},l=f.Util.zhK(e.VdK,j),m=0;m<i.length;m++)n=i[m],o=n.bdK(l),o.commentData&&(o.commentData.lossless={showShadow:n.showShadow(),indicatorSize:n.indicatorSize(),indicatorColor:n.indicatorColor(),ignoreDefaultLocation:n.ignoreDefaultLocation()}),l++,j.c_.push(o.vmlDrawingData),k.c_[1].c_.push(o.commentData)}};function _a(a,b){if(a){var c=a.trim().toLowerCase();if(["false"].indexOf(c)!==-1)return!1;if(["true"].indexOf(c)!==-1)return!0}return b}e.Workbook.$n("comments",sa)},"./dist/plugins/conditional/conditional.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/conditional/conditional.js")),d(c("./dist/plugins/conditional/conditional.ns.js"))},"./dist/plugins/conditional/conditional.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib,Jb,Kb,Lb,Mb,Nb=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("@grapecity/js-calc"),g=c("./dist/plugins/conditional/conditional.ns.js"),h=c("@grapecity/js-calc"),i=c("Core"),j=c("SheetsCalc"),k=c("./dist/plugins/conditional/conditionalFormatIcon.js"),l=i.UsedRangeUtil.SZJ,m=i.UsedRangeUtil.RZJ,n=i.XFileConstants.Xkb,o=i.XFileConstants.IbK,p=i.Util.WaK,q=d.Common.u.Kb,r=e.GC$,s=d.Common.u,t=null,u=void 0,v="undefined",w="string",x="true",y=Math.min,z=Math.max,A=Math.abs,B=Math.floor,C=Math.ceil,D=f.Convert,E=D.Na,F=D.Pa,G=D.Th,H=String.fromCharCode(32),I=String.fromCharCode(160),J=d.Common.u,K=J.Db,L=J.kb,M=J.jb,N=J.Bb,O=d.Common.j.Fa,P=d.Common.q,Q=d.Common.F,R=e.Ul,S=R.GcK,T=i.Ul.getFormulaString,U=R.naa,V=i.IndexHelper.R9,W=R.McK,X=R.PcK,Y=R.QcK,Z=R.JcK,$=R.UcK,_=R.oaa,aa=R.IcK,ba=R.LcK,ca=i.range_parser.CcK,da=i.range_parser.getRangeString,ea=e.Zn,fa=R.T$a,ga=R.XcK,ha=R.l_a,ia=!!f,ja=e.Style,ka=d.Common.pc,la=ka.bc,ma=e.kf,na=e.Range,oa=d.Common.l,pa=d.Common.k,qa=pa.Fb,ra=pa.Cb,sa=pa.ac,ta=f.Functions,ua=f.evaluateOperator,va=e.Rm,wa=i.Util.Tha,xa=Array.isArray,ya=new d.Common.ResourceManager(g.SR,"ConditionalFormatting"),za=ya.getResource.bind(ya),Aa=function(a){return/[\f\n\r\t\v]/.test(a)},Ba=function(a){var b=a.row<0?j.BAND_INDEX_CONST:a.row,c=a.col<0?j.BAND_INDEX_CONST:a.col;return h.uf(t,t,b,c,b+a.rowCount-1,c+a.colCount-1)},Ca=function(a){var b;if(a instanceof f.Expression)b=a;else if(a instanceof na)b=Ba(a);else{if(!E(a))throw za().Exp_NotSupport;a=F(a),isNaN(a)||(b=new f.Expression(2),b.value=a)}return b};function Ob(a){return a.rowCount}function Pb(a){return a.colCount}function Qb(a){return""===a.trim()}function Rb(a){return""===a}Da=function(a,b,c,d){var e=a,f=b,g=function(a,b){var g,h,i=this;return i.hasOwnProperty("_ps")||(i._ps={}),g=i._ps,0===arguments.length?g[e]!==u?d?d.call(i,g[e]):g[e]:f:(g[e]!==a&&(h=g[e]!==u?g[e]:f,g[e]=a,b!==!1&&c&&c.call(i,a,h)),i)};return g.isDefault=function(a){return a===f},g},Ea=function(a,b,c){var d=this;return c||(c={}),b||(b=d),O(d.pivotTableName)||(c.pivot=!0),r.each(b,function(b,e){var f,g,h=d[e];O(h)||(f=h.call(d),"formula"===e?(d.getFormulaString?f=d.getFormulaString(a,u,u,!0):d.condition()&&d.condition().getFormulaString&&(f=d.condition().getFormulaString(a,u,u,!0)),f&&(c[e]=f)):"style"===e&&xa(f)?(g=f.map(function(a){return a.toJSON()}),c[e]=g):"iconCriteria"===e||"icons"===e?c[e]=f:oa.Ska(f)?c[e]=oa.Daa(f):f&&f.toJSON?c[e]=f.toJSON(a):O(f)||h.isDefault(f)||(c[e]=f))}),c},Fa=function(a,c,d,e){if(d){var f=this,g;c||(c=f),r.each(c,function(c,h){var i,j,k,l,m,n,o,p,q,s,t;if(g=d[h],!O(g))if("ranges"===h){for(i=[],j=0;j<g.length;j++)k=g[j],i.push(ma(k.row,k.col,Ob(k),Pb(k)));f.ranges(i,!1)}else if("style"===h)xa(g)?(l=g.map(function(a){var b=new ja;return b.fromJSON(a,e),b}),f.style(l)):(f.style(new ja,!1),f.style().fromJSON(g,e));else if("iconCriteria"===h)for(m=g.length,n=0;n<m;n++)o=g[n],f.NV[n]=new Gb(o.isGreaterThanOrEqualTo,o.iconValueType,o.iconValue);else if("icons"===h)for(p=g.length,q=0;q<p;q++)s=g[q],f.CZa[q]={iconSetType:s.iconSetType,iconIndex:s.iconIndex};else"iconSetType"===h?f[h](g,!0):"item1"===h||"item2"===h?(f[h](b.$V(),!1),f[h]().fromJSON(g,a)):"expected"===h?r.getType(g)!==w||5!==d.conType&&13!==d.conType?f[h](g,!1):"/OADate("===g.substr(0,8)?f[h](oa.Rka(g),!1):f[h](new Date(g)):"condition"===h?(t=new qb,t.fromJSON(g,a),f.condition(t,!1)):r.getType(g)===w&&"/OADate("===g.substr(0,8)?f[h](oa.Rka(g),!1):f[h](g,!1)})}};function Sb(a,b,c,d){switch(d&&"string"==typeof b&&"string"==typeof c&&(b=b.toLowerCase(),c=c.toLowerCase()),a){case Ja.equalsTo:return b===c;case Ja.notEqualsTo:return b!==c;case Ja.greaterThan:return b>c;case Ja.greaterThanOrEqualsTo:return b>=c;case Ja.lessThan:return b<c;case Ja.lessThanOrEqualsTo:return b<=c;default:return!1}}Ga=e.lUa,r.extend(Ga.prototype,{YUa:function(a){var b,c=this,d=c.zTa;!d||!a&&d.originalConditionalRules||(b=c.U5.AW.map(function(a){return{rule:a,ranges:a.ranges().slice()}}),a?d.currentConditionalRules=b:d.originalConditionalRules=b)},$Ua:function(a){var b=this.U5,c=this.kj;c.suspendPaint(),a&&(0===a.length&&b.AW&&1===b.AW.length&&b.constructor.ao(c,"onRuleUpdated",{ranges:b.AW[0].ranges()}),b.AW=a.map(function(a){var d=a.rule,e=a.ranges;return"Object"===d.constructor.name&&(d=b.iga(a.rule,c,!1),e=e.map(function(a){return new na(a.row,a.col,a.rowCount,a.colCount)})),d.ranges(e),b.constructor.ao(c,"onRuleUpdated",{ranges:d.ranges()}),d}),b.QV()),c.resumePaint()},_Ua:function(a,b,c,d){this.YUa(),this.U5.rI(a,b,c,d),this.YUa(!0)},aVa:function(a,b,c,d){this.YUa(),this.U5.GR(a,b,c,d),this.YUa(!0)},bVa:function(a,b,c,d){this.YUa(),this.U5.tI(a,b,c,d),this.YUa(!0)},cVa:function(a,b,c,d){this.YUa(),this.U5.HR(a,b,c,d),this.YUa(!0)},dVa:function(){this.YUa(),this.U5.Nm(),this.YUa(!0)},eVa:function(){this.YUa(),this.U5.QV()}}),Ga.$n("conditionalFormat",{init:function(){this.U5=new Mb(this.kj)},applyChanges:function(a){var b,c=a.changes,d=a.isUndo;c&&(b=d?c.originalConditionalRules:c.currentConditionalRules,b&&this.$Ua(b))},undo:function(a){var b=a.originalConditionalRules;b&&this.$Ua(b)},dispose:function(a){var b=this,c=a&&a.clearCache;c!==!1&&b.U5&&(b.U5.no(),b.U5=t)}}),Ha={init:function(){this.conditionalFormats=this.ITa.U5},getUsedRange:function(a){var b,c,d;a.type&i.UsedRangeType.conditionFormat&&(b=this,c=b.conditionalFormats,d=c.getUsedRange(),l(a.range,d))},dispose:function(a){if(a.clearCache!==!1){var b=this.conditionalFormats;b&&b.OV()}},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=Ob(a),e=a.col,f=Pb(a),g=a.sheetArea,h=this.ITa,i=this.tables;"addRows"===b?h._Ua(c,d,i&&i.WFc(c,-1,d,-1,!0),!1):"deleteRows"===b?h.aVa(c,d):"addColumns"===b?h.bVa(e,f):"deleteColumns"===b?h.cVa(e,f):"clear"===b?h.dVa():"setColumnCount"!==b&&"setRowCount"!==b||3!==g&&1!==g||h.eVa()},toJson:function(a,b){var c=this.conditionalFormats,d=b&&b.ignoreStyle;c&&!d&&(a.conditionalFormats=c.toJSON(this))},fromJson:function(a,b,c){var d=c&&c.ignoreStyle;a&&a.conditionalFormats&&!d&&this.conditionalFormats.fromJSON(a.conditionalFormats,this,b,!0)},bdK:function(a,b,c){var d,e,f,g,h,k,l,m,o,p,q,r,s,t,u=this,v=c&&c.includeStyles===!1,w=u.conditionalFormats;if(!v&&w&&j&&!u.ODJ&&(d=w.AW,d&&d.length>0)){for(e=b.styleManager,f=a.c_,g=[],h=void 0,k=void 0,l=void 0,m=0,o=d.length;m<o;m++)p=d[m],q=p.ruleType(),r=!0,hc(p)||gc(p)?(g.push(p.beK()),hc(p)&&(r=!1)):q===Ia.formulaRule&&R.Rha(p.Yw,u.name(),u.parent&&u.parent.$dK())&&(h||(k=new i.SimpleSharedStrings,l=new i.SimpleSharedStrings,h=new i.SharedDxfs(k,l)),g.push(p.beK(h)),r=!1),ic(p)?(a.lossless||(a.lossless={}),a.lossless.stateRules||(a.lossless.stateRules=[]),a.lossless.stateRules.push(p.toJSON())):r&&f.push(p.bdK(e,void 0,void 0,c));g.length>0&&(s=Z(a,n),t={n_:"ext",r_:[1,3],c_:[{n_:"conditionalFormattings",c_:g}]},s.c_.push(t),h&&(s.lossless={sharedDxfs:h.ulK(),sharedColors:k.bdK(),commonSharedStrings:l.bdK()}))}},cdK:function(a,b,c){var d,e,f,g,h,k=this,l=c&&c.includeStyles===!1,m=this.conditionalFormats,p=m.AW,q=i.Util.alK(c);if(j&&m&&!l){for(d=W(a,o),e=Z(a,n),f=aa(e,"ext&conditionalFormattings"),g=b.styleManager,d&&d.length>0&&d.forEach(function(a){var d,e=i.NodeHelper.oca(a.pivot),f=ca(a.sqref,void 0,!0);q&&i.Util.JkK(k,f,!0,b),d=a.c_,d.forEach(function(a){var b=m.IlK(a,f,g,k,c);b&&(b.pivot=e,O(a.priority)||b.priority(+a.priority),p.push(b))})}),m.JlK(f,b,k,p,e,q),h=p.length-1;h>-1;h--)p[h].pivot&&p.splice(h,1);a.lossless&&a.lossless.stateRules&&a.lossless.stateRules.length>0&&a.lossless.stateRules.forEach(function(a){var b=new Lb;b.fromJSON(a,k),m.AW.push(b)}),m.Vgc=!cc(m.AW),m.QV()}}},e.Worksheet.$n("conditionalFormat",Ha),e.Workbook.$n("conditionalFormat",{fromJson:function(a,b,c){this.sheets.forEach(function(a){a.conditionalFormats&&a.conditionalFormats.getRules().forEach(function(a){a.S$a()})})},onCultureChanged:function(){za()}}),function(a){a[a.conditionRuleBase=0]="conditionRuleBase",a[a.cellValueRule=1]="cellValueRule",a[a.specificTextRule=2]="specificTextRule",a[a.formulaRule=3]="formulaRule",a[a.dateOccurringRule=4]="dateOccurringRule",a[a.top10Rule=5]="top10Rule",a[a.uniqueRule=6]="uniqueRule",a[a.duplicateRule=7]="duplicateRule",a[a.averageRule=8]="averageRule",a[a.twoScaleRule=10]="twoScaleRule",a[a.threeScaleRule=11]="threeScaleRule",a[a.dataBarRule=12]="dataBarRule",a[a.iconSetRule=13]="iconSetRule",a[a.rowStateRule=14]="rowStateRule",a[a.columnStateRule=15]="columnStateRule"}(Ia=b.RuleType||(b.RuleType={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.greaterThan=2]="greaterThan",a[a.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",a[a.lessThan=4]="lessThan",a[a.lessThanOrEqualsTo=5]="lessThanOrEqualsTo"}(Ja=b.GeneralComparisonOperators||(b.GeneralComparisonOperators={})),Ka=[9,10,13,14,11,12],function(a){a[a.or=0]="or",a[a.and=1]="and"}(La=b.LogicalOperators||(b.LogicalOperators={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.greaterThan=2]="greaterThan",a[a.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",a[a.lessThan=4]="lessThan",a[a.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",a[a.between=6]="between",a[a.notBetween=7]="notBetween"}(Ma=b.ComparisonOperators||(b.ComparisonOperators={})),function(a){a[a.contains=0]="contains",a[a.doesNotContain=1]="doesNotContain",a[a.beginsWith=2]="beginsWith",a[a.endsWith=3]="endsWith"}(Na=b.TextComparisonOperators||(b.TextComparisonOperators={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.beginsWith=2]="beginsWith",a[a.doesNotBeginWith=3]="doesNotBeginWith",a[a.endsWith=4]="endsWith",a[a.doesNotEndWith=5]="doesNotEndWith",a[a.contains=6]="contains",a[a.doesNotContain=7]="doesNotContain"}(Oa=b.TextCompareType||(b.TextCompareType={})),function(a){a[a.backgroundColor=0]="backgroundColor",a[a.foregroundColor=1]="foregroundColor"}(Pa=b.ColorCompareType||(b.ColorCompareType={})),function(a){a[a.empty=0]="empty",a[a.nonEmpty=1]="nonEmpty",a[a.error=2]="error",a[a.nonError=3]="nonError",a[a.formula=4]="formula"}(Qa=b.CustomValueType||(b.CustomValueType={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.before=2]="before",a[a.beforeEqualsTo=3]="beforeEqualsTo",a[a.after=4]="after",a[a.afterEqualsTo=5]="afterEqualsTo"}(Ra=b.DateCompareType||(b.DateCompareType={})),function(a){a[a.dateOccurring=0]="dateOccurring",a[a.yearOccurring=1]="yearOccurring",a[a.quarterOccurring=2]="quarterOccurring",a[a.monthOccurring=3]="monthOccurring",a[a.weekOccurring=4]="weekOccurring",a[a.dayOccurring=5]="dayOccurring",a[a.yearToDate=6]="yearToDate"}(Sa=b.DateExConditionExpectType||(b.DateExConditionExpectType={})),function(a){a[a.top=0]="top",a[a.bottom=1]="bottom"}(Ta=b.Top10ConditionType||(b.Top10ConditionType={})),function(a){a[a.today=0]="today",a[a.yesterday=1]="yesterday",a[a.tomorrow=2]="tomorrow",a[a.last7Days=3]="last7Days",a[a.thisMonth=4]="thisMonth",a[a.lastMonth=5]="lastMonth",a[a.nextMonth=6]="nextMonth",a[a.thisWeek=7]="thisWeek",a[a.lastWeek=8]="lastWeek",a[a.nextWeek=9]="nextWeek",a[a.nextQuarter=10]="nextQuarter",a[a.thisQuarter=11]="thisQuarter",a[a.lastQuarter=12]="lastQuarter",a[a.nextYear=13]="nextYear",a[a.thisYear=14]="thisYear",a[a.lastYear=15]="lastYear"}(Ua=b.DateOccurringType||(b.DateOccurringType={})),function(a){a[a.quarter1=0]="quarter1",a[a.quarter2=1]="quarter2",a[a.quarter3=2]="quarter3",a[a.quarter4=3]="quarter4"}(Va=b.QuarterType||(b.QuarterType={})),function(a){a[a.above=0]="above",a[a.below=1]="below",a[a.equalOrAbove=2]="equalOrAbove",a[a.equalOrBelow=3]="equalOrBelow",a[a.above1StdDev=4]="above1StdDev",a[a.below1StdDev=5]="below1StdDev",a[a.above2StdDev=6]="above2StdDev",a[a.below2StdDev=7]="below2StdDev",a[a.above3StdDev=8]="above3StdDev",a[a.below3StdDev=9]="below3StdDev"}(Wa=b.AverageConditionType||(b.AverageConditionType={})),function(a){a[a.number=0]="number",a[a.lowestValue=1]="lowestValue",a[a.highestValue=2]="highestValue",a[a.percent=3]="percent",a[a.percentile=4]="percentile",a[a.automin=5]="automin",a[a.formula=6]="formula",a[a.automax=7]="automax"}(Xa=b.ScaleValueType||(b.ScaleValueType={})),function(a){a[a.leftToRight=0]="leftToRight",a[a.rightToLeft=1]="rightToLeft"}(Ya=b.BarDirection||(b.BarDirection={})),function(a){a[a.automatic=0]="automatic",a[a.cellMidPoint=1]="cellMidPoint",a[a.none=2]="none"}(Za=b.DataBarAxisPosition||(b.DataBarAxisPosition={})),function(a){a[a.threeArrowsColored=0]="threeArrowsColored",a[a.threeArrowsGray=1]="threeArrowsGray",a[a.threeTriangles=2]="threeTriangles",a[a.threeStars=3]="threeStars",a[a.threeFlags=4]="threeFlags",a[a.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",a[a.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",a[a.threeSigns=7]="threeSigns",a[a.threeSymbolsCircled=8]="threeSymbolsCircled",a[a.threeSymbolsUncircled=9]="threeSymbolsUncircled",a[a.fourArrowsColored=10]="fourArrowsColored",a[a.fourArrowsGray=11]="fourArrowsGray",a[a.fourRedToBlack=12]="fourRedToBlack",a[a.fourRatings=13]="fourRatings",a[a.fourTrafficLights=14]="fourTrafficLights",a[a.fiveArrowsColored=15]="fiveArrowsColored",a[a.fiveArrowsGray=16]="fiveArrowsGray",a[a.fiveRatings=17]="fiveRatings",a[a.fiveQuarters=18]="fiveQuarters",a[a.fiveBoxes=19]="fiveBoxes",a[a.noIcons=20]="noIcons"}($a=b.IconSetType||(b.IconSetType={})),function(a){a[a.number=1]="number",a[a.percent=4]="percent",a[a.formula=7]="formula",a[a.percentile=5]="percentile"}(_a=b.IconValueType||(b.IconValueType={})),function(a){a[a.contains=0]="contains"}(ab||(ab={})),function(a){a[a.relationCondition=0]="relationCondition",a[a.numberCondition=1]="numberCondition",a[a.textCondition=2]="textCondition",a[a.colorCondition=3]="colorCondition",a[a.formulaCondition=4]="formulaCondition",a[a.dateCondition=5]="dateCondition",a[a.dateExCondition=6]="dateExCondition",a[a.textLengthCondition=7]="textLengthCondition",a[a.top10Condition=8]="top10Condition",a[a.uniqueCondition=9]="uniqueCondition",a[a.averageCondition=10]="averageCondition",a[a.cellValueCondition=11]="cellValueCondition",a[a.areaCondition=12]="areaCondition",a[a.timeCondition=13]="timeCondition",a[a.stateCondition=14]="stateCondition"}(bb=b.ConditionType||(b.ConditionType={})),function(a){a[a.automatic=0]="automatic",a[a.middle=1]="middle",a[a.none=2]="none"}(cb||(cb={})),db=function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0)},eb=function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,999)},fb=function(a,b){a.setDate(b)},gb=function(a){return a.getDate()},hb=function(a,b){return a.getFullYear()===b.getFullYear()&&a.getMonth()===b.getMonth()&&a.getDate()===b.getDate()},ib=function(a,b){var c=eb(a);return b>c},jb=function(a,b){return b>a},kb=function(a,b){var c=db(a);return b<c},lb=function(a,b){return b<a},mb=function(a,b){return a.getHours()===b.getHours()&&a.getMinutes()===b.getMinutes()&&a.getSeconds()===b.getSeconds()&&a.getMilliseconds()===b.getMilliseconds()},nb=function(a,b){var c=new Date(1899,11,30,a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()),d=new Date(1899,11,30,b.getHours(),b.getMinutes(),b.getSeconds(),b.getMilliseconds());return d>c},ob=function(a,b){return!nb(a,b)&&!mb(a,b)},b.$V=function(a,b,c,d,e,f,g,h,i){return new qb(a,{compareType:b,expected:c,formula:d,customValueType:e,type:f,ranges:g,item1:h,item2:i})},b.Cxb=new ja,pb=["conType","compareType","item1","item2","ignoreBlank","preciseCompareDate","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"];function Tb(a){var b={},c=D.Uh(a,b);return c?b.value:typeof a===w&&a.toLowerCase()===x}qb=function(){function a(a,b){var c,d;b||(b={}),c=b.formula,d=this,d.offsetRow=0,d.offsetCol=0,d.conType("string"==typeof a?bb[a]:a),O(b.compareType)||d.RV(b.compareType),O(b.expected)||d.expected(b.expected),O(c)||d.formula("string"==typeof c?K(r.trim(c),"="):c),O(b.item1)||d.item1(b.item1),O(b.item2)||d.item2(b.item2),O(b.customValueType)||d.customValueType(b.customValueType),O(b.type)||d.type(b.type),d.ranges(b.ranges),d.Lf=t,d.TV=t}return a.prototype.context=function(a){if(1===arguments.length){this.xc=a;var b=this.item1(),c=this.item2();b&&b.context&&b.context(a),c&&c.context&&c.context(a)}return this.xc},a.prototype.j_a=function(a){var b=this,c=b.item1(),d=b.item2();a?b.q$a=!0:b.p$a=!0,c&&c.j_a(a),d&&d.j_a(a)},a.prototype.k_a=function(){var a=this,b=a.item1(),c=a.item2();delete a.q$a,delete a.p$a,b&&b.k_a(),c&&c.k_a()},a.prototype.initExpression=function(a,b,c){var d,e,f,g,h,i=this.item1(),j=this.item2();i&&i.initExpression&&i.initExpression(),j&&j.initExpression&&j.initExpression(),a=a||this.xc,d=this.Yw,a&&d&&!this.Lf&&(this.ranges()?(e=ha(this.ranges()),b=e.r,c=e.c):(b=b||0,c=c||0),f=a.getCalcService(),g=a.yj(),f&&g&&(h=!1,this.q$a&&(h=!this.p$a),this.Lf=f.parse(g,d,b,c,!1,!0,h)))},a.prototype.expression=function(a,b,c,d){var e,f,g;return 1===arguments.length?(this.Lf=a,b=b||this.xc,a?b&&(this.ranges()?(e=ha(this.ranges()),c=e.r,d=e.c):(c=c||0,d=d||0),f=b.getCalcService(),g=b.yj(),f&&g&&(this.Yw=f.unparse(g,a,c,d))):this.Yw=a,this.Lf):(this.Lf||this.initExpression(b,c,d),this.Lf)},a.prototype.getFormulaString=function(a,b,c,d){var e,f,g;return a=a||this.xc,e=this.Lf,f=this.Yw,a&&f?(e||(this.initExpression(a,b,c),e=this.Lf),f&&(e.value&&14===e.value.type||e.value2&&14===e.value2.type)?f:(g=ha(this.ranges()),b=O(b)?g.r:b,c=O(c)?g.c:c,a.getCalcService().unparse(a.yj(),e,b,c,u,!!d))):f},a.prototype.formula=function(a,b,c){if("string"!=typeof a){var d=this.item1(),e=this.item2();return 0===c&&d&&d.formula?d.formula(a,b,c):1===c&&e&&e.formula?e.formula(a,b,c):this.getFormulaString(u,a,b);
}this.Yw=a,this.Lf=t},a.prototype.adjustOffset=function(a,b){var c=this,d=c.item1();d&&d.adjustOffset&&d.adjustOffset(a,b),d=c.item2(),d&&d.adjustOffset&&d.adjustOffset(a,b),c.offsetRow=a,c.offsetCol=b},a.prototype.relationConditionEvaluate=function(a,b,c,d,e){var f,g,h,i,j=this;function k(d,e){if(a&&d&&3===d.conType()){var f=a.getActualStyle(b,c,3,!0);f&&(0===d.RV()?e=f.backColor:1===d.RV()&&(e=f.foreColor))}return e}function l(a,b){if(a)return a.ignoreBlank(j.ignoreBlank()),arguments.length<5?k(a,d):b}function m(d,e){return!O(d)&&d.evaluate(a,b,c,e)}return f=l(j.item1(),d),g=l(j.item2(),e),h=m(j.item1(),f)?1:0,i=m(j.item2(),g)?1:0,h+i>j.RV()},a.prototype.cellValueConditionEvaluate=function(a,b,c,d){var e=this.getExpected(a,b,c);return!(e!==t||!a||!a.lRa)||this.cellValueConditionCheckCondition(e,d)},a.prototype.cellValueConditionCheckCondition=function(a,b){var c,d,e,f,g=this,h=0,i=!1,j=g.RV();if(O(b)&&O(a))switch(j){case Ja.equalsTo:case Ja.greaterThanOrEqualsTo:case Ja.lessThanOrEqualsTo:return!0;case Ja.notEqualsTo:case Ja.greaterThan:case Ja.lessThan:return!1;default:return!1}if("boolean"==typeof a||"boolean"==typeof b)return Sb(j,b,a);if(c={},O(b))g.treatNullValueAsZero()?i=!0:h=b;else{if(typeof b===w&&"number"==typeof a)return Sb(j,1,0);"boolean"!=typeof b&&G(b,c)&&(h=c.value,i=!isNaN(h))}return d=0,e=!1,("number"==typeof a||a&&"string"==typeof a&&!Qb(a))&&G(a,c)&&(d=c.value,e=!0),f=Ka[j],i?e?Sb(j,h,d):ua(f,b,a):"string"==typeof b?e?ua(f,b,d):"string"==typeof a?ua(f,b,a):1===j:!!O(b)&&j===Ja.notEqualsTo},a.prototype.numberConditionEvaluate=function(a,b,c,d){var e=this.numberConditionGetExpected(a,b,c);return!(e!==t||!a||!a.lRa)||(this.integerValue()&&(e=isNaN(e)?t:e>0?B(e):C(e)),this.numberConditionCheckCondition(e,d))},a.prototype.numberConditionCheckCondition=function(a,b){var c,d,e=this;if((O(b)||""===b)&&e.ignoreBlank())return!0;if(isNaN(b))return!1;if(O(a)){if(e.ignoreBlank())return!0;a=0}try{c=O(b)?0:parseFloat(b)}catch(a){return!1}return!(e.integerValue()&&(d=c-B(c)===0,!d))&&Sb(e.RV(),c,a)},a.prototype.numberConditionGetExpected=function(a,b,c){var d,e=this;return e.Yw&&e.Yw.length>0?(d=a.Cf(),d?d.evaluate(a.yj(),e.expression(t,a),b,c):e.expected()):e.expected()},a.prototype.textConditionEvaluate=function(a,b,c,d){var e,f,g,h=this,i=h.compareType(),j=h.ignoreCase();function k(a,b){return h.testTextByCondition(b,a,"^","$",function(){return j?a.toLowerCase()===b.toLowerCase():a===b})}function l(a,b){return h.testTextByCondition(b,a,"^","",function(){return L(b,a,j)})}function m(a,b){return h.testTextByCondition(b,a,"","$",function(){return M(b,a,j)})}function n(a,b){return h.testTextByCondition(b,a,"","",function(){return N(b,a===u||a===t?"":a,j)})}if(!h.forceValue2Text()&&Q(d,Date))return i!==Oa.beginsWith&&i!==Oa.endsWith&&i!==Oa.contains&&(i===Oa.doesNotBeginWith||i===Oa.doesNotEndWith||i===Oa.doesNotContain);if(e=O(d)?"":""+d,h.ignoreBlank()&&""===e)return!0;if(f=this.getExpected(a,b,c),g=O(f)?"":""+f,h.hasWildcard(g)&&"number"==typeof d)return i===Oa.doesNotBeginWith||i===Oa.doesNotContain||i===Oa.doesNotEndWith||i===Oa.notEqualsTo;switch(i){case Oa.equalsTo:return k(g,e);case Oa.notEqualsTo:return!k(g,e);case Oa.beginsWith:return l(g,e);case Oa.doesNotBeginWith:return!l(g,e);case Oa.endsWith:return m(g,e);case Oa.doesNotEndWith:return!m(g,e);case Oa.contains:return n(g,e);case Oa.doesNotContain:return!n(g,e);default:return!1}},a.prototype.hasWildcard=function(a){return a.indexOf("*")>-1||a.indexOf("?")>-1},a.prototype.testTextByCondition=function(a,b,c,d,e){var f,g=this.useWildCards();return g?this.regex()?P.qb(this.regex()).test(a):(f=P.ub(b))?(f=c+f+d,this.ignoreCase()?P.sb(f).test(a):P.qb(f).test(a)):e():e()},a.prototype.colorConditionEvaluate=function(a,b,c,e){var f,g,h,i;function j(a){return O(a)||""===a?t:ka.ec(a)}if(f=this,g=j(f.expected()),O(g)||""===g){if(f.ignoreBlank()||O(g)&&O(e))return!0}else if(h=j(e),(O(h)||""===h)&&a&&a.getDefaultStyle&&(i=a.getDefaultStyle(),f.RV()===Pa.backgroundColor?h=i.backColor:f.RV()===Pa.foregroundColor&&(h=i.foreColor)),!O(h)&&""!==h)return d.Common.pc.Pka(h,g);return!1},a.prototype.formulaConditionEvaluate=function(a,b,c,d){var e,f,g,h;if(!ia)return!1;if(e=this,e.customValueType()===Qa.formula)return f=e.xc&&e.xc.getDataSource&&e.xc.getDataSource(),f&&f.jFJ&&(a.yj().xc=f.jFJ(b)),g=e.getExpected(a,b,c),!(!e.ignoreBlank()||!O(g)&&""!==g)||Tb(g);switch(h=D.vf,e.customValueType()){case Qa.empty:return O(d)||""===d;case Qa.nonEmpty:return!O(d)&&""!==d;case Qa.error:return h(d);case Qa.nonError:return!h(d);default:return!1}},a.prototype.formulaConditionGetExpected=function(a,b,c){var d,e,f,g,i,j,k,l=this;if(l.Yw&&l.Yw.length>0){if(d=a.Cf(),!d)return l.expected();if(e=d.Hg(a.yj(),l.expression(u,a),h.pf(b,c),!0),f=void 0,g=void 0,i=void 0,j=void 0,k=void 0,D.Fh(e)){for(f=e.getRowCount(0),g=e.getColumnCount(0),i=[],j=0;j<f;j++)for(i[j]=[],k=0;k<g;k++)i[j][k]=e.getValue(0,j,k);e=i}else if(D.Ca(e)){for(f=e.getRowCount(),g=e.getColumnCount(),i=[],j=0;j<f;j++)for(i[j]=[],k=0;k<g;k++)i[j][k]=e.getValue(j,k);e=i}return Q(e,Array)?e[0][0]:e}return l.expected()},a.prototype.dateOrTimeEvaluate=function(a,b,c,d,e,f,g){var h,i,j,k=this;if((O(d)||""===d)&&k.ignoreBlank())return!0;if(h=d,!Q(d,Date)){if(k.RV()===Ra.notEqualsTo)return!0;if(!O(d))return!1;h=oa.Xb(0)}if(i=t,j=this.getExpected(a,b,c),Q(j,Date)?i=j:"string"==typeof j?i=oa.Qa(j):"number"==typeof j&&(i=oa.Xb(j)),O(i))return!!k.ignoreBlank();switch(k.RV()){case Ra.equalsTo:return e(i,h);case Ra.notEqualsTo:return!e(i,h);case Ra.after:return g(i,h);case Ra.afterEqualsTo:return g(i,h)||e(i,h);case Ra.before:return f(i,h);case Ra.beforeEqualsTo:return f(i,h)||e(i,h);default:return!1}},a.prototype.dateConditionEvaluate=function(a,b,c,d){var e=this.preciseCompareDate();return this.dateOrTimeEvaluate(a,b,c,d,hb,e?lb:kb,e?jb:ib)},a.prototype.timeConditionEvaluate=function(a,b,c,d){return this.dateOrTimeEvaluate(a,b,c,d,mb,ob,nb)},a.prototype.dateExConditionEvaluate=function(a,b,c,d){var e=this.A4(a,b,c);return!O(e)&&this.dateExConditionCheckCondition(e,d)},a.prototype.getExConditionDateScope=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=t,K=t,L=new Date,M=new Date(L.getFullYear(),L.getMonth(),L.getDate(),L.getHours(),L.getMinutes(),L.getSeconds(),L.getMilliseconds());switch(a){case Ua.last7Days:fb(M,gb(M)-6),J=db(M),K=eb(L);break;case Ua.yesterday:fb(M,gb(M)-1),J=db(M),K=eb(M);break;case Ua.today:J=db(L),K=eb(L);break;case Ua.tomorrow:fb(M,gb(M)+1),J=db(M),K=eb(M);break;case Ua.lastWeek:b=L,fb(b,gb(L)-L.getDay()-7),c=M,c.setDate(gb(M)-M.getDay()-1),J=db(b),K=eb(c);break;case Ua.thisWeek:d=L,fb(d,gb(L)-L.getDay()),e=M,fb(e,gb(M)-M.getDay()+6),J=db(d),K=eb(e);break;case Ua.nextWeek:f=L,fb(f,gb(L)-L.getDay()+7),g=M,fb(g,gb(M)-M.getDay()+13),J=db(f),K=eb(g);break;case Ua.lastMonth:h=L,fb(h,1),h.setMonth(L.getMonth()-1),i=M,fb(i,0),J=db(h),K=eb(i);break;case Ua.thisMonth:j=L,fb(j,1),k=M,fb(k,1),k.setMonth(M.getMonth()+1),fb(k,0),J=db(j),K=eb(k);break;case Ua.nextMonth:l=L,fb(l,1),l.setMonth(L.getMonth()+1),m=M,fb(m,1),m.setMonth(M.getMonth()+2),fb(m,0),J=db(l),K=eb(m);break;case Ua.nextQuarter:n=L,o=n.getMonth(),p=o%3,n.setDate(1),n.setMonth(o-p+3),q=M,r=void 0,q.setDate(1),q.setMonth(o-p+3+2),r=2===q.getMonth()||11===q.getMonth()?31:30,q.setDate(r),J=db(n),K=eb(q);break;case Ua.thisQuarter:s=L,u=s.getMonth(),v=u%3,s.setDate(1),s.setMonth(u-v),w=M,x=void 0,w.setDate(1),w.setMonth(u-v+2),x=2===w.getMonth()||11===w.getMonth()?31:30,w.setDate(x),J=db(s),K=eb(w);break;case Ua.lastQuarter:y=L,z=y.getMonth(),A=z%3,y.setDate(1),y.setMonth(z-A-3),B=M,C=void 0,B.setDate(1),B.setMonth(z-A-3+2),C=2===B.getMonth()||11===B.getMonth()?31:30,B.setDate(C),J=db(y),K=eb(B);break;case Ua.nextYear:D=L,D.setDate(1),D.setFullYear(D.getFullYear()+1),D.setMonth(0),E=M,E.setFullYear(E.getFullYear()+1),E.setMonth(11),E.setDate(31),J=db(D),K=eb(E);break;case Ua.thisYear:F=L,F.setDate(1),F.setMonth(0),G=M,G.setMonth(11),G.setDate(31),J=db(F),K=eb(G);break;case Ua.lastYear:H=L,H.setFullYear(H.getFullYear()-1),H.setDate(1),H.setMonth(0),I=M,I.setFullYear(I.getFullYear()-1),I.setMonth(11),I.setDate(31),J=db(H),K=eb(I)}return{from:J,to:K}},a.prototype.dateExConditionCheckCondition=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o;function p(a,b){switch(a){case Va.quarter1:return b.getMonth()>=0&&b.getMonth()<=2;case Va.quarter2:return b.getMonth()>=3&&b.getMonth()<=5;case Va.quarter3:return b.getMonth()>=6&&b.getMonth()<=8;case Va.quarter4:return b.getMonth()>=9&&b.getMonth()<=11;default:return!1}}if(d=this,e=c,d.ignoreBlank()&&(O(e)||""===e))return!0;try{if(O(e)&&!d.treatNullValueAsZero())return!1;e=D.Wh(e)}catch(a){return!1}if(g=d.expectTypeId(),g===Sa.dateOccurring){if(h=this.getExConditionDateScope(a),i=h.from,j=h.to,!O(i)&&!O(j))return k=b.$V(bb.dateCondition,Ra.afterEqualsTo,i,t),l=b.$V(bb.dateCondition,Ra.beforeEqualsTo,j,t),m=b.$V(bb.relationCondition,La.and,t,t,t,t,t,k,l),m.evaluate(t,0,0,e)}else if(f=d.A4(t,0,0),!O(f)){if(g===Sa.yearOccurring)return f===e.getFullYear();if(g===Sa.quarterOccurring)return p(f,e);if(g===Sa.monthOccurring)return f===e.getMonth();if(g===Sa.weekOccurring)return f===e.getDay();if(g===Sa.dayOccurring)return f===gb(e);if(g===Sa.yearToDate)return n=new Date,o=new Date,n.setMonth(0,1),n.setHours(0,0,0,0),o.setHours(23,59,59,999),n<=e&&e<=o}return!1},a.prototype.textLengthConditionEvaluate=function(a,b,c,d){var e,f;return!(!O(d)&&""!==d||!this.ignoreBlank())||(e=O(d)?0:(""+d).length,f=this.A4(a,b,c),"number"==typeof f&&Sb(this.RV(),e,f))},a.prototype.top10ConditionEvaluate=function(a,b,c,d){var e,f,g,h=this;if(O(d)||""===d)return h.ignoreBlank();if(e=h.A4(a,b,c),!O(e)&&(f=void 0,h.k$a?(O(h.mxb)&&(h.mxb=h.getTopValues(a,e,h.ranges())),f=h.mxb):f=h.getTopValues(a,e,h.ranges()),f)){g=0;try{g=h.Pa(d)}catch(a){return!1}if(pa.Bb(f,g))return!0}return!1},a.prototype.A4=function(a,b,c){var d=this.getExpected(a,b,c);return d=parseInt(d,10),isNaN(d)||!isFinite(d)?t:d},a.prototype.adjustRange=function(a,b){return ma(a.row,a.col,Math.min(Ob(a),b.getRowCount()),Math.min(Pb(a),b.getColumnCount()))},a.prototype.getTopValues=function(a,b,c){var d,e,f,g,h,i,j,k,l,m=0===this.type()?1:-1,n=[];if(!c)return n;for(d=this.UV(a,c),e=sa(d),j=0;j<e;j++)for(f=this.adjustRange(d[j],a),k=0;k<Ob(f);k++)for(g=k+f.row,l=0;l<Pb(f);l++)h=l+f.col,i=this.Pa(a.getValue(g,h)),O(i)||n.push(i);return n.sort(function(a,b){return(b-a)*m}),sa(n)>b&&(n=n.slice(0,b)),n},a.prototype.Pa=function(a){return("number"==typeof a||Q(a,Date))&&ia?F(a):t},a.prototype.uniqueConditionEvaluate=function(a,b,c,d){var e,f,g,h,j=this,k=d;return O(k)||""===k?j.ignoreBlank():(ia&&E(k)&&!Aa(k)&&!i.Ul.isInfinityNumberString(k)&&(k=F(k)),e=this.getExpected(a,b,c),f={},D.Uh(e,f),g=f.value,!O(g)&&(h=j.duplicatedArrayCached||j.getDuplicated(a,j.ranges()),!O(h)&&pa.Bb(h,k)?g===!0:g!==!0))},a.prototype.getDuplicated=function(a,b){var c,d,e,f,g,h,j,k,l,m,n,o=[],p={},q=this.UV(a,b);if(q)for(c=sa(q),d=0;d<c;d++)for(e=q[d],e=this.adjustRange(e,a),f=Ob(e),g=Pb(e),h=0;h<f;h++)for(j=h+e.row,k=0;k<g;k++)l=k+e.col,m=a.getValue(j,l,3),O(m)||!ia||!E(m)||Aa(m)||i.Ul.isInfinityNumberString(m)||(m=F(m)),n=p[m],n?1===n&&o.push(m):p[m]=1;return o},a.prototype.VV=function(a,b){var c,d=a.length;for(c=0;c<d;c++)if(a[c].key===b)return!0;return!1},a.prototype.averageConditionEvaluate=function(a,b,c,d){var e,f,g,h,i,j,k,l;if(!ia)return!1;if(e=this,e.ignoreBlank()&&(O(d)||""===d))return!0;if(e.WV(),e.k$a?(O(e.mxb)&&(e.mxb=e.getExpected(a,b,c)),f=e.mxb):f=e.getExpected(a,b,c),g={},h=G(f,g)?g.value:NaN,i=t,j=e.TV?e.XV(a,e.TV,b,c):t,O(j)||(g={},i=G(j,g)?g.value:NaN),E(d)&&(k=F(d),!isNaN(h)))switch(l=isNaN(i),e.type()){case Wa.above:return k>h;case Wa.below:return k<h;case Wa.equalOrAbove:return k>=h;case Wa.equalOrBelow:return k<=h;case Wa.above1StdDev:return!l&&k>h+i;case Wa.below1StdDev:return!l&&k<h-i;case Wa.above2StdDev:return!l&&k>h+2*i;case Wa.below2StdDev:return!l&&k<h-2*i;case Wa.above3StdDev:return!l&&k>h+3*i;case Wa.below3StdDev:return!l&&k<h-3*i;default:return!1}return!1},a.prototype.WV=function(){var a=this;a.ranges()&&(a.Lf=a.YV("AVERAGE",a.ranges()),a.type()>=4&&a.type()<=9&&(a.TV=a.YV("STDEV",a.ranges())))},a.prototype.YV=function(a,b){var c,d,e,g;if(!ia)return t;if(c=ta.findGlobalFunction(a)){for(d=[],e=sa(b),g=0;g<e;g++)d[g]=Ca(b[g]);return f.Jh(c,d)}return t},a.prototype.averageConditionGetExpected=function(a,b,c){var d=a.Cf();return d?d.Hg(a.yj(),this.expression(u,a),h.pf(b,c),!1):t},a.prototype.nxb=function(){var a=this.conType();a!==bb.averageCondition&&a!==bb.top10Condition||(this.k$a=!0)},a.prototype.oxb=function(){var a=this;a.k$a=!1,a.mxb=u},a.prototype.XV=function(a,b,c,d){var e=a.Cf();return e?e.Hg(a.yj(),b,h.pf(c,d),!1):t},a.prototype.ZV=function(a,b){var c,d;for(d=0;d<sa(b);d++)c=b[d],Q(c,Array)&&sa(c)>0?sa(b)>1?a.push(c[0]):a.push.apply(a,c):a.push(c)},a.prototype.getValidList=function(a,b,c){var d,e,f=[],g=this.getValidListImp(a,b,c);for(d=0,e=sa(g);d<e;d++)f.push(g[d].value);return f},a.prototype.cJc=function(){return this.Yw&&this.Yw.length>0},a.prototype.getValidListImp=function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=[];if(l.Yw&&l.Yw.length>0)d=l.getExpected(a,b,c),Q(d,Array)?l.ZV(m,d):m.push(d);else if(l.expected()&&l.expected().length>0&&(e=l.expected(),f=e.replace(/\\,/g,String.fromCharCode(206)),g=f.split(",")))for(h=0;h<sa(g);h++)i=g[h],O(i)||(j=RegExp(String.fromCharCode(206),"g"),k=r.trim(i).replace(j,","),""!==k&&m.push({text:k,value:k}));return m},a.prototype.areaConditionEvaluate=function(a,b,c,d){var e,f,g,h,i,j;function k(a,b,c){return Q(a,Date)&&Q(b,Date)?a.valueOf()===b.valueOf():c||"string"!=typeof a||"string"!=typeof b?a===b:a.toLowerCase()===b.toLowerCase()}if(e=this,O(d)||""===d)return e.ignoreBlank()===!0;for(f=e.getValidList(a,b,c),g=0;g<sa(f);g++){if(h=f[g],O(h)&&O(d))return!0;if(e.Yw){if(k(h,d,!1))return!0}else if(i=a.getActualStyle(b,c,3,!0),j=R.ul(i,h,!0),k(j,d,!0))return!0}return!1},a.prototype.areaConditionGetExpected=function(a,b,c){var d,e,f,g,i,j,k,l,m,n,o,p,q,r=this,s=[];if(r.Yw){if(d=void 0,e=void 0,f=void 0,g=void 0,i=void 0,j=void 0,k=a.Cf(),!k)return s;if(l=k.Hg(a.yj(),r.expression(u,a),h.pf(b,c),!0),D.Fh(l))for(d=l.getRowCount(0),e=l.getColumnCount(0),m=l.getRow(0),n=l.getColumn(0),o=l.xf&&l.xf.kj,o&&(o.CkK&&o.CkK(),p=o.getRowCount(),q=o.getColumnCount(),d=d>p?z(p-m,0):d,e=e>q?z(q-n,0):e),f=0;f<d;f++)for(s[f]=[],g=0;g<e;g++)i=l.getValue(0,f,g),j=o?o.getText(m+f,n+g):i,s[f][g]={value:i,text:j};else if(D.Ca(l))for(d=l.getRowCount(),e=l.getColumnCount(),f=0;f<d;f++)for(s[f]=[],g=0;g<e;g++)i=l.getValue(f,g),s[f][g]={value:i,text:i}}else s.push({value:r.expected(),text:r.expected()});return s},a.prototype.stateConditionEvaluate=function(a,b,c,d){var e=this.expected();return!(O(d)||O(e)||isNaN(d)||isNaN(d))&&(d&e)>0},a.prototype.reset=function(){var a=this;switch(a.ignoreBlank(!1),a.preciseCompareDate(!1),a.RV(1),a.item1(t),a.item2(t),a.value1=t,a.value2=t,a.expected(t),a.RV(0),a.integerValue(!1),a.operator=0,a.text="",a.RV(0),a.useWildCards(!0),a.ignoreCase(!1),a.forceValue2Text(!1),a.customValueType(0),a.Lf=t,a.type(0),this.expectTypeId(0),a.ranges(t),a.isPercent(!1),a.regex(t),a.conType()){case bb.relationCondition:a.ignoreBlank(!1),a.RV(1);break;case bb.numberCondition:a.RV(0),a.integerValue(!1);break;case bb.textCondition:a.RV(0),a.useWildCards(!0),a.forceValue2Text(!1);break;case bb.colorCondition:a.RV(0);break;case bb.formulaCondition:a.customValueType(0),a.TV=t;break;case bb.dateCondition:case bb.timeCondition:a.RV(0);break;case bb.dateExCondition:a.expectTypeId(0);break;case bb.textLengthCondition:a.RV(0);break;case bb.top10Condition:a.type(0);break;case bb.averageCondition:a.type(0);break;case bb.cellValueCondition:a.operator=6;break;case bb.areaCondition:}},a.prototype.evaluate=function(a,b,c,d){var e=this.conType();return!O(e)&&this[bb[e]+"Evaluate"](a,b,c,d)},a.prototype.getExpectedNormal=function(a,b,c,d,e,f){var g,i=this,j=i.Yw,k=i.expected();return j?(g=a.Cf(),g?g.Hg(a.yj(),i.expression(u,a),h.pf(b,c),!1,f):k):k},a.prototype.getExpected=function(a,b,c){var d=this;switch(d.conType()){case 2:return d.getExpectedNormal(a,b,c,b-d.offsetRow,c-d.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:case 13:return d.getExpectedNormal(a,b,c,b-d.offsetRow,c-d.offsetCol,!1);case 8:return d.getExpectedNormal(a,b,c,b,c);case 0:return t;case 1:return d.numberConditionGetExpected(a,b,c);case 3:return t;case 4:return d.formulaConditionGetExpected(a,b,c);case 10:return d.averageConditionGetExpected(a,b,c);case 12:return d.areaConditionGetExpected(a,b,c);default:return t}},a.prototype.UV=function(a,b){var c,d,e,f=[];for(c=0,d=sa(b);c<d;c++)e=a.Tq(b[c]),f.push(e);return f},a.prototype.getExpressions=function(){var a=[],b=this;return 0===b.conType()?(b.item1()&&b.item1().getExpressions&&(a=b.item1().getExpressions()),b.item2()&&b.item2().getExpressions&&(a=a.concat(b.item2().getExpressions())),a):(b.Lf||b.initExpression(),b.Lf?[b.Lf]:[])},a.prototype.setExpressions=function(a,b){var c=this,d;return b&&b.push({type:"condition",condition:this,expressions:c.getExpressions(),newExpressions:a}),0===c.conType()?(c.item1()&&c.item1().setExpressions&&(d=c.item1().getExpressions().length,c.item1().setExpressions(a.slice(0,d))),void(c.item2()&&c.item2().setExpressions&&c.item2().setExpressions(a.slice(d)))):void c.expression(a[0])},a.prototype.toJSON=function(a){var b=Ea.call(this,a,pb);return b.ignoreBlank&&!isNaN(b.ignoreBlank)&&(b.ignoreBlank=0!==parseInt(b.ignoreBlank,10)),b},a.prototype.fromJSON=function(a,b,c){var d,e;a&&(d=this,Fa.call(d,b,pb,a,c),e=b&&b.Wu&&b.Wu.useR1C1,e&&b instanceof i.Worksheet&&(d.context(b),fa(d)),d.j_a(!0),d.initExpression(),d.k_a())},a.fromSource=function(a){return b.$V(12,t,a,t)},a.fromFormula=function(a){return b.$V(12,t,"",a)},a.fromDay=function(a){var c=b.$V(6,t,a);return c.expectTypeId(5),c},a.fromMonth=function(a){var c=b.$V(6,t,a);return c.expectTypeId(3),c},a.fromQuarter=function(a){var c=b.$V(6,t,a);return c.expectTypeId(2),c},a.fromWeek=function(a){var c=b.$V(6,t,a);return c.expectTypeId(4),c},a.fromYear=function(a){var c=b.$V(6,t,a);return c.expectTypeId(1),c},a}(),b.Condition=qb,qb.prototype.conType=Da("conType",t),qb.prototype.ranges=Da("ranges",t,function(a){var b=this.item1(),c=this.item2();b&&b.ranges&&b.ranges(a),c&&c.ranges&&c.ranges(a)}),qb.prototype.ignoreBlank=Da("ignoreBlank",!1),qb.prototype.preciseCompareDate=Da("preciseCompareDate",!1),qb.prototype.compareType=Da("compareType",u),qb.prototype.RV=qb.prototype.compareType,qb.prototype.expected=Da("expected",u),qb.prototype.item1=Da("item1",t),qb.prototype.item2=Da("item2",t),qb.prototype.treatNullValueAsZero=Da("treatNullValueAsZero",!1),qb.prototype.integerValue=Da("integerValue",!1),qb.prototype.forceValue2Text=Da("forceValue2Text",!1),qb.prototype.useWildCards=Da("useWildCards",!0),qb.prototype.regex=Da("regex",t),qb.prototype.ignoreCase=Da("ignoreCase",!1),qb.prototype.customValueType=Da("customValueType",u),qb.prototype.expectTypeId=Da("expectTypeId",0),qb.prototype.type=Da("type",t),qb.prototype.isPercent=Da("isPercent",!1);function Ub(a,b,c,d,e,f,g,h,i){var j=Math.round;switch(a.lineWidth=1,a.rect(f,g,h,i),c++,c=j(c),d=j(d),a.clip(),b.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:k.drawArrows(a,b.iconSetType,b.iconIndex,c,d,e);break;case 2:k.drawIconTypeIsTwo(a,b.iconSetType,b.iconIndex,c,d,e);break;case 3:k.drawStar(a,b.iconSetType,b.iconIndex,c,d,e);break;case 14:case 12:case 5:k.drawCircle(a,b.iconSetType,b.iconIndex,c,d,e);break;case 4:k.drawFlag(a,b.iconSetType,b.iconIndex,c,d,e);break;case 6:k.drawTrafficLight(a,b.iconSetType,b.iconIndex,c,d,e);break;case 7:k.drawIconTypeIsSen(a,b.iconSetType,b.iconIndex,c,d,e);break;case 8:k.drawIconTypeIsEight(a,b.iconSetType,b.iconIndex,c,d,e);break;case 9:k.drawIconTypeIsNine(a,b.iconSetType,b.iconIndex,c,d,e);break;case 18:k.drawSector(a,b.iconSetType,b.iconIndex,c,d,e);break;case 17:case 13:k.drawSignal(a,b.iconSetType,b.iconIndex,c,d,e);break;case 19:k.drawMagicCube(a,b.iconSetType,b.iconIndex,c,d,e)}}function Vb(a,b,c){var d=[],e=a.row,f=a.rowCount,g=a.col,h=a.col+a.colCount-1;return g<b?b<=h&&h<=c?(d[0]=ma(e,g,f,b-g),d[1]=ma(e,b,f,h-b+1)):h>c&&(d[0]=ma(e,g,f,b-g),d[1]=ma(e,b,f,c-b+1),d[2]=ma(e,c+1,f,h-c)):g<=c&&(b<=h&&h<=c?d[1]=a:h>c&&(d[1]=ma(e,g,f,c-g+1),d[2]=ma(e,c+1,f,h-c))),d}function Wb(a,b,c){var d=[],e=a.col,f=a.colCount,g=a.row,h=a.row+a.rowCount-1;return g<b?b<=h&&h<=c?(d[0]=ma(g,e,b-g,f),d[1]=ma(b,e,h-b+1,f)):h>c&&(d[0]=ma(g,e,b-g,f),d[1]=ma(b,e,c-b+1,f),d[2]=ma(c+1,e,h-c,f)):g<=c&&(b<=h&&h<=c?d[1]=a:h>c&&(d[1]=ma(g,e,c-g+1,f),d[2]=ma(c+1,e,h-c,f))),d}rb=function(){function a(a,b,c){var d=this;d.xyb=!0,d.ruleType(a),d.style(b),d.ranges(c)}return a.prototype.stopIfTrue=function(a){},a.prototype.evaluate=function(a,c,d,e){var f,g,h,i,j=this,k=j.V4J(c,d);return j.pu(k)?(j.initCondition(),f={baseRow:0,baseCol:0},j.getBaseCoordinate(f),j.condition().adjustOffset(c-f.baseRow,d-f.baseCol),g=t,h=D.vf,i=j.condition().evaluate(a,c,d,e),i&&!h(i)&&(g=j.getExpected(k)||b.Cxb),j.condition().adjustOffset(0,0),g):t},a.prototype.V4J=function(a,b){return this.contains(a,b)},a.prototype.pu=function(a){return a},a.prototype.contains=function(a,b){var c,d,e,f=this.ranges();if(f)for(c=sa(f),d=void 0,e=0;e<c;e++)if(d=f[e],d.contains(a,b))return!0;return!1},a.prototype.createCondition=function(){return this.xyb=!1,null},a.prototype.initCondition=function(a){var b=this.condition();b||(b=this.createCondition(),b&&(b.ranges(this.ranges()),this.condition(b)),a&&this.context(a),this.context()&&b&&b.context(this.context()))},a.prototype.yyb=function(){var a,b=this;b.xyb&&(a=b.condition(),a||(b.initCondition(),a=b.condition()),a&&!a.Lf&&a.initExpression())},a.prototype.context=function(a){return 1===arguments.length&&(this.xc=a,this.condition()&&this.condition().context(a)),this.xc},a.prototype.getExpected=function(a){return this.style()},a.prototype.reset=function(){var a=this;a.ranges(t),a.condition(t),a.style(t),a.stopIfTrue(!1),a.priority(1)},a.prototype.intersects=function(a,b,c,d){var e,f,g,h=this.ranges();if(h)for(e=sa(h),f=void 0,g=0;g<e;g++)if(f=h[g],f.intersect(a,b,c,d))return!0;return!1},a.prototype.isScaleRule=function(){return!1},a.prototype.isStateRule=function(){return!1},a.prototype.getBaseCoordinate=function(a){var b,c,d,e,f;if(a.baseRow=Number.MAX_VALUE,a.baseCol=Number.MAX_VALUE,b=this,b.ranges()&&sa(b.ranges())>0)for(c=0;c<sa(b.ranges());c++)d=b.ranges()[c],e=d.row,f=d.col,e=e===-1?0:e,f=f===-1?0:f,a.baseRow=y(e,a.baseRow),a.baseCol=y(f,a.baseCol);else a.baseRow=0,a.baseCol=0},a.prototype.cPJ=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this,p=!1;if(o.yyb(),d=o.ranges())for(e=sa(d),f=0;f<e;f++)g=d[f],h=g.row,i=Ob(g),j=g.col,k=Pb(g),l=h===a.row&&i===a.rowCount&&a.col<=j&&k<=a.colCount,m=h===b.row&&i===b.rowCount&&b.col<=j&&k<=b.colCount,n=l||m,n&&(d[f]=ma(h,j,i+c,k),p=!0);return p},a.prototype._V=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=this,A=c?b:0,B=c?0:b;if(z.yyb(),f=z.ranges()){for(g=[],h=sa(f),i=0;i<h;i++)if(j=f[i],k=c?j.row:j.col,l=c?Ob(j):Pb(j),k!==-1){if(d&&d.length>0){for(m=!1,n=0,o=d.length;n<o;n++)if(p=d[n],p&&(q=!c&&p.col===a&&p.col===j.col&&p.colCount-b===j.colCount,r=!c&&p.col===a&&p.row===j.row&&p.rowCount===j.rowCount&&j.col>=p.col&&j.col+j.colCount<=p.col+p.colCount,s=c&&p.row===a&&p.row===j.row&&p.rowCount-b===j.rowCount,q||r||s)){f[i]=ma(j.row,j.col,Ob(j)+A,Pb(j)+B),m=!0;break}if(m)break}if(t=j,u=e&&d&&d[0]){if(v=c?Vb(j,u.col,u.col+u.colCount-1):Wb(j,u.row,u.row+u.rowCount-1),v[0]&&g.push(v[0]),v[2]&&g.push(v[2]),!v[1])continue;t=v[1]}k>=a?f[i]=ma(t.row+A,t.col+B,Ob(t),Pb(t)):a<=k+l&&(f[i]=ma(t.row,t.col,Ob(t)+A,Pb(t)+B))}for(w=0,x=g;w<x.length;w++)y=x[w],f.push(y)}},a.prototype.rI=function(a,b,c,d){this._V(a,b,!0,c,d)},a.prototype.tI=function(a,b,c,d){this._V(a,b,!1,c,d)},a.prototype.aW=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this,z=c?a:0,A=c?0:a,B=c?b:0,C=c?0:b;if(x.yyb(),f=x.ranges()){for(g=[],h=[],i=sa(f),j=0;j<i;j++)if(k=f[j],l=c?k.row:k.col,m=c?Ob(k):Pb(k),l!==-1){if(n=k,o=e&&d&&d[0]){if(p=c?Vb(k,o.col,o.col+o.colCount-1):Wb(k,o.row,o.row+o.rowCount-1),p[0]&&g.push(p[0]),p[2]&&g.push(p[2]),!p[1])continue;n=p[1]}l>a?l+m<=a+b?h.push(n):f[j]=ma(n.row-B,n.col-C,Ob(n),Pb(n)):a<l+m&&(q=ma(n.row,n.col,Ob(n)-y(n.row+Ob(n)-z,B),Pb(n)-y(n.col+Pb(n)-A,C)),0===Pb(q)||0===Ob(q)?h.push(n):f[j]=q)}for(r=0,s=g;r<s.length;r++)t=s[r],f.push(t);for(u=sa(h),v=0;v<u;v++)w=h[v],qa(f,w)}},a.prototype.GR=function(a,b,c,d){this.aW(a,b,!0,c,d)},a.prototype.HR=function(a,b,c,d){this.aW(a,b,!1,c,d)},a.prototype.toJSON=function(a){return Ea.call(this,a)},a.prototype.fromJSON=function(a,b,c){a&&(Fa.call(this,b,t,a,c),this.initCondition(b))},a.prototype.S$a=function(){var a=this.condition();a&&fa(a)},a.prototype.iW=function(){var a,b,c,d=this.cW,e=this.ranges();if(!d)return this.cW=dc(e),!1;if(a=sa(d),b=sa(e),a!==b)return!0;for(c=0;c<b;c++)if(!d[c].equals(e[c]))return!0;return!1},a}(),b.ConditionRuleBase=rb,sb=rb.prototype,sb.ruleType=Da("ruleType",t),sb.ranges=Da("ranges",t,function(a){var b,c=this.condition();c&&c.ranges()&&(b=c.xc,b&&b.ITa.YUa(),c.ranges(a),b&&b.ITa.YUa(!0))}),sb.condition=Da("condition",t),sb.style=Da("style",t),sb.priority=Da("priority",1),sb.stopIfTrue=Da("stopIfTrue",!1);function Xb(a,b){return a===Ia.cellValueRule&&(b===Ma.between||b===Ma.notBetween)}tb=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],ub={today:0,yesterday:1,tomorrow:2,last7Days:3,thisMonth:4,lastMonth:5,nextMonth:6,thisWeek:7,lastWeek:8,nextWeek:9},vb={0:"today",1:"yesterday",2:"tomorrow",3:"last7Days",4:"thisMonth",5:"lastMonth",6:"nextMonth",7:"thisWeek",8:"lastWeek",9:"nextWeek"},function(a){a[a.equal=0]="equal",a[a.notEqual=1]="notEqual",a[a.greaterThan=2]="greaterThan",a[a.greaterThanOrEqual=3]="greaterThanOrEqual",a[a.lessThan=4]="lessThan",a[a.lessThanOrEqual=5]="lessThanOrEqual",a[a.between=6]="between",a[a.notBetween=7]="notBetween"}(wb||(wb={}));function Yb(a,b,c){var d,e,f;if(!a||!b)return null;if(d=b[0],d.row<0||d.col<0)return null;if(e=i.IndexHelper.R9(d.col)+(d.row+1),f="",f=d.rowCount===i.XmlConstants.M7?q("${0}:${1}",[i.IndexHelper.R9(d.col),i.IndexHelper.R9(d.col+d.colCount-1)]):d.colCount===i.XmlConstants.L7?q("${0}:${1}",[d.row+1,d.row+d.rowCount]):q("${0}${1}:${2}${3}",[i.IndexHelper.R9(d.col),d.row+1,i.IndexHelper.R9(d.col+d.colCount-1),d.row+d.rowCount]),"top10"===a.type)return a.bottom?a.percent?q("IF(INT(COUNT({0})*{1}%)>0,SMALL({0},INT(COUNT({0})*{1}%)),MIN({0}))>={2}",[f,a.rank,e]):q("SMALL(({0}),MIN({1},COUNT({0})))>={2}",[f,a.rank,e]):a.percent?q("IF(INT(COUNT({0})*{1}%)>0,LARGE({0},INT(COUNT({0})*{1}%)),MIN({0}))<={2}",[f,a.rank,e]):q("LARGE(({0}),MIN({1},COUNT({0})))<={2}",[f,a.rank,e]);if("containsText"===a.type)return q('NOT(ISERROR(SEARCH("{0}",{1})))',[c,e]);if("notContainsText"===a.type)return q('ISERROR(SEARCH("{0}",{1}))',[c,e]);if("beginsWith"===a.type)return q('LEFT({0},{1}) = "{2}"',[e,c.length,c]);if("endsWith"===a.type)return q('RIGHT({0},{1}) = "{2}"',[e,c.length,c]);if("duplicateValues"===a.type)return q("AND(COUNTIF({0},{1})>1,NOT(ISBLANK({1})))",[f,e]);if("uniqueValues"===a.type)return q("AND(COUNTIF({0},{1})=1,NOT(ISBLANK({1})))",[f,e]);if("aboveAverage"===a.type||"belowAverage"===a.type||"aboveOrEqualToAverage"===a.type||"belowOrEqualToAverage"===a.type){if("aboveAverage"===a.type&&O(a.stdDev))return q("{0}>AVERAGE({1})",[e,f]);if(!O(a.aboveAverage)){if(!(O(a.equalAverage)||a.aboveAverage||O(a.equalAverage))&&a.equalAverage&&O(a.stdDev))return q("{0}<=AVERAGE({1})",[e,f]);if(!a.aboveAverage&&O(a.stdDev))return q("{0}<AVERAGE({1})",[e,f])}if(!O(a.equalAverage)&&a.equalAverage&&O(a.stdDev))return q("{0}>=AVERAGE({1})",[e,f]);if(!O(a.stdDev))return O(a.aboveAverage)||a.aboveAverage?q("({0}-AVERAGE({1}))>=STDEVP({1})*({2})",[e,f,a.stdDev]):q("({0}-AVERAGE({1}))<=STDEVP({1})*(-{2})",[e,f,a.stdDev])}return null}xb=function(a){Nb(c,a);function c(b,c,d,e,f,g,h,i,j,k){var l=a.call(this,b,d)||this,m=l;return m.ranges(c),m.operator(e),m.value1("string"==typeof f?r.trim(f):f),m.value2("string"==typeof g?r.trim(g):g),m.text(h),m.formula(i),m.type(j),m.rank(k),m.cached=!1,m.cW=t,l}return c.prototype.value1=function(a,b){var c,d;return 1!==arguments.length?(c=this.condition(),c&&(d=c.formula(a,b,0),d&&d.length>0)?"="+K(r.trim(""+d),"="):this._Qa):void(this._Qa=a)},c.prototype.value2=function(a,b){var c,d;return 1!==arguments.length?(c=this.condition(),c&&(d=c.formula(a,b,1),d&&d.length>0)?"="+K(r.trim(""+d),"="):this.aRa):void(this.aRa=a)},c.prototype.formula=function(a,b){var c=this,d=c.condition();return"string"!=typeof a?d&&d.formula(a,b)||c.Yw:(c.Yw=a,void(d&&d.formula(a)))},c.prototype.cellValueRuleCreateCondition=function(){var a,c,d,e,f,g,h,i,j=this,k=j.value1(),l=j.value2(),m=j.ranges(),n=j.bW(k)?K(k,"="):t,o=j.bW(l)?K(l,"="):t,p=j.operator();return p===Ma.between?(a=b.$V(bb.cellValueCondition,3,k,n,u,u,m),a.treatNullValueAsZero(!0),c=b.$V(bb.cellValueCondition,5,l,o,u,u,m),c.treatNullValueAsZero(!0),f=b.$V(bb.relationCondition,1,t,t,t,t,m,a,c),d=b.$V(bb.cellValueCondition,5,k,n,u,u,m),d.treatNullValueAsZero(!0),e=b.$V(bb.cellValueCondition,3,l,o,u,u,m),e.treatNullValueAsZero(!0),g=b.$V(bb.relationCondition,1,t,t,t,t,m,d,e),b.$V(bb.relationCondition,0,t,t,t,t,m,f,g)):p===Ma.notBetween?(a=b.$V(bb.cellValueCondition,4,k,n,u,u,m),a.treatNullValueAsZero(!0),c=b.$V(bb.cellValueCondition,2,l,o,u,u,m),a.treatNullValueAsZero(!0),f=b.$V(bb.relationCondition,0,t,t,t,t,m,a,c),d=b.$V(bb.cellValueCondition,2,k,n,u,u,m),d.treatNullValueAsZero(!0),e=b.$V(bb.cellValueCondition,4,l,o,u,u,m),e.treatNullValueAsZero(!0),g=b.$V(bb.relationCondition,0,t,t,t,t,m,d,e),b.$V(bb.relationCondition,1,t,t,t,t,m,f,g)):(h=p,i=b.$V(11,h,k,n,u,u,m),i.treatNullValueAsZero(!0),i)},c.prototype.bW=function(a){return!O(a)&&"="===a[0]},c.prototype.specificTextRuleCreateCondition=function(){var a,c,d,e,f=this.operator();switch(f){case 2:a=2;break;case 3:a=4;break;case 0:a=6;break;case 1:a=7;break;default:a=0}return c=this.text(),d=t,c&&"="===c[0]&&(d=c),e=b.$V(2,a,c,d,u,u,this.ranges()),e.ignoreCase(!0),e.useWildCards(2!==f&&3!==f),e},c.prototype.formulaRuleCreateCondition=function(){var a=this,c=a.ranges();return b.$V(4,t,t,a.Yw,4,t,c)},c.prototype.dateOccurringRuleCreateCondition=function(){return b.$V(6,t,this.type(),t,t,u,this.ranges())},c.prototype.top10RuleCreateCondition=function(){return b.$V(8,t,this.rank(),t,t,this.type(),this.ranges())},c.prototype.uniqueRuleCreateCondition=function(){return b.$V(9,t,!1,t,t,t,this.ranges())},c.prototype.duplicateRuleCreateCondition=function(){return b.$V(9,t,!0,t,t,t,this.ranges())},c.prototype.averageRuleCreateCondition=function(){return b.$V(10,t,t,t,t,this.type(),this.ranges())},c.prototype.createCondition=function(){return this[Ia[this.ruleType()]+"CreateCondition"]()},c.prototype.reset=function(){var a=this;switch(a.ranges(t),a.condition(t),a.style(t),a.stopIfTrue(!1),a.priority(1),a.operator(6),a.value1(t),a.value2(t),a.text(""),a.formula(t),a.type(0),a.rank(10),a.ruleType()){case 1:a.operator(6);break;case 2:a.operator(0);break;case 4:a.style(t);break;case 5:a.type(0),a.rank(10);break;case 8:a.type(0)}},c.prototype.evaluate=function(b,c,d,e){return this.jW(b),a.prototype.evaluate.call(this,b,c,d,e)},c.prototype.jW=function(a){var b,c=this;c.initCondition(),b=c.condition(),9===b.conType()&&(c.iW()&&(c.Nm(),c.cW=dc(c.ranges())),c.cached===!1&&(b.duplicatedArrayCached=b.getDuplicated(a,c.ranges()),c.cached=!0))},c.prototype.Nm=function(){this.cached=!1},c.prototype.rI=function(b,c,d,e){a.prototype.rI.call(this,b,c,d,e),this.Nm()},c.prototype.tI=function(b,c,d,e){a.prototype.tI.call(this,b,c,d,e),this.Nm()},c.prototype.GR=function(b,c,d,e){a.prototype.GR.call(this,b,c,d,e),this.Nm()},c.prototype.HR=function(b,c,d,e){a.prototype.HR.call(this,b,c,d,e),this.Nm()},c.prototype.toJSON=function(a){var b,c,d,e,f,g=this;return O(g.condition())&&this.initCondition(),b=Ea.call(g,a,tb),c=g.value1(),Xb(b.ruleType,b.operator)&&(d=g.value2()),
e=a&&a.parent&&1===a.parent.options.referenceStyle,O(c)||(g.bW(c)&&e&&(c=Zb(a,g,c,e)),b.value1=c),O(d)||(g.bW(d)&&e&&(d=Zb(a,g,d,e)),b.value2=d),f=g.ruleType(),f===Ia.conditionRuleBase&&(b.condition=g.condition().toJSON()),b},c.prototype.fromJSON=function(a,b,c){var d=tb;O(a.condition)||(d=tb.concat(["condition"])),Fa.call(this,b,d,a,c),O(a.value1)||this.value1(a.value1),O(a.value2)||this.value2(a.value2),this.initCondition(b)},c.prototype.ceK=function(a,b){var c,d,e,f,g,h,j,k,l,m,n,p,q,r,s,t,v,w,x,y,z,A,B,C,D=this,E=D.ruleType(),F=i.Util.KlK(b),G={n_:o,sqref:da(D.ranges())};return G.pivot=O(D.pivotTableName)?u:"1",c=a.getDxfIndex(D.style()),d=D.operator&&D.operator(),e=D.type&&D.type(),f=nc(E,e,d),g=f.type,h=f.operator,j=D.condition(),k=f.timePeriod,l=D.priority()?""+D.priority():"1",m=D.stopIfTrue()?1:u,n=1===e?1:u,p=j&&j.isPercent(),q=p?1:u,r=D.rank&&D.rank()||u,s=D.text&&D.text(),E===Ia.averageRule&&(w=0,e!==Wa.equalOrAbove&&e!==Wa.equalOrBelow||(v=1),e!==Wa.above1StdDev&&e!==Wa.below1StdDev||(w=1),e!==Wa.above2StdDev&&e!==Wa.below2StdDev||(w=2),e!==Wa.above3StdDev&&e!==Wa.below3StdDev||(w=3),e!==Wa.below&&e!==Wa.equalOrBelow&&e!==Wa.below1StdDev&&e!==Wa.below2StdDev&&e!==Wa.below3StdDev||(t=0)),x=[],y=D.value1()||D.Yw,z=D.value2(),O(y)||x.push({n_:"formula",c_:[jc(F?y:S(y))]}),Xb(E,d)&&!O(z)&&x.push({n_:"formula",c_:[jc(F?z:S(z))]}),A={n_:"cfRule",type:g,dxfId:c!==u?+c:c,priority:l,stopIfTrue:m,aboveAverage:t,equalAverage:v,bottom:n,percent:q,rank:r,operator:h,text:s,stdDev:w,timePeriod:k},E===Ia.specificTextRule||E===Ia.dateOccurringRule||E===Ia.top10Rule||E===Ia.uniqueRule||E===Ia.duplicateRule||E===Ia.averageRule?(B=Yb(A,D.ranges(),s),B&&(C=[{n_:"formula",c_:[U(R.getFormulaString(B))]}],A.c_=C)):A.c_=x,G.c_=[A],G},c.prototype.beK=function(a){var b,c,d=this,e={n_:"conditionalFormatting","xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"},f=wa(),g={n_:"cfRule",type:"expression",id:f};return d.deK=f,O(d.priority())||(g.priority=d.priority()),b={n_:"f",c_:[U(T(d.Yw))]},c={n_:"dxf",v:a.FdK(d.style())},g.c_=[b,c],e.c_=[g,{n_:"sqref",c_:[da(d.ranges())]}],e},c.prototype.eeK=function(){var a=this;if(ga(a.value1())||ga(a.value2())||ga(a.text())||ga(a.Yw))return!0},c.prototype.bdK=function(a,b,c,d){var e=this;if(!e.eeK())return O(e.condition())&&e.initCondition(),b?e.beK(c):e.ceK(a,d)},c.prototype.feK=function(a,b,c,d){var e,f,g,h,j,k,l,m=this,n=a.type,o=i.Util.KlK(d),q=c.getDxf(a.dxfId,void 0,!0),r=W(a,"formula"),s=p(r&&ba(r[0])),t=p(r&&ba(r[1]));switch("cellIs"===n?(m._Qa=(o?"":"=")+_(s),t&&(m.aRa=(o?"":"=")+_(t))):m.Yw=_(s),O(a.stopIfTrue)||m.stopIfTrue(1===+a.stopIfTrue),e=a.rank,f=sc(n)){case 8:h=!0,0===+a.aboveAverage&&(h=!1),j=1===+a.equalAverage,g=j?h?2:3:h?0:1,O(a.stdDev)||(k=+a.stdDev,h?1===k?g=4:2===k?g=6:3===k&&(g=8):1===k?g=5:2===k?g=7:3===k&&(g=9));break;case 5:g=0,a.bottom&&(g=1),a.percent&&(e=Math.floor(b[0].rowCount*b[0].colCount*e/100),0===e&&(e=1));break;case 4:g=0,"timePeriod"===a.type&&a.timePeriod&&(g=ub[a.timePeriod])}m.type(g),O(e)||m.rank(+e),l=mc(n,a.operator,a.timePeriod),m.operator(l),m.text(_(a.text)),m.ranges(b),m.ruleType(f),m.style(q)},c.prototype.geK=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this,p=a.type,q=sc(p);switch(O(a.stopIfTrue)||o.stopIfTrue(1===+a.stopIfTrue),e=a.rank,q){case 8:f=!0,0===+a.aboveAverage&&(f=!1),g=1===+a.equalAverage,d=g?f?2:3:f?0:1,O(a.stdDev)||(h=+a.stdDev,f?1===h?d=4:2===h?d=6:3===h&&(d=8):1===h?d=5:2===h?d=7:3===h&&(d=9));break;case 5:d=0,a.bottom&&(d=1),a.percent&&(e=Math.floor(b[0].rowCount*b[0].colCount*e/100),0===e&&(e=1));break;case 4:d=0,"timePeriod"===a.type&&a.timePeriod&&(d=ub[a.timePeriod])}o.type(d),O(e)||o.rank(+e),i=mc(p,a.operator,a.timePeriod),o.operator(i),o.ruleType(q),j=W(a,"f"),k=j&&_($(ba(j[0]))),l=j&&_($(ba(j[1]))),"cellIs"===p?(o._Qa=k,o.aRa=l):o.Yw=k,m=Z(a,"dxf"),n=m.v,o.style(c.GdK(n)),o.ranges(b)},c.prototype.cdK=function(a,b,c,d,e,f,g){var h=this;e?h.geK(a,b,f):h.feK(a,b,c,g),h.initCondition(d)},c}(rb),b.NormalConditionRule=xb;function Zb(a,b,c,d){var e=b.ranges(),f=ha(e),g=j.formulaToExpression(a,c,f.r,f.c,d);return j.expressionToFormula(a,g,f.r,f.c,!d)}yb={operator:Da("operator",t),text:Da("text",t),type:Da("type",t),rank:Da("rank",t),priority:Da("priority",1)},r.extend(xb.prototype,yb),zb=function(){function a(a,b){this.type=a,this.value=b}return a}(),b.ScaleValue=zb,Ab=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],Bb=function(a){Nb(c,a);function c(b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,r,s,u,v,w=a.call(this,b,t,l)||this,x=w;return x.xyb=!1,x.lowestValueCached=t,x.highestValueCached=t,x.zyb={},x.cached=!1,x.cW=t,m=c,n=d,o=e,p=f,q=g,r=h,s=i,u=j,v=k,arguments.length<=1&&(m=1,n=t,o=la(255,248,105,107),p=4,q=50,r=la(255,255,235,132),s=2,u=t,v=la(255,99,190,123)),x.minColor(o),x.minValue(n),x.minType(m),x.midColor(r),x.midValue(q),x.midType(p),x.maxColor(v),x.maxValue(u),x.maxType(s),w}return c.prototype.stopIfTrue=function(a){return!1},c.prototype.isScaleRule=function(){return!0},c.prototype.createCondition=function(){return t},c.prototype.fW=function(a){var c=b.$V(8,t,t,t,t,1).getTopValues(a,1,this.ranges());return sa(c)>0?c[0]:t},c.prototype.gW=function(a){var c=b.$V(8,t,t,t,t,0).getTopValues(a,1,this.ranges());return sa(c)>0?c[0]:t},c.prototype.jW=function(a){var b=this;b.iW()&&(b.Nm(),b.cW=dc(b.ranges())),b.cached===!1&&(b.lowestValueCached=b.fW(a),b.highestValueCached=b.gW(a),b.cached=!0)},c.prototype.Nm=function(){this.lowestValueCached=t,this.highestValueCached=t,this.zyb={},this.cached=!1},c.prototype.kW=function(a,b,c,d){var e,f;return d&&(e=a.Cf())?(f=e.parse(a.yj(),d,b,c),e.Hg(a.yj(),f,h.pf(b,c),!1)):t},c.prototype.bW=function(a){return a&&"="===a[0]},c.prototype.lW=function(a){return O(a)||""===a?t:"="===a[0]?a.substr(1):a},c.prototype.mW=function(a,b,c,d){if(this.bW(d))return this.kW(a,b,c,this.lW(""+d));var e={};return G(d,e)?e.value:NaN},c.prototype.dW=function(a){return this.jW(a),this.highestValueCached},c.prototype.eW=function(a){return this.jW(a),this.lowestValueCached},c.prototype.nW=function(a,b,c,d){var e,f,g=this.mW(a,b,c,d);return!isNaN(g)&&0<=g&&g<=100&&(e=this.eW(a),f=this.dW(a),typeof e!==v&&e!==t&&typeof f!==v&&f!==t)?e+(f-e)*g/100:t},c.prototype.oW=function(a,b,c,d){var e,f,g,i,j,k,l,m,n,o,p,q,r=this.zyb;if(void 0!==r[d])return r[d];if(e=this.mW(a,b,c,d),!isNaN(e)&&0<=e&&e<=100){for(f=0,g=this.ranges(),i=sa(g),j=0;j<i;j++)k=this.YV("PERCENTILE",[a.Tq(g[j]),e/100]),l=a.Cf(),m=a.yj(),n=l.unparse(m,k,b,c),o=l.parse(m,n,b,c),p=l.Hg(m,o,h.pf(b,c),!1),q={},f+=G(p,q)?q.value:0;return r[d]=f/i,r[d]}return r[d]=t,r[d]},c.prototype.pW=function(a,b,c,d,e){var f,g,h=this;switch(d){case Xa.formula:return h.bW(e)||(e="="+e),h.mW(a,b,c,e);case Xa.highestValue:return h.dW(a);case Xa.lowestValue:return h.eW(a);case Xa.number:return h.mW(a,b,c,e);case Xa.percent:return h.nW(a,b,c,e);case Xa.percentile:return h.oW(a,b,c,e);case Xa.automax:return f=h.dW(a),f<0?0:f;case Xa.automin:return g=h.eW(a),g>0?0:g;default:return t}},c.prototype.qW=function(a,b,c){return a===b&&a===c?1:a<=b?0:a>=c?1:(a-b)/(c-b)},c.prototype.rW=function(a,b,c){var d,e,f,g,h,i;return 0<=a&&a<=1?(d=ka.ec(b),e=ka.ec(c),f=d.a*(1-a)+e.a*a,g=d.r*(1-a)+e.r*a,h=d.g*(1-a)+e.g*a,i=d.b*(1-a)+e.b*a,la(parseFloat(f/255+""),parseInt(g+"",10),parseInt(h+"",10),parseInt(i+"",10))):t},c.prototype.YV=function(a,b){var c,d,e,g;if(!ia)return t;if(c=ta.findGlobalFunction(a)){for(d=[],e=sa(b),g=0;g<e;g++)d[g]=Ca(b[g]);return f.Jh(c,d)}return t},c.prototype.rI=function(b,c,d,e){a.prototype.rI.call(this,b,c,d,e),this.Nm()},c.prototype.tI=function(b,c,d,e){a.prototype.tI.call(this,b,c,d,e),this.Nm()},c.prototype.GR=function(b,c,d,e){a.prototype.GR.call(this,b,c,d,e),this.Nm()},c.prototype.HR=function(b,c,d,e){a.prototype.HR.call(this,b,c,d,e),this.Nm()},c.prototype.scaleEvaluate=function(a,b,c,d){var e,f,g,h,i=this;if(i.jW(a),i.contains(b,c)){if(O(d))return t;try{if(e=F(d),f=i.pW(a,b,c,i.minType(),i.minValue()),g=i.pW(a,b,c,i.midType(),i.midValue()),h=i.pW(a,b,c,i.maxType(),i.maxValue()),f>h)return t;if(isNaN(g)){if(!isNaN(f)&&!isNaN(h))return i.qW(e,f,h)}else if(!isNaN(f)&&!isNaN(h))return e<f?0:e>=h?2:f<=e&&e<=g?i.qW(e,f,g):1+i.qW(e,f,h)}catch(a){return t}}return t},c.prototype.twoScaleRuleEvaluate=function(a,b,c,d){var e,f,g,h,i,j;if(!O(d)){if(e={},f=E(d)&&G(d,e)?e.value:NaN,isNaN(f))return t;if(g=this,h=g.pW(a,b,c,g.minType(),g.minValue()),i=g.pW(a,b,c,g.maxType(),g.maxValue()),!O(h)&&!O(i))return j=g.qW(f,h,i),g.rW(j,g.minColor(),g.maxColor())}return t},c.prototype.threeScaleRuleEvaluate=function(a,b,c,d){var e,f,g,h,i,j,k=this;if(k.lh=a,!O(d)){if(e={},f=E(d)&&G(d,e)?e.value:NaN,isNaN(f))return t;if(g=k.pW(a,b,c,k.minType(),k.minValue()),h=k.pW(a,b,c,k.midType(),k.midValue()),i=k.pW(a,b,c,k.maxType(),k.maxValue()),!O(g)&&!O(i)&&!O(h))return j=void 0,g>i?t:f<=g||g===i?f>=i?k.maxColor():k.minColor():f>=i?k.maxColor():f<=h?(j=k.qW(f,g,h),k.rW(j,k.minColor(),k.midColor())):(j=k.qW(f,h,i),k.rW(j,k.midColor(),k.maxColor()))}return t},c.prototype.evaluate=function(a,b,c,d){return this[Ia[this.ruleType()]+"Evaluate"](a,b,c,d)},c.prototype.ad=function(){var a=this;a.minValue(t),a.minType(1),a.midValue(50),a.midType(4),a.maxValue(t),a.maxType(2),10===a.ruleType()&&(a.minColor(la(0,255,255,255)),a.maxColor(la(255,99,190,123))),11===a.ruleType()&&(a.midValue(50),a.midType(4),a.minColor(la(255,248,105,107)),a.midColor(la(255,255,235,132)),a.maxColor(la(255,99,190,123)))},c.prototype.reset=function(){var a=this;a.ranges(t),a.condition(t),a.style(t),a.ad(),a.lh=t,a.stopIfTrue(!1),a.priority(1)},c.prototype.toJSON=function(a){return Ea.call(this,a,Ab)},c.prototype.fromJSON=function(a,b,c){Fa.call(this,b,Ab,a,c),this.initCondition(b)},c.prototype.eeK=function(){var a=this;if(ga(a.minValue())||ga(a.midValue())||ga(a.maxValue()))return!0},c.prototype.bdK=function(a){var b,c,d,e,f,g,h,i,j,k,l,m=this;if(!m.eeK())return O(m.condition())&&m.initCondition(),b=m.ruleType(),c={n_:o,sqref:da(m.ranges())},c.pivot=O(m.pivotTableName)?u:"1",d=pc(m.minType()),e=m.minValue(),f=pc(m.maxType()),g=m.maxValue(),h=m.minColor(),i=m.maxColor(),(O(d)||"autoMin"===d)&&(d="min"),(O(f)||"autoMax"===f)&&(f="max"),c.c_=[{n_:"cfRule",type:"colorScale",priority:m.priority()?""+m.priority():"1",c_:[{n_:"colorScale",c_:[{n_:"cfvo",type:d,val:O(e)||vc(d)?u:U(S(e))},{n_:"cfvo",type:f,val:O(g)||vc(f)?u:U(S(g))}]}]}],O(h)||c.c_[0].c_[0].c_.push(X(h)),O(i)||c.c_[0].c_[0].c_.push(X(i)),11===b&&(j=pc(m.midType()),k=m.midValue(),l=m.midColor(),c.c_[0].c_[0].c_.splice(1,0,{n_:"cfvo",type:j,val:O(k)?50:U(S(k))}),O(l)||c.c_[0].c_[0].c_.splice(4,0,X(l))),c},c.prototype.cdK=function(a,b,c,d){var e,f,g,h,i,j=this,k=kc(a),l=lc(a),m=k[0];2===k.length?g=k[1]:(e=k[1],g=k[2]),i=l[0],e?(f=l[1],h=l[2]):h=l[1],e?j.ruleType(Ia.threeScaleRule):j.ruleType(Ia.twoScaleRule),j.minColor(i),j.minValue(wc(m.val)),j.minType(oc(m.type)),j.midColor(f),e&&!O(e.val)&&j.midValue(wc(e.val)),j.midType(oc(e&&e.type)),j.maxColor(h),j.maxValue(wc(g.val)),j.maxType(oc(g.type)),j.ranges(b),j.initCondition(d)},c}(rb),b.ScaleRule=Bb,Cb={minValue:Da("minValue",t),minType:Da("minType",5),minColor:Da("minColor",t),midValue:Da("midValue",50,t,function(a){var b=this;if(b.lh){if(2===b.midType())return b.dW(b.lh);if(1===b.midType())return b.eW(b.lh)}return a}),midType:Da("midType",t),midColor:Da("midColor",t),maxType:Da("maxType",7),maxValue:Da("maxValue",t),maxColor:Da("maxColor",t)},r.extend(Bb.prototype,Cb);function $b(a){return a.c_[0]&&a.c_[0].c_[0]&&a.c_[0].c_[0].c_[0]}Db=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],Eb=function(a){Nb(b,a);function b(b,c,d,e,f,g){var h=this,i=b,j=c,k=d,l=e,m=f;return 0===arguments.length&&(i=5,j=t,k=7,l=t,m=la(255,99,142,198)),h=a.call(this,12,i,j,t,t,t,t,k,l,t,g)||this,h.xyb=!1,h.ad(m),h}return b.prototype.ad=function(a){var b=this;b.gradient(!0),b.color(a),b.showBorder(!1),b.borderColor("black"),b.dataBarDirection(0),b.negativeFillColor("red"),b.useNegativeFillColor(!0),b.negativeBorderColor("black"),b.useNegativeBorderColor(!1),b.axisPosition(0),b.axisColor("black"),b.showBarOnly(!1)},b.prototype.reset=function(){var a=this;a.ranges(t),a.condition(t),a.style(t),a.ad(la(255,99,142,198)),a.stopIfTrue(!1),a.priority(1),a.minValue(t),a.minType(5),a.midValue(t),a.midType(t),a.maxValue(t),a.maxType(7),a.minColor(t),a.midColor(t),a.maxColor(t)},b.prototype.JKJ=function(a,b,c,d){var e,f,g,h,i=this,j=d?i.maxType():i.minType(),k=d?i.maxValue():i.minValue();if(6!==j&&4!==j)return i.pW(a,b,c,j,k);for(f=0;f<sa(i.ranges());f++)if(i.ranges()[f].intersect(b,-1,1,-1)&&(e=i.ranges()[f]))return g=e.row,h=e.col,g=g===-1?0:g,h=h===-1?0:h,i.pW(a,g,h,j,k)},b.prototype.tW=function(a,b,c){var d=0;return a>=c&&a>b?[1,d]:a<=b&&a<c?[0,d]:c===b?[.5,d]:[(a-b)/(c-b),d]},b.prototype.uW=function(a,b,c){var d,e,f=.5,g=A(c-b);return c>0&&b>=0?c===b?[.5,f]:a>=c?[.5,f]:a<=b?[b/c*.5,f]:[.5*A(a/c),f]:c>0&&b<0?(d=c>A(b)?.5:c/g,e=c>A(b)?b/g:-.5,a>0?a>=c?[d,f]:[a/c*d,f]:a<0?a<=b?[e,f]:[a/b*e,f]:[0,f]):c<=0&&b<0?c===b?[-.5,f]:a>=c?[-c/b*.5,f]:a<=b?[-.5,f]:[-a/b*.5,f]:0===c&&0===b?[0,f]:(f=-1,[-1,f])},b.prototype.vW=function(a,b,c){var d,e,f,g=-1,h=A(b),i=A(c),j=A(c-b),k=b<0?-1:1;return c>0&&b>=0||c<=0&&b<0?(d=z(h,i),e=y(h,i),f=A(a),g=b<0?1:0,f<=e&&f<d?[0,g]:f>=d&&f>e?[k,g]:e===d?[.5*k,g]:[k*(A(a)-e)/j,g]):c>0&&b<0?(g=A(b)/j,0===a?[0,g]:a>=c?[1-g,g]:[z(a,b)/j,g]):0===c&&0===b?(g=.5,0===a?[0,g]:[.5*k,g]):[-1,g]},b.prototype.wW=function(a,b,c){var d=this;return 0===d.axisPosition()?d.vW(a,b,c):1===d.axisPosition()?d.uW(a,b,c):d.tW(a,b,c)},b.prototype.evaluate=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;if(!O(d)){if(e={},f=E(d,!0)&&G(d,e)?e.value:NaN,isNaN(f))return t;if(g=this,h=g.JKJ(a,b,c,!1),i=g.JKJ(a,b,c,!0),Q(h,Date)&&(h=oa.Ra(h)),Q(i,Date)&&(i=oa.Ra(i)),!O(h)&&!O(i))return h>i&&(j=i,i=h,h=j),k=void 0,l=g.wW(f,h,i),!l||sa(l)<2?t:(m=l[0],k=l[1],n=f<0&&g.useNegativeFillColor()?g.negativeFillColor():g.color(),o=f<0&&g.useNegativeBorderColor()?g.negativeBorderColor():g.borderColor(),p=g.axisColor(),n=va.Om(a,n),o=va.Om(a,o),p=va.Om(a,p),{fillColor:n,borderColor:o,showBorder:g.showBorder(),axisColor:p,isGradient:g.gradient(),direction:g.dataBarDirection(),axisLocation:k,scale:m,showBarOnly:g.showBarOnly()})}return t},b.prototype.toJSON=function(a){return Ea.call(this,a,Db)},b.prototype.fromJSON=function(a,b,c){Fa.call(this,b,Db,a,c),this.initCondition(b)},b.paintDataBar=function(a,b,c,d,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=new e.Rect(c+2,d+2,f-4,g-4),w=v.x,x=v.y,y=B(A(v.width*b.scale)),z=v.height;if(0===b.axisLocation)b.scale<=0&&(y=0);else if(1===b.axisLocation)b.scale<0?w=w+v.width-y:y=0;else{for(h=B(v.width*b.axisLocation+w)+.5,i=v.y,j=1,k=g-2,a.lineWidth=j,a.strokeStyle=b.axisColor,a.beginPath(),l=0;l<=k;l+=2)1===b.direction?(a.moveTo(2*c+f-h,i+l),a.lineTo(2*c+f-h,i+l+1)):(a.moveTo(h,i+l),a.lineTo(h,i+l+1));a.stroke(),b.scale>0?w=h+j:b.scale<0?w=h-y:y=0}b.showBorder&&(w=B(w)+.5,y-=1,x+=.5,z-=1),m=w,n=w+y,1===b.direction&&(m=2*c+f-w-y,n=2*c+f-w),y>=0&&z>=0&&(o=b.fillColor,b.isGradient&&(p=.9,o=a.createLinearGradient(m,x,n,x),q=ka.ec(b.fillColor),r=la(q.a,B(255*p+q.r*(1-p)),B(255*p+q.g*(1-p)),B(255*p+q.b*(1-p))),s=b.scale<0?1-p:p,t=b.fillColor,u=b.scale<0?1:0,1===b.direction?(o.addColorStop(s,t),o.addColorStop(u,r)):(o.addColorStop(s,r),o.addColorStop(u,t))),a.fillStyle=o,a.fillRect(m,x,y,z),b.showBorder&&y>0&&z>0&&(a.strokeStyle=b.borderColor,a.strokeRect(m,x,y,z)))},b.prototype.ceK=function(){var a,b,c,d,e,f,g,h=this,i={n_:o,sqref:da(h.ranges())};return i.pivot=O(h.pivotTableName)?u:"1",a=h.showBarOnly()?0:u,b=pc(h.minType()),c=h.minValue(),d=pc(h.maxType()),e=h.maxValue(),f=h.color(),(O(b)||"autoMin"===b)&&(b="min"),(O(d)||"autoMax"===d)&&(d="max"),g=[],g.push({n_:"cfvo",type:b,val:O(c)||Rb(c)||vc(b)?u:U(S(c))}),g.push({n_:"cfvo",type:d,val:O(e)||Rb(e)||vc(d)?u:U(S(e))}),f&&g.push(X(f)),i.c_=[{n_:"cfRule",type:"dataBar",priority:h.priority()?""+h.priority():"1",c_:[{n_:"dataBar",showValue:a,c_:g}]}],h.deK&&i.c_[0].c_.push({n_:n,c_:[{n_:"ext",r_:[1,17],c_:[{n_:"id",c_:[h.deK]}]}]}),i},b.prototype.beK=function(){var a,b,c,d,e,f,g,h,i=this,j={n_:"conditionalFormatting",r_:[2]},k=wa(),l={n_:"cfRule",type:"dataBar",id:k};return i.deK=k,a={n_:"dataBar",minLength:0,maxLength:100},i.showBarOnly()&&(a.showValue="0"),i.showBorder()&&(a.border="1"),i.gradient()===!1&&(a.gradient="0"),i.useNegativeFillColor()===!1&&(a.negativeBarColorSameAsPositive="1"),i.useNegativeBorderColor()&&(a.negativeBarBorderColorSameAsPositive="0"),a.direction=1===i.dataBarDirection()?"rightToLeft":"leftToRight",b=i.axisPosition(),1===b?a.axisPosition="middle":2===b&&(a.axisPosition="none"),c=[],d=i.color(),d&&c.push(X(d)),e=i.minType(),f=i.minValue(),g=i.maxType(),h=i.maxValue(),O(e)||5===e?c.push({n_:"cfvo",type:"autoMin"}):O(f)||Rb(f)?c.push({n_:"cfvo",type:pc(e)}):c.push({n_:"cfvo",type:pc(e),c_:[{n_:"f",c_:[U(T(f))]}]}),O(g)||7===g?c.push({n_:"cfvo",type:"autoMax"}):O(h)||Rb(h)?c.push({n_:"cfvo",type:pc(g)}):c.push({n_:"cfvo",type:pc(g),c_:[{n_:"f",c_:[U(T(h))]}]}),i.showBorder()&&i.borderColor()&&c.push(X(i.borderColor(),u,"borderColor")),O(i.negativeFillColor())?c.push(X("red",u,"negativeFillColor")):c.push(X(i.negativeFillColor(),u,"negativeFillColor")),O(i.negativeBorderColor())?c.push(X("black",u,"negativeBorderColor")):c.push(X(i.negativeBorderColor(),u,"negativeBorderColor")),2!==i.axisPosition()&&c.push(X(i.axisColor(),u,"axisColor")),a.c_=c,l.c_=[a],j.c_=[l,{n_:"sqref",c_:[da(i.ranges())]}],j},b.prototype.bdK=function(a,b){var c=this;if(!c.eeK())return b?c.beK():c.ceK()},b.prototype.feK=function(a,b){var c,d,e,f=this,g=kc(a),h=lc(a);f.color(h[0]),c=g[0],d=g[1],f.minType(oc(c.type)),f.minValue(wc(c.val)),f.maxType(oc(d.type)),f.maxValue(wc(d.val)),f.priority(+a.priority),f.ranges(b),e=Z(a,"dataBar"),O(e.showValue)||f.showBarOnly(!i.NodeHelper.oca(e.showValue,!0)),a.c_[1]&&a.c_[1].n_===n&&(f.deK=$b(a.c_[1]))},b.prototype.geK=function(a,b){var c,d,e,f,g,h,j,k,l,m,n=this,o=Z(a,"dataBar");O(o.showValue)||n.showBarOnly(!i.NodeHelper.oca(o.showValue,!0)),O(o.border)||n.showBorder(i.NodeHelper.oca(o.border,!1)),O(o.gradient)||n.gradient(i.NodeHelper.oca(o.gradient,!0)),O(o.direction)||n.dataBarDirection("rightToLeft"===o.direction?1:0),O(o.axisPosition)||n.axisPosition(+cb[o.axisPosition]),O(o.negativeBarColorSameAsPositive)||n.useNegativeFillColor(!i.NodeHelper.oca(o.negativeBarColorSameAsPositive,!1)),O(o.negativeBarBorderColorSameAsPositive)||n.useNegativeBorderColor(!i.NodeHelper.oca(o.negativeBarBorderColorSameAsPositive,!0)),c=W(o,"cfvo"),2===c.length&&(n.minType(oc(c[0].type)),d=W(c[0],"f"),e=yc(c[0],d&&d[0]),O(e)||n.minValue(wc(e)),n.maxType(oc(c[1].type)),d=W(c[1],"f"),f=yc(c[1],d&&d[0]),O(f)||n.maxValue(wc(f))),g=Z(o,"fillColor"),g&&n.color(Y(g)),h=Z(o,"borderColor"),h&&n.borderColor(Y(h)),j=Z(o,"negativeFillColor"),j&&n.negativeFillColor(Y(j)),k=Z(o,"negativeBorderColor"),k&&n.negativeBorderColor(Y(k)),l=Z(o,"axisColor"),l&&n.axisColor(Y(l)),m=lc(a),m&&m.length>0&&n.color(m[0]),n.ranges(b)},b.prototype.cdK=function(a,b,c,d,e,f){var g=this;e?g.geK(a,b):g.feK(a,b),g.initCondition(d)},b}(Bb),b.DataBarRule=Eb,Fb={gradient:Da("gradient",!0),color:Da("color",t),showBorder:Da("showBorder",!1),borderColor:Da("borderColor","black"),dataBarDirection:Da("dataBarDirection",0),negativeFillColor:Da("negativeFillColor","red"),useNegativeFillColor:Da("useNegativeFillColor",!0),negativeBorderColor:Da("negativeBorderColor","black"),useNegativeBorderColor:Da("useNegativeBorderColor",!1),axisPosition:Da("axisPosition",0),axisColor:Da("axisColor","black"),showBarOnly:Da("showBarOnly",!1)},r.extend(Eb.prototype,Fb),Gb=function(){function a(a,b,c){this.isGreaterThanOrEqualTo=a,this.iconValueType=b,this.iconValue=c}return a}(),b.IconCriterion=Gb,Hb=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],Ib=function(a){Nb(b,a);function b(b,c){var d=this,e=b;return 0===arguments.length&&(e=0),d=a.call(this,13,t,t,t)||this,d.xyb=!1,d.ranges(c),d.ad(e),d}return b.prototype.xW=function(a){var b=this;b.iconSetType(a,!1),b.iconSetType()>=$a.threeArrowsColored&&b.iconSetType()<=$a.threeSymbolsUncircled?(b.NV=[],b.NV[0]=new Gb((!0),_a.percent,33),b.NV[1]=new Gb((!0),_a.percent,67),b.CZa=[],b.CZa[0]={iconSetType:a,iconIndex:0},b.CZa[1]={iconSetType:a,iconIndex:1},b.CZa[2]={iconSetType:a,iconIndex:2}):b.iconSetType()>=$a.fourArrowsColored&&b.iconSetType()<=$a.fourTrafficLights?(b.NV=[],b.NV[0]=new Gb((!0),_a.percent,25),b.NV[1]=new Gb((!0),_a.percent,50),b.NV[2]=new Gb((!0),_a.percent,75),b.CZa=[],b.CZa[0]={iconSetType:a,iconIndex:0},b.CZa[1]={iconSetType:a,iconIndex:1},b.CZa[2]={iconSetType:a,iconIndex:2},b.CZa[3]={iconSetType:a,iconIndex:3}):b.iconSetType()>=$a.fiveArrowsColored&&b.iconSetType()<=$a.fiveBoxes?(b.NV=[],b.NV[0]=new Gb((!0),_a.percent,20),b.NV[1]=new Gb((!0),_a.percent,40),b.NV[2]=new Gb((!0),_a.percent,60),b.NV[3]=new Gb((!0),_a.percent,80),b.CZa=[],b.CZa[0]={iconSetType:a,iconIndex:0},b.CZa[1]={iconSetType:a,iconIndex:1},b.CZa[2]={iconSetType:a,iconIndex:2},b.CZa[3]={iconSetType:a,iconIndex:3},b.CZa[4]={iconSetType:a,iconIndex:4}):b.iconSetType()>$a.fiveBoxes&&(b.NV=[],b.CZa=[])},b.prototype.ad=function(a){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xW(a)},b.prototype.yW=function(a){var b=sa(this.NV)+1;return this.reverseIconOrder()&&b>2?b-1-a:a},b.prototype.pW=function(a,b,c,d){var e=this,f=e.NV[d];if(f)switch(f.iconValueType){case _a.formula:return e.mW(a,b,c,f.iconValue);case _a.number:return e.mW(a,b,c,f.iconValue);case _a.percent:return e.nW(a,b,c,f.iconValue);case _a.percentile:return e.oW(a,b,c,f.iconValue);default:return t}},b.prototype.evaluate=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=d;if(O(r))return t;if(e={},f=E(d,!0)&&"boolean"!=typeof r&&G(d,e)?e.value:NaN,isNaN(f))return t;if(g=0,h=q.iconSetType(),i=q.NV,h>=$a.fiveArrowsColored?g=5:h>=$a.fourArrowsColored?g=4:h>=$a.threeArrowsColored&&(g=3),!i)return 0;for(k=0,l=g-1;l>0;l--)if(l<sa(i)+1&&(j=i[l-1],!O(j&&j.iconValue)&&(m=q.pW(a,b,c,l-1),!O(m)&&(n=j.isGreaterThanOrEqualTo?f>=m:f>m,f<Number.MAX_VALUE&&n)))){k=l;break}return o=q.yW(k),p=q.CZa,p?{iconSetType:p[o]?p[o].iconSetType:$a.noIcons,iconIndex:p[o]?p[o].iconIndex:0,showIconOnly:q.showIconOnly()}:{iconSetType:$a.noIcons,iconIndex:0,showIconOnly:q.showIconOnly()}},b.prototype.reset=function(){var a=this;a.ranges(t),a.condition(t),a.style(t),a.showIconOnly(!1),a.reverseIconOrder(!1),a.iconSetType(0,t),a.NV=t,a.stopIfTrue(!1),a.priority(1),a.minColor(t),a.minValue(t),a.minType(5),a.midColor(t),a.midValue(t),a.midType(t),a.maxColor(t),a.maxValue(t),a.maxType(7),a.CZa=t},b.prototype.icons=function(a){return 1===arguments.length&&(this.CZa=a),this.CZa},b.prototype.iconCriteria=function(){return this.NV},b.prototype.toJSON=function(a){return Ea.call(this,a,Hb)},b.prototype.fromJSON=function(a,b,c){Fa.call(this,b,Hb,a,c),this.initCondition(b)},b.prototype.eeK=function(){var a,b,c=this,d=c.NV;if(d&&d.length>0)for(a=0;a<d.length;a++)if(b=d[a].iconValue,ga(b))return!0},b.prototype.ceK=function(){var a,b,c,d,e,f,g=this,h={n_:o,sqref:da(g.ranges())};for(h.pivot=O(g.pivotTableName)?u:"1",a=g.iconSetType(),O(a)&&(a=0),h.c_=[{n_:"cfRule",type:"iconSet",priority:g.priority()?""+g.priority():"1",c_:[{n_:"iconSet",iconSet:rc(a),reverse:g.reverseIconOrder()?"1":u,showValue:g.showIconOnly()?"0":u,c_:[{n_:"cfvo",type:"percent",val:"0"}]}]}],b=h.c_[0].c_[0].c_,c=g.NV,d=0,e=c.length;d<e;d++)f=c[d],b.push({n_:"cfvo",type:tc(f.iconValueType),val:U(T(f.iconValue)),gte:f.isGreaterThanOrEqualTo===!1?"0":u});return g.deK&&h.c_[0].c_.push({n_:n,c_:[{n_:"ext",r_:[1,17],c_:[{n_:"id",c_:[g.deK]}]}]}),h},b.prototype.beK=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q={n_:"conditionalFormatting",r_:[2]},r=wa(),s={n_:"cfRule",type:"iconSet",id:r};for(p.deK=r,O(p.priority())||(s.priority=p.priority()),a=p.iconSetType(),b={n_:"iconSet",iconSet:rc(a)},c=fc(a,p.CZa),c&&(b.custom=1),p.showIconOnly()&&(b.showValue=0),p.reverseIconOrder()&&(c||(b.reverse=1)),d=[{n_:"cfvo",type:"percent",c_:[{n_:"f",c_:[0]}]}],e=p.NV,c&&p.reverseIconOrder()&&(e=e.concat([]).reverse()),f=0;f<e.length;f++)g=e[f],h={n_:"cfvo",type:tc(g.iconValueType),c_:[{n_:"f",c_:[U(S(g.iconValue))]}]},g.isGreaterThanOrEqualTo===!1&&(h.gte=0),d.push(h);for(i=p.CZa,j=0;j<i.length;j++)k=i[j],l=k.iconSetType,m=k.iconIndex,n=zc(l,m),o={n_:"cfIcon",iconSet:rc(n.iconSetType),iconId:n.iconIndex},d.push(o);return b.c_=d,s.c_=[b],q.c_=[s,{n_:"sqref",c_:[da(p.ranges())]}],q},b.prototype.bdK=function(a,b){var c=this;if(!c.eeK())return O(c.condition())&&c.initCondition(),b?c.beK():c.ceK()},b.prototype.feK=function(a,b){var c,d,e,f,g,h,j=this,k=a.c_[0];if(k)for(c=qc(k.iconSet||"3TrafficLights1"),j.showIconOnly(!i.NodeHelper.oca(k.showValue,!0)),j.reverseIconOrder(i.NodeHelper.oca(k.reverse,!1)),j.iconSetType(c),j.ranges(b),d=kc(a),e=1,f=d.length;e<f;e++)g=j.NV[e-1],h=d[e],g?(h.type&&(g.iconValueType=uc(h.type)),O(h.val)||(g.iconValue=$(h.val)),O(h.gte)||(g.isGreaterThanOrEqualTo=!!h.gte)):(g=new Gb((!!h.gte),uc(h.type),$(h.val)),j.NV[e-1]=g);a.c_[1]&&a.c_[1].n_===n&&(j.deK=$b(a.c_[1]))},b.prototype.geK=function(a,b){var c,d,e,f,g,h,j,k,l,m,n=this,o=Z(a,"iconSet");for(n.iconSetType(qc(o.iconSet)),n.ranges(b),O(o.showValue)||n.showIconOnly(!i.NodeHelper.oca(o.showValue,!0)),O(o.reverse)||n.reverseIconOrder(i.NodeHelper.oca(o.reverse,!1)),c=W(o,"cfvo"),d=1,e=c.length;d<e;d++)f=n.NV[d-1],g=c[d],h=g.val,O(h)&&(j=Z(g,"f"),h=p(j&&j.c_&&j.c_[0])),f?(g.type&&(f.iconValueType=uc(g.type)),O(h)||(f.iconValue=0===h?"=0":$(h)),O(g.gte)||(f.isGreaterThanOrEqualTo=!!g.gte)):(f=new Gb((!!g.gte),uc(g.type),$(h)),n.NV[d-1]=f);for(k=W(o,"cfIcon"),d=0,e=k.length;d<e;d++)l=n.CZa[d],m=k[d],l&&(O(m.iconSet)||(l.iconSetType=qc(m.iconSet)),O(m.iconId)||(l.iconIndex=+m.iconId))},b.prototype.cdK=function(a,b,c,d,e,f){var g=this;e?g.geK(a,b):g.feK(a,b),g.initCondition(d)},b.getIcon=function(a,b){return t},b.ofc=function(a,b,c,d,e,f,g){if(g.ko(b)){var h=g.lo(b);a.drawImage(h,c,d,e,f)}else g.fo(b)},b.paintIconSet=function(a,c,d,e,f,g,h,j,k,l){var m,n,o=i.To.No(h.font,1).fontSize,p=o,q=2,s=2,t=d+q;if(c.showIconOnly&&(1===h.hAlign?t=d+f/2-p/2:2===h.hAlign&&(t=d+f-q-p-2)),m=1===h.vAlign?e+g/2-p/2:2===h.vAlign?e+g-s-j/2-p/2:e+s+j/2-p/2,c.iconSetType!==$a.noIcons)if(n=b.getIcon(c.iconSetType,c.iconIndex),n&&"string"===r.getType(n)&&l)try{b.ofc(a,n,t,m,p,p,l)}catch(a){}else Ub(a,c,t,m,p,d,e,f,g)},b}(Bb),b.IconSetRule=Ib,Jb={iconSetType:Da("iconSetType",$a.threeArrowsColored,function(a){this.xW(a)}),reverseIconOrder:Da("reverseIconOrder",!1),showIconOnly:Da("showIconOnly",!1)},r.extend(Ib.prototype,Jb);function _b(a){return"string"==typeof a&&"="!==a[0]&&(a='="'+s.Gb(a,'"','""')+'"'),a}Kb=["ruleType","state","style","priority","stopIfTrue","ranges"],Lb=function(a){Nb(c,a);function c(b,c,d,e){var f=a.call(this,b,u,e)||this,g=f;return g.style(d),g.state(c),f}return c.prototype.V4J=function(a,b){var c,d,e,f=this.ranges();if(f)for(c=sa(f),d=void 0,e=0;e<c;e++)if(d=f[e],d.contains(a,b))return e;return-1},c.prototype.pu=function(a){return a>-1},c.prototype.getExpected=function(a){void 0===a&&(a=0);var b=this.style();return xa(b)?b[a]:b},c.prototype.isRow=function(){var a=this,b=a.ruleType();return O(a.hj)&&(b===Ia.rowStateRule?a.hj=!0:b===Ia.columnStateRule&&(a.hj=!1)),this.hj},c.prototype.isStateRule=function(){return!0},c.prototype.gDJ=function(){var a=this,c=a.state(),d=a.ranges();return b.$V(bb.stateCondition,ab.contains,c,u,u,u,d)},c.prototype.rowStateRuleCreateCondition=function(){return this.gDJ()},c.prototype.columnStateRuleCreateCondition=function(){return this.gDJ()},c.prototype.createCondition=function(){return this[Ia[this.ruleType()]+"CreateCondition"]()},c.prototype.hDJ=function(a){var b=this;return c.StatesPriority.indexOf(b.state())<c.StatesPriority.indexOf(a.state())},c.prototype.fromJSON=function(a,b,c){var d=Kb;O(a.condition)||(d=Kb.concat(["condition"])),Fa.call(this,b,d,a,c),this.initCondition(b)},c.prototype.toJSON=function(a){var b,c,d=this;return O(d.condition())&&this.initCondition(),b=Ea.call(d,a,Kb),c=d.ruleType(),c===Ia.conditionRuleBase&&(b.condition=d.condition().toJSON()),b},c.StatesPriority=[4,i.RowColumnStates.invalid,i.RowColumnStates.dirty,i.RowColumnStates.invalidFormula,i.RowColumnStates.inserted,256,i.RowColumnStates.selected,i.RowColumnStates.active,i.RowColumnStates.hover,i.RowColumnStates.edit],c}(rb),b.StateRule=Lb,Lb.prototype.state=Da("state",t),Mb=function(){function a(a){this.AW=[],this.BW=t,this.DW={},this.Vgc=!0,this.WS=a}return a.prototype.getUsedRange=function(){var a,b,c,d,e,f,g,h=this,i=h.getRules(),j={};if(i)for(a=void 0,b=0,c=i;b<c.length;b++)for(d=c[b],a=d.ranges(),e=0,f=a;e<f.length;e++)g=f[e],l(j,m(g));return j},a.prototype.no=function(){this.WS=t},a.prototype.getRule=function(a){return this.AW[a]},a.prototype.count=function(){return sa(this.AW)},a.prototype.w4=function(){return this.AW},a.prototype.UV=function(a){var b,c,d=[],e=this.WS,f=sa(a);for(b=0;b<f;b++)c=e.Tq(a[b]),d.push(c);return d},a.prototype.EW=function(a){var b,c,d,e,f=[],g=this.WS;for(b=0,c=sa(a);b<c;b++)d=a[b],e=new na(d.row,d.col,Ob(d),Pb(d)),0===d.row&&Ob(d)===g.getRowCount()&&(e.row=-1),0===d.col&&Pb(d)===g.getColumnCount()&&(e.col=-1),f.push(e);return f},a.prototype.QV=function(){if(this.Vgc&&(this.DW={},this.AW))for(var a=0;a<sa(this.AW);a++)this.FW(this.AW[a])},a.prototype.OV=function(){this.Vgc&&(this.DW={})},a.prototype.FW=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(this.Vgc)for(b=this,c=b.DW,h=b.UV(a.ranges()),i=b.WS,j=i.getRowCount(),k=i.getColumnCount(),l=0;l<sa(h);l++)for(m=h[l],n=m.row,o=m.col,p=Ob(m),q=Pb(m),n+p-1>=j&&(p=j-n),o+q-1>=k&&(q=k-o),r=0;r<p;r++)for(f=r+n,d=c[f],d||(c[f]=d=[]),s=0;s<q;s++)g=s+o,e=d[g],e||(d[g]=e=[]),e.push(a)},a.prototype.GW=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;if(this.Vgc)for(b=this.DW,g=this.UV(a.ranges()),h=0;h<sa(g);h++)for(i=g[h],j=0;j<Ob(i);j++)if(e=j+i.row,c=b[e])for(k=0;k<Pb(i);k++)if(f=k+i.col,d=c[f]){for(l=[],m=0;m<sa(d);m++)d[m]!==a&&l.push(d[m]);0===sa(l)&&(l=u),c[f]=l}},a.prototype.HW=function(a,b,c,d){var e,f,g,h,i,j;if(this.Vgc)for(b===-1&&(b=0,d=this.WS.getColumnCount()),a===-1&&(a=0,c=this.WS.getRowCount()),g=this.DW,i=0;i<c;i++)if(e=i+a,h=g[e])for(j=0;j<d;j++)f=j+b,h[f]=u},a.prototype.Ayb=function(a,b){var c,d,e=[];for(c=0;c<sa(this.AW);c++)d=this.AW[c],d.contains(a,b)&&e.push(d);return e},a.prototype.addSpecificTextRule=function(a,b,c,d){var e=new xb(2,d,c,a,t,t,b);return this.addRule(e)},a.prototype.addCellValueRule=function(a,b,c,d,e){var f=new xb(1,e,d,a,_b(b),_b(c));return this.addRule(f)},a.prototype.addDateOccurringRule=function(a,b,c){var d=new xb(4,c,b,t,t,t,t,t,a);return this.addRule(d)},a.prototype.addFormulaRule=function(a,b,c){var d=new xb(3,c,b,t,t,t,t,a);return this.addRule(d)},a.prototype.addTop10Rule=function(a,b,c,d){var e=new xb(5,d,c,t,t,t,t,t,a,b);return this.addRule(e)},a.prototype.addUniqueRule=function(a,b){var c=new xb(6,b,a);return this.addRule(c)},a.prototype.addDuplicateRule=function(a,b){var c=new xb(7,b,a);return this.addRule(c)},a.prototype.addAverageRule=function(a,b,c){var d=new xb(8,c,b,t,t,t,t,t,a);return this.addRule(d)},a.prototype.add3ScaleRule=function(a,b,c,d,e,f,g,h,i,j){var k;return k=0===arguments.length?new Bb(11):new Bb(11,a,b,c,d,e,f,g,h,i,j),this.addRule(k)},a.prototype.add2ScaleRule=function(a,b,c,d,e,f,g){var h;return h=0===arguments.length?new Bb(10):new Bb(10,a,b,c,t,t,t,d,e,f,g),this.addRule(h)},a.prototype.addDataBarRule=function(a,b,c,d,e,f){var g;return g=0===arguments.length?new Eb:new Eb(a,b,c,d,e,f),this.addRule(g)},a.prototype.addIconSetRule=function(a,b){var c=new Ib(a,b);return this.addRule(c)},a.prototype.addRowStateRule=function(a,b,c){var d=this,e=new Lb(Ia.rowStateRule,a,b,c);return d.addRule(e)},a.prototype.addColumnStateRule=function(a,b,c){
var d=this,e=new Lb(Ia.columnStateRule,a,b,c);return d.addRule(e)},a.prototype.addRule=function(b){var c,d,e,f,g,h,j,k,l,m,n,o,p,q,r=this,s=r.WS;if(s){if(!b)throw Error(za().Exp_RuleIsNull);for(c=b.ranges(),d=void 0,e=void 0,c&&(f=ha(c),d=f.r,e=f.c,b.ranges(c.slice(0))),g=b.getExpected(),h=g&&g.formatter,h&&"string"==typeof h&&s.oJb(d||0,e||0,h),b.isStateRule()&&(j=b.state(),k=b.isRow(),s.XCJ&&s.XCJ.enableState(j,k)),s.ITa.YUa(),l=1,m=void 0,n=sa(r.AW),m=0;m<n;m++)o=r.AW[m],p=o._ps,q=p.priority||1,p.priority=q+1,b.isStateRule()&&o.isStateRule()&&b.hDJ(o)&&(l=z(l,p.priority),p.priority-=1);return b.priority(l),r.AW.push(b),a.ao(s,"onRuleAdded",{ranges:c}),s.Wq(i.Events.WorksheetDataChanged,{type:"conditionFormat"}),b.context(s),r.FW(b),s.ITa.YUa(!0),s.$p(),b}},a.prototype.removeRule=function(b){var c,d,e,f,g,h,i,j,k=this,l=k.WS,m=l.parent;if(l){if(b&&(c=b.getExpected(),d=c&&c.formatter,d&&"string"==typeof d&&m.UHb[d]&&m.VHb(d),l.ITa.YUa(),k.GW(b),qa(k.AW,b),l.ITa.YUa(!0),a.ao(l,"onRuleRemoved",{priority:b.priority(),ranges:b.ranges()}),b.isStateRule())){for(e=b.state(),f=b.isRow(),g=!1,h=0,i=k.AW;h<i.length;h++)if(j=i[h],j.isStateRule()&&j.state()===e){g=!0;break}g||l.XCJ.disableState(e,f)}l.$p()}},a.prototype.IW=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r;return a.intersect(b,c,d,e)?(f=a.row,g=a.row+Ob(a)-1,h=a.col,i=a.col+Pb(a)-1,j=b,k=b+d-1,l=c,m=c+e-1,n=[],f!==-1&&h!==-1&&j!==-1&&l!==-1&&(l-h>0&&(o=ma(f,h,Ob(a),l-h),n.push(o)),i-m>0&&(p=ma(f,m+1,Ob(a),i-m),n.push(p)),j-f>0&&(q=ma(f,z(l,h),j-f,y(m,i)-z(l,h)+1),n.push(q)),g-k>0&&(r=ma(k+1,z(l,h),g-k,y(m,i)-z(l,h)+1),n.push(r))),sa(n)>0?n:t):[a]},a.prototype.removeRuleByRange=function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.WS;if(s){if(f=[],r.AW)for(s.ITa.YUa(),r.HW(b,c,d,e),g=0,h=sa(r.AW);g<h;g++)if(i=r.AW[g],a.ao(s,"onRuleRemoved",{ranges:[new na(b,c,d,e)]}),i&&i.ranges()&&i.intersects(b,c,d,e))if(s.pivotTables&&i.pivotTableName)j=s.pivotTables.get(i.pivotTableName),j.kIJ(i,b,c,d,e);else{for(k=[],l=r.UV(i.ranges()),m=0,n=sa(l);m<n;m++)o=r.IW(l[m],b,c,d,e),o&&(k=k.concat(o));sa(k)>0?i.ranges(r.EW(k)):f.push(i)}for(p=0,q=sa(f);p<q;p++)qa(r.AW,f[p]);s.ITa.YUa(!0),s.$p()}},a.prototype.clearRule=function(){var b,c,d,e,f,g,h,i=this,j=i.WS,k=j.parent;if(j){for(b=i.AW,j.ITa.YUa(),c=0;c<b.length;c++)d=b[c],e=d.getExpected(),f=e&&e.formatter,a.ao(j,"onRuleRemoved",{ranges:d.ranges()}),f&&"string"==typeof f&&k.UHb[f]&&k.VHb(f);if(j.pivotTables)for(g=j.pivotTables.all(),c=0;c<g.length;c++)h=g[c],h.$IJ();i.AW.length=0,i.QV(),j.ITa.YUa(!0),j.$p()}},a.prototype.getRules=function(a,b){var c,d,e,f,g,h,i,j,k=this,l=k.AW;if(0===arguments.length||0===sa(l))return l;if(a=a===u?-1:a,b=b===u?-1:b,c=[],k.Vgc)d=k.DW,f=void 0,a!==-1&&b!==-1?(f=d[a],f&&(e=f[b],ac(c,e))):a===-1?r.each(d,function(a,d){e=d[b],ac(c,e)}):(f=d[a],f&&r.each(f,function(a,b){ac(c,b)}));else if(g=k.WS,h=g.getRowCount(),i=g.getColumnCount(),j=void 0,a!==-1&&b!==-1)ac(c,k.Ayb(a,b));else if(a===-1)for(j=0;j<h;j++)ac(c,k.Ayb(j,b));else for(j=0;j<i;j++)ac(c,k.Ayb(a,j));return c},a.prototype.containsRule=function(a,b,c){return!(!a||!pa.Bb(this.AW,a))&&a.contains(b,c)},a.prototype.nCJ=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this,n=m.WS;if(n){if(!a)throw Error(za().Exp_RuleIsNull);for(c=a.ranges(),d=void 0,e=void 0,c&&(f=ha(c),d=f.r,e=f.c),g=a.getExpected(),h=g&&g.formatter,h&&"string"==typeof h&&n.oJb(d||0,e||0,h),n.ITa.YUa(),i=0,j=sa(m.AW);i<j;i++)k=m.AW[i]._ps,l=k.priority||1,b<=l&&(k.priority=l+1);return a.priority(b),m.AW[b]=a,a.context(n),m.FW(a),n.$p(),a}},a.prototype.cPJ=function(a,b,c){var d,e,f=this,g=f.WS,h=g.ITa,i=f.AW,j=sa(i),k=!1;for(h.YUa(),d=0;d<j;d++)e=i[d],e&&e.cPJ(a,b,c)&&(k=!0);k&&f.QV()},a.prototype._V=function(a,b,c,d,e){var f,g,h,i=this;if(i.AW&&i.WS)for(f=sa(i.AW),g=0;g<f;g++)h=i.AW[g],h&&(c?h.rI(a,b,d,e):h.tI(a,b,d,e));i.QV()},a.prototype.rI=function(a,b,c,d){this._V(a,b,!0,c,d)},a.prototype.tI=function(a,b,c,d){this._V(a,b,!1,c,d)},a.prototype.aW=function(a,b,c,d,e){var f,g,h,i=this;if(i.AW&&i.WS)for(f=sa(i.AW),g=f-1;g>=0;g--)h=i.AW[g],h&&(c?h.GR(a,b,d,e):h.HR(a,b,d,e),h.ranges().length<=0&&(i.GW(h),i.AW.splice(g,1)));i.QV()},a.prototype.GR=function(a,b,c,d){this.aW(a,b,!0,c,d)},a.prototype.HR=function(a,b,c,d){this.aW(a,b,!1,c,d)},a.prototype.Nm=function(){var a,b,c,d=this.AW;if(d!==t&&sa(d)>0)for(b=0,c=sa(d);b<c;b++)a=d[b],a.Nm&&a.Nm()},a.prototype.XA=function(a,b,c,d,e,f,g,h,i){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S=[],T=[],U=[],V=[],W=[],X=this,Y=X.WS,Z=!i&&Y.CMc();for(a===-1&&(a=0,d=0,f=Y.getRowCount()),b===-1&&(b=0,e=0,g=Y.getColumnCount()),k=0;k<f;k++)for(l=0;l<g;l++)for(m=X.getRules(a+k,b+l),n=0;n<sa(m);n++)if(o=m[n],p=o.ranges(),!o.isStateRule()){for(q=[],r=0;r<sa(p);r++)s=p[r],t=Y.Tq(s),u=t.row,v=t.col,w=Ob(t),x=Pb(t),y=ra(U,s)<=-1||ra(U,s)>-1&&ra(V,o)<=-1,y&&s.contains(a+k,b+l)&&(U.push(s),V.push(o),z=ma(d+k,e+l,-1,-1),u+w>=f+a?z.rowCount=f-k:a<u?z.rowCount=w:z.rowCount=u+w-a,v+x>=g+b?z.colCount=g-l:b<v?z.colCount=x:z.colCount=v+x-b,X===c&&s.containsRange(z)||q.push(z),h&&!ec(W,z)&&W.push(z));q.length>0&&(A=S.indexOf(o),A<0?(Z&&(q=X.GMc(q)),S.push(o),T.push(q)):(Z&&(B=void 0,C=void 0,D=void 0,E=void 0,F=T[A][0].row,G=T[A][0].col,H=q[0],B=H.row-F,C=H.col-G,D=Y.DMc(F,B,!0),E=Y.DMc(G,C),H.row+=D,H.col+=E,q=X.GMc(q)),T[A]=T[A].concat(q)))}for(I=0,J=S.length;I<J;I++)K=X.iga(S[I].toJSON(),S[I].context()),L=K.ranges(),K.ranges(T[I]),M=K.Yw,M&&(N=1===Y.parent.options.referenceStyle,O=ha(L),P=j.formulaToExpression(Y,M,O.r,O.c,N),Q=ha(T[I]),R=j.expressionToFormula(Y,P,Q.r,Q.c,N),K.formula(R)),c.addRule(K);return X.QV(),W},a.prototype.GMc=function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=l.WS,n=[];if(a.length>0){for(b=a[0],c=b.row,d=b.col,e=b.rowCount,f=b.colCount,e+=m.DMc(c,e,!0),f+=m.DMc(d,f),g=[],h=void 0,i=0;i<f;i++)0!==i?0!==m.getColumnWidth(d+i)?h.colCount++:(g.push(h),i=m.Zq(d+i-1)-1-d,h=new na(c,d+i+1,1,0)):h=new na(c,d,1,1);for(g.push(h),j=0;j<e;j++)if(0!==j)if(0!==m.getRowHeight(c+j))for(k=0;k<g.length;k++)g[k].rowCount++;else for(n=n.concat(dc(g)),j=m._q(c+j-1)-1-c,k=0;k<g.length;k++)g[k].rowCount=0,g[k].row=c+j+1;n=n.concat(g)}return n},a.prototype.YA=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=[],w=this,x=w.WS,A=x.getRowCount(3),B=x.getColumnCount(3);for(a===-1&&(a=0,c=x.getRowCount()),b===-1&&(b=0,d=x.getColumnCount()),g=0;g<c;g++)for(h=0;h<d;h++)for(i=w.getRules(a+g,b+h),j=0;j<sa(i);j++)if(k=i[j],l=k.ranges(),!k.isStateRule()){for(m=[],n=0;n<sa(l);n++)o=l[n],p=x.Tq(o),q=p.row,r=p.col,s=Ob(p),t=Pb(p),ec(e,o)||ra(v,o)<=-1&&o.contains(a+g,b+h)&&(v.push(o),a>q&&m.push(ma(q,r,a-q,t)),b>r&&m.push(ma(z(a,q),r,y(a+c,q+s)-z(a,q),b-r)),b+d<r+t&&m.push(ma(z(a,q),b+d,y(a+c,q+s)-z(a,q),r+t-(b+d))),a+c<q+s&&m.push(ma(a+c,r,q+s-(a+c),t)));x&&x.ITa.YUa(),w.Byb(x,v,e,l,A,B,f),u=l.concat(m),u.length>0?(k.yyb(),k.ranges(u)):w.removeRule(k)}w.QV()},a.prototype.Byb=function(a,b,c,d,e,f,g){var h,i,j,k,l,m;for(h=0;h<sa(b);h++){if(i=b[h],j=[i],g)for(k=0;k<sa(c);k++)l=c[k],i.intersect(l.row,l.col,l.rowCount,l.colCount)&&(j=j.concat(a.v_a(i,l,e,f)));for(m=0;m<sa(j);m++)qa(d,j[m])}},a.prototype.jp=function(a,b,c,d,e,f,g,h){var i=16,j=!1,k=!1,l=h.sheet,m=h.row,n=h.col,o=l.zoom(),p=this.oRa(l,m,n,b,h.sheetArea),q=p&&p.iconSet,r=p&&p.dataBar;return(r||q)&&(a.save(),a.beginPath(),r&&(Eb.paintDataBar(a,r,c,d,e,f),j=r.showBarOnly),q&&(i=parseInt(i*o+"",10),(e<i||f<i)&&(a.rect(c,d,e,f),a.clip(),a.beginPath()),Ib.paintIconSet(a,q,c,d,e,f,g,h.lineHeight,o,h.imageLoader),k=q.showIconOnly),a.restore()),j||k},a.prototype.oRa=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q;if(O(e)||3===e){if(f=this,g=a.ss,j=g.Um(b,c))h=j.i,i=j.d;else{if(k=f.getRules(b,c),l=sa(k),l>0){for(k.sort(function(a,b){return a.priority()-b.priority()}),m=t,n=t,o=void 0,p=void 0,q=void 0,q=0;q<l&&(!m||!n);q++)o=k[q],o&&(Q(o,Eb)&&(m=o),Q(o,Ib)&&(n=o));if(m||n)for(m=n=t,q=0;q<l&&(!m||!n)&&(o=k[q],!(o&&(!m&&Q(o,Eb)&&(m=o),!n&&Q(o,Ib)&&(n=o),o.stopIfTrue()&&(p=o.evaluate(a,b,c,d)))));q++);m&&(i=m.evaluate(a,b,c,d)),n&&(h=n.evaluate(a,b,c,d))}g.Wm(b,c,i,h)}return{dataBar:i,iconSet:h}}},a.prototype.bp=function(a,b,c){var d,e,f;if(O(c)||3===c)for(d=this.getRules(a,b),e=0,f=sa(d);e<f;e++)if(d[e]instanceof Ib)return!0;return!1},a.prototype.toJSON=function(a){var b,c,d=[];for(b=0;b<sa(this.AW);b++)c=this.AW[b],d.push(c?c.toJSON(a):t);return 0===sa(d)?u:{rules:d}},a.prototype.fromJSON=function(a,b,c,d){var e,f,g,h,i;if(a&&(e=a.rules)){for(this.AW=[],f=sa(e),g=0;g<f;g++)h=e[g],h.pivot&&d||(i=this.iga(h,b,c),i&&this.AW.push(i));this.Vgc=!bc(e),this.QV()}},a.prototype.IlK=function(a,b,c,d,e){var f=a.type,g;switch(f){case"dataBar":g=new Eb;break;case"iconSet":g=new Ib;break;case"colorScale":g=new Bb;break;default:g=new xb}return g&&g.cdK(a,b,c,d,void 0,void 0,e),g},a.prototype.iga=function(a,b,c){var d,e,f=t;return a&&(d=this.JW(),e=d[a.ruleType],e&&(f=new e,f.fromJSON(a,b,c))),f},a.prototype.JW=function(){if(!this.BW){var a={};a[0]=xb,a[1]=xb,a[2]=xb,a[3]=xb,a[4]=xb,a[5]=xb,a[6]=xb,a[7]=xb,a[8]=xb,a[9]=Bb,a[10]=Bb,a[11]=Bb,a[12]=Eb,a[13]=Ib,a[14]=Lb,a[15]=Lb,this.BW=a}return this.BW},a.prototype.JlK=function(a,b,c,d,e,f,g){var h,j,k,l,m,n,o,p,q,r,s,t;if(a&&a.c_&&!(a.c_.length<=0))for(h=a.c_,k=0,l=h.length;k<l;k++)m=h[k],n=Z(m,"sqref"),o=void 0,n&&(o=ca(n.c_[0]),f&&i.Util.JkK(c,o,!0,b)),p=Z(m,"cfRule"),q=p.type,r=void 0,"dataBar"===q?(r=xc(d,p.id),r||(r=new Eb,this.AW.push(r))):"iconSet"===q?(r=xc(d,p.id),r||(r=new Ib,this.AW.push(r))):"expression"!==q&&"cellIs"!==q||(!j&&e.lossless&&(s=new i.SimpleSharedStrings,s.cdK(e.lossless.sharedColors),t=new i.SimpleSharedStrings,t.cdK(e.lossless.commonSharedStrings),j=new i.SharedDxfs(s,t),j.vlK(e.lossless.sharedDxfs)),r=new xb(3),this.AW.push(r)),!r||!g&&r.pivot||(r.cdK(p,o,b.styleManager,c,!0,j),O(p.priority)||r.priority(+p.priority))},a.prototype.Eq=function(a,b,c,d){var e,f,g,h,j,k,l,m,n,o,p=this;if(p&&p.count()>0&&(e=p.getRules(b,c),f=sa(e),g=void 0,h=t,f>0))for(e.sort(function(a,b){return a.priority()-b.priority()}),j=0;j<f;j++)if(g=e[j]){if(k=p.WS,g.isScaleRule())10!==g.ruleType()&&11!==g.ruleType()||(h=g.evaluate(k,b,c,k.getValue(b,c,d)),h&&(a||(a=new ja),a.backColor===u&&(a.backColor=h)));else if(g.isStateRule()){if(d!==i.SheetArea.viewport)continue;l=g.state(),m=g.isRow(),n=g.ranges(),o=k.XCJ.getState(b,c,l,m,n),h=g.evaluate(k,b,c,o),h&&(a||(a=new ja),a.Yo(h,!1,1))}else h=g.evaluate(k,b,c,k.getValue(b,c,d)),h&&(a||(a=new ja),a.Yo(h,!1,1));if(g.stopIfTrue()&&h)break}return a},a.prototype.Fq=function(a,b,c,d){var e,f,g,h,j,k,l,m,n,o,p,q,r={v5:!1},s=this;if(s&&s.count()>0&&(e=s.getRules(a,b),f=sa(e),g=void 0,h=t,f>0))for(e.sort(function(a,b){return a.priority()-b.priority()}),j=0;j<f;j++)if(g=e[j]){if(k=s.WS,g.isScaleRule()){if(l=g.ruleType(),"backColor"===c&&(10===l||11===l)&&(h=g.evaluate(k,a,b,k.getValue(a,b,d)))){r.Fi=h,r.v5=!0;break}}else if(g.isStateRule()){if(d!==i.SheetArea.viewport)continue;if(m=g.state(),n=g.isRow(),o=g.ranges(),p=k.XCJ.getState(a,b,m,n,o),q=g.style(),!(q&&void 0!==q[c]||g.stopIfTrue()))continue;if(h=g.evaluate(k,a,b,p),h&&h[c]!==u){r.Fi=h[c],r.v5=!0;break}}else{if(q=g.style(),!(q&&void 0!==q[c]||g.stopIfTrue()))continue;if(h=g.evaluate(k,a,b,k.getValue(a,b,d)),h&&h[c]!==u){r.Fi=h[c],r.v5=!0;break}}if(g.stopIfTrue()&&h)break}return r},a}(),b.ConditionalFormats=Mb,ea(Mb);function ac(a,b){if(b)for(var c=0;c<b.length;c++)a.push(b[c])}function bc(a){var b,c,d,e,f,g=sa(a);for(b=0;b<g;b++)if(c=a[b],d=c.ranges)for(e=0;e<d.length;e++)if(f=d[e],f.rowCount>1e3)return!0;return!1}function cc(a){var b,c,d,e,f,g=sa(a);for(b=0;b<g;b++)if(c=a[b],d=c.ranges())for(e=0;e<d.length;e++)if(f=d[e],f.rowCount>1e3)return!0;return!1}function dc(a){var b,c,d=[],e=sa(a);for(c=0;c<e;c++)b=a[c],d.push(ma(b.row,b.col,Ob(b),Pb(b)));return d}function ec(a,b){var c,d;for(c=0;c<a.length;c++)if(d=a[c],d&&d.equals(b))return!0;return!1}function fc(a,b){var c,d=!0,e=!0,f=!0;for(c=0;c<b.length;c++)if(b[c].iconSetType!==a){d=!1;break}for(c=0;c<b.length;c++)if(b[c].iconIndex!==c){e=!1;break}for(c=0;c<b.length;c++)if(b[c].iconIndex!==b.length-1-c){f=!1;break}return!d||!e&&!f}function gc(a){return!(!a.ruleType||a.ruleType()!==Ia.dataBarRule)}function hc(a){if(a.ruleType()===Ia.iconSetRule){var b=a.iconSetType();return 3===b||2===b||19===b||fc(b,a.CZa)}}function ic(a){return a.ruleType()===Ia.rowStateRule||a.ruleType()===Ia.columnStateRule}function jc(a){var b=/&/g,c=/</g,d=/>/g;return"string"==typeof a?a.replace(b,"&amp;").replace(c,"&lt;").replace(d,"&gt;"):O(a)?a:""+a}function kc(a){var b=a.c_&&a.c_[0];if(b)return W(b,"cfvo")}function lc(a){var b,c=a.c_&&a.c_[0];return c&&(b=W(c,"color"),b&&b.length>0)?b.map(function(a){return Y(a)}):[]}function mc(a,b,c){switch(a){case"cellIs":return wb[b];case"containsText":return Na.contains;case"beginsWith":return Na.beginsWith;case"endsWith":return Na.endsWith;case"notContainsText":return Na.doesNotContain;case"timePeriod":return Ua[c]}}function nc(a,b,c){var d,e,f;switch(a){case Ia.cellValueRule:return d={type:"cellIs"},O(c)||(d.operator=wb[c]),d;case Ia.specificTextRule:return e="containsText",f="contains",2===c?(e="beginsWith",f="beginsWith"):3===c?(e="endsWith",f="endsWith"):1===c?(e="notContainsText",f="notContains"):0===c&&(f="containsText"),d={type:e,operator:f};case Ia.formulaRule:return d={type:"expression"},O(c)||(d.operator=c),d;case Ia.dateOccurringRule:return d={type:"timePeriod"},O(b)||(d.timePeriod=vb[b]),d;case Ia.top10Rule:return d={type:"top10"},O(c)||(d.operator=c),d;case Ia.uniqueRule:return d={type:"uniqueValues"},O(c)||(d.operator=c),d;case Ia.duplicateRule:return d={type:"duplicateValues"},O(c)||(d.operator=c),d;case Ia.averageRule:return d={type:"aboveAverage"},O(c)||(d.operator=c),d;case Ia.twoScaleRule:return d={type:"colorScale"},O(c)||(d.operator=c),d;default:return}}function oc(a){var b={num:0,min:1,max:2,percent:3,percentile:4,formula:6,autoMin:5,autoMax:7};return b[a]}function pc(a){var b={0:"num",1:"min",2:"max",3:"percent",4:"percentile",6:"formula",5:"autoMin",7:"autoMax"};return b[a]}function qc(a){var b={"3Arrows":0,"3ArrowsGray":1,"3Flags":4,"3TrafficLights1":5,"3TrafficLights2":6,"3Signs":7,"3Symbols":8,"3Symbols2":9,"4Arrows":10,"4ArrowsGray":11,"4RedToBlack":12,"4Rating":13,"4TrafficLights":14,"5Arrows":15,"5ArrowsGray":16,"5Rating":17,"5Quarters":18,"3Stars":3,"3Triangles":2,"5Boxes":19,NoIcons:20};return b[a]}function rc(a){var b={0:"3Arrows",1:"3ArrowsGray",4:"3Flags",5:"3TrafficLights1",6:"3TrafficLights2",7:"3Signs",8:"3Symbols",9:"3Symbols2",10:"4Arrows",11:"4ArrowsGray",12:"4RedToBlack",13:"4Rating",14:"4TrafficLights",15:"5Arrows",16:"5ArrowsGray",17:"5Rating",18:"5Quarters",3:"3Stars",2:"3Triangles",19:"5Boxes",20:"NoIcons"};return b[a]}function sc(a){var b={beginsWith:2,endsWith:2,notContainsText:2,containsText:2,expression:3,containsBlanks:3,notContainsBlanks:3,containsErrors:3,notContainsErrors:3,timePeriod:4,today:4,tomorrow:4,yesterday:4,last7Days:4,lastMonth:4,nextMonth:4,thisWeek:4,nextWeek:4,lastWeek:4,thisMonth:4,top10:5,uniqueValues:6,duplicateValues:7,aboveAverage:8,belowAverage:8,aboveOrEqualToAverage:8,belowOrEqualToAverage:8},c=b[a];return c!==u?c:1}function tc(a){var b={1:"num",4:"percent",5:"percentile",7:"formula"};return b[a]}function uc(a){var b={num:1,percent:4,percentile:5,formula:7};return b[a]}function vc(a){return"lowestValue"===a||"highestValue"===a}function wc(a){return a=_(a),"string"==typeof a&&"="!==a.charAt(0)?"="+a:a}function xc(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c].deK===b)return a[c]}function yc(a,b){var c;return O(a.val)?O(b)||(c=p(_(b.c_&&b.c_[0]))):c=a.val,c}function zc(a,b){if(10===a){if(3===b)return{iconSetType:0,iconIndex:2};if(0===b)return{iconSetType:0,iconIndex:0}}else if(15===a){if(4===b)return{iconSetType:0,iconIndex:2};if(0===b)return{iconSetType:0,iconIndex:0};if(2===b)return{iconSetType:0,iconIndex:1};if(3===b)return{iconSetType:10,iconIndex:2};if(1===b)return{iconSetType:10,iconIndex:1}}else if(11===a){if(3===b)return{iconSetType:1,iconIndex:2};if(0===b)return{iconSetType:1,iconIndex:0}}else if(16===a){if(4===b)return{iconSetType:1,iconIndex:2};if(0===b)return{iconSetType:1,iconIndex:0};if(2===b)return{iconSetType:1,iconIndex:1};if(3===b)return{iconSetType:11,iconIndex:2};if(1===b)return{iconSetType:11,iconIndex:1}}else if(14===a){if(3===b)return{iconSetType:5,iconIndex:2};if(2===b)return{iconSetType:5,iconIndex:1};if(1===b)return{iconSetType:5,iconIndex:0}}else if(13===a){if(0===b)return{iconSetType:17,iconIndex:1};if(1===b)return{iconSetType:17,iconIndex:2};if(2===b)return{iconSetType:17,iconIndex:3};if(3===b)return{iconSetType:17,iconIndex:4}}return{iconSetType:a,iconIndex:b}}},"./dist/plugins/conditional/conditional.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/conditional/conditional.res.en.js");b.SR={en:d}},"./dist/plugins/conditional/conditional.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_RuleIsNull="The argument 'rule' is null",b.Exp_NotSupported="Not supported exception"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;Object.defineProperty(b,"__esModule",{value:!0}),d=Math.PI,e=Math.round,f=Math.cos,g=Math.sin,h="#4d82b8 #4d82b8 #4d82b8 #4d82b8",i="#326f5b",j="#76a797",k="#A4802b",l="#EAC282",m="#9E381C",n="#D86344",o="#646262",p="#808080",q="#353535",r="#303030",s="#505050",t="#727272",u=[[{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.5},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.5},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d}],[{strokeStyle:k,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:r,fillColor:s,fillColor2:"#d86344",rotate:0},{strokeStyle:r,fillColor:s,fillColor2:"#eac282",rotate:0},{strokeStyle:r,fillColor:s,fillColor2:j,rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:n,fillColor2:"white",rotate:.25*d},{strokeStyle:k,fillColor:l,fillColor2:"white",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"white",rotate:d*-.25}],[{strokeStyle:m,fillColor:n,fillColor2:"",rotate:.25*d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d*-.25}],[{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.75},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.25},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.75},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.25},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:q,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:p,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:t,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:q,fillColor:s,fillColor2:"",rotate:0},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:0},{strokeStyle:i,fillColor:j,fillColor2:"",rotate:0}],[{strokeStyle:i,fillColor:j,fillColor2:"",rotate:d},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.75},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.5},{strokeStyle:k,fillColor:l,fillColor2:"",rotate:d*-.25},{strokeStyle:m,fillColor:n,fillColor2:"",rotate:0}],[{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.75},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.5},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:d*-.25},{strokeStyle:o,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:h,fillColor2:"",rotate:0}],[{strokeStyle:s,fillColor:s,fillColor2:"",rotate:2*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:.5*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:.5*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:1*d},{strokeStyle:s,fillColor:s,fillColor2:"",rotate:2*d}],[{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:t,fillColor:h,fillColor2:"",rotate:0}]];function v(a,b,c,d,e){a.beginPath(),a.moveTo(b,c),a.lineTo(b+d,c),a.lineTo(b+d,c+e),a.lineTo(b,c+e),a.lineTo(b,c),a.closePath(),a.fill(),a.stroke()}function w(a,b,c,d,f,g){var h,i;a.translate(d,f),a.strokeStyle=u[b][c].strokeStyle,h=u[b][c].fillColor.split(" "),i=e(.2*g),a.fillStyle=h[0],v(a,i+.5,3*i+.5,i,2*i),a.fillStyle=h[1],v(a,2*i+.5,2*i+.5,i,3*i),a.fillStyle=h[2],v(a,3*i+.5,i+.5,i,4*i),a.fillStyle=h[3],v(a,4*i+.5,.5,i,5*i)}b.drawSignal=w;function x(a,b,c,d,f,g){var h,i;a.translate(d,f),a.strokeStyle=u[b][c].strokeStyle,h=u[b][c].fillColor.split(" "),a.fillStyle=u[b][c].strokeStyle,i=e(g/2),a.fillStyle=h[0],v(a,.5,.5,i,i),a.fillStyle=h[1],v(a,i+.5,.5,i,i),a.fillStyle=h[2],v(a,.5,i+.5,i,i),a.fillStyle=h[3],v(a,i+.5,i+.5,i,i)}b.drawMagicCube=x;function y(a,b,c,e,f,g){a.translate(e+g/2,f+g/2),a.strokeStyle=u[b][c].strokeStyle,4===c?(a.beginPath(),a.arc(0,0,g/2,0,u[b][c].rotate),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(0,0,g/2,0,u[b][c].rotate),a.closePath(),a.stroke()):0===c?(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.arc(0,0,g/2,0,u[b][c].rotate),a.stroke(),a.closePath()):1===c?(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-g/2),a.arc(0,0,g/2,.5*-d,0),a.lineTo(0,0),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.arc(0,0,g/2,0,2*d),a.stroke()):2===c?(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-g/2),a.arc(0,0,g/2,.5*-d,.5*d),a.moveTo(0,0),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.arc(0,0,g/2,0,2*d),a.stroke()):3===c&&(a.beginPath(),a.arc(0,0,g/2,0,2*d),a.closePath(),a.fillStyle="white",a.fill(),a.beginPath(),a.moveTo(0,0),a.lineTo(0,-g/2),a.arc(0,0,g/2,.5*-d,d),a.lineTo(0,0),a.fillStyle=u[b][c].fillColor,a.fill(),a.arc(0,0,g/2,0,2*d),a.stroke(),a.closePath())}b.drawSector=y;function z(a,b,c){a.moveTo(f(.1*d)*b,-g(.1*d)*b),a.lineTo(f(.3*d)*c,-g(.3*d)*c),a.lineTo(0*b,-g(.5*d)*b),a.lineTo(f(.7*d)*c,-g(.7*d)*c),a.lineTo(f(.9*d)*b,-g(.9*d)*b),a.lineTo(f(1.1*d)*c,-g(1.1*d)*c),a.lineTo(f(1.3*d)*b,-g(1.3*d)*b),a.lineTo(0*c,-g(1.5*d)*c),a.lineTo(f(1.7*d)*b,-g(1.7*d)*b),a.lineTo(f(1.9*d)*c,-g(1.9*d)*c),a.lineTo(f(.1*d)*b,-g(.1*d)*b)}function A(a,b,c,e,h,i){var j=i,k=j/1.8,l=k/2.5;a.translate(k+e,k+h),a.strokeStyle="#727272",a.fillStyle=u[b][c].fillColor,a.beginPath(),2===c&&(a.strokeStyle="#727272",z(a,k,l),a.fill(),a.stroke(),a.strokeStyle=u[b][c].strokeStyle,z(a,k,l),a.stroke(),a.closePath()),0===c&&(a.fillStyle="white",z(a,k,l),a.fill(),a.stroke(),a.strokeStyle="#727272",z(a,k,l),a.stroke(),a.closePath()),1===c&&(a.strokeStyle=u[b][c].fillColor,a.moveTo(0*k,-g(.5*d)*k),a.lineTo(f(.7*d)*l,-g(.7*d)*l),a.lineTo(f(.9*d)*k,-g(.9*d)*k),a.lineTo(f(1.1*d)*l,-g(1.1*d)*l),a.lineTo(f(1.3*d)*k,-g(1.3*d)*k),a.lineTo(0*l,-g(1.5*d)*l),a.fill(),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(0*k,-g(.5*d)*k),a.lineTo(-f(.7*d)*l,-g(.7*d)*l),a.lineTo(-f(.9*d)*k,-g(.9*d)*k),a.lineTo(-f(1.1*d)*l,-g(1.1*d)*l),a.lineTo(-f(1.3*d)*k,-g(1.3*d)*k),a.lineTo(0*l,-g(1.5*d)*l),a.fillStyle="white",a.fill(),a.closePath(),a.beginPath(),a.strokeStyle="#727272",z(a,k,l),a.stroke(),a.closePath())}b.drawStar=A;function B(a,b,c,d,e,f){2===c?E(a,b,c,d,e,f):0===c?C(a,b,c,d,e,f):1===c&&D(a,b,c,d,e,f)}b.drawIconTypeIsEight=B;function C(a,b,c,f,g,h){var i=h,j=e(i/2);a.translate(f+j,g+j),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),a.arc(0,0,j,0,2*d),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(0,0,j,0,2*d),a.closePath(),a.stroke(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.375*-i,.1*-i,.75*i,.2*i),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.1*-i,.375*-i,.2*i,.75*i),a.closePath(),a.fill(),a.stroke()}function D(a,b,c,e,f,g){var h=g;a.translate(e,f),a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),a.arc(.5*h,.5*h,.5*h,0,2*d),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(.5*h,.5*h,.5*h,0,2*d),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(h/3,.1*h),a.lineTo(h/1.5,.1*h),a.lineTo(.625*h,.6*h),a.lineTo(.375*h,.6*h),a.lineTo(h/3,.1*h),a.moveTo(.625*h,.85*h),a.arc(.5*h,.8*h,.15*h,0,2*d),a.fillStyle=u[b][c].fillColor2,a.fill(),a.closePath()}function E(a,b,c,f,g,h){var i=h;a.translate(e(f+i/2),e(i/2+g)),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),a.arc(0,0,i/2,0,2*d),a.closePath(),a.fillStyle=u[b][c].fillColor,a.fill(),a.beginPath(),a.arc(0,0,i/2,0,2*d),a.stroke(),a.closePath(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.325*-i,.25*-i,.2*i,.5*i),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=u[b][c].fillColor2,a.fillRect(.325*-i,.05*i,.65*i,.2*i),a.closePath(),a.fill(),a.stroke()}function F(a,b,c,d,e,f){2===c?I(a,b,c,d,e,f):0===c?H(a,b,c,d,e,f):1===c&&G(a,b,c,d,e,f)}b.drawIconTypeIsNine=F;function G(a,b,c,e,f,g){var h=g;a.translate(e,f),a.beginPath(),a.strokeStyle=u[b][c].strokeStyle,a.moveTo(h/3,.5),a.lineTo(h/1.5,.5),a.lineTo(.625*h,.65*h),a.lineTo(.375*h,.65*h),a.lineTo(h/3,.5),a.moveTo(.65*h,.85*h),a.arc(.5*h,.85*h,.15*h,0,2*d),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function H(a,b,c,d,f,g){var h,i,j=g;a.translate(e(d+j/2),e(f+j/2)),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),h=.5*j,i=.075*j,V(a,-h,-i),U(a,-h,i),U(a,-i,i),U(a,-i,h),U(a,i,h),U(a,i,i),U(a,h,i),U(a,h,-i),U(a,i,-i),U(a,i,-h),U(a,-i,-h),U(a,-i,-i),U(a,-h,-i),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function I(a,b,c,d,f,g){var h=g;a.translate(e(d+h/2),e(f+h/2)),a.strokeStyle=u[b][c].strokeStyle,a.rotate(u[b][c].rotate),a.beginPath(),a.fillStyle=u[b][c].fillColor,a.fillRect(.375*-h,.25*-h,.2*h,.5*h),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=u[b][c].fillColor,a.fillRect(.375*-h,.05*h,.75*h,.2*h),a.closePath(),a.fill(),a.stroke()}function J(a,b,c,d,f,g){var h=1.2*g;a.translate(d,f),a.strokeStyle=p,a.fillStyle=p,v(a,e(.2*h)+.5,.5,e(.06*h),e(.8*h)),a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),V(a,.4*h,.5),U(a,.4*h,.5*h),U(a,.9*h,.25*h),U(a,.4*h,.5),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}b.drawFlag=J;function K(a,b,c,d,e,f){2===c?M(a,b,c,d,e,f):1===c?P(a,b,c,d,e,f):O(a,b,c,d,e,f)}b.drawIconTypeIsSen=K;function L(a,b,c,f,g,h){var i=e(h);a.strokeStyle=u[b][c].strokeStyle,a.fillStyle=u[b][c].fillColor,v(a,f+.5,g+.5,i,i),a.beginPath(),a.arc(i/2+f+.5,i/2+g+.5,.375*i,0,2*d),a.fillStyle=u[b][c].fillColor2,a.fill(),a.stroke()}b.drawTrafficLight=L;function M(a,b,c,e,f,g){var h=g;a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),a.arc(h/2+e,h/2+f,h/2,0,2*d),a.fillStyle=u[b][c].fillColor,a.closePath(),a.fill(),a.stroke()}b.drawCircle=M;function N(a,b,c,d,e,f){1===c?Q(a,b,c,d,e,f):0===c?R(a,b,c,d,e,f):2===c&&S(a,b,c,d,e,f)}b.drawIconTypeIsTwo=N;function O(a,b,c,d,f,g){var h=g;a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),a.translate(d+e(h/2),f+e(h/2)),a.beginPath(),V(a,0,-h/2),U(a,h/2,0),U(a,0,h/2),U(a,-h/2,0),U(a,0,-h/2),a.fillStyle=u[b][c].fillColor,a.closePath(),a.fill(),a.stroke()}function P(a,b,c,d,f,g){var h=e(g);a.translate(d,f),a.strokeStyle=u[b][c].strokeStyle,a.beginPath(),V(a,0,h),U(a,h/2,h-h/2*Math.sqrt(3)),U(a,h,h),U(a,0,h),a.fillStyle=u[b][c].fillColor,a.closePath(),a.fill(),a.stroke()}function Q(a,b,c,d,f,g){var h=g;a.strokeStyle=u[b][c].strokeStyle,a.translate(e(h/2+d),e(h/2+f)),a.beginPath(),a.rotate(u[b][c].rotate),V(a,-h/2,-h/5.4),U(a,h/2,-h/5.4),U(a,h/2,h/5.4),U(a,-h/2,h/5.4),U(a,-h/2,-h/5.4),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function R(a,b,c,d,f,g){a.strokeStyle=u[b][c].strokeStyle;var h=g;a.translate(e(h/2+d),e(h/2+f)),a.beginPath(),V(a,-h/2,-h/3),U(a,h/2,-h/3),U(a,0,h/3),U(a,-h/2,-h/3),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function S(a,b,c,d,f,g){a.strokeStyle=u[b][c].strokeStyle;var h=g;a.translate(e(h/2+d),e(h/2+f)),a.beginPath(),V(a,-h/2,h/3),U(a,h/2,h/3),U(a,0,-h/3),U(a,-h/2,h/3),a.fillStyle=u[b][c].fillColor,a.fill(),a.stroke()}function T(a,b,c,d,f,g){var h,i,j,k,l=g/3.5,m=u[b].length-1;a.strokeStyle=u[b][m-c].strokeStyle,a.translate(e(1.75*l+d),e(1.75*l+f)),a.rotate(u[b][m-c].rotate),a.beginPath(),h=.25*l,i=1.25*l,j=.75*l,k=1.75*l,V(a,-j,-k),U(a,h,-k),U(a,h,h),U(a,i,-j),U(a,i,h),U(a,-h,k),U(a,-k,h),U(a,-k,-j),U(a,-j,h),U(a,-j,-k),a.fillStyle=u[b][m-c].fillColor,a.fill(),a.stroke()}b.drawArrows=T;function U(a,b,c){a.lineTo(e(b)+.5,e(c)+.5)}function V(a,b,c){a.moveTo(e(b)+.5,e(c)+.5)}},"./dist/plugins/contextMenu/context-menu-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.Ul.vl,f=d.Go,g=d.GC$,h="gc.command.executed",i="insertComment",j="editComment",k="gc.spread.",l="left",m="top",n=function(a){o(b,a);function b(b,c){var d=a.call(this,b,e(b))||this,f=d;return f.Eu=c,d}return b.prototype.Qla=function(a,b,c){var d=this,e=a[0];d.kma&&d.kma.ai&&d.kma.ai(e,b,c,d.Eu)},b.prototype.OT=function(a,b,c,d,e){var f=this,g=f.Sla(c,d);f.kma=a,f.Qla(g,b,e)},b.prototype.Sla=function(b,c){var d=this,e=d.yo();return e.css([l,m],[b,c]),e.empty(),a.prototype.Ao.call(this),d.QQ(),e},b.prototype.Loa=function(a){var b,c,d,e=this,f=e.yo();return"block"!==f.css("display")||(b=f.offset(),b.top+=document.body.clientTop||0,b.left+=document.body.clientLeft||0,c=a.x,d=a.y,c<b.left||c>f.width()+b.left||d<b.top||d>f.height()+b.top)},b.prototype.QQ=function(){var a=this;a.Eu.bind(h,function(){a.close()})},b.prototype.Tla=function(){var a=this;a.Eu.unbind(h)},b.prototype.close=function(){var b,c,d,e=this,f=e.kma;f&&f.xc&&(b=[k+i,k+j],c=f.ZPa,(!c||b.indexOf(c.name)<0)&&(d=f.xc.getActiveSheet(),d&&d.mm&&d.mm.Qq()),e.kma.no()),e.Tla(),e.vo(e.Cj)&&g("#"+e.Cj).remove(),a.prototype.close.call(this)},b}(f),b.ContextMenuViewDialog=n},"./dist/plugins/contextMenu/context-menu.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c]);
}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/contextMenu/context-menu.js")),d(c("./dist/plugins/contextMenu/menu-view.js")),d(c("./dist/plugins/contextMenu/context-menu.ns.js"));var e=c("./dist/plugins/contextMenu/context-menu-dialog.js");b.Cyb=e.ContextMenuViewDialog},"./dist/plugins/contextMenu/context-menu.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib,Jb,Kb,Lb,Mb,Nb,Ob,Pb,Qb,Rb,Sb,Tb,Ub,Vb,Wb,Xb,Yb,Zb,$b,_b,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/plugins/contextMenu/context-menu-dialog.js"),f=c("./dist/plugins/contextMenu/menu-view.js"),g=c("Core"),h=c("./dist/plugins/contextMenu/context-menu.ns.js"),i=g.GC$,j=d.Common.j.Fa,k=d.Common.j.za,l=g.Ul.nl,m="gc.spread.contextMenu.",n="gc.spread.",o="gc-spread-",p="gc.spread.pivot",q="gc-spread-pivot-selected",r="viewport",s="colHeader",t="rowHeader",u="slicer",v="timeline",w="sheetTab",x="corner",y="pivotPageFilter",z="pivotTopLeft",A="pivotHeader",B="pivotEmptyLabel",C="pivotContent",D="pivotGrandTotal",E="FieldName",F="SortType",G="pivotSummarizeValuesBy",H="pivotExpandOrCollapse",I="pivotTableGroup",J="OpenPivotGroupDialog",K="pivotTableUnGroup",L="pivotShowValueAs",M="pivotShowDetails",N="pivotRefresh",O="removeField",P="pivotTable",Q="removePivotGrandTotal",R="openValueFieldSettingDialogCmd",S="pivotSum",T="UpdatePivotValueFieldCmd",U="pivotCount",V="pivotAverage",W="pivotMax",X="pivotMin",Y="pivotProduct",Z="pivotNoCalculation",$="pivotGrandtotal",_="pivotColumnTotal",aa="pivotRowTotal",ba="pivotOf",ca="pivotParentRowTotal",da="pivotDifferenceFrom",ea="pivotPercentDifferenceFro",fa="pivotRunningTotalIn",ga="pivotPercentRunningTotalIn",ha="pivotRankSmallestToLargest",ia="pivotOfParentTotal",ja="pivotParentColumnTotal",ka="pivotRankLargestToSmallest",la="pivotIndex",ma="pivotMoreOptions",na="pivotFilter",oa="pivotClearFilterFrom",pa="pivotKeepOnlySelectedItems",qa="pivotHideSelectedItems",ra="pivotTop10",sa="pivotLabelFilters",ta="pivotValueFilters",ua="pivotExpand",va="pivotCollapse",wa="pivotExpandEntireField",xa="pivotCollapseEntireField",ya="createDialogForValueFilter",za="createDialogForLabelFilter",Aa="OpenPivotShowValueAsDialog",Ba="filterFieldLabelValue",Ca="ClearCommand",Da="pivotSort",Ea="removeSlicer",Fa="toggleComment",Ga="deleteComment",Ha="editComment",Ia="unhideSheet",Ja="hideSheet",Ka="unhideRows",La="unhideColumns",Ma="hideRows",Na="pinRows",Oa="pinColumns",Pa="promote",Qa="demote",Ra="addAfter",Sa="addBefore",Ta="addAbove",Ua="addBelow",Va="moveUp",Wa="moveDown",Xa="expandAllLevels",Ya="collapseAllLevels",Za="expandLevel",$a="expandLevel1",_a="expandLevel2",ab="expandLevel3",bb="expandLevel4",cb="expandLevel5",db="expandLevel6",eb="expandLevel7",fb="expandLevel8",gb="expandLevel9",hb="hideColumns",ib="sortAscend",jb="sortDescend",kb="sort",lb="filter",mb="insertComment",nb="deleteSheet",ob="insertNote",pb="replyComment",qb="insertSheet",rb="insertRows",sb="insertColumns",tb="deleteRows",ub="deleteColumns",vb="clearContents",wb="paste",xb="pasteOptions",yb="pasteFormatting",zb="pasteValues",Ab="pasteFormula",Bb="pasteAll",Cb="cut",Db="copy",Eb="pasteValuesFormatting",Fb="pasteFormulaFormatting",Gb="separator",Hb="groupHeader",Ib="slicerSortAscend",Jb="slicerSortDescend",Kb="table",Lb="tableInsert",Mb="tableDelete",Nb="tableInsertRowsAbove",Ob="tableInsertRowsBelow",Pb="tableInsertColumnsLeft",Qb="tableInsertColumnsRight",Rb="tableInsertRows",Sb="tableInsertColumns",Tb="tableDeleteRows",Ub="tableDeleteColumns",Vb="insertCopiedCells",Wb="insertCutCells",Xb="shiftCellsDown",Yb="shiftCellsRight",Zb="allSheets",$b="tableInsertRowsAboveForContextMenu",_b="tableInsertRowsBelowForContextMenu",ac="tableDeleteRowsForContextMenu",bc="tableInsertColumnsLeftForContextMenu",cc="tableInsertColumnsRightForContextMenu",dc="tableDeleteColumnsForContextMenu",ec="row",fc="col",gc=void 0,hc=new d.Common.ResourceManager(h.SR,"ContextMenu"),ic=hc.getResource.bind(hc),jc={sheetTab:function(a,b,c){return RegExp("sheetTab","i").test(c.workArea)&&a.tabStripHitInfo&&a.tabStripHitInfo.sheetTab&&"newSheet"!==a.tabStripHitInfo.sheetTab.sheetName&&"allSheets"!==a.tabStripHitInfo.sheetTab.sheetName},outline:function(a,b,c){return!!(RegExp("outline","i").test(c.workArea)&&a.worksheetHitInfo&&a.worksheetHitInfo.outlineHitInfo)},viewport:function(a,b,c){if(RegExp("viewport","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&!a.worksheetHitInfo.floatingObjectHitInfo&&!a.worksheetHitInfo.shapeHitInfo&&!a.worksheetHitInfo.pivotTableInfo&&!a.worksheetHitInfo.commentHitInfo)return rc(b,c)&&sc(b,c)&&vc(b,c)&&yc(b,c)&&zc(b,c)&&Ac(b,c)},rowHeader:function(a,b,c){if(RegExp("rowHeader","i").test(c.workArea)&&a.worksheetHitInfo&&2===a.worksheetHitInfo.hitTestType)return rc(b,c)&&sc(b,c)&&tc(b,c)&&uc(b,c)&&Fc(b,c)&&Cc(b,c)},colHeader:function(a,b,c){var d,e,f,h=a.worksheetHitInfo;if(RegExp("colHeader","i").test(c.workArea)&&h&&1===h.hitTestType&&(d=g.UCJ(b),e=d&&d.ITa.getFreeAreaRowCount(1),f=h.row<e,!f))return rc(b,c)&&sc(b,c)&&tc(b,c)&&uc(b,c)&&Gc(b,c)&&Dc(b,c,a)},corner:function(a,b,c){if(RegExp("corner","i").test(c.workArea)&&a.worksheetHitInfo&&0===a.worksheetHitInfo.hitTestType)return rc(b,c)&&sc(b,c)&&vc(b,c)&&yc(b,c)},slicer:function(a,b,c){return RegExp("slicer","i").test(c.workArea)&&a.worksheetHitInfo&&a.worksheetHitInfo.shapeHitInfo&&a.worksheetHitInfo.shapeHitInfo.shape&&"Slicer"===a.worksheetHitInfo.shapeHitInfo.shape.drawingType},timeline:function(a,b,c){var d=RegExp("timeline","i").test(c.workArea),e=a.worksheetHitInfo&&a.worksheetHitInfo.shapeHitInfo&&a.worksheetHitInfo.shapeHitInfo.shape&&"Timeline"===a.worksheetHitInfo.shapeHitInfo.shape.drawingType;return d&&e},chart:function(a,b,c){return RegExp("chart","i").test(c.workArea)&&a.worksheetHitInfo&&a.worksheetHitInfo.floatingObjectHitInfo&&a.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"2"===a.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},shape:function(a,b,c){return RegExp("shape","i").test(c.workArea)&&a.worksheetHitInfo&&a.worksheetHitInfo.shapeHitInfo},table:function(a,b,c){var d=g.UCJ(b),e=d&&d.tables;return RegExp("table","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&!a.worksheetHitInfo.floatingObjectHitInfo&&!a.worksheetHitInfo.shapeHitInfo&&!a.worksheetHitInfo.pivotTableInfo&&!a.worksheetHitInfo.commentHitInfo&&e&&e.wKb()},vpWithoutTb:function(a,b,c){if(RegExp("vpWithoutTb","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&!a.worksheetHitInfo.floatingObjectHitInfo&&!a.worksheetHitInfo.shapeHitInfo&&!a.worksheetHitInfo.pivotTableInfo&&!a.worksheetHitInfo.commentHitInfo){var d=g.UCJ(b),e=d.tables,f=e&&e.wKb();return!f&&rc(b,c)&&sc(b,c)&&vc(b,c)&&yc(b,c)}},pivotTablePageFilterArea:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotPageFilter","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo&&0===a.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableCornerArea:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotTopLeft","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo&&1===a.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableEmptyLabelArea:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotEmptyLabel","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo&&3===a.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableHeaderArea:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotHeader","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo&&2===a.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableGrandTotalArea:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotGrandTotal","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo&&5===a.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableContentArea:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotContent","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo&&4===a.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTable:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotTable","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo}},kc=[];function mc(a){var b,c;if(a.slicers){if(b=a.slicers.all(),!b||k(b))return null;for(c in b)if(b[c].isSelected())return!0;return!1}}function nc(a,b,c){var d,e,f,g,h=b===ec?"rowCount":"colCount";for(d=0;d<a.length;d++)for(e=a[d],f=e[b]===-1?0:e[b],g=0;g<e[h];g++)c(f+g)}function oc(a,b){var c=[],d=-1,e;for(e=a.row;e<a.row+a.rowCount;e++)b[e]!==!1&&d===-1&&(d=e),b[e]===!1&&d!==-1&&(c.push([d,e-d]),d=-1);return d!==-1&&c.push([d,e-d]),c}function pc(a,b){var c,d,e,f;if(1===b.colCount&&b.row===-1){if(c=b.col,c===a.$q()&&(d=c-1,d>=0&&!a.getColumnVisible(d)))return!0}else if(1===b.rowCount&&b.col===-1&&(e=b.row,e===a.ar()&&(f=e-1,f>=0&&!a.getRowVisible(f))))return!0}function qc(a){var b,c,d;if(a.slicers){if(b=a.slicers.all(),!b||k(b))return null;c=[];for(d in b)b[d].isSelected()&&c.push(b[d]);return c}}function rc(a,b){var c,d=b.name,e=b.group;if([n+Db,n+Cb,n+xb].indexOf(d)<0&&n+xb!==e)return!0;if(c=g.UCJ(a),c&&c.ODJ&&(n+xb===d||n+xb===e))return!1;switch(d){case n+Ab:case n+yb:case n+Fb:case n+zb:case n+Eb:if(c&&c.tu().G4===!0)return!1}return!0}function sc(a,b){if([n+vb].indexOf(b.name)<0)return!0;var c=g.UCJ(a);return!c||!c.ODJ}function tc(a,b){if([n+sb,n+ub,n+rb,n+tb].indexOf(b.name)<0)return!0;var c=g.UCJ(a);return!c||!c.ODJ}function uc(a,b){var c,d=b.name;return[n+hb,n+La,n+Ma,n+Ka].indexOf(d)<0||(c=g.UCJ(a),!c||!c.ODJ||d!==n+Ma&&d!==n+Ka)}function vc(a,b){var c,d,e,f,h,i,j,k=[n+mb,n+Ha,n+Fa,n+Ga],l=b.name;if(k.indexOf(l)<0)return!0;if(c=g.UCJ(a),d=c.getActiveRowIndex(),e=c.getActiveColumnIndex(),c&&c.comments){if(f=c.comments.get(d,e))return l!==n+mb;if(l===n+Ha||l===n+Fa)return!1;if(l===n+mb)return!0;for(h=c.getSelections(),i=0;i<h.length;i++)if(j=h[i],xc(j,c))return!0;return!1}}function wc(a,b){var c,d,e,f,g,h;if(b.comments)for(c=b.comments.all(),d=void 0,e=void 0,f=0;f<a.length;f++)for(g=a[f],h=0;h<c.length;h++)if(!c[h].locked()&&(e=c[h].nT,d=c[h].oT,e>=g.row&&e<g.row+g.rowCount&&d>=g.col&&d<g.col+g.colCount))return!0;return!1}function xc(a,b){var c,d,e,f;if(b.comments)for(c=b.comments.all(),d=void 0,e=void 0,f=0;f<c.length;f++)if(e=c[f].nT,d=c[f].oT,e>=a.row&&e<a.row+a.rowCount&&d>=a.col&&d<a.col+a.colCount)return!0;return!1}function yc(a,b){var c,d,e,f,h;return[n+kb,n+lb].indexOf(b.name)<0||(c=g.UCJ(a),(!c||!c.ODJ)&&(d=c.getSelections(),!(!d||1!==d.length)&&(e=d[0],f=Hc(c,e),!(f&&(h=f.range(),e.row<h.row||e.col<h.col||e.row+e.rowCount>h.row+h.rowCount||e.col+e.colCount>h.col+h.colCount)))))}function zc(a,b){var c,d;return[n+Vb].indexOf(b.name)<0||(c=g.UCJ(a),d=c&&c.tu(),d&&!d.G4&&d.n5&&1===d.n5.length&&1===c.getSelections().length&&Bc(c))}function Ac(a,b){var c,d;return[n+Wb].indexOf(b.name)<0||(c=g.UCJ(a),d=c&&c.tu(),d&&d.G4&&d.n5&&1===d.n5.length&&1===c.getSelections().length&&Bc(c))}function Bc(a){var b,c,d,e,f,g;if(a.ODJ)return!1;if(b=a.getActiveRowIndex(),c=a.getActiveColumnIndex(),d=a.tu(),!d.YHb)return!1;if(a.tables&&a.tables.find(b,c))return!1;for(e=a.ITa.getSpans(),f=0;f<e.length;f++)if(g=e[f],b>=g.row&&b<g.row+g.rowCount&&c>=g.col&&c<g.col+g.colCount)return!1;return!0}function Cc(a,b){var c,d,e,f,h,i=g.UCJ(a),j=[n+t+Pa,n+t+Qa].indexOf(b.name),k=[n+t+Ta,n+t+Ra,n+t+Sa,n+t+Ua,n+t+Va,n+t+Wa].indexOf(b.name),l=j>-1,m=k>-1;return i&&i.ODJ&&(c=i.ODJ,l||m)?(d=c.u7J(),d&&(e=c.options.menuItemVisibility,f=[e.promoteMenuItemVisible,e.demoteMenuItemVisible],h=[e.addAboveMenuItemVisible,e.addAfterMenuItemVisible,e.addBeforeMenuItemVisible,e.addBelowMenuItemVisible,e.moveUpMenuItemVisible,e.moveDownMenuItemVisible],d=l&&f[j],!d&&c.C7J()&&(d=m&&h[k])),d):!(l||m)}function Dc(a,b,c){var d,e,f,h,i,j=g.UCJ(a),k=9,l=n+s,m=[Xa,Ya].map(function(a){return l+a}).indexOf(b.name),o=Ec(k,function(a){return l+Za+(a+1)}).indexOf(b.name),p=m>-1,q=o>-1;return j&&j.ODJ&&(d=j.ODJ,d.u7J()&&(q||p))?(e=d.options.menuItemVisibility,f=[e.expandAllLevelMenuItemVisible,e.collapseAllLevelMenuItemVisible],q?(h=c.ZL=c.ZL?c.ZL:d.x7J()+1,i=parseInt(b.name.charAt((l+Za).length),10),i<=Math.min(k,h)&&e.expandToLevelMenuItemVisible):p&&f[m]):!(q||p)}function Ec(a,b){var c,d=[];for(c=0;c<a;c++)d.push(b(c,d));return d}function Fc(a,b){var c,d,e,f,h,i,j,k;if([n+t+Vb,n+t+Wb].indexOf(b.name)<0)return!0;if(c=g.UCJ(a),c&&c.ODJ)return!1;if(d=c.tu(),e=c.getActiveRowIndex(),c.tables)for(f=c.tables.all(),h=0;h<f.length;h++)if(i=f[h],e>i.cj&&e<i.cj+i.Xj)return!1;for(j=c.ITa.getSpans(),h=0;h<j.length;h++)if(k=j[h],e>k.row&&e<k.row+k.rowCount)return!1;if(!d.YHb||d.n5&&1!==d.n5.length||1!==c.getSelections().length)return!1;if(b.name===n+t+Wb){if(d.G4&&d.n5&&c.getColumnCount()%d.n5[0].colCount===0)return!0}else if(b.name===n+t+Vb&&!d.G4&&d.n5&&c.getColumnCount()%d.n5[0].colCount===0)return!0;return!1}function Gc(a,b){var c,d,e,f,h,i,j,k;if([n+s+Vb,n+s+Wb].indexOf(b.name)<0)return!0;if(c=g.UCJ(a),c&&c.ODJ)return!1;if(d=c.tu(),e=c.getActiveColumnIndex(),c.tables)for(f=c.tables.all(),h=0;h<f.length;h++)if(i=f[h],e>i.dj&&e<i.dj+i.OZ)return!1;for(j=c.ITa.getSpans(),h=0;h<j.length;h++)if(k=j[h],e>k.col&&e<k.col+k.colCount)return!1;if(!d.YHb||d.n5&&1!==d.n5.length||1!==c.getSelections().length)return!1;if(b.name===n+s+Vb){if(!d.G4&&d.n5&&c.getRowCount()%d.n5[0].rowCount===0)return!0}else if(b.name===n+s+Wb&&d.G4&&d.n5&&c.getRowCount()%d.n5[0].rowCount===0)return!0;return!1}function Hc(a,b){var c,d,e;if(!b)return null;for(g.Ul.FLJ(b,a.getRowCount(),a.getColumnCount()),c=b.row;c<b.row+b.rowCount;c++)for(d=b.col;d<b.col+b.colCount;d++)if(a.tables&&(e=a.tables.find(c,d)))return e;return null}function Ic(a,b,c,d){var e,f;for(e=0;e<b.length;e++)f=b[e],f.UIb(c,d,!0,gc,f.xKb())}function Jc(a){var b,c,d,e=a;for(b=0;b<e.length-1;b++)for(c=b+1;c<e.length;c++)e[b].row<e[c].row&&(d=e[b],e[b]=e[c],e[c]=d);return e}function Kc(a){var b,c,d,e=a;for(b=0;b<e.length-1;b++)for(c=b+1;c<e.length;c++)e[b].col<e[c].col&&(d=e[b],e[b]=e[c],e[c]=d);return e}function Lc(a,b,c,d){var e=a.ITa.getSpans(gc,3);b>=0?(Nc(a,e,b,d,3),Nc(a,a.ITa.getSpans(gc,2),b,d,2)):c>=0&&(Mc(a,e,c,d,3),Mc(a,a.ITa.getSpans(gc,1),c,d,1))}function Mc(a,b,c,d,e){var f,g,h,i,j,k,l,m;for(f=0,g=b.length;f<g;f++)if(h=b[f],c>h.col&&c<h.col+h.colCount)for(i=a.getStyle(h.row,h.col,e),j=c;j<c+d;j++)for(k=h.row;k<h.row+h.rowCount;k++)a.setStyle(k,j,i,e),k===h.row+h.rowCount-1&&(l=a.getCell(h.row+h.rowCount-1,h.col),m=l.borderBottom(),m&&a.getCell(k,j).borderBottom(m))}function Nc(a,b,c,d,e){var f,g,h,i,j,k,l,m;for(f=0,g=b.length;f<g;f++)if(h=b[f],c>=h.row&&c<=h.row+h.rowCount)for(i=a.getStyle(h.row,h.col,e),j=c;j<c+d;j++)for(k=h.col;k<h.col+h.colCount;k++)a.setStyle(j,k,i,e),k===h.col+h.colCount-1&&(l=a.getCell(h.row,h.col+h.colCount-1),m=l.borderRight(),m&&a.getCell(j,k).borderRight(m))}function Oc(a,b,c,d,e,f){var h,i,j,k,l,m,n=g.VCJ(a,b.sheetName);return!!n&&(h=b.considerAllSheets,i=a.LVJ(),n.suspendPaint(),j=g.Commands.bWa(n.name()),c?(l=void 0,e&&(l=e(n,b)),l&&l.cancel||(h?g.Commands._xb(i,b):n.ITa.undo(b[j]),f&&f(n,b,l))):(h?g.Commands.Zxb(i):n.ITa.startTransaction(),k=d(n,b),h?g.Commands.$xb(i,b):b[j]=n.ITa.endTransaction()),n.resumePaint(),h&&(m=g.UCJ(a),m&&n!==m&&m.repaint()),k)}function Pc(a,b,c){var d;if(c>0){for(d=b+1;d<a.getRowCount();d++)if(c-=a.getRowHeight(d),c<=0)return d-b}else if(c<0)for(d=b-1;d>=0;d--)if(c+=a.getRowHeight(d),c>=0)return d-b;return 0}function Qc(a,b,c){var d;if(c>0){for(d=b+1;d<a.getColumnCount();d++)if(c-=a.getColumnWidth(d),c<=0)return d-b}else if(c<0)for(d=b-1;d>=0;d--)if(c+=a.getColumnWidth(d),c>=0)return d-b;return 0}function Rc(a,b,c,d){var e=g.VCJ(a,b.sheetName);e&&c.execute({cmd:wb,sheetName:e.name(),pasteOption:d})}function Sc(a,b,c,d){return Oc(a,b,c,function(c){var e,f=qc(c);if(f&&0!==f.length){for(e in f)f.hasOwnProperty(e)&&f[e].sortState(d);a.changeSelectionInCommandExecuting(b,null,null,[],f)}})}function Tc(a){a.Os(8,ic().hideSheetFailureInfo)}function Uc(a,b){var c=b.name(),d=a.getSheetIndex(c),e={sheetName:c,propertyName:"isVisible",cancel:!1,sheetIndex:d,oldValue:!1,newValue:!0};return a.Wq(g.Events.SheetChanging,e),!e.cancel&&(b.visible(!0),void a.Wq(g.Events.SheetChanged,{sheetName:c,propertyName:"isVisible",sheetIndex:d,oldValue:!1,newValue:!0}))}function Vc(a,b,c){var d,e={oldSheet:b,newSheet:c,cancel:!1};return a.Wq(g.Events.ActiveSheetChanging,e),!e.cancel&&(d={oldValue:!0,newValue:!1,sheetName:b.name(),propertyName:"isSelected",cancel:!1,sheetIndex:a.getSheetIndex(b.name())},a.Wq(g.Events.SheetChanging,d),!d.cancel&&(d={oldValue:!1,newValue:!0,sheetName:c.name(),propertyName:"isSelected",cancel:!1,sheetIndex:a.getSheetIndex(c.name())},a.Wq(g.Events.SheetChanging,d),!d.cancel&&void 0))}function Wc(a,b){var c,d=g.UCJ(a);a.Wq(g.Events.ActiveSheetChanged,{oldSheet:b,newSheet:d}),c={oldValue:!0,newValue:!1,sheetName:b.name(),propertyName:"isSelected",sheetIndex:a.getSheetIndex(b.name())},a.Wq(g.Events.SheetChanged,c),c={oldValue:!1,newValue:!0,sheetName:d.name(),propertyName:"isSelected",sheetIndex:a.getSheetIndex(d.name())},a.Wq(g.Events.SheetChanged,c)}lc=function(){function a(){var a=this;a.menuView=new f.MenuView,a.menuData=a.BRJ()}return a.prototype.BRJ=function(){return[{text:ic().copy,name:n+Db,command:m+Db,iconClass:o+Db,workArea:r+s+t+u+x+P+v},{text:ic().cut,name:n+Cb,command:m+Cb,iconClass:o+Cb,workArea:r+s+t+u+x+v},{text:ic().pasteOptions,name:n+xb,iconClass:o+xb,type:Hb,workArea:r+s+t+u+x+v},{command:m+Bb,name:n+Bb,iconClass:o+Bb,group:n+xb,text:ic().pasteAll,workArea:r+s+t+u+x+v},{command:m+Ab,name:n+Ab,iconClass:o+Ab,group:n+xb,text:ic().pasteFormula,workArea:r+s+t+x},{command:m+zb,name:n+zb,iconClass:o+zb,group:n+xb,text:ic().pasteValues,workArea:r+s+t+x},{command:m+yb,name:n+yb,iconClass:o+yb,group:n+xb,text:ic().pasteFormatting,workArea:r+s+t+x},{command:m+Eb,name:n+Eb,iconClass:o+Eb,group:n+xb,text:ic().pasteValuesFormatting,workArea:r+s+t+x},{command:m+Fb,name:n+Fb,iconClass:o+Fb,group:n+xb,text:ic().pasteFormulaFormatting,workArea:r+s+t+x},{text:ic().paste,name:n+wb,command:m+zb,iconClass:o+xb,workArea:r+s+t+x},{type:Gb},{text:ic().pinRows,name:n+Na,command:m+Na,workArea:t},{text:ic().pinColumns,name:n+Oa,command:m+Oa,workArea:s},{type:Gb},{text:ic().promote,name:n+t+Pa,command:m+Pa,workArea:t},{text:ic().demote,name:n+t+Qa,command:m+Qa,workArea:t},{type:Gb},{text:ic().moveUp,name:n+t+Va,command:m+Va,workArea:t},{text:ic().moveDown,name:n+t+Wa,command:m+Wa,workArea:t},{type:Gb},{text:ic().addAfter,name:n+t+Ra,command:m+Ra,workArea:t},{text:ic().addBefore,name:n+t+Sa,command:m+Sa,workArea:t},{text:ic().addAbove,name:n+t+Ta,command:m+Ta,workArea:t},{text:ic().addBelow,name:n+t+Ua,command:m+Ua,workArea:t},{type:Gb},{text:ic().expandAllLevels,name:n+s+Xa,command:m+Xa,workArea:s},{text:ic().collapseAllLevels,name:n+s+Ya,command:m+Ya,workArea:s},{text:ic().expandLevel1,name:n+s+$a,command:m+$a,workArea:s},{text:ic().expandLevel2,name:n+s+_a,command:m+_a,workArea:s},{text:ic().expandLevel3,name:n+s+ab,command:m+ab,workArea:s},{text:ic().expandLevel4,name:n+s+bb,command:m+bb,workArea:s},{text:ic().expandLevel5,name:n+s+cb,command:m+cb,workArea:s},{text:ic().expandLevel6,name:n+s+db,command:m+db,workArea:s},{text:ic().expandLevel7,name:n+s+eb,command:m+eb,workArea:s},{text:ic().expandLevel8,name:n+s+fb,command:m+fb,workArea:s},{text:ic().expandLevel9,name:n+s+gb,command:m+gb,workArea:s},{type:Gb},{text:ic().clearContents,command:m+vb,name:n+vb,workArea:r+s+t+x},{type:Gb},{text:ic().headerInsertCopiedCells,name:n+t+Vb,command:m+t+Vb,workArea:t},{text:ic().headerInsertCutCells,name:n+t+Wb,command:m+t+Wb,workArea:t},{text:ic().headerInsertCopiedCells,name:n+s+Vb,command:m+s+Vb,workArea:s},{text:ic().headerInsertCutCells,name:n+s+Wb,command:m+s+Wb,workArea:s},{text:ic().insertCopiedCells,name:n+Vb,subMenu:[{text:ic().shiftCellsRight,name:n+Vb+Yb,command:m+Vb+Yb,iconClass:o+Yb},{text:ic().shiftCellsDown,name:n+Vb+Xb,command:m+Vb+Xb,iconClass:o+Xb}],workArea:r},{text:ic().insertCutCells,name:n+Wb,subMenu:[{text:ic().shiftCellsRight,name:n+Wb+Yb,command:m+Wb+Yb,iconClass:o+Yb},{text:ic().shiftCellsDown,name:n+Wb+Xb,command:m+Wb+Xb,iconClass:o+Xb}],workArea:r},{text:ic().insertRows,name:n+rb,command:m+rb,workArea:t},{text:ic().insertColumns,name:n+sb,command:m+sb,workArea:s},{text:ic().deleteRows,name:n+tb,command:m+tb,workArea:t},{text:ic().deleteColumns,name:n+ub,command:m+ub,workArea:s},{type:Gb},{text:ic().tableInsert,name:n+Lb,subMenu:[{text:ic().tableInsertColumnsLeft,name:n+Pb,command:bc,iconClass:o+Pb},{text:ic().tableInsertColumnsRight,name:n+Qb,command:cc,iconClass:o+Qb},{text:ic().tableInsertRowsAbove,name:n+Nb,command:$b,iconClass:o+Nb},{text:ic().tableInsertRowsBelow,name:n+Ob,command:_b,iconClass:o+Ob}],workArea:Kb},{text:ic().tableDelete,name:n+Mb,subMenu:[{text:ic().tableDeleteColumns,name:n+Ub,command:dc,iconClass:o+Ub},{text:ic().tableDeleteRows,name:n+Tb,command:ac,iconClass:o+Tb}],workArea:Kb},{type:Gb},{text:ic().insertSheet,name:n+qb,command:m+qb,workArea:w},{text:ic().deleteSheet,name:n+nb,command:m+nb,workArea:w},{type:Gb},{text:ic().filter,name:n+lb,command:m+lb,workArea:r+x},{text:ic().sort,name:n+kb,subMenu:[{text:ic().sortAscend,name:n+ib,command:m+ib,iconClass:o+ib},{text:ic().sortDescend,name:n+jb,command:m+jb,iconClass:o+jb}],workArea:r+x},{text:ic().slicerSortAscend,name:n+Ib,command:m+Ib,iconClass:o+ib,workArea:u},{text:ic().slicerSortDescend,name:n+Jb,command:m+Jb,iconClass:o+jb,workArea:u},{type:Gb},{text:ic().insertComment,name:n+mb,command:m+mb,iconClass:o+mb,workArea:r+x},{text:ic().editComment,name:n+Ha,command:m+Ha,iconClass:o+Ha,workArea:r+x},{text:ic().deleteComment,name:n+Ga,command:m+Ga,iconClass:o+Ga,workArea:r+x},{text:ic().toggleComment,name:n+Fa,command:m+Fa,workArea:r+x},{type:Gb},{text:ic().hideRows,name:n+Ma,command:m+Ma,workArea:t},{text:ic().unhideRows,name:n+Ka,command:m+Ka,workArea:t},{text:ic().hideColumns,name:n+hb,command:m+hb,workArea:s},{text:ic().unhideColumns,name:n+La,command:m+La,workArea:s},{type:Gb},{text:ic().hideSheet,name:n+Ja,command:m+Ja,workArea:w},{text:ic().unhideSheet,name:n+Ia,command:m+Ia,workArea:w},{type:Gb},{text:ic().removeSlicer,name:n+Ea,command:m+Ea,workArea:u+v},{type:Gb},{text:ic().sort,name:n+kb,subMenu:[{text:ic().sortAscend,name:n+ib,command:Da,iconClass:o+ib,commandOptions:{subType:0},placeholder:F},{text:ic().sortDescend,name:n+jb,command:Da,iconClass:o+jb,commandOptions:{subType:1},placeholder:F}],workArea:A},{text:ic().pivotTableRefresh,name:p+N,command:N,iconClass:o+N,workArea:y+z+C+A+D+B},{text:ic().pivotTableRemove_,name:p+O,command:O,iconClass:o+O,workArea:y+z+C+A,placeholder:E},{text:ic().pivotTableRemoveGrandTotal,name:p+Q,command:Q,workArea:D},{text:ic().pivotTableSummarizeValuesBy,name:p+G,subMenu:[{text:ic().pivotTableSum,name:n+S,command:T,commandOptions:{subTotalType:8}},{text:ic().pivotTableCount,name:n+U,command:T,commandOptions:{subTotalType:1}},{text:ic().pivotTableAverage,name:n+V,command:T,commandOptions:{subTotalType:0}},{text:ic().pivotTableMax,name:n+W,command:T,commandOptions:{subTotalType:3}},{text:ic().pivotTableMin,name:n+X,command:T,commandOptions:{subTotalType:4}},{text:ic().pivotTableProduct,name:n+Y,command:T,commandOptions:{subTotalType:5}}],workArea:z+C+D},{text:ic().pivotTableShowValueAs,name:p+L,subMenu:[{text:ic().pivotTableNoCalculation,name:n+Z,command:T,commandOptions:{showValueAsType:0}},{text:ic().pivotTableGrandTotal,name:n+$,command:T,commandOptions:{showValueAsType:1}},{text:ic().pivotTableColumnTotal,name:n+_,command:T,commandOptions:{showValueAsType:3}},{text:ic().pivotTableRowTotal,name:n+aa,command:T,commandOptions:{showValueAsType:2}},{text:ic().pivotTableOf,name:n+ba,command:Aa,commandOptions:{showValueAsType:4}},{text:ic().pivotTableParentRowTotal,name:n+ca,command:T,commandOptions:{showValueAsType:5}},{text:ic().pivotTableParentColumnTotal,name:n+ja,command:T,commandOptions:{showValueAsType:6}},{text:ic().pivotTableOfParentTotal,name:n+ia,command:Aa,commandOptions:{showValueAsType:7}},{text:ic().pivotTableDifferenceFrom,name:n+da,command:Aa,commandOptions:{showValueAsType:8}},{text:ic().pivotTablePercentDifferenceFrom,name:n+ea,command:Aa,commandOptions:{showValueAsType:9}},{text:ic().pivotTableRunningTotalIN,name:n+fa,command:Aa,commandOptions:{showValueAsType:10}},{text:ic().pivotTablePercentRunningTotalIn,name:n+ga,command:Aa,commandOptions:{showValueAsType:11}},{text:ic().pivotTableRankSmallestToLargest,name:n+ha,command:Aa,commandOptions:{showValueAsType:12}},{text:ic().pivotTableRankLargestToSmallest,name:n+ka,command:Aa,commandOptions:{showValueAsType:13}},{text:ic().pivotTableIndex,name:n+la,command:T,commandOptions:{showValueAsType:14}}],workArea:z+C},{text:ic().pivotTableFilter,name:p+na,iconClass:o+na,subMenu:[{text:ic().pivotTableClearFilterFrom_,name:n+oa,command:Ca,iconClass:o+oa,placeholder:E,commandOptions:{clearType:0}},{text:ic().pivotTableKeepOnlySelectedItems,name:n+pa,command:Ba,commandOptions:{subType:1}},{text:ic().pivotTableHideSelectedItems,name:n+qa,command:Ba,commandOptions:{subType:2}},{text:ic().pivotTableTop10,name:n+ra,command:ya,commandOptions:{isTop10:!0}},{text:ic().pivotTableLabelFilters,name:n+sa,command:za},{text:ic().pivotTableValueFilters,name:n+ta,command:ya}],workArea:A},{text:ic().pivotTableExpandOrCollapse,name:p+H,subMenu:[{text:ic().pivotTableExpand,name:n+ua,command:ua,iconClass:o+ua},{text:ic().pivotTableCollapse,name:n+va,command:va,iconClass:o+va},{text:ic().pivotTableExpandEntireField,name:n+wa,command:wa,iconClass:o+wa},{text:ic().pivotTableCollapseEntireField,name:n+xa,command:xa,iconClass:o+xa}],workArea:A},{text:ic().pivotTableGroup,name:p+I,command:J,iconClass:o+I,workArea:A},{text:ic().pivotTableUnGroup,name:p+K,command:K,iconClass:o+K,workArea:A},{text:ic().pivotTableShowDetails,name:p+M,command:M,iconClass:o+M,workArea:C},{text:ic().pivotTableValueFieldSettings,name:p+R,command:R,iconClass:o+R,workArea:z+C+D}]},a.prototype.ad=function(a){var b=this;b.Mma||(b.wu=a.commandManager(),j(b.Ela)&&(b.Ela=new e.ContextMenuViewDialog(a.pZJ(),i(a.sv))),b.nla(a),b.kTa={filter:{menuDataDict:[n+lb],checkFunction:function(a){if(a&&a.rowFilter)return!0}},comments:{menuDataDict:[n+mb,n+Ha,n+Ga,n+Fa],checkFunction:function(a){if(a&&a.comments)return!0}},slicer:{menuDataDict:[n+Ib,n+Jb,n+Ea],checkFunction:function(a){if(a&&a.slicers)return!0}},floatingObject:{menuDataDict:[n+zb,n+yb,n+Ab],checkFunction:function(a){var b,c,d;return!a||!a.BR||(b=a.BR(),c=b.fromSheet,d=c&&c.CR,!d||void 0)}},table:{menuDataDict:[n+Lb,n+Mb],checkFunction:function(a){if(a&&a.tables)return!0}},tableSheet:{menuDataDict:[n+wb,n+Na,n+Oa,n+Pa,n+Qa,n+Ta,n+Ra,n+Sa,n+Ua,n+Va,n+Wa,n+Xa,n+Ya,n+$a,n+_a,n+ab,n+bb,n+cb,n+db,n+eb,n+fb,n+gb],checkFunction:function(a){if(a&&a.ODJ)return!0}}},b.Mma=!0)},a.prototype.ola=function(a,b){var c,d,e,f,h,i,k,m,n=this;return b.focus(),c=n.pla(a,b),j(c)?void l(a):(d=g.UCJ(b),void(d&&(e={row:d.getActiveRowIndex(),col:d.getActiveColumnIndex()},d.isEditing()&&c.worksheetHitInfo&&c.worksheetHitInfo.col===e.col&&c.worksheetHitInfo.row===e.row||b.getTab()&&b.getTab().FD)||(n.ad(b),n.qla(c,b),d=g.UCJ(b),d&&(f=d.getSelections()[0],j(f)||j(d.pivotTables)||(h=d.pivotTables.findPivotTable(f.row,f.col),!j(h)&&c.worksheetHitInfo&&(c.worksheetHitInfo.pivotTableInfo=h,i=h.getPivotInfoImp(f.row,f.col,!1,!1,!0),j(i)||(c.worksheetHitInfo.pivotTableCellInfo=i)))),k=n.Fla(n.menuData,c,b),m=n.onOpenMenu(n.menuData,k,c,b),m||(l(a),k.length&&n.jla(k,c,b),n.onMenuOpened()))))},a.prototype.qla=function(a,b){var c=this;c.Ela.Loa(a)&&c.sla(a,b)},a.prototype.sla=function(a,b){var c=this,d=g.UCJ(b);d&&d.isEditing()&&d.endEdit(),c.tla(a)?c.ula(a,b):c.vla(a)&&c.wla(a,b)},a.prototype.vla=function(a){return!!a.worksheetHitInfo},a.prototype.xla=function(a,b,c,d){var e=!0,f,g;if(1===d){for(f=0;f<a.length;f++)g=a[f],g.row===-1&&c>=g.col&&c<g.col+g.colCount&&(e=!1);return e}if(2===d){for(f=0;f<a.length;f++)g=a[f],g.col===-1&&b>=g.row&&b<g.row+g.rowCount&&(e=!1);return e}for(f=0;f<a.length;f++)if(g=a[f],g.contains(b,c))return!1;return!0},a.prototype.tla=function(a){return!(!a.tabStripHitInfo||!a.tabStripHitInfo.sheetTab)},a.prototype.yla=function(a){return a.tabStripHitInfo.sheetTab.sheetName},a.prototype.iDJ=function(a){return a.tabStripHitInfo.sheetTab.sheetIndex},a.prototype.wla=function(a,b){var c=this,d=g.UCJ(b),e=a.worksheetHitInfo;e.floatingObjectHitInfo||e.commentHitInfo||e.shapeHitInfo||(c.Ala(d,e),c.aPa(d))},a.prototype.aPa=function(a){var b,c=a.getActiveRowIndex(),d=a.getActiveColumnIndex(),e=a.comments;e&&(b=e.get(c,d),b&&e.bU===b&&e.hT(b))},a.prototype.zla=function(a){return 3===a.hitTestType},a.prototype.cs=function(a,b,c){a.cs&&a.cs(b,c)},a.prototype.Ala=function(a,b){var c,d,e,f,g=this,h=a.ITa.getSelections(),i=b.row,j=b.col;a.Qs(b.rowViewportIndex<0?-1:b.row,b.colViewportIndex<0?-1:b.col)&&(c=!1,g.xla(h,i,j,b.hitTestType)?c=!0:(d=a.shapes&&a.shapes.all()||[],e=d.filter(function(a){return a.isSelected()}),e.length>0&&(e.forEach(function(a){return a.isSelected(!1)}),c=!0)),c&&(f=a.mm,f.Ala(a,b,i,j),f.hH()))},a.prototype.ula=function(a,b){var c,d=this.iDJ(a),e=b.ACJ(d);e&&(e.HHb()||(c=b.xCJ(),c.forEach(function(a){a.HHb()&&a.HHb(!1,!0)}),e.HHb(!0,!0)),b.BCJ(d,2,!1,!0),this.$Oa(this.menuData,a,b))},a.prototype.pla=function(a,b){var c=b.oia(),d=a.pageX-c.left,e=a.pageY-c.top;return d=d>=0?d:1,e=e>=0?e:1,b.hitTest(d,e,!0)},a.prototype.onOpenMenu=function(a,b,c,d){},a.prototype.onMenuOpened=function(){},a.prototype.jla=function(a,b,c){var d=this;d.Ela.Loa(b)&&(d.Cla(),c.xw(),d.Dla(a,b,c))},a.prototype.Cla=function(){this.Ela.close()},a.prototype.Dla=function(a,b,c){var d=this,e=c.uXJ(),f=b.x,g=b.y;f-=e.left,g-=e.top,d.Ela.OT(d.menuView,a,f,g,c)},a.prototype.Fla=function(a,b,c){var d,e=this,f={};return i.extend(!0,f,a),d=e.I8J(f,b,c),e.J$a(d,b),e.lTa(d,c),e.yKb(d,c),e.UZa(d,c),e.RZa(d),d=e.Bma(d),e.zKb(d),d},a.prototype.I8J=function(a,b,c){var d=this,e=[],f=Object.keys(jc);return i.each(a,function(a,g){var h,i,k,l;if(!j(g))for(g.type===Gb&&e.push(g),h=0;h<f.length;h++)if(i=f[h],k=jc[i],k(b,c,g)&&(l=d.nMc(g,b)))return void e.push(g)}),e},a.prototype.oMc=function(a,b,c){var d,e,f,g,h,i,k=c.placeholder,l=c.name,m=b.area,o=b.value,p=b.menuArea,q=b.colHeadFieldInfo,r=b.rowInfos,s=b.colInfos,t=b.cornerFieldInfo,u=b.activeRowFieldInfo,v=b.activeColFieldInfo;if(j(k))l===n+sa&&(g=u&&u.name||v&&v.name||q&&q.fieldName||t&&t.fieldName,h=a.Vyc,i=g&&h.getFieldInfoByName(g)&&2===h.getFieldInfoByName(g).ny,i&&(c.text=ic().pivotTableLabelFilters_Date));else if(k===E){if(d=void 0,0===p)d=b.pageFieldInfo.fieldName;else if(2===m&&2===p){if(q)d=q.fieldName;else if(d=v&&v.name,j(d)){for(e=v.index;e>=0&&s[e]&&j(s[e].itemName);)e-=1;d=s[e].fieldName}}else if(3===m&&2===p){if(d=u&&u.name,j(d)){for(e=u.index;e>=0&&r[e]&&j(r[e].itemName);)e-=1;d=r[e].fieldName}}else 1===m?1===p?d=b.value:2===p&&t&&(d=t.fieldName):4===p&&(d=b.valueFieldName,2===m?d=v&&v.name||o:3===m&&(d=u&&u.name||o));c.text=c.text.replace("{0}",'"'+d+'"')}else k===F&&4===p&&(d=void 0,f=c.commandOptions.subType,0===f?d=ic().pivotTableSortAscend:1===f&&(d=ic().pivotTableSortDescend),c.text=d);j(c.commandOptions)&&(c.commandOptions={}),c.commandOptions.pivotTableName=a.name(),c.commandOptions.pivotTableCellInfo=b;
},a.prototype.zKb=function(a){var b,c,d=0,e=!1;for(b=0;b<a.length&&(c=a[b].name,c!==n+t+Vb&&c!==n+t+Wb&&c!==n+s+Vb&&c!==n+s+Wb||(e=!0),c!==n+rb&&c!==n+sb||(d=b,!e));b++);e&&a.splice(d,1)},a.prototype.J$a=function(a,b){var c=b.worksheetHitInfo,d=c&&(c.row===gc||c.col===gc);d&&a.splice(0,a.length)},a.prototype.lTa=function(a,b){var c=this,d=g.UCJ(b),e=c.kTa;return i.each(e,function(b,e){var f,g,h;if(!e.checkFunction(d))for(f=e.menuDataDict,g=0,h=f.length;g<h;g++)c.hma(a,f[g],function(a,b){a[b]=null})}),a},a.prototype.nMc=function(a,b){var c,d,e,f,g,h,i,k,l,m,n,o,q,r,s,t=this,u=b.worksheetHitInfo&&b.worksheetHitInfo.pivotTableInfo;if(u&&(c=b.worksheetHitInfo&&b.worksheetHitInfo.pivotTableCellInfo)){if(d=u.options.subtotalsPosition,e=c.value,f=c.area,g=c.menuArea,h=c.cornerFieldInfo,i=c.colHeadFieldInfo,k=c.activeRowFieldInfo,l=c.activeColFieldInfo,m=c.rowInfos,n=c.colInfos,o=c.valueFieldName,q=[p+H,p+na,p+M],q.indexOf(a.name)>-1&&((2===f||3===f)&&4===g||(!j(h)||!j(i))&&e===ic().sigmaValueTemp||3===f&&k&&m[k.index].isSubtotal&&void 0===m[k.index].collapseIndex&&1!==d||2===f&&l&&n[l.index].isSubtotal&&void 0===n[l.index].collapseIndex&&1!==d))return!1;if(r=[p+I,p+K],r.indexOf(a.name)>-1&&(!j(h)||!j(i)))return!1;if(s=[p+R,p+O,p+G,p+L],s.indexOf(a.name)>-1&&j(o)&&4===g&&4===f)return!1;a&&a.subMenu?a.subMenu.forEach(function(a){t.oMc(u,c,a),t.J8J(u,c,a)}):t.oMc(u,c,a)}return!0},a.prototype.J8J=function(a,b,c){var d,e,f,g,h,i,k,l=b.activeRowFieldInfo,m=b.activeColFieldInfo,o=b.cornerFieldInfo,p=b.colHeadFieldInfo,r=b.valueFieldName,s=l&&l.name||m&&m.name||p&&p.fieldName||o&&o.fieldName||r,t=a.Vyc,u=s&&t.getFieldInfoByName(s),v=t.IUJ;switch(c.commandOptions&&u&&(d=c.commandOptions.showValueAsType,e=c.commandOptions.subTotalType,j(d)||(f=u.xFJ&&u.xFJ.showDataAs||0,f===d&&(c.iconClass=q)),j(e)||(g=u.getSubTotalType(),g===e&&(c.iconClass=q))),c.name){case n+oa:h=v.HL[u.Zxc],i=!1,h&&h.cyc()&&(i=!0),k=!!h&&h.dyc(),i||k||(c.disable=!0);break;case n+pa:case n+qa:j(o)&&j(p)||(c.disable=!0)}},a.prototype.yKb=function(a,b){var c,d,e,f=g.UCJ(b),h=f&&f.getSelections();h&&h.length>0&&(c=Hc(f,h[0]),d=f.getActiveRowIndex(),e=f.getActiveColumnIndex(),c&&i.each(a,function(a,b){if(!j(b)&&b.name===n+Lb){var f=b.subMenu;c.checkTableLastRow(d)&&f.splice(3,1),c.checkTableLastCol(e)&&f.splice(1,1)}}))},a.prototype.RZa=function(a){var b,c=this,d=a.length;for(b=d-1;b>=0;b--)a[b]?a[b].subMenu&&c.RZa(a[b].subMenu):a.splice(b,1);return a},a.prototype.Bma=function(a){var b,c,d,e,f,g=[],h=a.length;for(b=0;b<h;b++)a[b]&&a[b].type===Gb&&a[b+1]&&a[b+1].type===Gb||g.push(a[b]);for(h=g.length,c=0,d=0,e=!0,f=!0,b=0;b<h&&(e&&g[b].type===Gb?c++:e=!1,f&&g[h-1-b].type===Gb?d++:f=!1,e||f);b++);return g.splice(h-d,d),g.splice(0,c),g},a.prototype.UZa=function(a,b){var c=this;c.VZa(a,b),c.QZa(a,b)},a.prototype.VZa=function(a,b){var c,d=this,e=g.UCJ(b),f=e&&e.tables,h=e&&e.ODJ;for(c=0;c<a.length;c++)if(a[c]){switch(a[c].name){case n+rb:e.ZZa()||(a[c].disable=!0);break;case n+tb:(!e.ZZa()||f&&f.containTableHeaderTotalRowForSheet())&&(a[c].disable=!0);break;case n+sb:case n+ub:e.$Za()||(a[c].disable=!0);break;case n+Nb:f&&(f.isAcrossTables()||f.containTableHeader()||f.noRoomToInsertRow())&&(a[c].disable=!0);break;case n+Ob:f&&(f.isAcrossTables()||f.noRoomToInsertRow())&&(a[c].disable=!0);break;case n+Tb:f&&(f.checkTableRow()||f.isAcrossTables()||f.containTableHeaderTotalRow())&&(a[c].disable=!0);break;case n+Pb:case n+Qb:f&&(f.isAcrossTables()||f.noRoomToInsertColumn())&&(a[c].disable=!0);break;case n+Ub:f&&(f.checkTableCol()||f.isAcrossTables()||f.isWholeTableCol())&&(a[c].disable=!0);break;case n+Oa:h&&(a[c].disable=!h.enablePinColumn());break;case n+Na:h&&(a[c].disable=!h.enablePinRow())}a[c]&&a[c].subMenu&&d.VZa(a[c].subMenu,b)}},a.prototype.QZa=function(a,b){var c,d,e,f,h=this,i=g.UCJ(b),j=i&&i.options.isProtected,k=i&&i.options.protectionOptions;if(j&&k)for(c=void 0,d=0;d<a.length;d++)if(a[d]){switch(a[d].name){case n+rb:k.allowInsertRows||(a[d].disable=!0);break;case n+sb:k.allowInsertColumns||(a[d].disable=!0);break;case n+tb:k.allowDeleteRows||(a[d].disable=!0);break;case n+ub:k.allowDeleteColumns||(a[d].disable=!0);break;case n+lb:k.allowFilter||(a[d].disable=!0);break;case n+ib:case n+jb:k.allowSort||(a[d].disable=!0);break;case n+Ma:case n+Ka:case n+hb:case n+La:i.ODJ||(a[d].disable=!0);break;case n+Ib:case n+Jb:k.allowEditObjects||a.splice(0,a.length);break;case n+mb:k.allowEditObjects||(a[d]=null);break;case n+Ha:e=void 0,i.comments&&(c=i.comments.get(i.getActiveRowIndex(),i.getActiveColumnIndex()),e=c&&c.lockText()),!k.allowEditObjects&&e&&(a[d]=null);break;case n+Ga:f=void 0,i.comments&&(f=!wc(i.getSelections(),i)),!k.allowEditObjects&&f&&(a[d]=null);break;case n+Nb:case n+Ob:case n+Pb:case n+Qb:case n+Tb:case n+Ub:a[d].disable=!0}a[d]&&a[d].subMenu&&h.QZa(a[d].subMenu,b)}},a.prototype.$Oa=function(a,b,c){var d,e,f,h;if(b.tabStripHitInfo&&(d=this,e=c.xCJ(),f=d.RS(n+Ia))){for(h=0;h<e.length;h++)if(e[h].visible()===g.SheetTabVisible.hidden)return void(f.disable=!1);f.disable=!0}},a.prototype.RS=function(a){var b=this;return b.gma(b.menuData,a)},a.prototype.gma=function(a,b){var c,d=this;return d.hma(a,b,function(a,b){c=a[b]}),c},a.prototype.hma=function(a,b,c){for(var d=this,e=a.length,f=0;f<e;f++)if(!j(a[f])){if(b===a[f].name)return void c(a,f);a[f].subMenu&&d.hma(a[f].subMenu,b,c)}},a.prototype.CRJ=function(a,b){for(var c,d=this,e=a.length,f=0;f<e;f++)c=a[f],j(c)||(b(c),c.subMenu&&d.CRJ(c.subMenu,b))},a.prototype.nla=function(a){var b,c,d,e,f,h,i,l,n,o,p,q,r,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa;function ba(a,b,c){var d,e;for(d=0;d<c;d++)e=b+d,a.indexOf(e)===-1&&a.push(e);return a}this.p5J||(b=a.commandManager(),c={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&(mc(d)?b.execute({cmd:"copyFloatingObjects",sheetName:d.name()}):b.execute({cmd:Db,sheetName:d.name(),ignoreClipboard:!0}))}},b.register(m+Db,c,null,!1,!1,!1,!1),d={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&(mc(d)?b.execute({cmd:"cutFloatingObjects",sheetName:d.name()}):b.execute({cmd:Cb,sheetName:d.name(),ignoreClipboard:!0}))}},b.register(m+Cb,d,null,!1,!1,!1,!1),e={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&(d.isPasteFloatingObject&&d.isPasteFloatingObject()?b.execute({cmd:"pasteFloatingObjects",sheetName:d.name()}):d.isPasteShapes&&d.isPasteShapes()?b.execute({cmd:"pasteShapes",sheetName:d.name()}):b.execute({cmd:wb,sheetName:d.name(),pasteOption:0}))}},b.register(m+Bb,e,null,!1,!1,!1,!1),f={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&b.execute({cmd:wb,sheetName:d.name(),pasteOption:0,shiftCells:g.InsertShiftCell.right})}},b.register(m+Vb+Yb,f,null,!1,!1,!1,!1),b.register(m+Wb+Yb,f,null,!1,!1,!1,!1),b.register(m+s+Vb,f,null,!1,!1,!1,!1),b.register(m+s+Wb,f,null,!1,!1,!1,!1),h={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&b.execute({cmd:wb,sheetName:d.name(),pasteOption:0,shiftCells:g.InsertShiftCell.down})}},b.register(m+Vb+Xb,h,null,!1,!1,!1,!1),b.register(m+Wb+Xb,h,null,!1,!1,!1,!1),b.register(m+t+Vb,h,null,!1,!1,!1,!1),b.register(m+t+Wb,h,null,!1,!1,!1,!1),i={canUndo:!1,execute:function(a,c){var d=3;Rc(a,c,b,d)}},b.register(m+Ab,i,null,!1,!1,!1,!1),l={canUndo:!1,execute:function(a,c){var d=1;Rc(a,c,b,d)}},b.register(m+zb,l,null,!1,!1,!1,!1),n={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&b.execute({cmd:wb,sheetName:d.name(),pasteOption:2})}},b.register(m+yb,n,null,!1,!1,!1,!1),o={canUndo:!1,execute:function(a,c){var d=4;Rc(a,c,b,d)}},b.register(m+Eb,o,null,!1,!1,!1,!1),p={canUndo:!1,execute:function(a,c){var d=5;Rc(a,c,b,d)}},b.register(m+Fb,p,null,!1,!1,!1,!1),q={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&b.execute({cmd:"clear",sheetName:d.name()})}},b.register(m+vb,q,null,!1,!1,!1,!1),r={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=c.commentState||2,r=c.displayMode,s=c.activeRow,t=c.activeCol,u=b.comments.add(s,t,"");u&&(u.commentState(q),r&&u.displayMode(r),d=b.Er(s),e=b.Fr(t),f=b.getCellRect(s,t,d,e),g=b.am(),h=g.Ft(d,e),i=u.location(),j=u.width(),k=u.height(),l=void 0,m=void 0,n=void 0,o=void 0,p=a.ku,f.y+i.y<h.y?(n=Pc(b,s,f.y+i.y-h.y),l=p.ms(b,n),p.ju(b,l.cj,0),b.os()):f.y+i.y+k>h.y+h.height&&(n=Pc(b,s,f.y+i.y+k-(h.y+h.height)),l=p.ms(b,n),p.ju(b,l.cj,0),b.os()),f.x+i.x+j>h.x+h.width&&(o=Qc(b,t,f.x+i.x+j-(h.x+h.width)),m=p.Sw(b,o),p.lu(b,m.dj,0),b.qs()))},function(a,b){var c,d=b.activeRow,e=b.activeCol,f=a.comments.get(d,e);if(f)return b.displayMode=f.displayMode(),b.commentState=f.commentState(),c={sheet:a,sheetName:a.name(),comment:f,cancel:!1},a.Wq(g.Events.CommentRemoving,c),{cancel:c.cancel,comment:f}},function(a,b,c){a.Wq(g.Events.CommentRemoved,{sheet:a,sheetName:a.name(),comment:c.comment})})}},b.register(m+mb,r,null,!1,!1,!1,!1),u={canUndo:!1,execute:function(a,b){var c,d,e,f=g.VCJ(a,b.sheetName);f&&(c=b.activeRow,d=b.activeCol,e=f.comments.get(c,d),e&&e.commentState(2,!0))}},b.register(m+Ha,u,null,!1,!1,!1,!1),v={canUndo:!0,execute:function(a,c,d){return Oc(a,c,d,function(a){var d,e,f,g,h,i=c.selections,j=i.length;if(!(j<=0))for(d=0;d<j;d++)for(e=i[d],f=e.row;f<e.row+e.rowCount;f++)for(g=e.col;g<e.col+e.colCount;g++)h=a.comments.get(f,g),!h||a.options.isProtected&&!a.options.protectionOptions.allowEditObjects&&h.locked()||b.execute({cmd:Ga,sheetName:a.name(),row:h.nT,col:h.oT})})}},b.register(m+Ga,v,null,!1,!1,!1,!1),w={canUndo:!1,execute:function(a,b){var c,d,e,f=g.VCJ(a,b.sheetName);f&&(c=b.activeRow,d=b.activeCol,e=f.comments.get(c,d),e&&(2===e.displayMode()?e.displayMode(1):e.displayMode(2)))}},b.register(m+Fa,w,null,!1,!1,!1,!1),x={canUndo:!0,execute:function(a,b,c){return b.considerAllSheets=!0,Oc(a,b,c,function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o=Jc(b.selections);for(d=0;d<o.length;d++){for(c=o[d],e=a.getRange(c.row-1,0,1,c.colCount),f=[],g=0;g<e.colCount;g++)a.getCell(e.row,g).locked()||f.push(g);for(h=c.row,i=c.rowCount,a.addRows(h,i),j=0;j<f.length;j++)for(k=o[d].row;k<o[d].row+o[d].rowCount;k++)a.getCell(k,f[j]).locked(!1);if(a.tables&&i>0)for(l=a.tables.s$(h,-1,i,-1),m=0;m<l.length;m++)n=l[m],n.UIb(h,i,!1,!1);Lc(a,h,-1,i)}})}},b.register(m+rb,x,null,!1,!1,!1,!1),y={canUndo:!0,execute:function(a,b,c){return b.considerAllSheets=!0,Oc(a,b,c,function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o=Kc(b.selections);for(d=0;d<o.length;d++){for(c=o[d],e=a.getRange(0,c.col-1,c.rowCount,1),f=[],g=0;g<e.rowCount;g++)a.getCell(g,e.col).locked()||f.push(g);for(h=c.col,i=c.colCount,a.addColumns(h,i),j=0;j<f.length;j++)for(k=h;k<h+i;k++)a.getCell(f[j],k).locked(!1);if(a.tables&&i>0)for(l=a.tables.s$(-1,h,-1,i),m=0;m<l.length;m++)n=l[m],n.VIb(h,i,!1,!1);Lc(a,-1,h,i)}})}},b.register(m+sb,y,null,!1,!1,!1,!1),z={canUndo:!0,execute:function(a,b,c){return b.considerAllSheets=!0,Oc(a,b,c,function(a){var c,d,e,f,g,h,i,j,k=Jc(b.selections),l=a.filterRowsVisibleInfo&&a.filterRowsVisibleInfo.rowsVisibleInfo,m=l&&Object.keys(l).length>0;for(c=0;c<k.length;c++)if(d=k[c],e=d.row,f=d.rowCount,g=a.getRowCount(),m)for(h=oc(d,l),i=h.length-1;i>=0;i--)e=h[i][0],f=h[i][1],j=a.tables&&a.tables.s$(e,-1,f,-1),a.deleteRows(e,f),j.length>0&&g-a.getRowCount()>0&&(g=a.getRowCount(),Ic(a,j,e,f));else j=a.tables&&a.tables.s$(e,-1,f,-1),a.deleteRows(e,f),j.length>0&&g-a.getRowCount()>0&&Ic(a,j,e,f)})}},b.register(m+tb,z,null,!1,!1,!1,!1),A={canUndo:!0,execute:function(a,b,c){return b.considerAllSheets=!0,Oc(a,b,c,function(a){var c,d,e,f,g,h,i,j=Kc(b.selections);for(c=0;c<j.length;c++)if(d=a.getColumnCount(),e=j[c].col,f=j[c].colCount,g=void 0,a.tables&&(g=a.tables.s$(-1,e,-1,f)),a.deleteColumns(e,f),a.tables&&d-a.getColumnCount()>0)for(h=0;h<g.length;h++)i=g[h],i.VIb(e,f,!0)})}},b.register(m+ub,A,null,!1,!1,!1,!1),B={canUndo:!1,execute:function(a){var b,c,d,e,f=a.getActiveSheetIndex(),h=a.getActiveSheetTabIndex(),i=[],j=g.UCJ(a);b=h>=0?a.SCJ("",g.SheetType.tableSheet):a.vv(a.wv(f)),c=a.xCJ(),c.forEach(function(a){a.HHb()&&i.push(a)}),i.forEach(function(a){a.HHb(!1,!0)}),d={sheetName:b.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:f},a.Wq(g.Events.SheetChanging,d),d.cancel||(e={oldSheet:j,newSheet:b},a.Wq(g.Events.ActiveSheetChanging,e),h>=0?a.QCJ(h,2,b):a.ow(Math.max(0,f),2,b),b.HHb(!0,!0),a.Wq(g.Events.SheetChanged,{sheetName:b.name(),propertyName:"insertSheet",sheetIndex:f}),a.Wq(g.Events.ActiveSheetChanged,{oldSheet:j,newSheet:b}))}},b.register(m+qb,B,null,!1,!1,!1,!1),C={canUndo:!1,execute:function(a,b){var c,d,e,f,h,i,k=g.UCJ(a),l=a.xCJ();l.length>1?(c=[],d=[],l.forEach(function(a,b){if(a.HHb()){var e=a.name();c.push(e),d.push(b)}}),c.length!==l.length?c.length>=1&&(e={oldSheet:k,cancel:!1},f=a.sheets,a.options&&a.options.saveChangesForSheet&&g.Commands.Zxb(f),h=[],c.forEach(function(b,c){var f,i,l=d[c],m=g.VCJ(a,b),n={sheetName:b,propertyName:"deleteSheet",cancel:!1,sheetIndex:l};m===k&&a.Wq(g.Events.ActiveSheetChanging,e),a.Wq(g.Events.SheetChanging,n),e.cancel||n.cancel||(f=a.getSheetIndex(b),!j(f)&&f>=0?(a.removeSheet(f),a.getActiveSheetIndex()===-1&&a.setActiveSheetTab(0)):(f=a.getSheetTabIndex(b),!j(f)&&f>=0&&(a.removeSheetTab(f),a.getActiveSheetTabIndex()===-1&&a.setActiveSheetIndex(0))),h.push(b),a.Wq(g.Events.SheetChanged,{sheetName:b,propertyName:"deleteSheet",sheetIndex:l}),i=g.UCJ(a),m===k&&a.Wq(g.Events.ActiveSheetChanged,{oldSheet:m,newSheet:i}))}),b.deletedSheets=h,a.options&&a.options.saveChangesForSheet&&g.Commands.$xb(f,b),i=g.UCJ(a),i&&!i.isSelected()&&i.HHb(!0,!0)):Tc(k)):Tc(k),a.undoManager().clear()}},b.register(m+nb,C,null,!1,!1,!1,!1),D={canUndo:!0,execute:function(a,c,d){return Oc(a,c,d,function(a){var d,e,f=c.selections,g=f[0],h=Hc(a,g),i=c.activeRow,j=c.activeCol;h?(d=h.range(),d.contains(i,j,1,1)&&(e=h.name(),b.execute({cmd:"contextmenuFilterForTable",sheetName:a.name(),cmdOption:{tableName:e,activeRow:i,activeCol:j,expectedText:a.getText(i,j)}}))):a.rowFilter&&b.execute({cmd:"contextmenuFilterForSheet",sheetName:a.name(),cmdOption:{activeRow:i,activeCol:j,selection:g,expectedText:a.getText(i,j)}})})}},b.register(m+lb,D,null,!1,!1,!1,!1),E={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){var c=b.activeCol,d=b.selections,e=Hc(a,d[0]),f=e?e.dataRange():d[0],h=a.kJb(f,!0,null),i={sheet:a,sheetName:a.name(),col:c,ascending:!0,range:f,compareFunction:gc,groupSort:h.groupSort,ignoreHidden:h.ignoreHidden,cancel:!1};a.Wq(g.Events.RangeSorting,i),i.cancel===!1&&(a.sortRange(f.row,f.col,f.rowCount,f.colCount,!0,[{index:c,ascending:!0,compareFunction:i.compareFunction}],{groupSort:i.groupSort,ignoreHidden:i.ignoreHidden},gc,!!e),a.Wq(g.Events.RangeSorted,i))})}},b.register(m+ib,E,null,!1,!1,!1,!1),F={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){var c=b.activeCol,d=b.selections,e=Hc(a,d[0]),f=e?e.dataRange():d[0],h=a.kJb(f,!0,null),i={sheet:a,sheetName:a.name(),col:c,ascending:!1,range:f,compareFunction:gc,groupSort:h.groupSort,ignoreHidden:h.ignoreHidden,cancel:!1};a.Wq(g.Events.RangeSorting,i),i.cancel===!1&&(a.sortRange(f.row,f.col,f.rowCount,f.colCount,!0,[{index:c,ascending:!1,compareFunction:i.compareFunction}],{groupSort:i.groupSort,ignoreHidden:i.ignoreHidden},gc,!!e),a.Wq(g.Events.RangeSorted,i))})}},b.register(m+jb,F,null,!1,!1,!1,!1),G={canUndo:!0,execute:function(a,b,c){return Sc(a,b,c,1)}},b.register(m+Ib,G,null,!1,!1,!1,!1),H={canUndo:!0,execute:function(a,b,c){return Sc(a,b,c,2)}},b.register(m+Jb,H,null,!1,!1,!1,!1),I={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){var c,d,e,f,g=b.selections;if(g.length>0){for(c=[],d=0,e=g;d<e.length;d++)f=e[d],ba(c,f.row,f.rowCount);try{a.ODJ.togglePinnedRows(c)}catch(a){return!1}}})}},b.register(m+Na,I,null,!1,!1,!1,!1),J={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){var c,d,e,f,g=b.selections;if(g.length>0){for(c=[],d=0,e=g;d<e.length;d++)f=e[d],ba(c,f.col,f.colCount);try{a.ODJ.togglePinnedColumns(c)}catch(a){return!1}}})}},b.register(m+Oa,J,null,!1,!1,!1,!1),K={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.promoteHierarchyLevel(b.activeRow)}catch(a){return!1}})}},b.register(m+Pa,K,null,!1,!1,!1,!1),L={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.demoteHierarchyLevel(b.activeRow)}catch(a){return!1}})}},b.register(m+Qa,L,null,!1,!1,!1,!1),M={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.addHierarchyItemAfter(b.activeRow)}catch(a){return!1}})}},b.register(m+Ra,M,null,!1,!1,!1,!1),N={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.addHierarchyItemBefore(b.activeRow)}catch(a){return!1}})}},b.register(m+Sa,N,null,!1,!1,!1,!1),O={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.addHierarchyItemAbove(b.activeRow)}catch(a){return!1}})}},b.register(m+Ta,O,null,!1,!1,!1,!1),P={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.addHierarchyItemBelow(b.activeRow)}catch(a){return!1}})}},b.register(m+Ua,P,null,!1,!1,!1,!1),Q={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.moveUp(b.activeRow)}catch(a){return!1}})}},b.register(m+Va,Q,null,!1,!1,!1,!1),R={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.moveDown(b.activeRow)}catch(a){return!1}})}},b.register(m+Wa,R,null,!1,!1,!1,!1),S={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.expandAllHierarchyLevels()}catch(a){return!1}})}},b.register(m+Xa,S,null,!1,!1,!1,!1),T={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.collapseAllHierarchyLevels()}catch(a){return!1}})}},b.register(m+Ya,T,null,!1,!1,!1,!1),U={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{var c=parseInt(b.cmd.charAt((m+Za).length),10)-1;a.ODJ.expandHierarchyLevel(c)}catch(a){return!1}})}},Ec(9,function(a){b.register(m+Za+(a+1),U,null,!1,!1,!1,!1)}),V={canUndo:!1,execute:function(a,b){var c,d=b.itemName.substr(10),e=a.TCJ(),f=a.getSheetIndex(d);j(f)&&(f=a.sheets.length+a.getSheetTabIndex(d)),a.MJc.iw(f),c=a.getTab(),c.VMJ(e,f)}},b.register(m+Zb,V,null,!1,!1,!1,!1),W={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(c){a.suspendCalcService(),nc(b.selections,ec,function(a){c.setRowVisible(a,!1)}),a.resumeCalcService()})}},b.register(m+Ma,W,null,!1,!1,!1,!1),X={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(c){a.suspendCalcService(),nc(b.selections,fc,function(a){c.setColumnVisible(a,!1)}),a.resumeCalcService()})}},b.register(m+hb,X,null,!1,!1,!1,!1),Y={canUndo:!1,execute:function(a){var b,c,d,e,f,h,i,j,k,l,m,n,o,p,q=0,r=a.xCJ();if(r.forEach(function(a){a.visible()===g.SheetTabVisible.visible&&(q+=1)}),b=g.UCJ(a),q<=1)return void Tc(b);if(d=[],r.forEach(function(a){a.HHb()&&d.push(a)}),q!==d.length){for(e=0;e<d.length;e++)f=d[e],h=f.name(),i=a.getSheetIndex(h),j={sheetName:h,propertyName:"isVisible",cancel:!1,sheetIndex:i,oldValue:!0,newValue:!1},a.Wq(g.Events.SheetChanging,j),k={cancel:!1,oldSheet:f},h===b.name()&&a.Wq(g.Events.ActiveSheetChanging,k),j.cancel||k.cancel||(f.HHb(!1,!0),kc.push(f),f.visible(!1),l=g.UCJ(a),e===d.length-1&&l&&!l.isSelected()&&(m=l.name(),c={oldValue:!1,newValue:!0,sheetName:m,propertyName:"isSelected",cancel:!1,sheetIndex:a.getSheetIndex(m)},a.Wq(g.Events.SheetChanging,c)),a.Wq(g.Events.SheetChanged,{sheetName:h,propertyName:"isVisible",sheetIndex:i,oldValue:!0,newValue:!1}));n=g.UCJ(a),o=n&&n.name(),c&&(c.cancel?n.ITa.GHb(!1):(n.ITa.GHb(!0),a&&a.MJc&&a.MJc.repaint(),p={oldValue:!1,newValue:!0,sheetName:o,propertyName:"isSelected",sheetIndex:a.getSheetIndex(o)},a.Wq(g.Events.SheetChanged,p))),b!==n&&a.Wq(g.Events.ActiveSheetChanged,{oldSheet:b,newSheet:n})}else Tc(b);a.undoManager().clear()}},b.register(m+Ja,Y,null,!1,!1,!1,!1),Z={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(c){var d=b.selections,e=b.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;j(e)&&(e=b.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=pc(c,d[0])),1===d.length&&e?(c.setRowVisible(d[0].row-1,!0),c.mq(d[0].row-1)):(a.suspendCalcService(),nc(d,ec,function(a){c.setRowVisible(a,!0),a===c._t()&&(c.lq=0,c.os())}),a.resumeCalcService())})}},b.register(m+Ka,Z,null,!1,!1,!1,!1),$={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(c){var d=b.selections,e=b.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;j(e)&&(e=b.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=pc(c,d[0])),1===d.length&&e?(c.setColumnVisible(d[0].col-1,!0),c.rq(d[0].col-1)):(a.suspendCalcService(),nc(d,fc,function(a){c.setColumnVisible(a,!0),a===c.$t()&&(c.qq=0,c.qs())}),a.resumeCalcService())})}},b.register(m+La,$,null,!1,!1,!1,!1),_={canUndo:!1,execute:function(a,b){var c,d,e,f,h,i,k,l=a.xCJ();if(0===kc.length)for(c=0;c<l.length;c++)l[c].visible()===g.SheetTabVisible.hidden&&(kc.push(l[c]),l[c].HHb(!1));if(d=g.UCJ(a),kc.length>0){if(l.forEach(function(a){a!==d&&a.HHb(!1,!0)}),e=void 0,f=void 0,b&&!j(b.activeSheetIndex)&&(e=l[b.activeSheetIndex]),b&&b.unhideSheetIndexes&&b.unhideSheetIndexes.length>0&&(i=b.unhideSheetIndexes,i.forEach(function(b){var c,d=l[b];h=Uc(a,d),h!==!1&&(c=kc.indexOf(l[b]),c>-1&&kc.splice(c,1))}),e||(e=l[i[i.length-1]])),!e){if(e=kc.pop(),!e)return;if(h=Uc(a,e),h===!1)return}if(!e)return;if(k=Vc(a,d,e),k===!1)return;a.setActiveSheet(e.name())}g.UCJ(a)!==d&&Wc(a,d)}},b.register(m+Ia,_,null,!1,!1,!1,!1),aa={canUndo:!1,execute:function(a,c){var d,e,f,h,i=g.VCJ(a,c.sheetName);if(i&&(a.suspendPaint(),d=[],e=i.slicers.all(),e&&!k(e))){for(f in e)e.hasOwnProperty(f)&&(h=e[f],h.isSelected()&&d.push(h.name()));b.execute({cmd:"deleteSlicers",sheetName:i.name(),slicerNames:d}),a.resumePaint()}}},b.register(m+Ea,aa,null,!1,!1,!1,!1),this.p5J=!0)},a.prototype.openAllSheetsListContextMenu=function(a,b,c,d){var e,f=this.menuView.maxHeight();(j(f)||f===-1)&&this.menuView.maxHeight(400),e=this.OYJ(b,c),this.ad(b),this.qla(e,b),this.jla(a,e,b),j(f)?this.menuView.maxHeight(-1):this.menuView.maxHeight(f),this.menuView.EKJ.lL(d)},a.prototype.OYJ=function(a,b){var c=this.pla(b,a),d=2;return 0===a.options.tabStripPosition&&(c.x=c.x+d,c.y=c.y-d),c},a}(),b.ContextMenu=lc,g.Workbook.$n("contextmenu",{init:function(){var a=this;a.contextMenu||(a.contextMenu=new lc),a.contextMenu.nla(this)},setHost:function(){var a=this,b=a.qo;a.contextMenu||(a.contextMenu=new lc),i(b).bind("contextmenu.gcSheet",function(b){if(a.options.allowContextMenu)return a.contextMenu.ola(b,a)})},dispose:function(){i(this.qo).unbind("contextmenu.gcSheet")},onCultureChanged:function(){var a,b,c,d=this.contextMenu;d&&(a=d.menuData,b=d.BRJ(),c={},d.CRJ(b,function(a){j(a.name)||(c[a.name]=a.text)}),d.CRJ(a,function(a){j(a.name)||j(c[a.name])||(a.text=c[a.name])}))},fromJson:function(a){var b=this.contextMenu&&this.contextMenu.menuView,c=a.contextMenu;b&&!j(c)&&(b.ysb=a.scrollable,b.CKJ=a.maxHeight)},toJson:function(a){var b=this.contextMenu&&this.contextMenu.menuView;!b||j(b.ysb)&&j(b.CKJ)||(a.contextMenu={},a.contextMenu.scrollable=b.ysb,a.contextMenu.maxHeight=b.CKJ)}})},"./dist/plugins/contextMenu/context-menu.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/contextMenu/context-menu.res.en.js");b.SR={en:d}},"./dist/plugins/contextMenu/context-menu.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.copy="Copy",b.cut="Cut",b.pasteOptions="Paste Options:",b.pasteAll="All",b.pasteFormula="Formulas",b.pasteValues="Values",b.pasteFormatting="Formatting",b.pasteValuesFormatting="Values&Formatting",b.pasteFormulaFormatting="Formula&Formatting",b.clearContents="Clear Contents",b.insertRows="Insert",b.insertColumns="Insert",b.deleteRows="Delete",b.deleteColumns="Delete",b.insertSheet="Insert",b.deleteSheet="Delete",b.insertComment="Insert Comment",b.filter="Filter",b.sort="Sort",b.insertCopiedCells="Insert Copied Cells...",b.insertCutCells="Insert Cut Cells...",b.shiftCellsRight="Shift Cells Right",b.shiftCellsDown="Shift Cells Down",b.headerInsertCopiedCells="Insert Copied Cells",b.headerInsertCutCells="Insert Cut Cells",b.slicerSortAscend="Sort A to Z",b.slicerSortDescend="Sort Z to A",b.sortAscend="Sort A to Z",b.sortDescend="Sort Z to A",b.hideRows="Hide",b.hideColumns="Hide",b.hideSheet="Hide",b.unhideSheet="Unhide",b.unhideColumns="Unhide",b.unhideRows="Unhide",b.editComment="Edit Comment",b.deleteComment="Delete Comment",b.toggleComment="Show/Hide Comment",b.removeSlicer="Remove",b.removeFloatingObject="Remove",b.tableInsert="Insert",b.tableInsertRowsAbove="Table Rows Above",b.tableInsertRowsBelow="Table Row Below",b.tableInsertColumnsLeft="Table Columns to the Left",b.tableInsertColumnsRight="Table Columns to the Right",b.tableDelete="Delete",b.tableDeleteRows="Table Rows",b.tableDeleteColumns="Table Columns",b.hideSheetFailureInfo="A workbook must contain at least one visible worksheet.\nTo hide, delete or move the selected sheet(s), you must first insert a new sheet or unhide a sheet that is already hidden.",b.pivotTableRefresh="Refresh",b.pivotTableMove="Move",b.pivotTableRemove_="Remove {0}",b.pivotTableRemoveGrandTotal="Remove GrandTotal",b.pivotTableValueFieldSettings="Value Field Settings...",b.pivotTableOptions="PivotTable Options...",b.pivotTableNumberFormat="Number Format...",b.pivotTableSort="Sort",b.pivotTableSummarizeValuesBy="Summarize Values By",b.pivotTableSum="Sum",b.pivotTableCount="Count",b.pivotTableAverage="Average",b.pivotTableMax="Max",b.pivotTableMin="Min",b.pivotTableProduct="Product",b.pivotTableDistinctCount="Distinct Count",b.pivotTableMoreOptions="More Options",b.pivotTableShowValueAs="Show Value As",b.pivotTableNoCalculation="No Calculation",b.pivotTableGrandTotal="% of Grand Total",b.pivotTableColumnTotal="% of Column Total",b.pivotTableRowTotal="% of Row Total",b.pivotTableOf="% Of...",b.pivotTableParentRowTotal="% of Parent Row Total",b.pivotTableParentColumnTotal="% of Parent Column Total",b.pivotTableOfParentTotal="% of Parent Total...",b.pivotTableDifferenceFrom="Difference From...",b.pivotTablePercentDifferenceFrom="% Difference From...",b.pivotTableRunningTotalIN="Running Total In...",b.pivotTablePercentRunningTotalIn="% Running Total In...",b.pivotTableRankSmallestToLargest="Rank Smallest to Largest...",b.pivotTableRankLargestToSmallest="Rank Largest to Smallest...",b.pivotTableIndex="Index",b.pivotTableShowDetails="Show Details",b.pivotTableGroup="Group...",b.pivotTableUnGroup="Ungroup...",b.pivotTableExpandOrCollapse="Expand/Collapse",b.pivotTableFilter="Filter",b.pivotTableSubtotal_="Subtotal {0}",b.pivotTableHideFieldList="Hide Field List",b.pivotTableFieldSettings="Field Settings...",b.pivotTableClearFilterFrom_="Clear Filter From {0}",b.pivotTableKeepOnlySelectedItems="Keep Only Selected Items",b.pivotTableHideSelectedItems="Hide Selected Items",b.pivotTableTop10="Top 10...",b.pivotTableLabelFilters="Label Filters...",b.pivotTableLabelFilters_Date="Date Filters...",b.pivotTableValueFilters="Value Filters...",b.pivotTableExpand="Expand",b.pivotTableCollapse="Collapse",b.pivotTableExpandEntireField="Expand Entire Field",b.pivotTableCollapseEntireField="Collapse Entire Field",b.pivotTableCollapseTo_="Collapse to {0}",b.pivotTableExpandTo_="Expand to {0}",b.pivotTableMove_ToBeginning="Move {0} to Beginning",b.pivotTableMove_Up="Move {0} Up",b.pivotTableMove_Down="Move {0} Down",b.pivotTableMove_ToEnd="Move {0} to end",b.pivotTableMove_ToLeft="Move {0} to left",b.pivotTableMove_ToRight="Move {0} to Right",b.pivotTableMove_ToColumns="Move {0} to columns",b.sigmaValue="\u2211 Values",b.sigmaValueTemp="Values",b.pivotTableSortAscend="Sort Smallest to Largest",b.pivotTableSortDescend="Sort Largest to Smallest",b.pinRows="Pin/Unpin Rows",b.pinColumns="Pin/Unpin Columns",b.promote="Promote",b.demote="Demote",b.moveUp="Move Up",b.moveDown="Move Down",b.addAfter="Add After",b.addBefore="Add Before",b.addAbove="Add Above",b.addBelow="Add Below",b.expandAllLevels="Expand All Levels",b.collapseAllLevels="Collapse All Levels",b.expandLevel1="Expand to Level 1",b.expandLevel2="Expand to Level 2",b.expandLevel3="Expand to Level 3",b.expandLevel4="Expand to Level 4",b.expandLevel5="Expand to Level 5",b.expandLevel6="Expand to Level 6",b.expandLevel7="Expand to Level 7",b.expandLevel8="Expand to Level 8",b.expandLevel9="Expand to Level 9",b.paste="Paste"},"./dist/plugins/contextMenu/menu-view.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=e.GC$,g=e.Ul.Nl,h=d.Common.j,i=h.Fa,j=h.Aa,k=h.C4,l=void 0,m=null,n=document,o=window,p=Math.max,q=Math.min,r=Math.floor,s={AKb:"mouseenter",BKb:"mouseleave",CKb:"click",mHc:"mousewheel",qGc:"DOMMouseScroll",DKb:"gc.command.executed",EKb:".",FKb:"gc-ui-contextmenu",sKJ:".gcScrollWrapper",GKb:"-",HKb:"container",IKb:"hover",JKb:"disable-hover",KKb:"text",LKb:"icon",MKb:"menuitem",NKb:"nonselective-menuitem",OKb:"menuitem-content",PKb:"sup-container",QKb:"separator",RKb:"sup-indicator",SKb:"subitems-container",TKb:"group-container",UKb:"title",VKb:"group-header",WKb:"groupitems-container",XKb:"groupitem",YKb:"nonexecutable",ZKb:"executable",$Kb:"disable",NKJ:"gcUIElement",OKJ:"gcContextMenu",_Kb:"gc-statusbar-contextmenu",aLb:" ui-widget",bLb:" ui-state-hover",cLb:" ui-icon ui-icon-triangle-1-e",dLb:"DIV",eLb:"SPAN",fLb:"keydown.ctx.gcSheet",gLb:"none",hLb:"inline-block",iLb:"visible",jLb:"hidden",tKJ:"block",uKJ:"none",KKJ:"overflow"},t=s.FKb+s.GKb+s.IKb,u=s.FKb+s.GKb+s.MKb,v=s.FKb+s.GKb+s.NKb,w=s.FKb+s.GKb+s.OKb,x=s.FKb+s.GKb+s.ZKb,y=s.FKb+s.GKb+s.PKb,z=s.FKb+s.GKb+s.SKb,A=s._Kb+s.GKb+"check",B=s._Kb+s.GKb+"check-container",C=s._Kb+s.GKb+"content",D=s._Kb+s.GKb+"status",E=12;function I(a){if(a instanceof Object)return!0}!function(a){a[a.up=0]="up",a[a.down=1]="down"}(F||(F={})),G=function(){function a(a,b,c){var d=this;d.qo=a,d.Uc=b,d.vKJ(a,b,c)}return a.prototype.vKJ=function(a,b,c){var d=this,e=d.Ana=f(document.createElement("DIV")),g=d.wKJ=document.createElement("DIV"),h=d.xKJ=document.createElement("DIV");e[0].className="gc-ui-contextmenu-scroll-wrapper",g.className="gc-ui-contextmenu-scroll-indicator",g.innerText=String.fromCharCode(708),h.className="gc-ui-contextmenu-scroll-indicator",h.innerText=String.fromCharCode(709),a.append(f(g)),a.append(e),e.append(b),e.height(c.height-12),a.append(f(h)),d.yKJ=e.height()+E,d.r3=d.iZJ(b),d.hT(F.up),d.QQ()},a.prototype.iZJ=function(a){var b=0;return a[0].childNodes.forEach(function(a){b+=a.offsetHeight}),b},a.prototype.zKJ=function(){return this.Ana},a.prototype.AKJ=function(a){var b=this;return i(a)?b.Ana.scrollTop():(b.Ana.scrollTop(a),void b.BKJ(a))},a.prototype.lL=function(a){var b,c=this.Uc[0],d=c.childNodes,e=0;for(b=0;b<a;b++)e+=d[b].offsetHeight;this.AKJ(e-E)},a.prototype.QQ=function(){var a=this,b=a.wKJ,c=a.xKJ,d=a.Ana,e=a.yKJ,g=a.r3;f(b).bind(s.AKb+s.sKJ,function(){a.Jw=o.setInterval(function(){var b=d.scrollTop(),c=b<=10?0:b-10;a.AKJ(r(c))},100)}),f(b).bind(s.BKb+s.sKJ,function(){o.clearInterval(a.Jw)}),f(b).bind(s.CKb+s.sKJ,function(){a.AKJ(0)}),f(c).bind(s.AKb+s.sKJ,function(){a.Jw=o.setInterval(function(){var b=d.scrollTop(),c=b>=g-e-10?g-e+2:b+10;a.AKJ(c)},100)}),f(c).bind(s.BKb+s.sKJ,function(){o.clearInterval(a.Jw)}),f(c).bind(s.CKb+s.sKJ,function(){a.AKJ(g-e)}),d.bind(s.mHc+s.sKJ,function(b){a.BKJ(d.scrollTop()+(b.deltaY||-b.wheelDelta||0))}).bind(s.qGc+s.sKJ,function(b){a.BKJ(d.scrollTop()+(b.deltaY||-b.wheelDelta||0))})},a.prototype.Tla=function(){var a=this,b=a.wKJ,c=a.xKJ,d=a.Ana;f(b).unbind(s.sKJ),f(c).unbind(s.sKJ),d.unbind(s.sKJ)},a.prototype.hyc=function(){var a=this;a.Tla(),a.qo.append(a.Uc),f(a.Ana).remove(),f(a.wKJ).remove(),f(a.xKJ).remove(),a.qo=l,a.Uc=l,a.Ana=l,a.wKJ=l,a.xKJ=l},a.prototype.Ao=function(a){switch(a){case F.up:this.wKJ.style.display=s.tKJ;break;case F.down:this.xKJ.style.display=s.tKJ}},a.prototype.hT=function(a){switch(a){case F.up:this.wKJ.style.display=s.uKJ;break;case F.down:this.xKJ.style.display=s.uKJ}},a.prototype.BKJ=function(a){var b=this,c=b.yKJ,d=b.r3;a<1?(b.Ao(F.down),b.hT(F.up),b.WRJ(!0)):a>d-c-1?(b.Ao(F.up),b.hT(F.down),
b.WRJ(!1)):(b.Ao(F.up),b.Ao(F.down),b.WRJ(!0))},a.prototype.WRJ=function(a){var b=this,c=b.Ana,d=b.yKJ;a&&(d-=E),c.height(d)},a}(),H=function(){function a(){}return a.prototype.ai=function(a,b,c,d){var e=this;e.qo=f(a),e.lla=k(b),e.wu=c.commandManager(),e.xc=c,e.Eu=d,e.LQ=[],e.YPa={},e.rQa=[],e.LKJ={},e.ZPa=m,e.lma()},a.prototype.mma=function(){var a,b,c,d,e,f,g,h,j,k,l,n,o,p,r,t,u,v,w,x,y,z,A,B,C=this,D=C.w_,E=C.qo,F=C.hostInfo;D[0].style.maxHeight="",a=parseInt(E.css("left"),10),b=parseInt(E.css("top"),10),c=E.width(),d=E.height(),e=C.DKJ(d),e&&(f=C.EKJ=C.FKJ(E,D),d=C.GKJ()),"number"==typeof C.CKJ&&(e?(g=f.zKJ(),g[0].style.maxHeight=C.CKJ+"px",D.css(s.KKJ,m)):(D[0].style.maxHeight=C.CKJ+"px",D.css(s.KKJ,s.jLb),d=D.height()+2)),h=C.FXJ(),j=h.windowTop,k=h.windowLeft,l=h.windowWidth,n=h.windowHeight,i(F)?(t=C.EXJ(),u=t.contextTop,v=t.contextLeft,w=t.contextWidth,x=t.contextHeight,y=u+b-Math.max(j,u),z=q(j+n,u+x)-(u+b),A=j+n-u+b,B=q(k+l,v+w)-(v+a),a+c>w?(a=a-c>0?a-c:a,E.css("left",a)):c>B&&E.css("left",a-c),d>z&&(d<=y?E.css("top",b-d):y+z>=d?E.css("top",b+z-d):A<d?E.css("top",j+n-u-d):E.css("top",u>j?0:j-u))):(F.left+a+c>k+l&&(a=a-c>0?a-c:a,E.css("left",a)),o=C.xc&&C.xc.getHost(),p=(o&&o.getBoundingClientRect().top)<F.top,r=F.top,p?r+b>=d?E.css("top",b-d):E.css("top",-r):n-r-b<d&&E.css("top",n-r-d))},a.prototype.FXJ=function(){return{windowTop:o.scrollY||o.pageYOffset,windowLeft:o.scrollX||o.pageXOffset,windowWidth:o.clientWidth||o.innerWidth,windowHeight:o.clientHeight||o.innerHeight}},a.prototype.EXJ=function(){var a,b,c,d,e,g,h=this;return h.xc&&(e=f(h.xc.getHost()),g=e.offset(),a=g.top,b=g.left,c=e.width(),d=e.height()),{contextTop:a,contextLeft:b,contextWidth:c,contextHeight:d}},a.prototype.FKJ=function(a,b){return new G(a,b,{height:this.GKJ()})},a.prototype.jZJ=function(){var a=this,b=a.w_;"number"==typeof a.CKJ&&(b[0].style.maxHeight=a.CKJ+"px",b.css(s.KKJ,s.jLb))},a.prototype.lma=function(){var a,b,c,d=this,e=d.lla;i(e)||!I(e)||e.length<1||(e instanceof Array||(e=[e]),a="menuView",b=d.nma(a,e),d.YPa.menuView=b,c=d.oma(d.lla),d.w_=c,d.jZJ(),c.appendTo(d.qo),d.mma(),d.QQ(),d.rQa.push({name:a,menuView:c}))},a.prototype.nma=function(a,b){for(var c,d=this,e=b.length,f=0,g=[];f<e;f++)c=b[f],i(c)||"separator"===c.type||(c.subMenu?d.YPa[c.name]=d.nma(c.name,c.subMenu):"groupHeader"===c.type&&(d.pma(c,b),d.YPa[c.name]=d.nma(a,c.groups)),g.push(d.qma(a,c)));return g},a.prototype.qma=function(a,b){var c,d,e,g=this;if(c="groupHeader"===b.type?g.$Pa():g.rma(),d=g.createMenuItemElement(b),!i(d))return d instanceof HTMLElement&&(d=f(d)),i(b.itemClass)||c.addClass(b.itemClass),i(b.title)||c.attr("title",b.title),d.appendTo(c),e={name:b.name,host:c,menuItemData:b,menuName:a},this.SpreadJSDesignerAutoTest&&this.SpreadJSDesignerAutoTest(e.host,e.menuItemData),g.LQ.push(e),e},a.prototype.rma=function(){var a=f(g(s.dLb));return a.addClass(u),a},a.prototype.$Pa=function(){var a=f(g(s.dLb));return a.addClass(v),a},a.prototype.createMenuItemElement=function(a){var b,c=this,d=a.type;return b="groupHeader"===d?c.tma(a):"groupItem"===d?c.uma(a):"statusBar"===d?c.Eyb(a):a.subMenu?c.vma(a):c.wma(a)},a.prototype.wma=function(a){var b,c,e=f(g(s.dLb)).addClass(w);return a.command?a.disable?e.addClass(s.FKb+s.GKb+s.$Kb):e.addClass(x):e.addClass(s.FKb+s.GKb+s.YKb),b=f(g(s.eLb)).addClass(s.FKb+s.GKb+s.LKb),a.iconClass&&b.addClass(a.iconClass),b.appendTo(e),a.text&&(c=f(g(s.eLb)).addClass(s.FKb+s.GKb+s.KKb),c[0].innerHTML=d.Common.u.Ob(a.text),c.appendTo(e)),e},a.prototype.sma=function(a){return f(g(s.dLb)).addClass(s.FKb+s.GKb+s.QKb)},a.prototype.tma=function(a){var b,c,d,e,h,i,j,k=this,l=f(g(s.dLb)).addClass(s.FKb+s.GKb+s.TKb);if(a.groups.length<=0)return l;for(b=k.wma(a),b.addClass(s.FKb+s.GKb+s.VKb),b.appendTo(l),c=f(g(s.dLb)).addClass(s.FKb+s.GKb+s.WKb),d=a.groups,e=d.length,h=0;h<e;h++)i=k.xma("name",d[h].name),j=i.host,j.addClass(s.FKb+s.GKb+s.XKb),j.appendTo(c);return c.appendTo(l),l},a.prototype.uma=function(a){var b=this,c=b.wma(a),d=c.find(s.EKb+s.FKb+s.GKb+s.KKb);return d.remove(),c.attr(s.UKb,a.text),c},a.prototype.Eyb=function(a){var b,c,d,e=g("div"),h=f(e).addClass(w),i=a.visible,j=a.menuContent,k=a.status,l=g("div");return f(l).addClass(A),b=g("div"),f(b).addClass(B),b.appendChild(l),b.style.visibility=i?s.iLb:s.jLb,c=g("div"),c.innerText=j,f(c).addClass(C),d=g("div"),f(d).addClass(D),k?(d.innerText=k,d.style.display=s.hLb):d.style.display=s.gLb,e.appendChild(b),e.appendChild(c),e.appendChild(d),h},a.prototype.vma=function(a){var b,c,d,e=this,h=f(g(s.dLb)).addClass(y),i=e.wma(a);return a.subMenu.length>0&&(b=f(g(s.eLb)).addClass(s.FKb+s.GKb+s.RKb+s.cLb),b.appendTo(i),c=e.oma(a.subMenu),d=f(g(s.dLb)).addClass(z),c.appendTo(d),d.appendTo(e.qo),e.LKJ[a.name]=d),i.appendTo(h),h},a.prototype.oma=function(a){for(var b,c,d,e,h=this,j=f(g(s.dLb)).addClass(s.FKb+s.GKb+s.HKb+s.aLb),k=a.length,l=0;l<k;l++)i(a[l])||(b=a[l].name,i(b)?"separator"===a[l].type&&(d=h.$Pa(),e=h.sma(a[l]),e.appendTo(d),d.appendTo(j)):(c=h.xma("name",b),i(c)||c.host.appendTo(j)));return j},a.prototype.xma=function(a,b){for(var c=this,d=c.LQ,e=d.length,g=0;g<e;g++)if(b instanceof f?b[0]===d[g][a][0]:d[g][a]===b)return d[g]},a.prototype.pma=function(a,b){var c,d,e;for(a.groups=[],c=b.length,d=0;d<c;d++)e=b[d],e&&e.group&&e.group===a.name&&(e.type="groupItem",a.groups.push(e),b.splice(d,1),d--)},a.prototype.QQ=function(){var a=this;f(s.EKb+u).bind(s.AKb,function(){var b,c,d,e=f(this),g=a.xma("host",e);for(a.ZPa=g,b=a.rQa,c=0,d=b.length;c<d&&g.menuName!==a.rQa[d-c-1].name;c++)a.Ooa();a._Pa(),a.cQa(!1)}).bind(s.BKb,function(){a.ZPa=m,a._Pa()}).bind(s.CKb,function(b){var c,d=f(this),e=a.xma("host",d);a.ZPa=e,c=a.aQa(!1,b),c&&a.WT()}),f(n).bind(s.fLb,function(b){var c,d,e;if(!b.target||f(b.target).attr(s.NKJ)!==s.OKJ){switch(b.keyCode){case 27:c=a.Ooa(),c||a.WT();break;case 32:case 13:c=a.aQa(!0,b),c&&a.WT();break;case 9:b.shiftKey?a.bQa(!1,!0):a.bQa(!0,!0);break;case 37:d=a.Ooa(),e=a.xma("name",d),e&&(a.ZPa=e),a.ZPa&&a.ZPa.menuItemData.group&&a.bQa(!1,!0);break;case 38:a.bQa(!1,!1);break;case 39:a.ZPa&&a.ZPa.menuItemData.group&&a.bQa(!0,!0),a.cQa(!0);break;case 40:a.bQa(!0,!1)}b.preventDefault?b.preventDefault():b.returnValue=!1}})},a.prototype.Noa=function(a,b){var c,d,e,g,h,i,j,k,l,m,n,o,p,r=this,t=r.EXJ(),u=t.contextTop,v=t.contextLeft,w=t.contextWidth,x=t.contextHeight,y=r.FXJ(),z=y.windowTop,A=y.windowLeft,B=y.windowWidth,C=y.windowHeight,D=b.parentRelatedLeft,E=b.parentRelatedTop,F=b.parentAbsoluteLeft,G=b.parentWidth;return a.css("top",E+2),c=a.width(),d=a.height(),e=a.position(),g=a.offset(),h=g.top,i=e.top,F+G+c>q(A+B,v+w)?a.css("left",D-c-1):a.css("left",D+G),k=r.MKJ(),l=r.DKJ(d),l&&(m=f(a[0].firstChild),j=r.FKJ(a,m),d=r.GKJ()),"number"==typeof r.CKJ&&(l?(n=j.zKJ(),n[0].style.maxHeight=r.CKJ+"px"):(a[0].style.maxHeight=r.CKJ+"px",a.css(s.KKJ,s.jLb),d=a.height())),o=q(z+C,u+x),p=o-h,d>p&&(d>k?a.css("top",u>z?0:z-u):a.css("top",i+o-h-d)),j},a.prototype.zma=function(a){return a.command},a.prototype.getCommandOptions=function(a,b,c){},a.prototype.aQa=function(a,b){var c,d=this,e=d.ZPa;if(e&&!e.menuItemData.disable)return c=e.menuItemData,c.subMenu?void(c.subMenu.length>0&&d.cQa(a)):(d.h4(b),!0)},a.prototype.h4=function(a){var b,c,d,f,g,h,k,l,m=this,n=m.ZPa,o=m.zma(n.menuItemData);i(o)||(b=m.getCommandOptions(n.menuItemData,n.host[0],a),c=m.wu,j(o)?o(m.xc,b):(d=e.UCJ(m.xc),f=d&&d.getActiveColumnIndex(),g=d&&d.getActiveRowIndex(),h=d&&d.tables&&d.tables.find(g,f),k=d&&d.pivotTables&&d.pivotTables.findPivotTable(g,f),i(k)?c.execute({cmd:o,sheetName:d&&d.name(),selections:d&&d.getSelections(),activeRow:g,activeCol:f,commandOptions:b,tableName:h?h.name():"",itemName:n.menuItemData.name}):(l=n.menuItemData.commandOptions,i(l)&&(l={}),i(l.pivotTableName)&&(l.pivotTableName=k.name()),i(l.pivotTableCellInfo)&&(l.pivotTableCellInfo=k.getPivotInfoImp(g,f,!1,!1,!0)),c.execute({cmd:o,sheetName:d.name(),selections:d.getSelections(),activeRow:g,activeCol:f,commandOptions:l,itemName:n.menuItemData.name}))))},a.prototype.Tla=function(){f(s.EKb+u).unbind(s.AKb).unbind(s.BKb).unbind(s.CKb),f(n).unbind(s.fLb)},a.prototype.no=function(){var a=this;a.qo=m,a.lla=m,a.wu=m,a.xc=m,a.Eu=m,a.LQ=m,a.YPa=m,a.ZPa=m,a.w_=m,a.LKJ=m,a.EKJ&&(a.EKJ.hyc(),a.EKJ=l),a.Tla()},a.prototype.Ooa=function(){var a,b,c,d=this;if(d.rQa.length>1)return a=d.rQa.pop(),b=a.menuView,c=b.find(s.EKb+u),c.removeClass(t+s.bLb),a.menuView.hide(),a.subMenuWrapper&&(a.subMenuWrapper.hyc(),a.subMenuWrapper=l),a.name},a.prototype._Pa=function(){var a,b,c,d=this,e=d.dQa(!0);if(e){for(a=0,b=e.length;a<b;a++)e[a].host.removeClass(t+s.bLb);d.ZPa&&(c=d.ZPa.menuItemData,c.disable?d.ZPa.host.addClass(s.FKb+s.GKb+s.JKb+s.bLb):d.ZPa.host.addClass(t+s.bLb))}},a.prototype.WT=function(){var a=this;a.Eu.trigger(s.DKb),a.no()},a.prototype.bQa=function(a,b){var c,d,e,f,g,h,i,j,k,m,n=this,o=n.dQa(b);n.ZPa&&(c=n.eQa(n.ZPa,o),c||(d=n.YPa[n.ZPa.menuItemData.group],d&&(e=d[0],c=n.eQa(e,o)))),a?(c!==l&&c!==o.length-1||(c=-1),c="number"==typeof c?c+1:0):(c!==l&&0!==c||(c=o.length),c="number"==typeof c?c-1:0),n.ZPa=o[c],n._Pa(),f=n.rQa[n.rQa.length-1],g=o.length,h=f&&("menuView"===f.name?n.EKJ:f.subMenuWrapper),h&&(i=h.AKJ(),j=i+n.ZPa.host.position().top,k=j+o[c].host.height()+2,m=h.zKJ().height(),j<i+E?0===c?h.AKJ(0):h.AKJ(j-E):k>i+m&&(c===g-1?h.AKJ(h.zKJ().height()):h.AKJ(j-E),h.AKJ(k-m)))},a.prototype.dQa=function(a){for(var b,c,d,e=this,f=e.rQa[e.rQa.length-1].name,g=e.YPa[f],h=0,i=g.length,j=[];h<i;h++)if("groupHeader"!==g[h].menuItemData.type)j.push(g[h]);else if(b=e.YPa[g[h].menuItemData.name],a)for(c=0,d=b.length;c<d;c++)j.push(b[c]);else j.push(b[0]);return j},a.prototype.eQa=function(a,b){var c,d=b.length;for(c=0;c<d;c++)if(a.name===b[c].name)return c},a.prototype.cQa=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.ZPa;k&&(b=k.menuItemData,b.subMenu&&b.subMenu.length>0&&(b.name!==j.rQa[j.rQa.length-1].name&&(c=j.LKJ[b.name],c.show(),d=k.host,e=j.LKJ[k.menuName],f=d.offset(),g=d.position(),h=e&&e.position(),i=j.Noa(c,{parentRelatedLeft:h?h.left:g.left,parentRelatedTop:h?g.top+h.top:g.top,parentAbsoluteLeft:f.left,parentWidth:e?e.width():d.width()+3}),j.rQa.push({name:b.name,menuView:c,subMenuWrapper:i})),j.ZPa=m,a&&j.bQa(!0,!1)))},a.prototype.GKJ=function(){var a=this,b=a.MKJ();return"number"==typeof a.CKJ&&a.ysb!==!1&&(b=q(b,a.CKJ)),b},a.prototype.MKJ=function(){var a=this,b=a.hostInfo,c=a.EXJ(),d=c.contextTop,e=c.contextHeight,f=a.FXJ(),g=f.windowTop,h=f.windowHeight;return b?h:q(g+h,d+e)-p(g,d)},a.prototype.DKJ=function(a){var b,c=this;return c.ysb!==!1&&(b=c.GKJ(),a>b||void 0)},a.prototype.scrollable=function(a){var b=this;return i(a)?b.ysb:void(b.ysb=a)},a.prototype.maxHeight=function(a){var b=this;return i(a)?b.CKJ:(b.CKJ=a,void(a<0&&(b.CKJ=void 0)))},a.prototype.getHost=function(){return this.qo},a}(),b.MenuView=H},"./dist/plugins/data/binding.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Core"),f=e.GC$,g=c("Common"),h=c("./dist/plugins/data/data.ns.js"),i=f.isNumeric,j=g.Common.j.Fa,k=null,l=void 0,m="string",b.yL=n,o=b.yL=n={},p="cellBinding",q=new g.Common.ResourceManager(h.SR,"Bindings"),r=q.getResource.bind(q),d.Workbook.$n("binding",{onCultureChanged:function(){r()}}),s=function(){function a(a){this.xf=a}return a.prototype.setValue=function(a,b){D(this.xf,a,b)},a.prototype.getValue=function(a){return E(this.xf,a)},a.prototype.getSource=function(){return this.xf},a}(),b.CellBindingSource=s,t=function(){function a(a){this.ad(a)}return a.prototype.bind=function(a,b){var c,d,e,g,h=this,i=h.kj,j=h._dataSource;if(b&&h.tUa(b,{type:"bind",oldDataSource:j}),j&&(j.lka&&(j.subscribe=j.lka,delete j.mka,delete j.lka),C(j.dispose)&&j.dispose()),h.zL(h.AL),h.zL(h.BL),h.ad(i),h._dataSource=a,a){if(c=h.CL=z(a),!c)throw Error(r().Exp_NotSupportedDataSource);h.DL=h.EL(),i&&f[f.sd]({tc:i.parent}),i&&(d=h.AL,e=a.currentPosition,a.subscribe&&d.push(a.subscribe(h.FL,h)),e&&e.subscribe&&d.push(e.subscribe(h.GL,h)),C(a.subscribe)&&!a.lka&&(g=a.lka=a.subscribe,a.mka=!1,a.subscribe=function(b,c){var d=[].concat.apply([],arguments),e=function(){if(!a.mka&&C(b))return b.apply(c,arguments)};return d[0]=e,g.apply(a,d)}),h.Lx()),h.HL=A(a,c)}return w(i,a)},a.prototype.Lx=function(){var a,b,c,d,e,f=this,g=f.kj,h=f._dataSource;if(g&&h&&(a=f.CL,f.zL(f.BL),b=k,a!==p&&(c=g.getActiveRowIndex(),h.currentPosition?(-1<=c&&c<h.count()&&h.currentPosition(c),b=h.currentItem()):b=f.ru(c)),b)){d=function(){g&&g.repaint()};for(e in b)b[e]&&C(b[e].subscribe)&&f.BL.push(b[e].subscribe(d,k,k))}},a.prototype.zL=function(a){var b,c;if(a)for(b=0;b<a.length;b++)c=a[b],c&&C(c.dispose)&&c.dispose()},a.prototype.getRowCount=function(){var a=this,b=a._dataSource,c=a.CL,d=0;return b&&c&&c!==p&&(d=o[c].getDataLength(b)),d},a.prototype.getColumnCount=function(){var a,b,c,d=this.HL;return d?d.length:(a=this._dataSource,a&&(b=a[0],c=f.getType(b),"null"===c||c===m||"number"===c)?1:0)},a.prototype.getSource=function(){return this._dataSource},a.prototype.rL=function(){return this.HL},a.prototype.Nka=function(a){this.HL=a},a.prototype.ru=function(a){var b=this._dataSource,c=this.CL,d=k;return b&&c&&c!==p&&(d=o[c].getDataItem(b,a)),d},a.prototype.EL=function(){var a,b,c,d=this;if(!d.DL)for(a=d.getRowCount(),b=0;b<a;b++)if(c=d.ru(b)){d.DL=c.entityAspect&&c.entityType||c.constructor;break}return d.DL},a.prototype.getValue=function(a,b){return x(this,a,b)},a.prototype.setValue=function(a,b,c,d){var e,f=this;return d&&(e=x(f,a,b).value,f.tUa(d,{type:"setValue",row:a,col:b,oldValue:e})),y(f,a,b,c)},a.prototype.sL=function(){var a=o[this.CL];return a&&a.canAdd&&a.canAdd()},a.prototype.tL=function(){var a=o[this.CL];return a&&a.canInsert&&a.canInsert()},a.prototype.vL=function(){var a=o[this.CL];return a&&a.canRemove&&a.canRemove()},a.prototype.allowSetCount=function(){var a,b=this.CL;return b===p||(a=o[b],a&&a.allowSetCount&&a.allowSetCount())},a.prototype.uL=function(a,b,c){var d,e,f=this,g=f._dataSource;!g||a>f.getRowCount()||(d=f.CL,e=f.EL(),d&&d!==p&&!f.IL&&(f.JL=!0,c&&f.tUa(c,{type:"addItems",row:a,rowCount:b}),o[d].addItems(g,a,b,e,l),f.JL=!1))},a.prototype.wL=function(a,b,c){var d,e,f,g=this,h=g.CL,i=g.getRowCount(),j=g._dataSource;!j||a>=i||h&&h!==p&&!g.IL&&(g.JL=!0,d=g.kj,e=d&&d.onItemRemoved?d.onItemRemoved.bind(d):l,f=o[h].removeItems(j,a,b,e),c&&f&&f.length>0&&g.tUa(c,{type:"removeItems",row:a,removedItems:f}),g.JL=!1)},a.prototype.uUa=function(a,b){var c=this,d=c._dataSource,e=c.CL;o[e].undoRemoveItems(d,a,b)},a.prototype.xL=function(a){return B(a||this._dataSource)},a.prototype.ad=function(a){var b=this;b._dataSource=k,b.CL="",b.DL=k,b.HL=k,b.AL=[],b.BL=[],b.qia=k,b.kj=a,v(a)},a.prototype.FL=function(a){var b,c,d,e,f=this,g=f.kj;if(g&&!f.JL){if(a){if(f.IL=!0,!isNaN(a.length)&&(g.setRowCountCore(a.length),b=g.ITa,j(f.HL)&&0===b.VTa(!1,3)&&(f.HL=A(f._dataSource),g.setColumnCount(f.getColumnCount()),c=f.rL())))for(d=0,e=c.length;d<e;d++)b.do("setItem",!1,3,d,{name:c[d]});f.IL=!1}g.$p()}},a.prototype.GL=function(){var a,b=this,c=b.kj,d=b._dataSource;c&&d&&d.currentPosition&&(a=d.currentPosition(),c.Jl!==a&&(c.Sr(a,c.Kl,l,l,2),c.$p()))},a.prototype.tUa=function(a,b){if(!(this.kj&&this.kj.ITa&&!j(this.kj.ITa.WTa)&&this.kj.ITa.WTa<=0)){var c=a.bindingChanges;c||(c=a.bindingChanges=[]),b.bindingManager=this,c.push(b)}},a.prototype.heK=function(a){var b=this,c=a.type,d=a.row;"bind"===c?b.bind(a.dataSource):"setValue"===c?b.setValue(d,a.col,a.value):"addItems"===c?b.uL(d,a.rowCount):"removeItems"===c&&b.wL(d,a.rowCount)},a.prototype.sUa=function(a){var b=this,c=a.type,d=a.row;"bind"===c?b.bind(a.oldDataSource):"setValue"===c?b.setValue(d,a.col,a.oldValue):"addItems"===c?b.wL(d,a.rowCount):"removeItems"===c&&b.uUa(d,a.removedItems)},a.prototype.toJSON=function(){var a,b=this._dataSource;return b?(a=this.CL,b=a===p?b.getSource():o[a].toJSON(b),{type:a,source:b}):k},a.prototype.fromJSON=function(a){var b,c,d=a&&a.source;d&&(b=a.type,c=void 0,c=b===p?new s(d):o[b].fromJSON(d),c&&this.bind(c))},a}(),b.qL=t;function v(a){var b=a&&a.wq;b&&b.xL()&&d.Worksheet.ao(a,"resetBinding",{sheet:a})}function w(a,b){var c=a&&a.wq;return!(!c||!c.xL(b))&&(a.clearPendingChanges(),d.Worksheet.ao(a,"initBinding",{sheet:a,data:b}),!0)}function x(a,b,c){var d,e,f,g,h,i,j,m,n,q,r=a,s=r._dataSource,t={value:k,hasBinding:!1};if(!s)return t;if(d=r.kj,e=r.CL,e===p){if(h=d?d.getBindingPath(b,c):k)return{value:s.getValue(h),hasBinding:!0}}else{if(b<0||a.getRowCount()<=b)return t;if(i=d?d.getColumnCount():a.getColumnCount(),c<0||i<=c)return t;if(d?(r.qia||(r.qia=d.ITa.Hp(!1,3)),f=r.qia[c],f&&(g=f.name)):a.HL&&(r.qia?(f=r.qia[c],f&&(g=f.dataField)):g=a.HL[c]),e)return j=o[e],m=f&&f.value,n=C(m)?m:k,q=d&&d.onItemGotten?d.onItemGotten.bind(d):l,j.getValue(s,n,g,b,c,q)}return t}function y(a,b,c,d){var e,f,g,h,i,j,m,n,q,r=a,s=r._dataSource,t=!1;if(!s)return t;if(e=r.kj,f=r.CL,f===p)i=e?e.getBindingPath(b,c):k,i&&(s.setValue(i,d),t=!0);else{if(b<0||a.getRowCount()<=b)return t;if(j=e?e.getColumnCount():a.getColumnCount(),c<0||j<=c)return t;e?(r.qia||(r.qia=e.ITa.Hp(!1,3)),g=r.qia[c],g&&(h=g.name)):a.HL&&(r.qia?(g=r.qia[c],g&&(h=g.dataField)):h=a.HL[c]),f&&(m=o[f],n=g&&g.value,q=C(n)?n:k,t=m.setValue(s,q,h,b,c,d,l))}return t}function z(a){var b=k;return a&&(B(a)?b=p:f.each(o,function(c,d){if(d.isDataSource(a))return b=c,!1})),b}function A(a,b){return a&&b&&b!==p?o[b].getProperties(a):k}function B(a){return s&&a instanceof s}function C(a){return"function"==typeof a}function D(a,b,c){var d,e,f,g,h;if(a&&b){if(d=a[b],!j(d))return void(C(d)?a[b](c):a[b]=c);for(e=b.split("."),f=e.length,g=0;g<f&&(h=e[g],a);g++)g===f-1?C(a[h])?a[h](c):a[h]=c:C(a[h])?(j(a[h]())&&a[h]({}),a=a[h]()):(j(a[h])&&(a[h]={}),a=a[h])}}b.setValueByPath=D;function E(a,b,c){var d,e,f,g,h;if(!a||!b)return k;if(d=a[b],!j(d))return C(d)?d():d;e=null,c?(e=c[b],e||(e=b.split("."),c[b]=e)):e=b.split("."),f=e.length,g=0;do{if(h=e[g],a=C(a[h])?a[h]():a[h],j(a))return k;++g}while(g<f);return a}b.LL=E,u=function(){function a(){this.pathCache={}}return a.prototype.isDataSource=function(a){return f.isArray(a)},a.prototype.getDataLength=function(a){return a.length},a.prototype.getDataItem=function(a,b){return a[b]},a.prototype.addItems=function(a,b,c,d){var e,f;for(e=0;e<c;e++)f={},d&&(f=d.createEntity?d.createEntity():new d),a.splice(b,0,f)},a.prototype.removeItems=function(a,b,c){var d=this.getDataLength(a);if(b<d)return a.splice(b,Math.min(c,d-b))},a.prototype.undoRemoveItems=function(a,b,c){for(var d=0,e=c.length;d<e;d++)a.splice(b+d,0,c[d])},a.prototype.getProperties=function(a){var b,c,d=a.length,e=k;if(d>0){e=[],b=a[0];for(c in b)C(b[c])||e.push(c)}return e},a.prototype.getValue=function(a,b,c,d,e){var f=k,g=!1,h=this.getDataItem(a,d);return j(h)||(b?(f=b(h),g=!0):c?(f=E(h,c,this.pathCache),g=!0):(typeof h===m||i(h))&&0===e&&(f=h,g=!0)),{value:f,hasBinding:g}},a.prototype.setValue=function(a,b,c,d,e,f){var g=!1,h=this.getDataItem(a,d);return j(h)||(b?(b(h,f),g=!0):c?(D(h,c,f),g=!0):(typeof h===m||i(h))&&0===e&&(a[d]=f,g=!0)),g},a.prototype.fromJSON=function(a){return a},a.prototype.toJSON=function(a){return a},a}(),o.defaultBindingSource=new u},"./dist/plugins/data/data.dataview.js":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/plugins/data/binding.js"),b.yL=e.yL,f=d.Common.j.Fa,g=null,h=function(){function a(){}return a.prototype.isDataSource=function(a){var b=window.wijmo;return b&&b.data&&b.data.isDataView&&b.data.isDataView(a)},a.prototype.getDataLength=function(a){return a.count()},a.prototype.getDataItem=function(a,b){return a.item(b)},a.prototype.addItems=function(a,b,c,d){if(d)for(var e=0;e<c;e++)a.mka=!0,a.add(d.createEntity?d.createEntity():new d),a.mka=!1,a.commitEdit()},a.prototype.removeItems=function(a,b,c){var d,e,f,g,h=this.getDataLength(a);if(b<h){for(d=[],e=Math.min(c,h-b),f=0;f<e;f++)g=a.item(b),a.remove(g),d.push(g);return d}},a.prototype.undoRemoveItems=function(a,b,c){var d,e,f=a.getSource();for(d=0,e=c.length;d<e;d++)f.splice(b+d,0,c[d]);a.refresh()},a.prototype.getProperties=function(a){var b,c=0,d=g,e=a.getProperties();if(e&&e.length>0)for(c=e.length,d=[],b=0;b<c;b++)d.push(e[b].name);return d},a.prototype.canInsert=function(){return!1},a.prototype.getValue=function(a,b,c,d,e){var h=g,i=!1,j=this.getDataItem(a,d);return f(j)||(b?(h=b(j),i=!0):c&&(h=a.getProperty(j,c),i=!0)),{value:h,hasBinding:i}},a.prototype.setValue=function(a,b,c,d,e,g){var h=!1,i=this.getDataItem(a,d);return f(i)||(b?(b(i,g),h=!0):c&&(a.setProperty(i,c,g),h=!0)),h},a.prototype.fromJSON=function(a){return a},a.prototype.toJSON=function(a){return a.local},a}(),e.yL.dataViewBinding=new h},"./dist/plugins/data/data.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),c("./dist/plugins/data/worksheet-databind.js");var e=c("./dist/plugins/data/binding.js");b.CellBindingSource=e.CellBindingSource,b.qL=e.qL,b.setValueByPath=e.setValueByPath,b.LL=e.LL,d(c("./dist/plugins/data/data.ko.js")),d(c("./dist/plugins/data/data.dataview.js")),d(c("./dist/plugins/data/data.ns.js"))},"./dist/plugins/data/data.ko.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/data/binding.js"),b.yL=f.yL,g=e.Common.j.Fa,h=d.GC$,i=h.isFunction,j=h.getType,k=h.isNumeric,l=null,m="string",n=window.ko,o=function(){function a(){}return a.prototype.isDataSource=function(a){return n&&n.isObservable(a)},a.prototype.getDataLength=function(a){return a().length},a.prototype.getDataItem=function(a,b){return a()[b]},a.prototype.addItems=function(a,b,c,d){var e,f;for(e=0;e<c;e++)f={},d&&(f=d.createEntity?d.createEntity():new d),a.splice(b,0,f)},a.prototype.removeItems=function(a,b,c){var d=this.getDataLength(a);if(b<d)return a.splice(b,Math.min(c,d-b))},a.prototype.undoRemoveItems=function(a,b,c){for(var d=0,e=c.length;d<e;d++)a.splice(b+d,0,c[d])},a.prototype.getProperties=function(a){var b,c,d=a(),e=d.length,f=[];if(e>0){b=d[0];for(c in b)i(b[c])?n&&n.isObservable(b[c])&&f.push(c):f.push(c)}return f},a.prototype.getValue=function(a,b,c,d,e){var h=l,i=!1,n=this.getDataItem(a,d);return g(n)||(b?(h=b(n),i=!0):c?(h=f.LL(n,c),i=!0):(j(n)===m||k(n))&&0===e&&(h=n,i=!0)),{value:h,hasBinding:i}},a.prototype.setValue=function(a,b,c,d,e,h){var i=!1,l=this.getDataItem(a,d);return g(l)||(b?(b(l,h),i=!0):c?(f.setValueByPath(l,c,h),i=!0):(j(l)===m||k(l))&&0===e&&(a()[d]=h,i=!0)),i},a.prototype.fromJSON=function(a){return n?n.observableArray(a):l},a.prototype.toJSON=function(a){return a()},a}(),f.yL.koBinding=new o,n&&(p=n.bindingHandlers,p["gc-spread-sheets"]=p["gcspread-sheets"]=p.wijspread={init:function(a,b,c,e){var f,g,i,j,k,l,n,o,p,q,r,s;if(!h(a).data("workbook")&&(f=b(),g=f&&f.sheets,i=new d.Workbook(h("#"+a.id)[0],f),g)){for(j=void 0,k=void 0,l=g.length,n=i.getSheetCount();n<l;)j=i.vv(i.wv(n)),i.ow(n,0,j),n=i.getSheetCount();for(o=0;o<l;o++)j=i.getSheet(o),k=g[o],p=k.name,q=k.autoGenerateColumns,r=k.data,s=k.columns,typeof p===m&&p.length>0&&j.cq(p),"boolean"==typeof q&&(j.autoGenerateColumns=q),r&&j.setDataSource(r),s&&s.length>0&&(j.autoGenerateColumns=!1,j.bindColumns(s))}},update:function(a,b,c,d){}})},"./dist/plugins/data/data.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/data/data.res.en.js");b.SR={en:d}},"./dist/plugins/data/data.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_NotSupportedDataSource="The data source is not supported!"},"./dist/plugins/data/worksheet-databind.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/data/binding.js"),g=e.Common.j.Fa;function p(a,b,c){"string"==typeof c&&(c={name:c}),a.ITa.do("setItem",!1,3,b,c);var d=c&&c.formatter,e=c&&c.cellType;d&&a.setFormatter&&a.setFormatter(-1,b,d),e&&a.setCellType(-1,b,e),c&&!g(c.width)&&a.setColumnWidth(b,c.width)}h=d.GC$.isEmptyObject,i=d.GC$.extend,j=d.Worksheet.prototype,k=null,l="bindingPath",m=RegExp("^\\d*(\\.\\d+)?\\*$"),n=e.Common.l,o={getDataSource:function(){var a=this.wq;return a?a.getSource():k},setDataSource:function(a,b){var c,d,e,g,h,i,j=this,k=j.wq;if(k&&(k.getSource()!==a||j.ODJ)){if(j.suspendPaint(),b&&j.vs(),a){if(k=j.wq,k.kLb=!0,c=k.bind(a,j.ITa.zTa),!c&&(j.setRowCountCore(k.getRowCount()),j.autoGenerateColumns&&(j.setColumnCount(k.getColumnCount()),d=k.rL())))for(e=0,g=d.length;e<g;e++)j.ITa.do("setItem",!1,3,e,{name:d[e]})}else j.wq=new f.qL(j);j.clearPendingChanges(),h=!1,k&&k.kLb&&(h=k.lLb,delete k.lLb,delete k.kLb),j.recalcAll&&j.recalcAll(h),i=j.tu(),i&&i.PA===j&&i.hZ(),j.resumePaint()}},bindColumn:function(a,b){var c=this;c.suspendPaint();try{p(c,a,b)}finally{c.resumePaint()}},bindColumns:function(a){var b,c,d,e,f=this;f.suspendPaint();try{if(a)for(b=a.length,isNaN(b)||f.setColumnCount(b),c=0;c<b;c++)d=a[c],e=d.size,m.test(e)&&(d.starSize=e),p(f,c,d)}finally{f.resumePaint()}},getDataItem:function(a){var b,c,d,e,f,h,i=this,j=i.wq;if(!j||0===j.getRowCount())return k;if(b=i.getColumnCount(),c={},d=j.ru(a))for(e in d)d.hasOwnProperty(e)&&"function"!=typeof e&&(c[e]=d[e]);for(f=0;f<b;f++)h=i.ITa.Jp(!1,3,f),h&&h.name&&h.name.length>0&&g(c[h.name])&&(c[h.name]=i.getValue(a,f));return c},getDataColumnName:function(a){var b,c=this;return 0<=a&&a<c.getColumnCount()&&c.getDataSource()?(b=c.ITa.Jp(!1,3,a),b&&(b.displayName||b.name)):k},getBindingPath:function(a,b){return this.ITa.getValueForKey(a,b,l)},setBindingPath:function(a,b,c){var e=this;return e.ITa.do("setValueForKey",a,b,l,c),e.Wq(d.Events.WorksheetDataChanged,{type:"bindingPath"}),e.$p(),e}},i(j,o),d.CellRange.prototype.bindingPath=d.CellRange.Pl(j.getBindingPath,j.setBindingPath);function q(a,b,c,d,e,f){var g,h,i,j,k,l=a.wq,m="dataManagerBindingSource"===l.CL;for(g=0;g<c;g++)for(h=0;h<d;h++)i=l.getValue(g,h),j=i.value,i&&i.hasBinding&&(k=j,n.Ska(j)&&(k=n.Daa(j)),f?a._dK(b,g,h,k,e):a.qI(b,g,h,k,m))}function r(a,b,c,d){var e,f,h,i,j,k=a.options.colHeaderAutoTextIndex;for(e=0;e<c;e++)if(k>=0&&e===k||k===-1&&e===c-1)for(f=0;f<d;f++)h=b[e]&&b[e][f]&&b[e][f].value,i=a.ITa.Jp(!1,3,f),g(h)&&i&&(j=i.displayName||i.name,j&&a.qI(b,e,f,j))}d.Worksheet.$n("binding",{init:function(){var a=this;a.autoGenerateColumns=!0,a.wq=new f.qL(a)},dispose:function(a){var b=this;a.clearCache!==!1&&(b.wq=k)},onLayoutChanged:function(a){var b,c,d,e,f,g=this,h=a.changeType,i=a.row,j=a.rowCount,l=a.sheetArea,m=g.wq;if("addingRows"===h)m&&m.sL()===!1?a.canAdd=!1:m&&m.tL()===!1&&(a.newRow=g.getRowCount());else if("addRows"===h)m&&m.uL(i,j,g.ITa.zTa);else if("deletingRows"===h){if(m)if(m.vL()===!1)a.canDelete=!1;else for(g.Ts||(g.Ts=[]),b=g.Ts,c=g.ITa,d=m.getRowCount(),e=0;e<j&&i+e<c.getRowCount();e++)f=k,i+e<d&&(f=m.ru(i+e)),b.push({row:i+e,data:f})}else"deleteRows"===h?m&&m.wL(i,j,g.ITa.zTa):"settingRowCount"===h&&(!m.getSource()||m.allowSetCount()||3!==l&&2!==l||(a.canSet=!1))},toJson:function(a,b){var c,d,e,f=this,g=f.getColumnCount(),i=f.getDataSource();b&&b.includeBindingSource&&i&&(c=a.data.dataTable||{},q(f,c,f.getRowCount(),g),h(c)||(a.data.dataTable=c),d=a.colHeaderData.dataTable||{},r(f,d,f.getRowCount(1),g),h(d)||(a.colHeaderData.dataTable=d)),e=f.autoGenerateColumns,e!==!0&&(a.autoGenerateColumns=f.autoGenerateColumns)},fromJson:function(a,b){var c,d,e,h,i=this;i.wq=new f.qL(i),b&&(c=i.wq,d=a.dataSource,e=a.dataBinding,d&&c.bind(d),e&&c.fromJSON(e,b)),h=a.autoGenerateColumns,g(h)||(i.autoGenerateColumns=h)},preFromJson:function(){this.wq=new f.qL(this)},bdK:function(a,b,c){var d,e,f=this,g=f.getColumnCount(),i=f.getDataSource(),j=a.lossless;j||(j=a.lossless={}),c&&c.includeBindingSource&&i&&(q(f,a,f.getRowCount(),g,b.sharedStrings,!0),d=j.colHeaderData.dataTable||{},r(f,d,f.getRowCount(1),g),h(d)||(j.colHeaderData.dataTable=d)),e=f.autoGenerateColumns,e!==!0&&(j.autoGenerateColumns=f.autoGenerateColumns)},cdK:function(a){var b,c=this;c.wq=new f.qL(c),b=a.lossless&&a.lossless.autoGenerateColumns,g(b)||(c.autoGenerateColumns=b)}});function s(a,b){var c,d;return"Object"===b.constructor.name&&(c=a.findByName(b.tableName),c&&(c.wq?b=c.wq:(d=new f.qL,d.fromJSON(b),c.wq=b=d))),b}d.lUa.$n("binding",{priority:6e3,getValue:function(a){var b,c=a.row,d=a.col,e=a.sheetArea,f=this.kj.wq;3===e&&f&&f._dataSource&&(b=f.getValue(c,d),a.isValueGet=b.hasBinding,a.value=b.value)},setValue:function(a){var b,c,d,e=a.row,f=a.col,g=a.value,h=a.sheetArea,i=this.kj,j=i.wq;3===h&&j&&j._dataSource&&(b=j.getValue(e,f),b.hasBinding&&(c=b.value,g!==c?(i.isDirtySuspended()||(d=i.getDataItem(e),this.Cp(e,f,{Dp:d,Ep:c},h)),a.isValueSet=j.setValue(e,f,g,i.ITa.zTa)):a.isValueSet="dataManagerBindingSource"!==j.CL))},applyChanges:function(a){var b,c,d,e=a.changes,f=a.isUndo,g=e&&e.rUa;if(g)if(f)for(b=g.length-1;b>=0;b--)c=g[b],c.bindingManager&&(d=s(this.kj.tables,c.bindingManager),d.sUa(c));else for(b=0;b<g.length;b++)c=g[b],d=s(this.kj.tables,c.bindingManager),d.heK&&d.heK(c)},undo:function(a){var b,c,d=a.bindingChanges;if(d)for(b=d.length-1;b>=0;b--)c=d[b],c.bindingManager.sUa(c)}})},"./dist/plugins/dragMerge/dragMerge-action.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),b.Commands=d.Commands,e=d.Commands.ActionBase,f=d.Commands.h4,g="dragMerge",h=Math.max;function k(a,b){return a.Tq(b)}i=function(a){j(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){var a,b=this.kj,c=this.VQ,d=k(b,c.oldSelection),e=k(b,c.newSelection);if(d.equals(e)){if(a=b.getSpan(d.row,d.col),a&&d.equals(a))return!1;if(1===d.rowCount&&1===d.colCount)return!1}return!0},b.prototype.canUndo=function(){var a=d.Commands.bWa(this.kj.name()),b=this.VQ[a];return d.Commands.cWa(b)},b.prototype.undo=function(){var a,b,c=this;return!!c.canUndo()&&(a=c.kj,c.Lz(a,!0),b=d.Commands.bWa(a.name()),a.ITa.undo(c.VQ[b]),c.Mz(a,!0),void 0)},b.prototype.execute=function(){var a,b,c,e,f,g=this,i=g.kj,j=g.VQ,k=j.oldSelection,l=j.newSelection;return!!g.canExecute()&&(i.ITa.startTransaction(),g.Lz(i,!0),i.ITa.do("clearSpan",k.row,k.col,k.rowCount,k.colCount),a=l.row,b=l.col,c=l.rowCount,e=l.colCount,i.addSpan(a,b,c,e),i.setSelection(a,b,h(c,1),h(e,1)),g.Mz(i,!0),f=d.Commands.bWa(i.name()),j[f]=i.ITa.endTransaction(),void 0)},b}(e),d.Commands[g]={canUndo:!0,execute:function(a,b,c){return f(a,i,b,c)}},d.Commands.dja=function(a){a.register(g,d.Commands[g])}},"./dist/plugins/dragMerge/dragMerge-event.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.GC$,f=null,g=void 0,h=Math.abs,i=d.kf;function j(a,b){a.Wq(d.Events.DragMerging,b)}function k(a,b){a.Wq(d.Events.DragMerged,b)}e.extend(d.iI.prototype,{gka:function(a){var b=this,c=b.kj,d=a,e=c.ITa.findSpan(a.row,a.col);return e&&e.containsRange(a)&&(d=e),d},Yia:function(a,b,c){var d,e,g,i,j,k=this.kj,l=k.parent,m=k.Ix(),n=k.yl,o=4,p=8,q=o/2,r=p/2;if(l&&l.options.allowUserDragMerge&&m&&!k.CH&&n.Xja){if(d=n.Xja,e=d.x,g=d.y,i=d.width,j=d.height,h(e+i-b)<=q&&h(g+j/2-c)<=r)return{right:!0};if(h(e+i/2-b)<=r&&h(g+j-c)<=q)return{bottom:!0}}return f},Zia:function(a){var b,c,d,e,f,g,h,i,j=this;return j.eG=!0,j.OG=!0,j.$ia=!0,j.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},j.fja=a.dragMergeInfo,b=j.kj,c=b.ITa,d=b.Ix(),j.ika=j.gka(d),e=b.Tq(j.ika),f=e.row,g=e.col,h=e.rowCount,i=e.colCount,c.qu(f,g,h,i)?(j.OG=!1,void(j.$ia=!1)):(j._ja=b.ITa.getSpans(e),b.suspendPaint(),c.do("clearSpan",f,g,h,i),b.resumePaint(),j.aka=e,j.bka(),j.jka(e),
void j.qG())},_ia:function(){var a,b,c,d,e,f,g,h,i=this,j=i.kj,k=j.parent;return k&&!k.options.allowUserDragMerge?void i.aja():(a=i.fH(),b=i.gH(),c=i.aka||i.ika,d=j.Tq(c),void(a>=0&&b>=0&&(e=i.fja,f=i.qja(d,a,b,e),i.kka=f,g=f.rowCount,h=f.colCount,g>0&&h>0&&(i.bka(),i.jka(f),i.aka=f,i.NG()))))},bka:function(){var a,b=this.kj,c=this.aka;c&&(a=b.cm(c),a.x-=2,a.y-=2,a.width+=4,a.height+=4,b.yl.dm(a))},qja:function(a,b,c,d){var e,f,g,h,j,k,l,m,n=this,o=n.kj,p=a.row,q=a.col,r=a.rowCount,s=a.colCount;return d.right?(e=p,f=q,g=r,h=c-q+1,j=e,k=q+s,l=g,m=c-q-s+1):d.bottom&&(e=p,f=q,g=b-p+1,h=s,j=p+r,k=f,l=b-p-r+1,m=h),o.ITa.MTa(j,k,l,m)&&(e=p,f=q,g=r,h=s),i(e,f,g,h)},aja:function(){var a,b,c,d=this,e=d.kj,f=e.parent,h=d._ja,i=d.ika,l=d.kka||i;d.eG=!1,d.OG=!1,d.$ia=!1,d.kka=g,d._ja=g,d.aka=g,d.ika=g,d.RG(),f&&f.options.allowUserDragMerge&&(a=e.ITa,e.suspendPaint(),h.length>0&&h.forEach(function(b){a.do("addSpan",b)}),e.resumePaint(),b={sheetName:e.name(),sheet:e,mergeRange:l,cancel:!1},j(e,b),b.cancel||(c={cmd:"dragMerge",sheetName:e.name(),oldSelection:i,newSelection:l},e.wu().execute(c),k(e,{sheetName:e.name(),sheet:e,mergeRange:l})))},jka:function(a){var b=this,c=b.kj,d=c.yl,e=d.hka;e(d,a)}})},"./dist/plugins/dragMerge/dragMerge.entry.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),c("./dist/plugins/dragMerge/dragMerge-action.js"),c("./dist/plugins/dragMerge/dragMerge.js"),c("./dist/plugins/dragMerge/dragMerge-event.js")},"./dist/plugins/dragMerge/dragMerge.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/dragMerge/dragMerge-action.js"),g=e.Common.pc,h=d.GC$,i="white";function l(a){var b=a.parent;return b&&b.options.backColor||i}function m(a,b,c){var d,e,f,g,h=a.Er(c.row);if((1===h||h!==a.Er(c.row+c.rowCount-1))&&(d=a.jt(1),d.length>0)){if(e=b.y+b.height/2,f=d[0],g=d[d.length-1],f.y<=e&&e<=f.y+f.height)return 1;if(g.y<=e&&e<=g.y+g.height)return 1}}function n(a,b,c){var d,e,f,g,h=a.Fr(c.col);if((1===h||h!==a.Fr(c.col+c.colCount-1))&&(d=a.it(1),d.length>0)){if(e=b.x+b.width/2,f=d[0],g=d[d.length-1],f.x<=e&&e<=f.x+f.width)return 1;if(g.x<=e&&e<=g.x+g.width)return 1}}function o(a,b,c){var e,f=a.am(),g=a.wNc(f),h=a.tNc(f),i=m(a,b,c),j=n(a,b,c);return e=1===i&&1===j?f.Ft(i,j):1===i?new d.Rect(f.kt,f.qt,f.hs+g+f.js,h):1===j?new d.Rect(f.pt,f.nt,g,f.fs+h+f.gs):new d.Rect(f.kt,f.nt,f.hs+g+f.js,f.fs+h+f.gs)}h.extend(d.oJ.prototype,{cja:function(a,b){var c,e,f,g,h,i,j,k,l,m,n,p,q,r,s,t,u,v=this,w=v.kj,x=w.mm;d.needPaintSelection(w)&&(c=w.cm(x.gka(b)),e=4,f=8,g=e/2,h=f/2,i=c.x,j=c.y,k=c.width,l=c.height,m=i+k-g,n=j+l/2-h,p=e,q=f,r=new d.Rect(m,n,p,q),s=o(w,r,b),m=i+k/2-h,n=j+l-g,p=f,q=e,t=new d.Rect(m,n,p,q),u=o(w,t,b),v.Xja=c,v.Wja(a,r,t,s,u))},Wja:function(a,b,c,e,f){var g=this,h=g.kj,i=d.Rm.Om(h,h.getSelectionBorderColor());a.save(),a.fillStyle=i,e&&(a.rect(e.x,e.y,e.width,e.height),a.clip()),a.beginPath(),a.rect(b.x,b.y,b.width,b.height),a.fill(),a.restore(),a.save(),a.fillStyle=i,f&&(a.rect(f.x,f.y,f.width,f.height),a.clip()),a.beginPath(),a.rect(c.x,c.y,c.width,c.height),a.fill(),a.restore()},hka:function(a,b){var c,e,f,h,i,j,k,m,n,o,p,q,r=a,s=r.kj,t=s.parent,u=s.mm,v=a.bm(),w=2,x=w/2;t&&t.options.allowUserDragMerge&&u.$ia&&(c=s.getActiveRowIndex(),e=s.getActiveColumnIndex(),f=s.getActualStyle(c,e),h=f&&f.backColor,i=l(s),j=g.ec(d.Rm.Om(s,h||i)),j.a*=.6/255,v.fillStyle=g.bc(j),v.strokeStyle=d.Rm.Om(s,s.getSelectionBorderColor()),v.lineWidth=2,v.beginPath(),k=t.Vv,m=s.cm(b),n=m.x,o=m.y,p=m.width,q=m.height,k>2007?(v.rect(n,o,p-x,q-x),v.strokeRect(n-1,o-1,p+1,q+1)):(v.rect(n+1,o+1,p-w-.5,q-w-.5),v.strokeRect(n-.5,o-.5,p,q)),v.fill(),v.restore(),r.cja(v,b))}}),j={init:function(){f.Commands.dja(this.commandManager())}},d.Workbook.$n("dragMerge",j),k={paintAdornment:function(a){var b,c=a.ctx,d=this,e=d.yl,f=d.ITa.getSelections();d.parent&&d.parent.options.allowUserDragMerge&&1===f.length&&!d.CH&&(b=d.Ix(),e.cja(c,b))}},d.Worksheet.$n("dragMerge",k)},"./dist/plugins/fill/drag-fill.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("./dist/plugins/fill/fill.js"),g=c("./dist/plugins/fill/fill.ns.js"),h=c("@grapecity/js-calc"),i=!!h,j=d.Common.j.Fa,k=null,l=void 0,m=e.kf,n=e.GC$,o=Math.max,p=Math.floor,q=e.Commands.ActionBase,r=e.Commands.xy,s=e.Commands.Bu,t=2047,u="startRange",v="fillRange",w="autoFillType",x="fillDirection",y="cancel",z="fill",A="dragDrop",B=n.isEmptyObject,C=new d.Common.ResourceManager(g.SR,"Fill"),D=C.getResource.bind(C);function J(a){return a.rowCount}function K(a){return a.colCount}function L(a,b){return a.getRowCount(b)}function M(a,b){return a.getColumnCount(b)}function N(a,b,c,d){return!!(a&&b&&b.containsRange(a))&&(!j(c)&&(1===c&&a.row===b.row&&J(a)===J(b)||0===c&&a.col===b.col&&K(a)===K(b))||!(j(d)||(2!==d&&3!==d||a.col!==b.col||K(a)!==K(b))&&(0!==d&&1!==d||a.row!==b.row||J(a)!==J(b))))}E={fillAuto:function(a,b,c){if(!b)throw Error(D().Exp_RangeIsNull);var e=this,g=c.fillType,h=c.series,i=c.direction,l=c.step,m=c.stop,n=new f.z$(e),o=c.hVJ;if(N(a,b,i?k:h,i)){e.suspendPaint(),a&&(e.mm.A$=a);try{4===g?n.B$(b,h,!1,c.withTag,c.withoutStyle,o):0===g?n.C$(b,i):1===g||2===g?n.D$(1===g,b,h,l,m):3===g&&n.E$(b,h,3,l,j(m)?k:d.Common.l.Ra(m),c.unit)}finally{e.resumePaint()}}}},n.extend(e.Worksheet.prototype,E),e.Worksheet.$n(z,{init:function(){this.Fyb=new f.Gyb(this)},setHost:function(a){if(a){var b=this.wu();b[z]||b.register(z,e.Commands[z]),b[A]||b.register(A,e.Commands[A])}},dispose:function(a){if(a.clearCache!==!1){var b=this;b.Fyb&&(b.Fyb.no(),b.Fyb=k)}}}),e.Workbook.$n(z,{onCultureChanged:function(){D()}}),F=function(a){I(b,a);function b(b,c){var d=a.call(this)||this,f=d,g=c[x],h=0===g,i=h||1===g,j=c[v],k=c[u],l=k.row,n=k.col,o=J(k),p=K(k);return f.kj=b,f.G$=c,4===c[w]?f.H$=new e.Commands.OA(b,{ranges:[c[v]]}):i?f.I$=m(l,h?j.col:n,o,p+K(j)):f.I$=m(2===g?j.row:l,n,o+J(j),p),f.J$=i?1:0,d}return b.prototype.canExecute=function(){var a=this,b=a.kj,c=a.G$,d=c[u],f=c[v];return!!b.Y3(f.row,f.col,J(f),K(f),void 0,void 0,void 0,void 0,!0,e.SheetArea.viewport)&&(4===c[w]||!f.intersect(d.row,d.col,J(d),K(d)))},b.prototype.execute=function(){var a,b,c,d,f,g,h=this;if(h.canExecute()){a=h.G$,b=a[v],c=h.kj,d=c.parent.LVJ(),e.Commands.Zxb(d),h.Lz(c,!0);try{i&&c.suspendCalcService(),f=c.getSelections(),c.isDirtySuspended()||(h.N$=new r(c,a[v],t)),4===a[w]?h.K$(c):h.L$(c),c.yu(f,c.getSelections())&&c.Au(f)}finally{h.Mz(c,!0),i&&c.resumeCalcService(!1),e.Commands.$xb(d,a),c.t4&&c.t4(b.row,b.col,J(b),K(b)),g=[],c.isDirtySuspended()||(h.M$=new r(c,b,t),h.M$.uy(h.N$.sy()),g=h.M$.wy()),s(c,b.row,b.col,J(b),K(b),g,1)}}},b.prototype.K$=function(a){var b,c,d,e,f,g,h,i,j,k=this;k.H$.execute(a),b=k.G$,c=b[u],d=b[v],e=0===k.J$,g=J(c),h=K(c),i=e?o(1,g-J(d)):g,j=e?h:o(1,h-K(d)),c.equals(d)||(f=m(c.row,c.col,i,j),a.Kr(o(a.ar(),f.row),o(a.$q(),f.col),a.Nr,a.Pr),a.Tr(),a.RXJ(f.row,f.col,J(f),K(f)))},b.prototype.L$=function(a){var b,c,d,f,g,h,i,j,m,n,q,r=this,s=r.kj,t=r.G$,y=t[u],z=t[v],A=t[w],B=r.I$,C={fillType:4,series:r.J$,withTag:!0,withoutStyle:!(s.tXJ&e.CopyToOptions.style)},D=s.tables,E=!1,F=new e.Range(B.row,B.col,B.rowCount,B.colCount);if(D)try{d=t[x],f=2===d,f&&(g=y.rowCount,h=0===D.s$(y.row,y.col,g,y.colCount).length,h&&(E=!0,F.rowCount-=g)),i=[],D.jIb(k,F,l,l,l,i,{applyDragFillAfterTableExpand:E}),i.length>0&&(C.hVJ=i)}catch(a){return s.Os(6,a.message),void s.resumePaint()}if(1===A){if(s.fillAuto(y,B,C),s.tXJ&e.CopyToOptions.style&&s.ITa.MTa(y.row,y.col,y.rowCount,y.colCount))for(b=0;b<z.rowCount;b++)for(c=0;c<z.colCount;c++)j=s.Aj(y.row+p(b%y.rowCount),y.col+p(c%y.colCount)),j&&j.clone&&(j=j.clone()),s.Nq(z.row+b,z.col+c,j)}else 0===A?(m=s.tXJ&~e.CopyToOptions.comment,r.O$(y,z,m)):2===A?r.O$(y,z,192):3===A&&(n=!(1!==J(y)||1!==K(y)||y.row===-1&&y.col!==-1||y.col===-1&&y.row!==-1),n?(q=187,r.O$(y,z,q)):(C.withoutStyle=!0,s.fillAuto(y,B,C)));s.Kr(o(a.ar(),B.row),o(a.$q(),B.col),a.Nr,a.Pr),a.Tr&&a.Tr(),s.RXJ(B.row,B.col,J(B),K(B))},b.prototype.O$=function(a,b,c){var d=this,e=d.kj,f=e.Tq(a),g=e.Tq(b),h=f.row,i=f.col,j=J(f),k=K(f),l=g.row,m=g.col,n=J(g),o=K(g),q=d.G$[x],r=3===q,s=1===q,t=p(n/j),u=n%j,v=p(o/k),w=o%k,y,z,A,B,C;if(e.I9J=!0,0===d.J$){for(y=0;y<t;y++)B=r?l+y*j:l+n-(y+1)*j,e.ax(h,i,B,m,j,k,c,!0,!0);0!==u&&(z=r?h:h+(t+1)*j-n,B=r?l+j*t:l+n-t*j-u,e.ax(z,i,B,m,u,k,c,!0,!0))}else{for(y=0;y<v;y++)C=s?m+y*k:m+o-(y+1)*k,e.ax(h,i,l,C,j,k,c,!0,!0);0!==w&&(A=s?i:i+(v+1)*k-o,C=s?m+k*v:m+o-v*k-w,e.ax(h,A,l,C,j,w,c,!0,!0))}delete e.I9J,e.recalcRange(l,m,n,o)},b.prototype.undo=function(){var a,b,c,d,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{i&&f.suspendCalcService(),a=f.getSelections(),b=e.G$,c=f.NF,d=b[v],g=4===b[w]?e.S$(f):e.T$(f),!f.U$&&c&&c.close(),s(f,d.row,d.col,J(d),K(d),e.M$?e.M$.wy():[],1,l,!0),f.yu(a,f.getSelections())&&f.Au(a)}finally{e.Mz(f,!0),i&&f.resumeCalcService(!1)}}return g},b.prototype.S$=function(a){var b=this,c=b.G$[u],d=c.row,f=c.col,g=e.Commands.bWa(a.name());return a.ITa.undo(b.G$[g]),a.Kr(o(a.ar(),d),o(a.$q(),f),a.Nr,a.Pr),!0},b.prototype.T$=function(a){var b,c=this,d=c.G$,f=d[u],g=f.row,h=f.col;i&&a.suspendCalcService();try{b=e.Commands.bWa(a.name()),a.ITa.undo(d[b]),a.Kr(o(a.ar(),g),o(a.$q(),h),a.Nr,a.Pr)}finally{i&&a.resumeCalcService(!1)}return a.invalidateLayout(),!0},b}(q),G=function(a){I(b,a);function b(b,c){var d=a.call(this)||this,e=d;return e.kj=b,e.i4=c,e.W$=c[u],e.X$=c[v],e.Y$=c[w],e.Z$=c[x],d}return b.prototype.execute=function(){var a,b,c,d,f,g,h,i,j,k=this,l=!1;if(k.canExecute()){a=k.kj,b=a.parent,c=k.X$,d=k.i4,f=a.parent.LVJ(),e.Commands.Zxb(f),k.oUa(),k.Lz(a,!0),a.vxb=!0;try{g=a.getSelections(),h=void 0,i=a.mm,j={sheet:a,sheetName:a.name()},j[y]=!1,j[v]=c,j[w]=k.Y$,j[x]=k.Z$,a.Wq(e.Events.DragFillBlock,j),i.$$=j[w],i._$=j[y],j[y]||(k.a_(j),a.Wq(e.Events.DragFillBlockCompleted,j)),l=!0,h=a.getSelections(),a.yu(g,h)&&a.Au(g),b&&d.xC&&b.changeSelectionInCommandExecuting(d,null,null,h)}finally{k.Mz(a,!0),a.vxb=!1,k.IVa(a,c),e.Commands.$xb(f,k.i4)}}return l},b.prototype.a_=function(a){var b,c,d=this,e=d.kj,f=e.mm,g=d.X$,h=d.Y$;f.$$=h,f._$||(b={},b[u]=d.W$,b[v]=g,b[w]=5===a[w]?h:a[w],b[x]=d.Z$,c=new F(e,b),e.suspendEvent(),c.execute(),e.resumeEvent(),d.i4.d_=c)},b.prototype.oUa=function(){var a=this;a.kj.isDirtySuspended()||(a.N$=new r(a.kj,a.X$,t))},b.prototype.undo=function(){var a,b,c,d,f,g,h,i=this;if(i.canUndo()){a=i.kj,b=i.X$,c=a.parent,d=i.i4,i.oUa(),i.Lz(a,!0);try{f=a.getSelections(),a.suspendEvent(),g=e.Commands.bWa(a.name()),a.ITa.undo(i.i4[g]),a.resumeEvent(),h=d[u],a.yu(f,[h])&&a.Au(f),c&&d.xC&&c.changeSelectionInCommandExecuting(d,null,null,[h])}finally{i.Mz(a,!0),i.IVa(a,b,!0)}}return!0},b.prototype.IVa=function(a,b,c){var d,e=this,f=[];a.isDirtySuspended()||(d=new r(a,b,t),d.uy(e.N$.sy()),f=d.wy()),s(a,b.row,b.col,J(b),K(b),f,1,l,c)},b}(q);function O(a,b,c,d,e,f){var g,h,i,j=a.getSelections();a.Tr(),a.RXJ(b,c,d,e,!0),g=a.getSelections(),h=b>0?b:a.ar(),i=c>0?c:a.$q(),a.Kr(h,i,a.Nr,a.Pr),a.Au(j),a.parent&&f.xC&&a.parent.changeSelectionInCommandExecuting(f,null,null,g)}function P(a){var b=a.parent,c=b.getActiveSheet();c&&a!==c&&c.repaint()}H=function(a){I(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){var a,b,c,d,f,g,h,i=this,j=i.kj,l=i.VQ,m=l.fromRow,n=l.fromColumn,o=J(l),p=l.columnCount,q=l.toRow,r=l.toColumn,s=!l.copy,t={row:m,col:n,rowCount:o,colCount:p},u={row:q,col:r,rowCount:o,colCount:p};if(j.tables&&j.tables.zxb(j,t,j,u,s))return!1;if(!j.pu(m,n,o,p,L(j),M(j)))return!1;if(!l.insert&&!j.pu(q,r,o,p,L(j),M(j)))return!1;if(l.cmd===e.RangeChangedAction[0]&&j.tables&&(a=!1,b=j.tables.s$(m,n,o,p),b.length>0)){for(c=b[0].range(),d=c.row;d<c.row+c.rowCount;d++)if(j.isRowFilterOut(d)){a=!0;break}return!(a&&c.contains(l.mouseTargetRow,l.mouseTargetCol,1,1))}return f=q>=0&&r<0&&m>=0&&n<0&&o>0&&p<0,g=q<0&&r>=0&&m<0&&n>=0&&o<0&&p>0,h=i.KZa(f,g),j.Y3(q,r,o,p,k,k,h,k,k,e.SheetArea.viewport)&&j.Y3(m,n,o,p,k,k,h,k,k,e.SheetArea.viewport)},b.prototype.KZa=function(a,b){var c,d,e=this,f=e.VQ,g=e.kj,h=f.insert,i=g.options.isProtected,j=g.options.protectionOptions;return!(!i||B(j)||(c=j.allowDragInsertRows,d=j.allowDragInsertColumns,!h||!(c&&a||d&&b)))},b.prototype.WCJ=function(a){var b=[].concat(a.parent.sheets);return a&&a.ODJ&&b.push(a),b},b.prototype.execute=function(){var a,b,c,d,f,g,h,i,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=this,D=!1;if(C.canExecute()){a=C.kj,b=C.VQ,C.oUa(),c=void 0,d=void 0,f=void 0,g=b.fromRow,h=b.fromColumn,i=b.toRow,l=b.toColumn,m=J(b),n=b.columnCount,o=b.option,p=m,q=n,r=C.WCJ(a),s=a.CMc(),s&&(p+=a.DMc(i,m,!0),q+=a.DMc(l,n)),e.Commands.Zxb(r),C.Lz(a,!0),a.vxb=!0,t=void 0;try{try{t={shiftCells:b.insert&&b.shiftCells===e.InsertShiftCell.down,isCopy:b.copy,isFirst:!0},a.tables&&a.tables.jIb(a,new e.Range(i,l,p,q),new e.Range(g,h,m,n),k,k,k,{shiftInfo:t})}catch(b){return a.Os(6,b.message),void a.resumePaint()}b.insert?h>=0&&g<0?(c=h,d=l,f=n,u=l,a.addColumns(d,f),b.copy?a.copyTo(-1,d<=c?c+f:c,-1,d,-1,f,o):(a.moveTo(-1,d<=c?c+f:c,-1,d,-1,f,o),a.deleteColumns(d<=c?c+f:c,f),c<d&&(u=d-f)),O(a,-1,u,L(a),f,b)):g>=0&&h<0?(c=g,d=i,f=m,v=i,a.addRows(d,f),b.copy?a.copyTo(d<=c?c+f:c,-1,d,-1,f,-1,o):(a.moveTo(d<=c?c+f:c,-1,d,-1,f,-1,o),a.deleteRows(d<=c?c+f:c,f),c<d&&(v=d-f)),O(a,v,-1,f,M(a),b)):g>=0&&h>=0&&(w=b.shiftCells,x=new e.Range(i,l,1,1),y=new e.Range(g,h,m,n),j(w)||(z={cmd:"clipboardPaste",sheetName:a.name(),clipboardHtml:"",clipboardImage:"",clipboardText:"",fromRanges:[y],fromSheet:a,isCutting:!b.copy,pasteOption:0,pastedRanges:[new e.Range(i,l,m,n)],_Hb:x,aIb:y,$Hb:w,c$J:!0,b$J:t&&t.ignoreFooterShiftIndex},a.wu().execute(z),A=a.getSelections()[0],w===e.InsertShiftCell.down&&i>g&&!b.copy&&h===l?a.setSelection(A.row-m,A.col,A.rowCount,A.colCount):w===e.InsertShiftCell.right&&l>h&&!b.copy&&g===i&&a.setSelection(A.row,A.col-n,A.rowCount,A.colCount))):(b.copy?a.copyTo(g,h,i,l,m,n,o):a.moveTo(g,h,i,l,m,n,o),a&&(O(a,i,l,p,q,b),B=b.io,b.copy||a.isDirtySuspended()||(B._z=C.aA(a,B.cA,g,h,m,n)),a.isDirtySuspended()||(B.dA=C.aA(a,B.fA,i,l,m,n)))),D=!0}finally{a.mm.gA={},C.Mz(a,!0),a.vxb=!1,e.Commands.$xb(r,b)}P(a)}return D},b.prototype.aA=function(a,b,c,d,e,f){var g=new r(a,m(c,d,e,f),this.VQ.option),h=a.tables&&a.tables.cIb&&a.tables.cIb(c,d,e,f);return h&&h.length>0&&(this.VQ.tableNamesObj={r:c,c:d,rc:e,cc:f,tableNames:h}),g.uy(b.sy()),s(a,c,d,e,f,g.wy(),0,h),g},b.prototype.oUa=function(){var a=this,b=a.kj,c=a.VQ,d=c.io={},e=c.fromRow,f=c.fromColumn,g=c.toRow,h=c.toColumn,i=c.option,j=e<0?0:e,k=f<0?0:f,l=g<0?0:g,n=h<0?0:h,o=e<0?L(b):J(c),p=f<0?M(b):c.columnCount;c.insert||b.isDirtySuspended()||(c.copy||(d.cA=new r(b,m(j,k,o,p),i)),d.fA=new r(b,m(l,n,o,p),i)),d.rA=b.Nr,d.sA=b.Pr,d.tA=b.Jl,d.uA=b.Kl},b.prototype.undo=function(){var a,b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z=this;if(z.canUndo()){if(a=z.kj,b=z.VQ,c=b.fromRow,d=b.fromColumn,f=b.toRow,g=b.toColumn,h=J(b),i=b.columnCount,!a.pu(c,d,h,i,L(a),M(a)))return!1;if(!b.insert&&!a.pu(f,g,h,i,L(a),M(a)))return!1;j=void 0,k=b.io,z.Lz(a,!0),l=z.WCJ(a),e.Commands._xb(l,b);try{b.insert?d>=0&&c>=0||(d>=0?(m=d,j=i,a&&O(a,-1,m,L(a),j,b)):c>=0&&(j=h,n=c,a&&O(a,n,-1,j,M(a),b))):(o=c<0?0:c,p=d<0?0:d,q=f<0?0:f,r=g<0?0:g,t=c<0?L(a):h,u=d<0?M(a):i,a&&(O(a,c,d,h,i,b),v=b.tableNamesObj,w=[],x=[],v&&(v.r===q&&v.c===r&&v.rc===t&&v.cc===u?x=v.tableNames:w=v.tableNames),s(a,q,r,t,u,k.dA?k.dA.wy():[],0,w,!0),s(a,o,p,t,u,k._z?k._z.wy():[],0,x,!0))),a&&(k.tA!==-1&&k.uA!==-1&&(y=a.getSelections()[0],y.contains(k.tA,k.uA)?a.Jr(k.tA,k.uA):a.Jr(y.row,y.col)),k.rA!==-2&&k.sA!==-2&&k.tA!==-1&&k.uA!==-1&&a.showCell(k.tA,k.uA,3,3))}finally{z.Mz(a,!0)}P(a)}return!0},b}(q),e.Commands[z]={canUndo:!0,execute:function(a,b,c){return e.Commands.h4(a,G,b,c)}},e.Commands[A]={canUndo:!0,execute:function(a,b,c){return e.Commands.h4(a,H,b,c)}}},"./dist/plugins/fill/fill-event.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("SheetsCalc"),g=c("./dist/plugins/fill/fill-ui.js"),h=c("./dist/plugins/fill/fill.js"),i=c("./dist/plugins/fill/fill.ns.js"),j=c("@grapecity/js-calc"),k=!!j,l=e.GC$,m=e.kf,n=d.Common.j.Fa,o=null,p=void 0,q=Math.min,r=Math.abs,s=Math.max,t=5,u=3,v="drag",w="corner",x="black",y=2047,z=d.Common.u,A=new d.Common.ResourceManager(i.SR,"Fill"),B=A.getResource.bind(A);function C(a){return a.rowViewportIndex}function D(a){return a.colViewportIndex}function E(a){return a.frozenRowCount()}function F(a){return a.frozenColumnCount()}function G(a){return a.hitTestType}function H(a,b){return a.getRowCount(b)}function I(a,b){return a.getColumnCount(b)}function J(a){return a.colCount}function K(a){return a.rowCount}function L(a){return a.height}function M(a){return a.width}function N(a){var b=7,c=a.parent;return c&&(b=c.Vv>2007?2:7),b}function O(a,b,c,d,f,g,h){a.save();var i,j,k;g=g||x,h=h||2,b===d?(a.rect(b-2,c,7,r(f-c)),a.clip(),a.beginPath(),c<f?(c-=3,f+=3):(c+=3,f-=3),i=e.zF(b-1,c-1,d-1,f+1,g,h),j=e.zF(b,c,d,f,g,h),k=e.zF(b+1,c-1,d+1,f+1,g,h)):c===f&&(a.rect(b,c-2,r(d-b),7),a.clip(),a.beginPath(),b<d?(b-=3,d+=3):(b+=3,d-=3),i=e.zF(b-1,c-1,d+1,f-1,g,h),j=e.zF(b,c,d,f,g,h),k=e.zF(b-1,c+1,d+1,f+1,g,h)),i&&i.vE(a),j&&j.vE(a),k&&k.vE(a),a.strokeStyle=g,a.stroke(),a.beginPath(),a.restore()}function P(a,b,c,d,f,g,h,i,j,k,l){var m=b?e.Events.DragDropBlock:e.Events.DragDropBlockCompleted,n={sheet:a,sheetName:a.name(),fromRow:c,fromCol:d,toRow:f,toCol:g,rowCount:h,colCount:i,copy:j,insert:k,copyOption:l};return b&&(n.cancel=!1),a.Wq(m,n),n}function Q(a,b,c,d,e){var f,g,h;for(f=0;f<c.rowCount;f++){for(g=0;g<c.colCount;g++){if(h=a.getSpan(c.row+f,c.col+g),!h||h.rowCount!==b.rowCount||h.colCount!==b.colCount)return!1;d&&(g+=b.colCount)}e&&(f+=b.rowCount)}return!0}function R(a,b,c){var d,e=b.row,f=b.rowCount,g=b.col,h=b.colCount,i=c.row,j=c.rowCount,k=c.col,l=c.colCount,m=e===i&&f===j,n=g===k&&h===l;return!(!m&&!n)&&(d=a.getSpan(e,g),!(!d||!Q(a,d,b,m,n))&&(!a.ITa.qu(i,k,j,l)&&Q(a,d,c,m,n)))}l.extend(e.iI.prototype,{gG:function(a){var b,c,d,e,f,g,h,i,j,k,l,m=this;m.zG||(b=m.kj,c=o,d=b.ITa.getSelections(),1===d.length?c=d[0]:d.length<1&&(c=b.ITa.getSpan(b.Jl,b.Kl)),c&&(m.zG=!0,m.OG=!0,m.L_=c,e=b.tables&&b.tables.find(c.row,c.col),e&&(m.z$J=!0,f=!0,g=e.range(),(e.showHeader()&&c.row===g.row||e.showFooter()&&c.row===g.row+g.rowCount-1||c.col!==g.col||c.colCount!==g.colCount)&&(f=!1),f&&(m.A$J=!0,m.j$J=!0,m.B$J=e.name())),h=b.getRangeRect(C(a),D(a),c),i=m.gA,i.x=h.x,i.y=h.y,i.width=h.width-1,i.height=h.height-1,i.row=c.row,i.col=c.col,i.rowCount=K(c),i.colCount=J(c),j=b.Tq(c),k=a.row,l=a.col,k<j.row&&(k=j.row),k>=j.row+K(j)&&(k=j.row+K(j)-1),l<j.col&&(l=j.col),l>=j.col+J(j)&&(l=j.col+J(j)-1),i.hitRow=k,i.hitCol=l,i.rowOffset=k-j.row,i.colOffset=l-j.col,m.rG={KG:C(a),MG:D(a),sG:G(a)},m.qG()))},AG:function(){var a,b,c,d,e,f,g,h,i,j,k=this;k.rG&&k.OG&&k.zG&&k.L_&&(a=k.$F,b=k.gA,c=k.kj.getCellRect(b.hitRow,b.hitCol),d=c.width/2,e=c.x+d,f=c.height/2,g=c.y+f,b.hitTarget={x:a.x,y:a.y},h=k.fH(),i=k.gH(),j=!1,(r(e-a.x)>d+5||r(g-a.y)>f+5)&&(j=!0),h>=0&&i>=0&&j&&k.M_(h,i),k.NG())},M_:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,r,u,v,w,x,y=this;y.zG&&y.L_&&(c=y.kj,d=y.gA,e=c.CMc(),f=c.Ix(),g=H(c),h=I(c),i=q(h-J(d),b-d.colOffset),j=q(g-K(d),a-d.rowOffset),e&&(k=c.FMc(b,d.colOffset+1),l=c.FMc(a,d.rowOffset+1,!0),i-=k,j-=l,0===c.getColumnWidth(i)&&(i=c.br(i)),0===c.getRowHeight(j)&&(j=c.gr(j))),f.row===-1&&f.col!==-1?(d.row=-1,d.col=s(0,i)):f.row!==-1&&f.col===-1?(d.row=s(0,j),d.col=-1):(d.row=d.row<0?-1:s(0,j),d.col=d.col<0?-1:s(0,i)),y.A$J&&(m=c.tables&&c.tables.find(a,b),n=m&&m.range(),!m||m.name()!==y.B$J||a===n.row||m.showFooter()&&a===n.row+n.rowCount?y.j$J=!1:y.j$J=!0,y.j$J?(d.col=n.col,y.OH=!y.isPressShiftKey):y.OH=y.isPressShiftKey),d.hitRow=a,d.hitCol=b,o=c.Tq(d),e&&(p=c.DMc(o.row,o.rowCount,!0),r=c.DMc(o.col,o.colCount),o.rowCount+=p,o.colCount+=r,o.rowCount=q(g,o.rowCount),o.colCount=q(h,o.colCount),o.row+o.rowCount>g&&(o.row=g-o.rowCount,d.row=o.row),o.col+o.colCount>h&&(o.col=h-o.colCount,d.col=o.col)),u=y.N_,u&&o.row===u.row&&o.col===u.col&&K(o)===K(u)&&J(o)===J(u)&&o.row>c.ar()&&o.col>c.$q()&&o.row+K(o)-1<c.ir()&&o.col+J(o)-1<c.dr()||(y.MI=o,c.yl.QH(),y.N_=o,v=c.parent,v&&v.options.showDragDropTip&&(w=d.x+d.width+t,x=d.y+d.height+t,v.uw(z.Ob(y.O_(o)),w,x))))},O_:function(a){var b,c,d,e,g,h,i,l,m,n,q,r,s,t;return a&&k?(b=this.kj,c=b.Ix(),d=K(c),e=J(c),g=b.getActiveRowIndex(),h=b.getActiveColumnIndex(),i=void 0,l=b.CMc(),g=g<0?0:g,h=h<0?0:h,1===d&&1===e?i=j.rf(o,o,a.row-g,a.col-h,!0,!0):(m=void 0,n=void 0,q=void 0,r=void 0,s=0,t=0,c.row===-1&&c.col>=0?(m=q=f.BAND_INDEX_CONST,n=a.col-h,r=a.col-h+e-1,t=e):c.col===-1&&c.row>=0?(n=r=f.BAND_INDEX_CONST,m=a.row-g,q=a.row-g+d-1,s=d):c.row>=0&&c.col>=0&&(m=a.row-g,q=a.row-g+d-1,n=a.col-h,r=a.col-h+e-1,s=d,t=e),l&&(q+=b.DMc(a.row,s,!0),r+=b.DMc(a.col,t)),i=j.uf(o,o,m,n,q,r,!0,!0,!0,!0,g,h)),b.Cf().unparse(b.yj(),i,g,h)):p},wH:function(a){var b,c,d,f,g,h,i,j,l,n,p,q,r,s,t,u,v,w,x,y=this,z=!1,A="",C=!1,D=y.kj;y.rG=o,y.RG(),c=D.Ix(),d=y.gA.row,f=y.gA.col,g=y.gA.hitRow,h=y.gA.hitCol,y.OH&&c.contains(g,h)||(b=c&&(K(c)>0||J(c)>0)?{r:c.row,c:c.col,rc:K(c),cc:J(c)}:{r:D.Jl,c:D.Kl,rc:1,cc:1},y.zG===!0&&y.OG===!0&&(i=b.r,j=b.c,l=b.rc,n=b.cc,p=D.options.protectionOptions,q=D.tXJ,r=void 0,y.shiftCells=null,y.OH&&(y.shiftCells=y.C$J?e.InsertShiftCell.right:e.InsertShiftCell.down),s={fromRow:i,fromColumn:j,rowCount:l,columnCount:n,toRow:d,toColumn:f,isDragInsert:y.OH,isDragCopy:y.PH},D.Wq(e.Events.BeforeDragDrop,s),A=s.invalidMessage,A&&0!==A.length||(!y.OH||i!==-1&&j!==-1?d===i&&f===j||(v=D.qu(i,j,l,n),w=D.qu(d,f,l,n),(v||w)&&(x=!1,v||y.shiftCells!==e.InsertShiftCell.right&&y.shiftCells!==e.InsertShiftCell.down||(x=!0),x||(z=!0,A=B().Exp_ChangeMergedCell)),z||k&&(D.Ns(i,j,l,n)||D.Ns(d,f,l,n))&&(z=!0,A=B().Exp_ChangePartOfArray),!z&&D.options.isProtected&&(!y.PH&&D.ou(m(i,j,l,n),!0,e.SheetArea.viewport)||D.ou(m(d,f,l,n),!0,e.SheetArea.viewport))&&(z=!0,A=D.k9J()),z||(y.OH&&(y.C$J?f=y.gA.hitCol:d=y.gA.hitRow),r=P(D,!0,i,j,d,f,l,n,y.PH,!1,q),r.cancel||(C=D.wu().execute({cmd:"dragDrop",sheetName:D.name(),fromRow:i,fromColumn:j,toRow:d,toColumn:f,rowCount:l,columnCount:n,copy:y.PH,insert:y.OH,shiftCells:y.shiftCells,option:r.copyOption,mouseTargetRow:g,mouseTargetCol:h}),P(D,!1,i,j,d,f,l,n,y.PH,!1,r.copyOption)))):j>=0?(y.PH&&(f<=j||f>=j+n)||!y.PH&&(f<j||f>j+n))&&((D.qu(-1,j,-1,n)||D.qu(-1,f,-1,0))&&(z=!0,A=B().Exp_ChangeMergedCell),t=p&&p.allowDragInsertColumns,!z&&D.options.isProtected&&t!==!0&&(z=!0,A=B().Exp_ColumnReadOnly),z||(r=P(D,!0,-1,j,-1,f,-1,n,y.PH,!0,q),r.cancel||(C=D.wu().execute({cmd:"dragDrop",sheetName:D.name(),fromRow:-1,fromColumn:j,toRow:-1,toColumn:f,rowCount:-1,columnCount:n,copy:y.PH,insert:!0,option:r.copyOption,mouseTargetRow:g,mouseTargetCol:h}),P(D,!1,-1,j,-1,f,-1,n,y.PH,!0,r.copyOption)))):i>=0&&j<0&&(y.PH&&(d<=i||d>=i+l)||!y.PH&&(d<i||d>i+l))&&((D.qu(i,-1,l,-1)||D.qu(d,-1,0,-1))&&(z=!0,A=B().Exp_ChangeMergedCell),z||k&&(D.Ns(i,-1,l,-1)||D.Ns(d,-1,0,-1))&&(z=!0,A=B().Exp_ChangePartOfArray),u=p&&p.allowDragInsertRows,!z&&D.options.isProtected&&u!==!0&&(z=!0,A=B().Exp_RowReadOnly),z||(r=P(D,!0,i,-1,d,-1,l,-1,y.PH,!0,q),r.cancel||(C=D.wu().execute({cmd:"dragDrop",sheetName:D.name(),fromRow:i,fromColumn:-1,toRow:d,toColumn:-1,rowCount:l,columnCount:-1,copy:y.PH,insert:!0,option:r.copyOption,mouseTargetRow:g,mouseTargetCol:h}),P(D,!1,i,-1,d,-1,l,-1,y.PH,!0,r.copyOption))))))),y.OG=!1,y.zG=!1,y.A$J=!1,y.z$J=!1,y.j$J=!1,y.B$J=o,y.L_=o,y.OH=!1,y.PH=!1,y.N_=o,y.MI=o,y.xw(),C||(y.gA={},D.repaint()),z&&D.Os(3,A)},hG:function(a){var b=this;b.BG!==!0&&b.OG!==!0&&(b.P_(),b.A$&&(b.OG=!0,b.BG=!0,b.$I=!0,b.Q_=a,b.R_=D(a),b.S_=C(a),b.T_=D(a),b.U_(),b.rG={KG:C(a),MG:D(a),sG:G(a)},b.qG()))},U_:function(){var a,b=this,c=E(b.kj),d=F(b.kj),e=b.V_();e>=0&&e<c?b.W_=0:e>=c&&e<=H(b.kj)&&(b.W_=1),b.X_()?b.Y_=1:b.Y_=b.Q_,a=b.Z_(),a>=0&&a<d?b.__=0:a>=d&&a<=I(b.kj)&&(b.__=1),b.a0()?b.b0=1:b.b0=b.R_},CG:function(){var a,b,c,d=this;d.rG&&d.BG&&d.OG&&d.A$&&(d.S_=d.iH(),d.T_=d.jH(),d.c0=d.fH(),d.d0=d.gH(),d.c0>=0&&d.d0>=0&&(d.e0(),d.f0(),a=d.kj.parent,b=!1,c=d.g0(),c&&(b=d.h0(d.A$,d.A_,!0)),a&&a.options.showDragFillTip&&b&&d.i0(),d.j0()),d.NG())},k0:function(){var a,b,c,e,f,g,i,j,k,l,m,n,p,q=this,r=q.kj,s=q.A$,t=q.A_,u=r.parent.options.defaultDragFillType,v=q.l0(3===u?5:u,3===u),w=q.m0(),x=q.g0();return 1===v?(a=0===w||1===w?1:0,c=new h.z$(r),e=c.B$(x,a,!0),b=q.n0(w,t,s),f=r.getActualStyle(b.row,b.col),g=f.cellType||r.Al(),i=f.formatter?f.formatter:f._autoFormatter,j=d.Formatter&&d.Formatter.GeneralFormatter,e instanceof Date&&j&&(i=new j(d.Common.CultureManager.q4().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@","0")),k=q.rG,l=3,k&&(l=k.sG),m={sheet:r,row:b.row,col:b.col,sheetArea:l,quotePrefix:f.quotePrefix},n={},g.format(e,i,n,m)):0===v?(b=q.n0(w,t,s),p=r.getFormula(b.row,b.col),p?o:r.getText(b.row,b.col)):o},n0:function(a,b,c){var d,e=c.row,f=c.col,g=K(c),h=J(c),i=m(e,f,1,1);return 3===a?(d=K(b)%g,d=0===d?e+g-1:e+d-1,i.row=d,i.col=f):1===a?(d=J(b)%h,d=0===d?f+h-1:f+d-1,i.row=e,i.col=d):0===a?(d=J(b)%h,d=0===d?f:f+h-d,i.row=e,i.col=d):2===a&&(d=K(b)%g,d=0===d?e:e+g-d,i.row=d,i.col=f),i},i0:function(){var a,b,c,d,e,f,g=this,h=g.kj,i=g.l0();return 4===i||g.a0()||g.X_()?(g.xw(),o):(d=g.m0(),e=g.g0(),f=h.cm(e),c=g.k0(),3===d||1===d?(a=f.x+f.width+u,b=f.y+f.height+u):0===d?(a=f.x+u,b=f.y+f.height+u):2===d&&(a=f.x+f.width+u,b=f.y+u),void g.uw(c,a,b))},j0:function(){var a=this;a.o0(),a.p0(),a.q0(),a.r0=a.g0()},o0:function(){var a,b=this.kj;this.r0&&(a=b.cm(this.r0),a.x-=2,a.y-=2,a.width+=4,a.height+=4,b.yl.dm(a))},p0:function(a){var b=this.kj;b.yl.im(this.A$,o,a)},q0:function(){var a,b,c,d,e=this.kj,f=e.yl,g=this.g0();g&&(a=f.bm(),b=e.cm(g),c=e.getSelectionBorderColor(),d=N(e),a.save(),a.beginPath(),f.RI(a,b,c,d),a.restore())},f0:function(){this.A_=this._I()},a0:function(){return this.A$.col===-1&&this.A$.row!==-1},X_:function(){return this.A$.row===-1&&this.A$.col!==-1},ZI:function(){return 4===this.dJ||5===this.dJ},_I:function(){var a=this,b=-1,c=-1,d=-1,e=-1;switch(a.dJ){case 0:a.X_()?(b=-1,d=-1):(b=a.V_(),d=K(a.A$)),c=a.d0,e=a.Z_()-c;break;case 1:a.X_()?(b=-1,d=-1):(b=a.V_(),d=K(a.A$)),c=a.s0()+1,e=a.d0-c+1;break;case 2:b=a.c0,d=a.V_()-b,a.a0()?(c=-1,e=-1):(c=a.Z_(),e=J(a.A$));break;case 3:b=a.t0()+1,d=a.c0-b+1,a.a0()?(c=-1,e=-1):(c=a.Z_(),e=J(a.A$));break;case 5:b=a.c0,d=a.t0()-b+1,a.a0()?(c=-1,e=-1):(c=a.Z_(),e=J(a.A$));break;case 4:a.X_()?(b=-1,d=-1):(b=a.A$.row,d=K(a.A$)),c=a.d0,e=a.s0()-c+1}return m(b,c,d,e)},u0:function(){var a=this.t0();return a!==-1?this.kj.Gr(this.Y_).findRow(a):o},v0:function(){return this.kj.Gr(this.S_).findRow(this.w0())},w0:function(){return this.kj.getViewportBottomRow(this.S_)},x0:function(){var a=this.s0();return a!==-1?this.kj.Hr(this.b0).findCol(a):o},y0:function(){return this.kj.Hr(this.T_).findCol(this.z0())},z0:function(){return this.kj.getViewportRightColumn(this.T_)},e0:function(){var a,b,c,d,e,f,g,h,i,j,k,m,n,o,p,s,t,u,v,w,x=this,y=x.a0(),z=x.X_(),A=l(x.kj.Ws()).offset(),B=x.$F.e,C=x.$F.x,D=x.$F.y,E=B.pageX-A.left,F=B.pageY-A.top,G=!1;y||z?z?x.d0>=x.Z_()&&x.d0<=x.s0()?x.dJ=4:x.d0<x.Z_()?x.dJ=0:x.d0>x.s0()&&(x.dJ=1):y&&(x.c0>=x.V_()&&x.c0<=x.t0()?x.dJ=5:x.c0<x.V_()?x.dJ=2:x.c0>x.t0()&&(x.dJ=3)):x.c0>=x.V_()&&x.c0<=x.t0()?x.d0>=x.Z_()&&x.d0<=x.s0()?(a=r(x.d0-x.s0()),b=r(x.c0-x.t0()),b>a?x.dJ=5:b<a?x.dJ=4:(c=x.u0(),c||(c=x.v0()),D>c.y+c.height?x.dJ=3:(d=x.x0(),d||(d=x.y0()),e=d.x+d.width-C,f=c.y+c.height-D,E>=d.x&&E<=d.x+d.width&&F>=c.y&&F<=c.y+c.height?e>=f?x.dJ=4:x.dJ=5:G=!0))):x.d0<x.Z_()?x.dJ=0:x.d0>x.s0()&&(x.dJ=1):x.c0<x.V_()?x.d0>=x.Z_()&&x.d0<=x.s0()?x.dJ=2:x.d0<x.Z_()?(a=r(x.d0-x.Z_()),b=r(x.c0-x.V_()),b>=a?x.dJ=2:x.dJ=0):x.d0>x.s0()&&(a=r(x.d0-x.s0()),b=r(x.c0-x.V_()),b>=a?x.dJ=2:x.dJ=1):x.c0>x.t0()&&(x.d0>=x.Z_()&&x.d0<=x.s0()?x.dJ=3:x.d0<x.Z_()?(a=r(x.d0-x.Z_()),b=r(x.c0-x.t0()),b>=a?x.dJ=3:x.dJ=0):x.d0>x.s0()&&(a=r(x.d0-x.s0()),b=r(x.c0-x.t0()),b>=a?x.dJ=3:x.dJ=1)),g=x.kj.yl.rH,g&&(h=x.t0(),i=x.s0(),j=h+1,k=i+1,m=x.kj.getRowHeight(h,3),n=x.kj.getColumnWidth(i,3),o=x.kj.getRowHeight(j,3),p=x.kj.getColumnWidth(k,3),s=g.x+g.width/2-q(10,n/2),t=g.x+g.width/2+q(10,p/2),u=g.y+g.height/2-q(10,m/2),v=g.y+g.height/2+q(10,o/2),w=!1,w=y||z?z?s<=E&&E<=t:u<=F&&F<=v:s<=E&&E<=t&&u<=F&&F<=v,w||G?(x.$I=!0,x.dJ=4):x.$I=!1)},V_:function(){return this.A$?this.A$.row===-1?0:this.A$.row:-1},t0:function(){var a=this;return a.A$?a.A$.row===-1?H(a.kj)-1:a.A$.row+K(a.A$)-1:-1},Z_:function(){return this.A$?this.A$.col===-1?0:this.A$.col:-1},s0:function(){var a=this;return a.A$?a.A$.col===-1?I(a.kj)-1:a.A$.col+J(a.A$)-1:-1},hla:function(a,b){var c,d,e,f,g,h,i=m(b.row,b.col,b.rowCount,b.colCount),j=this.kj;return j.ITa.findSpan(a.row,a.col)&&(c=a.rowCount,d=i.rowCount,0!==Math.floor(d%c)&&(e=Math.ceil(d/c)*c,i.row+e<=j.getRowCount()&&(i.rowCount=e)),f=a.colCount,g=i.colCount,0!==Math.floor(g%f)&&(h=Math.ceil(g/f)*f,i.col+h<=j.getColumnCount()&&(i.colCount=h))),i},xH:function(){var a,b,c,d,e,f,g=this,h=g.kj;return g.rG=o,g.RG(),g.xw(),g.BG&&g.OG?(g.BG=!1,g.OG=!1,a=g.g0(),void(a&&(b=g.h0(g.A$,g.A_),!b||g.$I?(g.A0(),g.WA(a)):(c=h.mm.A$,d=g.hla(c,g.A_),e=g.l0(),h.wu().execute({cmd:"fill",sheetName:h.name(),startRange:c,fillRange:d,autoFillType:e,fillDirection:h.mm.m0()}),f=g._$,!f&&g.B0()&&h.parent.options.showDragFillSmartTag&&4!==g.$$?g.C0(g.$$):g.WA(a),g.A0())))):void g.A0()},C0:function(a){var b=this.kj,c=b.yl.rH,d={x:c.x+c.width,y:c.y+c.height,fillType:a};b.NF=new g.K_(b.parent.pZJ(),b,d),b.NF.OT()},P_:function(){var a,b,c=this.kj,d=c.ITa.getSelections();1===d.length?(a=d[0],b=c.ITa.getSpans(a),b&&b.length>0&&(a=c.TJ(b,a)),this.A$=a):c.Jl>=0&&c.Kl>=0&&(this.A$=m(c.Jl,c.Kl,1,1))},A0:function(){this.OG=!1,this.BG=!1},WA:function(a){this.kj.yl.im(a)},l0:function(a,b){var c,d=this,e=d.kj,f=a!==p?a:e.parent.options.defaultDragFillType;return d.ZI()?4:5!==f?f:(c=1===K(d.A$)&&1===J(d.A$)&&!d.X_()&&!d.a0(),c?d.RH&&!b?1:0:d.RH&&!b?0:1)},g0:function(){var a,b,c,d,e=this;return e.A$?e.ZI()?e.A$:e.A_?(a=0,b=0,c=0,d=0,e.D0()?(a=2===e.dJ?e.A_.row:e.A$.row,b=K(e.A$)+K(e.A_),c=e.A$.col,d=J(e.A$)):(a=e.A$.row,b=K(e.A$),c=0===e.dJ?e.A_.col:e.A$.col,d=J(e.A$)+J(e.A_)),m(a,c,b,d)):o:o},h0:function(a,b,c){var d=this.kj,f=!0,g="";return d.ITa.MTa(b.row,b.col,K(b),J(b))&&!R(d,a,b)&&(f=!1,g=B().Exp_FillRangeContainsMergedCell),f&&d.options.isProtected&&d.ou(b,!0,e.SheetArea.viewport)&&(f=!1,g=d.k9J()),f||c||d.Wq(e.Events.InvalidOperation,{sheet:d,sheetName:d.name(),invalidType:e.InvalidOperationType.dragFill,message:g,fillRange:b}),f},B0:function(){return this.E0()||this.F0()},E0:function(){return 3===this.dJ||1===this.dJ},F0:function(){return 0===this.dJ||2===this.dJ},D0:function(){return 2===this.dJ||3===this.dJ||5===this.dJ},m0:function(){var a=this.dJ;return a>=0&&a<=3?a:4===a?0:5===a?2:3},tr:function(a,b,c){var d,e,f,g=this,h=o,i=C(a),j=D(a),k=g.kj,l=k.parent;if(n(i)||n(j)||!l.options.allowUserDragDrop&&!l.options.allowUserDragFill)return h;if(d=k.Ix(),d.row===-1&&d.col===-1)return h;if(i>=0&&j>=0&&1===k.ITa.getSelections().length){if(g.qH(i,j,b,c))return h;e=k.getRangeRect(i,j,d),e.x-4<b&&b<e.x+4&&e.y<=c&&c<e.y+e.height&&(h={action:v,side:"left"}),h||(f=g.kj.yl.rH,f&&f.x<=b&&b<=f.x+f.width&&f.y<=c&&c<=f.y+f.height&&(h={action:v,side:w})),h||e.x+e.width-4<b&&b<e.x+e.width+4&&e.y<=c&&c<e.y+e.height&&(h={action:v,side:"right"}),h||e.y-4<c&&c<e.y+4&&e.x<=b&&b<e.x+e.width&&(h={action:v,side:"top"}),h||e.y+e.height-4<c&&c<e.y+e.height+4&&e.x<=b&&b<e.x+e.width&&(h={action:v,side:"bottom"}),h&&(b<e.x||b>e.x+e.width||c<e.y||c>e.y+e.height)&&(h.outside=!0)}return l&&l.options.allowUserDragDrop||h&&h.side!==w&&(h.side=o),
l&&l.options.allowUserDragFill||h&&h.side===w&&(h.side=o),h},Hyb:function(a,b){var c=this,d=c.kj,e=d.getSpan(a,b,3);return e?!n(c.kj.getValue(e.row,e.col,3,0)):!n(c.kj.getValue(a,b,3,0))},D$J:function(a,b){var c,d=this,e=d.kj,f=e.tables;return!(!f||0===f.all().length)&&(c=f.s$(a,b,1,1)[0],c&&c.footerIndex()===a)},Iyb:function(a,b,c,d){var e,f=this;for(e=b;e<b+d;e++)if(!f.Hyb(a,e)||f.D$J(a,e))return!1;return!0},Jyb:function(a,b,c,d){var e,f=this;for(e=b;e<b+d;e++)if(f.Hyb(a,e))return!1;return!0},Kyb:function(a,b,c,d){var e,f,g,h,i,j,k,l=this,m=l.kj;if("left"===d){for(e=0;e<b;e++)l.Hyb(a,e)&&(c.searchArray[e]=!0);for(f=b-1,g=1;c.searchArray[f];)f--,g++;c.searchLength=g}if("right"===d){for(h=m.getColumnCount(),i=b;i<h;i++)l.Hyb(a,i)&&(c.searchArray[i-b]=!0);for(j=0,k=1;c.searchArray[j];)j++,k++;c.searchLength=k}return c},Lyb:function(a,b,c,d,e){var f,g,h,i,j,k=this,l=k.kj,m=0,n={searchArray:Array(d),searchLength:1},o={searchArray:Array(l.getColumnCount()-e),searchLength:1};for(f=b;f<c;f++)n=k.Kyb(f,a.col,n,"left"),o=k.Kyb(f,a.col+a.colCount-1,o,"right");for(;k.Jyb(c+m,a.col,1,a.colCount);){for(g=!0,h=!1,n=k.Kyb(c+m,d,n,"left"),o=k.Kyb(c+m,e,o,"right"),i=d-1;i>=d-n.searchLength;i--)if(k.Hyb(c+m,i)){m++,g=!1;break}if(g){for(j=e+1;j<=e+o.searchLength;j++)if(k.Hyb(c+m,j)){m++,h=!0;break}if(!h)return m}}return m},Myb:function(a){for(var b=this,c=0;b.Iyb(a.row+a.rowCount+c,a.col,1,a.colCount);)c++;return c},Nyb:function(a){var b,c,d,e,f=this;return f.Iyb(a.row+a.rowCount,a.col,1,a.colCount)?f.Myb(a):(d=a.row-2,e=a.row+a.rowCount,1===a.colCount?c=b=a.col:(b=a.col,c=a.col+a.colCount-1),f.Lyb(a,d,e,b,c))},cyb:function(){var a,b,c,d=this,e=d.kj,f=e.mm.A$,g=d.Nyb(f);0!==g&&(a=m(f.row+f.rowCount,f.col,g,f.colCount),d.dJ=3,d.A_=a,b=d.l0(),c=d._$,e.wu().execute({cmd:"fill",sheetName:e.name(),startRange:f,fillRange:a,autoFillType:b,fillDirection:d.dJ}),!c&&e.parent.options.showDragFillSmartTag&&4!==d.$$&&d.C0(d.$$))}}),l.extend(e.oJ.prototype,{gJ:function(a,b){var c,d=this.kj,f=a.x,g=a.y,h=M(a),i=L(a),j=d.Ix(),k=d.am(),l=4,m=-2.5;return b>2007&&(l=5,m=-3),c=new e.Rect((-4),(-4),l,l),j.col===-1?(c.x=k.kt,c.y=g+i+m):j.row===-1?(c.x=f+h+m,c.y=k.nt):(c.x=f+h+m,c.y=g+i+m),c},eJ:function(a,b,c,d,f){var g,h,i=this,j=i.kj,k=j.am(),l=j.parent,m=l&&l.Vv,n=i.gJ(d,m),o=n.x,p=n.y,q=M(n),r=L(n),t=k.Ft(b,c);f&&!n.intersectRect(f)||n.intersectRect(t)&&(g=-1.5,m>2007&&(g=-1),h=new e.Rect(o+g,p+g,q+2,r+2),h.x=s(h.x,t.x),h.y=s(h.y,t.y),i.dm(h),a.save(),f&&!f.containsRect(n)&&(a.rect(f.x,f.y,M(f),L(f)),a.clip()),a.beginPath(),a.fillStyle=e.Rm.Om(j,j.getSelectionBorderColor()),a.fillRect(o,p,q,r),i.rH=new e.Rect(n.x,n.y,4,4),a.beginPath(),a.restore())},RI:function(a,b,c,d){var e=b.x,f=b.y,g=e+M(b),h=f+L(b);O(a,e-2,f,g+1,f,c,d),O(a,e-1,h,g+1,h,c,d),O(a,e,f-1,e,h+1,c,d),O(a,g,f-1,g,h+1,c,d)},NI:function(a,b){var c,d,f,g,h,i,j,k,l,m,n,o,p,r,s,t,u,v,w,x,y,z=this,A=z.kj,B=A.mm,C=B.gA,D=C.hitTarget;C&&D&&(c=C.hitCol,d=C.hitRow,f=C.row,g=C.col,h=B.OH,i=A.OI,k=A.getSelectionBorderColor(),l=N(A),m=8,a.save(),h===!0?(n=A.Hr(0).findCol(c)||A.Hr(1).findCol(c)||A.Hr(2).findCol(c),o=A.Gr(0).findRow(d)||A.Gr(1).findRow(d)||A.Gr(2).findRow(d),C.row===-1&&C.col!==-1?n&&(p=n.x,r=M(n),C.col=c,D.x>p+r/2&&(C.col<A.cr()||C.col===A.dr())&&(p=n.x+M(n),C.col++),i&&0===M(i)||(i=B.gA),i&&(j=new e.Rect(i.x-m,i.y-m,M(i)+2*m,L(i)+2*m),z.dm(j,b),z.im(A.Ix(),b)),A.QI=new e.Rect(p,C.y,0,L(C)),a.rect(b.x,b.y,M(b),L(b)),a.clip(),a.beginPath(),O(a,p-m,C.y,p+m,C.y,k,l),O(a,p,C.y,p,C.y+L(C),k,l),O(a,p-m,C.y+L(C),p+m,C.y+L(C),k,l)):C.row!==-1&&C.col===-1?o&&(s=o.y,t=L(o),C.row=d,D.y>s+t/2&&(C.row<A.hr()||C.row===A.ir())&&(s=o.y+L(o),C.row++),i&&0===L(i)||(i=B.gA),i&&(j=new e.Rect(i.x-m,i.y-m,M(i)+2*m,L(i)+2*m),z.dm(j,b),z.im(A.Ix(),b)),A.QI=new e.Rect(C.x,s,M(C),0),a.rect(b.x,b.y,M(b),L(b)),a.clip(),a.beginPath(),O(a,C.x,s-m,C.x,s+m,k,l),O(a,C.x,s,C.x+M(C),s,k,l),O(a,C.x+M(C),s-m,C.x+M(C),s+m,k,l)):C.row!==-1&&C.col!==-1&&(u=A.Hr(0).findCol(g)||A.Hr(1).findCol(g)||A.Hr(2).findCol(g),v=A.Gr(0).findRow(f)||A.Gr(1).findRow(f)||A.Gr(2).findRow(f),o&&n&&v&&u&&(p=u.x,s=v.y,i&&(j=new e.Rect(i.x-m,i.y-m,M(i)+2*m,L(i)+2*m),z.dm(j,b),z.im(A.Ix(),b)),w=!1,x=A.getCellRect(d,c),!B.z$J&&x&&(y=C.hitTarget.x-x.x,w=y<q(16,A.Tl(c)/4)),w?p=n.x:s=o.y,A.QI=new e.Rect(p,s,M(C),L(C)),A.Ix().contains(d,c)||(a.rect(b.x,b.y,M(b),L(b)),a.clip(),a.beginPath(),w?(O(a,p-m,s,p+m,s,k,l),O(a,p,s,p,s+L(C),k,l),O(a,p-m,s+L(C),p+m,s+L(C),k,l),B.C$J=!0):(O(a,p,s-m,p,s+m,k,l),O(a,p,s,p+M(C),s,k,l),O(a,p+M(C),s-m,p+M(C),s+m,k,l),B.C$J=!1))))):(i&&(j=new e.Rect(i.x-m,i.y-m,M(i)+2*m,L(i)+2*m),z.dm(j,b),z.im(A.Ix(),b)),a.rect(b.x,b.y,M(b),L(b)),a.clip(),a.beginPath(),z.RI(a,C,k,l)),a.beginPath(),a.restore())},QH:function(){var a,b,c,d,f,g,h,i,j,k,l,m=this,n=m.kj,o=n.yt,p=n.mm.MI;o&&o.dragInfo&&p&&(a=m.bm(),b=n.am(),c=n.mm.gA,d=n.cm(p),f=n.frozenTrailingColumnCount(),g=n.frozenTrailingRowCount(),h=n.getColumnCount()-f,i=n.getRowCount()-g,j=b.Ft(1,1),f>0&&p.col+p.colCount<=h&&d.x+M(d)>j.x+M(j)&&d.intersectRect(j)&&(d=d.getIntersectRect(j)),g>0&&p.row+p.rowCount<=i&&d.y+L(d)>j.y+L(j)&&d.intersectRect(j)&&(d=d.getIntersectRect(j)),k=new e.Rect(b.kt,b.nt,b.lt+b.js,b.ot+b.gs),M(d)>=0&&L(d)>=0&&(c.x=d.x,c.y=d.y,c.width=M(d),c.height=L(d),m.NI(a,k)),l=n.mm.OH,l===!0?n.OI=n.QI:n.OI=new e.Rect(c.x,c.y,M(c),L(c)))}})},"./dist/plugins/fill/fill-ui.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("./dist/plugins/fill/fill.ns.js"),g=e.GC$,h=e.Ul.Nl,i=e.Ul.vl,j=g(document),k=" btn btn-default",l="ui-state-hover ",m="gc-fill-type-item",n="gc-fill-menu-container",o=l+"gc-smartMenu-item-hover",p=l+"gc-smart-tag-hover",q="ui-icon ui-icon-check gc-check-image",r="gc-menu-item-input",s="ui-state-active gc-smart-tag-active",t="gc-tag-container",u="float",v="left",w="top",x="display",y="width",z="min-width",A="height",B="margin",C="change",D="input[type=radio]",E="mouseover",F="mouseout",G="click",H="fillTypeChanged",I="keydown.ui-fill",J=new d.Common.ResourceManager(f.SR,"Fill"),K=J.getResource.bind(J);function O(a,b,c,d,e,f){var i=a.CH,j=i?"160px":"150px",l=i?"25px":"20px",m=g(h("div")).css([x,z,A,"padding",B],["block",j,l,0,0]).addClass("gc-smartMenu-item-default "+c+" ui-state-default"+k),n=g(h("div")).addClass(r).appendTo(m),o=g(h("div")).addClass("gc-menu-item-text").appendTo(m),p=g(h("input")).attr({id:b,value:e,type:"radio",name:"fill-group",style:"display:none"}).appendTo(n);return g(h("span")).text(d).appendTo(o),f?(n.addClass(q),p.prop("checked","checked")):p.prop("checked",""),m}L=function(a){N(b,a);function b(b,c){var d,e=a.call(this,b,i(c.parent.qo))||this;return e.kj=c,e.v_=g("."+t),d=e.w_=e.yo(),d.addClass(n),O(c,"smartMenuCopyCells",m,K().CopyCells,"0",!0).appendTo(d),O(c,"smartMenuFillSeries",m,K().FillSeries,"1").appendTo(d),c.ODJ||(O(c,"smartMenuFillFormattingOnly",m,K().FillFormattingOnly,"2").appendTo(d),O(c,"smartMenuFillWithoutFormatting",m,K().FillWithoutFormatting,"3").appendTo(d)),e}return b.prototype.Ao=function(){a.prototype.Ao.call(this)},b.prototype.QQ=function(){var a,b=this,c=g("."+m);c.bind(E,function(){g(this).addClass(o)}).bind(F,function(){g(this).removeClass(o)}).bind(G,function(){var a,c=g(this),d=b.v_,e=c.find(D),f=e[0];f.checked=!0,e.trigger(C),d.trigger(G),d.trigger(F),c.removeClass(o),a=parseInt(g(f).attr("value"),10),b.x_(a)}),a=b.w_.find(D),a.bind(C,function(){g("."+r).removeClass(q),g(this).parent().addClass(q)})},b.prototype.y_=function(){g("."+m).unbind(E).unbind(F).unbind(G),this.w_.find(D).unbind(C)},b.prototype.x_=function(a){var b=this,c=b.kj,d=c.mm;if(b.z_!==a){b.z_=a,c.U$=!0,c.suspendEvent();try{e.Commands.undo.execute(c.parent,{sheetName:c.name()})}finally{c.resumeEvent()}c.U$=!1,c.wu().execute({cmd:"fill",sheetName:c.name(),startRange:d.A$,fillRange:d.A_,autoFillType:a,fillDirection:d.dJ}),b.v_.trigger(H,a)}},b.prototype.MQ=function(){return!!g("."+n).length},b}(e.Go),M=function(a){N(b,a);function b(b,c,d){var e,f=a.call(this,b,i(c.parent.qo))||this;return f.kj=c,f.B_=d,e=f.C_=f.yo().addClass("gc-smart-tag-default "+t+" gc-no-user-select ui-widget-header"+k),f.D_=g(h("div")).attr("class","fillSmartTag").css(u,v).appendTo(e),f.E_=g(h("div")).attr("class","fillSmartTagDown").css([u,x],[v,"none"]).appendTo(e),f}return b.prototype.F_=function(a,b,c){var d=this,e=d.kj.CH,f=g(b),h=d.G_,i=d.E_,j=e?"38px":"32px",k=e?"24px":"18px";h&&h.MQ()||(a?f.addClass(p):f.removeClass(p),f.css([y,A],[a?j:k,k]),c||(a?i.show():i.hide()))},b.prototype.H_=function(){var a=this,b=a.C_,c=e.Ul.rl(),d=e.Ul.Ml.safari&&(c.ipad||c.iphone);b.bind(E,function(){a.F_(!0,this,d)}).bind(F,function(){a.F_(!1,this,d)}),b.bind(G,function(){var b,c,e=g(this),f=a.G_,h=a.E_,i=f&&f.MQ();i?(d&&h.hide(),e.removeClass(s),a.I_()):(d&&h.show(),e.addClass(s),a.J_(),b=a.w_,c=b&&b.find(D)[a.B_.fillType],c&&!c.checked&&(c.checked=!0,g(c).trigger(C)))}),j.bind(I,function(b){27===b.keyCode&&(a.G_&&a.G_.MQ()?a.I_():a.close(),e.Ul.nl(b))})},b.prototype.OT=function(){var a=this,b=a.C_,c=a.B_,d=a.kj.CH,e=d?"3px":"0px",f=d?"24px":"18px";b&&(b.css([v,w],[c.x,c.y]),a.Ao(),a.H_(),a.D_.css(B,e),a.E_.css(A,f),a.hZ())},b.prototype.J_=function(){var a,b,c,d,e,f,g,h=this,i=h.kj;h.G_||(h.G_=new L(i.parent.pZJ(),i),h.w_=h.G_.yo()),a=h.C_,b=a.css(v),c=a.css(w),d=parseFloat(c),f=h.G_,g=h.B_,f.z_=g.fillType,isNaN(d)||(e=d+a.height()+2),h.w_.css([v,w],[b,e]),f.Ao(),f.QQ(),f.v_.unbind(H).bind(H,function(a,b){g.fillType=b})},b.prototype.I_=function(){var a=this.G_;a&&(a.y_(),a.close())},b.prototype.hZ=function(){var a=this,b=a.G_,c=a.C_;b&&(b.MQ()&&c.trigger(G),c.trigger(F))},b.prototype.close=function(){var b,c=this,d=c.kj;c.hZ(),j.unbind(I),a.prototype.close.call(this),b=d.Xs,b&&(b.style.cursor="default"),d&&d.zt()},b.prototype.KZJ=function(b){var c=this.xo&&a.prototype.OZJ.call(this,this.xo.get(0),b);return!!c||this.w_&&a.prototype.OZJ.call(this,this.w_.get(0),b)},b}(e.Go),b.K_=M},"./dist/plugins/fill/fill.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),c("./dist/plugins/fill/drag-fill.js"),c("./dist/plugins/fill/fill-event.js"),d(c("./dist/plugins/fill/fill-ui.js")),d(c("./dist/plugins/fill/fill.js")),d(c("./dist/plugins/fill/fill.ns.js"))},"./dist/plugins/fill/fill.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("@grapecity/js-calc"),g=c("SheetsCalc"),h=c("./dist/plugins/fill/fill.ns.js"),i=!!f,j=d.Common.j,k=null,l=void 0,m=Math.floor,n=e.kf,o=j.Fa,p=j.Pa,q=d.Common.k,r=q.Eb,s=q.ac,t=d.Common.l,u=t.Ra,v=t.Xb,w="number",x="date",y="string",z="default",A=new d.Common.ResourceManager(h.SR,"Fill"),B=A.getResource.bind(A),C=d.Common.CultureManager;function ba(a){return!ca(a)&&j.Na(a)}function ca(a){return"string"==typeof a}function da(a,b){return a.lastIndexOf(b)!==-1}!function(a){a[a.copyCells=0]="copyCells",a[a.fillSeries=1]="fillSeries",a[a.fillFormattingOnly=2]="fillFormattingOnly",a[a.fillWithoutFormatting=3]="fillWithoutFormatting",a[a.clearValues=4]="clearValues",a[a.auto=5]="auto"}(D=b.AutoFillType||(b.AutoFillType={})),function(a){a[a.left=0]="left",a[a.right=1]="right",a[a.up=2]="up",a[a.down=3]="down"}(E=b.FillDirection||(b.FillDirection={})),function(a){a[a.column=0]="column",a[a.row=1]="row"}(F=b.FillSeries||(b.FillSeries={})),function(a){a[a.direction=0]="direction",a[a.linear=1]="linear",a[a.growth=2]="growth",a[a.date=3]="date",a[a.auto=4]="auto"}(G=b.FillType||(b.FillType={})),function(a){a[a.day=0]="day",a[a.weekday=1]="weekday",a[a.month=2]="month",a[a.year=3]="year"}(H=b.FillDateUnit||(b.FillDateUnit={}));function ea(a){var b=[a];return b.rowCount=1,b.colCount=s(a),b}function fa(a){return a}function ga(a,b,c,e){var f=ea(b),g=ea(c),h=ea([e]),i=a?d.Common.qc(f,g,h,!0,fa,k,k,k):d.Common.sc(f,g,h,!0,k,k,k),j=i&&i[0][0];return typeof j===w?d.Common.o.Lma(j,13):j}function ha(a){return a.toLowerCase()}I=function(){function a(a){this.e_=[],this.f_=[],this.Oyb=[],this.Nc=k,this.Pyb=[],this.Qyb=k,this.g_=o(a)?-1:a}return a.prototype.h_=function(){return s(this.e_)},a.prototype.Ey=function(){var a=this,b=[],c=a.f_,d,e;for(d=0;d<s(c);d++)e=c[d],b.push("object"===a.Nc?a.Wh(e):e);return b},a.prototype.i_=function(){var a,b,c,d=this,e=d.e_;if(s(e)>0){for(a=d.g_,b=[],c=void 0,a===-1&&(a=e[0]),c=0;c<s(e);c++)b[c]=e[c]-a+1;return b}return k},a.prototype.j_=function(){var a=this.f_;return s(a)?a:k},a.prototype.Eb=function(a,b,c){if(!ba(c))throw Error(B().Exp_NumberOnly);var d=this;o(d.Nc)&&(d.Nc=c instanceof Date?x:w),r(d.e_,a,b),r(d.f_,a,p(c))},a.prototype.Sb=function(a,b){var c=this,d=o(c.Nc);ba(b)?(d&&(b instanceof Date?c.Nc=x:c.Nc=w),c.f_.push(p(b))):d&&(c.Nc=ca(b)?y:z),c.e_.push(a),c.Oyb.push(b)},a.prototype.k_=function(a){return this.Nc===x?this.Wh(a):a},a.prototype.Wh=function(a){var b=k;if(a instanceof Date)b=a;else if(f)try{b=f.Convert.Wh(a)}catch(c){b=a}return b},a}(),J=function(){function a(a){this.Ryb=-1,this.Syb=[],this.Tyb=-1,this.kj=a}return a.prototype.no=function(){this.kj=k},a.prototype.Uyb=function(){var a=this.kj;return a.parent&&a.parent.Txb()||[]},a.prototype.Vyb=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=a.length,q=!1;if(a&&p>0)for(b=ha(a[0]),c=this.Uyb(),d=void 0,e=void 0,f=void 0,g=void 0,h=void 0,i=void 0,d=0;d<c.length;d++)if(e=c[d],f=e.map(function(a){return ha(a)}),g=f.indexOf(b),g>=0){for(h=g,j=f.length,k=void 0,l=void 0,m=void 0,n=1;n<p;n++){if(l=ha(a[n]),k=f.indexOf(l),!(k>=0)){q=!1;break}if(m=k-h+j,i){if(i!==m){q=!1;break}}else q=!0,i=m,h=k}if(o=1===p,q||o){q=!0,this.Ryb=g,this.Syb=e,this.Tyb=o?1:i;break}}return q},a.prototype.ge=function(a){var b=this.Syb,c=this.Ryb,d=this.Tyb,e=b.length,f=ja(a,e),g;return g=(c+d*f)%e,b[g]},a}(),K=function(){function a(){this.Uk="",this.kja="",this.Tyb=0,this.Xyb=1,this._padding=""}return a.prototype.ge=function(a){var b=this.Tyb*(a-1)+this.Xyb,c=this._padding.length,d=""+Math.abs(b),e=d.length,f=this._padding+d,g=f.length;return d=e>c?d:f.substr(g-c),this.Uk+d+this.kja},a}();function ia(a){var b,c,d=a.length,e=1;if(d>1)for(e=a[1]-a[0],c=2;c<d;c++)if(b=a[c]-a[c-1],e!==b){e=0;break}return e}function ja(a,b){return a>0?(a-1)%b:b-Math.abs(a)%b-1}function ka(a){for(var b="",c=0;c<a;)b+="0",c++;return b}function la(a,b){return 12*(b.getFullYear()-a.getFullYear())+(b.getMonth()-a.getMonth())}function ma(a){return a.every(function(a){var b=a.getDate();return 1===b})}function na(a){return a.every(function(a){var b=a.getFullYear(),c=a.getMonth(),d=a.getDate(),e=new Date(b,c+1,0).getDate();return d===e})}function oa(a){var b=0,c=a.every(function(a){var c=a.getDate();return b||(b=c),b===c});return c?b:0}function pa(a,b){var c,d,e=a.length,f=!0;for(d=2;d<e&&(c=la(a[d-1],a[d]),f=b===c,f);d++);return f}function qa(a){return a.every(function(a){var b=a.getHours(),c=a.getMinutes(),d=a.getSeconds();return 0!==b||0!==c||0!==d})}function ra(a,b){return new Date(a,b+1,0).getDate()}function sa(a){return"0"===a[0]}function ta(a,b,c){var d,e,f,g,h,i=c?1:2,j=c?2:1;return b.every(function(b){return d=b.match(a.Yyb),!!d&&(e=d[i],h=e.length,h>a.Zyb&&sa(e)&&(a.Zyb=h),f=parseInt(e,10),g=d[j],o(a.Qyb)&&(a.Qyb=g),g!==a.Qyb?(a.$yb=!0,a.Qyb=k,a.Pyb=[]):a.Pyb.push(f),!0)})}L=function(){function a(){}return a.prototype.match=function(a){return!1},a.prototype.getTargetValue=function(a,b,c,d,e){},a.prototype.resetProp=function(){},a.prototype._yb=function(a,b){return a.indexOf(b+1)},a.prototype.dispose=function(){},a}(),M=function(a){aa(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.azb=0,b.Nc=x,b}return b}(L),N=function(a){aa(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.match=function(a){var b=this.azb=la(a[0],a[1]),c=ma(a),d=a.length,e=!0;return c&&d>2&&(e=pa(a,b)),c&&e},b.prototype.getTargetValue=function(a,b){var c=a.Oyb,d=c[0],e=d.getFullYear(),f=d.getMonth(),g=b-1,h=this.azb,i=f+h*g;return new Date(e+parseInt(i/12,10),i%12,1)},b}(M),O=function(a){aa(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.match=function(a){var b=this.azb=la(a[0],a[1]),c=na(a),d=a.length,e=!0;return c&&d>2&&(e=pa(a,b)),c&&e},b.prototype.getTargetValue=function(a,b){var c=a.Oyb,d=c[0],e=d.getFullYear(),f=d.getMonth(),g=b-1,h=this.azb,i=f+h*g,j=e+parseInt(i/12,10),k=i%12;return new Date(j,k,ra(j,k))},b}(M),P=function(a){aa(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.match=function(a){var b,c,d,e,f,g=!1;return qa(a)||(b=this.azb=la(a[0],a[1]),c=oa(a),d=c>0,e=a.length,f=!0,this.bzb=c,d&&e>2&&(f=pa(a,b)),g=d&&f),g},b.prototype.getTargetValue=function(a,b){var c=a.Oyb,d=c[0],e=d.getFullYear(),f=d.getMonth(),g=b-1,h=this.azb,i=f+h*g,j=e+parseInt(i/12,10),k=i%12;return new Date(j,k,this.bzb)},b}(M),Q=function(a){aa(b,a);function b(){var b=a.call(this)||this;return b.Yyb=k,b.Pyb=[],b.Qyb=k,b.$yb=!1,b.Zyb=0,b.Nc=y,b.t_=!1,b.czb=!1,b.dzb=new K,b}return b.prototype.resetProp=function(){this.Pyb=[],this.Zyb=0,this.Qyb=k,this.$yb=!1,this.t_=!1,this.czb=!1},b.prototype.getInternal=function(a){var b,c,d=!1,e=a[0];for(c=1;c<a.length;c++)if(b=a[c],1!==Math.abs(b-e)){d=!0;break}return d},b}(L),R=function(a){aa(b,a);function b(b){var c=a.call(this)||this;return c.ezb=new J(b),c}return b.prototype.dispose=function(){var a=this;a.ezb&&(a.ezb.no(),a.ezb=k)},b.prototype.match=function(a){return this.ezb.Vyb(a)},b.prototype.getTargetValue=function(a,b,c,d,e){var f=a.Oyb,g=f.length,h=this._yb(c,d),i=k,j;return h!==-1&&(j=g*e+h+1,i=this.ezb.ge(j)),i},b}(Q),S=function(a){aa(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.Yyb=/^\d+$/,b}return b.prototype.match=function(a){var b=this,c,d,e;return a.every(function(a){return c=a.match(b.Yyb),!!c&&(e=a.length,e>b.Zyb&&sa(a)&&(b.Zyb=e),d=parseInt(a,10),b.Pyb.push(d),!0)})},b.prototype.getTargetValue=function(a,b,c,d,e){var f=a.Oyb,g=this.dzb,h=ia(this.Pyb),i=f.length,j=0!==h,l=j?0:ja(b,i),m=this._yb(c,d),n=k,o;return this.t_=j,this.czb=this.getInternal(a.e_),m!==-1&&(g.Tyb=h,g.Xyb=this.Pyb[l],g._padding=ka(this.Zyb),o=i*e+m+1,n=g.ge(o)),n},b}(Q),T=function(a){aa(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.Yyb=/^(.*\D+)(\d+)$/,b}return b.prototype.match=function(a){return ta(this,a,!1)},b.prototype.getTargetValue=function(a,b,c,d,e){var f=a.Oyb,g=this.dzb,h=ia(this.Pyb),i=f.length,j=0!==h,l=j?0:ja(b,i),m=this._yb(c,d),n=k,o;return this.t_=j,this.czb=this.getInternal(a.e_),m!==-1&&(g.Uk=this.Qyb,g.Tyb=h,g.Xyb=this.Pyb[l],g._padding=ka(this.Zyb),o=i*e+m+1,n=g.ge(o)),n},b}(Q),U=function(a){aa(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.Yyb=/^(\d+)(\D+.*)$/,b}return b.prototype.match=function(a){return ta(this,a,!0)},b.prototype.getTargetValue=function(a,b,c,d,e){var f=a.Oyb,g=this.dzb,h=ia(this.Pyb),i=f.length,j=0!==h,l=j?0:ja(b,i),m=this._yb(c,d),n=k,o;return this.t_=j,this.czb=this.getInternal(a.e_),m!==-1&&(g.kja=this.Qyb,g.Tyb=h,g.Xyb=this.Pyb[l],g._padding=ka(this.Zyb),o=i*e+m+1,n=g.ge(o)),n},b}(Q),V=function(a){aa(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.Yyb=/^(.*\D+)(\d+)(\D+.*)$/,b}return b.prototype.resetProp=function(){a.prototype.resetProp.call(this),this.bIJ=k},b.prototype.match=function(a){var b,c,d,e,f,g,h=this;return a.every(function(a){return b=a.match(h.Yyb),!!b&&(c=b[2],g=c.length,g>h.Zyb&&sa(c)&&(h.Zyb=g),d=parseInt(c,10),e=b[1],o(h.Qyb)&&(h.Qyb=e),f=b[3],o(h.bIJ)&&(h.bIJ=f),e!==h.Qyb||f!==h.bIJ?(h.$yb=!0,h.Qyb=k,h.bIJ=k,h.Pyb=[]):h.Pyb.push(d),!0)})},b.prototype.getTargetValue=function(a,b,c,d,e){var f=this,g=a.Oyb,h=f.dzb,i=ia(f.Pyb),j=g.length,l=0!==i,m=l?0:ja(b,j),n=f._yb(c,d),o=k,p;return f.t_=l,f.czb=f.getInternal(a.e_),n!==-1&&(h.Uk=f.Qyb,h.kja=f.bIJ,h.Tyb=i,h.Xyb=f.Pyb[m],h._padding=ka(f.Zyb),p=j*e+n+1,o=h.ge(p)),o},b}(Q),W=["-","_",":",".",","],X=function(a){aa(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.resetProp=function(){a.prototype.resetProp.call(this),this.cIJ=k},b.prototype.match=function(a){var b,c,d,e,f,g,h,i=this;return a.every(function(a){var j,l,m,n=i.cIJ;if(h=o(n)?W.some(function(b){if(da(a,b))return i.cIJ=b,!0}):da(a,n)){if(n=i.cIJ,j=a.lastIndexOf(n),e=a.substring(0,j+1),o(i.Qyb))i.Qyb=e;else if(i.Qyb!==e)return!1;if(l=a.substr(j+1),m=/^(\d+)(\D+.*)$/,b=l.match(m))return c=b[1],g=c.length,g>i.Zyb&&sa(c)&&(i.Zyb=g),d=parseInt(c,10),f=b[2],o(i.bIJ)&&(i.bIJ=f),f!==i.bIJ?(i.Qyb=k,i.bIJ=k,i.Pyb=[],!1):(i.Pyb.push(d),!0)}return!1})},b}(V),Y=function(a){aa(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.getTargetValue=function(a,b,c){return ga(!0,a.j_(),c,b)},b}(L),Z=function(a){aa(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.t_=!0,b}return b.prototype.getTargetValue=function(a,b,c,d){var e=a.Oyb,f=e.length,g=ja(b,f);return e[g]},b}(L),$=function(){function a(a){var b,c,d,e,f,g,h=this;h.fzb=[new N,new O,new P],h.hzb=new Y,h.izb=new Z,b=C.culture(),c=C.q4(b).isJCKCulture,d=new R(a),e=new S,f=new T,g=new U,c?h.gzb=[d,e,new X,f,g,new V]:h.gzb=[d,e,f,g]}return a.prototype.getRule=function(a,b){var c,d,e,f=[],g=this.izb;for(a===x?(f=this.fzb,g=this.hzb):a===y?f=this.gzb:a===w&&(g=this.hzb),c=0;c<f.length;c++)if(d=f[c],e=void 0,d.resetProp(),d.match(b)){if(e=d.$yb,o(e)||e===!1)return d;if(e===!0)return g}return g},a.prototype.no=function(){var a=this;a.fzb&&(ua(a.fzb),a.fzb=k),a.gzb&&(ua(a.gzb),a.gzb=k),a.hzb&&(a.hzb.dispose(),a.hzb=k),a.izb&&(a.izb.dispose(),a.izb=k)},a}(),b.Gyb=$;function ua(a){a.forEach(function(a){a&&a.dispose()})}_=function(){function a(a){this.kj=a,this.AX=!1,this.mLb=[]}return a.prototype.D$=function(a,b,c,d,e){var f=this,g=a?1:2;o(d)&&o(e)?f.E$(b,c,g):f.E$(b,c,g,d,e,k)},a.prototype.E$=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z=this,A=z.kj,C=A.Tq(a),D=C.row,E=C.col,F=C.rowCount,G=C.colCount;if(A.ITa.MTa(D,E,F,G))throw Error(B().Exp_RangeContainsMergedCell);for(l=arguments.length>3,m=0,n=1===b,o=n?G:F,p=n?D:E,q=n?D+F:E+G,r=l?1:o,t=this.kj.mm.A$,u=t.row===D&&t.rowCount===F&&t.col>E||t.col===E&&t.colCount===G&&t.row>D,g=p;g<q;g++)if(v=u&&l?E+G-1:E,w=u&&l?D+F-1:D,x=n?z.l_(g,v,1,r,b):z.l_(w,g,r,1,b),x&&x.h_())for(j=x.e_[0],l?(k=u?x.f_[s(x.f_)-1]:x.f_[0],h=z.m_(u,k,o,c,d,e,f),u&&(m=o-s(h),j=x.e_[s(x.e_)-1])):h=z.n_(x,o,c),i=0;i<s(h);i++)y=x.k_(h[i]),n?z.o_(A,g,j,g,E+m+i,y,c):z.o_(A,j,g,D+m+i,g,y,c)},a.prototype.l_=function(a,b,c,d,e){for(var f=k,g=this.kj,h,i=1===e,j=i?b+d-1:a+c-1,l=i?b:a;j>=l;)h=i?g.getValue(a,j):g.getValue(j,b),ba(h)&&(f||(f=new I(l)),f.Eb(0,j,h)),j--;return f},a.prototype.m_=function(a,b,c,d,e,f,g){var h,i,j,k=[],l=b,m=e>=0,n=o(f);for(h=0;h<c;h++)i=l>=f,j=l<=f,a&&(n||m&&i||!m&&j)?(k.unshift(l),1===d?l-=e:2===d?l/=e:3!==d||o(g)||(l=this.p_(!0,g,b,l,e,h+1))):!a&&(n||m&&j||!m&&i)&&(k.push(l),1===d?l+=e:2===d?l*=e:3!==d||o(g)||(l=this.p_(!1,g,b,l,e,h+1)));return k},a.prototype.n_=function(a,b,c){var d=[],e,f=1===c;if(f||2===c){for(1===a.h_()&&a.Sb(a.e_[0]+1,f?a.k_(a.f_[0]+1):a.Ey()[0]),e=0;e<b;e++)d.push(ga(!!f,a.j_(),a.i_(),e+1));return d}return k},a.prototype.B$=function(a,b,c,d,e,f){var g,h=this,i=h.kj,j=i.ITa,k=i.Tq(a),l=k.row,m=k.col,n=k.rowCount,o=k.colCount,p=i.Tq(i.mm.A$),q=p.row,r=p.col;if(j.qu(q,r,p.rowCount,p.colCount)||j.qu(l,m,n,o))throw Error(B().Exp_ChangeMergedCell);return g=h.q_(p,n,o,b,c,!(l<q||m<r),d,e,f),h.iVJ&&h.iVJ.xr&&(h.iVJ.xr.reFilter(),delete h.iVJ),g},a.prototype.q_=function(a,b,c,d,e,f,g,h,i){var j=this,o=f?1:-1,p,q,r,s,t=a.row,u=a.col,v=a.rowCount,w=a.colCount;if(1===d){if(p=m(c/w),q=c%w,!e)for(s=1;s<p;s++)r=n(t,u+s*o*w,v,w),j.r_(a,r,d,4,e,f,l,l,l,g,h);if(e&&p>1&&0===q&&(p-=1,q=w),p>0&&q>0)return r=f?n(t,u+p*w,v,q):n(t,u-p*w+w-q,v,q),j.r_(a,r,d,4,e,f,k,f?0:w-q,l,g,h)}else{if(p=m(b/v),q=b%v,j.AX||(r=n(t+o*v,u,b-v,c),j.nLb(a,r,o,i)),!e)for(s=1;s<p;s++)r=n(t+s*o*v,u,v,w),j.r_(a,r,d,4,e,f,k,k,!0,g,h);if(e&&p>1&&0===q&&(p-=1,q=v),p>0&&q>0)return r=f?n(t+p*v,u,q,w):n(t-p*v+v-q,u,q,w),j.r_(a,r,d,4,e,f,f?0:v-q,k,!0,g,h)}},a.prototype.r_=function(a,b,c,d,e,f,g,h,i,j,l){var m,n,p,q,r,s,t,u,v,z,A,B,C,D,E,F,G,H,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=this,Z=Y.kj,$=1===c,_=$?a.row:a.col,aa=$?a.col:a.row,da=$?b.row:b.col,ea=$?b.col:b.row,fa=$?a.rowCount:a.colCount,ga=$?a.colCount:a.rowCount,ha=$?b.colCount:b.rowCount;for(q=0;q<fa;q++){for(s=k,t=k,u=0,v=_+q,z=da+q,A=v,B=z,C=($?h:g)||0,D=$?0:C,E=$?k:i,F=k;u<ga;)if(G=aa+u,H=ea+u-C,J=k,K=G,L=H,$||(v=G,G=A,z=H,H=B),p=Z.ITa.findSpan(v,G),m=Z.getFormula&&Z.getFormula(v,G),m&&""!==m||(J=Z.getValue(v,G)),M=Y.AX,M&&o(F)&&(F=f===!1?Z.getValue(aa+ga-1,G):Z.getValue(v,G)),M||4!==d||!ba(J)&&!ca(J)||(s||(s=new I),n=ba(J)?J instanceof Date?x:w:y,t||(t=n),t!==n))if(!M&&J&&s&&s.h_()){if(r=Y.s_($,a,b,A,B,s,e,f,D,E,j,l),e&&r)return r;s=k,t=k}else{if(M||!p||p&&($?p.row:p.col)===A)if(N=L===ea+ha-1,O=M?F:J,e){if(M)return O;if(p&&N||!p&&(N&&f||!f&&L===ea))return J}else L<ea+ha&&L>=ea&&(M||$||!$&&!(i&&Z.Ps&&Z.Ps(L)))&&(M&&Y.mLb.indexOf(z)!==-1||Y.o_(Z,v,G,z,H,O,d,j,l));p?u+=$?p.colCount:p.rowCount:u++}else s.Sb(K,J),p?u+=$?p.colCount:p.rowCount:u++;if(Y.AX)for(P=a.row,Q=a.col,R=a.rowCount,S=a.colCount,T=void 0,U=void 0,V=f===!1?-1:1,W=1;W<R;W++)for(T=P+V*W,X=0;X<S;)U=Q+X,Y.mLb.indexOf(T)===-1&&Y.o_(Z,P,Q,T,U,F,d,j,l),X++;if(s&&s.h_()&&(r=Y.s_($,a,b,A,B,s,e,f,D,E,j,l),e&&!o(r)))return r}return k},a.prototype.nLb=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this,u=t.kj,v=u.tables,w=a.union(b),x=w.row,y=w.rowCount,z=a.row,A=a.col,B=a.rowCount,C=a.colCount;if(v)for(e=v.s$(z,A,B,C),f=0,g=e;f<g.length;f++){if(h=g[f],i=h.cj,j=h.dj,k=y,d)for(l=0,m=d;l<m.length;l++)if(n=m[l],n.row===i&&n.col===j){k=n.rowCount,t.iVJ=h;break}if(o=h.xr,p=t.mLb,q=void 0,o&&o.isFiltered&&o.isFiltered()){for(r=0;r<k;r++)q=x+c*r,o.isRowFilteredOut(q)&&t.mLb.push(q);if(p.length>0){t.AX=!0;break}}}if(s=u.xr,t.AX!==!0&&s&&s.isFiltered&&s.isFiltered()){for(p=t.mLb,q=void 0,r=0;r<y;r++)q=x+c*r,s.isRowFilteredOut(q)&&t.mLb.push(q);p.length>0&&(t.AX=!0)}},a.prototype.o_=function(a,b,c,d,e,f,h,j,m){var n,o,p,q=a.ITa;i&&(a.hasFormula(b,c,3)||a.hasFormula(d,e,3))&&(a.setFormula(d,e,k),0!==h&&4!==h||(n=a.Bj(),a.getFormula(b,c)&&g.CalcOperatorAdjustor.copyFormula(n,b,c,n,d,e,1,1,l,!0))),a.setValue(d,e,f),p=m?0:64,j&&(p|=128),p|=1024,a.ax(b,c,d,e,1,1,p,l,!0),a.removeSpan(d,e,3),o=q.findSpan(b,c),o&&b===o.row&&c===o.col&&a.Sq(d,e,o.rowCount,o.colCount,3)},a.prototype.s_=function(a,b,c,d,e,f,g,h,i,j,l,m){var n,o,p,q,r,s,t,u,v,w,z,A,B,C,D,E,F=this,G=F.kj,H=a?c.col:c.row,I=a?b.col:b.row,J=a?c.colCount:c.rowCount,K=a?b.colCount:b.rowCount;if(i=i||0,r=f.h_(),s=(H-I-i)/K,t=F.t_(f.e_,f.f_),u=f.Nc,t){for(p=[],o=0;o<r;o++)p[o]=o+1;n=r}else q=f.e_[0],n=f.e_[r-1]-q+1,1===r&&u!==y&&f.Sb(f.e_[0]+1,f.k_(f.f_[0]+1)),p=f.i_();for(o=0;o<n;o++)if(v=f.Oyb,w=void 0,z=void 0,A=void 0,u!==x&&u!==y||(w=G.Fyb&&G.Fyb.getRule(u,v)),w?(z=w.getTargetValue(f,n*s+o+1,p,o,s),t=w.t_?w.t_:t,B=!!w.czb&&w.czb,A=t&&!B):(z=ga(!0,f.j_(),p,n*s+o+1),A=t),C=H+J-1,D=A?f.e_[o]:q+o,E=D+s*K,g){if(t&&(h&&E===C||!h&&E===H)||!t&&E+i===C)return f.k_(z)}else E<H+J&&E>=H&&(a?F.o_(G,d,D,e,E,f.k_(z),4,l,m):j&&G.Ps&&G.Ps(E)||F.o_(G,D,d,E,e,f.k_(z),4,l,m));return k},a.prototype.t_=function(a,b){var c,d,e,f=s(b);if(f<=1||s(a)!==f)return!1;for(c=a[1]-a[0],d=b[1]-b[0],e=2;e<f;e++)if(a[e]-a[e-1]!==c||b[e]-b[e-1]!==d)return!1;return!0},a.prototype.C$=function(a,b){var c=this,d=this.kj,e=d.ITa.getSpans(),f=d.Tq(a),g=f.row,h=f.col,i=f.rowCount,j=f.colCount,k;k=0===b?n(g,h+j-1,i,1):1===b?n(g,h,i,1):2===b?n(g+i-1,h,1,j):n(g,h,1,j),k=d.su(e,k),k&&c.u_(k,g,h,i,j,b)},a.prototype.u_=function(a,b,c,d,e,f){var g=this,h=a.row,i=a.col,j=a.rowCount,k=a.colCount,o,p,q,r,s,t,u,v=g.kj.ITa,w;if(0===f?(w=v.MTa(b,c,d,e-k),t=0,u=-1*k,q=e,r=k,s=1):1===f?(w=v.MTa(b,c+k,d,e-k),t=0,u=k,q=e,r=k,s=1):2===f?(w=v.MTa(b,c,d-j,e),t=-1*j,u=0,q=d,r=j,s=0):(w=v.MTa(b+j,c,d-j,e),t=j,u=0,q=d,r=j,s=0),w)throw Error(B().Exp_TargetContainsMergedCells);if(q%r!==0)throw Error(B().Exp_MergedCellsIdentical);for(o=m(q/r),p=1;p<o;p++)g.r_(a,n(h+p*t,i+p*u,j,k),s,0,l,l,l,l,!0)},a.prototype.p_=function(a,b,c,d,e,f){var g=a?-1:1,h=m(f*e),i=Math.abs(e),j=v(b>1?c:d);if(0===b)j.setDate(j.getDate()+g*e);else if(1===b)for(;i>0;)j.setDate(j.getDate()+g*(e>0?1:-1)),6!==j.getDay()&&0!==j.getDay()&&i--;else 2===b?j.setMonth(j.getMonth()+g*h):j.setFullYear(j.getFullYear()+g*h);return u(j)},a}(),b.z$=_},"./dist/plugins/fill/fill.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/fill/fill.res.en.js");b.SR={en:d}},"./dist/plugins/fill/fill.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.CopyCells="Copy Cells",b.FillSeries="Fill Series",b.FillFormattingOnly="Fill Formatting Only",b.FillWithoutFormatting="Fill Without Formatting",b.Exp_NumberOnly="Only works for Numbers",b.Exp_RangeContainsMergedCell="Range should not have merged cells.",b.Exp_TargetContainsMergedCells="Target range should not have merged cells.",b.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",b.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",b.Exp_FillCellsReadOnly="The cells you are trying to fill are protected and therefore read-only.",b.Exp_ChangeMergedCell="Cannot change part of merged cell.",b.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",b.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",b.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",b.Exp_RangeIsNull="range is null",b.Exp_ChangePartOfArray="Cannot change part of an array."},"./dist/plugins/filter/filter-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/filter/filter-ns.js"),e=c("Core"),f=c("Common"),g=c("./dist/plugins/filter/filter.js"),h=c("ConditionalFormatting"),i=f.Common.j.Fa,j=f.Common.j.Ba,k=e.Commands.ActionBase,l="sortFilter",m="filterTextSelectAction",n="filterByCondition",o="clearFilter",p="contextmenuFilterForSheet",q="contextmenuFilterForTable",r=e.Commands.h4,s=f.Common.k.ac,t=void 0,u=null,v=new f.Common.ResourceManager(d.SR,"Filter"),w=v.getResource.bind(v);function E(a,b){var c,d;return a?(d=b.tables.findByName(a),d&&(c=d.rowFilter())):c=b.rowFilter(),c}function F(a,b,c,d,e){return{sheet:a,sheetName:a.name(),table:b,tableCol:c,filterValues:d,conditionInfo:0===s(d)&&e?e.toJSON():t}}function G(a,b,c,d){return{sheet:a,sheetName:a.name(),col:b,filterValues:c,conditionInfo:0===s(c)&&d?d.toJSON():t}}function H(a,b,c,d,f){var g=c?a-c.range().col:-1;c?b.Wq(e.Events.TableFiltering,F(b,c,g,d,f)):b.Wq(e.Events.RangeFiltering,G(b,a,d,f))}function I(a,b,c){var d,f;c?(f=a-c.range().col,d={sheet:b,sheetName:b.name(),
table:c,tableCol:f},b.Wq(e.Events.TableFilterClearing,d)):(d={sheet:b,sheetName:b.name(),col:a},b.Wq(e.Events.RangeFilterClearing,d))}function J(a,b,c){var d,f;c?(f=a-c.range().col,d={sheet:b,sheetName:b.name(),table:c,tableCol:f},b.Wq(e.Events.TableFilterCleared,d)):(d={sheet:b,sheetName:b.name(),col:a},b.Wq(e.Events.RangeFilterCleared,d))}function K(a,b,c,d,f,g){var h=d?b-d.range().col:-1;a.filter(b),d?c.Wq(e.Events.TableFiltered,F(c,d,h,f,g)):c.Wq(e.Events.RangeFiltered,G(c,b,f,g))}function L(a,b){a.suspendPaint();var c=e.Commands.bWa(a.name());return a.ITa.undo(b[c]),a.resumePaint(),!0}x=function(a){D(b,a);function b(b,c){var d=a.call(this,b,c)||this,e=d;return e.zZ=e.VQ.cmdOption,e.zZ.rowFilter=E(e.zZ.tableName,e.kj),d}return b.prototype.execute=function(){var a,b=this,c=b.zZ.rowFilter,d=b.zZ.colIndex,f=b.zZ.compareFunction,g=b.zZ.isAsc,h=!i(b.zZ.tableName),j=b.zZ.color,k=b.zZ.isBackColor,l={groupSort:b.zZ.groupSort,ignoreHidden:b.zZ.ignoreHidden};b.kj.suspendPaint(),b.kj.ITa.startTransaction();try{j!==t?c.sortColumnByColor(d,g,j,k,l,h):c.oLb(d,g,f,l,h)}finally{a=e.Commands.bWa(b.kj.name()),b.VQ[a]=b.kj.ITa.endTransaction(),b.kj.resumePaint()}},b.prototype.undo=function(){return L(this.kj,this.VQ)},b}(k),e.Commands[l]={canUndo:!0,execute:function(a,b,c){return r(a,x,b,c)}},y=function(a){D(b,a);function b(b,c){var d=a.call(this,b,c)||this,e=d;return e.zZ=e.VQ.cmdOption,d}return b.prototype.execute=function(){var a,b,c=this,d=c.zZ.colIndex,f=c.VQ.cmdOption.tableName,g=E(f,c.kj);g&&(f&&(a=c.kj.tables.findByName(f)),c.kj.suspendPaint(),c.kj.ITa.startTransaction(),I(d,c.kj,a),g.removeFilterItems(d),J(d,c.kj,a),b=e.Commands.bWa(c.kj.name()),c.VQ[b]=c.kj.ITa.endTransaction(),c.kj.resumePaint())},b.prototype.undo=function(){return L(this.kj,this.VQ)},b}(k),e.Commands[o]={canUndo:!0,execute:function(a,b,c){return r(a,y,b,c)}},z=function(a){D(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,d,f,g,i,j,k,l=this,m=l.VQ.cmdOption.colIndex,n=l.VQ.cmdOption.checkedValues,o=l.VQ.cmdOption.allValuesLength,p=s(n),q=w().Blanks,r=l.VQ.cmdOption.tableName,t=l.kj,v=E(r,t);if(v){if(r&&(a=t.tables.findByName(r)),t.suspendPaint(),t.suspendCalcService(),t.ITa.startTransaction(),H(m,t,a,n,u),v.removeFilterItems(m),p!==o)if(v.eNJ)v.rZ[m]=n;else{for(b=[],c=0;c<p;c++)d=n[c],f=void 0,g=d.text,i=d.value,j=d.type,g===q&&(g=""),f=new h.Condition(2),f._ps.expected=g,f._ps.compareType=0,f._ps.useWildCards=!1,("date"===j||"blank"===j&&v.HXJ)&&(f.jzb=!0,f.pLb=i),b.push(f);v.addFilterItem(m,b)}K(v,m,t,a,n,u),k=e.Commands.bWa(t.name()),l.VQ[k]=t.ITa.endTransaction(),t.resumeCalcService(!1),t.resumePaint()}},b.prototype.undo=function(){return L(this.kj,this.VQ)},b}(k),e.Commands[m]={canUndo:!0,execute:function(a,b,c){return r(a,z,b,c)}},A=function(a){D(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c=this,d=c.VQ.cmdOption.colIndex,f=c.VQ.cmdOption.condition,g=c.VQ.cmdOption.tableName,h=c.kj,j=E(g,c.kj);return i(f)?(h.Os(7,w().invalidCondition),!1):void(j&&(g&&(a=c.kj.tables.findByName(g)),c.kj.suspendPaint(),c.kj.ITa.startTransaction(),H(d,c.kj,a,[],f),j.removeFilterItems(d),j.addFilterItem(d,f),K(j,d,c.kj,a,[],f),b=e.Commands.bWa(c.kj.name()),c.VQ[b]=c.kj.ITa.endTransaction(),c.kj.resumePaint()))},b.prototype.undo=function(){return L(this.kj,this.VQ)},b}(k),e.Commands[n]={canUndo:!0,execute:function(a,b,c){return r(a,A,b,c)}},B=function(a){D(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,d,f,j=this,k=j.kj,l=j.VQ.cmdOption,m=l.selection,n=l.activeRow,o=l.activeCol,p=l.expectedText;k.ITa.startTransaction(),1===m.rowCount&&1===m.colCount&&(m=this.kj.expandSelection(k,m),this.kj.deleteBlankContent(k,m)),k.rowFilter()?(a=void 0,b=k.rowFilter(),c=b.extendedRange||b.range,c.contains(n,o,1,1)?(H(o,k,t,[p],u),a=new h.Condition(h.ConditionType.textCondition,{compareType:0,expected:p}),b.addFilterItem(o,a),K(b,o,k,t,[p],u)):c.row-1!==n||i(b.qZ[o])?(k.rowFilter().unfilter(),k.rowFilter(new g.HideRowFilter(m))):(d=k.getText(c.row,o),H(o,k,t,[p],u),a=new h.Condition(h.ConditionType.textCondition,{compareType:0,expected:d}),b.addFilterItem(o,a),K(b,o,k,t,[p],u))):k.rowFilter(new g.HideRowFilter(m)),f=e.Commands.bWa(k.name()),this.VQ[f]=k.ITa.endTransaction()},b.prototype.undo=function(){return L(this.kj,this.VQ)},b}(k),e.Commands[p]={canUndo:!0,execute:function(a,b,c){return r(a,B,b,c)}},C=function(a){D(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,d,f,g=this,j=g.kj,k=g.VQ.cmdOption,l=k.tableName,m=k.expectedText,n=k.activeCol,o=k.activeRow;j.ITa.startTransaction(),a=E(l,j),b=j.tables.findByName(l),a&&b&&(c=b.range(),b.showHeader()&&c.row===o&&!i(a.qZ[n-c.col])&&(m=j.getText(o+1,n)),H(n,j,t,[m],u),d=new h.Condition(h.ConditionType.textCondition,{compareType:0,expected:m}),a.removeFilterItems(n),a.addFilterItem(n,d),K(a,n,j,t,[m],u),f=e.Commands.bWa(j.name()),this.VQ[f]=j.ITa.endTransaction())},b.prototype.undo=function(){return L(this.kj,this.VQ)},b}(k),e.Commands[q]={canUndo:!0,execute:function(a,b,c){return r(a,C,b,c)}},e.Commands.fVa=function(a){a.register(l,e.Commands[l]),a.register(m,e.Commands[m]),a.register(n,e.Commands[n]),a.register(o,e.Commands[o]),a.register(p,e.Commands[p]),a.register(q,e.Commands[q])}},"./dist/plugins/filter/filter-button-images.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8c";function e(a){return 0===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg==":1===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAALLSURBVHjadJNtaNVlGMav+/kfjy3GTDfcsQW1CMrhWSZ6AsmXmflFDts5/0eYA52i02M6tdBIRQQJBLX8Yg4xYlMEJaHphzxKzoiaZptN0MBtacyXoYIobUgT/fXhtOMS+vBw89wXXPfLdd0CLNxwyACF648YYH7tnuEYAeQbv3CA/EeHBcivazbAUo1fv6hwfYtJEjDy2XP//8vpGbA9ZiE7xQ6USs3S7sUx9YHNbMqYn1IerGmQ3pr8uYXsNUAqnZ+LvqHJAA2BeIoGT6DJbMqBbAwArR77vs4/uhOje9BxlXEcww13pXDvtwaoes1MB6iz8xfxGkIIiLCUIEXaDTxiFJOmKp5YxDcciS6jVpRi8g1H87PVgLYslwO0GYzf+x377ubwXoLKafXEE/WUTfC9tBIhwNTJdAPkw4R1fdkkOmJW1/LAYNBV54iDJK8HH7NPd+/9MTqeWER//62YHxrrJvCDydd99Z/tpjLboz7znQF2/vSfufwY9Ne1e9r9JtHKaUvxqWY3UgXX23dNbccOlhQUFxUN9GweVsaWIQNZRfkeByidrnDxRD19N29U5AnChkMO0BMYAwRA4GkPAKuZc/2F8JWTDlB716sCIm9PXcz1K9+/lCc4erstABQmP3U8LBvlV2VJr8yyIHMSv+LUk1QmCzADBjQnrB0dT9TT0/243NfqXx8szwaAzq6Q1bDJnWnrmlKV3EZVchvvJbfQ2nqmDLDqD0/YXFqs8t0l/Haxu3j+vOPDO9ifu4P9jwPAeSk6RE/RpHc+4KefL8waYWEDrOPX9ol/cycA1KH7pvCTsxFAPxZGXQ1YmDhlgNIHsoWQd5wONw4JxgfhwmeKXSUjXbq0Oi/j80el28UjqpdqK1ivcCB7KJwXTuHKcwWAPtPCoJkShy7kjKU3dIXLAvQyVdq1C3WVXNbE2RgUOphuqVXH3T8DAFTcPgRQEEuLAAAAAElFTkSuQmCC":2===a?d+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAJKSURBVHjanJJfSJNhFMaf9/02R9MFCVZLUOgfpLMCmwrd7KIIm6X4fXoTY1oXltaN86oEi4xodtNNeNMHJZQ0gpDQmUKEyUAiyKCFW4PNtSFMoyKJSp4uputbJIUX5+K855zfe85zDkhiza4u2+HXn4M64dcBvw5BTotLtyDJ49KvI2fapK/Q/8qkwAjYiEHj4rrBG+ft4p+AB51f8pKazxxDY/djhLYj95bJLKG5fR+w5whUVxNUtR6qOiHUrmABNH3AkgcoqsBM11O56gvVUy2GV6CQNA/WjFdkMpnyhYV0NjZOAf6ksQMZCGQL3e526fUWm0kKrlAJRT7CUXeac+Gp3bRTaJpHXsReoLl3yGQAKPUtlaJh8yHxKI0s+C3xLHHXwjIqlbXtTKc/lKTScaRSFItMAWReB4WtdfdMJCVJTI18xihLNzFCyWXC4WxjMpksjiOK5BytjXIGUH0XCowjkFsESeF27BQLSy9F/2FK0ip6wa2VtV7OxxNF8XgciUQCKpMCZFoaRdQ6PXIHshvQDtACUJDARA/tVTVe6rHrSs97mMPh16j3vQECvpKc4iSLWzrGqXWMrahnx6h1jP5oPRf8Ho1FLA5nG/c7vayq8TIajdoikRi0nqCEdn9gDaCQLNVOXZOuk310nbhCV0Mvhx+OWlbhykGnh+Hou20sy2rUdLtbAJxUfs9PwW9PQM4qjuqjfDEd6ssX+VP56kdZ/+s80H9nZJcBYDxT6x8b+vspDw4Fbf+TuC7gpn7ZtoFCSdJE0vxrAN8Jcr/DWZzEAAAAAElFTkSuQmCC":3===a?d+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMuSURBVHjaZJN/aNR1GMefz+f7/d6P3aZGDGVKERLDbXdMJAQhlr+ujWo62g5DpUBiEyJjpxi0ZRtyDSQvV0cDd2uw213b1EHiFjbGZq5bIbc5dTuyybRyK+ZCDrG0evWHdwfWHx8+PDwPz/vzeb2fR451DGvpQB2ODJvnP24zDkewD7Zct6h9qD1j4TzPWNgsip80isbCxuS7vzinGm5aZwcwbwVPGoAhgAIEsAAN2NKxSscmYKRvE1iRPrY3Vt7Ski4WQKaJOmbjyF3WS//3jfr4hVXGEA55J5aXc+ZMdF0yOZWbFtCAKtx5zCUQLQBk32svPFJ8eHN16u+fCn6fv+MErKWlRWdvPzr9QpUVnIroxravlYz0tTvWdi9XRFGA6ugKOMPh7qHu7u5Ue3s7ra2tBIMnaG4+Sl1dHTU1NZSXl7P42x39zRxKYl82mYD8Q0wA8bjFmv855Xqzdu/swsICDx78xfz8r0xMXKa+/iBer5fx8W+PDi22PjH43pKSoi2bzIS+reVlUYCVn18q11hl9vb2GIFAgFQqxczMDKFQCK/Xy8WLF4ozkN2e00o8O07YA1KpxCUCyKYSUX1fxDQgc3NzRjAY/DMej+Pz+ejpiTkzAAEpqfpEJHeP2PZJXO32VBsbKryydY3IPZB1a3IVIH6/n1AoREVFBWmQjzknK7aLHm4bWXs5cel48uq0ziQGolE9e/uG8vsPceDttygrK8s2cBfkZ9zQ8syGbeaVyQmp3v8VNXWDvFo3SPX+8/hqzxEPjqiD9X5eqqoiN8fFjzeu5wHidh9xZTjIgZr1BqAaWi6Zm3e8z/OVDZS90kBv74AdUH7/IbZu3oJps0h8N7N62IXpLt2VnVbZWfKc+jTx+aM/3bti85RuZ3RsvBjQxFgWO9VnTSebzB+SMyvhtMMTFsv9+l4r26Czq0sxcV9F+3eprnOJwumr14ozpMMfnLV/duQjPdeDmiTiaGrutLs3Nhjujc86sxD/uHs/DxCPjFrbXly0N7ZEbR9GcPb0jz4NS/q/1P/nwlOFlYpOrZ4UkeUiOt8nRk6xyGNzT3YXTGBZeqEcgP53ACxeTBjELwuFAAAAAElFTkSuQmCC":4===a?d+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMNSURBVHjalJNfaFt1FMfP796bm9hublCwa93AVd3W5d67ddisFFw1lovUl7r0jx2rWWW6prpCkzfrUwjVFx0LwSrYPtiO0YJPDsuwIOJKq1PL0q43iZ3OuUp04p8owmbl40PXMgaCPnzhcPjCOef7PV8BxD6WETrKjXcviUbjTlW870/ta9mqfiqv1kuRQePjk68pkj4FSfX66HRA8ujfDPapvveWN4n1xKAC5H9CB3SRo767m9uhvRxQUGXAEXOt3uCodViWpT4Yi+tC1Rrhj99/luV8QQ43unrkxWaNVSqvXSNgHSeQSqU2A4Zt2xUdHR3bp6amwp8uTNU91jRgij2PAWg1da+sTwmeGTv768TExN8jIyOk0xlOnTpNMpkiFovR3t6O67rcuPHDJkCtr6U7zVH/gffPKrwravLzC75EIkGxWOTWrVWKxR+Zn79EPB7HdV3m5uYaAK12/xfmxm0P1uwW62D36p77nzdXVr4Txwn5h4aGVkqlEp6XJ5PJ4LouMzMzDYAGiPXkGwGJLGIAyqmPYod6sEM9vziRF0xALMvS0+n0zdnZWTo7O5mcnNwHaNevi27bqN0v+w1pWyj5AOUEjygn1I3VeLzaund/xfj4uAASi8WWM5kMLS0tAAYgV69+K5cvvyq/zZ7TpG1hzZaqbZbsDR3DPnSi2n6ka0uhUJB8Pt+QSCTo7++nqamJ204YXV1PG5aF2nFxUgn7PlGAWIefVXYoihVufcBWorLZrOTz+YMDAwN/tba2UlZWRi6Xq7itmQbb9JnU25qMvvmRAKrmoafEqY/edOqf2bljV/iebDYrgPT29q6Ew2FM06RQKFQMDw+L4ziabaP3nXwpIBy9oACVnBblHOh52N4Vqaxr7jYAFQwGty4uLm72PE/3PK8yt+QZuawnjgSN0TOiDj36nCmP9364pjiY1hJ67RX8F5dMBUjtW7Xav+Xh3PRnIiK6CF/qd/66886YHvW3Sfh8lQHfy11Z2MCegBgioknbCZQTPr1l71di/IcUqjsgLfHzvn8GACNDKumTxWELAAAAAElFTkSuQmCC":5===a?d+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAANBSURBVHjaXJNfSGR1HMXP73fvdcYdo7Vy1KRlZ9DdnOvv5uTODK0s1mxDyKIYSRYoUwQikkgzPUS0RuW6QRCEuIiM/XuxNdiH6m17WnZFCMSHtjuOszONf0ZnGgW1iLbw9DBl0sPhy3k5HDjfD0h6w/VvSJJC8a5sOPeUYQ1TIjAuPOc+kN6Kae2JthodGBCVrSEdpmXAd8pJUrb2julgiWgJ9MMXABIXYADApQA0ACLc8Jjg9bAkKbhbD5LimDTgNQn15sc6SZD1onyPZIAUSyQOSS124oLzDxL7hwRJjaTIFbYcUJ5xB0lYp29oZ8+OypZnPhfvkXiHdGz8nHHs7++6e+vede6UiiiVio69vR2v1+2S5slqQRJ4XvdXkBS7O+uuUv43bO79UvPZp4nfr8/N/Tk7O8urVz9cu3x5zH6x76Xvuru7f+zq6joIhUKFYrHYSBJA4yVBUm5sbWPm15nqH1bvOpRScnBwcL1QKPD+/b+4vV3k0tIy4/E4I5EIFxcXu0nKckDwWUlSV6peqGCUW/mvJUmoNr82MTHBg4MD2rbNqakpRiIR3r59a5ykzOc3QBJob5txkZSbuQ00h/q5ub7htZSJ9NYmlDLF5OQkFxYW2NfXx/n5+YskhWk2G0p9IV5BXgDBAZ1k5Z07tx6wAlHmcjlHjrUim13D8vIaYrEYr12bZmdnJ0k6ygvVHi0GOD2SpHGPhApGmclkKjKZ15HJpHHzJrV4PM6RkRF2dHQwm83WeTweMTw8cCwA1YKkUwWjVMEofaFXeS99w1CksKwWIxaLsaenh1VVVUyn0yf8fmBoKCpIoqeBAr3n50DywdXVlWorEGUqufp0imnpM8eEaZpaPB5nOBymrutMpVKuM2dGdQvjGh+icfFxCCA0YJB0tKC9Mpn8qTKZhLSS0BOJUWmaprBtu8K2bW1lZeVR27alUq3SwpDBh2t1fAUN/eepkYfCOvW26/grWxNB6XukvYJJwgKE+c1zUs270TQdkmq4WeKtTwS+hETiCgUJafrb/89CWTU9/8JT9k2UnP7HN1Ag+OQV8Ps6Yb78vigj/a08ahGCaGzql/zIrbmhy/9IzAmSztMvzJz8ewAvdf7cUVI5hQAAAABJRU5ErkJggg==":6===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAeBJREFUOBGtkj1oU1EUx8+5fSC00VZoCwpOtUOcBMHFdhA0g5ODg0HSDg0EuoibOrTRodBdhWIMlCAFFTMphCqVakgGcS2InSoiQQ22SUxe373H+7+ax2uJkz3w7rnn6/fOvecSHaQsfqjNLLyvCXQvbrValUqlItGYihrNts50ds0b6Ki/uw+CgLTWXdPpEHC7/Pl0xzenuE8lfd/EYe/JtAaK/wlotnSm7QdPs2dHv/7yg2ew9wN6dcBIml2rxYLG9hdi3mShLWE6QSJjXuzI8QfnRxtdUKlUEmamRCLh6uD3sLTq9aSQqnl96jr+4nkeBYHO+9Zvww+RAzHGWO6eO/wL8E1GickvJ8fX/6QSXV3ZyBsmHCMEAP5fUiwWBV8U4o7QWb0Q175+7gK2RVE8SEaOseKJ/ktr5W7B/gnA7wCHLr7asPs4HPJycqTR0utM6snAlXdhMWIA9LwDBCHyeOLozvf2KrF6G7tWvkEUXraL9wKEGfLo3OGfuvnajvDjUPryFHPWuCq7FAqFeTuBLGyMEV0opbKpVOqOe4mydKa/3vjxQrc6W0OD49PRYhQhEQB0gElgD58DYvm2ePKWpS64h2Ro13WOu2a6N3zz033kQHK53Bx0Op2+C30g8htq3/HPc2QfaQAAAABJRU5ErkJggg==":7===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAdVJREFUOBFjYKAQMIL0/9ztovn31991YLP+/2f4z8TIz/DvvyQjE6MNl9f+ozA7Tpw48R8IGCwtLcH6QOIsIILddc91IKUJYv/fZiv65dvfQ4wMTKu4Q47ANYPk/vz5A6JQANgAmMj/pTaCn9/+2M3AyHSYJ/poIQMD3CKwkr9//8KUwmm4Af/nWvN+/Ppl539GhisCKQEZjIyM/+GqoAyQC4DiKMJgA/7PNOZ6/+XdVqD3HgtJ6cQzMjb8Q1FFyIC3Hz7mAwPHFmj83bd3z19506ECDAygLkaGKSIVd6bCDPv37x8DKBCRAdgFIuV32oGCIIwXYAtEJmQdnedeJbedefUfRCOLw9ggA9ANQTHg64+/6T9//zsAomGakGlQLKDHBNyAqqNPDH7++qfFyMwU+evXP00QH1kziA3SjNMFX7/9Tf/x68/qBjOxF99//VkD4mMzAN0F4EjN2v+K58+XT89AsQCM/cfAtCALDG5lFh4+qWmOYl8WL15cD4yBBpCBoHQAigkmJqaG2NjYRrAXvr1/H/nz9/9Xf/8y5v/49bcHRAO98wokDtIEUggyAOYFEBskBpIDg7AV189ELL9eBeODaBAfJI4sNmfOnDoQRhajmA0AtPr0ppdKGGIAAAAASUVORK5CYII=":8===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":9===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPlJREFUOBHtULkNg0AQPJBBogVyKICE1CSkxIgCqMkFUAApiQlISCiAAlwABIjfM2dZOnwteKXTfjNzuyvE34zfE7Rt65/n+bBtOwuC4MV+13XuPM+FaZp5GIa9yrmpCeNpmh5wdxCeTdNErI3jWEPUgwB7ssY6TRNYliUzDOMJgk9PEMmIe/iMuWraCmxWVeWu6ypFmJNsWVYUx7FcibWvaROwgTXEvu8Sg18FRhfbtn05F69NUJalC4EaKA9PHgwiXKd3HCdKkuQyhTbBMAwFCJLMsfkd14HzcZ8C/nJEkwDVjuPIAaxBitI0ffExZg3CuYr9x58LvAEtbX2YkfGdBQAAAABJRU5ErkJggg==":11===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":12===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAgRJREFUOBFjYKAQMIL0nzx5cs6/f/+SCZnFyMh4kpeX105bW/sXTC0TiCEmJpbz58+fc0DMgAe/YWJiCkXWDNILNkBRUfEHUGPw379/3/3+/RtsCIhGwv+A8pFmZmaPQZqQAdgAkICjo+MDoAExQPwPpBFIgzHIRUDv1QLl9yBrhLHBYQDjgOjt27fXAzU0AP0LFgbSmzw8PAKA9H9kdTA2hgH///9n2gIEQEO+mpzfvp2FmfWgeO3kuzAN6DTcCzAJoE0g/zZoXj+8h+Pti7lMLx5deJHpmwKTB9H/09JY74XamoHYGAaABIFh8PemhAb//3//1wBN4/r769fsRwmu0x8luUrdjXRov/v++sM/f/5a4DOA4RMrZ+dOq7C1QC8Z/P/7/8K/P38z/nz/+fjfn98+QDf4qq0/NgmvAaCYAHrlpziDzI0/f//e+AuMjb9//jH9+8dQrrL6yFmQZhDA6gWQBDAaG+Pu79/+8OudjX9//4kAeqcLKLbm7+9fHf8bGuD64AyQJhj4+fPnpaTHj5se3Xm08d/fv57AGJmgsupwubqIbtSP778enNm/IhymFqsB6enpvx/fO+IL9ILbn39/L6oIaJaBNDDOmvVb8Ldg2I9vv2yAYQNOAlgNACn+zfD/+r+//+4x/mMoAGkEiYGA4oEDP1iZmCp3a4mpQEQoJAFYGTPePuR04gAAAABJRU5ErkJggg==":13===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjlBNDZFRkFFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjlBNDZFRkJFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2OUE0NkVGOEUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2OUE0NkVGOUUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Poa+1GoAAAE5SURBVHjapJO/SgNBEIdzS6x9CR8gEIjNYSkISWNI1BCw0MLCQCqDhWC0SGIltpo3SIrY2NgI1ygoJo1WIZBW0gn+Qc9vYC8sS+5OyMB3c7v3m7mZnTvH9/3EPJaUi+d5V7idf+jvYcV13a9gQ2m/D08xwW9QMIOnCdj8wOVhEhL8C1voxvaDoAJJMsKVtdi2I57fzsqszAWiG9yJpbmGRuQhWnYKy/AOkvCOxKGjUvYGYmnhGKTkNjwzpV1Tw3oBMmEViP3AInRgHS4JSOvqKrANTXhQEWNrQRdSUgXsgUwhCzkqvZjZgmWf8KoJ9DWCH0PPwLC6PsQebMKZbqlJOyouwUCPU4LX4Jy31vAlkO9lIzIB4m/pE1ahDwfGflFuqcKJa+EFhlDVgQnjsz+EJVk78/7OfwIMAP6mWr/ROcXGAAAAAElFTkSuQmCC":14===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAGBJREFUGBljYCAHzJo1a8L///+ZsOlFEQQqygcqXr1q1SpOdMUoCqGSQe/fv987c+ZMEWTF2BSC5C0ZGRkXEaPwONAZccgKWZA5UPY6QUHBmLCwsO9Y5CBC+HyNUxPZEgCPEyCkHm49GwAAAABJRU5ErkJggg==":""}b.getFilterButtonImageSrc=e},"./dist/plugins/filter/filter-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib,Jb=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("ConditionalFormatting"),g=c("./dist/plugins/filter/filter.js"),h=c("CellTypes"),i=c("./dist/plugins/filter/filter-button-images.js"),j=c("./dist/plugins/filter/filter-ns.js"),k=e.Formatter.GeneralFormatter,l=e.Common.CultureManager,m=e.Common.l,n=e.Common.j.Ba,o=e.Common.u.Ob,p=e.Common.u.Pb,q=null,r=void 0,s=d.Ul.Nl,t=d.Ul,u=e.Common.k.ac,v=t.nl,w="left",x="top",y="float",z="relative",A="gc-ui-filter-subitems-container",B="gc-no-user-select",C="gc-filter-dialog-style",D="position",E="gc-ui-filter-subitem-item",F="gc-ui-filter-allDate-item",G="gc-filter-alldates-arrow",H="gc-filter-item-hover",I="ui-state-hover ",J=I+H,K="gc-filter-hover",L=K+" form-control well "+J,M="gc-filter-button-hover "+I,N="gc-filter-submenu-check",O="gc-filter-submenu-check-img",P="gc-filter-allDate-check-img",Q="gc-filter-alldates-list",R="gc-filter-addDates-container",S="gc-filter-subMenu-wrap",T="top10_dialog",U="custom_dialog",V="gc-sub-color-sort",W="gc-sub-color-filter",X="automatic",Y="more_color",Z="gc-filter-dialog-color-title",$="gc-color-item",_="color-checked-wrap",aa="gc-color-item-list",ba="gc-filter-sort",ca="gc-filter-color-dialog-background",da="gc-filter-color-dialog-font",ea="gc-filter-color-dialog-style",fa="TextFilter",ga="NumberFilter",ha="DateFilter",ia="#D3F0E0",ja="#86BFA0",ka="#000000",la="#FFFFFF",ma="transparent",na="border-box",oa="data-isCheck",pa="inline-block",qa="content-box",ra="#top10-item",sa="#gc-color-dialog-selected",ta="#gc-color-dialog-noFill",ua="thin solid rgb(160,160,160)",va="data-checked",wa="gc-filter-dialog-close",xa="1px solid #c2c2c2",ya="gc-filter-top10-rank-illegal",za="1px solid #e0e0e0",Aa="data-isNeedDialog",Ba="data-isCustom",Ca="data-conditionType",Da="data-operatorType",Ea="data-colIndex",Fa="data-colorType",Ga="data-color",Ha="<div class=",Ia="<span class=",Ja="<img class=",Ka="<li class=",La="object",Ma="</span><span>",Na="</div></div>",Oa=".filter-custom-select-input",Pa="display",Qa="box-sizing",Ra="none",Sa="width",Ta="height",Ua="padding",Va="border",Wa="click",Xa="mouseover",Ya="mouseout",Za="resize",$a="inherit",_a="#E81123",ab="white",bb="backgroundColor",cb="#f0f0f0",db="margin",eb=db+"Left",fb=db+"Top",gb=db+"Right",hb="font-size",ib=188,jb=16,kb=1e4,lb=[[1,"Equal","E",1,0],[1,"NotEqual","N",1,1],[1,"GreaterThan","G",1,2],[1,"GreaterOrEquals","O",1,3],[1,"LessThan","L",1,4],[1,"LessThanOrEquals","Q",1,5],[1,"Between","W",0,1],[1,"Top10","T",8,0],[0,"AboveAverage","A",10,0],[0,"BelowAverage","O",10,1],[1,"Custom","F",1,0]],
mb=[[1,"Equal","E",2,0],[1,"NotEqual","N",2,1],[1,"Begin","I",2,2],[1,"End","T",2,4],[1,"Contain","A",2,6],[1,"NotContain","D",2,7],[1,"Custom","F",2,0]],nb=[[1,"Equal","E",5,0],[1,"Before","B",5,2],[1,"After","A",5,4],[1,"Between","W",0,1],[0,"Tomorrow","T",6,2],[0,"Today","O",6,0],[0,"Yesterday","D",6,1],[0,"NextWeek","K",6,9],[0,"ThisWeek","H",6,7],[0,"LastWeek","L",6,8],[0,"NextMonth","M",6,6],[0,"ThisMonth","S",6,4],[0,"LastMonth","N",6,5],[0,"NextQuarter","N",6,10],[0,"ThisQuarter","N",6,11],[0,"LastQuarter","N",6,12],[0,"NextYear","N",6,13],[0,"ThisYear","N",6,14],[0,"LastYear","N",6,15],[0,"YearToDate","A",6,0,6],[0,"AllDates","P",6,1],[1,"Custom","F",6,0]],ob="IsBeginWith-2-2",pb="IsEndWith-4-2",qb="NotEndWith-5-2",rb="IsContain-6-2",sb="NotContains-7-2",tb=[["Q1","1",6,0,2],["Q2","B",6,1,2],["Q3","A",6,2,2],["Q4","4",6,3,2],["Jan","J",6,0,3],["Feb","F",6,1,3],["Mar","M",6,2,3],["Apr","A",6,3,3],["May","Y",6,4,3],["Jun","U",6,5,3],["Jul","L",6,6,3],["Aug","T",6,7,3],["Sep","S",6,8,3],["Oct","O",6,9,3],["Nov","N",6,10,3],["Dec","D",6,11,3]],ub=["IsEquals-0-1","NotEquals-1-11","IsGreaterThan-2-1","IsGreaterOrEqual-3-1","IsLess-4-1","LessOrEqual-5-1",ob,"NotBeginWith-3-2",pb,qb,rb,sb],vb=["IsEquals-0-2","NotEquals-1-2","IsGreaterThan-2-1","IsGreaterOrEqual-3-1","IsLess-4-1","LessOrEqual-5-1",ob,"NotBeginWith-3-2",pb,qb,rb,sb],wb=["IsEquals-0-5","NotEquals-1-5","IsAfter-4-5","AfterOrEqual-5-5","IsBefore-2-5","BeforeOrEqual-3-5",ob,"NotBeginWith-4-2",pb,qb,rb,sb],xb=new e.Common.ResourceManager(j.SR,"Filter"),yb=xb.getResource.bind(xb);function Kb(a){return typeof a===La?JSON.stringify(a):e.Common.pc.bc(e.Common.pc.ec(a))}function Lb(a,b,c,d){var e,f;try{if(c.suspendPaint(),!d)return;e=d.sj?d.sj.name():r,f={tableName:e,colIndex:a,condition:b},g.h4("filterByCondition",f,c)}finally{c.resumePaint()}}zb=function(){function a(a,b,c,e,f,g){var h=this;h.Nc=r,h.EXa=g,h.FXa=a,h.kj=e,h.GXa=d.GC$(a),h.xo=b,h.P$a=!1,h.HXa=c,h.xr=c.rowFilter,h.IXa=f,h.JXa=q}return a.prototype.ad=function(){this.yl(this.KXa()),this.LXa()},a.prototype.zW=function(a){return i.getFilterButtonImageSrc(a)},a.prototype.KXa=function(){var a=d.GC$(s("div")).attr("id",A+"_"+this.EXa);return a.addClass(C+" "+B+" "+S),a.css([D,Pa,Qa],["absolute",Ra,na]),this.JXa=a,d.GC$(this.FXa).append(this.JXa),a},a.prototype.cXa=function(){return"none"!==this.JXa[0].style.display},a.prototype.Ao=function(){d.GC$("."+S).hide(),this.JXa.show(),this.MXa()},a.prototype.hT=function(){this.JXa.hide(),this.JXa.find("."+L).removeClass(L)},a.prototype.OWa=function(a){return this.Nc=a,this},a.prototype.MXa=function(a){var b,c,d,e,f=this.GXa.offset(),g=this.IXa.AWa.offset(),h=document.documentElement,i=g.left,j=g.top,k=h.clientWidth,l=h.clientHeight,m=this.JXa.width(),n=this.JXa.height(),o=this.GXa.parent().parent(),p=o.offset(),q=p.top,r=this.xo.offset();r.left+this.xo.width()+m-i>k?(b=-1*(m+2)+"px",d=!1):(b=this.xo.width()+"px",d=!0),e=f.top-r.top,c=q+e+n-j>l?j+l-n-p.top-6:e,c+="px",this.JXa.css([w,x],[b,c]),a&&a.call(this,d)},a.prototype.NXa=function(a,b){var c=this,d=c.kj,e=c.xr;Lb(a,b,d,e),this.IXa.close()},a.prototype.oXa=function(){var a=d.GC$("."+H,this.JXa[0]);a.trigger(Wa)},a.prototype.WW=function(){var a,b=this,c=b.HXa,d=this.kj,e=c.col,f=c.rowFilter;f&&(a={rowFilter:f,colIndex:e},d.wu().execute({cmd:"clearFilter",sheetName:d.name(),cmdOption:a}))},a.prototype.tXa=function(){return this.hT(),q},a.prototype.uXa=function(){this.cXa()||(this.Ao(),this.mXa())},a.prototype.yl=function(a){},a.prototype.LXa=function(){},a.prototype.mXa=function(){},a.prototype.wXa=function(){},a.prototype.vXa=function(){},a}(),Ab=function(a){Jb(b,a);function b(b,c,d,e,f,g){return a.call(this,b,c,d,e,f,g)||this}return b.prototype.yl=function(a){this.OXa()},b.prototype.LXa=function(){var a=this;a.JXa.bind(Xa,function(a){v(a)}).bind(Ya,function(a){v(a)}),d.GC$("."+E,a.JXa[0]).bind(Xa,function(a){d.GC$("."+E).removeClass(L),d.GC$(this).addClass(L),v(a)}).bind(Ya,function(a){d.GC$(this).removeClass(L),v(a)}).bind(Wa,function(b){d.GC$(this).attr("id")!==R&&a.PXa(d.GC$(this)),v(b)}),this.QXa&&this.QXa()},b.prototype.r$a=function(a){return a!==r&&"TRUE"===a||"FALSE"===a},b.prototype.RXa=function(){var a,b,c,e,g,h,i,j,k,l,m,n,o=this.xr.rZ[this.HXa.col],p=this.SXa,q=!1;if(o&&o.length>0&&o[0]instanceof f.Condition)for(o=o[0],h=o.compareType(),i=o.expected(),e=o.expectTypeId(),g=o.conType(),10===g&&(h=o.type()),8===g&&(h=0),this.r$a(i)&&(g=11),0===g&&(j=o.item1().compareType(),k=o.item2().compareType(),5===Math.max(j,k)&&3===Math.min(j,k)&&(q=!0)),l=0,m=u(p);l<m;l++){if(b=0===g&&p[l][3]===g&&q||p[l][3]===g&&0!==g||11===g&&(1===p[l][3]||2===p[l][3]),b&&8===g){a=l;break}if(c=p[l][4]===h&&!q||6===p[l][3]&&i===p[l][4]||q,b&&c&&(isNaN(e)||0===e)){a=l;break}}isNaN(e)||6!==e||(a=19),isNaN(e)||2!==e&&3!==e||(a=20,this.TXa&&this.TXa(tb,i,e)),a!==r&&0!==a?n=d.GC$("."+E)[a]:!o||3===g||a!==r||2===g&&0===h?0===a&&5===g&&(n=d.GC$("."+E)[a]):n=d.GC$("."+E)[u(p)-1],d.GC$(n).attr(oa,1),d.GC$(n).find("."+O).css([Pa],[pa])},b.prototype.mXa=function(){var a=d.GC$("."+E).removeClass(L)[0];d.GC$(a).addClass(L)},b.prototype.UXa=function(a){var b;if(0!==a)b=a;else switch(this.Nc){case ga:b=1;break;case fa:b=2;break;case ha:b=5}return b},b.prototype.VXa=function(a,b,c,d){var e=this.kj,f;switch(a){case T:f=new Gb(e.parent.pZJ(),e,this.HXa,T);break;case U:f=new Ib(e.parent.pZJ(),e,this.HXa,U,this.IXa.fY,d,b,c,this.UXa(b))}f&&f.OT()},b.prototype.PXa=function(a){var b,c,d=this.HXa.col,e=parseInt(a.attr(Aa),10),g=parseInt(a.attr(Ca),10),h=parseInt(a.attr(Da),10),i=parseInt(a.attr("data-expectTypeId"),10),j=parseInt(a.attr(Ba),10),k=parseInt(a.attr(oa),10);return isNaN(i)||(e=0,j=0),0===e&&1===k?(this.WW(),void this.IXa.close()):1===e?(this.IXa.close(),b=8===g&&0===h?T:U,void this.VXa(b,g,h,j)):(c=new f.Condition(g),10===g?c.type(h):c.compareType(h),6!==g||isNaN(i)?6===g&&(c=new f.Condition(g),c.expected(h)):(c=new f.Condition(g),c.expectTypeId(i),c.expected(h)),void this.NXa(d,c))},b.prototype.OXa=function(){},b.prototype.WXa=function(a){var b,c,e="";for(b=0,c=a.length;b<c;b++)e+=b===c-1?this.XXa(a[b],1):this.XXa(a[b],0);this.JXa.html(e),d.GC$(this.FXa).append(this.JXa),this.YXa(),this.RXa()},b.prototype.YXa=function(){var a=this.FXa.offsetHeight-2,b=this.FXa.offsetTop;d.GC$("."+E+",."+F).css([Ua,Ta,"line-height","white-space","clear",Va,Sa,Ta,hb,db],["0 10px 0 0",a,a,"nowrap","both",Ra,"auto","auto","12px",0]),this.JXa.css([w,x],["100%",b]),d.GC$(".gc-filter-hotkey").css(["text-decoration"],["underline"]),d.GC$("."+N).css([Pa,Sa,"textAlign"],[pa,"24px","center"]),d.GC$("."+N+" img").css([Pa,"verticalAlign"],[pa,"text-bottom"]),d.GC$("."+O+",."+P).hide(),d.GC$("#"+R).css([D],[z]),d.GC$("."+G).css([eb,Sa,Ta,"background-position"],["5px","16px","16px","center bottom"]),d.GC$("#"+Q).css([D,Pa,Sa],["absolute","none","auto"])},b.prototype.XXa=function(a,b){var c="",d=a[0],e=yb()[a[1]],f=a[3],g=a[4];return c=""+Ha+'"'+E+'" '+Ba+'="'+b+'" '+Aa+' ="'+d+'" '+Ca+'="'+f+'" '+Da+'="'+g+'">'+Ha+'"'+ba+'">'+Ia+'"'+N+'">'+Ja+'"'+O+'" src="'+this.zW(11)+'">'+Ma+e+"</span>"+Na},b.prototype.vXa=function(){var a=d.GC$("."+H,this.JXa[0]).removeClass(L),b=d.GC$("."+E);0===a.index()?d.GC$(b[b.length-1]).addClass(L):d.GC$(b[a.index()-1]).addClass(L)},b.prototype.wXa=function(){var a=d.GC$("."+H,this.JXa[0]);a.length>0&&a[0].nextSibling?(a.removeClass(L),d.GC$(a[0].nextSibling).addClass(L)):this.mXa()},b}(zb),Bb=function(a){Jb(b,a);function b(b,c,d,e,f,g){var h=a.call(this,b,c,d,e,f,g)||this,i=lb;return e.PDJ&&(i=i.slice(0,7).concat(i.slice(i.length-1))),h.SXa=i,h}return b.prototype.OXa=function(){this.WXa(this.SXa)},b}(Ab),b.WWa=Bb,Cb=function(a){Jb(b,a);function b(b,c,d,e,f,g){var h=a.call(this,b,c,d,e,f,g)||this;return h.SXa=mb,h}return b.prototype.OXa=function(){this.WXa(mb)},b}(Ab),b.XWa=Cb,Db=function(a){Jb(b,a);function b(b,c,d,e,f,g){var h=a.call(this,b,c,d,e,f,g)||this,i=nb;return e.PDJ&&(i=i.slice(0,4).concat(i.slice(i.length-1))),h.SXa=i,h}return b.prototype.OXa=function(){this.WXa(this.SXa)},b.prototype.XXa=function(a,b){var c="",d=a[0],e=yb()[a[1]],f=a[3],g=a[4];return c="AllDates"===a[1]?'<div id="'+R+'" class="'+E+'" '+Ba+'="'+b+'" '+Aa+' ="'+d+'" '+Ca+'="'+f+'" '+Da+'="'+g+'">'+Ha+'"'+ba+'">'+Ia+'"'+N+'">'+Ja+'"'+O+'" src="'+this.zW(11)+'">'+Ma+e+"</span>"+Ia+'"'+G+' gc-filterDialog-rightArrow"></span></div>'+this.ZXa()+"</div>":"YearToDate"===a[1]?""+Ha+'"'+E+'" data-expectTypeId="'+a[5]+'" '+Ba+'="'+b+'" '+Aa+' ="'+d+'" '+Ca+'="'+f+'" '+Da+'="'+g+'">'+Ha+'"'+ba+'">'+Ia+'"'+N+'">'+Ja+'"'+O+'" src="'+this.zW(11)+'">'+Ma+e+"</span>"+Na:""+Ha+'"'+E+'" '+Ba+'="'+b+'" '+Aa+' ="'+d+'" '+Ca+'="'+f+'" '+Da+'="'+g+'">'+Ha+'"'+ba+'">'+Ia+'"'+N+'">'+Ja+'"'+O+'" src="'+this.zW(11)+'">'+Ma+e+"</span>"+Na},b.prototype.Ao=function(){d.GC$("."+S).hide(),this.JXa.show(),this.MXa(this.$Xa)},b.prototype.$Xa=function(a){var b,c,e,f,g,h,i,j,k,l;this.JXa.show(),b=d.GC$("#"+Q),c=d.GC$("#"+R),e=this.JXa,b.length<=0||(h=document.documentElement,i=h.clientWidth,j=h.clientHeight,k=this.IXa.AWa.offset(),l=k.top,f=e.offset().left+e.width()+b.width()>i?-1*b.width()+"px":a?e.width()+"px":-1*b.width()+"px",g=c.offset().top+b.height()-l>j?l+j-b.height()-c.offset().top-5:0,g+="px",b.css([w,x],[f,g]))},b.prototype.ZXa=function(){var a,b='<div id="'+Q+'" class="'+C+'">';for(a=0;a<u(tb);a++)b+=""+Ha+'"'+F+'" data-expectTypeId="'+tb[a][4]+'" '+Ca+'="6"  '+Da+'="'+tb[a][3]+'">'+Ha+'"'+ba+'">'+Ia+'"'+N+'">'+Ja+'"'+P+'" src="'+this.zW(11)+'">'+Ma+yb()[tb[a][0]]+"</span>"+Na;return b+="</div>"},b.prototype.mXa=function(){var a,b;this._Xa()?(a=d.GC$("."+F).removeClass(L),d.GC$(a[0]).addClass(L)):(b=d.GC$("."+E).removeClass(L)[0],d.GC$(b).addClass(L))},b.prototype._Xa=function(){var a=!1,b=d.GC$("#"+Q);return a=0!==b.length&&b.css(Pa)!==Ra},b.prototype.aYa=function(){d.GC$("#"+Q).hide(),d.GC$("."+F).removeClass(L)},b.prototype.QXa=function(){var a=this;d.GC$("."+F,a.JXa[0]).bind(Xa,function(){d.GC$(this).addClass(L),d.GC$("#"+R).addClass(L)}).bind(Ya,function(){d.GC$(this).removeClass(L)}).bind(Wa,function(b){a.PXa(d.GC$(this)),v(b)}),d.GC$("#"+R,a.JXa[0]).bind(Xa,function(){d.GC$("#"+Q).show()}).bind(Ya,function(){a.aYa()}).bind(Wa,function(b){d.GC$("#"+Q).show(),a.mXa(),v(b)})},b.prototype.bYa=function(){var a=!1,b=d.GC$("#"+R);return a=0!==b.length&&b.hasClass(L)},b.prototype.TXa=function(a,b,c){var e,f,g;for(f=0;f<u(a);f++)if(a[f][3]===b&&a[f][4]===c){e=f;break}g=d.GC$("."+F)[e],d.GC$(g).attr(oa,1),d.GC$(g).find("."+P).css([Pa],[pa]).attr(oa,1)},b.prototype.oXa=function(){var a;a=this._Xa()?d.GC$("."+H,d.GC$("#"+Q)[0]):d.GC$("."+H,this.JXa[0]),a.trigger(Wa)},b.prototype.tXa=function(){var a=q;return this._Xa()?(this.aYa(),a=this):this.hT(),a},b.prototype.uXa=function(){var a=this.cXa(),b=this._Xa();a?!b&&this.bYa()&&(d.GC$("#"+Q).show(),this.mXa()):(this.Ao(),this.mXa())},b.prototype.vXa=function(){var a,b,c,e;this._Xa()?(a=d.GC$("."+H,d.GC$("#"+Q)[0]).removeClass(L),b=d.GC$("."+F),0===a.index()?d.GC$(b[b.length-1]).addClass(L):d.GC$(b[a.index()-1]).addClass(L)):(c=d.GC$("."+H,this.JXa[0]).removeClass(L),e=d.GC$("."+E),0===c.index()?d.GC$(e[e.length-1]).addClass(L):d.GC$(e[c.index()-1]).addClass(L))},b.prototype.wXa=function(){var a,b,c;this._Xa()?(a=d.GC$("."+H,d.GC$("#"+Q)[0]).removeClass(L),b=d.GC$("."+F),a.index()===b.length-1?d.GC$(b[0]).addClass(L):d.GC$(b[a.index()+1]).addClass(L)):(c=d.GC$("."+H,this.JXa[0]),c.length>0&&c[0].nextSibling?(c.removeClass(L),d.GC$(c[0].nextSibling).addClass(L)):this.mXa())},b}(Ab),b.YWa=Db,Eb=function(a){Jb(b,a);function b(b,c,d,e,f,g){return a.call(this,b,c,d,e,f,g)||this}return b.prototype.yl=function(){this.cYa(this.IXa._Wa,this.IXa.aXa)},b.prototype.dYa=function(){var a,b,c,d,e,f=this.xr.zZ;if(f&&f.color!==r){if(b=f.isBackColor?0:1,c=f.color,d=this.IXa._Wa,e=this.IXa.aXa,"{"===c[0]?c=JSON.parse(c):""!==c&&(c=Kb(c)),""===c&&0===b&&d[X]===r)return r;if(""===c&&0!==b&&e[X]===r)return r;a={colorType:b,color:c}}return a},b.prototype.eYa=function(){var a=this.xr.rZ[this.HXa.col],b;return a&&a.length>0&&a[0]instanceof f.Condition&&3===a[0].conType()&&(b={colorType:a[0].compareType(),color:a[0].expected()}),b},b.prototype.cYa=function(a,b){this.fYa(a,b),this.gYa()},b.prototype.hYa=function(a,b){this.IXa.DXa(a,b),this.IXa.close()},b.prototype.iYa=function(a){var b,c,d,e,f;this.IXa.close(),b=this,c=b.kj,e=a?this.IXa._Wa:this.IXa.aXa,this.d$a&&(d=this.d$a.color),f=new Hb(c.parent.pZJ(),c,this.HXa,this.EXa,e,a,d),f.OT()},b.prototype.jYa=function(a,b){var c=new f.Condition(3),d=this.HXa.col,e=b?0:1,g=this.eYa();return g&&g.colorType===e&&g.color===a?(this.WW(),void this.IXa.close()):(c.compareType(e),c.expected(a),void this.NXa(d,c))},b.prototype.gYa=function(){d.GC$("."+Z,this.JXa[0]).css([Ta,"line-height","textIndent","whiteSpace"],["32px","32px","8px","nowrap"]),d.GC$("."+aa,this.JXa[0]).css(["listStyle","padding",Ta,"lineHeight",Va,"whiteSpace",Sa,db,hb,Qa],[Ra,"2px 0","23px","23px","1px solid transparent","nowrap","140px",0,"12px","content-box"]),d.GC$("."+$,this.JXa[0]).css([Sa,Va,gb,Ta,Qa,"whiteSpace",y],["75px","1px solid rgb(130,130,130)","24px","22px",na,"nowrap",w]),d.GC$("."+_,this.JXa[0]).css([Pa,Sa,Ta,"verticalAlign",db,"textAlign",y],[pa,"22px","22px","middle","0 3px 0 2px","center",w]),d.GC$("."+_+" img",this.JXa[0]).css([fb,Pa],["3px",Ra]),d.GC$(".gc-color-dialog-more-color",this.JXa[0]).css([Ua],["0 5px 0 0"]),d.GC$("."+_+" img.checked",this.JXa[0]).css([fb,Pa],["3px","block"])},b.prototype.fYa=function(a,b){var c,e,f,g;this.EXa===V?(c=yb().SortCellTitle,e=yb().SortFontTitle,f=this.dYa()):this.EXa===W&&(c=yb().FilterCellTitle,e=yb().FilterFontTitle,f=this.eYa()),this.d$a=f,g=this.kYa(c,a[X],a.data,0,f),g+=this.kYa(e,b[X],b.data,1,f),""!==g?this.JXa.html(g):this.P$a=!0,d.GC$(this.FXa).append(this.JXa),this.JXa.find("canvas").forEach(function(a,b,c){var e,f,g,h,i,j=a;e="{"===j.textContent[0]?JSON.parse(j.textContent):j.textContent,f=73,g=20,j.width=f,j.height=g,h=j.getContext("2d"),i=function(){h.fillRect(0,0,f,g)},d.To.setFillStyle(h,e,0,0,f,g,i)})},b.prototype.kYa=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=!1,q="checked";e&&d===e.colorType&&""!==e.color?g=Kb(e.color):e&&""===e.color&&d===e.colorType&&(g=e.color),f=0===d?ca:da,h=""+Ha+"'"+Z+"'>"+a+"</div><ul class='"+f+"' style='padding: 7px 0 0 0;margin:0'>",i=0;for(j in c)c.hasOwnProperty(j)&&i<5&&(k="",g!==r&&g===j&&(k=q,p=!0),h+=""+Ka+'"'+aa+'" '+Ea+'="'+c[j]+'" '+Fa+'="'+d+'">'+Ia+'"'+_+'">'+Ja+'"'+k+'" src="'+this.zW(11)+'"></span>'+Ha+'"'+$+'"><canvas>'+j+"</canvas></div></li>",i++);return 0===i&&g===r||b===r&&1===i?h="":(b!==r&&(l=0===d?yb().NoFill:yb().Automatic,m="",g!==r&&""===g&&(m=q,p=!0),h+=""+Ka+'"'+aa+'" '+Ea+'="'+X+'" '+Fa+'="'+d+'" '+Ga+' = "">'+Ia+'"'+_+'"><img  class="'+m+'" src="'+this.zW(11)+'"></span>'+Ha+'"'+ba+'">'+l+"</div></li>"),5===i&&(n="",p||g===r||(n=q),o=0===d?yb().CellColor:yb().FontColor,h+=""+Ka+'"'+aa+'" '+Ea+'="'+Y+'" '+Fa+'="'+d+'" >'+Ia+'"'+_+'">'+Ja+'"'+n+'" src="'+this.zW(11)+'"></span>'+Ha+'"'+ba+' gc-color-dialog-more-color">'+o+"</div></li>"),h+="</ul>")},b.prototype.mXa=function(){var a=d.GC$("."+aa,this.JXa[0]).removeClass(L)[0];d.GC$(a).addClass(L)},b.prototype.LXa=function(){var a=this;a.JXa.bind(Xa,function(a){v(a)}).bind(Ya,function(a){v(a)}),d.GC$("."+aa,a.JXa[0]).bind(Wa,function(){var b,c=d.GC$(this).find("canvas"),e=d.GC$(this).attr(Ea),f=d.GC$(this).attr(Fa),g=!1;return c&&c.length>0?(b=c.text(),"{"===b[0]&&(b=JSON.parse(b))):b=d.GC$(this).attr(Ga),f=parseInt(f,10),0===f&&(g=!0),"more_color"===e?void a.iYa(g):void(a.EXa===V?a.hYa(b,g):a.EXa===W&&a.jYa(b,g))}).bind(Xa,function(b){d.GC$("."+aa,a.JXa[0]).removeClass(L),d.GC$(this).addClass(L),v(b)}).bind(Ya,function(a){d.GC$(this).removeClass(L),v(a)})},b.prototype.kzb=function(a){var b=0;return a.forEach(function(a,c){d.GC$(a).hasClass(H)&&(b=c)}),b},b.prototype.vXa=function(){var a,b=d.GC$("."+aa,this.JXa[0]),c=this.kzb(b);0===c?d.GC$(b.removeClass(L)[b.length-1]).addClass(L):(a=b.removeClass(L)[c-1],d.GC$(a).addClass(L))},b.prototype.wXa=function(){var a,b=d.GC$("."+aa,this.JXa[0]),c=this.kzb(b);c===b.length-1?this.mXa():(a=b.removeClass(L)[c+1],d.GC$(a).addClass(L))},b}(zb),b.ZWa=Eb,Fb=function(a){Jb(b,a);function b(b,c,d,e){var f,g=this,h=c.parent;return g=a.call(this,b,t.vl(h&&h.qo),!0)||this,f=g,f.kj=c,f.lYa=f.Cj+"_OK",f.mYa=f.Cj+"_Cancel",f.nYa=f.Cj+"_Close",f.HXa=d,f.xr=d.rowFilter,f.EXa=e,f.xo=f.yo(),g}return b.prototype.OT=function(){},b.prototype.Fva=function(){this.Ao(),this.yl(),this.oYa(),this.BPa()},b.prototype.yl=function(){},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css([D,w,x],["fixed",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.oYa=function(){var a=this,b=function(b){b.stopPropagation(),a.qYa(),a.fNJ(),a.close()};d.GC$("#"+a.lYa).bind(Wa,function(b){b.stopPropagation();var c=a.pYa();c&&(a.fNJ(),a.close())}),d.GC$("#"+a.mYa).bind(Wa,b),d.GC$("#"+a.nYa).bind(Wa,b).bind(Xa,function(){this.style.backgroundColor=_a,this.style.color=ab}).bind(Ya,function(){this.style.backgroundColor=$a,this.style.color=$a}),d.GC$("#"+a.lYa+", #"+a.mYa).bind(Xa,function(){d.GC$(this).addClass(M)}).bind(Ya,function(){d.GC$(this).removeClass(M)}),d.GC$(document).bind(Za,function(){a.BPa()})},b.prototype.PXa=function(a){var b=this.HXa,c=b.col,d=this.kj,e=b.rowFilter;Lb(c,a,d,e)},b.prototype.pYa=function(){return!0},b.prototype.qYa=function(){},b.prototype.fNJ=function(){},b}(d.Go),b.rYa=Fb,Gb=function(a){Jb(b,a);function b(b,c,d,e){var f=a.call(this,b,c,d,e)||this,g=f;return g.Vo=230,g._v=140,g.HXa=d,g.xr=g.HXa.rowFilter,g.EXa=e,g.sYa=g.tYa(),g.Fva(),f}return b.prototype.tYa=function(){var a,b,c={rank:0,item:10},d=this,e=d.xr.rZ[d.HXa.col];return e&&e.length>0&&e[0]instanceof f.Condition&&8===e[0].conType()&&(a=e[0].type(),b=e[0].expected(),c={rank:a,item:b}),c},b.prototype.yl=function(){var a=this.uYa();this.yo().html(a),this.setStyle(),this.LXa()},b.prototype.vYa=function(a){1===a.value.length?a.value=a.value.replace(/[^1-9]/g,""):a.value=a.value.replace(/\D/g,"")},b.prototype.LXa=function(){var a=this;d.GC$(ra).bind("keyup",function(){d.GC$(this).removeClass(ya),a.vYa(this)}).bind("paste",function(){d.GC$(this).removeClass(ya),a.vYa(this)})},b.prototype.pYa=function(){var a=this,b=parseInt(d.GC$("#top10-rank").val(),10),c=parseInt(d.GC$(ra).val(),10),e=new f.Condition(8),g=!1;return c?(g=!0,e.type(b),e.expected(c),a.PXa(e)):d.GC$(ra).addClass(ya).focus(),g},b.prototype.uYa=function(){var a="",b="";return b=1===this.sYa.rank?'<select id="top10-rank"><option value="0">'+yb().top+'</option><option value="1" selected = "selected">'+yb().bottom+"</option></select>":'<select id="top10-rank"><option value="0" selected="selected">'+yb().top+'</option><option value="1">'+yb().bottom+"</option></select>",a+='<div class="gc-popup ui-widget '+C+'"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span class="gc-filter-dialog-title">'+yb().Top10Filter+'</span><span id="'+this.nYa+'" class="gc-filter-dialog-close">\xd7</span></div><div id="top10-desc"><div class="top10-show-text">'+yb().Show+'</div><div class="ui-dialog-hr"></div></div><div class="top10-wrap">'+b+'<input id="top10-item" class="gc-filter-top10-rank" type="text"  value="'+this.sYa.item+'" /></div><div class="top10-footer top10-wrap"><input type="button" id="'+this.lYa+'" value="'+yb().OK+'"><input id="'+this.mYa+'" type="button" class="gc-filter-dialog-close" value="'+yb().Cancel+'"/></div></div>'},b.prototype.setStyle=function(){d.GC$(".gc-popup",this.xo[0]).css([bb,Sa,Ta],[cb,this.Vo,this._v]),d.GC$(".ui-dialog-titlebar",this.xo[0]).css({height:"34px",background:"white",fontSize:"12px",fontWeight:"normal",color:"#222",border:"none",borderRadius:"0"}),d.GC$(".gc-filter-dialog-title",this.xo[0]).css({float:"left",height:"34px",lineHeight:"34px",display:pa,marginLeft:"15px"}),d.GC$(".top10-show-text",this.xo[0]).css({float:"left"}),d.GC$(".ui-dialog-hr",this.xo[0]).css({position:"absolute",left:"24px",right:"0",margin:"0 5px",height:"12px",borderBottom:za,borderWidth:"thin"}),d.GC$("#top10-desc",this.xo[0]).css({height:"24px",lineHeight:"24px",marginLeft:"15px",position:z,fontSize:"10px"}),d.GC$("#"+this.nYa,this.xo[0]).css({float:"right",fontSize:"18px",width:"36px",height:"34px",lineHeight:"34px",textAlign:"center"}),d.GC$("#top10-rank",this.xo[0]).css({width:"120px",marginRight:"20px",height:"21px",textIndent:"5px",fontSize:"inherit",padding:"0",marginBottom:0}),d.GC$(ra,this.xo[0]).css({width:"60px",textIndent:"5px",padding:0,height:"21px",margin:0,fontSize:"inherit",display:pa}),d.GC$(".top10-wrap",this.xo[0]).css({padding:"0px 12px",textAlign:"right",color:"#9B9C9C",fontSize:"13px"}),d.GC$(".top10-footer",this.xo[0]).css({padding:"20px 12px 12px"}),d.GC$("#"+this.lYa+", #"+this.mYa).css({width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:xa,padding:0,display:pa}),d.GC$("#"+this.lYa,this.xo[0]).css({marginRight:"12px"})},b}(Fb),Hb=function(a){Jb(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e)||this,j=i;return j.Vo=416,j._v=100,j.wYa=36,j.xYa=24,j.yYa=8,j.zYa=7,j.EXa=e,j.AYa=f,j.Xba=g?0:1,typeof h!==La&&h?j.BYa=Kb(h):j.BYa=h,j.CYa=q,j.DYa=q,j.Fva(),i}return b.prototype.yl=function(){var a,b,c=this.EYa();this.xo.append(c),a=d.GC$("#color-spread-wrap",this.xo[0])[0],this.e$a=this.f$a(),b=this.FYa(a),this.GYa(a,b),this.LXa(this.CYa,this.DYa)},b.prototype.f$a=function(){return ia},b.prototype.FYa=function(a){var b=this.AYa.colorNumber,c,e,f=!1;return e=this.wYa*this.zYa+4,Math.ceil(b/this.zYa)>this.yYa?(c=this.xYa*this.zYa,f=!0,e+=20):c=this.xYa*Math.ceil(b/this.zYa),d.GC$(a).height(c),d.GC$(a).width(e),f},b.prototype.HYa=function(a,b,c){var d,e,f;a.suspendPaint(),d=a.options,e=b.options,d.showHorizontalScrollbar=!1,d.allowContextMenu=!1,d.showVerticalScrollbar=c,d.scrollbarMaxAlign=!0,d.tabStripVisible=!1,d.allowUserResize=!1,d.allowUserDragDrop=!1,d.allowUserDragFill=!1,d.allowUserZoom=!1,d.grayAreaBackColor="#fff",e.colHeaderVisible=!1,e.rowHeaderVisible=!1,e.selectionBackColor=ma,e.selectionBorderColor=ma,e.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},e.isProtected=!0,b.setColumnCount(this.zYa+2),f=this.AYa.colorNumber,b.setRowCount(Math.ceil(f/this.zYa)+1),b.defaults.rowHeight=21,b.defaults.colWidth=36,b.setColumnWidth(0,2),b.setColumnWidth(this.zYa+1,2),b.setRowHeight(0,2),a.resumePaint()},b.prototype.IYa=function(a,b){var c,d,e,f,g;b.suspendPaint(),c=(this.zYa-this.AYa.colorNumber)*this.wYa/2,b.setColumnWidth(0,c);for(g in this.AYa.data)this.AYa.data.hasOwnProperty(g)&&(f=this.JYa(d,e),d=f.row,e=f.col,this.Bba(d,e,g,b));b.resumePaint()},b.prototype.Bba=function(a,b,c,d){var e=new h.Button;e.buttonBackColor("{"===c[0]?JSON.parse(c):c),e.marginLeft(3),e.marginTop(3),e.marginRight(3),e.marginBottom(3),d.setCellType(a,b,e,3),c===this.BYa&&this.g$a(d,a,b,this.e$a)},b.prototype.JYa=function(a,b){return a===r&&b===r?(a=1,b=1):b<this.zYa?b+=1:(a+=1,b=1),{row:a,col:b}},b.prototype.KYa=function(a,b){var c,d,e,f;b.suspendPaint(),c=r,d=r;for(f in this.AYa.data)this.AYa.data.hasOwnProperty(f)&&(e=this.JYa(c,d),c=e.row,d=e.col,this.Bba(c,d,f,b));b.resumePaint()},b.prototype.g$a=function(a,b,c,e){var f,g;a.suspendPaint(),this.h$a&&(f=a.getStyle(this.h$a.row,this.h$a.col,3),f.backColor="#ffffff",f.borderLeft=new d.LineBorder(ja,d.LineStyle.empty),f.borderTop=new d.LineBorder(ja,d.LineStyle.empty),f.borderRight=new d.LineBorder(ja,d.LineStyle.empty),f.borderBottom=new d.LineBorder(ja,d.LineStyle.empty),a.setStyle(this.h$a.row,this.h$a.col,f,3)),this.h$a={row:b,col:c},g=a.getStyle(b,c,3),g.backColor=e,g.borderLeft=new d.LineBorder(ja,d.LineStyle.thin),g.borderTop=new d.LineBorder(ja,d.LineStyle.thin),g.borderRight=new d.LineBorder(ja,d.LineStyle.thin),g.borderBottom=new d.LineBorder(ja,d.LineStyle.thin),a.setStyle(b,c,g,3),a.resumePaint()},b.prototype.GYa=function(a,b){var c,e=new d.Workbook(a);e.EDc=!0,c=e.getActiveSheet(),this.CYa=e,this.DYa=c,this.HYa(e,c,b),this.AYa.colorNumber<this.zYa?this.IYa(e,c):this.KYa(e,c)},b.prototype.B_a=function(){var a,b=r;for(a in this.AYa.data)if(this.AYa.data.hasOwnProperty(a)){b=a;break}return"{"===b[0]?JSON.parse(b):b},b.prototype.EYa=function(){var a,b,c,e,f,g,h=d.GC$(s("div")).addClass("gc-popup ui-widget "+ea+" "+C+" "+B);return h.css({backgroundColor:"#f0f0f0"}),a=this.LYa(),h.append(a),b=this.MYa(),h.append(b),c=d.GC$(s("div")).css([Ua],["0 12px"]),e=this.NYa(),e!==r&&c.append(e),f=this.OYa(),c.append(f),g=this.PYa(),c.append(g),h.append(c),h.append(this.QYa()),h},b.prototype.LYa=function(){var a=d.GC$(s("div")),b=d.GC$(s("span")),c=d.GC$(s("span")).attr("id",this.nYa);return a.css([Sa,Ta,bb,Ua,Qa],["100%","34px","#fff","0 0 0 12px",na]),b.css(["float",Ta,"lineHeight",Pa],[w,"34px","34px",pa]).html(yb().ColorTitle),c.css(["float",Ta,"lineHeight",Pa,hb,Sa,"textAlign"],["right","34px","34px",pa,"18px","36px","center"]).html("\xd7").addClass(wa),a.append(b),a.append(c),a},b.prototype.MYa=function(){var a=d.GC$(s("div")),b=d.GC$(s("div")),c;return 0===this.Xba&&this.EXa===V?c=yb().SortCell:0===this.Xba&&this.EXa===W?c=yb().FilterCell:1===this.Xba&&this.EXa===V?c=yb().SortFont:1===this.Xba&&this.EXa===W&&(c=yb().FilterFont),a.css(Ua,"0 12px"),b.css([Ta,"lineHeight"],["24px","24px"]).html(c),a.append(b),a},b.prototype.NYa=function(){var a,b,c,e=r;return this.AYa[X]!==r&&(a=""===this.BYa,b=1===this.Xba?yb().Automatic:yb().NoFill,c=d.GC$(s("div")).html(b),c.attr("id","gc-color-dialog-noFill"),a?(c.attr(va,"checked"),c.css([bb,Ua,Va,"textAlign","margin"],["rgb(134,191,160)","0 12px",ua,"center","5px 0"])):c.css([bb,Ua,Va,"textAlign","margin"],[ma,"0 12px",ua,"center","5px 0"]),e=c),e},b.prototype.OYa=function(){var a=d.GC$(s("div")).attr("id","color-spread-wrap");return a.css([bb,Ua,Va,Sa,"box-sizing"],["#fff","6px","1px solid rgb(160,160,160)","288px",qa]),a},b.prototype.PYa=function(){var a,b=this,c=d.GC$(s("div")),e=d.GC$(s("div")).html(yb().Selected),f=s("canvas"),g=d.GC$(f).attr("id","gc-color-dialog-selected");return c.css([D,Ua,Qa,db,Ta],[z,"0 12px",qa,"12px 0","16px"]),e.css([y,Sa,"text-align"],[w,"60px","center"]),a=1===b.Xba?ka:la,b.BYa===r&&(b.BYa=b.B_a()),""!==b.BYa&&(a=b.BYa),g.css([D,w,Va],["absolute","70px",ua]),f.width=ib,f.height=jb,b.Ygc(g,a),c.append(e),c.append(g),c},b.prototype.Ygc=function(a,b){var c,e,f=typeof b===La?JSON.stringify(b):b;a.text(f),c=a[0].getContext("2d"),e=function(){c.fillRect(0,0,ib,jb)},d.To.setFillStyle(c,"{"===f[0]?JSON.parse(f):f,0,0,ib,jb,e)},b.prototype.pYa=function(){var a,b=d.GC$(ta);return a=1===b.length&&"checked"===b.attr(va)?"":this.BYa,this.RYa(a),!0},b.prototype.RYa=function(a){var b=0===this.Xba;this.EXa===V?this.SYa(a,b):this.EXa===W&&this.TYa(a,b)},b.prototype.SYa=function(a,b,c){var e,f,g=this,h=g.HXa,i=h.rowFilter,j=g.kj;i&&j&&j.hK()&&(c=c!==r&&c,e=h.col,f={sheet:j,sheetName:j.Cj,col:e,ascending:c,color:a,isBackColor:b,cancel:!1},j.Wq(d.Events.RangeSorting,f),f.cancel===!1&&(j.suspendPaint(),i.sortColumnByColor(e,c,a,b),j.resumePaint(),j.Wq(d.Events.RangeSorted,f)))},b.prototype.TYa=function(a,b){var c=new f.Condition(3),d=b?0:1;c.compareType(d),c.expected(a),this.PXa(c)},b.prototype.LXa=function(a,b){var c=this;d.GC$(ta).bind(Wa,function(){var a=1===c.Xba?ka:la;c.Ygc(d.GC$(sa),a),d.GC$(this).css(bb,"rgb(134,191,160)"),d.GC$(this).attr(va,"checked")}),a.bind(d.Events.ButtonClicked,function(a,e){var f,g=e.row,h=e.col,i=b.getCellType(g,h);c.g$a(b,g,h,c.e$a),f=i.buttonBackColor(),c.Ygc(d.GC$(sa),f),d.GC$(ta).css(bb,ma).attr(va,""),c.BYa=f}),a.bind(d.Events.TouchToolStripOpening,function(a,b){b.handled=!0})},b.prototype.QYa=function(){var a=d.GC$(s("div")),b=d.GC$(s("input")).attr({type:"button",value:yb().OK,id:this.lYa}),c=d.GC$(s("input")).attr({type:"button",value:yb().Cancel,id:this.mYa}).addClass(wa),e={width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:xa,padding:"0",display:pa,margin:"0"};return a.addClass("color-custom-footer").css({textAlign:"right",padding:"10px 12px 12px"}),b.css(e).css({marginRight:"12px"}),c.css(e),a.append(b[0]),a.append(c[0]),a},b}(Fb),Ib=function(a){Jb(b,a);function b(b,c,d,e,f,g,h,i,j){var k=a.call(this,b,c,d,e)||this,l=k;return l.Vo=840,l._v=260,l.HXa=d,l.xr=l.HXa.rowFilter,l.EXa=e,l.UYa=g,l.fY=f,l.VYa=h,l.WYa=j,l.XYa=i,l.YYa(g),l.Fva(),k}return b.prototype.yl=function(){var a=this,b=a.ZYa(this.sYa);a.xo.append(b),d.GC$(".gc-popup",this.xo[0]).css([bb,Sa,Ta,hb],[cb,this.Vo,this._v,"12px"]),a.LXa()},b.prototype.LXa=function(){var a=this;d.GC$(Oa).bind("change",function(){var a=d.GC$(this).find("option")[this.selectedIndex];d.GC$(this).parent().find("input").val(d.GC$(a).text()).attr("gc-data",d.GC$(this).val())}),a.fY.length>kb&&(a.fNJ=function(){var b,c=a.gNJ;if(c)for(b=0;b<c.length;b++)c[b].workbook.destroy();a.gNJ=null,d.GC$("#first-condition-expected input, #sec-condition-expected input").remove(),d.GC$(Oa).remove(),d.GC$(".gc-filter-dialog-style").remove(),d.GC$(".filter-custom-select-first-option").remove()},d.GC$(Oa).bind("mousedown",function(b){var c,e,f,g;if(b.preventDefault(),b.stopPropagation(),c=d.GC$(this).parent().find("div")[0],e=a.gNJ,c&&e)for(f="none"===c.style.display,g=0;g<e.length;g++)e[g].container===c?e[g].container.style.display=f?"block":"none":e[g].container.style.display="none"}),d.GC$(".gc-filter-dialog-style").bind("mousedown",function(b){var c,d,e=a.gNJ;for(d=0;d<e.length;d++)c=e[d].container,c.contains(b.target)||(c.style.display="none")})),d.GC$(".filter-custom-select-first-option").bind("click",function(a){a.stopPropagation(),a.preventDefault(),d.GC$(this).parent().trigger("change")}),d.GC$("#first-condition-expected input, #sec-condition-expected input").bind("change",function(){var b=d.GC$(this).val(),c=-1;a.fY.forEach(function(a,d){a.text===b&&(c=d)}),""===b&&(d.GC$(this).parent().find("select")[0].value=""),d.GC$(this).attr("gc-data",c)})},b.prototype.F_a=function(a,b,c){var d,e,f,g,h=a.val(),i=a.attr("gc-data");return 2===b&&+i===-1?h:(e=this.fY[i],e?d=2===b?e.text:e.value:11!==b||isNaN(+h)?(f={},g=new k,g.getPreferredDisplayFormatter(h,f),d=f.value):d=parseFloat(h),d)},b.prototype.pYa=function(){var a=this,b=parseInt(d.GC$("#filter-logical-wrap input:checked").val(),10),c=a.$Ya(b),e=!1;return a.PXa(c),c?e=!0:d.GC$("#first-condition-type").focus(),e},b.prototype.$V=function(a,b){var c,d,e,g,h=a.val().trim();return h?(d=parseInt(h.split("-")[0],10),c=parseInt(h.split("-")[1],10),e=this.F_a(b,c,d),g=new f.Condition(c),this.r$a(e)&&g.conType(2),g.compareType(d),"string"===n(e)&&(e=p(e)),g.expected(e),g.treatNullValueAsZero(!1),g.ignoreCase(!0),"string"===n(e)&&e.indexOf("*")===-1&&e.indexOf("?")===-1?g.useWildCards(!1):"string"!==n(e)||e.indexOf("*")===-1&&e.indexOf("?")===-1||(g.conType(2),g.useWildCards(!0)),g):q},b.prototype.$Ya=function(a){var b,c=this.$V(d.GC$("#first-condition-type"),d.GC$("#first-condition-expected input")),e=this.$V(d.GC$("#sec-condition-type"),d.GC$("#sec-condition-expected input"));return c?(e?(b=new f.Condition(0),b.compareType(a),b.item1(c),b.item2(e)):b=c,b):null},b.prototype.b$a=function(){var a=this.HXa,b=a.rowFilter,c=this.kj.getText(a.row,a.col);return b&&b.range.row<=0&&(c=this.kj.getText(a.row,a.col,a.sheetArea)),c},b.prototype.ZYa=function(a){var b,c,e,f,g,h,i;return this.gNJ=[],b=this.b$a(),c=d.GC$(s("div")).addClass("gc-popup ui-widget "+C),c.css({backgroundColor:"#f0f0f0"}),c.append(this._Ya()),c.append(this.aZa(b)),e=this.bZa("first-condition-type","first-condition-expected",a.compareType1||0,a.expected1,a.conType1,!0),c.append(e),c.append(this.cZa(a.logic)),f=this.bZa("sec-condition-type","sec-condition-expected",a.compareType2,a.expected2,a.conType2),c.append(f),f.css([D,Ua],[z,"0 0 12px 35px"]),g=d.GC$(s("div")),h=d.GC$(s("p")).html(yb().Explain1).css({margin:"0",lineHeight:"initial",backgroundColor:ma}),i=d.GC$(s("p")).html(yb().Explain2).css({margin:"0",lineHeight:"initial",backgroundColor:ma}),g.append(h),g.append(i),g.css({fontSize:"10px",textIndent:"12px"}),c.append(g),c.append(this.dZa()),c},b.prototype.bZa=function(a,b,c,e,f,g){
var h=d.GC$(s("div")),i;return h.css([D,Ua],[z,"0 0 12px 35px"]),h.append(this.eZa(c,f,g).attr("id",a)),i=this.fY.length>kb?this.hNJ(this.fY,e).attr("id",b):this.fZa(this.fY,e).attr("id",b),h.append(i),h},b.prototype._Ya=function(){var a=d.GC$(s("div")),b=d.GC$(s("span")),c=d.GC$(s("span")).attr("id",this.nYa);return a.css([Sa,Ta,bb,Ua,Qa],["100%","34px","#fff","0 0 0 12px",na]),b.css(["float",Ta,"lineHeight",Pa],[w,"34px","34px",pa]).html(yb().CustomTitle),c.css(["float",Ta,"lineHeight",Pa,hb,Sa,"textAlign"],["right","34px","34px",pa,"18px","36px","center"]).html("\xd7").addClass(wa),a.append(b),a.append(c),a},b.prototype.cZa=function(a){var b=d.GC$(s("div")),c=d.GC$(s("input")).attr({name:"filter-logical",id:"filter-dialog-and",type:"radio"}).val(1).css([Sa,Pa],["unset",pa]),e=d.GC$(s("input")).attr({name:"filter-logical",id:"filter-dialog-or",type:"radio"}).val(0).css([Sa,Pa],["unset",pa]),f=d.GC$(s("label")).attr({for:"filter-dialog-and"}).html(yb().And).css([gb,"font-weight",hb,Pa,"margin-bottom",Ua],["10px","inherit","13px",pa,"0","0"]),g=d.GC$(s("label")).attr({for:"filter-dialog-or"}).html(yb().Or).css([gb,"font-weight",hb,Pa,"margin-bottom",Ua],["10px","inherit","13px",pa,"0","0"]);return b.attr("id","filter-logical-wrap"),b.css({padding:"0 0 0 40px",height:"30px"}),0===a?(e.prop("checked",!0),c.prop("checked",!1)):(e.prop("checked",!1),c.prop("checked",!0)),b.append(c),b.append(f),b.append(e),b.append(g),b},b.prototype.aZa=function(a){var b,c,e,f=d.GC$(s("div")),g=d.GC$(s("div")).html(yb().ShowRows);return f.css(Ua,"0 12px"),g.css([Ta,"lineHeight"],["24px","24px"]),f.append(g),b=d.GC$(s("div")),c=d.GC$(s("div")),a?(e=d.GC$(s("div")).html(o(a)),e.css([y,"maxWidth","textOverflow","whiteSpace","overflow"],[w,"300px","ellipsis","nowrap","hidden"]),b.css({height:"24px",lineHeight:"24px",marginLeft:"15px",fontSize:"10px"}),c.css({overflow:"hidden",margin:"0 5px",height:"12px",borderBottom:za,borderWidth:"thin"}),b.append(e)):(b.css({height:"12px",lineHeight:"2px",marginLeft:"15px",fontSize:"10px"}),c.css({margin:"0 5px",height:"2px",borderBottom:za,borderWidth:"thin"})),b.append(c),f.append(b),f},b.prototype.eZa=function(a,b,c){var e,f,g,h,i,j,k,l=[],m=!1;for(l=6===this.VYa||5===this.VYa?wb:1===this.VYa?ub:vb,e=d.GC$(s("select")),f={height:"25px",width:"230px",marginBottom:0,marginRight:"12px",fontSize:"inherit",padding:0,boxSizing:"border-box"},e.css(f),g="<option>&nbsp;</option>",j=!1,a===r&&(g='<option selected="selected" >&nbsp;</option>'),k=0;k<l.length;k++)h=l[k].split("-"),i=!1,h[2]&&(j=!1,(b===parseInt(h[2],10)||6===this.WYa&&5===parseInt(h[2],10)||11===parseInt(h[2],10))&&(j=!0),j&&a===parseInt(h[1],10)&&(i=!0)),i?(m=!0,g+='<option selected="selected" value="'+h[1]+"-"+h[2]+'">'+yb()[h[0]]+"</option>"):g+='<option value="'+h[1]+"-"+h[2]+'">'+yb()[h[0]]+"</option>";return e[0].innerHTML=g,d.GC$("option",e[0]).css({height:"20px"}),!m&&c&&d.GC$(d.GC$("option",e[0])[1]).attr("selected","selected"),e},b.prototype.I$a=function(a){var b=o(a);return b&&b.length>100&&(b=b.substr(0,100)+"..."),b},b.prototype.fZa=function(a,b){var c,e,f,g,h,i=-1,j=b,k=d.GC$(s("div")),o=d.GC$(s("select")).addClass("filter-custom-select-input"),p=d.GC$(s("input")),r=yb().Blanks,t={height:"25px",width:"540px",margin:0,padding:0};for(k.css([D,w,"top"],["absolute","278px","0"]),p.css([D,w,x,Sa,"textIndent",Va,Ta,Qa,"outline",Ua,db],["absolute","2px","2px","518px","5px",0,"21px",na,Ra,0,0]),o.css(t),e="",f=!0,g=0;g<a.length;g++)a[g].text===r&&a[g].value===q||(h=this.I$a(a[g].text),"date"===n(a[g].value)&&(c||(c=l.q4(l.culture()).DateTimeFormat),h=m.Vb(a[g].value,c.shortDatePattern)),a[g].value+""==b+""&&(i=g,j=h),h=h.replace(/\s/g,"&nbsp;"),f?(e+='<option class="filter-custom-select-first-option" value="'+g+'">'+h+"</option>",f=!f):e+='<option value="'+g+'">'+h+"</option>");return o[0].innerHTML=e,o[0].selectedIndex=-1,"date"===n(j)&&(c||(c=l.q4(l.culture()).DateTimeFormat),j=m.Vb(j,c.shortDatePattern)),p.attr("gc-data",i).val(j),k.append(o),k.append(p),k},b.prototype.hNJ=function(a,b){var c,e,f=b,g=d.GC$(s("div")),h=d.GC$(s("div")),i=d.GC$(s("select")).addClass("filter-custom-select-input"),j=d.GC$(s("input")),k={height:"25px",width:"540px",margin:0,padding:0};return h.css([D,w,"top"],["absolute","278px","0"]),g.css([D,"top","width","height","border","display","z-index"],["absolute","25","538px","333px","solid black 1px","none",1]),j.css([D,w,x,Sa,"textIndent",Va,Ta,Qa,"outline",Ua,db],["absolute","2px","2px","518px","5px",0,"21px",na,Ra,0,0]),i.css(k),e=function(a){j.val(a)},this.iNJ(g[0],a,b,e),i[0].innerHTML='<option value="0">0</option>',"date"===n(f)&&(c||(c=l.q4(l.culture()).DateTimeFormat),f=m.Vb(f,c.shortDatePattern)),e(f),h.append(g),h.append(i),h.append(j),h},b.prototype.iNJ=function(a,b,c,e){var f,g,h,i,j,k=new d.Workbook(a,{allowContextMenu:!1,showHorizontalScrollbar:!1,showVerticalScrollbar:!0,scrollbarMaxAlign:!0,tabStripVisible:!1,allowUserResize:!1,allowUserDragDrop:!1,allowUserDragFill:!1,allowUserZoom:!1,grayAreaBackColor:"white",sheetCount:1});this.gNJ.push({container:a,workbook:k}),f=k.getActiveSheet(),g=f.options,f.suspendPaint(),g.colHeaderVisible=!1,g.rowHeaderVisible=!1,g.selectionBackColor="transparent",g.selectionBorderColor="transparent",g.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},g.isProtected=!0,f.defaults.rowHeight=17,f.defaults.colWidth=540,f.setRowCount(b.length),h=new d.Style,h.foreColor="white",h.backColor="#1E90FF",i=new d.Range((-1),0,(-1),1),f.cellStates.add(i,1,h),f.autoGenerateColumns=!1,f.bindColumn(0,"text"),f.setDataSource(b),f.setColumnCount(1),f.bind(d.Events.CellClick,function(b,c){a.style.display="none";var d=c.sheet.getValue(c.row,c.col);e(d)}),j=new d.Style,j.vAlign=1,f.setStyle(-1,0,j),f.resumePaint()},b.prototype.dZa=function(){var a=d.GC$(s("div")),b=d.GC$(s("input")).attr({type:"button",value:yb().OK,id:this.lYa}),c=d.GC$(s("input")).attr({type:"button",value:yb().Cancel,id:this.mYa}).addClass(wa),e={width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:xa,padding:0,display:pa};return a.addClass("custom-footer").css({textAlign:"right",padding:"10px 12px 12px"}),b.css(e).css({marginRight:"12px"}),c.css(e),a.append(b[0]),a.append(c[0]),a},b.prototype.YYa=function(a){var b=this,c=b.xr.rZ[b.HXa.col],d={conType1:2,conType2:r,compareType1:0,compareType2:r,expected1:r,expected2:r,logic:1};c=c&&c.length&&c[0]instanceof f.Condition?c[0]:q,b.sYa=b.gZa(d,a,c)},b.prototype._Za=function(a,b){var c,d,e=l.q4(l.culture()).DateTimeFormat,f={},g=a.expectTypeId();if(0===g)f=a.getExConditionDateScope(a.expected());else if(6===g)c=new Date,d=new Date,c.setMonth(0,1),c.setHours(0,0,0,0),d.setHours(23,59,59,999),f={from:c,to:d};else if(3===g)return b.conType1=this.WYa,b.compareType1=this.XYa,b.expected1=r,b;return b.conType1=5,b.conType2=5,b.compareType1=5,b.compareType2=2,b.expected1=m.Vb(f.from,e.shortDatePattern),b.expected2=m.Vb(f.to,e.shortDatePattern),b},b.prototype.gZa=function(a,b,c){var d,e,f,g,h,i=c&&(c.conType()===this.VYa||11===c.conType()&&(1===this.VYa||2===this.VYa)),j=c&&(c.compareType()===this.XYa||0===c.conType());return!c||1!==b||6!==c.conType()||0!==c.expectTypeId()&&6!==c.expectTypeId()&&3!==c.expectTypeId()?(d=!0,1===this.WYa&&c&&0===c.conType()&&(e=c.item1().compareType(),f=c.item2().compareType(),5===Math.max(e,f)&&3===Math.min(e,f)||(d=!1)),1===b||i&&j&&d?c&&0===c.conType()?(this.VYa=this.WYa,a.conType1=c.item1().conType(),a.conType2=c.item2().conType(),a.compareType1=c.item1().compareType(),a.compareType2=c.item2().compareType(),a.expected1=c.item1().expected(),a.expected2=c.item2().expected(),a.logic=c.compareType()):c&&0!==c.conType()&&3!==c.conType()&&(g=c.compareType(),h=c.conType(),a.conType1=h,a.expected1=c.expected(),a.compareType1=g):0===this.VYa?(this.VYa=this.WYa,1===this.WYa?(a.conType1=1,a.conType2=1,a.compareType1=3,a.compareType2=5):5===this.WYa&&(a.conType1=5,a.compareType1=5,a.conType2=5,a.compareType2=3)):1===this.VYa&&this.s$a(c)?(a.conType1=this.WYa,a.compareType1=this.XYa,a.expected1=c.expected()):(a.conType1=this.WYa,a.compareType1=this.XYa,a.expected1=r),a):this._Za(c,a)},b.prototype.r$a=function(a){return a!==r&&"TRUE"===a||"FALSE"===a},b.prototype.s$a=function(a){if(!a)return!1;var b=!1,c=a.expected();return 1===a.conType()&&this.r$a(c)&&(b=!0),b},b}(Fb)},"./dist/plugins/filter/filter-ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/filter/filter.res.en.js");b.SR={en:d}},"./dist/plugins/filter/filter-ui.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("./dist/plugins/filter/filter-dialog.js"),g=c("ConditionalFormatting"),h=c("CellTypes"),i=c("./dist/plugins/filter/filter.js"),j=c("./dist/plugins/filter/filter-button-images.js"),k=c("./dist/plugins/filter/filter-ns.js"),l=d.Common.q,m=e.Ul.lHb,n=d.Common.u.Ob,o=d.Formatter.lxb,p=e.Ul.Nl,q=e.Ul,r=q.nl,s=d.Common.k.ac,t=null,u=d.Common.j.Fa,v=parseFloat,w=e.GC$.inArray,x="gc-sortASC",y="gc-sortDES",z="gc-filterOK",A="gc-filterCancel",B="gc-filterSearch",C="gc-filterCheckAll",D="gc-filterUnCheckAll",E="gc-filter-item-container",F="gc-filter-hover",G="gc-filter-button",H="gc-filter-item-link ",I="gc-filter-sort",J="ui-state-hover ",K="gc-filter-button-hover "+J,L="gc-filter-item-hover",M=J+L,N=F+" form-control well "+M,O=" ui-corner-all ",P="ui-button-disabled",Q=" ui-state-disabled",R="gc-filter-button-disable",S="gc-sub-color-filter",T="gc-sub-content-flter",U="gc-sub-color-sort",V="gc-no-user-select",W=" gc-filter-check",X="gc-filter-check-outerDiv",Y="gc-filter-button-active",Z=".ui-filter-dialog",$="px",_="font-size",aa="string",ba="mouseout",ca="click",da="keydown",ea="keyup",fa="search",ga="input",ha="span",ia="div",ja="button",ka="DOMMouseScroll",la="mousewheel",ma="mousedown",na="mouseover",oa="mouseup",pa="margin",qa=pa+"Left",ra=pa+"Top",sa="padding",ta=sa+"Top",ua="display",va="none",wa="width",xa="height",ya="border",za="position",Aa="absolute",Ba="background-color",Ca="left",Da="top",Ea="box-sizing",Fa="content-box",Ga="block",Ha=d.Common.j.Ba,Ia=d.Common.l.Xb,Ja=d.Common.l.Ska,Ka="gc-sortASC-tr",La="gc-sortDEC-tr",Ma="gc-sort-color-tr",Na="clear_filter",Oa="gc-color-filter",Pa="gc-major_filter",Qa="gc-search-tr",Ra="gc-filter-function-tr",Sa=void 0,Ta="automatic",Ua="gc-async-process-tr",Va="TextFilter",Wa="NumberFilter",Xa="DateFilter",Ya="gc-filter-choose-area",Za="filter-button-tr",$a="gc-filter-dialog-style",_a="gc-sortColor",ab="gc-filter-color",bb="gc-clearFilter",cb="gc-majorFilter",db="gc-filterDialog-rightArrow",eb="gc-filter-disable-item",fb=500,gb=100,hb=20,ib=10,jb=30,kb=5e4,function(a){a[a.true=1]="true",a[a.false=2]="false",a[a.undefined=2]="undefined",a[a.null=3]="null"}(lb||(lb={})),function(a){a[a.false=0]="false",a[a.true=1]="true"}(mb||(mb={})),nb=new d.Common.ResourceManager(k.SR,"Filter"),ob=nb.getResource.bind(nb),pb=function(){function a(a,b,c,d,e,f,g,h){var i=this;i.rowFilter=a,i.row=b,i.col=c,i.sheetArea=d,i.x=e,i.y=f,i.width=g,i.height=h}return a.prototype.ko=function(){var a=this,b=a.rowFilter,c=a.col,d=b.getSortState(c);return b?b.isFiltered(c)?[3,4,5][d]:d:0},a}(),b.eY=pb;function sb(a,b){e.GC$(a).addClass(b)}function tb(a,b){return"object"==typeof a?JSON.stringify(a):(a=b.getColor(a),d.Common.pc.bc(d.Common.pc.ec(a)))}function ub(a,b){var c,d,e={date:0,number:1,string:2,boolean:3,blank:4},f=a.value,g=b.value,h=a.type,i=b.type;if(h!==i)return e[h]<e[i]?-1:1;if("date"===h&&"date"===i){if(c=f.getFullYear(),d=g.getFullYear(),c<d)return 1;if(c>d)return-1}return f>g?1:f<g?-1:0}function vb(a,b,c,d,e){if(a){var f=void 0;"string"==typeof a?(f=e[a],f===Sa&&(f=e[a]=tb(a,c))):f=JSON.stringify(a),b.data[f]===Sa&&b.colorNumber++,b.data[f]=d}else b[Ta]=Ta}function wb(a,b){e.GC$(a).removeClass(b)}function xb(a,b,c){a.css([wa,xa],[b+$,c+$])}function yb(a){e.GC$(a).css([ya,pa,sa,"outline"],[0,0,0,va])}function zb(a){return a.concat([])}function Ab(a,b){var c,e,f,g,h,i,j;if(u(a)||""===a||"number"==typeof a&&isNaN(a))return"blank";if(c=Ja(a),e="number"==typeof a,"General"===b||u(b)){if(c)return"date"}else if(!m(b)&&(c||e))return f=/d|D|m|M|y|Y|z|Z|g|G|e/,g=b instanceof d.Formatter.FormatterBase,h=g?b:new d.Formatter.GeneralFormatter(b),i=g?b.formatString():b,i=Bb(i),j=f.test(i)&&!(h.hasFormattedColor&&h.hasFormattedColor())&&!("General"===i||""===i||void 0===i),j?"date":"number";return Ha(a)}function Bb(a){var b,c;return a?(b=/AM\/PM/gi,c=/:mm|:m|mm:|m:/gi,a=a.replace(b,""),a=a.replace(c,"")):a}function Cb(a){var b,c,d,e="",f=!1;for(b=0,c=a.length;b<c;b++)d=a[b],'"'===d&&(f=!f),"E"===d||f||(e+=d.toLowerCase());return e}function Db(a,b,c,d,e){var f,g,h,i,j,k;if(b&&a)return f=a.format(c),j=[],f&&(k=f.split("/"),g=k[0]||"",h=k[1]||"",i=k[2]||""),j.push({value:g,level:0,status:d}),j.push({value:h,level:1,status:d}),j.push({value:i,level:2,status:d}),{key:b,value:c,children:j,status:d,type:e}}function Eb(a,b,c,d,e,f,g,h){var i,j;if(b)return i=[],i.push({value:b,level:a.outlineColumn&&a.outlineColumn.XQa(e)?a.getCell(d,e).textIndent():0,status:f}),j=a.ODJ,j&&j.t7J&&a.outlineColumn&&a.outlineColumn.XQa(e)&&(i[0].level=j.t7J(d),u(h)||(i[0].status=f=lb[!h])),{key:b,value:c,children:i,status:f,type:g}}function Fb(a){var b,c,e,f,g,h,i,j,k,l,m;if(u(a)&&(a=""),b=new d.Formatter.GeneralFormatter(a),c=b.formatters,c&&!(c.length<=0)&&(e=c[0]))return f=d.Common.CultureManager.getCultureInfo(),g=f&&f.id,h=e.localeIDFormatPart,i=e.dbNumberFormatPart,j=h&&h.Wc||g,k=d.Common.CultureManager.LZa(j,Cb(a)),l=h&&h.Kc||"",m=i&&i.Kc||"",new d.Formatter.GeneralFormatter(m+l+k)}qb=function(a){rb(b,a);function b(b,c,d,e){var f,g=this,h=c.parent;return g=a.call(this,b,q.vl(h&&h.qo))||this,f=g,f.pxb={},f.fY=[],f.hY=[],f.gY=[],f.CWa=[],f.a$a=[],f.qLb=[],f.rLb=[],f.sLb=!1,f.jNJ=0,f.tLb=!1,f.DWa={Number:0,Text:0,Date:0},f.EWa="",f.FWa=t,f.sheet=c,f.filterButtonInfo=d,f.lY=237,f.mY=410,f.U$a=26,f.nY=191,f.oY=150,f.lzb=1.2,f.rEscape=/[\-\[\]{}()+.,\\\^$|#\s]/g,f.elementList=[],f.activeItemIndex=t,f.xo=f.yo(),f.GWa=f.HWa(),f.IWa=f.K8J(),f.V$a=e,f.W$a=f.X$a(),f.wY(),f.xY(),g}return b.prototype.X$a=function(){var a=this,b=[],c=this.V$a,d=a.mY,e=a.U$a;return c.sortByValue?b=b.concat([1,1]):(b=b.concat([0,0]),d-=2*e),c.sortByColor?b=b.concat([1]):(b=b.concat([0]),d-=e),c.filterByValue===!0||c.filterByColor===!0?b=b.concat([1]):(b=b.concat([0]),d-=e),c.filterByColor===!0?b=b.concat([1]):(b=b.concat([0]),d-=e),c.filterByValue===!0?b=b.concat([1]):(b=b.concat([0]),d-=e),c.listFilterArea===!0?b=b.concat([1,1,1,1]):(b=b.concat([0,0,0,0]),d-=254),a.mY=d,b},b.prototype.OT=function(){var a,b=this,c=b.sheet.parent,d=b.filterButtonInfo,f=b.V$a,g=b.xo;b.yY=!!c&&c.options.useTouchLayout,(f.filterByValue||f.listFilterArea||f.sortByColor||f.filterByColor)&&(b.zY(d.col),b.kNJ(),b.KWa(),b.LWa()),1===e.GC$("#"+Pa).length&&(b.MWa=b.NWa(e.GC$("#"+Pa)[0].children[2]),b.MWa.OWa(b.EWa).ad()),1===e.GC$("#"+Oa).length&&(b.PWa=b.QWa(e.GC$("#"+Oa)[0].children[2],S),b.PWa.ad()),1===e.GC$("#"+Ma).length&&(b.RWa=b.QWa(e.GC$("#"+Ma)[0].children[2],U),b.RWa.ad()),g.hide(),b.Ao(function(){b.elementList.length>0&&e.GC$(b.elementList[0]).focus()}),b.BY(b.yY),a=d.x+d.width-g.width()-6,a<5&&(a=5),g.css([Ca,Da],[a,d.y+d.height]),b.Do(),b.QQ(),b.MY(),setTimeout(function(){b.xo.focus()}),b.sheet.mm.uC()},b.prototype.Do=function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.xo;0!==m.length&&(a=l.sheet.parent,b=l.filterButtonInfo,c=a.getHost().getBoundingClientRect(),d=m[0].getBoundingClientRect(),e=parseInt(m.css("left"),10),f=parseInt(m.css("top"),10),g=d.width,h=d.height,isNaN(e)||isNaN(f)||isNaN(g)||isNaN(h)||(i=0,j=c.height,k=!1,f+h>j&&(i=f+h-j),i>0&&(b.y-h>0?f=b.y-h:(f-=i,k=!0)),f<0&&!k&&(f=0),m.css({left:e+"px",top:f+"px"})))},b.prototype.$WJ=function(){if(1===e.GC$("#"+Pa).length){var a=e.GC$("#"+Pa)[0];e.GC$(a).addClass(eb+Q)}},b.prototype.kNJ=function(){var a=this;a.itemList&&a.itemList.length>0?a.AY(a.dataSource):a.sheet.endEdit()},b.prototype.BY=function(a){var b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=this;a&&(b=u.lY*u.lzb,c=u.mY*u.lzb,d=b-u.lY,f=c-u.mY,xb(u.xo,b,c),g=e.GC$("."+I),h=v(g.css(ta))+f/30,i=e.GC$("."+G),j=v(i.css(wa))+d/4,k=v(i.css(xa))+f/8,l=e.GC$("#"+z),m=v(l.css(qa))+d/2,n=e.GC$("#"+B),o=v(n.css(wa))+d,p=v(n.css(xa))+f/8,q=e.GC$("."+X),r=v(q.css(ra))+f/10,s=e.GC$("#"+D),t=v(s.css(qa))+d,g.css(sa,h+$+" 6px"),xb(i,j,k),l.css(qa,m+$),xb(n,o,p),q.css(ra,r+$),s.css(qa,t+$))},b.prototype.close=function(){var b=this,c=b.sheet;b.xo.hide(),b.hXa&&(b.hXa.no(),b.hXa=null),a.prototype.close.call(b),e.GC$(b.CY).remove(),e.GC$(b.DY).remove(),c.GZ=null,c&&c.zt()},b.prototype.Y$a=function(){1===e.GC$("#"+Ka).length&&this.Z$a(),1===e.GC$("#"+Ma).length&&this.$$a()},b.prototype.Z$a=function(){var a=this,b=a.elementList,c=a.EY(x,ob().SortAscending),d=a.EY(y,ob().SortDescending),f=e.GC$("#"+Ka)[0],g=e.GC$("#"+La)[0];e.GC$(f.children[0]).append(e.GC$(p("img")).attr("src",j.getFilterButtonImageSrc(6))),e.GC$(g.children[0]).append(e.GC$(p("img")).attr("src",j.getFilterButtonImageSrc(7))),e.GC$(f.children[1]).append(c),e.GC$(g.children[1]).append(d),b.push(f),b.push(g)},b.prototype.$$a=function(){var a=this,b=a.elementList,c=a.EY(_a,ob().SortColor),d=e.GC$("#"+Ma)[0],f=a.SWa(),g=this.TWa(f),h=e.GC$(p("span"));h.addClass(db),e.GC$(d.children[0]).append(g),e.GC$(d.children[1]).append(c),e.GC$(d.children[2]).append(h),b.push(d)},b.prototype._$a=function(a){var b,c=this,d=c.elementList,f=c.EY(ab,ob().FilterColor),g=e.GC$("#"+Oa)[0],h=e.GC$(p("span"));h.addClass(db),b=this.TWa(a.isShowColorFilterSelect),e.GC$(g.children[0]).append(b),e.GC$(g.children[1]).append(f),e.GC$(g.children[2]).append(h),d.push(g)},b.prototype.a_a=function(a){var b,c,d=this,f=d.sheet,g=d.filterButtonInfo.col,h=d.TWa(a.isShowMajorCheck),i=e.GC$("#"+Pa)[0],j=f.outlineColumn&&f.outlineColumn.XQa(g);j&&e.GC$(i).addClass(eb+Q),e.GC$(i.children[0]).append(h),b=d.EY(cb,""),b.appendTo(i.children[1]),c=e.GC$(p("span")),c.addClass(db),e.GC$(i.children[2]).append(c),d.elementList.push(i)},b.prototype.b_a=function(){var a,b,c,d,f=1===e.GC$("#"+Oa).length,g=1===e.GC$("#"+Pa).length;(f||g)&&(a=this,b=a.elementList,c=e.GC$("#"+Na)[0],a.UWa(c),b.push(c),d=a.VWa(),f&&a._$a(d),g&&a.a_a(d))},b.prototype.c_a=function(){var a=this;a.V$a.listFilterArea&&(a.d_a(),a.lNJ(),a.e_a(),a.L8J())},b.prototype.L8J=function(){var a=G+" gc-filter-button-default ui-button ui-state-default"+O+"btn btn-default",b=e.GC$("#"+Za)[0],c=p(ja),d=p(ja),f=e.GC$(c).text(ob().OK).css(_,"1em").attr("id",z),g=e.GC$(d).text(ob().Cancel).css(_,"1em").attr("id",A);sb(c,a),sb(d,a),e.GC$(b.children[1]).append(f).append(g),this.elementList.push(c),this.elementList.push(d)},b.prototype.lNJ=function(){var a,b,c=this,d=e.GC$("#"+Ua),f=d[0].children[1];d.css([ua,za],[va,Aa]),a=e.GC$(p(ha)).css([wa,xa,pa,ya,ua],[c.nY,2,"-5px 0 0 4px","solid 1px #A7ABB0",Ga]),b=c.mNJ=e.GC$(p(ha)).css([wa,xa,Ba,ua],[0,2,"#A7ABB0",Ga]),e.GC$(a).append(b),e.GC$(f).append(a)},b.prototype.e_a=function(){var a,b=this,c=b.VWa(),d=e.GC$("#"+Ya)[0],f=e.GC$(p("img")).attr("src",j.getFilterButtonImageSrc(11)).addClass("gc-filter-checked");f.css(["verticalAlign","margin-top"],["top","4px"]),c.isShowSelectCheck||f.css([ua],[va]),a=b.itemList=e.GC$(p(ia)).css([wa,xa,Ea],[b.nY,b.oY,Fa]),sb(a[0],E),e.GC$(d.children[0]).append(f).css([ua],["inline-block"]),e.GC$(d.children[1]).append(a)},b.prototype.d_a=function(){var a,b,c,d=this,f=e.GC$(p(ia)).css([pa,sa],[0,0]),g=e.GC$(p(ia)).appendTo(f),h=e.GC$("#"+Qa)[0],i=e.GC$(p(ga)).attr({type:fa,placeholder:ob().Search,id:B}).appendTo(g);sb(f[0],"gc-search-outer-div ui-widget-header"+O+"ui-multiselect-header ui-helper-clearfix"),d.elementList.push(i[0]),a=e.GC$(p(ia)).appendTo(f),b=d.FY(C,ob().CheckAll,"gc-check-image ui-icon ui-icon-check"),c=d.FY(D,ob().UncheckAll,"gc-uncheck-image ui-icon ui-icon-closethick"),sb(a[0],X),a.append(b).append(c),e.GC$(h.children[1]).append(f),d.elementList.push(b[0]),d.elementList.push(c[0])},b.prototype.xY=function(){var a=this;a.Y$a(),a.b_a(),a.c_a()},b.prototype.NWa=function(a){var b=this,c=t;switch(this.EWa){case Wa:c=new f.WWa(a,b.xo,b.filterButtonInfo,b.sheet,b,T);break;case Va:c=new f.XWa(a,b.xo,b.filterButtonInfo,b.sheet,b,T);break;case Xa:c=new f.YWa(a,b.xo,b.filterButtonInfo,b.sheet,b,T)}return c},b.prototype.QWa=function(a,b){var c=this,d=t;return b===S?d=new f.ZWa(a,c.xo,c.filterButtonInfo,c.sheet,c,S):b===U&&(d=new f.ZWa(a,c.xo,c.filterButtonInfo,c.sheet,c,U)),d},b.prototype.SWa=function(){var a=this,b=a.filterButtonInfo,c=b.rowFilter,d=!1,e=c.zZ;return e!==t&&e.color!==Sa&&b.col===e.index&&(d=!0),d},b.prototype.TWa=function(a){var b=e.GC$(p("div")),c=e.GC$(p("img")).attr("src",j.getFilterButtonImageSrc(11)).addClass("gc-filter-checked");return a||c.css([ua],[va]),b.append(c),b},b.prototype.HWa=function(){var a=this,b=a.filterButtonInfo,c=b.rowFilter,d=b.col,e=a.sheet.getText(a.filterButtonInfo.row,d,b.sheetArea),f=c&&c.qmK();return f&&f.row<=0?e=a.sheet.getText(b.row,d,b.sheetArea):e||(e=a.sheet.getText(0,d,1)),""===e&&1===a.sheet.options.colHeaderAutoText?e="(Column "+(d+1)+")":""===e&&(e="(Column "+q.xq(d+1)+")"),e='"'+e},b.prototype.UWa=function(a){var b=this,c;b.IWa?(c=j.getFilterButtonImageSrc(12),e.GC$(a).addClass("gc-filter-item")):(c=j.getFilterButtonImageSrc(13),e.GC$(a).addClass(eb+Q)),e.GC$(a.children[0]).append(e.GC$(p("img")).attr("src",c).css([wa],["18px"])),b.v$a(bb,b.GWa,e.GC$(a.children[1]))},b.prototype.i$a=function(a){var b=a.conType();return 0===b&&0===a.item1().compareType()&&0===a.item2().compareType()&&5===a.item1().conType()&&5===a.item2().conType()},b.prototype.VWa=function(){var a,b,c,d=this,e=!1,f=!1,h=!1,i=d.filterButtonInfo,j=i.col,k=i.rowFilter,l=k.rZ[j];return l&&l.length>0&&(l=l[0],l instanceof g.Condition?(a=l.conType(),b=l.compareType(),0===b&&3!==a&&d.V$a.listFilterArea?h=!0:0!==b||3===a||d.V$a.listFilterArea?0!==b&&3!==a?e=!0:3===a&&(f=!0):e=!0,c=this.i$a(l),(5===a&&0===b||c)&&(h=!1,e=!0)):h=d.V$a.listFilterArea),{isShowColorFilterSelect:f,isShowMajorCheck:e,isShowSelectCheck:h}},b.prototype.K8J=function(){var a=this,b=!1,c=a.filterButtonInfo,d=c.col,e=c.rowFilter,f=e.rZ[d];return f&&f.length>0&&(b=!0),b},b.prototype.$Wa=function(){var a=Math.max(this.DWa.Date,this.DWa.Number,this.DWa.Text);return a===this.DWa.Text?Va:a===this.DWa.Number?Wa:a===this.DWa.Date?Xa:void 0},b.prototype.KWa=function(){var a,b,c=this.$Wa();this.EWa=c,a=ob()[c],b=e.GC$("#"+cb),b.text(a)},b.prototype.nNJ=function(a){var b=this,c=b.nY*a,d=e.GC$(b.mNJ);d.css([wa],[c])},b.prototype.oNJ=function(a){var b=e.GC$("#"+Ua);b.css([ua],[a?Ga:va])},b.prototype.WW=function(){var a,b,c=this,d=c.filterButtonInfo,e=this.sheet,f=d.col,g=d.rowFilter;g&&(a=g.sj?g.sj.name():Sa,b={tableName:a,colIndex:f},e.wu().execute({cmd:"clearFilter",sheetName:e.name(),cmdOption:b}),c.close())},b.prototype.LWa=function(){var a,b=!1,c=this._Wa,d=this.aXa,e=c.colorNumber,f=d.colorNumber;c.automatic&&e++,d.automatic&&f++,(e!==Sa&&e>1||f!==Sa&&f>1)&&(b=!0),a=this.VWa(),b||(!a.isShowColorFilterSelect&&this.bXa(Oa),!this.SWa()&&this.bXa(Ma))},b.prototype.bXa=function(a){var b=e.GC$("#"+a).addClass(eb+Q);b.find("."+db)},b.prototype.wY=function(){var a,b,c,d,f,g,h,i=this,j=i.xo,k=" gc-sort-container ui-menu-item",l=i.table=e.GC$(p("table")).css([sa,ua],[0,"table"]).attr({cellspacing:0,cellpadding:0});for(sb(l[0],"gc-layout-table"),c=[Ka,La,Ma,Na,Oa,Pa,Qa],d=i.W$a,a=0;a<10;a++)if(1===d[a])for(f=p("tr"),g=e.GC$(f).appendTo(l),a<6&&(e.GC$(f).attr("id",c[a]).css([ua,xa,_],["table-row","26px","9pt"]),e.GC$(f).addClass(Ra)),6===a&&e.GC$(f).attr("id",c[a]),7===a&&e.GC$(f).attr("tabindex",0).attr("id",Ya),8===a&&e.GC$(f).attr("id",Ua),9===a&&e.GC$(f).attr("id",Za),yb(f),b=0;b<3;b++)h=p("td"),e.GC$(h).appendTo(g),yb(h),0===b?sb(h,"gc-layout-table-first-column"):2===b?sb(h,"gc-layout-table-last-column"):1===b&&(0===a?sb(h,"gc-filter-sort-asc-container"+k+"gc-layout-table-middle-column"):1===a&&sb(h,"gc-filter-sort-desc-container"+k+"gc-layout-table-middle-column"));i.table.appendTo(j),j.css(["box-shadow",wa,xa,Ea],["rgba(0, 0, 0, 0.15) 2px 4px 5px",i.lY+$,i.mY+$,Fa]),sb(j[0],$a+" "+V),j.appendTo(i.zo())},b.prototype.QQ=function(){var a,b,c,d,f=this,g=!1,h=!1,i=e.GC$("."+G);e.GC$("#"+Ka).bind(oa,function(a){g&&(g=!1,f.JY(!0),f.close(),r(a))}).bind(ma,function(a){r(a),g=!0}),e.GC$("#"+La).bind(oa,function(a){h&&(h=!1,f.JY(!1),f.close(),r(a))}).bind(ma,function(a){r(a),h=!0}),e.GC$("."+Ra).bind(na,function(){f.MWa&&e.GC$(this).attr("id")!==Pa&&f.MWa.cXa()&&(f.MWa.hT(),f.FWa=t,wb(e.GC$("#"+Pa)[0],N)),f.PWa&&e.GC$(this).attr("id")!==Oa&&f.PWa.cXa()&&(f.PWa.hT(),f.FWa=t,wb(e.GC$("#"+Oa)[0],N)),f.RWa&&e.GC$(this).attr("id")!==Ma&&f.RWa.cXa()&&(f.RWa.hT(),f.FWa=t,wb(e.GC$("#"+Ma)[0],N)),!e.GC$(this).hasClass(Q.trim())&&e.GC$(this).index()<6&&sb(this,N)}).bind(ba,function(){f.MWa&&e.GC$(this).attr("id")===Pa&&(clearTimeout(a),f.MWa.cXa())||f.PWa&&e.GC$(this).attr("id")===Oa&&(clearTimeout(b),f.PWa.cXa())||f.RWa&&e.GC$(this).attr("id")===Ma&&(clearTimeout(c),f.RWa.cXa())||wb(this,N)}),e.GC$("#"+Na).bind(ca,function(){f.IWa&&f.WW()}),e.GC$("#"+Pa).bind(na,function(){e.GC$(this).hasClass(eb)||(a=setTimeout(function(){f.FWa=f.MWa,f.FWa.Ao()},fb))}),e.GC$("#"+Oa).bind(na,function(){e.GC$(this).hasClass(eb)||(b=setTimeout(function(){f.FWa=f.PWa,f.FWa.Ao()},fb))}),e.GC$("#"+Ma).bind(na,function(){e.GC$(this).hasClass(eb)||(c=setTimeout(function(){f.FWa=f.RWa,f.FWa.Ao()},fb))}),e.GC$("#"+C).bind(ma,function(a){r(a)}).bind(oa,function(a){f.KY(a,!0)}),e.GC$("#"+D).bind(ma,function(a){r(a)}).bind(oa,function(a){f.KY(a,!1)}),e.GC$("#"+B).bind(da,function(a){13===(a.which||a.keyCode)&&a.preventDefault()}).bind(ea,function(a){w(a.keyCode,[9,37,38,39,40])<0&&(f.NY(),f.MY())}).bind(fa,function(a){f.NY(),f.MY()}),i.bind(na,function(){sb(this,K)}).bind(ba,function(){wb(this,K)}),i.bind(ma,function(){wb(this,K),sb(this,Y)}).bind(ba,function(){wb(this,Y)}),e.GC$("#"+z).bind(ca,function(){var a,b,c,d,e,g,h,i=f.filterButtonInfo,j=i.rowFilter;if(f.pNJ===!1?(j.eNJ=!0,f.qNJ()):(f.dXa(),f.pNJ===!0?j.HXJ=!0:f.sheet.ODJ&&(j.eNJ=!0)),a=f.qLb,b=[],c=f.hY,d=a.length,e=c.length,f.sLb){for(g=0;g<(d>e?d:e);g++)c[g]&&b.push(c[g]),!a[g]||a[g].repeat||a[g].noCheck||b.push(a[g]);f.hY=b}h=f.hY,f.sheet.suspendPaint(),f.PY(h),f.sheet.resumePaint(),f.close()}),e.GC$("#"+A).bind(ca,function(){f.close()}),f.xo.bind(la,function(a){r(a)}).bind(ka,function(a){r(a)}).bind(da+Z,function(a){f.QY(a)}).bind(ea+Z,function(a){r(a)}),f.itemList&&f.itemList.length>0&&(f.hXa.bind(e.Events.TopRowChanged,function(a,b){f.fXa(b)}),d=function(a,b){f.pNJ===!1?f.rNJ(b):f.gXa(b)},f.hXa.bind(e.Events.CellClick,d),f.hXa.bind(e.Events.CellChanged,d),f.hXa.bind(e.Events.TouchToolStripOpening,function(a,b){b.handled=!0}))},b.prototype.fXa=function(a){var b,c,d,e,f,g,h,i,j;a.oldTopRow>a.newTopRow||(b=this,c=a.sheet,d=c.parent,e=a.newTopRow,f=c.jt(1).length,g=b.itemList.width(),h=b.iXa,i=c.getColumnWidth(h),d.options.showVerticalScrollbar&&(g-=22),j=Math.max(c.getColumnCount()*i,g),b.PZa(c,j,i,e,f))},b.prototype.PZa=function(a,b,c,d,f,g){var h,i,j,k,l,m,n=0,o=0,p=this,q=a.parent,r=p.iXa,s=d+f,t=p.pNJ;for(t!==!1&&(h=a.outlineColumn.WZa()),i=Math.min(s,a.getRowCount()),j=d;j<i;j++)k=g&&g[j].name||a.getText(j,r),l=t===!1?jb:h[j].cellContent.left,m=e.Vn.Xn(k),o=m+l-b,o>0&&o>n&&(n=o);n>0&&(a.addColumns(a.getColumnCount(),Math.ceil(n/c)),q.options.showHorizontalScrollbar=!0)},b.prototype.gXa=function(a){var b,c,d,f,g,h,i,j,k,l,m,n=this,o=a.sheet,q=a.row,r=a.sheetArea,t=n.iXa;n.activeItemIndex=q,b=n.eXa.outlineColumn.getCheckStatus(),"add_current"===n.dataSource[0].key&&0===q&&(n.sLb=1===b[0]),o.suspendPaint(),!a.ignoreClick&&o.yt&&(c=o.yt.cellTypeHitInfo,d=c&&c.outlineColumnHitInfo,f=d&&d.indicator,f||(o.outlineColumn.getCheckStatus(q,t)===n.dataSource[q].status&&(g=o.outlineColumn,g.setCheckStatus(q,n.MZa(n.dataSource[q].status))),n.DZa())),o.CH&&o.m_a("transparent"),h=e.GC$("."+L,this.xo[0]),s(h)>0?wb(h,M):n.jXa(o),i=o.getStyle(q,t,r),j=i&&i.clone()||new e.Style,k=e.GC$(p(ia)),sb(k,N),this.xo.append(k),l=k.css("backgroundColor"),m=k.css("color"),k.remove(),j.backColor=l,j.foreColor=m,o.setStyle(q,-1,j),o.resumePaint(),n.dXa(),n.MY()},b.prototype.rNJ=function(a){var b,c,d,f,g,h,i,j,k,l,m,n=this,o=a.sheet,q=a.row,r=a.sheetArea,t=n.iXa,u=a.col;n.activeItemIndex=q,b=n.CWa,c="add_current"===n.dataSource[0].key,d=c&&0===q,d&&(0===u?n.sLb=!!this.dataSource[0].status:(n.sLb=!!!this.dataSource[0].status,this.dataSource[0].status=n.sLb?1:0)),f=c?q-1:q,o.suspendPaint(),!a.ignoreClick&&o.yt&&(g=void 0,0===u?g=a.newValue?1:0:d||(g=b[f].status?0:1,this.dataSource[q].status=g),d||(b[f].status=g,n.jNJ+=g?1:-1)),o.CH&&o.m_a("transparent"),h=e.GC$("."+L,this.xo[0]),s(h)>0?wb(h,M):n.jXa(o),i=o.getStyle(q,t,r),j=i&&i.clone()||new e.Style,k=e.GC$(p(ia)),sb(k,N),this.xo.append(k),l=k.css("backgroundColor"),m=k.css("color"),k.remove(),j.backColor=l,j.foreColor=m,o.setStyle(q,-1,j),o.resumePaint(),n.MY()},b.prototype.DZa=function(){for(var a=this,b=a.eXa,c=b.outlineColumn,d=c.getCheckStatus(),e=0;e<d.length;)a.dataSource[e].status=d[e],e++},b.prototype.MZa=function(a){return 1===a?2:1},b.prototype.jXa=function(a){var b,c,d=a.getRowCount();for(b=0;b<d;b++)if(c=a.getStyle(b,-1),c&&(c.backColor||c.foreColor)){c.foreColor=c.backColor=void 0,a.setStyle(b,-1,c);break}},b.prototype.sNJ=function(a){for(var b=this,c=b.dataSource,d=0,e=b.CWa,f=c[0]&&"add_current"===c[0].key?1:0;d<e.length;)c[d+f].status=a,e[d].status=a,d++},b.prototype.dXa=function(){var a,b,c,d,e,f,g,h=this,i=h.eXa.outlineColumn.getCheckStatus(),j=0,k=h.gY||h.hY,l=h.CWa,m=0;for(h.sLb=1===i[0],"add_current"===h.dataSource[0].key&&(j=1),h.hY=[],b=0;b<l.length&&(a=l[b],!(m>=k.length));b++)if(a.key===k[m].text){for(m++,c=a.children,d=Sa,e=0;e<c.length;e++)f=c[e],g=i[j],f.show!==!1&&(j+=1),d=g||d,3!==g&&(f.status=g);2!==d?h.hY.push({text:a.key,value:a.value,type:a.type}):h.tNJ(b,a)}},b.prototype.qNJ=function(){var a,b,c,d,e,f,g,h=this,i=h.gY||h.hY,j=h.CWa,k=0;for("add_current"===h.dataSource[0].key&&(h.sLb=!!h.dataSource[0].status),h.hY=[],b=h.filterButtonInfo,c=b.col,d=b.rowFilter,e=d.uNJ,e[c]=[],f=0;f<j.length&&(a=j[f],!(k>=i.length));f++)a.key===i[k].text&&(k++,g=a.status,g?h.hY.push({text:a.key,value:a.value,type:a.type}):(h.tNJ(f,a),e[c].push(a.key)))},b.prototype.tNJ=function(a,b){var c,d=this,e=d.rLb;if(e[a])if(e[a].value===b.value)d.rLb[a]=null;else for(c=a+1;c<e.length;){if(e[c]&&e[c].value===b.value){d.rLb[c]=null;break}c++}},b.prototype.KY=function(a,b){var c,d,e,f,g=this,h=g.eXa,i=g.gY;h.suspendPaint(),g.hY=b?zb(i):[],!b&&g.sLb&&(g.sLb=!1),d=lb[b],g.pNJ===!1?(c=mb[b],g.sNJ(c),g.jNJ=b?i.length:0):(e=h.outlineColumn,e&&(e.Wlb(d),g.DZa(),b&&g.tLb&&(f=e.Kia.QR[0],f&&f.checkBox&&(e.Kia.QR[0].checkBox.checkStatus=0),e.refresh()))),h.resumePaint(),g.MY(),r(a)},b.prototype.kXa=function(a){switch(a){case Pa:this.FWa=this.MWa;break;case Oa:this.FWa=this.PWa;break;case Ma:this.FWa=this.RWa}},b.prototype.lXa=function(a){var b=this;b.FWa=a,b.FWa.Ao(),b.FWa.mXa()},b.prototype.nXa=function(a){var b,c,d,f=s(a);0!==f&&(b=this,c=a.attr("id"),d=c===Ka,1===f?d||c===La?(b.JY(d),b.close()):c===A?b.close():c===Pa?b.FWa!==t?b.FWa.oXa():b.lXa(b.MWa):c===Oa?b.lXa(b.PWa):c===Ma?b.lXa(b.RWa):c===Na?b.WW():e.GC$("#"+z).trigger(ca):2===s(a)||3===s(a)?b.FWa&&b.FWa.oXa():e.GC$("#"+z).trigger(ca))},b.prototype.GUJ=function(a,b){var c,d,e,f,g=this;return!(!a[0]||"INPUT"===a[0].nodeName)&&(s(a)?(g.FWa===t&&g.kXa(b),
g.FWa===t||g.FWa.P$a||g.FWa.uXa(),a.trigger(ma),a.trigger(oa),a.trigger(ca)):u(this.activeItemIndex)||(c=g.eXa,d=this.activeItemIndex,e=0,c.outlineColumn.getCheckStatus(d,e)===g.dataSource[d].status&&(f=c.outlineColumn,f.setCheckStatus(d,g.MZa(g.dataSource[d].status))),g.DZa()),!0)},b.prototype.pXa=function(){var a,b,c,d,e=this,f=e.CWa,g=e.gY,h=0,i=[];for(a=0;a<f.length;a++)if(!u(g[h])&&f[a].key===g[h].text)for(h++,b=f[a].children,c=0;c<b.length;c++)d=b[c],d.show!==!1&&i.push(d.value||f[a].key);return i},b.prototype.qXa=function(a,b,c){var d,e,f=this,g=f.elementList;return!s(b)&&u(f.activeItemIndex)?d=g[0]:(s(b)?wb(b,M):f.jXa(f.eXa),e=f.pXa(),d=4===a?f.rXa(e,b,c):f.sXa(e,b,a)),d},b.prototype.sXa=function(a,b,c){var d,e,f,g,h=this,i=h.elementList,j=b[0],k=i.length-2,l=zb(i),m=h.activeItemIndex||0,n=0;for(e=0;e<s(a);e++)l.splice(-2,0,a[e]);if(f=j?w(j,l):k+m,g=3===c,f>=0){for(d=g?l[f+1]:l[f-1],m=m||0,n=g?f+1:f-1,w(d,a)>=0&&s(b)>0&&(f=g?f+m:m+(i.length-2),d=g?l[f+1]:l[f],n=g?f+1:f);g&&f<s(l)&&h.RY(d);)n=f+1,f+=1,d=l[f+1];if(!g){for(;f>0&&h.RY(d);)n=f-1,f-=1,d=l[f-1];d||(d=l[s(l)-1])}d||(d=l[0])}return typeof d===aa?n-k:d},b.prototype.rXa=function(a,b,c){var d,e,f=this,g=f.elementList,h=b[0],i=zb(g),j=f.activeItemIndex||0;if(i.splice(-2,0,a[j]),s(b)){if(e=w(h,i),e>=0){for(d=c?i[e-1]||i[s(i)-1]:i[e+1];c&&e>0&&f.RY(d);)e-=1,d=i[e-1];for(;!c&&f.RY(d)&&e<s(i);)e+=1,d=i[e+1]}}else d=c?g[g.length-3]:f.RY(g[g.length-2])?g[g.length-1]:g[g.length-2];return d||(d=i[0]),typeof d===aa?j:d},b.prototype.QY=function(a){var b,c,d,f=this,g=e.GC$("."+L,f.xo[0]),h=a.which||a.keyCode,i=w(h,[27,13,38,40,9,37,39,32]);if(g.length>0&&(b=g.attr("id")),0===i)f.close(),r(a);else if(1===i)this.nXa(g);else if(i>4){if(5===i)f.FWa===t&&f.kXa(b),f.FWa!==t&&(f.FWa=f.FWa.tXa());else if(6===i)f.FWa===t&&f.kXa(b),f.FWa===t||f.FWa.P$a||f.FWa.uXa();else if(7===i&&!this.GUJ(g,b))return;r(a)}else i>1&&f.FWa!==t&&f.FWa.cXa()?(2===i||4===i&&a.shiftKey?f.FWa.vXa():(3===i||4===i&&!a.shiftKey)&&f.FWa.wXa(),r(a)):i>1&&(c=f.qXa(i,g,a.shiftKey),"number"==typeof c?(g=c,f.gXa({sheet:f.eXa,row:g,sheetArea:3,ignoreClick:!0}),f.eXa.Yq(g,f.iXa),e.GC$("#"+Ya).focus(),r(a)):(g=e.GC$(c),d=g.attr("id"),d!==B&&d!==z&&d!==A&&d!==C&&d!==D?g.find("i").focus():g.focus(),sb(g,F+" "+M),r(a)))},b.prototype.RY=function(a){return typeof a!==aa&&(a=e.GC$(a),0!==s(a)&&!!(a.hasClass(P)||a.hasClass(Q)||a.hasClass(R)))},b.prototype.PY=function(a){var b,c,d,e,f,g=this,h=g.sheet;if(h)try{if(h.suspendPaint(),b=g.filterButtonInfo,c=b.rowFilter,!c)return;d=b.col,e=c.sj?c.sj.name():Sa,f={tableName:e,colIndex:d,checkedValues:a,allValuesLength:s(g.fY)},h.wu().execute({cmd:"filterTextSelectAction",sheetName:h.name(),cmdOption:f})}finally{h.resumePaint()}},b.prototype.NY=function(){var a,b,c,d,f,g,h,i,j,k,m,n,o,p,q,r=this,t=e.GC$.trim(e.GC$("#"+B).val().toLowerCase()),u=r.pNJ===!1?r.XWJ:r.CWa,v=r.a$a,w={},x=r.rLb;if(x.forEach(function(a){a&&a.repeat&&delete a.repeat}),t){for(b=l.ub(t),c=[],d=void 0,b||(d=RegExp(t.replace(r.rEscape,"\\$&"),"gi")),a=0;a<u.length;a++)for(f=u[a],g=f.children,h=0;h<g.length;h++){if(i=g[h],j=f.key,k=f.type,m=i.value||j,n=b&&l.sb(b).exec(m),n&&0===n.index||!b&&m.search(d)!==-1){if(w[j])break;if(c.push({text:j,value:f.value,type:k}),o=x[a],o&&o.value===f.value)o.repeat=!0;else for(p=a+1;p<x.length;){if(q=x[p],q&&q.value===f.value){q.repeat=!0;break}p++}w[j]=!0;break}x[a]&&x[a].repeat&&delete x[a].repeat}r.uLb=!0,r.gY=zb(c),r.qLb=x,r.hY=zb(c),r.jNJ=r.gY.length,r.HY(w)}else if(s(v)){for(this.tLb=!1,a=0;a<v.length;a++)1!==v[a].status&&(v[a].status=1);r.gY=zb(r.fY),r.hY=zb(r.fY),r.pNJ===!1?(r.vNJ(v,!1),r.CWa=r.XWJ):r.AXa(v),r.dataSource=v,r.jNJ=v.length}else this.tLb=!1,r.a$a=zb(r.dataSource)},b.prototype.EY=function(a,b){var c=e.GC$(p("i"));return c.attr({id:a}).text(b).css([ua,sa,"cursor",pa,"text-decoration","text-align",_,"outline",xa],[Ga,"0 6px","default","0px 0 1px 2px",va,Ca,"12px",va,"inherit"]),sb(c[0],H+I+O),c},b.prototype.v$a=function(a,b,c){var d,f,g,h=ob().Clear,i=e.GC$(p("i")).html(h.replace("{0}",'"'));i.attr({id:a}).css([ua,sa,"cursor",pa,"text-decoration","text-align",_,"outline",xa,"white-space"],["inline","0 6px","default","0px 0 1px 2px",va,Ca,"12px",va,"inherit","nowrap"]),c.append(i),d=c.width()-i[0].offsetWidth,g='<span class="filterName">'+n(b)+'</span><span style="vertical-align: top">"</span>',f=h.replace("{0}",g),i.html(f),e.GC$(".filterName",i[0]).css(["max-width","overflow","text-overflow",ua,"vertical-align"],[d+"px","hidden","ellipsis","inline-block","text-bottom"]),sb(i[0],H+I+O)},b.prototype.FY=function(a,b,c){var d=p(ha),f=e.GC$(p(ha)).text(b),g=p("i"),h=e.GC$(g);return sb(d,"gc-check-uncheck-all "+c),h.attr({id:a}).css(["float",qa,sa,_,xa],[Ca,"7px","0","12px","16px"]).append(e.GC$(d)).append(f),sb(g,W+W+"-style"),h},b.prototype.xXa=function(a){return"date"===a?void this.DWa.Date++:"number"===a||"boolean"===a?void this.DWa.Number++:"string"===a?void this.DWa.Text++:void 0},b.prototype.yXa=function(){var a=this.DWa.Date,b=this.DWa.Number,c=this.DWa.Text,d=a+b+c;return d>a&&d>b&&d>c?"mix":d===a?"type":d===b?"number":d===c?"text":void 0},b.prototype.YZa=function(a){var b,c=!0,d=a.rZ[this.filterButtonInfo.col];return d&&d.length>0&&d[0]instanceof g.Condition&&(d=d[0],b=this.i$a(d),(0!==d.compareType()||b||0===d.compareType()&&5===d.conType())&&(c=!1)),c},b.prototype.M8J=function(a){var b,c=this,d=c.pxb[a];return u(d)&&(b=a.replace(/(\[[^h^m^s]+\])|(General)/gi,""),d=o.Lc(b),c.pxb[a]=d),d},b.prototype.T0=function(a,b){return"number"===Ha(b)&&"string"===Ha(a)&&this.M8J(a)?Ia(b):b},b.prototype.Q$a=function(a,b,c,d,e,f){vb(a!==t&&a.backColor,c,d,e,f),vb(a!==t&&a.foreColor,b,d,e,f)},b.prototype.zY=function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=l.filterButtonInfo.rowFilter;m&&(b=l.sheet,c=b.Tq(m.extendedRange||m.range),d=c.col,e={},f=[],g={},h=[],i={data:{},colorNumber:0},j={data:{},colorNumber:0},k=b.outlineColumn&&b.outlineColumn.XQa(a),l.hasBlank=!1,a>=d&&a<d+c.colCount&&l.wNJ(a,i,j,e,g,f,h),l.xNJ(i,j,k,f,h,g,a))},b.prototype.wNJ=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=this,t=s.filterButtonInfo.rowFilter;if(t)for(h=s.sheet,j=h.currentTheme(),k={},l=h.Tq(t.extendedRange||t.range),m=s.V$a.sortByColor||s.V$a.filterByColor,n=l.rowCount,h.PDJ&&(n=Math.min(n,gb)),o=0;o<n;o++)p=l.row+o,q=h.getRowHeight(p)>0,r=q||!t.isFiltered()||t.N8J(p,a),r&&m&&(i=h.getActualStyle(p,a,3,!1,!1,!0),this.Q$a(i,c,b,j,p,k)),s.u$a(d,e,f,p,a,g)},b.prototype.xNJ=function(a,b,c,d,e,f,g){var h,i=this;i._Wa=a,i.aXa=b,c||(h=d.length,h<=kb&&(d.sort(ub),e.sort(ub))),i.fY=d,i.rLb=e,i.gY=zb(d),i.pNJ===!1?(i.CWa=i.yNJ(g,f,d),i.XWJ=zb(i.CWa),i.jNJ=i.hY.length):(i.CWa=i.zXa(g,f,d),i.jNJ=i.CWa.length),i.a$a=i.dataSource},b.prototype.O8J=function(a,b,c){var d,e=this,f=e.sheet;return c?c:(d=f.getActualStyle(a,b),d&&d._autoFormatter&&d._autoFormatter.formatCached?d._autoFormatter.formatCached:void 0)},b.prototype.NWJ=function(a){var b=this,c=b.sheet;return c.tq(-1,a,"formatter")},b.prototype.u$a=function(a,b,c,d,e,f,g,h,i,j,k){var l,n,o,p,q,r,s,t,v,w,x,y,z,A,B,C,D,E,F,G,H=this,I=H.sheet,J=H.filterButtonInfo.rowFilter,K=g?h:I.getValue(d,e),L=g?i:I.dNJ(d,e,K);if(L=L?L.trim():L,l=L,n=ob().Blanks,o=H.YZa(J),p=I.ODJ,H.zNJ||(H.zNJ=[]),H.zNJ.hasOwnProperty(e)?s=H.zNJ[e]:H.zNJ[e]=s=J.isFiltered(e),H.ANJ||(H.ANJ=[]),H.ANJ.hasOwnProperty(e)?t=H.ANJ[e]:H.ANJ[e]=t=I.outlineColumn&&I.outlineColumn.XQa(e),p){if(v=!1,w=!0,J.uNJ||(J.uNJ={}),H.BNJ||(H.BNJ=[]),H.BNJ.hasOwnProperty(e)?q=H.BNJ[e]:H.BNJ[e]=q=H.NWJ(e),q&&!m(q)&&(K=H.T0(q,K)),x=j,y="date"===x,H.xXa(x),1===H.DWa.Date&&(H.XZa=Fb(q)),y&&(l=J.mzb.format(K)),z=I.ODJ,z.u7J&&z.u7J())return A=k,(""===L||u(L))&&(x="blank",H.hasBlank=!0,L=n),A?(b[L]=!0,H.hY.push({text:L,value:K,type:x}),f.push({text:L,value:K,type:x})):f.push({text:L,value:K,noCheck:!0,type:x}),void c.push({text:L,value:K,type:x,noCheck:!A});B=J.isFiltered(),C=!0,""!==L||!w&&B&&!C?a[l]||w&&(k?(b[L]=!0,v=!0,H.hY.push({text:L,value:K,type:x}),f.push({text:L,value:K,type:x})):f.push({text:L,value:K,noCheck:!0,type:x}),c.push({text:L,value:K,type:x,noCheck:!v}),a[l]=!0):H.hasBlank||(x="blank",H.hasBlank=!0,k?(b[n]=!0,v=!0,H.hY.push({text:n,value:K,type:x}),f.push({text:n,value:K,type:x})):f.push({text:n,value:K,noCheck:!0,type:x}),c.push({text:n,value:K,type:x,noCheck:!v}))}else w=I.getRowHeight(d)>0,q=I.getFormatter(d,e),q&&!m(q)&&(K=H.T0(q,K)),r=H.O8J(d,e,q),x=Ab(K,r),y="date"===x,H.xXa(x),1===H.DWa.Date&&(H.XZa=Fb(q)),y&&(l=J.mzb.format(K)),D=I.getRowVisible(d,3,!0),E=J.P8J(d,e),B=J.isFiltered(),C=J.N8J(d,e),F=I.Yr(d),G=o&&(w||!s||t&&D&&!E),""!==L||!w&&B&&!C?a[l]||D&&F&&(G?(b[L]=!0,H.hY.push({text:L,value:K,type:x}),f.push({text:L,value:K,type:x})):f.push({text:L,value:K,noCheck:!0,type:x}),(w||!B||C)&&(c.push({text:L,value:K,type:x}),a[l]=!0)):H.hasBlank||(H.hasBlank=!0,c.push({text:n,value:K,type:x}),G?(b[n]=!0,H.hY.push({text:n,value:K,type:x}),f.push({text:n,value:K,type:x})):f.push({text:n,value:K,noCheck:!0,type:x}))},b.prototype.zXa=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this,t=[],u=[],v=s.sheet,w=v.Tq(s.filterButtonInfo.rowFilter.extendedRange||s.filterButtonInfo.rowFilter.range),x=v.outlineColumn;if(x&&x.XQa(a))for(j=0;j<c.length;j++)n=c[j].text,o=c[j].value,p=c[j].type,q=c[j].noCheck,i=lb[!!b[n]],k=Eb(v,n,o,w.row+j,a,i,p,q),t.push(k),m=k.children[0],m&&m.show!==!1&&u.push({name:m.value||k.key,level:s.uLb?0:m.level,status:m.status});else for(j=0;j<c.length;j++)switch(n=c[j].text,o=c[j].value,p=c[j].type){case"date":for(i=lb[!!b[n]],k=Db(s.XZa,n,o,i,p),l=k.children,e=l[0].value,f=l[1].value||l[0].value,l[0].show=l[1].show=!0,e===g&&(l[0].show=!1,f===h&&(l[1].show=!1)),g=e,h=f,t.push(k),m=k.children,r=0;r<3;r++)m[r]&&m[r].show!==!1&&u.push({name:m[r].value||k.key,level:m[r].level,status:m[r].status});break;case"number":case"string":case"boolean":case"blank":case"array":case"object":i=lb[!!b[n]],k=Eb(v,n,o,w.row+j,a,i,p),t.push(k),m=k.children[0],m&&m.show!==!1&&u.push({name:m.value||k.key,level:m.level,status:m.status})}return s.dataSource=u,t},b.prototype.yNJ=function(a,b,c,d){var e=this,f=[],g=[],h,i,j,k,l,m,n,o;for(d&&(f=[],g=[]),k=0;k<c.length;k++)l=c[k].text,m=c[k].value,n=c[k].type,o=c[k].noCheck,h=void 0===o?b[l]:!o,i=mb[h],j={key:l,value:m,children:[{value:l,level:0,status:i}],status:i,type:n,checked:h},f.push(j),g.push({name:j.children[0].value||j.key,level:0,status:i});return e.dataSource=g,f},b.prototype.AY=function(a){var b=this,c=0,d=b.itemList,f=!1,g=b.hXa;g||(g=new e.Workbook(d[0],{allowContextMenu:!1,showHorizontalScrollbar:!1,showVerticalScrollbar:!1,scrollbarMaxAlign:!0,tabStripVisible:!1,allowUserResize:!1,allowUserDragDrop:!1,allowUserDragFill:!1,allowUserZoom:!1,grayAreaBackColor:"white",sheetCount:1}),f=!0),g.EDc=!0,b.hXa=g,b.eXa=g.getActiveSheet(),b.iXa=c,b.pNJ===!1?(b.iXa=1,b.vNJ(a,f)):(b.AXa(a),b.DZa())},b.prototype.AXa=function(a){var b,c,d,f,g,h,i=this,j=i.hXa,k=i.itemList,l=k.width(),m=k.height();i.hXa.sheets.length>0&&(i.hXa.removeSheet(0),i.eXa=Sa),j.addSheet(0,new e.Worksheet("sheet1")),b=i.eXa=j.sheets[0],j.suspendEvent(),b.suspendPaint(),c=j.options,d=b.options,c.showHorizontalScrollbar=!1,c.showVerticalScrollbar=!1,d.colHeaderVisible=!1,d.rowHeaderVisible=!1,d.selectionBackColor="transparent",d.selectionBorderColor="transparent",d.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},d.protectionOptions.allowOutlineRows=!0,d.isProtected=!0,b.defaults.rowHeight=hb,b.defaults.colWidth=ib,b.setRowCount(0===a.length?0:a.length+1),f=new e.Style,f.font='12px "Segoe UI", Calibri, Thonburi, Arial, Verdana, sans-serif, "Mongolian Baiti", "Microsoft Yi Baiti", "Javanese Text"',b.setDefaultStyle(f),b.CNJ=!0,b.outlineColumn.options({columnIndex:i.iXa,showIndicator:!0,showCheckBox:!0,pNJ:this.pNJ}),b.outlineColumn.Lia(),b.showRowOutline(!1),b.setColumnCount(1),a.length>0&&i.uLb?(i.uLb=!1,a.unshift({name:ob().add_current_filter,level:0,status:0,key:"add_current",value:"add_current",children:[]}),i.tLb=!0):0===a.length&&(i.uLb=!1),i.BXa(b,a),hb*a.length>m&&(j.options.showVerticalScrollbar=!0,l-=22),g=b.jt(1).length,i.PZa(b,l,ib,0,g,a),!j.options.showVerticalScrollbar&&j.options.showHorizontalScrollbar&&(m-=22,hb*a.length>m&&(j.options.showVerticalScrollbar=!0,l-=22)),h=Math.ceil(l/ib),b.addColumns(b.getColumnCount(),h-1),b.outlineColumn.Mia(),this.YUJ(a),b.resumePaint(),j.resumeEvent()},b.prototype.YUJ=function(a){var b,c,d=this,e=d.hXa,f=d.eXa=e.sheets[0],g=f.rowOutlines,h=[],i=[];for(c=0;c<a.length;c++)b=a[c].level,a[c+1]&&a[c+1].level===b+1&&(0===b?h.push(c):1===b&&i.push(c));1===h.length?1!==i.length&&i.forEach(function(a){g.setCollapsed(a,!0)}):(h.forEach(function(a){g.setCollapsed(a,!0)}),i.forEach(function(a){g.setCollapsed(a,!0)})),f.mq(0)},b.prototype.vNJ=function(a,b){var c,d,f,g,h,i=this,j=i.hXa,k=i.sheet,l=i.itemList,m=l.width(),n=l.height(),o=i.eXa=j.sheets[0];j.suspendEvent(),o.suspendPaint(),k.endEdit(),b||o.reset(),c=j.options,d=o.options,c.showHorizontalScrollbar=!1,c.showVerticalScrollbar=!1,d.colHeaderVisible=!1,d.rowHeaderVisible=!1,d.selectionBackColor="transparent",d.selectionBorderColor="transparent",d.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},d.isProtected=!0,o.defaults.rowHeight=hb,o.defaults.colWidth=jb,o.setRowCount(0===a.length?0:a.length+1),f=new e.Style,f.font='12px "Segoe UI", Calibri, Thonburi, Arial, Verdana, sans-serif, "Mongolian Baiti", "Microsoft Yi Baiti", "Javanese Text"',f.vAlign=2,o.setDefaultStyle(f),o.CNJ=!0,a.length>0&&i.uLb?(i.uLb=!1,a.unshift({name:ob().add_current_filter,level:0,status:0,key:"add_current",value:"add_current",children:[]}),i.tLb=!0):0===a.length&&(i.uLb=!1),i.DNJ(o,a,j),20*a.length>n&&(j.options.showVerticalScrollbar=!0,m-=22),g=o.jt(1).length,i.PZa(o,m,jb,0,g,a),h=Math.ceil(m/jb),o.setColumnCount(o.getColumnCount()+h-2),o.resumePaint(),j.resumeEvent()},b.prototype.BXa=function(a,b){var c,d,e,f,g,h,i;if(0!==b.length){if(c=this,d=0,f=0,g=a.outlineColumn,h=c.iXa,a.suspendPaint(),a.autoGenerateColumns=!1,a.bindColumn(0,"name"),a.setDataSource(b),i=c.yXa(),"text"!==i&&"number"!==i||c.sheet.outlineColumn&&c.sheet.outlineColumn.XQa(c.filterButtonInfo.col))for(f=0;f<b.length;f++)d=b[f].level,a.getCell(f,h).textIndent(d);else a.getCell(-1,h).textIndent(d);for(g.refresh(),f=0;f<b.length;f++)e=b[f].status,g.CXa(f,e);a.resumePaint()}},b.prototype.DNJ=function(a,b,c){var d,f;0!==b.length&&(a.suspendPaint(),a.autoGenerateColumns=!1,a.bindColumn(1,"name"),a.bindColumn(0,"status"),a.setDataSource(b),a.setColumnCount(2),d=new e.Style,d.locked=!1,a.setStyle(-1,0,d),f=new h.CheckBox,f._caption="  ",f._textAlign=2,a.setCellType(-1,0,f),c.bind(e.Events.EditStarting,function(a,b){b.cancel=!0}),a.resumePaint())},b.prototype.HY=function(a){var b=this;b.pNJ===!1?(b.CWa=b.yNJ(b.filterButtonInfo.col,a,b.gY,!0),b.jNJ=b.hY.length,b.vNJ(b.dataSource,!1)):(b.zXa(b.filterButtonInfo.col,a,b.gY),b.AXa(b.dataSource))},b.prototype.JY=function(a){var b,c,d,f,g,h=this,j=h.filterButtonInfo,k=j.rowFilter,l=h.sheet,m=k.qmK(),n=l.Tq(m);k&&l&&l.hK()&&(b=l.kJb(n,!0,null),c=j.col,d={sheet:l,sheetName:l.name(),col:c,ascending:a,range:n,compareFunction:Sa,groupSort:b.groupSort,ignoreHidden:b.ignoreHidden,cancel:!1},l.Wq(e.Events.RangeSorting,d),d.cancel===!1&&(f=k.sj?k.sj.name():Sa,g={tableName:f,colIndex:c,compareFunction:d.compareFunction,groupSort:d.groupSort,ignoreHidden:d.ignoreHidden,isAsc:a},i.h4("sortFilter",g,l),l.Wq(e.Events.RangeSorted,d)))},b.prototype.DXa=function(a,b,c){var d,f,g,h,j=this,k=j.filterButtonInfo,l=k.rowFilter,m=j.sheet;l&&m&&m.hK()&&(c=c!==Sa&&c,d=k.col,f={sheet:m,sheetName:m.Cj,col:d,ascending:c,color:a,isBackColor:b,cancel:!1},m.Wq(e.Events.RangeSorting,f),f.cancel===!1&&(g=l.sj?l.sj.name():Sa,h={tableName:g,colIndex:d,isAsc:c,color:a,isBackColor:b},i.h4("sortFilter",h,m),m.Wq(e.Events.RangeSorted,f)))},b.prototype.MY=function(){var a=e.GC$("#"+z),b=P+Q+" "+R,c=this.pNJ===!1?this.jNJ:s(this.hY)>0;this.sLb||c?(a.prop("disabled",!1),wb(a[0],b)):(a.prop("disabled",!0),sb(a[0],b))},b}(e.Go),b.gZ=qb},"./dist/plugins/filter/filter.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/filter/filter-ns.js")),c("./dist/plugins/filter/filter-actions.js"),d(c("./dist/plugins/filter/filter-ui.js")),d(c("./dist/plugins/filter/filter.js"))},"./dist/plugins/filter/filter.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Y=this&&this.__assign||function(){return Y=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},Y.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("ConditionalFormatting"),g=c("./dist/plugins/filter/filter-ui.js"),h=c("./dist/plugins/filter/filter-ns.js"),i=c("./dist/plugins/filter/filter-button-images.js"),j=d.Ul.McK,k=d.Ul.JcK,l=d.NodeHelper.oca,m=d.NodeHelper.pca,n=d.NodeHelper.qca,o=d.Ul.oaa,p=d.Ul.naa,q=e.Common.l.Xb,r=e.Common.l.Ra,s=null,t=void 0,u=f.$V,v=d.kf,w=e.Common.j.Fa,x=e.Common.j.Ca,y=parseInt,z=e.Common.k,A=z.Cb,B=z.Bb,C=z.Fb,D=z.ac,E="HideRowFilter",F=".filter",G=d.GC$,H=G.each,I=new e.Common.ResourceManager(h.SR,"Filter"),J=I.getResource.bind(I),K=d.UsedRangeUtil.SZJ,L=d.UsedRangeUtil.RZJ;function Z(a,b,c){var e,f={cmd:a,sheetName:c.name(),cmdOption:b};c.PDJ?(e=d.Commands[f.cmd],e&&e.execute(c.parent,f,0)):c.wu().execute(f)}b.h4=Z;function $(a,b,c,d){var e,f;for(f=0;f<D(a);f++)if(e=a[f],e&&e.row===b&&e.col===c&&e.sheetArea===d)return e;return s}M={rowFilter:function(a){var b=this,c=b.xr;return D(arguments)?a&&Ma(b,a.range)?c:(b.ITa.gVa(c,0),c&&c.reset(),c=b.xr=a,c&&(b.xr.kj=b),b.$p(),b.ITa.gVa(c,0,t,!0),b):c},iZ:function(){var a,b,c,d,e,f,h,i,j,k=this,l=[],m=k.rowFilter(),n=m&&m.range,o=k.tables;if(n&&(d=n.row,e=n.col,f=void 0,h=e<0?ba(k):e+n.colCount,b=e<0?0:e,d<1?(a=ca(k,1)-1,f=1):(a=d-1,f=3),a>=0))for(;b<h;)m.filterButtonVisible(b)?(c=new g.eY(m),c.sheetArea=f,c.row=a,i=ea(k,a,b,f),i?(c.row=i.row,c.col=i.col,b+=i.colCount):(c.col=b,b++),l.push(c)):b++;return o&&(j=o.all(),H(j,function(d,e){if(a=e.headerIndex(),e&&e.showHeader()&&a>=0){var f=e.range(),h=void 0;for(h=0;h<f.colCount;h++)b=f.col+h,e.filterButtonVisible(h)&&(c=new g.eY(e.rowFilter(),a,b,3),l.push(c))}})),l},jZ:function(){var a=this,b=a.kZ;return b||(b=a.kZ=a.iZ()),b},Ps:function(a,b){var c=this.filterRowsVisibleInfo;return w(b)&&(b=3),!(3!==b&&2!==b||!c||c.lZ(a))},Nu:function(){return this.filterRowsVisibleInfo.mZ()},oK:function(a,b,c){var d,e,f=this,g=f.zoom(),h=f.parent,i=g>1?1:g,j=3===b||b===t?f.defaults.rowHeight:f.defaults.colHeaderRowHeight,k=y(""+Math.min(20,j)*i);return h&&h.options.useTouchLayout&&(k=y(""+j*g)),d={x:a.x+a.width-k,y:a.y+a.height-k,width:k,height:k},c&&0!==c.columnHeaderFitMode&&(e=c.cellWidth,e&&(d.x=a.x+e-k)),d}},G.extend(d.Worksheet.prototype,M),function(a){a[a.filter=0]="filter",a[a.unfilter=1]="unfilter"}(N=b.FilterActionType||(b.FilterActionType={}));function _(a,b){var c,d=da(a),e=a.compareType();2===d||7===d?(c=a.jzb,A(b,"T")!==-1||c?A(b,"DT")===-1&&c&&b.push("DT"):b.push("T")):3===d?0===e&&A(b,"BC")===-1?b.push("BC"):1===e&&A(b,"FC")===-1&&b.push("FC"):A(b,"V")===-1&&b.push("V")}function aa(a){var b,c,d,e,f=[];for(b=0;b<D(a);b++)c=a[b],0===da(c)?(d=c.item1(),e=c.item2(),d&&_(d,f),e&&_(e,f)):_(c,f);return f}function ba(a){return a.getColumnCount()}function ca(a,b){return a.getRowCount(b)}function da(a){return a.conType()}function ea(a,b,c,d){var e=a.getSpan(b,c,d);return!e&&a.xJb&&(e=a.xJb.zJb(b,c,d)),e}O={sortByValue:!0,sortByColor:!0,filterByColor:!0,filterByValue:!0,listFilterArea:!0},P={"-1":"null",100:"aboveAverage",101:"belowAverage"},Q={null:-1,aboveAverage:100,belowAverage:101,tomorrow:2,today:0,yesterday:1,nextWeek:9,thisWeek:7,lastWeek:8,nextMonth:6,thisMonth:4,lastMonth:5,nextQuarter:10,thisQuarter:11,lastQuarter:12,nextYear:13,thisYear:14,lastYear:15,yearToDate:16,Q1:17,Q2:18,Q3:19,Q4:20,M1:21,M2:22,M3:23,M4:24,M5:25,M6:26,M7:27,M8:28,M9:29,M10:30,M11:31,M12:32},R=[["today","yesterday","tomorrow","lastWeek","thisMonth","lastMonth","nextMonth","thisWeek","lastWeek","nextWeek","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear"],[],["Q1","Q2","Q3","Q4"],["M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12"],[],[],["yearToDate"]];function fa(a){return w(a)?a:a.length>=2&&"="===a[0]?a.substring(1):"="===a?"":a}function ga(a){return"number"==typeof a?"number":a instanceof Date||"string"==typeof a&&0===a.indexOf("/OADate(")&&a.indexOf(")")===a.length-2?"date":"boolean"==typeof a?"boolean":""}function ha(a){var b=a.formula();return w(b)&&(b=a.expected(),"string"==typeof b&&(b='"'+b+'"'),b instanceof Date&&(b=r(b)+"")),b}function ia(a,b,c){var d,e,f,g=k(a,"colorFilter");g&&(d=m(g.dxfId,0),e=c.getDxf(d),f=l(g.cellColor,!0),b.push(u(3,f?0:1,e&&e.backColor)))}function ja(a,b){var c,d,e,f,g,h,i,l,n,p,q,r,s,t,v,w,x,y=k(a,"filters");if(y){for(c="1"===y.blank,d=j(y,"filter"),e=j(y,"dateGroupItem"),f=0,g=d;f<g.length;f++)h=g[f],i=u(2,0,o(h.val)),i.ignoreCase(!0),i.ignoreBlank(c),b.push(i);for(l=0,n=e;l<n.length;l++)p=n[l],q=m(p.day,1),r=m(p.hour,0),s=m(p.minute,0),t=m(p.month,0),v=m(p.second,0),w=m(p.year,0),x=new Date(w,t>0?t-1:t,q,r,s,v),i=u(5,0,x),i.ignoreBlank(!c),b.push(i)}}function ka(a,b,c){var d,e,f,g={none:0,equal:0,lessThan:4,lessThanOrEqual:5,notEqual:1,greaterThan:2,greaterThanOrEqual:3};switch(a){case"string":d=2;break;case"number":d=1,e=parseFloat(c),isNaN(e)||(c=e);break;case"date":d=5,"string"==typeof c&&0===c.indexOf("/OADate(")?(f=parseInt(c.replace("/OADate(",""),10),c=q(f)):c=q(parseInt(c,10)),g={none:0,equal:0,lessThan:2,lessThanOrEqual:3,notEqual:1,greaterThan:4,greaterThanOrEqual:5};break;case"boolean":default:d=11}return u(d,g[b],c)}function la(a,b,c){var d,e,f,g,h,i,l;function m(a,b){var d,e,f,g,h="notEqual"===a,i=b.indexOf("*"),j=b.lastIndexOf("*");return i!==-1?(i===b.length-1&&0!==i?(e=h?3:2,d=u(2,e,b.substring(0,b.length-1))):0===i&&i===j?(e=h?5:4,d=u(2,e,b.substring(1))):(f=h?7:6,i!==-1&&j!==-1&&(b=b.substr(1,b.length-2)),d=u(2,f,b)),d.ignoreCase(!0)):(g=ga(c),d=ka(g,a,b)),d}d=k(a,"customFilters"),d&&(e=d.and,f=j(d,"customFilter"),g=f[0],h=f[1],i=void 0,g&&(i=m(g.operator,g.val)),h?(l="1"===e?1:0,b.push(u(0,l,s,s,s,s,s,i,m(h.operator,h.val)))):b.push(i))}function ma(a,b,c){var e,f,g,h,i,j=k(a,"dynamicFilter");j&&(e=Q[j.type],f=j.val,g=j.maxVal,h=new d.Range(c.row,c.col,c.rowCount,1),i=void 0,100===e||101===e?i=u(10,s,s,s,s,e-100,[h]):16===e?(i=u(6,s,0),i.expectTypeId(6)):e>=17&&e<=20?(i=u(6,s,e-17),i.expectTypeId(2)):e>=21&&e<=32?(i=u(6,s,e-21),i.expectTypeId(3)):e>=0&&e<=15&&(i=u(6,s,e)),i&&(w(f)||(i.value=f),w(g)||(i.maxValue=g),b.push(i)))}function na(a,b){var c,d,e,f,g=k(a,"top10");g&&(c=n(g.val,NaN),d=l(g.percent,!1),e=l(g.top,!0)?0:1,f=u(8,s,c,s,s,e),f.isPercent(d),b.push(f))}function oa(a,b,c,d){var e,f,g;if(1===c.colCount){for(e=[],g=c.row;g<c.row+c.rowCount;g++)f=a.getValue(g,c.col),w(f)||e.push(f);return e.sort(function(a,b){return d?b-a:a-b}),e[b-1]}}function pa(a){var b,c,d,e,g,h=[],i=[];for(i.push(a);i.length>0;)b=i.shift(),c=b instanceof f.Condition,d=c?b.conType():b.conType,0===d?(e=c?b.item1():b.item1,g=c?b.item2():b.item2,w(e)||i.push(e),w(g)||i.push(g)):h.push(b);return h}function qa(a,b){var c=a.expected(),d=0===a.compareType(),e=d?{backColor:c}:{backColor:{type:1,patternColor:c}},f={n_:"colorFilter",dxfId:b.getDxfIndex(e)};return d||(f.cellColor="0"),f}function ra(a,b,c){var d={n_:"top10"},e=1===b.type(),f=b.isPercent(),g=b.expected(),h=NaN;return e&&(d.top=0),f&&(d.percent=1),w(g)||(f&&(g=Math.ceil(c.rowCount%g/100)),w(c)||(h=oa(a,g,c,!e))),isNaN(g)||(d.val=g),isNaN(h)||(d.filterVal=h),d}function sa(a,b,c,d,e){var f,g;return w(a)?s:(f=P[a],6===b&&(f=R[c][a]),g={n_:"dynamicFilter"},f&&"null"!==f?g.type=f:g.type="null",f&&"Q"!==f[0]&&"M"!==f[0]&&(w(d)||(g.val=d),w(e)||(g.maxVal=e)),g)}function ta(a,b,c){var d,e,f,g=b.type(),h=b.conType(),i=b.expectTypeId()||0,j=0,k=0;for(e=0;e<c.rowCount;e++)f=parseFloat(a.getValue(c.row+e,c.col)),isNaN(f)||(j+=f,k++);return k>0&&(d=j/k),sa(g,h,i,d)}function ua(a){var b=new Date,c=b.getDay(),d=b.getDate(),e=new Date(b),f=new Date(b);switch(a){case 3:e.setDate(d-6);break;case 1:e.setDate(d-1);break;case 0:break;case 2:e.setDate(d+1);break;case 8:e.setDate(d-c-7),f.setDate(d-c-1);break;case 7:e.setDate(d-c),f.setDate(d-c+6);break;case 9:e.setDate(d-c+7),f.setDate(d-c+13);break;case 5:e.setDate(1),e.setMonth(e.getMonth()-1),f.setDate(0);break;case 4:e.setDate(1),f.setMonth(f.getMonth()+1),f.setDate(0);break;case 6:e.setDate(1),e.setMonth(e.getMonth()+1),f.setMonth(f.getMonth()+2),f.setDate(0)}return e.setHours(0),e.setMinutes(0),e.setSeconds(0),f.setHours(23),f.setMinutes(59),f.setSeconds(59),{from:e,to:f}}function va(a){var b,c,d,e=a.expected(),f=a.conType(),g=a.expectTypeId();return e>=0&&e<=15||e>=21&&e<=32?(d=ua(e),d.from&&d.to&&(b=d.from,c=d.to)):e=-1,sa(e,f,g,b,c)}function wa(a,b){var c={n_:"customFilter"},d={"-1":"none",0:"equal",4:"lessThan",5:"lessThanOrEqual",1:"notEqual",2:"greaterThan",3:"greaterThanOrEqual"};return a=d[a],"none"!==a&&(c.operator=a),c.val=""+b,c}function xa(a,b,c){if(w(a)&&w(c))return s;var d={n_:"customFilters"};return b&&(d.and="1"),w(a)||(d.c_||(d.c_=[]),d.c_.push(a)),w(c)||(d.c_||(d.c_=[]),d.c_.push(c)),d}function ya(a,b,c){var d,e,f,g={n_:"filters",c_:[]};return c&&(g.blank="1"),a=[].concat(a),a&&a.length>0&&(d=[],e=[],b||a.forEach(function(a){var b,c=a.expected();w(c)||""===c||(b={n_:"filter",val:p(c)},d.push(b))}),d.length>0&&(e=e.concat(d)),f=[],b&&(a.forEach(function(a){f.push(Ba(a.expected()))}),f.length>0&&(e=e.concat(f))),e.length>0&&(g.c_=e)),g}function za(a,b){var c,d,e,f=a.compareType();if(!w(f))return c=a.expected(),d=void 0,d=w(c)?fa(a.Yw)+"":c+"",e=wa(f,d),b?e:xa(e)}function Aa(a,b){var c,d=a.expected(),e=-1;switch(a.compareType()){case 0:return ya(a);case 1:e=1;break;case 2:d+="*";break;case 3:e=1,d+="*";break;case 4:d="*"+d;break;case 5:e=1,d="*"+d;break;case 6:d="*"+d+"*";break;case 7:e=1,d="*"+d+"*"}return c=wa(""+e,d),b?c:xa(c)}function Ba(a,b){var c={n_:"dateGroupItem"},d=a.getFullYear(),e=a.getMonth()+1,f=a.getDate(),g=a.getHours(),h=a.getMinutes(),i=a.getSeconds();return d>0&&(c.year=d),e>=0&&e<12&&(c.month=e),f>0&&f<32&&(c.day=f),g<24&&(c.hour=g),h<60&&(c.minute=h),i<60&&(c.second=i),c.dateTimeGrouping="day",c}function Ca(a,b){var c,d,e,f=a.compareType();if(0===f)return Ba(a.expected(),b);switch(c=-1,f){case 0:break;case 1:c=1;break;case 2:c=4;break;case 3:c=5;break;case 4:c=2;break;case 5:c=3}return c!==-1?(d=ha(a),e=wa(""+c,d),b?e:xa(e)):void 0}function Da(a,b){return a.every(function(a){return a.conType()===b})}function Ea(a){var b=-1;switch(a){case 0:case 2:case 4:case 6:b=0;break;case 1:case 3:case 5:case 7:b=1;break;default:b=0}return""+b}function Fa(a,b){switch(b){case 0:case 1:return a;case 2:case 3:return a.concat("*");case 4:case 5:return"*".concat(a);case 6:case 7:return"*".concat(a).concat("*");default:return a}}function Ga(a,b,c,d,e){if(!w(b)){var f=b.conType();if(3===f)return qa(b,d);if(8===f)return ra(a,b,c);if(10===f)return ta(a,b,c);if(6===f)return va(b);if(11===f||1===f)return za(b,e);if(2===f)return Aa(b,e);if(5===f)return Ca(b,e)}}function Ha(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=pa(a),t=r.length,u=a.compareType();if(0===u){if(Da(r,5))return ya(r,!0);if(Da(r,2)){if(d=!1,t<=2)for(e=0,f=r;e<f.length;e++)if(g=f[e],0!==g.compareType()){d=!0;break}return d?(h=r[0],i=h.compareType(),j=h.expected(),k=wa(Ea(i),w(j)?fa(h.Yw):Fa(j,i)),l=void 0,2===t&&(h=r[1],i=h.compareType(),j=h.expected(),l=wa(Ea(i),w(j)?fa(h.Yw):Fa(j,i))),xa(k,!1,l)):ya(r)}if(Da(r,11)){if(m=!0,r.length<=2&&(m=!1),m)return ya(r);if(r.length>0)return n=r[0],o=n.compareType(),j=n.expected(),k=void 0,l=void 0,k=wa(o,w(j)?fa(n.Yw):j),2===t&&(n=r[1],o=n.compareType(),j=n.expected(),l=wa(o,w(j)?fa(n.Yw):j)),xa(k,!1,l)}return p=Ga(b,r[0],c,void 0,!0),q=void 0,t>1&&(q=Ga(b,r[1],c,void 0,!0)),xa(p,!1,q)}if(2===t)return k=Ga(b,r[0],c,void 0,!0),w(k)?s:(l=Ga(b,r[1],c,void 0,!0),w(l)?s:xa(k,!0,l))}function Ia(a,b,c){var e,f,g,h,i,j;if(a&&!w(a.ascending)&&!w(a.index))return e=d.range_parser.getRangeString([new d.Range(b.row,a.index,b.rowCount,1)]),f={n_:"sortState",ref:e},g={n_:"sortCondition",ref:e},a.ascending||(g.descending=1),h=a.color,h!==t&&(i=a.isBackColor,"{"===h[0]&&(h=JSON.parse(h)),j=i?{backColor:h}:{foreColor:h},g.sortBy=i?d.SortBy.cellColor:d.SortBy.fontColor,g.dxfId=c.getDxfIndex(j)),f.c_||(f.c_=[]),f.c_.push(g),f}function Ja(a){for(var b in a)if(a.hasOwnProperty(b)&&!a[b])return!1;return!0}function Ka(a,b,c){var d,e,f,g,h,i,j,k;for(d=0;d<D(b);d++)for(e=b[d],f=e.conditions,g=0;g<D(f);g++)h=f[g],h&&(i=void 0,j=e.index,k=a[j],h.isCondition===!1?i=h:(i=u(),i.fromJSON(h,c)),k||(k=a[j]=[]),k.push(i))}function La(a){var b,c,d,e,g=0,h=[];for(b=0;b<D(a);b++)if(c=a[b]){for(d=[],e=void 0,e=0;e<D(c);e++)d.push(c[e]instanceof f.Condition?c[e].toJSON():Y({},c[e],{isCondition:!1}));h[g]={index:b,conditions:d},g++}return h}S=function(){function a(a){var b=this;b.range=a,b.HYJ=!0,a&&(b.IYJ=new d.Range(a.row,a.col,a.rowCount,a.colCount)),b.reset(),b.typeName="",b.filterHandler=s,b.pYJ()}return a.prototype.getUsedRange=function(){var a=this,b=a.extendedRange;return L(b)},a.prototype.pYJ=function(){var a=this;Object.defineProperty(a,"extendedRange",{get:function(){return a.qYJ()?(a.HYJ&&a.rYJ(),a.IYJ):a.range},set:function(b){a.IYJ=b,a.qYJ()&&a.rYJ()}})},a.prototype.qYJ=function(){var a=this,b=a.kj,c=b&&b.parent;return c&&c.options.allowAutoExtendFilterRange&&a.sYJ},a.prototype.rYJ=function(){var a,b,c,e,f,g,h,i,j=this,k=j.kj,l=k&&k.ITa,m=j.range;if(m&&l){for(j.IYJ=new d.Range(m.row,m.col,m.rowCount,m.colCount),a=j.IYJ,b=a.row,c=a.col,e=a.colCount,f=m.rowCount,g=b+f,h=g,i=-1;j.tYJ(l,h,c,1,e);)h++;i=Math.max(g,h),j.IYJ.rowCount=i-b,j.HYJ=!1}},a.prototype.no=function(){this.kj=s,this.sj=s},a.prototype.tYJ=function(a,b,c,e,f){var g,h;for(g=b;g<b+e;g++)for(h=c;h<c+f;h++)if(!w(a.getValue(g,h,d.SheetArea.viewport,!0)))return!0;return!1},a.prototype.filterButtonVisible=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=this,o=n.qmK();if(!w(o)){if(c=n.kj,d=n.oZ(o),e=n.pZ(o,c),f=arguments,g=n.qZ,h=a>=d&&a<e,i=D(f),j=f[0],k=typeof j,0===i){for(l=d;l<e;l++)if(g[l]||g[l]===t)return!0;return!1}if(m=a,1===i){if("number"===k)return h&&g[m]===t&&(g[m]=!0),g[m];if("boolean"===k){for(c&&c.ITa.gVa(n,3),l=d;l<e;l++)g[l]=j;c&&c.ITa.gVa(n,3,t,!0)}}else 2===i&&h&&(c&&c.ITa.gVa(n,4,a),g[m]=b,c&&c.ITa.gVa(n,4,a,!0));return c&&c.$p(),n}},a.prototype.oZ=function(a){return a.col<0?0:a.col},a.prototype.pZ=function(a,b){return b&&a.col<0?ba(b):a.col+a.colCount},a.prototype.addFilterItem=function(a,b){var c,d=this,e=d.kj,g=d.qmK(),h=d.rZ,i=h[a];if(w(b))throw Error(J().Exp_FilterItemIsNull);if(a<-1||a>=ba(e))throw Error(J().Exp_InvalidColumnIndex);if(g){if(e.ITa.gVa(d,5),g=e.Tq(g),a<g.col||a>=g.col+g.colCount)return;if(i||(i=[]),b instanceof f.Condition)i.push(b);else if(x(b))for(c=0;c<b.length;c++)i.push(b[c]);h[a]=i,e.ITa.gVa(d,5,t,!0)}},a.prototype.removeFilterItems=function(a,b){this.kj.ITa.gVa(this,6),this.NX(a),this.unfilter(a,b),this.kj.ITa.gVa(this,6,t,!0)},a.prototype.NX=function(a){var b=this,c=b.rZ;b.sZ(a),c[a]&&c.splice(a,1,s)},a.prototype.unfilter=function(a,b){var c,d,e,f=this,g=f.kj;if(g){if(g.ITa.gVa(f,2),c=[],d=f.Je,e=void 0,w(a))for(e=D(d)-1;e>=0;e--)c.push(d[e]),f.OX(d[e]);else c.push(a),f.OX(a),f.reFilter(b);b||f.tZ(g,1,c),g.ITa.gVa(f,2,t,!0)}},a.prototype.uZ=function(a){var b,c,d,e,f,g,h=this,i=h.qmK();if(h.OX(a),h.rZ[a]&&i){if(b=i.col,b!==-1&&(a<b||a>=b+i.colCount))return;for(i=h.kj.Tq(i),c=i.row,d=i.rowCount,e=h.vZ(a,c,d),
f=void 0,g=h.wZ(c,d,a,e),g.forEach(function(a){a.nxb()}),f=c;f<c+d;f++)h.isRowFilteredOut(f)||h.xZ(g,f,a,e);g.forEach(function(a){a.oxb()}),h.RX(a,!0)}},a.prototype.vZ=function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=l.kj,n=aa(l.rZ[a]),o={},p=D(n);for(d=b;d<b+c;d++){for(h={},e=0;e<p;e++)f=n[e],"T"===f?(i=m.getText(d,a),h[f]=i?i.trim():i):"DT"===f?(j=m.getValue(d,a),k=l.mzb,h[f]=k.format(j)):"BC"===f?(g=m.getActualStyle(d,a,3,!1,!1,!0),g&&(h[f]=g.backColor)):"FC"===f?(g=m.getActualStyle(d,a,3,!1,!1,!0),g&&(h[f]=g.foreColor)):"V"===f&&(h[f]=m.getValue(d,a));o[d]=h}return o},a.prototype.filter=function(a,b){var c,d,e=this,f=e.kj,g=e.rZ;if(f){if(f.ITa.gVa(e,7),d=[],e.E$J===!1&&(delete e.E$J,e.Je=[]),w(a))for(c=0;c<D(g);c++)g[c]&&(d.push(c),e.uZ(c));else{if(!g[a])return;d.push(a),e.uZ(a)}b||e.tZ(f,0,d),f.ITa.gVa(e,7,t,!0)}},a.prototype.tZ=function(a,b,c){var d,e=this;a.AR&&a.AR(),d=e.SX(b,c),e.filterHandler&&e.filterHandler(d),e.onFilter(d),a.$p()},a.prototype.SX=function(a,b){var c,d,e,f=this,g=f.kj,h=f.qmK(),i=[],j=[];if(h)for(c=g.Tq(h),d=c.row,e=void 0,e=d;e<d+c.rowCount;e++)f.isRowFilteredOut(e)?j.push(e):i.push(e);return{action:a,sheet:g,range:h,filteredRows:i,filteredOutRows:j,columns:b}},a.prototype.onFilter=function(a){},a.prototype.isFiltered=function(a){var b=this.Je;return arguments.length?B(b,a):b.length>0},a.prototype.isRowFilteredOut=function(a){var b,c,d=this,e=d.qmK();return!(!d.isFiltered()||!e)&&(b=e.row,c=d.Q8J[a],!(b!==-1&&(a<b||a>=b+e.rowCount)||D(c)>=D(d.Je)))},a.prototype.reset=function(){var a=this,b=a.kj;b&&b.ITa.gVa(a,8),a.zZ=s,a.unfilter(),a.rZ=[],a.Je=[],a.yZ=[],a.Q8J={},a.qZ={}},a.prototype.Dl=function(a,b,c){var d,e,f,g=this,h=!1,i=g.kj,j=g.qmK();return j&&(j=i.Tq(j,c),d=j.row,e=j.col,f=b>=e&&b<e+j.colCount,1===c&&a===ca(i,c)-1&&d-1<0&&f?h=!0:3===c&&a===d-1&&f&&(h=!0)),h},a.prototype.getFilterItems=function(a){var b=this.rZ[a];return b||[]},a.prototype.getFilteredItems=function(){return this.yZ},a.prototype.sortColumn=function(a,b){this.oLb(a,b,null)},a.prototype.oLb=function(a,b,c,d,e){var f,g,h,i,j=this,k=j.kj;if(k){f=j.qmK(),g=k.Tq(f),k.suspendPaint();try{k.ITa.gVa(j,1,a),h={index:a,ascending:b,compareFunction:c},i=k.sortRange(g.row,g.col,g.rowCount,g.colCount,!0,[h],d,s,e),i&&(j.zZ=h,j.isFiltered(a)&&j.reFilter()),k.ITa.gVa(j,1,a,!0)}finally{k.resumePaint()}}},a.prototype.sortColumnByColor=function(a,b,c,d,e,f){var g,h,i,j,k=this,l=k.kj;l&&(g=k.qmK(),h=l.Tq(g),l.suspendPaint(),l.ITa.gVa(k,1,a),i={index:a,ascending:b,color:c,isBackColor:d},j=l.sortRange(h.row,h.col,h.rowCount,h.colCount,!0,[i],e,s,f),j&&(k.zZ=i,k.isFiltered(a)&&k.reFilter()),l.ITa.gVa(k,1,a,!0),l.resumePaint())},a.prototype.getSortState=function(a){var b=this.zZ,c=0;return b&&b.index===a&&(c=b.ascending?1:2),c},a.prototype.reFilter=function(a){var b,c=this,d=c.Je,e=D(d);for(c.kj.ITa.gVa(c,13),c.Q8J={},c.yZ=[],c.Je=[],b=0;b<e;b++)c.filter(d[b],a);c.kj.ITa.gVa(c,13,t,!0)},a.prototype.openFilterDialog=function(){},a.prototype.QX=function(a,b){var c=this.Q8J,d=c[a];w(d)?d=[b]:(B(d,b)&&C(d,b),d.push(b)),c[a]=d},a.prototype.PX=function(a){var b=this.yZ;B(b,a)||b.push(a)},a.prototype.OX=function(a){var b,c,d=this,e=d.Q8J,f=d.qmK();if(f&&d.isFiltered(a)){d.RX(a,!1);for(c in e)c&&(b=e[c],b&&B(b,a)&&(C(b,a),D(b)||(e[c]=t)));d.sZ(a)}},a.prototype.RX=function(a,b){var c=this.Je;if(b){if(D(c)){if(c[D(c)-1]===a)return;C(c,a)}c.push(a)}else C(c,a)},a.prototype.sZ=function(a){var b,c,d=this,e=d.rZ,f=e.length,g=[],h=[];for(b=0;b<f;b++)b===a?g=g.concat(e[b]):h=h.concat(e[b]);for(c=g.length,b=0;b<c;b++)B(h,g[b])||C(d.yZ,g[b])},a.prototype.wZ=function(a,b,c,d){var e,f,g,h,i,j,k=this,l=k.rZ[c],m={},n=[];for(e=0;e<D(l);e++)f=l[e],2!==da(f)||0!==f.compareType()||f.forceValue2Text()||f.useWildCards()||f.ignoreCase()||f.ignoreBlank()?n.push(f):f.jzb?(g=k.mzb,m[g.format(f.pLb)]=f):m[f.expected()]=f;for(e=a;e<a+b;e++)h=k.isRowFilteredOut(e),i=d[e],m[i.T]===t&&m[i.DT]===t||(j=m[i.T]||m[i.DT],k.QX(e,c),h||k.PX(j));return n},a.prototype.xZ=function(a,b,c,d){var e,f,g,h,i,j,k=this,l=k.qmK();for(e=0;e<D(a);e++)if(f=a[e],g=f.item1(),h=f.item2(),i=void 0,j=void 0,0===da(f)?(g&&(i=k.AZ(g,b,c,l,d)),h&&(j=k.AZ(h,b,c,l,d))):i=k.AZ(f,b,c,l,d),f.evaluate(k.kj,b,c,i,j)){k.QX(b,c),k.PX(f);break}},a.prototype.AZ=function(a,b,c,d,e){var f,g,h,i=this,j=s,k=da(a),l=a.compareType(),m=e[b];return 8!==k&&10!==k||(f=[],g=i.kj.Tq(d),h=g.col,h<=c&&c<h+g.colCount&&f.push(v(g.row,c,g.rowCount,1)),a.ranges(f)),2===k||7===k?j=m.T:3===k?0===l?j=m.BC:1===l&&(j=m.FC):j=m.V,j},a.prototype.R8J=function(a,b){var c,d,e,f,g=this,h=g.Je;return!!D(h)&&(d=g.Q8J[a],e=D(d),w(d)||e<0?c=!0:(f=A(d,b),c=f<0),c)},a.prototype.P8J=function(a,b){var c,d,e,f,g=this,h=g.Je;return!!D(h)&&(c=-1,d=A(h,b),e=g.Q8J[a],f=D(e),d>0&&(c=h[d-1]),c>-1?!!f&&c===e[f-1]:!f)},a.prototype.N8J=function(a,b){var c,d,e,f=this,g=f.Je;return!D(g)||(c=A(g,b),d=f.Q8J[a],e=D(d)||0,e>=D(g)||!(c<0||e<D(g)-1)&&(!d||A(d,b)<0))},a.prototype.rI=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=q.range;if(r&&(d=ca(q.kj)-b-1,e=r.row,f=r.col,g=r.rowCount,h=r.colCount,e>-1&&(d=e+g-1,a<e||c&&a===e&&0===a?q.BZ(v(e+b,f,g,h)):a<e+g&&q.BZ(v(e,f,g+b,h))),i=q.Q8J,q.isFiltered()&&i)){for(j=[],k=void 0,Object.keys(i).forEach(function(a){j.push(+a)}),j.sort(function(a,b){return b-a}),l={},m=[],k=0;k<D(j);k++)n=j[k],n>=a&&n<=d?l[n+b]=i[n]:n<a&&(l[n]=i[n]);for(f!==-1&&h!==-1||(f=0,h=q.kj.getColumnCount()),o=0;o<h;o++)m.push(o+f);for(p=0;p<b;p++)l[p+a]=m.slice();q.Q8J=l}},a.prototype.tI=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this,p=o.range;if(p){if(d=p.row,e=p.col,f=p.rowCount,g=p.colCount,h=0,i=-1,j=0,a>=0&&o.CZ()){for(k=0;k<b;k++)k+a<=o.DZ()&&h++;o.DZ(o.DZ()+h)}for(e>-1&&(c||a<e+g?(i=a,j=g-(a-e),o.BZ(v(d,e,f,g+b))):a<=e&&(i=e,j=g,o.BZ(v(d,e+b,f,g)))),i<0&&(i=0,j=ba(o.kj)-b),k=i+j-1;k>=i;k--)k>=a&&(l=k+b,m=A(o.Je,k),m>=0&&(o.Je[m]=l),n=o.rZ[k],D(n)&&(C(o.rZ,k),o.rZ[l]=n));o.reFilter()}},a.prototype.GR=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this,n=m.range,o=m.kj,p=o&&o.parent;if(n&&(c=0,d=ca(o)+b-1,e=n.row,f=n.col,g=n.rowCount,h=n.colCount,e>-1&&(c=e,d=e+g-1,a<=e?o.$Bb?(m.BZ(v(a,f,g,h)),delete o.$Bb):e===a+1||e+g<=a+b?p&&!p.options.allowAutoExtendFilterRange&&0!==g&&m.BZ(s):e<a+b?m.BZ(v(a,f,e+g-(a+b),h)):m.BZ(v(e-b,f,g,h)):a<e+g&&m.BZ(v(e,f,g-Math.min(e+g-a,b),h))),i=m.Q8J,m.isFiltered()&&i))for(j=c;j<=d;j++)j>=a&&j<a+b?i[j]=t:j>=a+b&&(k=j,l=i[k],l&&(i[k-b]=l,i[k]=t))},a.prototype.BZ=function(a){this.kj.ITa.gVa(this,14),this.range=a,this.HYJ=!0,this.kj.ITa.gVa(this,14,t,!0)},a.prototype.EZ=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this,o=n.kj,p=n.range;if(p)if(a){if(!a.equals(p)){if(d=p.col,e=p.colCount,f=a.col,g=a.colCount,h=ba(o),n.isFiltered()&&!(d<0&&f<0))for(d<0&&(d=0,e=h),f<0&&(f=0,g=h),b=0;b<e;b++)c=d+b,(f>c||c>=f+g)&&n.removeFilterItems(c);if(i=p.row,j=p.rowCount,k=a.row,l=a.rowCount,m=ca(o),n.isFiltered()&&n.Q8J&&!(i<0&&k<0))for(i<0&&(i=0,j=m),k<0&&(k=0,l=m),b=0;b<j;b++)c=i+b,(k>c||c>=k+l)&&(n.Q8J[c]=t)}}else n.reset();!n.CZ()||a&&a.contains(-1,n.DZ())||(n.zZ=s),n.BZ(a)},a.prototype.HR=function(a,b){var c,d,e,f,g,h,i,j,k=this,l=k.range,m=k.DZ(),n=a+b;if(l){for(a>=0&&k.CZ()&&(m>=a&&m<n?k.DZ(-1):m>=n&&k.DZ(m-b)),c=l.row,d=l.col,e=l.rowCount,d<0?(d=0,f=ba(k.kj)+b):f=l.colCount,g=d;g<d+f;g++)g>=a&&(g<n?k.removeFilterItems(g):(h=g-b,i=A(k.Je,g),j=k.rZ[g],i>=0&&(k.Je[i]=h),D(j)&&(C(k.rZ,g),k.rZ[h]=j)));d>=0&&(a<d?n<=d?k.BZ(v(c,d-b,e,f)):n<=d+f?k.BZ(v(c,a,e,d+f-n)):k.BZ(s):a<d+f&&(n<=d+f?k.BZ(v(c,d,e,f-b)):k.BZ(v(c,d,e,a-d)))),k.reFilter()}},a.prototype.CZ=function(){var a=this,b=a.zZ;return!!b&&(b.index>-1&&0!==a.getSortState(b.index))},a.prototype.DZ=function(a){var b=this,c=b.zZ,d;return D(arguments)?(c?c.index=a:b.zZ={index:a,ascending:!1},d=b):d=c?c.index:-1,d},a.prototype.$b=function(a,b,c,d){var e,f,g,h=this,i=h.range;i&&(e=v(a,b,c,d),h.filterButtonVisible()?(f=i.row-1,g=i.rowCount+1,f<0&&(f=-1,g=-1),e.containsRange(v(f,i.col,g,i.colCount))&&h.unfilter()):e.containsRange(i)&&h.unfilter())},a.prototype.fromJSON=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;if(a){for(c=this,d=a.range,e=a.filterItemMap,f=c.rZ,g=a.sortInfo,h=a.showFilterButton,i=a.filterButtonVisibleInfo,m=c.kj,d&&(c.range=v(d.row,d.col,d.rowCount,d.colCount)),a.dialogVisibleInfo&&(c.g_a=G.extend({},O,a.dialogVisibleInfo)),Ka(f,e,b),l=a.filteredColumns||a.filteredColMap,j=0;j<D(l);j++)w(l[j])||c.Je.push(l[j]);if(g&&g.color===t?c.zZ={index:g.index,ascending:g.ascending}:g&&g.color!==t&&(c.zZ={index:g.index,ascending:g.ascending,color:g.color,isBackColor:g.isBackColor}),h!==t)if(n=c.range,i)c.qZ=i;else if(n)for(j=c.oZ(n);j<c.pZ(n,m);j++)c.qZ[j]=h}},a.prototype.cdK=function(a,b,c){var e,f,g,h,i,n,o,p,q,r,s,t,u,x,y,z,A,B,C,D,E,F,H,I,J,K,L,M,N,P,Q,R,S,T,U,V;if(a&&(e=a.ref&&a.ref.toUpperCase(),f=a.lossless,g=f&&f.range,e&&"#REF!"!==e||g)){if(h=this,i=h.kj,g?n=g:(n=d.range_parser.CcK(e)[0],o=f&&f.isSJSFilter,o||(n.row>=0&&(n.row=n.row+1),n.rowCount>=0&&(n.rowCount=n.rowCount-1))),p=j(a,"filterColumn"),q=k(a,"sortState")||b,n&&(h.range=v(n.row,n.col,n.rowCount,n.colCount)),f&&f.dialogVisibleInfo&&(h.g_a=G.extend({},O,f.dialogVisibleInfo)),r=h.range,s=h.rZ,t=r&&r.col,p)for(x=0,y=p;x<y.length;x++)z=y[x],A=z.colId,w(A)||w(t)||(B=parseInt(A,10)+t,h.Je.push(B),C=s[B],C||(C=s[B]=[]),ia(z,C,c),ja(z,C),la(z,C,i.getValue(r.row,B)),ma(z,C,r),na(z,C),!u&&C.length>0&&(u=!0));if(D=f&&f.filterItemMap,D&&Ka(s,D),q&&(E=k(q,"sortCondition"),F=E.sortBy,H=!E.descending,I=d.range_parser.CcK(E.ref)[0].col,h.zZ={index:I,ascending:H},F!==d.SortBy.fontColor&&F!==d.SortBy.cellColor||(J=m(k(E,"dxfId"),0),K=c.getDxf(J),L=void 0,K&&(L=K.backColor),h.zZ.color=L||"",h.zZ.isBackColor=F===d.SortBy.cellColor)),r&&(M=i.ITa.YTa(!0,3),N=M.getHiddenRows(),P=M.infos,u&&N&&N.length>0&&p&&p.length>0&&i.filterRowsVisibleInfo)){for(Q=i.filterRowsVisibleInfo.rowsVisibleInfo||{},R=!0,S=r.row,T=r.row+r.rowCount;S<T;S++)N.indexOf(S)>=0&&(Q[S]=!1,R=!1,P[S]&&P[S].visible===!1&&(P[S].visible=!0));R===!1&&(i.filterRowsVisibleInfo.rowsVisibleInfo=Q,i.filterRowsVisibleInfo.empty=!1)}for(U=!0,(f&&(f.showTableHeader===!1||f.showFilterButton===!1)||!r&&!b||p&&p.length>0&&l(p[0].hiddenButton,!1)===!0)&&(U=!1),!r&&f&&(h.range=r=f.filterRange),V=f&&f.filterButtonVisibleInfo,S=h.oZ(r);S<h.pZ(r,i);S++)h.qZ[S]=V?V[S]:U}},a.prototype.getToJsonRowFilter=function(){var a,b,c,d,e,f,g=[],h=this.kj,i=this.range,j=0,k=0;if(i&&(j=i.row,k=i.row+i.rowCount),h&&(a=h.filterRowsVisibleInfo&&h.filterRowsVisibleInfo.rowsVisibleInfo,!w(a)))for(b=Object.keys(a),c=void 0,d=0,e=b;d<e.length;d++)f=e[d],c=+f,c>=j&&c<k&&a[c]===!1&&g.push(c);return g},a.prototype.toJSON=function(){var a,b,c,d,e=this,f={},g=e.range,h=e.qZ,i=e.rZ,j=e.Je,k=e.zZ,l=[],m=0,n=e.typeName,o=e.qKJ;if(o&&(f.adjustRangeForFrozen=o),g&&(f.range=g),n&&(f.typeName=n),e.g_a){b={};for(c in e.g_a)e.g_a.hasOwnProperty(c)&&e.g_a[c]===!1&&(b[c]=!1);f.dialogVisibleInfo=b}if(l=La(i),D(l)&&(f.filterItemMap=l),D(j)&&(f.filteredColumns=j),k&&(f.sortInfo=k),h)if(G.isEmptyObject(h))f.showFilterButton=!0;else{f.filterButtonVisibleInfo=G.extend({},h),d=!1;for(a in h)if(h[a]){d=!0;break}f.showFilterButton=d}return f.filteredOutRows=e.getToJsonRowFilter(),f},a.prototype.bdK=function(a,b,c){var e,g,h,i,j,k,l,m,n,o,p,q,r,s,u,v,x,y,z,A,B,C,F,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=a.c_,Z=this,$=Z.kj,_=Z.range,aa=Z.rZ,ba=Z.Je,ca=[],da=_.col,ea=Z.sj,fa=1,ga=!1;if(ea&&(e=ea.MZ,e===!1&&(fa=0),ga=!0),g=c&&d.OpenSaveFileType.excel===c.fileType,aa&&aa.length>0&&ba&&ba.length>0)for(h=0;h<D(aa);h++)if(i=aa[h]){if(g&&(h<da||h>=da+_.colCount||ba.indexOf(h)<0))return;if(j=i[0],k=void 0,j instanceof f.Condition)for(k=j,l=1;l<i.length;l++)k=f.$V(0,0,t,t,t,t,t,k,i[l]);k&&(m={n_:"filterColumn",colId:(ea?h-ea.dj:h-da)+""},n=new d.Range(_.row+1,da,_.rowCount-1,_.colCount),o=void 0,1===D(i)?(o=Ga($,k,n,b),w(o)&&(o=Ha(k,$,n))):o=Ha(k,$,n),w(o)||(m.c_=[o]),ca.push(m))}if(p=$.getSpans(),q=[],_&&p&&p.length>0){for(r=_.row-1,s=ca.length>0,u=_.colCount,v=0,x=p;v<x.length;v++)if(y=x[v],z=y.row,A=y.rowCount,B=y.col,C=y.colCount,B>=da&&B+C<=u&&(r===z||r===z+A-1))for(F=B;F<B+C-1;F++)H=F-da,s||ga===!0?(I=ca[F],I&&I.colId===H?ca[F].showButton=0:q.push({n_:"filterColumn",colId:H,showButton:0})):q.push({n_:"filterColumn",colId:H,showButton:0});ca=ca.concat(q)}if(J=Z.zZ,J&&(ga?K=Ia(J,_,b):ca.push(Ia(J,_,b))),L=Z.qZ,M=!0,L){if(N=!1,G.isEmptyObject(L))N=!0;else for(h in L)if(L[h]){N=!0;break}if(0!==fa){if(ea&&(!N||!Ja(L)))if(0===ca.length){if(g)for(h=0;h<_.colCount;h++)ca.push({n_:"filterColumn",colId:h+"",hiddenButton:"1"})}else for(O=void 0,P=0,Q=ca;P<Q.length;P++)O=Q[P],L[O.colId]||(O.hiddenButton=1)}else M=!1}if(_&&M){if(R=Z.qKJ?$.frozenRowCount():0,S=!(c&&c.fileType===d.OpenSaveFileType.excel),T={n_:"autoFilter",ref:d.range_parser.EcK(S?_:Ta($,_,R))},S&&(T.lossless||(T.lossless={}),T.lossless.isSJSFilter=S,T.lossless.filterButtonVisibleInfo=L,U=Z.typeName,U&&U!==E&&(T.lossless||(T.lossless={}),T.lossless.typeName=U,T.lossless.filterItemMap=La(aa))),ca.length>0){if(V=Z.g_a){W={};for(X in V)V.hasOwnProperty(X)&&V[X]===!1&&(W[X]=!1);T.lossless||(T.lossless={}),T.lossless.dialogVisibleInfo=W}T.c_=ca}Y||(Y=a.c_=[]),Y.push(T),K&&Y.push(K)}},a.prototype.TX=function(a){var b=a.options;return!b.isProtected||b.protectionOptions.allowFilter},a.prototype.hitTest=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w=this.kj;if(w){if(d=a.rowViewportIndex,e=a.colViewportIndex,f=a.hitTestType,h=w.it(e),1===f?(i=w.ut().findY(c),j=h.findX(b),k=1):3===f&&(i=w.jt(d).findY(c),j=h.findX(b),k=3),!i||!j)return s;if(l=i.row,m=j.col,n=ea(w,l,m,k),o=w.jZ(),n){if(p=n.row,q=n.col,!n.contains(l,m,1,1))return s;l=p,m=q}return o&&(r=$(o,l,m,k),r&&(t=w.getCellRect(l,m,d,e,!0),u=w.PKJ(m),v=w.oK(t,k,{columnHeaderFitMode:u,cellWidth:w.getColumnWidth(m)}),v.x<=b&&b<=v.x+v.width&&v.y<=c&&c<=v.y+v.height))?new g.eY(r.rowFilter,r.row,r.col,r.sheetArea,v.x,v.y,v.width,v.height):s}},a.prototype.qmK=function(){return this.extendedRange||this.range},a}(),b.RowFilterBase=S;function Ma(a,b){var c,d,e,f,g,h,i,j,k,l,m;if(!b)return null;if(c=a.getRowCount(),d=a.getColumnCount(),e=Na(a,b,c,d),f=e.row,g=e.col,h=e.rowCount,i=e.colCount,j=a.tables,w(j))return null;for(k=f;k<f+h;k++)for(l=g;l<g+i;l++)if(m=j.find(k,l))return m;return null}function Na(a,b,c,e){var f=b.row,g=b.col,h=b.rowCount,i=b.colCount;return c||(c=a.getRowCount()),e||(e=a.getColumnCount()),f===-1&&(f=0,h=c),g===-1&&(g=0,i=e),h=f+h>c?c-f:h,i=g+i>e?e-g:i,new d.Range(f,g,h,i)}T=function(a){X(b,a);function b(b){var c=a.call(this,b)||this;return c.sYJ=!0,c.typeName=E,c.g_a=G.extend({},O),c.mzb=new e.Formatter.GeneralFormatter("yyyy/mm/dd"),c}return b.prototype.onFilter=function(a){var b=this,c=b.kj;c&&(b.FZ(c,a.filteredRows,a.filteredOutRows),c.au())},b.prototype.filterDialogVisibleInfo=function(a){if(0===arguments.length)return this.g_a||(this.g_a=G.extend({},O)),this.g_a;if(a){var b={};return a.sortByValue!==t&&(b.sortByValue=!!a.sortByValue),a.sortByColor!==t&&(b.sortByColor=!!a.sortByColor),a.filterByColor!==t&&(b.filterByColor=!!a.filterByColor),a.filterByValue!==t&&(b.filterByValue=!!a.filterByValue),a.listFilterArea!==t&&(b.listFilterArea=!!a.listFilterArea),G.extend(this.g_a,b),this}},b.prototype.FZ=function(a,b,c){var d,e,f=a.filterRowsVisibleInfo;f&&(d=a.getCalcService(),d.suspend(),d.H9J="filter",e=f.D4(b,c),a.recalcRows&&a.recalcRows(e),delete d.H9J,d.resume(!1),d.F9J())},b.prototype.openFilterDialog=function(a){var b,c=this,d=c.kj;c.TX(d)&&(b=new g.gZ(d.parent.pZJ(),d,a,c.filterDialogVisibleInfo()),d.GZ=b,b.OT())},b}(S),b.HideRowFilter=T,U=function(){function a(){this.hZ()}return a.prototype.lZ=function(a){if(this.empty)return!0;var b=this.rowsVisibleInfo[a];return!!w(b)||b},a.prototype.D4=function(a,b){var c,d,e,f,g,h,i,j,k=[],l=this.rowsVisibleInfo;for(c=0,d=a.length;c<d;c++)e=a[c],f=l[e],f!==t&&f!==s&&k.push(e),delete l[e];for(g=0,h=b.length;g<h;g++)i=b[g],j=l[i],j!==t&&j!==s||k.push(i),l[i]=!1;return this.empty=!1,k},a.prototype.hZ=function(){this.rowsVisibleInfo={},this.empty=!0},a.prototype.C_a=function(a,b){var c,d,e=this.rowsVisibleInfo;for(d=0;d<b;d++)c=e[d+a],w(c)||delete e[d+a]},a.prototype.NTa=function(a,b){var c,d,e,f,g=this.rowsVisibleInfo,h={},i=Object.keys(g);for(d=0,e=i;d<e.length;d++)f=e[d],c=+f,c>=a?h[c+b]=g[c]:h[c]=g[c];this.rowsVisibleInfo=h},a.prototype.PTa=function(a,b){var c,d,e,f,g=this.rowsVisibleInfo,h={},i=Object.keys(g),j=a+b;for(d=0,e=i;d<e.length;d++)f=e[d],c=+f,c>=a&&c<j?delete g[c]:c>=j?h[c-b]=g[c]:h[c]=g[c];this.rowsVisibleInfo=h},a.prototype.mZ=function(){return!this.empty},a.prototype.clone=function(){var b=new a;return b.rowsVisibleInfo=G.extend({},this.rowsVisibleInfo),b.empty=this.empty,b},a}();function Oa(a,b,c,e){var f=a.typeName,g,h;f&&f!==E?(g=d.getTypeFromString(f),g&&(h=new g)):h=new T,h&&(b.xr=h,h.kj=b,h.fromJSON(a,c),h.E$J=!!e,e&&h.reFilter())}function Pa(a,b,c,e){var f,g,h,i=a.lossless&&a.lossless.typeName;i&&i!==E?(f=d.getTypeFromString(i),f&&(g=new f)):g=new T,g&&(b.xr=g,g.kj=b,g.cdK(a,void 0,c),h=b.parent,h&&h.options.allowAutoExtendFilterRange!==!0&&(h.options.allowAutoExtendFilterRange=!0),g.E$J=!!e,e&&g.reFilter())}function Qa(a){a&&(a.bind("shiftCellsDown"+F,function(b,c){var d,e,f,g,h=a.rowFilter();h&&(d=c.row,e=c.col,f=c.changedRowCount,g=c.changedColCount,h.range.row+h.range.rowCount===d&&(d-=1),h.range.col+h.range.colCount===e&&1!==h.range.colCount&&(e-=1),h.range.contains(d,e,1,1)&&(f>0?h.rI(d,f):f<0&&h.GR(d,f),g>0?h.tI(e,g):g<0&&h.HR(e,g)))}),a.bind(d.Events.CellChanged+F,function(){Ra(a,!0)}),a.bind(d.Events.RangeChanged+F,function(){Ra(a,!0)}),a.bind(d.Events.RowChanged+F,function(){Ra(a,!0)}),a.bind(d.Events.ColumnChanged+F,function(){Ra(a,!0)}))}function Ra(a,b){var c=a.rowFilter();c&&(c.HYJ=b)}function Sa(a){a&&(a.unbind("shiftCellsDown"+F),a.unbind(d.Events.CellChanged+F),a.unbind(d.Events.RangeChanged+F),a.unbind(d.Events.RowChanged+F),a.unbind(d.Events.ColumnChanged+F))}function Ta(a,b,c){void 0===c&&(c=0);var d=b.row,e=b.col,f=b.rowCount,g=b.colCount;return d===-1&&(d=c,f=a.getRowCount()),e===-1&&(e=0,g=a.getColumnCount()),d<=0?d=0:(d--,f+=1),v(d,e,f,g)}V={init:function(){var a=this;a.xr=s,a.filterRowsVisibleInfo=new U,a.Wr.push({Xr:function(b){return a.filterRowsVisibleInfo.lZ(b)}}),Qa(a)},getUsedRange:function(a){var b,c,e;a.type&d.UsedRangeType.filter&&(b=this,c=b.xr,e=c&&c.getUsedRange(),K(a.range,e))},processMouseDown:function(a){var b=a.hitInfo.filterButtonHitInfo;b&&(b.rowFilter.openFilterDialog(b),a.r=!0)},onLayoutChanged:function(a){var b,c=this,d=a.changeType,e=a.row,f=a.rowCount,g=a.col,h=a.colCount,i=c.xr;return"invalidateLayout"===d?void(c.kZ=s):void(i&&(b=c.ITa,"addRows"===d?b.hVa(e,f,a.rowExpand):"deleteRows"===d?b.iVa(e,f):"addColumns"===d?b.jVa(g,h):"deleteColumns"===d?b.kVa(g,h):"clear"===d&&i.range&&b.lVa(e,g,f,h)))},dispose:function(a){var b=this,c=b.GZ,d=a&&a.clearCache;c&&c.close(),d!==!1&&Sa(b)},toJson:function(a,b){var c=this.xr,d=b&&b.ignoreStyle;c&&!d&&(a.rowFilter=c.toJSON())},bdK:function(a,b,c){var d=this.xr,e=c&&c.includeStyles===!1;!d||e||this.ODJ||d.bdK(a,b.styleManager,c)},cdK:function(a,b,c){var d,e=c&&c.includeStyles===!1,f=c&&c.isApplyRefilter;e||(d=k(a,"autoFilter"),w(d)||Pa(d,this,b.styleManager,f))},fromJson:function(a,b,c){var d=a.rowFilter,e=a.isApplyRefilter,f=c&&c.ignoreStyle;d&&!f&&Oa(d,this,b,e)},paintCell:function(a){var b,c,e,f,h,j,k,l,m,n,o,p,q,r=this,s=a.cell,t=s.width,u=s.height,v=s.cellLayout,w=r.vu(),x=r.jZ(),y=[],z=a.ctx;if(s&&s.cornerX&&0!==s.columnHeaderFitMode&&(b=s.columnHeaderFitMode,c=s.cornerX,e=c-s.x),(!v||!B(y,v))&&x&&t>0&&u>0&&(f=s.baseRow||s.row,h=s.baseCol||s.col,j=$(x,f,h,a.sheetArea))){k=new g.eY(j.rowFilter,j.row,j.col,j.sheetArea,s.x,s.y,t,u),l=r.oK(new d.Rect(k.x,k.y,k.width,k.height),k.sheetArea,{cellWidth:e,columnHeaderFitMode:b}),m=l.width,n=l.height,o=l.x,p=l.y,q=i.getFilterButtonImageSrc(k.ko()),z.save(),z.rect(k.x,k.y,k.width,k.height),z.clip(),z.beginPath(),z.lineWidth=1,z.fillStyle="#FFFFFF",z.strokeStyle="#CCCCCC",z.fillRect(o+1,p+1,m-3,n-3),z.strokeRect(o+1-.5,p+2-.5,m-3,n-4);try{w.ko(q)?z.drawImage(w.lo(q),o,p+1,m-3,n-3):w.fo(q)}catch(a){}z.beginPath(),z.restore()}}},d.Worksheet.$n("filter",V),W={init:function(){d.Commands.fVa(this.commandManager())},onCultureChanged:function(){J()}},d.Workbook.$n("filter",W);function Ua(a){var b,c=[],d=Object.keys(a);for(b=0;b<d.length;b++)c.push(+d[b]);return c}function Va(a,b){b&&(a.filterRowsVisibleInfo=b)}G.extend(d.lUa.prototype,{gVa:function(a,b,c,d){var e,f,g,h=this,i=h.zTa;if(i){switch(i.originalFilter||(i.originalFilter=[]),e={type:b,newState:d,rowFilter:a},b){case 0:f=void 0,f=a?{range:a.range,typeName:a.typeName,filteredColumns:a.Je.concat([]),filteredItems:a.yZ.concat([]),filterItemMap:a.rZ.concat([]),filteredInRowsWithColIndexs:G.extend({},a.Q8J),filterButtonVisibleInfo:G.extend({},a.qZ),sortInfo:G.extend({},a.zZ)}:s,g=h.kj.filterRowsVisibleInfo.clone(),e.changeInfo={rowFilter:f,filterRowsVisibleInfo:g};break;case 2:case 7:e.changeInfo={filteredColumns:a.Je.concat([]),filterRowsVisibleInfo:h.kj.filterRowsVisibleInfo.clone()};break;case 1:e.changeInfo=a.zZ;break;case 3:e.changeInfo=G.extend({},a.qZ);break;case 4:e.changeInfo={col:c,val:a.qZ[c]};break;case 5:case 6:e.changeInfo={filterItemMap:a.rZ.concat([]),filterRowsVisibleInfo:h.kj.filterRowsVisibleInfo.clone(),filteredColumns:a.Je.concat([])};break;case 8:e.changeInfo={range:a.range,filteredColumns:a.Je.concat([]),filteredItems:a.yZ.concat([]),filteredInRowsWithColIndexs:G.extend({},a.Q8J),filterButtonVisibleInfo:G.extend({},a.qZ),sortInfo:G.extend({},a.zZ),filterRowsVisibleInfo:h.kj.filterRowsVisibleInfo.clone()};break;case 9:case 10:e.changeInfo={range:a.range,filteredInRowsWithColIndexs:G.extend({},a.Q8J),filteredColumns:a.Je.concat([]),filterRowsVisibleInfo:h.kj.filterRowsVisibleInfo.clone()};break;case 11:case 12:e.changeInfo={range:a.range,sortInfo:G.extend({},a.zZ),filterItemMap:a.rZ.concat([]),filteredColumns:a.Je.concat([]),filterRowsVisibleInfo:h.kj.filterRowsVisibleInfo.clone()};break;case 13:e.changeInfo={filteredInRowsWithColIndexs:G.extend({},a.Q8J),filteredItems:a.yZ.concat([]),filteredColumns:a.Je.concat([])};break;case 14:e.changeInfo={range:a.range}}i.originalFilter.push(e)}},nVa:function(a){var b,c,d=this,f=d.kj,g=a.rowFilter,h=a.changeInfo;if(g||0===a.type){if(g&&"Object"===g.constructor.name){if(!g.range)return;g.tableName?(b=f.tables.findByName(g.tableName),b&&(g=b.rowFilter())):h&&h.rowFilter?Oa(a.rowFilter,f,!1):g=f.rowFilter()}switch(h&&h.filterRowsVisibleInfo&&"Object"===h.filterRowsVisibleInfo.constructor.name&&(c=new U,c.rowsVisibleInfo=e.Common.j.Ia({},h.filterRowsVisibleInfo.rowsVisibleInfo),c.empty=h.filterRowsVisibleInfo.empty,h.filterRowsVisibleInfo=c),a.type){case 0:h.rowFilter&&"Object"!==h.rowFilter.constructor.name?h.rowFilter?f.xr=G.extend(g,h.rowFilter):f.xr=h.rowFilter:h.rowFilter||(f.xr=null),Va(f,h.filterRowsVisibleInfo);break;case 1:g.zZ=h;break;case 3:g.qZ=h;break;case 4:g.qZ[h.col]=h.val;break;case 5:case 6:g.rZ=h.filterItemMap,g.Je=h.filteredColumns,Va(f,h.filterRowsVisibleInfo);break;case 2:case 7:g.Je=h.filteredColumns,Va(f,h.filterRowsVisibleInfo);break;case 8:G.extend(g,h),Va(f,h.filterRowsVisibleInfo);break;case 9:case 10:g.range=h.range,g.Q8J=h.filteredInRowsWithColIndexs,g.Je=h.filteredColumns,Va(f,h.filterRowsVisibleInfo);break;case 11:case 12:g.range=h.range,g.zZ=h.sortInfo,g.rZ=h.filterItemMap,g.Je=h.filteredColumns,Va(f,h.filterRowsVisibleInfo);break;case 13:g.Q8J=h.filteredInRowsWithColIndexs,g.yZ=h.filteredItems,g.Je=h.filteredColumns;break;case 14:g.range=h.range}}},oVa:function(a,b){var c,d,e=D(a);if(b)for(c=0;c<e;c++)d=a[c],d.newState&&this.nVa(d);else for(c=e-1;c>=0;c--)d=a[c],d.newState||this.nVa(d)},hVa:function(a,b,c){var d=this.kj.xr;d&&(this.gVa(d,9),d.rI(a,b,c),this.gVa(d,9,t,!0))},iVa:function(a,b){var c=this.kj.xr;c&&(this.gVa(c,10),c.GR(a,b),this.gVa(c,10,t,!0))},jVa:function(a,b){var c=this.kj.xr;c&&(this.gVa(c,11),c.tI(a,b),this.gVa(c,11,t,!0))},kVa:function(a,b){var c=this.kj.xr;c&&(this.gVa(c,12),c.HR(a,b),this.gVa(c,12,t,!0))},lVa:function(a,b,c,d){var e=this.kj.xr;e&&e.$b(a,b,c,d)}}),d.lUa.$n("filter",{applyChanges:function(a){var b=a.changes,c=a.isUndo,d=b&&b.originalFilter;d&&D(d)&&this.oVa(d,!c)},undo:function(a){var b=a.originalFilter;D(b)&&this.oVa(b)}})},"./dist/plugins/filter/filter.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_InvalidColumnIndex="Invalid column index.",b.SortAscending="Sort Ascending",b.SortDescending="Sort Descending",b.OK="OK",b.Cancel="Cancel",b.Search="Search",b.CheckAll="Check all",b.UncheckAll="Uncheck all",b.Blanks="(Blanks)",b.Exp_FilterItemIsNull="FilterItem is null.",b.Show="Show",b.ShowRows="Show rows where:",b.And="And",b.Or="Or",b.SortColor="Sort By Color",b.FilterColor="Filter By Color",b.FilterCellTitle="Filter By Cell Color",b.FilterFontTitle="Filter By Font Color",b.SortCellTitle="Sort By Cell Color",b.SortFontTitle="Sort By Font Color",b.FontColor="More Font Colors...",b.CellColor="More Cell Colors...",b.NoFill="No Fill",b.Automatic="Automatic",b.Clear="Clear Filter From {0}",b.TextFilter="Text Filters",b.DateFilter="Date Filters",b.NumberFilter="Number Filters",b.Custom="Custom Filter...",b.Equal="Equals...",b.NotEqual="Does Not Equal...",b.GreaterThan="Greater Than...",b.GreaterOrEquals="Greater Than Or Equal To...",b.LessThan="Less Than...",b.LessThanOrEquals="Less Than Or Equal To...",b.Between="Between...",b.Top10="Top 10...",b.AboveAverage="Above Average",b.BelowAverage="Below Average",b.Begin="Begins With...",b.End="Ends With...",b.Contain="Contains...",b.NotContain="Does Not Contain...",b.Before="Before...",b.After="After...",b.Tomorrow="Tomorrow",b.Today="Today",b.Yesterday="Yesterday",b.NextWeek="Next Week",b.ThisWeek="This Week",b.LastWeek="Last Week",b.NextMonth="Next Month",b.ThisMonth="This Month",b.LastMonth="Last Month",b.NextQuarter="Next Quarter",b.ThisQuarter="This Quarter",b.LastQuarter="Last Quarter",b.NextYear="Next Year",b.ThisYear="This Year",b.LastYear="Last Year",b.YearToDate="Year To Date",b.AllDates="All Dates in Period",b.Top10Filter="Top 10 Auto Filter",b.CustomTitle="Custom AutoFilter",b.ColorTitle="Available Cell Colors",b.top="top",b.bottom="bottom",b.SortCell="Select a cell color to sort by:",b.SortFont="Select a font color to sort by:",b.FilterCell="Select a cell color to filter by:",b.FilterFont="Select a font color to filter by:",b.Selected="Selected:",b.IsEquals="equals",b.NotEquals="does not equal",b.IsGreaterThan="is greater than",b.IsGreaterOrEqual="is greater than or equal to",b.IsLess="is less than",b.LessOrEqual="is less than or equal to",b.IsBeginWith="begins with",b.NotBeginWith="does not begin with",b.IsEndWith="ends with",b.NotEndWith="does not end with",b.IsContain="contains",b.NotContains="does not contain",b.IsAfter="is after",b.AfterOrEqual="is after or equal to",b.IsBefore="is before",b.BeforeOrEqual="is before or equal to",b.Q1="Quarter 1",b.Q2="Quarter 2",b.Q3="Quarter 3",b.Q4="Quarter 4",b.Jan="January",b.Feb="February",b.Mar="March",b.Apr="April",b.May="May",b.Jun="June",b.Jul="July",b.Aug="August",b.Sep="September",b.Oct="October",b.Nov="November",b.Dec="December",b.Explain1="Use ? to represent any single character",b.Explain2="Use * to represent any series of characters",b.Year="",b.Day="",b.add_current_filter="Add current selection to filter",b.invalidCondition="Error in parse line"},"./dist/plugins/floatingObject/drawing/StatefulChartElementBase.js":function(a,b,c){"use strict";var d,e,f,g,h=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/floatingObject/drawing/stateful.js"),e=c("./dist/plugins/floatingObject/drawing/common.js"),f=null,g=function(a){h(b,a);function b(b){return a.call(this,b)||this}return Object.defineProperty(b.prototype,"ChartFormat",{get:function(){var a=this;return e.UnitHelper.isNullOrUndefined(a.Kb)&&(a.Kb=a.GetDefaultFormat()),a.Kb},set:function(a){var b,c=this;e.UnitHelper.isNullOrUndefined(c.Kb)||c.Kb.SetParentForChildren(a),b=c.Kb,c.Kb=a,e.UnitHelper.isNullOrUndefined(b)||(c.Kb.ParentStateful=b.ParentStateful)},enumerable:!0,configurable:!0}),b.prototype.CreateFormat=function(){return f},b.prototype.GetDefaultFormat=function(){return this.CreateFormat()},b.prototype.GetFormatInternal=function(){return this.Kb},b.prototype.FromShapeProperties=function(a){var b=this;e.UnitHelper.isNullOrUndefined(a)?b.ClearFormat():(e.UnitHelper.isNullOrUndefined(b.Kb)&&(b.Kb=b.CreateFormat()),b.Kb.FromOOModel(a))},b.prototype.FromSJSShapeProperties=function(a){var b=this;e.UnitHelper.isNullOrUndefined(a)?b.ClearFormat():(e.UnitHelper.isNullOrUndefined(b.Kb)&&(b.Kb=b.CreateFormat()),b.Kb.FromSJSOOModel(a))},b.prototype.ToShapeProperties=function(){return e.UnitHelper.isNullOrUndefined(this.Kb)?f:this.Kb.ToOOModel()},b.prototype.ToSJSShapeProperties=function(){return e.UnitHelper.isNullOrUndefined(this.Kb)?f:this.Kb.ToSJSOOModel()},b.prototype.Delete=function(){e.UnitHelper.isNullOrUndefined(this.Kb)||(this.Kb.ParentStateful=f)},b.prototype.ClearFormat=function(){var a=this;e.UnitHelper.isNullOrUndefined(a.Kb)||(a.Kb.SetParentForChildren(f),a.Kb.ParentStateful=f,a.Kb=f)},b}(d.StatefulBase),b.StatefulChartElementBase=g},"./dist/plugins/floatingObject/drawing/chart.ns.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/floatingObject/drawing/drawingInterface.js")),d(c("./dist/plugins/floatingObject/drawing/stateful.js")),d(c("./dist/plugins/floatingObject/drawing/common.js")),d(c("./dist/plugins/floatingObject/drawing/color.js")),d(c("./dist/plugins/floatingObject/drawing/colorData.js")),d(c("./dist/plugins/floatingObject/drawing/colorFormat.js")),d(c("./dist/plugins/floatingObject/drawing/effects.js")),d(c("./dist/plugins/floatingObject/drawing/fillFormat.js")),d(c("./dist/plugins/floatingObject/drawing/fontData.js")),d(c("./dist/plugins/floatingObject/drawing/fontFormat.js")),d(c("./dist/plugins/floatingObject/drawing/gradient.js")),d(c("./dist/plugins/floatingObject/drawing/lineFormat.js")),d(c("./dist/plugins/floatingObject/drawing/picture.js")),d(c("./dist/plugins/floatingObject/drawing/threeDFormat.js")),d(c("./dist/plugins/floatingObject/drawing/StatefulChartElementBase.js"))},"./dist/plugins/floatingObject/drawing/color.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/plugins/floatingObject/drawing/common.js"),f=c("./dist/plugins/floatingObject/drawing/drawingInterface.js"),g=d.Common.pc,h=e.UnitHelper.isNullOrUndefined,i=null,j=function(){function a(a,b,c,d){var e=this;e.value=a,e.state=b,e.name=c,e.knownColor=d}return a.FromKnownColor=function(b){return new a(0,a.StateKnownColorValid,i,b)},a.FromIndexedColor=function(b,c){var d=a.IndexedColors;return d||(d=a.IndexedColors=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,a.FromKnownColor(k.WindowText).ToArgb(),a.FromKnownColor(k.Window).ToArgb()]),a.FromArgb(d[b]).GetTintColor(c)},a.FromArgb=function(b){return new a(b,a.StateARGBValueValid,i,0)},a.FromArgbs=function(b,c,d,e){
return a.CheckByte(b,"alpha"),a.CheckByte(c,"red"),a.CheckByte(d,"green"),a.CheckByte(e,"blue"),new a(a.MakeArgb(b,c,d,e),a.StateARGBValueValid,i,0)},a.FromBaseColor=function(b,c){return a.CheckByte(b,"alpha"),new a(a.MakeArgb(b,c.R,c.G,c.B),a.StateARGBValueValid,i,0)},a.FromRgb=function(b,c,d){return a.FromArgbs(255,b,c,d)},a.CheckByte=function(a,b){if(a<0||a>255)throw Error("InvalidEx2BoundArgument")},a.MakeArgb=function(a,b,c,d){var e=Math.pow(2,24);return e*a+(b<<16|c<<8|d)},Object.defineProperty(a.prototype,"Transparent",{get:function(){return a.FromKnownColor(k.Transparent)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"R",{get:function(){return this.Value>>16&255},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"G",{get:function(){return this.Value>>8&255},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"B",{get:function(){return 255&this.Value},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"A",{get:function(){return this.Value>>24&255},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"IsKnownColor",{get:function(){return 0!==(this.state&a.StateKnownColorValid)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"IsEmpty",{get:function(){return 0===this.state},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"IsNamedColor",{get:function(){return 0!==(this.state&a.StateNameValid)||this.IsKnownColor},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"IsSystemColor",{get:function(){return!!this.IsKnownColor&&(!(this.knownColor>26)||this.knownColor>167)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Name",{get:function(){var b,c=this;return 0!==(c.state&a.StateNameValid)?c.name:c.IsKnownColor?(b=m.KnownColorToName(c.knownColor),h(b)?"":b):c.value.toString(16)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Value",{get:function(){var b=this;return 0!==(b.state&a.StateValueMask)?b.value:b.IsKnownColor?m.KnownColorToArgb(b.knownColor):a.NotDefinedValue},enumerable:!0,configurable:!0}),a.prototype.Equals=function(b){return b instanceof a&&this.Value===b.Value},a.prototype.GetTintColor=function(b){var c,d=this;return 0===b||h(b)?d:(c=g.jc({r:d.R,g:d.G,b:d.B},b),a.FromArgbs(c.a,c.r,c.g,c.b))},a.prototype.GetBrightness=function(){var a=this.R/255,b=this.G/255,c=this.B/255,d=a,e=a;return b>d&&(d=b),c>d&&(d=c),b<e&&(e=b),c<e&&(e=c),(d+e)/2},a.prototype.GetHue=function(){var a,b,c,d,e,f,g,h=this;return h.R===h.G&&h.G===h.B?0:(a=h.R/255,b=h.G/255,c=h.B/255,d=0,e=a,f=a,b>e&&(e=b),c>e&&(e=c),b<f&&(f=b),c<f&&(f=c),g=e-f,a===e?d=(b-c)/g:b===e?d=2+(c-a)/g:c===e&&(d=4+(a-b)/g),d*=60,d<0&&(d+=360),d)},a.prototype.GetSaturation=function(){var a,b=this.R/255,c=this.G/255,d=this.B/255,e=0,f=b,g=b;return c>f&&(f=c),d>f&&(f=d),c<g&&(g=c),d<g&&(g=d),f===g?e:(a=(f+g)/2,a<=.5?(f-g)/(f+g):(f-g)/(2-f-g))},a.prototype.ToArgb=function(){return this.Value},a.prototype.ToKnownColor=function(){return this.knownColor},a.prototype.ToString=function(){var b=this,c="ARGBColor";return c+=" [",0!==(b.state&a.StateNameValid)?c+=b.Name:0!==(b.state&a.StateKnownColorValid)?c+=b.Name:0!==(b.state&a.StateValueMask)?(c+="A=",c+=b.A,c+=", R=",c+=b.R,c+=", G=",c+=b.G,c+=", B=",c+=b.B):c+="Empty",c+="]"},a.StateKnownColorValid=1,a.StateARGBValueValid=2,a.StateValueMask=2,a.StateNameValid=8,a.NotDefinedValue=0,a}(),b.ARGBColor=j,e.ChartUtility.Kqa=function(a,b){var c,d,h=b.ColorType;return h===f.ColorType.Index?j.FromIndexedColor(b.Value,b.Tint):h===f.ColorType.Theme?(c=e.ChartUtility.toThemeColorString(b.Value,b.Tint),d=g.ec(a.getColor(c)),b.Transparency&&(d.a=parseInt(255*(1-b.Transparency)+"",10)),j.FromArgbs(d.a,d.r,d.g,d.b)):h===f.ColorType.Auto?j.FromKnownColor(k.WindowText):h===f.ColorType.None?new j:j.FromArgb(b.Value).GetTintColor(b.Tint)},function(a){a[a.ActiveBorder=1]="ActiveBorder",a[a.ActiveCaption=2]="ActiveCaption",a[a.ActiveCaptionText=3]="ActiveCaptionText",a[a.AliceBlue=28]="AliceBlue",a[a.AntiqueWhite=29]="AntiqueWhite",a[a.AppWorkspace=4]="AppWorkspace",a[a.Aqua=30]="Aqua",a[a.Aquamarine=31]="Aquamarine",a[a.Azure=32]="Azure",a[a.Beige=33]="Beige",a[a.Bisque=34]="Bisque",a[a.Black=35]="Black",a[a.BlanchedAlmond=36]="BlanchedAlmond",a[a.Blue=37]="Blue",a[a.BlueViolet=38]="BlueViolet",a[a.Brown=39]="Brown",a[a.BurlyWood=40]="BurlyWood",a[a.ButtonFace=168]="ButtonFace",a[a.ButtonHighlight=169]="ButtonHighlight",a[a.ButtonShadow=170]="ButtonShadow",a[a.CadetBlue=41]="CadetBlue",a[a.Chartreuse=42]="Chartreuse",a[a.Chocolate=43]="Chocolate",a[a.Control=5]="Control",a[a.ControlDark=6]="ControlDark",a[a.ControlDarkDark=7]="ControlDarkDark",a[a.ControlLight=8]="ControlLight",a[a.ControlLightLight=9]="ControlLightLight",a[a.ControlText=10]="ControlText",a[a.Coral=44]="Coral",a[a.CornflowerBlue=45]="CornflowerBlue",a[a.Cornsilk=46]="Cornsilk",a[a.Crimson=47]="Crimson",a[a.Cyan=48]="Cyan",a[a.DarkBlue=49]="DarkBlue",a[a.DarkCyan=50]="DarkCyan",a[a.DarkGoldenrod=51]="DarkGoldenrod",a[a.DarkGray=52]="DarkGray",a[a.DarkGreen=53]="DarkGreen",a[a.DarkKhaki=54]="DarkKhaki",a[a.DarkMagenta=55]="DarkMagenta",a[a.DarkOliveGreen=56]="DarkOliveGreen",a[a.DarkOrange=57]="DarkOrange",a[a.DarkOrchid=58]="DarkOrchid",a[a.DarkRed=59]="DarkRed",a[a.DarkSalmon=60]="DarkSalmon",a[a.DarkSeaGreen=61]="DarkSeaGreen",a[a.DarkSlateBlue=62]="DarkSlateBlue",a[a.DarkSlateGray=63]="DarkSlateGray",a[a.DarkTurquoise=64]="DarkTurquoise",a[a.DarkViolet=65]="DarkViolet",a[a.DeepPink=66]="DeepPink",a[a.DeepSkyBlue=67]="DeepSkyBlue",a[a.Desktop=11]="Desktop",a[a.DimGray=68]="DimGray",a[a.DodgerBlue=69]="DodgerBlue",a[a.Firebrick=70]="Firebrick",a[a.FloralWhite=71]="FloralWhite",a[a.ForestGreen=72]="ForestGreen",a[a.Fuchsia=73]="Fuchsia",a[a.Gainsboro=74]="Gainsboro",a[a.GhostWhite=75]="GhostWhite",a[a.Gold=76]="Gold",a[a.Goldenrod=77]="Goldenrod",a[a.GradientActiveCaption=171]="GradientActiveCaption",a[a.GradientInactiveCaption=172]="GradientInactiveCaption",a[a.Gray=78]="Gray",a[a.GrayText=12]="GrayText",a[a.Green=79]="Green",a[a.GreenYellow=80]="GreenYellow",a[a.Highlight=13]="Highlight",a[a.HighlightText=14]="HighlightText",a[a.Honeydew=81]="Honeydew",a[a.HotPink=82]="HotPink",a[a.HotTrack=15]="HotTrack",a[a.InactiveBorder=16]="InactiveBorder",a[a.InactiveCaption=17]="InactiveCaption",a[a.InactiveCaptionText=18]="InactiveCaptionText",a[a.IndianRed=83]="IndianRed",a[a.Indigo=84]="Indigo",a[a.Info=19]="Info",a[a.InfoText=20]="InfoText",a[a.Ivory=85]="Ivory",a[a.Khaki=86]="Khaki",a[a.Lavender=87]="Lavender",a[a.LavenderBlush=88]="LavenderBlush",a[a.LawnGreen=89]="LawnGreen",a[a.LemonChiffon=90]="LemonChiffon",a[a.LightBlue=91]="LightBlue",a[a.LightCoral=92]="LightCoral",a[a.LightCyan=93]="LightCyan",a[a.LightGoldenrodYellow=94]="LightGoldenrodYellow",a[a.LightGray=95]="LightGray",a[a.LightGreen=96]="LightGreen",a[a.LightPink=97]="LightPink",a[a.LightSalmon=98]="LightSalmon",a[a.LightSeaGreen=99]="LightSeaGreen",a[a.LightSkyBlue=100]="LightSkyBlue",a[a.LightSlateGray=101]="LightSlateGray",a[a.LightSteelBlue=102]="LightSteelBlue",a[a.LightYellow=103]="LightYellow",a[a.Lime=104]="Lime",a[a.LimeGreen=105]="LimeGreen",a[a.Linen=106]="Linen",a[a.Magenta=107]="Magenta",a[a.Maroon=108]="Maroon",a[a.MediumAquamarine=109]="MediumAquamarine",a[a.MediumBlue=110]="MediumBlue",a[a.MediumOrchid=111]="MediumOrchid",a[a.MediumPurple=112]="MediumPurple",a[a.MediumSeaGreen=113]="MediumSeaGreen",a[a.MediumSlateBlue=114]="MediumSlateBlue",a[a.MediumSpringGreen=115]="MediumSpringGreen",a[a.MediumTurquoise=116]="MediumTurquoise",a[a.MediumVioletRed=117]="MediumVioletRed",a[a.Menu=21]="Menu",a[a.MenuBar=173]="MenuBar",a[a.MenuHighlight=174]="MenuHighlight",a[a.MenuText=22]="MenuText",a[a.MidnightBlue=118]="MidnightBlue",a[a.MintCream=119]="MintCream",a[a.MistyRose=120]="MistyRose",a[a.Moccasin=121]="Moccasin",a[a.NavajoWhite=122]="NavajoWhite",a[a.Navy=123]="Navy",a[a.OldLace=124]="OldLace",a[a.Olive=125]="Olive",a[a.OliveDrab=126]="OliveDrab",a[a.Orange=127]="Orange",a[a.OrangeRed=128]="OrangeRed",a[a.Orchid=129]="Orchid",a[a.PaleGoldenrod=130]="PaleGoldenrod",a[a.PaleGreen=131]="PaleGreen",a[a.PaleTurquoise=132]="PaleTurquoise",a[a.PaleVioletRed=133]="PaleVioletRed",a[a.PapayaWhip=134]="PapayaWhip",a[a.PeachPuff=135]="PeachPuff",a[a.Peru=136]="Peru",a[a.Pink=137]="Pink",a[a.Plum=138]="Plum",a[a.PowderBlue=139]="PowderBlue",a[a.Purple=140]="Purple",a[a.Red=141]="Red",a[a.RosyBrown=142]="RosyBrown",a[a.RoyalBlue=143]="RoyalBlue",a[a.SaddleBrown=144]="SaddleBrown",a[a.Salmon=145]="Salmon",a[a.SandyBrown=146]="SandyBrown",a[a.ScrollBar=23]="ScrollBar",a[a.SeaGreen=147]="SeaGreen",a[a.SeaShell=148]="SeaShell",a[a.Sienna=149]="Sienna",a[a.Silver=150]="Silver",a[a.SkyBlue=151]="SkyBlue",a[a.SlateBlue=152]="SlateBlue",a[a.SlateGray=153]="SlateGray",a[a.Snow=154]="Snow",a[a.SpringGreen=155]="SpringGreen",a[a.SteelBlue=156]="SteelBlue",a[a.Tan=157]="Tan",a[a.Teal=158]="Teal",a[a.Thistle=159]="Thistle",a[a.Tomato=160]="Tomato",a[a.Transparent=27]="Transparent",a[a.Turquoise=161]="Turquoise",a[a.Violet=162]="Violet",a[a.Wheat=163]="Wheat",a[a.White=164]="White",a[a.WhiteSmoke=165]="WhiteSmoke",a[a.Window=24]="Window",a[a.WindowFrame=25]="WindowFrame",a[a.WindowText=26]="WindowText",a[a.Yellow=166]="Yellow",a[a.YellowGreen=167]="YellowGreen"}(k=b.KnownColor||(b.KnownColor={})),l=function(a){a[1]=4290032820,a[2]=4288263377,a[3]=4278190080,a[4]=4289440683,a[5]=4293980400,a[6]=4288716960,a[7]=4285098345,a[8]=4293125091,a[9]=4294967295,a[10]=4278190080,a[11]=4278190080,a[12]=4285361517,a[13]=4281571839,a[14]=4294967295,a[15]=4278216396,a[16]=4294244348,a[17]=4290760155,a[18]=4278190080,a[19]=4294967265,a[20]=4278190080,a[21]=4293980400,a[22]=4278190080,a[23]=4291348680,a[24]=4294967295,a[25]=4284769380,a[26]=4278190080,a[168]=4293980400,a[169]=4294967295,a[170]=4288716960,a[171]=4290367978,a[172]=4292338930,a[173]=4293980400,a[174]=4281571839},m=function(){function a(){}return a.ArgbToKnownColor=function(b){var c,d,e;for(this.EnsureColorTable(),c=0;c<a.colorTable.length;c++)if(d=a.colorTable[c],d===b&&(e=j.FromArgb(c),!e.IsSystemColor))return e;return j.FromArgb(b)},a.Encode=function(a,b,c,d){return b<<16|c<<8|d|a<<24},a.EnsureColorNameTable=function(){h(a.colorNameTable)&&a.InitColorNameTable()},a.EnsureColorTable=function(){h(a.colorTable)&&this.InitColorTable()},a.InitColorNameTable=function(){var b,c=[];for(b in k)k.hasOwnProperty(b)&&(c[k[b]]=b);a.colorNameTable=c},a.InitColorTable=function(){var b=[];l(b),b[27]=16777215,b[28]=-984833,b[29]=-332841,b[30]=-16711681,b[31]=-8388652,b[32]=-983041,b[33]=-657956,b[34]=-6972,b[35]=-16777216,b[36]=-5171,b[37]=-16776961,b[38]=-7722014,b[39]=-5952982,b[40]=-2180985,b[41]=-10510688,b[42]=-8388864,b[43]=-2987746,b[44]=-32944,b[45]=-10185235,b[46]=-1828,b[47]=-2354116,b[48]=-16711681,b[49]=-16777077,b[50]=-16741493,b[51]=-4684277,b[52]=-5658199,b[53]=-16751616,b[54]=-4343957,b[55]=-7667573,b[56]=-11179217,b[57]=-29696,b[58]=-6737204,b[59]=-7667712,b[60]=-1468806,b[61]=-7357301,b[62]=-12042869,b[63]=-13676721,b[64]=-16724271,b[65]=-7077677,b[66]=-60269,b[67]=-16728065,b[68]=-9868951,b[69]=-14774017,b[70]=-5103070,b[71]=-1296,b[72]=-14513374,b[73]=-65281,b[74]=-2302756,b[75]=-460545,b[76]=-10496,b[77]=-2448096,b[78]=-8355712,b[79]=-16744448,b[80]=-5374161,b[81]=-983056,b[82]=-38476,b[83]=-3318692,b[84]=-11861886,b[85]=-16,b[86]=-989556,b[87]=-1644806,b[88]=-3851,b[89]=-8586240,b[90]=-1331,b[91]=-5383962,b[92]=-1015680,b[93]=-2031617,b[94]=-329006,b[95]=-2894893,b[96]=-7278960,b[97]=-18751,b[98]=-24454,b[99]=-14634326,b[100]=-7876870,b[101]=-8943463,b[102]=-5192482,b[103]=-32,b[104]=-16711936,b[105]=-13447886,b[106]=-331546,b[107]=-65281,b[108]=-8388608,b[109]=-10039894,b[110]=-16777011,b[111]=-4565549,b[112]=-7114533,b[113]=-12799119,b[114]=-8689426,b[115]=-16713062,b[116]=-12004916,b[117]=-3730043,b[118]=-15132304,b[119]=-655366,b[120]=-6943,b[121]=-6987,b[122]=-8531,b[123]=-16777088,b[124]=-133658,b[125]=-8355840,b[126]=-9728477,b[127]=-23296,b[128]=-47872,b[129]=-2461482,b[130]=-1120086,b[131]=-6751336,b[132]=-5247250,b[133]=-2396013,b[134]=-4139,b[135]=-9543,b[136]=-3308225,b[137]=-16181,b[138]=-2252579,b[139]=-5185306,b[140]=-8388480,b[141]=-65536,b[142]=-4419697,b[143]=-12490271,b[144]=-7650029,b[145]=-360334,b[146]=-744352,b[147]=-13726889,b[148]=-2578,b[149]=-6270419,b[150]=-4144960,b[151]=-7876885,b[152]=-9807155,b[153]=-9404272,b[154]=-1286,b[155]=-16711809,b[156]=-12156236,b[157]=-2968436,b[158]=-16744320,b[159]=-2572328,b[160]=-40121,b[161]=-12525360,b[162]=-1146130,b[163]=-663885,b[164]=-1,b[165]=-657931,b[166]=-256,b[167]=-6632142,a.colorTable=b},a.KnownColorToArgb=function(a){return this.EnsureColorTable(),a<=k.MenuHighlight?this.colorTable[a]:0},a.KnownColorToName=function(b){return this.EnsureColorNameTable(),b<=k.MenuHighlight?a.colorNameTable[b]:i},a.IsKnowColor=function(b){return a.EnsureColorTable(),a.colorTable.indexOf(b)!==-1},a}(),b.KnownColorTable=m},"./dist/plugins/floatingObject/drawing/colorData.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/floatingObject/drawing/drawingInterface.js"),function(a){a[a.None=0]="None",a[a.ColorType=1]="ColorType",a[a.Value=2]="Value",a[a.Tint=4]="Tint",a[a.All=7]="All"}(e=b.ColorDataFlag||(b.ColorDataFlag={})),f=function(){function a(){}return a.ConvertHexStringToInt=function(a){return parseInt(a,16)},a.prototype.Equals=function(a){return this.ColorType===a.ColorType&&this.Value===a.Value&&this.Tint===a.Tint},a.prototype.Clone=function(){return this},a.prototype.Compose=function(a,b){void 0===b&&(b=!0),a.Flag!==e.None&&(b?this.ConflictCompose(a):this.NonConflictCompose(a))},a.prototype.ConflictCompose=function(a){var b=this;(a.Flag&e.ColorType)===e.ColorType&&b.ColorType!==a.ColorType&&(b.ColorType=a.ColorType,b.Value=0,b.Tint=0),(a.Flag&e.Value)===e.Value&&(b.Value=a.Value),(a.Flag&e.Tint)===e.Tint&&(b.Tint=a.Tint),b.Flag|=a.Flag},a.prototype.NonConflictCompose=function(a){var b=this;(b.Flag&e.ColorType)!==e.ColorType&&(a.Flag&e.ColorType)===e.ColorType&&(b.ColorType=a.ColorType,b.Value=a.Value,b.Tint=a.Tint,b.Flag=a.Flag)},a.prototype.RemoveDuplicateStyle=function(a){return this.Compare(a,!1)},a.prototype.RemoveDifferentStyle=function(a){return this.Compare(a,!0)},a.prototype.Compare=function(a,b){var c,d,f,g=this,h=!1;return(g.Flag&e.ColorType)===e.ColorType&&(f=(a.Flag&e.ColorType)!==e.ColorType||g.ColorType!==a.ColorType,b?f?(g.Flag=e.None,h=!0):((g.Flag&e.Value)===e.Value&&(c=(a.Flag&e.Value)!==e.Value||g.Value!==a.Value,c&&(g.Flag=e.None,h=!0)),(g.Flag&e.Tint)===e.Tint&&(d=(a.Flag&e.Tint)!==e.Tint||g.Tint!==a.Tint,d&&(g.Flag=e.None,h=!0))):f||((g.Flag&e.Value)===e.Value&&(c=(a.Flag&e.Value)!==e.Value||g.Value!==a.Value,c||(g.Flag&=~e.Value,h=!0)),(g.Flag&e.Tint)===e.Tint&&(d=(a.Flag&e.Tint)!==e.Tint||g.Tint!==a.Tint,d||(g.Flag&=~e.Tint,h=!0)),g.Flag===e.ColorType&&(g.Flag=e.None,h=!0))),h},a.prototype.UpdateDefaultValueFlag=function(){this.ColorType===d.ColorType.None?this.Flag=e.None:this.Flag=e.All},a.prototype.UpdateFlagFromBottom=function(){},a.prototype.ClearFlag=function(){this.Flag=e.None},a.prototype.SetFullFlag=function(){this.Flag=e.All},a.prototype.IsFullFlag=function(){return this.Flag===e.All},a}(),b.ColorData=f},"./dist/plugins/floatingObject/drawing/colorFormat.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("./dist/plugins/floatingObject/drawing/colorData.js"),g=c("./dist/plugins/floatingObject/drawing/color.js"),h=c("./dist/plugins/floatingObject/drawing/common.js"),i=c("./dist/plugins/floatingObject/drawing/stateful.js"),j=c("./dist/plugins/floatingObject/drawing/drawingInterface.js"),k=e.Util.StringToByteArray,l=e.NodeHelper.pca,m=d.Common.pc,n=h.UnitHelper.isNullOrUndefined,o=h.ShapeConstants.DefaultTransparent,p=h.ShapeConstants.DefaultSatMod,q=h.ShapeConstants.PositionConver,r=null,s=Math.abs,t=Math.floor;function w(a,b){return a.getColor(b)!==b}b.createColorFormatFromRGB=function(a,b,c){var d=new u(a);return d.ColorType=b,d.RGB=c,d},b.createColorFormat=function(a,b,c,d){var e=new u(a);return e.ColorType=b,e.ObjectThemeColor=c,d&&(e.TintAndShade=d),e},u=function(a){v(b,a);function b(b,c){var d,e,f=a.call(this,c)||this;return void 0===c&&(c=r),d=f,d.Hqa=j.ColorSchemeIndex.None,d.Iqa=r,d.Yba=0,d.Jqa=0,d.Gqa=o,d.m5J=p,d.xc=b,d.hqa=c,e=d.xc.DrawingType,e===j.DrawingType.Shape?d.Xba=j.SolidColorType.Theme:e===j.DrawingType.Chart?d.Xba=j.SolidColorType.Automatic:e===j.DrawingType.Picture&&(d.Xba=j.SolidColorType.None),d}return b.prototype.setColor=function(a,b){var c,d,e=this;a&&w(a.currentTheme(),b)?(c=h.ChartUtility.fromThemeColorString(b),c&&(e.ObjectThemeColor=c.index,void 0!==c.tint&&(e.Brightness=c.tint))):(d=m.ec(b),e.RGB=g.ARGBColor.FromArgbs(d.a,d.r,d.g,d.b))},b.prototype.GetColorData=function(){var a,b,c,d,e=this,h=new f.ColorData;if(h.ColorType=j.ColorType.RGB,a=e.Xba,a===j.SolidColorType.None)h.ColorType=j.ColorType.None;else if(a===j.SolidColorType.Automatic){if(h.ColorType=j.ColorType.Auto,b=e.GetAutoColorFormat(),!n(b))return b.GetColorData()}else a===j.SolidColorType.RGB?n(e.Iqa)||(h.ColorType=j.ColorType.RGB,c=this.Iqa,d=1-e.Gqa,1!==d&&(c=g.ARGBColor.FromArgbs(parseInt(255*d,10),c.R,c.G,c.B)),h.Value=c.ToArgb(),h.Tint=e.Yba||e.Jqa):a===j.SolidColorType.Theme&&(h.ColorType=j.ColorType.Theme,h.Value=e.Hqa,h.Tint=e.Yba||e.Jqa,h.Transparency=e.Gqa);return h},b.prototype.HasOwnColor=function(){return this.GetState(j.ColorFormatStates.ObjectThemeColor)||this.GetState(j.ColorFormatStates.RGB)||this.GetAutoColorFormat()!==r},b.prototype.GetAutoColorFormat=function(){if(this.ColorType===j.SolidColorType.Automatic&&!n(this.AutoColorFormat)){var a=this.AutoColorFormat();if(!n(a)&&a.ColorType!==j.SolidColorType.Automatic)return a}return r},b.prototype.OnParentChanged=function(a){this.hqa=a},b.prototype.ClearModel=function(){var a,b,c;for(this.Lqa=r,this.BhK=r,a=0,b=this.Children;a<b.length;a++)c=b[a],c.ClearModel()},b.prototype.CalcBrightness=function(a,b){return a&&a.length>0&&b&&b.length>0?b[0]/q:a&&a.length>0?a[0]/q-1:0},b.prototype.CalcLumModeOff=function(a,b){var c=this;c.Brightness>0?(a.push(t((1-c.Brightness)*q)),b.push(t(c.Brightness*q))):c.Brightness<0&&a.push(t((1+c.Brightness)*q))},b.prototype.ieK=function(a){var b=this;b.Brightness>0?(a.lumMod={val:t((1-b.Brightness)*q)+""},a.lumOff={val:t(b.Brightness*q)+""}):b.Brightness<0&&(a.lumMod={val:t((1+b.Brightness)*q)+""})},b.prototype.FromCT_ColorProperties=function(a){var b,c,d,e,f,i,k,l,m=this;m.Lqa=a,n(a)?m.ColorType=j.SolidColorType.None:n(a.schemeClr)?n(a.srgbClr)||n(a.srgbClr.val)||3!==a.srgbClr.val.length?n(a.scrgbClr)?n(a.sysClr)?n(a.prstClr)||(k=a.prstClr,l=h.ChartUtility.GetPresetColorRGB(k.val),m.RGB=g.ARGBColor.FromRgb(l[0],l[1],l[2]),m.Brightness=m.CalcBrightness(k.lumMod,k.lumOff),!n(k.alpha)&&k.alpha.length>0&&m.FromTransparency(k.alpha[0])):(f=a.sysClr,i=f.val,n(i)?n(f.lastClr)||3!==f.lastClr.length||(m.RGB=g.ARGBColor.FromRgb(f.lastClr[0],f.lastClr[1],f.lastClr[2])):m.RGB=g.ARGBColor.FromKnownColor(i),m.Brightness=m.CalcBrightness(f.lumMod,f.lumOff),!n(f.alpha)&&f.alpha.length>0&&m.FromTransparency(f.alpha[0])):(e=a.scrgbClr,m.RGB=g.ARGBColor.FromRgb(e.r,e.g,e.b)):(d=a.srgbClr,m.RGB=g.ARGBColor.FromRgb(d.val[0],d.val[1],d.val[2]),m.Brightness=m.CalcBrightness(d.lumMod,d.lumOff),!n(d.alpha)&&d.alpha.length>0&&m.FromTransparency(d.alpha[0]),!n(d.tint)&&d.tint.length>0&&m.FromTint(d.tint[0]),!n(d.satMod)&&d.satMod.length>0&&m.FromSatMod(d.satMod[0])):(b=a.schemeClr,m.ObjectThemeColor=b.val,m.Brightness=m.CalcBrightness(b.lumMod,b.lumOff),m.Yba=0,!n(b.tint)&&b.tint.length>0&&m.FromTint(b.tint[0]),!n(b.alpha)&&b.alpha.length>0&&m.FromTransparency(b.alpha[0]),!n(b.satMod)&&b.satMod.length>0&&m.FromSatMod(b.satMod[0]),c=b.shade,c&&c.length&&m.FromShade(c[0]))},b.prototype.jeK=function(a){var b,c,d,e,f=this,g=a.lumMod,h=a.lumOff;g&&(g=[l(g.val)]),h&&(h=[l(h.val)]),f.Brightness=f.CalcBrightness(g,h),b=a.alpha,n(b)||f.FromTransparency(l(b.val)),f.Yba=0,c=a.tint,n(c)||f.FromTint(l(c.val)),d=a.shade,n(d)||f.FromShade(l(d.val)),e=a.satMod,n(e)||f.FromSatMod(l(e.val))},b.prototype.keK=function(a){a=a?a:{};var b=this;b.ieK(a),b.Transparency!==o&&(a.alpha={val:b.ToTransparency()+""}),b.TintAndShade>0?a.tint={val:b.ToTint()+""}:b.TintAndShade<0&&(a.shade={val:b.ToShade()+""}),b.SatMod!==p&&(a.satMod={val:b.ToSatMod()+""})},b.prototype.FromSJSCT_ColorProperties=function(a){var b,c,d,e,f,i,l,m,o,p=this;p.BhK=a,n(a)?p.ColorType=j.SolidColorType.None:n(a.schemeClr)?n(a.srgbClr)?n(a.scrgbClr)?n(a.sysClr)?n(a.prstClr)||(m=a.prstClr,o=h.ChartUtility.GetPresetColorRGB(+j.ST_PresetColorVal[m.val]),p.RGB=g.ARGBColor.FromRgb(o[0],o[1],o[2]),p.jeK(m)):(f=a.sysClr,i=f.val,n(i)?n(f.lastClr)||(l=k(f.lastClr),p.RGB=g.ARGBColor.FromRgb(l[0],l[1],l[2])):p.RGB=g.ARGBColor.FromKnownColor(z(+j.ST_SystemColorVal[i])),p.jeK(f)):(e=a.scrgbClr,p.RGB=g.ARGBColor.FromRgb(+e.r,+e.g,+e.b),p.jeK(e)):(c=a.srgbClr,d=k(c.val||c),d&&3===d.length&&(p.RGB=g.ARGBColor.FromRgb(d[0],d[1],d[2]),p.jeK(c))):(b=a.schemeClr,p.ObjectThemeColor=C(j.ST_SchemeColorVal[b.val||b]),p.jeK(b))},b.prototype.ToCT_ColorProperties=function(a){var b,c,d,e,f=this,g=f.Lqa||a,i=[],k=[],l=g.schemeClr;return l&&h.ChartUtility.removeEmptyArrayProperties(l),f.ColorType===j.SolidColorType.Theme?(x(g),l||(l=g.schemeClr={}),l.val=f.ObjectThemeColor,f.CalcLumModeOff(i,k),y(l,i,k),f.TintAndShade>0?l.tint=[f.ToTint()]:f.TintAndShade<0&&(l.shade=[f.ToShade()]),f.Transparency!==o&&(l.alpha=[f.ToTransparency()]),f.SatMod!==p&&(l.satMod=[f.ToSatMod()])):f.ColorType===j.SolidColorType.RGB&&(x(g),delete g.schemeClr,b=r,f.Iqa&&f.Iqa.IsKnownColor&&(b=f.Iqa.ToKnownColor()),n(b)?(d=g.srgbClr={},d.val=[f.RGB.R,f.RGB.G,f.RGB.B],f.CalcLumModeOff(i,k),y(d,i,k),f.Transparency!==o&&(d.alpha=[f.ToTransparency()]),f.SatMod!==p&&(d.satMod=[f.ToSatMod()]),f.TintAndShade>0?d.tint=[f.ToTint()]:f.TintAndShade<0&&(d.shade=[f.ToShade()])):(c=g.sysClr={},c.val=b,c.lastClr=[f.RGB.R,f.RGB.G,f.RGB.B],f.CalcLumModeOff(i,k),y(c,i,k),f.Transparency!==o&&(c.alpha=[f.ToTransparency()]))),e=a&&a.colorFillType,n(e)||(g.colorFillType=e),g},b.prototype.ToSJSCT_ColorProperties=function(a){var b,c,d,e,f=this,g=f.BhK||a,i=g.schemeClr;return i&&h.ChartUtility.removeEmptyArrayProperties(i),f.ColorType===j.SolidColorType.Theme?(x(g),i||(i=g.schemeClr={}),i.val=j.ST_SchemeColorVal[B(f.ObjectThemeColor)],f.keK(i)):f.ColorType===j.SolidColorType.RGB&&(x(g),delete g.schemeClr,b=r,f.Iqa&&f.Iqa.IsKnownColor&&(b=f.Iqa.ToKnownColor()),n(b)?(d=g.srgbClr={},d.val=[f.RGB.R,f.RGB.G,f.RGB.B].map(function(a){return("00"+a.toString(16)).substr(-2)}).join(""),f.keK(d)):(c=g.sysClr={},c.val=j.ST_SystemColorVal[A(b)],c.lastClr=[f.RGB.R,f.RGB.G,f.RGB.B].map(function(a){return("00"+a.toString(16)).substr(-2)}).join(""),f.keK(c))),e=a&&a.colorFillType,n(e)||(g.colorFillType=e),g},b.prototype.FromTint=function(a){this.TintAndShade=1-a/q},b.prototype.FromShade=function(a){this.TintAndShade=a/q-1},b.prototype.ToTint=function(){return t(s((1-this.TintAndShade)*q))},b.prototype.ToShade=function(){return t(s((1+this.TintAndShade)*q))},b.prototype.FromTransparency=function(a){this.Transparency=1-a/q},b.prototype.ToTransparency=function(){return t((1-this.Transparency)*q)},b.prototype.FromSatMod=function(a){this.SatMod=a/q},b.prototype.ToSatMod=function(){return t(this.SatMod*q)},b.prototype.Clone=function(){var a=this,c=new b(a.xc);return c.Jqa=a.Jqa,c.Xba=a.Xba,c.xc=a.xc,c.Iqa=a.Iqa,c.Hqa=a.Hqa,c.Yba=a.Yba,c.AutoColorFormat=a.AutoColorFormat,c},b.prototype.FromOOModel=function(a){this.FromCT_ColorProperties(a)},b.prototype.FromSJSOOModel=function(a){this.FromSJSCT_ColorProperties(a)},b.prototype.ToOOModel=function(){var a=this.ColorType;return a===j.SolidColorType.Automatic?{}:a===j.SolidColorType.None?{colorFillType:j.ColorFillType.NoFillProperties}:this.ToCT_ColorProperties({colorFillType:0})},b.prototype.ToSJSOOModel=function(){var a=this.ColorType;return a===j.SolidColorType.Automatic?{}:a===j.SolidColorType.None?{colorFillType:j.ColorFillType.NoFillProperties}:this.ToSJSCT_ColorProperties({colorFillType:0})},b.prototype.Color_FromOOModel=function(a){this.FromCT_ColorProperties(a)},b.prototype.Color_ToOOModel=function(){return this.ToCT_ColorProperties({})},b.prototype.Color_ToSJSOOModel=function(){return this.ToSJSCT_ColorProperties({})},b.prototype.GradientStop_FromOOModel=function(a){this.FromCT_ColorProperties(a)},b.prototype.GradientStop_ToOOModel=function(){return this.ToCT_ColorProperties({})},b.prototype.ColorData_FromOOModel=function(a){a.ColorType===j.ColorType.Index?this.RGB=g.ARGBColor.FromArgb(a.Value):a.ColorType===j.ColorType.Theme&&(this.ObjectThemeColor=a.Value,this.TintAndShade=a.Tint)},b.prototype.ColorData_ToOOModel=function(){var a=this,b=new f.ColorData;return a.ColorType===j.SolidColorType.RGB?(b.Value=a.RGB.Value,b.ColorType=j.ColorType.RGB):a.ColorType===j.SolidColorType.Theme&&(b.Value=a.ObjectThemeColor,b.Tint=a.TintAndShade,b.ColorType=j.ColorType.Theme),b},Object.defineProperty(b.prototype,"Brightness",{get:function(){return this.GetState(j.ColorFormatStates.Brightness)||n(this.hqa)?this.Jqa:this.hqa.Brightness},set:function(a){if(a<-1||a>1)throw Error();this.Jqa=a,this.Dirty(j.ColorFormatStates.Brightness)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ObjectThemeColor",{get:function(){return this.GetState(j.ColorFormatStates.ObjectThemeColor)||n(this.hqa)?this.Hqa:this.hqa.ObjectThemeColor},set:function(a){var b=this,c={13:1,14:0,15:3,16:2};n(c[a])||(a=c[a]),b.Hqa=a,b.Dirty(j.ColorFormatStates.ObjectThemeColor),b.ColorType=j.SolidColorType.Theme,b.Iqa=r,b.UnDirty(j.ColorFormatStates.RGB),b.Jqa=0,b.Dirty(j.ColorFormatStates.Brightness)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"RGB",{get:function(){var a=this;return a.HasOwnColor()||n(a.hqa)?a.xc.Kqa(a.GetColorData()):a.hqa.RGB},set:function(a){var b=this;b.Iqa=a,b.Transparency=1-a.A/255,b.Dirty(j.ColorFormatStates.RGB),b.ColorType=j.SolidColorType.RGB,b.Hqa=j.ColorSchemeIndex.None,b.Dirty(j.ColorFormatStates.ObjectThemeColor),b.Jqa=0,b.Yba=0,b.Dirty(j.ColorFormatStates.Brightness),b.Dirty(j.ColorFormatStates.TintAndShade)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"TintAndShade",{get:function(){var a=this;return a.Yba},set:function(a){this.Yba=a,this.Dirty(j.ColorFormatStates.TintAndShade)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Transparency",{get:function(){var a=this;return a.GetState(j.ColorFormatStates.Transparency)||n(a.hqa)?a.Gqa:a.hqa.Transparency},set:function(a){a=Math.max(0,Math.min(1,a)),this.Gqa=a,this.Dirty(j.ColorFormatStates.Transparency)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"SatMod",{get:function(){var a=this;return a.GetState(j.ColorFormatStates.SatMod)||n(a.hqa)?a.m5J:a.hqa.SatMod},set:function(a){this.m5J=a,this.Dirty(j.ColorFormatStates.SatMod)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ColorType",{get:function(){var a=this;return a.GetState(j.ColorFormatStates.ColorType)||n(a.hqa)?a.Xba:a.hqa.ColorType},set:function(a){this.Xba=a,this.Dirty(j.ColorFormatStates.ColorType)},enumerable:!0,configurable:!0}),b}(i.StatefulBase),b.ColorFormat=u;function x(a){delete a.hslClr,delete a.prstClr,delete a.scrgbClr,delete a.srgbClr,delete a.sysClr}function y(a,b,c){b.length>0&&(a.lumMod=b),c.length>0&&(a.lumOff=c)}function z(a){var b=null;switch(a){case j.ST_SystemColorVal.scrollBar:b=23;break;case j.ST_SystemColorVal.activeCaption:b=2;break;case j.ST_SystemColorVal.inactiveCaption:b=17;break;case j.ST_SystemColorVal.menu:b=21;break;case j.ST_SystemColorVal.window:b=24;break;case j.ST_SystemColorVal.windowFrame:b=25;break;case j.ST_SystemColorVal.menuText:b=22;break;case j.ST_SystemColorVal.windowText:b=26;break;case j.ST_SystemColorVal.activeBorder:b=1;break;case j.ST_SystemColorVal.inactiveBorder:b=16;break;case j.ST_SystemColorVal.appWorkspace:b=4;break;case j.ST_SystemColorVal.highlight:b=13;break;case j.ST_SystemColorVal.highlightText:b=14;break;case j.ST_SystemColorVal.btnFace:b=168;break;case j.ST_SystemColorVal.btnShadow:b=170;break;case j.ST_SystemColorVal.grayText:b=12;break;case j.ST_SystemColorVal.inactiveCaptionText:b=18;break;case j.ST_SystemColorVal.btnHighlight:b=169;break;case j.ST_SystemColorVal.infoText:b=20;break;case j.ST_SystemColorVal.infoBk:b=19;break;case j.ST_SystemColorVal.gradientActiveCaption:b=171;break;case j.ST_SystemColorVal.gradientInactiveCaption:b=172;break;case j.ST_SystemColorVal.menuHighlight:b=174;break;case j.ST_SystemColorVal.menuBar:b=173}return b}function A(a){var b=null;switch(a){case 1:b=j.ST_SystemColorVal.activeBorder;break;case 2:b=j.ST_SystemColorVal.activeCaption;break;case 168:b=j.ST_SystemColorVal.btnFace;break;case 169:b=j.ST_SystemColorVal.btnHighlight;break;case 170:b=j.ST_SystemColorVal.btnShadow;break;case 171:b=j.ST_SystemColorVal.gradientActiveCaption;break;case 172:b=j.ST_SystemColorVal.gradientInactiveCaption;break;case 12:b=j.ST_SystemColorVal.grayText;break;case 13:b=j.ST_SystemColorVal.highlight;break;case 14:b=j.ST_SystemColorVal.highlightText;break;case 16:b=j.ST_SystemColorVal.inactiveBorder;break;case 17:b=j.ST_SystemColorVal.inactiveCaption;break;case 18:b=j.ST_SystemColorVal.inactiveCaptionText;break;case 20:b=j.ST_SystemColorVal.infoText;break;case 21:b=j.ST_SystemColorVal.menu;break;case 173:b=j.ST_SystemColorVal.menuBar;break;case 174:b=j.ST_SystemColorVal.menuHighlight;break;case 22:b=j.ST_SystemColorVal.menuText;break;case 24:b=j.ST_SystemColorVal.window;break;case 25:b=j.ST_SystemColorVal.windowFrame;break;case 26:b=j.ST_SystemColorVal.windowText}return b}function B(a){var b=j.ST_SchemeColorVal.accent1;switch(a){case 4:b=j.ST_SchemeColorVal.accent1;break;case 5:b=j.ST_SchemeColorVal.accent2;break;case 6:b=j.ST_SchemeColorVal.accent3;break;case 7:b=j.ST_SchemeColorVal.accent4;break;case 8:b=j.ST_SchemeColorVal.accent5;break;case 9:b=j.ST_SchemeColorVal.accent6;break;case 0:b=j.ST_SchemeColorVal.bg1;break;case 2:b=j.ST_SchemeColorVal.bg2;break;case 11:b=j.ST_SchemeColorVal.folHlink;break;case 10:b=j.ST_SchemeColorVal.hlink;break;case 12:b=j.ST_SchemeColorVal.phClr;break;case 13:b=j.ST_SchemeColorVal.dk1;break;case 14:b=j.ST_SchemeColorVal.lt1;break;case 15:b=j.ST_SchemeColorVal.dk2;break;case 16:b=j.ST_SchemeColorVal.lt2;break;case 1:b=j.ST_SchemeColorVal.tx1;break;case 3:b=j.ST_SchemeColorVal.tx2}return b}function C(a){var b=4;switch(a){case j.ST_SchemeColorVal.bg1:b=0;break;case j.ST_SchemeColorVal.tx1:b=1;break;case j.ST_SchemeColorVal.bg2:b=2;break;case j.ST_SchemeColorVal.tx2:b=3;break;case j.ST_SchemeColorVal.accent1:b=4;break;case j.ST_SchemeColorVal.accent2:b=5;break;case j.ST_SchemeColorVal.accent3:b=6;break;case j.ST_SchemeColorVal.accent4:b=7;break;case j.ST_SchemeColorVal.accent5:b=8;break;case j.ST_SchemeColorVal.accent6:b=9;break;case j.ST_SchemeColorVal.hlink:b=10;break;case j.ST_SchemeColorVal.folHlink:b=11;break;case j.ST_SchemeColorVal.phClr:b=12;break;case j.ST_SchemeColorVal.dk1:b=13;break;case j.ST_SchemeColorVal.lt1:b=14;break;case j.ST_SchemeColorVal.dk2:b=15;break;case j.ST_SchemeColorVal.lt2:b=16}return b}},"./dist/plugins/floatingObject/drawing/common.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/floatingObject/drawing/drawingInterface.js"),g=c("SheetsCalc"),h=c("./node_modules/util/util.js"),i=c("@grapecity/js-calc"),j=e.Common.l,k=null,l=void 0,m=Math.max,n=Math.min,
o=Math.floor,p=Math.log,q=Math.pow,r=Math.ceil,s=Math.abs,t=d.XmlConstants.M7,u=d.XmlConstants.L7;function K(a){return"number"==typeof a||a instanceof Date}function L(a,b,c){c.configurable=!0,c.enumerable=!0,Object.defineProperty(a,b,c)}v=function(){function a(){}return a.FromOADate=j.Xb,a.ToOADate=j.Ra,a.OADateMinAsDouble=-657435,a.OADateMaxAsDouble=2958466,a}(),b.DateTimeExtension=v,w=function(){function a(){}return a.log=function(a,b){return p(a)/p(b)},a.round=function(a,b){var c=q(10,b);return Math.round(a*c)/c},a.isNaNOrInfinite=function(a){return isNaN(a)||!isFinite(a)},a.GetTriangleAngle=function(a,b,c){var d,e;return 0===a&&0===b?0:(d=(a*a+c*c-b*b)/s(2*a*c),e=0,a<0&&b>0?e=90:a<0&&b<0?e=180:a>0&&b<0&&(e=270),180*Math.acos(d)/Math.PI+e)},a.INT32_MAX_VALUE=2147483647,a.DOUBLE_MAX_VALUE=Number.MAX_VALUE,a.DOUBLE_MIN_VALUE=-Number.MAX_VALUE,a}(),b.NumberExtension=w;function M(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}x=function(){function a(){}return a.pointToPixel=function(a){return M(96*a/72,2)},a.IsNullOrEmpty=function(b){return a.isNullOrUndefined(b)||""===b},a.IsNegativeInfinity=function(a){return a===Number.NEGATIVE_INFINITY},a.IsPositiveInfinity=function(a){return a===Number.POSITIVE_INFINITY},a.isNullOrUndefined=function(a){return a===l||a===k},a}(),b.UnitHelper=x,y=function(){function a(a,b,c,d){var e=this;e.Row=a,e.Column=b,e.RowCount=c,e.ColumnCount=d}return Object.defineProperty(a.prototype,"Left",{get:function(){return this.Column},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Top",{get:function(){return this.Row},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Right",{get:function(){return this.Column+this.ColumnCount},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Bottom",{get:function(){return this.Row+this.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"IsFullColumn",{get:function(){return 0===this.Row&&this.RowCount===w.INT32_MAX_VALUE},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"IsFullRow",{get:function(){return 0===this.Column&&this.ColumnCount===w.INT32_MAX_VALUE},enumerable:!0,configurable:!0}),a.prototype.Intersect=function(a){var b=this,c=a,d=m(b.Column,c.Column),e=m(b.Row,c.Row),f=n(b.Right,c.Right),g=n(b.Bottom,c.Bottom);d>=f||e>=g?(b.Column=0,b.Row=0,b.ColumnCount=0,b.RowCount=0):(b.Column=d,b.Row=e,b.ColumnCount=f-d,b.RowCount=g-e)},a.prototype.IntersectsWith=function(a){var b=this,c=a;return!(b.Left>=c.Right||b.Right<=c.Left||b.Top>=c.Bottom||b.Bottom<=c.Top)},a}(),b.CellRect=y,z=function(){function a(a,b){this.Worksheet=a,this.tpa=b,this.UpdateRects()}return a.prototype.UpdateRects=function(){var a,b,c,d,e,f,g,h,i,j,k,l=this;for(l.upa=[],d=l.Worksheet,e=d.getRowCount(),f=d.getColumnCount(),g=0;g<l.tpa.length;g++){if(c=l.tpa[g],h=c.Row,i=c.Column,a=c.RowCount,b=c.ColumnCount,(h<0||a<0||i<0||b<0)&&((h<0||a<0)&&(h=0,a=w.INT32_MAX_VALUE),(i<0||b<0)&&(i=0,b=w.INT32_MAX_VALUE),l.tpa[g]=new y(h,i,a,b)),(0!==h||a!==w.INT32_MAX_VALUE)&&(h<0||a<=0||h+a>t))throw Error();if((0!==i||b!==w.INT32_MAX_VALUE)&&(i<0||b<=0||i+b>u))throw Error()}for(j=0,k=l.tpa;j<k.length;j++)c=k[j],a=n(c.Bottom,e+1)-c.Top,b=n(c.Right,f+1)-c.Left,l.upa.push(new y(c.Row,c.Column,a,b))},Object.defineProperty(a.prototype,"Row",{get:function(){var a=this.upa[0].Row;return a<0?0:a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Column",{get:function(){var a=this.upa[0].Column;return a<0?0:a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"RowCount",{get:function(){var a,b,c=this,d=c.upa[0].RowCount,e=c.upa[0].Row;return d<0||e<0?(a=c.Worksheet,b=a.getRowCount()):d},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ColumnCount",{get:function(){var a=this,b=this.upa[0].ColumnCount,c=this.upa[0].Column,d=a.Worksheet,e=d.getColumnCount();return b<0||c<0?e:b},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"EntireRow",{get:function(){var b,c,d=[];for(b=0;b<this.upa.length;b++)c=this.upa[b],c.Column=-1,c.ColumnCount=-1,d.push(c);return new a(this.Worksheet,d)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"EntireColumn",{get:function(){var b,c,d=[];for(b=0;b<this.upa.length;b++)c=this.upa[b],c.Row=-1,c.RowCount=-1,d.push(c);return new a(this.Worksheet,d)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Text",{get:function(){var a=this;return a.Worksheet.vpa(a.Row,a.Column,a.RowCount,a.ColumnCount)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Areas",{get:function(){var b,c,d,e=this.upa,f=[];for(b=0,c=e;b<c.length;b++)d=c[b],f.push(new a(this.Worksheet,[d]));return f},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Hidden",{get:function(){return this.Worksheet.wpa(this.tpa)},enumerable:!0,configurable:!0}),a}(),b.Range=z,function(a){a[a.Row=1]="Row",a[a.Column=2]="Column",a[a.RowIsRelative=4]="RowIsRelative",a[a.ColumnIsRelative=8]="ColumnIsRelative",a[a.LastRowIsRelative=16]="LastRowIsRelative",a[a.LastColumnIsRelative=32]="LastColumnIsRelative",a[a.Range=64]="Range",a[a.Error=128]="Error"}(A||(A={})),B=function(){function a(a,b,c,d,e){var f=this;f.WorksheetName=a,f.Row=b,f.Column=c,void 0!==d&&(f.LastRow=d),void 0!==e&&(f.LastColumn=e)}return Object.defineProperty(a.prototype,"Row",{get:function(){return(this.Kind&A.Row)===A.Row?this.cj:0},set:function(a){this.cj=a,this.Kind|=A.Row},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Column",{get:function(){return(this.Kind&A.Column)===A.Column?this.Lk:0},set:function(a){this.Lk=a,this.Kind|=A.Column},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"RowCount",{get:function(){var a,b,c=this;return c.IsRange?(c.Kind&A.Row)===A.Row?c.RowIsRelative&&c.LastRowIsRelative||!c.RowIsRelative&&!c.LastRowIsRelative?c.LastRow-c.Row+1:-1:(a=c.Worksheet,b=a.getRowCount()):1},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ColumnCount",{get:function(){var a=this;return a.IsRange?(a.Kind&A.Column)===A.Column?a.ColumnIsRelative&&a.LastColumnIsRelative||!a.ColumnIsRelative&&!a.LastColumnIsRelative?a.LastColumn-a.Column+1:-1:a.Worksheet.getColumnCount():1},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"LastColumn",{get:function(){var a,b,c=this;return c.IsRange?(c.Kind&A.Column)===A.Column?c.xpa:(a=c.Worksheet,b=a.getColumnCount(),b-1):c.Column},set:function(a){this.xpa=a,this.Kind|=A.Column|A.Range},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"LastRow",{get:function(){var a,b,c=this;return c.IsRange?(c.Kind&A.Row)===A.Row?c.ypa:(a=c.Worksheet,b=a.getRowCount(),b-1):c.Row},set:function(a){this.ypa=a,this.Kind|=A.Row|A.Range},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"RowIsRelative",{get:function(){return(this.Kind&(A.Row|A.RowIsRelative))===(A.Row|A.RowIsRelative)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ColumnIsRelative",{get:function(){return(this.Kind&(A.Column|A.ColumnIsRelative))===(A.Column|A.ColumnIsRelative)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"LastRowIsRelative",{get:function(){return this.IsRange?(this.Kind&(A.Row|A.LastRowIsRelative))===(A.Row|A.LastRowIsRelative):this.RowIsRelative},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"LastColumnIsRelative",{get:function(){return this.IsRange?(this.Kind&(A.Column|A.LastColumnIsRelative))===(A.Column|A.LastColumnIsRelative):this.ColumnIsRelative},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"IsRange",{get:function(){return(this.Kind&A.Range)===A.Range},set:function(a){a?this.Kind|=A.Range:this.Kind&=~A.Range},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"IsError",{get:function(){return"#REF"===this.WorksheetName},enumerable:!0,configurable:!0}),a.prototype.GetSourceRange=function(a,b){var c=this,d=c.Row,e=c.Column,f=c.LastRow,g=c.LastColumn;return new y(d,e,f-d+1,g-e+1)},a.prototype.ToR1C1Text=function(a){var b,c,d,e,f,g;return a===l&&(a=k),b=this,c=b.Yw,h.isNullOrUndefined(c)?(b.Kind&A.Error)===A.Error?b.GetPrevText(a)+"#REF!":(d="",(b.Kind&A.Row)===A.Row&&(e=b.Row,d+=b.RowIsRelative?0===e?"R":"R["+e+"]":"R"+(e+1)),(b.Kind&A.Column)===A.Column&&(f=b.Column,d+=b.ColumnIsRelative?0===f?"C":"C["+f+"]":"C"+(f+1)),b.IsRange&&(g=!1,(b.Kind&(A.Row|A.Column))!==(A.Row|A.Column)&&((b.Kind&A.Row)===A.Row?b.RowIsRelative===b.LastRowIsRelative&&b.Row===b.LastRow&&(g=!0):b.ColumnIsRelative===b.LastColumnIsRelative&&b.Column===b.LastColumn&&(g=!0)),g||(d+=":",(b.Kind&A.Row)===A.Row&&(e=b.LastRow,d+=b.LastRowIsRelative?0===e?"R":"R["+e+"]":"R"+(e+1)),(b.Kind&A.Column)===A.Column&&(f=b.LastColumn,d+=b.LastColumnIsRelative?0===f?"C":"C["+f+"]":"C"+(f+1)))),b.GetPrevText(a)+d):c},a.prototype.ToA1Text=function(a,b,c){var d,e,f,g,i;return c===l&&(c=k),d=this,e=d.Yw,h.isNullOrUndefined(e)?(d.Kind&A.Error)===A.Error?d.GetPrevText(c)+"#REF!":(f="",(d.Kind&A.Column)===A.Column&&(i=d.Column,d.ColumnIsRelative?i+=b:f+="$",isNaN(i)||(f+=d.GetColumnIndexInA1Letter(i))),(d.Kind&A.Row)===A.Row&&(g=d.Row,d.RowIsRelative?g+=a:f+="$",f+=""+(g+1)),d.IsRange&&(f+=":",(d.Kind&A.Column)===A.Column&&(i=d.LastColumn,d.LastColumnIsRelative?i+=b:f+="$",isNaN(i)||(f+=d.GetColumnIndexInA1Letter(i))),(d.Kind&A.Row)===A.Row&&(g=d.LastRow,d.LastRowIsRelative?g+=a:f+="$",f+=""+(g+1))),d.GetPrevText(c)+f):e},a.prototype.GetPrevText=function(a){var b,c=this,d="";return c.Workbook>0&&(d="["+c.Workbook+"]"),b=c.WorksheetName,x.isNullOrUndefined(b)&&(b=a),b&&(d+=x.isNullOrUndefined(c.LastWorksheetName)?b:b+":"+c.LastWorksheetName),d?((c.IsSpecialSheetName(b)||c.IsSpecialSheetName(c.LastWorksheetName))&&(d="'"+d.replace("'","''")+"'"),d+="!"):""===b&&(d="!"),d},a.prototype.IsSpecialSheetName=function(b){var c,d;if(!x.isNullOrUndefined(b)){if(b===a.ErrorWorksheetName)return!1;for(c=0;c<b.length;c++)if(d=b[c],!(d>="A"&&d<="Z"||d>="a"&&d<="z"||d>="0"&&d<="9"||"_"===d))return!0}return!1},a.prototype.GetColumnIndexInA1Letter=function(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=[],d=0;;){if(d=a%26,isNaN(d))break;if(c.unshift(b[d]),a=parseInt(a/26+"",10),0===a)break;a--}return c.join("")},a.ErrorWorksheetName="#REF",a}(),b.Reference=B,b.ChartConstants={XValuesMinMax:"XValuesMinMax",ValuesMinMax:"ValuesMinMax",PrimaryValuesMinMax:"PrimaryValuesMinMax",SecondaryValuesMinMax:"SecondaryValuesMinMax",PrimaryXValuesMinMax:"PrimaryXValuesMinMax",SecondaryXValuesMinMax:"SecondaryXValuesMinMax",Collection:"Collection",Restore:"Restore",ChartType:"ChartType",AxisGroup:"AxisGroup",AreAllXValuesDateTime:"AreAllXValuesDateTime",XValuesFormula:"XValuesFormula",XValues:"XValues",CategoryNames:"CategoryNames",CategoryType:"CategoryType",SecondaryPlot:"SecondaryPlot",SplitType:"SplitType",SplitValue:"SplitValue",IsMultiLevelXValues:"IsMultiLevelXValues",PlotOrder:"PlotOrder",FIELD_TYPE_CELLRANGE:"CELLRANGE",FIELD_TYPE_SERIESNAME:"SERIESNAME",FIELD_TYPE_CATEGORYNAME:"CATEGORYNAME",FIELD_TYPE_VALUE:"VALUE",FIELD_TYPE_XVALUE:"XVALUE",FIELD_TYPE_YVALUE:"YVALUE",FIELD_TYPE_BUBBLESIZE:"BUBBLESIZE",FIELD_TYPE_PERCENTAGE:"PERCENTAGE",FIELD_TYPE_TXLINK:"TxLink",FIELD_TEXT_CELLRANGE:"[CELLRANGE]",FIELD_TEXT_SERIESNAME:"[SERIES NAME]",FIELD_TEXT_CATEGORYNAME:"[CATEGORY NAME]",FIELD_TEXT_VALUE:"[VALUE]",FIELD_TEXT_XVALUE:"[XVALUE]",FIELD_TEXT_YVALUE:"[YVALUE]",FIELD_TEXT_BUBBLESIZE:"[BUBBLE SIZE]",CHART_LATIN_HEAD_FONT:"+mj-lt",CHART_LATIN_BODY_FONT:"+mn-lt",CHART_EA_HEAD_FONT:"+mj-ea",CHART_EA_BODY_FONT:"+mn-ea",CHART_CS_HEAD_FONT:"+mj-cs",CHART_CS_BODY_FONT:"+mn-cs",DefaultLineColorBrightness:.85,DefaultMarkerSize:7},b.ShapeConstants={ShapeTypePrefix:"Shape",PositiveFixedAngleConvert:6e4,PositionConver:1e5,CropPositionConver:1e3,ShadeConver:2e5,DefaultBrightness:.5,RelativeRectConver:1e3,DefaultTransparent:0,PositiveFixedPercentageConvert:1e5,DefaultOffset:2.07995176,DefaultSatMod:1},C=["","Dotted-5%","Dotted-10%","Dotted-20%","Dotted-25%","Dotted-30%","Dotted-40%","Dotted-50%","Dotted-60%","Dotted-70%","Dotted-75%","Dotted-80%","Dotted-90%","HorizontalStripes-Dark","VerticalStripes-Dark","DiagonalStripes-DarkDownward","DiagonalStripes-DarkUpward","SmallCheckerBoard","Trellis","HorizontalStripes-Light","VerticalStripes-Light","DiagonalStripes-LightDownward","DiagonalStripes-LightUpward","SmallGrid","DottedDiamondGrid","DiagonalStripes-WideDownward","DiagonalStripes-WideUpward","Stripes-Slashes","Stripes-Backslashes","VerticalStripes-Narrow","HorizontalStripes-Narrow","VerticalStripes-AlternatingVerticalLines","HorizontalStripes-AlternatingHorizontalLines","LargeConfetti","LargeGrid","HorizontalBrick","LargeCheckerBoard","SmallConfetti","ZigZag","SolidDiamondGrid","DiagonalBrick","OutlinedDiamondGrid","Plaid","Sphere","Weave","DottedGrid","Divot","Shingle","Wave"],function(a){a[a["background 1"]=0]="background 1",a[a["background 2"]=2]="background 2",a[a["text 1"]=1]="text 1",a[a["text 2"]=3]="text 2",a[a["accent 1"]=4]="accent 1",a[a["accent 2"]=5]="accent 2",a[a["accent 3"]=6]="accent 3",a[a["accent 4"]=7]="accent 4",a[a["accent 5"]=8]="accent 5",a[a["accent 6"]=9]="accent 6",a[a.hyperlink=10]="hyperlink",a[a.followedhyperlink=11]="followedhyperlink"}(D||(D={}));function N(a){if(null===a||void 0===a)return!0;if(Array.isArray(a))return 0===a.length;if(a instanceof Date)return!1;if("object"!=typeof a)return!1;for(var b in a)return!1;return!0}function O(a,b){var c,d;if(N(a))return null;for(c in a)b.indexOf(c)>=0||(d=a[c],Array.isArray(d)?0!==d.length&&null!==P(d,b)||delete a[c]:"object"==typeof d&&(d=O(d,b),null===d&&delete a[c]));return N(a)?null:a}function P(a,b){var c=[],d=a.length;return a.forEach(function(a){var d=O(a,b);null!==d&&c.push(d)}),c.length<d&&[].splice.apply(a,[].concat(0,d,c)),c.length?a:null}function Q(a){delete a.solidFill,delete a.pattFill,delete a.blipFill,delete a.gradFill,delete a.noFill,delete a.grpFill,delete a.uFill,delete a.uFillTx}E=function(){function a(){}return a.Kqa=function(a,b){},a.Yra=function(a,b){return b===f.ThemeFont.Major?a.getFont("Headings"):b===f.ThemeFont.Minor?a.getFont("Body"):""},a.colorFormatToString=function(b,c,d,e){var f=b&&b.Color;return a.colorFormatToStringImp(f,c,d,e)},a.colorFormatToStringImp=function(b,c,d,e){var g,h;if(b&&b.ColorType!==f.SolidColorType.None){if(c&&(g=b.GetColorData(),g.ColorType===f.ColorType.Theme))return a.toThemeColorString(g.Value,g.Tint);if(h=b.RGB)return d?"rgba("+h.R+","+h.G+","+h.B+","+h.A/255+")":"rgb("+h.R+","+h.G+","+h.B+")"}else if(b&&b.ColorType===f.SolidColorType.None&&e)return"";return"transparent"},a.isMarkerScatterChart=function(a){return[1,33,35,26,27,28,42].indexOf(a)>=0},a.getFillFormatResult=function(b,c,d,e,f){var g,h,i,j,k,l=b&&b.Type;return 1===l?(g={},h=b&&b.PatternColor,i=b&&b.Color,j=a.colorFormatToStringImp(h,c,d,e),k=a.colorFormatToStringImp(i,c,d,e),f?(g.type="Pattern",g.color=k,g.pattern=[],g.pattern.push({style:{fill:j},content:C[b.Pattern]})):(g.type=b.Pattern,g.foregroundColor=j,g.backgroundColor=k),g):a.colorFormatToString(b,c,d,e)},a.getTransparencyFromColorFormat=function(a,b){var c,d=a&&a.Color;if(d&&(d.ColorType!==f.SolidColorType.None||b)){if(!x.isNullOrUndefined(d.Transparency))return parseFloat(d.Transparency.toFixed(2));if(c=d.RGB)return parseFloat((c.A/255).toFixed(2))}return 0},a.toThemeColorString=function(a,b){return D[a]+" "+parseInt(100*b+"",10)},a.fromThemeColorString=function(a){var b,c=a.split(" "),d=c.length,e=c[0].toLowerCase(),f=c[1],g=c[2];if("hyperlink"===e||"followedhyperlink"===e){if(1===d)return{index:D[e],tint:0};if(2===d)return{index:D[e],tint:parseInt(f,10)/100}}if(d>=2&&(b=D[e+" "+f],b!==l)){if(2===d)return{index:b,tint:0};if(3===d)return{index:b,tint:parseInt(g,10)/100}}},a.InitPresetColors=function(){var b=a.presetColors;b[f.ST_PresetColorVal.aliceBlue]=[240,248,255],b[f.ST_PresetColorVal.antiqueWhite]=[250,235,215],b[f.ST_PresetColorVal.aqua]=[0,255,255],b[f.ST_PresetColorVal.aquamarine]=[127,255,212],b[f.ST_PresetColorVal.azure]=[240,255,255],b[f.ST_PresetColorVal.beige]=[245,245,220],b[f.ST_PresetColorVal.bisque]=[255,228,196],b[f.ST_PresetColorVal.black]=[0,0,0],b[f.ST_PresetColorVal.blanchedAlmond]=[255,235,205],b[f.ST_PresetColorVal.blue]=[0,0,255],b[f.ST_PresetColorVal.blueViolet]=[138,43,226],b[f.ST_PresetColorVal.brown]=[165,42,42],b[f.ST_PresetColorVal.burlyWood]=[222,184,135],b[f.ST_PresetColorVal.cadetBlue]=[95,158,160],b[f.ST_PresetColorVal.chartreuse]=[127,255,0],b[f.ST_PresetColorVal.chocolate]=[210,105,30],b[f.ST_PresetColorVal.coral]=[255,127,80],b[f.ST_PresetColorVal.cornflowerBlue]=[100,149,237],b[f.ST_PresetColorVal.cornsilk]=[255,248,220],b[f.ST_PresetColorVal.crimson]=[220,20,60],b[f.ST_PresetColorVal.cyan]=[0,255,255],b[f.ST_PresetColorVal.darkBlue]=[0,0,139],b[f.ST_PresetColorVal.darkCyan]=[0,139,139],b[f.ST_PresetColorVal.darkGoldenrod]=[184,134,11],b[f.ST_PresetColorVal.darkGray]=[169,169,169],b[f.ST_PresetColorVal.darkGreen]=[0,100,0],b[f.ST_PresetColorVal.darkGrey]=[169,169,169],b[f.ST_PresetColorVal.darkKhaki]=[189,183,107],b[f.ST_PresetColorVal.darkMagenta]=[139,0,139],b[f.ST_PresetColorVal.darkOliveGreen]=[85,107,47],b[f.ST_PresetColorVal.darkOrange]=[255,140,0],b[f.ST_PresetColorVal.darkOrchid]=[153,50,204],b[f.ST_PresetColorVal.darkRed]=[139,0,0],b[f.ST_PresetColorVal.darkSalmon]=[233,150,122],b[f.ST_PresetColorVal.darkSeaGreen]=[143,188,143],b[f.ST_PresetColorVal.darkSlateBlue]=[72,61,139],b[f.ST_PresetColorVal.darkSlateGray]=[47,79,79],b[f.ST_PresetColorVal.darkSlateGrey]=[47,79,79],b[f.ST_PresetColorVal.darkTurquoise]=[0,206,209],b[f.ST_PresetColorVal.darkViolet]=[148,0,211],b[f.ST_PresetColorVal.deepPink]=[255,20,147],b[f.ST_PresetColorVal.deepSkyBlue]=[0,191,255],b[f.ST_PresetColorVal.dimGray]=[105,105,105],b[f.ST_PresetColorVal.dimGrey]=[105,105,105],b[f.ST_PresetColorVal.dkBlue]=[0,0,139],b[f.ST_PresetColorVal.dkCyan]=[0,139,139],b[f.ST_PresetColorVal.dkGoldenrod]=[184,134,11],b[f.ST_PresetColorVal.dkGray]=[169,169,169],b[f.ST_PresetColorVal.dkGreen]=[0,100,0],b[f.ST_PresetColorVal.dkGrey]=[169,169,169],b[f.ST_PresetColorVal.dkKhaki]=[189,183,107],b[f.ST_PresetColorVal.dkMagenta]=[139,0,139],b[f.ST_PresetColorVal.dkOliveGreen]=[85,107,47],b[f.ST_PresetColorVal.dkOrange]=[255,140,0],b[f.ST_PresetColorVal.dkOrchid]=[153,50,204],b[f.ST_PresetColorVal.dkRed]=[139,0,0],b[f.ST_PresetColorVal.dkSalmon]=[233,150,122],b[f.ST_PresetColorVal.dkSeaGreen]=[143,188,139],b[f.ST_PresetColorVal.dkSlateBlue]=[72,61,139],b[f.ST_PresetColorVal.dkSlateGray]=[47,79,79],b[f.ST_PresetColorVal.dkSlateGrey]=[47,79,79],b[f.ST_PresetColorVal.dkTurquoise]=[0,206,209],b[f.ST_PresetColorVal.dkViolet]=[148,0,211],b[f.ST_PresetColorVal.dodgerBlue]=[30,144,255],b[f.ST_PresetColorVal.firebrick]=[178,34,34],b[f.ST_PresetColorVal.floralWhite]=[255,250,240],b[f.ST_PresetColorVal.forestGreen]=[34,139,34],b[f.ST_PresetColorVal.fuchsia]=[255,0,255],b[f.ST_PresetColorVal.gainsboro]=[220,220,220],b[f.ST_PresetColorVal.ghostWhite]=[248,248,255],b[f.ST_PresetColorVal.gold]=[255,215,0],b[f.ST_PresetColorVal.goldenrod]=[218,165,32],b[f.ST_PresetColorVal.gray]=[128,128,128],b[f.ST_PresetColorVal.green]=[0,128,0],b[f.ST_PresetColorVal.greenYellow]=[173,255,47],b[f.ST_PresetColorVal.grey]=[128,128,128],b[f.ST_PresetColorVal.honeydew]=[240,255,240],b[f.ST_PresetColorVal.hotPink]=[255,105,180],b[f.ST_PresetColorVal.indianRed]=[205,92,92],b[f.ST_PresetColorVal.indigo]=[75,0,130],b[f.ST_PresetColorVal.ivory]=[255,255,240],b[f.ST_PresetColorVal.khaki]=[240,230,140],b[f.ST_PresetColorVal.lavender]=[230,230,250],b[f.ST_PresetColorVal.lavenderBlush]=[255,240,245],b[f.ST_PresetColorVal.lawnGreen]=[124,252,0],b[f.ST_PresetColorVal.lemonChiffon]=[255,250,205],b[f.ST_PresetColorVal.lightBlue]=[173,216,230],b[f.ST_PresetColorVal.lightCoral]=[240,128,128],b[f.ST_PresetColorVal.lightCyan]=[224,255,255],b[f.ST_PresetColorVal.lightGoldenrodYellow]=[250,250,210],b[f.ST_PresetColorVal.lightGray]=[211,211,211],b[f.ST_PresetColorVal.lightGreen]=[144,238,144],b[f.ST_PresetColorVal.lightGrey]=[211,211,211],b[f.ST_PresetColorVal.lightPink]=[255,182,193],b[f.ST_PresetColorVal.lightSalmon]=[255,160,122],b[f.ST_PresetColorVal.lightSeaGreen]=[32,178,170],b[f.ST_PresetColorVal.lightSkyBlue]=[135,206,250],b[f.ST_PresetColorVal.lightSlateGray]=[119,136,153],b[f.ST_PresetColorVal.lightSlateGrey]=[119,136,153],b[f.ST_PresetColorVal.lightSteelBlue]=[176,196,222],b[f.ST_PresetColorVal.lightYellow]=[255,255,224],b[f.ST_PresetColorVal.lime]=[0,255,0],b[f.ST_PresetColorVal.limeGreen]=[50,205,50],b[f.ST_PresetColorVal.linen]=[250,240,230],b[f.ST_PresetColorVal.ltBlue]=[173,216,230],b[f.ST_PresetColorVal.ltCoral]=[240,128,128],b[f.ST_PresetColorVal.ltCyan]=[224,255,255],b[f.ST_PresetColorVal.ltGoldenrodYellow]=[250,250,120],b[f.ST_PresetColorVal.ltGray]=[211,211,211],b[f.ST_PresetColorVal.ltGreen]=[144,238,144],b[f.ST_PresetColorVal.ltGrey]=[211,211,211],b[f.ST_PresetColorVal.ltPink]=[255,182,193],b[f.ST_PresetColorVal.ltSalmon]=[255,160,122],b[f.ST_PresetColorVal.ltSeaGreen]=[32,178,170],b[f.ST_PresetColorVal.ltSkyBlue]=[135,206,250],b[f.ST_PresetColorVal.ltSlateGray]=[119,136,153],b[f.ST_PresetColorVal.ltSlateGrey]=[119,136,153],b[f.ST_PresetColorVal.ltSteelBlue]=[176,196,222],b[f.ST_PresetColorVal.ltYellow]=[255,255,224],b[f.ST_PresetColorVal.magenta]=[255,0,255],b[f.ST_PresetColorVal.maroon]=[128,0,0],b[f.ST_PresetColorVal.medAquamarine]=[102,205,170],b[f.ST_PresetColorVal.medBlue]=[0,0,205],b[f.ST_PresetColorVal.mediumAquamarine]=[102,205,170],b[f.ST_PresetColorVal.mediumBlue]=[0,0,205],b[f.ST_PresetColorVal.mediumOrchid]=[186,85,211],b[f.ST_PresetColorVal.mediumPurple]=[147,112,219],b[f.ST_PresetColorVal.mediumSeaGreen]=[60,179,113],b[f.ST_PresetColorVal.mediumSlateBlue]=[123,104,238],b[f.ST_PresetColorVal.mediumSpringGreen]=[0,250,154],b[f.ST_PresetColorVal.mediumTurquoise]=[72,209,204],b[f.ST_PresetColorVal.mediumVioletRed]=[199,21,133],b[f.ST_PresetColorVal.medOrchid]=[186,85,211],b[f.ST_PresetColorVal.medPurple]=[147,112,219],b[f.ST_PresetColorVal.medSeaGreen]=[60,179,113],b[f.ST_PresetColorVal.medSlateBlue]=[123,104,238],b[f.ST_PresetColorVal.medSpringGreen]=[0,250,154],b[f.ST_PresetColorVal.medTurquoise]=[72,209,204],b[f.ST_PresetColorVal.medVioletRed]=[199,21,133],b[f.ST_PresetColorVal.midnightBlue]=[25,25,112],b[f.ST_PresetColorVal.mintCream]=[245,255,250],b[f.ST_PresetColorVal.mistyRose]=[255,228,225],b[f.ST_PresetColorVal.moccasin]=[255,228,181],b[f.ST_PresetColorVal.navajoWhite]=[255,222,173],b[f.ST_PresetColorVal.navy]=[0,0,128],b[f.ST_PresetColorVal.oldLace]=[253,245,230],b[f.ST_PresetColorVal.olive]=[128,128,0],b[f.ST_PresetColorVal.oliveDrab]=[107,142,35],b[f.ST_PresetColorVal.orange]=[255,165,0],b[f.ST_PresetColorVal.orangeRed]=[255,69,0],b[f.ST_PresetColorVal.orchid]=[218,112,214],b[f.ST_PresetColorVal.paleGoldenrod]=[238,232,170],b[f.ST_PresetColorVal.paleGreen]=[152,251,152],b[f.ST_PresetColorVal.paleTurquoise]=[175,238,238],b[f.ST_PresetColorVal.paleVioletRed]=[219,112,147],b[f.ST_PresetColorVal.papayaWhip]=[255,239,213],b[f.ST_PresetColorVal.peachPuff]=[255,218,185],b[f.ST_PresetColorVal.peru]=[205,133,63],b[f.ST_PresetColorVal.pink]=[255,192,203],b[f.ST_PresetColorVal.plum]=[221,160,221],b[f.ST_PresetColorVal.powderBlue]=[176,224,230],b[f.ST_PresetColorVal.purple]=[128,0,128],b[f.ST_PresetColorVal.red]=[255,0,0],b[f.ST_PresetColorVal.rosyBrown]=[188,143,143],b[f.ST_PresetColorVal.royalBlue]=[65,105,225],b[f.ST_PresetColorVal.saddleBrown]=[139,69,19],b[f.ST_PresetColorVal.salmon]=[250,128,114],b[f.ST_PresetColorVal.sandyBrown]=[244,164,96],b[f.ST_PresetColorVal.seaGreen]=[46,139,87],b[f.ST_PresetColorVal.seaShell]=[255,245,238],b[f.ST_PresetColorVal.sienna]=[160,82,45],b[f.ST_PresetColorVal.silver]=[192,192,192],b[f.ST_PresetColorVal.skyBlue]=[135,206,235],b[f.ST_PresetColorVal.slateBlue]=[106,90,205],b[f.ST_PresetColorVal.slateGray]=[112,128,144],b[f.ST_PresetColorVal.slateGrey]=[112,128,144],b[f.ST_PresetColorVal.snow]=[255,250,250],b[f.ST_PresetColorVal.springGreen]=[0,255,127],b[f.ST_PresetColorVal.steelBlue]=[70,130,180],b[f.ST_PresetColorVal.tan]=[210,180,140],b[f.ST_PresetColorVal.teal]=[0,128,128],b[f.ST_PresetColorVal.thistle]=[216,191,216],b[f.ST_PresetColorVal.tomato]=[255,99,71],b[f.ST_PresetColorVal.turquoise]=[64,224,208],b[f.ST_PresetColorVal.violet]=[238,130,238],b[f.ST_PresetColorVal.wheat]=[245,222,179],b[f.ST_PresetColorVal.white]=[255,255,255],b[f.ST_PresetColorVal.whiteSmoke]=[245,245,245],b[f.ST_PresetColorVal.yellow]=[255,255,0],b[f.ST_PresetColorVal.yellowGreen]=[154,205,50]},a.GetPresetColorRGB=function(b){return a.presetColors[b]},a.GetDimensioin=function(a){var b={0:-1,1:2,33:2,34:2,35:2,36:2,11:3,48:3,57:2,58:2};return b[a]||1},a.AreValuesAllNum=function(a,b,c){var d,e,f;if(x.isNullOrUndefined(b))return null;for(d=a.getArray(b.row,b.col,b.rowCount,b.colCount),e=!0,f=0;f<d.length;f++)if(!this.AreAllNumbers(d[f],c)){e=!1;break}return e},a.AreValuesDateTime=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;if(x.isNullOrUndefined(c)||0===c.length)return!1;for(e=!0,g=this.GetStylesFromCellRefers(b,c,d),h=this.GetValuesFromCellRefers(b,c,d),i=0;i<g.length;i++){for(j=g[i],k=j.length,l=j[0]&&j[0].length,m=0;m<l;m++){for(n=0;n<k;n++)if(o=j[n][m],f=h[i]&&h[i][n]&&h[i][n][m],!x.isNullOrUndefined(f)&&!(f instanceof Date)&&(x.isNullOrUndefined(o)||!a.IsDatesOrTimesNumberFormat(o.FormatCode)||!K(f))){e=!1;break}if(!e)break}if(!e)break}if(e){for(p=0,q=h;p<q.length;p++)for(r=q[p],s=0,t=r;s<t.length;s++)if(u=t[s],!x.isNullOrUndefined(u))for(v=0;v<u.length;v++)if(f=u[v],!x.isNullOrUndefined(f))return!0;return!1}return!1},a.AreAllNumbers=function(a,b){var c,d,e,f,g,h;if(!a)return!1;for(c=!0,d=0,e=a;d<e.length;d++)if(f=e[d],g=K(f),h=b&&(null===f||f&&f._error),!g&&!h){c=!1;break}return c},a.AreAllNull=function(a){var b,c,d,e=!0;for(b=0,c=a;b<c.length;b++)if(d=c[b],null!==d&&void 0!==d){e=!1;break}return e},a.AreAllDate=function(a,b){var c,d,e,f;for(c=0,d=a;c<d.length;c++)if(e=d[c],f=b&&(null===e||e&&e._error),!(e instanceof Date||f))return!1;return!0},a.TryAllToNumbers=function(a,b,c){var d,e,f,g,h,j;if(x.isNullOrUndefined(a)||0===a.length)return!1;for(d=!0,e=[],f=a.length,g=0;g<f;g++)h=a[g],x.isNullOrUndefined(h)?c||e.push(h):(j={value:void 0},this.TryToDouble(h,j)?e.push(j.value):(i.Convert&&i.Convert.jja(h)?e.push(Number.NaN):e.push(0),d=!1));return Array.prototype.push.apply(b,e),d},a.TryToDouble=function(a,b,c){var d,e,f,g,h,i,j={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},l=k;if(!a)return b.value=0,!0;d=typeof a;try{if("number"===d)l=a;else if("string"===d&&c){if(a=a.trim(),0===a.length)return b.value=0,!0;if(e=".",f=",","."!==e&&"."!==f&&a.indexOf(".")>=0||","!==e&&","!==f&&a.indexOf(",")>=0)return!1;if(g=!1,"%"===a.charAt(a.length-1)&&(g=!0,a=a.substr(0,a.length-1)),"$"===a[0]||"$"===a[a.length-1])return!1;if(a.indexOf(e)!==a.lastIndexOf(e))return!1;if(a.length>=2&&"0"===a[0]&&"x"===a[1])return!1;if(l=+a,w.isNaNOrInfinite(l)){if(h=a.charCodeAt(0),h|=32,a.length>4&&h>=96&&h<=122&&(i=a[0]+a[1]+a[2],i=i.toUpperCase(),!j[i]))return!1;if("/"===a[0]||"/"===a[a.length-1])return!1;if("#"===a[0]||"#"===a[a.length-1])return!1;if(l=new Date(a),w.isNaNOrInfinite(l.valueOf()))return!1;l=v.ToOADate(l)}g&&(l/=100)}else if("boolean"===d)l=a?1:0;else{if(!(a instanceof Date))return!1;l=v.ToOADate(a)}}catch(a){return!1}return b.value=l,!0},a.IsBarChart=function(a){return a===f.ChartType.barClustered||a===f.ChartType.barClustered3D||a===f.ChartType.barStacked||a===f.ChartType.barStacked100||a===f.ChartType.barStacked1003D||a===f.ChartType.barStacked3D},a.zpa=function(b){var c,d=a.chartTypeDict;if(!d){d=a.chartTypeDict={};for(c in f.ChartType)d[f.ChartType[c]]=c.toLowerCase()}return d[b]},a.IsColumnChart=function(b){return a.zpa(b).indexOf("column")>=0},a.IsAnyPieChart=function(a){return this.IsPieChart(a)||this.IsDoughnutChart(a)||this.IsOfPieChart(a)},a.IsFunnelChart=function(a){return a===f.ChartType.funnel},a.IsPieChart=function(b){return a.zpa(b).indexOf("pie")>=0},a.IsPieOrDoughnutChart=function(a){return this.IsPieChart(a)||this.IsDoughnutChart(a)},a.IsRadarChart=function(a){return a===f.ChartType.radar||a===f.ChartType.radarFilled||a===f.ChartType.radarMarkers},a.IsOfPieChart=function(a){return a===f.ChartType.pieOfPie||a===f.ChartType.barOfPie},a.IsStackedChart=function(b){return a.zpa(b).indexOf("stacked")>=0},a.IsStacked100Chart=function(b){return a.zpa(b).indexOf("stacked100")>=0},a.IsLineChart=function(a){return a===f.ChartType.line3D||a===f.ChartType.line||a===f.ChartType.lineMarkers||a===f.ChartType.lineMarkersStacked||a===f.ChartType.lineMarkersStacked100||a===f.ChartType.lineStacked||a===f.ChartType.lineStacked100},a.IsLineMarkerChart=function(a){return a===f.ChartType.lineMarkers||a===f.ChartType.lineMarkersStacked||a===f.ChartType.lineMarkersStacked100},a.IsLineSeries=function(a){return a===f.ChartType.line||a===f.ChartType.lineMarkers||a===f.ChartType.lineMarkersStacked||a===f.ChartType.lineMarkersStacked100||a===f.ChartType.lineStacked||a===f.ChartType.lineStacked100||a===f.ChartType.xyScatterLines||a===f.ChartType.xyScatterLinesNoMarkers||a===f.ChartType.xyScatterSmooth||a===f.ChartType.xyScatterSmoothNoMarkers||a===f.ChartType.radar||a===f.ChartType.radarMarkers},a.IsMarkerSeries=function(a){return a===f.ChartType.lineMarkers||a===f.ChartType.lineMarkersStacked||a===f.ChartType.lineMarkersStacked100||a===f.ChartType.radarMarkers||a===f.ChartType.xyScatter||a===f.ChartType.xyScatterLines||a===f.ChartType.xyScatterSmooth},a.IsErrorBarSeries=function(b){return!a.Is3DChart(b)&&(a.IsBarChart(b)||a.IsAreaChart(b)||a.IsLineChart(b)||a.IsColumnChart(b)||a.IsScatterChart(b)||a.IsBubbleChart(b))},a.IsTrendlineSeries=function(b){return!a.Is3DChart(b)&&!a.IsStackedChart(b)&&(b===f.ChartType.barClustered||b===f.ChartType.columnClustered||b===f.ChartType.line||b===f.ChartType.lineMarkers||b===f.ChartType.area||a.IsScatterChart(b)||a.IsBubbleChart(b))},a.IsFillSeries=function(a){return!this.IsLineSeries(a)&&a!==f.ChartType.xyScatter},a.IsAreaChart=function(b){return a.zpa(b).indexOf("area")>=0},a.IsScatterChart=function(b){return a.zpa(b).indexOf("scatter")>=0},a.IsSurfaceChart=function(b){return a.zpa(b).indexOf("surface")>=0},a.IsBubbleChart=function(b){return a.zpa(b).indexOf("bubble")>=0},a.IsSmoothLine=function(b){return a.zpa(b).indexOf("smooth")>=0},a.Is3DChart=function(b){var c=a.zpa(b);return c.indexOf("3d")>=0&&b!==f.ChartType.bubble3DEffect||this.IsSurfaceChart(b)||c.indexOf("cylinder")>=0||c.indexOf("cone")>=0||c.indexOf("pyramid")>=0},a.IsSurface3DChart=function(a){return a===f.ChartType.surface||a===f.ChartType.surfaceWireframe},a.IsDoughnutChart=function(a){return a===f.ChartType.doughnut||a===f.ChartType.doughnutExploded},a.IsExplodedChart=function(a){return a===f.ChartType.pieExploded3D||a===f.ChartType.doughnutExploded||a===f.ChartType.pieExploded},a.HasSeriesAx=function(a){return a===f.ChartType.column3D||a===f.ChartType.area3D||a===f.ChartType.line3D||this.IsSurfaceChart(a)},a.IsStockChart=function(b){return a.zpa(b).indexOf("stock")>=0},a.IsTreeMap=function(a){return a===f.ChartType.treemap},a.IsSunburstChart=function(a){return a===f.ChartType.sunburst},a.IsSunburstOrTreemapChart=function(b){return a.IsTreeMap(b)||a.IsSunburstChart(b)},a.IsStockHLC=function(a){return a===f.ChartType.stockHLC},a.IsBuiltInComboChart=function(a){return this.IsStockChart(a)},a.ConvertToTextUnderlineType=function(a){var b=f.TextUnderlineType.None;return a===f.UnderlineType.Single?b=f.TextUnderlineType.Single:a===f.UnderlineType.Double&&(b=f.TextUnderlineType.Double),b},a.ToUnderlineType=function(a){var b=f.UnderlineType.None;return a===f.TextUnderlineType.Single?b=f.UnderlineType.Single:a===f.TextUnderlineType.Double&&(b=f.UnderlineType.Double),b},a.MapToGroupType=function(a){var b={12:9,13:9,14:9,15:3,16:3,17:3,6:3,18:8,19:8,20:8,21:2,22:2,23:2,9:11,24:11,25:11,26:11,27:11,28:11,5:4,10:12,29:12,30:12,32:12,31:5,4:5,1:14,33:14,34:14,35:14,36:14,8:7,37:7,38:7,39:1,40:1,7:1,3:10,41:10,2:13,42:13,43:13,44:6,45:6,46:6,47:6,11:14,48:14,49:11,
50:11,51:11,52:11};return b[a]||J.UnKnown},a.HasSeriesLines=function(a){return this.IsOfPieChart(a)},a.HasHiLoLines=function(a){return this.IsStockChart(a)},a.HasUpDownBars=function(a){return a===f.ChartType.stockOHLC||a===f.ChartType.stockVOHLC},a.RangeToReferences=function(b){var c,d,e,f=[];for(c=0,d=b.Areas;c<d.length;c++)e=d[c],f.push(a.CreateReference(e.Worksheet.name(),e.Row,e.Column,e.RowCount,e.ColumnCount));return f},a.CreateReference=function(a,b,c,d,e){return 1===d&&1===e?new B(a,b,c):new B(a,b,c,b+d-1,c+e-1)},a.ReferencesToFormula=function(a,b){var c,d;if(b===l&&(b=!1),x.isNullOrUndefined(a)||0===a.length)return k;for(c=[],d=0;d<a.length;d++)d>0&&c.push(","),b?c.push(a[d].ToR1C1Text()):c.push(a[d].ToA1Text(0,0));return c.join("")},a.getRangeInfoByFormula=function(a,b){var c,d,e,f;return b&&(c=g.formulaToRanges(a,b,0,0),d=c[0],d&&(e=a.parent,f=e.getSheetFromName(d.sheetName)))?{sheet:f,range:d.ranges&&d.ranges[0]}:{range:{}}},a.isContinuousRange=function(a,b,c){if(a.sheet!==b.sheet)return!1;var d,e,f,g,h,i,j,k,l,m;if(c){if(d=a.range,f=d.rowCount,g=d.col,h=d.colCount,i=b.range,k=i.rowCount,l=i.col,f===k&&g+h===l)return!0}else if(d=a.range,f=d.rowCount,e=d.row,h=d.colCount,i=b.range,m=i.colCount,j=d.row,h===m&&e+f===j)return!0},a.GetValuesFromCellRefers=function(a,b,c){var d,e,f,g,h=[];if(x.isNullOrUndefined(b)||0===b.length||b.some(function(a){return a.IsError}))return h;for(d=0,e=b;d<e.length;d++)f=e[d],g=this.GetValuesFromCellRefer(a,f,c),x.isNullOrUndefined(g)||h.push(g);return h},a.GetValuesFromCellRefer=function(a,b,c){var d,e=a.Apa(b.WorksheetName);return x.isNullOrUndefined(e)?k:d=c?e.Bpa(b.Row,b.Column,b.RowCount,b.ColumnCount,!0):e.Cpa(b.Row,b.Column,b.RowCount,b.ColumnCount,!0)},a.GetStylesFromCellRefers=function(a,b,c){var d,e,f,g,h=[];if(x.isNullOrUndefined(b)||0===b.length||b.some(function(a){return a.IsError}))return h;for(d=0,e=b;d<e.length;d++)f=e[d],g=this.GetStylesFromCellRefer(a,f,c),x.isNullOrUndefined(g)||h.push(g);return h},a.GetStylesFromCellRefer=function(a,b,c){var d,e=a.Apa(b.WorksheetName);return x.isNullOrUndefined(e)?k:d=c?e.Dpa(b.Row,b.Column,b.RowCount,b.ColumnCount):e.Epa(b.Row,b.Column,b.RowCount,b.ColumnCount)},a.GetPrimaryAxises=function(a){var b,c,d=[],e=a.axes.length;if(a.axes&&e>0)for(b=0;b<e;b++)c=a.axes[b],h.isNullOrUndefined(c.AxisGroup)?e>2?0!==b&&1!==b||(d.push(c.axId),d.push(c.crossAx),d.axisGroup=c.AxisGroup):0===b&&(d.push(c.axId),d.push(c.crossAx),d.axisGroup=c.AxisGroup):0===c.AxisGroup&&(d.push(c.axId),d.push(c.crossAx),d.axisGroup=c.AxisGroup);return d},a.GetSJSPrimaryAxises=function(a){var b=[];return a.valAx&&(Array.isArray(a.valAx)?(b.push(a.valAx[0].axId.val),b.push(a.valAx[0].crossAx.val)):(b.push(a.valAx.axId.val),b.push(a.valAx.crossAx.val))),b},a.GetSJSSecondaryAxises=function(a){var b,c=[];return a.valAx&&Array.isArray(a.valAx)&&(b=a.valAx.length,c.push(a.valAx[b-1].axId.val),c.push(a.valAx[b-1].crossAx.val)),c},a.GetAxises=function(b,c){var d,e,g,h,i,j=a.GetPrimaryAxises(b);if(c===f.AxisGroup.primary)return j;if(d=[],!x.isNullOrUndefined(b.axes))for(e=b.axes.filter(function(a){return j.indexOf(a.axId)<0}),g=0,h=e;g<h.length;g++)i=h[g],d.push(i.axId);return d},a.GetSJSAxises=function(b,c){var d=a.GetSJSPrimaryAxises(b);return c===f.AxisGroup.primary?d:a.GetSJSSecondaryAxises(b)},a.GetCategoryAxises=function(a){var b,c,d,e=[];for(b=0,c=a.chartGroups;b<c.length;b++)d=c[b],!x.isNullOrUndefined(d.axId)&&d.axId.length>0&&e.push(d.axId[0]);return e},a.GetSJSCategoryAxises=function(b){var c,d,e,f=[],g=a.GetSJS_ChartGroups(b);for(c=0,d=g;c<d.length;c++)e=[].concat(d[c]),e.forEach(function(a){!h.isNullOrUndefined(a)&&!x.isNullOrUndefined(a.axId)&&a.axId.length>0&&f.push(a.axId.val||a.axId[0].val)});return f},a.GetIs2016ChartByPlotArea=function(b){var c=a.Get2016ChartType(b);return!!c},a.GetIs2016ChartByChartType=function(a){return 53===a||54===a||55===a||56===a||57===a||58===a||59===a||60===a},a.GetSJS2016ChartType=function(a){var b,c=a&&a.plotAreaRegion&&a.plotAreaRegion.series;return c&&(c=[].concat(c)),c&&c.length>0&&(b=f.SeriesType[c[0].layoutId]),b},a.Get2016ChartType=function(a){var b,c=a&&a.plotAreaRegion&&a.plotAreaRegion.series;return c&&c.length>0&&(b=c[0].layoutId),b},a.GetChartType=function(b){var c,d,e,g,h,i,j=a.Get2016ChartType(b);if(j)return a.GetChartTypeBy2016InnerChartType(j);if(c=this.GetStockChartType(b),!x.isNullOrUndefined(c))return c;for(d=[],e=0,g=b.chartGroups;e<g.length;e++)h=g[e],i=a.GetChartTypeByChartBase(h),d.indexOf(i)<0&&d.push(i);return 0===d.length?f.ChartType.columnClustered:d.length>1?f.ChartType.combo:d[0]},a.GetSJSChartType=function(b){var c,d,e=a.GetSJS2016ChartType(b);return e?a.GetChartTypeBy2016InnerChartType(e):(c=this.GetSJS_StockChartType(b),x.isNullOrUndefined(c)?(d=a.GetSJS_ChartTypeByChartGroupBase(b),d.length>1?f.ChartType.combo:d[0]):c)},a.GetStockChartType=function(b){var c=a.GetStockChart(b);if(0===c.length)return k;if(!x.isNullOrUndefined(b.chartGroups)&&b.chartGroups.length>1){if(3===c[0].ser.length)return f.ChartType.stockVHLC;if(4===c[0].ser.length)return f.ChartType.stockVOHLC}else{if(3===c[0].ser.length)return f.ChartType.stockHLC;if(4===c[0].ser.length)return f.ChartType.stockOHLC}return k},a.GetSJS_ChartGroups=function(a){var b=[a.area3DChart,a.areaChart,a.bar3DChart,a.barChart,a.bubbleChart,a.doughnutChart,a.line3DChart,a.lineChart,a.ofPieChart,a.pie3DChart,a.pieChart,a.radarChart,a.scatterChart,a.stockChart,a.surface3DChart,a.surfaceChart];return b.filter(function(a){return!h.isNullOrUndefined(a)})},a.GetSJS_StockChartType=function(b){var c,d=b.stockChart;if(h.isNullOrUndefined(d))return k;if(d.ser)if(c=[].concat(d.ser).length,a.GetSJS_ChartGroups(b).length>1){if(3===c)return f.ChartType.stockVHLC;if(4===c)return f.ChartType.stockVOHLC}else{if(3===c)return f.ChartType.stockHLC;if(4===c)return f.ChartType.stockOHLC}return k},a.GetChartTypeByChartBase=function(b,c){return c===l&&(c=k),b.chartType===f.CT_ChartType.CT_BarChart||b.chartType===f.CT_ChartType.CT_Bar3DChart?a.GetChartTypeByBarChart(b):b.chartType===f.CT_ChartType.CT_AreaChart||b.chartType===f.CT_ChartType.CT_Area3DChart?a.GetChartTypeByAreaChart(b):b.chartType===f.CT_ChartType.CT_LineChart||b.chartType===f.CT_ChartType.CT_Line3DChart?a.GetChartTypeByLineChart(b):[f.CT_ChartType.CT_PieChart,f.CT_ChartType.CT_Pie3DChart,f.CT_ChartType.CT_DoughnutChart,f.CT_ChartType.CT_OfPieChart].indexOf(b.chartType)>=0?a.GetChartTypeByPieChart(b):b.chartType===f.CT_ChartType.CT_RadarChart?a.GetChartTypeByRadarChart(b,c):b.chartType===f.CT_ChartType.CT_ScatterChart?a.GetChartTypeByScatterChart(b,c):b.chartType===f.CT_ChartType.CT_BubbleChart?a.GetChartTypeByBubbleChart(b):b.chartType===f.CT_ChartType.CT_SurfaceChart||b.chartType===f.CT_ChartType.CT_Surface3DChart?a.GetChartTypeBySurfaceChart(b):f.ChartType.columnClustered},a.GetSJS_ChartTypeByChartGroupBase=function(b,c){var d=[];return b.barChart&&d.push(a.GetSJSChartTypeByBarChart(b.barChart)),b.bar3DChart&&d.push(a.GetSJSChartTypeByBarChart(b.bar3DChart,!0)),b.areaChart&&d.push(a.GetSJSChartTypeByAreaChart(b.areaChart)),b.area3DChart&&d.push(a.GetSJSChartTypeByAreaChart(b.area3DChart,!0)),b.lineChart&&d.push(a.GetSJSChartTypeByLineChart(b.lineChart)),b.line3DChart&&d.push(a.GetSJSChartTypeByLineChart(b.line3DChart,!0)),b.radarChart&&d.push(a.GetSJSChartTypeByRadarChart(b.radarChart,c)),b.scatterChart&&d.push(a.GetSJSChartTypeByScatterChart(b.scatterChart,c)),b.pieChart&&d.push(f.ChartType.pie),b.pie3DChart&&d.push(f.ChartType.pie3D),b.doughnutChart&&d.push(f.ChartType.doughnut),b.ofPieChart&&d.push(b.ofPieChart.ofPieType&&b.ofPieChart.ofPieType.val===f.ST_OfPieType[1]?f.ChartType.barOfPie:f.ChartType.pieOfPie),b.surfaceChart&&d.push(a.GetSJSChartTypeBySurfaceChart(b.surfaceChart)),b.surface3DChart&&d.push(a.GetSJSChartTypeBySurfaceChart(b.surface3DChart,!0)),b.bubbleChart&&d.push(a.GetSJSChartTypeByBubbleChart(b.bubbleChart)),d.length>0?d:[f.ChartType.columnClustered]},a.GetSJS_SeriesChartTypeByChartBase=function(b,c){return c===l&&(c=k),b.chartType===f.CT_ChartType.CT_BarChart||b.chartType===f.CT_ChartType.CT_Bar3DChart?a.GetSJSChartTypeByBarChart(b,b.chartType===f.CT_ChartType.CT_Bar3DChart):b.chartType===f.CT_ChartType.CT_AreaChart||b.chartType===f.CT_ChartType.CT_Area3DChart?a.GetSJSChartTypeByAreaChart(b,b.chartType===f.CT_ChartType.CT_Area3DChart):b.chartType===f.CT_ChartType.CT_LineChart||b.chartType===f.CT_ChartType.CT_Line3DChart?a.GetSJSChartTypeByLineChart(b,b.chartType===f.CT_ChartType.CT_Line3DChart):[f.CT_ChartType.CT_PieChart,f.CT_ChartType.CT_Pie3DChart,f.CT_ChartType.CT_DoughnutChart,f.CT_ChartType.CT_OfPieChart].indexOf(b.chartType)>=0?a.GetChartTypeByPieChart(b):b.chartType===f.CT_ChartType.CT_RadarChart?a.GetSJSChartTypeByRadarChart(b,c):b.chartType===f.CT_ChartType.CT_ScatterChart?a.GetSJSChartTypeByScatterChart(b,c):b.chartType===f.CT_ChartType.CT_BubbleChart?a.GetSJSChartTypeByBubbleChart(b):b.chartType===f.CT_ChartType.CT_SurfaceChart||b.chartType===f.CT_ChartType.CT_Surface3DChart?a.GetSJSChartTypeBySurfaceChart(b):f.ChartType.columnClustered},a.GetChartTypeBy2016InnerChartType=function(a){if(!x.isNullOrUndefined(a))switch(a){case f.CT_ChartType.CT_BoxWhisker:return f.ChartType.boxWhisker;case f.CT_ChartType.CT_Funnel:return f.ChartType.funnel;case f.CT_ChartType.CT_ParetoLine:return f.ChartType.paretoLine;case f.CT_ChartType.CT_RegionMap:return f.ChartType.regionMap;case f.CT_ChartType.CT_Sunburst:return f.ChartType.sunburst;case f.CT_ChartType.CT_Treemap:return f.ChartType.treemap;case f.CT_ChartType.CT_Waterfall:return f.ChartType.waterfall;case f.CT_ChartType.CT_ClusteredColumn:return f.ChartType.clusteredColumn}return f.CT_ChartType.CT_Treemap},a.Get2016InnerChartTypeByChartType=function(a){if(!x.isNullOrUndefined(a))switch(a){case f.ChartType.boxWhisker:return f.CT_ChartType.CT_BoxWhisker;case f.ChartType.funnel:return f.CT_ChartType.CT_Funnel;case f.ChartType.paretoLine:return f.CT_ChartType.CT_ParetoLine;case f.ChartType.regionMap:return f.CT_ChartType.CT_RegionMap;case f.ChartType.sunburst:return f.CT_ChartType.CT_Sunburst;case f.ChartType.treemap:return f.CT_ChartType.CT_Treemap;case f.ChartType.waterfall:return f.CT_ChartType.CT_Waterfall;case f.ChartType.clusteredColumn:return f.CT_ChartType.CT_ClusteredColumn}return f.CT_ChartType.CT_Treemap},a.GetChartTypeByBarChart=function(a){var b=a.chartType===f.CT_ChartType.CT_Bar3DChart||!h.isNullOrUndefined(a.shape);if(x.isNullOrUndefined(a.grouping))return b?a.barDir===f.ST_BarDir.bar?f.ChartType.barClustered3D:f.ChartType.columnClustered3D:a.barDir===f.ST_BarDir.bar?f.ChartType.barClustered:f.ChartType.columnClustered;switch(a.grouping){case f.ST_BarGrouping.percentStacked:return b?a.barDir===f.ST_BarDir.bar?f.ChartType.barStacked1003D:f.ChartType.columnStacked1003D:a.barDir===f.ST_BarDir.bar?f.ChartType.barStacked100:f.ChartType.columnStacked100;case f.ST_BarGrouping.clustered:return b?a.barDir===f.ST_BarDir.bar?f.ChartType.barClustered3D:f.ChartType.columnClustered3D:a.barDir===f.ST_BarDir.bar?f.ChartType.barClustered:f.ChartType.columnClustered;case f.ST_BarGrouping.standard:return b?a.barDir===f.ST_BarDir.bar?f.ChartType.barClustered3D:f.ChartType.column3D:a.barDir===f.ST_BarDir.bar?f.ChartType.barClustered:f.ChartType.columnClustered;case f.ST_BarGrouping.stacked:return b?a.barDir===f.ST_BarDir.bar?f.ChartType.barStacked3D:f.ChartType.columnStacked3D:a.barDir===f.ST_BarDir.bar?f.ChartType.barStacked:f.ChartType.columnStacked}return f.ChartType.columnClustered},a.GetSJSChartTypeByBarChart=function(a,b){var c=[].concat(a)[0],d=!!b,e=f.ST_BarDir[c.barDir.val],g=c.grouping&&c.grouping.val;if(x.isNullOrUndefined(g))return d?e===f.ST_BarDir.bar?f.ChartType.barClustered3D:f.ChartType.columnClustered3D:e===f.ST_BarDir.bar?f.ChartType.barClustered:f.ChartType.columnClustered;switch(f.ST_BarGrouping[g]){case f.ST_BarGrouping.percentStacked:return d?e===f.ST_BarDir.bar?f.ChartType.barStacked1003D:f.ChartType.columnStacked1003D:e===f.ST_BarDir.bar?f.ChartType.barStacked100:f.ChartType.columnStacked100;case f.ST_BarGrouping.clustered:return d?e===f.ST_BarDir.bar?f.ChartType.barClustered3D:f.ChartType.columnClustered3D:e===f.ST_BarDir.bar?f.ChartType.barClustered:f.ChartType.columnClustered;case f.ST_BarGrouping.standard:return d?e===f.ST_BarDir.bar?f.ChartType.barClustered3D:f.ChartType.column3D:e===f.ST_BarDir.bar?f.ChartType.barClustered:f.ChartType.columnClustered;case f.ST_BarGrouping.stacked:return d?e===f.ST_BarDir.bar?f.ChartType.barStacked3D:f.ChartType.columnStacked3D:e===f.ST_BarDir.bar?f.ChartType.barStacked:f.ChartType.columnStacked}return f.ChartType.columnClustered},a.GetChartTypeByAreaChart=function(a){var b=a.chartType===f.CT_ChartType.CT_Area3DChart;if(x.isNullOrUndefined(a.grouping))return b?f.ChartType.area3D:f.ChartType.area;switch(a.grouping){case f.ST_Grouping.percentStacked:return b?f.ChartType.areaStacked1003D:f.ChartType.areaStacked100;case f.ST_Grouping.standard:return b?f.ChartType.area3D:f.ChartType.area;case f.ST_Grouping.stacked:return b?f.ChartType.areaStacked3D:f.ChartType.areaStacked}return f.ChartType.area},a.GetSJSChartTypeByAreaChart=function(a,b){var c=[].concat(a)[0],d=!!b,e=c.grouping&&c.grouping.val;if(x.isNullOrUndefined(e))return d?f.ChartType.area3D:f.ChartType.area;switch(f.ST_Grouping[e]){case f.ST_Grouping.percentStacked:return d?f.ChartType.areaStacked1003D:f.ChartType.areaStacked100;case f.ST_Grouping.standard:return d?f.ChartType.area3D:f.ChartType.area;case f.ST_Grouping.stacked:return d?f.ChartType.areaStacked3D:f.ChartType.areaStacked}return f.ChartType.area},a.GetChartTypeByLineChart=function(a){var b=a.chartType===f.CT_ChartType.CT_Line3DChart,c=a.marker;if(x.isNullOrUndefined(a.grouping)){if(b)return f.ChartType.line3D}else switch(a.grouping){case f.ST_Grouping.percentStacked:return b?f.ChartType.line3D:c?f.ChartType.lineMarkersStacked100:f.ChartType.lineStacked100;case f.ST_Grouping.standard:return b?f.ChartType.line3D:c?f.ChartType.lineMarkers:f.ChartType.line;case f.ST_Grouping.stacked:return b?f.ChartType.line3D:c?f.ChartType.lineMarkersStacked:f.ChartType.lineStacked;default:return f.ChartType.area}return c?f.ChartType.lineMarkers:f.ChartType.line},a.GetSJSChartTypeByLineChart=function(a,b){var c=[].concat(a)[0],e=!!b,g=d.NodeHelper.oca(c.marker&&c.marker.val),h=c.grouping&&c.grouping.val;if(x.isNullOrUndefined(h)){if(e)return f.ChartType.line3D}else switch(f.ST_Grouping[h]){case f.ST_Grouping.percentStacked:return e?f.ChartType.line3D:g?f.ChartType.lineMarkersStacked100:f.ChartType.lineStacked100;case f.ST_Grouping.standard:return e?f.ChartType.line3D:g?f.ChartType.lineMarkers:f.ChartType.line;case f.ST_Grouping.stacked:return e?f.ChartType.line3D:g?f.ChartType.lineMarkersStacked:f.ChartType.lineStacked;default:return f.ChartType.area}return g?f.ChartType.lineMarkers:f.ChartType.line},a.GetChartTypeByPieChart=function(a){if(a.chartType===f.CT_ChartType.CT_PieChart)return f.ChartType.pie;if(a.chartType===f.CT_ChartType.CT_Pie3DChart)return f.ChartType.pie3D;if(a.chartType===f.CT_ChartType.CT_OfPieChart){var b=a;return b.ofPieType===f.ST_OfPieType.bar?f.ChartType.barOfPie:f.ChartType.pieOfPie}return a.chartType===f.CT_ChartType.CT_DoughnutChart?f.ChartType.doughnut:f.ChartType.pie},a.GetChartTypeByRadarChart=function(a,b){var c=b&&b.marker&&b.marker.symbol&&b.marker.symbol===f.MarkerStyle.MarkerStyleNone;if(!x.isNullOrUndefined(a.radarStyle))switch(a.radarStyle){case f.ST_RadarStyle.standard:case f.ST_RadarStyle.marker:return c?f.ChartType.radar:f.ChartType.radarMarkers;case f.ST_RadarStyle.filled:return f.ChartType.radarFilled}return 2},a.GetSJSChartTypeByRadarChart=function(a,b){var c=[].concat(a)[0],d=b&&b.marker&&b.marker.symbol&&b.marker.symbol&&b.marker.symbol.val===f.SymbolShape[4];if(!x.isNullOrUndefined(c.radarStyle))switch(f.ST_RadarStyle[c.radarStyle.val]){case f.ST_RadarStyle.standard:case f.ST_RadarStyle.marker:return d?f.ChartType.radar:f.ChartType.radarMarkers;case f.ST_RadarStyle.filled:return f.ChartType.radarFilled}return 2},a.GetChartTypeByScatterChart=function(a,b){var c,d,e,g,h,i,j,k=a.scatterStyle;return x.isNullOrUndefined(k)?f.ChartType.xyScatter:(c={0:1,1:36,2:35,3:f.ChartType.xyScatter,4:34,5:33},d=k,e=b||a.ser[0],g=e&&e.marker&&e.marker.symbol,h=4===g,i=e&&e.spPr&&e.spPr.ln,j=i&&i.noFill,2===d?j?d=3:h&&(d=1):5===d&&h&&(d=4),c[d])},a.GetSJSChartTypeByScatterChart=function(a,b){var c,d,e,g,h,i,j,k=[].concat(a)[0],l=k.scatterStyle&&k.scatterStyle.val;return x.isNullOrUndefined(l)?f.ChartType.xyScatter:(c={0:1,1:36,2:35,3:f.ChartType.xyScatter,4:34,5:33},d=f.ST_ScatterStyle[l],e=b||k.ser[0],g=e&&e.marker&&e.marker.symbol&&e.marker.symbol.val,h=4===f.ST_MarkerStyle[g],i=e&&e.spPr&&e.spPr.ln,j=i&&i.noFill,2===d?j?d=3:h&&(d=1):5===d&&h&&(d=4),c[d])},a.GetChartTypeByBubbleChart=function(a){return a.bubble3D?f.ChartType.bubble3DEffect:f.ChartType.bubble},a.GetSJSChartTypeByBubbleChart=function(a){var b;return a.bubble3D&&(b=d.NodeHelper.oca(a.bubble3D.val)),b?f.ChartType.bubble3DEffect:f.ChartType.bubble},a.GetChartTypeBySurfaceChart=function(a){var b=a.chartType===f.CT_ChartType.CT_Surface3DChart;return b?a.wireframe?f.ChartType.surfaceWireframe:f.ChartType.surface:a.wireframe?f.ChartType.surfaceTopViewWireframe:f.ChartType.surfaceTopView},a.GetSJSChartTypeBySurfaceChart=function(a,b){return b?d.NodeHelper.oca(a.wireframe)?f.ChartType.surfaceWireframe:f.ChartType.surface:d.NodeHelper.oca(a.wireframe)?f.ChartType.surfaceTopViewWireframe:f.ChartType.surfaceTopView},a.GetTextFieldTypeString=function(a){var c={0:b.ChartConstants.FIELD_TYPE_CELLRANGE,1:b.ChartConstants.FIELD_TYPE_SERIESNAME,2:b.ChartConstants.FIELD_TYPE_CATEGORYNAME,3:b.ChartConstants.FIELD_TYPE_VALUE,4:b.ChartConstants.FIELD_TYPE_XVALUE,5:b.ChartConstants.FIELD_TYPE_YVALUE,6:b.ChartConstants.FIELD_TYPE_BUBBLESIZE,7:b.ChartConstants.FIELD_TYPE_PERCENTAGE,8:b.ChartConstants.FIELD_TYPE_TXLINK};return c[a]||""},a.GetTextFieldTypeText=function(a){var c={0:b.ChartConstants.FIELD_TEXT_CELLRANGE,1:b.ChartConstants.FIELD_TEXT_SERIESNAME,2:b.ChartConstants.FIELD_TEXT_CATEGORYNAME,3:b.ChartConstants.FIELD_TEXT_VALUE,4:b.ChartConstants.FIELD_TEXT_XVALUE,5:b.ChartConstants.FIELD_TEXT_YVALUE,6:b.ChartConstants.FIELD_TEXT_BUBBLESIZE};return c[a]||""},a.GetTextFieldType=function(a){var c=f.TextFieldType.CellRange;switch(a){case b.ChartConstants.FIELD_TYPE_CELLRANGE:c=f.TextFieldType.CellRange;break;case b.ChartConstants.FIELD_TYPE_SERIESNAME:c=f.TextFieldType.SeriesName;break;case b.ChartConstants.FIELD_TYPE_CATEGORYNAME:c=f.TextFieldType.CategoryName;break;case b.ChartConstants.FIELD_TYPE_VALUE:c=f.TextFieldType.Value;break;case b.ChartConstants.FIELD_TYPE_XVALUE:c=f.TextFieldType.XValue;break;case b.ChartConstants.FIELD_TYPE_YVALUE:c=f.TextFieldType.YValue;break;case b.ChartConstants.FIELD_TYPE_BUBBLESIZE:c=f.TextFieldType.BubbleSize;break;case b.ChartConstants.FIELD_TYPE_PERCENTAGE:c=f.TextFieldType.Percentage;break;case b.ChartConstants.FIELD_TYPE_TXLINK:c=f.TextFieldType.TxLink}return c},a.GetPrimaryPieChart=function(a){return a[0]},a.GetPlotAreaCharts=function(a,b){return a.chartGroups?a.chartGroups.filter(function(a){return a.chartType===b}):[]},a.GetSJSPlotAreaCharts=function(a,b){return h.isNullOrUndefined(a[b])?[]:[].concat(a[b])},a.GetAreaChart=function(b){return a.GetPlotAreaCharts(b,4)},a.GetSJSAreaChart=function(b){return a.GetSJSPlotAreaCharts(b,"areaChart")},a.GetArea3DChart=function(b){var c=a.GetPlotAreaCharts(b,5);return c.length>0?c[0]:k},a.GetSJSArea3DChart=function(b){var c=a.GetSJSPlotAreaCharts(b,"area3DChart");return c.length>0?c[0]:k},a.GetBarChart=function(b){return a.GetPlotAreaCharts(b,6)},a.GetSJSBarChart=function(b){return a.GetSJSPlotAreaCharts(b,"barChart")},a.GetBar3DChart=function(b){var c=a.GetPlotAreaCharts(b,7);return c.length>0?c[0]:k},a.GetSJSBar3DChart=function(b){var c=a.GetSJSPlotAreaCharts(b,"bar3DChart");return c.length>0?c[0]:k},a.GetLineChart=function(b){return a.GetPlotAreaCharts(b,8)},a.GetSJSLineChart=function(b){return a.GetSJSPlotAreaCharts(b,"lineChart")},a.GetLine3DChart=function(b){var c=a.GetPlotAreaCharts(b,9);return c.length>0?c[0]:k},a.GetSJSLine3DChart=function(b){var c=a.GetSJSPlotAreaCharts(b,"line3DChart");return c.length>0?c[0]:k},a.GetStockChart=function(b){return a.GetPlotAreaCharts(b,0)},a.GetSJSStockChart=function(b){return a.GetSJSPlotAreaCharts(b,"stockChart")},a.GetRadarChart=function(b){return a.GetPlotAreaCharts(b,2)},a.GetSJSRadarChart=function(b){return a.GetSJSPlotAreaCharts(b,"radarChart")},a.GetScatterChart=function(b){return a.GetPlotAreaCharts(b,1)},a.GetSJSScatterChart=function(b){return a.GetSJSPlotAreaCharts(b,"scatterChart")},a.GetPieCharts=function(a){var b=[10,11,12,13];return a.chartGroups?a.chartGroups.filter(function(a){return b.indexOf(a.chartType)>=0}):[]},a.GetPieChart=function(b){return a.GetPlotAreaCharts(b,10)},a.GetSJSPieChart=function(b){return a.GetSJSPlotAreaCharts(b,"pieChart")},a.GetPie3DChart=function(b){var c=a.GetPlotAreaCharts(b,11);return c.length>0?c[0]:k},a.GetSJSPie3DChart=function(b){var c=a.GetSJSPlotAreaCharts(b,"pie3DChart");return c.length>0?c[0]:k},a.GetDoughnutChart=function(b){return a.GetPlotAreaCharts(b,12)},a.GetSJSDoughnutChart=function(b){return a.GetSJSPlotAreaCharts(b,"doughnutChart")},a.GetOfPieChart=function(b){return a.GetPlotAreaCharts(b,13)},a.GetSJSOfPieChart=function(b){return a.GetSJSPlotAreaCharts(b,"ofPieChart")},a.GetSurfaceChart=function(b){return a.GetSurface3DChartOrChart(b,14)},a.GetSJSSurfaceChart=function(b){return a.GetSJSSurface3DChartOrChart(b,"surfaceChart")},a.GetSurface3DChart=function(b){return a.GetSurface3DChartOrChart(b,15)},a.GetSJSSurface3DChart=function(b){return a.GetSJSSurface3DChartOrChart(b,"surface3DChart")},a.GetSurface3DChartOrChart=function(b,c){var d=a.GetPlotAreaCharts(b,c);return d.length>0?d[0]:k},a.GetSJSSurface3DChartOrChart=function(b,c){var d=a.GetSJSPlotAreaCharts(b,c);return d.length>0?d[0]:k},a.GetBubbleChart=function(b){return a.GetPlotAreaCharts(b,3)},a.GetSJSBubbleChart=function(b){return a.GetSJSPlotAreaCharts(b,"bubbleChart")},a.GetAxes=function(a,b){return a.axes.filter(function(a){return a.axisType===b})},a.removeEmptyArrayProperties=function(a){var b,c;for(b in a)a.hasOwnProperty(b)&&(c=a[b],(void 0===c||Array.isArray(c)&&0===c.length)&&delete a[b])},a.allSeriesIsScatterOrBubble=function(b){var c,d,e,f,g=b.ChartType;if(a.IsBubbleChart(g)||a.IsScatterChart(g))return!0;if(0===g&&(c=b.SeriesCollection.AllSers,d=c.length,d>0)){if(e=c[0].ChartType,f=void 0,a.IsBubbleChart(e)){for(f=1;f<d;f++)if(!a.IsBubbleChart(c[f].ChartType))return!1;return!0}if(a.IsScatterChart(e)){for(f=1;f<d;f++)if(!a.IsScatterChart(c[f].ChartType))return!1;return!0}}return!1},a.getLineFormatInfo=function(b,c,d,e,f){var g,i,j,l=b&&b.Format&&b.Format.Line;return l?(g=l.Weight,i={},g>=0&&(i.width=g),j=a.colorFormatToString(l,c,d,e),d||(i.transparency=a.getTransparencyFromColorFormat(l,f)),(j||""===j&&e)&&(i.color=j),h.isNullOrUndefined(l.DashStyle)||(i.dashStyle=l.DashStyle),i):k},a.isSupportConnectedLineChartType=function(a){return a===f.ChartType.line||a===f.ChartType.lineMarkers||a===f.ChartType.xyScatterLines||a===f.ChartType.xyScatterLinesNoMarkers||a===f.ChartType.xyScatterSmooth||a===f.ChartType.xyScatterSmoothNoMarkers},a.isSupportConnected=function(b,c){var d,e,f;if(a.isSupportConnectedLineChartType(b)||a.IsRadarChart(b))return!0;if(0===b)for(d=c.SeriesCollection.AllSers,e=0;e<d.length;e++)if(f=d[e].ChartType,a.isSupportConnectedLineChartType(f)||a.IsRadarChart(f))return!0;return!1},a.isSupportGaps=function(a){return a!==f.ChartType.sunburst&&a!==f.ChartType.treemap&&a!==f.ChartType.lineMarkersStacked&&a!==f.ChartType.lineMarkersStacked100&&a!==f.ChartType.lineStacked&&a!==f.ChartType.lineStacked100},a.IsDatesOrTimesNumberFormat=function(b){var c,d,e,f,g,h,i,j;if(!b||0===b.length)return!1;if(b=b.toUpperCase().trim(),"["===b[0]){if(c=b.indexOf("]"),c===-1||c===b.length-1)return!1;b=b.substr(c+1)}for(d=-1,e=0,f=!1,g=k,h=0;h<b.length;h++){if(j=b[h],"["===j)do j=b[h],h++;while(h<b.length&&"]"!==j);if("Y"===j||"D"===j||"M"===j||"H"===j||"S"===j)f?e++:0!==h&&"\\"===b[h-1]||(f=!0,d=h,e=1);else{if(f=!1," "===j&&g)return!0;0!==e&&(i=b.substr(d,e),d=h,e=0,g=x.isNullOrUndefined(g)?a.IsValidDateOrTimeFormatPattern(i):g&&a.IsValidDateOrTimeFormatPattern(i))}}return 0!==e&&h===b.length&&(i=b.substr(d,e),g=x.isNullOrUndefined(g)?a.IsValidDateOrTimeFormatPattern(i):g&&a.IsValidDateOrTimeFormatPattern(i)),g},a.IsValidDateOrTimeFormatPattern=function(a){var b,c,d,e,f,g={Y:4,D:4,M:5,H:2,S:2};if(!a)return!1;for(b={},c=0;c<a.length;c++)d=a[c],b[d]?b[d]=b[d]+1:b[d]=1;for(e in b)if(b.hasOwnProperty(e)){if(f=g[e],void 0===f)return!1;if(b[e]>f)return!1}return!0},a.ToPatternType=function(a){var b=0;switch(a){case 0:b=1;break;case 1:b=2;break;case 2:b=3;break;case 3:b=4;break;case 4:b=5;break;case 5:b=6;break;case 6:b=7;break;case 7:b=8;break;case 8:b=9;break;case 9:b=10;break;case 10:b=11;break;case 11:b=12;break;case 16:b=13;break;case 17:b=14;break;case 27:b=15;break;case 28:b=16;break;case 34:b=17;break;case 52:b=18;break;case 14:b=19;break;case 15:b=20;break;case 25:b=21;break;case 26:b=22;break;case 36:b=23;break;case 45:b=24;break;case 29:b=25;break;case 30:b=26;break;case 32:b=27;break;case 31:b=28;break;case 19:b=29;break;case 18:b=30;break;case 21:b=31;break;case 20:b=32;break;case 40:b=33;break;case 37:b=34;break;case 41:b=35;break;case 35:b=36;break;case 39:b=37;break;case 53:b=38;break;case 43:b=39;break;case 42:b=40;break;case 44:b=41;break;case 46:b=42;break;case 47:b=43;break;case 48:b=44;break;case 38:b=45;break;case 49:b=46;break;case 50:b=47;break;case 51:b=48;break;case 12:b=49;break;case 13:b=50;break;case 22:b=51;break;case 23:b=52;break;case 24:b=53;break;case 33:b=54}return b},a.ToST_PresetPatternVal=function(a){var b=0;switch(a){case 1:b=0;break;case 2:b=1;break;case 3:b=2;break;case 4:b=3;break;case 5:b=4;break;case 6:b=5;break;case 7:b=6;break;case 8:b=7;break;case 9:b=8;break;case 10:b=9;break;case 11:b=10;break;case 12:b=11;break;case 13:b=16;break;case 14:b=17;break;case 15:b=27;break;case 16:b=28;break;case 17:b=34;break;case 18:b=52;break;case 19:b=14;break;case 20:b=15;break;case 21:b=25;break;case 22:b=26;break;case 23:b=36;break;case 24:b=45;break;case 25:b=29;break;case 26:b=30;break;case 27:b=32;break;case 28:b=31;break;case 29:b=19;break;case 30:b=18;break;case 31:b=21;break;case 32:b=20;break;case 33:b=40;break;case 34:b=37;break;case 35:b=41;break;case 36:b=35;break;case 37:b=39;break;case 38:b=53;break;case 39:b=43;break;case 40:b=42;break;case 41:b=44;break;case 42:b=46;break;case 43:b=47;break;case 44:b=48;break;case 45:b=38;break;case 46:b=49;break;case 47:b=50;break;case 48:b=51;break;case 49:b=12;break;case 50:b=13;break;case 51:b=22;break;case 52:b=23;break;case 53:b=24;break;case 54:b=33}return b},a.presetColors={},a.defineProperty=L,a.simpleJSONObject=O,a.umb=Q,a}(),b.ChartUtility=E,E.InitPresetColors(),F=function(){function a(){}return a.InitGradientStopPresetColor=function(a,b){},a.InitGradientStopTwoColor=function(a,b){},a.InitGradientTwoColorCornerStops=function(a,b){},a.InitGradientTwoColorCenterStops=function(a,b){},a.InitGradientOneColorCornerStops=function(a,b){},a.InitGradientOneColorCenterStops=function(a,b){},a.InitGradientStopOneColor=function(a,b){},a.InitGradientStops=function(a,b,c){},a.GetGradientAngle=function(a,b){var c=0;switch(a){case f.GradientStyle.GradientHorizontal:1===b?c=90:2===b||4===b?c=270:3===b&&(c=90);break;case f.GradientStyle.GradientVertical:1===b||3===b?c=0:2!==b&&4!==b||(c=180);break;case f.GradientStyle.GradientDiagonalUp:1===b||3===b?c=45:2!==b&&4!==b||(c=225);break;case f.GradientStyle.GradientDiagonalDown:1===b||3===b?c=135:2!==b&&4!==b||(c=315);break;case f.GradientStyle.GradientFromCorner:case f.GradientStyle.GradientFromCenter:c=135}return c},a.GetTintAndShadeByDegree=function(a){return 2*(a-.5)},a.ToLum=function(a){return 1e5-o(2e5*(1-a))},a.FromLum=function(a){return 1-(1e5-a)/2e5},a}(),b.ShapeUtility=F;function R(a){return 8===a||!E.Is3DChart(a)&&(E.IsBarChart(a)||E.IsColumnChart(a)||E.IsLineChart(a))}function S(a){var b,c,d,e=a.ChartType;if(0!==e)return R(e);for(b=a.SeriesCollection.AllSers,c=0,d=b.length;c<d;c++)if(R(b[c].ChartType))return!0;return!1}G=function(){function a(){}return a.CalculateValidMinimum=function(a,b,c,d,e,f){return c?a===w.DOUBLE_MAX_VALUE||a<=0?b===w.DOUBLE_MIN_VALUE||b<=0?a=1:b<1?a=b/d:1===b?a=1/d:1<b&&(a=1):b<=a?b===w.DOUBLE_MIN_VALUE||b<=0||(b<1&&e&&!f?a=b/d:1===b&&e&&!f?a=1/d:1<b&&(e||!f)&&(a=1)):e&&(a=1):a===w.DOUBLE_MAX_VALUE?b===w.DOUBLE_MIN_VALUE?a=0:b<0?a=2*b:0===b?a=-1:0<b&&(a=0):b<=a&&(b===w.DOUBLE_MIN_VALUE||(b<0&&e&&!f?b!==a&&(a=2*b):0===b&&e&&!f?a=-1:0<b&&(e||!f)&&(a=0))),a},a.CalculateValidMaximum=function(a,b,c,d){return c?b<=a&&(a<1?b=1:1===a?b=d:1<a&&(b=a*d)):b<=a&&(a<0?b=0:0===a?b=1:0<a&&b!==a&&(b=2*a)),b},a.calcMinMax=function(a,b,c,d){var e,f,g=b-a,h=.05*g,i=d.ChartType;return c?(e=a,f=b,b<1&&(e=f=1)):a>=0?(f=b,S(d)&&(f+=h),6*g>b?e=0:(e=a-g/2,(E.IsScatterChart(i)||E.IsBubbleChart(i))&&(e=a))):b<=0?(e=a,S(d)&&(e-=h),6*g+a>0?f=0:(f=b+g/2,(E.IsScatterChart(i)||E.IsBubbleChart(i))&&(f=b))):(e=a-h,f=b+h),{Min:e,Max:f}},a.CalculateMinimum2=function(a,b,c,d,e){return a=d?q(e,o(w.log(a,e))):o(a/c)*c},a.Gpa={},a.CalculateMaximum2=function(a,b,c,d,e){return b=d?q(e,r(w.log(b,e))):r(b/c)*c},a.CalculateMajorUnit=function(a,b,c,d,e,f){var g,h=s(b-a);return e?g=f:(g=q(10,o(w.log(h,10))),h/g<=1.6?g/=5:h/g<=4?g/=2:h/g>8&&(g*=2),c||(g=m(g,d))),g},a.CalculateMinorUnit=function(a,b,c,d){var e;return e=d?c:c/5},a.GenerateAxisId=function(){for(var a=0;;)if(a=o(9e7*Math.random())+1e7,!this.Gpa[a]){this.Gpa[a]=!0;break}return a},a}(),b.AxisUtility=G,H=function(){function a(){}return Object.defineProperty(a.prototype,"ChartFormat",{get:function(){return x.isNullOrUndefined(this.Kb)&&(this.Kb=this.GetDefaultFormat()),this.Kb},enumerable:!0,configurable:!0}),a.prototype.CreateFormat=function(){return k},a.prototype.GetDefaultFormat=function(){return this.CreateFormat()},a.prototype.GetFormatInternal=function(){return this.Kb},a.prototype.FromShapeProperties=function(a){var b=this;x.isNullOrUndefined(a)?b.ClearFormat():(x.isNullOrUndefined(b.Kb)&&(b.Kb=b.CreateFormat()),b.Kb.FromOOModel(a))},a.prototype.FromSJSShapeProperties=function(a){var b=this;x.isNullOrUndefined(a)?b.ClearFormat():(x.isNullOrUndefined(b.Kb)&&(b.Kb=b.CreateFormat()),b.Kb.FromSJSOOModel(a))},a.prototype.ToShapeProperties=function(){return x.isNullOrUndefined(this.Kb)?k:this.Kb.ToOOModel()},a.prototype.ToSJSShapeProperties=function(){return x.isNullOrUndefined(this.Kb)?k:this.Kb.ToSJSOOModel()},a.prototype.Delete=function(){x.isNullOrUndefined(this.Kb)||(this.Kb.ParentStateful=k)},a.prototype.ClearFormat=function(){var a=this;x.isNullOrUndefined(a.Kb)||(a.Kb.SetParentForChildren(k),a.Kb.ParentStateful=k,a.Kb=k)},a}(),b.ChartElementBase=H,function(a){a[a.BevelNone=0]="BevelNone",a[a.BevelRelaxedInset=1]="BevelRelaxedInset",a[a.BevelCircle=2]="BevelCircle",a[a.BevelSlope=3]="BevelSlope",a[a.BevelCross=4]="BevelCross",a[a.BevelAngle=5]="BevelAngle",a[a.BevelSoftRound=6]="BevelSoftRound",a[a.BevelConvex=7]="BevelConvex",a[a.BevelCoolSlant=8]="BevelCoolSlant",a[a.BevelDivot=9]="BevelDivot",a[a.BevelRiblet=10]="BevelRiblet",a[a.BevelHardEdge=11]="BevelHardEdge",a[a.BevelArtDeco=12]="BevelArtDeco"}(I=b.BevelType||(b.BevelType={})),function(a){a[a.UnKnown=0]="UnKnown",a[a.Area3DGroup=1]="Area3DGroup",a[a.Bar3DGroup=2]="Bar3DGroup",a[a.Column3DGroup=3]="Column3DGroup",a[a.Line3DGroup=4]="Line3DGroup",a[a.Pie3DGroup=5]="Pie3DGroup",a[a.SurfaceGroup=6]="SurfaceGroup",a[a.AreaGroup=7]="AreaGroup",a[a.BarGroup=8]="BarGroup",a[a.ColumnGroup=9]="ColumnGroup",a[a.DoughnutGroup=10]="DoughnutGroup",a[a.LineGroup=11]="LineGroup",a[a.PieGroup=12]="PieGroup",a[a.RadarGroup=13]="RadarGroup",a[a.XYGroup=14]="XYGroup"}(J=b.ChartGroupType||(b.ChartGroupType={}));function T(a){return parseFloat(a||"0")/1e5}b.leK=T;function U(a){var b=null;switch(a){case f.ST_SystemColorVal.scrollBar:b=23;break;
case f.ST_SystemColorVal.activeCaption:b=2;break;case f.ST_SystemColorVal.inactiveCaption:b=17;break;case f.ST_SystemColorVal.menu:b=21;break;case f.ST_SystemColorVal.window:b=24;break;case f.ST_SystemColorVal.windowFrame:b=25;break;case f.ST_SystemColorVal.menuText:b=22;break;case f.ST_SystemColorVal.windowText:b=26;break;case f.ST_SystemColorVal.activeBorder:b=1;break;case f.ST_SystemColorVal.inactiveBorder:b=16;break;case f.ST_SystemColorVal.appWorkspace:b=4;break;case f.ST_SystemColorVal.highlight:b=13;break;case f.ST_SystemColorVal.highlightText:b=14;break;case f.ST_SystemColorVal.btnFace:b=168;break;case f.ST_SystemColorVal.btnShadow:b=170;break;case f.ST_SystemColorVal.grayText:b=12;break;case f.ST_SystemColorVal.inactiveCaptionText:b=18;break;case f.ST_SystemColorVal.btnHighlight:b=169;break;case f.ST_SystemColorVal.infoText:b=20;break;case f.ST_SystemColorVal.infoBk:b=19;break;case f.ST_SystemColorVal.gradientActiveCaption:b=171;break;case f.ST_SystemColorVal.gradientInactiveCaption:b=172;break;case f.ST_SystemColorVal.menuHighlight:b=174;break;case f.ST_SystemColorVal.menuBar:b=173}return b}b.toKnownColor=U;function V(a){return a&&(a instanceof Array||(a=[a])),a}b.meK=V;function W(a){var b=4;switch(a){case f.ST_SchemeColorVal.bg1:b=0;break;case f.ST_SchemeColorVal.tx1:b=1;break;case f.ST_SchemeColorVal.bg2:b=2;break;case f.ST_SchemeColorVal.tx2:b=3;break;case f.ST_SchemeColorVal.accent1:b=4;break;case f.ST_SchemeColorVal.accent2:b=5;break;case f.ST_SchemeColorVal.accent3:b=6;break;case f.ST_SchemeColorVal.accent4:b=7;break;case f.ST_SchemeColorVal.accent5:b=8;break;case f.ST_SchemeColorVal.accent6:b=9;break;case f.ST_SchemeColorVal.hlink:b=10;break;case f.ST_SchemeColorVal.folHlink:b=11;break;case f.ST_SchemeColorVal.phClr:b=12;break;case f.ST_SchemeColorVal.dk1:b=13;break;case f.ST_SchemeColorVal.lt1:b=14;break;case f.ST_SchemeColorVal.dk2:b=15;break;case f.ST_SchemeColorVal.lt2:b=16}return b}b.toColorSchemeIndex=W;function X(a){return a?"1":"0"}b.FgK=X},"./dist/plugins/floatingObject/drawing/drawingInterface.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib,Jb,Kb,Lb,Mb,Nb,Ob,Pb,Qb,Rb,Sb;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.noStrike=0]="noStrike",a[a.sngStrike=1]="sngStrike",a[a.dblStrike=2]="dblStrike"}(d=b.ST_TextStrikeType||(b.ST_TextStrikeType={})),function(a){a[a.none=0]="none",a[a.small=1]="small",a[a.all=2]="all"}(e=b.ST_TextCapsType||(b.ST_TextCapsType={})),f=function(){function a(){}return a.HiddenScene3dUri="{31F19639-BCED-4A60-ADC4-E9642A236FB7}",a.HiddenSp3dUri="{E45631CC-5BF2-4C18-A39C-3461C7D3F71A}",a.HiddenFillUri="{909E8E84-426E-40DD-AFC4-6F175D3DCCD1}",a.HiddenLineUri="{91240B29-F687-4F45-9708-019B960494DF}",a}(),b.OOXMLFileHelper=f,function(a){a[a.png=0]="png",a[a.jpg=1]="jpg",a[a.jpeg=2]="jpeg",a[a.emf=3]="emf"}(g=b.ST_BobType||(b.ST_BobType={})),function(a){a[a.none=0]="none",a[a.words=1]="words",a[a.sng=2]="sng",a[a.dbl=3]="dbl",a[a.heavy=4]="heavy",a[a.dotted=5]="dotted",a[a.dottedHeavy=6]="dottedHeavy",a[a.dash=7]="dash",a[a.dashHeavy=8]="dashHeavy",a[a.dashLong=9]="dashLong",a[a.dashLongHeavy=10]="dashLongHeavy",a[a.dotDash=11]="dotDash",a[a.dotDashHeavy=12]="dotDashHeavy",a[a.dotDotDash=13]="dotDotDash",a[a.dotDotDashHeavy=14]="dotDotDashHeavy",a[a.wavy=15]="wavy",a[a.wavyHeavy=16]="wavyHeavy",a[a.wavyDb=17]="wavyDb"}(h=b.ST_TextUnderlineType||(b.ST_TextUnderlineType={})),function(a){a[a.pct5=0]="pct5",a[a.pct10=1]="pct10",a[a.pct20=2]="pct20",a[a.pct25=3]="pct25",a[a.pct30=4]="pct30",a[a.pct40=5]="pct40",a[a.pct50=6]="pct50",a[a.pct60=7]="pct60",a[a.pct70=8]="pct70",a[a.pct75=9]="pct75",a[a.pct80=10]="pct80",a[a.pct90=11]="pct90",a[a.horz=12]="horz",a[a.vert=13]="vert",a[a.ltHorz=14]="ltHorz",a[a.ltVert=15]="ltVert",a[a.dkHorz=16]="dkHorz",a[a.dkVert=17]="dkVert",a[a.narHorz=18]="narHorz",a[a.narVert=19]="narVert",a[a.dashHorz=20]="dashHorz",a[a.dashVert=21]="dashVert",a[a.cross=22]="cross",a[a.dnDiag=23]="dnDiag",a[a.upDiag=24]="upDiag",a[a.ltDnDiag=25]="ltDnDiag",a[a.ltUpDiag=26]="ltUpDiag",a[a.dkDnDiag=27]="dkDnDiag",a[a.dkUpDiag=28]="dkUpDiag",a[a.wdDnDiag=29]="wdDnDiag",a[a.wdUpDiag=30]="wdUpDiag",a[a.dashDnDiag=31]="dashDnDiag",a[a.dashUpDiag=32]="dashUpDiag",a[a.diagCross=33]="diagCross",a[a.smCheck=34]="smCheck",a[a.lgCheck=35]="lgCheck",a[a.smGrid=36]="smGrid",a[a.lgGrid=37]="lgGrid",a[a.dotGrid=38]="dotGrid",a[a.smConfetti=39]="smConfetti",a[a.lgConfetti=40]="lgConfetti",a[a.horzBrick=41]="horzBrick",a[a.diagBrick=42]="diagBrick",a[a.solidDmnd=43]="solidDmnd",a[a.openDmnd=44]="openDmnd",a[a.dotDmnd=45]="dotDmnd",a[a.plaid=46]="plaid",a[a.sphere=47]="sphere",a[a.weave=48]="weave",a[a.divot=49]="divot",a[a.shingle=50]="shingle",a[a.wave=51]="wave",a[a.trellis=52]="trellis",a[a.zigZag=53]="zigZag"}(i=b.ST_PresetPatternVal||(b.ST_PresetPatternVal={})),function(a){a[a.rnd=0]="rnd",a[a.sq=1]="sq",a[a.flat=2]="flat"}(j=b.ST_LineCap||(b.ST_LineCap={})),function(a){a[a.email=0]="email",a[a.screen=1]="screen",a[a.print=2]="print",a[a.hqprint=3]="hqprint",a[a.none=4]="none"}(k=b.ST_BlipCompression||(b.ST_BlipCompression={})),function(a){a[a.shape=0]="shape",a[a.circle=1]="circle",a[a.rect=2]="rect"}(l=b.ST_PathShadeType||(b.ST_PathShadeType={})),function(a){a[a.legacyMatte=0]="legacyMatte",a[a.legacyPlastic=1]="legacyPlastic",a[a.legacyMetal=2]="legacyMetal",a[a.legacyWireframe=3]="legacyWireframe",a[a.matte=4]="matte",a[a.plastic=5]="plastic",a[a.metal=6]="metal",a[a.warmMatte=7]="warmMatte",a[a.translucentPowder=8]="translucentPowder",a[a.powder=9]="powder",a[a.dkEdge=10]="dkEdge",a[a.softEdge=11]="softEdge",a[a.clear=12]="clear",a[a.flat=13]="flat",a[a.softmetal=14]="softmetal"}(m=b.ST_PresetMaterialType||(b.ST_PresetMaterialType={})),function(a){a[a.relaxedInset=0]="relaxedInset",a[a.circle=1]="circle",a[a.slope=2]="slope",a[a.cross=3]="cross",a[a.angle=4]="angle",a[a.softRound=5]="softRound",a[a.convex=6]="convex",a[a.coolSlant=7]="coolSlant",a[a.divot=8]="divot",a[a.riblet=9]="riblet",a[a.hardEdge=10]="hardEdge",a[a.artDeco=11]="artDeco"}(n=b.ST_BevelPresetType||(b.ST_BevelPresetType={})),function(a){a[a.maxMin=0]="maxMin",a[a.minMax=1]="minMax"}(o=b.ST_Orientation||(b.ST_Orientation={})),function(a){a[a.between=0]="between",a[a.midCat=1]="midCat"}(p=b.ST_CrossBetween||(b.ST_CrossBetween={})),function(a){a[a.TwoCellAnchor=0]="TwoCellAnchor",a[a.OneCellAnchor=1]="OneCellAnchor",a[a.AbsoluteAnchor=2]="AbsoluteAnchor",a[a.RelSizeAnchor=3]="RelSizeAnchor",a[a.AbsSizeAnchor=4]="AbsSizeAnchor"}(q=b.AnchorType||(b.AnchorType={})),function(a){a[a.SolidColorFillProperties=0]="SolidColorFillProperties",a[a.PatternFillProperties=1]="PatternFillProperties",a[a.GradientFillProperties=2]="GradientFillProperties",a[a.BlipFillProperties=3]="BlipFillProperties",a[a.GroupFillProperties=4]="GroupFillProperties",a[a.NoFillProperties=5]="NoFillProperties"}(r=b.ColorFillType||(b.ColorFillType={})),function(a){a[a.CT_StockChart=0]="CT_StockChart",a[a.CT_ScatterChart=1]="CT_ScatterChart",a[a.CT_RadarChart=2]="CT_RadarChart",a[a.CT_BubbleChart=3]="CT_BubbleChart",a[a.CT_AreaChart=4]="CT_AreaChart",a[a.CT_Area3DChart=5]="CT_Area3DChart",a[a.CT_BarChart=6]="CT_BarChart",a[a.CT_Bar3DChart=7]="CT_Bar3DChart",a[a.CT_LineChart=8]="CT_LineChart",a[a.CT_Line3DChart=9]="CT_Line3DChart",a[a.CT_PieChart=10]="CT_PieChart",a[a.CT_Pie3DChart=11]="CT_Pie3DChart",a[a.CT_DoughnutChart=12]="CT_DoughnutChart",a[a.CT_OfPieChart=13]="CT_OfPieChart",a[a.CT_SurfaceChart=14]="CT_SurfaceChart",a[a.CT_Surface3DChart=15]="CT_Surface3DChart",a[a.CT_BoxWhisker=16]="CT_BoxWhisker",a[a.CT_Funnel=17]="CT_Funnel",a[a.CT_ParetoLine=18]="CT_ParetoLine",a[a.CT_RegionMap=19]="CT_RegionMap",a[a.CT_Sunburst=20]="CT_Sunburst",a[a.CT_Treemap=21]="CT_Treemap",a[a.CT_Waterfall=22]="CT_Waterfall",a[a.CT_ClusteredColumn=23]="CT_ClusteredColumn"}(s=b.CT_ChartType||(b.CT_ChartType={})),function(a){a[a.boxWhisker=0]="boxWhisker",a[a.funnel=1]="funnel",a[a.paretoLine=2]="paretoLine",a[a.regionMap=3]="regionMap",a[a.sunburst=4]="sunburst",a[a.treemap=5]="treemap",a[a.waterfall=6]="waterfall",a[a.clusteredColumn=7]="clusteredColumn"}(t=b.ST_SeriesLayout||(b.ST_SeriesLayout={})),function(a){a[a.CT_CatAx=0]="CT_CatAx",a[a.CT_DateAx=1]="CT_DateAx",a[a.CT_SerAx=2]="CT_SerAx",a[a.CT_ValAx=3]="CT_ValAx"}(u=b.CT_AxisType||(b.CT_AxisType={})),function(a){a[a.CT_HiddenScene3dExtension=0]="CT_HiddenScene3dExtension",a[a.CT_HiddenFillPropertiesExtension=1]="CT_HiddenFillPropertiesExtension",a[a.CT_HiddenLinePropertiesBaseExtension=2]="CT_HiddenLinePropertiesBaseExtension",a[a.CT_HiddenShape3dExtension=3]="CT_HiddenShape3dExtension",a[a.CT_OfficeArtExtension=4]="CT_OfficeArtExtension"}(v=b.CT_HiddenExtensionType||(b.CT_HiddenExtensionType={})),function(a){a[a.major=0]="major",a[a.minor=1]="minor",a[a.none=2]="none"}(w=b.ST_FontCollectionIndex||(b.ST_FontCollectionIndex={})),function(a){a[a.aliceBlue=0]="aliceBlue",a[a.antiqueWhite=1]="antiqueWhite",a[a.aqua=2]="aqua",a[a.aquamarine=3]="aquamarine",a[a.azure=4]="azure",a[a.beige=5]="beige",a[a.bisque=6]="bisque",a[a.black=7]="black",a[a.blanchedAlmond=8]="blanchedAlmond",a[a.blue=9]="blue",a[a.blueViolet=10]="blueViolet",a[a.brown=11]="brown",a[a.burlyWood=12]="burlyWood",a[a.cadetBlue=13]="cadetBlue",a[a.chartreuse=14]="chartreuse",a[a.chocolate=15]="chocolate",a[a.coral=16]="coral",a[a.cornflowerBlue=17]="cornflowerBlue",a[a.cornsilk=18]="cornsilk",a[a.crimson=19]="crimson",a[a.cyan=20]="cyan",a[a.darkBlue=21]="darkBlue",a[a.darkCyan=22]="darkCyan",a[a.darkGoldenrod=23]="darkGoldenrod",a[a.darkGray=24]="darkGray",a[a.darkGreen=25]="darkGreen",a[a.darkGrey=26]="darkGrey",a[a.darkKhaki=27]="darkKhaki",a[a.darkMagenta=28]="darkMagenta",a[a.darkOliveGreen=29]="darkOliveGreen",a[a.darkOrange=30]="darkOrange",a[a.darkOrchid=31]="darkOrchid",a[a.darkRed=32]="darkRed",a[a.darkSalmon=33]="darkSalmon",a[a.darkSeaGreen=34]="darkSeaGreen",a[a.darkSlateBlue=35]="darkSlateBlue",a[a.darkSlateGray=36]="darkSlateGray",a[a.darkSlateGrey=37]="darkSlateGrey",a[a.darkTurquoise=38]="darkTurquoise",a[a.darkViolet=39]="darkViolet",a[a.deepPink=40]="deepPink",a[a.deepSkyBlue=41]="deepSkyBlue",a[a.dimGray=42]="dimGray",a[a.dimGrey=43]="dimGrey",a[a.dkBlue=44]="dkBlue",a[a.dkCyan=45]="dkCyan",a[a.dkGoldenrod=46]="dkGoldenrod",a[a.dkGray=47]="dkGray",a[a.dkGreen=48]="dkGreen",a[a.dkGrey=49]="dkGrey",a[a.dkKhaki=50]="dkKhaki",a[a.dkMagenta=51]="dkMagenta",a[a.dkOliveGreen=52]="dkOliveGreen",a[a.dkOrange=53]="dkOrange",a[a.dkOrchid=54]="dkOrchid",a[a.dkRed=55]="dkRed",a[a.dkSalmon=56]="dkSalmon",a[a.dkSeaGreen=57]="dkSeaGreen",a[a.dkSlateBlue=58]="dkSlateBlue",a[a.dkSlateGray=59]="dkSlateGray",a[a.dkSlateGrey=60]="dkSlateGrey",a[a.dkTurquoise=61]="dkTurquoise",a[a.dkViolet=62]="dkViolet",a[a.dodgerBlue=63]="dodgerBlue",a[a.firebrick=64]="firebrick",a[a.floralWhite=65]="floralWhite",a[a.forestGreen=66]="forestGreen",a[a.fuchsia=67]="fuchsia",a[a.gainsboro=68]="gainsboro",a[a.ghostWhite=69]="ghostWhite",a[a.gold=70]="gold",a[a.goldenrod=71]="goldenrod",a[a.gray=72]="gray",a[a.green=73]="green",a[a.greenYellow=74]="greenYellow",a[a.grey=75]="grey",a[a.honeydew=76]="honeydew",a[a.hotPink=77]="hotPink",a[a.indianRed=78]="indianRed",a[a.indigo=79]="indigo",a[a.ivory=80]="ivory",a[a.khaki=81]="khaki",a[a.lavender=82]="lavender",a[a.lavenderBlush=83]="lavenderBlush",a[a.lawnGreen=84]="lawnGreen",a[a.lemonChiffon=85]="lemonChiffon",a[a.lightBlue=86]="lightBlue",a[a.lightCoral=87]="lightCoral",a[a.lightCyan=88]="lightCyan",a[a.lightGoldenrodYellow=89]="lightGoldenrodYellow",a[a.lightGray=90]="lightGray",a[a.lightGreen=91]="lightGreen",a[a.lightGrey=92]="lightGrey",a[a.lightPink=93]="lightPink",a[a.lightSalmon=94]="lightSalmon",a[a.lightSeaGreen=95]="lightSeaGreen",a[a.lightSkyBlue=96]="lightSkyBlue",a[a.lightSlateGray=97]="lightSlateGray",a[a.lightSlateGrey=98]="lightSlateGrey",a[a.lightSteelBlue=99]="lightSteelBlue",a[a.lightYellow=100]="lightYellow",a[a.lime=101]="lime",a[a.limeGreen=102]="limeGreen",a[a.linen=103]="linen",a[a.ltBlue=104]="ltBlue",a[a.ltCoral=105]="ltCoral",a[a.ltCyan=106]="ltCyan",a[a.ltGoldenrodYellow=107]="ltGoldenrodYellow",a[a.ltGray=108]="ltGray",a[a.ltGreen=109]="ltGreen",a[a.ltGrey=110]="ltGrey",a[a.ltPink=111]="ltPink",a[a.ltSalmon=112]="ltSalmon",a[a.ltSeaGreen=113]="ltSeaGreen",a[a.ltSkyBlue=114]="ltSkyBlue",a[a.ltSlateGray=115]="ltSlateGray",a[a.ltSlateGrey=116]="ltSlateGrey",a[a.ltSteelBlue=117]="ltSteelBlue",a[a.ltYellow=118]="ltYellow",a[a.magenta=119]="magenta",a[a.maroon=120]="maroon",a[a.medAquamarine=121]="medAquamarine",a[a.medBlue=122]="medBlue",a[a.mediumAquamarine=123]="mediumAquamarine",a[a.mediumBlue=124]="mediumBlue",a[a.mediumOrchid=125]="mediumOrchid",a[a.mediumPurple=126]="mediumPurple",a[a.mediumSeaGreen=127]="mediumSeaGreen",a[a.mediumSlateBlue=128]="mediumSlateBlue",a[a.mediumSpringGreen=129]="mediumSpringGreen",a[a.mediumTurquoise=130]="mediumTurquoise",a[a.mediumVioletRed=131]="mediumVioletRed",a[a.medOrchid=132]="medOrchid",a[a.medPurple=133]="medPurple",a[a.medSeaGreen=134]="medSeaGreen",a[a.medSlateBlue=135]="medSlateBlue",a[a.medSpringGreen=136]="medSpringGreen",a[a.medTurquoise=137]="medTurquoise",a[a.medVioletRed=138]="medVioletRed",a[a.midnightBlue=139]="midnightBlue",a[a.mintCream=140]="mintCream",a[a.mistyRose=141]="mistyRose",a[a.moccasin=142]="moccasin",a[a.navajoWhite=143]="navajoWhite",a[a.navy=144]="navy",a[a.oldLace=145]="oldLace",a[a.olive=146]="olive",a[a.oliveDrab=147]="oliveDrab",a[a.orange=148]="orange",a[a.orangeRed=149]="orangeRed",a[a.orchid=150]="orchid",a[a.paleGoldenrod=151]="paleGoldenrod",a[a.paleGreen=152]="paleGreen",a[a.paleTurquoise=153]="paleTurquoise",a[a.paleVioletRed=154]="paleVioletRed",a[a.papayaWhip=155]="papayaWhip",a[a.peachPuff=156]="peachPuff",a[a.peru=157]="peru",a[a.pink=158]="pink",a[a.plum=159]="plum",a[a.powderBlue=160]="powderBlue",a[a.purple=161]="purple",a[a.red=162]="red",a[a.rosyBrown=163]="rosyBrown",a[a.royalBlue=164]="royalBlue",a[a.saddleBrown=165]="saddleBrown",a[a.salmon=166]="salmon",a[a.sandyBrown=167]="sandyBrown",a[a.seaGreen=168]="seaGreen",a[a.seaShell=169]="seaShell",a[a.sienna=170]="sienna",a[a.silver=171]="silver",a[a.skyBlue=172]="skyBlue",a[a.slateBlue=173]="slateBlue",a[a.slateGray=174]="slateGray",a[a.slateGrey=175]="slateGrey",a[a.snow=176]="snow",a[a.springGreen=177]="springGreen",a[a.steelBlue=178]="steelBlue",a[a.tan=179]="tan",a[a.teal=180]="teal",a[a.thistle=181]="thistle",a[a.tomato=182]="tomato",a[a.turquoise=183]="turquoise",a[a.violet=184]="violet",a[a.wheat=185]="wheat",a[a.white=186]="white",a[a.whiteSmoke=187]="whiteSmoke",a[a.yellow=188]="yellow",a[a.yellowGreen=189]="yellowGreen"}(x=b.ST_PresetColorVal||(b.ST_PresetColorVal={})),function(a){a[a.percentStacked=0]="percentStacked",a[a.standard=1]="standard",a[a.stacked=2]="stacked"}(y=b.ST_Grouping||(b.ST_Grouping={})),function(a){a[a.none=0]="none",a[a.line=1]="line",a[a.lineMarker=2]="lineMarker",a[a.marker=3]="marker",a[a.smooth=4]="smooth",a[a.smoothMarker=5]="smoothMarker"}(z=b.ST_ScatterStyle||(b.ST_ScatterStyle={})),function(a){a[a.standard=0]="standard",a[a.marker=1]="marker",a[a.filled=2]="filled"}(A=b.ST_RadarStyle||(b.ST_RadarStyle={})),function(a){a[a.percentStacked=0]="percentStacked",a[a.clustered=1]="clustered",a[a.standard=2]="standard",a[a.stacked=3]="stacked"}(B=b.ST_BarGrouping||(b.ST_BarGrouping={})),function(a){a[a.bar=0]="bar",a[a.col=1]="col"}(C=b.ST_BarDir||(b.ST_BarDir={})),function(a){a[a.pie=0]="pie",a[a.bar=1]="bar"}(D=b.ST_OfPieType||(b.ST_OfPieType={})),function(a){a[a.b=0]="b",a[a.l=1]="l",a[a.r=2]="r",a[a.t=3]="t"}(E=b.ST_AxPos||(b.ST_AxPos={})),function(a){a[a.OuterShadowEffect=0]="OuterShadowEffect",a[a.InnerShadowEffect=1]="InnerShadowEffect",a[a.PresetShadowEffect=2]="PresetShadowEffect"}(F=b.ShadowEffectType||(b.ShadowEffectType={})),function(a){a[a.BarSer=0]="BarSer",a[a.AreaSer=1]="AreaSer",a[a.LineSer=2]="LineSer",a[a.PieSer=3]="PieSer",a[a.RadarSer=4]="RadarSer",a[a.ScatterSer=5]="ScatterSer",a[a.BubbleSer=6]="BubbleSer",a[a.SurfaceSer=7]="SurfaceSer",a[a.boxWhisker=16]="boxWhisker",a[a.funnel=17]="funnel",a[a.paretoLine=18]="paretoLine",a[a.regionMap=19]="regionMap",a[a.sunburst=20]="sunburst",a[a.treemap=21]="treemap",a[a.waterfall=22]="waterfall",a[a.clusteredColumn=23]="clusteredColumn"}(G=b.SeriesType||(b.SeriesType={})),function(a){a[a.InvertSolidFillFmt=0]="InvertSolidFillFmt",a[a.SeriesDataLabelsRange=1]="SeriesDataLabelsRange",a[a.ChartDispNaAsBlank=2]="ChartDispNaAsBlank"}(H=b.ExtDataType||(b.ExtDataType={})),function(a){a[a.RegularTextRun=0]="RegularTextRun",a[a.TextLineBreak=1]="TextLineBreak",a[a.TextField=2]="TextField"}(I=b.TextParagraphElementType||(b.TextParagraphElementType={})),function(a){a[a.None=0]="None",a[a.Font=1]="Font",a[a.Fill=2]="Fill",a[a.Border=4]="Border",a[a.Alignment=8]="Alignment",a[a.Protection=16]="Protection",a[a.FormatCode=32]="FormatCode",a[a.All=63]="All"}(J=b.StyleDataFlag||(b.StyleDataFlag={})),function(a){a[a.none=0]="none",a[a.x=1]="x",a[a.y=2]="y",a[a.xy=3]="xy"}(K=b.ST_TileFlipMode||(b.ST_TileFlipMode={})),function(a){a[a.over=0]="over",a[a.mult=1]="mult",a[a.screen=2]="screen",a[a.darken=3]="darken",a[a.lighten=4]="lighten"}(L=b.ST_BlendMode||(b.ST_BlendMode={})),function(a){a[a.legacyFlat1=0]="legacyFlat1",a[a.legacyFlat2=1]="legacyFlat2",a[a.legacyFlat3=2]="legacyFlat3",a[a.legacyFlat4=3]="legacyFlat4",a[a.legacyNormal1=4]="legacyNormal1",a[a.legacyNormal2=5]="legacyNormal2",a[a.legacyNormal3=6]="legacyNormal3",a[a.legacyNormal4=7]="legacyNormal4",a[a.legacyHarsh1=8]="legacyHarsh1",a[a.legacyHarsh2=9]="legacyHarsh2",a[a.legacyHarsh3=10]="legacyHarsh3",a[a.legacyHarsh4=11]="legacyHarsh4",a[a.threePt=12]="threePt",a[a.balanced=13]="balanced",a[a.soft=14]="soft",a[a.harsh=15]="harsh",a[a.flood=16]="flood",a[a.contrasting=17]="contrasting",a[a.morning=18]="morning",a[a.sunrise=19]="sunrise",a[a.sunset=20]="sunset",a[a.chilly=21]="chilly",a[a.freezing=22]="freezing",a[a.flat=23]="flat",a[a.twoPt=24]="twoPt",a[a.glow=25]="glow",a[a.brightRoom=26]="brightRoom"}(M=b.ST_LightRigType||(b.ST_LightRigType={})),function(a){a[a.sib=0]="sib",a[a.tree=1]="tree"}(N=b.ST_EffectContainerType||(b.ST_EffectContainerType={})),function(a){a[a.shdw1=0]="shdw1",a[a.shdw2=1]="shdw2",a[a.shdw3=2]="shdw3",a[a.shdw4=3]="shdw4",a[a.shdw5=4]="shdw5",a[a.shdw6=5]="shdw6",a[a.shdw7=6]="shdw7",a[a.shdw8=7]="shdw8",a[a.shdw9=8]="shdw9",a[a.shdw10=9]="shdw10",a[a.shdw11=10]="shdw11",a[a.shdw12=11]="shdw12",a[a.shdw13=12]="shdw13",a[a.shdw14=13]="shdw14",a[a.shdw15=14]="shdw15",a[a.shdw16=15]="shdw16",a[a.shdw17=16]="shdw17",a[a.shdw18=17]="shdw18",a[a.shdw19=18]="shdw19",a[a.shdw20=19]="shdw20"}(O=b.ST_PresetShadowVal||(b.ST_PresetShadowVal={})),function(a){a[a.auto=0]="auto",a[a.t=1]="t",a[a.ctr=2]="ctr",a[a.base=3]="base",a[a.b=4]="b"}(P=b.ST_TextFontAlignType||(b.ST_TextFontAlignType={})),function(a){a[a.l=0]="l",a[a.ctr=1]="ctr",a[a.r=2]="r",a[a.just=3]="just",a[a.justLow=4]="justLow",a[a.dist=5]="dist",a[a.thaiDist=6]="thaiDist"}(Q=b.ST_TextAlignType||(b.ST_TextAlignType={})),function(a){a[a.alphaLcParenBoth=0]="alphaLcParenBoth",a[a.alphaUcParenBoth=1]="alphaUcParenBoth",a[a.alphaLcParenR=2]="alphaLcParenR",a[a.alphaUcParenR=3]="alphaUcParenR",a[a.alphaLcPeriod=4]="alphaLcPeriod",a[a.alphaUcPeriod=5]="alphaUcPeriod",a[a.arabicParenBoth=6]="arabicParenBoth",a[a.arabicParenR=7]="arabicParenR",a[a.arabicPeriod=8]="arabicPeriod",a[a.arabicPlain=9]="arabicPlain",a[a.romanLcParenBoth=10]="romanLcParenBoth",a[a.romanUcParenBoth=11]="romanUcParenBoth",a[a.romanLcParenR=12]="romanLcParenR",a[a.romanUcParenR=13]="romanUcParenR",a[a.romanLcPeriod=14]="romanLcPeriod",a[a.romanUcPeriod=15]="romanUcPeriod",a[a.circleNumDbPlain=16]="circleNumDbPlain",a[a.circleNumWdBlackPlain=17]="circleNumWdBlackPlain",a[a.circleNumWdWhitePlain=18]="circleNumWdWhitePlain",a[a.arabicDbPeriod=19]="arabicDbPeriod",a[a.arabicDbPlain=20]="arabicDbPlain",a[a.ea1ChsPeriod=21]="ea1ChsPeriod",a[a.ea1ChsPlain=22]="ea1ChsPlain",a[a.ea1ChtPeriod=23]="ea1ChtPeriod",a[a.ea1ChtPlain=24]="ea1ChtPlain",a[a.ea1JpnChsDbPeriod=25]="ea1JpnChsDbPeriod",a[a.ea1JpnKorPlain=26]="ea1JpnKorPlain",a[a.ea1JpnKorPeriod=27]="ea1JpnKorPeriod",a[a.arabic1Minus=28]="arabic1Minus",a[a.arabic2Minus=29]="arabic2Minus",a[a.hebrew2Minus=30]="hebrew2Minus",a[a.thaiAlphaPeriod=31]="thaiAlphaPeriod",a[a.thaiAlphaParenR=32]="thaiAlphaParenR",a[a.thaiAlphaParenBoth=33]="thaiAlphaParenBoth",a[a.thaiNumPeriod=34]="thaiNumPeriod",a[a.thaiNumParenR=35]="thaiNumParenR",a[a.thaiNumParenBoth=36]="thaiNumParenBoth",a[a.hindiAlphaPeriod=37]="hindiAlphaPeriod",a[a.hindiNumPeriod=38]="hindiNumPeriod",a[a.hindiNumParenR=39]="hindiNumParenR",a[a.hindiAlpha1Period=40]="hindiAlpha1Period"}(R=b.ST_TextAutonumberScheme||(b.ST_TextAutonumberScheme={})),function(a){a[a.overflow=0]="overflow",a[a.ellipsis=1]="ellipsis",a[a.clip=2]="clip"}(S=b.ST_TextVertOverflowType||(b.ST_TextVertOverflowType={})),function(a){a[a.horz=0]="horz",a[a.vert=1]="vert",a[a.vert270=2]="vert270",a[a.wordArtVert=3]="wordArtVert",a[a.eaVert=4]="eaVert",a[a.mongolianVert=5]="mongolianVert",a[a.wordArtVertRtl=6]="wordArtVertRtl"}(T=b.ST_TextVerticalType||(b.ST_TextVerticalType={})),function(a){a[a.none=0]="none",a[a.square=1]="square"}(U=b.ST_TextWrappingType||(b.ST_TextWrappingType={})),function(a){a[a.textNoShape=0]="textNoShape",a[a.textPlain=1]="textPlain",a[a.textStop=2]="textStop",a[a.textTriangle=3]="textTriangle",a[a.textTriangleInverted=4]="textTriangleInverted",a[a.textChevron=5]="textChevron",a[a.textChevronInverted=6]="textChevronInverted",a[a.textRingInside=7]="textRingInside",a[a.textRingOutside=8]="textRingOutside",a[a.textArchUp=9]="textArchUp",a[a.textArchDown=10]="textArchDown",a[a.textCircle=11]="textCircle",a[a.textButton=12]="textButton",a[a.textArchUpPour=13]="textArchUpPour",a[a.textArchDownPour=14]="textArchDownPour",a[a.textCirclePour=15]="textCirclePour",a[a.textButtonPour=16]="textButtonPour",a[a.textCurveUp=17]="textCurveUp",a[a.textCurveDown=18]="textCurveDown",a[a.textCanUp=19]="textCanUp",a[a.textCanDown=20]="textCanDown",a[a.textWave1=21]="textWave1",a[a.textWave2=22]="textWave2",a[a.textDoubleWave1=23]="textDoubleWave1",a[a.textWave4=24]="textWave4",a[a.textInflate=25]="textInflate",a[a.textDeflate=26]="textDeflate",a[a.textInflateBottom=27]="textInflateBottom",a[a.textDeflateBottom=28]="textDeflateBottom",a[a.textInflateTop=29]="textInflateTop",a[a.textDeflateTop=30]="textDeflateTop",a[a.textDeflateInflate=31]="textDeflateInflate",a[a.textDeflateInflateDeflate=32]="textDeflateInflateDeflate",a[a.textFadeRight=33]="textFadeRight",a[a.textFadeLeft=34]="textFadeLeft",a[a.textFadeUp=35]="textFadeUp",a[a.textFadeDown=36]="textFadeDown",a[a.textSlantUp=37]="textSlantUp",a[a.textSlantDown=38]="textSlantDown",a[a.textCascadeUp=39]="textCascadeUp",a[a.textCascadeDown=40]="textCascadeDown"}(V=b.ST_TextShapeType||(b.ST_TextShapeType={})),function(a){a[a.l=0]="l",a[a.ctr=1]="ctr",a[a.r=2]="r",a[a.dec=3]="dec"}(W=b.ST_TextTabAlignType||(b.ST_TextTabAlignType={})),function(a){a[a.tl=0]="tl",a[a.t=1]="t",a[a.tr=2]="tr",a[a.l=3]="l",a[a.r=4]="r",a[a.bl=5]="bl",a[a.b=6]="b",a[a.br=7]="br"}(X=b.ST_LightRigDirection||(b.ST_LightRigDirection={})),function(a){a[a.tl=0]="tl",a[a.t=1]="t",a[a.tr=2]="tr",a[a.l=3]="l",a[a.ctr=4]="ctr",a[a.r=5]="r",a[a.bl=6]="bl",a[a.b=7]="b",a[a.br=8]="br"}(Y=b.ST_RectAlignment||(b.ST_RectAlignment={})),function(a){a[a.scrollBar=0]="scrollBar",a[a.background=1]="background",a[a.activeCaption=2]="activeCaption",a[a.inactiveCaption=3]="inactiveCaption",a[a.menu=4]="menu",a[a.window=5]="window",a[a.windowFrame=6]="windowFrame",a[a.menuText=7]="menuText",a[a.windowText=8]="windowText",a[a.captionText=9]="captionText",a[a.activeBorder=10]="activeBorder",a[a.inactiveBorder=11]="inactiveBorder",a[a.appWorkspace=12]="appWorkspace",a[a.highlight=13]="highlight",a[a.highlightText=14]="highlightText",a[a.btnFace=15]="btnFace",a[a.btnShadow=16]="btnShadow",a[a.grayText=17]="grayText",a[a.btnText=18]="btnText",a[a.inactiveCaptionText=19]="inactiveCaptionText",a[a.btnHighlight=20]="btnHighlight",a[a.Item3dDkShadow=21]="Item3dDkShadow",a[a.Item3dLight=22]="Item3dLight",a[a.infoText=23]="infoText",a[a.infoBk=24]="infoBk",a[a.hotLight=25]="hotLight",a[a.gradientActiveCaption=26]="gradientActiveCaption",a[a.gradientInactiveCaption=27]="gradientInactiveCaption",a[a.menuHighlight=28]="menuHighlight",a[a.menuBar=29]="menuBar"}(Z=b.ST_SystemColorVal||(b.ST_SystemColorVal={})),function(a){a[a.bg1=0]="bg1",a[a.tx1=1]="tx1",a[a.bg2=2]="bg2",a[a.tx2=3]="tx2",a[a.accent1=4]="accent1",a[a.accent2=5]="accent2",a[a.accent3=6]="accent3",a[a.accent4=7]="accent4",a[a.accent5=8]="accent5",a[a.accent6=9]="accent6",a[a.hlink=10]="hlink",a[a.folHlink=11]="folHlink",a[a.phClr=12]="phClr",a[a.dk1=13]="dk1",a[a.lt1=14]="lt1",a[a.dk2=15]="dk2",a[a.lt2=16]="lt2"}($=b.ST_SchemeColorVal||(b.ST_SchemeColorVal={})),function(a){a[a.sng=0]="sng",a[a.dbl=1]="dbl",a[a.thickThin=2]="thickThin",a[a.thinThick=3]="thinThick",a[a.tri=4]="tri"}(_=b.ST_CompoundLine||(b.ST_CompoundLine={})),function(a){a[a.ctr=0]="ctr",a[a.in=1]="in"}(aa=b.ST_PenAlignment||(b.ST_PenAlignment={})),function(a){a[a.dataOnly=0]="dataOnly",a[a.postalCode=1]="postalCode",a[a.county=2]="county",a[a.state=3]="state",a[a.countryRegion=4]="countryRegion",a[a.countryRegionList=5]="countryRegionList",a[a.world=6]="world"}(ba=b.ST_GeoMappingLevel||(b.ST_GeoMappingLevel={})),function(a){a[a.mercator=0]="mercator",a[a.miller=1]="miller",a[a.robinson=2]="robinson",a[a.albers=3]="albers"}(ca=b.ST_GeoProjectionType||(b.ST_GeoProjectionType={})),function(a){a[a.None=-4142]="None",a[a.LT1=0]="LT1",a[a.DK1=1]="DK1",a[a.LT2=2]="LT2",a[a.DK2=3]="DK2",a[a.Accent1=4]="Accent1",a[a.Accent2=5]="Accent2",a[a.Accent3=6]="Accent3",a[a.Accent4=7]="Accent4",a[a.Accent5=8]="Accent5",a[a.Accent6=9]="Accent6",a[a.Hlink=10]="Hlink",a[a.FolHlink=11]="FolHlink"}(da=b.ColorSchemeIndex||(b.ColorSchemeIndex={})),function(a){a[a.None=0]="None",a[a.Major=1]="Major",a[a.Minor=2]="Minor"}(ea=b.ThemeFont||(b.ThemeFont={})),function(a){a[a.Empty=0]="Empty",a[a.Row=1]="Row",a[a.Column=2]="Column",a[a.RowIsRelative=4]="RowIsRelative",a[a.ColumnIsRelative=8]="ColumnIsRelative",a[a.LastRowIsRelative=16]="LastRowIsRelative",a[a.LastColumnIsRelative=32]="LastColumnIsRelative",a[a.Range=64]="Range",a[a.Error=128]="Error"}(fa=b.ReferenceKind||(b.ReferenceKind={})),function(a){a[a.t=0]="t",a[a.ctr=1]="ctr",a[a.b=2]="b",a[a.just=3]="just",a[a.dist=4]="dist"}(ga=b.ST_TextAnchoringType||(b.ST_TextAnchoringType={})),function(a){a[a.overflow=0]="overflow",a[a.clip=1]="clip"}(ha=b.ST_TextHorzOverflowType||(b.ST_TextHorzOverflowType={})),function(a){a[a.Shape=0]="Shape",a[a.Chart=1]="Chart",a[a.Picture=2]="Picture",a[a.Connector=3]="Connector",a[a.GroupShape=4]="GroupShape"}(ia=b.DrawingType||(b.DrawingType={})),function(a){a[a.TextureTopLeft=0]="TextureTopLeft",a[a.TextureTop=1]="TextureTop",a[a.TextureTopRight=2]="TextureTopRight",a[a.TextureLeft=3]="TextureLeft",a[a.TextureCenter=4]="TextureCenter",a[a.TextureRight=5]="TextureRight",a[a.TextureBottomLeft=6]="TextureBottomLeft",a[a.TextureBottom=7]="TextureBottom",a[a.TextureBottomRight=8]="TextureBottomRight"}(ja=b.TextureAlignment||(b.TextureAlignment={})),function(a){a[a.None=0]="None",a[a.Horizontal=1]="Horizontal",a[a.Vertical=2]="Vertical",a[a.Both=3]="Both"}(ka=b.TextureFlipType||(b.TextureFlipType={})),function(a){a[a.TextureTypeNone=0]="TextureTypeNone",a[a.TexturePreset=1]="TexturePreset",a[a.TextureUserDefined=2]="TextureUserDefined"}(la=b.TextureType||(b.TextureType={})),function(a){a[a.Solid=0]="Solid",a[a.Patterned=1]="Patterned",a[a.Gradient=2]="Gradient",a[a.Textured=3]="Textured",a[a.Background=4]="Background",a[a.Picture=5]="Picture",a[a.Group=6]="Group"}(ma=b.FillType||(b.FillType={})),function(a){a[a.GradientEarlySunset=0]="GradientEarlySunset",a[a.GradientLateSunset=1]="GradientLateSunset",a[a.GradientNightfall=2]="GradientNightfall",a[a.GradientDaybreak=3]="GradientDaybreak",a[a.GradientHorizon=4]="GradientHorizon",a[a.GradientDesert=5]="GradientDesert",a[a.GradientOcean=6]="GradientOcean",a[a.GradientCalmWater=7]="GradientCalmWater",a[a.GradientFire=8]="GradientFire",a[a.GradientFog=9]="GradientFog",a[a.GradientMoss=10]="GradientMoss",a[a.GradientPeacock=11]="GradientPeacock",a[a.GradientWheat=12]="GradientWheat",a[a.GradientParchment=13]="GradientParchment",a[a.GradientMahogany=14]="GradientMahogany",a[a.GradientRainbow=15]="GradientRainbow",a[a.GradientRainbowII=16]="GradientRainbowII",a[a.GradientGold=17]="GradientGold",a[a.GradientGoldII=18]="GradientGoldII",a[a.GradientBrass=19]="GradientBrass",a[a.GradientChrome=20]="GradientChrome",a[a.GradientChromeII=21]="GradientChromeII",a[a.GradientSilver=22]="GradientSilver",a[a.GradientSapphire=23]="GradientSapphire"}(na=b.PresetGradientType||(b.PresetGradientType={})),function(a){a[a.TexturePapyrus=0]="TexturePapyrus",a[a.TextureCanvas=1]="TextureCanvas",a[a.TextureDenim=2]="TextureDenim",a[a.TextureWovenMat=3]="TextureWovenMat",a[a.TextureWaterDroplets=4]="TextureWaterDroplets",a[a.TexturePaperBag=5]="TexturePaperBag",a[a.TextureFishFossil=6]="TextureFishFossil",a[a.TextureSand=7]="TextureSand",a[a.TextureGreenMarble=8]="TextureGreenMarble",a[a.TextureWhiteMarble=9]="TextureWhiteMarble",a[a.TextureBrownMarble=10]="TextureBrownMarble",a[a.TextureGranite=11]="TextureGranite",a[a.TextureNewsprint=12]="TextureNewsprint",a[a.TextureRecycledPaper=13]="TextureRecycledPaper",a[a.TextureParchment=14]="TextureParchment",a[a.TextureStationery=15]="TextureStationery",a[a.TextureBlueTissuePaper=16]="TextureBlueTissuePaper",a[a.TexturePinkTissuePaper=17]="TexturePinkTissuePaper",a[a.TexturePurpleMesh=18]="TexturePurpleMesh",a[a.TextureBouquet=19]="TextureBouquet",a[a.TextureCork=20]="TextureCork",a[a.TextureWalnut=21]="TextureWalnut",a[a.TextureOak=22]="TextureOak",a[a.TextureMediumWood=23]="TextureMediumWood"}(oa=b.PresetTexture||(b.PresetTexture={})),function(a){a[a.GradientColorNone=0]="GradientColorNone",a[a.GradientOneColor=1]="GradientOneColor",a[a.GradientTwoColors=2]="GradientTwoColors",a[a.GradientPresetColors=3]="GradientPresetColors",a[a.GradientMultiColor=4]="GradientMultiColor"}(pa=b.GradientColorType||(b.GradientColorType={})),function(a){a[a.none=0]="none",a[a.dottedPercent5=1]="dottedPercent5",a[a.dottedPercent10=2]="dottedPercent10",a[a.dottedPercent20=3]="dottedPercent20",a[a.dottedPercent25=4]="dottedPercent25",a[a.dottedPercent30=5]="dottedPercent30",a[a.dottedPercent40=6]="dottedPercent40",a[a.dottedPercent50=7]="dottedPercent50",a[a.dottedPercent60=8]="dottedPercent60",a[a.dottedPercent70=9]="dottedPercent70",a[a.dottedPercent75=10]="dottedPercent75",a[a.dottedPercent80=11]="dottedPercent80",a[a.dottedPercent90=12]="dottedPercent90",a[a.darkHorizontal=13]="darkHorizontal",a[a.darkVertical=14]="darkVertical",a[a.darkDownwardDiagonal=15]="darkDownwardDiagonal",a[a.darkUpwardDiagonal=16]="darkUpwardDiagonal",a[a.smallCheckerBoard=17]="smallCheckerBoard",a[a.trellis=18]="trellis",a[a.lightHorizontal=19]="lightHorizontal",a[a.lightVertical=20]="lightVertical",a[a.lightDownwardDiagonal=21]="lightDownwardDiagonal",a[a.lightUpwardDiagonal=22]="lightUpwardDiagonal",a[a.smallGrid=23]="smallGrid",a[a.dottedDiamond=24]="dottedDiamond",a[a.wideDownwardDiagonal=25]="wideDownwardDiagonal",a[a.wideUpwardDiagonal=26]="wideUpwardDiagonal",a[a.dashedUpwardDiagonal=27]="dashedUpwardDiagonal",a[a.dashedDownwardDiagonal=28]="dashedDownwardDiagonal",a[a.narrowVertical=29]="narrowVertical",a[a.narrowHorizontal=30]="narrowHorizontal",a[a.dashedVertical=31]="dashedVertical",a[a.dashedHorizontal=32]="dashedHorizontal",a[a.largeConfetti=33]="largeConfetti",a[a.largeGrid=34]="largeGrid",a[a.horizontalBrick=35]="horizontalBrick",
a[a.largeCheckerBoard=36]="largeCheckerBoard",a[a.smallConfetti=37]="smallConfetti",a[a.zigZag=38]="zigZag",a[a.solidDiamond=39]="solidDiamond",a[a.diagonalBrick=40]="diagonalBrick",a[a.outlinedDiamond=41]="outlinedDiamond",a[a.plaid=42]="plaid",a[a.sphere=43]="sphere",a[a.weave=44]="weave",a[a.dottedGrid=45]="dottedGrid",a[a.divot=46]="divot",a[a.shingle=47]="shingle",a[a.wave=48]="wave"}(qa=b.PatternType||(b.PatternType={})),function(a){a[a.GradientHorizontal=0]="GradientHorizontal",a[a.GradientVertical=1]="GradientVertical",a[a.GradientDiagonalUp=2]="GradientDiagonalUp",a[a.GradientDiagonalDown=3]="GradientDiagonalDown",a[a.GradientFromCorner=4]="GradientFromCorner",a[a.GradientFromTitle=5]="GradientFromTitle",a[a.GradientFromCenter=6]="GradientFromCenter",a[a.GradientTopSpotlight=7]="GradientTopSpotlight",a[a.GradientBottomSpotlight=8]="GradientBottomSpotlight"}(ra=b.GradientStyle||(b.GradientStyle={})),function(a){a[a.short=0]="short",a[a.medium=1]="medium",a[a.long=2]="long"}(sa=b.ArrowheadLength||(b.ArrowheadLength={})),function(a){a[a.none=0]="none",a[a.triangle=1]="triangle",a[a.stealth=2]="stealth",a[a.diamond=3]="diamond",a[a.oval=4]="oval",a[a.open=5]="open"}(ta=b.ArrowheadStyle||(b.ArrowheadStyle={})),function(a){a[a.narrow=0]="narrow",a[a.medium=1]="medium",a[a.wide=2]="wide"}(ua=b.ArrowheadWidth||(b.ArrowheadWidth={})),function(a){a[a.solid=0]="solid",a[a.squareDot=1]="squareDot",a[a.dash=2]="dash",a[a.longDash=3]="longDash",a[a.dashDot=4]="dashDot",a[a.longDashDot=5]="longDashDot",a[a.longDashDotDot=6]="longDashDotDot",a[a.sysDash=7]="sysDash",a[a.sysDot=8]="sysDot",a[a.sysDashDot=9]="sysDashDot",a[a.dashDotDot=10]="dashDotDot",a[a.roundDot=11]="roundDot"}(va=b.LineDashStyle||(b.LineDashStyle={})),function(a){a[a.flat=2]="flat",a[a.square=1]="square",a[a.round=0]="round"}(wa=b.LineCapStyle||(b.LineCapStyle={})),function(a){a[a.round=0]="round",a[a.miter=1]="miter",a[a.bevel=2]="bevel"}(xa=b.LineJoinStyle||(b.LineJoinStyle={})),function(a){a[a.LineSingle=0]="LineSingle",a[a.LineThinThin=1]="LineThinThin",a[a.LineThinThick=2]="LineThinThick",a[a.LineThickThin=3]="LineThickThin",a[a.LineThickBetweenThin=4]="LineThickBetweenThin"}(ya=b.LineStyle||(b.LineStyle={})),function(a){a[a.PictureAutomatic=0]="PictureAutomatic",a[a.PictureGrayscale=1]="PictureGrayscale",a[a.PictureBlackAndWhite=2]="PictureBlackAndWhite",a[a.PictureWatermark=3]="PictureWatermark"}(za=b.PictureColorType||(b.PictureColorType={})),function(a){a[a.Shadow1=0]="Shadow1",a[a.Shadow2=1]="Shadow2",a[a.Shadow3=2]="Shadow3",a[a.Shadow4=3]="Shadow4",a[a.Shadow5=4]="Shadow5",a[a.Shadow6=5]="Shadow6",a[a.Shadow7=6]="Shadow7",a[a.Shadow8=7]="Shadow8",a[a.Shadow9=8]="Shadow9",a[a.Shadow10=9]="Shadow10",a[a.Shadow11=10]="Shadow11",a[a.Shadow12=11]="Shadow12",a[a.Shadow13=12]="Shadow13",a[a.Shadow14=13]="Shadow14",a[a.Shadow15=14]="Shadow15",a[a.Shadow16=15]="Shadow16",a[a.Shadow17=16]="Shadow17",a[a.Shadow18=17]="Shadow18",a[a.Shadow19=18]="Shadow19",a[a.Shadow20=19]="Shadow20",a[a.Shadow21=20]="Shadow21",a[a.Shadow22=21]="Shadow22",a[a.Shadow23=22]="Shadow23",a[a.Shadow24=23]="Shadow24",a[a.Shadow25=24]="Shadow25",a[a.Shadow26=25]="Shadow26",a[a.Shadow27=26]="Shadow27",a[a.Shadow28=27]="Shadow28",a[a.Shadow29=28]="Shadow29",a[a.Shadow30=29]="Shadow30",a[a.Shadow31=30]="Shadow31",a[a.Shadow32=31]="Shadow32",a[a.Shadow33=32]="Shadow33",a[a.Shadow34=33]="Shadow34",a[a.Shadow35=34]="Shadow35",a[a.Shadow36=35]="Shadow36",a[a.Shadow37=36]="Shadow37",a[a.Shadow38=37]="Shadow38",a[a.Shadow39=38]="Shadow39",a[a.Shadow40=39]="Shadow40",a[a.Shadow41=40]="Shadow41",a[a.Shadow42=41]="Shadow42",a[a.Shadow43=42]="Shadow43"}(Aa=b.ShadowType||(b.ShadowType={})),function(a){a[a.ShadowStyleInnerShadow=0]="ShadowStyleInnerShadow",a[a.ShadowStyleOuterShadow=1]="ShadowStyleOuterShadow"}(Ba=b.ShadowStyle||(b.ShadowStyle={})),function(a){a[a.SoftEdgeTypeNone=0]="SoftEdgeTypeNone",a[a.SoftEdgeType1=1]="SoftEdgeType1",a[a.SoftEdgeType2=2]="SoftEdgeType2",a[a.SoftEdgeType3=3]="SoftEdgeType3",a[a.SoftEdgeType4=4]="SoftEdgeType4",a[a.SoftEdgeType5=5]="SoftEdgeType5",a[a.SoftEdgeType6=6]="SoftEdgeType6"}(Ca=b.SoftEdgeType||(b.SoftEdgeType={})),function(a){a[a.CameraLegacyObliqueTopLeft=0]="CameraLegacyObliqueTopLeft",a[a.CameraLegacyObliqueTop=1]="CameraLegacyObliqueTop",a[a.CameraLegacyObliqueTopRight=2]="CameraLegacyObliqueTopRight",a[a.CameraLegacyObliqueLeft=3]="CameraLegacyObliqueLeft",a[a.CameraLegacyObliqueFront=4]="CameraLegacyObliqueFront",a[a.CameraLegacyObliqueRight=5]="CameraLegacyObliqueRight",a[a.CameraLegacyObliqueBottomLeft=6]="CameraLegacyObliqueBottomLeft",a[a.CameraLegacyObliqueBottom=7]="CameraLegacyObliqueBottom",a[a.CameraLegacyObliqueBottomRight=8]="CameraLegacyObliqueBottomRight",a[a.CameraLegacyPerspectiveTopLeft=9]="CameraLegacyPerspectiveTopLeft",a[a.CameraLegacyPerspectiveTop=10]="CameraLegacyPerspectiveTop",a[a.CameraLegacyPerspectiveTopRight=11]="CameraLegacyPerspectiveTopRight",a[a.CameraLegacyPerspectiveLeft=12]="CameraLegacyPerspectiveLeft",a[a.CameraLegacyPerspectiveFront=13]="CameraLegacyPerspectiveFront",a[a.CameraLegacyPerspectiveRight=14]="CameraLegacyPerspectiveRight",a[a.CameraLegacyPerspectiveBottomLeft=15]="CameraLegacyPerspectiveBottomLeft",a[a.CameraLegacyPerspectiveBottom=16]="CameraLegacyPerspectiveBottom",a[a.CameraLegacyPerspectiveBottomRight=17]="CameraLegacyPerspectiveBottomRight",a[a.CameraOrthographicFront=18]="CameraOrthographicFront",a[a.CameraIsometricTopUp=19]="CameraIsometricTopUp",a[a.CameraIsometricTopDown=20]="CameraIsometricTopDown",a[a.CameraIsometricBottomUp=21]="CameraIsometricBottomUp",a[a.CameraIsometricBottomDown=22]="CameraIsometricBottomDown",a[a.CameraIsometricLeftUp=23]="CameraIsometricLeftUp",a[a.CameraIsometricLeftDown=24]="CameraIsometricLeftDown",a[a.CameraIsometricRightUp=25]="CameraIsometricRightUp",a[a.CameraIsometricRightDown=26]="CameraIsometricRightDown",a[a.CameraIsometricOffAxis1Left=27]="CameraIsometricOffAxis1Left",a[a.CameraIsometricOffAxis1Right=28]="CameraIsometricOffAxis1Right",a[a.CameraIsometricOffAxis1Top=29]="CameraIsometricOffAxis1Top",a[a.CameraIsometricOffAxis2Left=30]="CameraIsometricOffAxis2Left",a[a.CameraIsometricOffAxis2Right=31]="CameraIsometricOffAxis2Right",a[a.CameraIsometricOffAxis2Top=32]="CameraIsometricOffAxis2Top",a[a.CameraIsometricOffAxis3Left=33]="CameraIsometricOffAxis3Left",a[a.CameraIsometricOffAxis3Right=34]="CameraIsometricOffAxis3Right",a[a.CameraIsometricOffAxis3Bottom=35]="CameraIsometricOffAxis3Bottom",a[a.CameraIsometricOffAxis4Left=36]="CameraIsometricOffAxis4Left",a[a.CameraIsometricOffAxis4Right=37]="CameraIsometricOffAxis4Right",a[a.CameraIsometricOffAxis4Bottom=38]="CameraIsometricOffAxis4Bottom",a[a.CameraObliqueTopLeft=39]="CameraObliqueTopLeft",a[a.CameraObliqueTop=40]="CameraObliqueTop",a[a.CameraObliqueTopRight=41]="CameraObliqueTopRight",a[a.CameraObliqueLeft=42]="CameraObliqueLeft",a[a.CameraObliqueRight=43]="CameraObliqueRight",a[a.CameraObliqueBottomLeft=44]="CameraObliqueBottomLeft",a[a.CameraObliqueBottom=45]="CameraObliqueBottom",a[a.CameraObliqueBottomRight=46]="CameraObliqueBottomRight",a[a.CameraPerspectiveFront=47]="CameraPerspectiveFront",a[a.CameraPerspectiveLeft=48]="CameraPerspectiveLeft",a[a.CameraPerspectiveRight=49]="CameraPerspectiveRight",a[a.CameraPerspectiveAbove=50]="CameraPerspectiveAbove",a[a.CameraPerspectiveBelow=51]="CameraPerspectiveBelow",a[a.CameraPerspectiveAboveLeftFacing=52]="CameraPerspectiveAboveLeftFacing",a[a.CameraPerspectiveAboveRightFacing=53]="CameraPerspectiveAboveRightFacing",a[a.CameraPerspectiveContrastingLeftFacing=54]="CameraPerspectiveContrastingLeftFacing",a[a.CameraPerspectiveContrastingRightFacing=55]="CameraPerspectiveContrastingRightFacing",a[a.CameraPerspectiveHeroicLeftFacing=56]="CameraPerspectiveHeroicLeftFacing",a[a.CameraPerspectiveHeroicRightFacing=57]="CameraPerspectiveHeroicRightFacing",a[a.CameraPerspectiveHeroicExtremeLeftFacing=58]="CameraPerspectiveHeroicExtremeLeftFacing",a[a.CameraPerspectiveHeroicExtremeRightFacing=59]="CameraPerspectiveHeroicExtremeRightFacing",a[a.CameraPerspectiveRelaxed=60]="CameraPerspectiveRelaxed",a[a.CameraPerspectiveRelaxedModerately=61]="CameraPerspectiveRelaxedModerately",a[a.PresetCameraNone=62]="PresetCameraNone"}(Da=b.PresetCamera||(b.PresetCamera={})),function(a){a[a.LightingTopLeft=0]="LightingTopLeft",a[a.LightingTop=1]="LightingTop",a[a.LightingTopRight=2]="LightingTopRight",a[a.LightingLeft=3]="LightingLeft",a[a.LightingNone=4]="LightingNone",a[a.LightingRight=5]="LightingRight",a[a.LightingBottomLeft=6]="LightingBottomLeft",a[a.LightingBottom=7]="LightingBottom",a[a.LightingBottomRight=8]="LightingBottomRight"}(Ea=b.PresetLightingDirection||(b.PresetLightingDirection={})),function(a){a[a.LightRigLegacyFlat1=0]="LightRigLegacyFlat1",a[a.LightRigLegacyFlat2=1]="LightRigLegacyFlat2",a[a.LightRigLegacyFlat3=2]="LightRigLegacyFlat3",a[a.LightRigLegacyFlat4=3]="LightRigLegacyFlat4",a[a.LightRigLegacyNormal1=4]="LightRigLegacyNormal1",a[a.LightRigLegacyNormal2=5]="LightRigLegacyNormal2",a[a.LightRigLegacyNormal3=6]="LightRigLegacyNormal3",a[a.LightRigLegacyNormal4=7]="LightRigLegacyNormal4",a[a.LightRigLegacyHarsh1=8]="LightRigLegacyHarsh1",a[a.LightRigLegacyHarsh2=9]="LightRigLegacyHarsh2",a[a.LightRigLegacyHarsh3=10]="LightRigLegacyHarsh3",a[a.LightRigLegacyHarsh4=11]="LightRigLegacyHarsh4",a[a.LightRigThreePoint=12]="LightRigThreePoint",a[a.LightRigBalanced=13]="LightRigBalanced",a[a.LightRigSoft=14]="LightRigSoft",a[a.LightRigHarsh=15]="LightRigHarsh",a[a.LightRigFlood=16]="LightRigFlood",a[a.LightRigContrasting=17]="LightRigContrasting",a[a.LightRigMorning=18]="LightRigMorning",a[a.LightRigSunrise=19]="LightRigSunrise",a[a.LightRigSunset=20]="LightRigSunset",a[a.LightRigChilly=21]="LightRigChilly",a[a.LightRigFreezing=22]="LightRigFreezing",a[a.LightRigFlat=23]="LightRigFlat",a[a.LightRigTwoPoint=24]="LightRigTwoPoint",a[a.LightRigGlow=25]="LightRigGlow",a[a.LightRigBrightRoom=26]="LightRigBrightRoom"}(Fa=b.LightRigType||(b.LightRigType={})),function(a){a[a.tl=0]="tl",a[a.t=1]="t",a[a.tr=2]="tr",a[a.l=3]="l",a[a.r=4]="r",a[a.bl=5]="bl",a[a.b=6]="b",a[a.br=7]="br"}(Ga=b.LightRigDirection||(b.LightRigDirection={})),function(a){a[a.Category=0]="Category",a[a.Value=1]="Value",a[a.SeriesAxis=2]="SeriesAxis"}(Ha=b.AxisType||(b.AxisType={})),function(a){a[a.high=0]="high",a[a.low=1]="low",a[a.nextToAxis=2]="nextToAxis",a[a.none=3]="none"}(Ia=b.TickLabelPosition||(b.TickLabelPosition={})),function(a){a[a.ScaleLogarithmic=0]="ScaleLogarithmic",a[a.ScaleLinear=1]="ScaleLinear"}(Ja=b.ScaleType||(b.ScaleType={})),function(a){a[a.days=0]="days",a[a.months=1]="months",a[a.years=2]="years"}(Ka=b.TimeUnit||(b.TimeUnit={})),function(a){a[a.cross=0]="cross",a[a.inside=1]="inside",a[a.none=2]="none",a[a.outside=3]="outside"}(La=b.TickMark||(b.TickMark={})),function(a){a.hundreds="hundreds",a.thousands="thousands",a.tenThousands="tenThousands",a.hundredThousands="hundredThousands",a.millions="millions",a.tenMillions="tenMillions",a.hundredMillions="hundredMillions",a.billions="billions",a.trillions="trillions"}(Ma=b.DisplayUnit||(b.DisplayUnit={})),function(a){a.automatic="auto",a.maximum="max",a.minimum="min"}(Na=b.AxisCrossPoint||(b.AxisCrossPoint={})),function(a){a[a.minMax=0]="minMax",a[a.maxMin=1]="maxMin"}(Oa=b.AxisOrientation||(b.AxisOrientation={})),function(a){a[a.AutomaticScale=0]="AutomaticScale",a[a.CategoryScale=1]="CategoryScale",a[a.TimeScale=2]="TimeScale",a[a.ValueScale=3]="ValueScale"}(Pa=b.CategoryType||(b.CategoryType={})),function(a){a[a.primary=0]="primary",a[a.secondary=1]="secondary"}(Qa=b.AxisGroup||(b.AxisGroup={})),function(a){a[a.cone=0]="cone",a[a.coneToMax=1]="coneToMax",a[a.box=2]="box",a[a.cylinder=3]="cylinder",a[a.pyramid=4]="pyramid",a[a.pyramidToMax=5]="pyramidToMax"}(Ra=b.ST_Shape||(b.ST_Shape={})),function(a){a[a.none=0]="none",a[a.banner=1]="banner",a[a.overlapping=2]="overlapping"}(Sa=b.ST_ParentLabelLayout||(b.ST_ParentLabelLayout={})),function(a){a[a.none=0]="none",a[a.bestFitOnly=1]="bestFitOnly",a[a.showAll=2]="showAll"}(Ta=b.ST_RegionLabelLayout||(b.ST_RegionLabelLayout={})),function(a){a[a.ConeToPoint=0]="ConeToPoint",a[a.ConeToMax=1]="ConeToMax",a[a.Box=2]="Box",a[a.Cylinder=3]="Cylinder",a[a.PyramidToPoint=4]="PyramidToPoint",a[a.PyramidToMax=5]="PyramidToMax"}(Ua=b.BarShape||(b.BarShape={})),function(a){a[a.combo=0]="combo",a[a.xyScatter=1]="xyScatter",a[a.radar=2]="radar",a[a.doughnut=3]="doughnut",a[a.pie3D=4]="pie3D",a[a.line3D=5]="line3D",a[a.column3D=6]="column3D",a[a.area3D=7]="area3D",a[a.area=8]="area",a[a.line=9]="line",a[a.pie=10]="pie",a[a.bubble=11]="bubble",a[a.columnClustered=12]="columnClustered",a[a.columnStacked=13]="columnStacked",a[a.columnStacked100=14]="columnStacked100",a[a.columnClustered3D=15]="columnClustered3D",a[a.columnStacked3D=16]="columnStacked3D",a[a.columnStacked1003D=17]="columnStacked1003D",a[a.barClustered=18]="barClustered",a[a.barStacked=19]="barStacked",a[a.barStacked100=20]="barStacked100",a[a.barClustered3D=21]="barClustered3D",a[a.barStacked3D=22]="barStacked3D",a[a.barStacked1003D=23]="barStacked1003D",a[a.lineStacked=24]="lineStacked",a[a.lineStacked100=25]="lineStacked100",a[a.lineMarkers=26]="lineMarkers",a[a.lineMarkersStacked=27]="lineMarkersStacked",a[a.lineMarkersStacked100=28]="lineMarkersStacked100",a[a.pieOfPie=29]="pieOfPie",a[a.pieExploded=30]="pieExploded",a[a.pieExploded3D=31]="pieExploded3D",a[a.barOfPie=32]="barOfPie",a[a.xyScatterSmooth=33]="xyScatterSmooth",a[a.xyScatterSmoothNoMarkers=34]="xyScatterSmoothNoMarkers",a[a.xyScatterLines=35]="xyScatterLines",a[a.xyScatterLinesNoMarkers=36]="xyScatterLinesNoMarkers",a[a.areaStacked=37]="areaStacked",a[a.areaStacked100=38]="areaStacked100",a[a.areaStacked3D=39]="areaStacked3D",a[a.areaStacked1003D=40]="areaStacked1003D",a[a.doughnutExploded=41]="doughnutExploded",a[a.radarMarkers=42]="radarMarkers",a[a.radarFilled=43]="radarFilled",a[a.surface=44]="surface",a[a.surfaceWireframe=45]="surfaceWireframe",a[a.surfaceTopView=46]="surfaceTopView",a[a.surfaceTopViewWireframe=47]="surfaceTopViewWireframe",a[a.bubble3DEffect=48]="bubble3DEffect",a[a.stockHLC=49]="stockHLC",a[a.stockOHLC=50]="stockOHLC",a[a.stockVHLC=51]="stockVHLC",a[a.stockVOHLC=52]="stockVOHLC",a[a.boxWhisker=53]="boxWhisker",a[a.funnel=54]="funnel",a[a.paretoLine=55]="paretoLine",a[a.regionMap=56]="regionMap",a[a.sunburst=57]="sunburst",a[a.treemap=58]="treemap",a[a.waterfall=59]="waterfall",a[a.clusteredColumn=60]="clusteredColumn"}(Va=b.ChartType||(b.ChartType={})),function(a){a[a.exp=0]="exp",a[a.linear=1]="linear",a[a.log=2]="log",a[a.movingAvg=3]="movingAvg",a[a.poly=4]="poly",a[a.power=5]="power"}(Wa=b.ST_TrendlineType||(b.ST_TrendlineType={})),function(a){a[a.exponential=0]="exponential",a[a.linear=1]="linear",a[a.logarithmic=2]="logarithmic",a[a.movingAverage=3]="movingAverage",a[a.polynomial=4]="polynomial",a[a.power=5]="power"}(Xa=b.TrendlineType||(b.TrendlineType={})),function(a){a[a.bestFit=0]="bestFit",a[a.b=1]="b",a[a.ctr=2]="ctr",a[a.inBase=3]="inBase",a[a.inEnd=4]="inEnd",a[a.l=5]="l",a[a.outEnd=6]="outEnd",a[a.r=7]="r",a[a.t=8]="t"}(Ya=b.ST_DLblPos||(b.ST_DLblPos={})),function(a){a[a.bestFit=0]="bestFit",a[a.below=1]="below",a[a.center=2]="center",a[a.insideBase=3]="insideBase",a[a.insideEnd=4]="insideEnd",a[a.left=5]="left",a[a.outsideEnd=6]="outsideEnd",a[a.right=7]="right",a[a.above=8]="above"}(Za=b.DataLabelPosition||(b.DataLabelPosition={})),function(a){a[a.MarkerStyleCircle=0]="MarkerStyleCircle",a[a.MarkerStyleDash=1]="MarkerStyleDash",a[a.MarkerStyleDiamond=2]="MarkerStyleDiamond",a[a.MarkerStyleDot=3]="MarkerStyleDot",a[a.MarkerStyleNone=4]="MarkerStyleNone",a[a.MarkerStylePicture=5]="MarkerStylePicture",a[a.MarkerStylePlus=6]="MarkerStylePlus",a[a.MarkerStyleSquare=7]="MarkerStyleSquare",a[a.MarkerStyleStar=8]="MarkerStyleStar",a[a.MarkerStyleTriangle=9]="MarkerStyleTriangle",a[a.MarkerStyleX=10]="MarkerStyleX",a[a.MarkerStyleAutomatic=11]="MarkerStyleAutomatic"}($a=b.MarkerStyle||(b.MarkerStyle={})),function(a){a[a.x=0]="x",a[a.y=1]="y"}(_a=b.ST_ErrDir||(b.ST_ErrDir={})),function(a){a[a.both=0]="both",a[a.minus=1]="minus",a[a.plus=2]="plus"}(ab=b.ErrorBarType||(b.ErrorBarType={})),function(a){a[a.cust=0]="cust",a[a.fixedVal=1]="fixedVal",a[a.percentage=2]="percentage",a[a.stdDev=3]="stdDev",a[a.stdErr=4]="stdErr"}(bb=b.ST_ErrValType||(b.ST_ErrValType={})),function(a){a[a.custom=0]="custom",a[a.fixedValue=1]="fixedValue",a[a.percentage=2]="percentage",a[a.standardDeviation=3]="standardDeviation",a[a.standardError=4]="standardError"}(cb=b.ErrorBarValueType||(b.ErrorBarValueType={})),function(a){a[a.Stretch=0]="Stretch",a[a.Stack=1]="Stack",a[a.StackScale=2]="StackScale"}(db=b.DrawingPictureType||(b.DrawingPictureType={})),function(a){a[a.SizeIsArea=0]="SizeIsArea",a[a.SizeIsWidth=1]="SizeIsWidth"}(eb=b.SizeRepresents||(b.SizeRepresents={})),function(a){a[a.SplitByPosition=0]="SplitByPosition",a[a.SplitByValue=1]="SplitByValue",a[a.SplitByPercentValue=2]="SplitByPercentValue",a[a.SplitByCustomSplit=3]="SplitByCustomSplit"}(fb=b.ChartSplitType||(b.ChartSplitType={})),function(a){a[a.custom=0]="custom",a[a.top=1]="top",a[a.right=2]="right",a[a.left=3]="left",a[a.bottom=4]="bottom",a[a.topRight=5]="topRight"}(gb=b.LegendPosition||(b.LegendPosition={})),function(a){a[a.rows=0]="rows",a[a.columns=1]="columns"}(hb=b.RowCol||(b.RowCol={})),function(a){a[a.circle=0]="circle",a[a.dash=1]="dash",a[a.diamond=2]="diamond",a[a.dot=3]="dot",a[a.none=4]="none",a[a.picture=5]="picture",a[a.plus=6]="plus",a[a.square=7]="square",a[a.star=8]="star",a[a.triangle=9]="triangle",a[a.x=10]="x"}(ib=b.SymbolShape||(b.SymbolShape={})),function(a){a[a.solid=0]="solid",a[a.dot=1]="dot",a[a.dash=2]="dash",a[a.lgDash=3]="lgDash",a[a.dashDot=4]="dashDot",a[a.lgDashDot=5]="lgDashDot",a[a.lgDashDotDot=6]="lgDashDotDot",a[a.sysDash=7]="sysDash",a[a.sysDot=8]="sysDot",a[a.sysDashDot=9]="sysDashDot",a[a.sysDashDotDot=10]="sysDashDotDot"}(jb=b.LineType||(b.LineType={})),function(a){a[a.Baseline=0]="Baseline",a[a.Superscript=1]="Superscript",a[a.Subscript=2]="Subscript"}(kb=b.VertAlignType||(b.VertAlignType={})),function(a){a[a.MoveAndSize=0]="MoveAndSize",a[a.Move=1]="Move",a[a.FreeFloating=2]="FreeFloating"}(lb=b.Placement||(b.Placement={})),function(a){a[a.All=0]="All",a[a.Chart=1]="Chart",a[a.PlotArea=2]="PlotArea",a[a.Series=3]="Series",a[a.SeriesCollection=4]="SeriesCollection",a[a.Point=5]="Point",a[a.DataLabel=6]="DataLabel",a[a.DataMarker=7]="DataMarker",a[a.CategoryAxis=8]="CategoryAxis",a[a.ValueAxis=9]="ValueAxis",a[a.SeriesAxis=10]="SeriesAxis",a[a.Lengend=11]="Lengend",a[a.FloorWall=12]="FloorWall",a[a.SideWall=13]="SideWall",a[a.BackWall=14]="BackWall",a[a.ChartTitle=15]="ChartTitle",a[a.AxisTitle=16]="AxisTitle",a[a.ChartGroup=17]="ChartGroup"}(mb=b.ChartElements||(b.ChartElements={})),function(a){a[a.PNG=0]="PNG",a[a.JPG=1]="JPG",a[a.JPEG=2]="JPEG",a[a.EMF=3]="EMF"}(nb=b.ImageType||(b.ImageType={})),function(a){a[a.None=0]="None",a[a.Automatic=1]="Automatic",a[a.RGB=2]="RGB",a[a.Theme=3]="Theme"}(ob=b.SolidColorType||(b.SolidColorType={})),function(a){a[a.None=0]="None",a[a.Words=1]="Words",a[a.Single=2]="Single",a[a.Double=3]="Double",a[a.Heavy=4]="Heavy",a[a.Dotted=5]="Dotted",a[a.DottedHeavy=6]="DottedHeavy",a[a.Dash=7]="Dash",a[a.DashHeavy=8]="DashHeavy",a[a.DashLong=9]="DashLong",a[a.DashLongHeavy=10]="DashLongHeavy",a[a.DotDash=11]="DotDash",a[a.DotDashHeavy=12]="DotDashHeavy",a[a.DotDotDash=13]="DotDotDash",a[a.DotDotDashHeavy=14]="DotDotDashHeavy",a[a.Wavy=15]="Wavy",a[a.WavyHeavy=16]="WavyHeavy",a[a.WavyDouble=17]="WavyDouble"}(pb=b.TextUnderlineType||(b.TextUnderlineType={})),function(a){a[a.ReflectionTypeNone=0]="ReflectionTypeNone",a[a.ReflectionType1=1]="ReflectionType1",a[a.ReflectionType2=2]="ReflectionType2",a[a.ReflectionType3=3]="ReflectionType3",a[a.ReflectionType4=4]="ReflectionType4",a[a.ReflectionType5=5]="ReflectionType5",a[a.ReflectionType6=6]="ReflectionType6",a[a.ReflectionType7=7]="ReflectionType7",a[a.ReflectionType8=8]="ReflectionType8",a[a.ReflectionType9=9]="ReflectionType9"}(qb=b.ReflectionType||(b.ReflectionType={})),function(a){a[a.CellRange=0]="CellRange",a[a.SeriesName=1]="SeriesName",a[a.CategoryName=2]="CategoryName",a[a.Value=3]="Value",a[a.XValue=4]="XValue",a[a.YValue=5]="YValue",a[a.BubbleSize=6]="BubbleSize",a[a.Percentage=7]="Percentage",a[a.TxLink=8]="TxLink"}(rb=b.TextFieldType||(b.TextFieldType={})),function(a){a[a.None=0]="None",a[a.Single=1]="Single",a[a.Double=2]="Double",a[a.SingleAccounting=3]="SingleAccounting",a[a.DoubleAccounting=4]="DoubleAccounting"}(sb=b.UnderlineType||(b.UnderlineType={})),function(a){a[a.None=0]="None",a[a.Auto=1]="Auto",a[a.RGB=2]="RGB",a[a.Index=3]="Index",a[a.Theme=4]="Theme"}(tb=b.ColorType||(b.ColorType={})),function(a){a[a.connected=0]="connected",a[a.gaps=1]="gaps",a[a.zero=2]="zero"}(ub=b.DisplayBlanksAs||(b.DisplayBlanksAs={})),function(a){a[a.cross=0]="cross",a[a.in=1]="in",a[a.none=2]="none",a[a.out=3]="out"}(vb=b.ST_TickMark||(b.ST_TickMark={})),function(a){a[a.high=0]="high",a[a.low=1]="low",a[a.nextTo=2]="nextTo",a[a.none=3]="none"}(wb=b.ST_TickLblPos||(b.ST_TickLblPos={})),function(a){a[a.hundreds=0]="hundreds",a[a.thousands=1]="thousands",a[a.tenThousands=2]="tenThousands",a[a.hundredThousands=3]="hundredThousands",a[a.millions=4]="millions",a[a.tenMillions=5]="tenMillions",a[a.hundredMillions=6]="hundredMillions",a[a.billions=7]="billions",a[a.trillions=8]="trillions"}(xb=b.ST_BuiltInUnit||(b.ST_BuiltInUnit={})),function(a){a[a.in=1]="in",a[a.out=3]="out",a[a.cross=0]="cross",a[a.none=2]="none"}(yb=b.ST_TickMarksType||(b.ST_TickMarksType={})),function(a){a[a.autoZero=1]="autoZero",a[a.max=2]="max",a[a.min=3]="min"}(zb=b.ST_Crosses||(b.ST_Crosses={})),function(a){a[a.min=0]="min",a[a.ctr=1]="ctr",a[a.max=2]="max"}(Ab=b.ST_PosAlign||(b.ST_PosAlign={})),function(a){a[a.b=4]="b",a[a.tr=5]="tr",a[a.l=3]="l",a[a.r=2]="r",a[a.t=1]="t"}(Bb=b.ST_LegendPos||(b.ST_LegendPos={})),function(a){a[a.edge=0]="edge",a[a.factor=1]="factor"}(Cb=b.ST_LayoutMode||(b.ST_LayoutMode={})),function(a){a[a.inner=0]="inner",a[a.outer=1]="outer"}(Db=b.ST_LayoutTarget||(b.ST_LayoutTarget={})),function(a){a[a.circle=0]="circle",a[a.dash=1]="dash",a[a.diamond=2]="diamond",a[a.dot=3]="dot",a[a.none=4]="none",a[a.picture=5]="picture",a[a.plus=6]="plus",a[a.square=7]="square",a[a.star=8]="star",a[a.triangle=9]="triangle",a[a.x=10]="x"}(Eb=b.ST_MarkerStyle||(b.ST_MarkerStyle={})),function(a){a[a.auto=0]="auto",a[a.cust=1]="cust",a[a.percent=2]="percent",a[a.pos=3]="pos",a[a.val=4]="val"}(Fb=b.ST_SplitType||(b.ST_SplitType={})),function(a){a[a.area=0]="area",a[a.w=1]="w"}(Gb=b.ST_SizeRepresents||(b.ST_SizeRepresents={})),function(a){a[a.span=0]="span",a[a.gap=1]="gap",a[a.zero=2]="zero"}(Hb=b.ST_DispBlanksAs||(b.ST_DispBlanksAs={})),function(a){a[a.legacyObliqueTopLeft=0]="legacyObliqueTopLeft",a[a.legacyObliqueTop=1]="legacyObliqueTop",a[a.legacyObliqueTopRight=2]="legacyObliqueTopRight",a[a.legacyObliqueLeft=3]="legacyObliqueLeft",a[a.legacyObliqueFront=4]="legacyObliqueFront",a[a.legacyObliqueRight=5]="legacyObliqueRight",a[a.legacyObliqueBottomLeft=6]="legacyObliqueBottomLeft",a[a.legacyObliqueBottom=7]="legacyObliqueBottom",a[a.legacyObliqueBottomRight=8]="legacyObliqueBottomRight",a[a.legacyPerspectiveTopLeft=9]="legacyPerspectiveTopLeft",a[a.legacyPerspectiveTop=10]="legacyPerspectiveTop",a[a.legacyPerspectiveTopRight=11]="legacyPerspectiveTopRight",a[a.legacyPerspectiveLeft=12]="legacyPerspectiveLeft",a[a.legacyPerspectiveFront=13]="legacyPerspectiveFront",a[a.legacyPerspectiveRight=14]="legacyPerspectiveRight",a[a.legacyPerspectiveBottomLeft=15]="legacyPerspectiveBottomLeft",a[a.legacyPerspectiveBottom=16]="legacyPerspectiveBottom",a[a.legacyPerspectiveBottomRight=17]="legacyPerspectiveBottomRight",a[a.orthographicFront=18]="orthographicFront",a[a.isometricTopUp=19]="isometricTopUp",a[a.isometricTopDown=20]="isometricTopDown",a[a.isometricBottomUp=21]="isometricBottomUp",a[a.isometricBottomDown=22]="isometricBottomDown",a[a.isometricLeftUp=23]="isometricLeftUp",a[a.isometricLeftDown=24]="isometricLeftDown",a[a.isometricRightUp=25]="isometricRightUp",a[a.isometricRightDown=26]="isometricRightDown",a[a.isometricOffAxis1Left=27]="isometricOffAxis1Left",a[a.isometricOffAxis1Right=28]="isometricOffAxis1Right",a[a.isometricOffAxis1Top=29]="isometricOffAxis1Top",a[a.isometricOffAxis2Left=30]="isometricOffAxis2Left",a[a.isometricOffAxis2Right=31]="isometricOffAxis2Right",a[a.isometricOffAxis2Top=32]="isometricOffAxis2Top",a[a.isometricOffAxis3Left=33]="isometricOffAxis3Left",a[a.isometricOffAxis3Right=34]="isometricOffAxis3Right",a[a.isometricOffAxis3Bottom=35]="isometricOffAxis3Bottom",a[a.isometricOffAxis4Left=36]="isometricOffAxis4Left",a[a.isometricOffAxis4Right=37]="isometricOffAxis4Right",a[a.isometricOffAxis4Bottom=38]="isometricOffAxis4Bottom",a[a.obliqueTopLeft=39]="obliqueTopLeft",a[a.obliqueTop=40]="obliqueTop",a[a.obliqueTopRight=41]="obliqueTopRight",a[a.obliqueLeft=42]="obliqueLeft",a[a.obliqueRight=43]="obliqueRight",a[a.obliqueBottomLeft=44]="obliqueBottomLeft",a[a.obliqueBottom=45]="obliqueBottom",a[a.obliqueBottomRight=46]="obliqueBottomRight",a[a.perspectiveFront=47]="perspectiveFront",a[a.perspectiveLeft=48]="perspectiveLeft",a[a.perspectiveRight=49]="perspectiveRight",a[a.perspectiveAbove=50]="perspectiveAbove",a[a.perspectiveBelow=51]="perspectiveBelow",a[a.perspectiveAboveLeftFacing=52]="perspectiveAboveLeftFacing",a[a.perspectiveAboveRightFacing=53]="perspectiveAboveRightFacing",a[a.perspectiveContrastingLeftFacing=54]="perspectiveContrastingLeftFacing",a[a.perspectiveContrastingRightFacing=55]="perspectiveContrastingRightFacing",a[a.perspectiveHeroicLeftFacing=56]="perspectiveHeroicLeftFacing",a[a.perspectiveHeroicRightFacing=57]="perspectiveHeroicRightFacing",a[a.perspectiveHeroicExtremeLeftFacing=58]="perspectiveHeroicExtremeLeftFacing",a[a.perspectiveHeroicExtremeRightFacing=59]="perspectiveHeroicExtremeRightFacing",a[a.perspectiveRelaxed=60]="perspectiveRelaxed",a[a.perspectiveRelaxedModeratel=61]="perspectiveRelaxedModeratel"}(Ib=b.ST_PresetCameraType||(b.ST_PresetCameraType={})),function(a){a[a.solid=0]="solid",a[a.dot=1]="dot",a[a.dash=2]="dash",a[a.lgDash=3]="lgDash",a[a.dashDot=4]="dashDot",a[a.lgDashDot=5]="lgDashDot",a[a.lgDashDotDot=6]="lgDashDotDot",a[a.sysDash=7]="sysDash",a[a.sysDot=8]="sysDot",a[a.sysDashDot=9]="sysDashDot",a[a.sysDashDotDot=10]="sysDashDotDot"}(Jb=b.ST_PresetLineDashVal||(b.ST_PresetLineDashVal={})),function(a){a[a.sm=0]="sm",a[a.med=1]="med",a[a.lg=2]="lg"}(Kb=b.ST_LineEndWidth||(b.ST_LineEndWidth={})),function(a){a[a.none=0]="none",a[a.triangle=1]="triangle",a[a.stealth=2]="stealth",a[a.diamond=3]="diamond",a[a.oval=4]="oval",a[a.arrow=5]="arrow"}(Lb=b.ST_LineEndType||(b.ST_LineEndType={})),function(a){a[a.sm=0]="sm",a[a.med=1]="med",a[a.lg=2]="lg"}(Mb=b.ST_LineEndLength||(b.ST_LineEndLength={})),function(a){a[a.twoCellAnchor=0]="twoCellAnchor",a[a.oneCellAnchor=1]="oneCellAnchor",a[a.absoluteAnchor=2]="absoluteAnchor",a[a.groupShapeAnchor=3]="groupShapeAnchor"}(Nb=b.ST_AnchorType||(b.ST_AnchorType={})),function(a){a[a.t=1]="t",a[a.r=2]="r",a[a.l=3]="l",a[a.b=4]="b"}(Ob=b.ST_2016ChartPosLegend||(b.ST_2016ChartPosLegend={})),function(a){a[a.Color=1]="Color",a[a.PatternColor=2]="PatternColor",a[a.BeginArrowheadLength=4]="BeginArrowheadLength",a[a.BeginArrowheadStyle=8]="BeginArrowheadStyle",a[a.BeginArrowheadWidth=16]="BeginArrowheadWidth",a[a.DashStyle=32]="DashStyle",a[a.EndArrowheadLength=64]="EndArrowheadLength",a[a.EndArrowheadStyle=128]="EndArrowheadStyle",a[a.EndArrowheadWidth=256]="EndArrowheadWidth",a[a.InsetPen=512]="InsetPen",a[a.Pattern=1024]="Pattern",a[a.Style=2048]="Style",a[a.Transparency=4096]="Transparency",a[a.Visible=8192]="Visible",a[a.Weight=16384]="Weight",a[a.CapStyle=32768]="CapStyle",a[a.JoinStyle=65536]="JoinStyle"}(Pb=b.LineFormatStates||(b.LineFormatStates={})),function(a){a[a.Brightness=1]="Brightness",a[a.ObjectThemeColor=2]="ObjectThemeColor",a[a.RGB=4]="RGB",a[a.TintAndShade=8]="TintAndShade",a[a.ColorType=16]="ColorType",a[a.Transparency=32]="Transparency",a[a.SatMod=64]="SatMod"}(Qb=b.ColorFormatStates||(b.ColorFormatStates={})),function(a){a[a.PictureShape=0]="PictureShape",a[a.PictureFill=1]="PictureFill",a[a.TextureFill=2]="TextureFill"}(Rb=b.PictureFormatType||(b.PictureFormatType={})),function(a){a[a.days=0]="days",a[a.months=1]="months",a[a.years=2]="years"}(Sb=b.ST_TimeUnit||(b.ST_TimeUnit={}))},"./dist/plugins/floatingObject/drawing/effects.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/floatingObject/drawing/stateful.js"),e=c("./dist/plugins/floatingObject/drawing/common.js"),f=c("./dist/plugins/floatingObject/drawing/colorFormat.js"),g=c("./dist/plugins/floatingObject/drawing/drawingInterface.js"),function(a){a[a.Blur=1]="Blur",a[a.Offset=2]="Offset",a[a.Size=4]="Size",a[a.Transparency=8]="Transparency",a[a.Type=16]="Type"}(h||(h={})),i=e.UnitHelper.isNullOrUndefined,j=Math.floor,k=Math.sqrt,function(a){a[a.Blur=1]="Blur",a[a.Obscured=2]="Obscured",a[a.OffsetX=4]="OffsetX",a[a.OffsetY=8]="OffsetY",a[a.RotateWithShape=16]="RotateWithShape",a[a.Size=32]="Size",a[a.Style=64]="Style",a[a.Transparency=128]="Transparency",a[a.Type=256]="Type",a[a.Visible=512]="Visible"}(l||(l={})),m=function(a){r(b,a);function b(b,c){var d=a.call(this,c)||this,f=d;return f.Ira=5,f.Jra=!1,f.Kra=e.ShapeConstants.DefaultOffset,f.Lra=e.ShapeConstants.DefaultOffset,f.Mra=!1,f.Oz=100,f.Gqa=0,f.bz=!1,f.presetShadowOffset=-6,f.xc=b,f.hqa=c,d}return b.prototype.OnStyleChange=function(){var a=this;a.Ira=0,a.Kra=0,a.Lra=0,a.Oz=100,a.Gqa=0,a.UnDirty(l.Type),a.Style===g.ShadowStyle.ShadowStyleInnerShadow?a.Mra=!1:a.Style===g.ShadowStyle.ShadowStyleOuterShadow&&(a.Mra=!0)},b.prototype.OnTypeChange=function(){var a=this;a.Ira=5,a.Kra=a.presetShadowOffset,a.Lra=a.presetShadowOffset,a.Oz=100,a.Gqa=.5,a.UnDirty(l.Style)},b.prototype.GetDefaultColor=function(){var a=new f.ColorFormat(this.xc,this.hqa&&this.hqa.Nra);return a.ColorType=g.SolidColorType.None,a},b.prototype.IncrementOffsetX=function(a){this.OffsetX+=a},b.prototype.IncrementOffsetY=function(a){this.OffsetY+=a},b.prototype.FromOOModel=function(a){this.Lqa=a},b.prototype.ToOOModel=function(){return this.Lqa},b.prototype.ToCT_PresetShadowEffect=function(){var a=this,b=a.OffsetX,c=a.OffsetY,d=k(b*b+c*c),f={dist:0,dir:0};return f.dist=d,f.dir=j(e.NumberExtension.GetTriangleAngle(b,c,d)*e.ShapeConstants.PositiveFixedAngleConvert),f.prst=a.Type,a.ToCT_Color(f),f},b.prototype.ToCT_InnerShadowEffect=function(){var a=this,b=a.OffsetX,c=a.OffsetY,d=k(b*b+c*c),f={blurRad:0,dist:0,dir:0};return f.blurRad=a.Blur,f.dist=d,0===b&&0===c||(f.dir=j(e.NumberExtension.GetTriangleAngle(b,c,d)*e.ShapeConstants.PositiveFixedAngleConvert)),f.scrgbClr=a.ToCT_ScRgbColor(),f},b.prototype.ToCT_OuterShadowEffect=function(){var a=this,b=a.OffsetX,c=a.OffsetY,d=k(b*b+c*c),f={blurRad:0,dist:0,dir:0,sx:1e5,sy:1e5,kx:0,ky:0,algn:g.TextureAlignment.TextureBottom,rotWithShape:!0};return f.blurRad=a.Blur,f.dist=d,0===b&&0===c||(f.dir=j(e.NumberExtension.GetTriangleAngle(b,c,d)*e.ShapeConstants.PositiveFixedAngleConvert)),f.rotWithShape=a.RotateWithShape===!0,f.sx=j(a.Size*e.ShapeConstants.RelativeRectConver),f.sy=j(a.Size*e.ShapeConstants.RelativeRectConver),f.scrgbClr=a.ToCT_ScRgbColor(),f},b.prototype.ToCT_Color=function(a){var b,c,d,f,h,k=this;i(k.Nra)||(k.Nra.ColorType===g.SolidColorType.Theme?(f={},f.val=k.Nra.ObjectThemeColor,0!==k.Nra.Brightness&&(b=j(1e5*k.Nra.Brightness),f.lumMod=[b],c=j(1e5*(1-k.Nra.Brightness)),f.lumOff=[c]),k.Nra.TintAndShade>0&&k.Nra.TintAndShade<1&&(d=j(k.Nra.TintAndShade*e.ShapeConstants.ShadeConver),
f.shade=[d]),a.schemeClr=f):k.Nra.ColorType===g.SolidColorType.RGB&&(h={},h.val=[k.Nra.RGB.R,k.Nra.RGB.G,k.Nra.RGB.B],0!==k.Nra.Brightness&&(b=j(1e5*k.Nra.Brightness),h.lumMod=[b],c=j(1e5*(1-k.Nra.Brightness)),h.lumOff=[c]),0!==k.Transparency&&(d=j(k.Transparency*e.ShapeConstants.PositiveFixedPercentageConvert),h.alpha=[d]),a.srgbClr=h))},b.prototype.ToCT_ScRgbColor=function(){var a,b={};return 0!==this.Transparency&&(a=j(this.Transparency*e.ShapeConstants.PositiveFixedPercentageConvert),b.alpha=[a]),b},b.prototype.SetState=function(b,c){a.prototype.SetState.call(this,b,c),b!==l.Blur&&b!==l.OffsetX&&b!==l.OffsetY&&b!==l.RotateWithShape&&b!==l.Size&&b!==l.Transparency||this.GetState(l.Style)||(this.Wqa=g.ShadowStyle.ShadowStyleOuterShadow)},Object.defineProperty(b.prototype,"ForeColor",{get:function(){var a=this;return i(a.Nra)&&(a.Nra=a.GetDefaultColor()),a.Nra},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Obscured",{get:function(){var a=this;return a.GetState(l.Obscured)||i(a.hqa)?a.Jra:a.hqa.Obscured},set:function(a){this.Jra=a,this.SetState(l.Obscured,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Blur",{get:function(){var a=this;return a.GetState(l.Blur)||i(a.hqa)?a.Ira:a.hqa.Blur},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Blue",{set:function(a){this.Ira=a,this.SetState(l.Blur,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"OffsetX",{get:function(){var a=this;return a.GetState(l.OffsetX)||i(a.hqa)?a.Kra:a.hqa.OffsetX},set:function(a){this.Kra=a,this.SetState(l.OffsetX,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"OffsetY",{get:function(){var a=this;return a.GetState(l.OffsetY)||i(a.hqa)?a.Lra:a.hqa.OffsetY},set:function(a){this.Lra=a,this.SetState(l.OffsetY,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"RotateWithShape",{get:function(){var a=this;return a.GetState(l.RotateWithShape)||i(a.hqa)?a.Mra:a.hqa.RotateWithShape},set:function(a){var b=this;b.Style===g.ShadowStyle.ShadowStyleInnerShadow||b.GetState(l.Type)||(b.Mra=a,b.SetState(l.RotateWithShape,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Size",{get:function(){var a=this;return a.GetState(l.Size)||i(a.hqa)?a.Oz:a.hqa.Size},set:function(a){this.Oz=a,this.SetState(l.Size,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Style",{get:function(){var a=this;return a.GetState(l.Style)||i(a.hqa)?a.Wqa:a.hqa.Style},set:function(a){var b=this;b.Style!==a&&b.OnStyleChange(),b.Wqa=a,b.SetState(l.Style,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Transparency",{get:function(){var a=this;return a.GetState(l.Transparency)||i(a.hqa)?a.Gqa:a.hqa.Transparency},set:function(a){this.Gqa=a,this.SetState(l.Transparency,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Type",{get:function(){var a=this;return a.GetState(l.Type)||i(a.hqa)?a.Nc:a.hqa.Type},set:function(a){this.Nc=a,this.SetState(l.Type,!0),this.OnTypeChange()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Visible",{get:function(){var a=this;return a.GetState(l.Visible)||i(a.hqa)?a.bz:a.hqa.Visible},set:function(a){var b=this;b.bz=a,b.SetState(l.Visible,!0),a===!1||b.GetState(l.Style)||(b.Wqa=g.ShadowStyle.ShadowStyleOuterShadow)},enumerable:!0,configurable:!0}),b}(d.StatefulBase),b.ShadowFormat=m,n=function(a){r(b,a);function b(b){return a.call(this,b)||this}return b.prototype.FromOOModel=function(a){this.Lqa=a},b.prototype.ToOOModel=function(){return this.Lqa},b}(d.StatefulBase),b.SoftEdgeFormat=n,o=function(a){r(b,a);function b(b,c){var d=a.call(this,c)||this,e=d;return e.Oz=100,e.Nc=g.ReflectionType.ReflectionType1,e.presetShadowOffset=-6,e.xc=b,e.hqa=c,d}return Object.defineProperty(b.prototype,"Blur",{get:function(){var a=this;return a.GetState(h.Blur)||i(a.hqa)?a.Ira:a.hqa.Blur},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Blue",{set:function(a){this.Ira=a,this.SetState(h.Blur,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Offset",{get:function(){var a=this;return a.GetState(h.Offset)||i(a.hqa)?a.UP:a.hqa.Offset},set:function(a){this.UP=a,this.SetState(h.Offset,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Size",{get:function(){var a=this;return a.GetState(h.Size)||i(a.hqa)?a.Oz:a.hqa.Size},set:function(a){this.Oz=a,this.SetState(h.Size,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Transparency",{get:function(){var a=this;return a.GetState(h.Transparency)||i(a.hqa)?a.Gqa:a.hqa.Transparency},set:function(a){this.Gqa=a,this.SetState(h.Transparency,!0)},enumerable:!0,configurable:!0}),b.prototype.FromOOModel=function(a){this.Lqa=a},b.prototype.ToOOModel=function(){return this.Lqa},b.prototype.OnTypeChange=function(){var a=this;a.Ira=5,a.UP=a.presetShadowOffset,a.Oz=100,a.Gqa=.5},b}(d.StatefulBase),b.ReflectionFormat=o,function(a){a[a.Color=1]="Color",a[a.Radius=2]="Radius",a[a.Transparency=4]="Transparency"}(p||(p={})),q=function(a){r(b,a);function b(b,c){var d=a.call(this,c)||this;return d.xc=b,d.hqa=c,d}return Object.defineProperty(b.prototype,"Color",{get:function(){var a=this;return i(a.tE)&&(a.tE=a.GetDefaultColor()),a.tE},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Radius",{get:function(){var a=this;return a.GetState(p.Radius)||i(a.hqa)?a.radius:a.hqa.Radius},set:function(a){this.radius=a,this.Dirty(p.Radius)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Transparency",{get:function(){var a=this;return a.GetState(p.Transparency)||i(a.hqa)?a.Gqa:a.hqa.Transparency},set:function(a){this.Gqa=a,this.Dirty(p.Transparency)},enumerable:!0,configurable:!0}),b.prototype.FromOOModel=function(a){this.Lqa=a},b.prototype.ToOOModel=function(){return this.Lqa},b.prototype.GetDefaultColor=function(){var a=new f.ColorFormat(this.xc,this.hqa&&this.hqa.Color);return a.ColorType=g.SolidColorType.None,a},b.prototype.SetState=function(b,c){var d=this;a.prototype.SetState.call(d,b,c),b!==p.Radius&&b!==p.Transparency||d.tE&&d.tE.ColorType===g.SolidColorType.None&&(d.tE.ColorType=g.SolidColorType.RGB)},b.prototype.ToCT_Color=function(a){var b,c,d,f,h,k,l,m=this,n=m.tE;i(n)||(f=n.ColorType,h=n.Brightness,f===g.SolidColorType.Theme?(k={},k.val=n.ObjectThemeColor,0!==h&&(b=j(1e5*h),k.lumMod=[b],c=j(1e5*(1-h)),k.lumOff=[c]),n.TintAndShade>0&&n.TintAndShade<1&&(d=j(n.TintAndShade*e.ShapeConstants.ShadeConver),k.shade=[d]),a.schemeClr=k):f===g.SolidColorType.RGB&&(l={},l.val=[n.RGB.R,n.RGB.G,n.RGB.B],0!==h&&(b=j(1e5*h),l.lumMod=[b],c=j(1e5*(1-h)),l.lumOff=[c]),0!==m.Transparency&&(d=j(m.Transparency*e.ShapeConstants.PositiveFixedPercentageConvert),l.alpha=[d]),a.srgbClr=l))},b}(d.StatefulBase),b.GlowFormat=q},"./dist/plugins/floatingObject/drawing/fillFormat.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/floatingObject/drawing/stateful.js"),e=c("./dist/plugins/floatingObject/drawing/common.js"),f=c("./dist/plugins/floatingObject/drawing/colorFormat.js"),g=c("./dist/plugins/floatingObject/drawing/gradient.js"),h=c("./dist/plugins/floatingObject/drawing/picture.js"),i=c("./dist/plugins/floatingObject/drawing/drawingInterface.js"),j=c("Core"),k=j.ExcelHelper.pixelToEMU,l=e.ShapeConstants,m=l.PositiveFixedPercentageConvert,n=l.PositiveFixedAngleConvert,o=l.PositionConver,p=e.ShapeUtility,q=e.UnitHelper,r=e.leK,s=e.ChartUtility,t=e.FgK,u=j.NodeHelper.pca,v=j.NodeHelper.oca,w=q.isNullOrUndefined,x=null,y=void 0,z=Math.floor,A="The specified value is out of range";function E(a){return{l:a.l+"",t:a.t+"",r:a.r+"",b:a.b+""}}!function(a){a[a.GradientStops=1]="GradientStops",a[a.GradientStyle=2]="GradientStyle",a[a.GradientColorType=4]="GradientColorType",a[a.Pattern=8]="Pattern",a[a.PresetTexture=16]="PresetTexture",a[a.RotateWithObject=32]="RotateWithObject",a[a.TextureAlignment=64]="TextureAlignment",a[a.TextureHorizontalScale=128]="TextureHorizontalScale",a[a.TextureName=256]="TextureName",a[a.TextureOffsetX=512]="TextureOffsetX",a[a.TextureOffsetY=1024]="TextureOffsetY",a[a.TextureTile=2048]="TextureTile",a[a.TextureType=4096]="TextureType",a[a.TextureVerticalScale=8192]="TextureVerticalScale",a[a.Transparency=16384]="Transparency",a[a.Type=32768]="Type",a[a.Visible=65536]="Visible",a[a.Color=131072]="Color",a[a.PatternColor=262144]="PatternColor",a[a.PictureFormat=524288]="PictureFormat",a[a.GradientDegree=1048576]="GradientDegree",a[a.GradientAngle=2097152]="GradientAngle",a[a.GradientVariant=4194304]="GradientVariant",a[a.PresetGradientType=8388608]="PresetGradientType"}(B||(B={})),C=function(a){D(b,a);function b(b,c,d,e){var f=a.call(this,c)||this,j=f;return j.dqa=!0,j.eqa=i.ST_PathShadeType.rect,j.wE=i.PatternType.none,j.fqa=!0,j.bz=!0,j.gqa=x,j.xc=b,j.Nc=i.FillType.Solid,j.hqa=c,j.iqa=d,j.xo=e,j.jqa=new h.PictureFormat(i.PictureFormatType.PictureFill,c&&c.PictureFormat),j.jqa.Container=e,j.kqa=1,j.lqa=1,j.mqa=new g.GradientStops(j.xc),f}return Object.defineProperty(b.prototype,"Parent",{get:function(){return this.hqa},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"PictureFormat",{get:function(){return this.jqa},set:function(a){var b,c=this;w(c.jqa)||c.jqa.SetParentForChildren(a),b=c.jqa,c.jqa=a,w(b)||(c.jqa.ParentStateful=b.ParentStateful)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"PatternColor",{get:function(){return this.PatternColorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Color",{get:function(){return this.ColorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"GradientAngle",{get:function(){var a=this;if(!a.IsDirty(B.GradientAngle)&&!w(a.hqa))return a.hqa.GradientAngle;if(a.GradientStyle===i.GradientStyle.GradientFromCenter||a.GradientStyle===i.GradientStyle.GradientFromCorner)throw Error();return a.nqa},set:function(a){this.nqa=a,this.Dirty(B.GradientAngle)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"GradientColorType",{get:function(){return this.GetGradientColorType()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"GradientDegree",{get:function(){var a=this;return a.IsDirty(B.GradientDegree)||w(a.hqa)?a.oqa:a.hqa.GradientDegree},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"GradientStops",{get:function(){var a=this;return a.IsDirty(B.GradientStops)||w(a.hqa)?a.mqa:a.hqa.GradientStops},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"GradientStyle",{get:function(){var a=this;return a.IsDirty(B.GradientStyle)||w(a.hqa)?a.qqa:a.hqa.GradientStyle},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"GradientVariant",{get:function(){var a=this;return a.IsDirty(B.GradientVariant)||w(a.hqa)?a.sqa:a.hqa.GradientVariant},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Pattern",{get:function(){var a=this;return a.IsDirty(B.Pattern)||w(a.hqa)?a.wE:a.hqa.Pattern},set:function(a){this.wE=a,this.Dirty(B.Pattern)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"PresetGradientType",{get:function(){var a=this;return a.IsDirty(B.PresetGradientType)||w(a.hqa)?a.wqa:a.hqa.PresetGradientType},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"RotateWithObject",{get:function(){var a=this;return a.IsDirty(B.RotateWithObject)||w(a.hqa)?a.fqa:a.hqa.RotateWithObject},set:function(a){this.fqa=a,this.Dirty(B.RotateWithObject)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"TextureAlignment",{get:function(){var a=this;return a.IsDirty(B.TextureAlignment)||w(a.hqa)?a.yqa:a.hqa.TextureAlignment},set:function(a){this.yqa=a,this.Dirty(B.TextureAlignment)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"TextureHorizontalScale",{get:function(){var a=this;return a.IsDirty(B.TextureHorizontalScale)||w(a.hqa)?a.kqa:a.hqa.TextureHorizontalScale},set:function(a){this.kqa=a,this.Dirty(B.TextureHorizontalScale)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"TextureOffsetX",{get:function(){var a=this;return a.IsDirty(B.TextureOffsetX)||w(a.hqa)?a.zqa:a.hqa.TextureOffsetX},set:function(a){this.zqa=a,this.Dirty(B.TextureOffsetX)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"TextureOffsetY",{get:function(){var a=this;return a.IsDirty(B.TextureOffsetY)||w(a.hqa)?a.Aqa:a.hqa.TextureOffsetY},set:function(a){this.Aqa=a,this.Dirty(B.TextureOffsetY)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"TextureVerticalScale",{get:function(){var a=this;return a.IsDirty(B.TextureVerticalScale)||w(a.hqa)?a.lqa:a.hqa.TextureVerticalScale},set:function(a){this.lqa=a,this.Dirty(B.TextureVerticalScale)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Transparency",{get:function(){var a=this;return a.IsDirty(B.Transparency)||w(a.hqa)?a.ColorInternal.Transparency:a.hqa.Transparency},set:function(a){this.ColorInternal.Transparency=a,this.Dirty(B.Transparency)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Type",{get:function(){var a=this;return a.IsDirty(B.Type)||w(a.hqa)?a.Nc:a.hqa.Type},set:function(a){this.Nc=a,this.Dirty(B.Type)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Visible",{get:function(){var a=this;return a.IsDirty(B.Visible)||w(a.hqa)?a.bz:a.hqa.Visible},set:function(a){this.bz=a,this.Dirty(B.Visible)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ColorInternal",{get:function(){var a=this;return w(a.tE)&&(a.tE=new f.ColorFormat(a.xc,w(a.hqa)?x:a.hqa.Color),a.tE.AutoColorFormat=a.iqa),a.tE},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"PatternColorInternal",{get:function(){var a=this;return w(a.Bqa)&&(a.Bqa=new f.ColorFormat(a.xc,w(a.hqa)?x:a.hqa.PatternColor)),a.Bqa},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"PresetTexture",{get:function(){var a=this;return a.IsDirty(B.PresetTexture)||w(a.hqa)?a.Cqa:a.hqa.PresetTexture},set:function(a){this.Cqa=a,this.Dirty(B.PresetTexture)},enumerable:!0,configurable:!0}),b.prototype.GetGradientColorType=function(){var a,b,c,d,e=[];for(a=0,b=this.mqa.GradientStopList;a<b.length;a++)c=b[a],this.FindInColorStops(c.Color,e)||e.push(c.Color);return d=e.length,0===d?i.GradientColorType.GradientColorNone:1===d?i.GradientColorType.GradientOneColor:2===d?i.GradientColorType.GradientTwoColors:i.GradientColorType.GradientMultiColor},b.prototype.FindInColorStops=function(a,b){var c,d,e,f;for(c=0,d=b;c<d.length;c++)if(e=d[c],f=e.ColorType,f===a.ColorType)if(f===i.SolidColorType.Theme){if(e.ObjectThemeColor===a.ObjectThemeColor&&e.TintAndShade===a.TintAndShade)return!0}else if(f===i.SolidColorType.RGB&&e.RGB.Equals(a.RGB)&&e.TintAndShade===a.TintAndShade)return!0;return!1},b.prototype.pqa=function(a){this.oqa=a,this.Dirty(B.GradientDegree)},b.prototype.Fpa=function(a){this.mqa=a,this.Dirty(B.GradientStops)},b.prototype.rqa=function(a){this.qqa=a,this.Dirty(B.GradientStyle)},b.prototype.tqa=function(a){this.sqa=a,this.Dirty(B.GradientVariant)},b.prototype.uqa=function(a){if(a===i.PatternType.none)throw Error(A);var b=this;b.Pattern===i.PatternType.none&&b.vqa(i.FillType.Patterned),b.wE=a,b.Dirty(B.Pattern)},b.prototype.xqa=function(a){this.wqa=a,this.Dirty(B.PresetGradientType)},b.prototype.vqa=function(a){this.Nc=a,this.Dirty(B.Type)},b.prototype.InitGradientInfo=function(a,b,c){if(a===i.GradientStyle.GradientFromTitle)throw Error(A);var d=this;d.rqa(a),d.tqa(b),d.vqa(i.FillType.Gradient),d.xqa(c)},b.prototype.OneColorGradient=function(a,b,c){if(c<0||c>1)throw Error(A);var d=this;d.InitGradientInfo(a,b,i.PresetGradientType.GradientEarlySunset),d.pqa(c),p.InitGradientStops(d.xc,d,i.GradientColorType.GradientOneColor)},b.prototype.TwoColorGradient=function(a,b){this.InitGradientInfo(a,b,i.PresetGradientType.GradientEarlySunset),p.InitGradientStops(this.xc,this,i.GradientColorType.GradientTwoColors)},b.prototype.PresetGradient=function(a,b,c){this.InitGradientInfo(a,b,c),p.InitGradientStops(this.xc,this,i.GradientColorType.GradientPresetColors)},b.prototype.Patterned=function(a){this.SetPatternColor(),this.vqa(i.FillType.Patterned),this.uqa(a)},b.prototype.SetPatternColor=function(){var a=this;a.Color.ObjectThemeColor=i.ColorSchemeIndex.LT1,a.PatternColor.ObjectThemeColor=i.ColorSchemeIndex.Accent1,a.Color.ClearModel(),a.PatternColor.ClearModel()},b.prototype.Solid=function(){this.vqa(i.FillType.Solid),w(this.tE)||this.tE.ClearModel()},b.prototype.ClearColor=function(){this.tE=x},b.prototype.GetState=function(b,c){var d=this;return c===y&&(c=!1),b!==B.Color||w(d.tE)?b!==B.PatternColor||w(d.Bqa)?a.prototype.GetState.call(d,b,c):d.Bqa.IsDirtyIncludingParent(c):d.tE.IsDirtyIncludingParent(c)},b.prototype.IsDirtyIncludingParent=function(b){void 0===b&&(b=!1);var c=this;return!(w(c.Bqa)||!c.Bqa.IsDirtyIncludingParent())||(!(w(c.tE)||!c.tE.IsDirtyIncludingParent())||(!w(c.mqa)&&c.mqa.Count>0||(!(w(c.jqa)||!c.jqa.IsDirtyIncludingParent())||a.prototype.IsDirtyIncludingParent.call(c,b))))},b.prototype.OnParentChanged=function(a){var b=this;b.hqa=a,w(b.hqa)?(w(b.tE)||(b.tE.ParentStateful=x),w(b.Bqa)||(b.Bqa.ParentStateful=x)):(w(b.tE)||(b.tE.ParentStateful=b.hqa.Color),w(b.Bqa)||(b.Bqa.ParentStateful=b.hqa.PatternColor))},b.prototype.FromOOModel=function(a,b){if(w(b))throw Error("colorFillType not provided!");var c=this;c.gqa=a,b===i.ColorFillType.SolidColorFillProperties?(c.ColorInternal.FromOOModel(c.gqa),c.Nc=i.FillType.Solid,c.SetState(B.Type,!0)):b===i.ColorFillType.PatternFillProperties?(c.FromCT_PatternFillProperties(a),c.Nc=i.FillType.Patterned,c.SetState(B.Type,!0)):b===i.ColorFillType.GradientFillProperties?(c.FromCT_GradientFillProperties(a),c.Nc=i.FillType.Gradient,c.SetState(B.Type,!0)):b===i.ColorFillType.BlipFillProperties?(c.jqa.FromOOModel(a),c.Nc=i.FillType.Picture,c.SetState(B.Type,!0)):b===i.ColorFillType.GroupFillProperties?(c.Nc=i.FillType.Group,c.SetState(B.Type,!0)):b===i.ColorFillType.NoFillProperties&&(c.Nc=i.FillType.Solid,c.SetState(B.Type,!0))},b.prototype.FromSJSOOModel=function(a,b){if(w(b))throw Error("colorFillType not provided!");var c=this;b===i.ColorFillType.SolidColorFillProperties?(c.ColorInternal.FromSJSOOModel(a),c.Nc=i.FillType.Solid,c.SetState(B.Type,!0)):b===i.ColorFillType.PatternFillProperties?(c.FromSJSCT_PatternFillProperties(a),c.Nc=i.FillType.Patterned,c.SetState(B.Type,!0)):b===i.ColorFillType.GradientFillProperties?(c.FromSJSCT_GradientFillProperties(a),c.Nc=i.FillType.Gradient,c.SetState(B.Type,!0)):b===i.ColorFillType.BlipFillProperties?(c.jqa.FromSJSOOModel(a),c.Nc=i.FillType.Picture,c.SetState(B.Type,!0)):b===i.ColorFillType.GroupFillProperties?(c.Nc=i.FillType.Group,c.SetState(B.Type,!0)):b===i.ColorFillType.NoFillProperties&&(c.Nc=i.FillType.Solid,c.SetState(B.Type,!0))},b.prototype.ToOOModel=function(a){var b;if(this.Visible)switch(this.Type){case i.FillType.Solid:b=this.ToCT_SolidColorFillProperties();break;case i.FillType.Patterned:b=this.ToCT_PatternFillProperties();break;case i.FillType.Gradient:b=this.ToCT_GradientFillProperties();break;case i.FillType.Textured:b=this.ToCT_TileFillProperties();break;case i.FillType.Background:break;case i.FillType.Picture:b=this.ToCT_PictureFillProperties();break;case i.FillType.Group:b={colorFillType:i.ColorFillType.GroupFillProperties}}else b={colorFillType:i.ColorFillType.NoFillProperties};return b},b.prototype.ToSJSOOModel=function(a){var b;if(this.Visible)switch(this.Type){case i.FillType.Solid:b=this.ToSJSCT_SolidColorFillProperties();break;case i.FillType.Patterned:b=this.ToSJSCT_PatternFillProperties();break;case i.FillType.Gradient:b=this.ToSJSCT_GradientFillProperties();break;case i.FillType.Textured:b=this.ToSJSCT_TileFillProperties();break;case i.FillType.Background:break;case i.FillType.Picture:b=this.ToSJSCT_PictureFillProperties();break;case i.FillType.Group:b={colorFillType:i.ColorFillType.GroupFillProperties}}else b={colorFillType:i.ColorFillType.NoFillProperties};return b},b.prototype.ToSJS_FillGroup=function(a){var b,c,d=this;s.umb(a),b=d.ToSJSOOModel(),c=b.colorFillType,c===i.ColorFillType.SolidColorFillProperties?a.solidFill=b:c===i.ColorFillType.PatternFillProperties?a.pattFill=b:c===i.ColorFillType.GradientFillProperties?a.gradFill=b:c===i.ColorFillType.BlipFillProperties?a.blipFill=b:c===i.ColorFillType.NoFillProperties&&(a.noFill={}),delete b.colorFillType},b.prototype.FromCT_PatternFillProperties=function(a){this.uqa(a.prst),this.ColorInternal.FromOOModel(a.bgClr),this.PatternColorInternal.FromOOModel(a.fgClr)},b.prototype.FromSJSCT_PatternFillProperties=function(a){this.uqa(s.ToPatternType(i.ST_PresetPatternVal[a.prst])),this.ColorInternal.FromSJSOOModel(a.bgClr),this.PatternColorInternal.FromSJSOOModel(a.fgClr)},b.prototype.ToCT_PatternFillProperties=function(){var a,b=this;return b.xc.DrawingType===i.DrawingType.GroupShape?x:(a={colorFillType:i.ColorFillType.PatternFillProperties},a.prst=b.Pattern,b.PatternColorInternal.ColorType!==i.SolidColorType.None&&(a.fgClr=b.PatternColorInternal.Color_ToOOModel()),b.Color.ColorType!==i.SolidColorType.None&&(a.bgClr=b.Color.Color_ToOOModel()),a)},b.prototype.ToSJSCT_PatternFillProperties=function(){var a,b=this;return b.xc.DrawingType===i.DrawingType.GroupShape?x:(a={colorFillType:i.ColorFillType.PatternFillProperties},a.prst=i.ST_PresetPatternVal[s.ToST_PresetPatternVal(b.Pattern)],b.PatternColorInternal.ColorType!==i.SolidColorType.None&&(a.fgClr=b.PatternColorInternal.Color_ToSJSOOModel()),b.Color.ColorType!==i.SolidColorType.None&&(a.bgClr=b.Color.Color_ToSJSOOModel()),a)},b.prototype.FromCT_GradientFillProperties=function(a){var b=this;b.Fpa(new g.GradientStops(b.xc)),b.mqa.FromOOModel(a.gsLst),b.RotateWithObject=a.rotWithShape,w(a.path)?w(a.lin)||(b.FromCT_LinearShadeProperties(a.lin),b.FromTitleCT_RelativeRect(a.tileRect)):b.FromCT_PathShadeProperties(a.path)},b.prototype.FromSJSCT_GradientFillProperties=function(a){var b,c,d=this;d.Fpa(new g.GradientStops(d.xc)),d.mqa.FromSJSOOModel(a.gsLst),d.RotateWithObject=v(a.rotWithShape,!1),b=a.path,c=a.lin,w(b)?w(c)||(d.FromSJSCT_LinearShadeProperties(c),d.FromTitleSJSCT_RelativeRect(a.tileRect)):d.FromSJSCT_PathShadeProperties(b)},b.prototype.ToCT_GradientFillProperties=function(){var a=this,b={colorFillType:i.ColorFillType.GradientFillProperties};return b.rotWithShape=a.RotateWithObject,!w(a.GradientStops)&&a.GradientStops.Count>0&&(b.gsLst=a.GradientStops.ToOOModel()),a.GradientStyle===i.GradientStyle.GradientFromCenter||a.GradientStyle===i.GradientStyle.GradientFromCorner||a.GradientStyle===i.GradientStyle.GradientTopSpotlight||a.GradientStyle===i.GradientStyle.GradientBottomSpotlight?b.path=a.ToCT_PathShadeProperties():b.lin=a.ToCT_LinearShadeProperties(),b.tileRect=a.ToTitleCT_RelativeRect(),b},b.prototype.ToSJSCT_GradientFillProperties=function(){var a=this,b={};return b.rotWithShape=t(a.RotateWithObject),!w(a.GradientStops)&&a.GradientStops.Count>0&&(b.gsLst=a.GradientStops.ToSJSOOModel()),a.GradientStyle===i.GradientStyle.GradientFromCenter||a.GradientStyle===i.GradientStyle.GradientFromCorner||a.GradientStyle===i.GradientStyle.GradientTopSpotlight||a.GradientStyle===i.GradientStyle.GradientBottomSpotlight?b.path=a.ToSJSCT_PathShadeProperties():b.lin=a.ToSJSCT_LinearShadeProperties(),b.tileRect=a.ToSJSTitleCT_RelativeRect(),b.colorFillType=i.ColorFillType.GradientFillProperties,b},b.prototype.ToCT_PictureFillProperties=function(){return this.jqa.ToOOModel()},b.prototype.ToSJSCT_PictureFillProperties=function(){return this.jqa.ToSJSOOModel()},b.prototype.FromTitleCT_RelativeRect=function(a){var b=this;w(a)||(a.l===-m&&a.t===-m?b.tqa(1):a.t===-m&&a.r===-m?b.tqa(2):a.l===-m&&a.b===-m?b.tqa(3):a.r===-m&&a.b===-m&&b.tqa(4))},b.prototype.FromTitleSJSCT_RelativeRect=function(a){var b,c,d,e,f=this;w(a)||(b=r(a.l),c=r(a.t),d=r(a.r),e=r(a.b),b===-m&&c===-m?f.tqa(1):c===-m&&d===-m?f.tqa(2):b===-m&&e===-m?f.tqa(3):d===-m&&e===-m&&f.tqa(4))},b.prototype.ToTitleCT_RelativeRect=function(){var a={l:0,r:0,t:0,b:0},b=this.GradientVariant;return this.GradientStyle===i.GradientStyle.GradientFromCorner&&(1===b?(a.l=-m,a.t=-m):2===b?(a.t=-m,a.r=-m):3===b?(a.l=-m,a.b=-m):4===b&&(a.r=-m,a.b=-m)),a},b.prototype.ToSJSTitleCT_RelativeRect=function(){return E(this.ToTitleCT_RelativeRect())},b.prototype.FromCT_LinearShadeProperties=function(a){this.GradientAngle=(a.ang||0)/n,this.Vkb=!0,this.dqa=a.scaled},b.prototype.FromSJSCT_LinearShadeProperties=function(a){this.GradientAngle=parseFloat(a.ang||"0")/n,this.Vkb=!0,this.dqa=j.NodeHelper.oca(a.scaled,!1)},b.prototype.ToCT_LinearShadeProperties=function(){return{ang:z(this.GradientAngle*n),scaled:this.dqa}},b.prototype.ToSJSCT_LinearShadeProperties=function(){return{ang:z(this.GradientAngle*n)+"",scaled:t(this.dqa)}},b.prototype.FromCT_PathShadeProperties=function(a){w(a)||(this.eqa=a.path,this.FromCT_RelativeRect(a.fillToRect))},b.prototype.FromSJSCT_PathShadeProperties=function(a){w(a)||(this.eqa=i.ST_PathShadeType[a.path],this.FromSJSCT_RelativeRect(a.fillToRect))},b.prototype.ToCT_PathShadeProperties=function(){return{path:this.eqa,fillToRect:this.ToCT_RelativeRect()}},b.prototype.ToSJSCT_PathShadeProperties=function(){return{path:i.ST_PathShadeType[this.eqa],fillToRect:this.ToSJSCT_RelativeRect()}},b.prototype.FromCT_RelativeRect=function(a){var b,c;w(a)||(b=.5*m,c=this,a.l===b&&a.t===b&&a.r===b&&a.b===b?c.rqa(i.GradientStyle.GradientFromCenter):a.r===m&&a.b===m?(c.rqa(i.GradientStyle.GradientFromCorner),c.tqa(1)):a.l===m&&a.b===m?(c.rqa(i.GradientStyle.GradientFromCorner),c.tqa(2)):a.r===m&&a.t===m?(c.rqa(i.GradientStyle.GradientFromCorner),c.tqa(3)):a.l===m&&a.t===m?(c.rqa(i.GradientStyle.GradientFromCorner),c.tqa(4)):a.l===b&&a.t===.8*-m?c.rqa(i.GradientStyle.GradientTopSpotlight):a.l===b&&a.t===1.3*m&&c.rqa(i.GradientStyle.GradientBottomSpotlight))},b.prototype.FromSJSCT_RelativeRect=function(a){var b,c,d,e,f,g;w(a)||(b=.5*m,c=this,d=u(a.l),e=u(a.r),f=u(a.t),g=u(a.b),d===b&&f===b&&e===b&&g===b?c.rqa(i.GradientStyle.GradientFromCenter):e===m&&g===m?(c.rqa(i.GradientStyle.GradientFromCorner),c.tqa(1)):d===m&&g===m?(c.rqa(i.GradientStyle.GradientFromCorner),c.tqa(2)):e===m&&f===m?(c.rqa(i.GradientStyle.GradientFromCorner),c.tqa(3)):d===m&&f===m?(c.rqa(i.GradientStyle.GradientFromCorner),c.tqa(4)):d===b&&f===.8*-m?c.rqa(i.GradientStyle.GradientTopSpotlight):d===b&&f===1.3*m&&c.rqa(i.GradientStyle.GradientBottomSpotlight))},b.prototype.ToCT_RelativeRect=function(){var a,b={l:0,r:0,t:0,b:0},c=.5*m;return this.GradientStyle===i.GradientStyle.GradientFromCenter?(b.l=c,b.t=c,b.r=c,b.b=c):this.GradientStyle===i.GradientStyle.GradientFromCorner?(a=this.GradientVariant,1===a?(b.r=m,b.b=m):2===a?(b.l=m,b.b=m):3===a?(b.t=m,b.r=m):4===a&&(b.l=m,b.t=m)):this.GradientStyle===i.GradientStyle.GradientTopSpotlight?(b.l=c,b.r=c,b.t=.8*-n,b.b=1.8*m):this.GradientStyle===i.GradientStyle.GradientBottomSpotlight&&(b.l=c,b.r=c,b.t=1.3*m,b.b=.3*-n),b},b.prototype.ToSJSCT_RelativeRect=function(){return E(this.ToCT_RelativeRect())},b.prototype.ToCT_SolidColorFillProperties=function(){return this.ColorInternal.ToOOModel()},b.prototype.ToSJSCT_SolidColorFillProperties=function(){return this.ColorInternal.ToSJSOOModel()},b.prototype.ToCT_TileFillProperties=function(){var a=this.jqa.ToOOModel();return a.tile=this.ToCT_TileInfoProperties(),a},b.prototype.ToSJSCT_TileFillProperties=function(){var a=this.jqa.ToSJSOOModel();return a.tile=this.ToSJSCT_TileInfoProperties(),a},b.prototype.ToCT_TileInfoProperties=function(){var a=this;return{algn:a.TextureAlignment,tx:a.TextureOffsetX,ty:a.TextureOffsetY,sx:z(a.TextureHorizontalScale*o),sy:z(a.TextureVerticalScale*o)}},b.prototype.ToSJSCT_TileInfoProperties=function(){var a=this;return{algn:i.ST_RectAlignment[a.TextureAlignment],tx:k(a.TextureOffsetX),ty:k(a.TextureOffsetY),sx:z(a.TextureHorizontalScale*o),sy:z(a.TextureVerticalScale*o)}},b.prototype.Clone=function(){var a=this,c=new b(a.xc,a.hqa,a.iqa,a.xo);return w(a.Bqa)||(c.Bqa=a.Bqa.Clone()),w(a.tE)||(c.tE=a.tE.Clone()),c.oqa=a.oqa,c.dqa=a.dqa,c.mqa=a.mqa,c.sqa=a.sqa,c.wE=a.wE,c.wqa=a.wqa,c.Cqa=a.Cqa,c.Dqa=a.Dqa,c.Eqa=a.Eqa,c.Nc=a.Nc,c.nqa=a.nqa,c.fqa=a.fqa,c.yqa=a.yqa,c.kqa=a.kqa,c.zqa=a.zqa,c.Aqa=a.Aqa,c.Fqa=a.Fqa,c.lqa=a.lqa,c.Gqa=a.Gqa,c.bz=a.bz,c.rpa=a.rpa,c.hqa=a.hqa,c},b}(d.StatefulBase),b.FillFormat=C},"./dist/plugins/floatingObject/drawing/fontData.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/floatingObject/drawing/common.js"),e=c("./dist/plugins/floatingObject/drawing/drawingInterface.js"),f=c("./dist/plugins/floatingObject/drawing/colorData.js"),g=d.UnitHelper.isNullOrUndefined,function(a){a[a.None=0]="None",a[a.Color=1]="Color",a[a.Size=2]="Size",a[a.Name=4]="Name",a[a.Family=8]="Family",a[a.CharSet=16]="CharSet",a[a.Scheme=32]="Scheme",a[a.Bold=64]="Bold",a[a.Italic=128]="Italic",a[a.Underline=256]="Underline",a[a.Strike=512]="Strike",a[a.VertAlign=1024]="VertAlign",a[a.Shadow=2048]="Shadow",a[a.Outline=4096]="Outline",a[a.Condense=8192]="Condense",a[a.Extend=16384]="Extend",a[a.All=32767]="All"}(h||(h={})),i=function(){function a(){var a=this;a.Flag=h.None,a.Size=0,a.Family=0,a.CharSet=0,a.Scheme=e.ThemeFont.None,a.Underline=e.UnderlineType.None,a.VertAlign=e.VertAlignType.Baseline}return a.prototype.Equals=function(a){if(g(a))return!1;var b=this;return b.Size===a.Size&&b.Color.Equals(a.Color)&&b.Name===a.Name&&b.Family===a.Family&&b.CharSet===a.CharSet&&b.Scheme===a.Scheme&&b.Bold===a.Bold&&b.Italic===a.Italic&&b.Underline===a.Underline&&b.Strike===a.Strike&&b.VertAlign===a.VertAlign&&b.Shadow===a.Shadow&&b.Outline===a.Outline&&b.Condense===a.Condense&&b.Extend===a.Extend&&b.NotUsed===a.NotUsed},a.prototype.Clone=function(){var b=new a,c=this;return b.Color=c.Color,b.Size=c.Size,b.Name=c.Name,b.Family=c.Family,b.CharSet=c.CharSet,b.Scheme=c.Scheme,b.Bold=c.Bold,b.Italic=c.Italic,b.Underline=c.Underline,b.Strike=c.Strike,b.VertAlign=c.VertAlign,b.Shadow=c.Shadow,b.Outline=c.Outline,b.Condense=c.Condense,b.Extend=c.Extend,b.Flag=c.Flag,b.NotUsed=c.NotUsed,b},a.prototype.UpdateDefaultValueFlag=function(){var a=this,b=h.None;a.Color.UpdateDefaultValueFlag(),a.Color.Flag!==f.ColorDataFlag.None&&(b|=h.Color),0!==a.Size&&(b|=h.Size),g(a.Name)||(b|=h.Name),0!==a.Family&&(b|=h.Family),0!==a.CharSet&&(b|=h.CharSet),a.Scheme!==e.ThemeFont.None&&(b|=h.Scheme),a.Bold&&(b|=h.Bold),a.Italic&&(b|=h.Italic),a.Underline!==e.UnderlineType.None&&(b|=h.Underline),a.Strike&&(b|=h.Strike),a.VertAlign!==e.VertAlignType.Baseline&&(b|=h.VertAlign),a.Shadow&&(b|=h.Shadow),a.Outline&&(b|=h.Outline),a.Condense&&(b|=h.Condense),a.Extend&&(b|=h.Extend),a.Flag=b},a.prototype.UpdateFlagFromBottom=function(){var a=this;a.Color.UpdateFlagFromBottom(),a.Color.Flag===f.ColorDataFlag.None?a.Flag&=~h.Color:a.Flag|=h.Color},a.prototype.UpdateDefaultValueFlagForDxf=function(){var a=this,b=a.Flag,c=h.None;(b&h.Bold)===h.Bold&&(c|=h.Bold),(b&h.Italic)===h.Italic&&(c|=h.Italic),a.Color.UpdateDefaultValueFlag(),a.Color.Flag!==f.ColorDataFlag.None&&(c|=h.Color),0!==a.Size&&(c|=h.Size),g(a.Name)||(c|=h.Name),0!==a.Family&&(c|=h.Family),0!==a.CharSet&&(c|=h.CharSet),a.Scheme!==e.ThemeFont.None&&(c|=h.Scheme),a.Underline!==e.UnderlineType.None&&(c|=h.Underline),a.Strike&&(c|=h.Strike),a.VertAlign!==e.VertAlignType.Baseline&&(c|=h.VertAlign),a.Shadow&&(c|=h.Shadow),a.Outline&&(c|=h.Outline),a.Condense&&(c|=h.Condense),a.Extend&&(c|=h.Extend),a.Flag=c},a.prototype.Compose=function(a,b){void 0===b&&(b=!0),a.Flag!==h.None&&(b?this.ConflictCompose(a):this.NonConflictCompose(a));
},a.prototype.ConflictCompose=function(a){var b=this,c=a.Flag;(c&h.Color)===h.Color&&b.Color.Compose(a.Color),(c&h.Size)===h.Size&&(b.Size=a.Size),(c&h.Name)===h.Name&&(b.Name=a.Name),(c&h.Family)===h.Family&&(b.Family=a.Family),(c&h.CharSet)===h.CharSet&&(b.CharSet=a.CharSet),(c&h.Scheme)===h.Scheme?b.Scheme=a.Scheme:(c&h.Name)===h.Name&&(b.Scheme=e.ThemeFont.None,c&=~h.Scheme),(c&h.Bold)===h.Bold&&(b.Bold=a.Bold),(c&h.Italic)===h.Italic&&(b.Italic=a.Italic),(c&h.Underline)===h.Underline&&(b.Underline=a.Underline),(c&h.Strike)===h.Strike&&(b.Strike=a.Strike),(c&h.VertAlign)===h.VertAlign&&(b.VertAlign=a.VertAlign),(c&h.Shadow)===h.Shadow&&(b.Shadow=a.Shadow),(c&h.Outline)===h.Outline&&(b.Outline=a.Outline),(c&h.Condense)===h.Condense&&(b.Condense=a.Condense),(c&h.Extend)===h.Extend&&(b.Extend=a.Extend),b.Flag|=c},a.prototype.NonConflictCompose=function(a){var b=this,c=b.Flag;b.Color.Compose(a.Color,!1),(c&h.Size)!==h.Size&&(b.Size=a.Size),(c&h.Name)!==h.Name&&(b.Name=a.Name),(c&h.Family)!==h.Family&&(b.Family=a.Family),(c&h.CharSet)!==h.CharSet&&(b.CharSet=a.CharSet),(c&h.Scheme)!==h.Scheme&&(b.Scheme=a.Scheme),(c&h.Bold)!==h.Bold&&(b.Bold=a.Bold),(c&h.Italic)!==h.Italic&&(b.Italic=a.Italic),(c&h.Underline)!==h.Underline&&(b.Underline=a.Underline),(c&h.Strike)!==h.Strike&&(b.Strike=a.Strike),(c&h.VertAlign)!==h.VertAlign&&(b.VertAlign=a.VertAlign),(c&h.Shadow)!==h.Shadow&&(b.Shadow=a.Shadow),(c&h.Outline)!==h.Outline&&(b.Outline=a.Outline),(c&h.Condense)!==h.Condense&&(b.Condense=a.Condense),(c&h.Extend)!==h.Extend&&(b.Extend=a.Extend),b.Flag|=a.Flag},a.prototype.RemoveDuplicateStyle=function(a){return this.Compare(a,!1)},a.prototype.RemoveDifferentStyle=function(a){return this.Compare(a,!0)},a.prototype.Compare=function(a,b){var c,d,e,g,i=this,j=i.Flag,k=a.Flag,l=[],m=!1;if((j&h.Color)===h.Color&&(c=(k&h.Color)!==h.Color,c||(b?(m=i.Color.RemoveDifferentStyle(a.Color),c=i.Color.Flag===f.ColorDataFlag.None):(m=i.Color.RemoveDuplicateStyle(a.Color),c=i.Color.Flag!==f.ColorDataFlag.None)),d=b?c:!c,d&&l.push(h.Color)),(j&h.Size)===h.Size&&(c=(k&h.Size)!==h.Size||i.Size!==a.Size,d=b?c:!c,d&&l.push(h.Size)),(j&h.Name)===h.Name&&(c=(k&h.Name)!==h.Name||i.Name!==a.Name,d=b?c:!c,d&&l.push(h.Name)),(j&h.Family)===h.Family&&(c=(k&h.Family)!==h.Family||i.Family!==a.Family,d=b?c:!c,d&&l.push(h.Family)),(j&h.CharSet)===h.CharSet&&(c=(k&h.CharSet)!==h.CharSet||i.CharSet!==a.CharSet,d=b?c:!c,d&&l.push(h.CharSet)),(j&h.Scheme)===h.Scheme&&(c=(k&h.Scheme)!==h.Scheme||i.Scheme!==a.Scheme,d=b?c:!c,d&&l.push(h.Scheme)),(j&h.Bold)===h.Bold&&(c=(k&h.Bold)!==h.Bold||i.Bold!==a.Bold,d=b?c:!c,d&&l.push(h.Bold)),(j&h.Italic)===h.Italic&&(c=(k&h.Italic)!==h.Italic||i.Italic!==a.Italic,d=b?c:!c,d&&l.push(h.Italic)),(j&h.Underline)===h.Underline&&(c=(k&h.Underline)!==h.Underline||i.Underline!==a.Underline,d=b?c:!c,d&&l.push(h.Underline)),(j&h.Strike)===h.Strike&&(c=(k&h.Strike)!==h.Strike||i.Strike!==a.Strike,d=b?c:!c,d&&l.push(h.Strike)),(j&h.VertAlign)===h.VertAlign&&(c=(k&h.VertAlign)!==h.VertAlign||i.VertAlign!==a.VertAlign,d=b?c:!c,d&&l.push(h.VertAlign)),(j&h.Shadow)===h.Shadow&&(c=(k&h.Shadow)!==h.Shadow||i.Shadow!==a.Shadow,d=b?c:!c,d&&l.push(~h.Shadow)),(j&h.Outline)===h.Outline&&(c=(k&h.Outline)!==h.Outline||i.Outline!==a.Outline,d=b?c:!c,d&&l.push(h.Outline)),(j&h.Condense)===h.Condense&&(c=(k&h.Condense)!==h.Condense||i.Condense!==a.Condense,d=b?c:!c,d&&l.push(h.Condense)),(j&h.Extend)===h.Extend&&(c=(k&h.Extend)!==h.Extend||i.Extend!==a.Extend,d=b?c:!c,d&&l.push(h.Extend)),e=l.length,e>0)for(m=!0,g=0;g<e;g++)j&=~l[g];return i.Flag=j,m},a.prototype.ClearFlag=function(){this.Color.ClearFlag(),this.Flag=h.None},a.prototype.SetFullFlag=function(){this.Color.SetFullFlag(),this.Flag=h.All},a.prototype.IsFullFlag=function(){return this.Flag===h.All&&this.Color.IsFullFlag()},a}(),b.FontData=i},"./dist/plugins/floatingObject/drawing/fontFormat.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),_=this&&this.__assign||function(){return _=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},_.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("@grapecity/js-calc"),f=c("Core"),g=c("./dist/plugins/floatingObject/drawing/stateful.js"),h=c("./dist/plugins/floatingObject/drawing/common.js"),i=c("./dist/plugins/floatingObject/drawing/fillFormat.js"),j=c("./dist/plugins/floatingObject/drawing/fontData.js"),k=c("./dist/plugins/floatingObject/drawing/drawingInterface.js"),l=f.NodeHelper.pca,m=f.NodeHelper.oca,n=f.NodeHelper.VaK,o=f.ExcelHelper.pointToPixel,p=f.ExcelHelper.emuToPixles,q=f.ExcelHelper.pixelToEMU,r=f.Util.StringToByteArray,s=f.Ul.miK,t=f.Ul.oaa,u=f.Ul.naa,v=f.Ul.gmK,w=45720,x=91440,y=p(w),z=p(x),A="overflow",B=d.Common.j,C=B.za,D=h.ChartUtility,E=D.umb,F=h.ChartConstants,G=h.UnitHelper,H=G.isNullOrUndefined,I=h.toKnownColor,J=h.toColorSchemeIndex,K=h.meK,L=null,M=void 0,N={hiddenScene3dUri:"{31F19639-BCED-4A60-ADC4-E9642A236FB7}",hiddenSp3dUri:"{E45631CC-5BF2-4C18-A39C-3461C7D3F71A}",hiddenFillUri:"{909E8E84-426E-40DD-AFC4-6F175D3DCCD1}",hiddenFillUri2:"{909E8E84-426E-40dd-AFC4-6F175D3DCCD1}",hiddenLineUri:"{91240B29-F687-4F45-9708-019B960494DF}",hiddenLineUri2:"{91240B29-F687-4f45-9708-019B960494DF}",hiddenASvgBlip:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}",hiddenASvgBlip2:"{96DAC541-7B7A-43d3-8B79-37D633B846F1}"};function aa(a,b,c,d){a.forEach(function(a){var e=b[a];d&&(e=d(e)),c[a]=e})}function ba(a){if(a){var b=parseInt(a,10);if(!isNaN(b))return b}}function ca(a,b){return H(a)?b:a}function da(a){var b=0;switch(a){case 0:b=1;break;case 1:b=2;break;case 2:b=3;break;case 3:b=4;break;case 4:b=5;break;case 5:b=6;break;case 6:b=7;break;case 7:b=8;break;case 8:b=9;break;case 9:b=10;break;case 10:b=11;break;case 11:b=12;break;case 16:b=13;break;case 17:b=14;break;case 27:b=15;break;case 28:b=16;break;case 34:b=17;break;case 52:b=18;break;case 14:b=19;break;case 15:b=20;break;case 25:b=21;break;case 26:b=22;break;case 36:b=23;break;case 45:b=24;break;case 29:b=25;break;case 30:b=26;break;case 32:b=27;break;case 31:b=28;break;case 19:b=29;break;case 18:b=30;break;case 21:b=31;break;case 20:b=32;break;case 40:b=33;break;case 37:b=34;break;case 41:b=35;break;case 35:b=36;break;case 39:b=37;break;case 53:b=38;break;case 43:b=39;break;case 42:b=40;break;case 44:b=41;break;case 46:b=42;break;case 47:b=43;break;case 48:b=44;break;case 38:b=45;break;case 49:b=46;break;case 50:b=47;break;case 51:b=48;break;case 12:b=49;break;case 13:b=50;break;case 22:b=51;break;case 23:b=52;break;case 24:b=53;break;case 33:b=54}return b}function ea(a){var b={};return a.d&&(b.d=ba(a.d)),a.sp&&(b.sp=ba(a.sp)),b}function fa(a){var b={ds:[]},c=a.ds,d=a.dumy;return c&&(c=K(c),c.forEach(function(a){b.ds.push(ea(a))})),d&&(b.dumy=n(d)),b}function ga(a){var b={w:1,len:1};return a.type&&(b.type=k.ST_LineEndType[a.type]),a.w&&(b.w=k.ST_LineEndWidth[a.w]),a.len&&(b.len=k.ST_LineEndLength[a.len]),b}function ha(a){var b,c,d,e,f,g,h,i,j,m;if(a)return b={},a.w&&(b.w=p(l(a.w))),a.cap&&(b.cap=k.ST_LineCap[a.cap]),a.cmpd&&(b.cmpd=k.ST_CompoundLine[a.cmpd]),a.algn&&(b.algn=k.ST_PenAlignment[a.algn]),Aa(a,b),c=a.prstDash,d=a.custDash,e=a.round,f=a.bevel,g=a.miter,h=a.headEnd,i=a.tailEnd,j=a.extLst,c&&(m=c.val,H(m)||(b.prstDash=k.ST_PresetLineDashVal[m])),d&&(b.custDash=fa(d)),e&&(b.round=!0),f&&(b.bevel={}),g&&(b.miter={lim:l(g.lim)}),h&&(b.headEnd=ga(h)),i&&(b.tailEnd=ga(i)),j&&(b.extLst=Ta(j)),b}function ia(a,b,c){a[b]&&(c[b]=[l(a[b].val)])}function ja(a,b){var c,d,e,f;for(a.tint&&(b.tint=[ba(a.tint.val)]),a.shade&&(b.shade=[ba(a.shade.val)]),a.comp&&(b.comp=[{}]),a.inv&&(b.inv=[{}]),a.gray&&(b.gray=[{}]),a.alpha&&(b.alpha=[ba(a.alpha.val)]),c=["alphaMod","alphaOff","hue","hueMod","hueOff","sat","satMod","satOff","lum","lumMod","lumOff","red","redMod","redOff","green","greenMod","greenOff","blue","blueMod","blueOff"],d=0,e=c;d<e.length;d++)f=e[d],ia(a,f,b);a.gamma&&(b.gamma=[{}]),a.invGamma&&(b.invGamma=[{}])}function ka(a){if(a){var b={};return a.r&&(b.r=l(a.r)),a.g&&(b.g=l(a.g)),a.b&&(b.b=l(a.b)),ja(a,b),b}}function la(a){var b,c;if(a)return b={},c=a.val,H(c)||(b.val=r(c)),ja(a,b),b}function ma(a){if(a){var b={};return a.hue&&(b.hue=l(a.hue)),a.sat&&(b.sat=l(a.sat)),a.lum&&(b.lum=l(a.lum)),ja(a,b),b}}function na(a){if(a){var b={};return a.val&&(b.val=I(k.ST_SystemColorVal[a.val])),a.lastClr&&(b.lastClr=r(a.lastClr)),ja(a,b),b}}function oa(a){var b,c;if(a)return b={},c=a.val,H(c)||(b.val=J(k.ST_SchemeColorVal[c])),ja(a,b),b}function pa(a){var b,c;if(a)return b={},c=a.val,H(c)||(b.val=k.ST_PresetColorVal[c]),ja(a,b),b}function qa(a,b){var c,d,e,f,g,h,i;if(a)return c=b||{},d=a.scrgbClr,e=a.srgbClr,f=a.hslClr,g=a.sysClr,h=a.schemeClr,i=a.prstClr,d&&(c.scrgbClr=ka(d)),e&&(c.srgbClr=la(e)),f&&(c.hslClr=ma(f)),g&&(c.sysClr=na(g)),h&&(c.schemeClr=oa(h)),i&&(c.prstClr=pa(i)),c}b.neK=qa;function ra(a){var b={};return a.pos&&(b.pos=l(a.pos)),qa(a,b)}function sa(a){var b={gs:[]},c=a.gs,d=a.dumy;return c&&(c=K(c),c.forEach(function(a){b.gs.push(ra(a))})),d&&(b.dumy=n(d.v_)),b}function ta(a){var b={};return a.ang&&(b.ang=ba(a.ang)),a.scaled&&(b.scaled=n(a.scaled)),b}function ua(a){if(a){var b={l:0,r:0,t:0,b:0};return a.l&&(b.l=ba(a.l)),a.r&&(b.r=ba(a.r)),a.t&&(b.t=ba(a.t)),a.b&&(b.b=ba(a.b)),b}}function va(a){var b={},c=a.path;return H(c)||(b.path=k.ST_PathShadeType[c]),a.fillToRect&&(b.fillToRect=ua(a.fillToRect)),b}function wa(a){var b,c,d,e,f;if(a)return b={rotWithShape:!0},a.flip&&(b.flip=k.ST_TileFlipMode[a.flip]),a.rotWithShape&&(b.rotWithShape=n(a.rotWithShape)),c=a.gsLst,d=a.lin,e=a.path,f=a.tileRect,c&&(b.gsLst=sa(c)),d&&(b.lin=ta(d)),e&&(b.path=va(e)),f&&(b.tileRect=ua(f)),b}function xa(a){var b={rad:0,grow:!0};return a.rad&&(b.rad=ba(a.rad)),a.grow&&(b.grow=n(a.grow)),b}function ya(a){var b,c,d={};return d.useA=ca(m(a.useA),!0),b=a.clrFrom,c=a.clrTo,b&&(d.clrFrom=qa(b)),c&&(d.clrTo=qa(c)),d}function za(a){var b,c,d,e;if(a)return b={},c=a.prst,H(c)||(b.prst=da(k.ST_PresetPatternVal[c])),d=a.fgClr,e=a.bgClr,d&&(b.fgClr=qa(d)),e&&(b.bgClr=qa(e)),b}function Aa(a,b){var c=b||{},d=a.solidFill,e=a.gradFill,f=a.blipFill,g=a.pattFill,h=a.grpFill;return a.noFill&&(c.noFill=!0),d&&(c.solidFill=qa(d)),e&&(c.gradFill=wa(e)),f&&(c.blipFill=db(f)),g&&(c.pattFill=za(g)),h&&(c.grpFill={}),c}function Ba(a){var b={},c=a.blend;return H(c)||(b.blend=k.ST_BlendMode[c]),Aa(a,b)}function Ca(a){var b={hue:0,sat:0,lum:0};return a.hue&&(b.hue=ba(a.hue)),a.sat&&(b.sat=ba(a.sat)),a.lum&&(b.lum=ba(a.lum)),b}function Da(a){var b={bright:0,contrast:0};return a.bright&&(b.bright=ba(a.bright)),a.contrast&&(b.contrast=ba(a.contrast)),b}function Ea(a){var b={hue:0,amt:0};return a.hue&&(b.hue=ba(a.hue)),a.amt&&(b.amt=ba(a.amt)),b}function Fa(a){var b,c={},d=ca(a.type,0);return H(d)||(c.type=k.ST_BobType[d]),b=a.blob,b&&(c.blob=b.v_),c}function Ga(a,b){var c=b||{};return a.lat&&(c.lat=ba(a.lat)),a.lon&&(c.lon=ba(a.lon)),a.rev&&(c.rev=ba(a.rev)),c}function Ha(a){var b={zoom:1e5};return a.fov&&(b.fov=ba(a.fov)),a.zoom&&(b.zoom=ba(a.zoom)),a.prst&&(b.prst=k.ST_PresetCameraType[a.prst]),Ga(a.rot,b)}function Ia(a){var b={};return a.rig&&(b.rig=k.ST_LightRigType[a.rig]),a.dir&&(b.dir=k.ST_LightRigDirection[a.dir]),Ga(a.rot,b)}function Ja(a){var b={};return a.x&&(b.x=ba(a.x)),a.y&&(b.y=ba(a.y)),a.z&&(b.z=ba(a.z)),b}function Ka(a){var b={};return a.dx&&(b.dx=ba(a.dx)),a.dy&&(b.dy=ba(a.dy)),a.dz&&(b.dz=ba(a.dz)),b}function La(a){var b={},c=a.anchor,d=a.norm,e=a.up,f=a.extLst;return c&&(b.anchor=Ja(c)),d&&(b.norm=Ka(d)),e&&(b.up=Ka(e)),f&&(b.extLst=Ta(f)),b}function Ma(a){var b={},c=a.camera,d=a.lightRig,e=a.backdrop,f=a.extLst;return c&&(b.camera=Ha(c)),d&&(b.lightRig=Ia(d)),e&&(b.backdrop=La(e)),f&&(b.extLst=Ta(f)),b}function Na(a){var b={w:76200,h:76200,prst:1};return a.w&&(b.w=ba(a.w)),a.h&&(b.h=ba(a.h)),a.prst&&(b.prst=k.ST_BevelPresetType[a.prst]),b}function Oa(a){var b,c,d,e,f,g={};return a.z&&(g.z=p(ba(a.z))),a.extrusionH&&(g.extrusionH=p(ba(a.extrusionH))),a.contourW&&(g.contourW=p(ba(a.contourW))),a.prstMaterial&&(g.prstMaterial=k.ST_PresetMaterialType[a.prstMaterial]),b=a.bevelT,c=a.bevelB,d=a.extrusionClr,e=a.contourClr,f=a.extLst,b&&(g.bevelT=Na(b)),c&&(g.bevelB=Na(c)),d&&(g.extrusionClr=qa(d)),e&&(g.contourClr=qa(e)),f&&(g.extLst=Ta(f)),g}function Pa(a){var b={};return a.asvg&&(b.asvg=a.asvg),a.embed&&(b.embed=a.embed),b}function Qa(a){var b={};return a.id&&(b.id=a.id),a["xmlns:a16"]&&(b.name=a["xmlns:a16"]),b}function Ra(a){var b={};return a.cellRange&&(b.cellRange=a.cellRange),a.spid&&(b.spid=a.spid),b}function Sa(a){var b,c,d,e,f,g,h,i,j={creationId:[]},k=ca(a.uri,"");return j.uri=k,b=k===N.hiddenScene3dUri?0:k===N.hiddenSp3dUri?3:k===N.hiddenFillUri||k===N.hiddenFillUri2?1:k===N.hiddenLineUri||k===N.hiddenLineUri2?2:k===N.hiddenASvgBlip||k===N.hiddenASvgBlip2?5:4,j.hiddenExtensionType=b,c=a.hiddenScene3d,d=a.hiddenSp3d,e=a.hiddenFill,f=a.hiddenLine,g=a.svgBlip,h=a.creationId,i=a.cameraTool,c&&(j.Scene3d=Ma(c)),d&&(j.Shape3d=Oa(d)),e&&(j.Fill=Aa(e)),f&&(j.Line=ha(f)),g&&(j.svgBlip=Pa(g)),h&&(h=K(h),h.forEach(function(a){j.creationId.push(Qa(a))})),i&&(j.cameraTool=Ra(i)),j}function Ta(a){var b={},c=a.ext,d=[];return c&&(c=K(c),c.forEach(function(a){d.push(Sa(a))}),d.length>0&&(b.ext=d)),b}function Ua(a){var b={},c=a.blend;return H(c)||(b.blend=k.ST_BlendMode[c]),ab(a.cont,b)}function Va(a){var b={};return b.rad=ca(ba(a.rad),0),qa(a,b)}function Wa(a){var b={blurRad:0,dist:0,dir:0};return b.shadowEffectType=1,a.blurRad&&(b.blurRad=ba(a.blurRad)),a.dist&&(b.dist=ba(a.dist)),a.dir&&(b.dir=ba(a.dir)),qa(a,b)}function Xa(a){var b,c={blurRad:0,dist:0,dir:0,sx:1e5,sy:1e5,kx:0,ky:0,algn:7,rotWithShape:!0};return c.shadowEffectType=0,b=["blurRad","dist","dir","sx","sy","kx","ky"],b.forEach(function(b){c[b]=ba(a[b])}),a.algn&&(c.algn=k.ST_RectAlignment[a.algn]),a.rotWithShape&&(c.rotWithShape=n(a.rotWithShape)),qa(a,c)}function Ya(a){var b={dist:0,dir:0,shadowEffectType:2};return a.dist&&(b.dist=ba(a.dist)),a.dir&&(b.dir=ba(a.dir)),a.prst&&(b.prst=k.ST_PresetShadowVal[a.prst]),qa(a,b)}function Za(a){var b={blurRad:0,stA:1e5,stPos:0,endA:0,endPos:1e5,dist:0,dir:0,fadeDir:54e5,sx:1e5,sy:1e5,kx:0,ky:0,algn:7,rotWithShape:!0},c=["blurRad","stA","stPos","endA","endPos","dist","dir","fadeDir","sx","sy","kx","ky"];return c.forEach(function(c){b[c]=ba(a[c])}),a.algn&&(b.algn=k.ST_RectAlignment[a.algn]),a.rotWithShape&&(b.rotWithShape=n(a.rotWithShape)),b}function $a(a){var b={tx:0,ty:0};return a.tx&&(b.tx=ba(a.tx)),a.ty&&(b.ty=ba(a.ty)),b}function _a(a,b){var c,d,e,f=a.alphaBiLevel,g=a.alphaCeiling,h=a.alphaFloor,i=a.alphaInv,j=a.alphaMod,k=a.alphaModFix,m=a.alphaRepl,n=a.biLevel,o=a.blur,p=a.clrChange,q=a.clrRepl,r=a.duotone,s=a.fillOverlay,t=a.grayscl,u=a.hsl,v=a.lum,w=a.tint,x=a.blipBlob,y=a.extLst;if(f&&(b.alphaBiLevel={thresh:l(f.thresh)}),g&&(b.alphaCeiling={}),h&&(b.alphaFloor={}),i&&(b.alphaInv=qa(i)),j&&(b.alphaMod=ab(j.cont)),k&&(b.alphaModFix={amt:ca(l(k.amt),1e5)}),m&&(b.alphaRepl={a:l(m.a)}),n&&(b.biLevel={thresh:l(n.thresh)}),o&&(b.blur=xa(o)),p&&(b.clrChange=ya(p)),q&&(b.clrRepl=qa(q)),r&&(b.duotone=r.c_.map(qa)),s&&(b.fillOverlay=Ba(s)),t&&(b.grayscl={}),u&&(b.hsl=Ca(u)),v&&(b.lum=Da(v)),w&&(b.tint=Ea(w)),x&&(b.blipBlob=Fa(x)),y&&(b.extLst=Ta(y),c=b.extLst&&b.extLst.ext,Array.isArray(c)&&b.embed)){for(d=-1,e=0;e<c.length;e++)if(5===c[e].hiddenExtensionType){d=e;break}d!==-1&&(b.embed=c[d].svgBlip.embed,c.splice(d,1)),0===c.length&&(delete b.extLst.ext,0===Object.keys(b.extLst).length&&delete b.extLst)}}function ab(a,b){var c,d,e,f,g,h,i,j,m,n,o,p,q=b||{};return a.type?q.type=k.ST_EffectContainerType[a.type]:q.type=0,a.name&&(q.name=a.name),c=a.cont,d=a.effect,e=a.alphaOutset,f=a.blend,g=a.fill,h=a.glow,i=a.innerShdw,j=a.outerShdw,m=a.prstShdw,n=a.reflection,o=a.relOff,p=a.softEdge,_a(a,q),c&&(q.cont=ab(c)),d&&(q.effect={ref:d.ref}),e&&(q.alphaOutset={rad:ca(ba(e.rad),0)}),f&&(q.blend=Ua(f)),g&&(q.fill=Aa(g)),h&&(q.glow=Va(h)),i&&(q.innerShdw=Wa(i)),j&&(q.outerShdw=Xa(j)),m&&(q.prstShdw=Ya(m)),n&&(q.reflection=Za(n)),o&&(q.relOff=$a(o)),p&&(q.softEdge={rad:l(p.rad)}),q}function bb(a){var b={cstate:4};return a["r:embed"]&&(b.embed=a["r:embed"]),a.link&&(b.link=a.link),a.cstate&&(b.cstate=k.ST_BlipCompression[a.cstate]),_a(a,b),b}function cb(a){var b={},c=["tx","ty","sx","sy"],d=["tx","ty"];return c.forEach(function(c){if(a[c]){var e=ba(a[c]);d.indexOf(c)!==-1&&(e=p(e)),b[c]=e}}),a.flip&&(b.flip=k.ST_TileFlipMode[a.flip]),a.algn&&(b.algn=k.ST_RectAlignment[a.algn]),b}function db(a){var b,c,d,e,f={};return a.dpi&&(f.dpi=ba(a.dpi)),a.rotWithShape&&(f.rotWithShape=n(a.rotWithShape)),b=a.blip,c=a.srcRect,d=a.tile,e=a.stretch,b&&(f.blip=bb(b)),c&&(f.srcRect=ua(c)),d&&(f.tile=cb(d)),e&&(f.stretch=ua(e.fillRect)),f}function eb(a){var b={},c=a.blur,d=a.fillOverlay,e=a.glow,f=a.innerShdw,g=a.outerShdw,h=a.prstShdw,i=a.reflection,j=a.softEdge;return c&&(b.blur=xa(c)),d&&(b.fillOverlay=Ba(d)),e&&(b.glow=Va(e)),f&&(b.innerShdw=Wa(f)),g&&(b.outerShdw=Xa(g)),h&&(b.prstShdw=Ya(h)),i&&(b.reflection=Za(i)),j&&(b.softEdge={rad:l(j.rad)}),b}function fb(a){var b={sx:1e5,sy:1e5,kx:0,ky:0,tx:0,ty:0},c=["sx","sy","kx","ky","tx","ty"];return c.forEach(function(c){b[c]=ba(a[c])}),b}function gb(a){var b=ab(a),c=a.xfrm;return c&&(b.xfrm=fb(c)),c}function hb(a){var b={pitchFamily:0,charset:1},c=["typeface","panose","pitchFamily","charset"];return c.forEach(function(c){b[c]=a[c]}),b}function ib(a){var b={name:"",builtIn:!1};return a.embed&&(b.embed=a.embed),a.name&&(b.name=a.name),a.builtIn&&(b.builtIn=n(a.builtIn)),b}function jb(a){var b,c,d={invalidUrl:"",action:"",tgtFrame:"",tooltip:"",history:!0,highlightClick:!1,endSnd:!1},e=["id","invalidUrl","action","tgtFrame","tooltip"],f=["history","highlightClick","endSnd"];return a.id,aa(e,a,d),f.forEach(function(b){d[b]=n(a[b])}),b=a.snd,c=a.extLst,b&&(d.snd=ib(b)),c&&(d.extLst=Ta(c)),d}function kb(a){var b,c,d,e,f,g,h,i,j,p,q,r,s,t,u={},v=["kern","spc","baseline","smtId"],w=["kumimoji","normalizeH","noProof","dirty","err","smtClean"],x=["altLang","bmk"];return aa(v,a,u,ba),aa(w,a,u,n),aa(x,a,u),a.sz&&(u.sz=o(l(a.sz)/100)),a.b&&(u.b=m(a.b)),a.i&&(u.i=m(a.i)),a.u&&(u.u=k.ST_TextUnderlineType[a.u]),a.strike&&(u.strike=k.ST_TextStrikeType[a.strike]),a.cap&&(u.cap=k.ST_TextCapsType[a.cap]),b=a.effectLst,c=a.effectDag,d=a.highlight,e=a.uLnTx,f=a.uLn,g=a.uFillTx,h=a.uFill,i=a.latin,j=a.ea,p=a.cs,q=a.sym,r=a.hlinkClick,s=a.hlinkMouseOver,t=a.extLst,u.ln=ha(a.ln),Aa(a,u),b&&(u.effectLst=eb(b)),c&&(u.effectDag=gb(c)),d&&(u.highlight=qa(d)),e&&(u.uLnTx={}),f&&(u.uLn=ha(f)),g&&(u.uFillTx={}),h&&(u.uFill=Aa(h)),i&&(u.latin=hb(i)),j&&(u.ea=hb(j)),p&&(u.cs=hb(p)),q&&(u.sym=hb(q)),r&&(u.hlinkClick=jb(r)),s&&(u.hlinkMouseOver=jb(s)),t&&(u.extLst=Ta),u}function lb(a){var b={},c=a.spcPct,d=a.spcPts;return c&&(b.spcPct=l(c.val)),d&&(b.spcPts=l(d.val)),b}function mb(a){var b={startAt:1};return a.type&&(b.type=k.ST_TextAutonumberScheme[a.type]),a.startAt&&(b.startAt=ba(a.startAt)),b}function nb(a){var b={};return a.pos&&(b.pos=ba(a.pos)),a.algn&&(b.algn=k.ST_TextTabAlignType[a.algn]),b}function ob(a){var b={tab:[]},c=a.tab,d=a.dumy;return c&&(c=K(c),c.forEach(function(a){b.tab.push(nb(a))})),d&&(b.dumy=n(d)),b}function pb(a){var b,c,d,e,f,g,h,i,j,m,o,p,q,r,s,t,u,v={},w=["marL","marR","lvl","indent","defTabSz"],x=["rtl","eaLnBrk","latinLnBrk","hangingPunct"];return aa(w,a,v,ba),aa(x,a,v,n),a.fontAlgn&&(v.fontAlgn=k.ST_TextFontAlignType[a.fontAlgn]),a.algn&&(v.algn=k.ST_TextAlignType[a.algn]),b=a.lnSpc,c=a.spcBef,d=a.spcAft,e=a.buClrTx,f=a.buClr,g=a.buSzTx,h=a.buSzPct,i=a.buSzPts,j=a.buFontTx,m=a.buFont,o=a.buNone,p=a.buAutoNum,q=a.buChar,r=a.buBlip,s=a.tabLst,t=a.defRPr,u=a.extLst,b&&(v.lnSpc=lb(b)),c&&(v.spcBef=lb(c)),d&&(v.spcAft=lb(d)),e&&(v.buClrTx={}),f&&(v.buClr=qa(f)),g&&(v.buSzTx={}),h&&(v.buSzPct=l(h.val)),i&&(v.buSzPts=l(i.val)),j&&(v.buFontTx={}),m&&(v.buFont=hb(m)),o&&(v.buNone={}),p&&(v.buAutoNum=mb(p)),q&&(v.buChar={char:q.char}),r&&(v.buBlip=bb(r.blip)),s&&(v.tabLst=ob(s)),t&&(v.defRPr=kb(t)),u&&(v.extLst=Ta(u)),v}function qb(a){var b,c,d,e={elementType:2};return a.id&&(e.id=ba(a.id)),a.type&&(e.type=ba(a.type)),b=a.rPr,c=a.pPr,d=a.t,b&&(e.rPr=kb(b)),c&&(e.pPr=pb(c)),d&&(e.t=d),e}function rb(a){var b={};return a.name&&(b.name=a.name),a.fmla&&(b.fmla=a.fmla),b}function sb(a){var b={gd:[]},c=K(a.gd),d=a.dumy;return c&&c.forEach(function(a){b.gd.push(rb(a))}),d&&(b.dumy=n(d)),b}function tb(a){var b={},c=a.prst;return H(c)||(b.prst=k.ST_TextShapeType[c]),sb(a.avLst)}function ub(a){var b={fontScale:1e5,lnSpcReduction:0};return a.fontScale&&(b.fontScale=ba(a.fontScale)),a.lnSpcReduction&&(b.lnSpcReduction=ba(a.lnSpcReduction)),b}function vb(a,b,c,d,f){var g,h,i,j=[],l=new e.Evaluator,m=b.source?b.source:a.yj(),n=m.getEvaluatorContext(e.pf(c,d)),o=e.Mh(n,b,!1,0,0,!0,!0),p=l.evaluate(o||b,n,!0,!0);if(p instanceof e.CalcReference)for(g=p.getSource().getName(),h=0;h<p.getRangeCount();h++)i=D.CreateReference(g,p.getRow(h),p.getColumn(h),p.getRowCount(h),p.getColumnCount(h)),b.rowRelative&&(i.Kind|=k.ReferenceKind.RowIsRelative),b.columnRelative&&(i.Kind|=k.ReferenceKind.ColumnIsRelative),b.endRowRelative&&(i.Kind|=k.ReferenceKind.LastRowIsRelative),b.endColumnRelative&&(i.Kind|=k.ReferenceKind.LastColumnIsRelative),j.push(i);return j}function wb(a,b,c,d,e){var f,g,h=a&&a.getCalcService();if(b&&h){f=void 0;try{g=h.parse(a.yj(),b,0,0,!1,!1,!e),f=vb(a,g,0,0,b)}catch(a){}if(f&&f.length>0)return f[0]}return L}O=function(){function a(a){this.Hpa=a}return Object.defineProperty(a.prototype,"Formula",{get:function(){return this.GetFormula(!1)},set:function(a){a!==this.Formula&&this.UpdateTextByFormulas(a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"FormulaR1C1",{get:function(){return this.GetFormula(!0)},set:function(a){a!==this.Formula&&this.UpdateTextByFormulas(a,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Parent",{get:function(){return this.Hpa},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ReferingText",{get:function(){return this.GetReferingText()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Worksheet",{get:function(){return this.Hpa.sheet()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"TextRefer",{get:function(){return this.Ipa},set:function(a){this.SetTextRefer(a)},enumerable:!0,configurable:!0}),a.prototype.SetTextRefer=function(a,b){b===M&&(b=!0),this.SetTextReferInternal(a,b),this.OnSetTextRefer(a)},a.prototype.OnSetTextRefer=function(a){},a.prototype.GetReferingText=function(){var a="";return H(this.Ipa)||(a=this.GetFirstCellText(this.Ipa)),a},a.prototype.GetFirstCellText=function(a){var b,c,d,e=this.Worksheet;return H(a.WorksheetName)&&(a.WorksheetName=e.name()),b=e.parent,c=b&&b.getSheetFromName(a.WorksheetName),d=c&&c.getText(a.Row,a.Column),H(d)?"":d},a.prototype.GetTextList=function(a){var b,c,d,e,f=[],g=this.Worksheet;for(H(a.WorksheetName)&&(a.WorksheetName=g.name()),b=g.Apa(a.WorksheetName),c=a.Row;c<=a.LastRow;c++)for(d=a.Column;d<=a.LastColumn;d++)e=b.Jpa(c,d).Text,f.push(H(e)?"":e);return f},a.prototype.SetTextReferInternal=function(a,b){this.Ipa=a},a.prototype.GetFormula=function(a){var b,c;return a===M&&(a=!1),(b=this.Ipa)?(c=this.Worksheet.name(),a?b.ToR1C1Text(c):b.ToA1Text(0,0,c)):""},a.prototype.UpdateTextByFormulas=function(a,b){b===M&&(b=!1),this.Ipa=wb(this.Worksheet,a,0,0,b)},a}(),b.ReferenceText=O,P=function(a){$(b,a);function b(b,c,d,e){var f,g=a.call(this,b)||this;return c===M&&(c=L),d===M&&(d=L),e===M&&(e=L),f=g,f.Lpa=L,f.Mpa=L,f.ChK=L,f.Npa=d||"",f.Opa=e,f.InitRichTextFields(c),g}return b.prototype.InitRichTextFields=function(a){var b=this,c=b.CreateDrawingTextBody(b.Hpa,b.Opa);H(b.Lpa)||b.Lpa.Font.SetParentForChildren(c.Font),b.Lpa=c,b.Lpa.Font.ParentStateful=a,H(b.Npa)||b.Lpa.AddParagraph(b.Npa)},Object.defineProperty(b.prototype,"TextBody",{get:function(){return this.Lpa},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Font",{get:function(){return this.Lpa.Font},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Text",{get:function(){return H(this.TextRefer)?this.Lpa.Text:this.ReferingText},set:function(a){this.SetTextInternal(a)},enumerable:!0,configurable:!0}),b.prototype.SetTextInternal=function(a){this.SetTextReferInternal(L),this.UpdateTextBody(a)},b.prototype.UpdateTextBody=function(a){this.Lpa.Clear();var b=H(a)?this.Npa:a;H(b)||this.Lpa.AddParagraph(b)},b.prototype.OnSetTextRefer=function(b){a.prototype.OnSetTextRefer.call(this,b),this.UpdateTextBody(L)},b.prototype.FromOOModel=function(a){var b=this;b.Mpa=a,b.InitRichTextFields(b.Lpa.Font.ParentStateful),H(a.rich)||b.Lpa.FromOOModel(a.rich),!H(a.strRef)&&a.strRef.f&&b.UpdateTextByFormulas(a.strRef.f)},b.prototype.FromSJSOOModel=function(a){var b=this;b.ChK=a,b.InitRichTextFields(b.Lpa.Font.ParentStateful),H(a.rich)||b.Lpa.FromSJSOOModel(a.rich),!H(a.strRef)&&a.strRef.f&&a.strRef.f.v_&&b.UpdateTextByFormulas(a.strRef.f.v_)},b.prototype.ToOOModel=function(a){var b=this,c=H(b.Mpa)?{}:b.Mpa;return H(b.Ipa)||(c.strRef={f:b.Formula}),c.rich=b.Lpa.ToOOModel(a),c},b.prototype.ToSJSOOModel=function(a){var b=this,c=H(b.ChK)?{}:b.ChK;return H(b.Ipa)||(c.strRef={f:{v_:b.Formula}}),c.rich=b.Lpa.ToSJSOOModel(a),c},b.prototype.SetParagraphSplitFlag=function(a){var b,c,d=this.Lpa;for(b=0,c=d.Count;b<c;b++)d.Get(b).SplitSpaceFlag=a},b.prototype.CreateDrawingTextBody=function(a,b){return new X(a,b)},b}(O),b.DrawingText=P,Q={Bold:1,Color:2,Italic:4,Name:8,OutlineFont:16,Shadow:32,Size:64,Strikethrough:128,Subscript:256,Superscript:512,ThemeFont:1024,Underline:2048},R=function(a){$(b,a);function b(b,c,d){var e,f=this;return c===M&&(c=L),d===M&&(d=L),f=a.call(this,c)||this,e=f,e.Ora=k.ThemeFont.None,e.Pra=L,e.Qra=L,e.Rra=L,e.xc=b,e.Zpa=new i.FillFormat(b,c&&c.FillInternal),e.hqa=c,d&&(H(d.Size)||(e.Oz=d.Size),H(d.Bold)||(e.Sra=d.Bold)),e}return Object.defineProperty(b.prototype,"Bold",{get:function(){var a=this.hqa;return a&&!this.GetState(Q.Bold)?a.Bold:this.Sra},set:function(a){this.Sra=a,this.SetState(Q.Bold,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Color",{get:function(){return this.FillInternal.Color},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Italic",{get:function(){var a=this.hqa;return a&&!this.GetState(Q.Italic)?a.Italic:this.Tra},set:function(a){this.Tra=a,this.SetState(Q.Italic,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Name",{get:function(){var a=this.hqa;return a&&!this.HasOwnFont()?a.Name:this.GetOwnFont()},set:function(a){this.SetFont(a),this.ClearOOFontNames()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Size",{get:function(){var a=this.hqa;return a&&!this.GetState(Q.Size)?a.Size:this.Oz},set:function(a){this.Oz=a,this.SetState(Q.Size,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Strikethrough",{get:function(){var a=this.hqa;return a&&!this.GetState(Q.Strikethrough)?a.Strikethrough:this.Ura},set:function(a){this.Ura=a,this.SetState(Q.Strikethrough,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Subscript",{get:function(){var a=this.hqa;return a&&!this.GetState(Q.Subscript)?a.Subscript:this.Vra},set:function(a){this.Vra=a,this.SetState(Q.Subscript,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Superscript",{get:function(){var a=this.hqa;return a&&!this.GetState(Q.Superscript)?a.Superscript:this.Wra},set:function(a){this.Wra=a,this.SetState(Q.Superscript,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Underline",{get:function(){var a=this.hqa;return a&&!this.GetState(Q.Underline)?a.Underline:this.Xra},set:function(a){this.Xra=a,this.SetState(Q.Underline,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ThemeFont",{get:function(){var a=this.hqa;return a&&!this.GetState(Q.ThemeFont)?a.ThemeFont:this.Ora},set:function(a){this.SetThemeFont(a),this.ClearOOFontNames()},enumerable:!0,configurable:!0}),b.prototype.IsDirtyIncludingParent=function(b){return!(!this.Zpa||!this.Zpa.IsDirtyIncludingParent(b))||a.prototype.IsDirtyIncludingParent.call(this,b)},b.prototype.HasOwnFont=function(){return this.IsDirty(Q.Name)||this.IsDirty(Q.ThemeFont)},b.prototype.OnParentChanged=function(a){this.hqa=a,this.Zpa&&(this.Zpa.ParentStateful=a&&a.FillInternal)},b.prototype.GetOwnFont=function(){return this.Ora===k.ThemeFont.None?this.Cj:this.xc.Yra(this.Ora)},b.prototype.SetFont=function(a){var b=this;a===F.CHART_CS_HEAD_FONT||a===F.CHART_EA_HEAD_FONT||a===F.CHART_LATIN_HEAD_FONT?b.SetThemeFont(k.ThemeFont.Major):a===F.CHART_CS_BODY_FONT||a===F.CHART_EA_BODY_FONT||a===F.CHART_LATIN_BODY_FONT?b.SetThemeFont(k.ThemeFont.Minor):(b.Cj=a,b.SetState(Q.Name,!0),b.Ora=k.ThemeFont.None,b.SetState(Q.ThemeFont,!1))},b.prototype.SetThemeFont=function(a){var b=this;b.Ora=a,b.SetState(Q.ThemeFont,!0),b.Cj=L,b.SetState(Q.Name,!1)},b.prototype.ClearOOFontNames=function(){this.Qra=L,this.Rra=L,this.Pra=L},b.prototype.GetActualFormat=function(){var a,c,d=this,e=new b(d.xc);for(a in Q)if(c=Q[a],this.IsDirty(c))switch(c){case Q.Bold:e.Bold=this.Bold;break;case Q.Italic:e.Italic=this.Italic;break;case Q.Name:e.Name=this.Name;break;case Q.Size:e.Size=this.Size;break;case Q.Strikethrough:e.Strikethrough=this.Strikethrough;break;case Q.Subscript:e.Superscript=this.Superscript;break;case Q.Superscript:e.Subscript=this.Subscript;break;case Q.ThemeFont:e.ThemeFont=this.ThemeFont;break;case Q.Underline:e.Underline=this.Underline}return e},Object.defineProperty(b.prototype,"FillInternal",{get:function(){var a=this;return a.Zpa||(a.Zpa=new i.FillFormat(a.xc,a.hqa&&a.hqa.FillInternal)),a.Zpa},enumerable:!0,configurable:!0}),b.prototype.TextCharacterProperties_FromOOModel=function(a){var b,c=this;c.SuspendClearChildrenState(),c.Zra=a,H(a.latin)||(c.Qra=a.latin.typeface),H(a.ea)||(c.Pra=a.ea.typeface),H(a.cs)||(c.Rra=a.cs.typeface),c.Qra?c.SetFont(c.Qra):c.Pra?c.SetFont(c.Pra):c.Rra&&c.SetFont(c.Rra),H(a.sz)||(b=a.sz,c.Oz!==b&&(c.Size=b)),H(a.b)||(c.Bold=a.b),H(a.i)||(c.Italic=a.i),H(a.strike)||(c.Strikethrough=a.strike===k.ST_TextStrikeType.sngStrike||a.strike===k.ST_TextStrikeType.dblStrike),H(a.u)||(c.Underline=a.u),H(a.baseline)||0===a.baseline?c.Subscript=!1:c.Subscript=!0,H(a.solidFill)?H(a.noFill)?H(a.blipFill)?H(a.gradFill)?H(a.pattFill)?c.SetFillField(L):c.FillInternal.FromOOModel(a.pattFill,k.ColorFillType.PatternFillProperties):c.FillInternal.FromOOModel(a.gradFill,k.ColorFillType.GradientFillProperties):c.FillInternal.FromOOModel(a.blipFill,k.ColorFillType.BlipFillProperties):c.FillInternal.Color.ColorType=k.SolidColorType.None:c.FillInternal.FromOOModel(a.solidFill,k.ColorFillType.SolidColorFillProperties),c.ResumeClearChilrenState()},b.prototype.TextCharacterProperties_FromSJSOOModel=function(a){var b,c,d=this;d.SuspendClearChildrenState(),H(a.latin)||(d.Qra=a.latin.typeface),H(a.ea)||(d.Pra=a.ea.typeface),H(a.cs)||(d.Rra=a.cs.typeface),d.Qra?d.SetFont(d.Qra):d.Pra?d.SetFont(d.Pra):d.Rra&&d.SetFont(d.Rra),H(a.sz)||(b=o(l(a.sz)/100),d.Oz!==b&&(d.Size=b)),H(a.b)||(d.Bold=m(a.b)),H(a.i)||(d.Italic=m(a.i)),H(a.strike)||(d.Strikethrough=k.ST_TextStrikeType[a.strike]===k.ST_TextStrikeType.sngStrike||k.ST_TextStrikeType[a.strike]===k.ST_TextStrikeType.dblStrike),H(a.u)||(d.Underline=k.ST_TextUnderlineType[a.u]),d.Subscript=!1,c=a.solidFill||a.solidFill,H(c)?H(a.noFill)?H(a.blipFill)?H(a.gradFill)?H(a.pattFill)?d.SetFillField(L):d.FillInternal.FromSJSOOModel(a.pattFill,k.ColorFillType.PatternFillProperties):d.FillInternal.FromSJSOOModel(a.gradFill,k.ColorFillType.GradientFillProperties):d.FillInternal.FromSJSOOModel(a.blipFill,k.ColorFillType.BlipFillProperties):d.FillInternal.Color.ColorType=k.SolidColorType.None:d.FillInternal.FromSJSOOModel(c,k.ColorFillType.SolidColorFillProperties),
d.ResumeClearChilrenState()},b.prototype.AdjustStateful=function(a,b){H(a)||(a.SetParentForChildren(b),H(b)||(b.ParentStateful=a.ParentStateful),a.ParentStateful=L)},b.prototype.SetFillField=function(a){this.AdjustStateful(this.Zpa,a),this.Zpa=a},b.prototype.TextCharacterProperties_ToOOModel=function(){var a,b,c,d,e=this;return e.IsDirtyIncludingParent(!0)?(a=e.Zra||{},e.IsPropDirtyIncludingParent(Q.Name,!0)?(b=e.Name,H(a.latin)&&(a.latin={}),a.latin.typeface=b):e.IsPropDirtyIncludingParent(Q.ThemeFont,!0)&&e.ThemeFont!==k.ThemeFont.None?(H(a.latin)&&(a.latin={}),a.latin.typeface=e.ThemeFont===k.ThemeFont.Major?F.CHART_LATIN_HEAD_FONT:F.CHART_LATIN_BODY_FONT):(e.Qra||e.Pra||e.Rra)&&(e.Qra&&(H(a.latin)&&(a.latin={}),a.latin.typeface=e.Qra),e.Pra&&(H(a.ea)&&(a.ea={}),a.ea.typeface=e.Pra),e.Rra&&(H(a.cs)&&(a.cs={}),a.cs.typeface=e.Rra)),e.IsPropDirtyIncludingParent(Q.Size,!0)&&e.Size>1?a.sz=e.Size:delete a.sz,e.IsPropDirtyIncludingParent(Q.Bold,!0)&&(a.b=e.Bold),e.IsPropDirtyIncludingParent(Q.Italic,!0)&&(a.i=e.Italic),e.IsPropDirtyIncludingParent(Q.Strikethrough,!0)&&(a.strike=e.Strikethrough?k.ST_TextStrikeType.sngStrike:k.ST_TextStrikeType.noStrike),e.IsPropDirtyIncludingParent(Q.Underline,!0)&&(a.u=e.Underline),e.Subscript&&H(a.baseline)?a.baseline=-25e3:e.Superscript&&H(a.baseline)?a.baseline=3e4:e.Subscript||e.Superscript||delete a.baseline,E(a),!H(e.Zpa)&&e.Zpa.IsDirtyIncludingParent(!0)&&(c=e.Zpa.ToOOModel(),d=c.colorFillType,d===k.ColorFillType.SolidColorFillProperties?a.solidFill=c:d===k.ColorFillType.PatternFillProperties?a.pattFill=c:d===k.ColorFillType.GradientFillProperties?a.gradFill=c:d===k.ColorFillType.BlipFillProperties?a.blipFill=c:d===k.ColorFillType.NoFillProperties&&(a.noFill=!0),delete c.colorFillType),a):{}},b.prototype.TextCharacterProperties_ToSJSOOModel=function(){var a,b,c=this;return c.IsDirtyIncludingParent(!0)?(a={},!H(c.Zpa)&&c.Zpa.IsDirtyIncludingParent(!0)&&c.Zpa.ToSJS_FillGroup(a),c.IsPropDirtyIncludingParent(Q.Name,!0)?(b=c.Name,H(a.latin)&&(a.latin={}),a.latin.typeface=v(b)):c.IsPropDirtyIncludingParent(Q.ThemeFont,!0)&&c.ThemeFont!==k.ThemeFont.None?(H(a.latin)&&(a.latin={}),a.latin.typeface=v(c.ThemeFont===k.ThemeFont.Major?F.CHART_LATIN_HEAD_FONT:F.CHART_LATIN_BODY_FONT)):(c.Qra||c.Pra||c.Rra)&&(c.Qra&&(H(a.latin)&&(a.latin={}),a.latin.typeface=v(c.Qra)),c.Pra&&(H(a.ea)&&(a.ea={}),a.ea.typeface=v(c.Pra)),c.Rra&&(H(a.cs)&&(a.cs={}),a.cs.typeface=v(c.Rra))),c.IsPropDirtyIncludingParent(Q.Size,!0)&&c.Size>1?a.sz=Math.round(100*f.ExcelHelper.pixelToPoint(c.Size))+"":delete a.sz,c.IsPropDirtyIncludingParent(Q.Bold,!0)&&(a.b=c.Bold?"1":"0"),c.IsPropDirtyIncludingParent(Q.Italic,!0)&&(a.i=c.Italic?"1":"0"),c.IsPropDirtyIncludingParent(Q.Strikethrough,!0)&&(a.strike=c.Strikethrough?k.ST_TextStrikeType[1]:k.ST_TextStrikeType[0]),c.IsPropDirtyIncludingParent(Q.Underline,!0)&&(a.u=k.ST_TextUnderlineType[c.Underline]),c.Subscript&&H(a.baseline)?a.baseline=-25e3:c.Superscript&&H(a.baseline)?a.baseline=3e4:c.Subscript||c.Superscript||delete a.baseline,a):{}},b.prototype.FromOOModel=function(a){var b=this;b.Bold=a.Bold,b.Italic=a.Italic,b.Name=a.Name,a.Scheme!==k.ThemeFont.None&&(b.ThemeFont=a.Scheme),b.Size=a.Size,b.Underline=D.ConvertToTextUnderlineType(a.Underline),b.Strikethrough=a.Strike,b.Subscript=(a.VertAlign&k.VertAlignType.Subscript)===k.VertAlignType.Subscript,b.Superscript=(a.VertAlign&k.VertAlignType.Superscript)===k.VertAlignType.Superscript,b.FillInternal.ColorInternal.ColorData_FromOOModel(a.Color)},b.prototype.FromSJSOOModel=function(a){this.FromOOModel(a)},b.prototype.ToOOModel=function(){var a,b=this,c=new j.FontData;return c.Bold=b.Bold,c.Italic=b.Italic,c.Name=b.Name,c.Scheme=b.ThemeFont,c.Size=b.Size,c.Underline=D.ToUnderlineType(b.Underline),c.Strike=b.Strikethrough,b.Subscript?c.VertAlign=k.VertAlignType.Subscript:b.Superscript&&(c.VertAlign=k.VertAlignType.Superscript),a=b.Zpa,a&&a.ColorInternal.IsDirtyIncludingParent(!0)&&a.ColorInternal.ColorType!==k.SolidColorType.None&&(c.Color=a.ColorInternal.ColorData_ToOOModel()),c},b.prototype.ToSJSOOModel=function(){this.ToOOModel()},b}(g.StatefulBase),b.FontFormat=R,S=function(){function a(a,b){var c=this;c.xc=a,c.$ra=b,c._font=new R(a),c._font.ParentStateful=b.Font}return Object.defineProperty(a.prototype,"Font",{get:function(){return this._font},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Text",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"IsCustomText",{get:function(){return!1},enumerable:!0,configurable:!0}),a.prototype.Delete=function(){this.$ra.DeleteElement(this),this.$ra=L},a.prototype.FromOOModel=function(a){},a.prototype.ToOOModel=function(){},a.prototype.ToSJSOOModel=function(){},a}(),b.DrawingTextElement=S,T=function(a){$(b,a);function b(b,c,d){var e=a.call(this,b,d)||this,f=e;return f._ra=L,f.niK=L,f._text=c,f.xc=b,f.elementType=k.TextParagraphElementType.RegularTextRun,e}return Object.defineProperty(b.prototype,"Text",{get:function(){return this._text},set:function(a){this._text=a},enumerable:!0,configurable:!0}),b.prototype.FromOOModel=function(a){var b=this;b._ra=a,b._text=a.t,H(a.rPr)?b._font=new R(b.xc,b._font.ParentStateful):b._font.TextCharacterProperties_FromOOModel(a.rPr)},b.prototype.FromSJSOOModel=function(a){var b=this;b.niK=a,b._text=t(a.t.v_),H(a.rPr)?b._font=new R(b.xc,b._font.ParentStateful):b._font.TextCharacterProperties_FromSJSOOModel(a.rPr)},b.prototype.ToOOModel=function(){var a=this._ra||{elementType:k.TextParagraphElementType.RegularTextRun};return a.t=this.Text,a.rPr=this._font.TextCharacterProperties_ToOOModel(),a},b.prototype.ToSJSOOModel=function(){var a=this.niK||{};return a.rPr=this._font.TextCharacterProperties_ToSJSOOModel(),a.t={v_:u(this.Text)},a},b}(S),b.DrawingTextRun=T,U=function(a){$(b,a);function b(b,c,d){var e=a.call(this,b,d)||this,f=e;return f.Nc=c,f.Hpa=b,f.asa=new O(f.Hpa),f.elementType=k.TextParagraphElementType.TextField,e}return Object.defineProperty(b.prototype,"Type",{get:function(){return this.Nc},set:function(a){this.Nc=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Text",{get:function(){return this.Type===k.TextFieldType.TxLink?this.asa.ReferingText:D.GetTextFieldTypeText(this.Type)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Worksheet",{get:function(){return this.Hpa&&this.Hpa.Parent},enumerable:!0,configurable:!0}),b.prototype.FromOOModel=function(a){var b=this;b.Lqa=a,b.Type=D.GetTextFieldType(a.type),H(a.rPr)?b._font=new R(b.xc,b._font.ParentStateful):b._font.TextCharacterProperties_FromOOModel(a.rPr)},b.prototype.FromSJSOOModel=function(a){var b=this;b.BhK=a,b.Type=D.GetTextFieldType(a.type),H(a.rPr)?b._font=new R(b.xc,b._font.ParentStateful):b._font.TextCharacterProperties_FromSJSOOModel(a.rPr)},b.prototype.wLb=function(){var a="{"+this.xLb(8)+"-"+this.xLb(4)+"-"+this.xLb(4)+"-"+this.xLb(4)+"-"+this.xLb(12)+"}";return a.toUpperCase()},b.prototype.xLb=function(a){return Math.random().toString(16).slice(-a)},b.prototype.ToOOModel=function(){var a=this,b=a.Lqa||{elementType:k.TextParagraphElementType.TextField},c=/{[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}}/;return(H(b.id)||b.id&&!c.test(b.id))&&(b.id=this.wLb()),b.type=D.GetTextFieldTypeString(a.Type),H(b.rPr)&&(b.rPr={}),b.rPr=a._font.TextCharacterProperties_ToOOModel(),b.t=a.Text,b},b.prototype.ToSJSOOModel=function(){var a=this,b=a.BhK||{},c=/{[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}}/;return(H(b.id)||b.id&&!c.test(b.id))&&(b.id=this.wLb()),b.type=D.GetTextFieldTypeString(a.Type),H(b.rPr)&&(b.rPr={}),b.rPr=a._font.TextCharacterProperties_ToSJSOOModel(),b.t=u(a.Text),b},b.prototype.UpdateTextByFormulas=function(a,b){this.asa.UpdateTextByFormulas(a,b)},b}(S),b.DrawingTextField=U,V=function(a){$(b,a);function b(b,c){var d=a.call(this,b,c)||this;return d.elementType=k.TextParagraphElementType.TextLineBreak,d}return Object.defineProperty(b.prototype,"Text",{get:function(){return"\r\n"},enumerable:!0,configurable:!0}),b.prototype.FromOOModel=function(a){this.Lqa=a},b.prototype.FromSJSOOModel=function(a){this.BhK=a},b.prototype.ToOOModel=function(){return this.Lqa||{elementType:k.TextParagraphElementType.TextLineBreak}},b.prototype.ToSJSOOModel=function(){return this.BhK||{}},b}(S),b.DrawingLineBreak=V,W=function(){function a(a,b){var c=this;c.bsa=L,c.oiK=L,c.csa=" ",c.xc=a,c.Lpa=b,c._font=new R(a),c._font.ParentStateful=c.Lpa.Font,c.rM=[]}return Object.defineProperty(a.prototype,"SplitSpaceFlag",{get:function(){return this.csa},set:function(a){this.csa=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Algn",{get:function(){return this.llK},set:function(a){this.llK=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Text",{get:function(){var a,b,c,d="";for(a=0,b=this.rM;a<b.length;a++)c=b[a],H(c.Text)||(d+=c.Text);return d},set:function(a){this.Clear(),this.AddRun(a)},enumerable:!0,configurable:!0}),a.prototype.Get=function(a){return this.rM[a]},Object.defineProperty(a.prototype,"Count",{get:function(){return this.rM.length},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Font",{get:function(){return this._font},enumerable:!0,configurable:!0}),a.prototype.AddRun=function(a,b){return this.AddRunInternal(a,b)},a.prototype.AddField=function(a){return this.AddFieldInternal(a)},a.prototype.Clear=function(){var a,b,c;for(a=0,b=this.rM;a<b.length;a++)c=b[a],c.Font.ParentStateful=L;this.rM.length=0},a.prototype.FromOOModel=function(a){var b,c,d,e,f,g,h,i=this;if(i.bsa=a,a.pPr&&i.FromParagraphProperties(a.pPr),a.elements)for(b=a.elements.length,c=i.rM=[],d=i.xc,e=0;e<b;e++)f=a.elements[e],g=f.elementType,h=void 0,g===k.TextParagraphElementType.RegularTextRun?h=i.CreateDrawingTextRun(d,f.t):g===k.TextParagraphElementType.TextLineBreak?h=i.CreateDrawingLineBreak(d):g===k.TextParagraphElementType.TextField&&(h=i.CreateDrawingTextField(d,D.GetTextFieldType(f.type))),h&&(h.FromOOModel(f),c.push(h))},a.prototype.FromSJSOOModel=function(a){var b,c,d=this;d.oiK=a,b=d.rM=[],c=d.xc,a.c_&&a.c_.forEach(function(a){var e,f;a.pPr?d.FromSJSParagraphProperties(a.pPr):a.r?(e=d.CreateDrawingTextRun(c,a.r.t?a.r.t.v_:""),f=a.r):a.br?(e=d.CreateDrawingLineBreak(c),f=a.br):a.fld&&(e=d.CreateDrawingTextField(c,D.GetTextFieldType(a.fld.type)),f=a.fld),e&&(e.FromSJSOOModel(f),b.push(e))})},a.prototype.FromParagraphProperties=function(a){if(a){var b=this;H(a.algn)||(b.llK=a.algn),a.defRPr&&b._font.TextCharacterProperties_FromOOModel(a.defRPr)}},a.prototype.FromSJSParagraphProperties=function(a){if(a){var b=this;H(a.algn)||(b.llK=k.ST_TextAlignType[a.algn]),a.defRPr&&b._font.TextCharacterProperties_FromSJSOOModel(a.defRPr)}},a.prototype.ToParagraphProperties=function(a){var b=this;return H(b.llK)||(a.algn=b.llK),H(b._font)||(a.defRPr=b._font.TextCharacterProperties_ToOOModel()),a},a.prototype.ToSJSParagraphProperties=function(a){var b=this;return H(b.llK)||0===b.llK||(a.algn=k.ST_TextAlignType[b.llK]),H(b._font)||(a.defRPr=b._font.TextCharacterProperties_ToSJSOOModel()),a},a.prototype.AddRunInternal=function(a,b){var c,d,e=this;return b===M&&(b=-1),c=e.CreateDrawingTextRun(e.xc,a),d=this.rM,b<0||b>=d.length?d.push(c):d.splice(b,0,c),c},a.prototype.AddFieldInternal=function(a){var b=this.CreateDrawingTextField(this.xc,a);return this.rM.push(b),b},a.prototype.ToOOModel=function(){var a,b,c,d,e=this,f=e.bsa||{elements:[]};for(f.pPr=e.ToParagraphProperties(f.pPr||{}),a=f.elements=[],b=0,c=e.rM,d=c.length;b<d;b++)a.push(c[b].ToOOModel());return(e.xc.DrawingType===k.DrawingType.Chart||H(e.bsa))&&H(f.endParaRPr)&&(f.endParaRPr={}),f},a.prototype.ToSJSOOModel=function(){var a,b,c,d,e,f=this,g=f.oiK||{n_:"p",c_:[]},h=s(g,"pPr")||{},i=s(g,"endParaRPr")||{};for(g.c_=[],f.ToSJSParagraphProperties(h),g.c_.push({pPr:h}),a=0,b=f.rM,c=b.length;a<c;a++)d=b[a].elementType,e=b[a].ToSJSOOModel(),d===k.TextParagraphElementType.RegularTextRun?g.c_.push({r:e}):d===k.TextParagraphElementType.TextLineBreak?g.c_.push({br:e}):d===k.TextParagraphElementType.TextField&&g.c_.push({fld:e});return g.c_.push({endParaRPr:i}),g},a.prototype.To2016ChartOOModel=function(){var a,b,c,d,e,f=this,g=f.bsa||{elements:[]};for(g.pPr||(g.pPr={}),a=g.pPr,H(f._font)||(a.defRPr=f._font.TextCharacterProperties_ToOOModel()),b=g.elements=[],c=0,d=f.rM,e=d.length;c<e;c++)b.push(d[c].ToOOModel());return H(f._font)||(g.endParaRPr=f._font.TextCharacterProperties_ToOOModel()),g},a.prototype.To2016ChartSJSOOModel=function(){var a=this,b=a.ToSJSOOModel();return H(a._font)||(b.c_[b.c_.length-1].endParaRPr=a._font.TextCharacterProperties_ToSJSOOModel()),b},a.prototype.Delete=function(){var a,b=this;for(a=b.rM.length-1;a>=0;a--)b.DeleteElement(b.rM[a]);b.Lpa.DeleteParagraph(b),b.Lpa=L},a.prototype.DeleteElement=function(a){a.Font.ParentStateful=L;var b=this.rM.indexOf(a);b>=0&&this.rM.splice(b,1)},a.prototype.CreateDrawingTextRun=function(a,b){return new T(a,b,this)},a.prototype.CreateDrawingLineBreak=function(a){return new V(a,this)},a.prototype.CreateDrawingTextField=function(a,b){return new U(a,b,this)},a}(),b.DrawingTextParagraph=W,X=function(){function a(a,b){this.dsa=[],this.esa=L,this.DhK=L,this.xc=a,this.Opa=b,this._font=new R(a,L,b),this.kO=void 0,this.mlK={top:void 0,bottom:void 0,left:void 0,right:void 0},this.nlK=void 0,this.olK=void 0,this.plK=void 0,this.FXa=void 0,this.elK=void 0,this.flK=void 0}return Object.defineProperty(a.prototype,"Text",{get:function(){var a,b,c,d="";for(a=0,b=this.dsa;a<b.length;a++)c=b[a],""!==d&&(d+="\r\n"),d+=c.Text;return d},set:function(a){this.Clear(),this.AddParagraph(a)},enumerable:!0,configurable:!0}),a.prototype.Get=function(a){return this.dsa[a]},Object.defineProperty(a.prototype,"Count",{get:function(){return this.dsa.length},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Font",{get:function(){return this._font},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Rotation",{get:function(){return this.kO},set:function(a){this.kO=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Inset",{get:function(){return this.mlK},set:function(a){this.mlK=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"anchorCtr",{get:function(){return this.nlK},set:function(a){this.nlK=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"anchor",{get:function(){return this.olK},set:function(a){this.olK=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"vert",{get:function(){return this.plK},set:function(a){this.plK=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"wrap",{get:function(){return this.FXa},set:function(a){this.FXa=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"horzOverflow",{get:function(){return this.elK},set:function(a){this.elK=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"vertOverflow",{get:function(){return this.flK},set:function(a){this.flK=a},enumerable:!0,configurable:!0}),a.prototype.setFontColor=function(a,b){var c,d=this,e=d.dsa.length;for(d._font&&d._font.Color.setColor(a,b),c=0;c<e;c++)d.dsa[c].Font.Color.setColor(a,b)},a.prototype.setFontTransparency=function(a){var b,c=this,d=c.dsa.length;for(c._font&&(c._font.Color.Transparency=a),b=0;b<d;b++)c.dsa[b].Font.Color.Transparency=a},a.prototype.updateFont=function(a,b,c,d){var e=this,f=[e._font];e.dsa.forEach(function(a){f.push(a.Font)}),f.forEach(function(e){e&&(e.Name=a,e.Size=b,e.Bold=c,e.Italic=d)})},a.prototype.AddParagraph=function(a,b){var c,d;return b===M&&(b=-1),c=this.CreateDrawingTextParagraph(this.xc),H(a)||c.AddRun(a),d=this.dsa,b<0||b>=d.length?d.push(c):d.splice(b,0,c),c},a.prototype.Clear=function(){var a,b,c;for(a=0,b=this.dsa;a<b.length;a++)c=b[a],c.Font.ParentStateful=L;this.dsa.length=0},a.prototype.ToOOModel=function(a){var b,c,d,e,f,g=this,h=g.esa||{p:[]},i=this.dsa,j=i.length;if(0===j&&!this._font.IsDirtyIncludingParent())return L;if(b=h.p=[],j>0)for(c=0;c<j;c++)d=i[c],b.push(a?d.To2016ChartOOModel():d.ToOOModel());else e=g.CreateDrawingTextParagraph(g.xc),f=e.ToOOModel(),f.pPr.defRPr=g._font.TextCharacterProperties_ToOOModel(),b.push(f);return h.bodyPr=g.glK(h.bodyPr||{}),H(h.lstStyle)&&(h.lstStyle={}),h},a.prototype.ToSJSOOModel=function(a){var b,c,d,e,f,g=this,h=g.DhK||{bodyPr:{},p:[]},i=this.dsa,j=i.length;if(0===j&&!this._font.IsDirtyIncludingParent())return L;if(h.bodyPr=g.hlK(h.bodyPr||{}),b=h.p=[],j>0)for(c=0;c<j;c++)d=i[c],b.push(a?d.To2016ChartSJSOOModel():d.ToSJSOOModel());else e=g.CreateDrawingTextParagraph(g.xc),f=e.ToSJSOOModel(),f.c_[0].pPr.defRPr=g._font.TextCharacterProperties_ToSJSOOModel(),b.push(f);return h},a.prototype.FromOOModel=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this;for(o.esa=a,b=0,c=o.dsa;b<c.length;b++)d=c[b],d.Clear();if(o.dsa.length=0,e=new R(o.xc,L,o.Opa),f=o._font,f&&(f.SetParentForChildren(e),e.ParentStateful=f.ParentStateful,f.ParentStateful=L),o._font=e,a.p&&a.p.length)for(g=a.p[0].pPr,h=a.p[0].elements&&a.p[0].elements[0]&&a.p[0].elements[0].rPr,i=a.p[0].endParaRPr,j=void 0,g&&g.defRPr&&!C(g.defRPr)?j=_({},g.defRPr,h):i&&!C(i)?j=i:h&&!C(h)&&(j=h),j&&o._font.TextCharacterProperties_FromOOModel(j),k=0,l=a.p;k<l.length;k++)m=l[k],n=o.CreateDrawingTextParagraph(o.xc),n.FromOOModel(m),o.dsa.push(n);o.ilK(a.bodyPr)},a.prototype.FromSJSOOModel=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=this;for(q.DhK=a,b=0,c=q.dsa;b<c.length;b++)d=c[b],d.Clear();if(q.dsa.length=0,e=new R(q.xc,L,q.Opa),f=q._font,f&&(f.SetParentForChildren(e),e.ParentStateful=f.ParentStateful,f.ParentStateful=L),q._font=e,a.p=a.p&&[].concat(a.p),a.p&&a.p.length)for(g=a.p[0],h=s(g,"pPr"),i=s(g,"r")||s(g,"br")||s(g,"fld"),j=i&&i.rPr,k=s(g,"endParaRPr"),l=void 0,h&&h.defRPr&&!C(h.defRPr)?l=_({},h.defRPr,j):k&&!C(k)?l=k:j&&!C(j)&&(l=j),l&&q._font.TextCharacterProperties_FromSJSOOModel(l),m=0,n=a.p;m<n.length;m++)o=n[m],p=q.CreateDrawingTextParagraph(q.xc),p.FromSJSOOModel(o),q.dsa.push(p);q.jlK(a.bodyPr)},a.prototype.ilK=function(a){var b,c,d,e,f,g,h,i,j;a&&(b=this,c=a.rot,H(c)||(b.kO=c),d=a.anchorCtr,H(d)||(b.nlK=d),e=a.anchor,H(e)||(b.olK=e),f=a.vert,H(f)||(b.plK=f),g=a.wrap,H(g)||(b.FXa=g),h=a.horzOverflow,H(h)||(b.elK=h),i=a.vertOverflow,H(i)||(b.flK=i),j=b.mlK,H(a.tIns)||(j.top=p(a.tIns,6)),H(a.bIns)||(j.bottom=p(a.bIns,6)),H(a.lIns)||(j.left=p(a.lIns,6)),H(a.rIns)||(j.right=p(a.rIns,6)))},a.prototype.glK=function(a){var b,c,d,e,f,g,h,i=this,j=i.Rotation;return H(j)||(a.rot=j),b=i.nlK,H(b)||(a.anchorCtr=b),c=i.olK,H(c)||(a.anchor=c),d=i.plK,H(d)||(a.vert=d),e=i.FXa,H(e)||(a.wrap=e),f=i.elK,H(f)||(a.horzOverflow=f),g=i.flK,H(g)||(a.vertOverflow=g),h=i.mlK,H(h.top)||(a.tIns=q(h.top)),H(h.bottom)||(a.bIns=q(h.bottom)),H(h.left)||(a.lIns=q(h.left)),H(h.right)||(a.rIns=q(h.right)),a},a.prototype.jlK=function(a){var b,c,d=this;a.rot&&(b=ba(a.rot),H(b)||b===-6e7||(d.kO=b/6e4)),H(a.anchorCtr)||(d.nlK=m(a.anchorCtr)),H(a.anchor)||(d.olK=k.ST_TextAnchoringType[a.anchor]),H(a.vert)||(d.plK=k.ST_TextVerticalType[a.vert]),H(a.wrap)||(d.FXa=k.ST_TextWrappingType[a.wrap]),H(a.horzOverflow)||(d.elK=k.ST_TextHorzOverflowType[a.horzOverflow]),H(a.vertOverflow)||(d.flK=k.ST_TextVertOverflowType[a.vertOverflow]),c=d.mlK,H(a.tIns)||(c.top=p(l(a.tIns),6)),H(a.bIns)||(c.bottom=p(l(a.bIns),6)),H(a.lIns)||(c.left=p(l(a.lIns),6)),H(a.rIns)||(c.right=p(l(a.rIns),6))},a.prototype.hlK=function(a){var b,c,d,e,f,g=this,h=g.Rotation;return H(h)||0===h||(a.rot=6e4*parseInt(h+"",10)),b=g.mlK,H(b.top)||(c=q(b.top),c!==w&&(a.tIns=c)),H(b.bottom)||(d=q(b.bottom),d!==w&&(a.bIns=d)),H(b.left)||(e=q(b.left),e!==x&&(a.lIns=e)),H(b.right)||(f=q(b.right),f!==x&&(a.rIns=f)),g.nlK===!0&&(a.anchorCtr="1"),H(g.olK)||0===g.olK||(a.anchor=k.ST_TextAnchoringType[g.olK]),H(g.plK)||(a.vert=k.ST_TextVerticalType[g.plK]),H(g.FXa)||0===g.FXa||(a.wrap=k.ST_TextWrappingType[g.FXa]),H(g.horzOverflow)||0===g.horzOverflow||(a.horzOverflow=k.ST_TextHorzOverflowType[g.horzOverflow]),H(g.vertOverflow)||0===g.vertOverflow||(a.vertOverflow=k.ST_TextVertOverflowType[g.vertOverflow]),a},a.prototype.Delete=function(){for(var a=this.dsa,b=a.length-1;b>=0;b--)this.DeleteParagraph(a[b])},a.prototype.DeleteParagraph=function(a){a.Font.ParentStateful=L;var b=this.dsa.indexOf(a);b>=0&&this.dsa.splice(b,1)},a.prototype.CreateDrawingTextParagraph=function(a){return new W(a,this)},a}(),b.DrawingTextBody=X,Y=function(a){$(b,a);function b(b,c){var d=a.call(this)||this,e=d;return e.Format1=b,e.Format2=c,d}return Object.defineProperty(b.prototype,"Stateful1",{get:function(){return this.Format1},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Stateful2",{get:function(){return this.Format2},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Brightness",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(k.ColorFormatStates.Brightness,!1)?a.Format2.Brightness:a.Format1.Brightness},set:function(a){this.Format1.Brightness=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ColorType",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(k.ColorFormatStates.ColorType,!1)?a.Format2.ColorType:a.Format1.ColorType},set:function(a){this.Format1.ColorType=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ObjectThemeColor",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(k.ColorFormatStates.ObjectThemeColor,!1)?a.Format2.ObjectThemeColor:a.Format1.ObjectThemeColor},set:function(a){this.Format1.ObjectThemeColor=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"RGB",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(k.ColorFormatStates.RGB,!1)?a.Format2.RGB:a.Format1.RGB},set:function(a){this.Format1.RGB=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"TintAndShade",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(k.ColorFormatStates.TintAndShade,!1)?a.Format2.TintAndShade:a.Format1.TintAndShade},set:function(a){this.Format1.TintAndShade=a},enumerable:!0,configurable:!0}),b.prototype.GetState=function(){},b.prototype.SetState=function(){},b.prototype.IsDirtyIncludingParent=function(){},b.prototype.IsPropDirtyIncludingParent=function(a,b){return this.Stateful1.IsPropDirtyIncludingParent(a,b)||this.Stateful2.IsPropDirtyIncludingParent(a,b)},b.prototype.Dirty=function(){},b.prototype.UnDirty=function(){},b.prototype.SuspendClearChildrenState=function(){},b.prototype.ResumeClearChilrenState=function(){},b.prototype.AddChildInternal=function(){},b.prototype.RemoveChildInternal=function(){},b}(g.StatefulBase),b.ComboColorFormat=Y,Z=function(a){$(b,a);function b(b,c){var d=a.call(this)||this,e=d;return e.Format1=b,e.Format2=c,d}return Object.defineProperty(b.prototype,"Stateful1",{get:function(){return this.Format1},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Stateful2",{get:function(){return this.Format2},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Bold",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(Q.Bold,!1)?a.Format2.Bold:a.Format1.Bold},set:function(a){this.Format1.Bold=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Color",{get:function(){return new Y(this.Format1.Color,this.Format2.Color)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Italic",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(Q.Italic,!1)?a.Format2.Bold:a.Format1.Bold},set:function(a){this.Format1.Bold=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Name",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(Q.Name,!1)?a.Format2.Name:a.Format1.Name},set:function(a){this.Format1.Name=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Size",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(Q.Size,!1)?a.Format2.Size:a.Format1.Size},set:function(a){this.Format1.Size=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Strikethrough",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(Q.Strikethrough,!1)?a.Format2.Strikethrough:a.Format1.Strikethrough},set:function(a){this.Format1.Strikethrough=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Subscript",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(Q.Subscript,!1)?a.Format2.Subscript:a.Format1.Subscript},set:function(a){this.Format1.Subscript=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Superscript",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(Q.Superscript,!1)?a.Format2.Superscript:a.Format1.Superscript},set:function(a){this.Format1.Superscript=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ThemeFont",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(Q.ThemeFont,!1)?a.Format2.ThemeFont:a.Format1.ThemeFont},set:function(a){this.Format1.ThemeFont=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Underline",{get:function(){var a=this;return!H(a.Format2)&&a.Stateful2.IsPropDirtyIncludingParent(Q.Underline,!1)?a.Format2.Underline:a.Format1.Underline},set:function(a){this.Format1.Underline=a},enumerable:!0,configurable:!0}),b.prototype.GetState=function(){},b.prototype.SetState=function(){},b.prototype.IsDirtyIncludingParent=function(){},b.prototype.IsPropDirtyIncludingParent=function(a,b){return this.Stateful1.IsPropDirtyIncludingParent(a,b)||this.Stateful2.IsPropDirtyIncludingParent(a,b)},b.prototype.Dirty=function(){},b.prototype.UnDirty=function(){},b.prototype.SuspendClearChildrenState=function(){},b.prototype.ResumeClearChilrenState=function(){},b.prototype.AddChildInternal=function(){},b.prototype.RemoveChildInternal=function(){},b}(g.StatefulBase),b.ComboFontFormat=Z},"./dist/plugins/floatingObject/drawing/gradient.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/floatingObject/drawing/common.js"),e=c("./dist/plugins/floatingObject/drawing/color.js"),f=c("./dist/plugins/floatingObject/drawing/colorFormat.js"),g=c("./dist/plugins/floatingObject/drawing/drawingInterface.js"),h=c("Core"),i=d.ShapeConstants.PositionConver,j=d.ShapeUtility,k=d.meK,l=void 0,m=function(){function a(a){this.nzb=a,this.tE=new f.ColorFormat(this.nzb)}return Object.defineProperty(a.prototype,"Color",{get:function(){return this.tE},set:function(a){this.tE=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Position",{get:function(){return this.SH},set:function(a){this.SH=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Transparency",{get:function(){return this.tE.Transparency},set:function(a){this.tE.Transparency=a},enumerable:!0,configurable:!0}),a.prototype.FromOOModel=function(a){this.Position=a.pos/i,this.tE.FromOOModel(a)},a.prototype.FromSJSOOModel=function(a){var b=h.NodeHelper.pca(a.pos,i);this.Position=b/i,this.tE.FromSJSOOModel(a)},a.prototype.ToOOModel=function(){var a=this.tE.ToOOModel();return a.pos=Math.round(this.Position*i),a},a.prototype.ToSJSOOModel=function(){var a=this.tE.ToSJSOOModel();return delete a.colorFillType,a.pos=Math.round(this.Position*i),a},a}(),b.GradientStop=m,n=function(){function a(a){this.Nqa=a,this.Oqa=[]}return a.prototype.Item=function(a){return this.Oqa[a]},Object.defineProperty(a.prototype,"Count",{get:function(){return this.Oqa.length},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"GradientStopList",{get:function(){return this.Oqa},enumerable:!0,configurable:!0}),a.prototype.Delete=function(a){a===-1&&(a=this.Count-1),this.Oqa.splice(a,1)},a.prototype.Insert=function(a,b,c,d,f){c===l&&(c=0),d===l&&(d=-1),f===l&&(f=0);var g=new m(this.Nqa);g.Color.RGB=e.ARGBColor.FromArgb(a),g.Position=b,g.Transparency=c,g.Color.Brightness=f,d<0?this.Oqa.push(g):this.Oqa.splice(d,0,g)},a.prototype.FromOOModel=function(a){var b,c,d,e;for(b=0,c=a.gs;b<c.length;b++)d=c[b],e=new m(this.Nqa),e.FromOOModel(d),this.GradientStopList.push(e)},a.prototype.FromSJSOOModel=function(a){var b,c,d,e,f=k(a.gs);for(b=0,c=f;b<c.length;b++)d=c[b],e=new m(this.Nqa),e.FromSJSOOModel(d),this.GradientStopList.push(e)},a.prototype.ToOOModel=function(){var a,b,c,d={gs:[]};for(a=0,b=this.Oqa;a<b.length;a++)c=b[a],d.gs.push(c.ToOOModel());return d},a.prototype.ToSJSOOModel=function(){var a,b,c,d={gs:[]};for(a=0,b=this.Oqa;a<b.length;a++)c=b[a],d.gs.push(c.ToSJSOOModel());return d},a}(),b.GradientStops=n;function o(a,b,c){var d=new m(a);return d.Position=b,d.Color=c,d}function p(a){return e.ARGBColor.FromArgb(a)}j.InitGradientStopPresetColor=function(a,b){var c,d,e,h,i,j,k,l,m,n,q,r,s,t=b.GradientStops.GradientStopList;switch(b.PresetGradientType){case g.PresetGradientType.GradientEarlySunset:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(130))),d=o(a,.3,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(6684815))),e=o(a,.64999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(12189798))),h=o(a,.89999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16711680))),i=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16744960))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i);break;case g.PresetGradientType.GradientLateSunset:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(0))),d=o(a,.2,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(64))),e=o(a,.5,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(4194368))),h=o(a,.75,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(9371712))),i=o(a,.89999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15889152))),j=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16760576))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j);break;case g.PresetGradientType.GradientNightfall:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(0))),d=o(a,.39999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(660108))),e=o(a,.7,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(1580231))),h=o(a,.88,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(7341524))),i=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(9190801))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i);break;case g.PresetGradientType.GradientDaybreak:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(6201087))),d=o(a,.39999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8766207))),e=o(a,.7,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(12900075))),h=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16772090))),t.push(c),t.push(d),t.push(e),t.push(h);break;case g.PresetGradientType.GradientHorizon:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(14478325))),d=o(a,.08,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8628163))),e=o(a,.13,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(7770041))),h=o(a,.21001,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8628163))),i=o(a,.52,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215))),j=o(a,.56,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10249571))),k=o(a,.58,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8400941))),l=o(a,.71001,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(12603982))),m=o(a,.94,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15456980))),n=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(5580316))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j),t.push(k),t.push(l),t.push(m),t.push(n);break;case g.PresetGradientType.GradientDesert:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16555979))),d=o(a,.87,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16298057))),e=o(a,.78999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16298057))),h=o(a,.37,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16705522))),
i=o(a,.33,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16339616))),j=o(a,.31,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(12912713))),k=o(a,.17999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(11812485))),l=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16298057))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j),t.push(k),t.push(l);break;case g.PresetGradientType.GradientOcean:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(251048))),d=o(a,.25,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(2217696))),e=o(a,.75,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(34790))),h=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(23743))),t.push(c),t.push(d),t.push(e),t.push(h);break;case g.PresetGradientType.GradientCalmWater:c=o(a,.5,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13421823))),d=o(a,.41001,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10079487))),e=o(a,.32,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10053375))),h=o(a,.195,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13408767))),i=o(a,.8999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10079487))),j=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13421823))),k=o(a,.59,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10079487))),l=o(a,.68,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10053375))),m=o(a,.805,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13408767))),n=o(a,.91001,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10079487))),q=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13421823))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j),t.push(k),t.push(l),t.push(m),t.push(n),t.push(q);break;case g.PresetGradientType.GradientFire:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16773632))),d=o(a,.45,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16742912))),e=o(a,.7,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16712448))),h=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(5048328))),t.push(c),t.push(d),t.push(e),t.push(h);break;case g.PresetGradientType.GradientFog:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8685764))),d=o(a,.53,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13950719))),e=o(a,.83,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13950719))),h=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(9874324))),t.push(c),t.push(d),t.push(e),t.push(h);break;case g.PresetGradientType.GradientMoss:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(14543823))),d=o(a,.25,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10270830))),e=o(a,.5,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(1403667))),h=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(14543823))),i=o(a,.75,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10270830))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i);break;case g.PresetGradientType.GradientPeacock:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(3381759))),d=o(a,.16,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(52428))),e=o(a,.47,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10066431))),h=o(a,.60001,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(3041170))),i=o(a,.71001,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(3355596))),j=o(a,.81,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(1143039))),k=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(26265))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j),t.push(k);break;case g.PresetGradientType.GradientWheat:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16509639))),d=o(a,.17999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16705522))),e=o(a,.36,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16435069))),h=o(a,.61,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16492925))),i=o(a,.82001,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16503964))),j=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16705522))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j);break;case g.PresetGradientType.GradientParchment:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16773073))),d=o(a,.64999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15789013))),e=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13747103))),t.push(c),t.push(d),t.push(e);break;case g.PresetGradientType.GradientMahogany:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(14070172))),d=o(a,.15,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13934188))),e=o(a,.35,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10900776))),h=o(a,.5,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(6696978))),i=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(14070172))),j=o(a,.85,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13934188))),k=o(a,.65,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10900776))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j),t.push(k);break;case g.PresetGradientType.GradientRainbow:c=o(a,.5,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10879915))),d=o(a,.395,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(530939))),e=o(a,.32499,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(1740104))),h=o(a,.24,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16776960))),i=o(a,.135,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15613719))),j=o(a,.6,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15210342))),k=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10879915))),l=o(a,.60501,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(530939))),m=o(a,.67501,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(1740104))),n=o(a,.76,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16776960))),q=o(a,.865,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15613719))),r=o(a,.94,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15210342))),s=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10879915))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j),t.push(k),t.push(l),t.push(m),t.push(n),t.push(q),t.push(r),t.push(s);break;case g.PresetGradientType.GradientRainbowII:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16724889))),d=o(a,.25,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16737843))),e=o(a,.5,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16776960))),h=o(a,.75,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(108431))),i=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(3368703))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i);break;case g.PresetGradientType.GradientGold:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15129772))),d=o(a,.12,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15128458))),e=o(a,.3,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13085772))),h=o(a,.45,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15128458))),i=o(a,.77,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13085772))),j=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15129772))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j);break;case g.PresetGradientType.GradientGoldII:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16508078))),d=o(a,.13,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(12423722))),e=o(a,.21001,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(12423722))),h=o(a,.63,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16508078))),i=o(a,.67,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(12423722))),j=o(a,.69,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8609303))),k=o(a,.82001,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(10651977))),l=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16442295))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j),t.push(k),t.push(l);break;case g.PresetGradientType.GradientBrass:c=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8541696))),d=o(a,.87,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16754688))),e=o(a,.72,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8541696))),h=o(a,.57001,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16754688))),i=o(a,.42,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8541696))),j=o(a,.28,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16754688))),k=o(a,.13,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8541696))),l=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16754688))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j),t.push(k),t.push(l);break;case g.PresetGradientType.GradientChrome:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215))),d=o(a,.16,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(2039583))),e=o(a,.17999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215))),h=o(a,.42,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(6513507))),i=o(a,.53,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13619151))),j=o(a,.66,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13619151))),k=o(a,.75999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(2039583))),l=o(a,.78999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215))),m=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8355711))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j),t.push(k),t.push(l),t.push(m);break;case g.PresetGradientType.GradientChromeII:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(13355979))),d=o(a,.13,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(6250335))),e=o(a,.21001,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(6250335))),h=o(a,.63,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215))),i=o(a,.67,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(11711154))),j=o(a,.69,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(2697513))),k=o(a,.82001,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(7829367))),l=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15395562))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j),t.push(k),t.push(l);break;case g.PresetGradientType.GradientSilver:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215))),d=o(a,.03501,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15132390))),e=o(a,.16,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8225942))),h=o(a,.235,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15132390))),i=o(a,.42501,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8225942))),j=o(a,.5,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15132390))),k=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15132390))),l=o(a,.965,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15132390))),m=o(a,.84,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8225942))),n=o(a,.765,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(15132390))),q=o(a,.575,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(8225942))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j),t.push(k),t.push(l),t.push(m),t.push(n),t.push(q);break;case g.PresetGradientType.GradientSapphire:c=o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(130))),d=o(a,.13,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(18431))),e=o(a,.28,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(130))),h=o(a,.42999,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(18431))),i=o(a,.58,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(130))),j=o(a,.72,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(18431))),k=o(a,.87,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(130))),l=o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(18431))),t.push(c),t.push(d),t.push(e),t.push(h),t.push(i),t.push(j),t.push(k),t.push(l)}},j.InitGradientStopTwoColor=function(a,b){var c,d,e=b.GradientStyle;return e===g.GradientStyle.GradientFromCenter?void this.InitGradientTwoColorCenterStops(a,b):e===g.GradientStyle.GradientFromCorner?void this.InitGradientTwoColorCornerStops(a,b):(c=b.GradientStops.GradientStopList,d=b.GradientVariant,void(1===d||2===d?(c.push(o(a,0,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),c.push(o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215))))):3===d?(c.push(o(a,0,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),c.push(o(a,.5,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215)))),c.push(o(a,1,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1)))):4===d&&(c.push(o(a,.5,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),c.push(o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215)))),c.push(o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215)))))))},j.InitGradientTwoColorCornerStops=function(a,b){var c=b.GradientStops.GradientStopList;c.push(o(a,0,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),c.push(o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215))))},j.InitGradientTwoColorCenterStops=function(a,b){var c=b.GradientStops.GradientStopList,d=b.GradientVariant;1===d?(c.push(o(a,0,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),c.push(o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215))))):2===d?(c.push(o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215)))),c.push(o(a,1,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1)))):3===d?(c.push(o(a,0,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),c.push(o(a,.5,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215)))),c.push(o(a,1,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1)))):4===d&&(c.push(o(a,0,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215)))),c.push(o(a,.5,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),c.push(o(a,1,f.createColorFormatFromRGB(a,g.SolidColorType.RGB,p(16777215)))))},j.InitGradientOneColorCornerStops=function(a,b){var c=f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1,this.GetTintAndShadeByDegree(b.GradientDegree)),d=b.GradientStops.GradientStopList;d.push(o(a,0,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),d.push(o(a,1,c))},j.InitGradientOneColorCenterStops=function(a,b){var c=f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1,this.GetTintAndShadeByDegree(b.GradientDegree)),d=b.GradientStops.GradientStopList,e=b.GradientVariant;1===e?(d.push(o(a,0,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),d.push(o(a,1,c))):2===e?(d.push(o(a,0,c)),d.push(o(a,1,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1)))):3===e?(d.push(o(a,0,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),d.push(o(a,.5,c)),d.push(o(a,1,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1)))):4===e&&(d.push(o(a,0,c)),d.push(o(a,.5,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),d.push(o(a,1,c)))},j.InitGradientStopOneColor=function(a,b){var c,d,e,h=b.GradientStyle;return h===g.GradientStyle.GradientFromCenter?void this.InitGradientOneColorCenterStops(a,b):h===g.GradientStyle.GradientFromCorner?void this.InitGradientOneColorCornerStops(a,b):(c=this.GetTintAndShadeByDegree(b.GradientDegree),d=b.GradientStops.GradientStopList,e=b.GradientVariant,void(1===e||2===e?(d.push(o(a,0,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),d.push(o(a,1,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1,c)))):3===e?(d.push(o(a,0,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),d.push(o(a,.5,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1,c))),d.push(o(a,1,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1)))):4===e&&(d.push(o(a,.5,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),d.push(o(a,0,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1))),d.push(o(a,1,f.createColorFormat(a,g.SolidColorType.Theme,g.ColorSchemeIndex.Accent1,c))))))},j.InitGradientStops=function(a,b,c){var d=this;if(b.Fpa(new n(a)),c===g.GradientColorType.GradientOneColor)d.InitGradientStopOneColor(a,b);else if(c===g.GradientColorType.GradientTwoColors)d.InitGradientStopTwoColor(a,b);else{if(c!==g.GradientColorType.GradientPresetColors)throw Error();d.InitGradientStopPresetColor(a,b)}b.GradientAngle=d.GetGradientAngle(b.GradientStyle,b.GradientVariant)}},"./dist/plugins/floatingObject/drawing/lineFormat.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/floatingObject/drawing/stateful.js"),f=c("./dist/plugins/floatingObject/drawing/common.js"),g=c("./dist/plugins/floatingObject/drawing/fillFormat.js"),h=c("./dist/plugins/floatingObject/drawing/drawingInterface.js"),i=d.NodeHelper.pca,j=f.ChartUtility.umb,k=f.UnitHelper.isNullOrUndefined,l=null;function o(a,b,c){return a>=b&&a<=c}m=function(a){n(b,a);function b(b,c,d){var e=a.call(this,c)||this,f=e;return f.Pqa=h.ArrowheadLength.medium,f.Qqa=h.ArrowheadStyle.none,f.Rqa=h.ArrowheadWidth.medium,f.Sqa=h.LineDashStyle.solid,f.Tqa=h.ArrowheadLength.medium,f.Uqa=h.ArrowheadStyle.none,f.Vqa=h.ArrowheadWidth.medium,f.Wqa=h.LineStyle.LineSingle,f.bz=!0,f.Xqa=-1,f.Yqa=l,f._lK=l,f.xc=b,f.hqa=c,f.iqa=d,f.vmb=h.LineCapStyle.flat,f.wmb=h.LineJoinStyle.round,f.Zpa=new g.FillFormat(b,c&&c.FillInternal,d),e}return Object.defineProperty(b.prototype,"PatternColor",{get:function(){return this.FillInternal.PatternColorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Color",{get:function(){return this.FillInternal.ColorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"BeginArrowheadLength",{get:function(){return this.IsDirty(h.LineFormatStates.BeginArrowheadLength)||k(this.hqa)?this.Pqa:this.hqa.BeginArrowheadLength},set:function(a){this.Pqa=a,this.Dirty(h.LineFormatStates.BeginArrowheadLength)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"BeginArrowheadStyle",{get:function(){return this.IsDirty(h.LineFormatStates.BeginArrowheadStyle)||k(this.hqa)?this.Qqa:this.hqa.BeginArrowheadStyle},set:function(a){this.Qqa=a,this.Dirty(h.LineFormatStates.BeginArrowheadStyle)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"BeginArrowheadWidth",{get:function(){return this.IsDirty(h.LineFormatStates.BeginArrowheadWidth)||k(this.hqa)?this.Rqa:this.hqa.BeginArrowheadWidth},set:function(a){this.Rqa=a,this.Dirty(h.LineFormatStates.BeginArrowheadWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"DashStyle",{get:function(){return this.IsDirty(h.LineFormatStates.DashStyle)||k(this.hqa)?this.Sqa:this.hqa.DashStyle},set:function(a){o(a,0,11)&&(this.Sqa=a,this.Dirty(h.LineFormatStates.DashStyle))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"CapStyle",{get:function(){return this.IsDirty(h.LineFormatStates.CapStyle)||k(this.hqa)?this.vmb:this.hqa.CapStyle},set:function(a){o(a,0,2)&&(this.vmb=a,this.Dirty(h.LineFormatStates.CapStyle))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"JoinStyle",{get:function(){return this.IsDirty(h.LineFormatStates.JoinStyle)||k(this.hqa)?this.wmb:this.hqa.JoinStyle},set:function(a){o(a,0,2)&&(this.wmb=a,this.Dirty(h.LineFormatStates.JoinStyle))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"EndArrowheadLength",{get:function(){return this.IsDirty(h.LineFormatStates.EndArrowheadLength)||k(this.hqa)?this.Tqa:this.hqa.EndArrowheadLength},set:function(a){this.Tqa=a,this.Dirty(h.LineFormatStates.EndArrowheadLength)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"EndArrowheadStyle",{get:function(){return this.IsDirty(h.LineFormatStates.EndArrowheadStyle)||k(this.hqa)?this.Uqa:this.hqa.EndArrowheadStyle},set:function(a){this.Uqa=a,this.Dirty(h.LineFormatStates.EndArrowheadStyle)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"EndArrowheadWidth",{get:function(){return this.IsDirty(h.LineFormatStates.EndArrowheadWidth)||k(this.hqa)?this.Vqa:this.hqa.EndArrowheadWidth},set:function(a){this.Vqa=a,this.Dirty(h.LineFormatStates.EndArrowheadWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"InsetPen",{get:function(){return this.IsDirty(h.LineFormatStates.InsetPen)||k(this.hqa)?this.Zqa:this.hqa.InsetPen},set:function(a){this.Zqa=a,this.Dirty(h.LineFormatStates.InsetPen)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Pattern",{get:function(){return this.FillInternal.Pattern},set:function(a){this.FillInternal.uqa(a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"PresetGradientType",{get:function(){return this.FillInternal.PresetGradientType},enumerable:!0,configurable:!0}),b.prototype.xqa=function(a){this.FillInternal.xqa(a)},Object.defineProperty(b.prototype,"GradientAngle",{get:function(){return this.FillInternal.GradientAngle},set:function(a){this.FillInternal.GradientAngle=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"GradientColorType",{get:function(){return this.FillInternal.GradientColorType},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"GradientDegree",{get:function(){return this.FillInternal.GradientDegree},enumerable:!0,configurable:!0}),b.prototype.pqa=function(a){this.FillInternal.pqa(a)},Object.defineProperty(b.prototype,"GradientStops",{get:function(){return this.FillInternal.GradientStops},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"GradientStyle",{get:function(){return this.FillInternal.GradientStyle},enumerable:!0,configurable:!0}),b.prototype.rqa=function(a){this.FillInternal.rqa(a)},Object.defineProperty(b.prototype,"GradientVariant",{get:function(){return this.FillInternal.GradientVariant},enumerable:!0,configurable:!0}),b.prototype.tqa=function(a){this.FillInternal.tqa(a)},Object.defineProperty(b.prototype,"Style",{get:function(){return this.IsDirty(h.LineFormatStates.Style)||k(this.hqa)?this.Wqa:this.hqa.Style},set:function(a){o(a,0,4)&&(this.Wqa=a,this.Dirty(h.LineFormatStates.Style))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Transparency",{get:function(){return this.FillInternal.Transparency},set:function(a){this.FillInternal.Transparency=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Visible",{get:function(){return this.IsDirty(h.LineFormatStates.Visible)||k(this.hqa)?this.bz:this.hqa.Visible},set:function(a){this.bz=a,this.Dirty(h.LineFormatStates.Visible)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Weight",{get:function(){return this.IsDirty(h.LineFormatStates.Weight)||k(this.hqa)?this.Xqa:this.hqa.Weight},set:function(a){this.Xqa=a,this.Dirty(h.LineFormatStates.Weight)},enumerable:!0,configurable:!0}),b.prototype.OneColorGradient=function(a,b,c){this.FillInternal.OneColorGradient(a,b,c)},b.prototype.TwoColorGradient=function(a,b){this.FillInternal.TwoColorGradient(a,b)},b.prototype.PresetGradient=function(a,b,c){this.FillInternal.PresetGradient(a,b,c)},b.prototype.Solid=function(){this.FillInternal.Solid()},b.prototype.Patterned=function(a){this.FillInternal.Patterned(a)},Object.defineProperty(b.prototype,"FillInternal",{get:function(){var a=this;return a.Zpa||(a.Zpa=new g.FillFormat(a.xc,a.hqa&&a.hqa.FillInternal,a.iqa)),a.Zpa},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Type",{get:function(){return this.FillInternal.Type},enumerable:!0,configurable:!0}),b.prototype.GetState=function(b,c){var d=this.Zpa;if(d){if(b===h.LineFormatStates.Color&&d.Color)return d.Color.IsDirtyIncludingParent(c);if(b===h.LineFormatStates.PatternColor&&d.PatternColor)return d.PatternColor.IsDirtyIncludingParent(c)}return a.prototype.GetState.call(this,b,c)},b.prototype.IsDirtyIncludingParent=function(b){var c=this.Zpa;return!(!c||!c.IsDirtyIncludingParent(b))||a.prototype.IsDirtyIncludingParent.call(this,b)},b.prototype.OnParentChanged=function(a){this.hqa=a;var b=this.Zpa;b&&a&&(b.ParentStateful=a.FillInternal)},b.prototype.FromOOModel=function(a){this.Yqa=a,this.FromCT_LineProperties(a)},b.prototype.FromSJSOOModel=function(a){this._lK=a,this.FromSJSCT_LineProperties(a)},b.prototype.ToOOModel=function(){return this.ToCT_LineProperties()},b.prototype.ToSJSOOModel=function(){return this.ToSJSCT_LineProperties()},b.prototype.FromCT_LineProperties=function(a){var b=this;k(a.solidFill)?k(a.pattFill)?k(a.gradFill)?k(a.noFill)||(b.FillInternal.ColorInternal.ColorType=h.SolidColorType.None):b.FillInternal.FromOOModel(a.gradFill,h.ColorFillType.GradientFillProperties):b.FillInternal.FromOOModel(a.pattFill,h.ColorFillType.PatternFillProperties):b.FillInternal.FromOOModel(a.solidFill,h.ColorFillType.SolidColorFillProperties),k(a.headEnd)||b.FromCT_LineEndProperties(a.headEnd),k(a.tailEnd)||b.FromCT_TailLineEndProperties(a.tailEnd),!k(a.w)&&a.w>=0?b.Weight=a.w:k(a.solidFill)&&k(a.gradFill)?(b.Xqa=-1,b.UnDirty(h.LineFormatStates.Weight)):b.Weight=1,k(a.cmpd)||(b.Style=a.cmpd),b.Round=!!a.round,k(a.prstDash)?b.UnDirty(h.LineFormatStates.DashStyle):b.DashStyle=a.prstDash,k(a.cap)||(b.CapStyle=a.cap),a.bevel?b.JoinStyle=h.LineJoinStyle.bevel:a.round?b.JoinStyle=h.LineJoinStyle.round:a.miter&&(b.JoinStyle=h.LineJoinStyle.miter)},b.prototype.FromSJSCT_LineProperties=function(a){var b,c,e,f=this,g=a.solidFill,j=a.pattFill,l=a.gradFill;k(g)?k(j)?k(l)?k(a.noFill)||(f.FillInternal.ColorInternal.ColorType=h.SolidColorType.None):f.FillInternal.FromSJSOOModel(l,h.ColorFillType.GradientFillProperties):f.FillInternal.FromSJSOOModel(j,h.ColorFillType.PatternFillProperties):f.FillInternal.FromSJSOOModel(g,h.ColorFillType.SolidColorFillProperties),b=a.headEnd,c=a.tailEnd,k(b)||f.FromSJSCT_LineEndProperties(b),k(c)||f.FromSJSCT_TailLineEndProperties(c),k(a.w)?k(g)&&k(l)?(f.Xqa=-1,f.UnDirty(h.LineFormatStates.Weight)):f.Weight=1:f.Weight=d.ExcelHelper.emuToPixles(i(a.w)),0===f.Weight&&k(a.noFill)&&(f.Weight=1),k(a.cmpd)||(f.Style=h.ST_CompoundLine[a.cmpd]),f.Round=!0,e=a.prstDash,k(e)?f.UnDirty(h.LineFormatStates.DashStyle):f.DashStyle=h.LineType[e.val],k(a.cap)||(f.CapStyle=h.ST_LineCap[a.cap]),a.bevel?f.JoinStyle=h.LineJoinStyle.bevel:a.round?f.JoinStyle=h.LineJoinStyle.round:a.miter&&(f.JoinStyle=h.LineJoinStyle.miter)},b.prototype.ToCT_LineProperties=function(){var a,b,c,d,e=this,f=e.Yqa;return e.IsDirtyIncludingParent()||k(f)?(a=f||{},j(a),e.bz?k(e.Zpa)||(b=e.Zpa.ToOOModel(),b.colorFillType===h.ColorFillType.SolidColorFillProperties?a.solidFill=b:b.colorFillType===h.ColorFillType.PatternFillProperties?a.pattFill=b:b.colorFillType===h.ColorFillType.GradientFillProperties?a.gradFill=b:b.colorFillType===h.ColorFillType.NoFillProperties&&(a.noFill=!0),delete b.colorFillType):a.noFill=!0,c=e.ToCT_HeadLineEndProperties(),c&&(a.headEnd=c),c=e.ToCT_TailLineEndProperties(),c&&(a.tailEnd=c),e.Weight>=0&&(a.w=e.Weight),e.GetState(h.LineFormatStates.Style,!0)&&(a.cmpd=e.Style),e.GetState(h.LineFormatStates.DashStyle,!0)&&(a.prstDash=e.DashStyle),e.Round&&(a.round=!0),e.GetState(h.LineFormatStates.CapStyle,!0)&&(a.cap=e.CapStyle),delete a.bevel,delete a.round,delete a.miter,e.GetState(h.LineFormatStates.JoinStyle,!0)&&(d=e.JoinStyle,d===h.LineJoinStyle.bevel?a.bevel={}:d===h.LineJoinStyle.round?a.round=!0:d===h.LineJoinStyle.miter&&(a.miter={lim:8e5})),a):f},b.prototype.ToSJSCT_LineProperties=function(){var a,b,c,e,f=this,g=f._lK;return f.IsDirtyIncludingParent()||k(g)?(a={},f.Weight>=0&&(a.w=d.ExcelHelper.pixelToEMU(f.Weight)),f.GetState(h.LineFormatStates.Style,!0)&&(a.cmpd=h.ST_CompoundLine[f.Style]),f.GetState(h.LineFormatStates.CapStyle,!0)&&(a.cap=h.ST_LineCap[f.CapStyle]),k(g&&g.algn)||(a.algn=g.algn),j(a),!f.bz||a.w<=0?a.noFill={}:k(f.Zpa)||(b=f.Zpa.ToSJSOOModel(),b.colorFillType===h.ColorFillType.SolidColorFillProperties?a.solidFill=b:b.colorFillType===h.ColorFillType.PatternFillProperties?a.pattFill=b:b.colorFillType===h.ColorFillType.GradientFillProperties?a.gradFill=b:b.colorFillType===h.ColorFillType.NoFillProperties&&(a.noFill={}),delete b.colorFillType),f.GetState(h.LineFormatStates.DashStyle,!0)&&(a.prstDash={val:h.ST_PresetLineDashVal[11===f.DashStyle?1:f.DashStyle]}),f.GetState(h.LineFormatStates.JoinStyle,!0)&&(c=f.JoinStyle,c===h.LineJoinStyle.bevel?a.bevel={}:c===h.LineJoinStyle.round?a.round={}:c===h.LineJoinStyle.miter&&(a.miter={lim:8e5})),e=f.ToSJSCT_HeadLineEndProperties(),e&&(a.headEnd=e),e=f.ToSJSCT_TailLineEndProperties(),e&&(a.tailEnd=e),k(g&&g.extLst)||(a.extLst=g.extLst),a):g},b.prototype.FromCT_LineEndProperties=function(a){var b=this;b.Qqa=a.type,b.Rqa=a.w,b.Pqa=a.len,b.SetState(h.LineFormatStates.BeginArrowheadStyle,!0),b.SetState(h.LineFormatStates.BeginArrowheadWidth,!0),b.SetState(h.LineFormatStates.BeginArrowheadLength,!0)},b.prototype.FromSJSCT_LineEndProperties=function(a){var b=this;b.Qqa=h.ST_LineEndType[a.type],b.Rqa=a.w?h.ST_LineEndWidth[a.w]:1,b.Pqa=a.len?h.ST_LineEndLength[a.len]:1,b.SetState(h.LineFormatStates.BeginArrowheadStyle,!0),b.SetState(h.LineFormatStates.BeginArrowheadWidth,!0),b.SetState(h.LineFormatStates.BeginArrowheadLength,!0)},b.prototype.ToCT_HeadLineEndProperties=function(){var a={w:h.ArrowheadWidth.medium,len:h.ArrowheadLength.medium},b=this,c=!1;return b.GetState(h.LineFormatStates.BeginArrowheadStyle,!0)&&(a.type=b.BeginArrowheadStyle,c=!0),b.GetState(h.LineFormatStates.BeginArrowheadWidth,!0)&&(a.w=b.BeginArrowheadWidth,c=!0),b.GetState(h.LineFormatStates.BeginArrowheadLength,!0)&&(a.len=b.BeginArrowheadLength,c=!0),c?a:l},b.prototype.ToSJSCT_HeadLineEndProperties=function(){var a={w:h.ST_LineEndWidth[1],len:h.ST_LineEndWidth[1]},b=this,c=!1;return b.GetState(h.LineFormatStates.BeginArrowheadStyle,!0)&&(a.type=h.ST_LineEndType[b.BeginArrowheadStyle],c=!0),b.GetState(h.LineFormatStates.BeginArrowheadWidth,!0)&&(a.w=h.ST_LineEndWidth[b.BeginArrowheadWidth],c=!0),b.GetState(h.LineFormatStates.BeginArrowheadLength,!0)&&(a.len=h.ST_LineEndWidth[b.BeginArrowheadLength],c=!0),c?a:l},b.prototype.FromCT_TailLineEndProperties=function(a){if(!k(a)){var b=this;b.Uqa=a.type,b.Vqa=a.w,b.Tqa=a.len,b.SetState(h.LineFormatStates.EndArrowheadStyle,!0),b.SetState(h.LineFormatStates.EndArrowheadWidth,!0),b.SetState(h.LineFormatStates.EndArrowheadLength,!0)}},b.prototype.FromSJSCT_TailLineEndProperties=function(a){if(!k(a)){var b=this;b.Uqa=h.ST_LineEndType[a.type],b.Vqa=a.w?h.ST_LineEndWidth[a.w]:1,b.Tqa=a.len?h.ST_LineEndLength[a.len]:1,b.SetState(h.LineFormatStates.EndArrowheadStyle,!0),b.SetState(h.LineFormatStates.EndArrowheadWidth,!0),b.SetState(h.LineFormatStates.EndArrowheadLength,!0)}},b.prototype.ToCT_TailLineEndProperties=function(){var a={w:h.ArrowheadWidth.medium,len:h.ArrowheadLength.medium},b=!1,c=this;return c.GetState(h.LineFormatStates.EndArrowheadStyle,!0)&&(a.type=c.EndArrowheadStyle,b=!0),c.GetState(h.LineFormatStates.EndArrowheadWidth,!0)&&(a.w=c.EndArrowheadWidth,b=!0),c.GetState(h.LineFormatStates.EndArrowheadLength,!0)&&(a.len=c.EndArrowheadLength,b=!0),b?a:l},b.prototype.ToSJSCT_TailLineEndProperties=function(){var a={w:h.ST_LineEndWidth[1],len:h.ST_LineEndWidth[1]},b=!1,c=this;return c.GetState(h.LineFormatStates.EndArrowheadStyle,!0)&&(a.type=h.ST_LineEndType[c.EndArrowheadStyle],b=!0),c.GetState(h.LineFormatStates.EndArrowheadWidth,!0)&&(a.w=h.ST_LineEndWidth[c.EndArrowheadWidth],b=!0),c.GetState(h.LineFormatStates.EndArrowheadLength,!0)&&(a.len=h.ST_LineEndWidth[c.EndArrowheadLength],
b=!0),b?a:l},b.prototype.Clone=function(){var a=this,c=new b(a.xc);return c.Zpa=a.Zpa&&a.Zpa.Clone(),c.Pqa=a.Pqa,c.Qqa=a.Qqa,c.Rqa=a.Rqa,c.Sqa=a.Sqa,c.Tqa=a.Tqa,c.Uqa=a.Uqa,c.Vqa=a.Vqa,c.Zqa=a.Zqa,c.bz=a.bz,c.Xqa=a.Xqa,c.rpa=a.rpa,c.hqa=a.hqa,c},b}(e.StatefulBase),b.LineFormat=m},"./dist/plugins/floatingObject/drawing/picture.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/floatingObject/drawing/stateful.js"),e=c("./dist/plugins/floatingObject/drawing/common.js"),f=c("./dist/plugins/floatingObject/drawing/drawingInterface.js"),g=c("Core"),h=g.ExcelHelper.emuToPixles,i=g.ExcelHelper.pixelToEMU,j=e.ShapeConstants.PositionConver,k=e.ShapeConstants.PositiveFixedPercentageConvert,l=e.ShapeUtility.FromLum,m=e.ShapeUtility.ToLum,n=e.UnitHelper.isNullOrUndefined,o=null,p=void 0,q=g.NodeHelper.pca;function u(a,b){return n(a)?b:a}function v(a){return n(a)?0:parseInt(a,10)}function w(a,b){return a&&parseFloat(a)/1e5||b}r=function(){function a(a){var b=this;b.qva=0,b.rva=0,b.sva=0,b.tva=0,b.xo=a}return Object.defineProperty(a.prototype,"PictureHeight",{get:function(){return this.tva},set:function(a){this.tva=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"PictureOffsetX",{get:function(){return this.qva},set:function(a){this.qva=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"PictureOffsetY",{get:function(){return this.rva},set:function(a){this.rva=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"PictureWidth",{get:function(){return this.sva},set:function(a){this.sva=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ShapeHeight",{get:function(){return this.xo.Height},set:function(a){this.xo.Height=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ShapeLeft",{get:function(){return this.xo.Left},set:function(a){this.xo.Left=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ShapeTop",{get:function(){return this.xo.Top},set:function(a){this.xo.Top=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ShapeWidth",{get:function(){return this.xo.Width},set:function(a){this.xo.Width=a},enumerable:!0,configurable:!0}),a.prototype.Clone=function(){var b=this,c=new a(b.xo);return c.tva=b.tva,c.qva=b.qva,c.rva=b.rva,c.sva=b.sva,c},a}(),b.Crop=r,s=function(a){t(b,a);function b(b,c){var d,g=this;return b===p&&(b=f.PictureFormatType.PictureShape),c===p&&(c=o),g=a.call(this,c)||this,d=g,d.Jqa=e.ShapeConstants.DefaultBrightness,d.Xba=f.PictureColorType.PictureAutomatic,d.uva=e.ShapeConstants.DefaultBrightness,d.vva=e.ShapeConstants.DefaultTransparent,d.wva=b,d.hqa=c,d.xva=d.wva===f.PictureFormatType.PictureShape,d.Gqa=e.ShapeConstants.DefaultTransparent,d.PBJ={left:0,right:0,top:0,bottom:0},d.QBJ={offsetX:0,offsetY:0,scaleX:1,scaleY:1,alignment:0,mirrorType:0},d}return Object.defineProperty(b.prototype,"Brightness",{get:function(){return this.IsDirty(1)||n(this.hqa)?this.Jqa:this.hqa.Brightness},set:function(a){if(a<0||a>1)throw Error();this.Jqa=a,this.Dirty(1)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"ColorType",{get:function(){return this.IsDirty(2)||n(this.hqa)?this.Xba:this.hqa.ColorType},set:function(a){a===f.PictureColorType.PictureAutomatic?(this.Jqa=e.ShapeConstants.DefaultBrightness,this.uva=e.ShapeConstants.DefaultBrightness):a===f.PictureColorType.PictureWatermark&&(this.Jqa=.85,this.uva=.15),this.Xba=a,this.Dirty(2)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Contrast",{get:function(){return this.IsDirty(4)||n(this.hqa)?this.uva:this.hqa.Contrast},set:function(a){if(a<0||a>1)throw Error();this.uva=a,this.Dirty(4)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Crop",{get:function(){var a=this;return a.yva||(a.yva=new r(a.zva)),a.yva},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"CropBottom",{get:function(){return this.Crop.ShapeTop+this.Crop.ShapeHeight},set:function(a){this.Crop.ShapeHeight=a-this.Crop.ShapeTop},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"CropLeft",{get:function(){return this.Crop.ShapeLeft},set:function(a){this.Crop.ShapeLeft=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"CropRight",{get:function(){return this.Crop.ShapeLeft+this.Crop.ShapeWidth},set:function(a){this.Crop.ShapeWidth=a-this.Crop.ShapeLeft},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"CropTop",{get:function(){return this.Crop.ShapeTop},set:function(a){this.Crop.ShapeTop=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Stretch",{get:function(){return this.PBJ},set:function(a){this.PBJ=JSON.parse(JSON.stringify(a))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Tile",{get:function(){return this.QBJ},set:function(a){this.QBJ=JSON.parse(JSON.stringify(a))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Transparency",{get:function(){return this.Gqa},set:function(a){a=Math.max(0,a),a=Math.min(1,a),this.Gqa=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"TransparencyColor",{get:function(){return this.IsDirty(8)||n(this.hqa)?this.vva:this.hqa.TransparencyColor},set:function(a){this.vva=a,this.Dirty(8)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"TransparentBackground",{get:function(){return this.IsDirty(16)||n(this.hqa)?this.xva:this.hqa.TransparentBackground},set:function(a){this.xva=a;var b=this.zva.Fill;a&&(b.Transparency=1),b.Solid(),this.Dirty(16)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Container",{get:function(){return this.zva},set:function(a){if(this.zva=a,a){var b=this.Crop;b.PictureWidth=a.Width,b.PictureHeight=a.Height}},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"PicFill",{get:function(){return this.IsDirty(32)||n(this.hqa)?this.Ava:this.hqa.PicFill},set:function(a){this.Ava=a,this.Dirty(32)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"PicType",{get:function(){return this.IsDirty(64)||n(this.hqa)?this.Bva:this.hqa.PicType},set:function(a){this.Bva=a,this.Dirty(64)},enumerable:!0,configurable:!0}),b.prototype.ClearModel=function(){var a,b,c;for(this.Tpa=o,a=0,b=this.Children;a<b.length;a++)c=b[a],c.ClearModel()},Object.defineProperty(b.prototype,"PictureFormatType",{get:function(){return this.wva},set:function(a){this.wva=a},enumerable:!0,configurable:!0}),b.prototype.HasOwnPicture=function(){return this.IsDirty(1)||this.IsDirty(2)||this.IsDirty(4)||this.IsDirty(8)||this.IsDirty(16)},b.prototype.SetPictureInfo=function(a,b,c){this.PicFill=a,this.PicType=b,this.PictureFormatType=c},b.prototype.IncrementBrightness=function(a){this.Brightness+=a},b.prototype.IncrementContrast=function(a){this.Contrast+=a},b.prototype.FromOOModel=function(a){var b,c=this;c.Tpa=a,n(a)||(c.FromCT_Blip(a.blip),b=c.zva,n(b)||(n(a.tile)||(c.PictureFormatType=f.PictureFormatType.TextureFill),c.Crop.PictureWidth=b.Width,c.Crop.PictureHeight=b.Height,c.PictureFormatType===f.PictureFormatType.PictureShape?c.FromCT_RelativeRect(a.srcRect):c.PictureFormatType===f.PictureFormatType.PictureFill?c.FromCT_Stretch(a.stretch):c.PictureFormatType===f.PictureFormatType.TextureFill&&c.FromCT_Tile(a.tile)))},b.prototype.FromSJSOOModel=function(a){var b,c,d,e,g=this;g.Tpa=a,n(a)||(g.FromSJSCT_Blip(a.blip),b=g.zva,n(b)||(c=a.srcRect,d=a.stretch,e=a.tile,n(e)||(g.PictureFormatType=f.PictureFormatType.TextureFill),g.Crop.PictureWidth=b.Width,g.Crop.PictureHeight=b.Height,g.PictureFormatType===f.PictureFormatType.PictureShape?g.FromSJSCT_RelativeRect(c):g.PictureFormatType===f.PictureFormatType.PictureFill?g.FromSJSCT_Stretch(d):g.PictureFormatType===f.PictureFormatType.TextureFill&&g.FromSJSCT_Tile(e)))},b.prototype.ToOOModel=function(){var a,b,c=this,d=c.Tpa||{};return d.colorFillType=f.ColorFillType.BlipFillProperties,d.blip=c.ToCT_Blip(),a=c.zva,n(a)?d:(b=c.PictureFormatType,b===f.PictureFormatType.PictureShape?(d.srcRect=c.ToCT_RelativeRect(),d.stretch={},d.stretch.fillRect={l:0,r:0,t:0,b:0}):b===f.PictureFormatType.PictureFill?(d.stretch=c.ToCT_Strecth(),d.srcRect={l:0,r:0,t:0,b:0},d.tile=o):b===f.PictureFormatType.TextureFill&&(d.stretch=o,d.srcRect=o,d.tile=c.ToCT_Tile()),d)},b.prototype.ToSJSOOModel=function(){var a,b,c=this,d=c.Tpa||{};return d.colorFillType=f.ColorFillType.BlipFillProperties,d.blip=c.ToSJSCT_Blip(),a=c.zva,n(a)?d:(b=c.PictureFormatType,b===f.PictureFormatType.PictureShape?(d.srcRect=c.ToCT_RelativeRect(),d.stretch={},d.stretch.fillRect={l:0,r:0,t:0,b:0}):b===f.PictureFormatType.PictureFill?(d.stretch=c.ToCT_Strecth(),d.srcRect={l:0,r:0,t:0,b:0},d.tile=o):b===f.PictureFormatType.TextureFill&&(d.stretch=o,d.srcRect=o,d.tile=c.ToSJSCT_Tile()),d)},b.prototype.FromCT_Blip=function(a){if(!n(a)){var b=this;b.FromCT_ColorChangeEffect(a.clrChange),b.FromCT_LuminanceEffect(a.lum),n(a.alphaModFix)||(b.Transparency=1-a.alphaModFix.amt/k),n(a.grayscl)?n(a.biLevel)||(b.ColorType=f.PictureColorType.PictureBlackAndWhite):b.ColorType=f.PictureColorType.PictureGrayscale,b.FromCT_BlipBlob(a.blipBlob)}},b.prototype.FromSJSCT_Blip=function(a){var b,c;n(a)||(b=this,b.FromSJSCT_ColorChangeEffect(a.clrChange),b.FromSJSCT_LuminanceEffect(a.lum),c=a.alphaModFix,n(c)||(b.Transparency=1-q(c.amt,1e5)/k),n(a.grayscl)?n(a.biLevel)||(b.ColorType=f.PictureColorType.PictureBlackAndWhite):b.ColorType=f.PictureColorType.PictureGrayscale,b.FromSJSCT_BlipBlob(a.blipBlob))},b.prototype.ToCT_Blip=function(){var a=this,b=a.Tpa&&a.Tpa.blip||{cstate:f.ST_BlipCompression.none};return a.TransparencyColor!==e.ShapeConstants.DefaultTransparent&&(b.clrChange=a.ToCT_ColorChangeEffect()),a.Brightness===e.ShapeConstants.DefaultBrightness&&a.Contrast===e.ShapeConstants.DefaultBrightness||(b.lum=a.ToCT_LuminanceEffect()),a.Transparency!==e.ShapeConstants.DefaultTransparent?b.alphaModFix={amt:(1-a.Transparency)*k}:delete b.alphaModFix,a.ColorType===f.PictureColorType.PictureGrayscale?b.grayscl={}:a.ColorType===f.PictureColorType.PictureBlackAndWhite&&(b.biLevel={thresh:5e4}),b.blipBlob=a.ToCT_BlipBlob(),b},b.prototype.ToSJSCT_Blip=function(){var a=this,b={r_:[8]};return a.TransparencyColor!==e.ShapeConstants.DefaultTransparent&&(b.clrChange=a.ToCT_ColorChangeEffect()),a.Brightness===e.ShapeConstants.DefaultBrightness&&a.Contrast===e.ShapeConstants.DefaultBrightness||(b.lum=a.ToCT_LuminanceEffect()),a.Transparency!==e.ShapeConstants.DefaultTransparent&&(b.alphaModFix={amt:(1-a.Transparency)*k}),a.ColorType===f.PictureColorType.PictureGrayscale?b.grayscl={}:a.ColorType===f.PictureColorType.PictureBlackAndWhite&&(b.biLevel={thresh:5e4}),b.blipBlob=a.ToCT_BlipBlob(),b},b.prototype.FromCT_ColorChangeEffect=function(a){var b=a&&a.clrFrom&&a.clrFrom.srgbClr;b&&this.FromColorByteArr(a.val)},b.prototype.FromSJSCT_ColorChangeEffect=function(a){var b=a&&a.clrFrom&&a.clrFrom.srgbClr;b&&this.FromColorByteArr(a.val)},b.prototype.ToCT_ColorChangeEffect=function(){var a=this.ToColorByteArr(this.vva);return{useA:!0,clrFrom:{srgbClr:{val:a}},clrTo:{srgbClr:{val:a,alpha:[0]}}}},b.prototype.FromColorByteArr=function(a){this.vva=0|a[2]<<16|a[1]<<8|a[0]},b.prototype.ToColorByteArr=function(a){var b=[];return b[3]=Math.floor(a/(1<<24)),a%=1<<24,b[2]=Math.floor(a/65536),a%=65536,b[1]=Math.floor(a/256),a%=256,b[0]=Math.floor(a),b},b.prototype.FromCT_LuminanceEffect=function(a){a&&(this.Brightness=l(a.bright),this.Contrast=l(a.contrast))},b.prototype.FromSJSCT_LuminanceEffect=function(a){a&&(this.Brightness=l(v(a.bright)),this.Contrast=l(v(a.contrast)))},b.prototype.ToCT_LuminanceEffect=function(){return{bright:m(this.Brightness),contrast:m(this.Contrast)}},b.prototype.FromCT_BlipBlob=function(a){if(a){var b=this;b.Ava=a.blob,b.Dirty(32),b.Bva=a.type,b.Dirty(64)}},b.prototype.FromSJSCT_BlipBlob=function(a){if(a){var b=this;b.Ava=a.blob,b.Dirty(32),b.Bva=u(f.ST_BobType[a.type],0),b.Dirty(64)}},b.prototype.ToCT_BlipBlob=function(){var a=this,b=a.Tpa&&a.Tpa.blip&&a.Tpa.blip.blipBlob||{type:f.ImageType.PNG};return b.blob=a.PicFill,b.type=a.PicType,b},b.prototype.FromCT_Tile=function(a){this.QBJ={offsetX:a.tx,offsetY:a.ty,scaleX:a.sx/j,scaleY:a.sy/j,alignment:a.algn,mirrorType:a.flip}},b.prototype.FromSJSCT_Tile=function(a){this.QBJ={offsetX:h(q(a.tx,0)),offsetY:h(q(a.ty,0)),scaleX:q(a.sx,j)/j,scaleY:q(a.sy,j)/j,alignment:f.ST_RectAlignment[a.algn||"tl"],mirrorType:f.ST_TileFlipMode[a.flip||"none"]}},b.prototype.ToCT_Tile=function(){var a=this.Tile;return{tx:a.offsetX,ty:a.offsetY,sx:Math.round(a.scaleX*j),sy:Math.round(a.scaleY*j),algn:a.alignment,flip:a.mirrorType}},b.prototype.ToSJSCT_Tile=function(){var a=this.Tile;return{tx:i(Math.round(a.offsetX)),ty:i(Math.round(a.offsetY)),sx:Math.round(a.scaleX*j),sy:Math.round(a.scaleY*j),algn:f.ST_RectAlignment[a.alignment],flip:f.ST_TileFlipMode[a.mirrorType]}},b.prototype.FromCT_Stretch=function(a){var b,c,d,e,f=a&&a.fillRect;n(f)||(b=f.l/j,c=f.r/j,d=f.t/j,e=f.b/j,this.PBJ={left:b,right:c,top:d,bottom:e})},b.prototype.FromSJSCT_Stretch=function(a){var b,c,d,f,g=a&&a.fillRect;n(g)||(b=e.leK(g.l)/j,c=e.leK(g.r)/j,d=e.leK(g.t)/j,f=e.leK(g.b)/j,this.PBJ={left:b,right:c,top:d,bottom:f})},b.prototype.ToCT_Strecth=function(){var a=this.Stretch,b=a.left,c=a.right,d=a.top,e=a.bottom;return{fillRect:{l:Math.round(b*j),r:Math.round(c*j),t:Math.round(d*j),b:Math.round(e*j)}}},b.prototype.FromCT_RelativeRect=function(a){var b,c,d,e,f,g,h,i=this.zva;n(a)||n(i)||(b=a.l/j,c=a.r/j,d=a.t/j,e=a.b/j,f=this.Crop,g=f.PictureWidth=i.Width/(1-b-c),h=f.PictureHeight=i.Height/(1-d-e),f.PictureOffsetX=(g-i.Width)/2-b*g,f.PictureOffsetY=(h-i.Height)/2-d*h)},b.prototype.FromSJSCT_RelativeRect=function(a){var b,c,d,f,g,h,i,k=this.zva;n(a)||n(k)||(b=e.leK(a.l)/j,c=e.leK(a.r)/j,d=e.leK(a.t)/j,f=e.leK(a.b)/j,g=this.Crop,h=g.PictureWidth=k.Width/(1-b-c),i=g.PictureHeight=k.Height/(1-d-f),g.PictureOffsetX=(h-k.Width)/2-b*h,g.PictureOffsetY=(i-k.Height)/2-d*i)},b.prototype.ToCT_RelativeRect=function(){var a,b,c,d,e,f,g,h,i=this.zva,k=this.Crop,l=k.ShapeHeight,m=k.ShapeWidth;return n(i)||0===l||0===m?{l:0,r:0,t:0,b:0}:(a=k.PictureWidth,b=k.PictureHeight,c=k.PictureOffsetX,d=k.PictureOffsetY,e=((a-m)/2-c)/a,f=((a-m)/2+c)/a,g=((b-l)/2-d)/b,h=((b-l)/2+d)/b,{l:e*j,r:f*j,t:g*j,b:h*j})},b.prototype.Clone=function(){var a=this,c=new b;return c.Jqa=a.Jqa,c.uva=a.uva,c.Xba=a.Xba,a.yva&&(c.yva=a.yva.Clone()),c.Gqa=a.Gqa,c.QBJ=JSON.parse(JSON.stringify(a.QBJ)),c.PBJ=JSON.parse(JSON.stringify(a.PBJ)),c.Ava=a.Ava,c.wva=a.wva,c.Bva=a.Bva,c.zva=a.zva,c.vva=a.vva,c.xva=a.xva,c},b.prototype.OnParentChanged=function(a){this.hqa=a},b}(d.StatefulBase),b.PictureFormat=s},"./dist/plugins/floatingObject/drawing/stateful.js":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=d.Common.j,f=e.Fa,g=function(){function a(a){var b=this;b.oi=[],b.qpa=0,b.rpa=0,b.spa=a,b.spa&&b.spa.AddChildInternal(b)}return a.prototype.SetState=function(a,b){var c=this,d=a;b?c.rpa|=d:c.rpa&=~d,c.IsClearChildrenStateSuspended||c.oi.forEach(function(b){b.SetState(a,!1)})},a.prototype.GetState=function(a,b){var c=this,d=a,e=(d&c.rpa)===d;return e||!b||f(c.spa)||(e=c.spa.GetState(a,!0)),e},a.prototype.OnStateChanged=function(a){},a.prototype.Dirty=function(a){this.SetState(a,!0)},a.prototype.UnDirty=function(a){this.SetState(a,!1)},a.prototype.UnDirtyAll=function(){this.rpa=0},a.prototype.IsDirty=function(a){return this.GetState(a)},a.prototype.IsPropDirtyIncludingParent=function(a,b){var c=this,d=c.GetState(a);return!!d||!(!b||f(c.spa))&&c.spa.IsPropDirtyIncludingParent(a,!0)},a.prototype.IsDirtyIncludingParent=function(a){var b=this;return b.rpa>0||!(!a||f(b.spa))&&b.spa.IsDirtyIncludingParent(!0)},a.prototype.AddChildInternal=function(a){var b=this.oi;b.indexOf(a)===-1&&b.push(a)},a.prototype.RemoveChildInternal=function(a){var b=this.oi,c=b.indexOf(a);c!==-1&&b.splice(c,1)},a.prototype.SetParentForChildren=function(a){var b=this.oi.slice(0);b.forEach(function(b){b.ParentStateful=a})},a.prototype.OnParentChanged=function(a){},a.prototype.SuspendClearChildrenState=function(){this.qpa++},a.prototype.ResumeClearChilrenState=function(){this.qpa--},Object.defineProperty(a.prototype,"ParentStateful",{get:function(){return this.spa},set:function(a){var b=this;a!==b.spa&&(b.spa&&b.spa.RemoveChildInternal(this),b.spa=a,b.spa&&b.spa.AddChildInternal(this),b.OnParentChanged(a))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Children",{get:function(){return this.oi},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"IsClearChildrenStateSuspended",{get:function(){return this.qpa>0},enumerable:!0,configurable:!0}),a}(),b.StatefulBase=g},"./dist/plugins/floatingObject/drawing/threeDFormat.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/floatingObject/drawing/common.js"),e=c("./dist/plugins/floatingObject/drawing/stateful.js"),f=c("./dist/plugins/floatingObject/drawing/drawingInterface.js"),g=c("Core"),h=g.ExcelHelper.emuToPixles,i=d.ShapeConstants.PositiveFixedAngleConvert,j=d.UnitHelper.isNullOrUndefined,function(a){a[a.BevelBottomDepth=1]="BevelBottomDepth",a[a.BevelBottomInset=2]="BevelBottomInset",a[a.BevelBottomType=4]="BevelBottomType",a[a.BevelTopDepth=8]="BevelTopDepth",a[a.BevelTopInset=16]="BevelTopInset",a[a.BevelTopType=32]="BevelTopType",a[a.ContourColor=64]="ContourColor",a[a.ContourWidth=128]="ContourWidth",a[a.Depth=256]="Depth",a[a.ExtrusionColor=512]="ExtrusionColor",a[a.ExtrusionColorType=1024]="ExtrusionColorType",a[a.FieldOfView=2048]="FieldOfView",a[a.LightAngle=4096]="LightAngle",a[a.Perspective=8192]="Perspective",a[a.PresetCamera=16384]="PresetCamera",a[a.PresetExtrusionDirection=32768]="PresetExtrusionDirection",a[a.PresetLighting=65536]="PresetLighting",a[a.PresetLightingDirection=131072]="PresetLightingDirection",a[a.PresetLightingSoftness=262144]="PresetLightingSoftness",a[a.PresetMaterial=524288]="PresetMaterial",a[a.PresetThreeDFormat=1048576]="PresetThreeDFormat",a[a.ProjectText=2097152]="ProjectText",a[a.RotationX=4194304]="RotationX",a[a.RotationY=8388608]="RotationY",a[a.RotationZ=16777216]="RotationZ",a[a.Visible=33554432]="Visible",a[a.Z=67108864]="Z",a[a.AutoScale=134217728]="AutoScale",a[a.DepthPercent=268435456]="DepthPercent",a[a.HeightPercent=536870912]="HeightPercent",a[a.RightAngleAxes=1073741824]="RightAngleAxes"}(k=b.ThreeDFormatStates||(b.ThreeDFormatStates={})),function(a){a[a.ExtrusionColorAutomatic=0]="ExtrusionColorAutomatic",a[a.ExtrusionColorCustom=1]="ExtrusionColorCustom"}(l||(l={})),m=null,n=function(a){o(b,a);function b(b,c){var e=a.call(this,c)||this,g=e;return g.$qa=d.BevelType.BevelNone,g._qa=d.BevelType.BevelNone,g.ara=l.ExtrusionColorAutomatic,g.bra=45,g.bz=!0,g.cra=m,g.dra=!0,g.era=100,g.fra=100,g.gra=!0,g.xc=b,g.hra=30,g.hqa=c,g.ira(f.PresetCamera.PresetCameraNone),e}return b.prototype.ira=function(a){var b=this;b.jra=a,b.Dirty(k.PresetCamera)},b.prototype.InitDicCameraType=function(){var a=this.cra=[];a[f.PresetCamera.CameraLegacyObliqueTopLeft]=[0,0,0],a[f.PresetCamera.CameraLegacyObliqueTop]=[0,0,0],a[f.PresetCamera.CameraLegacyObliqueTopRight]=[0,0,0],a[f.PresetCamera.CameraLegacyObliqueLeft]=[0,0,0],a[f.PresetCamera.CameraLegacyObliqueFront]=[0,0,0],a[f.PresetCamera.CameraLegacyObliqueRight]=[0,0,0],a[f.PresetCamera.CameraLegacyObliqueBottomLeft]=[0,0,0],a[f.PresetCamera.CameraLegacyObliqueBottom]=[0,0,0],a[f.PresetCamera.CameraLegacyObliqueBottomRight]=[0,0,0],a[f.PresetCamera.CameraLegacyPerspectiveTopLeft]=[0,0,0],a[f.PresetCamera.CameraLegacyPerspectiveTop]=[0,0,0],a[f.PresetCamera.CameraLegacyPerspectiveTopRight]=[0,0,0],a[f.PresetCamera.CameraLegacyPerspectiveLeft]=[0,0,0],a[f.PresetCamera.CameraLegacyPerspectiveFront]=[0,0,0],a[f.PresetCamera.CameraLegacyPerspectiveRight]=[0,0,0],a[f.PresetCamera.CameraLegacyPerspectiveBottomLeft]=[0,0,0],a[f.PresetCamera.CameraLegacyPerspectiveBottom]=[0,0,0],a[f.PresetCamera.CameraLegacyPerspectiveBottomRight]=[0,0,0],a[f.PresetCamera.CameraOrthographicFront]=[0,0,0],a[f.PresetCamera.CameraIsometricTopUp]=[314.7191,324.6037,60.16242],a[f.PresetCamera.CameraIsometricTopDown]=[45.28088,324.6037,299.8376],a[f.PresetCamera.CameraIsometricBottomUp]=[45.28088,35.39627,60.16242],a[f.PresetCamera.CameraIsometricBottomDown]=[314.7191,35.39627,299.8376],a[f.PresetCamera.CameraIsometricLeftUp]=[45,325,0],a[f.PresetCamera.CameraIsometricLeftDown]=[45,35,0],a[f.PresetCamera.CameraIsometricRightUp]=[315,35,0],a[f.PresetCamera.CameraIsometricRightDown]=[315,325,0],a[f.PresetCamera.CameraIsometricOffAxis1Left]=[64,18,0],a[f.PresetCamera.CameraIsometricOffAxis1Right]=[334,18,0],a[f.PresetCamera.CameraIsometricOffAxis1Top]=[306.5457,301.2619,57.6425],a[f.PresetCamera.CameraIsometricOffAxis2Left]=[26,18,0],a[f.PresetCamera.CameraIsometricOffAxis2Right]=[296,18,0],a[f.PresetCamera.CameraIsometricOffAxis2Top]=[53.45424,301.2619,302.3575],a[f.PresetCamera.CameraIsometricOffAxis3Left]=[64,342,0],a[f.PresetCamera.CameraIsometricOffAxis3Right]=[334,342,0],a[f.PresetCamera.CameraIsometricOffAxis3Bottom]=[306.5457,58.73808,302.3575],a[f.PresetCamera.CameraIsometricOffAxis4Left]=[26,342,0],a[f.PresetCamera.CameraIsometricOffAxis4Right]=[296,342,0],a[f.PresetCamera.CameraIsometricOffAxis4Bottom]=[53.45424,58.73808,57.64252],a[f.PresetCamera.CameraObliqueTopLeft]=[0,0,0],a[f.PresetCamera.CameraObliqueTop]=[0,0,0],a[f.PresetCamera.CameraObliqueTopRight]=[0,0,0],a[f.PresetCamera.CameraObliqueLeft]=[0,0,0],a[f.PresetCamera.CameraObliqueRight]=[0,0,0],a[f.PresetCamera.CameraObliqueBottomLeft]=[0,0,0],a[f.PresetCamera.CameraObliqueBottom]=[0,0,0],a[f.PresetCamera.CameraObliqueBottomRight]=[0,0,0],a[f.PresetCamera.CameraPerspectiveFront]=[0,0,0],a[f.PresetCamera.CameraPerspectiveLeft]=[20,0,0],a[f.PresetCamera.CameraPerspectiveRight]=[340,0,0],a[f.PresetCamera.CameraPerspectiveAbove]=[0,340,0],a[f.PresetCamera.CameraPerspectiveBelow]=[0,20,0],a[f.PresetCamera.CameraPerspectiveAboveLeftFacing]=[14.33758,39.30647,341.1238],a[f.PresetCamera.CameraPerspectiveAboveRightFacing]=[345.6624,39.30647,18.87615],a[f.PresetCamera.CameraPerspectiveContrastingLeftFacing]=[43.93887,10.39642,356.4465],a[f.PresetCamera.CameraPerspectiveContrastingRightFacing]=[316.0611,10.39642,3.553517],a[f.PresetCamera.CameraPerspectiveHeroicLeftFacing]=[14.29302,348.9837,2.626817],a[f.PresetCamera.CameraPerspectiveHeroicRightFacing]=[345.7069,348.9837,357.3732],a[f.PresetCamera.CameraPerspectiveHeroicExtremeLeftFacing]=[34.46068,8.12245,357.0914],a[f.PresetCamera.CameraPerspectiveHeroicExtremeRightFacing]=[325.5393,8.12245,2.9086],a[f.PresetCamera.CameraPerspectiveRelaxed]=[0,309.5601,0],a[f.PresetCamera.CameraPerspectiveRelaxedModerately]=[0,324.844,0]},b.prototype.SetPresetCamera=function(a){var b=this;b.jra=a,b.Dirty(k.PresetCamera)},b.prototype.UpdatePresetCamera=function(){var a=this;a.jra===f.PresetCamera.PresetCameraNone&&a.SetPresetCamera(f.PresetCamera.CameraOrthographicFront)},b.prototype.IncrementRotationX=function(a){this.RotationX+=a},b.prototype.IncrementRotationY=function(a){this.RotationY+=a},b.prototype.IncrementRotationZ=function(a){this.RotationZ+=a},b.prototype.ResetRotation=function(){var a=this;a.RotationX=0,a.RotationY=0,a.RotationZ=0},b.prototype.Clone=function(){var a=this,c=new b(a.xc);return c.pra=a.pra,c.qra=a.qra,c.$qa=a.$qa,c.rra=a.rra,c.sra=a.sra,c._qa=a._qa,j(a.tra)||(c.tra=a.tra.Clone()),c.ura=a.ura,c.ora=a.ora,j(a.vra)||(c.vra=a.vra.Clone()),c.ara=a.ara,c.bra=a.bra,c.wra=a.wra,c.hra=a.hra,c.jra=a.jra,c.xra=a.xra,c.yra=a.yra,c.zra=a.zra,c.Ara=a.Ara,c.Bra=a.Bra,c.Cra=a.Cra,c.Dra=a.Dra,c.kra=a.kra,c.lra=a.lra,c.mra=a.mra,c.bz=a.bz,c.nra=a.nra,c.rpa=a.rpa,c.hqa=a.hqa,c},b.prototype.IsDirtyIncludingParent=function(b){var c=this;return!(!c.tra||!c.tra.IsDirtyIncludingParent(b))||(!(!c.vra||!c.vra.IsDirtyIncludingParent(b))||a.prototype.IsDirtyIncludingParent.call(this,b))},b.prototype.OnParentChanged=function(a){var b=this;b.hqa=a,j(b.hqa)&&(b.tra&&(b.tra.ParentStateful=m),b.vra&&(b.vra.ParentStateful=m))},b.prototype.FromOOModel=function(a){var b=this;b.Lqa=a,b.FromCT_Scene3D(b.Lqa.Scene3D),b.FromCT_View3D(b.Lqa.View3D),b.FromCT_Shape3D(b.Lqa.Shape3D)},b.prototype.FromSJSOOModel=function(a,b,c){var d=this;d.Lqa={scene3d:a,sp3d:b,extLst:c},a||b?(d.oeK(a),d.peK(b)):c&&d.qeK(c)},b.prototype.reK=function(a){if(a){var b=this,c=a.lat,d=a.lon,e=a.rev;b.RotationX=parseInt(d,10)/i,b.RotationY=parseInt(c,10)/i,b.RotationZ=parseInt(e,10)/i}},b.prototype.seK=function(a){var b=this,c=a.prst,d=a.rot;b.ira(f.ST_PresetCameraType[c]),j(d)||b.reK(d)},b.prototype.oeK=function(a){var b=this,c=a.camera,d=a.extLst;c&&b.seK(c),d&&b.qeK(d)},b.prototype.teK=function(a){var b={w:76200,h:76200,prst:1},c=a.w,d=a.h,e=a.prst;return c&&(b.w=parseInt(c,10)),d&&(b.h=parseInt(d,10)),e&&(b.prst=f.ST_BevelPresetType[e]),b},b.prototype.peK=function(a){var b,c,d,e,f;a&&(b=this,c=a.extrusionH,c&&(d=h(parseInt(c,10)),0!==d&&(b.Depth=d,b.Dirty(k.Depth))),a.z&&(e=h(parseInt(a.z,10)),0!==e&&(b.Z=e,b.Dirty(k.Z))),f=a.extLst,f&&b.qeK(f))},b.prototype.qeK=function(a){var b,c=this,d=a&&a.ext;d&&(b=[].concat(d),b.forEach(function(a){var b=j(a.uri)?"":a.uri,d=a.scene3d,e=a.sp3d;b===f.OOXMLFileHelper.HiddenScene3dUri?c.oeK(d):b===f.OOXMLFileHelper.HiddenSp3dUri&&c.peK(e),(d||e)&&(c._InternalVisible=!1,c.Dirty(k.Visible))}))},b.prototype.ToOOModel=function(a){var b=this,c=b.Lqa||{};return c.View3D=b.ToCT_View3D(),b.PresetCamera!==f.PresetCamera.PresetCameraNone&&(c.Scene3D=b.ToCT_Scene3D()),(b.IsPropDirtyIncludingParent(k.Depth,!0)||b.IsPropDirtyIncludingParent(k.Z,!0))&&(c.Shape3D=b.ToCT_Shape3D()),c},b.prototype.FromCT_View3D=function(a){var b=this;j(a)||(j(a.hPercent)||(b._HeightPercent=a.hPercent),j(a.depthPercent)||(b._DepthPercent=a.depthPercent),j(a.rotX)||(b.RotationY=a.rotX),j(a.rotY)||(b.RotationX=a.rotY),j(a.rAngAx)?b._RightAngleAxes=!1:b._RightAngleAxes=a.rAngAx,j(a.perspective)||(b.Perspective=a.perspective/2))},b.prototype.ToCT_View3D=function(){var a=this,b=a.Lqa&&a.Lqa.View3D||{};return!a._AutoScale&&a.IsDirty(k.HeightPercent)&&(b.hPercent=a._HeightPercent),a.IsDirty(k.DepthPercent)&&(b.depthPercent=a._DepthPercent),a.IsDirty(k.RotationY)&&(b.rotX=a.RotationY),a.IsDirty(k.RotationX)&&(b.rotY=a.RotationX),a.IsDirty(k.RightAngleAxes)&&(b.rAngAx=a._RightAngleAxes),!a._RightAngleAxes&&a.IsDirty(k.Perspective)&&(b.perspective=2*a.Perspective),b},b.prototype.FromCT_Scene3D=function(a){j(a)||this.FromCT_Camera(a.camera)},b.prototype.ToCT_Scene3D=function(){var a=this,b=a.Lqa,c=b&&b.Scene3D||{};return c.camera=a.ToCT_Camera(),!j(c.camera)&&j(c.lightRig)&&(c.lightRig=a.ToDefaultCT_LightRig()),j(c.camera)&&j(c.backdrop)&&j(c.lightRig)?m:c},b.prototype.GetActualCT_Scene3D=function(){var a=this;return j(a.Lqa)||j(a.Lqa.Scene3D)?j(a.hqa)?m:a.GetActualCT_Scene3D():a.Lqa.Scene3D},b.prototype.FromCT_Shape3D=function(a){var b=this;j(a)||(0!==a.extrusionH&&(b.Depth=a.extrusionH,b.Dirty(k.Depth)),0!==a.z&&(b.Z=a.z,b.Dirty(k.Z)))},b.prototype.ToCT_Shape3D=function(){var a=this,b=a.Lqa,c=b&&b.Shape3D||{z:0,extrusionH:0,contourW:0,prstMaterial:f.ST_PresetMaterialType.warmMatte};return c.extrusionH=a.Depth,c.z=a.Z,c},b.prototype.ToDefaultCT_LightRig=function(){return{rig:f.LightRigType.LightRigThreePoint,dir:f.PresetLightingDirection.LightingTopLeft}},b.prototype.FromCT_Camera=function(a){j(a)||(this.ira(a.prst),j(a.rot)||this.FromCameraCT_SphereCoords(a.rot))},b.prototype.ToCT_Camera=function(){var a,b,c=this;return c.xc.DrawingType===f.DrawingType.Shape||c.xc.DrawingType===f.DrawingType.GroupShape?(a={zoom:1e5},a.prst=c.PresetCamera,a.rot=c.ToCameraCT_SphereCoords(),a):(b=c.Lqa,b&&b.Scene3D&&b.Scene3D.camera||m)},b.prototype.FromCameraCT_SphereCoords=function(a){var b=this;j(a)||(b.RotationX=a.lon/i,b.RotationY=a.lat/i,b.RotationZ=a.rev/i)},b.prototype.ToCameraCT_SphereCoords=function(){var a,b,c,d,e=this;return 0===e.RotationX&&0===e.RotationY&&0===e.RotationZ?m:(a={},b=e.RotationX,c=e.RotationY,d=e.RotationZ,a.lon=b*i,a.lat=c*i,a.rev=d*i,a)},Object.defineProperty(b.prototype,"Perspective",{get:function(){var a=this;return a.Dirty(k.Perspective),j(a.hqa)?a.hra:a.hqa.Perspective},set:function(a){var b=this;b.hra=a,b.Dirty(k.Perspective)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"PresetCamera",{get:function(){var a=this;return a.Dirty(k.PresetCamera),j(a.hqa)?a.jra:a.hqa.PresetCamera},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"RotationX",{get:function(){var a=this;return a.Dirty(k.RotationX),j(a.hqa)?a.Visible?a.kra:0:a.hqa.RotationX},set:function(a){var b=this;a!==b.kra&&(b.kra=a,b.Dirty(k.RotationX),b.UpdatePresetCamera())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"RotationY",{get:function(){var a=this;return a.Dirty(k.RotationY),j(a.hqa)?a.Visible?a.lra:0:a.hqa.RotationY},set:function(a){var b=this;if(b.xc.DrawingType===f.DrawingType.Chart){if(a<-90&&a>=180)return}else if(a<0&&a>=360)return;b.lra=a,b.Dirty(k.RotationY),b.UpdatePresetCamera()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"RotationZ",{get:function(){var a=this;return a.Dirty(k.RotationZ),j(a.hqa)?a.Visible?a.mra:0:a.hqa.RotationZ},set:function(a){var b=this;a!==b.mra&&(b.mra=a,b.Dirty(k.RotationZ),b.UpdatePresetCamera())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Visible",{get:function(){var a=this;return a.Dirty(k.Visible),j(a.hqa)?a.bz:a.hqa.Visible},set:function(a){var b=this;b.bz=a,b.Dirty(k.Visible)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Z",{get:function(){var a=this;return a.Dirty(k.Z),j(a.hqa)?a.Visible?a.nra:0:a.hqa.Z},set:function(a){var b=this;b.nra=a,b.Dirty(k.Z),b.UpdatePresetCamera()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"Depth",{get:function(){var a=this;return a.Dirty(k.Depth),j(a.hqa)?a.Visible?a.ora:0:a.hqa.Depth},set:function(a){var b=this;b.ora=a,b.Dirty(k.Depth),b.UpdatePresetCamera()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"DicCameraType",{get:function(){var a=this;return j(a.cra)&&a.InitDicCameraType(),a.cra},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"_InternalVisible",{get:function(){return this.bz},set:function(a){this.bz=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"_AutoScale",{get:function(){return this.dra},set:function(a){var b=this;b.dra=a,b.Dirty(k.AutoScale)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"_DepthPercent",{get:function(){return this.era},set:function(a){var b=this;a>=20&&a<=2e3&&(b.era=a,b.Dirty(k.DepthPercent))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"_HeightPercent",{get:function(){return this.fra},set:function(a){var b=this;a>=5&&a<=500&&(b.fra=a,b.Dirty(k.HeightPercent))},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"_RightAngleAxes",{get:function(){return this.gra},set:function(a){var b=this;b.gra=a,b.Dirty(k.RightAngleAxes)},enumerable:!0,configurable:!0}),b}(e.StatefulBase),b.ThreeDFormat=n},"./dist/plugins/floatingObject/floatingobject-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=this&&this.__extends||function(){var a=function(b,c){
return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("./dist/plugins/floatingObject/floatingobject.js"),g=e.GC$,h=g.isArray,i=d.Common.k.ac,j=null,k=Math.min,l=d.Common.j.Fa,m="unSelectAllFloatingObjects",n="deleteFloatingObjects",o="navigationNextFloatingObject",p="navigationPreviousFloatingObject",q="cutFloatingObjects",r="copyFloatingObjects",s="pasteFloatingObjects",t="dragCopyFloatingObjects",u="selectAllFloatingObjects",v="moveFloatingObjects",w="moveFloatingObjectsUp",x="moveFloatingObjectsDown",y="moveFloatingObjectsLeft",z="moveFloatingObjectsRight",A="resizeFloatingObjects",B="isSelected",C="name",D="cancel",E=e.Commands.h4;function O(a){var b=a.wr,c=!1;return b&&b.zR().forEach(function(a){a&&a[B]()&&(c=!0)}),c}function P(a,b){var c=i(b),d,e;if(i(b)>0)for(d=0;d<c;d++)e=a.wr.NR(b[d]),e&&e.isSelected(!0)}function Q(a,b,c,d,e){var f,g,h,i=a.parent,j=[],k=a.wr;if(d)j=d;else for(f=0;f<c.length;f++)j.push(k.NR(c[f]));i&&b.xC&&j[0]&&(g=j[0].startRow(),h=j[0].startColumn(),i.changeSelectionInCommandExecuting(b,g,h,[],j),b.xC.rNc=e)}F=function(a){N(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.canExecute=function(){return!!O(this.kj)},b.prototype.canUndo=function(){var a=e.Commands.bWa(this.kj.name()),b=this.VQ[a],c=b&&b.floatingObjectChanges;return!!(c&&i(c)>0)||(c=b&&b.slicerChanges,!!(c&&i(c)>0))},b}(e.Commands.ActionBase),b.FloatingObjectUndoActionBase=F,G=function(a){N(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,d,f,g,j=this,k=!1,l=j.kj,m=j.VQ,n=m.floatingObjects;if(j.canExecute()&&h(n)){for(Q(l,m,n),l.ITa.startTransaction(),j.Lz(l,!0),a=l.wr,b=0,c=i(n);b<c;b++)d=a.NR(n[b]),d&&(f=l.slicers,j.zS(d)&&f&&f.vV(d[C]()),a.Fb(n[b],!0),d[B](!1));l.GJ(),j.Mz(l,!0),g=e.Commands.bWa(l.name()),m[g]=l.ITa.endTransaction(),k=i(n)>0}return k},b.prototype.undo=function(){var a,b=this,c=b.VQ,d=b.kj;return!!b.canUndo()&&(b.Lz(d,!0),a=e.Commands.bWa(d.name()),d.ITa.undo(c[a]),d.EJ(),b.Mz(d,!0),!0)},b.prototype.zS=function(a){return a&&"Slicer"===a.typeName},b}(F),b.DeleteFloatingObjectUndoAction=G;function R(a){var b,c=a,d=c.kj;return!!c.canUndo()&&(c.Lz(d,!0),b=e.Commands.bWa(d.name()),d.ITa.undo(c.VQ[b]),c.Mz(d,!0),!0)}H=function(a){N(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!0},b.prototype.execute=function(){var a,b,c,d,f,g,j=this,k=!1,l=j.VQ,m=l.floatingObjects,n=j.kj;if(j.canExecute()&&h(m)){for(Q(n,l,m),n.ITa.startTransaction(),j.Lz(n,!0),a=n.wr,b=0,c=i(m);b<c;b++)d=a.NR(m[b]),d.allowMove()&&(f=d.position(),d.position(new e.Point(f.x+l.offsetX,f.y+l.offsetY)));j.Mz(n,!0),g=e.Commands.bWa(n.name()),l[g]=n.ITa.endTransaction(),k=i(m)>0}return k},b.prototype.undo=function(){return R(this)},b}(F),b.MovingFloatingObjectUndoAction=H,I=function(a){N(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,d,f,g,j=this,k=!1,l=j.VQ,m=l.floatingObjects,n=j.kj;if(P(n,m),j.canExecute()&&h(m)){for(Q(n,l,m),n.ITa.startTransaction(),j.Lz(n,!0),a=n.wr,b=0,c=i(m);b<c;b++)d=a.NR(m[b]),d.allowResize()&&(f=d.position(),d.width(d.width()+l.offsetWidth),d.height(d.height()+l.offsetHeight),d.position(new e.Point(f.x+l.offsetX,f.y+l.offsetY)));j.Mz(n,!0),g=e.Commands.bWa(n.name()),l[g]=n.ITa.endTransaction(),k=i(m)>0}return k},b.prototype.undo=function(){return R(this)},b}(F),b.ResizingFloatingObjectUndoAction=I,J=function(a){N(b,a);function b(){var b=a.call(this)||this;return b.kj=j,b}return b.prototype.canExecute=function(){var a=this,b=a.VQ.floatingObjects;return!!(i(b)>0&&a.ES(b))},b.prototype.canUndo=function(){var a=e.Commands.bWa(this.kj.name()),b=this.VQ[a],c=b&&b.floatingObjectChanges;return!!(c&&i(c)>0)},b.prototype.ES=function(a){var b,c,d,e=this,f=e.kj,g=f.wr;for(b=0,c=i(a);b<c;b++)if(d=g.NR(a[b]),d&&!f.ER(d))return!1;return!0},b.prototype.zS=function(a){return a&&"Slicer"===a.typeName},b}(e.Commands.ActionBase),b.FloatingObjectCopyPasteUndoAction=J,K=function(a){N(b,a);function b(b,c){var d=a.call(this)||this,e=d;return e.OFFSET=15,e.kj=b,e.VQ=c,l(c.clipboardFloatingObjectData)&&(c.clipboardFloatingObjectData=c.fromSheet.CR),d}return b.prototype.execute=function(){var a,b,c,d,f,g,h,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,D,E,F,G,H,I,J,K,L,M=this,N=M.VQ,P=N.floatingObjects;if(M.canExecute()){for(a=M.kj,b=N.fromSheet,a.ITa.startTransaction(),M.Lz(a,!0),c=[],d=a.wr,f=N.clipboardFloatingObjectData,void 0===N.Jl&&(O(a)&&d.zR().forEach(function(a){a&&a[B]()&&c.push(a)}),N.Jl=M.kj.getActiveRowIndex(),N.GS=M.kj.getActiveColumnIndex()),O(a)&&d.zR().forEach(function(a){a&&a[B]()&&a[B](!1)}),g=[],h=void 0,j=void 0,l=Number.MAX_VALUE,m=l,n=l,o=[],j=i(P),h=0;h<j;h++)p=f.find(P[h]).position(),m=k(m,p.x),n=k(n,p.y),o.push(new e.Point(p.x-m,p.y-n));if(q=0,r=0,c.length)s=l,t=l,c.forEach(function(a){if(a){var b=a.position();s=k(s,b.x),t=k(t,b.y)}}),q=s<l?s+M.OFFSET:0,r=t<l?t+M.OFFSET:0;else{for(u=0;u<N.Jl;u++)r+=a.Yr(u,3);for(v=0;v<N.GS;v++)q+=a.$r(v,3)}for(j=i(P),h=0;h<j;h++)w=o[h],g.push(new e.Point(q+w.x,r+w.y));for(x=N.isCutting,y=b.wr,z=[],A=[],j=i(P),h=0;h<j;h++)D=f.find(P[h]),E=D.clone(a),E.sheet(a),z.push(E),A.push(D);if(F=!1,G={sheet:a,sheetName:a.name(),objects:z,fromSheet:N.fromSheet,isCutting:N.isCutting,cancel:!1,action:N.isCutting?e.ClipboardActionType.cut:e.ClipboardActionType.copy},a.Wq(e.Events.ClipboardPasting,G),!G.cancel){for(h=0;h<j;h++)E=z[h],H=void 0,I=!1,D=A[h],!x||y.NR(P[h])||d.NR(P[h])?(I=E.name()===D.name(),I&&(J=U(E),H=M.zS(E)?a.slicers.HS(E[C]()):d.FS(J))):H=D.name(),I&&E[C](H),M.zS(E)&&(a.slicers.Cz(E),E.width(D.width()),E.height(D.height())),E.isVisible(!0),E.position(g[h]),E[B](!0),d.Sb(E);Q(a,N,null,z,!0),K={sheet:a,sheetName:a.name(),objects:z,fromSheet:N.fromSheet,isCutting:N.isCutting,action:N.isCutting?e.ClipboardActionType.cut:e.ClipboardActionType.copy},a.Wq(e.Events.ClipboardPasted,K),F=!0}return M.Mz(a,!0),L=e.Commands.bWa(a.name()),N[L]=a.ITa.endTransaction(),F||(N.lDc=!0),F}return!1},b.prototype.undo=function(){var a,b,c=this;return!!c.canUndo()&&(a=c.kj,c.Lz(a,!0),b=e.Commands.bWa(a.name()),a.ITa.undo(c.VQ[b]),c.Mz(a,!0),!0)},b}(J),b.ClipboardPasteFloatingObjectUndoAction=K,L=function(a){N(b,a);function b(b,c){var d=a.call(this)||this,e=d;return e.kj=b,e.VQ=c,d}return b.prototype.execute=function(){var a,b,c,d,f,g,h,j,k,l=this,m=!1,n=l.VQ,o=n.floatingObjects,p=l.kj;if(l.canExecute()){for(Q(p,n,o),p.ITa.startTransaction(),l.Lz(p,!0),a=p.wr,b=i(o),c=0;c<b;c++)d=a.NR(o[c]),d&&(f=d.clone(p),f.sheet(p),g=d.position(),f.position(new e.Point(g.x+n.offsetX,g.y+n.offsetY)),f[C](a.FS()),f[B](!0),d[B](!1),l.zS(f)&&p.slicers&&(h=f,j=p.slicers.HS(h.columnName()),h[C](j),p.slicers.Cz(h)),a.Sb(f));l.Mz(p,!0),k=e.Commands.bWa(p.name()),n[k]=p.ITa.endTransaction(),m=!0}return m},b.prototype.undo=function(){var a,b=this,c=b.kj;return!!b.canUndo()&&(b.Lz(c,!0),a=e.Commands.bWa(c.name()),c.ITa.undo(b.VQ[a]),b.Mz(c,!0),!0)},b}(J),b.DragCopyFloatingObjectUndoAction=L;function S(a){var b=[];return a.wr.zR().forEach(function(a){a[B]()&&b.push(a[C]())}),b}function T(a,b,c){var d,e,g,h,k=a.BR(),l=k.fromSheet;for(k.fromSheet=a,k.isCutting=c,d=new f.yR,e=0,g=0;g<i(b);g++)h=a.wr.NR(b[g]),h&&(d.push(h),e++);return l&&(l.CR=j),a.CR=d,e>0}function U(a){var b,c=a.typeName;switch(c){case"0":case"1":break;case"2":b="Chart "}return b}e.Commands[m]={canUndo:!1,execute:function(a,b){var c=e.Commands.bT(a,b);return!!O(c)&&(c.suspendPaint(),c.uQ(),c.GJ(),c.resumePaint(),!0)}},e.Commands[u]={canUndo:!1,execute:function(a,b){var c=e.Commands.bT(a,b);c.isEditing()||(c.suspendPaint(),c.wr.zR().forEach(function(a){a[B](!0)}),c.resumePaint())}},e.Commands[n]={canUndo:!0,execute:function(a,b,c){var d,f=e.Commands.bT(a,b);return c||(b.cmd||(b.cmd=n),b.floatingObjects||(d=S(f),b.floatingObjects=d)),i(b.floatingObjects)>0&&E(a,G,b,c)}},e.Commands[o]={canUndo:!1,execute:function(a,b){var c,d,f,g,h,i,j,k=e.Commands.bT(a,b);if(O(k)){for(k.suspendPaint(),c=void 0,d=void 0,f=void 0,g=void 0,h=k.wr.zR(),i=h.length,g=0;g<i;g++){if(j=h[g],d||(d=j),c){f=j;break}j&&j[B]()&&(c=j)}return k.uQ(),f||(f=d),f&&f[B](!0),k.resumePaint(),!0}return!1}},e.Commands[p]={canUndo:!1,execute:function(a,b){var c,d,f,g,h,i,j=e.Commands.bT(a,b);if(O(j)){for(j.suspendPaint(),c=void 0,d=void 0,f=void 0,g=j.wr.zR(),h=g.length,f=0;f<h;f++)if(i=g[f],c||(c=i),c[B]())d=i;else if(i[B]()||(d=i),i[B]())break;return d&&(j.uQ(),d[B](!0)),j.resumePaint(),!0}return!1}};function V(a){var b=[];return a.wr.zR().forEach(function(a){a[B]()&&b.push(a[C]())}),b}e.Commands[q]={canUndo:!0,execute:function(a,b,c){var d,f,g,h,j,k,l,m=!1;return c?m=E(a,G,b,c):(d=e.Commands.bT(a,b),b.cmd||(b.cmd=q),f=d.BR(),b.floatingObjects||(g=S(d),b.floatingObjects=g,b.fromSheet=f.fromSheet,b.isCutting=f.isCutting),h=b.floatingObjects,j=void 0,k=void 0,l=void 0,i(h)>0&&(k=h.map(function(a){return d.wr.NR(a)}),j={sheet:d,sheetName:d.name(),objects:k,isCutting:!0,cancel:!1,action:e.ClipboardActionType.cut},d.Wq(e.Events.ClipboardChanging,j),j.cancel?b.lDc=!0:(l=T(d,h,!0),l&&(d.Sob&&d.Sob(),e.Commands.Yxb(d.parent)),m=E(a,G,b,c),d.Wq(e.Events.ClipboardChanged,{sheet:d,sheetName:d.name(),objects:k})))),m}},e.Commands[r]={canUndo:!1,execute:function(a,b){var c,d,f,g=e.Commands.bT(a,b),h=V(g);if(i(h)>0){if(c=h.map(function(a){return g.wr.NR(a)}),d={sheet:g,sheetName:g.name(),objects:c,isCutting:!1,cancel:!1,action:e.ClipboardActionType.copy},g.Wq(e.Events.ClipboardChanging,d),!d.cancel)return f=T(g,h,!1),f&&(g.Sob&&g.Sob(),e.Commands.Yxb(g.parent)),g.Wq(e.Events.ClipboardChanged,{sheet:g,sheetName:g.name(),objects:c}),f;b.lDc=!0}return!1}},e.Commands[s]={canUndo:!0,execute:function(a,b,c){var d,f,g,h,j=e.Commands.bT(a,b);return!j.isEditing()&&(d=j.BR(),f=d.fromSheet,!!(g=f&&f.CR)&&(h=[],g.each(function(a){h.push(a[C]())}),0!==i(h)&&(!j.Js&&(c||(b.cmd||(b.cmd=s),b.floatingObjects||(b.floatingObjects=h,b.fromSheet=f,b.isCutting=d.isCutting)),i(b.floatingObjects)>0&&E(a,K,b,c)))))}},e.Commands[t]={canUndo:!0,execute:function(a,b,c){return E(a,L,b,c)}},function(a){a[a.left=0]="left",a[a.up=1]="up",a[a.right=2]="right",a[a.down=3]="down"}(M||(M={}));function W(a){return function(b,c){var d,f,g=e.Commands.bT(b,c),h=0;return a===M.left?h=-1:a===M.right&&(h=1),d=0,a===M.up?d=-1:a===M.down&&(d=1),f=S(g),i(f)>0&&g.wu().execute({cmd:v,sheetName:g.name(),floatingObjects:f,offsetX:h,offsetY:d})}}e.Commands[y]=W(M.left),e.Commands[w]=W(M.up),e.Commands[z]=W(M.right),e.Commands[x]=W(M.down),e.Commands[v]={canUndo:!0,execute:function(a,b,c){return(0!==b.offsetX||0!==b.offsetY)&&E(a,H,b,c)}},e.Commands[A]={canUndo:!0,execute:function(a,b,c){return E(a,I,b,c)}},e.Commands.JR=function(a){var b=e.Ul.sl(),c=!b,d=b;a.register(m,e.Commands[m],27,!1,!1,!1,!1),a.register(u,e.Commands[u],65,c,!1,!1,d),a.register(n,e.Commands[n],b?8:46,!1,!1,!1,!1),a.register(o,e.Commands[o],9,!1,!1,!1,!1),a.register(p,e.Commands[p],9,!1,!0,!1,!1),a.register(q,e.Commands[q],88,c,!1,!1,d),a.register(r,e.Commands[r],67,c,!1,!1,d),a.register(t,e.Commands[t]),a.register(s,e.Commands[s],86,c,!1,!1,d),a.register(v,e.Commands[v]),a.register(w,e.Commands[w],38,!1,!1,!1,!1),a.register(x,e.Commands[x],40,!1,!1,!1,!1),a.register(y,e.Commands[y],37,!1,!1,!1,!1),a.register(z,e.Commands[z],39,!1,!1,!1,!1),a.register(A,e.Commands[A])}},"./dist/plugins/floatingObject/floatingobject-touch.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Touch"),e=c("Core"),f=c("./dist/plugins/floatingObject/floatingobject.js"),g=e.Ul.nl,h=null,i=function(){function a(a,b,c){var e,f,g=this;g.yM=new d.jR(g),g.DQ=new d.kR(a,"FL_"+b.name,g.yM,2,200),g.BQ=c,g.CQ=new j(a,b),e=g.CQ,f=g.DQ,f._M=function(){return b.YR.isSelected()},f.bN=function(){return!0},f.dN=function(a){return e.jQ(a)},f.eN=function(a){return e.lQ(a)},f.fN=function(a){return e.pQ(a)},f.hN=function(a){return e.qQ(a)},f.iN=function(a){return e.sQ(a)}}return a.prototype.EQ=function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},a.prototype.FQ=function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},a.prototype.GQ=function(a){return this.yM.GQ()},a.prototype.HQ=function(a){return this.yM.HQ()},a.prototype.IQ=function(a){return this.yM.IQ()},a}(),j=function(){function a(a,b){var c=this;c.MS=b,c.YR=b.YR,c.NS=a,c.hQ=new d.TP(b.kj)}return a.prototype.OS=function(a){var b,c=new d.oP(a.X,a.Y),f=e.GC$(this.NS).offset();return f&&(b=document.body,c.X+=f.left+b.clientLeft||0,c.Y+=f.top+b.clientTop||0),c},a.prototype.jQ=function(a){a.DO=3},a.prototype.lQ=function(a,b){var c=this,d=b?a.rN:c.OS(a.rN);c.MS.AD({target:a.GP,isTouch:!0,button:0,pageX:d.X,pageY:d.Y,stopPropagation:function(){}}),b||c.hQ.OP()},a.prototype.pQ=function(a,b){var c=this,d=b?a.rN:c.OS(a.rN),e=a.dP.rO,f=c.MS.kj,g=f.parent;1!==e&&g&&g.options.allowUserZoom&&!b?(f.mm.O3=!1,c.MS.rS(),c.hQ.PP(e)):c.MS.BD({isTouch:!0,button:0,pageX:d.X,pageY:d.Y,stopPropagation:function(){}})},a.prototype.qQ=function(a,b){var c=this,d=b?a.rN:c.OS(a.rN),e=a.dP.rO,f=c.MS.kj,g=f.parent;1!==e&&g&&g.options.allowUserZoom&&!b?c.hQ.SP(e):this.MS.CD({isTouch:!0,button:0,pageX:d.X,pageY:d.Y,stopPropagation:function(){}})},a.prototype.sQ=function(b,c){var d,f,g,i=this,j=c?b.rN:i.OS(b.rN),k={e:{rN:j},r:h};if(a.ao(i,"preProcessTapped",k),!k.r)try{d=i.MS.kj,d.suspendPaint(),i.YR.isSelected()?(f=d.parent.touchToolStrip,g=100,f.open(j.X,j.Y-g)):(d.uQ(),i.YR.isSelected(!0),d.Wq(e.Events.FloatingElementSelected,{type:"floatingObject"}),e.Vl.Zl(d)),d.clearSelection()}finally{d.resumePaint()}},a}(),b.FloatingObjectTouchEventHandler=j,e.Zn(j),e.Rxb.touch&&f.FloatingObjectRender.$n("touch",{init:function(a){var b=this,c=b.wR=new i(a,b,b.kj.parent.BQ);c.EQ()},dispose:function(){var a=this.wR;a&&a.FQ()},preProcessMouseDown:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.GQ(b)&&(g(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.IQ(b)&&(g(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=this.wR;c&&!b.isTouch&&c.HQ(b)&&(g(b),a.r=!0)}})},"./dist/plugins/floatingObject/floatingobject.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/floatingObject/picture.js")),d(c("./dist/plugins/floatingObject/floatingobject.js")),d(c("./dist/plugins/floatingObject/floatingobject-actions.js")),d(c("./dist/plugins/floatingObject/floatingobject-touch.js")),d(c("./dist/plugins/floatingObject/floatingobject.ns.js"));var e=c("./dist/plugins/floatingObject/drawing/chart.ns.js");b.Drawing=e},"./dist/plugins/floatingObject/floatingobject.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/floatingObject/floatingobject.ns.js"),g=c("./dist/plugins/floatingObject/drawing/chart.ns.js"),h=c("./dist/plugins/floatingObject/drawing/common.js"),i=d.UsedRangeUtil.SZJ,j=d.XFileConstants.bbK,k=d.XFileConstants.epa,l=d.Ul.PcK,m=d.Util.ZkK,n=d.Util.$kK,o=d.Util._kK,p=function(){function a(){this.rM={}}return a.prototype.push=function(a){this.rM[Ea(a)]=a},a.prototype.remove=function(a){delete this.rM[a]},a.prototype.find=function(a){return this.rM[a]},a.prototype.empty=function(){delete this.rM,this.rM={}},a.prototype.each=function(a){var b,c=this.rM;for(b in c)c.hasOwnProperty(b)&&a(c[b])},a.prototype.isEmpty=function(){var a,b=this.rM;for(a in b)if(b.hasOwnProperty(a))return!1;return!0},a}(),b.yR=p,q=d.Ul.JcK,r=d.Ul.KcK,s=d.Ul.McK,t=d.Ul.LcK,u=d.NodeHelper.oca,v=d.NodeHelper.pca,w=d.ExcelHelper.emuToPixles,x=d.ExcelHelper.pixelToEMU,y=d.ExcelHelper.getActualColumnWidth,z=d.ExcelHelper.getActualRowHeight,A=d.Util.xiK,B=d.Util.ZaK,C=d.Util.XaK,D=h.ChartUtility.GetIs2016ChartByChartType,E=d.Util.clK,F=new e.Common.ResourceManager(f.SR,"FloatingObjects"),G=F.getResource.bind(F),H=e.Common.j,I=e.Common.D,J=H.Fa,K=H.Ma,L=d.Ul.Pl,M=d.Ul.Ol,N=d.Ul.Nl,O=d.Ul.Rl,P=p,Q=document,R=I,S=null,T=void 0,U=Math.ceil,V=Math.floor,W=Math.max,X=Math.min,Y=Math.abs,Z={dLb:"div",oHc:"on",pHc:"z-index",pGc:"move",qHc:"unselectable",rHc:1,Gcc:"border",sHc:9007199254740992,tHc:"floatingObjects",uHc:".gcFloatingObject",vHc:"name",wHc:"scroll",rFc:"x",xHc:"y",uGc:"width",vGc:"height",yHc:"startRow",zHc:"startRowOffset",AHc:"startColumn",BHc:"startColumnOffset",CHc:"endRow",DHc:"endRowOffset",EHc:"endColumn",FHc:"endColumnOffset",GHc:"isSelected",HHc:"isLocked",IHc:"isVisible",JHc:"canPrint",KHc:"dynamicSize",LHc:"dynamicMove",MHc:"fixedPosition",NHc:"allowResize",OHc:"allowMove",PHc:700,QHc:701,RHc:"position",SHc:"absolute",THc:"background",UHc:"gc-no-user-select",VHc:"gc-floatingobject-selected",WHc:"gc-floatingobject-unselected",XHc:"gc-floatingobject-resize-indicator-select",YHc:"gc-floatingobject-resize-indicator-unSelect",ZHc:"gc-floatingobject-content-container",$Hc:"gc-floatingobject-container",_Hc:"gc-floatingobject-moving-container",aIc:"gc-floatingobject-moving-div",bIc:".gc-floatingobject-resize-indicator",cIc:"gc-floatingobject-resize-indicator",dIc:"gc-floatingobject-absolute",eIc:"gc-floatingobject-top",fIc:"gc-floatingobject-middle",gIc:"gcfloatingobject-bottom",hIc:"gc-floatingobject-left",iIc:"gc-floatingobject-center",jIc:"gc-floatingobject-right",kIc:"content",TGc:"gc-no-user-select",lIc:"100%",mIc:"gc-floatingobject-background-cover",nIc:".fos",rGc:"left",oIc:"center",sGc:"right",Lcc:"top",pIc:"middle",tGc:"bottom",fHc:"-resize",PGc:"cursor",qIc:"mousemove",rIc:"mouseup",sIc:"startX",tIc:"startY",uIc:"startWidth",vIc:"startHeight",wIc:"endX",xIc:"endY",yIc:"startTopRow",zIc:"startLeftColumn"},function(a){a[a.twoCell=0]="twoCell",a[a.oneCell=1]="oneCell",a[a.absolute=2]="absolute"}($||($={})),_=Z.dLb+"."+Z.cIc,aa=_+"."+Z.eIc+"."+Z.hIc,ba=_+"."+Z.fIc+"."+Z.hIc,ca=_+"."+Z.gIc+"."+Z.hIc,da=_+"."+Z.eIc+"."+Z.iIc,ea=_+"."+Z.gIc+"."+Z.iIc,fa=_+"."+Z.eIc+"."+Z.jIc,ga=_+"."+Z.fIc+"."+Z.jIc,ha=_+"."+Z.gIc+"."+Z.jIc,ia=Z.Lcc+Z.rGc,ja=Z.Lcc+Z.oIc,ka=Z.Lcc+Z.sGc,la=Z.pIc+Z.rGc,ma=Z.pIc+Z.sGc,na=Z.tGc+Z.rGc,oa=Z.tGc+Z.oIc,pa=Z.tGc+Z.sGc;function Da(a,b,c){b=b||c;for(var d=b,e=1;a.indexOf(d)>-1;)d=b+"_"+e,e++;return d}function Ea(a){return"string"==typeof a[Z.vHc]?a[Z.vHc]:a[Z.vHc]()}qa=function(){var a=this;a.uQ=function(){var a=this.wr;a&&a.zR().forEach(function(a){a.isSelected(!1)})},a.AR=function(){var a=this,b=a.wr;b&&(b.isNeedToUpdateLayout=!0)},a.BR=function(){var a=this,b=a.parent,c=a.tv,d=b&&b.tv;return c||(c=a.tv=d?d:{fromSheet:S,isCutting:!1}),c},a.ex=function(){var a=this,b=a.BR(),c=b&&b.fromSheet;c&&(c.CR=S),b.fromSheet=S,b.isCutting=!1},a.DR=function(a){var b=this.options;return!b.isProtected||!a.isLocked()||b.protectionOptions.allowEditObjects},a.ER=function(a){var b=this.options;return!b.isProtected||!a.isLocked()||b.protectionOptions.allowEditObjects},a.isPasteFloatingObject=function(){var a=this,b=a.BR().fromSheet,c=this.CR;return!c&&b&&(c=b.CR),c&&!c.isEmpty()},a.IR=function(a,b){var c,d,e=this;return e.FR||(e.FR=[]),c=e.FR[a],c||(e.FR[a]=[]),d=e.FR[a][b],d||(e.FR[a][b]=new Aa(e)),d=e.FR[a][b]},a.QP=function(a,b){var c,d,e,f,g,h=this,i=h;if(!i.fI&&i.wr&&i.yl&&i.yl.bm())for(c=i.am(),d=void 0,b!==S&&void 0!==b||(b=i.zoom()),e=0;e<=2;e++)for(f=0;f<=2;f++)d=c.Ft(e,f),d&&(g=i.IR(e,f),g&&g.yl(e,f,b))}},qa.call(d.Worksheet.prototype);function Fa(a,b){var c,d,e,f,g,h,i,j=a.FR;if(j){for(c=void 0,d=void 0,e=void 0,f=void 0,e=j.length,c=0;c<e;c++)if(g=j[c]){for(f=g.length,d=0;d<f;d++)h=g[d],h&&h.no();g.length=0}j.length=0,a.FR=S}i=a.wr,i&&b!==!1&&i.no()}function Ga(a,b,c){a.zR().forEach(function(a){a.rI(b,c)})}function Ha(a,b,c){var d,e,f=[];for(a.zR().forEach(function(d){Ka(b,-1,b+c-1,a.sheet().getColumnCount(),d)&&(d.dynamicMove()||d.dynamicSize())?f.push(d):d.GR(b,c)}),e=f.length,d=0;d<e;d++)a.Fb(f[d].name())}function Ia(a,b,c){a.zR().forEach(function(a){a.tI(b,c)})}function Ja(a,b,c){var d,e,f=[];for(a.zR().forEach(function(d){Ka(-1,b,a.sheet().getRowCount(),b+c-1,d)&&(d.dynamicMove()||d.dynamicSize())?f.push(d):d.HR(b,c)}),e=f.length,d=0;d<e;d++)a.Fb(f[d].name())}function Ka(a,b,c,d,e){var f=e[Z.yHc](),g=e[Z.AHc](),h=e[Z.CHc](),i=e[Z.EHc]();return a<=f&&b<=g&&c>=h&&d>=i}function La(a,b){var c=this;return b||(b={}),d.GC$.each(a,function(a,d){var e=c[d],f=e.call(c);e.isDefault(f)||(b[d]=f)}),b}b.toJsonFn=La;function Ma(a,b){if(b){var c=this;d.GC$.each(a,function(a,d){b[d]!==T&&c[d].call(c,b[d],!1)})}}b.fromJsonFn=Ma;function Na(a){var b=a;return function(a,c){var d=this,e=d.sheet();b===Z.kIc&&(d.KR=!0),e&&e.$p(),d.onPropertyChanged(b,a,c)}}b.propertyRefreshCallback=Na;function Oa(a){var b=a;return function(a,c){var d=this,e=d.sheet();e&&(Qa(d),d.ROJ||Va(d),e.$p()),d.onPropertyChanged(b,a,c)}}function Pa(a){var b=a;return function(a,c){var d=this,e=d.sheet();e&&(kb(d),e.$p()),d.onPropertyChanged(b,a,c)}}function Qa(a){var b,c,e,f,g=a.sheet();function h(b,c,d,e){var f=0,h=b.call(a);return f=c.call(a,g,0,h),f+=Ra(d.call(a),e.call(g,h))}g&&(b=h(a[Z.yHc],Sa,a[Z.zHc],g.getRowHeight),c=h(a[Z.AHc],Ta,a[Z.BHc],g.getColumnWidth),e=a.x(),f=a.y(),e===c&&f===b||(a.x(c,!1),a.y(b,!1),a.onPropertyChanged("position",new d.Point(c,b),new d.Point(e,f))))}function Ra(a,b){return b>0&&b--,X(a,b)}function Sa(a,b,c,d){var e,f=0;for(e=b;e<c&&(f+=a.getRowHeight(e,3),!(f>d));e++);return f}function Ta(a,b,c,d){var e,f=0;for(e=b;e<c&&(f+=a.getColumnWidth(e,3),!(f>d));e++);return f}function Ua(a){var b=a.sheet();function c(b,c,d,e,f){var g=Wa(a,b,c),h=g.index;e.call(a,g.offset,!1),g.offset===-1&&(h+=1,e.call(a,0),h===f&&(h=f-1)),d.call(a,h,!1)}b&&(c(!0,a.y(),a[Z.yHc],a[Z.zHc],b.getRowCount()),c(!1,a.x(),a[Z.AHc],a[Z.BHc],b.getColumnCount()))}function Va(a){var b=a.sheet();function c(b,c,d,e){var f=Wa(a,b,c);d.call(a,f.index,!1),e.call(a,f.offset,!1)}b&&(c(!0,a.y()+a[Z.vGc](),a[Z.CHc],a[Z.DHc]),c(!1,a.x()+a[Z.uGc](),a[Z.EHc],a[Z.FHc]))}function Wa(a,b,c){var d,e,f=0,g=0,h=a.sheet(),i=b?h.getRowCount():h.getColumnCount();for(d=0;d<i;d++){if(e=b?h.getRowHeight(d,3):h.getColumnWidth(d,3),f+=e,g=f-c,g>0){g=g>0?e-g:-1;break}if(0===g){g=0,d+=1;break}}return d>=i&&(d=i-1,g=b?h.getRowHeight(d,3):h.getColumnWidth(d,3)),{offset:g,index:d}}function Xa(a,b){var c,d=new g.ColorFormat({DrawingType:0,sheet:function(){return a},Kqa:function(b){return a.Kqa(b)},Yra:function(b){return a.Yra(b)}});return d.setColor(a,b),c=d.ToSJSOOModel(),delete c.colorFillType,d.xc=T,c}function Ya(a,b){Za(b,$a(a))}function Za(a,b){a&&(a.style.zIndex=b+"")}function $a(a){var b=a.PR;return J(b)&&(b=a.Cka),b}function _a(a,b){a.PR=b,a.qo.forEach(function(a){for(var c=a.parentElement;c.className.indexOf(Z.$Hc)===-1;)c=c.parentElement;Za(c,b)})}function ab(a,b){J(a.PR)&&(a.Cka+=b)}ra=function(){function a(a,b){this.kj=a,this.g3=b}return a.prototype.no=function(){this.kj=S},a.prototype.getUsedRange=function(){var a,b,c,d,e,f,g,h=this,j=h.all(),k={};if(j)for(a=void 0,b=void 0,c=void 0,d=void 0,e=0,f=j;e<f.length;e++)g=f[e],a=g.startRow(),b=g.startColumn(),c=g.endRow(),d=g.endColumn(),i(k,{minRow:a,minCol:b,maxRow:c,maxCol:d});return k},a.prototype.add=function(a,b,c,d,e,f,g,h){var i=this,j;return"1"===i.g3?j=xa.ozb(a,b,c,d,e,f):"0"===i.g3&&(j=a),i.kj.wr.Sb(j),j},a.prototype.get=function(a){return this.kj.wr.NR(a)},a.prototype.remove=function(a){this.kj.wr.Fb(a)},a.prototype.clear=function(){return this.kj.wr.$b(this.g3)},a.prototype.all=function(){return this.kj.wr.zR(this.g3)},a.prototype.zIndex=function(a,b){return this.kj.wr.PR(a,b)},a.prototype.tTa=function(a,b,c){this.all().forEach(function(d){var e=c?d.startRow():d.startColumn(),f=c?d.endRow():d.endColumn();b<e||a>f||!d.dynamicSize()||kb(d),Qa(d)})},a}(),b.FloatingObjectCollection=ra;function bb(a){var b=a.sheet();b&&(d.GC$(Q.body).bind("scroll"+Z.uHc,function(){var a=b.parent&&b.parent.getActiveSheet();a&&a.wr&&b.QP(a.Dr())}),b.Fu(d.Events.ColumnChanged+Z.uHc,function(b,c){var d=c.propertyName;d!==Z.uGc&&d!==Z.IHc||cb(a)}),b.Fu(d.Events.RowChanged+Z.uHc,function(b,c){var d=c.propertyName;d!==Z.vGc&&d!==Z.IHc||cb(a)}),b.Fu(d.Events.ColumnWidthChanged+Z.uHc,function(){cb(a)}),b.Fu(d.Events.RowHeightChanged+Z.uHc,function(){cb(a)}))}function cb(a){var b=a.sheet();a.isNeedToUpdateLayout=!0,b.QP(b.Dr())}function db(a,b,c){return c&&c.width>0&&c.height>0&&(c.x===a||c.y===b||c.contains(a,b))}function eb(a){return a===d.RelationshipConstants.apa||a===d.RelationshipConstants.K0a||a===d.RelationshipConstants.xcK||a===d.RelationshipConstants.ycK||a===d.RelationshipConstants.zcK||a===d.RelationshipConstants.AcK}function fb(a){return a===d.RelationshipConstants.G7||a===d.RelationshipConstants.H7}function gb(a){return a instanceof Array}function hb(a,b,c,d){var e=a[b].v_,f;J(e)||(f=parseInt(e,10)),d&&(f=w(f)),c[b]=f}function ib(a){var b={};return hb(a,"row",b),hb(a,"col",b),hb(a,"rowOff",b,!0),hb(a,"colOff",b,!0),b}function jb(a){var b=a.toJSON(),c=a.PR;return isNaN(c)||(b.zIndex=c),b}sa=function(){function a(a){var b=this;b.sheet(a),bb(b),b.QR={},b.ueK=[]}return a.prototype.Dka=function(a){this.zR().forEach(function(b){ab(b,a)})},a.prototype.Sb=function(a,b){var c,d=this,e=d.sheet();if(e.suspendPaint(),c=a.name(),!c)throw e.resumePaint(),Error(G().Exp_FloatingObjectNameEmptyError);if(d.QR[c]){if(!b)throw e.resumePaint(),Error(G().Exp_FloatingObjectHasSameNameError);c=d.FS(c+"__"),a.name(c)}e.ITa.AUa(),d.Dka(-1),a.sheet(e),d.QR[c]=a,d.ueK.push(c),e.Zoa(a),e.ITa.AUa(!0),e.resumePaint()},a.prototype.NR=function(a){return this.QR[a]},a.prototype.Fb=function(a,b){var c,e,f,g,h=this;if(a){if(c=h.sheet(),e=h.NR(a),!e)return;return c.ITa.AUa(),c.suspendPaint(),b?(f={sheet:c,sheetName:c.name(),floatingObject:e,cancel:!1},c.Wq(d.Events.FloatingObjectRemoving,f),f.cancel===!1&&(delete h.QR[a],g=h.ueK.indexOf(a),g>-1&&h.ueK.splice(g),c.Wq(d.Events.FloatingObjectRemoved,{sheet:c,sheetName:c.name(),floatingObject:e}))):(delete h.QR[a],g=h.ueK.indexOf(a),g>-1&&h.ueK.splice(g)),c.ITa.AUa(!0),c.resumePaint(),!0}return!1},a.prototype.U3=function(a,b){var c,d,e=this,f=e.sheet();if(f.suspendPaint(),!b)throw Error(G().Exp_FloatingObjectNameEmptyError);if(e.QR[b])throw Error(G().Exp_FloatingObjectHasSameNameError);c=e.QR[a],delete e.QR[a],e.QR[b]=c,d=e.ueK.indexOf(a),d>-1&&e.ueK.splice(d),e.ueK.push(b),c.onNameChanged&&c.onNameChanged(a,b),f.resumePaint()},a.prototype.$b=function(a){var b=this,c=b.sheet();c.suspendPaint(),d.GC$.each(this.QR,function(c,d){a&&a!==d.g3||b.Fb(d.name())}),b.ueK=[],c.resumePaint()},a.prototype.zR=function(a){var b=[];return d.GC$.each(this.QR,function(c,d){a&&a!==d.g3||b.push(d)}),b},a.prototype.PR=function(a,b){var c=isNaN(b),d=this.NR(a);if(d){if(c)return $a(d);_a(d,b)}if(c)return-1},a.prototype.toJSON=function(){var a=[];return this.zR().forEach(function(b){var c,d;b instanceof xa&&b.hga()&&(c=b.toJSON(),d=b.PR,isNaN(d)||(c.zIndex=d),a.push(c))}),a},a.prototype.bdK=function(){this.toJSON()},a.prototype.fromJSON=function(a,b){var c,e,f,g,h,i,j,k,l,m,n=this;if(a&&0!==a.length)for(c=0;c<a.length;c++)e=a[c],f=void 0,e&&(g=void 0,h=e.floatingObjectType,i=d.Ul.Ol(h)?h+"":e.typeName,"0"===i?f=new xa:"1"===i?f=xa.ozb():(g=d.getTypeFromString(i),g&&(f=new g)),f&&(j=n.sheet(),k=j&&j.parent,l=k&&k.GBb,f.fromJSON(e,b,l),n.Sb(f),m=e.zIndex,J(m)||(f.PR=m)))},a.prototype.cdK=function(a,b,c,e){var f,g,h;a&&0!==a.c_.length&&(f=this,g=f.sheet(),h=d.Util.alK(e),a.c_.forEach(function(a){f.veK(g,a,c,b,h)}))},a.prototype.veK=function(a,b,c,d,e){var f,h;b.twoCellAnchor?(f=b.twoCellAnchor,h=g.ST_AnchorType.twoCellAnchor):b.oneCellAnchor?(f=b.oneCellAnchor,h=g.ST_AnchorType.oneCellAnchor):b.absoluteAnchor&&(f=b.absoluteAnchor,h=g.ST_AnchorType.absoluteAnchor),f&&(f.grpSp?this.rmK(a,f,c,d,e):this.smK(a,f,h,c,d,e))},a.prototype.smK=function(a,b,c,e,f,h){var i,j,l,m,n,o,p,q,r,s,t,u=this,v={};u.fromBaseDrawingSJSFormat(b,v),i=B(f.c_,v.weK),i&&(j=eb(i.Type),l=fb(i.Type)&&zb(b.pic),(j||l)&&(h&&E(a,b,T,e),c===g.ST_AnchorType.twoCellAnchor?u.xeK(a,b,v):c===g.ST_AnchorType.oneCellAnchor?u.yeK(a,b,v):c===g.ST_AnchorType.absoluteAnchor?u.zeK(b,v):c===g.ST_AnchorType.groupShapeAnchor&&u.tmK(b,v),j?(m=i.Target,m=m.split("/").pop().slice(0,-4),n=xa._getChartInstance&&xa._getChartInstance(a),n&&(o=e.charts[m],v.chartSpace=o,v.name=v.name||k,v.lossless=o.lossless,n.cdK(v,e),this.Sb(n,!0))):l&&(p=xa.ozb&&xa.ozb(),p&&(q=i.Target,q=q.split("/").pop(),r=e.media,s=v.name,v.src=oc(q,r[q]),s&&(v.name=Da(this.ueK,s)),p.fromJSON(v),this.Sb(p),b.lossless&&b.lossless.content&&(t=N(Z.dLb),t.innerHTML=b.lossless.content,p.content(d.GC$(t.firstChild)[0]))))))},a.prototype.rmK=function(a,b,c,d,e){var f=this,h=b.grpSp&&b.grpSp.c_||b.c_||[];h.forEach(function(b){if("grpSp"===b.n_){var i=h[1].grpSpPr.xfrm;f.updateGroupXfrm(i,b.c_[1].grpSpPr.xfrm),f.rmK(a,b,c,d,e)}else b.graphicFrame&&(f.updateGroupXfrm(h[1].grpSpPr.xfrm,b.graphicFrame.xfrm),f.smK(a,b,g.ST_AnchorType.groupShapeAnchor,c,d,e))})},a.prototype.convertXfrm=function(a){var b=function(a){return w(v(a),6)};a.chExt&&(a.chExt.cx=b(a.chExt.cx),a.chExt.cy=b(a.chExt.cy)),a.chOff&&(a.chOff.x=b(a.chOff.x),a.chOff.y=b(a.chOff.y)),a.ext.cx=b(a.ext.cx),a.ext.cy=b(a.ext.cy),a.off.x=b(a.off.x),a.off.y=b(a.off.y)},a.prototype.updateGroupXfrm=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;a.hasConvert||(this.convertXfrm(a),a.hasConvert=!0),b.hasConvert||(this.convertXfrm(b),b.hasConvert=!0),c=a.chExt.cx,d=a.chExt.cy,e=a.chOff.x,f=a.chOff.y,g=a.off.x,h=a.off.y,i=a.ext.cx,j=a.ext.cy,k=b.off.x,l=b.off.y,m=b.ext.cx,n=b.ext.cy,o=(k-e)/(c||1)*i,b.off.x=g+o,p=(l-f)/(d||1)*j,b.off.y=h+p,b.ext.cx=m/(c||1)*i,b.ext.cy=n/(d||1)*j},a.prototype.xeK=function(a,b,c){var d,e,f,g,h=b.editAs||0,i=b.from,j=b.to,k=nc($[h]);c.dynamicMove=k.dynamicMove,c.dynamicSize=k.dynamicSize,c.placement=h,i&&(f=ib(i),c.x=y(a,0,f.col)+f.colOff,c.y=z(a,0,f.row)+f.rowOff,c.startRow=f.row,c.startRowOffset=f.rowOff,c.startColumn=f.col,c.startColumnOffset=f.colOff),j&&(g=ib(j),d=y(a,0,g.col)+g.colOff,e=z(a,0,g.row)+g.rowOff,c.endRow=g.row,c.endRowOffset=g.rowOff,c.endColumn=g.col,c.endColumnOffset=g.colOff),c.height=e-c.y,c.width=d-c.x},a.prototype.yeK=function(a,b,c){var d,e=b.from,f=b.ext;c.dynamicMove=!0,c.dynamicSize=!1,c.placement=1,e&&(d=ib(e),c.x=y(a,0,d.col)+d.colOff,c.y=z(a,0,d.row)+d.rowOff),f&&(c.width=w(v(f.cx),6),c.height=w(v(f.cy),6))},a.prototype.zeK=function(a,b){var c=a.from||a.pos,d=a.ext;b.dynamicMove=!1,b.dynamicSize=!1,b.placement=2,c&&(b.x=w(v(c.x),6),b.y=w(v(c.y),6)),d&&(b.width=w(v(d.cx),6),b.height=w(v(d.cy),6))},a.prototype.tmK=function(a,b){var c,d=a.graphicFrame;b.dynamicMove=!1,b.dynamicSize=!1,b.placement=2,c=pc(d.xfrm),b.x=c.x,b.y=c.y,b.width=c.width,b.height=c.height},a.prototype.fromBaseDrawingSJSFormat=function(a,b){var c,d,e,f,g,h,i,k,l=a.graphicFrame,m=a.pic,n=a.AlternateContent,o=a.AlternateContent,p=a.clientData;if(l&&(c=l.nvGraphicFramePr.cNvPr,c&&(b.name=c.name,b.isVisible=!u(c.hidden)||!1,b.alt=c.descr,b.weK=l.graphic.graphicData.chart[j])),m){d=m.nvPicPr.cNvPr,d&&(b.name=d.name,b.isVisible=!u(d.hidden)||!1,b.alt=d.descr),e=m.blipFill.blip,f=e&&e["r:embed"],g=e&&e.extLst&&e.extLst.ext,gb(g)||(g=[g]);for(h in g)g.hasOwnProperty(h)&&(i=g[h]&&g[h]["asvg:svgBlip"],i&&(f=i["r:embed"]));b.weK=f}o&&(k=o.cNvPr,k&&(b.name=k.name,b.isVisible=!u(k.hidden)||!1,b.alt=k.descr),o.chart?b.weK=o.chart[j]:o.Choice&&o.Choice.graphicFrame&&(b.weK=o.Choice.graphicFrame.graphic.graphicData.chart&&o.Choice.graphicFrame.graphic.graphicData.chart[j])),p?(b.isLocked=u(p.fLocksWithSheet,!0),b.canPrint=u(p.fPrintsWithSheet,!0)):(b.isLocked=!0,b.canPrint=!0)},a.prototype.no=function(a){d.GC$(Q.body).unbind("scroll"+Z.uHc);var b=this,c=b.sheet();c&&(c.Gu(d.Events.ColumnChanged+Z.uHc),c.Gu(d.Events.RowChanged+Z.uHc),c.Gu(d.Events.ColumnWidthChanged+Z.uHc),c.Gu(d.Events.RowHeightChanged+Z.uHc)),
a!==!1&&(b.QR&&d.GC$.each(b.QR,function(b,c){c.no(a)}),b.sheet(S))},a.prototype.hitTest=function(a,b,c){var d,e,f,g,h=this.sheet(),i=h.am(),j=S;if(i)for(d=0;d<=2;d++)for(e=0;e<=2;e++)if(f=i.Ft(d,e),f&&f.contains(a,b)&&(g=h.IR&&h.IR(d,e),g&&g.jS.each(function(d){var e=d.YR;e&&e.isVisible()&&(h.DR(e)||c)&&db(a,b,d.Tka)&&(j?$a(j.floatingObject)<$a(e)&&(j.floatingobject=e):j={x:a,y:b,floatingObject:e,yl:d})}),j))return j;return j},a.prototype.FS=function(a){var b,c;for(a||(a="FloatingObject"),b=1,c=a+(""+b);this.NR(c);)b++,c=a+(""+b);return c},a}(),b.FloatingObjectModel=sa,ta={sheet:L("sheet",T)},d.GC$.extend(sa.prototype,ta),d.Zn(sa);function kb(a){var b,c,d,e,f=a.sheet();function g(b,c,d,e,g,h){var i,j=0,k=b.call(a),l=c.call(a),m=Ra(h.call(a),e.call(f,l));return j=d.call(a,f,k,l),k===l?j=W(0,m-g.call(a)):(i=e.call(f,k,3),i>0&&(j-=Ra(g.call(a),i)),j+=m),j}f&&(b=g(a[Z.yHc],a[Z.CHc],Sa,f.getRowHeight,a[Z.zHc],a[Z.DHc]),c=g(a[Z.AHc],a[Z.EHc],Ta,f.getColumnWidth,a[Z.BHc],a[Z.FHc]),c<0&&(c=0),b<0&&(b=0),d=a[Z.uGc](),d!==c&&(a[Z.uGc](c,!1),a.onPropertyChanged(Z.uGc,c,d)),e=a[Z.vGc](),e!==b&&(a[Z.vGc](b,!1),a.onPropertyChanged(Z.vGc,b,e)))}ua=["dotted","dashed","solid","double","groove","ridge","inset","outset"];function lb(a){return ua.indexOf(a)>=0}function mb(a){var b,c,d;if(M(a)&&("string"!=typeof a||""===a))throw Error(G().Exp_FloatingObjectNameEmptyError);return b=this,a!==b.name()&&(c=b.sheet(),!c||(d=c.wr.NR(a),!d))}va=[Z.vHc,Z.rFc,Z.xHc,Z.uGc,Z.vGc,Z.yHc,Z.zHc,Z.AHc,Z.BHc,Z.CHc,Z.DHc,Z.EHc,Z.FHc,Z.JHc,Z.GHc,Z.HHc,Z.IHc,Z.LHc,Z.KHc,Z.MHc,Z.NHc,Z.OHc,"alt"],wa=[["sheet",S,function(){tb(this)}],[Z.vHc,T,function(a,b){var c,d,e=this,f=e.sheet();f&&(c=f.wr,d=c.NR(b),d===e&&c.U3(b,a)),e.onPropertyChanged("name",a,b)},mb],[Z.rFc,0,ob(Z.rFc,!1)],[Z.xHc,0,ob(Z.xHc,!1)],[Z.vGc,0,ob(Z.vGc,!0)],[Z.uGc,0,ob(Z.uGc,!0)],[Z.yHc,T,Oa(Z.yHc)],[Z.zHc,0,Oa(Z.zHc)],[Z.AHc,T,Oa(Z.AHc)],[Z.BHc,0,Oa(Z.BHc)],[Z.CHc,T,Pa(Z.CHc)],[Z.DHc,0,Pa(Z.DHc)],[Z.EHc,T,Pa(Z.EHc)],[Z.FHc,0,Pa(Z.FHc)],[Z.GHc,!1,Na(Z.GHc)],[Z.HHc,!0,nb(Z.HHc)],[Z.JHc,!0,nb(Z.JHc)],[Z.IHc,!0,Na(Z.IHc)],[Z.LHc,!0,function(a,b){nb(Z.LHc).call(this,a,b)},function(a){return"boolean"==typeof a&&(a||this.dynamicSize(!1,!1),!this.fixedPosition())}],[Z.KHc,!0,function(a,b){nb(Z.KHc).call(this,a,b)},function(a){return"boolean"==typeof a&&this.dynamicMove()&&!this.fixedPosition()}],[Z.MHc,!1,function(a,b){var c=this;a&&(c.dynamicMove(!1,!1),c.dynamicSize(!1,!1)),c.onPropertyChanged(Z.MHc,a,b)}],[Z.NHc,!0,Na(Z.NHc)],[Z.OHc,!0,Na(Z.OHc)],["alt","",nb("alt")]];function nb(a){return function(b,c){this.onPropertyChanged(a,b,c)}}function ob(a,b){return function(c,d){var e=this,f=e.sheet();f&&(b&&rb(e),sb(e),wb(e),f.$p()),e.onPropertyChanged(a,c,d)}}function pb(a,b,c,d){var e,f,g=this;g.ROJ=!0,e=a.call(g),f=b.call(g),c<=e?g.dynamicMove()&&(a.call(g,e+d),b.call(g,f+d)):c<f&&g.dynamicSize()&&b.call(g,f+d),g.ROJ=!1}function qb(a,b,c,d,e,f,g){var h,i,j,k,l=this;l.ROJ=!0,h=a.call(l),i=c.call(l),e<=h?g<h?l.dynamicMove()&&(a.call(l,h-f),c.call(l,i-f)):g<i&&(j=g-h+1,k=i-h+1-j,l.dynamicMove()&&(a.call(l,e),b.call(l,0)),l.dynamicSize()&&c.call(l,e+k-1)):e<=i&&(g<i?l.dynamicSize()&&c.call(l,i-f):l.dynamicSize()&&(c.call(l,e),d.call(l,0))),l.ROJ=!1}function rb(a){var b=ub(a,a[Z.vGc]()),c=vb(a,a[Z.uGc]());a[Z.uGc]()>c&&a[Z.uGc](c,!1),a[Z.vGc]()>b&&a[Z.vGc](b,!1)}function sb(a){var b,c,d=a.x()+a[Z.uGc](),e=vb(a,d);d>e&&a.x(W(0,e-a[Z.uGc]()),!1),a.x()<0&&a.x(0,!1),b=a.y()+a[Z.vGc](),c=ub(a,b),b>c&&a.y(W(0,c-a[Z.vGc]()),!1),a.y()<0&&a.y(0,!1)}function tb(a){var b,c,d,e;rb(a),sb(a),b=a[Z.yHc](),c=a[Z.AHc](),J(b)||J(c)?Ua(a):Qa(a),d=a[Z.CHc](),e=a[Z.EHc](),J(d)||J(e)?Va(a):kb(a)}function ub(a,b){var c,d=a.sheet();return d?(c=d.getRowCount(),Sa(d,0,c,b)):Z.sHc}function vb(a,b){var c,d=a.sheet();return d?(c=d.getColumnCount(),Ta(d,0,c,b)):Z.sHc}function wb(a){Ua(a),Va(a)}function xb(a,b,c,d,e,f,g){var h,i=0,j=g?f.getRowHeight:f.getColumnWidth;for(h=a;h<b;h++)i+=U(j.call(f,h)*e);return i-=U((c||0)*e),i+=U((d||0)*e)}function yb(a,b,c,d){var e,f=0;for(e=0;e<a;e++)f+=d?c.getRowHeight(e,3):c.getColumnWidth(e,3);return f+=b}function zb(a){return a&&a.lossless&&a.lossless.isFloatingObject}b.isFloatingObjectPicture=zb;function Ab(a,b){var c=0;return a===!1&&b===!1?c=2:b===!1&&(c=1),c}function Bb(a,b){var c,d,e,f,g,h,i,j,k,l,m=a.getRowCount(),n=a.getColumnCount(),o=b.width(),p=b.height(),q=b.startRow(),r=b.startRowOffset()||0,s=b.startColumn(),t=b.startColumnOffset()||0,u=b.endRow(),v=b.endRowOffset()||0,w=b.endColumn(),x=b.endColumnOffset()||0,A=b.getOriginalWidth(),B=b.getOriginalHeight(),C=Math.min(o,A),D=Math.min(p,B),E=B>p?r:r+(p-B)/2,F=A>o?t:t+(o-A)/2;for(o=C,p=D,c=0,d=q,e=E,f=!1;d<m;)if(g=z(a,d,d+1),d++,c+=g,!f&&(e-=g),e<0&&!f&&(q=d-1<0?0:d-1,r=g+e,f=!0),c>p+E){u=d-1<0?0:d-1,v=g-(c-p-E);break}for(h=0,i=s,j=F,k=!1;i<n;)if(l=y(a,i,i+1),i++,h+=l,!k&&(j-=l),j<0&&!k&&(s=i-1<0?0:i-1,t=l+j,k=!0),h>o+F){w=i-1<0?0:i-1,x=l-(h-o-F);break}return{width:o,height:p,startRow:q,startRowOffset:r,startColumn:s,startColumnOffset:t,endRow:u,endRowOffset:v,endColumn:w,endColumnOffset:x}}function Cb(a,b){var c,d,e,f,g,h,i,j,k=a.getRowCount(),l=a.getColumnCount(),m=b.width(),n=b.height(),o=b.startRow(),p=b.startRowOffset()||0,q=b.startColumn(),r=b.startColumnOffset()||0,s=b.endRow(),t=b.endRowOffset()||0,u=b.endColumn(),v=b.endColumnOffset()||0,w=b.getOriginalWidth(),x=b.getOriginalHeight(),A=m/n,B=w/x,C={width:m,height:n,startRow:o,startRowOffset:p,startColumn:q,startColumnOffset:r,endRow:s,endRowOffset:t,endColumn:u,endColumnOffset:v},D=0,E=0,F=m,G=n;if(n>0&&x>0&&A>B)F=B*n,D=r+m/2-F/2,m=F,n=1/B*m;else{if(!(m>0&&w>0&&1/A>1/B))return C;G=1/B*m,E=p+n/2-G/2,n=G,m=B*n}if(D>0){for(;q<l;)if(c=y(a,q,q+1),q++,D-=c,D<0){q--,r=D+c;break}for(d=0,e=q;e<l;)if(f=y(a,e,e+1),e++,d+=f,d>F+r){v=f-(d-F-r),u=e-1<0?0:e-1;break}}else if(E>0){for(;o<k;)if(g=z(a,o,o+1),o++,E-=g,E<0){o--,p=E+g;break}for(h=0,i=o;i<k;)if(j=z(a,i,i+1),i++,h+=j,h>G+p){t=j-(h-G-p),s=i-1<0?0:i-1;break}}return C.width=m,C.height=n,C.startRow=o,C.startRowOffset=p,C.endRow=s,C.endRowOffset=t,C.startColumn=q,C.startColumnOffset=r,C.endColumn=u,C.endColumnOffset=v,C}function Db(a,b){var c,d,e,f,g,h,i=a.getRowCount(),j=a.getColumnCount(),k=b.width(),l=b.height(),m=b.startRow(),n=b.startRowOffset()||0,o=b.startColumn(),p=b.startColumnOffset()||0,q=b.endRow(),r=b.endRowOffset()||0,s=b.endColumn(),t=b.endColumnOffset()||0,u=b.getOriginalWidth(),v=b.getOriginalHeight();for(k=Math.min(k,u),l=Math.min(l,v),c=0,d=m;d<i;)if(e=z(a,d,d+1),d++,c+=e,c>l+n){q=d-1<0?0:d-1,r=e-(c-l-n);break}for(f=0,g=o;g<j;)if(h=y(a,g,g+1),g++,f+=h,f>k+p){s=g-1<0?0:g-1,t=h-(f-k-p);break}return{width:k,height:l,startRow:m,startRowOffset:n,startColumn:o,startColumnOffset:p,endRow:q,endRowOffset:r,endColumn:s,endColumnOffset:t}}function Eb(a){return!a||"hidden"===a}function Fb(a){switch(a){case"dotted":return"dot";case"dashed":return"dash";case"double":return"dbl"}return"solid"}function Gb(a){var b=1e5;return{l:parseInt((a.l||0)*b,10),t:parseInt((a.t||0)*b,10),r:parseInt((a.r||0)*b,10),b:parseInt((a.b||0)*b,10)}}function Hb(a){return 6e4*a}xa=function(){function a(a,b,c,d,e){var f=this;f.LR={startRowOffset:T,startColumnOffset:T,endRowOffset:T,endColumnOffset:T},f.typeName="0",f.g3="0",f.name(a),f.x(b?b:0,!1),f.y(c?c:0,!1),f[Z.uGc](d?d:0,!1),f[Z.vGc](e?e:0,!1),f.qo=[],f.KR=!1,f.Cka=Z.PHc,f.ROJ=!1}return a.prototype.position=function(a){var b,c,e=this,f=e.sheet();return 0===arguments.length?new d.Point(e.x(),e.y()):(b=e.x(),c=e.y(),!a||isNaN(a.x)||isNaN(a.y)||b===a.x&&c===a.y||(e.x(a.x,!1),e.y(a.y,!1),sb(e),wb(e),f&&f.$p(),e.onPropertyChanged("position",a,new d.Point(b,c))),e)},a.prototype.cloneContent=function(){var a,b,c=this.content();return c?(a=void 0,c.cloneNode?a=c.cloneNode(!0):(b=N(Z.dLb),b.innerHTML=c.outerHTML,a=b.firstChild),d.GC$(a).removeAttr("id")[0]):S},a.prototype.refreshContent=function(a){var b,c,e,f,g,h,i=this;i.KR&&a&&(b=d.GC$(a),b.empty(),c=i.cloneContent(),e=Z.lIc,f=Z.lIc,g="",h="",c&&c.style&&(g=c.style.width,h=c.style.height),""!==g&&(e=g),""!==h&&(f=h),c!==S?(d.GC$(c).css({width:e,height:f}).addClass(Z.mIc).addClass(Z.UHc).attr(Z.qHc,Z.oHc).appendTo(a),b.css(Z.THc,"")):b.css(Z.THc,""),i.KR=!1)},a.prototype.toJSON=function(){var a,b=this,c=La.call(b,va),e=b.LR;for(a in e)J(e[a])||(c[a]=e[a]);return c.typeName=b.typeName,c[Z.kIc]=d.GC$(N(Z.dLb)).append(b.cloneContent()).html(),c},a.prototype.bdK=function(a,b){var c=this,d=c.typeName;return"1"===d?c.toSJSFormat_PictureDrawing(a):"2"===d&&c.toSJSFormat_ChartDrawing(a,b),a},a.prototype.toSJSFormat_ChartDrawing=function(a,b){var c=this,d={from:{col:{v_:c.startColumn()},colOff:{v_:x(c.startColumnOffset())},row:{v_:c.startRow()},rowOff:{v_:x(c.startRowOffset())}},to:{col:{v_:c.endColumn()},colOff:{v_:x(c.endColumnOffset())},row:{v_:c.endRow()},rowOff:{v_:x(c.endRowOffset())}}},e={macro:"",nvGraphicFramePr:{cNvPr:{id:c.VdK,name:c.name(),v_:""},cNvGraphicFramePr:{}},xfrm:{off:{x:"0",y:"0"},ext:{cx:"0",cy:"0"}},graphic:{graphicData:{r_:[],chart:{}}}};b?(e.graphic.graphicData.r_.push(19),e.graphic.graphicData.chart={r_:[20,8],"r:id":a._id},d.AlternateContent={r_:[14],Choice:{r_:[18],Requires:"cx1",graphicFrame:e}}):(e.graphic.graphicData.r_.push(6),e.graphic.graphicData.chart={r_:[7,8],"r:id":a._id},d.graphicFrame=e),d.clientData={},a.c_.push({twoCellAnchor:d})},a.prototype.toSJSFormat_PictureDrawing=function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this,t=s.sheet(),u=s.pictureStretch();1===u?b=Bb(t,s):2===u?b=Cb(t,s):3===u&&(b=Db(t,s)),c=Ab(s.dynamicMove(),s.dynamicSize()),e={editAs:$[c]},b?(e.from={col:{v_:b.startColumn},colOff:{v_:x(b.startColumnOffset||0)},row:{v_:b.startRow},rowOff:{v_:x(b.startRowOffset||0)}},e.to={col:{v_:b.endColumn},colOff:{v_:x(b.endColumnOffset||0)},row:{v_:b.endRow},rowOff:{v_:x(b.endRowOffset||0)}}):(e.from={col:{v_:s.startColumn()},colOff:{v_:x(s.startColumnOffset()||0)},row:{v_:s.startRow()},rowOff:{v_:x(s.startRowOffset()||0)}},e.to={col:{v_:s.endColumn()},colOff:{v_:x(s.endColumnOffset()||0)},row:{v_:s.endRow()},rowOff:{v_:x(s.endRowOffset()||0)}}),s.isLocked()===!1&&(e.fLocksWithSheet="0"),f={id:s.VdK,name:s.name()},s.isVisible()||(f.hidden="1"),g=s.alt(),g&&(f.descr=g),f.extLst={ext:{r_:[26],creationId:{r_:[24,25]}}},h={cNvPr:f,cNvPicPr:{picLocks:{noChangeAspect:"1"}}},i={},i.blip={r_:[8],"r:embed":a._id,extLst:{ext:{r_:[23],useLocalDpi:{r_:[22],val:"0"}}}},j=s.rmb,j?(k=Gb(j),l={},J(k.l)||0===k.l||(l.l=k.l),J(k.t)||0===k.t||(l.t=k.t),J(k.r)||0===k.r||(l.r=k.r),J(k.b)||0===k.b||(l.b=k.b),i.srcRect=l):i.stretch={fillRect:{}},m={},s.tmb&&(m.rot=Hb(s.tmb)),m.xfrm={off:{x:"0",y:"0"},ext:{cx:"0",cy:"0"}},m.prstGeom={prst:"rect",avLst:{}},s.backColor()?m.solidFill=Xa(t,s.backColor()):m.noFill={},n=Eb(s.borderStyle())?0:s.borderWidth(),o=s.borderColor(),p=Fb(s.borderStyle()),q=s.noFill(),r=m.ln={},J(n)||(r.w=W(x(n),0)),"dbl"===p&&(r.cmpd="dbl"),q?r.noFill={}:r.solidFill=Xa(t,o),"dbl"!==p&&(r.prstDash={val:p}),e.pic={nvPicPr:h,blipFill:i,spPr:m,lossless:{isFloatingObject:!0}},e.clientData={},J(e.lossless)&&(e.lossless={}),e.lossless[Z.kIc]=d.GC$(N(Z.dLb)).append(s.cloneContent()).html(),a.c_.push({twoCellAnchor:e})},a.prototype.fromJSON=function(a,b){var c,e;a&&(c=this,c.TR=!0,Ma.call(this,va,a,b),J(a[Z.yHc])&&wb(c),a.content&&(e=N(Z.dLb),e.innerHTML=a.content,c.content(d.GC$(e.firstChild)[0])),c.TR=T)},a.prototype.cdK=function(a,b){},a.prototype.clone=function(b){var c=this,e=d.getTypeFromString(c.typeName),f=e?new e:new a,g=JSON.stringify(c.toJSON());return f.fromJSON(JSON.parse(g)),f.content(c.cloneContent()),f},a.prototype.onPropertyChanged=function(a,b,c){var d,e=this;e.TR||(d=e.sheet(),d&&(d.ITa.BUa(e,a,c,b),e.Wq({sheet:d,sheetName:d.name(),floatingObject:e,propertyName:a})))},a.prototype.Wq=function(a){var b,c=this.sheet();c&&(c.Wq(d.Events.FloatingObjectChanged,a),a.propertyName===Z.GHc&&(b={sheet:a.sheet,sheetName:a.sheetName,floatingObject:a.floatingObject},c.Wq(d.Events.FloatingObjectSelectionChanged,b)))},a.prototype.rI=function(a,b){var c=this;a=U(a),b=U(b),pb.call(c,c[Z.yHc],c[Z.CHc],a,b)},a.prototype.GR=function(a,b){var c=this,d=a+b-1;qb.call(c,c[Z.yHc],c[Z.zHc],c[Z.CHc],c[Z.DHc],a,b,d)},a.prototype.tI=function(a,b){var c=this;a=U(a),b=U(b),pb.call(c,c[Z.AHc],c[Z.EHc],a,b)},a.prototype.HR=function(a,b){var c,d=this;a=U(a),b=U(b),c=a+b-1,qb.call(d,d[Z.AHc],d[Z.BHc],d[Z.EHc],d[Z.FHc],a,b,c)},a.prototype.getHost=function(a,b){var c,d,e=this.qo.concat();if(!J(a)&&!J(b)){for(c=0;c<e.length;c++)if(d=e[c],d.rowViewportIndex===a&&d.columnViewportIndex===b)return d;return S}return e},a.prototype.UR=function(a,b,c){var d=this.qo;a&&d.indexOf(a)<0&&(a.rowViewportIndex=b,a.columnViewportIndex=c,d.push(a))},a.prototype.VR=function(a){var b=this.qo,c=b.indexOf(a);c>=0&&b.splice(c,1)},a.prototype.WR=function(a,b){var c,e,f,g,h,i,j=N(Z.dLb);return d.GC$(j).addClass(Z.TGc).addClass(Z.ZHc).attr(Z.qHc,Z.oHc).css(Z.RHc,Z.SHc),c=this.cloneContent(),e=Z.lIc,f=Z.lIc,g="",h="",i=c&&c.style,i&&(g=i.width,h=i.height),""!==g&&(e=g),""!==h&&(f=h),c!==S&&d.GC$(c).css({width:e,height:f}).addClass(Z.mIc).addClass(Z.TGc).attr(Z.qHc,Z.oHc).appendTo(j),this.UR(j,a,b),j},a.prototype.hga=function(){return!0},a.prototype.no=function(a){},a.prototype.Toa=function(){Qa(this),kb(this)},a.prototype.wxb=function(a){var b,c,d=this;return 1===a?V(d.width()):(b=yb(d.startColumn(),d.startColumnOffset(),d.sheet(),!1),c=Wa(d,!1,b+d[Z.uGc]()),xb(d.startColumn(),c.index,d.startColumnOffset(),c.offset,a,d.sheet(),!1))},a.prototype.xxb=function(a){var b,c,d=this;return 1===a?V(d.height()):(b=yb(d.startRow(),d.startRowOffset(),d.sheet(),!0),c=Wa(d,!0,b+d[Z.vGc]()),xb(d.startRow(),c.index,d.startRowOffset(),c.offset,a,d.sheet(),!0))},a}(),b.FloatingObject=xa,ya={content:L(Z.kIc,S,Na(Z.kIc))},d.GC$.each(wa,function(a,b){ya[b[0]]=L(b[0],b[1],b[2],b[3])}),d.GC$.extend(xa.prototype,ya);function Ib(a,b,c){var e=a.$R,f,g,h,i;switch(b){case ia:f=X(e[Z.sIc]+e[Z.uIc],c.x),g=X(e[Z.tIc]+e[Z.vIc],c.y),h=Y(c.x-e[Z.sIc]-e[Z.uIc]),i=Y(c.y-e[Z.tIc]-e[Z.vIc]);break;case ja:f=e[Z.sIc],g=X(e[Z.tIc]+e[Z.vIc],c.y),h=e[Z.uIc],i=Y(c.y-e[Z.tIc]-e[Z.vIc]);break;case ka:f=X(e[Z.sIc],c.x),g=X(e[Z.tIc]+e[Z.vIc],c.y),h=Y(c.x-e[Z.sIc]),i=Y(c.y-e[Z.tIc]-e[Z.vIc]);break;case la:f=X(e[Z.sIc]+e[Z.uIc],c.x),g=e[Z.tIc],h=Y(c.x-e[Z.sIc]-e[Z.uIc]),i=e[Z.vIc];break;case ma:f=X(e[Z.sIc],c.x),g=e[Z.tIc],h=Y(c.x-e[Z.sIc]),i=e[Z.vIc];break;case na:f=X(e[Z.sIc]+e[Z.uIc],c.x),g=X(e[Z.tIc],c.y),h=Y(c.x-e[Z.sIc]-e[Z.uIc]),i=Y(c.y-e[Z.tIc]);break;case oa:f=e[Z.sIc],g=X(e[Z.tIc],c.y),h=e[Z.uIc],i=Y(c.y-e[Z.tIc]);break;case pa:f=X(e[Z.sIc],c.x),g=X(e[Z.tIc],c.y),h=Y(c.x-e[Z.sIc]),i=Y(c.y-e[Z.tIc])}return new d.Rect(f,g,h,i)}function Jb(a){var b=d.GC$(a),c=b.position();return new d.Rect(c.left,c.top,b[Z.uGc](),b[Z.vGc]())}function Kb(a,b,c,e,f,g){d.GC$(a).css([Z.Lcc,Z.rGc,Z.uGc,Z.vGc],[[e-1],[c-1],f,g]).addClass(Z.aIc).appendTo(b)}function Lb(a,b){if(!a._R)return S;var c={inMoving:!1};return b||(c.inMoving=!0),c}function Mb(a){var b,c,d,e,f,g=a,h=g.kj,i=g.WE,j=g.aS,k=h.frozenTrailingRowCount(),l=h.frozenTrailingColumnCount(),m=h.am(),n=m.Ft(i,j),o=g.YR,p=o[Z.yHc](),q=o[Z.AHc](),r=o[Z.CHc](),s=o[Z.EHc](),t=h.frozenRowCount(),u=h.frozenColumnCount(),v=h.getRowCount(3)-k-1,w=h.getColumnCount(3)-l-1;return i===Z.rHc?(t>0&&(b=h.getViewportTopRow(i),(p<t||b===t)&&(n.y-=m.fs,n[Z.vGc]+=m.fs)),k>0&&(c=h.getViewportBottomRow(i),r>v&&c===v&&(n[Z.vGc]+=m.gs))):i===Z.rHc-1?(b=h.getViewportTopRow(i+1),(r>=b||b===t)&&(f=m.Ft(i+1,j),n[Z.vGc]+=f[Z.vGc])):i===Z.rHc+1&&(c=h.getViewportBottomRow(i-1),(p<=c||c===v)&&(f=m.Ft(i-1,j),n.y=f.y,n[Z.vGc]+=f[Z.vGc])),j===Z.rHc?(u>0&&(d=h.getViewportLeftColumn(j),(q<u||d===u)&&(n.x-=m.hs,n[Z.uGc]+=m.hs)),h.frozenTrailingColumnCount()>0&&(e=h.getViewportRightColumn(j),(s>w||e===w)&&(n[Z.uGc]+=m.js))):j===Z.rHc-1?(d=h.getViewportLeftColumn(j+1),(s>=d||d===u)&&(f=m.Ft(i,j+1),n[Z.uGc]+=f[Z.uGc])):j===Z.rHc+1&&(e=h.getViewportRightColumn(j-1),(q<=e||e===w)&&(f=m.Ft(i,j-1),n.x=f.x,n[Z.uGc]+=f[Z.uGc])),n}function Nb(a,b,c,e,f){var g=Jb(a);d.GC$(a).css([Z.Lcc,Z.rGc,Z.uGc,Z.vGc],[g.y+c,g.x+b,g[Z.uGc]+e,g[Z.vGc]+f])}function Ob(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q=a;if(q.bS){b=q.$F,c=Mb(q),e=q.cS,f=q.$R,g=f.direction,h=void 0,b=new d.Point(b.x-c.x,b.y-c.y),h=Ib(q,g,b),f.endX=h.x,f.endY=h.y,f.endWidth=h[Z.uGc],f.endHeight=h[Z.vGc],i=Jb(e),j=h.y-i.y,k=h.x-i.x,l=h[Z.uGc]-i[Z.uGc],m=h[Z.vGc]-i[Z.vGc],Nb(e,k,j,l,m),n=q.dS;for(o in n)R(n,o)&&(p=n[o],Nb(p.moveResizeDiv,k,j,l,m))}}function Pb(a,b){var c,e=a.kj;e&&(c=e.RF(b),c===!1&&d.Ul.nl(b))}function Qb(a){var b,c,d,e,f,g,h,i=a,j=i.kj,k=i.eS;if(k){if(b=O(j,k[Z.yIc],j.getViewportTopRow(i.WE),!0),c=O(j,k[Z.zIc],j.getViewportLeftColumn(i.aS),!1),d=k[Z.wIc]-k[Z.sIc]+(k[Z.wIc]>k[Z.sIc]?c:-1*c),e=k[Z.xIc]-k[Z.tIc]+(k[Z.xIc]>k[Z.tIc]?b:-1*b),0===d&&0===e)return;f=[],f.push(i.YR.name()),g=i.dS;for(h in g)R(g,h)&&f.push(h);j.wu().execute({cmd:"dragCopyFloatingObjects",sheetName:j.name(),floatingObjects:f,offsetX:d,offsetY:e})}}function Rb(a){var b,c,d,e,f,g,h,i=a,j=i.kj,k=i.eS,l=j.zoom();if(k){b=O(j,k[Z.yIc],j.getViewportTopRow(i.WE),!0),c=O(j,k[Z.zIc],j.getViewportLeftColumn(i.aS),!1),d=k[Z.wIc]-k[Z.sIc]+(k[Z.wIc]>k[Z.sIc]?c:-1*c),e=k[Z.xIc]-k[Z.tIc]+(k[Z.xIc]>k[Z.tIc]?b:-1*b),d/=l,e/=l,f=[],f.push(i.YR.name()),g=i.dS;for(h in g)R(g,h)&&f.push(h);j.wu().execute({cmd:"moveFloatingObjects",sheetName:j.name(),floatingObjects:f,offsetX:d,offsetY:e})}}function Sb(a,b,c,d){var e=O(a,b,c,d);return b>c?-e:e}function Tb(a){var b,c,d,e,f,g,h,i,j,k=a,l=k.kj,m=l.zoom(),n=k.YR,o=k.$R;if(o){b=Sb(l,o[Z.yIc],l.getViewportTopRow(k.WE),!0),c=Sb(l,o[Z.zIc],l.getViewportLeftColumn(k.aS),!1),d=void 0,e=void 0,d=o[Z.wIc]!==o[Z.sIc]?o[Z.wIc]-o[Z.sIc]+c:0,d/=m,e=o[Z.xIc]!==o[Z.tIc]?o[Z.xIc]-o[Z.tIc]+b:0,e/=m,f=(o.endWidth+c)/m-n[Z.uGc](),g=(o.endHeight+b)/m-n[Z.vGc](),h=[],h.push(n.name()),i=k.dS;for(j in i)R(i,j)&&h.push(j);l.wu().execute({cmd:"resizeFloatingObjects",sheetName:l.name(),floatingObjects:h,offsetX:d,offsetY:e,offsetWidth:f,offsetHeight:g})}}function Ub(a,b,c){var d,e,f,g,h,i=a,j=i.cS;if(j){d=c.x-b.x,e=c.y-b.y,Vb(j,d,e),f=i.dS;for(g in f)R(f,g)&&(h=f[g],Vb(h.moveResizeDiv,d,e))}}function Vb(a,b,c){var e=d.GC$(a),f=d.GC$(a).position();e.css([Z.Lcc,Z.rGc],[f[Z.Lcc]+c,f[Z.rGc]+b])}function Wb(a){var b,c,d,e,f,g,h,i,j,k,l,m=a,n=m.eS;n&&(b=m.YR,c=m.kj,d=c.am(),e=d[Z.uGc]-d.Br-d.zr,f=d[Z.vGc]-d.Cr-d.Ar,g=n.startX,h=n.startY,i=b.position().x,j=b.position().y,k=b[Z.uGc](),l=b[Z.vGc](),i+n.endX-g<0&&(n.endX=g-i),j+n.endY-h<0&&(n.endY=h-j),i+k+n.endX-g>e&&(n.endX=e+g-i-k),j+l+n.endY-h>f&&(n.endY=f+h-j-l),n.startTopRow=c.getViewportTopRow(m.WE),n.startLeftColumn=c.getViewportLeftColumn(m.aS))}function Xb(a){var b,c,e,f,g,h=a,i=h.$R;i&&(b=h.kj,c=b.am(),e=c[Z.uGc]-c.Br-c.zr,f=c[Z.vGc]-c.Cr-c.Ar,g=new d.Rect(i.endX,i.endY,i.endWidth,i.endHeight),g=g.getIntersect(0,0,e,f),i.endX=g.x,i.endY=g.y,i.endWidth=g[Z.uGc],i.endHeight=g[Z.vGc],i.startTopRow=b.getViewportTopRow(h.WE),i.startLeftColumn=b.getViewportLeftColumn(h.aS))}function Yb(a){var b,c,e,f,g,h,i,j,k=N(Z.dLb),l=d.GC$(k),m=a;return l.addClass(Z.$Hc).addClass(Z.UHc).attr(Z.qHc,Z.oHc).css(Z.pHc,Z.PHc).bind("mousedown",function(a){m.AD(a)}).bind(Z.qIc,function(a){m.BD(a)}).bind(Z.rIc,function(a){m.CD(a)}),k.addEventListener("mousewheel",function(a){Pb(m,a)},!1),k.addEventListener("DOMMouseScroll",function(a){Pb(m,a)},!1),b=d.GC$(N(Z.dLb)).addClass(Z.cIc+" "+Z.eIc+" "+Z.hIc+" "+Z.dIc),c=d.GC$(N(Z.dLb)).addClass(Z.cIc+" "+Z.eIc+" "+Z.iIc+" "+Z.dIc),e=d.GC$(N(Z.dLb)).addClass(Z.cIc+" "+Z.eIc+" "+Z.jIc+" "+Z.dIc),f=d.GC$(N(Z.dLb)).addClass(Z.cIc+" "+Z.fIc+" "+Z.hIc+" "+Z.dIc),g=d.GC$(N(Z.dLb)).addClass(Z.cIc+" "+Z.fIc+" "+Z.jIc+" "+Z.dIc),h=d.GC$(N(Z.dLb)).addClass(Z.cIc+" "+Z.gIc+" "+Z.hIc+" "+Z.dIc),i=d.GC$(N(Z.dLb)).addClass(Z.cIc+" "+Z.gIc+" "+Z.iIc+" "+Z.dIc),j=d.GC$(N(Z.dLb)).addClass(Z.cIc+" "+Z.gIc+" "+Z.jIc+" "+Z.dIc),l.append(b).append(c).append(e).append(f).append(g).append(h).append(i).append(j),za.ao(m,"init",k),k}function Zb(a){var b,c,e,f,g,h,i,j,k=a,l=k.hS&&k._R;if(l&&!k.cS){b=k.iS=N(Z.dLb),k.cS=N(Z.dLb),k.dS={},k.gS.jS.each(function(a){var b,c=a.YR;c&&c.name()!==k.YR.name()&&c.isSelected()&&!k.dS[c.name()]&&(b=a._R,k.dS[c.name()]={offsetX:b.x-l.x,offsetY:b.y-l.y,height:b[Z.vGc],width:b[Z.uGc],moveResizeDiv:N(Z.dLb)})}),c=Mb(k),e=d.GC$(b),e.css([Z.pHc,Z.Lcc,Z.rGc,Z.uGc,Z.vGc,Z.THc],[Z.QHc,c.y,c.x,c[Z.uGc],c[Z.vGc],"rgba(255,255,255,0.01)"]).addClass(Z._Hc).bind(Z.qIc,function(a){k.BD(a)}).bind(Z.rIc,function(a){k.CD(a)}),f=l.y-c.y,g=l.x-c.x,Kb(k.cS,b,g,f,l[Z.uGc],l[Z.vGc]),h=k.dS;for(i in h)R(h,i)&&(j=h[i],Kb(j.moveResizeDiv,k.iS,g+j.offsetX,f+j.offsetY,j[Z.uGc],j[Z.vGc]));k.Ks&&d.GC$(k.Ks).append(k.iS)}}function $b(a){var b=a;b.RB||(d.GC$(Q).bind(Z.qIc+Z.uHc,function(a){b.BD(a)}).bind(Z.rIc+Z.uHc,function(a){b.CD(a)}),b.RB=!0)}function _b(a){var b=a;b.RB&&(b.RB=!1,d.GC$(Q).unbind(Z.qIc+Z.uHc).unbind(Z.rIc+Z.uHc))}function ac(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=d.GC$(Z.bIc,b);t.removeClass(Z.YHc),c=a,e=Jb(c.hS),f=c.kS,g=c.YR,c.lS&&(f=c.lS),h=za.mS,i=Jb(f),j=i.x,k=i.y,l=e[Z.vGc]-i.y-i[Z.vGc],m=e[Z.uGc]-i.x-i[Z.uGc],n=0,o=h+2,p=V(h/2+1),"1"===g.typeName&&(q=g.borderWidth(),r=g.borderStyle(),lb(r)||(q=0),q>=p&&(n=q-p),l=e[Z.vGc]-k-i[Z.vGc]-q,m=e[Z.uGc]-j-i[Z.uGc]-q,j+=q,k+=q),s=[],j>0?(bc(c,k>0,aa,n,n,T,T,"nw"+Z.fHc,ia,s),bc(c,e[Z.vGc]>0,ba,n,(i[Z.vGc]-o)/2+k,T,T,"w"+Z.fHc,la,s),bc(c,l>0,ca,n,T,T,n,"ne"+Z.fHc,na,s)):(cc(c,aa),cc(c,ba),cc(c,ca)),bc(c,k>0,da,(i[Z.uGc]-o)/2+j,n,T,T,"n"+Z.fHc,ja,s),bc(c,l>0,ea,(i[Z.uGc]-o)/2+j,T,T,n,"n"+Z.fHc,oa,s),m>0?(bc(c,k>0,fa,T,n,n,T,"sw"+Z.fHc,ka,s),bc(c,e[Z.vGc]>0,ga,T,(i[Z.vGc]-o)/2+k,n,T,"w"+Z.fHc,ma,s),bc(c,l>0,ha,T,T,n,n,"se"+Z.fHc,pa,s)):(cc(c,fa),cc(c,ga),cc(c,ha)),c.ZR=!0,c.pmb=s}function bc(a,b,c,e,f,g,h,i,j,k){var l,m,n,o,p=a,q=d.GC$(c,p.hS),r=za.mS;b?q.css([Z.rGc,Z.Lcc,Z.sGc,Z.tGc,Z.uGc,Z.vGc,Z.PGc],[e,f,g,h,r,r,i]).addClass(Z.XHc).attr("resizeDirection",j):cc(p,c),k&&(l=d.GC$(p.hS),m=0,n=0,J(e)||(m=e),J(f)||(n=f),J(g)||(m=l.width()-g-r),J(h)||(n=l.height()-h-r),o=new d.Rect(m,n,r,r),k.push({rect:o,cursor:i,direction:j}))}function cc(a,b){d.GC$(b,a.hS).removeClass(Z.XHc).addClass(Z.YHc)}function dc(a,b){d.GC$(Z.bIc,b).removeClass(Z.XHc).addClass(Z.YHc),a.ZR=!1}function ec(a){var b,c,e,f,g,h,i,j,k,l,m,n=a,o=n.YR,p=o.qmb||o.src(),q=o.pictureStretch(),r=d.Rm.Om(o.sheet(),o.backColor()),s=n.kS;p&&s&&(b=d.GC$(s),n.XR!==p&&(n.XR=p,b.css([Z.THc+"-image",Z.THc+"-repeat"],["url('"+p+"')","no-repeat"])),b.css(Z.THc+"-color",r),q!==S&&q!==T&&o.oS&&(c=o.getOriginalWidth(),e=o.getOriginalHeight(),f=b[Z.uGc](),g=b[Z.vGc](),h=o.rmb,i=void 0,h&&(j=f/h.width,k=g/h.height,l=j*h.left,m=k*h.top,i={position:-l+"px "+-m+"px",size:j+"px "+k+"px"}),d.Ul.ql(s,f,g,c,e,q,i)))}function fc(a,b,c){var e,f,g,h,i=a.lS,j=a.YR,k=j.borderWidth(),l=j.borderStyle(),m=d.Rm.Om(j.sheet(),j.borderColor()),n=j.borderRadius(),o=0,p=V(za.mS/2+1);lb(l)&&!j.noFill()||(k=0),k<p&&(o=p-k),e=o,f=o,g=o,h=o,p=W(k,p),b.x<0?e+=b.x-p:(e+=b.x<p?b.x-p:0,h=c[Z.uGc]-e-b[Z.uGc]-2-2*k),b.y<0?f+=b.y-p:(f+=b.y<p?b.y-p:0,g=c[Z.vGc]-f-b[Z.vGc]-2-2*k),d.GC$(i).css([Z.RHc,Z.rGc,Z.Lcc,Z.tGc,Z.sGc,Z.Gcc+"-width",Z.Gcc+"-style",Z.Gcc+"-color",Z.Gcc+"-radius"],[Z.SHc,e,f,g,h,k,l,m,n])}za=function(){function a(a,b){this.XR="";var c=this;c.YR=a,c.name=a?a.name():"",c.kj=b,c.RB=!1,c.ZR=!1}return a.prototype.gV=function(a){var b,c,e,f,g,h,i=d.GC$(a.target).attr("resizeDirection");if(i)return i;if(b=d.GC$(this.hS).offset(),c=a.pageX-b.left,e=a.pageY-b.top,f=this.pmb)for(g=0;g<f.length;g++)if(h=f[g],h.rect.contains(c,e))return h.direction},a.prototype.smb=function(a){var b,c,e,f,g,h,i=a.target,j=d.GC$(i).attr("resizeDirection");if(j)return i.style.cursor;if(b=d.GC$(this.hS).offset(),c=a.pageX-b.left,e=a.pageY-b.top,f=this.pmb)for(g=0;g<f.length;g++)if(h=f[g],h.rect.contains(c,e))return h.cursor},a.prototype.AD=function(b){var c,e,f,g,h,i,j,k,l,m,n,o=this,p=o.kj,q=o.YR,r=p.ITa.Ky,s=o.WE,t=o.aS;if(p.ER(q)&&p.endEdit()&&(p.zt(!0),c={e:b,r:S},a.ao(o,"preProcessMouseDown",c),!c.r)){if(0===b.button||2===b.button){if(e=q.isSelected(),b.ctrlKey||b.shiftKey?q.isSelected(!e):e||(p.uQ(),q.isSelected(!0)),e||d.Vl.Zl(p),r&&r.vQ(),p.EJ(),p.hm&&p.hm(),2===b.button)return;if(f=p.mm,g=p.Vs(),h=o.gV(b),i=new d.Point(b.pageX-g.left,b.pageY-g.top),j=Lb(o,h),!q.allowMove()&&(!q.allowResize()||j.inMoving))return;o.$F=i,o.pS=!0,o.bS=j,j.inMoving?(k={},k.startTopRow=p.getViewportTopRow(s),k.startLeftColumn=p.getViewportLeftColumn(t),k.startX=i.x,k.startY=i.y,o.eS=k):(Zb(o),l={},m=Jb(o.cS),l.startX=m.x,l.startY=m.y,l.startWidth=m[Z.uGc],l.startHeight=m[Z.vGc],l.startTopRow=p.getViewportTopRow(s),l.startLeftColumn=p.getViewportLeftColumn(t),l.cursor=o.smb(b),l.direction=h,o.$R=l),$b(o),n=p.hitTest(i.x,i.y),f.rG={KG:n.rowViewportIndex,MG:n.colViewportIndex,sG:n.hitTestType},f.$F=i,f.qG(),f.O3=!0,p.Wq(d.Events.FloatingElementSelected,{type:"floatingObject"})}return!1}},a.prototype.BD=function(b){var c,e,f,g,h,i,j,k,l=this,m=l.kj,n=l.hS,o=l.iS;if(m.ER(l.YR))return c={e:b,r:S},a.ao(l,"preProcessMouseMove",c),c.r?(e=c.cursor,void(e&&d.GC$(n).css(Z.PGc,e))):(f=l.YR,g=f.isLocked()&&m.options.isProtected,d.GC$(n).css(Z.PGc,g||!f.allowMove()?"default":Z.pGc),m.dG?(n&&d.GC$(n).css(Z.PGc,"default"),!0):(h=m.mm,i=m.Vs(),j=new d.Point(b.pageX-i.left,b.pageY-i.top),l.pS?(l.bS.inMoving?(l.qS=!0,Zb(l),Ub(l,l.$F,j),d.GC$(o).css(Z.PGc,Z.pGc)):l.YR.allowResize()&&(l.kv=!0,Ob(l),d.GC$(o).css(Z.PGc,l.$R[Z.PGc])),(l.qS||l.kv)&&(l.$F=j,h.$F=j,h.NG(),d.GC$(Q.body).addClass(Z.UHc).attr(Z.qHc,Z.oHc))):(k=m.parent,k.options.enableAccessibility&&k.EHb(f.alt())),!1))},a.prototype.CD=function(b){var c,e,f,g,h,i=this,j=i.kj,k=j.mm,l=i.YR,m=i.hS,n=i.bS;if(j.ER(l)&&(c={e:b,r:S},a.ao(i,"preProcessMouseUp",c),!c.r))return j.dG?(d.GC$(m).css(Z.PGc,Z.pGc),!0):(k.O3=!1,k.RG(),e=j.Vs(),f=new d.Point(b.pageX-e.left,b.pageY-e.top),g=i.eS,g&&(g.endX=f.x,g.endY=f.y),n&&(h=l.fixedPosition(),n.inMoving&&i.qS?(h&&Wb(i),b.ctrlKey?Qb(i):Rb(i)):i.kv&&(h&&Xb(i),Tb(i)),d.GC$(Q.body).removeClass(Z.UHc)),i.rS(),!1)},a.prototype.rS=function(){var a=this;a.$R=S,a.eS=S,a.dS=S,d.GC$(a.iS).remove(),a.cS=S,a.pS=!1,_b(a),a.qS=!1,a.kv=!1},a.prototype.yl=function(a,b){var c,e,f,g,h,i,j,k=this,l=k.YR,m=k.kj;if(l){if(c=!1,k.sS=a,e=k.hS,!e){if(a.width<=0||a.height<=0)return;e=k.hS=Yb(k),Ya(l,e),f=m.parent,f&&(g=k.Ks=f.pZJ(),g&&d.GC$(g).append(e))}h=k.kS,h||(h=k.kS=l.WR(k.WE,k.aS),"1"===l.typeName?(k.lS=N(Z.dLb),d.GC$(k.lS).addClass(Z.UHc+" "+Z.ZHc).attr(Z.qHc,Z.oHc),e.appendChild(k.lS),k.lS.appendChild(h)):(e.appendChild(h),c=!0)),k.lS&&(fc(k,b,a),b.x=0,b.y=0),i=d.GC$(h),d.GC$(e).css([Z.Lcc,Z.rGc,Z.uGc,Z.vGc],[a.y,a.x,a[Z.uGc],a[Z.vGc]]),i.css([Z.Lcc,Z.rGc,Z.uGc,Z.vGc],[b.y,b.x,b[Z.uGc],b[Z.vGc]]),k.Tka=a,l.refreshContent&&l.refreshContent(h),k.lS&&ec(k),l.isSelected()?(i.removeClass(Z.WHc).addClass(Z.VHc),l.allowResize()?ac(k,e):k.ZR&&dc(k,e)):(i.removeClass(Z.VHc).addClass(Z.WHc),dc(k,e)),c&&(j=h.firstChild,m.Wq(d.Events.FloatingObjectLoaded,{sheet:m,sheetName:m.name(),floatingObject:l,element:j}))}},a.prototype.no=function(){var b=this,c=b.YR,e=b.hS,f=b.iS,g=b.kS;a.ao(b,"dispose"),g&&c.VR&&(c.VR(g),c.no(!1)),e&&(d.GC$(e).remove(),b.hS=S),f&&(d.GC$(f).remove(),b.iS=S)},a.mS=7,a}(),b.FloatingObjectRender=za,d.Zn(za);function gc(a){a.zR().forEach(function(a){a.dynamicMove()?Qa(a):Ua(a),a.dynamicSize()?kb(a):Va(a)})}function hc(a,b,c){var e,f,g,h,i,j,k=a.kj,l=k.am(),m=k.it(c),n=0,o=0,p=0,q=0;return m&&m.length>0&&(e=m[0],f=m[m.length-1],n=e.x,p=f.x+f[Z.uGc]-n,0===c&&n+p>l.x+l.width&&(p=l.x+l.width-n)),g=k.jt(b),g&&g.length>0&&(h=g[0],i=g[g.length-1],o=h.y,q=i.y+i[Z.vGc]-o,0===b&&o+q>l.y+l.height&&(q=l.y+l.height-o)),j=l.Ft(b,c),j.getIntersect(n,o,p,q)||new d.Rect(0,0,0,0)}function ic(a,b,c,d){var e,f,g,h,i,j,k,l,m=a,n=m.kj,o=new P,p=n.wr;return p.isNeedToUpdateLayout&&(gc(p),p.isNeedToUpdateLayout=!1),e=n.am(),f=n.ss,g=n.it(c),h=n.jt(b),g.length<=0||h.length<=0?o:(i=g[0],j=g[g.length-1],k=h[0],l=h[h.length-1],p.zR().forEach(function(a){var b,c,m,p,q,r,s,t,u,v,w,x,y,z,A;if(a&&a.isVisible()){if(b=void 0,c=void 0,m=a[Z.yHc](),p=a[Z.AHc](),q=a[Z.CHc](),r=a[Z.EHc](),a.fixedPosition())s=a.position(),b=s.x*d+e.kt,c=s.y*d+e.nt;else{if(t=g.findCol(p))b=t.x;else if(p<i.col)for(b=i.x,u=i.col-1;u>=p;u--)b-=f._m(u);else for(b=j.x+j[Z.uGc],v=j.col+1;v<=p;v++)b+=f._m(v);if(b+=Ra(a[Z.BHc](),n.getColumnWidth(p))*d,w=h.findRow(m))c=w.y;else if(m<k.row)for(c=k.y,x=k.row-1;x>=m;x--)c-=f.Sl(x);else for(c=l.y+l[Z.vGc],y=l.row+1;y<=m;y++)c+=f.Sl(y);c+=Ra(a[Z.zHc](),n.getRowHeight(m))*d}z=void 0,A=void 0,z=a.wxb(d),A=a.xxb(d),jc(n,m,p,q,r)||o.push({name:a.name(),x:b,y:c,width:z,height:A})}}),o)}function jc(a,b,c,d,e){var f,g,h;if(a.rowOutlines)for(f=!0,h=b;h<=d;h++)if(!a.rowOutlines.isCollapsed(h)){f=!1;break}if(a.columnOutlines)for(g=!0,h=c;h<=e;h++)if(!a.columnOutlines.isCollapsed(h)){g=!1;break}return f||g}function kc(a){var b,c,d,e;if(a)for(b=a.zR(),c=b.length,d=0;d<c;d++)if(e=b[d],e.isSelected())return!0;return!1}function lc(a){var b,c=a.target;return!(!a.target||(b=c.tagName.toLowerCase(),"input"!==b&&"textarea"!==b))}Aa=function(){function a(a){this.kj=a,this.jS=new P}return a.prototype.no=function(){var a=this.jS;a.each(function(a){a.no()}),a.empty(),this.kj=S},a.prototype.yl=function(a,b,c){var e,f,g,h,i,j,k,l,m,n;if(!(a<0||b<0)){for(e=this,f=e.kj,g=e.jS,h=f.wr,i=ic(e,a,b,c),j=[],g.each(function(a){i.find(a.name)&&h.NR(a.name)===a.YR||j.push(a)}),l=j.length,k=0;k<l;k++)m=j[k],m.gS=S,g.remove(m.name),m.no();n=f.parent&&f.parent.options.useTouchLayout,za.mS=n?11:7,i.each(function(c){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=h.NR(c.name),A=V(za.mS/2+1);z&&"1"===z.typeName&&(i=z.borderWidth(),j=z.borderStyle(),lb(j)||(i=0),i>A&&(A=i)),k=hc(e,a,b),l=1,m=c.x-A-l,n=c.y-A-l,o=c[Z.uGc]+2*A+2*l,p=c[Z.vGc]+2*A+2*l,q=W(k.y,n),r=W(k.x,m),s=p,t=o,u=A,v=A,w=-1*A-l,u=n-q+u,v=m-r+v,u<=0?(s+=u,s+=w):u<A&&u>0&&(s-=A-u),v<=0?(t+=v,t+=w):v<A&&v>0&&(t-=A-v),x=g.find(c.name),x||(x=new za(h.NR(c.name),f),x.gS=e,g.push(x)),x._R=c,x.WE=a,x.aS=b,y=new d.Rect(k.x,k.y,k[Z.uGc],k[Z.vGc]),x.yl(new d.Rect(r,q,t,s).getIntersectRect(y)||new d.Rect(r,q,0,0),new d.Rect(v,u,c[Z.uGc],c[Z.vGc]))})}},a}(),Ba={getUsedRange:function(a){var b,c,e;a.type&d.UsedRangeType.picture&&(b=this,c=b.pictures,e=c&&c.getUsedRange(),i(a.range,e))},init:function(){var a=this,b=a.$oa=[];a.Zoa=function(a){b.forEach(function(b){b.Wva&&b.Wva(a)})},a.wr=a.ITa.wr,a.pictures=new ra(a,"1"),a.floatingObjects=new ra(a,"0")},dispose:function(a){var b=this;Fa(b,a.clearCache),b.wr&&d.GC$.each(b.wr.zR(),function(b,c){c.no(a.clearCache)}),a.clearCache!==!1&&(b.pictures&&(b.pictures.no(),b.pictures=S),b.floatingObjects&&(b.floatingObjects.no(),b.floatingObjects=S),b.QP=S,b.Zoa=S,b.IR=S),b.unbind(d.Events.TableFiltered+Z.nIc),b.unbind(d.Events.RangeFiltered+Z.nIc),b.unbind(d.Events.FloatingElementSelected+Z.nIc)},setHost:function(a){if(a){var b=this;b.bind(d.Events.TableFiltered+Z.nIc,function(){b.AR()}),b.bind(d.Events.RangeFiltered+Z.nIc,function(){b.AR()}),b.bind(d.Events.FloatingElementSelected+Z.nIc,function(a,c){"floatingObject"!==c.type&&b.uQ()})}},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=a.rowCount,e=a.col,f=a.colCount,g=this.wr;"addRows"===b?Ga(g,c,d):"deleteRows"===b?Ha(g,c,d):"addColumns"===b?Ia(g,e,f):"deleteColumns"===b&&Ja(g,e,f)},paint:function(a){var b=this,c=a.clipRect;b.QP(c)},lastNonNullRowAndCol:function(){var a=0,b=0,c=this.wr;return c&&c.zR().forEach(function(c){c&&(c[Z.CHc]()>a&&(a=c[Z.CHc]()),c[Z.EHc]()>b&&(b=c[Z.EHc]()))}),{lastNonNullRow:a,lastNonNullCol:b}},toJson:function(a,b){var c,d=b&&b.ignoreStyle;d||(c=this.wr.toJSON(),c.length>0&&(a.floatingObjects=c))},fromJson:function(a,b,c){var d,e,f,g=c&&c.ignoreStyle;g||(d=this,d.wr=new sa(d),d.ITa.wr=d.wr,d.wr.isNeedToUpdateLayout=!0,e=a&&a.floatingObjectArray,f=b?e&&e.floatingObjects:a.floatingObjects,f&&d.wr.fromJSON(f,b))},preProcessMouseDown:function(a){var b,c,d=a.e,e=this.Vs(),f=d.pageX-e.left,g=d.pageY-e.top;!this.Cw&&this.Cva&&(b=this.hitTest(f,g),c=b&&b.formulaRangeHitInfo,c&&(c.inBorder||c.inTopLeft||c.inTopRight||c.inBottomLeft||c.inBottomRight))||this.uQ()},processKeyDown:function(a){kc(this.wr)&&(a.r=!0);
},onGroupChanged:function(a){this.floatingObjects.tTa(a.start,a.end,a.isRow),this.pictures.tTa(a.start,a.end,a.isRow)},processCompositionStart:function(a){kc(this.wr)&&(a.r=!0)},preProcessKeyDown:function(a){var b=this.wr;b&&lc(a.e)&&kc(b)&&(a.r=!0)},fromJsonAfterSJSFormula:function(a,b,c){var d,e,f,g,h,i=c&&c.includeStyles===!1;i||(d=this,e=d.wr,f=a.lossless&&a.lossless.floatingObjects,f&&d.wr.fromJSON(f),g=m(a,b),g&&(h=g.rels,e.cdK(g,h,b,c)))}},d.Worksheet.$n(Z.tHc,Ba),Ca={priority:900,init:function(){d.Commands.JR(this.commandManager())},onCommandExecuting:function(a){var b=a.wr.zR();b.forEach(function(a){a.isSelected(!1)})},onCultureChanged:function(){G()},bdK:function(a,b,c){var e,f,g,h,i,j,k,l,m,p,q,r,s,t,u,v,w,x,y=this,z=y.sheets;for(e=0;e<z.length;e++){if(f=z[e],g=A(a,f.name()),g.lossless||(g.lossless={}),h=f.charts,i=h&&h.all(),j=f.pictures,k=j&&j.all(),l=f.floatingObjects,m=l&&l.all(),i&&i.length>0)for(o(g,y.kkK),p=n(a,g),q=p.rels,r=0;r<i.length;r++)s=i[r],t=d.OpenSaveFileType.sjs,c&&!J(c.fileType)&&(t=c.fileType),s.fileType=t,Ca.toSJSFormat_Chart(a,s,p,q),delete s.fileType;if(k&&k.length>0){for(u={c_:[]},p=void 0,q=void 0,r=0;r<k.length;r++)v=k[r],w=";base64,",x=v.src(),x&&x.indexOf(w)>0?(p||(o(g,y.kkK),p=n(a,g),q=p.rels),Ca.toSJSFormat_Picture(a,v,u,q)):(g.lossless.floatingObjects||(g.lossless.floatingObjects=[]),g.lossless.floatingObjects.push(jb(v)));u.c_.length>0&&(p.c_=u.c_.concat(p.c_))}if(m&&m.length>0)for(g.lossless.floatingObjects||(g.lossless.floatingObjects=[]),r=0;r<m.length;r++)g.lossless.floatingObjects.push(jb(m[r]))}},toSJSFormat_Chart:function(a,b,c,e){var f,g,h,i,j=D(b.chartType()),k=C(e),l="rId"+k,m=b.VdK;c._id=l,j&&(f=q(a.workbook,"definedNames"),J(f)?(g={n_:"definedNames",c_:[]},a.workbook.c_.push(g),b.workbookCustomNames=g):b.workbookCustomNames=f),h=b.bdK(c),delete c._id,i=j?d.XFileConstants.Q0a:d.XFileConstants.epa,e.c_.push({n_:"Relationship",Id:l,Type:j?d.RelationshipConstants.K0a:d.RelationshipConstants.apa,Target:"../charts/"+i+m+"."+d.XFileConstants.r8}),J(a.charts)&&(a.charts={}),a.charts[i+b.VdK]=h,delete b.workbookCustomNames},toSJSFormat_Picture:function(a,b,c,e){var f=d.Util.pkK(b.src(),e,a);c._id=f,b.bdK(c),delete c._id}},d.Workbook.$n(Z.tHc,Ca);function mc(a,b,c){var e,f,g,h,i=void 0;return a&&(e=void 0,f=a.floatingObjectType,g=d.Ul.Ol(f)?f+"":a.typeName,"0"===g?i=new xa:"1"===g?i=xa.ozb():(e=d.getTypeFromString(g),e&&(i=new e(c))),i&&(i.fromJSON(a,b),h=a.zIndex,J(h)||(i.PR=h))),i}d.GC$.extend(d.lUa.prototype,{BUa:function(a,b,c,d){var e,f=this.zTa;f&&(e=f.floatingObjectChanges,e||(e=f.floatingObjectChanges=[]),e.push({type:"property",floatingObject:a,name:b,value:c,newValue:d}))},AUa:function(a){var b,c,e,f,g=this.zTa;g&&(b=g.floatingObjectChanges,b||(b=g.floatingObjectChanges=[]),c={},e=this.wr,d.GC$.each(e.QR,function(a,b){c[a]=b}),a?(f=b[b.length-1],f.currentObjects=c):b.push({type:"collection",floatingObjects:c}))},DUa:function(a,b){var c,d,e,f;if(a)for(c=this,d=c.wr,e=function(e){var f,g,h,i,j,k,l,m=a[e];"collection"===m.type?(f=b?m.currentObjects:m.floatingObjects,g=d.QR,d.QR={},c.kj.suspendPaint(),c.kj.clearSelection(),H.H(f,function(a,b){if("Object"===b.constructor.name){var e=g[a];e||(e=mc(b,!1,c.kj)),d.Sb(e)}else d.Sb(b)}),c.kj.resumePaint()):"property"===m.type&&(h=["startRow","startRowOffset","startColumn","startColumnOffset","endRow","endRowOffset","endColumn","endColumnOffset"],i="function"==typeof m.floatingObject.name?m.floatingObject.name():m.floatingObject.name,j=d.NR(i),k=m.name,l=b?m.newValue:m.value,j&&(j.ROJ=!0,j[k](l),h.indexOf(k)>=0&&(Qa(j),kb(j),j.sheet().$p()),j.ROJ=!1))},f=a.length-1;f>=0;f--)e(f)}}),d.lUa.$n(Z.tHc,{init:function(){this.wr=new sa(this.kj)},applyChanges:function(a){var b=a.changes,c=a.isUndo,d=b&&b.floatingObjectChanges;d&&this.DUa(d,!c)},undo:function(a){var b=a.floatingObjectChanges;b&&this.DUa(b)},dispose:function(a){var b=this,c=a&&a.clearCache;c!==!1&&b.wr&&(b.wr.no(),b.wr=S)}});function nc(a){var b=!0,c=!0;return 2===a?(b=!1,c=!1):1===a&&(c=!1),{dynamicMove:b,dynamicSize:c}}function oc(a,b){var c="png",d=a.lastIndexOf(".");return d!==-1&&(c=a.substr(d+1)),"svg"===c&&(c="svg+xml"),b?"data:image/"+c+";base64,"+b:S}function pc(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=Math.PI/180/6e4;if(a)return b=a.rot||0,c=a.off,d=a.ext,e=c.x,f=c.y,g=d.cx,h=d.cy,i=g/2,j=h/2,k=b*v,l=Math.sin(k),m=Math.cos(k),n=e+i,o=f+j,p=[],q=[],[{x:-i,y:-j},{x:i,y:-j},{x:-i,y:j},{x:i,y:j}].forEach(function(a){var b=qc(a,l,m);p.push(b.x+n),q.push(b.y+o)}),r=Math.min.apply(null,p),s=Math.max.apply(null,p),t=Math.min.apply(null,q),u=Math.max.apply(null,q),{x:r,y:t,width:s-r,height:u-t}}function qc(a,b,c){return{x:a.x*c-a.y*b,y:a.x*b+a.y*c}}},"./dist/plugins/floatingObject/floatingobject.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/floatingObject/floatingobject.res.en.js");b.SR={en:d}},"./dist/plugins/floatingObject/floatingobject.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_FloatingObjectHasSameNameError="The current worksheet already has a floating object with the same name.",b.Exp_FloatingObjectNameEmptyError="Floating object must have name"},"./dist/plugins/floatingObject/picture.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/floatingObject/floatingobject.js"),f=d.Ul.Nl,g=d.Ul.Pl,h=d.GC$,i=null,j=void 0,k="src",l="backColor",m="pictureStretch",n="borderRadius",o="borderWidth",p="borderStyle",q="borderColor",r="noFill",s=[k,l,n,o,p,r,q,m];function x(a){return"number"==typeof a&&!isNaN(a)}e.FloatingObject.ozb=function(a,b,c,d,e,f){return new t(a,b,c,d,e,f)},t=function(a){w(b,a);function b(b,c,d,e,f,g){var h=a.call(this,b,d,e,f,g)||this,j=h;return j.typeName="1",j.g3="1",j.bt=i,j.oS=!1,j.JS=!1,"string"==typeof c&&(j.JS=!(x(f)&&x(g)),j.src(c)),h}return b.prototype.onPropertyChanged=function(a,b,c){var d,e=this;e.TR||(d=e.sheet(),d&&(d.ITa.BUa(e,a,c,b),this.Wq({sheet:d,sheetName:d.name(),picture:e,propertyName:a})))},b.prototype.toJSON=function(){var b,c,d,f=this,g=a.prototype.toJSON.call(this);return e.toJsonFn.call(f,s,g),g.originalWidth=f.getOriginalWidth(),g.originalHeight=f.getOriginalHeight(),f.tmb&&(g.rot=f.tmb),b=f.rmb,b&&(c=b.left,d=b.top,g.srcRect={l:c,t:d,r:1-c-b.width,b:1-d-b.height}),g.isTakeOriginalSize=f.JS,delete g.content,g},b.prototype.fromJSON=function(b,c,d){var f,g,h,i,k;b&&(f=this,f.TR=!0,d&&(g=x(b.x)&&x(b.y)&&x(b.width)&&x(b.height),g&&(b.endRow=null,b.endRowOffset=null,b.endColumn=null,b.endColumnOffset=null)),a.prototype.fromJSON.call(this,b,c),e.fromJsonFn.call(f,s,b,c),b.rot&&(f.tmb=b.rot),f.oS=!1,h=b.srcRect,h&&(i=h.l,k=h.t,f.rmb={left:i,top:k,width:1-i-h.r,height:1-k-h.b}),f.JS=b.isTakeOriginalSize,y(f),f.TR=j)},b.prototype.cdK=function(a,b,c){this.fromJSON(a,b,c)},b.prototype.clone=function(){var a=new b,c=JSON.stringify(this.toJSON());return a.fromJSON(JSON.parse(c)),a},b.prototype.getOriginalWidth=function(){return this.KS},b.prototype.getOriginalHeight=function(){return this.LS},b.prototype.nS=function(a){var b=["dotted","dashed","solid","double","groove","ridge","inset","outset"];return b.indexOf(a)>=0},b.prototype.WR=function(a,b){var c=f("div");return h(c).addClass("gc-floatingobject-content-container").addClass("gc-no-user-select").attr("unselectable","on").css("position","absolute"),this.UR(c,a,b),c},b.prototype.Wq=function(a){var b,c=this.sheet();c&&(c.Wq(d.Events.PictureChanged,a),"isSelected"===a.propertyName&&(b={sheet:a.sheet,sheetName:a.sheetName,picture:a.picture},c.Wq(d.Events.PictureSelectionChanged,b)))},b.prototype.no=function(a){var b=this;b.bt&&a!==!1&&(b.bt.no(),b.bt=i)},b}(e.FloatingObject),b.Picture=t;function y(a){var b,c,e=a,f=e.src(),g=e.sheet();e.bt||(e.bt=new d.oo(function(){y(e)})),b=e.bt;try{b.ko(f)?(e.oS=!0,c=b.lo(f),e.KS=c.width,e.LS=c.height,e.tmb&&e.tmb%90===0&&(e.qmb=z(c,c.width,c.height,e.tmb)),e.JS&&(e.width(c.width,!0),e.height(c.height,!0),e.JS=!1),e.Wq({sheet:g,sheetName:g.name(),picture:e,propertyName:"originalSize"}),e.isVisible()&&g&&g.repaint()):b.fo(f)}catch(a){}}function z(a,b,c,d){var e,f,g=b,h=c;return 90!==d&&270!==d||(g=c,h=b),e=document.createElement("canvas"),e.width=g,e.height=h,f=e.getContext("2d"),f.translate(g/2,h/2),f.rotate(d/180*Math.PI),f.translate(-g/2,-h/2),f.drawImage(a,0,0,b,c,(g-b)/2,(h-c)/2,b,c),f.setTransform(1,0,0,1,0,0),e.toDataURL()}u=[[k,j,function(a,b){var c=this;c.oS=!1,y(c),c.srccallback||(c.srccallback=e.propertyRefreshCallback(k)),c.srccallback.call(c,a,b)}],[l,i,e.propertyRefreshCallback(l)],[n,-1,e.propertyRefreshCallback(n),x],[o,1,e.propertyRefreshCallback(o),x],[p,"none",function(a,b){var c=this;c.nS(a)||c.borderWidth(0),c.bscallback||(c.bscallback=e.propertyRefreshCallback(p)),c.bscallback.call(c,a,b)}],[r,j],[q,i,e.propertyRefreshCallback(q)],[m,0,e.propertyRefreshCallback(m)]],v=t.prototype,h.each(u,function(a,b){v[b[0]]=g(b[0],b[1],b[2],b[3])})},"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(a,b,c){"use strict";var d,e;function f(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),f(c("./dist/plugins/formulaTextbox/formulatextbox.js")),f(c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js")),c("./dist/plugins/formulaTextbox/formulatextbox-event.js"),c("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),c("./dist/plugins/formulaTextbox/formulatextbox-render.js"),e=c("./dist/plugins/formulaTextbox/formulatextbox.js"),b.findControl=function(a){return"string"==typeof a&&(a=document.getElementById(a)),d.GC$(a).data(e.CONST_FORMULATEXTBOX)}},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/formulaTextbox/formulatextbox.js"),f=null,g=void 0;function j(a){var b=d.Ul.Nl("textarea"),c=d.GC$(b);return c.css({display:"none"}),d.GC$(a).append(b),b}b.W4=j,h=function(){function a(){var a=this;a.nT=-1,a.Mk=-1,a._text="",a.Q2=-1,a.kj=null,a.MH=!1,a.R2=-1,a.I0=null,a.OC=null,a.f1=null}return a.prototype.$b=function(){var a=this;a.S2(),a.nT=-1,a.Mk=-1,a._text="",a.Q2=-1,a.MH=!1,a.R2=-1,a.kj=null,a.OC=null,a.f1=null},a.prototype.S2=function(){var a,b,c=this;c.kj.Js||(a=c.kj.getCellType(c.nT,c.Mk),b={sheet:c.kj,row:c.nT,col:c.Mk,sheetArea:3},c.I0&&c.I0.firstChild&&a.deactivateEditor(c.I0.firstChild.firstChild,b)),d.GC$(c.I0).remove(),c.I0=null},a.prototype.T2=function(a){var b,c=this,e=a.Cw;e&&(b=a._ZJ,c._text=e.text(),c.nT=b?b.row:a.getActiveRowIndex(),c.Mk=b?b.col:a.getActiveColumnIndex(),c.Wz=b?b.sheetArea:d.SheetArea.viewport,c.Q2=e.caret(),c.MH=e.MH,c.R2=e.C1(),c.V4=e.V4,c.C5=e.C5,c.Nfa=e.Nfa,c.kj=a,c.OC=a.parent,c.f1=a.mm.bG())},a.prototype.VF=function(a){var b=this;a.Cw&&(b._text=a.Cw.text(),b.Q2=a.Cw.caret(),b.MH=a.Cw.MH,b.R2=a.Cw.C1())},a.prototype.U2=function(a){var b=this,c=a.Cw;c&&(c.V4=b.V4,c.C5=b.C5,c.Nfa=b.Nfa,c.text(b._text),c.caret(b.Q2),b.MH&&(c.B1(),c.C1(b.R2)))},a.prototype.S8J=function(a){var b,c=a.oldSheet,d=this,e=c&&c.Cw;if(e)if(e.close(),(!d.kj||d.kj.Js)&&e.M0()||d.C5!==e.C5){d.T2(c),b=c.getValue(d.nT,d.Mk,d.Wz),c.suspendEvent();try{if(!c.endEdit(!0))return}finally{c.resumeEvent()}c.setValue(d.nT,d.Mk,b,d.Wz,!0),c.Px=1,a.needTriggerSheetChange=!1}else d._text&&(d.VF(c),e.destroy(),c.Cw=f,a.needTriggerSheetChange=!1)},a.prototype.T8J=function(a){var b,c,g,h,i,k=a.oldSheet,l=a.newSheet,m=this;if(l&&!l.Js){if(m.I0&&""===m._text&&(k&&k.GJ(),m.$b()),m._text&&m.kj===l)l.Px=0,l.zt(),l.suspendEvent(),m.V4?(b=j(l.parent.qo),e.J0(l,b,f,l.Jl,l.Kl,3),l.Px=2,l.yl.uH()):(c=void 0,g=void 0,m.Wz===d.SheetArea.rowHeader?(c=1,g=-1):m.Wz===d.SheetArea.colHeader&&(c=-1,g=1),l.EF(l.Ws(),m.nT,m.Mk,c,g,!1)),l.resumeEvent(),m.U2(l),m.VK(l,m.nT,m.Mk,m.Wz),k&&k.GJ(),m.$b();else if(m._text&&!m.I0){if(l.Px=1,k&&(k.Px=1),m.X2(l),!m.kj||m.kj.Js)return;l.EJ()}else if(m._text&&m.kj!==l){if(l.Px=1,k&&(k.Px=1,k.GJ()),m.X2(l),!m.kj||m.kj.Js)return;l.EJ()}h=m.kj,h&&(i=l.Cw,i&&(i.d$J=h!==l))}},a.prototype.X2=function(a){var b,c,h,i,j,k,l,m,n,o,p,q,r=this,s=r.kj;s&&!s.Js&&(b=r.nT,c=r.Mk,h=r.Wz,i=s.getCellType(b,c,h),j={sheet:s,row:b,col:c,sheetArea:h,canvasOffset:this.f1},k=i.isImeAware(j),(k||h!==d.SheetArea.viewport)&&(a.Px=1,l=i.a5(j),r.I0&&r.S2(),m=void 0,n=void 0,r.Wz===d.SheetArea.rowHeader?(m=1,n=-1):r.Wz===d.SheetArea.colHeader&&(m=-1,n=1),r.I0=l,d.GC$(l).css("position","absolute"),o=s.getCellRect(b,c,m,n),o.width===g&&(o.width=0),o.height===g&&(o.height=0),d.GC$(l).attr("id","across"),p=s.getActualStyle(b,c,h),i.d5(l,p,o,j),q=r.OC&&r.OC.getHost()||document.body,q.insertBefore(l,f),r.V4&&d.GC$(l).css({display:"none"}),e.J0(a,i.getEditingElement(),!0,a.Jl,a.Kl,3),l.firstChild&&!r.V4&&i.focus(l.firstChild.firstChild),r.U2(a),i.g5(l,p,o,j)))},a.prototype.VK=function(a,b,c,e){var f,g,h,i,j,k,l,m,n;e===d.SheetArea.rowHeader?g=-1:e===d.SheetArea.colHeader&&(f=-1),h=a.getCellType(b,c,e),i=a.BF,j=a.am(),k=a.getActualStyle(b,c,e),l=a.getCellRect(b,c,f,g),m=!1,e===d.SheetArea.rowHeader?m=l.x>=j.x&&l.y>=j.y+j.Cr&&l.x+l.width<=j.pt&&l.y+l.height<=j.ot+j.gs:e===d.SheetArea.colHeader?m=l.x>=j.x+j.Br&&l.y>=j.y&&l.x+l.width<=j.lt+j.js&&l.y+l.height<=j.qt:e===d.SheetArea.viewport&&(m=l.x>=j.kt&&l.y>=j.nt&&l.x+l.width<=j.lt+j.js&&l.y+l.height<=j.ot+j.gs),l&&l.width>0&&l.height>0&&m&&(n={sheet:a,row:b,col:c,sheetArea:e},i&&i.parentNode&&h.g5(i.parentNode.parentNode,k,l,n))},a}(),i=function(){function a(){}return a.U8J=function(b,c){a.H0||(a.H0=new h),a.H0.S8J(c)},a.V8J=function(b,c){a.H0||(a.H0=new h),a.H0.T8J(c)},a}(),b.G0=i},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/formulaTextbox/formulatextbox.js"),g=c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),h=void 0,i=e.Common.j.Fa;function k(a){var b,c=a.Cw,d=a.mm;return b=c.MH?d.E2:d.E2={anchorRow:a.Jl,anchorCol:a.Kl,leadingRow:a.Qr,leadingCol:a.Rr}}function l(a,b,c,e,g){var h,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=a.Cw,F=a.parent,G=F&&F.options;if(E&&E.M0()&&G&&G.allowUserEditFormula&&G.enableFormulaTextbox){switch(h=k(a),j=h.anchorRow,l=h.anchorCol,m=h.leadingRow,n=h.leadingCol,i(e)&&(e=j),i(g)&&(g=l),o=a.mm,b){case 3:t=a.iy(e,g,c,m);break;case 4:t=a.hy(e,g,c,m);break;case 1:t=a.HJ(e,g,c,n);break;case 2:t=a.LJ(e,g,c,n);break;case 5:t=a.OJ();break;case 6:t=a.NJ()}t&&(p=t.row,q=t.col,r=t.leadingCellRow?t.leadingCellRow:p,s=t.leadingCellCol?t.leadingCellCol:q,a.IJ(p,q)&&(h.anchorRow=p,h.anchorCol=q,h.leadingRow=r,h.leadingCol=s,u=a.pivotTables&&a.pivotTables.findPivotTable(r,s),v=E.shift,w=E.ctrl,x=u&&u.getPivotInfoImp(r,s,!1,!0),y=x&&x.area,!E.Nfa&&u&&x&&4===y?(E.GNc=new d.Range(r,s,1,1),z=x.valueFieldName,A=x.rowInfos,B=x.colInfos,(A||B)&&(C=a.mm.HNc(y,z,A,B,u.position()),C&&(E.v1(C,v,!w,!0),E.OG=!1))):(delete E.GNc,D=f.C2(o.kj,d.kf(p,q,1,1)),D&&E.v1(D,!1,!0)),p>=0&&q>=0&&a.Yq(p,q)))}}function m(a,b){if(a){if(2===a.Px)return!1;var c=a.Cw;return c&&c.M0()?(l(a,b,!1),!0):(c&&(a=j.O2(a)),a.yx(b,!1),!0)}return!1}function n(a,b,c,d){if(a){if(2===a.Px)return!1;var e=a.Cw;return e&&e.M0()?(l(a,b,!1,c,d),!0):(e&&(a=j.O2(a)),a.yx(b,!1,c,d),!0)}return!1}function o(a,b,c){var e,g,h,i,j,l,m,n,o=a.Cw,p=a.parent,q=p&&p.options;o&&o.M0()&&q&&q.allowUserEditFormula&&q.enableFormulaTextbox&&(e=a.mm,g=k(a),h=g.anchorRow,i=g.anchorCol,o.MH?(l=o.m1(),j=f.L0(a,l.text)):j=d.kf(h,i,1,1),j&&(m=a.UJ(j,b,c,h,i),n=f.C2(e.kj,m),n&&o.v1(n,!0,!1)))}function p(a,b,c){if(a){if(2===a.Px)return!1;var d=a.Cw;return d&&d.M0()?(o(a,b,c),!0):(d&&(a=j.O2(a)),!!a.endEdit()&&(a.Sx(b,c),!0))}return!1}d.Commands.Ox=m,d.Commands.Qx=n,d.Commands.Rx=p,j=function(){function a(){}return a.fv=function(b){return a.O2(b)},a.Xx=function(b){return a.O2(b)},a.Yx=function(b){return a.O2(b)},a.O2=function(b){var c=b,d=g.G0.H0;return d&&d._text&&d.kj&&(c=d.kj,a.G2(c)),c},a.G2=function(a,b){var c,d;void 0===b&&(b=!0),c=a.parent,d=g.G0.H0,d&&d._text&&c.hw(a,b)},a.Zx=function(b,c,e){var g,h,i=!1,j=b.Cw;return j&&j.M0()?(g=k(b),g.anchorRow=c,g.leadingRow=c,h=f.C2(b,d.kf(g.anchorRow,g.anchorCol,1,1)),h&&j.v1(h,!1,!0),b.mq(e),i=!0):j&&(b=a.O2(b)),{sheet:b,r:i}},a._x=function(b,c,e){var g,h,i=!1,j=b.Cw;return j&&j.M0()?(g=k(b),g.anchorRow=c,g.leadingRow=c,h=f.C2(b,d.kf(g.anchorRow,g.anchorCol,1,1)),h&&j.v1(h,!1,!0),b.mq(e),i=!0):j&&(b=a.O2(b)),{sheet:b,r:i}},a.pzb=function(b,c){var d=!1,e=c?5:6,f=b.Cw,g=b.Jl,h=b.Kl;return f&&f.M0()?(f.MH||(b.mm.E2={anchorRow:g,anchorCol:h,leadingRow:b.Qr,leadingCol:b.Rr}),l(b,e,!1,g,h),d=!0):f&&(b=a.O2(b)),{sheet:b,r:d}},a.ay=function(b){return a.pzb(b,!0)},a.by=function(b){return a.pzb(b,!1)},a.ey=function(b){return a.O2(b)},a.gy=function(b){return a.O2(b)},a.jy=function(b){var c,d,e,i=g.G0.H0;if(i&&i._text&&i.kj&&(b=i.kj,c=i.nT,d=i.Mk,a.G2(b,!1),f.K0(b),i.V4||b.Sr(c,d,h,h,1),b.isEditing()))return e=b.getValue(c,d,3),!!b.gv(!0,void 0,void 0,!0)&&(b.setValue(c,d,e,3,!0),!0)},a}(),d.Commands.i8J=j},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-calc"),f=c("SheetsCalc"),g=c("./dist/plugins/formulaTextbox/formulatextbox.js"),h=c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),i=c("Common"),j=i.Common.j.Fa,k=d.GC$.extend,l=null,m=void 0,n=Math.max,o=Math.min;function p(a,b,c,e){var f,g,h,i,j=a.Cw,k=a.ITa,l=j.F$J(),m=d.SheetArea.viewport;return l===d.SheetArea.colHeader&&e===d.SheetArea.colHeader?(f=k.getFreeAreaRowCount(d.SheetArea.colHeader),g=b,g<f&&(m=d.SheetArea.colHeader)):l===d.SheetArea.rowHeader&&e===d.SheetArea.rowHeader&&(h=k.getFreeAreaColumnCount(d.SheetArea.rowHeader),i=c,i<h&&(m=d.SheetArea.rowHeader)),m}function q(a,b,c,e,f,g,h,i){var j=a.Jx(b,c,b,c,h,i);return j=d.kf(j.row,j.col,1,1),g&&e>=0&&e>=0&&(j=a.Jx(b,c,e,f,h,i)),j}k(d.iI.prototype,{D2:function(a){var b,c,e,f,h,i,j,k,l,n,o,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=this,I=H.kj,J=I.Cw;J&&(H.Kka(),b=I.frozenRowCount(),c=I.frozenColumnCount(),e=J.MH,e&&H.E2||(H.E2={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),f=I.getRowCount(),h=I.getColumnCount(),i=a.hitTestType,j=a.row,k=a.col,l=H.shift,n=H.ctrl,J&&J.qp&&(J.qp===d.SelectionUnit.row?i=2:J.qp===d.SelectionUnit.column&&(i=1)),o=H.E2,r=o.anchorRow,s=o.anchorCol,t=-1,u=-1,w=p(I,j,k,i),0===i?(t=b?I.ar():I.lq,u=c?I.$q():I.qq,v=d.kf(-1,-1,-1,-1),J.v1(g.C2(I,v),l,!n,m,w),H.OG=!0):1===i?(w===d.SheetArea.viewport?(t=b?I.ar():I.lq,u=k,v=I.Jx(0,k,f-1,k,!0),l&&s>=0&&(v=I.Jx(0,k,f-1,s,!0)),v=d.kf(-1,v.col,-1,v.colCount)):w===d.SheetArea.colHeader&&(t=j,u=k,v=q(I,j,k,r,s,l,!0,w)),J.v1(g.C2(I,v,m,w),l,!n,m,w),H.OG=!0):2===i?(t=j,u=c?I.$q():I.qq,v=I.Jx(j,0,j,h-1,!0),l&&r>=0&&(v=I.Jx(j,0,r,h-1,!0)),v=d.kf(v.row,-1,v.rowCount,-1),J.v1(g.C2(I,v),l,!n,m,w),H.OG=!0):3===i&&(t=j,u=k,j!==m&&k!==m&&(x=a.row,y=a.col,z=a.pivotTableInfo,A=z&&z.getPivotInfoImp(x,y,!1,!0),B=A&&A.area,C=a.tableSelectInfo&&a.tableSelectInfo.tableSelection,!J.Nfa&&z&&A&&4===B?(J.GNc=new d.Range(x,y,1,1),D=A.valueFieldName,E=A.rowInfos,F=A.colInfos,(E||F)&&(G=H.HNc(B,D,E,F,z.position()),G&&(J.v1(G,l,!n,!0,w),H.OG=!0,H._BJ=!0))):(delete J.GNc,v=C?C:q(I,j,k,r,s,l,!0,w),J.v1(g.C2(I,v,m,w),l,!n,m,w),H.OG=!0))),H.DG=H.OG,l&&e||(o.anchorRow=t,o.anchorCol=u,o.leadingRow=t,o.leadingCol=u,o.sheetArea=w),H.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},H.qG())},HNc:function(a,b,c,e,f){var h,i,j,k,l,m,n,o,p,q,r,s=this,t=s.kj;if(4===a)return h=void 0,i=void 0,j="",k=f.row,l=f.col,m=d.kf(k,l,1,1),h=g.C2(t,m,!0),n=[],o=[],o=Array.isArray(c)&&Array.isArray(e)?c.concat(e):Array.isArray(c)&&c||Array.isArray(e)&&e,p=/\"/g,q='""',o&&o.forEach(function(a){"number"==typeof a.fieldName?n.push(a.fieldName):n.push('"'+a.fieldName.replace(p,q)+'"'),"number"==typeof a.itemName?n.push(a.itemName):n.push('"'+a.itemName.replace(p,q)+'"')}),j=n.join(","),i=b.replace(p,q),r='GETPIVOTDATA("'+i+'",'+h,""!==j&&(r+=","+j),r+")"},F2:function(a){var b,c,e=!1,f=h.G0.H0;if(f&&f.I0)if(b=f.kj,c=a.Cw,c&&b.setFormula(f.nT,f.Mk,c.text()),b!==a){if(d.Commands.i8J.G2(b),!b.endEdit())return;e=!0}else c&&(c.destroy(),a.Cw=l),f.$b();return e},EG:function(){var a,b,c=this,e=this._oa(),f=c.rG,g=c.E2;f&&c.OG&&(a=f.sG,b=g.sheetArea,e&&e.qp&&(e.qp===d.SelectionUnit.row?a=2:e.qp===d.SelectionUnit.column&&(a=1)),a===d.SheetArea.viewport||b===d.SheetArea.colHeader||b===d.SheetArea.rowHeader?c.H2():2===a?c.I2():1===a&&c.J2())},H2:function(){var a,b,c,d,e=this,f=e.E2,h=f.anchorRow,i=f.anchorCol,j=f.sheetArea,k=e.fH(m,j,!0),l=e.gH(m,j,!0);h>=0&&i>=0&&k>=0&&l>=0&&(a=e.kj,b=a.Jx(k,l,h,i,!0,j),c=g.C2(a,b,m,j),c&&(d=a.Cw,e._BJ?b.equals(d.GNc)||(delete d.GNc,d.v1(c,!0,!0)):d.v1(c,!0,!1))),e.NG()},I2:function(){var a,b,c,e,f=this,h=f.E2.anchorRow,i=f.fH();h>=0&&i>=0&&(a=f.kj,b=a.Jx(i,0,h,a.getColumnCount()-1,!0),b=d.kf(b.row,-1,b.rowCount,-1),c=g.C2(a,b),c&&(e=a.Cw,e.v1(c,!0,!1))),f.NG()},J2:function(){var a,b,c,e,f=this,h=f.E2.anchorCol,i=f.gH();h>=0&&i>=0&&(a=f.kj,b=a.Jx(0,i,a.getRowCount()-1,h,!0),b=d.kf(-1,b.col,-1,b.colCount),c=g.C2(a,b),c&&(e=a.Cw,e.v1(c,!0,!1))),f.NG()},yH:function(){var a=this;a.RG(),a.rG=l,a.OG=!1,a.DG=!1},iG:function(a){var b,c,e,f,h,i,k,l,m,n=this,o=n.kj,p=n._oa(),q=a.formulaRangeHitInfo;q&&q.inBorder&&p&&(p.MH&&p.NH(),p.close(),b=q.paramRange,c=b&&b.text,e=j(b.sheetArea)?d.SheetArea.viewport:b.sheetArea,c&&(f=g.L0(o,c),f&&(n.Kka(),h=o.Tq(f,e),i=a.row,k=a.col,i<h.row&&(i=h.row),i>=h.row+h.rowCount&&(i=h.row+h.rowCount-1),k<h.col&&(k=h.col),k>=h.col+h.colCount&&(k=h.col+h.colCount-1),l=i-h.row,m=k-h.col,n.OG=!0,n.FG=!0,n.K2={paramRange:b,fromRange:f,rowOffset:l,colOffset:m,sheetArea:e},n.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},n.qG())))},GG:function(){var a,b,c,e,f,h,i,j,k,l,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this;E.OG&&E.FG&&(a=E.K2,b=a.sheetArea,c=E.fH(m,b,!0),e=E.gH(m,b,!0),c>=0&&e>=0&&(f=a.fromRange,h=a.rowOffset,i=a.colOffset,j=a.toRow,k=a.toCol,l=c,p=e,l===j&&p===k||(a.toRow=l,a.toCol=p,q=E.kj,r=q.getRowCount(b),s=q.getColumnCount(b),t=f.row,u=f.col,v=f.rowCount,w=f.colCount,x=q.ITa,y=x.getFreeAreaRowCount(b),z=x.getFreeAreaColumnCount(b),r>y&&(r=y),s>z&&(s=z),A=t<0?-1:n(0,o(r-v,c-h)),B=u<0?-1:n(0,o(s-w,e-i)),C=g.C2(q,d.kf(A,B,v,w),m,b),C&&(D=E._oa(),D.D1(a.paramRange.index,C,!0)))),E.NG())},zH:function(){var a,b=this;b.RG(),b.OG=!1,b.FG=!1,b.K2=l,a=b._oa(),a.onRangeMoved&&a.onRangeMoved()},jG:function(a){var b,c,d,e,f,h,i,j,k,l,m,n=this,o=n.kj,p=n._oa(),q=a.formulaRangeHitInfo;if(q&&p&&(p.MH&&p.NH(),b=q.paramRange,c=b&&b.text,b&&c&&(d=g.L0(o,c)))){if(n.Kka(),e=d.row,f=d.row<0?-1:d.row+d.rowCount-1,h=d.col,i=d.col<0?-1:d.col+d.colCount-1,q.inTopLeft)j=f,k=i,l=e,m=h;else if(q.inTopRight)j=f,k=h,l=e,m=i;else if(q.inBottomLeft)j=e,k=i,l=f,m=h;else{if(!q.inBottomRight)return;j=e,k=h,l=f,m=i}n.OG=!0,n.HG=!0,n.L2={paramRange:b,anchorRow:j,anchorCol:k,toRow:l,toCol:m,sheetArea:a.hitTestType},n.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},n.qG()}},n8J:function(a,b){var c=a.Cw;return(!c||!c.wWJ)&&(c&&c.M0()?(this.D2(b),!0):!!this.F2(a))},IG:function(){var a,b,c,e,f,h,i,k,l,p,q,r,s,t,u,v,w,x,y,z,A,B,C=this;C.OG&&C.HG&&(a=C.L2,b=d.SheetArea.viewport,a&&!j(a.sheetArea)&&(b=a.sheetArea),c=C.fH(m,b,!0),e=C.gH(m,b,!0),c>=0&&e>=0&&(f=a.anchorRow,h=a.anchorCol,i=a.toRow,k=a.toCol,l=c,p=e,l===i&&p===k||(a.toRow=l,a.toCol=p,q=C.kj,r=q.getRowCount(b),s=q.getColumnCount(b),t=f<0?r-1:f,u=h<0?s-1:h,v=o(t,l),w=o(u,p),x=n(t,l)-v+1,y=n(u,p)-w+1,z=C._oa(),(0===v&&x===r||z&&z.qp===d.SelectionUnit.column)&&(v=-1,x=-1),(0===w&&y===s||z&&z.qp===d.SelectionUnit.row)&&(w=-1,y=-1),A=a.paramRange,B=g.C2(q,d.kf(v,w,x,y),m,A.sheetArea),B&&z.D1(A.index,B,!0))),C.NG())},AH:function(){var a,b,c=this;c.RG(),c.OG=!1,c.HG=!1,c.L2=l,a=c._oa(),a.V4&&(a.W0=1,b=a.text().lastIndexOf(",",a.caret()),b!==-1&&(a.W0=b+1)),a.onRangeResized&&a.onRangeResized()},vr:function(a,b,c){var e,f,i,k,m,n,o,p,q,r,s,t,u,v,w,x=this.kj,y=this._oa(),z=y&&y.l1();if(!z||0===z.length||!y.UQa)return l;if(e=a.rowViewportIndex,f=a.colViewportIndex,i=a.hitTestType,this.qH(e,f,b,c))return l;for(o=z.length-1;o>=0;o--)if(k=z[o],p=k.sheetArea,k.allowDrag!==!1&&(j(p)||p===i)&&(q=h.G0.H0,!(q&&q._text||(m=g.L0(x,k.text),j(m))))){if(j(p)&&(p=d.SheetArea.viewport),r=x.ITa.findSpan(m.row,m.col,p),r&&r.containsRange(m)&&(m=r),n=x.getRangeRect(e,f,m),s=5,t=n.x-2,u=n.x+n.width+1-s,v=n.y-2,w=n.y+n.height+1-s,t+s<=b&&b<u&&(v+1<=c&&c<=v+3||w+1<=c&&c<=w+3))return{paramRange:k,inBorder:!0};if(v+s<=c&&c<w&&(t+1<=b&&b<=t+3||u+1<=b&&b<=u+3))return{paramRange:k,inBorder:!0};if(u<=b&&b<u+s&&w<=c&&c<w+s)return{paramRange:k,inBottomRight:!0};if(t<=b&&b<t+s&&w<=c&&c<w+s)return{paramRange:k,inBottomLeft:!0};if(u<=b&&b<u+s&&v<=c&&c<v+s)return{paramRange:k,inTopRight:!0};if(t<=b&&b<t+s&&v<=c&&c<v+s)return{paramRange:k,inTopLeft:!0}}return l},_oa:function(){var a=this.kj;return a.Cw||a.Cva},ly:function(){var a,b,c,d,g,h,i,j,k,m,n,o,p,q=this,r=q.kj,s=r.Cw;if(s)if(a=r.Jl,b=r.Kl,c=r.parent,d=c&&1===c.options.referenceStyle,g=new f.SheetParserContext(r,d,e.pf(a,b)),h=new e.Parser,s.MH)for(k=s.u1(),m=0;m<k.length;m++){i=k[m];try{j=h.parse(g,i.text)}catch(a){j=l}j&&1===j.type&&(q.M2(j,a,b,!0,!0),s.D1(i.index,h.unparse(g,j)))}else{if(i=s.m1(),!i)return;try{j=h.parse(g,i.text)}catch(a){j=l}if(!j)return;1!==j.type||j.sf()?1===j.type&&(q.N2(j,a,b),s.D1(i.index,h.unparse(g,j))):(n=i.textOffset+i.text.lastIndexOf(":"),o=s.caret()<=n,o?(q.M2(j,a,b,!0,!1),p=h.unparse(g,j),s.D1(i.index,p),s.caret(i.textOffset+p.lastIndexOf(":"))):(q.M2(j,a,b,!1,!0),s.D1(i.index,h.unparse(g,j))))}},M2:function(a,b,c,d,e){var f,g,h=a.rowRelative,i=a.columnRelative;d&&(h&&i?(a.rowRelative=!1,a.columnRelative=!1,a.row+=b,a.column+=c):h?(a.columnRelative=!0,a.column-=c):i?(a.rowRelative=!0,a.columnRelative=!1,a.row-=b,a.column+=c):(a.columnRelative=!0,a.column-=c)),f=a.endRowRelative,g=a.endColumnRelative,e&&(f&&g?(a.endRowRelative=!1,a.endColumnRelative=!1,a.endRow+=b,a.endColumn+=c):f?(a.endColumnRelative=!0,a.endColumn-=c):g?(a.endRowRelative=!0,a.endColumnRelative=!1,a.endRow-=b,a.endColumn+=c):(a.endColumnRelative=!0,a.endColumn-=c))},N2:function(a,b,c){var d=a.rowRelative,e=a.columnRelative;d&&e?(a.rowRelative=!1,a.columnRelative=!1,a.row+=b,a.column+=c):d?(a.columnRelative=!0,a.column-=c):e?(a.rowRelative=!0,a.columnRelative=!1,a.row-=b,a.column+=c):(a.columnRelative=!0,a.column-=c)},Kka:function(){var a,b=this.kj,c=b.Cw;c&&(a=c.qo,a&&c.Cia(a)&&c.Jka())}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/formulaTextbox/formulatextbox.js"),g=c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),h=d.GC$.extend,i=e.Common.u,h(d.oJ.prototype,{uH:function(){var a,b,c=this,d=c.kj;d.Xq>0||(a=d.am(),b=c.bm(),c.Mx(a.x,a.y,a.width,a.height),c.Pw(b))}}),d.Worksheet.$n("formulatextboxrender",{paintAdornment:function(a){var b,c,d,e=this,f=a.ctx,g=a.clipRect,h=e.yl,i=e.am(),k=e.mm._oa();if(k)for(c=-1;c<=2;c++)for(d=-1;d<=2;d++)c===-1&&d===-1||(b=c===-1?i.gm(d):d===-1?i.fm(c):i.Ft(c,d),b&&0!==b.width&&0!==b.height&&j(h,f,c,d,g,k))}});function j(a,b,c,h,j,k){var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P=a.kj,Q=P.mm,R=P.sr(c,h),S=k&&k.l1(),T=S&&S.length;if(!(T<=0)&&(l=a.VI(c,h,j))){for(b.save(),b.rect(l.x,l.y,l.width,l.height),b.clip(),b.beginPath(),m=[],n=Q.isFormulaRangeHovering,o=Q.o8J,p=Q.FG,q=Q.K2,r=Q.HG,s=Q.L2,z=0;z<T;z++)if(t=S[z],y=t.sheetArea,("number"!=typeof y||y===R)&&(u=t.text,v=t.ranges&&t.ranges.length>0?t.ranges:[f.L0(P,u)])){if(A=g.G0.H0,A&&A.kj&&void 0!==u)if(i.Bb(u,"!")){if(B=i.Ib(u,"!"),P.name()!==B&&"'"+P.name()+"'"!==B)continue}else if(C=i.Ib(u,"["),D=P.tables,E=P.ODJ,F=E&&E.$VJ===d.SheetType.tableSheet&&E.name()===C,!(P.getCustomNames()[C]||D&&D.findByName(C)||F))continue;for(w=a.XI(c,h,v,l),G=0;G<w.length;G++)H=w[G],H&&H.width>0&&H.height>0&&(x=k.o1(z),k.t1(t)||t.isPivotClickCell?(n&&o.paramRange.index===z&&(b.beginPath(),b.lineWidth=2,b.strokeStyle=x,b.rect(H.x+1,H.y+1,H.width-3,H.height-3),b.stroke()),a.fJ(b,H,x)):n&&o.paramRange.index===z||p&&q.paramRange.index===z||r&&s.paramRange.index===z?(b.beginPath(),b.lineWidth=2,b.strokeStyle=x,b.rect(H.x+1,H.y+1,H.width-3,H.height-3),b.stroke()):(b.beginPath(),b.lineWidth=2,b.strokeStyle=x,b.rect(H.x,H.y,H.width-1,H.height-1),b.stroke()),k.n1(t)&&(I=e.Common.pc.ec(x),I.a=.1,b.beginPath(),b.fillStyle=e.Common.pc.bc(I),b.fillRect(H.x+1,H.y+1,H.width-3,H.height-3)),m.push({rect:H,color:x,allowDrag:t.allowDrag}))}if(m.length>0&&k.UQa)for(J=m.length,z=0;z<J;z++)H=m[z].rect,x=m[z].color,K=5,L=H.x-2,M=H.x+H.width+1-K,N=H.y-2,O=H.y+H.height+1-K,m[z].allowDrag!==!1&&(A=g.G0.H0,A&&A._text||(b.beginPath(),b.fillStyle=x,b.fillRect(L,N,K,K),b.fillRect(M,N,K,K),b.fillRect(L,O,K,K),b.fillRect(M,O,K,K)));b.beginPath(),b.restore()}}},"./dist/plugins/formulaTextbox/formulatextbox.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-calc"),e=c("SheetsCalc"),f=c("Common"),g=c("Core"),h=c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),i=null,j=void 0,k=Math.max,l=Math.min,m=g.GC$.extend,n=g.Ul.Nl,o=window,p=document,q=f.Common.u,r=g.Ul.nl,s=f.Common.j.Fa,t=g.Ul.Ml,u=t.msie&&parseInt(t.version,10)<10,v=q.Nb,b.CONST_FORMULATEXTBOX="formulatextbox",w="gcUIElement",x="input",y="\xa0",z=".gcFormulaTextBoxInternal",A=".gcFormulaTextBox",B=".gcFormulaTextBoxAcrossSheetInternal",C=".gcsj-func-ac-row",D="TextChanged",E="CaretChanged",F="AppendStarted",G="AppendEnded",H={left:37,right:39,up:38,down:40,tab:9,enter:13,pup:33,pdn:34,end:35,home:36,esc:27},I=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],J='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',K='url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+U1BKUyBBbm90aGVyLVNlbGVjdGluZzwvdGl0bGU+CiAgICA8ZyBpZD0iU1BKUy1Bbm90aGVyLVNlbGVjdGluZyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlN3aXRjaC1yb3cvY29sdW1uIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMS4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS04IiBmaWxsPSIjRDVENUQ1IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYiIGhlaWdodD0iMTMiPjwvcmVjdD4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMyIgeT0iNSIgd2lkdGg9IjEwIiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPHBhdGggZD0iTTMsNSBMMTMsNSBMMTMsOSBMMyw5IEwzLDUgWiBNNCw2IEw0LDggTDEyLDggTDEyLDYgTDQsNiBaIiBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTAsMCBMMTYsMCBMMTYsMTMgTDAsMTMgTDAsMCBaIE0xLDEgTDEsMTIgTDE1LDEyIEwxNSwxIEwxLDEgWiIgaWQ9IuefqeW9oiIgZmlsbD0iIzY2NjY2NiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOCI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjODFCRUZDIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTQiIGhlaWdodD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2LDAgTDE2LDQgTDAsNCBMMCwwIEwxNiwwIFogTTE1LDEgTDEsMSBMMSwzIEwxNSwzIEwxNSwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMzNjdGQzkiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi41ODc3NjcsIDYuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgZmlsbD0iI0ZBNzU0MSIgcG9pbnRzPSI1LjQxMjIzMjg1IDcgMi40MTIyMzI4NSAzLjk5NTM1Mjk1IDQuNDEyMjMyODUgMy45OTUzNTI5NSA0LjQxMjIzMjg1IDEgNi40MTIyMzI4NSAxIDYuNDEyMjMyODUgMy45OTUzNTI5NSA4LjQxNDAzOTk4IDMuOTk1MzUyOTUiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC44MjY2NDAyLDIuOTk1MzUyOTUgTDUuNDEyMDE5ODEsOC40MTUwOTU5NCBMMC4wMDA2NTkxMTExNjIsMi45OTUzNTI5NSBMMy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwzLjQxMjIzMjg1LDAgTDcuNDEyMjMyODUsMCBMNy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwxMC44MjY2NDAyLDIuOTk1MzUyOTUgWiBNNS40MTIyMzI4NSw3IEw4LjQxNDAzOTk4LDMuOTk1MzUyOTUgTDYuNDEyMjMyODUsMy45OTUzNTI5NSBMNi40MTIyMzI4NSwxIEw0LjQxMjIzMjg1LDEgTDQuNDEyMjMyODUsMy45OTUzNTI5NSBMMi40MTIyMzI4NSwzLjk5NTM1Mjk1IEw1LjQxMjIzMjg1LDcgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==")',
L="background",M="background-repeat",N="text-before",O="caret-before",P="\u200b",Q="=";function V(a,b){var c,d=0;for(c=0;c<a.length;c++)a[c]===b&&d++;return d}function W(){var a=[];return g.GC$.each(d.sR()._h,function(b,c){d.Functions.bi[b]&&(c.name=b,a.push(c))}),a}function X(a){var b=[],c;return g.GC$.each(a,function(a,d){c=d.description(),c&&(c.name=a,b.push(c))}),b}function Y(a,b){if(!a)return!1;var c=!1,d=!1;if(1===b.rowCount){if(a.hasHeadersRow()&&b.row===a.startRow())return!0;if(a.hasTotalsRow()&&b.row===a.endRow())return!0}else a.hasHeadersRow()&&b.row===a.startRow()&&(b.rowCount===a.dataRange().rowCount+1&&(c=!0),a.hasTotalsRow()&&b.rowCount===a.dataRange().rowCount+1+1&&(c=!0)),b.row===a.dataRange().row&&(b.rowCount===a.dataRange().rowCount&&(c=!0),a.hasTotalsRow()&&b.rowCount===a.dataRange().rowCount+1&&(c=!0));return b.col+b.colCount<=a.startColumn()+a.dataRange().colCount&&(d=!0),c&&d}function Z(a){return a.replace(/'/g,"''")}function $(a){var b=a.name();return e.jma(b.split(""),!1)?b:"'"+Z(b)+"'"}function _(a){var b=d.getMapping()&&d.getMapping().builtInFunctionsMapping,c=b&&b[a]&&b[a].alias||a;return q.Ob(c)}function aa(a,b,c){if(c){var d=RegExp(P,"g");return a.replace(d,"")===b.replace(d,"")}return a===b}function ba(a,b,c,d){var f,j,k,l,m,n,o,p,q,r,s,t,u;return void 0===d&&(d=g.SheetArea.viewport),b?(f=a.Cw,j=h.G0.H0,k=j&&j.kj||a,l=k.Jl,m=k.Kl,n=a.parent,o=n&&1===n.options.referenceStyle,p=15,(a.Cw&&a.Cw.Nfa||c)&&(p=0),b.row<0&&b.col<0&&(b=new g.Range(0,(-1),a.getRowCount(),(-1))),q=a.tables,r=q&&q.find(b.row,b.col),(j&&j.Nfa||c)&&(p=0),f&&!f.V4&&Y(r,b)?(j&&j._text&&j.kj!==a&&(l=m=-1),e.rangeToFormulaWithStructReference(a,b,l,m,p,o,r)):(s=a.ODJ,!r&&d===g.SheetArea.viewport&&s&&s.$VJ===g.SheetType.tableSheet?(r=s,ea(a,b.col,b.colCount,r)):(t=e.rangeToFormula(b,l,m,p,o),(j&&j._text||a.Cw&&a.Cw.V4&&a.Cw.ria)&&(u=$(a),t=u+"!"+t),t))):i}b.C2=ba;function ca(a){for(var b,c,d,e=[],f=0,g="";g!==i;)g=a.getColumnName(f),c=void 0,a.kj.ODJ&&(c=a.lOJ(f),c&&(b=f)),f++,g!==i&&e.push({name:g,description:"",isGroupColumn:c});return d={columns:e},s(b)||(d.groupInfo={rightGroupColumnIndex:b}),d}function da(a){return a&&"["===a[0]&&"]"===a[a.length-1]}function ea(a,b,c,d){var e,f,g,h,i=ca(d),j=i.columns,k=i.groupInfo,l=d.name();if(b===-1&&(b=0),c===-1&&(c=j.length),k){if(e=k.rightGroupColumnIndex,1===c&&b<=e)return"";if(c>1&&b<=e){if(b+c<=e+1)return"";c-=e-b+1,b=e+1}}return 1===c?l+"["+j[b].name+"]":c>1?(f=b+c-1,g=j[b].name,da(g)||(g="["+g+"]"),h=j[f].name,da(h)||(h="["+h+"]"),l+"["+g+":"+h+"]"):""}g.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",g.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",o.Yl.km.push(function(a,b){var c,d=h.G0;!b&&a.endEdit&&d&&(c=d.H0,c&&c.I0&&a.Cw&&(a.Cw&&a.Cw.destroy(),a.Cw=i,c.V4||c.$b()))});function fa(a,b,c,e,f,h){var i,j,k,l,m,n=a.parent,o=n&&n.options;(b&&o&&o.allowUserEditFormula&&o.enableFormulaTextbox||c)&&(a.Cw&&a.Cw.destroy(),a.Cw=new U(b,null,n),i=a.Cw.text(),j=a.getFormulaInformation(e,f,h),i[0]!==Q||j&&j.hasFormula||i===Q||o.allowInvalidFormula||(i="'"+i,a.Cw.text(i)),k=a.Cw,l=a.mm,m=a.yl,k.bind("AppendStarted",function(){k.close();var b=a.Px;1!==b&&(a.Px=1,a.Cu(b,1))}),k.bind("AppendEnded",function(){m.uH()}),k.bind(D,function(b,c){if(!a.Js){if(c&&c.type!==x){l.Qw(c);var d=a.getCellType(e,f,h);a.Wq(g.Events.EditChange,{sheet:a,sheetName:a.name(),row:e,col:f,editingText:d.getEditorValue(a.BF)})}m.uH(),a.Wq(g.Events.FormulaTextBoxTextChanged,{sheet:a,sheetName:a.name(),text:k.text(),sheetArea:h})}}),k.bind("CaretChanged",function(){m.uH(),a.Wq(g.Events.FormulaTextBoxCaretChanged,{sheet:a,sheetName:a.name(),caret:k.caret()})}),k.add(W()),k.add(X(d.Functions.ci)),k.add(X(a.Su).concat(X(n.Su))),m.uH())}b.J0=fa;function ga(a){a.Cw&&(a.Cw.destroy(),a.Cw=i,a.yl.uH());var b=a.parent&&a.parent.CF;p.activeElement===(b&&b.qo)&&a.mm.Qq()}b.K0=ga;function ha(a,b){var c,d,f,g;if(!b)return i;c=h.G0.H0,d=c&&c.kj||a,f=d.Jl,g=d.Kl;try{return e.formulaToRange(a,b,f,g)}catch(a){}return i}b.L0=ha,m(g.DC.prototype,{bE:function(a){return!(a&&a.Cw&&a.Cw.M0())},pWJ:function(a){return!a||!a.Cw||!!a.Cw.qWJ}}),g.Worksheet.$n(b.CONST_FORMULATEXTBOX,{startEdit:function(a){fa(this,a.element,j,a.row,a.col,a.sheetArea)},endEdit:function(){ga(this)},preProcessKeyDown:function(a){var b,c=this.Cw;return c&&c.BH(a.e)?void(a.r=!0):(b=this.parent&&this.parent.CF,void(b&&b.BH(a.e,a.c)&&(a.r=!0)))}}),R=g.DC.prototype,S=R.dE,g.DC.$n(b.CONST_FORMULATEXTBOX,{preProcessMouseDbClick:function(a){var b=g.UCJ(this.OC),c=b?b.Cw:void 0,d=c&&c.M0(),e=h.G0.H0;d?a.r=!1:e&&e.I0&&e.$b()}}),R.dE=function(){var a=g.UCJ(this.OC),b=a&&a.Cw,c=h.G0.H0,d=c&&c._text;return S.call(this)&&!d&&!b},T=1;function ia(a,b){var c,d,e,f,h,i,j,k,l,m,o=g.GC$(a);return o.attr("contenteditable","false"),c=n("table"),g.GC$(c).css("border-spacing","0"),g.GC$(c).css("width","100%"),o.append(c),d=n("tbody"),c.appendChild(d),e=document.createElement("tr"),d.appendChild(e),f=document.createElement("td"),g.GC$(f).css("padding-right","0px"),e.appendChild(f),h=document.createElement("td"),g.GC$(h).css("width","23px"),g.GC$(h).css("padding-right","0px"),e.appendChild(h),i=o.width()-g.GC$(h).width(),j=n("div"),k=n("div"),g.GC$(k).width(i),g.GC$(k).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),k.appendChild(j),f.appendChild(k),l=n("div"),h.appendChild(l),g.GC$(j).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),g.GC$(j).width(i),g.GC$(j).attr("contenteditable","true"),g.GC$(j).attr("spellcheck","false"),m=g.GC$(l),m.css({display:"block",float:"right",width:"23px",height:"23px",background:J,"background-repeat":"no-repeat"}),m.bind("click",function(){b.D5?(b.OC.Wq("RangeSelectEnding",b),b.endSelectMode()):b.startSelectMode()}),{contentDiv:j,button:l}}function ja(a){var b,c=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE","MAP","REDUCE","SCAN","MAKEARRAY","BYROW","BYCOL","TEXTSPLIT","HSTACK","VSTACK","TOROW","TOCOL","WRAPROWS","WRAPCOLS","TAKE","DROP","EXPAND","CHOOSEROWS","CHOOSECOLS"];for(b=0;b<c.length;b++)if(a===c[b])return!0}U=function(){function a(a,c,d){var e,f,i,j,k=this,l=a;if(k.V4=!1,k.Nfa=!1,k.qWJ=!0,k.ria=!0,k.Ac=[],k.Bc=[],k.yLb=[],k.d$J=!1,c&&c.rangeSelectMode&&(c.absoluteReference===!0&&(k.Nfa=!0),c.needSheetName===!1&&(k.ria=!1),c.acrossSheet===!1&&(k.qWJ=!1),k.qp=c.selectionUnit,k.V4=!0,k.D5=!1,k.E5=!1,k.cga=a,e=ia(a,k),l=e.contentDiv,k.sia=e.button,k.tia=a,k.C5=T,T++),k.UQa=!0,k.ad(d&&d.getHost()||p.body),l&&k.N0(l),d&&(k.O0=!0,k.P0(d),k.OC.Gu(g.Events.FormulaTextboxActiveSheetChanging+B,h.G0.U8J),k.OC.Fu(g.Events.FormulaTextboxActiveSheetChanging+B,h.G0.U8J),k.OC.Gu(g.Events.FormulaTextboxActiveSheetChanged+B,h.G0.V8J),k.OC.Fu(g.Events.FormulaTextboxActiveSheetChanged+B,h.G0.V8J)),f=k.text(),k.S0=k.T0(f),i=k.Cia(l)){k.V0(k.S0);try{j=o.getSelection(),j.selectAllChildren(l),j.rangeCount>0&&j.collapseToEnd()}catch(a){}g.GC$(k.qo).data(N,f)}g.GC$(a).data(b.CONST_FORMULATEXTBOX,k)}return a.prototype.j5=function(a){var b,c,d,e,f,g,i=this;i.O1(),i.UF(),i.E5=!0,b=h.W4(i.OC.qo),c=i.a1(),c&&(c.suspendPaint(),fa(c,b,!0,c.Jl,c.Kl,3),d=c.Cw,d.V4=!0,d.C5=i.C5,d.Nfa=i.Nfa,d.ria=i.ria,d.qp=i.qp,d.qWJ=i.qWJ,a&&(i.text(a),i.caret(a.length)),e=i.text(),f=i.caret(),f<=0&&(f=e.length),i.focus(),i.caret(f),i.MH=!0,i.W0=1,g=e.lastIndexOf(",",f),g!==-1&&(i.W0=g+1),e||(i.text("="),e="=",i.caret(1),f=1),"="!==e[0]&&(e="="+e,f++),d.text(e),d.caret(f),d.MH=i.MH,d.W0=i.W0,c.resumePaint())},a.prototype.startSelectMode=function(a){var b,c=a;c&&0!==c.indexOf("=")&&(c="="+c),b=this,b.V4=!0,b.D5=!0,g.GC$(b.sia).css([L,M],[K,"no-repeat"]),b.j5(c)},a.prototype.endSelectMode=function(){this.D5=!1,this.H5(),g.GC$(this.sia).css([L,M],[J,"no-repeat"])},a.prototype.H5=function(){var a=this.a1();a&&(a.gv(!0,j,!0),a.repaint())},a.prototype.vIb=function(a){this.yLb=[a]},a.prototype.zLb=function(){return this.yLb},a.prototype.destroy=function(){var a=this;a.D5&&a.H5(),a.yLb=i,a.MH=!1,a.W0=-1,a.X0(),a.Y0(),a.cXJ(),g.GC$(a.Z0).remove(),g.GC$(a.$0).remove(),g.GC$(a._0).remove()},a.prototype.bind=function(a,b,c){var d=this.qo;d&&a&&(a=a.split(/\s+/).join(A+" "),g.GC$(d).bind(a+A,b,c))},a.prototype.unbind=function(a,b){var c=this.qo;c&&a&&(a=a.split(/\s+/).join(A+" "),g.GC$(c).unbind(a+A,b))},a.prototype.unbindAll=function(){var a=this.qo;a&&g.GC$(a).unbind(A)},a.prototype.caret=function(a){var b,c,d=this,e=d.qo;if(e)return b=p.activeElement===e,c=g.GC$(e),0===arguments.length?b?d.b1(e).end:c.data(O):void(a!==d.caret()&&(b?(d.c1(e,a),c.data(O,d.b1(e).end)):c.data(O,a),d.Wq(E,{})))},a.prototype.b1=function(a){var b,c,d,e=this,f=-1,g=-1;return e.d1(a)?(f=a.selectionStart,g=a.selectionEnd):e.Cia(a)&&(b=o.getSelection(),b.rangeCount>0&&(c=b.getRangeAt(0),d=c.cloneRange(),d.selectNodeContents(a),d.setEnd(c.endContainer,c.endOffset),g=(""+d).length,d=c.cloneRange(),d.selectNodeContents(a),d.setEnd(c.startContainer,c.startOffset),f=(""+d).length,d.detach())),{start:f,end:g}},a.prototype.c1=function(a,b){var c,d,e,f,g=this;g.d1(a)?a.setSelectionRange(b,b):g.Cia(a)&&(e=this.e1(a,b),e&&(c=o.getSelection(),d=p.createRange(),f=e.node,f&&1===f.childNodes.length?d.setStart(f.firstChild,e.offset):f.lastChild&&f.lastChild.length&&d.setStart(f.lastChild,f.lastChild.length),d.collapse(!0),c.removeAllRanges(),c.addRange(d),this.V4&&(a.parentElement.scrollTop=a.parentElement.scrollHeight)))},a.prototype.text=function(a){var b,c,d,e,f,i,j,k,l=this,m=l.qo,n=l.a1();if(!m)return"";if(!n||n.Js)return m.innerHTML="","";if(b=l.d1(m),c=l.Cia(m),0===arguments.length){if(d="",b)d=m.value;else if(c){if(e=m.getElementsByClassName("gcsj-func-gray-formula"),e.length>0)return"";d=u?g.Ul.Woa(m):m.innerText,d=d.replace(/\r\n?/g,"\n"),d.indexOf(y)>=0&&(d=g.Ul.Ika(d,y," "))}return d}null!==a&&void 0!==a||(a=""),a!==l.text()&&(f=l.ALb(a),f?l.S0=l.T0(f):l.S0=l.T0(a),b?m.value=a:c&&(i=l.BLb(l.S0,a),l.V0(i),l.caret(a.length)),j={},k=h.G0.H0,k&&k._text&&(j={sheet:k.kj,editor:k.I0&&k.I0.firstChild.firstChild,canvasOffset:k.f1}),l.Wq(D,j)),l.CLb&&l.DLb()},a.prototype.kOJ=function(){var a=this;g.GC$(a.qo).data(N,a.text())},a.prototype.autoComplete=function(a){return 0===arguments.length?this.g1:void(this.g1=a)},a.prototype.showHelp=function(a){return 0===arguments.length?this.h1:void(this.h1=a)},a.prototype.add=function(a){var b,c;if(a)if(g.GC$.isArray(a))for(b=a.length,c=0;c<b;c++)this.Sb(a[c]);else this.Sb(a)},a.prototype.Sb=function(a){var b,c,d,e,f=a&&v(_(a.name));if(f){for(b=this.i1,c=b.length,d=0;d<c;d++){if(e=v(b[d].name),e===f)return;if(e>f)break}b.splice(d,0,a)}},a.prototype.remove=function(a){var b,c,d;if(a)for(a=v(a),b=this.i1,c=b.length,d=0;d<c;d++)if(v(b[d].name)===a){b.splice(d,1);break}},a.prototype.workbook=function(a){var b=this;return 0===arguments.length?b.OC:void(a===i?b.V4&&b.H5():(b.P0(a),b.j1()))},a.prototype.P0=function(a){var b,c;a&&(b=this,b.OC&&b.Y0(),c=b.qo,c&&(b.OC=a))},a.prototype.l1=function(){var a,b,c,d,e,f=[],g=this.S0,h=g&&g.length,i=0,j=0;if(h>0)for(c=0;c<h;c++)a=g[c],b=a.text,11===a.type&&(d={textOffset:i,text:b,ranges:a.ranges,index:j,allowDrag:a.allowDrag},"number"==typeof a.sheetArea&&(d.sheetArea=a.sheetArea),f.push(d),j++),i+=b.length;return e=this.GNc,e&&f.push({ranges:[e],index:j,allowDrag:!1,isPivotClickCell:!0}),f},a.prototype.m1=function(){var a,b,c,d,e,f=this.qo,g=this.l1();if(f&&g&&g.length>0)for(a=this.caret(),b=g.length,c=void 0,d=void 0,e=0;e<b;e++){if(c=g[e],d=c.textOffset,d<=a&&a<=d+c.text.length)return c;if(d>=a)break}return i},a.prototype.n1=function(a){var b,c,d;return!!a&&(b=this.caret(),c=a.text,d=a.textOffset,d<=b&&b<=d+c.length)},a.prototype.o1=function(a){var b,c,d,e,f,g,h,i=this.l1(),j=i.length;if(a<0||j<=a)return"";for(b=[],d=0,e=0;e<j;e++){for(c=i[e],f=!1,g=0;g<b.length;g++)if(c.text&&b[g].text.replace(/\s+/g,"").toUpperCase()===c.text.replace(/\s+/g,"").toUpperCase()){f=!0;break}if(f){if(a===e){d=g;break}}else if(b.push(c),a===e){d=b.length-1;break}}return h=I,h[d%h.length]},a.prototype.M0=function(){var a,b,c;return!!this.MH||(!!this.V4||(!!g.AVJ(this.text())||(a=this.s1(this.caret()),!!a&&(b=a.type,c=a.text,1===b||8===b||7===b&&"%"!==c||5===b||9===b||15===b))))},a.prototype.t1=function(a){if(!a||!this.MH)return!1;var b=this.W0,c=this.caret(),d=a.textOffset;return b<=d&&d<c},a.prototype.u1=function(){var a,b,c=[],d=this.l1(),e=d.length;if(e>0)for(b=0;b<e;b++)a=d[b],this.t1(a)&&c.push(a);return c},a.prototype.v1=function(a,b,c,d,e){var i,j,k,l,m,n,o,p,q,r,s,t,u;if(void 0===e&&(e=g.SheetArea.viewport),i=this,j=i.qo,a&&j){if(!i.MH){if(!i.M0())return;b=!1,i.MH=!0,i.W0=i.caret(),i.Wq(F,{})}k=i.W0,l=i.text(),m=i.caret(),l||(l="=",k=i.W0=1,m=1),n=m,c&&(b=!1,l=l.substr(0,k)+(m<0?"":l.substr(m)),i.S0=i.T0(l),m=k,n=m),o=i.s1(m),b?(p=l.substr(0,m),p=p.substr(0,p.length-o.text.length),p.length>=k&&(o.text=a,n=p.length+a.length)):(q=i.S0,r=f.Common.k.Cb(q,o),s=i.V4&&q.length>1&&r===q.length-1&&11===o.type,d?(a=m>k||s?l+this.w1()+a:l.slice(0,m)+a+l.slice(m),i.S0=i.T0(a)):m>k||s?(q.splice(r+1,0,{text:this.w1(),type:8}),q.splice(r+2,0,{text:a,type:11,sheetArea:e}),a=","+a):q.splice(r+1,0,{text:a,type:11,sheetArea:e}),n=m+a.length),i.z1(),t={},u=h.G0.H0,u&&u._text&&(t={sheet:u.kj,editor:u.I0&&u.I0.firstChild.firstChild,canvasOffset:u.f1}),i.Wq(D,t),i.caret(n)}},a.prototype.NH=function(){var a=this;a.MH&&(a.MH=!1,a.W0=-1,a.Wq(G,{}))},a.prototype.B1=function(){this.MH=!0,this.W0=this.caret()},a.prototype.C1=function(a){return void 0!==a&&(this.W0=a),this.W0},a.prototype.D1=function(a,b,c){var d,e,f,g,h,i,j,k=this,l=k.qo;if(l&&!(a<0)&&b){for(d="",e=!1,f=k.S0,g=f&&f.length,i=0,j=0;j<g;j++){if(h=f[j],11===h.type&&i++===a){f[j]={text:b,type:11,sheetArea:h.sheetArea},e=!0;break}d+=h.text}e&&(k.z1(),k.Wq(D,{}),c?k.caret(k.text().length):k.caret(d.length+b.length))}},a.prototype.j1=function(){var a,b,c=this;c.OC&&(a=c.qo,c.OC&&a&&(a.setAttribute(w,"gcAttachedFormulaTextBox"),c.V4||(c.OC.CF=c),c.OC.Fu(g.Events.FormulaTextboxEditStarted+z,c,c.E1),c.OC.Fu(g.Events.FormulaTextboxEnterCell+z,c,c.F1),c.OC.Fu(g.Events.FormulaTextboxEditEnded+z,c,c.G1),c.OC.Fu(g.Events.FormulaTextboxActiveSheetChanged+z,c,c.H1),c.OC.Fu(g.Events.FormulaTextboxRangeChanged+z,c,c.I1),c.OC.Fu(g.Events.FormulaTextBoxTextChanged+z,c,c.J1),c.OC.Fu(g.Events.FormulaTextBoxCaretChanged+z,c,c.K1),c.OC.Fu(g.Events.ValueChanged+z,c,c.ELb),b=g.UCJ(c.OC),b&&!c.V4&&c.text(c.L1(b,b.Jl,b.Kl)),c.Fu(D,c,c.M1),c.Fu(E,c,c.N1)))},a.prototype.refresh=function(a){var b,c=this.OC,d=this;c&&(b=g.UCJ(c),b&&!d.V4&&(d.OG=!!a||d.OG,d.text(d.L1(b,b.Jl,b.Kl)),d.OG=!1))},a.prototype.Y0=function(){var a=this,b=a.OC;!a.O0&&b&&(a.V4||(b.CF=null,b.Gu(g.Events.FormulaTextboxEditStarted+z,a.E1),b.Gu(g.Events.FormulaTextboxEnterCell+z,a.F1),b.Gu(g.Events.FormulaTextboxEditEnded+z,a.G1),b.Gu(g.Events.FormulaTextboxActiveSheetChanged+z,a.H1),b.Gu(g.Events.FormulaTextboxRangeChanged+z,a.I1),b.Gu(g.Events.FormulaTextBoxTextChanged+z,a.J1),b.Gu(g.Events.FormulaTextBoxCaretChanged+z,a.K1),b.Gu(g.Events.ValueChanged+z,a.ELb),a.Gu(D,a.M1),a.Gu(E,a.N1)),a.text("")),a.OC=null},a.prototype.O1=function(){var a,b,c=this;c.OG||(c.OG=!0,a=this.OC,b=a&&g.UCJ(a),b&&!b.isEditing()?(c.V4||b.EF(null,b.Jl,b.Kl,null,null,!1,null),c.Q1=!0):c.Q1=!1,c.OG=!1,c.R1||c.S1())},a.prototype.FLb=function(){var a=this,b=a.qo,c=a.GLb;b.insertBefore(c,b.firstChild),c.innerText=a.CLb},a.prototype.HLb=function(a,b){if(a){var c=this.ILb;c!==b&&(this.ILb=b,a.style.display=b?"":"none")}},a.prototype.DLb=function(){var a,b=this,c=b.qo,d=b.Cia(c);d?(a=b.GLb,a||(a=b.GLb=n("span"),a.className="gcsj-func-gray-formula"),b.HLb(a,!0),b.FLb()):c.placeholder=b.CLb},a.prototype.JLb=function(){var a,b,c=this;c.CLb&&(c.CLb="",a=c.qo,b=c.Cia(a),b?c.HLb(c.GLb,!1):a&&(a.placeholder=""))},a.prototype.UF=function(){var a,b,c,d,e,f,h=this,i=h.OC,j=i&&g.UCJ(i);j&&(a=j.Cw,h.Q1&&a&&(b=a.text(),c=h.text(),aa(c,b,!0)||(d=h.caret(),e=j.getFormulaInformation(j.getActiveRowIndex(),j.getActiveColumnIndex(),3),h.text(b),e.isArrayFormula&&(d>=c.length&&(d-=1),d=k(0,d-1)),h.caret(d))),(h.Q1&&a||h.V4)&&(f=j.Px,2!==f&&(j.Px=2,j.Cu(f,2))))},a.prototype.L1=function(a,b,c){var d,e,f,h,i,j="";if(a){if(d=a.parent,e=d&&d.options,f=a.getFormulaInformation(b,c,3),f&&f.hasFormula){if(j="="+f.formulaWithCulture,f.isDynamicArray)return this.CLb=j,"";this.CLb="",f.isArrayFormula&&(j="{"+j+"}")}else h=a.getActualStyle(b,c),i=a.getValue(b,c),j="string"==typeof i&&(h.quotePrefix||i.length>0&&"="===i[0]&&e&&e.allowUserEditFormula&&!e.allowInvalidFormula)?"'"+i:g.Ul.Il(h,i,a,{sheet:a,row:b,col:c,sheetArea:3})||"";this.JLb()}return j},a.prototype.H1=function(a,b){var c,d,e=a.data;e.OG||(c=b.newSheet,e.V4||(e.OG=!0,e.close(),b&&(d=c,d&&e.text(e.L1(d,d.Jl,d.Kl))),e.OG=!1))},a.prototype.E1=function(a,b){var c,d,e,f=a.data;f.OG||(c=f.OC,d=c&&g.UCJ(c),e=d&&d.Cw,e&&f.V4===e.V4&&f.C5===e.C5&&b.sheetArea!==g.SheetArea.colHeader&&b.sheetArea!==g.SheetArea.rowHeader&&(f.JLb(),f.OG=!0,f.text(e.text()),f.OG=!1))},a.prototype.F1=function(a,b){var c=a.data;c.V4||c.OG||(c.OG=!0,b&&c.text(c.L1(b.sheet,b.row,b.col)),c.OG=!1)},a.prototype.I1=function(a,b){var c,d,e,f,h,i=a.data;i.OG||i.V4||(i.OG=!0,b&&(c=b.sheet,d=b.row,e=b.col,f=b.rowCount,h=b.colCount,new g.Range(d,e,f,h).contains(c.Jl,c.Kl)&&i.text(i.L1(c,c.Jl,c.Kl))),i.OG=!1)},a.prototype.G1=function(a,b){var c,d=a.data;return d.V4&&d.D5&&d.E5?void(b.ignore=!0):void(d.OG||b.sheetArea!==g.SheetArea.colHeader&&b.sheetArea!==g.SheetArea.rowHeader&&(d.OG=!0,d.close(),c=h.G0.H0,c&&c.VF(b.sheet),b&&b.sheet.Cw&&!b.sheet.Cw.V4&&!d.V4&&d.text(d.L1(b.sheet,b.row,b.col)),d.OG=!1))},a.prototype.ELb=function(b,c){var d=c.sheet,e=d&&d.parent&&d.parent.CF;e&&e.e2()===c.row&&e.f2()===c.col&&e.a1()===d&&b.data instanceof a&&(c.text=d.getText(c.row,c.col),b.data.J1(b,c))},a.prototype.J1=function(a,b){var c,d=a.data;d.OG||(!b.sheet.Cw||d.V4===b.sheet.Cw.V4&&d.C5===b.sheet.Cw.C5)&&b.sheetArea!==g.SheetArea.colHeader&&b.sheetArea!==g.SheetArea.rowHeader&&(d.OG=!0,b&&(c=d.caret(),d.text(b.text),d.caret(c)),d.OG=!1)},a.prototype.K1=function(a,b){var c=a.data;c.OG||(!b.sheet.Cw||c.V4===b.sheet.Cw.V4&&c.C5===b.sheet.Cw.C5)&&(c.OG=!0,b&&c.caret(b.caret),c.OG=!1)},a.prototype.M1=function(a){var b,c,d,e,f,h,i,j,k=a.data;if(!k.OG&&(b=k.OC,c=b&&g.UCJ(b))){if(c.isEditing()||(k.O1(),k.focus()),k.OG=!0,d=c.Jl,e=c.Kl,f=c.Cw,h=c.getCellType(d,e),f){if(k.V4!==f.V4||k.C5!==f.C5)return;i=f.caret(),f.text(k.text()),f.caret(i)}else j={sheet:c,row:d,col:e,sheetArea:3},h.setEditorValue(c.BF,k.text(),j);k.OG=!1}},a.prototype.N1=function(a){var b,c,d,e=a.data;e.OG||(b=e.OC,c=b&&g.UCJ(b),c&&c.isEditing()&&(d=c.Cw,(!d||e.V4===d.V4&&e.C5===d.C5)&&(e.OG=!0,d&&(d.caret(e.caret()),e.S1()),e.OG=!1)))},a.prototype.ad=function(a){var b,c,d,e=this;e.T1=!1,e.U1=!1,e.MH=!1,e.W0=-1,e.i1=[],e.g1=!0,e.h1=!0,e.V1=!0,b=n("div"),b.className="gcsj-func-ac-popup",b.style.display="none",b.setAttribute(w,"gcFuncACPopup"),a.insertBefore(b,i),e.Z0=b,e.R1=!1,c=n("div"),c.className="gcsj-func-help-popup",c.style.display="none",c.setAttribute(w,"gcFuncHelpPopup"),a.insertBefore(c,i),e.$0=c,e.W1=!1,g.GC$(b).bind("mouseover",function(){e.V1=!1}).bind("mouseout",function(){e.V1=!0}),g.GC$(c).bind("mouseover",function(){e.V1=!1}).bind("mouseout",function(){e.V1=!0}),g.GC$(b).bind("scroll",function(){e.X1&&clearTimeout(e.X1),e.X1=o.setTimeout(function(){e.qo&&e.qo.focus()},100)}),d=n("div"),d.style.display="none",d.setAttribute(w,"gcFuncHelpDiv"),a.insertBefore(d,i),e._0=d,e.OC=null,e.OG=!1,e.Q1=!1,e.O0=!1},a.prototype.N0=function(a){var b,c,d;a&&(b=this,c=b.Cia(a),(b.d1(a)||c)&&(d=g.GC$(a),b.qo&&b.X0(),b.qo=a,t&&(t.msie||t.chrome)?c||u||t.chrome?(b.Fu("focus",function(){d.data(N,b.text())}),b.Fu("click",function(){d.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(a){b.Fu(a,function(){b.Y1()})})):b.Fu(x,function(){b.Z1()}):b.Fu(x,function(){if(c){var a=b.qo.lastChild;t.chrome&&a&&"BR"===a.tagName&&b.qo.removeChild(a)}b.Z1()}),b.Fu("keydown",function(a){var d,e,f,h,i,j=a.ctrlKey,k=a.shiftKey,l=a.altKey,m=a.metaKey,n=j||k||l||m,o=a.keyCode;!n&&b.R1&&(o===H.down?(b._1(1),r(a)):o===H.up?(b._1(-1),r(a)):o===H.tab&&(b.a2(),r(a))),o===H.esc&&b.close(),b.b2(a),d=g.UCJ(b.OC),e=d&&d.mm.LH(a),b.V4&&e&&(f=d.Cw,f&&f.MH&&f.NH()),c&&(e?(8===o?la(a)&&g.uHb.processBackspaceAndLeftArrowKeyEvent(a,!0):46===o&&la(a)&&g.uHb.processDeleteAndRightArrowKeyEvent(a,!0),b.Jka()):13===o&&(j||l)?(la(a)&&ka(),b.Jka(!0)):37===o?la(a)&&g.uHb.processBackspaceAndLeftArrowKeyEvent(a,!1):39===o&&la(a)&&g.uHb.processDeleteAndRightArrowKeyEvent(a,!1),c&&j&&(90===o||89===o)&&r(a)),h=b.text(),g.Ul.sl()&&c&&m&&(i=void 0,90===o&&(k?(i=b.Bc.pop(),i&&(b.text(i),b.Ac.push(h))):(i=b.Ac.pop()||"",b.text(i),b.Bc.push(h)),a.preventDefault(),a.stopPropagation()))}),b.Fu("keyup",function(a){var d,e,f,g;b.b2(a),d=b.text(),c&&(e=void 0,f=a.keyCode,g=a.ctrlKey,g&&90===f?(e=b.Ac.pop()||"",b.text(e),b.Bc.push(d)):g&&89===f&&(e=b.Bc.pop(),e&&(b.text(e),b.Ac.push(d))))}),b.Fu("focus",function(a){var c=t&&t.mozilla;c&&!b.qo.innerText&&(b.qo.innerText=""),b.b2(a),b.V4&&b.D5&&(b.E5=!0,b.j5())}),b.Fu("blur",function(){b.V1&&b.close(),b.V4&&(b.H5(),b.E5=!1)}),b.Fu("mousedown",function(){b.E5=!0,b.ILb&&(b.JLb(),b.KLb=!0),b.O1()}),b.Fu("mouseup",function(){if(b.KLb){b.KLb=!1;var a=b.qo,c=o.getSelection();a!==c.anchorNode&&c.selectAllChildren(a)}b.UF()}),b.Fu("click",function(a){var c,d,e;b.MH&&b.NH(),c=b.OC,d=c&&g.UCJ(c),e=d&&d.Cw,e&&e.MH&&!e.V4&&e.NH(),b.b2(a)}),b.Fu("compositionstart",function(){b.T1=!0}),b.Fu("compositionend",function(){b.T1=!1,(t.edge||t.chrome||t.msie)&&b.Y1()})))},a.prototype.X0=function(){var a,c=this,d=c.qo;d&&(a=g.GC$(d),a.removeData(N),a.removeData(O),a.removeAttr(w),a.data(b.CONST_FORMULATEXTBOX)&&a.data(b.CONST_FORMULATEXTBOX,i),c.nu(),c.unbindAll(),c.V4&&(g.GC$(c.cga).empty(),c.cga=i),c.qo=i)},a.prototype.Y1=function(){var a=this,b=g.GC$(a.qo),c=a.text();b.data(N)!==c&&(a.T1||b.data(N,c),a.Z1())},a.prototype.b2=function(a){if(t&&t.msie){var b=function(a,b){return function(){a.d2(a,b)}};setTimeout(b(this,a),10)}else this.d2(this,a)},a.prototype.d2=function(a,b){var c,d,e,f,h,i=b.keyCode,j=i===H.left||i===H.right||i===H.home||i===H.end||i===H.pdn||i===H.pup||i===H.tab||i===H.enter;if(a.g1||(j=j||i===H.up||i===H.down),c=void 0!==b.button,j||c){if(d=a.qo,e=g.GC$(d),f=a.b1(d),f.start!==f.end)return;h=f.end,e.data(O)!==h&&(e.data(O,h),a.Wq(E,{}),a.S1())}},a.prototype.e2=function(){var a,b,c=this.a1();return c?(a=c.Jl,b=c._ZJ,b&&(a=b.row),a):j},a.prototype.f2=function(){var a,b,c=this.a1();return c?(a=c.Jl,b=c._ZJ,b&&(a=b.col),a):j},a.prototype.F$J=function(){var a,b,c=this.a1();return c?(a=g.SheetArea.viewport,b=c._ZJ,b&&(a=b.sheetArea),a):j},a.prototype.a1=function(){if(this.OC)return g.UCJ(this.OC)},a.prototype.parseInternal=function(a,b,c,f,h){var i,k,l,m;return void 0===h&&(h=g.SheetArea.viewport),i=this,k=[],g.bW(a)&&V(a,'"')%2!==1?(l=new d.Parser,m=e.qzb(l,a,b,c,f,!0,j,j,h),k=i.i2(m,a)):(k.push({text:a,type:17}),k)},a.prototype.T0=function(a){return this.parseInternal(a,this.a1(),this.e2(),this.f2(),this.F$J())},a.prototype.Z1=function(){var a,b,c,d=this,e=d.text();return"\n"!==e&&e.indexOf("\n")>=0?void d.Wq(D,{type:x}):(a=d.qo,b=g.GC$(a),d.U1=!0,d.S0=d.T0(e),d.Cia(a)?d.T1||("\n"===e?(b.empty(),d.Wq(D,{type:x})):(c=d.caret(),d.V0(d.S0),d.Wq(D,{type:x}),d.caret(c))):d.Wq(D,{type:x}),c=d.caret(),b.data(O)!==c&&(b.data(O,c),d.Wq(E,{})),d.c2(),void(d.R1||d.S1()))},a.prototype.j2=function(){return f.Common.CultureManager.q4().NumberFormat},a.prototype.h2=function(){var a=this.j2();return a&&a.arrayGroupSeperator||";"},a.prototype.l2=function(){var a=this.j2();return a&&a.arrayListSeparator||","},a.prototype.w1=function(){var a=this.j2();return a&&a.listSeparator||","},a.prototype.g2=function(){var a=this.j2();return a&&a.numberDecimalSeparator||"."},a.prototype.i2=function(a,b){var c,e,g,h,i,j,k=[],l=[],m=b&&"="!==b[0],n=this.h2(),o=this.l2(),p=!1;for(c=0;c<a.length;c++)if(!(c>0&&c<a.length-1&&";"===a[c-1].text&&","===a[c].text&&"ARRAYROW"===a[c+1].text))if(e=a[c],g=this.m2(e,l),h=e.text,2===g)k.push({text:h,type:g});else if(p&&8===g&&","===h)k.push({text:o,type:9});else if(p&&8===g&&";"===h)k.push({text:n,type:10});else if(8===g)k.push({text:h,type:g});else if(3===g)"ARRAY"===h&&(p=!0),k.push({text:"{",type:3});else if(4===g)"ARRAY"===h||"}"===h?(p=!1,k.push({text:"}",type:4})):k.push({text:h,type:4});else if(6===g)k.push({text:")",type:g});else if(13===g)k.push({text:f.Common.o.nb(h),type:g,ranges:e.ranges,allowDrag:e.canDrag});else{if(1===g&&m)continue;null!==g&&(11===g&&a[c+1]&&"#"===a[c+1].text&&e.ranges&&e.ranges.length>0&&(i=new d.CalcReference(this.a1().ft,e.ranges).getSpillRef(),i&&i.yf&&(c++,e.ranges=i.yf,h+="#")),j={text:h,type:g,ranges:e.ranges,allowDrag:e.canDrag},11===g&&(j.sheetArea=e.sheetArea),k.push(j))}return k},a.prototype.m2=function(a,b){var c,d=a.type,e=a.subType,f=a.text,g=a.value;if(1===d){if(1===e)return"ARRAY"===f||"ARRAYROW"===f?(b.push(3),3):(b.push(5),"@"===g||"("===g.trim()?5:2);if(2===e){if(")"===g.trim())return 6;if(b.length>0){if(c=b[b.length-1],3===c)return b.pop(),4;if(5===c)return b.pop(),6}}if("="===g.trim())return 1}else if(3===d){if(0===e)return 8}else{if(5===d||6===d||4===d)return 7;if(0===d)return 7===e||0===e||12===e?11:5===e?12:4===e?13:3===e?14:6===e?16:14;if(7===d)return 15;if(8===d)return 17}return 17},a.prototype.z1=function(){var a,b=this,c=b.qo,d=b.S0,e="",f=d&&d.length;for(a=0;a<f;a++)e+=d[a].text;b.d1(c)?c.value=e:b.Cia(c)&&b.V0(d)},a.prototype.d1=function(a){var b=a&&a.tagName;return"TEXTAREA"===b||"INPUT"===b},a.prototype.Cia=function(a){return a&&"DIV"===a.tagName&&"true"===a.contentEditable},a.prototype.Dia=function(a){return"gcEditingInput"===g.GC$(a).attr(w)},a.prototype.Fu=function(a,b,c){var d=this.qo;d&&a&&(a=a.split(/\s+/).join(z+" "),g.GC$(d).bind(a+z,b,c))},a.prototype.Gu=function(a,b){var c=this.qo;c&&a&&(a=a.split(/\s+/).join(z+" "),g.GC$(c).unbind(a+z,b))},a.prototype.nu=function(){var a=this.qo;a&&g.GC$(a).unbind(z)},a.prototype.Wq=function(a,b){var c=this.qo;c&&g.GC$(c).trigger(a,b)},a.prototype.s1=function(a){var b,c,d,e,f;if(a<=0)return i;if(b=this.S0,c=b&&b.length,c>0)for(d=0,e=void 0,f=0;f<c;f++)if(e=b[f],d+=e.text.length,d>=a)return e;return i},a.prototype.n2=function(){var a,b,c,d,e,f=this.OC;if(f&&(a=g.UCJ(f),a&&(b=a.getCalcService().allowDynamicArray,c=a.Cw))){for(d=[].concat(c.i1),e=d.length-1;e>=0;e--)!b&&d[e]&&ja(d[e].name)?d.splice(e,1):d[e].isFunc=!0;return d.concat(this.o2(f,a)).concat(this.q2(f.sheets)).concat(this.jDJ(f))}return this.i1},a.prototype.o2=function(a,b){var c,d=[],e=b.getCustomNames();return e&&g.GC$.each(e,function(a,b){d.push({name:b.Cj,description:b.kT})}),c=a.getCustomNames(),c&&g.GC$.each(c,function(a,b){d.push({name:b.Cj,description:b.kT})}),d},a.prototype.q2=function(a){var b=[];return a.forEach(function(a){var c,e,f=a.tables;if(f&&(c=f.all()))for(e=0;e<c.length;e++)b.push({name:c[e].name(),description:d.sR().Fbx_TableName_Description+c[e].name()})}),b},a.prototype.jDJ=function(a){var b,c=[],e=a.ECJ;for(b=0;b<e.length;b++)c.push({name:e[b].name(),description:d.sR().Fbx_TableSheetName_Description+e[b].name()});return c},a.prototype.s2=function(a,b){var c,d,e,f;for(a=v(a),q.Bb(a,"[")&&(a=a.substr(a.lastIndexOf("[")+1),a=q.Gb(a,"@","")),c=[],d=b&&b.length,f=0;f<d;f++)e=b[f],0===v(_(e.name)).indexOf(a)&&c.push(e);return c},a.prototype.t2=function(){var a,b,c,d,e,f=this.caret();if(f<=0)return"";if(a=this.S0,b=a&&a.length,b>0)for(c=0,d=void 0,e=0;e<b;e++){if(d=a[e],c+d.text.length>=f)return d.text.substring(0,f-c);c+=d.text.length}return""},a.prototype.u2=function(){var a,b,c,d,e,f,g,h,j,k=this.caret(),l=this.S0,m=l&&l.length,n=[],o=0;for(b=0;b<m;b++){if(a=l[b],n.push(a),6===a.type)for(c=0;n.length>0;)if(d=n.pop(),6===d.type&&c++,5===d.type&&c--,0===c){n.length>0&&(d=n[n.length-1],d&&2===d.type&&n.pop());break}if(o+=a.text.length,o>=k)break}if(n.length>0)for(e=0;n.length>0;)if(a=n.pop(),8===a.type)e++;else if(2===a.type){for(f=v(a.text),g=this.n2(),h=g&&g.length,j=void 0,b=0;b<h;b++)if(j=g[b],v(_(j.name))===f)return{func:j,activeParamterIndex:e,isFunc:j.isFunc};break}return i},a.prototype.c2=function(){var a,b,c,d,e,f,h,i,j=this,k=j.v2(),l=j.g1&&g.bW(j.text())&&k&&k.length>0&&!j.MH&&!j.T1;if(l&&!j.V4){for(j.w2(),a=j.Z0,k.length>8?(a.style.height="204px",a.style.overflowY="scroll"):(a.style.height="auto",a.style.overflowY=""),b="",c=k.length,d=void 0,e=0;e<c;e++)d=k[e],b+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+d.isFunc+">"+_(d.name)+"</div><div class='gcsj-func-ac-row-description'>"+(d.description||"")+"</div></div>";f=g.GC$(j.Z0),f.html(b).show(),j.R1=!0,h=f.find(C),h.length>0&&(i="gcsj-ac-row-active",g.GC$(h[0]).addClass(i),h.bind("mouseover",function(){h.removeClass(i),g.GC$(this).addClass(i)}),h.bind("click",function(){j.a2()}),j.YWJ&&h.bind("mousedown",function(a){j.a2(),r(a)})),j.SH()}else j.z2()},a.prototype.cXJ=function(){var a=this,b=g.GC$(a.Z0).find(C);b&&(b.unbind("mouseover"),b.unbind("click"),a.YWJ&&b.unbind("mousedown"))},a.prototype.v2=function(){var a,b,c,e,f,g,h,i,j=this,k=j.s1(j.caret()),l=k&&k.text,m=[],n=j.S0.indexOf(k);if(k&&14===k.type)return m;if(a=this._getTable(n),b=j.A2(n,a),b.length>0){if(c=[],!a.kj.ODJ){e=JSON.parse(JSON.stringify(d.sR().B2)),f=d.getMapping()&&d.getMapping().tableFunctionsMapping;for(g in e)h=f&&f[e[g].name],h&&(e[g].name=h),c.push(e[g])}if(m=m.concat(b).concat(c),q.jb(l,"[")||q.jb(l,"[@"))return m}else m=this.n2();return l=j.t2(),i=[],l&&(i=j.s2(l,m)),i},a.prototype._getTable=function(a){var b,c,d,e,f,h,i=this.S0;return a<0||!i||a>=i.length?null:(b=this.OC,c=b&&g.UCJ(b),s(a)&&(a=i.length),c?(d=i[a],e=q.Ib(d.text,"["),f=c.tables,h=f&&f.findByName(e),s(h)&&(h=b.getSheetTab(e)),h):null)},a.prototype.A2=function(a,b){var c=[];return s(b)||(c=ca(b).columns),c},a.prototype.z2=function(){g.GC$(this.Z0).hide(),this.R1=!1},a.prototype._1=function(a){var b,c,d,e,f,h,i=g.GC$(this.Z0).find(C),j=i.length;if(0!==j){if(b="gcsj-ac-row-active",c=0,a)for(d=0;d<j;d++)if(g.GC$(i[d]).hasClass(b)){c=d+a;break}e=g.GC$(this.Z0).scrollTop(),i.removeClass(b),f=0,j>0&&(f=i[0].offsetHeight),c=k(c,0),c=l(c,j-1),h=i[c],g.GC$(h).addClass(b),h.offsetTop+h.offsetHeight>g.GC$(this.Z0).scrollTop()+g.GC$(this.Z0).height()?g.GC$(this.Z0).scrollTop(g.GC$(this.Z0).scrollTop()+f):h.offsetTop<g.GC$(this.Z0).scrollTop()?g.GC$(this.Z0).scrollTop(h.offsetTop):g.GC$(this.Z0).scrollTop(e)}},a.prototype.a2=function(){var a,b,c,d,e,f,h,j,k,l,m,n,o,p,r,s=this,t=g.GC$(s.Z0).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),u=t.text(),v="true"===t.attr("isFunc");if(u){for(a=s.caret(),b=s.S0,c=b&&b.length,d=0,e=0,f=0,h=i;f<c&&(h=b[f],e=h.text.length,!(d+e>=a));)f++,d+=e;j=a-d,k=h.text,l=0,m=0,q.Bb(k,"[")?(l=k.lastIndexOf("[",j-1),l===-1?(l=k.indexOf("["),l===-1?h.text=u:h.text=u+k.substr(l),l=0):(l++,"@"===k.charAt(l)&&(l+=1),m=k.indexOf("]",j),m===-1&&(m=k.length),h.text=k.substring(0,l)+u+k.substr(m))):(h.text=u,n=k.substr(j),n&&(o=s.T0("="+n),o.length>1&&b.splice(f+1,0,o[1]))),v?h.type=2:h.type=11,p=f+1,r=b[p],!v||r&&5===r.type||b.splice(p,0,{text:"(",type:5}),s.z2(),s.qo.focus(),s.z1(),s.caret(d+u.length+l+(v?1:0)),s.S1(),s.S0=s.T0(s.text()),s.Wq(D,{})}},a.prototype.S1=function(){var a,b,c,e,f,h,j,k,m,n,o,p,q,r,s,t,u,v=this;if(v.R1&&v.z2(),a=v.u2(),a===i||a.isFunc!==!0)return void v.w2();if(b=v.w1(),c=v.h1&&g.bW(v.text())&&a&&!v.MH&&!v.T1,c&&!v.V4){for(e=a.func,f=e.parameters,h=f&&f.length,j=l(h-1,a.activeParamterIndex),k=void 0,m="",n=0;n<h;n++)k=f[n],o=k.name,k.repeatable&&(o+=b+"..."),k.optional&&(o="["+o+"]"),p=n===h-1?"":b+" ",o=n===j?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+o+"</span>"+p:"<span class='gcsj-func-help-paramter'>"+o+"</span>"+p,m+=o;q="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+_(e.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+m+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>",r="<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+d.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(e.description||"")+"</div></div>",
s="<div class='gcsj-func-help-section-content'>"+r+"</div>",t="<div class='gcsj-func-help-body'>"+s+"</div>",u=q+t,g.GC$(v.$0).html(u).show(),v.W1=!0,v.SH()}else v.w2()},a.prototype.w2=function(){g.GC$(this.$0).hide(),this.W1=!1},a.prototype.close=function(){this.z2(),this.w2()},a.prototype.BH=function(a,b){var c,d,e,f,g,h;return!this.MH&&(c=a.ctrlKey||a.shiftKey||a.altKey||a.metaKey,d=a.keyCode,e=a.ctrlKey,f=a.altKey,g=a.metaKey,h=a.srcElement||a.target,!this.YWJ&&h&&b&&b.isEditing&&"gcAttachedFormulaTextBox"===h.getAttribute("gcUIElement")?67===d&&(e||g)&&!f||88===d&&(e||g)&&!f:this.R1&&!c&&(d===H.down||d===H.up||d===H.tab))},a.prototype.SH=function(){var a,b,c,d,e,f,j,k,l,m,n,o,q,r,s,t,u,v,w=this,x=i;if(w.R1?x=w.Z0:w.W1&&(x=w.$0),x){if(a=g.GC$(w.qo),b=g.GC$(x),c=h.G0.H0,c&&c.kj)return d=c.kj.getCellRect(c.nT,c.Mk),e=c.f1,void b.css("top",d.y+d.height+e.top).css("left",d.x+e.left);f=a.parent(),j=a.outerHeight(),w.Dia(w.qo)&&(f=f.parent(),j=f.outerHeight()),k=f.css("top"),l=parseFloat(k),isNaN(l)||(k=l),m=f.css("left"),"auto"===k&&(k=a.offset().top,m=a.offset().left),n=k+j,o=g.GC$(p.body).outerHeight(),q=g.GC$(p.body).outerWidth(!0),r=b.outerHeight(),s=b[0].offsetWidth,t=parseFloat(m),u=n+r,u>o&&(v=k-r,v>=0&&(n=v)),t+s+2>q&&(t-=t+s+2-q),b.css("top",n).css("left",t)}},a.prototype.focus=function(){g.GC$(this.qo).focus()},a.prototype.V0=function(a){var b,c,d,e,f=this,g="",h="",i=a&&a.length,j=0;for(c=0;c<i;c++)b=a[c],d="",11===b.type&&(d=" style='color: "+f.o1(j)+"'",j++),f._0.innerText=b.text,g+="<span"+d+" class='gcsj-func-color-text'>"+f._0.innerHTML+"</span>",h+=b.text;if(h||f.text())if(e=f.qo,g)e.innerHTML="<span class='gcsj-func-color-content'>"+g+"</span>";else for(;e.firstChild;)e.removeChild(e.firstChild)},a.prototype.e1=function(a,b){var c,d,e,f=g.GC$(a).find(".gcsj-func-color-content .gcsj-func-color-text"),h=f.length;for(b=k(0,b),e=0;e<h;e++)if(c=f[e],d=c.innerText,b-=d.length,b<=0)return{node:c,offset:d.length+b};return d?{node:c,offset:d.length}:i},a.prototype.nIb=function(a,b){var c=o.getSelection(),d=this.qo.children[0],e=document.createRange();e.setStart(d,a),e.setEnd(d,b),c.removeAllRanges(),c.addRange(e)},a.prototype.Jka=function(a){var b=this,c=b.qo,d=b.Cia(c),e=b.text();d&&e&&(e=a?e.substr(0,e.length-2):e,b.Ac.push(e))},a.prototype.BLb=function(a,b){var c,d,e,f,g,h,i,j;if(b)for(c=0,d=0,e=0,f=b.length,g=0;g<a.length;g++){for(h=a[g].text,d;d<f;d++)if(i=b[d].toUpperCase(),j=h[e]?h[e].toUpperCase():void 0,i===j)e+=1;else{if("\n"!==i)break;d+1<f&&b[d+1]===P&&(d+=1)}a[g].text=b.substring(c,d),c=d,e=0}return a},a.prototype.ALb=function(a){var b,c,d,e,f;if("="===a[0]&&a.indexOf("\n")!==-1){for(b=[],c=a.length,d=!1,e=0;e<c;e++)f=a[e],'"'===f&&(d=!d),d?b.push(f):"\n"!==f?b.push(f):e+1<c&&a[e+1]===P&&(e+=1);return b.join("")}},a}(),b.FormulaTextBox=U;function ka(){var a,b,c,d=o.getSelection();d.rangeCount>0&&(a=d.getRangeAt(0),b=p.createElement("span"),b.innerHTML="<br/>"+P,a.insertNode(b),c=p.createRange(),c.setStartAfter(b),c.setEndAfter(b),c.collapse(!1),d.removeAllRanges(),d.addRange(c))}function la(a){return"gcAttachedFormulaTextBox"===a.target.getAttribute("gcuielement")}},"./dist/plugins/group/group-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),b.Commands=e.Commands,f=c("./dist/plugins/group/group.js"),g=e.Commands.ActionBase,h=e.GC$,i="outlineColumn",j="removeColumnOutline",k="expandColumnOutline",l="expandColumnOutlineForLevel",m="outlineRow",n="removeRowOutline",o="expandRowOutline",p="expandRowOutlineForLevel",q=d.Common.j.Fa;function F(a){var b=a.kj;return a.ML?b.rowOutlines:b.columnOutlines}function G(a){var b,c,d,e,f,g=this,h=!1;return(a?g.canExecute():g.canUndo())&&(b=g.kj,c=g.VQ.index,d=g.VQ.count,e=F(g),b&&e&&!q(c)&&!q(d)&&(f=a?e.group:e.ungroupRange,g.Lz(b,!0),f.call(e,c,d),g.Mz(b,!0),h=!0)),h}r=function(a){E(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.ML=d,e}return b.prototype.execute=function(){var a,b,c=this,d=c.kj,f=c.VQ,g=d.ITa;return g.startTransaction(),a=G.call(c,!0),b=e.Commands.bWa(d.name()),f[b]=g.endTransaction(),a},b.prototype.undo=function(){return G.call(this,!1)},b}(g),s=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!1)||this}return b}(r),t=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!0)||this}return b}(r),u=function(a){E(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.ML=d,e}return b.prototype.execute=function(){var a,b,c,d,f,g=this,h=g.kj,i=h.ITa,j=!1;return g.canExecute()&&(a=g.VQ,b=a.index,c=a.count,d=F(g),h&&d&&!q(b)&&!q(c)&&(i.startTransaction(),g.Lz(h,!0),d.ungroupRange(b,c),g.Mz(h,!0),f=e.Commands.bWa(h.name()),a[f]=i.endTransaction(),j=!0)),j},b.prototype.undo=function(){var a,b,c=this,d=!1,f=c.kj;return c.canUndo()&&(a=e.Commands.bWa(f.name()),b=c.VQ[a],f&&b&&(c.Lz(f,!0),f.ITa.undo(b),c.Mz(f,!0),d=!0)),d},b}(g),v=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!1)||this}return b}(u),w=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!0)||this}return b}(u);function H(a,b,c,d,e){var f=0,g;for(g=b;g<=c&&g<d;g++)f+=e.call(a,g)*a.zoom();return f}function I(a,b,c,d,e){var f=0,g;for(g=b;g<d&&f<c;g++)b++,f+=e.call(a,g)*a.zoom();return b>=d?d-1:b}function J(a,b,c,d,e){if(b<d)return d;if(b>e)return e;for(var f=b;f<=e;f++)if(c.call(a,f))return f;return-1}function K(a,b,c){var d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this,w=v.kj,x=c.index,y=b?w.getRowCount():w.getColumnCount(),z=void 0,A=F(v),B=A.u2J;x<0||x>=y||B||(d=1===A.direction(),e=d?x-1:x+1,f.isIndexValid(A,e)&&(g=w.am(),h=b?w.frozenRowCount():w.frozenColumnCount(),i=b?w.frozenTrailingRowCount():w.frozenTrailingColumnCount(),j=b?g.uNc:g.xNc,k=b?w.BBJ:w.CBJ,l=b?w.getRowHeight:w.getColumnWidth,m=b?w.getViewportTopRow:w.getViewportLeftColumn,n=b?w.getViewportHeight:w.getViewportWidth,o=m.call(w,1),s=A.find(e,c.level),s&&(t=d?s.start:x,u=d?x:s.end,d?(a?t=x:t<h&&(t=h),t<o&&(o=t),u>=y-i&&(u=y-i-1),p=n.call(w,1),p+=k?0:j,q=H(w,o,u,y,l),q>p&&(o=I(w,o,q-p,y,l)),r=J(w,o,l,h,y-1)):(a?u=x:u>=y&&(u=y-1),u>=y-i&&(u=y-i-1),t<o?r=J(w,t,l,h,y-1):(p=n.call(w,1),p+=k?0:j,q=H(w,o,u,y,l),q>p&&(r=J(w,t,l,h,y-1)))),b&&r!==z?(w.lq=r,w.os()):b||r===z||(w.qq=r,w.qs()))))}function L(a){var b,c,d,e,g,h,i,j=this,k=!1;return(a?j.canExecute():j.canUndo())&&(b=j.kj,c=j.VQ,d=F(j),e=c.collapsed,g=c.index,h=c.level,!b||!d||q(e)||q(g)||q(h)||(j.Lz(b,!0),a||(e=!e),i=1===d.direction()?d.find(g-1,h):d.find(g+1,h),i&&d.setCollapsed(g,e),q(c.index)&&(c.index=f.getExtendIndex(b,j.ML,h)),K.call(j,e,j.ML,c),j.Mz(b,!0),k=!0)),k}x=function(a){E(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.ML=d,e}return b.prototype.canExecute=function(){var a,b,c=this,d=c.kj,e=d.ODJ;return!e||(a=c.VQ.level,b=F(c),e.detailColumnsVisible()||a<b.getMaxLevel())},b.prototype.execute=function(){var a,b,c=this,d=c.kj,f=c.VQ,g=d.ITa;return g.startTransaction(),a=L.call(c,!0),b=e.Commands.bWa(d.name()),f[b]=g.endTransaction(),a},b.prototype.undo=function(){return L.call(this,!1)},b}(g),y=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!1)||this}return b}(x),z=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!0)||this}return b}(x),A=function(a){E(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.ML=d,e}return b.prototype.canExecute=function(){var a,b,c=this,d=c.kj,e=d.ODJ;return!e||(a=c.VQ.level,b=F(c),e.detailColumnsVisible()||a<=b.getMaxLevel())},b.prototype.execute=function(){var a,b,c,d,g,h,i=this,j=i.kj,k=!1;if(i.canExecute()&&(a=void 0,b=i.VQ.level,c=F(i),j&&c&&!q(b))){for(j.ITa.startTransaction(),i.Lz(j,!0),j.suspendCalcService(),j.ITa.vUa(i.ML),c.Lia(),a=0;a<b;a++)c.expand(a,!0,!0);c.expand(b,!1,!0),c.Mia(),j.ITa.vUa(i.ML,!0),d=i.VQ.index,q(d)&&(d=f.getExtendIndex(j,i.ML,b)),K.call(i,!1,i.ML,{level:b-1,index:d}),g=j.getCalcService(),g.H9J="filter",j.recalcRange(0,0,j.getRowCount(),j.getColumnCount()),delete g.H9J,j.resumeCalcService(!1),g.F9J(),i.Mz(j,!0),h=e.Commands.bWa(j.name()),i.VQ[h]=j.ITa.endTransaction(),k=!0}return k},b.prototype.undo=function(){var a,b,c,d=this,f=!1;return d.canUndo()&&(a=d.kj,b=e.Commands.bWa(a.name()),c=d.VQ[b],a&&c&&(d.Lz(a,!0),a.ITa.undo(c),f=!0,d.Mz(a,!0))),f},b}(g),B=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!1)||this}return b}(A),C=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!0)||this}return b}(A),D=e.Commands.h4,e.Commands[i]={canUndo:!0,execute:function(a,b,c){return D(a,s,b,c)}},e.Commands[m]={canUndo:!0,execute:function(a,b,c){return D(a,t,b,c)}},e.Commands[j]={canUndo:!0,execute:function(a,b,c){return D(a,v,b,c)}},e.Commands[n]={canUndo:!0,execute:function(a,b,c){return D(a,w,b,c)}},e.Commands[k]={canUndo:!0,execute:function(a,b,c){return D(a,y,b,c)}},e.Commands[o]={canUndo:!0,execute:function(a,b,c){return D(a,z,b,c)}},e.Commands[l]={canUndo:!0,execute:function(a,b,c){return D(a,B,b,c)}},e.Commands[p]={canUndo:!0,execute:function(a,b,c){return D(a,C,b,c)}},e.Commands.SL=function(a){a.register(i,e.Commands[i]),a.register(m,e.Commands[m]),a.register(j,e.Commands[j]),a.register(n,e.Commands[n]),a.register(k,e.Commands[k]),a.register(o,e.Commands[o]),a.register(l,e.Commands[l]),a.register(p,e.Commands[p])}},"./dist/plugins/group/group.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/group/group-actions.js")),d(c("./dist/plugins/group/group.js")),d(c("./dist/plugins/group/group.ns.js"))},"./dist/plugins/group/group.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("./dist/plugins/group/group-actions.js"),g=c("./dist/plugins/group/group.ns.js"),h={},i=null,j=void 0,k=Math.max,l=Math.min,m=Math.round,n=Math.ceil,o=e.GC$,p=o.each,q=e.Im.Lm,r=d.Common.k,s=r._b,t=r.$b,u=r.ac,v=8.25,w=17,x=4,y=e.Ul.Ol,z=d.Common.j.Fa,A=e.Ul.Pl,B=e.Ul.fp,C=e.Ul.IcK,D=e.Ul.JcK,E=e.Ul.McK,F="rangegroup",G="gc-group",H=G+"-box",I=H+"-expand",J=H+"-collapsed",K=G+"-line",L=G+"-dot",M="rgh",N="cgh",O="rg",P="cg",Q=e.XFileConstants.AbK,R=e.XFileConstants.HbK,S="1",T="0",U=new d.Common.ResourceManager(g.SR,"Outlines"),b.getSR=U.getResource.bind(U),V=e.NodeHelper.oca,W={Gt:function(){var a,b,c,d,e,f,g,h=this,i=h.TL;return i?i:(a=h.options,b=a.sheetAreaOffset,c={x:b.left,y:b.top,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},d=h.rowOutlines,e=h.columnOutlines,f=w*h.zoom(),h.showRowOutline()&&d&&!d.iT()&&(g=d.getMaxLevel(),g>=0&&(c.width=f*(g+2)+x,c.rowMaxLevel=g)),h.showColumnOutline()&&e&&!e.iT()&&(g=e.getMaxLevel(),g>=0&&(c.height=f*(g+2)+x,c.colMaxLevel=g)),h.TL=c,c)},showRowOutline:A("showRowOutline",!0,function(){this.$p()}),showColumnOutline:A("showColumnOutline",!0,function(){this.$p()})},o.extend(e.Worksheet.prototype,W);function ea(a,b){a.Wq(e.Events.RangeGroupStateChanging,b)}function fa(a,b){a.Wq(e.Events.RangeGroupStateChanged,b)}function ga(a,b){var c,d=a.options,e=d.isProtected;return!e||(c=d.protectionOptions,b?c.allowOutlineRows:c.allowOutlineColumns)}function ha(a,c){var d,f,g,h,i=c.what===M,j=ga(a,i);a.isEditing&&a.isEditing()||!j?j||a.Os(e.InvalidOperationType.groupProtected,b.getSR().Exp_GROUP_PROTECTED):(d=c.info.index,f=i?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",g=ja(a,i,-1,d,!0),ea(a,g),h=ka(a,i,d-1),g&&g.cancel===!1&&(a.wu().execute({cmd:f,sheetName:a.name(),level:d,index:h}),fa(a,ja(a,i,-1,d,!1))))}function ia(a,c){var d,f,g,h,i,j,k=c.what===O,l=ga(a,k);a.isEditing&&a.isEditing()||!l?l||a.Os(e.InvalidOperationType.groupProtected,b.getSR().Exp_GROUP_PROTECTED):pa(k,a)&&(d=c.info,f=d.index,g=f,h=d.level,i=void 0,j=k?"expandRowOutline":"expandColumnOutline",1===d.lineDirection?f--:f++,i=ja(a,k,f,h,!0),ea(a,i),i&&i.cancel===!1&&(a.wu().execute({cmd:j,sheetName:a.name(),index:g,level:h,collapsed:d.isExpanded}),fa(a,ja(a,k,f,h,!1))))}function ja(a,b,c,d,e){var f={sheet:a,sheetName:a.name(),isRowGroup:b,index:c,level:d};return e&&(f.cancel=!1),f}function ka(a,b,c){var d,e,f,g=b?a.rowOutlines:a.columnOutlines;if(g)for(d=g.items,e=!1,f=0;f<d.length;f++)if(d[f])if(d[f].level===c)e=!0;else if(e)return f;return b?a.getActiveRowIndex():a.getActiveColumnIndex()}b.getExtendIndex=ka;function la(a,b){var c,d,f,g,h=this,j=h.Gt(),k=j.width,l=j.height;return k||l?(c=h.am(),d=new e.Rect(j.x,j.y,k,c.height),f=new e.Rect(j.x,j.y,c.width,l),d.contains(a,b)||f.contains(a,b)?(g=ma(h,a,b,j.rowMaxLevel,!0),g||(g=ma(h,a,b,j.colMaxLevel,!1)),g||{what:"empty",info:i}):i):i}X=function(){function a(a,b,c){var d=this;d.PADDING=2,d.kj=a,d.ML=b,d.ZL=y(c)?c:pa(b,a).getMaxLevel()}return a.prototype._L=function(a){var b,c,d,e,f,g,h,i,j,l,n,o,p,r,s,t,u,w,x,y,z,A,C,D,E,F,I,J=this,K=J.kj,L=J.ZL;if(!(L<0)&&(b=J.ML,c=K.Gt(),d=oa.call(J,c,b),d)){if(e=L+2,f=J.PADDING,g=K.options,h=c.width,i=c.height,j=c.x,l=c.y,n=K.am(),o=n.width,p=n.height,r=n.Cr,s=n.Br,t=n.zr,u=n.Ar,a.save(),a.fillStyle=q(G).backgroundColor,a.strokeStyle=q(G).borderTopColor,a.lineWidth=1,a.fillRect(j,l,b?h:o,b?p:i),a.strokeRect(j-.5,l-.5,b?h:o+1,b?p+1:i),b?a.strokeRect(j-.5,u-.5,h,r):a.strokeRect(t-.5,l-.5,s,i),w=(b?r:s)-d,y=k(0,(b?u-g.sheetAreaOffset.top:t-g.sheetAreaOffset.left)+w/2),z=f,b&&(C=y,y=z,z=C),a.restore(),x=b?g.colHeaderVisible:g.rowHeaderVisible,a.save(),x&&w>=0)for(A=0;A<e;A++)D=d-1,E=void 0,F=j+y,I=l+z,b?F=m(F)+.5:I+=.5,a.fillStyle=q(H).backgroundColor,a.fillRect(F,I,D,D),a.font=v*K.zoom()+"pt Arial",a.strokeStyle=q(H).borderTopColor,a.strokeRect(F,I,D,D),a.fillStyle=q(H).color,E=B(a.font),J.pM(a,F,I,D,d,A+1,E),b?y+=d:z+=d;a.restore()}},a.prototype.pM=function(a,b,c,d,e,f,g){var h=""+f,i=a.measureText(h).width;i<=d&&g<=e&&(a.textBaseline="middle",a.fillText(h,b+(d-i)/2,c+d/2))},a.prototype.WL=function(a,b,c){var d,e,f,g,h=this,j=h.kj,k=h.ZL;return k<0?i:(d=k+2,e=j.am(),f=j.options,g=f.sheetAreaOffset,c?h.qM(j,a,b,c,f.colHeaderVisible,e.Cr,e.Ar-g.top,d):h.qM(j,a,b,c,f.rowHeaderVisible,e.Br,e.zr-g.left,d))},a.prototype.qM=function(a,b,c,d,f,g,h,j){var l,m,n,o,p,q=this,r=a.Gt(),s=oa.call(q,r,d),t=g-s;if(s&&f&&t>=0)for(l=k(0,h+t/2),m=q.PADDING,d&&(p=l,l=m,m=p),o=0;o<j;o++){if(n=new e.Rect(r.x+l,r.y+m,s,s),n.contains(b,c))return{index:o};d?l+=s:m+=s}return i},a}(),Y=function(){function a(a,b,c,d){var e=this;e.PADDING=2,e.LINE_SIZE=2,e.START_LINE_SIZE=6,e.bM=[],e.cM=[],e.dM=[],e.kj=a,e.ML=b,e.eM=c,e.ZL=y(d)?d:pa(b,a).getMaxLevel()}return a.prototype.YL=function(){var a,b=this;b.ZL!==-1&&(a=b.fM(0,b.ML),p(a,function(a,c){b.gM(c)}))},a.prototype.gM=function(a){var b,c,d,e,f,g,h,j,m,n,o,q,r,s,t,v,w,x,y=this,z=y.kj,A=y.ML,B=pa(A,z).direction(),C=1===B,D=0===B,E=y.hM(!0,A),F=y.hM(!1,A),G=a.start,H=a.end,I=a.level;if(C?b=H+1:D&&(b=G-1),0===a.state()){if(c=!0,d=a.parent,d&&(D&&G===d.start||C&&H===d.end)&&(c=!1),c&&y.iM(!0,I,b,E,F,B),G<=F&&H>=E){for(e=k(E,G),f=l(F,H),g=void 0,h=void 0,c&&(g={start:e,end:f,level:I,startLine:i},(C&&e===G||D&&f===H)&&(g.startLine=!0),y.bM.push(g)),m=[],n=a.children,h=e;h<=f;h++)m.push(!1);for(p(n,function(a,b){var c=b.start,d=b.end,f;if(1===b.state())for(j=c;j<=d;j++)m[j-e]=!0;f=C?d+1:d-1,m[f-e]=!0,y.gM(b)}),o=!0,h=0;h<u(n);h++){if(q=n[h],r=q.start,s=q.end,t=r===G,v=s===H,t&&v){o=!1;break}if(C&&v||D&&t)for(j=r;j<=s;j++)m[j-e]=!0}if(o)for(w=e;w<=f;w++)m[w-e]||(x={index:w,level:I+1},y.cM.push(x))}}else 1===a.state()&&y.iM(!1,I,b,E,F,B)},a.prototype.iM=function(a,b,c,d,e,f){var g={isExpanded:a,level:b};a&&(g.paintLine=!0),c>=d&&c<=e&&(g.index=c,g.lineDirection=f,this.dM.push(g))},a.prototype.jM=function(a){var b=this,c=b.kj,d=b.eM;return b.ML?c.Gr(d).findRow(a):c.Hr(d).findCol(a)},a.prototype.aM=function(a){var b,c,d,e,f,g,h,i,j,k,l,n,o,p=this;p.ZL!==-1&&(b=p.kj,c=b.Gt(),d=p.ML,e=oa.call(p,c,d),e&&(f=parseInt(q(K).borderTopWidth,10),f=isNaN(f)?2:f,g=m(e/3),h=p.PADDING,i=(e-f)/2+h,a.save(),a.fillStyle=q(G).color,j=b.am(),k=0,l=0,n=c.width,o=c.height,d?(l+=j.y+j.Cr,o=j.height-j.Cr):(k+=j.x+j.Br,n=j.width-j.Br),a.rect(k,l,n,o),a.clip(),p.kM(a,p.cM,d,c,e,i,f),d?p.D_a(a,p.bM,d,c,e,i,f,g):p.E_a(a,p.bM,d,c,e,i,f,g),p.mM(a,p.dM,d,c,e,i,f,h),a.beginPath(),a.restore()))},a.prototype.kM=function(a,b,c,d,e,f,g){var h,i,j,l=this,m=2,n=l.kj,o=n.options,r=o.sheetAreaOffset,s=r.left,t=r.top;a.save(),a.fillStyle=q(L).color,j=l.bM,p(b,function(b,n){var o,p,q,r,u,v=n.index,w=n.level,x=l.jM(v);x&&(l.C0a(j,v,w)||(o=c?x.y:x.x,p=(c?x.height:x.width)-g,p>=0&&(h=o+k(0,p/2),i=n.level*e+f,c?(q=h,h=i+.5,i=q,i-=t):(i+=.5,h-=s),a.strokeStyle="transparent",a.lineWidth=0,r=d.x+h,u=d.y+i,r%1!==0&&(r+=.5),u%1!==0&&(u+=.5),a.strokeRect(r,u,m,m),a.fillRect(r,u,m,m))))}),a.restore()},a.prototype.C0a=function(a,b,c){var d,e=!1,f=u(a);for(d=0;d<f;d++)if(a[d].level===c&&a[d].start<=b&&a[d].end>=b){e=!0;break}return e},a.prototype.D_a=function(a,b,c,d,e,f,g,h){var i,j,l,m,o,p,r,s,t,v,w,x,y,z,A,B,C;for(a.save(),a.strokeStyle=q(K).borderTopColor,a.fillStyle=q(K).borderTopColor,a.lineWidth=g,i=this,j=i.kj,l=pa(c,j).direction(),o=j.options,p=o.sheetAreaOffset,r=p.top,m=0;m<u(b);m++){s=b[m],t=s.start,v=s.end,w=void 0,x=void 0;do w=i.jM(t),t++;while(!w&&t<=v);do x=i.jM(v),v--;while(!x&&v>=t);(w||x)&&(w?x||(x=w):w=x,y=w.y,z=s.level*e+f,A=g,B=k(0,x.y+x.height-w.y),1===l?y+=1:y-=1,y-=r,a.beginPath(),C=d.x+z+A/2,C=n(C),a.moveTo(C,d.y+y),a.lineTo(C,d.y+y+B),a.stroke(),s.startLine&&e/2-2*g>0&&(0===l&&(y=y+B-g-r),y>=w.y-r&&y<x.y+x.height-r&&a.fillRect(n(d.x+z),d.y+y,h,g)))}a.restore()},a.prototype.E_a=function(a,b,c,d,e,f,g,h){var i,j,l,m,o,p,r,s,t,v,w,x,y,z,A,B;for(a.save(),a.strokeStyle=q(K).borderTopColor,a.fillStyle=q(K).borderTopColor,a.lineWidth=g,i=this,j=i.kj,l=pa(c,j).direction(),o=j.options,p=o.sheetAreaOffset,r=p.left,m=0;m<u(b);m++){s=b[m],t=s.start,v=s.end,w=void 0,x=void 0;do w=i.jM(t),t++;while(!w&&t<=v);do x=i.jM(v),v--;while(!x&&v>=t);(w||x)&&(w?x||(x=w):w=x,y=w.x,z=s.level*e+f,A=k(0,x.x+x.width-w.x),1===l&&(y+=1),y-=r,B=d.y+z+g/2,B=n(B),a.beginPath(),a.moveTo(d.x+y,B),a.lineTo(d.x+y+A,B),a.stroke(),s.startLine&&e/2-2*g>0&&(0===l&&(y=y+A-g-r),y>=w.x-r&&y<x.x+x.width-r&&a.fillRect(d.x+y,n(d.y+z),g,h)))}a.restore()},a.prototype.r0a=function(a){var b=q(a).backgroundImage;return"none"===b&&(b=""),b&&(b=b.split(",")[0],b=b.replace(/url\(['"]?([^'"\)]+)['"]?\)/,"$1"),b=b.trim()),b},a.prototype.mM=function(a,b,c,d,e,f,g,h){var i,j,m,o,p,r,s,t,v,w,x,y,z,A,B,C,D,E,F,G,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z=this,$=Z.kj,_=$.options,aa=_.sheetAreaOffset.left,ba=_.sheetAreaOffset.top,ca=q(H).borderTopColor,da=q(H).backgroundColor,ea=q(H).color,fa=q(K).borderTopColor,ga=1,ha=$.vu(),ia=Z.r0a(I),ja=Z.r0a(J);for(ia&&!ha.ko(ia)&&ha.fo(ia),ja&&!ha.ko(ja)&&ha.fo(ja),j=ja&&ha.lo(ja),m=ia&&ha.lo(ia),o=q(I),p=q(J),r=m?o.backgroundColor:"",s=j?p.backgroundColor:"",t=m?o.borderTopColor:"",v=j?p.borderTopColor:"",i=0;i<u(b);i++)a.save(),A=b[i],B=Z.jM(A.index),B?(C=c?B.height:B.width,C<=0?a.restore():(D=k(0,(C-e)/2),E=void 0,F=void 0,G=(c?B.y-ba:B.x-aa)+D,L=A.level*e+h,M=l(e,C),N=e,O=void 0,P=void 0,Q=C-M,c?(R=G,G=L,L=R,S=M,M=N,N=S,O=.5,P=0):(O=0,P=.5),y=A.isExpanded?t:v,a.strokeStyle=y?y:ca,a.lineWidth=ga,x=A.isExpanded?r:s,x?a.fillStyle=x:a.fillStyle=da,a.fillRect(d.x+G,d.y+L,M,N),E=d.x+G+O,F=d.y+L+P,a.strokeRect(E,F,M,N),a.fillStyle=ea,w=A.isExpanded?ia:ja,Z.nM(a,A.isExpanded,w,E,F,M,N),a.restore(),A.paintLine&&Q>0&&(a.save(),a.strokeStyle=fa,G=c?B.y-ba:B.x-aa,L=A.level*e+f,T=0===A.lineDirection,U=c?g:D,V=c?D:g,c?(W=G,G=L,L=W,T&&(L+=D+N,V=Q-D)):T&&(G+=D+M,U=Q-D),a.beginPath(),a.lineWidth=g,X=n(d.x+G+g/2),Y=n(d.y+L+g/2),c?(a.moveTo(X,d.y+L),a.lineTo(X,d.y+L+V-ga)):(z=0,j&&!A.isExpanded&&(z=1),a.moveTo(d.x+G,Y),a.lineTo(d.x+G+O+U+z,Y)),a.stroke(),a.restore()))):a.restore()},a.prototype.nM=function(a,b,c,d,e,f,g){var h,i,j,k=this,l=this.kj,n=l.vu();if(c&&n.ko(c)){h=n.lo(c),i=h.width,j=h.height;try{a.drawImage(h,0,0,i,j,m(d),m(e),f-1,g-1)}catch(a){}}else k.u0a(a,b,d,e,f,g)},a.prototype.u0a=function(a,b,c,d,e,f){var g,h,i=m(e/4),j=m(e/2);b||(g=m(f/4),h=m(f/2),a.fillRect(c+e/2-1,d+g,2,f-h)),a.fillRect(c+i,d+f/2-1,j,2)},a.prototype.fM=function(a,b){var c,d,e,f=this,g=f.kj,h=[],i=-1,j=-1,m=pa(b,g),n=b?g.Gr:g.Hr,o=n.call(g,f.eM),p=u(o);for(p&&(d=o[0],e=o[p-1],i=k(0,(b?d.row:d.col)-1),j=b?l(g.getRowCount(),e.row+2):l(g.getColumnCount(),e.col+2));i<j;)c=m.find(i,a),c?(i=c.end+1,h.push(c)):i++;return h},a.prototype.hM=function(a,b){var c=-1,d=this,e=d.kj,f=d.eM,g=e.frozenRowCount(),h=e.frozenColumnCount(),i=e.frozenTrailingRowCount(),j=e.frozenTrailingColumnCount(),k=e.getRowCount(),l=e.getColumnCount();return 0===f?c=a?0:(b?g:h)-1:1===f?c=a?b?g:h:(b?k-i:l-j)-1:2===f&&(c=a?b?k-i:l-j:(b?k:l)-1),c},a.prototype.oM=function(a){a&&this.kj.CH&&(a.x-=2,a.y-=2,a.width+=4,a.height+=4)},a.prototype.XL=function(a,b,c){var d,f,g,h,j,m,n,o,p,q,r,s,t,v,w,x,y=this,z=y.ZL,A=y.kj,B=A.options,C=B.sheetAreaOffset.left,D=B.sheetAreaOffset.top;if(z<0)return i;if(d=A.Gt(),f=oa.call(y,d,c),!f)return i;for(g=y.dM,m=0;m<u(g);m++)if(n=g[m],o=n.index,p=n.level*f+y.PADDING,q=y.jM(o),q&&(h=c?q.height:q.width,!(h<=0)&&(r=l(f,h),s=f,t=(c?q.y-D:q.x-C)+k(0,(h-f)/2),v=p,c&&(w=r,r=s,s=w,x=t,t=v,v=x),j=new e.Rect(d.x+t+.5,d.y+v+.5,r,s),y.oM(j),j.contains(a,b))))return n;return i},a}();function ma(a,b,c,d,e){var f,g,h=new X(a,e,d),j=h.WL(b,c,e);if(j)return{what:e?M:N,info:j};for(f=na(a,e,d),g=0;g<=2;g++)if(j=f[g].XL(b,c,e))return{what:e?O:P,info:j};return i}function na(a,b,c){var d=[new Y(a,b,0,c),new Y(a,b,1,c),new Y(a,b,2,c)],e;for(e=0;e<=2;e++)d[e].YL();return d}function oa(a,b){var c=b?a.width:a.height;return k(0,(c-2*this.PADDING)/(this.ZL+2))}function pa(a,b){return a?b.rowOutlines:b.columnOutlines}!function(a){a[a.backward=0]="backward",a[a.forward=1]="forward"}(Z=b.OutlineDirection||(b.OutlineDirection={})),h.OutlineDirection=Z,function(a){a[a.expanded=0]="expanded",a[a.collapsed=1]="collapsed"}($=b.OutlineState||(b.OutlineState={})),h.OutlineState=$,_=function(){function a(a,b,c,d){var e=this;e.children=[],e.parent=i,e.model=a,e.start=b,e.end=c,e.level=d}return a.prototype.state=function(a){var b=this,c=b.model;return arguments.length?void(c&&c.expandGroup(b,0===a)):c?c.getState(b):0},a.prototype.contains=function(a){return this.start<=a&&a<=this.end},a.prototype.addChild=function(a){a&&(this.children.push(a),a.parent=this)},a}(),b.OutlineInfo=_,h.OutlineInfo=_,aa=function(){function a(a){this.level=a?a.level:0,this.collapsed=!!a&&a.collapsed,this.viewCollapsed=!!a&&a.viewCollapsed}return a}();function qa(a,b,c){var d,e,f,g;if(c>0){for(d=a.items,e=void 0,f=void 0,g=[],e=0;e<c;e++)g.push(i);if(a.items=d=d.slice(0,b).concat(g,d.slice(b)),a.V3<=0&&b>0&&(f=d[b-1]))for(e=0;e<c;e++)d[b+e]=new aa(f);wa(a)}}function ra(a,b,c){c>0&&(a.items.splice(b,c),wa(a))}function sa(a,b,c){for(var d,e,f,g,h=i,j=a.items,k=b,l=u(j);k<l&&(d=j[k],!d||d.level<c||(h||(h=new _(a,k,k,c)),d.level>c&&(e=sa(a,k,c+1),k=e.index,h.addChild(e.g)),k>h.end&&(h.end=k),!a.isGroupEnd(k,c)));k++);if(h)for(f=h.end+1,g=h.start;g<f;g++)j[g].groupInfo||(j[g].groupInfo=h);return{g:h,index:k}}function ta(a,b){return b>=-1&&b<u(a.items)}b.isIndexValid=ta;function ua(a,b,c){var d,e,f=a&&a.items;if(f)for(d=f[b]&&f[b].groupInfo;d;){if(e=d.level,e===c)return d;if(!(e>c))break;d=d.parent}return i}function va(a,b){switch(a){case"head":case"tail":return b===i;case"direction":return 1===b;case"itemsData":return 0===u(b);default:return!1}}function wa(a){a.Zka=i,a.refresh()}function xa(a,b){!b&&a.Wka||(a.Zka=a.createRangeGroup(),za(a))}function ya(a){a.Wka&&!a.Zka&&(a.Zka=a.createRangeGroup())}function za(a,b){!a.Wka&&a.groupChangeHandler&&a.groupChangeHandler(b)}function Aa(a,c,d){if(Ba(a,c),!ta(a,c+d-1))throw Error(b.getSR().Exp_InvalidCount)}function Ba(a,c){if(!ta(a,c))throw Error(b.getSR().Exp_InvalidIndex)}function Ca(a,b){for(var c,d=a.parent;d&&(c=b?a.end===d.end:a.start===d.start);)a=d,d=d.parent;return a}ba=function(){function a(a,b,c){var d=this;d.head=i,d.tail=i,d.Zka=i,d.items=Array(a),d.V3=0,d.wz=!0,d.kj=b,d.ML=c}return a.prototype.no=function(){this.kj=i},a.prototype.getUsedRange=function(a){var b,c,d,f,g,h,i,j,k,l,m,n,o;if(a&e.UsedRangeType.axis)return b=this,c=b.items,d=b.ML,f=Object.keys(c),g=f.length,h=b.kj,g>0&&h?(i=0,j=g,k=c[+f[0]],l=g-1,m=c[+f[l]],k&&k.level===-1&&(i=1),m&&m.level===-1&&(j=l),d?(n=h.getColumnCount()-1,{minRow:+f[i],minCol:0,maxRow:+f[j-1],maxCol:n}):(o=h.getRowCount()-1,{minRow:0,minCol:+f[i],maxRow:o,maxCol:+f[j-1]})):void 0},a.prototype.group=function(a,b){var c=this,d,e;for(Aa(c,a,b),c.kj.ITa.vUa(c.ML),d=0;d<b;d++)e=a+d,c.items[e]?c.items[e].level++:c.items[e]=new aa;c.Wka&&c.Zka&&(c.Zka=i),c.kj.ITa.vUa(c.ML,!0),xa(c),c.wz=!1},a.prototype.Lia=function(){this.Wka=!0,this.Zka=i},a.prototype.Mia=function(){var a=this;a.Wka=!1,a.refresh()},a.prototype.ungroupRange=function(a,b){var c=this,d,e;for(Aa(c,a,b),c.kj.ITa.vUa(c.ML),d=0;d<b;d++)e=c.items[a+d],e&&e.level>-1&&e.level--;c.kj.ITa.vUa(c.ML,!0),xa(c)},a.prototype.ungroup=function(){var a=this,b=u(a.items);a.kj.ITa.vUa(a.ML),a.items=Array(b),xa(a),a.wz=!0},a.prototype.expand=function(a,c,d){var e,f,g,h,i,j,k;if(a<-1)throw Error(b.getSR().Exp_InvalidLevel);for(e=this,f=e.items,h=e.kj,h.ITa.vUa(e.ML),ya(e),i=h.Cf(),h.suspendPaint(),i.suspend(),j=0,k=f.length;j<k;j++)f[j]&&(g=e.find(j,a),g&&(e.expandGroup(g,c,!0),j=g.end));d||e.kj.ITa.vUa(e.ML,!0),i.resume(!1),h.resumePaint()},a.prototype.expandGroup=function(a,c,d){if(!a)throw Error(b.getSR().Exp_GroupInfoIsNull);var e=this,f=e.direction(),g=-1;d||e.kj.ITa.vUa(e.ML),0===f?g=a.start-1:1===f&&(g=a.end+1),e.setCollapsed(g,!c,a.level,d),d||e.kj.ITa.vUa(e.ML,!0),e.kj.$p()},a.prototype.Xr=function(a){return!(!this.wz&&ta(this,a))||!this.isCollapsed(a)},a.prototype.isCollapsed=function(a){var b=this.items[a];return!!(b&&b.viewCollapsed&&b.level>-1)},a.prototype.find=function(a,b){var c=this,d;return ya(c),b===-1?d=c.Zka:(c.kj.ODJ||Ba(c,a),d=ua(c,a,b)),d},a.prototype.getLevel=function(a){var b=this.items[a];return b?b.level:-1},a.prototype.getCollapsed=function(a){var b=this.items[a];return!!b&&!!b.collapsed},a.prototype.B4=function(a,b,c,d){var e,f;for(e=b;e<=c;e++)f=a[e],f||(f=a[e]=new aa,f.level=-1),f.viewCollapsed=d},a.prototype.setCollapsed=function(a,b,c,d){var e,f,g,h,i,k,l=this,m=!1,n=l.items,o=l.kj.ITa,p=[];if(d||o.vUa(l.ML),ya(l),a<0?(e=l.head,e||(e=l.head=new aa)):a<u(n)?(e=n[a],e||(e=n[a]=new aa,e.level=-1)):(e=l.tail,e||(e=l.tail=new aa)),f=1===l.direction(),g=c!==j,g||e.collapsed===b?g&&(e.level===c-1&&(e.collapsed=b),m=!0,l.E4(a,b,c)):(e.collapsed=b,m=!0,l.E4(a,b,c)),m&&(a+=f?-1:1,i=l.find(a,l.getLevel(a)))){for(k=i.start;k<=i.end;k++)p.push(k);h={indexes:p}}za(l,h),d||l.kj.ITa.vUa(l.ML,!0)},a.prototype.dPa=function(a,b){var c,d=this.items;d[a]?d[a].collapsed!==b&&(d[a].collapsed=b):(c=d[a]=new aa,c.level=-1,c.collapsed=b)},a.prototype.E4=function(a,b,c){var d,e,f,g,h,i,k,l,m,n,o=this,p=o.items,q=1===o.direction(),r=q?-1:1,s=c!==j,t=a+r,u=s?c:o.getLevel(t),v=ua(o,t,u);if(v&&(d=q?v.end+1:v.start-1,d!==a&&(v=null)),z(v)&&(u=s?c:o.getLevel(a),v=ua(o,a,u)),v)if(e=void 0,f=v.parent,b)s||(e=q?v.end+1:v.start-1,o.dPa(e,!0),v=Ca(v,q)),o.B4(p,v.start,v.end,!0);else{for(g=!1,h=void 0;f;){if(h=q?f.end+1:f.start-1,p[h]&&p[h].collapsed&&p[h].level>-1){g=!0;break}f=f.parent}if(!g)for(s||(e=q?v.end+1:v.start-1,o.dPa(e,!1),v=Ca(v,q)),o.B4(p,v.start,v.end,!1),i=[v],k=0;k>=0;)if(l=i[k],k--,h=q?l.end+1:l.start-1,p[h]&&p[h].collapsed&&p[h].level!==-1)o.B4(p,l.start,l.end,!0);else for(m=l.children,n=0;m&&n<m.length;n++)++k,i[k]=m[n]}},a.prototype.getMaxLevel=function(){var a=-1,b=this.items,c;return p(b,function(b,d){d&&(c=d.level,c>a&&(a=c))}),a},a.prototype.cB=function(a,b,c,d){var e,f,g,h,i;if(!(c<=0||a===b)){for(e=this,e.kj.ITa.vUa(e.ML),a<0&&(a=0),b<0&&(b=0),f=[],g=e.items,h=s(g,a-1);h>=0&&h<a+c;)i=new aa(g[h]),f.push({index:h-a,value:i}),h=s(g,h);d&&t(g,a,c),t(g,b,c),p(f,function(a,c){g[b+c.index]=c.value}),wa(e),e.kj.ITa.vUa(e.ML,!0)}},a.prototype.bB=function(a,b,c,d,e){var f,g,h=this;if(h.kj.ITa.vUa(h.ML),b<0&&(b=0),c<0&&(c=0),f=[],a)for(g=s(a.items,b-1);g>=0&&g<b+d;)f[g-b]=new aa(a.items[g]),g=s(a.items,g);t(h.items,c,d),f.length>0&&f.forEach(function(a,b){h.items[c+b]=a}),e&&t(a.items,b,d),h.kj.ITa.vUa(h.ML,!0)},a.prototype.refresh=function(){this.wz||xa(this)},a.prototype.VL=function(a){var b=this,c=b.items,d=u(c),e=a-d;e<0?c.splice(a,-e):b.items=c.concat(Array(e)),wa(b)},a.prototype.getState=function(a){var b=this,c=b.items,d,e=b.direction(),f=-1;return 0===e?f=a.start-1:1===e&&(f=a.end+1),d=f<0?b.head:f<u(c)?c[f]:b.tail,d&&d.collapsed?1:0},a.prototype.Ez=function(a,b){var c=this,d=c.items;a<0?(c.head||(c.head=new aa),c.head.level=b):a<u(d)?(d[a]||(d[a]=new aa),d[a].level=b):(c.tail||(c.tail=new aa),c.tail.level=b),wa(c)},a.prototype.suspendAdding=function(){this.V3++},a.prototype.resumeAdding=function(){this.V3--},a.prototype.createRangeGroup=function(){for(var a,b,c=this,d=c.items,e=u(c.items),f=new _(c,0,e-1,(-1)),g=0;g<e;)d[g]&&(d[g].groupInfo=i),g++;for(g=0;g<e;)d[g]?(a=sa(c,g,0),b=a.g,g=a.index+1,b&&b.level>-1&&f.addChild(b)):g++;return f},a.prototype.LLb=function(a,b){return 1===this.direction()?b===a.end+1:b===a.start-1},a.prototype.MLb=function(a,b,c,d){var e=this,f=-1,g=0;if(1===e.direction()&&(f=0,g=1),a===b)return e.LLb(a,c)||e.LLb(a,d)?{start:a.start,end:a.end,level:a.level}:{start:c,end:d,level:a.level};for(;a.level>b.level;){if(b===a.parent)return e.LLb(b,d)?{start:b.start,end:b.end,level:b.level}:{start:a.start+f,end:d,level:a.level-1};a=a.parent}for(;a.level<b.level;){if(a===b.parent)return e.LLb(a,c)?{start:a.start,end:a.end,level:a.level}:{start:c,end:b.end+g,level:b.level-1};b=b.parent}for(;a.level>=0;){if(a.parent===b.parent)return{start:a.start+f,end:b.end+g,level:b.level-1};a=a.parent,b=b.parent}return{start:a.start+f,end:b.end+g,level:b.level-1}},a.prototype.NLb=function(a){var b,c,d,e=this,f=e.items,g=f[a];return b=1===e.direction()?f[a-1]:f[a+1],c=g?g.level:-1,d=b?b.level:-1,c<d?b&&b.groupInfo:g&&g.groupInfo},a.prototype.gJb=function(a,b){var c,d,e=this,f=e.NLb(a),g=e.NLb(a+b-1);if(z(f)&&z(g))return{start:a,end:a+b-1,count:b,level:-1};if(!f||!g){for(c=f||g;c&&c.level!==-1;)c=c.parent;f||(f=c),g||(g=c)}return d=e.MLb(f,g,a,a+b-1),d.count=d.end-d.start+1,d},a.prototype.lJb=function(a,b){var c,d,e,f,g=this,h=g.items;for(c=a;c<a+b;c++)if(d=h[c]&&h[c].groupInfo&&h[c].groupInfo.level,!z(d)&&d>=0)return!0;return e=1===g.direction()?a-1:a+b,f=h[e]&&h[e].groupInfo&&h[e].groupInfo.level,!z(f)&&f>=0},a.prototype.OLb=function(a){var b=this,c=b.items,d=c[a]&&c[a].groupInfo&&c[a].groupInfo.level;return z(d)?-1:d},a.prototype.PLb=function(a,b,c){var d,e,f=this,g=[],h=[];for(d=a;d<a+b;d++)e=f.OLb(d),e===c&&h.push(d),f.OLb(d+1)<c&&h.length>0&&(g.push(h),h=[]);return h.length>0&&g.push(h),g},a.prototype.hJb=function(a,b){var c,d,e,f,g=this;if(1===b)return g.PLb(a.start,a.count,a.level);for(c=[],d=g.getMaxLevel(),e=2===b?a.level+1:a.level,f=d;f>=e&&f>=-1;f--)c=c.concat(g.PLb(a.start,a.count,f));return c},a.prototype.jJb=function(a,b,c){var d,e,f,g=this;for(d=a.length-1;d>=0;d--)e=a[d],e.collapse&&g.setCollapsed(e.head,!1),g.ungroupRange(e.start,e.count);for(d=a.length-1;d>=0;d--)e=a[d],f=r.Cb(b,e.head)+c,1===g.direction()?g.group(f-e.count,e.count):g.group(f+1,e.count),e.collapse&&g.setCollapsed(f,e.collapse)},a.prototype.iJb=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,o=n.items;if(1===c)for(d=n.getMaxLevel(),e=b.level+1;e<=d;e++)a.splice.apply(a,[0,0].concat(n.PLb(b.start,b.count,e)));else 2===c&&a.push.apply(a,n.PLb(b.start,b.count,b.level));for(f=a.length,g=a[f-1].concat([]),h=[],e=f-2;e>=0;e--)i=o[a[e][0]],j=i.groupInfo,1===n.direction()?(k=j.end+1,l=r.Cb(g,k),g.splice.apply(g,[l,0].concat(a[e])),h.push({head:k,start:j.start,count:k-j.start,collapse:i.viewCollapsed
})):(k=j.start-1,l=r.Cb(g,k),g.splice.apply(g,[l+1,0].concat(a[e])),h.push({head:k,start:j.start,count:j.end-k,collapse:i.viewCollapsed}));for(m=!1,e=0;e<b.count;e++)if(g[e]!==e+b.start){m=!0;break}return{array:g,isChanged:m,groupSwap:h}},a.prototype.isGroupEnd=function(a,b){var c,d,e,f,g,h,i=this,j=i.items,k=a+1;return!ta(i,k)||(!(c=j[k])||(d=c.level,e=j[a].level,f=!1,d<e&&(g=e-d,h=e-b,h>=0&&h<g&&(f=!0)),f))},a.prototype.hitTest=function(a,b,c){return la.call(a,b,c)},a.prototype.jp=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;if(!this.iT()&&(e=a.Gt(),f=a.am(),g=a.ss,h=e.width,i=e.height,h||i)){if(j=d?h:f.width,k=d?f.height:i,l=d?e.rowMaxLevel:e.colMaxLevel,m=d?g.bn:g.dn,b.save(),b.beginPath(),!c||c.intersect(e.x,e.y,j,k))for(n=new X(a,d,l),o=void 0,p=void 0,n._L(b),o=m.call(a.ss,function(){return na(a,d,l)}),p=0;p<=2;p++)o[p].aM(b);b.beginPath(),b.restore()}},a.prototype.UL=function(a,b){if(b){var c=b.what;c===M||c===N?ha(a,b):c!==O&&c!==P||ia(a,b)}},a.prototype.iT=function(){return this.wz},a.prototype.s0a=function(){var a=parseInt(q(K).borderTopWidth,10);return isNaN(a)?2:a},a.prototype.fromJSON=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,q,r=b&&b.ignoreStyle;if(a&&!r){if(c=this,d=c.items,e=a.items,f=a.itemsData,g=a.direction,h=a.head,i=a.tail,m=[],z(g)||c.direction(g),h&&(c.head=h),i&&(c.tail=i),n=!1,e&&e.length>0)for(q=0;q<e.length;q++)z(e[q])||(o=new aa(e[q]),c.direction()===Z.forward&&(o.viewCollapsed?n=!0:n&&(o.collapsed=!0,n=!1)),d[q]=o,c.wz=!1);else p(f,function(a,b){if(j=b.index,k=b.info,j>=0&&k){for(l=0;l<b.count&&!(j+l>=u(d));l++)b.info.collapsed&&m.push(b),d[j+l]=new aa(k);c.wz=!1}});for(xa(c,!0),q=0;q<m.length;q++)c.E4(m[q].index,!0)}},a.prototype.toJSON=function(a){var b,c,d,e,f,g,h,i,k,l,m=a&&a.ignoreStyle;if(!m){for(b=this,c=[],d=b.items,f=-1,g=[],e=0;e<u(d);e++)h=c[f],i=d[e],i&&(g[e]={level:i.level,collapsed:i.collapsed,viewCollapsed:i.viewCollapsed},f>=0&&e===h.count+h.index&&i.level===h.info.level&&i.collapsed===h.info.collapsed?c[f].count++:(f++,c[f]={index:e,count:1,info:{level:i.level,collapsed:i.collapsed}}));return k={items:g,itemsData:c,direction:b.direction(),head:b.head,tail:b.tail},l={},p(k,function(a,b){va(a,b)||(l[a]=b)}),o.isEmptyObject(l)?j:l}},a}(),b.Outline=ba,ba.prototype.direction=A("direction",1),h.Outline=ba;function Da(a){return a&&new aa(a)}function Ea(a){return{items:a.items.map(Da),head:Da(a.head),tail:Da(a.tail),wz:a.wz,direction:a.direction()}}function Fa(a,b){a.items=b.items.map(Da),a.head=Da(b.head),a.tail=Da(b.tail),a.wz=b.wz,a.direction(b.direction),xa(a,!0)}o.extend(e.lUa.prototype,{vUa:function(a,b){var c=this,d=c.zTa;d&&(d.originalOutlines||(d.originalOutlines=[]),!a||!b&&d.originalOutlines[0]?a||!b&&d.originalOutlines[1]||(d.originalOutlines[b?3:1]=Ea(c.yUa)):d.originalOutlines[b?2:0]=Ea(c.xUa))},zUa:function(a,b,c){var d,e=this;void 0!==b&&(this.kj.outlineColumn.YQa=b),a&&(d=a[c?2:0],d&&Fa(e.xUa,d),d=a[c?3:1],d&&Fa(e.yUa,d))}}),e.lUa.$n(F,{init:function(){var a=this,b=a.kj;a.yUa=new ba(a.getColumnCount(),b,(!1)),a.xUa=new ba(a.getRowCount(),b,(!0))},applyChanges:function(a){var b=this,c=a.changes,d=a.isUndo,e=c&&c.originalOutlines;(e||c.oldOptions)&&b.zUa(e,c.oldOptions,!d)},undo:function(a){var b=a.originalOutlines;(b||a.oldOptions)&&(this.zUa(b,a.oldOptions),this.kj.$p())},dispose:function(a){var b=this,c=a&&a.clearCache;c!==!1&&(b.yUa&&(b.yUa.no(),b.yUa=i),b.xUa&&(b.xUa.no(),b.xUa=i))}}),ca={init:function(){var a=this;a.rowOutlines=a.ITa.xUa,a.columnOutlines=a.ITa.yUa,a.rowOutlines.groupChangeHandler=function(b){var c,d,f,g,h,i=b&&b.indexes;i&&a.recalcRows&&(c=a.getCalcService(),c&&!c.IsSuspended()&&a.recalcRows(i)),d=a.parent,d&&a!==d.getActiveSheet()||a.au(),i?(f=i[0],g=i[i.length-1],h=!0):(f=0,g=a.getRowCount()-1,h=!1),e.Worksheet.ao(a,"onGroupChanged",{start:f,end:g,isRow:!0,fromSetCollapsed:h})},a.columnOutlines.groupChangeHandler=function(b){var c,d,f,g,h=a.parent;h&&a!==h.getActiveSheet()||a.bu(),c=b&&b.indexes,c?(d=c[0],f=c[c.length-1],g=!0):(d=0,f=a.getColumnCount()-1,g=!1),e.Worksheet.ao(a,"onGroupChanged",{start:d,end:f,isRow:!1,fromSetCollapsed:g})},a.Wr.push(a.rowOutlines),a.Zr.push(a.columnOutlines)},dispose:function(a){var b=this;a.clearCache!==!1&&(b.rowOutlines&&(b.rowOutlines.groupChangeHandler=i),b.columnOutlines&&(b.columnOutlines.groupChangeHandler=i)),o(b.Ws()).unbind("mousedown.group")},setHost:function(a){if(a){var b=this;a.bind("mousedown.group",function(a){var c,d=b.Vs(),e=la.call(b,a.pageX-d.left,a.pageY-d.top);e&&(c=e.what,c===O||c===M?b.rowOutlines.UL(b,e):c!==P&&c!==N||b.columnOutlines.UL(b,e))})}},preProcessMouseDbClick:function(a){var b=this;z(b.yt)||z(b.yt.outlineHitInfo)||(a.r=!0)},onPaintSuspend:function(a){var b=this;a.suspend?(b.rowOutlines.Lia(),b.columnOutlines.Lia()):(b.rowOutlines.Mia(),b.columnOutlines.Mia())},beforeLayoutChanged:function(a){var b=this,c=a.changeType;"invalidateLayout"===c&&(b.TL=i)},onLayoutChanged:function(a){var b=this,c=a.changeType,d=a.row,e=a.rowCount,f=a.col,g=a.colCount,h=a.sheetArea,j=b.rowOutlines,k=b.columnOutlines,l=this.ITa;"addRows"===c?(l.vUa(!0),qa(j,d,e),l.vUa(!0,!0)):"deleteRows"===c?(l.vUa(!0),ra(j,d,e),l.vUa(!0,!0)):"addColumns"===c?(l.vUa(!1),qa(k,f,g),l.vUa(!1,!0)):"deleteColumns"===c?(l.vUa(!1),ra(k,f,g),l.vUa(!1,!0)):"invalidateLayout"===c?b.TL=i:"setColumnCount"===c?(l.vUa(!1),3!==h&&1!==h||k.VL(g),l.vUa(!1,!0)):"setRowCount"!==c||3!==h&&2!==h||(l.vUa(!0),j.VL(e),l.vUa(!0,!0))},paint:function(a){var b=a.ctx,c=a.clipRect,d=this,e=d.rowOutlines,f=d.columnOutlines;e&&e.jp(d,b,c,!0),f&&f.jp(d,b,c,!1)},fromJson:function(a,b,c){if(a){var d=this,e=void 0,f=a.showRowRangeGroup,g=a.showColumnRangeGroup,h=y(f)?f:a.showRowOutline,i=y(g)?g:a.showColumnOutline;z(h)||d.showRowOutline(h),z(i)||d.showColumnOutline(i),e=a.rowRangeGroup||a.rowOutlines,e&&d.rowOutlines.fromJSON(e,c),e=a.colRangeGroup||a.columnOutlines,e&&d.columnOutlines.fromJSON(e,c)}},toJson:function(a,b){var c,d=this,e=d.rowOutlines,f=d.columnOutlines,g=d.showRowOutline();g!==!0&&(a.showRowOutline=g),c=d.showColumnOutline(),c!==!0&&(a.showColumnOutline=c),a.rowOutlines=e?e.toJSON(b):j,a.columnOutlines=f?f.toJSON(b):j},bdK:function(a,b,c){var d,f,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=c&&c.includeStyles===!1;if(!C){for(d=this,f=d.rowOutlines,g=d.columnOutlines,h=d.showRowOutline(),h!==!0&&(a.lossless.showRowOutline=h),i=d.showColumnOutline(),i!==!0&&(a.lossless.showColumnOutline=i),0!==f.direction()&&0!==g.direction()||(k=D(a,Q),k||(k={n_:Q,c_:[]},a.c_.push(k)),l={n_:"outlinePr"},k.c_.push(l),0===f.direction()&&(l.summaryBelow="0"),0===g.direction()&&(l.summaryRight="0")),m=D(a,e.XFileConstants.FbK),n=f.getMaxLevel(),o=g.getMaxLevel(),p=n!==-1?n+1:j,q=o!==-1?o+1:j,m.outlineLevelRow=p,m.outlineLevelCol=q,r=a.tempCols,s=g.items,t=m.defaultColWidth,u=0;u<s.length;u++)v=s[u],v&&(w=v.viewCollapsed,x=r[u]?r[u]:{width:t,hidden:j,collapsed:j,outlineLevel:j},(x.hidden===S||w)&&(x.hidden=S),v.collapsed===!0&&(x.collapsed=S),v.level!==-1&&(x.outlineLevel=v.level+1),r[u]=x);for(y=D(a,R),z=f.items,u=0;u<z.length;u++)A=z[u],A&&(w=A.viewCollapsed,B=y[u]?y[u]:{},B.v===j&&w===!1&&(B.v=0),B.f=A.collapsed===!0?1:0,B.l=A.level+1,y[u]=B)}},cdK:function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,q,r,s,t,v,w,x,y,A,B,E,F,G,H,I,J,K,L,M,N,O,P=c&&c.includeStyles===!1;if(!P&&(a.lossless&&(d=a.lossless.showRowOutline,f=a.lossless.showColumnOutline,z(d)||this.showRowOutline(d),z(f)||this.showColumnOutline(f)),g=this,h=g.rowOutlines,i=g.columnOutlines,j=C(a,Q+"&outlinePr"),j&&("0"===j.summaryBelow&&h.direction(0),"0"===j.summaryRight&&i.direction(0)),k=D(a,e.XFileConstants.GbK),l=k&&k.c_,l&&l.length>0&&(m=i.items,n=g.getColumnCount(),l.forEach(function(a){var b,c,d,f,g,h;if((a.outlineLevel>0||!z(a.collapsed))&&(i.wz=!1,b=a.min-1,c=a.max-1,d=+a.outlineLevel||0,f=V(a.hidden,!1),g=V(a.collapsed,!1),b>=0&&c>=0))for(c===e.MAX_COLUMN_COUNT-1&&(c=Math.max(n,b)),h=b;h<=c;h++)m[h]=new aa({level:d-1,collapsed:g,viewCollapsed:f}),h+2>n&&!(d<=0&&(!m[h-1]||m[h-1]&&m[h-1].level<0))&&(n=h+2)}),n>g.getColumnCount()&&g.setColumnCount(n)),o=D(a,R))){for(q=g.ITa.YTa(!0),r={rowItems:[],itemsData:[]},s=[],t=h.items,v=r.rowItems,w=r.itemsData,x=o.rowCount,y=0===h.direction(),A=g.getRowCount(),B=0;B<x;B++)E=o[B],E?(F=!!E.f,G=+E.l||0,(G>0||F)&&(v[B]={level:G-1,collapsed:F},H=w[w.length-1],H&&B===H.index+H.count&&H.info.level===G-1&&H.info.collapsed===F?H.count++:w.push({index:B,count:1,info:{level:G-1,collapsed:F}})),I=!!E.v,J=s[B-1]&&s[B-1].hidden,w&&Ha(r,B,G,y,I,J),K={},K.hidden=I,I&&0===G&&(K.visible=!1),s.push(K),+B+2>A&&(G>0||F)&&(A=+B+2)):s.push({});if(Ga(r,o,s,h.direction(),q),L=!1,M=void 0,N=[],v&&v.length>0)for(O=0;O<v.length;O++)z(v[O])||(M=new aa(v[O]),h.direction()===Z.forward&&(M.viewCollapsed?L=!0:L&&(M.collapsed=!0,L=!1)),t[O]=M,h.wz=!1);else p(w,function(a,b){var c,d=b.index,e=b.info;if(d>=0&&e){for(c=0;c<b.count&&!(d+c>=u(w));c++)b.info.collapsed&&N.push(b),h[d+c]=new aa(e);h.wz=!1}});for(xa(h,!0),O=0;O<N.length;O++)h.E4(N[O].index,!0);for(A>g.getRowCount()&&g.setRowCount(A),O=0;O<s.length;O++)s[O].visible===!1&&q.KkK.push(O)}}},e.Worksheet.$n(F,ca);function Ga(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(a)for(f=0===d,g=a.rowItems,h=function(){return f?0:b.rowCount-1},i=function(a){return f?a<b.rowCount:a>=0},j=function(a){return f?a+1:a-1},k=function(a){return f?a-1:a+1},l=h();i(l);l=j(l))m=g[l],m&&(n=k(l),o=g[n],p=!o&&"number"==typeof m.level||o&&o.level<m.level,q=o&&o.level>m.level,r=void 0,s=void 0,p?(r=n,s=!!o&&(o.collapsed||o.viewCollapsed)):q?m.level===-1?s=!1:(t=g[o.parentIndex],t&&(r=t.parentIndex,s=t.viewCollapsed)):(r=o.parentIndex,s=o.viewCollapsed),m.parentIndex=r,m.viewCollapsed=s,!s&&c[l].hidden&&(c[l].visible=!1,z(e.infos[l])&&(e.infos[l]={}),e.infos[l].visible=!1))}function Ha(a,b,c,d,e,f){var g,h,i,j,k=a.itemsData;k&&(g=k[k.length-1],h=k[k.length-2],i=g&&g.info,j=h&&h.info,i&&(d&&e&&1===g.count?j&&h.index===g.index-1&&j.level===i.level-1?j.collapsed=!0:b>0?k.splice(k.length-2,0,{index:g.index-1,count:1,info:{level:i.level-1,collapsed:!0}}):a.head={collapsed:!0,level:c-1}:!d&&f&&(j&&g.index===h.index+1&&i.level===j.level-1?g.collapsed=!0:b>=g.index+g.count&&k.push({index:g.index+g.count,count:1,info:{level:i.level-1,collapsed:!0}}))))}da={init:function(){f.Commands.SL(this.commandManager())},onCultureChanged:function(){b.getSR()}},e.Workbook.$n(F,da)},"./dist/plugins/group/group.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/group/group.res.en.js");b.SR={en:d}},"./dist/plugins/group/group.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_InvalidIndex="Invalid index",b.Exp_InvalidCount="Invalid count",b.Exp_InvalidLevel="Invalid level",b.Exp_GroupInfoIsNull="groupInfo is null",b.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},"./dist/plugins/hyperlink/hyperlink.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("SheetsCalc"),g=d.Ul.fp,h=d.Ul.Nl,i=d.Ul.ol,j=d.GC$,k=d.Commands.ActionBase,l=d.CellTypes.Base,m=e.Common.j.Fa,n=e.Common.j.C4,o=e.Common.u.NIc,p=e.Common.pc,q=void 0,r=null,s=Math.max,t=Math.min,u=Math.floor,v=window.open,w=e.Common.u.kb,x="position",y="absolute",z="margin",A="font",B="left",C="top",D="padding",E="border",F="box-sizing",G="pointer",H="background-color",I="content-box",J="default",K="white",L="div",M="gc-spread-hyperlink-tooltip",N="hyperlink",O="followedHyperlink",P="hyperlink",Q="openUrl",R="generateHyperlink",S=/^sjs:\/\/\w+[\!]\w+([\:]\w+)?/,T=/^(mailto:\/\/)?([A-Za-z0-9_\-\.\!\#$%&'*\+/=?^`{|}~])+\@([A-Za-z0-9\-])+\.([A-Za-z0-9\-]){2,63}(\?subject=.+)?$/gi,U=/(((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi,function(a){a[a.blank=0]="blank",a[a.self=1]="self",a[a.parent=2]="parent",a[a.top=3]="top"}(V=b.HyperlinkTargetType||(b.HyperlinkTargetType={})),d.GC$.extend(d.lUa.prototype,{getHyperlink:function(a,b,c){var d,e;return m(c)&&(c=3),d=this,e=d.XTa(c).RTa(a,b),e&&!m(e.hyperlink)?e.hyperlink:r},setHyperlink:function(a,b,c,d){var e,f,g,h,i,j,k,l=this;if(m(d)&&(d=3),e=c&&c.url,e&&e.match(U)&&e.match(U).length>0?(f="www.",w(e,f)&&(c.url="http://"+e)):e&&e.match(T)&&e.match(T).length>0&&(g="mailto:",w(e,g)||(c.url=g+e)),h=l.WTa>0?[["sheetModels",d],q]:q,i=l.XTa(d).RTa(a,b,!0,h?h[0]:q),m(i))h&&(h.length=0);else{if(j=i.hyperlink,m(c))i.hyperlink=null,delete i.hyperlink;else{i.hyperlink={url:"",linkColor:q,visitedLinkColor:q,tooltip:"",target:0,drawUnderline:!0,isVisited:!1,command:""};for(k in i.hyperlink)c[k]!==q&&(i.hyperlink[k]=c[k])}h&&(h[0].push("hyperlink"),h[1]=j,h[2]=i.hyperlink)}h&&h.length>0&&l.zTa.push(h)}}),d.GC$.extend(d.Worksheet.prototype,{getHyperlink:function(a,b,c){var d,e;return 0===c?r:(m(c)&&(c=3),d=this,e=d.ITa,n(e.getHyperlink(a,b,c)))},setHyperlink:function(a,b,c,d){var e,f,g,h;0!==d&&(m(d)&&(d=3),e=this,f=e.ITa,g=f.getRowCount(d),h=f.getColumnCount(d),a<0||a>=g||b<0||b>=h||(f.do("setHyperlink",a,b,c,d),this.$p()))}}),W=function(a){aa(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,g,h,i,j,k,l,n,p,q,r,s=this,t=s.kj,u=!1,x=t.parent,y=t,z=s.VQ.url;if(m(z))return u;if(a=s.VQ.target||0,b="sjs://",0===z.indexOf(b)||"#"===z[0]){if(c=b.length,g="#"===z[0]?z.substr(1):z.substr(c),h=void 0,h=f.formulaToRanges(t,g,0,0,!0),h&&0===h.length&&(h=f.formulaToRanges(t,g,0,0,!1,!0)),h&&h.length>0){if(i=h[0].sheetName,j=h[0].ranges[0],i!==t.name()&&x.getSheetFromName(i).visible()===d.SheetTabVisible.visible){if(k=x.getSheetFromName(i),l={oldSheet:y,newSheet:k,cancel:!1},x.Wq(d.Events.ActiveSheetChanging,l),l.cancel)return;x.setActiveSheet(i),n=x.getActiveSheetIndex(),x.MJc.DLc(n),t=x.getActiveSheet(),y!==t&&x.Wq(d.Events.ActiveSheetChanged,{oldSheet:y,newSheet:t})}x.getSheetFromName(i).visible()===d.SheetTabVisible.visible&&(t.Yq(j.row+j.rowCount,j.col+j.colCount),t.setSelection(j.row,j.col,j.rowCount,j.colCount))}}else m(z)||(p="mailto:",z.match(U)&&z.match(U).length>0?(q="www.",w(z,q)&&(z="http://"+z)):z.match(T)&&z.match(T).length>0&&(w(z,p)||(z=p+z)),w(z,p)&&e.Common.u.Jb(z,"?")>1&&(r=z.split("?"),z=r[0]+"?"+r.slice(1).join("%3F")),v(o(z),["_blank","_self","_parent","_top"][a]));return u},b}(k),d.Commands[Q]={canUndo:!1,execute:function(a,b,c){return d.Commands.h4(a,W,b,c)}},X=function(a){aa(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e=this,f=e.kj,g=e.VQ,h=g.url,i=g.row,j=g.col,k=g.sheetArea;if(null===h)a=null;else{if("string"!=typeof h)return!1;if(b=h.match(U),(!b||b.length<1)&&(b=h.match(T),(!b||b.length<1)&&(b=h.match(S))),!(b&&b.length>0&&0===h.indexOf(b[0])&&h.length===b[0].length))return!1;a={url:h,linkColor:N,visitedLinkColor:O}}return f.ITa.startTransaction(),f.suspendPaint(),f.suspendEvent(),f.setHyperlink(i,j,a,k),f.resumeEvent(),f.resumePaint(),c=d.Commands.bWa(f.name()),e.VQ[c]=f.ITa.endTransaction(),!0},b.prototype.undo=function(){var a,b=this,c=b.kj;return c.suspendPaint(),c.suspendEvent(),a=d.Commands.bWa(c.name()),c.ITa.undo(this.VQ[a]),c.resumeEvent(),c.resumePaint(),!0},b}(k),d.Commands[R]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,X,b,c)}},Y={init:function(){this.commandManager().register(Q,d.Commands[Q]),this.commandManager().register(R,d.Commands[R])}},d.Workbook.$n(P,Y),Z={setHyperlinkWhenEditing:function(a){var b=a.url,c=a.row,d=a.col,e=a.sheetArea,f=this,g=f.getParent();g.options.allowAutoCreateHyperlink&&g.commandManager().execute({cmd:R,sheetName:f.name(),url:b,row:c,col:d,sheetArea:e})}},d.Worksheet.$n(P,Z),$={applyHyperlinkStyle:function(a){var b,c,d=a.sheet,e=a.row,f=a.col;d._Cc&&d._Cc(e,f)||(b=a.style,c=d.getHyperlink(e,f,a.sheetArea),!ga(b)&&fa(b,c))},getCellTextHitInfo:function(a){var b,c,d,e,f,g,h=a.context.sheetArea,i=a.cellStyle,j=a.context,k=j.sheet,l=j.row,n=j.col;ba(k,l,n,h)&&!ga(i)&&(b=a.cellRect,b&&(c=k.Er(l),d=k.Fr(n),e=k.am(),f=void 0,m(h)||3===h?f=e.Ft(c,d):2===h?f=e.fm(c):1===h&&(f=e.gm(d)),f&&(b=b.getIntersectRect(f))),m(h)&&3!==h||!i||!b||(g=k.getText(l,n,h),a.paddingHitInfo={row:l,col:n,x:a.x,y:a.y,sheetArea:h,sheet:k,isFocusAware:!0,isReservedLocation:la(a.x,a.y,i,b,j,g)}))},processMouseUpOnCellPadding:function(a){var b,c,e,f,g,h=a.sheet,i=a.cellStyle,j=a.row,k=a.col,l=a.sheetArea;!h||h.isEditing()||!ba(h,j,k,l)||ga(i)||a.isPivotTable||a.isReservedLocation&&(b=h.Ws(),ea(h),b&&(b.style.cursor=J),c=h.ITa.getHyperlink(j,k,l),c.isVisited=!0,e=c.command,m(e)||""===e||e===Q?h.getParent().commandManager().execute({cmd:Q,sheetName:h.name(),url:c.url,target:c.target}):"string"==typeof e?h.getParent().commandManager().execute({cmd:e,row:j,col:k,sheetName:h.name(),sheetArea:l}):"function"==typeof e&&e.call(r,h,j,k,l),f=h.getColumnCount(),g=new d.Range(j,(-1),1,f),h.repaint(h.getRangeRect(1,1,g)))},processMouseMoveOnCellPadding:function(a){var b,c,d=a.row,e=a.col,f=a.sheet,g=a.cellStyle,h=a.sheetArea;ba(f,d,e,h)&&!ga(g)&&(!f||f.isEditing()&&f.getActiveRowIndex()===d&&f.getActiveColumnIndex()===e||(b=f.Ws(),c=f.getHyperlink(d,e,h),a.isReservedLocation?b&&(da(f,a,c.tooltip),b.style.cursor=G):(ea(f),b&&(b.style.cursor=J))))},processMouseLeaveOnCellPadding:function(a){var b,c=a.sheet,d=a.row,e=a.col,f=a.sheetArea;ea(c),ba(c,d,e,f)&&c&&(b=c.Ws(),b&&(b.style.cursor=J))},onUpdateContainer:function(a){var b=a.cellStyle,c=a.context.row,d=a.context.col,e=a.context.sheet.getHyperlink(c,d);!ga(b)&&fa(b,e)}},l.$n(P,$);function ba(a,b,c,d){return m(d)&&(d=3),!m(a.getHyperlink(b,c,d))}function ca(){var a=h(L);return j(a).css(x,y).css(z,0).css(D,2).css(E,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(F,I).css(H,K).css(A,"9pt Arial"),a}function da(a,b,c){var d,e,f,g,h,i,k;c&&(d=a&&a.zo(),e=d.getElementsByClassName(M)[0],f=!1,m(e)&&(e=ca(),e.className=M,d.insertBefore(e,r),f=!0),g=j(e),!f&&g.isVisible()||(g.text(c),h=a.mm.bG(),i=h.left+b.x,k=h.top+b.y+20,g.css(C,k).css(B,i),g.show()))}function ea(a){var b=a&&a.zo(),c=b.getElementsByClassName(M)[0];m(c)||j(c).hide()}function fa(a,b){m(b)||(b.drawUnderline&&(m(a.textDecoration)?a.textDecoration=1:0!==a.textDecoration&&1!==(1&a.textDecoration)&&(a.textDecoration+=1)),b.isVisited?b.visitedLinkColor===r?a.foreColor="rgba(0,0,0,0)":b.visitedLinkColor===q?a.foreColor=O:a.foreColor=b.visitedLinkColor:m(b.linkColor)?b.linkColor===q&&a.foreColor||(a.foreColor=N):a.foreColor=b.linkColor)}_={0:!0,1:!0,2:!0,3:!0,4:!0};function ga(a){if(a&&a.cellType){var b=a.cellType.typeName;if(!_[b])return!0}return!1}function ha(a,b,c,d,e,f,g){var h=0,i=0,j=a.width,k=a.height,l=ia(g);return l&&(j-=l),h=f=f||0,1===d?h=(j-b)/2:2===d&&(h=j-b-f),1===e?i=(k-c)/2:2===e&&(i=k-c),l&&(h+=l),{x:h,y:i}}function ia(a){var b={context:a,value:0};return l.ao(a.sheet,"getOutlineColumnOffset",b),b.value}function ja(a,b){var c=g(b),e=s(0,d.Vn.Xn(a,b,!0)),f=a.split(/\r\n|\r|\n/).length*c;return{x:0,y:0,width:e,height:f}}function ka(a,b,c,d,e,f,g){var h=ja(a,d),i=ha(e,h.width,h.height,b,c,f,g);return h.x=i.x,h.y=i.y,h}function la(a,b,c,e,f,g){var h,j,k,l,n,o,p,q,r,s,u,v,w,x=f.sheet,y=x.yl;if(m(c))return!1;if(c.textOrientation)return!0;if(h=x.getValue(f.row,f.col,f.sheetArea),g||(g=x.getText(f.row,f.col,f.sheetArea)),!g)return!1;for(g=g.replace(/\s+/g," "),j=c&&c.font?c.font:y.Bl(),j=y.Cl(j),k=[g],l=ma(c),c.wordWrap&&(k=d.Vn.Wn(g,e.width-3-l,j),g=k.join("\r\n")),n=c.hAlign,o=c.vAlign,3===n&&(n=i(n,h,c.formatter)),p=ka(g,n,o,j,e,l,f),q=e.y+p.y,r=0;r<k.length;r++)if(s=ka(k[r],n,o,j,e,l,f),u=e.x+s.x,v=t(u+s.width,e.x+e.width),w=q,q=t(w+s.height,e.y+e.height),u<=a&&a<v&&w<=b&&b<q)return!0;return!1}function ma(a){return 8*(a.textIndent||0)}},"./dist/plugins/namebox/namebox-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("SheetsCalc"),g=c("./dist/plugins/namebox/namebox.ns.js"),h=e.Commands.ActionBase,i=d.Common.u,j=d.Common.j.Fa,k=new d.Common.ResourceManager(g.SR,"NameBox"),l=k.getResource.bind(k),m="print_area",n=void 0,o="addCustomName",p="navigateToRange",q=function(a){s(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,d,e,g,h,k,o,p,q,r,s=this,t=!1;if(s.canExecute()){a=s.kj,b=a.getParent(),c=s.VQ,d=c.nameBox,e=c.selectorValue;try{if(g=a.getSelections(),j(g)||0===g.length)return;if(e.toLowerCase()===m&&a.printInfo)return h=g[0],k=a.printInfo(),k.rowStart(h.row),k.rowEnd(h.row+h.rowCount-1),k.columnStart(h.col),k.columnEnd(h.col+h.colCount-1),!0;for(o=a.name(),i.kb(o,"'")&&i.jb(o,"'")||(o="'"+o+"'"),p=[],q=void 0,r=0;r<g.length;r++)p.push(o+"!"+f.rangeToFormula(g[r],a.getActiveRowIndex(),a.getActiveColumnIndex(),n,!!b.options.referenceStyle));q=p.join(","),b.addCustomName(e,q,a.getActiveRowIndex(),a.getActiveColumnIndex(),""),t=!0}catch(b){a.Os(15,l().invalidName),d.updateNameRangeSelectorValue()}}return t},b}(h),e.Commands[o]={canUndo:!1,execute:function(a,b){e.Commands.h4(a,q,b)}},r=function(a){s(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,k,l=this,m=!1;if(l.canExecute()){if(a=l.kj,b=a.getParent(),c=l.VQ,d=c.nameBox,e=c.selectorValue,f=c.selections,g=c.sheetName,b.BCJ(b.getSheetIndex(g),1,!1,!0),h=b.getActiveSheet(),h.clearSelection(),i=f[0],j(i))return;for(h.setSelection(i.row,i.col,i.rowCount,i.colCount),k=1;k<f.length;k++)i=f[k],h.addSelection(i.row,i.col,i.rowCount,i.colCount);d.selector.val(e),d.r5J=d.selector.val(),m=!0}return m},b}(h),e.Commands[p]={canUndo:!1,execute:function(a,b){e.Commands.h4(a,r,b)}},e.Commands.s5J=function(a){a.register(o,e.Commands[o]),a.register(p,e.Commands[p])}},"./dist/plugins/namebox/namebox-list.js":function(a,b,c){"use strict";var d,e,f=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("CellTypes"),e=function(a){f(b,a);function b(b,c){var d=a.call(this,b)||this;return c&&d.setNameList(c),d}return b.prototype.setNameList=function(a){var b=this;b.setOptions({items:b.t5J(a),textEllipsis:!0})},b.prototype.t5J=function(a){return a.map(function(a){return{text:a,value:a}})},b.CustomNameChange="CustomNameChange",b}(d.List),b.NameBoxList=e},"./dist/plugins/namebox/namebox.entry.js":function(a,b,c){"use strict";var d,e;function f(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),c("./dist/plugins/namebox/namebox-actions.js"),d=c("Core"),e=c("./dist/plugins/namebox/namebox.js"),b.NameBox=e.NameBox,f(c("./dist/plugins/namebox/namebox.ns.js")),b.findControl=function(a){return"string"==typeof a&&(a=document.getElementById(a)),d.GC$(a).data("name-box")}},"./dist/plugins/namebox/namebox.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-calc"),e=c("Core"),f=c("SheetsCalc"),g=c("CellTypes"),h=c("./dist/plugins/namebox/namebox-list.js"),i=c("Common"),j=c("./dist/plugins/namebox/namebox.ns.js"),k=e.GC$,l=null,m=void 0,n="A1",o=".gc-name-box",p="div",q="input",r="name-box",s="_",t="invalid",u="gc-name-box-",v="container",w="selector",x="dropdown",y=i.Common.j.Fa,z=i.Common.u,A=e.util.Nl,B=e.util.Ql,C=new i.Common.ResourceManager(j.SR,"NameBox"),D=C.getResource.bind(C),E=[d.ExpressionType.reference,d.ExpressionType.name,d.ExpressionType.structReference],F={enableAddCustomName:!0,enableNavigateToRange:!0,showCustomNameList:!0,dropDownMaxHeight:500},G=function(){function a(a,b,c){var d,e;this.addCustomNameCommand="addCustomName",this.navigateToRangeCommand="navigateToRange",this.r5J="",this.v5J=!1,a&&b&&(a instanceof HTMLElement?d=a:"string"==typeof a&&(d=document.getElementById(a)),d&&(e=this,e.v5J=!0,e.qo=d,k(d).data(r,e),e.options=B(F,function(a,b,c){e.Op(a,b,c)}),e.T3(c),e.w5J(),e.v5J=!1,e.bind(b)))}return Object.defineProperty(a.prototype,"selector",{get:function(){return k("."+u+w,this.qo)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dropdown",{get:function(){return k("."+u+x,this.qo)},enumerable:!0,configurable:!0}),a.prototype.getHost=function(){return this.qo},a.prototype.getCustomNameList=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;if(void 0===a&&(a=!1),b=this,c=b.Qu,!c)return[];for(d=c.getActiveSheet(),e=[],f=b.PiK(d,a).concat(b.QiK(a)),g=0,h=f;g<h.length;g++)i=h[g],e.push(i.getName());for(j=b.RiK(),k=0,l=j;k<l.length;k++)m=l[k],e.push(m.name);return e},a.prototype.bind=function(a){var b=this;b.unbind(),a&&(b.Qu=a,b._id=a.N7J()),b.rebuild()},a.prototype.unbind=function(){var a=this;a.x5J(),a.FP=l,a.Lva(),a.Qu=l,a._id=l},a.prototype.refresh=function(){this.updateNameRangeSelectorValue()},a.prototype.rebuild=function(){var a=this;a.v5J||(a.Lva(),a.w5J(),a.AJ(),a.y5J(),a.refresh())},a.prototype.executeCommand=function(a,b,c){var d=this,e=d.Qu,f=e.getActiveSheet();e.commandManager().execute({cmd:a,sheetName:c||f.name(),nameBox:d,selectorValue:d.selector.val(),selections:b||f.getSelections()})},a.prototype.dispose=function(){var a=this;a.unbind(),a.FP&&a.FP.dispose(),a.FP=l,a.z5J&&a.z5J.close(),a.z5J=l,k(a.qo).data(r,l),a.qo.innerHTML="",a.qo=l},a.prototype.Op=function(a,b,c){var d=this;if(b!==c){if(d.options[a]=b,d.v5J)return;switch(a){case"dropDownMaxHeight":case"showCustomNameList":d.rebuild();break;case"enableAddCustomName":case"enableNavigateToRange":case"addCustomNameCommand":case"navigateToRangeCommand":d.refresh()}}},a.prototype.T3=function(a){var b=this.options,c=a||{};c=k.extend(!0,{},F,c),k.each(c,function(a,c){b.hasOwnProperty(a)&&(b[a]=c)})},a.prototype.y5J=function(){var a=this;a.FP&&a.FP.setNameList(a.SiK())},a.prototype.SiK=function(){var a=this.getCustomNameList(!0);return a=a.filter(function(b,c){return a.indexOf(b)===c}).sort(function(a,b){return M(a,b)})},a.prototype.x5J=function(){var a=this;a.z5J&&(a.z5J.close(),a.z5J=l,a.FP=l)},a.prototype.A5J=function(){var a,b,c,d,e=this;e.x5J(),a=A(p),b=new h.NameBoxList(a,e.SiK()),c=new g.PopupControl(b.getContainer(),e.qo,{align:g.DropDownAlignment.Near,hostElement:e.Qu.getHost(),direction:g.DropDownDirection.Down}),d=+e.options.dropDownMaxHeight||F.dropDownMaxHeight,k(b.getContainer()).css(["width","maxHeight"],[k(e.qo).width(),d+"px"]).addClass("gc-name-box-list"),c.open(),e.FP=b,e.z5J=c},a.prototype.w5J=function(){var a,b,c,d=this,e=d.qo;e.innerHTML="",a=A(p),a.classList.add(u+v),b=A(q),b.classList.add(u+w),d.options.showCustomNameList&&(c=A(p),c.classList.add(u+x)),a.appendChild(b),c&&a.appendChild(c),e.appendChild(a)},a.prototype.UCJ=function(a){if(a||(a=this.Qu),a){var b=a.getActiveSheet();return b?b:void 0}},a.prototype.O7J=function(){return o+(this._id||"")},a.prototype.AJ=function(){var a=this,b=a.Qu,c=a.qo,d=a.O7J();b.bind(e.Events.SelectionChanging+d,c,function(){var c,d,e,f=a.UCJ();f&&f.getSelections&&(c=f.getSelections(),d=c[c.length-1],null!==d&&d!==m&&(e=H(b,d),a.selector.val(e||""),a.r5J=e||""))}),b.bind(e.Events.InternalSelectionChanging+d,c,function(c,d){var e,f=d.newSelections;null!==f&&f!==m&&(e=H(b,f),a.selector.val(e||""),a.r5J=e||"")}),b.bind(e.Events.SelectionChanged+d,function(b,c){var d=a.B5J();a.updateNameRangeSelectorValue(d,c.shiftKey)}),b.bind(e.Events.DragDropBlockCompleted+d,function(){a.updateNameRangeSelectorValue()}),b.bind(e.Events.ActiveSheetChanged+d,function(){a.updateNameRangeSelectorValue()}),b.bind(e.Events.FormulaTextboxActiveSheetChanged+d,function(){a.updateNameRangeSelectorValue()}),b.bind(e.Events.FormulaTextboxEnterCell+d,function(){a.updateNameRangeSelectorValue()}),b.bind(e.Events.ShapeSelectionChanged+d,function(){a.updateNameRangeSelectorValue()}),b.bind(e.Events.FloatingObjectSelectionChanged+d,function(){a.updateNameRangeSelectorValue()}),a.selector.bind("blur"+d,a.C5J.bind(a)),a.selector.bind("keydown"+d,a.D5J.bind(a)),a.selector.bind("focus",function(){a.selector[0].select()}),a.dropdown.bind("mousedown"+d,a.E5J.bind(a))},a.prototype.Lva=function(){var a=this,b=a.Qu,c=a.O7J();b&&b.unbind(c),a.selector.unbind(c),a.dropdown.unbind(c),k(document).unbind(c)},a.prototype.updateNameRangeSelectorValue=function(a,b){var c,d,e,f,g,h,i,j,k=this;return!y(a)&&k.selector?(k.selector.val(a||""),void(k.r5J=k.selector.val())):(d=k.I5J(),e=d.length,void(e>0?(c=1===e?d[0].name():"",k.selector&&(k.selector.val(c),k.r5J=k.selector.val())):(f=k.B5J(),y(f)?(g=k.Qu,h=g.getActiveSheet(),h?(i=h.getSelections()[h.getSelections().length-1],null!==i&&i!==m&&(j=void 0,j=b?H(g,i):I(g,h.getActiveRowIndex()+1,h.getActiveColumnIndex()+1,i),k.selector&&(k.selector.val(j||""),k.r5J=k.selector.val()))):k.selector.val(n)):(k.selector.val(f),k.r5J=k.selector.val()))))},a.prototype.B5J=function(){var a,b,c=this,d=c.Qu,e=d.getActiveSheet(),f="";if(e)return a=e.getSelections(),b=e.name(),1===a.length?(f=L(K(a[0])),c.TiK(f)||c.UiK(f,b)):void 0},a.prototype.UiK=function(a,b){var c,d,e,g,h,i,j,k;if(a)for(c=this,e=c.PiK().concat(c.QiK()),g=0,h=e;g<h.length;g++)if(i=h[g],d=i.Lf,j=d&&d.source,j&&j instanceof f.SheetSource&&j.getName()===b&&(k=d.getRange(i.Uu||0,i.Vu||0),k&&a===L(k)))return i.getName()},a.prototype.TiK=function(a){var b,c,d,e;if(a)for(b=this.RiK(),c=0,d=b;c<d.length;c++)if(e=d[c],a===L(e.range))return e.name},a.prototype.PiK=function(a,b){var c,d;return void 0===b&&(b=!1),c=this.Qu,d=[],a||(a=c&&c.getActiveSheet()),d=a.getCustomNames(),d.filter(function(a){return J(a,c,b)})},a.prototype.QiK=function(a){var b,c;return void 0===a&&(a=!1),b=this.Qu,c=[],c=b&&b.getCustomNames(),c.filter(function(c){return J(c,b,a)})},a.prototype.RiK=function(){var a,b,c,d,e,f,g=this.Qu,h=g.sheets,i=[],j=[];for(a=0,b=h;a<b.length;a++)c=b[a],j=j.concat(c.tables&&c.tables.all());for(d=0,e=j;d<e.length;d++)f=e[d],i.push({name:f.name(),range:f.dataRange()});return i},a.prototype.I5J=function(){var a=[],b=this,c=b.J5J();return c.forEach(function(b){b.isSelected()&&a.push(b)}),a},a.prototype.J5J=function(a){var b,c,d,e,f=this.Qu,g=a||f.getActiveSheet();return g?(b=g.shapes&&g.shapes.all()||[],c=g.floatingObjects&&g.floatingObjects.all()||[],d=g.charts&&g.charts.all()||[],e=g.pictures&&g.pictures.all()||[],b.concat(d).concat(e).concat(c)):[]},a.prototype.K5J=function(a){var b,c,d=this,e=d.J5J();for(b=0;b<e.length;b++)if(c=e[b],c.name()===a)return c},a.prototype.C5J=function(){var a,b,c,d,e=this,f=e.selector.val();if(!f||e.I5J().length>0)return e.$7J(),void e.updateNameRangeSelectorValue(f);if(b=e.K5J(f))return e.$7J(),void b.isSelected(!0);if(e.r5J.toLocaleUpperCase()!==f.toLocaleUpperCase()){c=e.Qu,d=c.getActiveSheet();try{a=e.L5J()}catch(a){if(a.message===t)return void d.Os(15,D().invalidName)}a&&a.sheetName?e.options.enableNavigateToRange&&a.ranges.length>0&&(e.$7J(a.sheetName),e.executeCommand(e.navigateToRangeCommand,a.ranges,a.sheetName)):e.options.enableAddCustomName&&e.executeCommand(e.addCustomNameCommand);
}},a.prototype.D5J=function(a){var b=this,c=b.selector.val();"Enter"===a.key&&(this.I5J().length>0&&c&&this.I5J()[0].name(c),a.currentTarget.blur(),b.Qu&&b.Qu.focus(!0)),a&&a.stopPropagation&&a.stopPropagation()},a.prototype.E5J=function(){var a=this;a.A5J(),a.FP.on("ValueChangedEvent",function(b){var c,d=b.value;y(d)&&!d||(c=a.selector.val(),a.updateNameRangeSelectorValue(d),a.r5J=c,a.C5J()),a.x5J()})},a.prototype.$7J=function(a){var b,c,d,e=this,f=e.Qu,g=f.getSheetFromName(a)||f.getActiveSheet(),h=e.J5J(g);for(b=0,c=h;b<c.length;b++)d=c[b],d.isSelected()&&d.isSelected(!1)},a.prototype.L5J=function(){var a,b,c,d,e,g,h,i=this,j=i.selector.val(),k=i.Qu,l=k.getActiveSheet();if(j=j.replace(/, /g,","),O(j))throw Error(t);for(b=j.split(","),c={ranges:[],sheetName:""},d=0,e=b;d<e.length;d++)if(g=e[d],a=f.formulaToRanges(l,g,l.getActiveRowIndex(),l.getActiveColumnIndex()),y(a)||0===a.length){if(b.length>1)throw Error(t)}else if(1===a.length){if(h=a[0],c.sheetName&&h.sheetName!==c.sheetName)throw Error(t);if(!k.getSheetFromName(h.sheetName))throw Error(t);c.ranges=c.ranges.concat(h.ranges),c.sheetName=h.sheetName}return c},a}(),b.NameBox=G;function H(a,b){var c,d="",e=b.rowCount,f=b.colCount,g=b.row+1,h=b.col+1;return 1===e&&1===f?d=I(a,g,h):e<0&&f>0?d=f+"C":f<0&&e>0?d=e+"R":e<0&&f<0?(c=a.getActiveSheet(),c&&(d=c.getRowCount()+"R x "+c.getColumnCount()+"C")):d=e+"R x "+f+"C",d}function I(a,b,c,e){var f,g,h,i,j,k,l,n,o,p,q;if(b<1||c<1)return null;if(f="",g=a.getActiveSheet(),h=g&&g.name(),e&&g){if(i=!1,j=g.getSpans())for(k=0;k<j.length;k++)j[k].row===e.row&&j[k].col===e.col&&j[k].rowCount===e.rowCount&&j[k].colCount===e.colCount&&(i=!0);if(l=a.getCustomNames(),l!==m)for(n=0;n<l.length;n++)if(o=l[n].getExpression(),o&&o.type===d.ExpressionType.reference&&o.source&&o.source.getName&&h===o.source.getName()&&(p=o.getRange(0,0),null!==p&&p!==m&&(p.row===e.row&&p.column===e.col&&p.row+p.rowCount===e.row+e.rowCount&&p.column+p.columnCount===e.col+e.colCount||p.row===e.row&&p.column===e.col&&i))){f=l[n].getName();break}if(""===f&&l!==m)for(n=0;n<l.length;n++)o=l[n].getExpression(),o&&o.type===d.ExpressionType.reference&&(p=o.getRange(0,0),(p.row===e.row&&p.column===e.col&&p.row+p.rowCount===e.row+e.rowCount&&p.column+p.columnCount===e.col+e.colCount||p.row===e.row&&p.column===e.col&&i)&&(f=l[n].getName()))}if(""===f)switch(a.options.referenceStyle){case 0:for(;c>0;)q=c%26,0===q?(f="Z"+f,c--):f=String.fromCharCode("A".charCodeAt(0)+q-1)+f,c=parseInt(""+c/26,10);f+=""+b;break;case 1:f="R"+b+"C"+c}return f}e.Workbook.$n("nameBox",{init:function(){e.Commands.s5J(this.commandManager()),this.curNameBoxId=0},onCultureChanged:function(){D()}}),k.extend(e.Workbook.prototype,{N7J:function(){var a=this.curNameBoxId+(""+(new Date).getTime());return this.curNameBoxId+=1,a}});function J(a,b,c){void 0===c&&(c=!1);var e=a.getExpression();return!(!e||c&&!N(e,b))&&(E.indexOf(e.type)>-1||e.type===d.ExpressionType.operator&&16===e.operatorType)}function K(a){var b=a.row,c=a.col,d=a.rowCount,f=a.colCount;return b!==-1&&d!==-1||(b=-1,d=-1),c!==-1&&f!==-1||(c=-1,f=-1),new e.Range(b,c,d,f)}function L(a){if(a)return a.row+s+a.col+s+a.rowCount+s+a.colCount}function M(a,b){var c,d;try{d=i.Common.CultureManager.getCultureInfo(),c=d.localeCompare?d.localeCompare(a,b):a.localeCompare(b,"en")}catch(d){c=a.localeCompare(b)}return c}function N(a,b){var c,d,e,g,h,i;try{if(c=b.getActiveSheet(),d=!!b.options.referenceStyle,e=f.formulaToRanges(c,f.expressionToFormula(b,a,c.getActiveRowIndex(),c.getActiveColumnIndex(),d),m,m,m,d),!e||e.length<1)return!1;for(g=0,h=e;g<h.length;g++)if(i=h[g],!b.getSheetFromName(i.sheetName))return!1}catch(a){return!1}return!0}function O(a){return RegExp(/[^A-Za-z0-9_\.\\!\\?\'\"\,\:\u0080-\uFFFF]+/g).test(a)}},"./dist/plugins/namebox/namebox.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/namebox/namebox.res.en.js");b.SR={en:d}},"./dist/plugins/namebox/namebox.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.invalidName="You must enter a valid reference you want to go to, or type a valid name for the selection."},"./dist/plugins/outlineColumn/outlineColumn-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),b.commands=e.Commands,f=e.Commands.ActionBase,g=d.Common.j.Fa,h="increaseCellIndent",i="decreaseCellIndent",j="updateOutlineColumnCheckStatus",k="updateOutlineColumnOption",l="outlineColumnCheckStatus",b.outlineColumnCheckStatus=l,m=e.Commands.h4;function s(a,b,c,d){return u(a,b,c,d)}function t(a,b,c,d){a.Wq(e.Events.OutlineColumnCheckStatusChanged,{sheet:a,sheetName:a.name(),row:b,col:c,status:d})}function u(a,b,c,d){var e,f,h,i,j,k,l,m,n,o,p=g(d)?a.getActiveColumnIndex():d;if(!a.outlineColumn.XQa(p))return null;if(e=b?1:-1,f=a.getActiveRowIndex(),h=a.getSelections()[0].rowCount,j=!0,g(c))for(c={},j=!1,i=f;i<h+f;i++)0!==i&&(k=a.rowOutlines.getLevel(i),b&&(l=a.rowOutlines.getLevel(i-1),k>l&&!c[i-1])||(m=k+e,n=a.outlineColumn.options(),o=g(n.maxLevel)?a.outlineColumn.Oia().maxLevel:n.maxLevel,o&&m+1>o||m+1<0||(c[i]={row:i,original:k+1,current:m+1},j=!0)));return j?c:null}function v(a,b,c,e){var f,h,i,j=u(a,b,c,e);if(!j)return null;f=g(e)?a.getActiveColumnIndex():e,a.outlineColumn.Lia(),a.suspendPaint();for(h in j)d.Common.D(j,h)&&(i=j[h],a.getCell(i.row,f).textIndent(i.current));a.resumePaint(),a.outlineColumn.Mia()}function w(a,b,c,d){var e,f,g,h,i,j=0,k=0,l=a.rowOutlines.getLevel(b);if(a.outlineColumn.Kia.updateCheckStatus(b,d),f=b<=a.getRowCount()-2?a.rowOutlines.find(b+1,l+1):null,null!==f&&null!==d)for(g=f.start;g<f.end+1;g++)a.outlineColumn.Kia.updateCheckStatus(g,d);for(f=a.rowOutlines.find(b,l);null!==f&&null!==f.parent;){if(f.start>0){for(j=f.start-1,k=a.rowOutlines.getLevel(j),a.outlineColumn.Kia.updateCheckStatus(j,d),e=a.rowOutlines.find(j+1,k+1),g=e.start;g<e.end+1;g++)if(h=a.outlineColumn.Kia.QR[g].checkBox.checkStatus,h!==d){i="number"==typeof h&&"number"==typeof d&&3,a.outlineColumn.Kia.updateCheckStatus(j,i);break}g===e.end+1&&d===!0&&a.outlineColumn.Kia.updateCheckStatus(j,!0)}f=f.parent}}b.setCheckStatus=w;function x(a){var b=a.kj,c=e.Commands.bWa(b.name()),d=a.VQ[c];b.ITa.undo(d)}n=function(a){r(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!!s(this.kj,!0,this.VQ.changingRows,this.VQ.changingColumns)},b.prototype.canUndo=function(){return!0},b.prototype.execute=function(){var a,b;return!!this.canExecute()&&(a=this.kj,a.ITa.startTransaction(),a.outlineColumn.Kia.JVa(),v(this.kj,!0,this.VQ.changingRows,this.VQ.changingColumns),b=e.Commands.bWa(a.name()),this.VQ[b]=a.ITa.endTransaction(),!0)},b.prototype.undo=function(){var a=this,b=a.kj,c=e.Commands.bWa(b.name()),d=a.VQ[c];return b.ITa.undo(d),!0},b}(f),o=function(a){r(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!!s(this.kj,!1,this.VQ.changingRows,this.VQ.changingColumns)},b.prototype.canUndo=function(){return!0},b.prototype.execute=function(){var a,b;return!!this.canExecute()&&(a=this.kj,a.ITa.startTransaction(),a.outlineColumn.Kia.JVa(),v(a,!1,this.VQ.changingRows,this.VQ.changingColumns),b=e.Commands.bWa(a.name()),this.VQ[b]=a.ITa.endTransaction(),!0)},b.prototype.undo=function(){return x(this),!0},b}(f),p=function(a){r(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!0},b.prototype.canUndo=function(){return!0},b.prototype.execute=function(){var a,b=this,c=b.kj,d=b.VQ,f=d.options,g=JSON.parse(JSON.stringify(c.outlineColumn.YQa));return c.ITa.startTransaction(),c.outlineColumn.YQa=f,c.outlineColumn.refresh(),a=e.Commands.bWa(c.name()),d[a]=c.ITa.endTransaction(),d[a].oldOptions=g,!0},b.prototype.undo=function(){return x(this),this.kj.outlineColumn.refresh(),!0},b}(f),q=function(a){r(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!0},b.prototype.canUndo=function(){return!0},b.prototype.execute=function(){var a,b=this,c=b.kj,d=b.VQ,f=d.row,g=d.col,h=d.status;return c.ITa.startTransaction(),w(c,f,g,h),c.outlineColumn.refresh(),a=e.Commands.bWa(c.name()),d[a]=c.ITa.endTransaction(),t(c,f,g,h),!0},b.prototype.undo=function(){return x(this),this.kj.outlineColumn.refresh(),!0},b}(f),e.Commands[h]={canUndo:!0,execute:function(a,b,c){return b.cmd=h,m(a,n,b,c)}},e.Commands[i]={canUndo:!0,execute:function(a,b,c){return b.cmd=i,m(a,o,b,c)}},e.Commands[k]={canUndo:!0,execute:function(a,b,c){return b.cmd=k,m(a,p,b,c)}},e.Commands[j]={canUndo:!0,execute:function(a,b,c){return b.cmd=j,m(a,q,b,c)}},e.Commands.$Qa=function(a){var b=e.Ul.sl(),c=!b,d=b;a.register(h,e.Commands[h],221,c,!1,!0,d),a.register(i,e.Commands[i],219,c,!1,!0,d),a.register(j,e.Commands[j]),a.register(k,e.Commands[k])}},"./dist/plugins/outlineColumn/outlineColumn.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/outlineColumn/outlineColumn.js")),d(c("./dist/plugins/outlineColumn/outlineColumn-actions.js")),d(c("./dist/plugins/outlineColumn/outlineColumn.ns.js"))},"./dist/plugins/outlineColumn/outlineColumn.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/outlineColumn/outlineColumn-actions.js"),g=c("./dist/plugins/outlineColumn/outlineColumn.ns.js"),h=e.Common.k,i=h.ac,j=e.Common.A,k=e.Common.B,l=d.GC$.each,m=d.GC$.isEmptyObject,n=e.Common.j.Fa,o=5,p=6,q=6,r=3,s=16,t=16,u=16,v=16,w=void 0,x="number",y=null,z=new e.Common.ResourceManager(g.SR,"OutlineColumn"),A=z.getResource.bind(z),B={columnIndex:w,showCheckBox:!1,showImage:!1,images:w,showIndicator:!0,expandIndicator:w,collapseIndicator:w,maxLevel:10};function H(a){return!(!a.expandIndicator&&!a.collapseIndicator)}function I(a,b){return a&&a.outlineColumn&&a.outlineColumn.options()&&a.outlineColumn.options().columnIndex===b}function J(a,b,c){var d=b.x+c.x,e=c.y+c.height/2-b.height/2,f=b.height,g=b.width;c.x+c.width<d+g||(a.save(),a.beginPath(),a.strokeStyle="black",a.strokeRect(d,e,g,f),a.fillStyle="white",a.fillRect(d,e,g,f),3===b.checkStatus?(a.beginPath(),a.fillStyle="black",a.rect(d+g/5,e+f/5,g-.4*g,f-.4*f),a.fill()):b.checkStatus!==!0&&1!==b.checkStatus||(a.beginPath(),a.lineWidth=g/5,a.moveTo(d+g/6,e+f/2),a.lineTo(d+2*g/5,e+5/7*f),a.lineTo(d+5/6*g,e+f/6),a.stroke()),a.restore())}function K(a,b,c,d){var e=b.collapsed,f=b.x+c.x,g=c.y+c.height/2-b.height/2,h=b.height,i=b.width;c.x+c.width<f+i||(e?b.expandIndicator?L(a,b.expandIndicator,b,c,d):(a.save(),a.fillStyle="black",a.beginPath(),a.moveTo(f,g),a.lineTo(f,g+h),a.lineTo(f+i,g+h/2),a.fill(),a.restore()):b.collapseIndicator?L(a,b.collapseIndicator,b,c,d):(a.save(),a.fillStyle="black",a.beginPath(),a.moveTo(f,g+h),a.lineTo(f+i,g+h),a.lineTo(f+i,g),a.fill(),a.restore()))}function L(a,b,c,d,e){var f,g=c.x+d.x,h=d.y+d.height/2-c.height/2,i=c.width,j=c.height;if(!(d.x+d.width<g+i)&&b&&"none"!==b&&e)try{e.ko(b)?(f=e.lo(b),a.drawImage(f,0,0,f.width,f.height,g,h,i,j)):e.fo(b)}catch(a){}}function M(a,b,c,d){var e={sheet:a,sheetName:a.name(),isRowGroup:!0,index:b,level:c};return d&&(e.cancel=!1),e}function N(a,b,c){var e,f,g=a.options,h=g.isProtected;h&&!g.protectionOptions.allowOutlineRows?a.Os(d.InvalidOperationType.groupProtected,A().Exp_GROUP_PROTECTED):(e=a.rowOutlines.getLevel(b),n(c)&&(c=!a.rowOutlines.getCollapsed(b)),f=M(a,b+1,e+1,!0),a.Wq(d.Events.RangeGroupStateChanging,f),f&&f.cancel===!1&&(a.wu().execute({cmd:"expandRowOutline",sheetName:a.name(),index:b,level:e+1,collapsed:c}),a.Wq(d.Events.RangeGroupStateChanged,M(a,b+1,e+1,!1))))}function O(a,b,c,d){var e,f;n(d)&&(e=a.outlineColumn.getCheckStatus(b),d=typeof e===x?1===e?2:1:!e),f={cmd:"updateOutlineColumnCheckStatus",row:b,col:c,status:d,sheetName:a.name()},a.wu().execute(f)}function P(a,b,c){var d,e,f,g=a.getLevel(b);if(c!==g+1)for(d=c-(g+1),e=0,f=Math.abs(d);e<f;e++)d>0?a.group(b,1):a.ungroupRange(b,1)}function Q(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,q,s=R(c,"showIndicator");s?(h=a.zoom(),i=a.getRowCount(),j=!!a.rowOutlines.isCollapsed(b+1),k=o*h,l=p*h,m=null,n=null,c.expandIndicator&&(m=c.expandIndicator,j&&(k=u*h,l=v*h)),c.collapseIndicator&&(n=c.collapseIndicator,j||(k=u*h,l=v*h)),b<i-1&&(q=a.getActualStyle(b+1,d),q&&q.textIndent>e?g.indicator={x:f.value+r*h,y:-l/2,width:k,height:l,collapsed:j,collapseIndicator:n,expandIndicator:m}:delete g.indicator),f.value+=2*r*h+k):delete g.indicator}function R(a,b){return n(a[b])?B[b]:a[b]}function S(a,b,c){var d,e,f=-1,g=0,h=a.children;for(d=a.start;d<=a.end;d++)if(e=void 0,h&&h[g]&&h[g].start-1===d?(e=S(h[g],b,c),d=h[g].end,g++):e=b[d]&&b[d].checkBox&&b[d].checkBox.checkStatus,f===-1)f=e;else if(f!==e){f=typeof e===x&&typeof f===x&&3;break}for(;g<a.children.length;g++)S(h[g],b,c);return c.updateCheckStatus(a.start-1,f),f}function T(a){var b=a.rowOutlines,c=a.outlineColumn.Kia,d=b.find(0,-1);d.children&&d.children.forEach(function(a){S(a,c.QR,c)})}function U(a,b,c,d,e,f){var g,h,i=n(c.showCheckBox)?B.showCheckBox:c.showCheckBox;i?(g=!n(f.checkBox)&&1!==f.checkBox&&f.checkBox.checkStatus,h=a.zoom(),f.checkBox={x:e.value+r*h,y:-q*h,width:2*q*h,height:2*q*h,checkStatus:g},e.value+=2*r*h+2*q*h):delete f.checkBox}function V(a,b,c,d,e){var f,g,h,i,j,k=n(c.showImage)?B.showImage:c.showImage;k?(f=c.images,g=a.zoom(),f&&f.length&&(h=b>f.length-1?f[f.length-1]:f[b],i=d.value+r*g,j=0,e.images={image:h,x:i,y:j,width:s*g,height:t*g},d.value+=2*r*g+s*g)):delete e.images}function W(a,b,c){var d,e,f,g,h=a.outlineColumn.options(),i=h&&h.columnIndex;if(!n(i))return d={value:0},e=0,f=a.getActualStyle(b,i),f&&f.textIndent&&(e=f.textIndent),0!==b&&(g=a.rowOutlines.getLevel(b-1),e-g>=3&&(e=g+2)),d.value+=8*e,P(a.rowOutlines,b,e),Q(a,b,h,i,e,d,c),U(a,b,h,i,d,c),V(a,e,h,d,c),c.cellContent={left:d.value,x:d.value,y:0,width:-d.value,height:0},c}C=function(){function a(a){this.kj=a,this.YQa={},this.$e=0}return a.prototype.no=function(){var a=this;a.kj=y,a.Kia=y,a.YQa=y},a.prototype.LRa=function(a,b){return this.YQa&&this.YQa.columnIndex===b?this.Kia.QR[a].cellContent.left:null},a.prototype.options=function(a){var b=this,c=b.YQa;return i(arguments)?(b.YQa=a,b.refresh(),b):c},a.prototype.refresh=function(){var a=this.kj;n(this.YQa)||n(this.YQa.columnIndex)||0===this.$e&&(a.suspendPaint(),a.outlineColumn.Kia.updateModel(),a.resumePaint())},a.prototype.setCheckStatus=function(a,b){var c=this.YQa.columnIndex;n(c)||O(this.kj,a,c,b)},a.prototype.Wlb=function(a){this.kj.outlineColumn.Kia.setAllTiemCheckStatus(a),this.refresh()},a.prototype.getCheckStatus=function(a){var b,c;if(i(arguments))return this.kj.outlineColumn.Kia.getCheckStatus(a);for(b=[],c=this.kj.getRowCount(),a=0;a<c;a++)b[a]=this.kj.outlineColumn.Kia.getCheckStatus(a);return b},a.prototype.setCollapsed=function(a,b){N(this.kj,a,b)},a.prototype.getCollapsed=function(a){var b,c;if(i(arguments))return this.kj.outlineColumn.Kia.getCollapsed(a);for(b=[],c=this.kj.getRowCount(),a=0;a<c;a++)b[a]=this.kj.outlineColumn.Kia.getCollapsed(a);return b},a.prototype.reset=function(){if(!n(this.YQa)&&!n(this.YQa.columnIndex)){var a=this.kj;this.YQa=B,a.suspendPaint(),a.outlineColumn.Kia.updateModel(),a.resumePaint()}},a.prototype.XQa=function(a){return this.YQa&&this.YQa.columnIndex===a},a.prototype.ZQa=function(){return this.YQa&&!n(this.YQa.columnIndex)},a.prototype.Lia=function(){this.$e++},a.prototype.Mia=function(){this.$e>0&&this.$e--,0===this.$e&&this.refresh()},a.prototype.Nia=function(a,b){this.kj.outlineColumn.Kia.insertRows(a,b)},a.prototype.STa=function(a,b){this.kj.outlineColumn.Kia.deleteRows(a,b)},a.prototype.Oia=function(){return B},a.prototype.Pia=function(){return{TRIANGLE_HEIGHT:o,TRIANGLE_BASE:p,CHECKBOX_RADIUS:q,GAP:r,IMAGE_WIDTH:s,IMAGE_HEIGHT:t,INDICATOR_IMAGE_WIDTH:u,INDICATOR_IMAGE_HEIGHT:v}},a.prototype.Gka=function(a){var b,c,d=this;for(b in a)a.hasOwnProperty(b)&&(c=d.Kia.QR[b]=d.Kia.QR[b]||{},c.checkBox={checkStatus:a[b].checked})},a.prototype.CXa=function(a,b){var c=this.YQa.columnIndex;n(c)||f.setCheckStatus(this.kj,a,c,b)},a.prototype.WZa=function(){return this.Kia.QR},a}(),b.OutlineColumn=C,D=function(){function a(a){var b=this;b.kj=a,b.QR={}}return a.prototype.no=function(){this.kj=y},a.prototype.updateIndicatorCollapsed=function(a,b){var c=this;n(c.QR[a])||n(c.QR[a].indicator)||(c.QR[a].indicator.collapsed=b)},a.prototype.updateCheckStatus=function(a,b){var c,d=this;d.JVa(a),n(d.QR[a])||(c=d.QR[a].checkBox,c&&(c.checkStatus=b),d.JVa(a,!0))},a.prototype.setAllTiemCheckStatus=function(a){var b,c,d=this,e=d.QR;for(b in e)e.hasOwnProperty(b)&&(c=e[b].checkBox,c&&(c.checkStatus=a))},a.prototype.getCheckStatus=function(a){var b=this;return n(b.QR[a])||n(b.QR[a].checkBox)?null:b.QR[a].checkBox.checkStatus},a.prototype.getCollapsed=function(a){var b=this;return!n(b.QR[a])&&!n(b.QR[a].indicator)&&b.QR[a].indicator.collapsed},a.prototype.updateModel=function(){var a,b,c,d,e,f=this,g=f.kj,h=g.getRowCount();for(g.rowOutlines.direction(0),a=0;a<h;a++)f.QR[a]=f.QR[a]||{},W(g,a,f.QR[a]);b=g.outlineColumn.options(),c=n(b.showCheckBox)?B.showCheckBox:b.showCheckBox,c&&T(g),d=g.ODJ,d&&d.options.allowAddNew&&(e=h-1,delete f.QR[e])},a.prototype.insertRows=function(a,b){var c=this;c.JFc(a,b),c.wEc(a,b)},a.prototype.JFc=function(a,b){var c,d,e,f=this.kj,g=f.outlineColumn.options();n(g)||(c=g.columnIndex,n(c)||(d=f.getActualStyle(a-1,c),e=0,d&&d.textIndent&&(e=d.textIndent),f.getRange(a,c,b,1).textIndent(e)))},a.prototype.wEc=function(a,b){var c,d=this,e=d.QR,f=e[a-1],g=f&&f.checkBox,h=d.kj.getRowCount();for(j(e,h,a,b),c=0;c<b;c++)e[a+c]={checkBox:{checkStatus:g&&g.checkStatus}}},a.prototype.deleteRows=function(a,b){this.xEc(a,b)},a.prototype.xEc=function(a,b){var c=this,d=c.QR,e=c.kj.getRowCount();k(d,e,a-1,b)},a.prototype.KVa=function(a,b){var c,d=this.QR[b];d&&!a[b]&&(c=d.checkBox,a[b]={checked:c&&c.checkStatus})},a.prototype.LVa=function(a){var b,c=this,d=this.QR;for(b in d)d.hasOwnProperty(b)&&c.KVa(a,b)},a.prototype.MVa=function(a){var b,c=this.QR;for(b in a)n(a[b].checked)||(c[b].checkBox.checkStatus=a[b].checked)},a.prototype.NVa=function(a){var b=this.kj.ITa.zTa;return b?(b.outlineColumnChanges||(b.outlineColumnChanges={items:{}}),b.currentOutlineColumnChanges||(b.currentOutlineColumnChanges={items:{}}),a?b.currentOutlineColumnChanges:b.outlineColumnChanges):w},a.prototype.JVa=function(a,b){var c=this,d=c.NVa(b);d&&!d.all&&(n(a)?(d.all=!0,c.LVa(d.items)):c.KVa(d.items,a))},a.prototype.PVa=function(a){this.MVa(a.items)},a}(),d.GC$.extend(d.lUa.prototype,{PVa:function(a){var b=this,c=b.QVa,d=c.Kia;c.ZQa()&&(d.updateModel(),a&&d.PVa(a),b.kj.$p())}}),d.lUa.$n("outlineColumn",{init:function(){var a=this,b=a.kj;a.QVa=new C(b),a.QVa.Kia=new D(b)},applyChanges:function(a){var b,c,d=a.changes,e=a.isUndo;d&&(b=d.outlineColumnOption,b&&this.QVa.options(e?b.oldValue:b.value),c=e?d.outlineColumnChanges:d.currentOutlineColumnChanges,c&&this.PVa(c))},undo:function(a){var b=a.outlineColumnChanges;b&&!a.oldOptions&&this.PVa(b)},dispose:function(a){var b=this,c=a&&a.clearCache;c!==!1&&b.QVa&&(b.QVa.Kia&&(b.QVa.Kia.no(),b.QVa.Kia=y),b.QVa.no(),b.QVa=y)}});function X(a,b){var c,d,e,f,g,h,i;function j(a,b){var c=B[a];return c===b}if(c=a.YQa,d=a.Kia.QR,!n(c)){if(e={},l(B,function(a){f=c[a],n(f)||j(a,f)||(e[a]=f)}),g={},c.showCheckBox)for(h in d)d.hasOwnProperty(h)&&(i=d[h].checkBox.checkStatus,i&&(g[h]={checked:i}));m(g)||(e.data=g),b.outlineColumnOptions=e}}function Y(a,b){var c,d,e;if(b){if(c=b.data,d=void 0,c){d={};for(e in b)"data"!==e&&(d[e]=b[e]);a.Gka(c)}a.options(n(d)?b:d),a.refresh()}}E={init:function(){var a=this;a.outlineColumn=a.ITa.QVa},dispose:function(a){if(a.clearCache!==!1){var b=this,c=b.outlineColumn;c&&(c.no(),b.outlineColumn=y)}},toJson:function(a){X(this.outlineColumn,a)},fromJson:function(a){Y(this.outlineColumn,a.outlineColumnOptions)},bdK:function(a){a.lossless||(a.lossless={}),X(this.outlineColumn,a.lossless)},cdK:function(a){Y(this.outlineColumn,a&&a.lossless&&a.lossless.outlineColumnOptions)},onLayoutChanged:function(a){var b,c,d=this,e=d.outlineColumn,f=a.changeType,g=a.rowCount,h=a.row;if("addRows"===f)e.Kia.JVa(),e.Nia(h,g),e.Kia.JVa(null,!0),e.refresh();else if("deleteRows"===f)e.Kia.JVa(),e.STa(h,g),e.Kia.JVa(null,!0),e.refresh();else if("zoomSheet"===f)e.refresh();else if("invalidateLayout"===f&&e.Kia.QR&&!m(e.Kia.QR)&&d.rowOutlines.items&&!m(d.rowOutlines.items)){b=d.rowOutlines.items;for(c in b)b.hasOwnProperty(c)&&e.Kia.updateIndicatorCollapsed(parseInt(c,10),d.rowOutlines.isCollapsed(parseInt(c,10)+1))}},sortRangeChanged:function(a){for(var b=this.outlineColumn,c=a.column,d=a.columnCount,e=c;b.XQa(e)&&e<=c+d;)b.refresh(),e+=1}},d.Worksheet.$n("outlineColumn",E),F={paintCellPadding:function(a){var b,c=a.options.rect,d=a.options.context.sheet,e=a.options.context,f=e.row,g=e.col,h=a.ctx;I(d,g)&&c.width>0&&c.height>0&&(b=d.outlineColumn.Kia.QR[f],b&&(h.save(),b.indicator&&K(h,b.indicator,c,e.imageLoader),b.checkBox&&J(h,b.checkBox,c),b.images&&L(h,b.images.image,b.images,c,e.imageLoader),h.restore(),b.cellContent&&(c.x+=b.cellContent.left,c.width-=b.cellContent.left)))},getCellPaddingRect:function(a){var b,c=a.options.rect,d=a.options.context.sheet,e=a.options.context,f=e.row,g=e.col;I(d,g)&&c.width>0&&c.height>0&&(b=d.outlineColumn.Kia.QR[f],b&&b.cellContent&&(c.x+=b.cellContent.left,c.width-=b.cellContent.left))},getCellPaddingHitInfo:function(a){var b,c,d,e,f=a.context.sheet,g=a.context.col,h=a.context.row,i=a.x,j=a.y,k=a.cellRect,l=f.outlineColumn;if(a.paddingHitInfo=null,l&&l.YQa){for(b=l.Kia.QR[h],c=l.YQa.columnIndex,k=k.clone();g>c;)g--,k.x-=f.getColumnWidth(g);b&&g===c&&(d=void 0,e=void 0,b.indicator&&(d=b.indicator.x,e=b.indicator.x+k.x,i>=e&&i<e+b.indicator.width&&(a.paddingHitInfo={x:i,y:j,row:h,col:g,outlineColumnHitInfo:{indicator:!0}})),b.checkBox&&(d||(d=b.checkBox.x),e=b.checkBox.x+k.x,i>=e&&i<e+b.checkBox.width&&(a.paddingHitInfo={x:i,y:j,row:h,col:g,outlineColumnHitInfo:{checkBox:!0}})),b.images&&(d||(d=b.images.x),e=b.images.x+k.x,i>=e&&i<e+b.images.width&&(a.paddingHitInfo={x:i,y:j,row:h,col:g,outlineColumnHitInfo:{image:!0}})),d&&i>=k.x&&i<k.x+d&&(a.paddingHitInfo={x:i,y:j,row:h,col:g,outlineColumnHitInfo:{blank:!0}}))}},processMouseDownOnCellPadding:function(a){var b=a.sheet,c=a.row,d=a.col,e=a.outlineColumnHitInfo;n(e)||(e.indicator?N(b,c):e.checkBox?O(b,c,d):e.image||e.blank)},getOutlineColumnOffset:function(a){var b,c=a.context.sheet,d=a.context.col;I(c,d)&&(b=c.outlineColumn.options(),R(b,"showIndicator")&&(a.value+=r,H(b)?a.value+=u:a.value+=o,a.value+=r),R(b,"showCheckBox")&&(a.value+=r,a.value+=2*q,a.value+=r),R(b,"showImage")&&(a.value+=r,a.value+=s,a.value+=r))}},d.CellTypes.Base.$n("outlineColumn",F),G={init:function(){f.commands.$Qa(this.commandManager())},onCultureChanged:function(){A()}},d.Workbook.$n("outlineColumn",G)},"./dist/plugins/outlineColumn/outlineColumn.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/outlineColumn/outlineColumn.res.en.js");b.SR={en:d}},"./dist/plugins/outlineColumn/outlineColumn.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},"./dist/plugins/search/search.entry.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/search/search.js");b.SearchResult=d.SearchResult,b.SearchCondition=d.SearchCondition,b.SearchFlags=d.SearchFlags,b.SearchOrder=d.SearchOrder,b.SearchFoundFlags=d.SearchFoundFlags},"./dist/plugins/search/search.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("@grapecity/js-calc"),g=!!f,h=e.Common.q,i=null,j=Math.max,k="string";function q(a,b,c){if(!a)return!1;if(a=""+a,b=""+b,0===c)return a.indexOf(b)>-1;var d=(2&c)>0,e=(1&c)>0,f=(4&c)>0,g;return f?(g=d?h.zb(b,!1,!0):h.ub(b),b=g?g:b,g=e?h.sb(b):h.qb(b),g.test(a)):(e&&(b=b.toLowerCase(),a=a.toLowerCase()),d?b===a:a.indexOf(b)>=0)}function r(a,b,c,d,e,f,g,h){var j=i,k=a+1,l=b+1;return 0===c?l>=0&&l<=h?j={r:a,c:l}:k>=0&&k<=f&&(j={r:k,c:d?g:0}):k<=f?j={r:k,c:b}:l<=h&&(j={r:d?e:0,c:l}),j}d.Worksheet.prototype.search=function(a){var b,c,e,f,h,l,n,o,p,s,t,u,v,w,x,y,z,A,B,C;if(!a)return i;if(b=this,c=a.sheetArea,e=a.searchString,f=a.searchTarget,h=a.searchFlags,l=b.getRowCount(c),n=b.getColumnCount(c),o=new m,!e||0===f||l<=0&&n<=0)return o;for(p=j(0,a.rowStart),s=j(0,a.columnStart),t=a.rowEnd,u=a.columnEnd,v=(8&h)>0,(t<0||!v)&&(t=l-1),(u<0||!v)&&(u=n-1),w=a.findBeginRow,x=a.findBeginColumn,y=w<0?p:w,z=x<0?s:x;y>=0&&z>=0;){if(A=b.getCell(y,z,c),B=void 0,(1&f)>0&&(B=a.callback?a.callback(A,b):A.text(),""!==B&&q(B,e,h)&&(o.searchFoundFlag|=1,o.foundString=B)),g&&(8&f)>0&&(B=d.util.EgK(b,y,z),typeof B===k&&""!==B&&q(B,e,h)&&(o.searchFoundFlag|=8,o.foundString=B)),(4&f)>0&&(B=A.tag(),typeof B===k&&""!==B&&q(B,e,h)&&(o.searchFoundFlag|=4,o.foundString=B)),0!==o.searchFoundFlag)return o.foundRowIndex=y,o.foundColumnIndex=z,o;if(C=r(y,z,a.searchOrder,v,p,t,s,u),!C)break;y=C.r,z=C.c}return o},d.Workbook.prototype.search=function(a){var b,c,e,f,g,h,j,k,l;if(!a)return i;if(b=this,c=0,e=b.getSheetCount(),f=new m,!a.searchString||a.searchTarget===c||e<=0)return f;if(a.startSheetIndex===-1&&(a.startSheetIndex=0),a.endSheetIndex===-1&&(a.endSheetIndex=e-1),k=a.startSheetIndex,l=a.endSheetIndex,l>=k&&0<=k&&k<e&&0<=l&&l<e)for(g=k;g<=l;g++)if(h=b.getSheet(g),h.visible()===d.SheetTabVisible.visible&&(j=h.search(a),j&&j.searchFoundFlag!==c))return j.foundSheetIndex=g,j;return f},l=function(){function a(){this.startSheetIndex=-1,this.endSheetIndex=-1,this.searchString=i,this.searchFlags=0,this.searchOrder=0,this.searchTarget=1,this.sheetArea=3,this.rowStart=-1,this.columnStart=-1,this.rowEnd=-1,this.columnEnd=-1,this.findBeginRow=-1,this.findBeginColumn=-1}return a}(),b.SearchCondition=l,m=function(){function a(){this.foundColumnIndex=-1,this.foundRowIndex=-1,this.searchFoundFlag=0,this.foundSheetIndex=-1,this.foundString=i}return a}(),b.SearchResult=m,function(a){a[a.none=0]="none",a[a.ignoreCase=1]="ignoreCase",a[a.exactMatch=2]="exactMatch",a[a.useWildCards=4]="useWildCards",a[a.blockRange=8]="blockRange"}(n=b.SearchFlags||(b.SearchFlags={})),function(a){a[a.zOrder=0]="zOrder",a[a.nOrder=1]="nOrder"}(o=b.SearchOrder||(b.SearchOrder={})),function(a){a[a.none=0]="none",a[a.cellText=1]="cellText",a[a.cellTag=4]="cellTag",a[a.cellFormula=8]="cellFormula"}(p=b.SearchFoundFlags||(b.SearchFoundFlags={}))},"./dist/plugins/sheetsCalc/calc-extra-save.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-calc"),e=c("./dist/plugins/sheetsCalc/parser-sheets.js"),f=null,g=void 0,h=1,i=2,j=4,k=8,l=16,m=32,n=64;function o(a){var b,c,d,e;if(Array.from)return Array.from(a.keys());for(b=[],c=0,d=a.keys();c<d.length;c++)e=d[c],b.push(e);return b}function p(a,b,c){var e,f=function(e){var f,g,h,i,j=b[e];if(j.l)for(f=q(j.k),g=a.qg(f[1],f[2],!0),j.v&&a.bg(g),j.b,g.Ze=j.l.map(function(a){return parseInt(a,10)}),h=function(a){var b=j.l[a];g[b]=d.createMap(),j[b].map(function(a){var d,e=q(a),f=e[0];"?"!==f[0]&&"!"!==f[0]||(f=f.slice(1)),d=c[f],g[b].set(a,d.qg(e[1],e[2],!0))})},i=0;i<j.l.length;i++)h(i)};for(e=0;e<b.length;e++)f(e)}b.IiK=p;function q(a){return a.split(",").map(function(a,b){return b>0&&(a=parseInt(a,10)),a})}function r(a,b,c){var d,e,f,g,h,i,j,k,l,m=a.ug(!0);for(d in b.l)if(b.l.hasOwnProperty(d)){e=b[d];for(f in e)if(e.hasOwnProperty(f))for(g=f.split(",").map(function(a,b){return"?"!==a[0]&&"!"!==a[0]||(a=a.slice(1)),parseInt(a,10)}),h=0;h<e[f].length;h++)i=q(e[f][h]),j=i[0],"?"!==j[0]&&"!"!==j[0]||(j=j.slice(1)),k=c[j],l=k.qg(i[1],i[2],!0),m.processListener(parseInt(d,10),g[0],g[1],g[2],g[3],l,!0)}}b.hhK=r;function s(a){var b,c=null;return(a.isVolatile||a.YDc||a.Ze&&a.Ze.length>0)&&(c={},c.k=a.getKey(),a.isVolatile&&(c.v=!0),a.YDc&&(c.b=!0),a.Ze&&a[0]&&(b="0",c[b]=o(a[b]),c.l=a.Ze)),c}function t(a){var b,c,d,e,f,g,h=[],i=a.dataTable;for(d in i)if(i.hasOwnProperty(d)&&(e=i[d]))for(c in e)e.hasOwnProperty(c)&&(b=e[c],b&&(f=s(b.calc),f&&h.push(f)));return g=u(a),g&&h.push(g),h}b.JiK=t;function u(a){var b,c,d,e,f=a.ug();if(f)return b={k:"rangeCalc"},c="0",d=f[c],e={},d&&d.forEach(function(a,b){e[b]=o(a.content)}),b[c]=e,b.l=f.Ze,b}function v(a,b){var c,d,e,f,g,h={};if(b&&b.idMap){c=a.jh,d={};for(e in c)c.hasOwnProperty(e)&&(d[c[e].getSource().getName()]=c[e]);f=b.idMap;for(e in f)f.hasOwnProperty(e)&&(g=f[e],h[e]=d[g])}return h}b.jhK=v;function w(a){var b,c=a.jh,d={};for(b in c)c.hasOwnProperty(b)&&(d[b]=c[b].getSource().getName());return d}b.khK=w;function x(a,b){return y(a,b)}b.exprFromJSON=x;function y(a,b){var c,f,g,o,p,q,r=a.t;if(4===r||2===r||3===r||8===r||100===r)return f=new d.Expression(r),f.value=a.v,f;if(5===r)f=new d.Expression(5),f.value=d.CalcError.riK(a.v);else if(6===r)f=new d.Expression(6),f.value=new d.CalcArray(a.v);else if(9===r)f=d.Kh(a.o,y(a.v,b),a.w&&y(a.w,b));else if(10===r)f=new d.Expression(10),f.value=y(a.v,b);else if(11===r)f=new d.Expression(11);else if(7===r)for(f=new d.Expression(7),a.f&&(f.function=y(a,b)),a.n&&(f.function=b.getFunction(a.n),f.functionName=a.n),g=f.arguments=[],o=0;o<a.p.length;o++)a.p[o]&&(g[o]=y(a.p[o],b));else 1===r?(f=new d.ReferenceExpression(1),p=a.v.split("*"),p[0]&&(f.source=b.getExternalSource("",p[0])),p[1]&&(f.endSource=b.getExternalSource("",p[1])),p[2]&&(f.row=parseInt(p[2],10)),p[3]&&(f.column=parseInt(p[3],10)),p[4]&&(f.endRow=parseInt(p[4],10)),p[5]&&(f.endColumn=parseInt(p[5],10)),q=parseInt(p[6],10),f.rowRelative=!!(q&h),f.columnRelative=!!(q&i),f.endRowRelative=!!(q&j),f.endColumnRelative=!!(q&k),f.isFullRow=!!(q&l),f.isFullColumn=!!(q&m),f.isArrayReference=!!(q&n),f.isFullRow&&(f.column=f.endColumn=d.BAND_INDEX_CONST),f.isFullColumn&&(f.row=f.endRow=d.BAND_INDEX_CONST)):13===r?(f=new e.xzb,c=a.v,f.lj=c[0],f.source=c[1],f.P$J=c[2],f.xj=c[3],f.oj=c[4],f.pj=c[5],f.rj=c[6],f.qj=c[7],f.source=b.getExternalSource("",f.source),f.lj=b.getTableByName(f.lj)):22===f.type;return a.es&&(f.ensureSingle=!0),f}function z(a){return A(a)}b.exprToJSON=z;function A(a){var b,c,e,g;if(!a)return a;if(b={t:a.type},a.ensureSingle&&(b.es=1),4===a.type||2===a.type||3===a.type||8===a.type||100===a.type)b.v=a.value;else if(5===a.type)b.v=a.value._code;else if(6===a.type)b.v=a.value.array;else if(9===a.type)b.o=a.operatorType,b.v=A(a.value),b.w=a.value2&&A(a.value2);else if(10===a.type)b.v=A(a.value);else if(7===a.type)for(d.isExpression(a.function)?b.f=A(a.function):a.functionName&&(b.n=a.functionName),b.p=[],c=0;c<a.arguments.length;c++)b.p[c]=A(a.arguments[c]);else 1===a.type?(e=(a.rowRelative&&h)|(a.columnRelative&&i)|(a.endRowRelative&&j)|(a.endColumnRelative&&k)|(a.isFullRow&&l)|(a.isFullColumn&&m)|(a.isArrayReference&&n),g=[a.source&&a.source.getName(),a.endSource&&a.endSource.getName(),a.row,a.column,a.endRow,a.endColumn,e],a.isFullRow&&(g[3]=g[5]=f),a.isFullColumn&&(g[2]=g[4]=f),b.v=g.join("*")):13===a.type?b.v=[a.lj.name(),a.source.getName(),a.P$J,a.xj,a.oj,a.pj,a.rj,a.qj]:22===a.type;return b}},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){
a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Core"),f=c("Common"),g=c("./dist/plugins/sheetsCalc/parser-sheets.js"),h=c("@grapecity/js-calc"),i=c("./dist/plugins/sheetsCalc/calc.ns.js"),j=c("./dist/plugins/sheetsCalc/calc-extra-save.js"),k=f.Common.j,l=f.Common.u,m=k.Ia,n=k.za,o=null,p=void 0,q=["v","n","s","b","d","sn"],r=h.Errors.Value,s=f.Formatter&&f.Formatter.GeneralFormatter,t=h.Convert.vf,u=k.Fa,v=d.Ul.JcK,w=d.range_parser.EcK,x=d.Ul.naa,y=d.Util.addXLFNPrefix,z="=",A=function(a){return h.Convert.Na(a,!0)},B=d.Range.prototype.contains,C=l.Nb,D="number";function P(a){var b="_xlfn.";return a&&"string"==typeof a&&a.toLowerCase().indexOf(b)>=0?a.replace(/_xlfn\.|_xlws\./gi,""):a}b.processFunctionPrefix=P;function Q(a){if(a)return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}b.encodeNameFormula=Q,E=h.CalcSource.prototype,E.referenceToArray=function(a,b,c,d,e,f,g,i){var j,k,l,m,n,q,s,t,u,v,w,x,y=this,z=1,A=1,B=[],C=a.getRangeCount();if(0===C)return B.isError=!0,B;for(s=y.getRowCount(),t=y.getColumnCount(),c=c===p||c,u=0;u<C;u++){if(c||(q=[],B.push(q)),z=a.getRowCount(u),0===z)return B.isError=!0,B;if(A=a.getColumnCount(u),0===A)return B.isError=!0,B;if(l=a.getRow(u),m=a.getColumn(u),2!==c){if(l>=s||m>=t)return B=[o],B.rowCount=1,B.colCount=1,B.rangeCount=1,B;m+A>t&&(A=t-m)}for(l+z>s&&(z=s-l),v=void 0,w=0;w<z;w++)for(j=l+w,c||(v=[],q.push(v)),x=0;x<A;x++){if(k=m+x,n=y.getValue(j,k),d&&h.Convert.vf(n))return B=[n],B.isError=!0,B;if(n=h.Convert.wf(n,b,!h.ExcelCompatibleCalcMode,f,i),e&&n===h.Convert.CalcConvertedError)return B=[r],B.isConvertError=!0,B;n===o&&f||(2===c?B[w*A+x]=n:c?B.push(n):v.push(n))}}return c||1!==C||(B=B[0]),B.rowCount=z,B.colCount=A,B.rangeCount=C,B},E.getSheetReference=function(){var a=this;return a.Df=a.Df||new h.CalcReference(a),a.Df},function(a){a[a.a1=0]="a1",a[a.r1c1=1]="r1c1"}(F=b.ReferenceStyle||(b.ReferenceStyle={})),e.ReferenceStyle=F,G=function(){function a(a,b,c,d,e){var f=this;f.Cj=a,f.Uu=c,f.Vu=d,f.Lf=b,u(e)||(f.kT=e)}return a.prototype.getName=function(){return this.Cj},a.prototype.getRow=function(){return this.Uu},a.prototype.getColumn=function(){return this.Vu},a.prototype.getExpression=function(){return this.Lf},a.prototype.getComment=function(){return this.kT},a.prototype.fg=function(a,b){b&&b.push({type:"customName",nameInfo:this,expr:this.Lf}),this.Lf=a},a}(),b.NameInfo=G,e.NameInfo=G,H=function(a){O(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,e,f,g,h)||this,j=i;return j.nBJ=c,j.H4J=d,i}return b.prototype.getFormatter=function(){return this.nBJ},b.prototype.getSheetTabName=function(){return this.H4J},b}(G),b.FormatterNameInfo=H,h.CalcSource.prototype.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},I=function(a){O(b,a);function b(b){var c=a.call(this,o)||this;return c.references=b,c}return b.prototype.toArray=function(a,b,c,d,e){var f,g,h=this.references,i=[];for(f=0;f<h.length;f++){if(g=h[f].xf.referenceToArray(h[f],a,b,c,d,e),g.isError&&c)return g;b?Array.prototype.push.apply(i,g):i.push(g[0]),f||(i.rowCount=g.rowCount,i.colCount=g.colCount)}return i.rangeCount=h.length,i},b}(h.CalcReference),b.SheetRangeReference=I,J=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function R(a){var b,c,d,e,f,g;if(a<0)return"";if(b=J[a])return b;for(c=a,d="",e=d.length,a+=1;a>0;a=Math.floor((a-1)/26))f=d.substring(0,e),g=d.substring(e),d=f+String.fromCharCode(65+(a-1)%26)+g;return b=""+d,J[c]=b,b}K=function(a){O(b,a);function b(c,e,f,h){var i,j,k,l;for(void 0===h&&(h={}),i=a.call(this,c&&c.yj(h.sheetArea),e,f,h)||this,c||(c=b.CUJ=b.CUJ||new d.Worksheet,i.source||(i.source=c.yj(h.sheetArea))),i.kj=c,i.row=f&&f.row||0,i.column=f&&f.col||0,j=c.getCalcService(),k=j.getResolvers(),l=0;l<k.length;l++)if(k[l]instanceof g.SheetReferenceResolver)return i;return j.addResolver(new g.SheetReferenceResolver(c)),j.addResolver(new g.StructureReferenceResolver(c)),i}return b.prototype.getExternalSource=function(a,b){var c,d,e,f=this,g=f.kj.parent,i=f.kj.yj();if(a&&(!g||g.name!==a))return o;if(!g)return l.Mb(f.kj.name(),b)?i:o;if(Z(b))return g.G$J.parseSource(b,i.q$a);if(c=g.sheets,c&&c.length>0)for(d=0;d<c.length;d++)if(e=c[d],l.Mb(e.name(),b))return e.yj();return h.ParserContext.prototype.getExternalSource.call(this,a,b)},b.prototype.getExternalSourceToken=function(a){return a.getName(this)},b.prototype.getTableByName=function(a){var b,c,d=this.kj.tables,e=!0,f=d?d.g9J(a,e):o;if(!f&&(b=this.kj.parent&&this.kj.parent.sheets))for(c=0;c<b.length&&(d=b[c].tables,!d||!(f=d.g9J(a,e)));c++);return f?f:this.kj.parent&&this.kj.parent.getSheetTab(a)},b.prototype.getTableByIndex=function(a,b){var c=this.kj.tables;return c?c.RS(a,b,!0):o},b.prototype.setSource=function(a){this.source=a;var b=a;b&&b.getSheet&&(this.kj=b.getSheet())},b.prototype.no=function(){this.kj&&this.kj!==b.CUJ&&this.kj.no(),this.kj=o},b}(h.ParserContext),b.SheetParserContext=K,L=new f.Common.ResourceManager(d.SR);function S(a){if(a.indexOf("LET(")>-1)return"LET"}M=function(a){O(b,a);function b(c,d){var e=a.call(this,o)||this;return e.getCalcSourceModel=function(){return this.Bf},e.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},e.getRangeKey=function(a,b){return a.id+","+b.row+","+b.col+","+b.rowCount+","+b.colCount},e.getSheetRangeReference=function(a){var c,d,e,f,g,h=this.kj,i=h&&h.parent;if(a.endSource&&i&&i.sheets&&a.endSource instanceof b){for(c=i.sheets,d=!1,e=void 0,f=[],g=0;g<c.length;g++){if(e=c[g].yj(),e===this)d=!0;else if(e===a.endSource){f.push(e.getReference(a));break}d&&f.push(e.getReference(a))}return new I(f)}},e.kj=c,e.Wz=d?d:3,e}return b.prototype.getReferenceSheetNames=function(){return this.BeK||{}},b.prototype.addReferenceSheetName=function(a){var b=this;b.BeK||(b.BeK={}),b.BeK[a]=1},b.prototype.setReferenceSheetNames=function(a){this.BeK=a},b.prototype.startCalculation=function(){this.Hu||(this.QLb(),this.Iu=[])},b.prototype.endCalculation=function(){this.Hu=o,this.GkK=o,this.LIc(),this.Iu=o;var a=this.Bf.ug(!1);a&&a.clearListenersCache(),this.Af.calcOnDemand&&this.kj.repaint()},b.prototype.yBJ=function(){var a=this;a.zBJ?a.Iu&&(a.ABJ=a.ABJ.concat(a.Iu),a.Iu=[]):(a.ABJ=a.Iu||[],a.zBJ=setTimeout(function(){a.LIc(a.ABJ),delete a.ABJ,delete a.zBJ},0))},b.prototype.LIc=function(a){var b,c,e=a||this.Iu;e&&e.length>0&&(b=this.kj,c=b.ITa.XTa(3).Ap,b.Wq(d.Events.RangeChanged,{isUndo:!u(c&&c.JPJ),sheet:b,sheetName:b.name(),row:0,col:0,rowCount:b.getRowCount(),colCount:b.getColumnCount(),changedCells:e,action:6},b.vxb))},b.prototype.clearValueCache=function(){this.QLb()},b.prototype.QLb=function(){var a=this.getRowCount(),b=this.getColumnCount();this.Hu={rowCount:a,colCount:b},this.GkK={arrayInfo:[]}},b.prototype.wcc=function(){this.Hu=o,this.GkK=o,this.Iu=o},b.prototype.getValue=function(a,b){var c,e,f,g,i,j,k,l,m,n,s,t,u,v=[];for(c=2;c<arguments.length;c++)v[c-2]=arguments[c];if(e=this,f=e.kj,typeof a===D)g=arguments[0],i=arguments[1],b=arguments[2];else if(a=a,a.row!==p)g=a.row,i=a.col;else if(a.name)return null;return j=e.Wz,b=b||0,g<0||i<0?r:f.Ju&&f.Ku===g&&f.Lu===i?f.Mu:(k=e.Hu,l=q[b],k?(m=k.rowCount,n=k.colCount,s=void 0,t=void 0,u=void 0,g>=m?o:i>=n?o:(s=k[g],s||(s=k[g]={}),t=s[i],t||(t=s[i]={v:f.getValue(g,i,j)}),u=t[l],u===p&&(u=h.Convert.wf(t.v,b,!h.ExcelCompatibleCalcMode),t[l]=u),u=d.Ul.w0a(u))):g>=e.getRowCount()?o:i>=e.getColumnCount()?o:e.kj.getValue(g,i,j))},b.prototype.getIdentity=function(a,b){var c=this,d=b.row,e=b.rowCount||1,f=b.column,g=b.columnCount||1;return d===-1&&(d=0,e=c.getRowCount()),f===-1&&(f=0,g=c.getColumnCount()),c.getName()+"."+d+"."+e+"."+f+"."+g},b.prototype.getReference=function(a){var b=this,c=a.row,d=a.col;return c===-1&&(a.row=0,a.rowCount=b.getRowCount(),a.rowUndefine=!0),d===-1&&(a.col=0,a.colCount=b.getColumnCount(),a.colUndefine=!0),new h.CalcReference(b,[a])},b.prototype.getSources=function(a){var c,d,e,f,g;if(this.kj&&this.kj.parent&&this.kj.parent.sheets&&a instanceof b){for(c=this.kj.parent.sheets,d=!1,e=void 0,f=[],g=0;g<c.length;g++){if(e=c[g].yj(),e===this&&(d=!0),e===a){f.push(e);break}d&&f.push(e)}return f}},b.prototype.Ppb=function(a,b){var c,d=this,e=d.GkK,f=e&&e.arrayInfo;f&&(c=!1,f.forEach(function(d,g){if(d){var h=d.reference,i=d.key;B.call(h.yf[0],a,b)&&(delete e[i],f[g]=p,c=!0)}}),c&&(e.arrayInfo=[],f.forEach(function(a){a&&e.arrayInfo.push(a)})))},b.prototype.referenceToArray=function(a,b,c,d,e,f,g,i){var j,l,m,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q;if(b=b||0,j=this,t=1,u=1,y=[],B=j.kj,C=j.Hu,D=j.GkK,G=q[b],x=a.getRangeCount(),0===x)return y.isError=!0,y;if(D&&(F=a.getRangeCount()+"_"+a.getRow(0)+"_"+a.getColumn(0)+"_"+a.getRowCount(0)+"_"+a.getColumnCount(0)+"_"+b+"_"+c,z=D[F]))return z;for(H=this.getRowCount(),I=this.getColumnCount(),c=c===p||c,J=0;J<x;J++){if(c||(A=[],y.push(A)),t=a.getRowCount(J),0===t)return y.isError=!0,y;if(u=a.getColumnCount(J),0===u)return y.isError=!0,y;if(v=a.getRow(J),w=a.getColumn(J),2!==c){if(v>=H||w>=I)return y=c?[o]:[[o]],y.rowCount=1,y.colCount=1,y.rangeCount=1,y;w+u>I&&(u=I-w)}for(v+t>H&&(t=H-v),K=void 0,L=void 0,M=B.Ju,N=0;N<t;N++)for(l=v+N,c||(K=[],A.push(K)),C&&(C[l]||(C[l]={}),E=C[l]),O=0;O<u;O++){if(m=w+O,M&&B.Ku===l&&B.Lu===m)z=B.Mu,M=!1;else{if(C?(L=E[m],L?z=L.v:(z=B.getValue(l,m,j.Wz),L=E[m]={v:z})):z=B.getValue(l,m,j.Wz),g&&(P=B.getFormatter(),Q=void 0,Q=P instanceof s?P.formatString():P,"@"===Q?z=B.getText(l,m):z instanceof Date&&(z=k.Pa(z)),n(L)||(L=E[m]={v:z})),d&&h.Convert.vf(z))return y=[z],y.isError=!0,y;if(L&&L[G]!==p)z=L[G];else if(z=h.Convert.wf(z,b,!h.ExcelCompatibleCalcMode,f,i),L&&(L[G]=z),e&&L===z)return y=[r],y.isConvertError=!0,y}h.Convert.j$a(z,f)||(2===c?y[N*u+O]=z:c?y.push(z):K.push(z))}}return c||1!==x||(y=y[0]),y.rowCount=t,y.colCount=u,y.rangeCount=x,D&&(a.HkK&&D.arrayInfo.length<200||!isNaN(x)&&!isNaN(t)&&!isNaN(u)&&x*t*u>100&&x*t*u<1e6&&D.arrayInfo.length<50)&&(D[F]=y,D[F].rowCount=t,D[F].colCount=u,D[F].rangeCount=x,D.arrayInfo.push({reference:a,key:F})),y},b.prototype.getColumnCount=function(){var a=this.kj;return a.Js?0:a.getColumnCount(this.Wz)},b.prototype.getRowCount=function(){var a=this.kj;return a.Js?0:a.getRowCount(this.Wz)},b.prototype.isHiddenRow=function(a,b){var c=this.kj,d=c.Nu&&c.Nu();return!(!d&&b)&&0===c.getRowHeight(a)},b.prototype.getName=function(){var a=this.Wz,b=u(this.WOJ)?this.kj.name():this.WOJ;return a===d.SheetArea.colHeader?b+"CH":a===d.SheetArea.rowHeader?b+"RH":b},b.prototype.RLb=function(){var a=this,b=a.bIb;return b||(b=a.bIb=a.kj.ITa.bIb),b},b.prototype.setArray=function(a,b,c,d,e){return this.RLb().setArray(this,a,b,c,d,e)},b.prototype.updateItem=function(a,b,c){return this.RLb().updateItem(this,a,b,c)},b.prototype.LIb=function(a,b){this.RLb().LIb(a,b)},b.prototype.MIb=function(){this.RLb().MIb()},b.prototype.setValue=function(a){var b,c,e,f,g,h,i,j,k,l,n,o,q,r,s,t,v,w,x,y,z,A,B,C,D,E,F,G,H=[];for(b=1;b<arguments.length;b++)H[b-1]=arguments[b];if(c=this,e=c.kj,h=c.Wz,a=a,a.row!==p)f=a.row,g=a.col,i=1;else{if(a.name)return;f=arguments[0],g=arguments[1],i=2}j=arguments[i],k=arguments[i+1],l=c.Hu,l&&(n=l[f],n&&(o=n[g],o&&(o.v=j,o.b!==p&&(o.b=p),o.d!==p&&(o.d=p),o.n!==p&&(o.n=p),o.s!==p&&(o.s=p),o.sn=p))),q=d.Ul.x0a(j),r=e.ITa,s=!1,t=e.tables,v=t&&t.find(f,g),3===h&&v&&(w=v.showHeader()&&f===v.headerIndex(),x=v.showFooter()&&f===v.footerIndex(),w||x||(s=v.yq(f,g,q))),y=e.wq,3===h&&!s&&y&&y._dataSource&&(z=y.getValue(f,g),A=!1,z.hasBinding&&(B=void 0,l?(C=l.bindingRows=l.bindingRows||{},B=C[f],B||(B=C[f]=m({},e.getDataItem(f)))):B=m({},e.getDataItem(f)),r.Cp(f,g,{Dp:B,Ep:z.value}),A=y.setValue(f,g,q,r.zTa)),s="dataManagerBindingSource"===y.CL?A:z.hasBinding),D=e.pivotTables,3===h&&!s&&D&&(s=D.jmK(f,g,q)),s||(E="__hyperlink__",!u(q)&&q[E]&&(F=q[E],G={url:F},r.setHyperlink&&r.do("setHyperlink",f,g,G),q=""+q),r.do("setValue",f,g,q,h,!0,!0,arguments[i+2],!0,!0)),e.jCJ=!0,this.Iu?this.Iu.push({row:f,col:g,sheetArea:h}):e.Wq(d.Events.CellChanged,{sheet:e,sheetName:e.name(),row:f,col:g,sheetArea:h,propertyName:"value",oldValue:k,newValue:j,klK:!0})},b.prototype.getCustomFunction=function(a){return this.kj?this.kj.Pu(a):o},b.prototype.getCustomName=function(a){var b=this.getCustomNameInfo(a);return b?b.getExpression():o},b.prototype.getCustomNameInfo=function(a){return a=C(a),this.kj?this.kj.getCustomName(a):o},b.prototype.getSheet=function(){return this.kj},b.prototype.setFormula=function(a,b,c,d,e){var f,g,h,i,j=this;if(j.kj.ITa.zTa&&(g=j.kj.ITa.zTa.formulas,g||(g=j.kj.ITa.zTa.formulas={}),a>=-1&&b>=-1))if(h=j.getCalcService(),h.backupR1C1Formula&&(i=j.Bf.Kf(a,b),c=U(j.kj,i,a,b,!0,!1)),!d&&h.allowDynamicArray&&(d=j.Bf.Qf(a,b)),f=g[a],f||(f=g[a]={}),c&&"="===c[0]&&(c=c.substring(1)),e){if(f[b]&&f[b].oldFormula)return;d=m({},d),f[b]=m({},f[b],{oldFormula:c,oldArrayInfo:d}),c||delete f[b].oldArrayInfo}else f[b]=m({},f[b],{formula:c,arrayInfo:d}),c||delete f[b].arrayInfo},b.prototype.setArrayFormula=function(a,b,c,d,e){var f={row:a,col:b,rowCount:c,colCount:d};this.setFormula(a,b,e,f)},b.prototype.setFormulaByName=function(a,b,c){var d,e,f=this;f.kj.ITa.zTa&&(d=f.kj.ITa.zTa.formulas,d||(d=f.kj.ITa.zTa.formulas={}),e=d.names,e||(e=d.names={}),e[a]=m({},e[a],{formula:b,oldFormula:c}))},b.prototype.refresh=function(){this.kj.repaint()},b.prototype.toJSON=function(a,b,c,d,e){var f,g,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=b,D=this.kj,E=a.data||{},F=!0,G=this.Cf(),H=this===D.ft,I=0;for(H&&(l=h.createMap(),m={},D.Q5J=H&&m),o=G.forceR1C1Formula,p=0;p<=c;p++)if(f=E.dataTable||{},g=C[p]){for(j=f[p],F=!j,j=j||{},q=0;q<=d;q++)if(i=g[q],r=i&&i.Lf,i&&(r||i.H$J)){k=j[q]||{};try{s=void 0,t=void 0,H&&r&&!i.Pf&&(u=r.R5J=r.R5J||U(D,r,p,q,!0,!1),u.indexOf("!")<0&&(v=l.get(u),!v||v.baseColumn>q?(t=G.unparse(this,i.Lf,p,q,!1,!0),t.indexOf("[")<0&&(o&&(t=u),l.set(u,{formula:t,baseRow:p,baseColumn:q}))):(s=v.obj,s?(w=m[s.si],w.lastRow=p,w.lastColumn=Math.max(q,w.lastColumn)):(s=v.obj={si:I},m[I]={formula:v.formula,baseRow:v.baseRow,baseColumn:v.baseColumn,lastRow:p,lastColumn:q},f[v.baseRow][v.baseColumn].formula=v.obj,I++)))),t=o&&r?s||r.R5J||U(D,r,p,q,!0,!1):i.H$J||s||t||G.unparse(this,r,p,q,!1,!0),i.Pf?i.Pf.row===p&&i.Pf.col===q&&(k.arrayInfo=i.Pf,k.formula=t):k.formula=t,F=!1,j[q]=k}catch(a){}}if(F){if(f!==E.dataTable)continue}else f[p]=j;E.dataTable=f}if(m&&(m.nextIndex=I),e){for(x=E.columnDataArray||[],y=0;y<e.length;y++)z=e[y],z&&z.Lf&&(A=this.Cf().unparse(this,z.Lf,0,y,!1,!0),B=x[y]||{},B.formula=A,x[y]=B);x.length>0&&(E.columnDataArray=x)}n(E)||(a.data=E)},b.prototype.bdK=function(a,b,c,e,f,g){var i,k,l,m,n,o,p,q,r,s,t,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R=v(a,d.XFileConstants.HbK),S=this.Cf();for(S.uMc=!0,o=this.kj,p=this===o.ft,s=0,p&&(q=h.createMap(),r={},o.Q5J=p&&r),t=a.lossless.exprs=[],z=0;z<=c;z++)if(i=b[z],l=R[z],i)for(l||(l=R[z]={}),A=0;A<=e;A++)if(k=i[A],m=l[A],B=k&&k.Lf,k&&B){n=!0,m||(m={});try{C=void 0,D=void 0,E=void 0,F=-1,G=k.Pf,G||(H=o.ITa.bIb.anchors,H[z]&&H[z][A]&&(I=H[z][A],G={row:z,rowCount:I.rowCount,col:A,colCount:I.colCount,isDynamicArray:!0},I.isValid||(G.isInvalid=!0))),p&&B&&!G&&(J=B.R5J=B.R5J||U(o,B,z,A,!0,!1),K=d.Util.KlK(g),(K||J.indexOf("!")<0)&&(L=q.get(J),!L||L.baseColumn>A?(D=S.unparse(this,k.Lf,z,A,!1,!0),(K||D.indexOf("[")<0)&&q.set(J,{formula:D,baseRow:z,baseColumn:A})):(C=L.obj,C?(M=r[C.si],M.lastRow=z,M.lastColumn=Math.max(A,M.lastColumn)):(C=L.obj={si:s},r[s]={formula:L.formula,baseRow:L.baseRow,baseColumn:L.baseColumn,lastRow:z,lastColumn:A},s++),E=C.si,D=void 0))),u(E)&&(D=k.H$J||D||S.unparse(this,B,z,A,!1,!0),g&&g.includeCalcModelCache&&(N=j.exprToJSON(B),k.Nf||(N.nw=1),t.push(N),F=t.length-1),D=x(y(D))),G?(G.row===z&&G.col===A&&(O=w(G),(G.isInvalid||!G.rowCount)&&O.indexOf(":")>0&&(O=O.substring(0,O.indexOf(":"))),m.f=D,m.r=O),G.isDynamicArray&&(m.a=1)):(m.f=D,m.d="shared",m.g=E,m.c=1),F!==-1&&(m.e=F)}catch(a){}l[A]=m}for(P in r)Object.prototype.hasOwnProperty.call(r,P)&&(Q=r[P],O=w(new d.Range(Q.baseRow,Q.baseColumn,Q.lastRow-Q.baseRow+1,Q.lastColumn-Q.baseColumn+1)),m=R[Q.baseRow][Q.baseColumn],m.r=O,m.g=parseInt(P,10));delete S.uMc},b}(h.CalcSource),b.SheetSource=M,M.prototype.getParserContext=function(a,b,c){return b=b||h.pf(0,0),new K(this.kj,a,b,c)},N=function(a){O(b,a);function b(b){var c=a.call(this,o)||this;return c.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},c.Qu=b,c.RlK={},c}return b.prototype.addUsedCustomName=function(a){this.RlK[a]=1},b.prototype.getUsedCustomNames=function(){return this.RlK||{}},b.prototype.getCustomFunction=function(a){return this.Qu?this.Qu.getCustomFunction(a):o},b.prototype.getCustomName=function(a){var b=this.getCustomNameInfo(a);return b?b.getExpression():o},b.prototype.getCustomNameInfo=function(a){return this.Qu?this.Qu.getCustomName(a)||this.Qu.dJb(a):o},b}(h.CalcSource),b.SpreadSource=N;function T(a,b,c,e,f,g){var i,j=a&&a instanceof d.Worksheet&&a,k=new h.Parser;return c=c===p?0:c,e=e===p?0:e,i=new K(j,(!!f),h.pf(c,e)),g&&(i.culture=!0),k.parse(i,b)}b.formulaToExpression=T;function U(a,b,c,e,f,g){var i,j=a&&a instanceof d.Worksheet&&a,k=new h.Parser;return c=c===p?0:c,e=e===p?0:e,i=new K(j,(!!f),h.pf(c,e)),i.YSa=g,k.unparse(i,b)}b.expressionToFormula=U;function V(a,b,c,d,e){c===p&&(c=0),d===p&&(d=0);var f=T(a,b,c,d,e,!0);return W(a,f,c,d)}b.evaluateFormula=V;function W(a,b,c,d,e){var f,g,i=a.Cf();return c===p&&(c=a.getActiveRowIndex()),d===p&&(d=a.getActiveColumnIndex()),f=!0,e&&e.convertNullToZero!==p&&(f=e.convertNullToZero),g=a.yj(),i.Hg(g,b,h.pf(c,d),!1,f)}b.evaluateExpression=W;function X(a,b,c,d,e){var f,g,i,j=a.Cf();return c===p&&(c=a.getActiveRowIndex()),d===p&&(d=a.getActiveColumnIndex()),f=!0,e&&e.convertNullToZero!==p&&(f=e.convertNullToZero),g=a.yj(),i=h.pf(c,d),i.PhK=Math.random().toString(36).substring(2),j.QhK(g,b,i,f)}b.RhK=X;function Y(a,b,c,d,e){var f,j,k,l=a.row,m=a.col,n=a.row+a.rowCount-1,p=a.col+a.colCount-1,q=!1,r=!1,s=!1,t=!1;return arguments.length>=4&&(q=0!==(1&d),r=0!==(4&d),s=0!==(2&d),t=0!==(8&d),l-=q?b:0,n-=r?b:0,m-=s?c:0,p-=t?c:0),e&&(j=$(a,e,b),k=_(a,e,b),j&&k)?f=g.StructureReferenceResolver.create(e,j,k,a.col-e.dataRange().col,a.col+a.colCount-e.dataRange().col-1):(1===a.rowCount&&1===a.colCount?f=h.rf(o,o,l,m,q,s):(a.row<0&&(l=n=i.BAND_INDEX_CONST),a.col<0&&(m=p=i.BAND_INDEX_CONST),f=h.uf(o,o,l,m,n,p,q,s,r,t,b,c)),f)}b.rangeToExpression=Y;function Z(a){return a.indexOf("[")>=0&&a.indexOf("]")>1}b.isValidExternalReference=Z;function $(a,b,c){if(1===a.rowCount){if(b.hasHeadersRow()&&a.row===b.startRow())return 2;if(b.hasTotalsRow()&&a.row===b.endRow())return 8;if(c===a.row)return 1}else{if(b.hasHeadersRow()&&a.row===b.startRow()){if(a.rowCount===b.dataRange().rowCount+1)return 6;if(b.hasTotalsRow()&&a.rowCount===b.dataRange().rowCount+1+1)return 14}if(a.row===b.dataRange().row){if(a.rowCount===b.dataRange().rowCount)return 3;if(b.hasTotalsRow()&&a.rowCount===b.dataRange().rowCount+1)return 12}}return p}function _(a,b,c){return a.col===b.startColumn()&&a.colCount===b.dataRange().colCount?1:1===a.colCount?2:a.col>=b.startColumn()&&a.col+a.colCount-1<=b.endColumn()?4:p}function aa(a,b,c,d,e){var f=Y(a,b,c,d),g=new K(o,(!!e),h.pf(b,c)),i=new h.Parser,j=i.unparse(g,f);return g.no(),j}b.rangeToFormula=aa;function ba(a,b,c,d,e,f,g){var i=Y(b,c,d,e,g),j=new K(a,(!!f),h.pf(c,d)),k=new h.Parser;return k.unparse(j,i)}b.rangeToFormulaWithStructReference=ba;function ca(a,b,c,e){var f,g,i,j,k,l,m,n,o,p,q;if(!b)return null;if(c=c?c:0,e=e?e:0,f=a.Cf(),g=f.parse(a.yj(),b,c,e,!0,!0),j=!1,g)if(7===g.type&&"ANCHORARRAY"===g.functionName&&(g=g.arguments[0],j=!0),i=g.source,i&&13===g.type);else if(1===g.type&&g.endSource){for(k=g.source,l=g.endSource,m=k.getSources(l),n=!1,o=0;o<m.length;o++)if(m[o]===a.yj()){n=!0;break}g=n&&g}return!g||!g.getRange||i&&i!==a.yj()?null:(p=g.getRange(c,e))?(j&&(q=new h.CalcReference(a.ft,[p]).getSpillRef(),q&&q.yf&&(p=q.yf[0])),new d.Range(p.row,p.col,p.rowCount,p.colCount)):null}b.formulaToRange=ca;function da(a,b,c,e,f,i){var j,k,l,m,o,q,r,s,t,v,w=[],x=[];if(!b)return w;for(j={},c=c||0,e=e||0,k=new h.Parser,l=g.qzb(k,b,a,c,e,p,f,i),m=0;m<l.length;m++)if(o=l[m].sheetRanges,o&&!n(o))for(q=0;q<o.sheets.length;q++)for(r=o.sheets[q],x=j[r],x||(j[r]=x=[],w.push({sheetName:r,ranges:x})),s=o[r],t=0;t<s.length;t++)v=s[t],u(v)||x.push(new d.Range(v.row,v.col,v.rowCount,v.colCount));return w}b.formulaToRanges=da;function ea(a,b,c,d,e){var f=new h.Parser,g=new K(o,(!!e),h.pf(b,c)),i=fa(f,g,a,b,c,d);return g.no(),i}b.rangesToFormula=ea;function fa(a,b,c,d,e,g,h){var i,j,k,l,m="";for(i=0;i<c.length;i++)j=Y(c[i],d,e,g),k=a.unparse(b,j),i>0?(l=h&&f.Common.CultureManager.q4().NumberFormat.listSeparator||",",m+=l+" "+k):m+=k;return m}b.TLb=fa,b.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15};function ga(a,b,c,d,e,g,h){var i,j,k,l,m=d.getValue(b,c),n=!1,o=100,p=.001,q=.01,r=(A(m)?+m:0)-h,s=d.getValue(e,g),u=(A(s)?+s:0)-h;if(A(s)&&Math.abs(u)<p)n=!0;else if(t(s))n=!1;else for(i=r+(0===r?q:q*r),k=0;!n&&k<o;k++)i=f.Common.o.Lma(i,13),a.setValue(b,c,i),s=d.getValue(e,g),j=(A(s)?+s:0)-h,A(s)&&Math.abs(j)<p?n=!0:t(s)?i=(r+i)/2:r-i===0?i=r+(0===r?q:q*r):u-j===0?i=r+2*(i-r):(l=i-j*(r-i)/(u-j),r=i,u=j,i=l);return n||a.setValue(b,c,m),n}b.goalSeek=ga},"./dist/plugins/sheetsCalc/calc.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("Core");b.BAND_INDEX_CONST=-2147483648,b.MAX_ROW_COUNT=d.XmlConstants.M7,b.MAX_COLUMN_COUNT=d.XmlConstants.L7},"./dist/plugins/sheetsCalc/external-reference.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("@grapecity/js-calc"),g=e.Common.j,h=d.XFileConstants.abK,i=d.XFileConstants.dbK,j=void 0,k=null,l=e.Common.D,m=g.Fa,n=d.Util.XaK,o=d.Util.YaK,p=/^'?\[\d+\]/;function t(a,b,c,d){var e=a&&a[b];return e&&e[c]&&e[c][d]}function u(a,b,c,d){var e,f=a.sheets[b]&&a.sheets[b].data.dataTable,g=f&&f[c]&&f[c][d]&&f[c][d].value;return g&&g.richText?(e="",g.richText.forEach(function(a){e+=a.text}),e):g}q=function(a){s(b,a);function b(b,c,d){var e,g,h,i=a.call(this,k)||this;return i.getSheetRangeReference=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a];return f.Errors.Name},e=b.split("]"),d&&(g=e[0].substring(1)),c.K$J[g]?i.xf=c.K$J[g]:(h=e[0].indexOf("["),i.xf=c.t9J(e[0].substring(h+1),e[0].substring(0,h),!0)),i.u4=e[1],i.J$J=c,i}return b.prototype.Ig=function(a,b,c){var d,e=a.getKey();this.xf=this.J$J.u9J(this.xf),this.vv(),d=this.J$J.L$J[this.xf.i]=this.J$J.L$J[this.xf.i]||{},b?d[e]?d[e][1].push(c):d[e]=[a,[c]]:d[e]&&delete d[e]},b.prototype.vv=function(){this.xf.data=this.xf.data||{};var a=this.xf.data[this.u4];return a||(this.xf.sheetNames.push(this.u4),a=this.xf.data[this.u4]={},a.isNew=!0),a},b.prototype.getValue=function(a,b){var c,d=this.vv(),e=d[a];return e||(e=d[a]={}),m(e[b])&&(e[b]=j),d.isNew?f.Errors.Reference:(c=e[b],c&&c._code&&(c._error||c._calcError)?new f.CalcError(c._error||c._calcError):c)},b.prototype.getRowCount=function(){return f.MAX_ROW_COUNT},b.prototype.getColumnCount=function(){return f.MAX_COLUMN_COUNT},b.prototype.createSourceModel=function(){return k},b.prototype.getCalcSourceModel=function(){return k},b.prototype.setCalcSourceModel=function(){},b.prototype.getSources=function(a){return[]},b.prototype.referenceToArray=function(a,b,c,d,e,g,h,i){var l,m,n,o,p,q,r,s,t,u,v,w,x,y=this,z=1,A=1,B=[],C=a.getRangeCount();if(0===C)return B.isError=!0,B;for(r=y.getRowCount(),s=y.getColumnCount(),c=c===j||c,t=0;t<C;t++){if(c||(q=[],B.push(q)),n=a.getRow(t),o=a.getColumn(t),z=a.getRowCount(t),0===z)return B.isError=!0,B;if(z===-1&&(n=0,z=r),A=a.getColumnCount(t),0===A)return B.isError=!0,B;if(A===-1&&(o=0,A=s),n>=r||o>=s)return B=c?[k]:[[k]],B.rowCount=1,B.colCount=1,B.rangeCount=1,B;for(n+z>r&&(z=r-n),o+A>s&&(A=s-o),u=void 0,v=!1,w=0;w<z;w++)for(l=n+w,c||(u=[],q.push(u)),x=0;x<A;x++)m=o+x,p=y.getValue(l,m),v||(p=f.Convert.wf(p,b,!f.ExcelCompatibleCalcMode,g,i),d&&f.Convert.vf(p)&&(B=[p],B.isError=!0,v=!0),f.Convert.j$a(p,g)||(c?B.push(p):u.push(p)));if(v)return B}return c||1!==C||(B=B[0]),B.rowCount=z,B.colCount=A,B.rangeCount=C,B},b.prototype.getName=function(a){return this.J$J.L$J[this.xf.i]&&(!this.xf||a&&a.Eh)?"["+this.xf.i+"]"+this.u4:this.xf.option.path+"["+this.xf.option.name+"]"+this.u4},b.prototype.getIdentity=function(a,b){var c=this,d=b.row,e=b.rowCount||1,f=b.column,g=b.columnCount||1;return d===-1&&(d=0,e=c.getRowCount()),f===-1&&(f=0,g=c.getColumnCount()),c.getName(a)+"."+d+"."+e+"."+f+"."+g},b}(f.CalcSource),b.ExternalSource=q;function v(a,b){var c,d,e;if(a)for(c in a)l(a,c)&&(d=a[c],e=d.getExpression(),e&&e.forEachNodes(function(a){(1===a.type||5===a.type)&&a.source instanceof q&&(b[a.source.mi]=!0)}))}function w(a,b){var c=a.getRange(b.row,b.column);return c.sheetName=a.source.u4,c}r=function(){function a(a){this.K$J=a||{},this.L$J={},this.v9J()}return a.prototype.parseSource=function(a,b){return new q(a,this,b)},a.prototype.t9J=function(a,b,c,d){var e,f;for(e in this.K$J)if(l(this.K$J,e)&&(f=this.K$J[e],f&&f.option.name===a&&f.option.path===b))return f;if(!c)for(e in this.K$J)if(l(this.K$J,e)&&(f=this.K$J[e],f.option.name===a&&""===b))return f;return d?j:{option:{name:a,path:b},sheetNames:[],data:{}}},a.prototype.v9J=function(){for(var a in this.K$J)this.K$J[a]&&(this.K$J[a].i=a)},a.prototype.u9J=function(a){var b,c=this.t9J(a.option.name,a.option.path,!0,!0);return c?c:(b=Object.keys(this.K$J).length+1,this.K$J[b]=a,a.i=b,a)},a.prototype.r9J=function(a){var b,c,e,f={},g={},h=1;for(c in this.K$J)if(l(this.K$J,c)){if((!this.L$J[c]||d.GC$.isEmptyObject(this.L$J[c]))&&(b||(b={},v(a.Tu,b),a.sheets.forEach(function(a){v(a.Tu,b)})),!b[c]))continue;e=this.K$J[c],e.i=h,f[h]=e,g[h]=this.L$J[c],h++}this.K$J=f,this.L$J=g},a.prototype.toJSON=function(){var a,b,c={};for(a in this.K$J)l(this.K$J,a)&&(b=this.K$J[a],c[a]={option:{name:b.option.name,path:b.option.path},sheetNames:b.sheetNames,data:b.data});return c},a.prototype.bdK=function(a){var b,c=this.K$J,e=[],f={n_:"externalReferences",c_:e},g={},k=a.workbook.rels,m=0,p=function(a){var b,f,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;if(l(c,a)){for(m++,b=c[a],f=b.option.id=h+n(k),k.c_.push({n_:i,Id:f,Type:d.RelationshipConstants.A7,Target:o(d.XFileConstants.qbK+"/"+d.XFileConstants.pbK+a)}),e.push({n_:"externalReference","r:id":f}),p=[],q={n_:"sheetNames",c_:p},r={n_:"sheetDataSet",c_:[]},s=b.sheetNames,s&&s.forEach(function(a){p.push({n_:"sheetName",val:a})}),t=b.data,u=0,v=s.length;u<v;u++){if(w=t[s[u]],x={n_:d.XFileConstants.HbK,sheetId:u},w)if(w.isNew)x.refreshError=1;else{y=[];for(z in w)if(w.hasOwnProperty(z)){if(A=parseInt(z,10)+1,isNaN(A))continue;B=w[z],C=[],D={n_:"row",r:A,c_:C};for(E in B)B.hasOwnProperty(E)&&B[E]!==j&&(F=B[E],G={n_:"cell"},G.r=d.IndexHelper.R9(parseInt(E,10))+A,"string"==typeof F?G.t="str":"boolean"==typeof F?(G.t="b",F=F?"1":"0"):F&&F._code&&(G.t="e",F=F._calcError||F._error,"#SPILL!"!==F&&"#CALC!"!==F||(F="#VALUE!")),G.c_=[{n_:"v",c_:[F]}],C.push(G));y.push(D)}x.c_=y}r.c_.push(x)}g[f]={n_:"externalLink",r_:[13,14,1,21],c_:[{n_:"externalBook","r:id":"rId1",r_:[8],c_:[q,r]}],option:b.option}}};for(b in c)p(b);return{externalReferencesNode:f,externalLinks:g,count:m}},a.prototype.ViK=function(a,b,c){var d,e,f,g,h,i=b&&b.sheets&&Object.keys(b.sheets),k=i&&b.sheets[i[0]].data&&b.sheets[i[0]].data.dataTable,n=k?u:t,o=this.t9J(a,c||"",j,!0);if(!m(o)){d=o.i,e=this.K$J[d],e.sheetNames.forEach(function(a){var c,d,f=k?b.sheets[a]:b[a];f&&delete e.data[a].isNew;for(c in e.data[a])if(l(e.data[a],c))for(d in e.data[a][c])l(e.data[a][c],d)&&(e.data[a][c][d]=n(b,a,c,d))}),f=this.L$J[d]||{};for(g in f)l(f,g)&&(h=f[g][0],h.fh())}},a.prototype.VF=function(a,b,c){var d,e=this;"string"==typeof a?e.ViK(a,b,c):a&&(d=e.N$J(!0),d.forEach(function(b){a[b.filePath+b.name]&&e.ViK(b.name,a[b.filePath+b.name],b.filePath)}))},a.prototype.N$J=function(a){var b,c,d,e,f,g,h=[];for(b in this.K$J)if(l(this.K$J,b)){if(c=this.K$J[b],d={name:c.option.name,filePath:c.option.path},a){e=this.L$J[b]||{},d.items=[],f=function(a){var b,c,f,g;l(e,a)&&(b=e[a][0],c={row:b.row,col:b.column,sheetName:b.ah.xf.getName()},f=e[a][1],g=1===f.length?w(f[0],b):f.map(function(a){return w(a,b)}),d.items.push({target:c,source:g}))};for(g in e)f(g)}h.push(d)}return h},a}(),b.ExternalReferenceManager=r},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-calc"),e=c("Common"),f=c("./dist/plugins/sheetsCalc/calc.ns.js"),g=c("./dist/plugins/sheetsCalc/parser-sheets.js"),h=c("Core"),i=e.Common.j.Ia,j=e.Common.j.Fa,k=e.Common.u,l=k.Nb,m=Math.min,n=Math.max,o=void 0,p=null,q=d.Convert.vf,r=d.Errors.Reference,s=h.util.l_a;function x(a,b){var c,d,e,f;return b||(b=this),c=n(a.row,b.row),d=n(a.column,b.column),e=m(a.row+a.rowCount,b.row+b.rowCount),f=m(a.column+a.columnCount,b.column+b.columnCount),c>=e||d>=f?p:{row:c,column:d,rowCount:e-c,columnCount:f-d,intersectWith:x}}t=function(){function a(a,b,c,d,e,f,g,h){var i=this;i.Rj=a,i.Vj=b,i.Wj=c,i.Qj=d,i.Tj=e,i.Uj=f,i.Xj=g,i.Yj=h}return a.prototype.Nj=function(a){var b,c,d=this,e=d.Qj.kj;return d.HPJ=e&&e.CMc(),d.HPJ&&a>=0?(b=a-d.Tj+1,c=e.EMc(d.Tj,b,!0),d.Tj-d.Vj+c):d.Tj-d.Vj},a.prototype.Oj=function(a){var b,c,d=this,e=d.Qj.kj;return d.HPJ=e&&e.CMc(),d.HPJ&&a>=0?(b=a-d.Uj+1,c=e.EMc(d.Uj,b),d.Uj-d.Wj+c):d.Uj-d.Wj},a.prototype.Sj=function(a,b,c,d,e){var f=this;return f.Rj===a&&(f.Vj===-1||f.Vj<=b&&b+d<=f.Vj+f.Xj)&&(f.Wj===-1||f.Wj<=c&&c+e<=f.Wj+f.Yj)},a.prototype.Pj=function(a,b,c,d,e){var f=this,g=f.Qj.kj,h=g&&g.CMc(),i=f.Tj,j=f.Uj,k=f.Xj,l=f.Yj;return h&&(k+=g.DMc(i,k,!0),l+=g.DMc(j,l)),f.Qj===a&&(i===-1||i<=b&&b+d<=i+k)&&(j===-1||j<=c&&c+e<=j+l)},a.prototype.intersectWith=function(a,b,c,d,e){var f,g,h=this;return h.Qj!==a?p:(f=h.Zj(a,b,c,d,e),g=h.Zj(a,h.Vj,h.Wj,d,e),g.intersectWith(f))},a.prototype.Zj=function(a,b,c,d,e){var f=b===-1?0:b,g=b===-1||d===-1?a.rowCount:d,h=c===-1?0:c,i=c===-1||e===-1?a.colCount:e;return{row:f,column:h,rowCount:g,columnCount:i,intersectWith:x}},a}(),b.MoveSwapInfo=t;function y(a,b,c,d){return(!d||a<b)&&c}function z(a){return[a.row,a.col,a.rowCount,a.colCount].join(",")}function A(a,b,c,d){var e=a[b];e||(e=a[b]={}),e[c]=d}function B(a,b,c){var d=a[b];return!!d&&d[c]}u=function(){function a(){}return a.zj=function(b,c,e,g,h,i,j,k,l,n,o){var p,q,s,t,u,v,w=e,x=a,y=this.zj;if(!e)return w;if(s=e.type,10===s)w=d.Lh(y.call(x,b,c,e.value,g,h,i,j,k,l,n,o));else if(1===s&&e.sf()){if(p=m((e.source||c).getRowCount(),f.MAX_ROW_COUNT),q=m((e.source||c).getColumnCount(),f.MAX_COLUMN_COUNT),e.rowRelative&&(e.row+g<0||e.row+g>=p)||e.columnRelative&&(e.column+h<0||e.column+h>=q))return d.Hh(r,e.source);w=e.offset(0,0,!1)}else if(1===s){if(p=m((e.source||c).getRowCount(),f.MAX_ROW_COUNT),q=m((e.source||c).getColumnCount(),f.MAX_COLUMN_COUNT),t=e,t.rowRelative&&!e.isFullColumn&&(t.row+g<0||t.row+g>p)||t.columnRelative&&!e.isFullRow&&(t.column+h<0||t.column+h>q)||t.endRowRelative&&!e.isFullColumn&&(t.endRow+g<0||t.endRow+g>p)||t.endColumnRelative&&!e.isFullRow&&(t.endColumn+h<0||t.endColumn+h>q))return d.Hh(r,e.source,e.endSource);w=e.offset(0,0,!1,g,h)}else if(9===e.type)w=d.Kh(e.operatorType,y.call(x,b,c,e.value,g,h,i,j,k,l,n,o),e.value2&&y.call(x,b,c,e.value2,g,h,i,j,k,l,n,o));else if(7===s){if(u=[],e.arguments&&e.arguments.length>0)for(v=0;v<e.arguments.length;v++)u[v]=y.call(x,b,c,e.arguments[v],g,h,i,j,k,l,n,o);
w=d.Jh(e,u)}else 13===s&&(w=e.offsetWhenCopy(b,c,g,h,i,j,k,l,n,o));return w},a.copyFormula=function(b,c,e,f,g,h,i,j,k,l){var n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z=b,$=f,_=b.getSource(),aa=f.getSource(),ba=a;if(Z&&$){for(n=aa&&aa.getSheet().ITa.dUa(),p=c,q=e,r=g,s=h,t=i,u=j,c<0&&(p=0,t=m(b.rC(),f.rC())),e<0&&(q=0,u=m(b.cC(),f.cC())),g<0&&(r=0),h<0&&(s=0),v=new d.CalcSourceModel(b.Cf(),_),A=aa.getSheet(),B=!l&&A.CMc(),C=t,D=u,E=A.getRowCount(),F=A.getColumnCount(),w=0;w<t;w++)for(x=0;x<u;x++)Z.Uf(v,w+p,x+q,w,x);for(G={},H=f.Cf(),w=0,y=0;w<t&&w+r<E;w++)if(I=w+r,B&&0===A.getRowHeight(I))t++;else if(k&&aa.isHiddenRow(I,!0))y++;else{for(x=0,z=0,u=D;x<u&&x+s<F;x++)if(J=x+s,B&&0===A.getColumnWidth(J))u++;else{if(K=v.Kf(y,z)){if(K===G)continue;if(L=g+w-c-y,M=h+x-e-z,K=ba.zj(_,aa,K,I,J,L,M,g,h,C,D),N=v.Qf(y,z),aa){if(B&&N)continue;if(N&&!N.isDynamicArray){for(O=N.rowCount,P=N.colCount,Q=p-N.row,Q>0&&(O-=Q),R=t-w,R<O&&(O=R),S=q-N.col,S>0&&(P-=S),T=u-x,T<P&&(P=T),U=0;U<O;U++)for(V=0;V<P;V++)v.Rf(w+U,x+V,G);f.setArrayFormula(I,J,O,P,H.unparse(aa,K,I,J),o,n)}else W=K?H.unparse(aa,K,I,J):o,aa.setFormula(I,J,W,o),X=v.Mf(y,z),X&&(Y=new d.EvaluateContext(aa,d.pf(I,J),(!1)),X=$.Af.allowDynamicArray?d.Mh(Y,K,!1,0,0,!0,!0):d.qJJ(Y,K,!1,0,0,!1,!1),X=X===K?o:X),$.ig(I,J,K,X,N,n)}else $.Rf(I,J,K),$.Xf(I,J,N)}else $&&$.Kf(I,J)&&$.ig(I,J,o,o,o,n);z++}y++}}},a.moveFormula=function(a,b,c,d,e,f,g,i){var j,k,l,n,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=a.Bj(),P=d.Bj(),Q=O.Cf();if(O&&P){for(j=d.getRowCount(),k=d.getColumnCount(),l=O.dUa(),n=P.dUa(),q=Q.ih(),b<0&&(b=0,g=m(a.getRowCount(),j)),e<0&&(e=0),c<0&&(c=0,i=m(a.getColumnCount(),k)),f<0&&(f=0),r=!(a===d&&a.name()===d.name()),s=g,t=i,u=g,w=d.CMc(),w&&(s+=d.DMc(e,g,!0),t+=d.DMc(f,i)),O.Sg(b,c,g,i),qa(O,b,c,g,i),P.Sg(e,f,s,t),qa(P,e,f,s,t),x=[],y=0;y<g;y++)for(z=0;z<i;z++)A=O.Kf(y+b,z+c),B=O.Qf(y+b,z+c),C=O.Mf(y+b,z+c),A?(x.push({Lf:A,Pf:B,Nf:C}),O.Sf(y+b,z+c,l),(!B||B&&y+b===B.row&&z+c===B.col)&&O.xf.setFormula(y+b,z+c,p,o)):x.push(p);for(G=r?{}:null,y=0,D=0;y<u&&y+e<j;y++)if(H=y+e,w&&0===d.getRowHeight(H))u++;else{for(z=0,E=0,v=i;z<v&&f+z<k;z++)if(I=z+f,w&&0===d.getColumnWidth(I))v++;else{if(J=x[D*i+E]){if(A=J.Lf,B=J.Pf,w&&B){E++;continue}Q&&B&&!B.isDynamicArray&&B.row===b+y&&B.col===c+z&&(F=h.kf(H,I,B.rowCount,B.colCount)),K=B&&!B.isDynamicArray?F:o,C=J.Nf,P.FTa(n,H,I),P.Rf(H,I,A),P.Xf(H,I,K),P.Wf(H,I,C),(!K||K&&K.row===H&&K.col===I)&&(L=P.getFormula(H,I),P.xf.setFormula(H,I,L,K)),r&&(G[H+", "+I]=A)}else P.FTa(n,H,I),P.Rf(H,I,o),P.Xf(H,I,o);E++}D++}q.Dj(O,b,c,g,i),q.Dj(P,e,f,s,t),M=O.getSource().getSheet(),N=M.uja&&(M.parent||M).tja(),q.Ej(N,O.getSource(),b,c,P.getSource(),e,f,g,i,!0,G),r===!0&&q.Ej(N,O.getSource(),b,c,P.getSource(),e,f,g,i,!0,G)}},a.prototype.isAdjustCell=function(a){return a.preAdj||this.imb&&a===this.imb[0]},a.prototype.isAdjust=function(a){return a.preAdj||this.imb&&a===this.imb[0]},a.prototype.hh=function(a,b){var c=this,d,e;isNaN(b)||(c.imb||(c.imb={},c.jmb={}),d=c.imb[b],e=c.jmb[b],a&&!a.preAdj&&a!==d&&(d?e.nextAdj=a:c.imb[b]=a,a.preAdj=e,a.nextAdj=p,c.jmb[b]=a))},a.prototype.Fj=function(a,b){var c,d,e,f=this;isNaN(b)||(c=f.imb&&f.imb[b],a&&(a.preAdj||a===c)&&(d=a.preAdj,e=a.nextAdj,d?d.nextAdj=e:f.imb[b]=e,e?e.preAdj=d:f.jmb[b]=d,a.preAdj=p,a.nextAdj=p))},a.prototype.Gj=function(a,b,c,d,e,f,g){this.Hj(a,G,b,c,d,e,f,g);var h=0,i=0,j=0,k=0;0===b&&(d&&e?j=c:d?h=c:e?k=c:i=c),H(a,G,b,c,h,i,j,k,d,e,f),K(a,G,b,c,d,e)},a.prototype.Hj=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,p,q,r,s,t,u,v,w,x,z,C,D,E,F=this,G=F.imb;if(G){for(q={};G[0];)if(m=G[0],i=m.ah,p=i.dUa(),n=i.getSource(),j=m.row,k=m.column,B(q,j,k))F.Fj(m,0);else{if(l=i.Kf(j,k),!l||b===R&&n===a)(i.getRowExpression&&i.getRowExpression(j)||i.getColumnExpression&&i.getColumnExpression(k))&&i.Ag(j,k,1,1);else if(l=b.call(F,n,j,k,l,a,c,d,e,f,o,g,h),r=i.Qf(j,k)){if(n===a&&(s=f?d:-d,e?c<=r.row&&(r.row+=s):c<=r.col&&(r.col+=s)),j===r.row&&k===r.col)if(r.isDynamicArray)i.fg(j,k,l,r,!0,y(e?j:k,c,p,a.id===n.id));else for(t=j;t<j+r.rowCount;t++)for(q[t]||(q[t]={}),u=k;u<k+r.colCount;u++)i.fg(t,u,l,r,t===j&&u===k,y(e?t:u,c,p,a.id===n.id)),A(q,t,u,!0)}else i.fg(j,k,l,r,!0,y(e?j:k,c,p,a.id===n.id));F.Fj(m,0)}for(;G[1];)m=G[1],i=m.ah,p=i.dUa(),j=m.row,i.getRowExpression&&(l=i.getRowExpression(j),l&&i.fg&&(n=i.getSource(),i.fg(j,-1,b.call(F,n,j,-1,l,a,c,d,e,f),o,!0,y(j,c,p,a.id===n.id)))),F.Fj(m,1);for(;G[2];)m=G[2],i=m.ah,p=i.dUa(),k=m.column,i.getColumnExpression&&(l=i.getColumnExpression(k),l&&i.fg&&(n=i.getSource(),i.fg(-1,k,b.call(F,n,-1,k,l,a,c,d,e,f),o,!0,y(k,c,p,a.id===n.id)))),F.Fj(m,2);for(;G[3];)v=G[3],w=v.name,i=v.ah,l=i.DTa(w),x=b.call(F,i.getSource(),0,0,l,a,c,d,e,f,{isNameID:!0}),i.gg(w,x),F.Fj(v,3);for(z in G)if(C=+z,C>3&&G.hasOwnProperty(z))for(;G[z];)D=G[z],E=D.ah,l=b.call(F,E,0,0,D.expression,a,c,d,e,f),E.setExpression(D.id,D.name,l),F.Fj(D,C)}},a.prototype.ph=function(a){var b=this,c=a.getCalcSourceModel(),d=a.getRowCount(),e=a.getColumnCount();qa(c,0,0,d,e),b.Hj(a,R),H(a,R,0,0,0,0,0,0,!0,!1),K(a,R,0,0,!0,!1)},a.prototype.Ej=function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,p,q,r,s,u,v,w,x,y,C,D,E,F,G,H,I,J,K,L,N=this,O=ma,P=new t(b,c,d,e,f,g,h,i),Q={};if(a&&na(a,P,j),M(b,P,j),s=N.imb,v={},s){for(;s[0];)if(m=s[0],l=m.ah,n=m.row,p=m.column,r=l.dUa(),B(Q,n,p))N.Fj(m,0);else{if(q=l.Kf(n,p),u=l.getSource(),q)if(w=o,k&&k[n+", "+p]&&(u=b,w={crossSheetMoved:!0}),q=O.call(N,u,n,p,q,P,j,w),x=l.Qf(n,p),y=void 0,x&&!x.isDynamicArray)if(y=z(x),n===x.row&&p===x.col)for(v[y]=!0,C=n;C<n+x.rowCount;C++)for(Q[C]||(Q[C]={}),D=p;D<p+x.colCount;D++)l.fg(C,D,q,x,C===n&&D===p,r),A(Q,C,D,!0);else v[y]||(l.fg(n,p,q,x,!1,r),A(Q,n,p,!0));else l.fg(n,p,q,x,!0,r);else(l.getRowExpression&&l.getRowExpression(n)||l.getColumnExpression&&l.getColumnExpression(p))&&l.Ag(n,p,1,1);N.Fj(m,0)}for(;s[1];)m=s[1],l=m.ah,n=m.row,r=l.dUa(),l.getRowExpression&&(q=l.getRowExpression(n),q&&l.jg&&l.jg(n,O.call(N,u,n,-1,q,P,j),o,r)),N.Fj(m,1);for(;s[2];)m=s[2],l=m.ah,p=m.column,r=l.dUa(),l.getColumnExpression&&(q=l.getColumnExpression(p),q&&l.kg&&l.kg(p,O.call(N,u,-1,p,q,P,j),o,r)),N.Fj(m,2);for(;s[3];)E=s[3],F=E.name,l=E.ah,q=l.DTa(F),G=O.call(N,u,0,0,q,P,j),l.gg(F,G),N.Fj(E,3);for(H in s)if(I=+H,I>3&&s.hasOwnProperty(H))for(;s[H];)J=s[H],K=J.ah,L=K.getSource(),q=O.call(N,L,0,0,J.expression,P,j),K.setExpression(J.id,J.name,q),N.Fj(J,I)}},a.prototype.Dj=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=b+d,m=c+e;for(h=b;h<l;h++)for(i=c;i<m;i++)f=a.Yf(h,i),g=a.Kf(h,i),(f||g)&&(k.Fj(f,0),a.Q3(h,i,0),j=a.qg(h,i,!0),f&&g&&(f.row!==j.row||f.column!==j.column)&&(j.oldRow=f.row,j.oldColumn=f.column),k.hh(j,0))},a.prototype.Ij=function(a,b,c){var d,e,f=this;for(d=b;d!==-1&&d<b+c;d++)(a.Yf(-1,d)||a.Kf(-1,d))&&(a.Q3(-1,d,2),e=a.sg(d,!0),f.hh(e,2))},a.prototype.Jj=function(a,b,c){var d,e,f=this;for(d=b;d!==-1&&d<b+c;d++)(a.Yf(d,-1)||a.Kf(d,-1))&&(a.Q3(d,-1,1),e=a.rg(d,!0),f.hh(e,1))},a.prototype.Kj=function(a){var b,c,e,f,g,h=this,i=a.Cf().getAllSourceModels();for(e=0;e<i.length;e++)if(f=i[e],f.lmb)for(b=f.lmb(),g=0;g<b.length;g++)c=b[g],c&&c.isVolatile&&c instanceof d.CellCalc&&!h.isAdjustCell(c)&&h.hh(c,0)},a.prototype.onBeforeAddRemoveRows=function(a,b,c){[a,c].forEach(function(a){if(a){var c=a.rC(),d=a.cC();a.Sg(b,0,c-b,d),a.Ug(b,c-b),qa(a,b,-1,c-b,-1,!0)}})},a.prototype.onAfterAddRemoveRows=function(a,b,c,d,e,f){var g=this;[a,f].forEach(function(a){if(a){var e=a.rC(),f=a.cC();d?a.Ag(b,0,c,f):e+=c,g.Dj(a,b,0,e-b,f),g.Jj(a,b,e-b),g.Kj(a)}}),g.Gj(a.getSource(),b,c,!0,d,o,e),a.Cf().autoCalculation&&a.Cf().recalculateAll(!1)},a.prototype.onAfterAddRemoveColumns=function(a,b,c,d,e,f){var g=this;[a,f].forEach(function(a){if(a){var e=a.rC(),f=a.cC();d?a.Ag(0,b,e,c):f+=c,g.Dj(a,0,b,e,f-b),g.Ij(a,b,f-b),g.Kj(a)}}),g.Gj(a.getSource(),b,c,!1,d,o,e),a.Cf().autoCalculation&&a.Cf().recalculateAll(!1)},a.prototype.onBeforeAddRemoveColumns=function(a,b,c){[a,c].forEach(function(a){if(a){var c=a.rC(),d=a.cC();a.Sg(0,b,c,d-b),a.Wg(b,d-b),qa(a,-1,b,-1,d-b,!0)}})},a.prototype.onAfterRemoveName=function(a,b){var c=a.wg(b,!1);c&&(c.updateListening(!0,!1),c.fh(),c.updateListeningOnRemoved())},a.prototype.adjustFormulaOnRemoveName=function(a,b,c){return ra(a,b,c)},a.prototype.invalidName=function(a,b){var c,d;b&&(c=a.getCalcSourceModel(),d=c.wg(b.toUpperCase(),!0),d&&d.Yg())},a.prototype.onAfterRemoveTable=function(b,c){var d,e,f,g,i,j,k,l,m,n,o,p,q=this;for(i=0;i<b.length;i++)j=b[i],qa(j.source().getCalcSourceModel(),j.startRow(),j.startColumn(),j.endRow()-j.startRow()+1,j.endColumn()-j.startColumn()+1);if(k=q.imb)for(l={};k[0];)if(m=k[0],d=m.ah,e=m.row,f=m.column,B(l,e,f))q.Fj(m,0);else{if(g=d.Kf(e,f))if(g=a.adjustExpressionOnRemoveTable(g,b,e,f,c),n=d.Qf(e,f),n&&!n.isDynamicArray)for(n=h.kf(e,f,n.rowCount,n.colCount),o=e;o<e+n.rowCount;o++)for(l[o]||(l[o]={}),p=f;p<f+n.colCount;p++)d.fg(o,p,g,n,o===e&&p===f),A(l,o,p,!0);else d.fg(e,f,g,n,!0);else(d.getRowExpression&&d.getRowExpression(e)||d.getColumnExpression&&d.getColumnExpression(f))&&d.Ag(e,f,1,1);q.Fj(m,0)}},a.adjustExpressionOnRemoveTable=function(b,c,e,f,g){var h,i,j,k,l,m,n,o,q,r,s,t,u,v,w,x,y,z=a.adjustExpressionOnRemoveTable;if(9===b.type){if(h=b.value,i=b.value2,j=z(h,c,e,f,g),k=i&&z(i,c,e,f,g),h!==j||i!==k)return d.Kh(b.operatorType,j,k)}else if(7===b.type){for(l=!1,m=[],n=0;n<b.arguments.length;n++)o=b.arguments[n],q=z(o,c,e,f,g),l=l||o!==q,m.push(q);if(l)return d.Jh(b,m)}else if(10===b.type){if(r=b,s=r.value,t=z(s,c,e,f,g),s!==t)return d.Lh(t)}else if(13===b.type)for(u=b,n=0;n<c.length;n++)if(u.baseTable===c[n])return g?d.Ih:(v=u.getRange(e===-1?0:e,f===-1?0:f,!0),w=e===-1||1===u.referencePortions(),x=1===v.rowCount&&1===v.columnCount,y=u.source,x?d.rf(y,p,v.row,v.col,w,!1):d.uf(y,p,v.row,v.col,v.row+v.rowCount-1,v.col+v.colCount-1,w,!1,w,!1));return b},a}(),b.CalcOperatorAdjustor=u,v=d.CalcService.prototype,v.uzb=function(){return new u};function C(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p;return c>=0||!e?(m=d+(e?c:0),n=f+(g?c:0),o=k&&O(h,a,k),p=!k&&O(h,a,k),(o||p)&&(!l&&i+j<=c||l&&i<=c)&&(m-=e?j:0,n-=g?j:0),o=k&&O(h,b,k),p=!k&&O(h,b,k),(o||p)&&(!l&&i<=m||l&&(e&&c+d>=i||!e&&d>=i)?(m+=j,n+=j):(!l&&i<=n||l&&(g&&c+f>=i||!g&&f>=i))&&(n+=j)),m-=e?c:0,n-=g?c:0,l&&i+j<=c&&(m+=e?j:0,n+=g?j:0),{index:m,endIndex:n}):{index:d,endIndex:f}}function D(a,b,c,e,f,g,h,i,j,k,l,m){if(b&&!m){var n=j?f.row:f.column,o=j?f.rowRelative:f.columnRelative,p=void 0;if(j&&c>=0||!j&&e>=0||!o){if(k)p=C(a,b,j?c:e,n,o,-1,!1,g,h,i,j,l).index;else if(p=N(a,b,j?c:e,n,o,g,h,i,j,l),q(p))return d.Hh(p);p!==n&&(f=f.offset(j?p-n:0,j?0:p-n,!0))}}return f}function E(a,b,c,e,f,g,h,i,j,k,l,m){var n,o,p,r,s,t,u,v;if(b&&!m){if(n=f.tf(),3===n||j&&2===n||!j&&1===n)return f;if(o=j?f.rowRelative:f.columnRelative,p=j?f.endRowRelative:f.endColumnRelative,r=j?f.row:f.column,s=j?f.endRow:f.endColumn,t=void 0,j&&c>=0||!j&&e>=0||!o||!p){if(k)t=C(a,b,j?c:e,r,o,s,p,g,h,i,j,l);else if(t=P(a,b,j?c:e,r,o,s,p,g,h,i,j,l),q(t))return d.Hh(t);u=t.index,v=t.endIndex,u===r&&v===s||(f=f.offset2(j?u-r:0,j?0:u-r,j?v-s:0,j?0:v-s,c,e))}}return f}function F(a,b,c,d,e,f,g,h,i,j){if(b){var k=e;if(k&&f===k.source)return k.offsetWhenInsertRemoveColumn(g,h,i,j)}return e}function G(a,b,c,e,f,g,h,i,j,k,l,m){var n,q,r,s,t,u,v,w,x=G,y=e;if(e){if(1===e.type&&e.sf())y=D(a,e.source||a,b,c,e,f,g,h,i,j,l,m);else if(1===e.type)y=E(a,e.source||a,b,c,e,f,g,h,i,j,l,m);else if(10===e.type)n=x(a,b,c,e.value,f,g,h,i,j,o,l,m),n!==e.value&&(y=d.Lh(n));else if(9===e.type)q=x(a,b,c,e.value,f,g,h,i,j,o,l,m),r=e.value2&&x(a,b,c,e.value2,f,g,h,i,j,o,l,m),q===e.value&&r===e.value2||(y=d.Kh(e.operatorType,q,r));else if(7===e.type){for(s=p,t=void 0,u=void 0,v=e,w=v.arguments.length,u=0;u<w;u++)if(t=v.arguments[u],n=x(a,b,c,t,f,g,h,i,j,o,l,m),n!==t){s=[],s[u]=n;break}if(s){for(u=0;u<w;u++)t=v.arguments[u],s[u]!==o&&s[u]!==p||(s[u]=x(a,b,c,t,f,g,h,i,j,o,l,m));y=d.Jh(v,s)}}else l&&!a.O$J||i||13!==e.type||(y=F(a,a,b,c,e,f,g,h,j,l));return y}}function H(a,b,c,d,e,f,g,h,i,j,k){var l=function(e,f,g,h){return b.call(this,e,g,h,f,a,c,d,i,j,o,k)},m=a.getSheet(),n=m.uja&&(m.parent||m).tja(),p=m.ITa&&m.ITa.dUa();I(n,l,i,p)}function I(a,b,c,d){var e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;if(a)for(k=0;k<a.length;k++){for(l=!0,m=!0,n=g.maxRowCount-1,o=g.maxColumnCount-1,e=a[k].validator,p=e.n5,q=0,r=p.length;q<r&&(s=p[q],t=s.rowCount,u=s.colCount,i=s.row,j=s.col,t!==-1&&(m=!1,n=n>i?i:n),u!==-1&&(l=!1,o=o>j?j:o),l||m);q++);if(!(c&&m||!c&&l)&&(h=a[k].sheet,v=h.yj(),f=e.condition(),w=f.getExpressions(),w&&w.length>0)){for(x=0;x<w.length;x++)y=w[x],w[x]=b(v,y,n,o);f.setExpressions(w,d)}}}function J(a){var b=[],c=a.parent,d=c&&c.sheets||[a];return d.forEach(function(a){var c=a.conditionalFormats,d=c&&c.getRules();d&&d.length&&d.forEach(function(c){c.xyb&&b.push({rule:c,sheet:a})})}),b}function K(a,b,c,d,e,f){var g=function(g,h,i,j){return b.call(this,g,i,j,h,a,c,d,e,f)},h=a.getSheet(),i=J(h),j=h.ITa&&h.ITa.dUa();L(i,g,j,e,f)}function L(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;if(a)for(f=0,g=a.length;f<g;f++){if(h=a[f].rule,i=h.ranges(),j=s(i),k=j.r,l=j.c,m=a[f].sheet,n=m.yj(),o=h.condition(),p=m.tables,p&&i&&1===i.length&&(q=i[0],r=q.row,t=q.col,u=q.rowCount,v=q.colCount,w=void 0,e&&d?w=p.WFc(r,t,u,v):m.mJb&&m.KFc&&(w=[m.KFc]),w&&w.length)){for(x=!1,y=0,z=w.length;y<z;y++)if(A=w[y],B=A.row,C=A.col,D=A.rowCount,E=A.colCount,r===B&&u===D&&t>=C&&t+v<=C+E){x=!0;break}if(x)continue}if(o||(h.initCondition(),o=h.condition()),F=o&&o.getExpressions(),F&&F.length>0){for(G=0;G<F.length;G++)H=F[G],F[G]=b(n,H,k,l);o.setExpressions(F,c)}}}function M(a,b,c){var d=function(a,d,e,f){return ma.call(this,a,e,f,d,b,c)},e=a.getSheet(),f=J(e);L(f,d,e.ITa.dUa())}function N(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o;if(c>=0||!e){if(k=d+(e?c:0),l=i&&O(f,a,i),m=!i&&O(f,a,i),(l||m)&&g<=c&&(k+=e?h:0),l=i&&O(f,b,i),m=!i&&O(f,b,i),l||m)if(n=c+d,o=c+h+d,!j&&g+h<=k||j&&n>=g+h)k-=h;else if(!j&&g<=k||j&&n>=g&&g<=o&&o<=g+h)return r;return k-=e?c:0,j&&g<=c&&(k-=e?h:0),k}return d}function O(a,b,c){var d=c?{2:!0}:{1:!0};return a===b||a.kj===b.kj&&(3===a.Wz&&d[b.Wz]||d[a.Wz]&&3===b.Wz)}function P(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,s,t;if(c>=0||!e){if(m=d+(e?c:0),n=f+(g?c:0),o=i+j-1,p=k&&O(h,a,k),q=!k&&O(h,a,k),(p||q)&&i<=c&&(m+=e?j:0,n+=g?j:0),p=k&&O(h,b,k),q=!k&&O(h,b,k),p||q)if(s=c+d,t=c+f,!l&&o<m||l&&o<s)m-=j,n-=j;else{if(!l&&i<=m&&o>=n||l&&i<=s&&o>=t)return r;!l&&i>n||l&&i>t||(!l&&o<=n||l&&o<=t?(m=!l&&i>=m||l&&i>=s?m:i,n-=j):n=i-1)}return m-=e?c:0,n-=g?c:0,l&&i<=c&&(m-=e?j:0,n-=e?j:0),{index:m,endIndex:n}}return{index:d,endIndex:f}}function Q(a,b,c){var e,f,g,h,i,j,k,m,n,q,r,s,t,u,v,w,x=Q,y=b;if(b)if(b.source)if(h=b.source,i=b.endSource,i&&h!==i){if(j=h.kj&&h.kj.parent,!j)return d.Ih;i===c?(k=c.fEc,y.endSource=j.getSheet(k-1).yj()):h===c&&(m=c.fEc,y.source=j.getSheet(m).yj()),delete c.fEc,y.source===y.endSource&&delete y.endSource}else(a!==c&&h===c||a===c&&h!==c)&&(y=d.Ih);else if(10===b.type)e=x(a,b.value,c),e!==b.value&&(y=d.Lh(e));else if(9===b.type)n=x(a,b.value,c),q=b.value2&&x(a,b.value2,c),n===b.value&&q===b.value2||(y=d.Kh(b.operatorType,n,q));else if(7===b.type){for(r=p,s=b.arguments.length,g=0;g<s;g++)if(f=b.arguments[g],e=x(a,f,c),e!==f){r=[],r[g]=e;break}if(r){for(g=0;g<s;g++)f=b.arguments[g],r[g]!==o&&r[g]!==p||(r[g]=x(a,f,c));y=d.Jh(b,r)}}else 8===b.type&&(t=a||c,u=l(b.value),v=t.getCustomName(u),v&&v.source?h=v.source:(w=t.Af.getGlobalSourceModel()||t.getCalcSourceModel(),v=w.getSource().getCustomName(u),v&&v.source&&(h=v.source)),h&&(a!==c&&h===c||a===c&&h!==c)&&(y=d.Ih));return y}function R(a,b,c,d,e){return Q(a,d,e)}function S(a,b){return a.Qj===a.Rj&&b!==a.Qj}function T(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,q,r,s=!!e.source,t=e.source||a,u=e.rowRelative,v=e.columnRelative,w=b,x=c,y=f.Qj.kj;if(g&&g.isCustomName&&(l=e.row,m=e.column,w=f.Tj+(l-f.Vj)+y.DMc(f.Tj,l-f.Vj+1,!0),x=f.Uj+(m-f.Wj)+y.DMc(f.Uj,m-f.Wj+1)),n=f.Nj(w),o=f.Oj(x),(b>=0||!u)&&(c>=0||!v)){if(h=e.row+(u?b:0),i=e.column+(v?c:0),g&&g.isNameID||a===f.Rj&&(a===f.Qj?k=f.Pj(f.Qj,b,c,1,1):(q=b,r=c,g&&g.crossSheetMoved&&(q-=n,r-=o),k=f.Sj(f.Rj,q,r,1,1))),t===f.Qj&&f.Pj(t,h,i,1,1)&&!f.Sj(t,h,i,1,1)&&(!u&&!v||!k))return d.Ih;if(j=(s&&t===f.Rj||!s&&a===f.Rj)&&(!k&&f.Sj(f.Rj,h,i,1,1)||k&&f.Pj(f.Qj,u?h:h+n,v?i:i+o,1,1)),k&&(h-=u?n:0,i-=v?o:0),j&&(h+=n,i+=o),h-=u?b:0,i-=v?c:0,t=e.source,f.Rj!==f.Qj&&(j&&k?s&&(t=f.Qj):j?t=f.Qj:k&&!s&&(t=f.Rj)),h!==e.row||i!==e.column||t!==e.source)return d.rf(t,p,h,i,u,v)}else if((b>=0||!u)&&c===-1){if(h=e.row+(u?b:0),f.Pj(a,b,c,1,1)&&(h-=u?n:0),f.Sj(t,h,-1,1,-1))h+=n;else if(f.Pj(t,h,-1,1,-1))return d.Ih;if(h-=u?b:0,h!==e.row)return d.rf(e.source,p,h,e.column,u,e.columnRelative)}else if(b===-1&&c>=0&&!v){if(i=e.column+(v?c:0),f.Pj(a,b,c,1,1)&&(i-=v?o:0),f.Sj(t,h,i,1,1))i+=o;else if(f.Pj(t,h,i,1,1))return d.Ih;if(i-=v?c:0,h!==e.row||i!==e.column)return d.rf(e.source,e.endSource,e.row,i,e.rowRelative,v)}return e}function U(a,b){if(b=a.getIntersect(b,0,0),!b)return p;var c=a.row,d=a.col,e=a.rowCount,f=a.colCount;return a.rowCount===b.rowCount&&a.colCount===b.colCount||(a.rowCount===b.rowCount?(a.col===b.col&&(d=a.col+b.colCount),f=a.colCount-b.colCount):a.colCount===b.colCount&&(a.row===b.row&&(c=a.row+b.rowCount),e=a.rowCount-b.rowCount)),h.kf(c,d,e,f)}function V(a,b,c,d,e){var f,g;return!(!b||!a)&&(f=b.getIntersect(a,0,0),!(f||!(g=b.getIntersect(c,0,0)))||(!(!f||f.rowCount!==b.rowCount||0===e)||!(!f||f.colCount!==b.colCount||0===d)))}function W(a,b,c){var d=a.getRange(b,c);return h.kf(d.row,d.col,d.rowCount,d.colCount)}function X(a,b,c,d){var e,f=U(a,b);return f?(e=f.union(c),d?(e.col=a.col,e.colCount=a.colCount):(e.row=a.row,e.rowCount=a.rowCount)):e=c,{startRow:e.row,endRow:e.row+e.rowCount-1,startColumn:e.col,endColumn:e.col+e.colCount-1}}function Y(a,b,c,d,e){var f,g=U(a,b),h=a.getIntersect(b,0,0);return h?(h.row+=d,h.col+=e,f=g?g.union(h):c,{startRow:f.row,endRow:f.row+f.rowCount-1,startColumn:f.col,endColumn:f.col+f.colCount-1}):p}function Z(a,b){var c=a.row,d=a.col,e=a.rowCount,f=a.colCount,g=b.row,h=b.col,i=b.rowCount,j=b.colCount;return 1===e&&1!==f?h<d&&d<=h+j-1||h<=d+f-1&&d+f-1<h+j-1:1!==f||1===e||(g<c&&c<=g+i-1||g<=c+e-1&&c+e-1<g+i-1)}function $(a,b,c,d,e,f){var g,i,j,k,l=W(d,e,f),m=l.row,n=l.row+l.rowCount-1,o=l.col,p=l.col+l.colCount-1,q=a.Vj,r=q+a.Xj-1,s=a.Wj,t=s+a.Yj-1,u=a.Tj,v=a.Uj,w=h.kf(q,s,a.Xj,a.Yj),x=h.kf(u,v,a.Xj,a.Yj),y=l.getIntersect(x,0,0);if(V(w,l,x,b,c))if(i=0!==b,j=void 0,k=void 0,i)if(j=m>=q&&m<=r,k=n>=q&&n<=r,j&&k)m+=b,n+=b;else if(j&&!k)if(b<=0)m+=b;else if(q+b>n);else{if(!(r+b<n))return Y(l,w,x,b,c);if(q===m)return X(l,w,x,i);m+=b}else if(!j&&k)if(b>=0)n+=b;else if(r+b<m);else{if(!(u>m))return Y(l,w,x,b,c);if(r===n)return X(l,w,x,i);n+=b}else y&&!y.equals(x)&&Z(l,x)&&(g=U(l,y),m=g.row,n=g.row+g.rowCount-1,o=g.col,p=g.col+g.colCount-1);else if(j=o>=s&&o<=t,k=p>=s&&p<=t,j&&k)o+=c,p+=c;else if(j&&!k)if(c<0)o+=c;else if(s+c>p);else{if(!(t+c<p))return Y(l,w,x,b,c);if(s===o)return X(l,w,x,i);o+=c}else if(!j&&k)if(c>0)p+=c;else if(t+c<o);else{if(!(v>o))return Y(l,w,x,b,c);if(t===p)return X(l,w,x,i);p+=c}else y&&!y.equals(x)&&Z(l,x)&&(g=U(l,y),m=g.row,n=g.row+g.rowCount-1,o=g.col,p=g.col+g.colCount-1);return{startRow:m,endRow:n,startColumn:o,endColumn:p}}function _(a,b,c,d){return c>b||c+d-1<a}function aa(a,b,c,d){return c<=a&&c+d-1>=b}function ba(a,b,c,d){return c>a&&c+d-1<b}function ca(a,b,c,d){return c===a&&c+d-1<b||c>a&&c+d-1===b}function da(a,b,c,d){return c<a&&c+d-1>=a&&c+d-1<b||c>a&&c<=b&&c+d-1>b}function ea(a,b,c,d,e){return c<=a&&e<=a||c+d-1>=b&&e+d-1>=b}function fa(a,b,c,d,e){var f,g,h=[_,aa,ba,ca,da];for(g=0;g<h.length;g++)if(h[g](a,b,c,d)){f=g+"_";break}if(c===e)f+="9";else for(g=0;g<h.length;g++)if(c!==e&&h[g](a,b,e,d)){f+=g;break}return f}function ga(a,b,c,d,e){return{row:n(a.startRow,b),col:n(a.startColumn,c),endRow:m(a.endRow,d),endCol:m(a.endColumn,e)}}!function(a){a.outToOut="0_0",a.outToCover="0_1",a.outToInside="0_2",a.outToPart="0_3",a.outToCross="0_4",a.outNoMove="0_9",a.coverToOut="1_0",a.coverToCover="1_1",a.coverToCross="1_4",a.coverNoMove="1_9",a.insideToOut="2_0",a.insideToInside="2_2",a.insideToPart="2_3",a.insideToCross="2_4",a.insideNoMove="2_9",a.partToOut="3_0",a.partToInside="3_2",a.partToPart="3_3",a.partToCross="3_4",a.partNoMove="3_9",a.crossToOut="4_0",a.crossToCover="4_1",a.crossToInside="4_2",a.crossToPart="4_3",a.crossToCross="4_4",a.crossNoMove="4_9"}(w||(w={}));function ha(a,b,c,d,e){return a===e.Qj&&e.Tj<=b&&b<=e.Xj+e.Tj-1&&e.Uj<=c&&c<=e.Yj+e.Uj-1&&(b=b+e.Vj-e.Tj,c=c+e.Wj-e.Uj),{startRow:d.row+(d.rowRelative?b:0),endRow:d.endRow+(d.endRowRelative?b:0),startColumn:d.column+(d.columnRelative?c:0),endColumn:d.endColumn+(d.endColumnRelative?c:0)}}function ia(a,b,c,e,f,g,h,i,k){return j(g)&&(g=b.startRow),j(h)&&(h=b.startColumn),j(i)&&(i=b.endRow),j(k)&&(k=b.endColumn),d.uf(f||a.source,p,a.rowRelative?g-c:g,a.columnRelative?h-e:h,a.endRowRelative?i-c:i,a.endColumnRelative?k-e:k,a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,c,e)}function ja(a,b,c,e,f){var g,h,i,j,k,l,o,q,r,s,t=ha(a,b,c,e,f),u=e.source||a;if(f.Rj===u&&f.Qj===u)switch(g=fa(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj),h=fa(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj),i=g+"-"+h,j=f.Tj-f.Vj,k=f.Uj-f.Wj,l=ga(t,f.Vj,f.Wj,f.Vj+f.Xj-1,f.Wj+f.Yj-1),o=void 0,q=void 0,r=void 0,s=void 0,i){case w.outToCover+"-"+w.outToCover:case w.crossToCover+"-"+w.outToCover:case w.outToCover+"-"+w.crossToCover:case w.crossToCover+"-"+w.crossToCover:case w.coverToCover+"-"+w.outToCover:case w.outToCover+"-"+w.coverToCover:case w.coverNoMove+"-"+w.outToCover:case w.outToCover+"-"+w.coverNoMove:return d.Ih;case w.outToCross+"-"+w.outToCover:case w.coverToCross+"-"+w.outToCover:case w.insideToCross+"-"+w.outToCover:case w.partToCross+"-"+w.outToCover:case w.crossToCross+"-"+w.outToCover:case w.crossNoMove+"-"+w.outToCover:case w.outToCross+"-"+w.coverNoMove:case w.outToCross+"-"+w.coverToCover:case w.outToCross+"-"+w.crossToCover:case w.insideToCross+"-"+w.coverNoMove:case w.insideToCross+"-"+w.coverToCover:case w.insideToCross+"-"+w.crossToCover:return f.Tj<=t.startRow?ia(e,t,b,c,p,f.Tj+f.Xj):ia(e,t,b,c,p,p,p,f.Tj-1);case w.outToCover+"-"+w.outToCross:case w.outToCover+"-"+w.coverToCross:case w.outToCover+"-"+w.insideToCross:case w.outToCover+"-"+w.partToCross:case w.outToCover+"-"+w.crossToCross:case w.outToCover+"-"+w.crossNoMove:case w.coverNoMove+"-"+w.outToCross:case w.coverToCover+"-"+w.outToCross:case w.crossToCover+"-"+w.outToCross:case w.coverNoMove+"-"+w.insideToCross:case w.coverToCover+"-"+w.insideToCross:case w.crossToCover+"-"+w.insideToCross:return f.Uj<t.startColumn?ia(e,t,b,c,p,p,f.Uj+f.Yj):ia(e,t,b,c,p,p,p,p,f.Uj-1);case w.partToOut+"-"+w.coverNoMove:case w.crossToOut+"-"+w.coverNoMove:if(!ea(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj))return ia(e,t,b,c);case w.coverNoMove+"-"+w.partToOut:case w.coverNoMove+"-"+w.crossToOut:if(g===w.coverNoMove&&!ea(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj))return ia(e,t,b,c);case w.crossToInside+"-"+w.coverNoMove:case w.coverNoMove+"-"+w.crossToInside:return t.startRow>=f.Vj&&h===w.coverNoMove||t.startColumn>=f.Wj&&g===w.coverNoMove?ia(e,t,b,c,p,l.row+j,l.col+k):ia(e,t,b,c,p,p,p,l.endRow+j,l.endCol+k);case w.partToInside+"-"+w.coverNoMove:return t.startRow>=f.Vj?ia(e,t,b,c,p,m(l.row+j,l.endRow+1)):ia(e,t,b,c,p,p,p,n(l.endRow+j,l.row-1));case w.coverNoMove+"-"+w.partToInside:return t.startColumn>=f.Wj&&g===w.coverNoMove?ia(e,t,b,c,p,p,m(l.col+k,l.endCol+1)):ia(e,t,b,c,p,p,p,p,n(l.endCol+k,l.col-1));case w.partToCross+"-"+w.coverNoMove:case w.crossToPart+"-"+w.coverNoMove:case w.crossToCross+"-"+w.coverNoMove:if(ea(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj))return t.startRow>=f.Vj?ia(e,t,b,c,p,l.row+j):ia(e,t,b,c,p,p,p,l.endRow+j);case w.crossToCover+"-"+w.coverNoMove:case w.partToPart+"-"+w.coverNoMove:return f.Vj<f.Tj?ia(e,t,b,c,p,m(l.row+j,l.endRow+1),p,l.endRow+j):ia(e,t,b,c,p,l.row+j,p,n(l.endRow+j,l.row-1));case w.coverNoMove+"-"+w.partToCross:case w.coverNoMove+"-"+w.crossToPart:case w.coverNoMove+"-"+w.crossToCross:if(ea(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj))return t.startColumn>=f.Wj?ia(e,t,b,c,p,p,l.col+k):ia(e,t,b,c,p,p,p,p,l.endCol+k);case w.coverNoMove+"-"+w.crossToCover:case w.coverNoMove+"-"+w.partToPart:return f.Wj<f.Uj?ia(e,t,b,c,p,p,m(l.col+k,l.endCol+1),p,l.endCol+k):ia(e,t,b,c,p,p,l.col+k,p,n(l.endCol+k,l.col-1));case w.crossToCross+"-"+w.coverToCover:case w.crossToPart+"-"+w.coverToCover:case w.partToCross+"-"+w.coverToCover:if(ea(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj))return ia(e,t,b,c);case w.coverToCover+"-"+w.crossToCross:case w.coverToCover+"-"+w.crossToPart:case w.coverToCover+"-"+w.partToCross:if(g===w.coverToCover&&ea(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj))return ia(e,t,b,c);case w.coverToCover+"-"+w.partToPart:case w.partToPart+"-"+w.coverToCover:case w.coverToCover+"-"+w.crossToCover:case w.crossToCover+"-"+w.coverToCover:return ia(e,t,b,c,p,l.row+j,l.col+k,l.endRow+j,l.endCol+k);case w.partToPart+"-"+w.crossToCover:case w.partToCross+"-"+w.crossToCover:case w.crossToPart+"-"+w.crossToCover:case w.crossToCross+"-"+w.crossToCover:return ea(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj)?ia(e,t,b,c):(l.row===t.startRow?l.col===t.startColumn?(r=t.endColumn,s=l.col+k,o=l.endRow+j,q=l.row+j):(r=t.startColumn,s=l.endCol+k,o=g===w.partToCross||g===w.crossToCross?f.Vj+j-1:t.endRow,q=t.startRow):l.col===t.startColumn?(r=t.endColumn,s=l.col+k,o=t.endRow,q=g===w.partToCross||g===w.crossToCross?f.Vj+f.Xj-1+j+1:t.startRow):(r=t.startColumn,s=l.endCol+k,o=g===w.partToCross||g===w.crossToCross?l.row+j:t.startRow,q=l.endRow+j),ia(e,t,b,c,p,m(o,q),m(r,s),n(o,q),n(r,s)));case w.crossToCover+"-"+w.partToPart:case w.crossToCover+"-"+w.partToCross:case w.crossToCover+"-"+w.crossToPart:case w.crossToCover+"-"+w.crossToCross:return ea(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj)?ia(e,t,b,c):(l.row===t.startRow?l.col===t.startColumn?(r=l.endCol+k,s=l.col+k,o=t.endRow,q=l.row+j):(r=t.endColumn,s=h===w.partToCross||h===w.crossToCross?f.Wj+f.Yj-1+k+1:t.startColumn,o=t.endRow,q=l.row+j):l.col===t.startColumn?(r=t.startColumn,s=h===w.partToCross||h===w.crossToCross?f.Wj+k-1:t.endColumn,o=l.endRow+j,q=t.startRow):(r=h===w.partToCross||h===w.crossToCross?l.col+k:t.startColumn,s=l.endCol+k,o=t.startRow,q=l.endRow+j),ia(e,t,b,c,p,m(o,q),m(r,s),n(o,q),n(r,s)));case w.coverToOut+"-"+w.coverToOut:case w.coverToOut+"-"+w.coverToCross:case w.coverToOut+"-"+w.coverToCover:case w.coverToOut+"-"+w.coverNoMove:case w.coverToCross+"-"+w.coverToOut:case w.coverToCross+"-"+w.coverToCross:case w.coverToCross+"-"+w.coverToCover:case w.coverToCross+"-"+w.coverNoMove:case w.coverToCover+"-"+w.coverToOut:case w.coverToCover+"-"+w.coverToCross:case w.coverToCover+"-"+w.coverToCover:case w.coverToCover+"-"+w.coverNoMove:case w.coverNoMove+"-"+w.coverToOut:case w.coverNoMove+"-"+w.coverToCross:case w.coverNoMove+"-"+w.coverToCover:return ia(e,t,b,c,p,t.startRow+j,t.startColumn+k,t.endRow+j,t.endColumn+k);default:return ia(e,t,b,c)}}function ka(a,b,c,e,f,g,h,i){var j,k,l,m,n,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=!!e.source,O=N?e.source:a,P=g&&g.isDataValidator,Q=S(f,a),R=!1,T=e.rowRelative,U=e.columnRelative,V=e.endRowRelative,W=e.endColumnRelative;if(b>=0||!T||!V||c>=0||!U||!W){if(j=e.row+(T?b:0),k=e.endRow+(V?b:0),l=e.column+(U?c:0),m=e.endColumn+(W?c:0),n=k-j+1,q=m-l+1,!P&&Q){if(z=f.Sj(O,j,l,n,q))return e.offset(h,i,!0,b,c);if(f.Pj(O,j,l,n,q))return d.Ih;if(O!==f.Rj||O!==f.Qj||0!==h&&0!==i)return e;R=!0}if(g&&g.isNameID||a===f.Rj&&(a===f.Qj?y=f.Pj(f.Qj,b,c,1,1):(A=b,B=c,g&&g.crossSheetMoved&&(A-=h,B-=i),y=f.Sj(f.Rj,A,B,1,1))),(R||a===O&&a===f.Rj&&a===f.Qj)&&(C=b,D=c,y&&(C-=h,D-=i),0===h||0===i)){if(E=$(f,h,i,e,C,D),!E)return d.Ih;if(0===i&&h&&E.endColumn>=m&&E.startColumn<=l||0===h&&i&&E.endRow>=k&&E.startRow<=j)return F=E.startRow,G=E.startColumn,H=E.endRow,I=E.endColumn,F===j&&H===k&&G===l&&I===m?e:(T&&(F-=b),V&&(H-=b),U&&(G-=c),W&&(I-=c),d.uf(e.source,p,F,G,H,I,T,U,V,W,b,c))}if(y&&(J=f.Tj-f.Vj,K=f.Uj-f.Wj,n+=(T?-J:0)+(V?J:0),q+=(U?-K:0)+(W?K:0)),O===f.Qj&&f.Pj(O,j,l,n,q)&&!q&&(!T&&!U&&!V&&!W||!y))return d.Ih;if(x=(N&&O===f.Rj||!N&&a===f.Rj)&&(!y&&f.Sj(f.Rj,j,l,n,q)||y&&f.Pj(f.Qj,T?j:j+h,U?l:l+i,n,q)),y&&(t=T?h:0,u=V?h:0,v=U?i:0,w=W?i:0,j-=t,k-=u,l-=v,m-=w),L=!1,x)r=h,s=i,j+=r,k+=r,l+=s,m+=s;else if(f.Pj(O,j,l,n,q)){if(M=f.intersectWith(O,j,l,n,q),!M||M.rowCount!==n&&M.colCount!==q)return d.Ih;j=M.row+h,l=M.col+i,k=j+M.rowCount,m=l+M.colCount,L=!0}if(j-=T?b:0,k-=V?b:0,l-=U?c:0,m-=W?c:0,f.Rj===f.Qj?O=N?e.source:o:(O=e.source,x&&y&&N?O=f.Qj:x&&y||(x?O=f.Qj:y&&!N&&(O=f.Rj))),j!==e.row||l!==e.column||k!==e.endRow||m!==e.endColumn||L||O!==e.source)return d.uf(O,p,j,l,k,m,T,U,V,W,b,c)}else if(!(b>=0)&&T&&V||c!==-1){if(b===-1&&(c>=0||!U||!W)){if(l=e.column+(U?c:0),m=e.endColumn+(W?c:0),l>m)return d.Ih;if(f.Pj(a,b,c,1,1)&&(v=U?i:0,w=W?i:0,l-=v,m-=w),q=m-l+1,f.Sj(O,-1,l,-1,q))s=i,l+=s,m+=s;else if(f.Pj(O,-1,l,-1,q))return d.Ih;if(l-=U?c:0,m-=W?c:0,l!==e.column||m!==e.endColumn)return d.uf(e.source,p,e.row,l,e.endRow,m,e.rowRelative,U,e.endRowRelative,W,b,c)}}else{if(j=e.row+(T?b:0),k=e.endRow+(V?b:0),j>k)return d.Ih;if(f.Pj(a,b,c,1,1)&&(t=T?h:0,u=V?h:0,j-=t,k-=u),n=k-j+1,f.Sj(O,j,-1,n,-1))r=h,j+=r,k+=r;else if(f.Pj(O,j,-1,n,-1))return d.Ih;if(j-=T?b:0,k-=V?b:0,j!==e.row||k!==e.endRow)return d.uf(e.source,p,j,e.column,k,e.endColumn,T,e.columnRelative,V,e.endColumnRelative,b,c)}}function la(a,b,c,e,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=!!e.source,L=K?e.source:a,M=e.tf(),N=b,O=c,P=g.Qj.kj;if(h&&h.isCustomName&&(r=e.row,s=e.column,N=g.Tj+(r-g.Vj)+P.DMc(g.Tj,r-g.Vj+1,!0),O=g.Uj+(s-g.Wj)+P.DMc(g.Uj,s-g.Wj+1)),t=g.Nj(N),u=g.Oj(O),0===M){if(v=!g.HPJ&&ja(a,b,c,e,g))return v;if(v=ka(a,b,c,e,g,h,t,u))return v}else if(1===M){if(i=e.rowRelative,k=e.endRowRelative,b>=0||!i||!k){if(m=e.row+(i?b:0),n=e.endRow+(k?b:0),m>n)return d.Ih;if(q=a===g.Rj&&a===g.Qj&&g.Pj(g.Qj,b,c,1,1),L===g.Rj&&L===g.Qj&&0===g.Wj&&0===g.Uj&&g.Yj===L.getColumnCount()){if(w=g.Vj,x=g.Tj,y=g.Xj,q&&(m-=t,n-=t),z=w+y,A=m>=w&&z>m,B=n>=w&&z>n,A&&B)return q?e:e.offset(t,u,!0,b,c);if(C=x+y,A&&x<=n?(m+=t,C>n&&n>=x&&(n=C-1,m=z)):B&&C>=m&&(n+=t,x<=m&&o<C&&(m=x,n=w-1)),m-=i?b:0,n-=k?b:0,m!==e.row||n!==e.endRow)return d.uf(e.source,e.endSource,m,f.BAND_INDEX_CONST,n,f.BAND_INDEX_CONST,i,j,k,l,b,c)}if(q)return e.offset(-t,u,!0,b,c)}}else if(2===M){if(j=e.columnRelative,l=e.endColumnRelative,o=e.column+(j?c:0),p=e.endColumn+(l?c:0),o>p)return d.Ih;if(q=a===g.Rj&&a===g.Qj&&g.Pj(g.Qj,b,c,1,1),L===g.Rj&&L===g.Qj&&0===g.Vj&&0===g.Tj&&g.Xj===L.getRowCount()){if(D=g.Wj,E=g.Uj,F=g.Yj,q&&(o-=u,p-=u),G=D+F,H=o>=D&&G>o,I=p>=D&&G>p,H&&I)return q?e:e.offset(t,u,!0,b,c);if(J=E+F,H&&E<=p?(o+=u,J>p&&p>=E&&(p=J-1,o=G)):I&&J>=o&&(p+=u,E<=o&&o<J&&(o=E,p=D-1)),o-=j?c:0,p-=l?c:0,o!==e.column||p!==e.endColumn)return d.uf(e.source,e.endSource,f.BAND_INDEX_CONST,o,f.BAND_INDEX_CONST,p,i,j,k,l,b,c)}if(q)return e.offset(t,-u,!0,b,c)}return e}function ma(a,b,c,e,f,g,h){var i,j,k,l,m,n,q,r=ma,s=e;if(1===e.type&&e.sf())s=g?T(a,b,c,e,f,h):oa(a,b,c,e,f);else if(1===e.type)s=g?la(a,b,c,e,f,h):pa(a,b,c,e,f);else if(10===e.type)i=r(a,b,c,e.value,f,g,h),i!==e.value&&(s=d.Lh(i));else if(9===e.type)j=r(a,b,c,e.value,f,g,h),k=e.value2&&r(a,b,c,e.value2,f,g,h),j===e.value&&k===e.value2||(s=d.Kh(e.operatorType,j,k));else if(7===e.type){for(l=p,m=void 0,n=void 0,q=e.arguments.length,n=0;n<q;n++)if(m=e.arguments[n],i=r(a,b,c,m,f,g,h),i!==m){l=[],l[n]=i;break}if(l){for(n=0;n<q;n++)m=e.arguments[n],l[n]!==o&&l[n]!==p||(l[n]=r(a,b,c,m,f,g,h));s=d.Jh(e,l)}d.isExpression(e.function)&&(s.function=r(a,b,c,e.function,f,g,h))}return s}b.adjustFormulaOnMoveSwap=ma;function na(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=b.Rj.getSheet();if(q.mJb!==!0)for(d=q.ITa.dUa(),e=0;e<a.length;e++)if(f=a[e].validator,g=f.n5,h=s(g),i=h.r,j=h.c,k=a[e].sheet,l=k.yj(),m=f.condition(),n=m.getExpressions(),n&&n.length>0){for(o=0;o<n.length;o++)p=n[o],n[o]=ma(l,i,j,p,b,c,{isDataValidator:!0});m.setExpressions(n,d)}}function oa(a,b,c,e,f){var g,h,i=e.source||a,j=e.rowRelative,k=e.columnRelative,l=f.Nj(b),m=f.Oj(c);if((b>=0||!j)&&(c>=0||!k)){if(g=e.row+(j?b:0),h=e.column+(k?c:0),f.Pj(a,b,c,1,1)?(g-=j?l:0,
h-=k?m:0):f.Sj(a,g,h,1,1)&&(g+=j?l:0,h+=k?m:0),f.Sj(i,g,h,1,1)?(g+=l,h+=m):f.Pj(i,g,h,1,1)&&(g-=l,h-=m),g-=j?b:0,h-=k?c:0,g!==e.row||h!==e.column)return d.rf(e.source,p,g,h,j,k)}else if((b>=0||!j)&&c===-1){if(g=e.row+(j?b:0),f.Pj(a,b,-1,1,-1)?g-=j?l:0:f.Sj(a,g,-1,1,-1)&&(g+=j?l:0),f.Sj(i,g,-1,1,-1)?g+=l:f.Pj(i,g,-1,1,-1)&&(g-=l),g-=j?b:0,g!==e.row||h!==e.column)return d.rf(e.source,p,g,e.column,j,e.columnRelative)}else if(b===-1&&c>=0&&!k&&(h=e.column+0,f.Pj(a,-1,c,-1,1)?h-=0:f.Sj(a,-1,h,-1,1)&&(h+=0),f.Sj(i,-1,h,-1,1)?h+=m:f.Pj(i,-1,h,-1,1)&&(h-=m),h-=0,g!==e.row||h!==e.column))return d.rf(e.source,p,e.row,h,e.rowRelative,k);return e}function pa(a,b,c,e,g){var h,i,j,k,l,m,n,o,q,r,s,t,u,v,w,x,y=e.source||a,z=e.tf(),A=g.Nj(b),B=g.Oj(c);if(0===z){if(n=e.rowRelative,o=e.columnRelative,q=e.endRowRelative,r=e.endColumnRelative,!(b>=0)&&n&&q||!(c>=0)&&o&&r)if(!(b>=0)&&n&&q||c!==-1){if(b===-1&&(c>=0||!o||!r)){if(j=e.column+(o?c:0),k=e.endColumn+(r?c:0),j<k)return d.Ih;if(g.Pj(a,-1,c,-1,1)?(v=o?B:0,x=r?B:0,j-=v,k-=x):g.Sj(a,-1,c,-1,1)&&(v=o?B:0,x=r?B:0,j+=v,k+=x),m=k-j,g.Sj(y,-1,j,-1,m)?(t=B,j+=t,k+=t):g.Pj(y,-1,j,-1,m)&&(t=B,j-=t,k-=t),j-=o?c:0,k-=r?c:0,j!==e.column||k!==e.endColumn)return d.uf(e.source,p,j,e.endRow,k,e.rowRelative,o,e.endRowRelative,r,b,c)}}else{if(h=e.row+(n?b:0),i=e.endRow+(q?b:0),h<i)return d.Ih;if(g.Pj(a,b,-1,1,-1)?(u=n?A:0,w=n?A:0,h-=u,i-=w):g.Sj(a,b,-1,1,-1)&&(u=n?A:0,w=n?A:0,h+=u,i+=w),l=i-h,g.Sj(y,h,-1,l,-1)?(s=A,h+=s,i+=s):g.Pj(y,h,-1,l,-1)&&(s=A,h-=s,i-=s),h-=n?b:0,i-=q?b:0,h!==e.row||i!==e.endRow)return d.uf(e.source,p,h,e.column,i,e.endColumn,n,e.columnRelative,q,e.endColumnRelative,b,c)}else if(h=e.row+(n?b:0),i=e.endRow+(q?b:0),j=e.column+(o?c:0),k=e.endColumn+(r?c:0),l=i-h,m=k-j,g.Pj(a,b,c,1,1)?(u=n?A:0,v=o?B:0,w=q?A:0,x=r?B:0,h-=u,i-=w,j-=v,k-=x):g.Sj(a,h,j,l,m)&&(u=n?A:0,v=o?B:0,w=q?A:0,x=r?B:0,h+=u,i+=w,j+=v,k+=x),g.Sj(y,h,j,l,m)?(s=A,t=B,h+=s,i+=s,j+=t,k+=t):g.Pj(y,h,j,l,m)&&(s=A,t=B,h-=s,i-=s,j-=t,k-=t),h-=n?b:0,i-=q?b:0,j-=o?c:0,k-=r?c:0,h!==e.row||j!==e.column||i!==e.endRow||k!==e.endColumn)return d.uf(e.source,p,h,j,i,k,n,o,q,r,b,c)}else if(1===z){if(n=e.rowRelative,q=e.endRowRelative,b>=0||!n||!q){if(h=e.row+(n?b:0),i=e.endRow+(q?b:0),h<i)return d.Ih;if(g.Pj(a,b,-1,1,-1)?(u=n?A:0,w=q?A:0,h-=u,i-=w):g.Sj(a,b,-1,1,-1)&&(u=n?A:0,w=q?A:0,h+=u,i+=w),l=i-h,g.Sj(y,h,-1,l,-1)?(s=A,h+=s,i+=s):g.Pj(y,h,-1,l,-1)&&(s=A,h-=s,i-=s),h-=n?b:0,i-=q?b:0,h!==e.row||i!==e.endRow)return d.uf(e.source,p,h,f.BAND_INDEX_CONST,i,f.BAND_INDEX_CONST,n,!1,q,!1,b,c)}}else if(2===z){if(o=e.columnRelative,r=e.endColumnRelative,j=e.column+(o?c:0),k=e.endColumn+(r?c:0),j>k)return d.Ih;if(g.Pj(a,-1,c,-1,1)?(v=o?B:0,x=r?B:0,j-=v,k-=x):g.Sj(a,-1,c,-1,1)&&(v=o?B:0,x=r?B:0,j+=v,k+=x),m=k-j,g.Sj(y,-1,j,-1,m)?(t=B,j+=t,k+=t):g.Pj(y,-1,j,-1,m)&&(t=B,j-=t,k-=t),j-=o?c:0,k-=r?c:0,j!==e.column||k!==e.endColumn)return d.uf(e.source,p,f.BAND_INDEX_CONST,j,f.BAND_INDEX_CONST,k,!1,o,!1,r,b,c)}return e}function qa(a,b,c,d,e,f){a._g(b,c,d,e,!0,!1,f)}function ra(a,b,c){var e,f,g,h,i,j,k,l=ra,m=b;if(8===b.type){if(b.value===c&&(!b.source||b.source===a.getSource()))return d.Hh(r,b.source)}else if(10===b.type)e=l(a,b.value,c),e!==b.value&&(m=d.Lh(e));else if(9===b.type)h=l(a,b.value,c),i=b.value2&&l(a,b.value2,c),h===b.value&&i===b.value2||(m=d.Kh(b.operatorType,h,i));else if(7===b.type){for(j=p,k=b.arguments.length,g=0;g<k;g++)if(f=b.arguments[g],e=l(a,f,c),e!==f){j=[],j[g]=e;break}if(j){for(g=0;g<k;g++)f=b.arguments[g],j[g]!==o&&j[g]!==p||(j[g]=l(a,f,c));m=d.Jh(b,j)}}return m}},"./dist/plugins/sheetsCalc/parser-sheets.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("@grapecity/js-calc"),g=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=c("./dist/plugins/sheetsCalc/calc.ns.js"),i=c("./node_modules/util/util.js"),j=d.util.xq,k=new e.Common.ResourceManager(d.SR),l=k.getResource.bind(k),b.maxRowCount=d.XmlConstants.M7,b.maxColumnCount=d.XmlConstants.L7,m=[1,26,676],n=void 0,o=null,p=["#all","#data","#headers","#totals","#this row"],q={" ":!0,"'":!0,"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"\uff08":!0,"\uff09":!0,".":!0,";":!0,",":!0,"`":!0,"+":!0,"~":!0,"\uff01":!0,"":!0,"\u3001":!0,"\uff5d":!0,"\uff5b":!0,"\u3010":!0,"\u3011":!0,"-":!0,"\uff1b":!0,"\uff1a":!0,"\u2018":!0,"\u201c":!0,"\u201d":!0,"\u2019":!0,"\uff0c":!0,"\u3002":!0,"=":!0},r=/^(R|C|RC)?(0*[1-9]\d*)/,s=/^[A-z]{1,3}0*[1-9]\d{0,6}$/,t=/[\u00A2\u00A3\u00A5\u00A6\u00A9\u00AB\u00AC\u00AE\u09E6-\u09EF\u09F2-\u0A03\u0AE2-\u0AF1\u0BE6-\u0BFA\u0E3F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u181F\u1878-\u187F\u18A9\u18AB-\u18FF\u191D-\u194F\u196E\u196F\u1975-\u197F\u19AA-\u19C0\u19C8-\u19FF\u2000-\u200F\u2011\u2012\u2017\u201A\u201B\u201E\u201F\u2022-\u2024\u2028-\u202F\u2031\u2034\u2036-\u203A\u203C-\u2070\u2072\u2073\u2075-\u207E\u2080\u2085-\u208F\u2095-\u20CF\u2100\u2101\u2104\u2106\u2108\u2114\u2117\u2118\u211E-\u2120\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u2152\u2155-\u215A\u215F\u2189-\u218F\u219A-\u21D1\u21D3\u21D5-\u21FF\u2201\u2204-\u2206\u2209\u220A\u220C-\u220E\u2210\u2212-\u2214\u2216-\u2219\u221B\u221C\u2221\u2222\u2224\u2226\u222D\u222F-\u2233\u2238-\u223B\u223E-\u2247\u2249-\u224B\u224D-\u2251\u2253-\u225F\u2262\u2263\u2268\u2269\u226C\u226D\u2270-\u2281\u2284\u2285\u2288-\u2294\u2296-\u2298\u229A-\u22A4\u22A6-\u22BE\u22C0-\u2311\u2313-\u245F\u24B6-\u24CF\u24EA-\u24FF\u254C-\u254F\u2575-\u2580\u2590\u2591\u2596-\u259F\u25A2\u25AA-\u25B1\u25B4\u25B5\u25B8-\u25BB\u25BE\u25BF\u25C2-\u25C5\u25C9\u25CA\u25CC\u25CD\u25D2-\u25E1\u25E6-\u25EE\u25F0-\u2604\u2607\u2608\u260A-\u260D\u2610-\u261B\u261D\u261F-\u263F\u2641\u2643-\u265F\u2662\u2666\u266B\u266E\u2670-\u2BFF\u3004\u3018-\u301C\u3020\u302A-\u3030\u3036\u3037\u303F\u321D-\u321F\u322A-\u3230\u3233-\u3238\u323A-\u325F\u327C-\u327E\u3280-\u32A2\u32A9-\u3302\u3304-\u330C\u330E-\u3313\u3315-\u3317\u3319-\u3321\u3324\u3325\u3328-\u332A\u332C-\u3335\u3337-\u333A\u333C-\u3348\u334B\u334C\u334E-\u3350\u3352-\u3356\u3358-\u337A\u337F\u3385-\u3387\u33CB\u33CC\u33D4\u33D7\u33D9\u33DA\u33DE-\u33FF\uD80B-\uD83F\uFDFC-\uFE2F\uFE32\uFE45-\uFE48]/;function D(a){return j(a+1).split("")}function E(a,b){var c=b+1;return a<0?a%c+c:a>b?a%c:a}function F(a){return new f.ErrorSource(a)}function G(a,b,c,d,e,f,g){return 3===g||c>=0&&d>=0||1===g&&c>=0||2===g&&d>=0}function H(a,b,c,d,e){var g,i,j=h.BAND_INDEX_CONST,k={cj:j,dj:j,ej:!0,fj:!0,gj:!1,li:0,Vka:!0},l=b?L(a,c,d,0):K(a,0,e);return l.hj?(k.cj=l.ij,k.ej=l.jj):(k.dj=l.ij,k.fj=l.jj),k.li=l.li,k.gj=l.gj,!l.gj||l.li>=a.length?k:!b&&l.hj||b&&!l.hj?{gj:!1}:(g=a[k.li],!b&&(f.isNumber(g)||"$"===g)||b&&("C"===g||"c"===g)?(i=b?L(a,c,d,k.li):K(a,k.li,e),k.li=i.li,!i.gj||!b&&!i.hj||b&&i.hj?(k.gj=!1,k):(k.li<a.length&&(k.Vka=!1),b?(k.dj=i.ij,k.fj=i.jj):(k.cj=i.ij,k.ej=i.jj),k.gj=!0,k)):{gj:!1})}u=[1,10,100,1e3,1e4,1e5,1e6,1e6];function I(a){return f.ei(a)||95===a.charCodeAt(0)}function J(a,b,c){for(var d=a,e=b[a],f=!1;d<c&&!I(e);)d++,d<c&&(e=b[d]);if(d<c){for(;d<c&&I(e);)d++,d<c&&(e=b[d]);d<c&&(f=!0)}return f}function K(a,c,d){var e,g,h,i,j,k,l,n,o,p={jj:!0,gj:!1},q=a.length;if(c>=q)return p;if("$"===a[c]&&(p.jj=!1,c++),c>=q)return p;if(e=c,g=0,h=a[e],f.isNumber(h)&&"0"!==h){for(p.hj=!0;e<q&&f.isNumber(h);)e++,e<q&&(h=a[e]);if(e-c>7)return p;for(i=e-1,j=0;i>=c;i--,j++)g+=(a[i].charCodeAt(0)-48)*u[j];if(g<=b.maxRowCount)return p.ij=g-1,p.li=e,p.gj=!0,p}else if(f.ei(h)){for(p.hj=!1;e<q&&f.ei(h);)e++,e<q&&(h=a[e]);if(k=e-c,k>3)return p;if(J(e,a,q))return p;for(g=0,l=e-1,n=l;n>=c;n--){if(o=a[n].charCodeAt(0),!(o>=65&&o<=90||o>=97&&o<=122))return p;g+=((32|o)-96)*m[l-n]}if(g<=b.maxColumnCount)return p.ij=g-1,p.li=e,p.gj=!0,p}return p}function L(a,c,d,e){var g,i,j,k,l,m=h.BAND_INDEX_CONST,n={li:e,ij:m,hj:!0,jj:!1,gj:!1},o=a.length;if(e>=o)return n;if(g=e,i=a[g],"R"===i||"r"===i)n.hj=!0,j=c;else{if("C"!==i&&"c"!==i)return n;n.hj=!1,j=d}if(e++,g++,e>=o)return n.li=e,n.ij=j,n.jj=!0,n.gj=!0,n;if(i=a[g],"["===i&&(e++,g++,n.jj=!0),e>=o)return n;if(k=!1,i=a[g],n.jj&&"-"===i&&(e++,g++,k=!0),e>=o)return n;if(i=a[g],!f.isNumber(i))return n.jj?n:(n.li=e,n.ij=j,n.jj=!0,n.gj=!0,n);for(;g<o&&f.isNumber(i);)g++,g<o&&(i=a[g]);if(l=parseInt(a.slice(e,g).join(""),10),n.jj){if(g>=o||"]"!==a[g])return n;g++}return l<(n.hj?b.maxRowCount:b.maxColumnCount)?(n.jj?(l=k?-l:l,n.ij=l+j):n.ij=l-1,n.li=g,n.gj=!0,n):void 0}function M(a,b,c,d){var e,g,h=a.row||0,i=a.column||0;if(c.source===f.BangSource)d.push("!");else if(c.source&&(e=P(a,d,c.source,c.endSource),!e))return void d.push("#","R","E","F","!");g=c.type,8===g||5===g?d.push(""+c.value):c.value&&c._error?d.push(""+c.value):c.sf()?(!c.source&&a.addSheetName&&a.source&&P(a,d,a.source,n),N(a.useR1C1,h,i,c.row,c.column,c.rowRelative,c.columnRelative,d)):(!c.source&&a.addSheetName&&a.source&&P(a,d,a.source,n),O(a.source,a.useR1C1,h,i,c.row,c.column,c.endRow,c.endColumn,c.rowRelative,c.columnRelative,c.endRowRelative,c.endColumnRelative,d,c.tf()))}function N(a,c,d,e,g,h,i,j,k){var l,m;if(k=k||0,l=b.maxRowCount-1,(0===k||1===k)&&e>-l&&e<=2*l&&(e+=h?c:0,e=E(e,l)),m=b.maxColumnCount-1,(0===k||2===k)&&g>-m&&g<=2*m&&(g+=i?d:0,g=E(g,m)),!G(c,d,e,g,h,i,k))return void j.push(""+f.Errors.Reference);if(a){if(2!==k&&(j.push("R"),e>=0&&(c!==e||!h)&&(h?j.push("["+(e-c)+"]"):(e++,j.push(e+""))),g<0))return;1!==k&&(j.push("C"),d===g&&i||(i?j.push("["+(g-d)+"]"):(g++,j.push(g+""))))}else{if(g>=0&&(i||j.push("$"),j.push.apply(j,D(g))),e<0)return;e++,h||j.push("$"),j.push(e+"")}}function O(a,c,d,e,f,g,i,j,k,l,m,n,o,p){p=p||0,3===p&&(f=0,i=b.maxRowCount-1,p=1),N(c,d,e,f,g,k,l,o,p);var q=h.BAND_INDEX_CONST;(!c||f!==i||g!==j||i!==q&&j!==q)&&(i===q&&j===q||(o.push(":"),N(c,d,e,i,j,m,n,o,p)))}function P(a,b,c,d){if(a.getExternalSourceToken){if(c!==f.BangSource){var e=Q(a,a.getExternalSourceToken(c).split(""),d&&a.getExternalSourceToken(d).split(""));if(!(e.length>0))return!1;b.push.apply(b,e)}return b.push("!"),!0}return!1}function Q(a,b,c){if(!b||0===b.length)return[];var d=b,e;if(T(b,!1,a.Eh)||c&&T(c,!1,a.Eh)){for(d=["'"],e=0;e<b.length;e++)"'"===b[e]&&d.push("'"),d.push(b[e]);if(c)for(d.push(":"),e=0;e<c.length;e++)"'"===c[e]&&d.push("'"),d.push(c[e]);d.push("'")}else if(c)for(d.push(":"),e=0;e<c.length;e++)d.push(c[e]);return d}function R(a,b,c){var d,g;if(!a||0===a.length)return!0;if(!b){if(f.isNumber(a[0]))return!1;if(V(a))return!1;if(t.test(a[0]))return!1}for(g=0;g<a.length;g++)if(d=a[g],b){if("*"===d||":"===d||"["===d||"]"===d||"?"===d||"\\"===d||"/"===d)return!1}else if(q[d]||f.operaterTypesMap[d]||"\u3000"===d&&(c||e.Common.CultureManager.q4().isJCKCulture))return!1;return!0}b.jma=R,b.validateSheetName=R,v={"'":1,"[":1,"]":1,"?":1,"%":1," ":1};function S(a){var b,c;if(!a||0===a.length)return!0;for(c=0;c<a.length;c++)if(b=a[c],v[b]||f.operaterTypesMap[b])return!1;return!0}function T(a,b,c){var d,e,g,h;if(f.isDigit(+a[0]))return!0;if(d=a,e=a.lastIndexOf("["),e>0)return!0;if(0===e){if(g=a.lastIndexOf("]"),!(g>0))return!0;if(h=a.slice(1,g),!S(h))return!0;d=a.slice(g+1)}return!R(d,b,c)}function U(a){var c=a.search(/[0-9]/),d=a.substr(0,c),e=parseInt(a.substr(c),10);return(c<=2||3===c&&d<="XFD")&&e<=b.maxRowCount}function V(a){var b=a.join("").toUpperCase();return!!("RC"===b||"C"===b||"R"===b||r.test(b)||s.test(b)&&U(b))}function W(a){var b=new f.Expression(8);return b.value=a,b}function X(a){var b=a;return a&&a.length>=3&&"["===a[0]&&"0"===a[1]&&"]"===a[2]&&(b=3===a.length?"":a.substring(3)),b}function Y(a,b,c){var d,e,f,g,h,i=a.source;return i&&(e=i.q$a,f=i.pDc,g=i.qDc,e&&(h=b>=0&&b<f&&c>=g||b>=f&&c>=0&&c<g,h&&(d=i))),d}w=function(a){C(b,a);function b(b){var c=a.call(this,8e3)||this;return c.kj=b,c}return b.prototype.resolveToken=function(a,b,c,d){var e,g,j,k,l,m,n,p,q,r,s,t,u,v,w,x,y,z=a.useR1C1,A=a.row||0,B=a.column||0,C=c.length,D=c[d],E=D.ni,G=D.Nc,I=D.hi;if(0!==G&&6!==I)return!1;if(0===G&&0===I&&d<C-2&&":"===c[d+1].ni&&12===c[d+2].hi&&c[d+2].ni.indexOf(":")<0||0===G&&12===I){if(l=void 0,m=void 0,E&&(E.indexOf(":")>0&&E.indexOf("[")===-1?(n=E.indexOf(":"),l=E.substring(1,n-1),m=E.substring(n+1,E.length-2)):(l=E,"'"===l.charAt(0)&&(l=l.substring(1,l.length-1)),0===I&&(m=c[d+2].ni,"'"===m.charAt(0)&&(m=m.substring(1,m.length-1))))),d++,k=!!l,l=X(l),l&&(g=E?a.getExternalSource("",l):f.BangSource,g=g||F(l),m=X(m),m&&(j=a.getExternalSource("",m),j=j||F(m),d+=2)),D=c[d],D&&"["===D.Qb[0])return!1;if(!D)return W(E);E=D.ni}if(p=d===C-1?o:c[d+1],Z(c,D,d,z,!0)){if(q=a&&a.source&&a.source.Af&&a.source.Af.allowDynamicArray,r=H(D.Qb,z,A,B,q),!r.gj&&!k)return!1;if(D.hi=7,r.gj&&r.Vka){if(s=r.cj,t=r.dj,u=r.ej,v=r.fj,d<C-2&&5===p.Nc&&":"===p.ni&&(p=c[d+2],Z(c,p,d+2,z,!1)&&(w=H(p.Qb,z,A,B),w.gj&&s===h.BAND_INDEX_CONST==(w.cj===h.BAND_INDEX_CONST)&&t===h.BAND_INDEX_CONST==(w.dj===h.BAND_INDEX_CONST))))return A=s===h.BAND_INDEX_CONST?0:A,B=t===h.BAND_INDEX_CONST?0:B,{index:d+3,expr:f.uf(g,j,s-(u?A:0),t-(v?B:0),w.cj-(w.ej?A:0),w.dj-(w.fj?B:0),u,v,w.ej,w.fj,A,B)};if(s===h.BAND_INDEX_CONST||t===h.BAND_INDEX_CONST){if(z)return s-=s!==h.BAND_INDEX_CONST&&u?A:0,t-=t!==h.BAND_INDEX_CONST&&v?B:0,{index:d+1,expr:f.uf(g,j,s,t,s,t,u,v,u,v,A,B)};if(!g)return!1;e=W(E)}if(!e)return i.isNullOrUndefined(g)&&(g=Y(a,A,B)),x=s-(u?A:0),y=t-(v?B:0),e=f.rf(g,j,x,y,u,v),{index:d+1,expr:e}}else e=W(E)}else if(6===D.hi)e=new f.Expression(5),e.value=f.CalcError.parse(D.ni);else{if(!g)return!1;e=W(E)}return g&&(e.source=g),j&&(e.endSource=j),{index:d+1,expr:e}},b.prototype.unparse=function(a,b,c,d){var e=c&&c.type;return(1===e||8===e||5===e)&&(M(a,b,c,d),!0)},b}(f.TokenResolver),b.SheetReferenceResolver=w;function Z(a,b,c,d,e){return 0===b.Nc&&0===b.hi||!d&&0===b.Nc&&4===b.hi&&(!e||c<a.length-2&&":"===a[c+1].ni&&0===a[c+2].Nc&&4===a[c+2].hi)}!function(a){a[a.ThisRow=1]="ThisRow",a[a.Headers=2]="Headers",a[a.Data=3]="Data",a[a.Totals=8]="Totals",a[a.HeadersAndData=6]="HeadersAndData",a[a.DataAndTotals=12]="DataAndTotals",a[a.All=14]="All",a[a.NotSpecific=16]="NotSpecific"}(x=b.StructReferencePortions||(b.StructReferencePortions={})),function(a){a[a.All=1]="All",a[a.NotSpecific=1]="NotSpecific",a[a.SingleColumn=2]="SingleColumn",a[a.ColumnRange=4]="ColumnRange"}(y=b.StructReferenceColumnSpecifier||(b.StructReferenceColumnSpecifier={}));function $(a,b,c,d,e){return b<=a.startRow()&&c<=a.startColumn()&&b+d>a.endRow()&&c+e>a.endColumn()}z=function(a){C(b,a);function b(){return a.call(this,13)||this}return b.prototype.tableName=function(){return this.lj.tableName()},Object.defineProperty(b.prototype,"baseTable",{get:function(){return this.lj},set:function(a){this.lj=a,this.source=a.source()},enumerable:!0,configurable:!0}),b.prototype.JUa=function(){this.vzb=this.lj.startColumn()},b.prototype.columnReferenceStart=function(){return this.oj+this.lj.startColumn()},b.prototype.columnReferenceEnd=function(){return this.pj+this.lj.startColumn()},b.prototype.referencePortions=function(){return this.qj},b.prototype.referenceColumnSpecifier=function(){return this.rj},b.prototype.getRange=function(a,b,c){var d,e,g,h,i,j,k,l,m,n,p,q=this,r=q.lj;switch(q.JUa(),k=r.startRow(),l=r.endRow(),m=r.hasTotalsRow(),n=r.hasHeadersRow(),q.qj){case 3:case 16:d=n?k+1:k,g=m?l-1:l;break;case 2:if(n)d=k,g=k;else{if(!c)return o;d=k-1,g=k-1}break;case 8:if(m)d=l,g=l;else{if(!c)return o;d=l+1,g=l+1}break;case 1:d=a,g=a;break;case 6:d=k+(c&&!n?-1:0),g=m?l-1:l;break;case 12:d=n?k+1:k,g=l+(c&&!m?1:0);break;case 14:default:d=k+(c&&!n?-1:0),g=l+(c&&!m?1:0)}if(22===q.type){if(e=q.lj.getColumnIndexInTable(q.P$J),h=q.lj.getColumnIndexInTable(q.xj),e===-1||h===-1)return o}else e=q.columnReferenceStart(),h=q.columnReferenceEnd();return p=r.endColumn(),1===q.rj&&(h=p),e>p||h>p?(q._error=!0,o):g<d||!c&&d<k||!c&&g>l?o:(i=g-d+1,j=h-e+1,f.qf(d,e,i,j))},b.prototype.offsetWhenInsertRemoveColumn=function(a,c,d,e){var g,h,j=this,k=j.vzb;return i.isNullOrUndefined(k)&&(j.JUa(),k=j.vzb),i.isNullOrUndefined(k)||a<k||a===k&&d&&!e||a>j.pj+k?j:(c=d?c:-c,g=a-k,h=new b,h.baseTable=j.lj,h.pj=j.pj+c,h.oj=j.oj,a<=k+j.oj&&(h.oj+=c,h.oj<g&&(h.oj=g)),h.rj=j.rj,h.qj=j.qj,h.pj<h.oj?f.Ih:h)},b.prototype.offsetWhenCopy=function(a,b,c,d,e,h,i,j,k,l){var m,n,o,p,q,r,s=this,t=new g.SheetParserContext(b.kj,b.Af.useR1C1,f.pf(c,d)),u=t.getTableByIndex(c,d),v=s.offset();return u&&(m=c-e,n=d-h,o=i-e,p=j-h,q=void 0,a===b?q=t.getTableByIndex(m,n):(r=new g.SheetParserContext(a.kj,a.Af.useR1C1,f.pf(m,n)),q=r.getTableByIndex(m,n)),q!==u&&q===s.lj&&$(q,o,p,k,l)&&$(u,i,j,k,l)&&(v.baseTable=u)),v},b.prototype.Jma=function(a){var c,d=this,e=new b;return e.baseTable=d.lj,e.pj=d.pj,e.oj=d.oj,2===d.rj&&a&&(c=d.lj.endColumn()-d.lj.startColumn()+1,a%=c,e.oj+=a,e.oj<0&&(e.oj+=c),e.pj=e.oj),e.rj=d.rj,e.qj=d.qj,e},b.prototype.offset=function(a,c,d){var e=this,f=new b;return f.baseTable=e.baseTable,f.qj=e.qj,f.oj=e.oj,f.pj=e.pj,f.rj=e.rj,f},b.prototype.Kma=function(a,b){var c=this.lj;return a>=c.startRow()&&b>=c.startColumn()&&a<=c.endRow()&&b<=c.endColumn()},b.prototype.tzb=function(a,b,c){this.lj.wzb(a,b,c)},b}(f.Expression),b.xzb=z;function _(a,b){this.lj.gmb(a,this,b)}A=function(a){C(c,a);function c(b){var c=a.call(this,7900)||this;return c.kj=b,c}return c.prototype.resolveToken=function(a,b,d,e){var g,h,i,j,k,l,m=d[e],n=d[e+1];if(0===m.Nc){if(g=void 0,h=void 0,0===m.hi||7===m.hi)g=m.ni;else{if(12!==m.hi||!n||0!==n.Nc||0!==n.hi||"["!==n.Qb[0])return o;i=m.ni,"'"===i[0]&&(i=i.substr(1,i.length-2)),g=i+n.ni,h=!0}if("]"===g.charAt(g.length-1))try{return j=new z,aa(a,g.split(""),j),j.baseTable?(j.lj.kj.ODJ&&(k=j,k.type=22,k.gmb=_),h?{index:e+2,expr:j}:j):new f.Expression(0)}catch(a){}else if(l=a.getTableByName&&a.getTableByName(g))return c.create(l)}return o},c.prototype.unparse=function(a,c,d,e){var g,h,j,k,l,m,n,p,q,r,s,t,u;if(13!==d.type&&22!==d.type)return!1;if(g=d,h=g.lj.fOJ,j=i.isNullOrUndefined(h)?g.lj.tableName():h,a.YSa)return k=g.getRange(a.row,a.column,!0),l=f.uf(g.source,o,k.row,k.col,k.row+k.rowCount-1,k.col+k.colCount-1,!1,!1,!1,!1),M(a,c,l,e),!0;if(n=e.length,22===g.type&&g.baseTable.kj.Js)m=!0;else if(16===g.qj&&1===g.rj)return e.push(j),void(a.Eh&&e.push("[]"));return p=a.source===g.lj.source()&&g.Kma(a.row,a.column),p&&!a.Eh||(q=i.isNullOrUndefined(h)?g.lj.tableName():h,r=g.lj.kj,r&&r.ODJ&&!b.validateSheetName(q.split(""))&&(q=Q(a,q.split(""),null).join("")+"!"),e.push(q)),e.push("["),16!==g.qj&&(s=oa(g.qj,1!==g.rj,a.Eh),e.push(s)),1!==g.rj&&(1===g.qj&&!a.Eh||16===g.qj||e.push(", "),t=22===d.type?g.P$J:g.lj.getColumnName(g.oj),t?t=ha(t):m=!0,m||(4===g.rj?(u=22===d.type?g.xj:g.lj.getColumnName(g.pj),u?(u=ha(u),e.push("[",t,"]:[",u,"]")):m=!0):1===g.qj&&!a.Eh&&!ia(t)||16===g.qj?e.push(t):e.push("[",t,"]"))),m?(e.length=n,e.push("#REF!")):e.push("]"),!0},c.create=function(a,b,c,d,e){void 0===b&&(b=x.NotSpecific),void 0===c&&(c=y.NotSpecific),void 0===d&&(d=0),void 0===e&&(e=a.endColumn()-a.startColumn());var f=new z;return f.baseTable=a,f.qj=b,f.oj=d,f.pj=e,f.rj=c,f},c}(f.TokenResolver),b.StructureReferenceResolver=A;function aa(a,b,c){var d,e,f,g,h,j,k,l,m,n,o=c,p=0,q=b[p],r=ma(a,b,p,q),s=r.sj;if(!s){if(d=a.keepUnknownFormulas)return;na()}for(o.baseTable=s,p=r.tj,p++,q=b[p],e=p;" "===q;)p++,q=b[p];for("@"!==q&&"["!==q&&(p=e,q=b[p]),f=1,g=!1,h=!1,j=b.length;0!==f&&p<j;)if("["===q&&(f++,p++,q=b[p]),"#"===q)g&&f<=1&&na(),k=la(b,p,q,f),l=k.vj,p=k.tj,q=k.uj,f=k.wj,g?2===o.qj&&3===l||2===l&&3===o.qj?o.qj=6:3===o.qj&&8===l||3===l&&8===o.qj?o.qj=12:na():o.qj=l,g=!0;else if("@"===q){for((f>1||g)&&na(),g=!0,o.qj=1,p++,q=b[p];" "===q;)p++,q=b[p];","===q&&na()}else{for(m=p;!i.isNullOrUndefined(q)&&"]"!==q&&"["!==q;)if("'"===q&&p++,","===q){for(p++,q=b[p],n=p;" "===q;)p++,q=b[p];if("["===q){p=n,q=",";break}}else p++,q=b[p];if(p>m&&((h||"["===q&&f>1)&&na(),k=ca(o,b,p,q,f,m),p=k.tj,q=k.uj,f=k.wj,h=!0),"]"===q){if(f--,0===f)break;p>=b.length&&na(),p++,q=b[p]}","===q&&(p++,q=b[p])}g||(o.qj=a.WLb?1:16),h||(o.oj=0,o.pj=o.lj.endColumn()-o.lj.startColumn(),o.rj=1)}function ba(a,b,c){return a.slice(b,c).join("")}function ca(a,b,c,d,e,f){var g,h,i,j,k,l,m,o=a,p=[],q=!1,r=!1;if(e>1)q=!0,e--,p=b.slice(f,c),c++,d=b[c],":"===d&&(c++,d=b[c],r="["===d,i=ja(b,c,d,e),g=i.xj,c=i.tj,d=i.uj,e=i.wj);else if("["===d){for(r=!0,h=c-1,d=b[h];" "===d;)h--,d=b[h];":"!==d&&na(),p=b.slice(f,h),p=da(p),d=b[c],i=ja(b,c,d,e),g=i.xj,c=i.tj,d=i.uj,e=i.wj}else o.qj!==n&&16!==o.qj||(q=!0),j=b.slice(f,c),h=j.indexOf(":"),h>0?(p=j.slice(0,h),g=j.slice(h+1),"["!==g[0]&&na()):p=j;if(k=fa(o,p,q),o.P$J=p.join(""),o.xj=o.P$J,g?(l=fa(o,g,r),o.rj=4,o.xj=g.join("")):(l=k,o.rj=2),k>l&&(m=k,k=l,l=m),o.oj=k,o.pj=l,c++,c<b.length)for(d=b[c];" "===d;)c++,d=b[c];return{tj:c,uj:d,wj:e}}function da(a){for(var b=a.length-1;b>=0&&" "===a[b];)b--;for(;b>=0&&" "!==a[b];)b--;return b>=0?a.slice(b+1,a.length-b-1):a}function ea(a){for(var b=0,c=a.length,d=0;b<c&&" "===a[b];)b++;for(d=b,b=c-1;b>d&&" "===a[b];)b++;return b>=d?a.slice(d,b+1):a}function fa(a,b,c){var d,e,f,g;if(b&&ga(b,c)){for(d=[],e=0,f=b.length;e<f;e++)"'"===b[e]&&e<f-1&&e++,d.push(b[e]);return b=d,g=a.lj.getColumnIndexInTable(b.join("")),g<0&&na(),g}return-1}function ga(a,b){var c,d,e;if(b)return!0;if(c="",c=a[0],d=c,"#"===c||"@"===c||" "===c||","===c||":"===c||"["===c||"]"===c)return!1;for(e=1;e<a.length;e++){if(c=a[e],","===c||":"===c||"["===c&&"'"!==d||"]"===c&&"'"!==d||"@"===c&&"'"!==d||"#"===c&&"'"!==d)return!1;d=c}return!0}function ha(a){var b,c,d=[];for(c=0;c<a.length;c++)b=a[c],"["!==b&&"]"!==b&&"@"!==b&&"#"!==b&&"'"!==b||d.push("'"),d.push(b);return d.join("")}b.getValidaColumnName=ha;function ia(a){var b,c="";if(c=a[0],"#"===c||" "===c||"@"===c||" "===c||","===c||":"===c||"["===c||"]"===c)return!0;for(b=1;b<a.length;b++)if(c=a[b]," "===c||","===c||":"===c||"["===c||"]"===c||"@"===c||"#"===c)return!0;return!1}function ja(a,b,c,d){var e,f,g=!1;if("["===c)for(g=!0,d++,b++,c=a[b];" "===c;)b++,c=a[b];for(e=b;"]"!==c&&(","!==c||d>1);)"'"===c&&b++,b++,c=a[b];return b<=e&&na(),f=a.slice(e,b),d>1&&d--,g||(f=ea(f)),{xj:f,tj:b,uj:c,wj:d}}B={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1};function ka(a){var b,c=f.getMapping()&&f.getMapping().tableFunctionsMapping;if(!i.isNullOrUndefined(c))for(b in c)if(c[b].toLowerCase()===a)return b.toLowerCase();return a}function la(a,b,c,d){for(var e,f,g,h,i=14,j=b;"]"!==c;)"'"===c&&b++,b++,c=a[b];for(e=ba(a,j,b).toLowerCase().trim(),e=ka(e),f=!1,g=0;g<p.length;g++)if(h=p[g],e===h){i=B[e],f=!0;break}if(f||na(),b++,b>=a.length)d--;else{for(c=a[b];" "===c;)b++,c=a[b];if(","===c){for(d<=1&&na(),b++,c=a[b];" "===c;)b++,c=a[b];"["===c&&(d++,b++,c=a[b])}d>1&&d--}return{vj:i,tj:b,uj:c,wj:d}}function ma(a,b,c,d){for(var e,f,g=0,h=b.length;"["!==d&&c<h;)c++,d=b[c];return g=c,g>0?(f=ba(b,0,g),e=a.getTableByName(f)):e=a.getTableByIndex(a.row,a.column),{sj:e,tj:c,uj:d}}function na(){throw l().Exp_FormulaInvalid}function oa(a,b,c){var d=f.getMapping()&&f.getMapping().tableFunctionsMapping,e=f.sR().B2,g=d?d["#All"]:e.All.name,h=d?d["#This row"]:e.thisRow.name,i=d?d["#Headers"]:e.Headers.name,j=d?d["#Data"]:e.Data.name,k=d?d["#Totals"]:e.Totals.name;switch(a){case 1:return c?"["+h+"]":"@";case 2:return b?"["+i+"]":i;case 3:return b?"["+j+"]":j;case 8:return b?"["+k+"]":k;case 6:return"["+i+"], ["+j+"]";case 12:return"["+j+"], ["+k+"]";case 14:case 16:}return b?"["+g+"]":g}function pa(a,b){var c,d,e,g,h,i,j,k,l,m,n=0;for(a.unshift(new f.FormulaToken("=",1,0,0,0)),g=[],h=0,e=a.length-1;e>0;e--)a[e].mi===a[e-1].mi&&a[e].ni===a[e-1].ni||(g[h]=a[e],h++);for(g[h]=a[e],g.reverse(),i=[],j=0,k=0;k<g.length-1;k++,j++)d=qa(g[k]),i[j]=g[k],n=g[k+1].mi-g[k].mi-d,n>0&&(c=new f.FormulaToken(b.slice(g[k].mi+d,g[k+1].mi),7,g[k].mi+d),++j,i[j]=c);for(i[j]=g[k],d=qa(i[j]),i.length>0&&b.length>i[j].mi+d&&(c=new f.FormulaToken(b.slice(i[j].mi+d,b.length),7,i[j].mi+d),i[j+1]=c),l=0;l<i.length;l++)m=i[l].ni.trim(),3===i[l].hi?i[l].ni='"'+i[l].ni+'"':"("===m||"{"===m?(i[l].Nc=1,i[l].hi=1):")"!==m&&"}"!==m||(i[l].Nc=1,i[l].hi=2);return i}function qa(a){return 1===a.Nc&&"ARRAY"===a.ni?1:0===a.Nc&&3===a.hi?(a.HTa||a.ni).length+2:0===a.Nc&&12===a.hi?a.ni.length+3:a.ni.length}function ra(a,b,c){var d,e;a&&b&&(d=b.getName&&b.getName()||"!",e=a[d],e||(e=a[d]=[],a.sheets||(a.sheets=[]),a.sheets.push(d)),e.push(c))}function sa(a,b,c,d,e,g){var h,i,j,k;if(a){for(;10===a.type;)a=a.value;if(12===a.type&&(i=a,a=i.value),a.type>=2&&a.type<=6);else if(1===a.type)h=a.getRange(e,g),!d.source||a.source&&a.source!==d.source||b.push(h),ra(c,a.source||d.source,h);else if(13===a.type)h=a.getRange(e,g),a.source===d.source&&h&&b.push(h),ra(c,a.source||d.source,h);else if(8===a.type)a.mWJ||(a.mWJ=!0,j=o,a.source?a.source.Cf()&&(j=new f.EvaluateContext(a.source,f.pf(e,g))):j=d,sa(j.getName(a.value),b,c,j,e,g),a.mWJ=n);else if(9===a.type)sa(a.value,b,c,d,e,g),a.value2&&sa(a.value2,b,c,d,e,g);else if(7===a.type)for(k=0;k<a.arguments.length;k++)sa(a.arguments[k],b,c,d,e,g)}}function ta(a,b,c,e,g,h,j,k,l){var m,n,o,p;a.setParserOption(h),m=[],n=b.split(""),i.isNullOrUndefined(l)&&(l=d.SheetArea.viewport);try{o=!!k||c.Cf().useR1C1,p=c.yj(l).getParserContext(!j&&o,f.pf(e,g),{sheetArea:l}),m=a.parseToTokens(p,n,!1)}catch(a){}return m=pa(m,n),ua(a,m,n,c,e,g,j,k,l)}b.qzb=ta;function ua(a,b,c,e,h,i,j,k,l){var m,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;for(void 0===l&&(l=d.SheetArea.viewport),p=n,q=e.yj(l),r=e.Cf(),s=!!k||r.useR1C1,r?(m=new g.SheetParserContext(e,!j&&s,f.pf(h,i),{sheetArea:l}),p=new f.EvaluateContext(q,f.pf(h,i),(!1))):m=new f.ParserContext(o,(!1),f.pf(0,0)),m.ignoreError=!0,t=[],v=0;v<b.length;v++)try{if(u=b[v],"["===u.ni||"#"===u.Qb[0]||3===u.hi){t.push({text:u.HTa||u.ni,type:u.Nc,subType:u.hi,canDrag:!1,ranges:u.ranges,value:u.ni});continue}if(w=[],v=va(a,m,b,v,w),x=void 0,w.length>0){for(y=0;y<w.length;y++)if(z=w[y],z instanceof f.FormulaToken)t.push({text:c.slice(z.mi,z.li+1).join(""),type:z.Nc,subType:z.hi,canDrag:x,ranges:[],value:z.ni});else if(z.Lf){if(A=z.Lf,B=A.type,C=A.source,D=c.slice(z.mi,z.li+1).join(""),E=[],F={},x=!0,G=A.getRange&&A.getRange(h,i),8===B)x=!1,p&&(H=p,A.source&&(H=new f.EvaluateContext(A.source,f.pf(h,i),(!1))),I=H.getName(A.value),sa(I,E,F,p,h,i));else if(13===B||22===B)x=!1,C&&q&&C.kj===q.kj&&G?E.push(G):E=null,ra(F,C,G);else if(1===B)if(A.endSource)for(J=C,K=A.endSource,L=J.getSources(K),y=0;y<L.length;y++){if(L[y]===q){E.push(G);break}ra(F,L[y],G)}else ra(F,C||q,G),(!C||C&&q&&C.kj===q.kj)&&E.push(G);else E=null;E&&E.length>0?t.push({text:D,type:0,subType:7,canDrag:x,ranges:E,value:D,sheetRanges:F,sheetArea:C&&C.Wz||q.Wz}):t.push({text:D,type:u.Nc,subType:u.hi,canDrag:x,ranges:E,value:D,sheetRanges:F})}}else t.push({text:u.ni,type:u.Nc,subType:u.hi,canDrag:!1,ranges:u.ranges,value:u.ni})}catch(a){t.push({text:u.ni,type:u.Nc,subType:u.hi,canDrag:!1,ranges:u.ranges,value:u.ni})}return t}function va(a,b,c,d,e){var f,g,h,i,j,k,l=c[d];return l&&"function"!=typeof l&&0===l.Nc?(f=[],g=a.resolveToken(b,c,f,d)-1,h=f[0],i=h.type,1===i||13===i||8===i||5===i||22===i&&h.source?(j=c[g],k={mi:l.mi,li:j.li,Lf:h},e.push(k),g):d):d}},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/sheetsCalc/calc.ns.js")),d(c("./dist/plugins/sheetsCalc/parser-sheets.js")),d(c("./dist/plugins/sheetsCalc/calc-spreadjs.js")),d(c("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js")),d(c("./dist/plugins/sheetsCalc/worksheet-formula.js")),c("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("@grapecity/js-calc"),g=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),i=c("./dist/plugins/sheetsCalc/external-reference.js"),j=c("./dist/plugins/sheetsCalc/calc-extra-save.js"),k=g.SpreadSource,l=e.Common.u.Nb,m=new e.Common.ResourceManager(d.SR),n=m.getResource.bind(m),o=void 0,p=null,q=e.Common.D,r=e.Common.j.Fa,s=d.Ul.IcK,t=d.Ul.LcK,u=d.Ul.JcK,v=d.Ul.McK,w=d.Util.ZaK,x=d.IndexHelper.Q9,y=d.Util.addXLFNPrefix,z=d.Ul.oaa,A=d.Ul.naa,B=d.Util.Sja,C=d.XFileConstants.tbK,D=d.XFileConstants.bbK,E=d.Workbook.prototype,E.qv=function(a){var b=this,c=b.Wu;b.Wu=new f.CalcService,b.Wu.useR1C1=1===b.options.referenceStyle,b.Wu.allowDynamicArray=b.options.allowDynamicArray,b.Wu.iterativeCalculation=b.options.iterativeCalculation,b.Wu.iterativeCalculationMaximumIterations=b.options.iterativeCalculationMaximumIterations,b.Wu.iterativeCalculationMaximumChange=b.options.iterativeCalculationMaximumChange,a&&c&&b.Wu.cloneFrom(c),b.yv=new k(b),b.zv=b.Wu.getGlobalSourceModel(b.yv)},E.addCustomFunction=function(a){this.Xu(a)},E.Xu=function(a){if(!(a&&a instanceof f.Functions.Function))throw Error(n().Exp_InvalidCustomFunction);a.name=l(a.name),this.Su[a.name]=a},E.getCustomFunction=function(a){return a?this.Su[l(a)]:o},E.removeCustomFunction=function(a){a&&(delete this.Su[l(a)],this.iK())},E.clearCustomFunctions=function(){this.Su={}},E.addCustomName=function(a,b,c,d,e){this.Yu(this.Tu,a,b,c,d,!1,e)},E.H$a=function(a){return!this.Tu[l(a)]},E.isValidCustomName=function(a){return a&&d.Ul.G$a(a)&&this.H$a(a)},E.E4J=function(a,b,c,d,e,f,g,i){var j,k=this;if(!b||!c)throw Error(n().Exp_InvalidCustomName);i&&k.Wu?(j=i.F4J(c,d,e),a[l(b)]=new h.FormatterNameInfo(b,c,i.name(),j,d,e)):k.Yu(a,b,c,d,e,f,g)},E.Yu=function(a,b,c,e,f,g,i){var j,k,m,o,q=this;if(!b||!c||!g&&!q.isValidCustomName(b))throw Error(n().Exp_InvalidCustomName);if(q.Wu){if(j=d.UCJ(this),k=j?j.yj():p,m=void 0,g)try{m=q.Wu.parse(k,c,e,f,!1,!1,!0)}catch(a){}else m=q.Wu.parse(k,c,e,f);a[l(b)]=new h.NameInfo(b,m,e,f,i),g||(o={},o[b]=b,this.Zu(o,!0))}},E.siK=function(a,b,c,d,e,f,g,i){var j,k=this;if(!b||!c||!g&&!k.isValidCustomName(b))throw Error(n().Exp_InvalidCustomName);k.Wu&&(a[l(b)]=new h.NameInfo(b,d,e,f,i),g||(j={},j[b]=b,this.Zu(j,!0)))},E.getCustomName=function(a){return a?this.Tu[l(a)]:o},E.dJb=function(a){return a?this.UHb[l(a)]:o},E.getCustomNames=function(){var a=[];return d.GC$.each(this.Tu,function(b,c){a.push(c)}),a},E.XLb=function(){var a=[];return d.GC$.each(this.UHb,function(b,c){a.push(c)}),a},E.removeCustomName=function(a){if(a){delete this.Tu[l(a)];var b={};b[a]=a,this.Zu(b,!1)}},E.VHb=function(a){if(a){delete this.UHb[l(a)];var b={};b[a]=a,this.Zu(b,!1)}},E.clearCustomNames=function(){var a=this.Tu;this.Tu={},this.Zu(a,!1)},E.YLb=function(){var a=this.UHb;this.UHb={},this.Zu(a,!1)},E.Zu=function(a,b){var c,d;if(a){c=this.zv;for(d in a)c&&c.updateNameCalc(d,b);this.iK()}},E.iK=function(){if(this.Wu&&!this.Wu.IsSuspended()){var a=this.getActiveSheet();a&&(a.suspendPaint(),this.Wu.recalculateAll(),a.resumePaint())}},E.getCalcService=function(){return this.Wu},E.Cf=function(){return this.Wu},E.suspendCalcService=function(a){this.Wu&&this.Wu.suspend(a)},E.resumeCalcService=function(a){this.Wu&&this.Wu.resume(a)},E.getCircularReference=function(){var a,b,c,d=this.ACc();d=this.BCc(d),a=[];for(b in d)q(d,b)&&(c=b.split("\\"),a.push({row:+c[1],col:+c[2],rowCount:1,colCount:1,sheetName:c[0]}));return a},E.updateExternalReference=function(a,b,c){this.suspendPaint(),this.suspendCalcService(),this.G$J.VF(a,b,c),this.resumeCalcService(),this.resumePaint()},E.getExternalReferences=function(a){return this.G$J.N$J(a)},E.ACc=function(){var a={};return this.sheets.forEach(function(b){var c,d,e,f,g,h,i,j=b.Bj(),k=b.getRowCount(),l=b.getColumnCount(),m=b.name();if(j)for(c=0;c<k;c++)for(d=0;d<l;d++)for(e=m+"\\"+c+"\\"+d,f=b.bPJ(c,d),!a[e]&&f.length>0&&(a[e]={from:[],to:[]}),g=0;g<f.length;g++)h=f[g],i=h.sheetName+"\\"+h.row+"\\"+h.col,
a[i]||(a[i]={from:[],to:[]}),a[i].from.push(e),a[e].to.push(i)}),a},E.BCc=function(a){var b,c,d;function e(a,b){a.splice(a.indexOf(b),1)}for(b=!0;Object.keys(a).length>0&&b;){b=!1,c=function(c){if(q(a,c)){var d=a[c];0===d.from.length?(d.to.forEach(function(b){e(a[b].from,c)}),delete a[c],b=!0):0===d.to.length&&(d.from.forEach(function(b){e(a[b].to,c)}),delete a[c],b=!0)}};for(d in a)c(d)}return a};function F(a,b){a||b.forEach(function(a){var b=a.yj();b.MIb(),delete b.q$a})}function G(a,b,c,e){d.GC$.each(a,function(a,d){var f,g,h=d.getName(),i=d.getRow(),j=d.getColumn(),k=d.getExpression(),l=d.getComment(),m=d.getFormatter&&d.getFormatter(),n=d.getSheetTabName&&d.getSheetTabName();k&&(f=m||b.unparse(c,k,i,j,!1,!0),g={name:h,formula:f,sheetTabName:n,row:i,col:j},l&&(g.comment=l),e.push(g))})}function H(a,b){var c,d,e=t(a);if("str"===b)c=e;else if("b"===b)c="1"===e;else if("e"===b){switch(d=p,e){case"#DIV/0!":d=7;break;case"#N/A":d=42;break;case"#NAME?":d=29;break;case"#NULL!":d=0;break;case"#NUM!":d=36;break;case"#REF!":d=23;break;case"#VALUE!":d=15}c=d!==p?{_error:e,_code:d}:p}else c=parseFloat(e);return c}d.Workbook.$n("calc",{priority:1e3,init:function(){this.Su={},this.Tu={},this.UHb={},this.G$J=new i.ExternalReferenceManager},toJson:function(a){var b,c,e,f,g,h,i,j,k=this,l=k.Su;d.GC$.isEmptyObject(l)||(a.customFunctions=l),b=k.G$J.toJSON(k),d.GC$.isEmptyObject(b)||(a.externalReference=b),c=[],e=[],f=k.getCustomNames(),g=k.XLb(),h=k.Wu,i=this.getActiveSheet(),j=i?i.yj():p,f&&h&&(d.GC$.each(f,function(a,b){var d,e,f=b.getName(),g=b.getRow(),i=b.getColumn(),k=b.getExpression(),l=b.getComment();k&&(d=h.unparse(j,k,g,i,!1,!0),e={name:f,formula:d,row:g,col:i},l&&(e.comment=l),c.push(e))}),G(g,h,j,e),c.length>0&&(a.names=c),e.length>0&&(a.formatStringNames=e))},bdK:function(a,b,c){var e,f,g,i,k,l,m,n,o,q,r,t,u,v,w,x,z=this,A=z.Su;d.GC$.isEmptyObject(A)||(a.workbook.lossless.customFunctions=A),z.G$J&&(e=z.G$J.bdK(a),f=e.externalReferencesNode,g=e.externalLinks,i=e.count,i>0&&(a.workbook.c_.push(f),a.externalLinks=g)),k=[],l=s(a.workbook,"definedNames"),m=z.getCustomNames(),n=z.Wu,o=this.getActiveSheet(),q=o?o.yj():p,r=z.yv,t=r&&r.getUsedCustomNames()||{},m&&m.length>0&&n&&(l||(l={n_:"definedNames",c_:[]},a.workbook.c_.push(l)),u=l.c_,v=!c||c.includeUnusedNames!==!1,d.GC$.each(m,function(a,b){var d,e,f,g=b.getName(),i=b.getRow(),l=b.getColumn(),m=b.getExpression(),o=b.getComment();m&&(v||t[g])&&(d=y(h.encodeNameFormula(n.unparse(q,m,i,l,!1,!0))),e={n_:"definedName",name:g,comment:o,c_:[d]},c&&c.includeCalcModelCache&&(f=j.exprToJSON(m),k.push(f),e.e=k.length-1),u.push(e))})),k.length>0&&(a.workbook.lossless.exprs=k),w=[],x=z.XLb(),x&&x.length>0&&n&&(G(x,n,q,w),w.length>0&&(a.workbook.lossless.formatStringNames=w)),a.workbook.lossless.idMap=j.khK(n)},preFromSJSFormat:function(a,b,c){var e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,w,y,z,A,B,C,E,F,G,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W=u(a.workbook,"externalReferences"),X=a.externalLinks;if(W&&X&&W.c_&&W.c_.length>0){e={};for(f in X)if(X.hasOwnProperty(f)){if(g=X[f],h={},j=u(g,"externalBook")){if(k=u(j,"sheetNames"),l=[],k&&k.c_&&k.c_.length){for(m=0,n=k.c_.length;m<n;m++)o=k.c_[m],o&&(p=o.val,p&&l.push(p));h.sheetNames=l}if(q=u(j,"sheetDataSet")){if(r={},s=v(q,d.XFileConstants.HbK))for(t=0,w=s.length;t<w;t++)if(y=s[t],z=+y.sheetId,A="1"===y.refreshError,p=l[z],B=r[p]={},A&&(B.isNew=!0),C=v(y,"row"))for(E=0,F=C.length;E<F;E++)if(G=C[E],G&&(I=G.r-1,J=B[I]={},K=v(G,"cell")))for(L=0,M=K.length;L<M;L++)N=K[L],O=void 0,N&&(P=N.r,P&&(O=x(P)),Q=N.t,R=u(N,"v"),S=void 0,R&&(S=H(R,Q)),J[O]=S);h.data=r}}h.option=g.option,e[f]=h}for(T={},U=W.c_,V=U.length,m=0;m<V;m++)T[m+1]=e[U[m][D]];this.G$J=new i.ExternalReferenceManager(T)}},cdK:function(a,b,c){var e,f,g,i,k,l,m,q,s,v,x,y,A,E,G,H,I,J,K=this;function L(){var a,b;return e||(a=d.UCJ(K)||K.sheets[0],b=a?a.yj():p,e=b&&b.getParserContext(!1)),e}if(f=K.Wu,g=c&&!c.fullRecalc,i=d.Util.lkK(c,K.NjK),f&&(f.suspend(),f.Q$J=g),K.clearCustomNames(),k=K.sheets,i||k.forEach(function(a){a.yj().q$a=!0}),l=a.workbook.lossless,c&&(c.lhK=j.jhK(f,l)),m=b.workbookNames,m&&m.length>0&&m.forEach(function(a){var b=a.name,c=t(a),e=a.comment;l&&l.exprs&&l.exprs[a.e]?K.siK(K.Tu,b,""+h.processFunctionPrefix(d.Ul.oaa(c)),j.exprFromJSON(l.exprs[a.e],L()),0,0,!0,e,!0):c&&K.Yu(K.Tu,b,""+h.processFunctionPrefix(d.Ul.oaa(c)),0,0,!0,e,!0)}),K.YLb(),q=l&&l.formatStringNames)for(s=0;s<q.length;s++)v=q[s],r(v.sheetTabName)&&K.E4J(this.UHb,v.name,v.formula,v.row,v.col,!0,v.comment,o,!0);if(K.clearCustomFunctions(),x=l&&l.customFunctions)for(y in x)x.hasOwnProperty(y)&&(A=x[y],E=d.getTypeFromString(A.typeName),E&&(G=new E,G.fromJSON(A),K.Xu(G)));i||(H=[],I=a.workbook.rels&&a.workbook.rels.c_,J=u(a.workbook,C).c_,J.forEach(function(b){var c,d,e=B(z(b.name)),f=K.getSheetFromName(e),g=b[D],h=w(I,g),i=h&&h.Target;i&&(c=K.getSheetRelsName(i),d=void 0,d=i.indexOf("xl/chartsheets")>-1?a.chartsheets[c]:a.sheets[c],H.push({sheet:f,sheetData:d}))}),H.forEach(function(a){a.sheet&&a.sheet.nameFunctionFromSJSFormat(a.sheetData,b,c)}),H.forEach(function(a,d){a.sheet&&a.sheet.formulaFromSJSFormat(a.sheetData,b,c)})),c.incrementLoadTask.addTask(function(a,b,c){f&&(g?f.resumeWithoutCalc():f.resume(!1),delete f.Q$J),F(i,k)},[f,a,c],g?o:n().STEP.startCalc,function(){return g?d.STEP_RATE.end:d.STEP_RATE.loadFileData+d.STEP_RATE.parseFile+d.STEP_RATE.loadSheetDataWithCalc+d.STEP_RATE.loadSheetFormulaWithCalc})},ZdK:function(a,b,c){var e,f,g,h,j,k,l,m,n,p,q,s,v,x,y=this,A=y.Wu,E=c&&!c.fullRecalc,G=d.Util.lkK(c,y.NjK);if(A&&(A.suspend(),A.Q$J=E),y.clearCustomNames(),e=y.sheets,G||e.forEach(function(a){a.yj().q$a=!0}),f=a.workbook.lossless,y.G$J=new i.ExternalReferenceManager(f&&f.externalReference),g=b.workbookNames,g&&g.length>0&&g.forEach(function(a){var b=a.name,c=t(a),e=a.comment;c&&y.Yu(y.Tu,b,""+d.Ul.oaa(c),0,0,!0,e,!0)}),y.YLb(),h=f&&f.formatStringNames)for(j=0;j<h.length;j++)k=h[j],r(k.sheetTabName)&&y.E4J(this.UHb,k.name,k.formula,k.row,k.col,!0,k.comment,o,!0);if(y.clearCustomFunctions(),l=f&&f.customFunctions)for(m in l)l.hasOwnProperty(m)&&(n=l[m],p=d.getTypeFromString(n.typeName),p&&(q=new p,q.fromJSON(n),y.Xu(q)));G||(s=[],v=a.workbook.rels&&a.workbook.rels.c_,x=u(a.workbook,C).c_,x.forEach(function(b){var c,d,e=B(z(b.name)),f=y.getSheetFromName(e),g=b[D],h=w(v,g),i=h&&h.Target;i&&(c=y.getSheetRelsName(i),d=void 0,d=i.indexOf("xl/chartsheets")>-1?a.chartsheets[c]:a.sheets[c],s.push({sheet:f,sheetData:d}))}),s.forEach(function(a){a.sheet&&a.sheet.nameFunctionFromSJSFormat(a.sheetData,b,c)}),s.forEach(function(a){a.sheet&&a.sheet.formulaFromSJSFormat(a.sheetData,b,c)})),c.incrementLoadTask.addTask(function(a,b,c){if(A){if(E)A.resumeWithoutCalc();else{A.resume(!1),delete A.UXJ;var d=y.getActiveSheet();d&&d.$p()}delete A.Q$J}F(G,e)},[A,a,c])},preFromJson:function(a,b,c){this.G$J=new i.ExternalReferenceManager(a.externalReference)},fromJson:function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y=this,z=y.Wu,A=a.noRecalc||c&&c.doNotRecalculateAfterLoad;if(z&&(z.suspend(),z.Q$J=A),y.clearCustomNames(),g=a.sheets,h=[],g)for(j in g)"string"==typeof j&&(k=g[j],f=y.getSheetFromName(k.name||j),f.yj().q$a=!0);if(l=a.names)for(m=0;m<l.length;m++)n=l[m],y.Yu(this.Tu,n.name,n.formula,n.row,n.col,!0,n.comment);if(y.YLb(),o=a.formatStringNames)for(m=0;m<o.length;m++)n=o[m],r(n.sheetTabName)&&y.E4J(this.UHb,n.name,n.formula,n.row,n.col,!0,n.comment);if(y.clearCustomFunctions(),p=a.customFunctions)for(q in p)p.hasOwnProperty(q)&&(s=p[q],t=d.getTypeFromString(s.typeName),t&&(u=new t,u.fromJSON(s,b),y.Xu(u)));if(g){e=0;for(j in g)"string"==typeof j&&(k=g[j],f=y.getSheetFromName(k.name||j),h.push(f),f.nameFunctionsFromJSON(k,b,c),e++);for(i=h.length,e=0;e<i;e++)f=h[e],f.formulaFromJSON(g[f.name()],b,c)}for(z&&(A?z.resumeWithoutCalc():(z.resume(!1),delete z.UXJ),delete z.Q$J),v=0,w=h;v<w.length;v++)f=w[v],x=f.yj(),x.MIb(),delete x.q$a},Wgc:function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,s,t,u,v=this,w=v.Wu,x=a.noRecalc||c&&c.doNotRecalculateAfterLoad;if(w&&(w.suspend(),w.Q$J=x),v.clearCustomNames(),g=a.sheets,h=[],g)for(j in g)"string"==typeof j&&(k=g[j],f=v.getSheetFromName(k.name||j),f.yj().q$a=!0);if(l=a.names)for(m=0;m<l.length;m++)n=l[m],v.Yu(this.Tu,n.name,n.formula,n.row,n.col,!0,n.comment);if(v.YLb(),o=a.formatStringNames)for(m=0;m<o.length;m++)n=o[m],r(n.sheetTabName)&&v.E4J(this.UHb,n.name,n.formula,n.row,n.col,!0,n.comment);if(v.clearCustomFunctions(),p=a.customFunctions)for(q in p)p.hasOwnProperty(q)&&(s=p[q],t=d.getTypeFromString(s.typeName),t&&(u=new t,u.fromJSON(s,b),v.Xu(u)));if(g){e=0;for(j in g)"string"==typeof j&&(k=g[j],f=v.getSheetFromName(k.name||j),h.push(f),f.nameFunctionsFromJSON(k,b,c),e++);for(i=h.length,e=0;e<i;e++)f=h[e],f.formulaFromJSON(g[f.name()],b,c)}c.incrementLoadTask.addTask(function(a,b,c){var d,e,g,i;for(w&&(x?w.resumeWithoutCalc():(w.resume(!1),delete w.UXJ,d=v.getActiveSheet(),d&&d.$p()),delete w.Q$J),e=0,g=h;e<g.length;e++)f=g[e],i=f.yj(),i.MIb(),delete i.q$a},[w,a,c])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("@grapecity/js-calc"),g=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=c("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),i=c("./dist/plugins/sheetsCalc/calc-extra-save.js"),j=null,k=void 0,l=d.GC$.each,m=e.Common.u.Nb,n=e.Common.u,o=new e.Common.ResourceManager(d.SR),p=o.getResource.bind(o),q=e.Common.j.Fa,r="_XLNM.PRINT_AREA",s="PRINT_AREA",t="Print_Area",u=d.Ul.JcK,v=d.range_parser.DcK,w=d.IndexHelper.R9,x=d.Ul.Q9,y=d.Ul.oaa,z=d.Util.addXLFNPrefix,A=/(\$?)([A-Z]+)(\$?)(\d+)/,B=/(\$?)(\d+):(\$?)(\d+)/,C=/(\$?)([A-Z]+):(\$?)([A-Z]+)/,D=parseInt,E=d.UsedRangeUtil.updateUsedRangeByData;function G(a){return"="===a.charAt(0)}function H(a){var b=a.indexOf("["),c=a.indexOf("]");return{left:b,right:c}}function I(a){var b=H(a),c=b.left,d=b.right;return c>=0&&c<d}function J(a){var b=H(a),c=b.left,d=b.right,e=a.indexOf("@");return c<e&&e<d}function K(a){return G(a)&&J(a)}function L(a){return G(a)&&I(a)}function M(a,b){var c,d;if(a.ODJ){if(b=b.trim(),L(b))return!0;if(b.indexOf("{{")>=0&&b.indexOf("}}")>=0)for(c=b.split(/{{|}}/),d=0;d<c.length;d++)if(L(c[d].trim()))return!0}return!1}function N(a,b,c,d){return c===k&&(c=a.getActiveRowIndex()),a.ODJ.G4J(b,c,d)}function O(a){return a.columnRelative}function P(a){return a.endColumnRelative}function Q(a){return a.rowRelative}function R(a){return a.endRowRelative}function S(a){return a.Cf()}function T(a){return a.column}function U(a){return a.toUpperCase()===r?t:a}function V(){var a=this;return a.W8J?void(a.W8J=!1):(a.Su={},a.Tu={},a.rDc?a.rDc.clearAll():a.sDc=new g.SheetSource(a,d.SheetArea.colHeader),a.tDc?a.tDc.clearAll():a.uDc=new g.SheetSource(a,d.SheetArea.rowHeader),void(a.et?a.et.clearAll():a.ft=new g.SheetSource(a,d.SheetArea.viewport)))}function W(a,b){var c,d,e,f,g=a.ITa.bIb&&a.ITa.bIb.anchors;if(g){b.spillCells={};for(c in g)if(Object.prototype.hasOwnProperty.call(g,c)){d=g[c];for(e in d)Object.prototype.hasOwnProperty.call(d,e)&&(f=d[e],f.isValid||(b.spillCells[c+","+e]=1))}}}function X(a,b,c,d,e,f){var g=a.Ms(b,c,d,e,f),h=g&&g.formulas;return h&&h.length>0}function Y(a,b,c,d,e,f,g){var h=X(a,b,c,d,e,3);return!h&&f&&(e=a.getColumnCount(2),h=X(a,b,0,d,e,2)),!h&&g&&(d=a.getRowCount(1),h=X(a,0,c,d,e,1)),h}function Z(a){var b,c,d,e=[],f=[];for(b=0;b<a.length;b++)c=a[b],d=""+c.row+c.col+c.rowCount+c.colCount+c.sheetName,e.indexOf(d)<0&&(e.push(d),f.push(c));return f}function $(a,b){var c=a.formulaLoad/a.total;return b?.4*c+.5:.3*c+.4}function _(a,b,c,d,e,f){var g,h,i,j,k,l=d.yj(),m=a&&a.formula;m&&(g=void 0,"object"==typeof m&&(h=d.Bj(f),i=d.Q5J[m.si],i.baseRow===b&&i.baseColumn===c?m=i.formula:(g=h.Kf(i.baseRow,i.baseColumn),g?(g.S5J=m.si,d.Wu.UXJ&&d.Wu.UXJ[l.id+","+i.baseRow+","+i.baseColumn]&&(d.Wu.UXJ[l.id+","+b+","+c]={id:l.id,row:b,col:c})):(m=i.formula,i.baseRow=b,i.baseColumn=c))),j=a.arrayInfo,j&&!j.isDynamicArray?d.bv(b,c,D(j.rowCount,10),D(j.colCount,10),m,!0,f):(j&&(j.isInvalid&&l.LIb(b,c),k=l.getCalcSourceModel(),k.t$J=!0,l.RLb().setArray(l,j.row,j.col,j.rowCount,j.colCount,[],!0),delete k.t$J),d._u(b,c,m,g,!0,f,!0,!j)))}function aa(a,b,c,e,f,g,h){var i,j,k,l,m,n,o,p,q,r=f&&f.incrementLoadTask;if(r&&!r.isTerminated){for(i=r.isBusyFunc,g=g||0,j=g,a.suspendPaint(),k=30,l=new Date;j<c;){if(m=b[j])for(n=0;n<e;n++)_(m[n],j,n,a,!0,h);if(j++,i&&i())break;if(o=new Date,o-l>k)break}a.resumePaint(),f||(f={}),p=f&&f.incrementalLoading,p&&(p.loadStatus.formulaLoad+=j-g,q=$(p.loadStatus,f.doNotRecalculateAfterLoad),a.parent&&a.parent.Wq(d.Events.ProgressChanged,{loadStatus:p.loadStatus,progress:q,sheet:a}),p.loading&&p.loading(q,{sheet:a})),j<c&&f.incrementLoadTask.pushTask(aa,[a,b,c,e,f,j])}}function ba(a,b,c,d,e){var f,g,h;for(f=0;f<c;f++)if(g=b[f])for(h=0;h<d;h++)_(g[h],f,h,a,!0,e)}b.R$J=ba;function ca(a,b,c,d,e,f,h){var l,m,n,o,p,r,s,t=a.yj(),u=a.ITa,w=u.TdK||0,x=u.UdK||0;b!==k&&(l=y(b.f),m=b.g,n=b.r,n!==k&&(o=v(n)),"shared"===b.d&&m>=0&&(l?(r={formula:l},o&&(r.lastRow=o.rowCount+o.row-1,r.lastColumn=o.colCount+o.col-1,r.baseRow=o.row,r.baseColumn=o.col,o=j),f[m]||(f[m]=r,f.nextIndex=Math.max(f.nextIndex,m+1)),l={si:m}):l={si:m},s=a.Q5J[l.si],s.baseRow===c&&s.baseColumn===d?l=s.formula:(p=e.Kf(s.baseRow,s.baseColumn),p?(p.S5J=l.si,a.Wu.UXJ&&a.Wu.UXJ[t.id+","+s.baseRow+","+s.baseColumn]&&(a.Wu.UXJ[t.id+","+c+","+d]={id:t.id,row:c,col:d})):(l=s.formula,s.baseRow=c,s.baseColumn=d))),q(l)||(1===+b.a&&o&&(o.isDynamicArray=!0,h&&h.spillCells&&h.spillCells[c+","+d]&&(o.isInvalid=!0)),l=g.processFunctionPrefix(l),o&&!o.isDynamicArray?c>=w&&d<x?a.bv(c,d,D(o.rowCount,10),D(o.colCount,10),l,!0,2):c<w&&d>=x?a.bv(c,d,D(o.rowCount,10),D(o.colCount,10),l,!0,1):c>=w&&d>=x&&a.bv(c,d,D(o.rowCount,10),D(o.colCount,10),l,!0,3):(o&&(o.isInvalid&&t.LIb(c,d),t.RLb().setArray(t,o.row,o.col,o.rowCount,o.colCount,[],!0)),!p&&h&&h.exprs&&h.exprs[b.e]&&(p=i.exprFromJSON(h.exprs[b.e],t.getParserContext(!1)),h.exprs[b.e].nw&&(p.T5J=!0)),c>=w&&d<x?a._u(c,d,l,p,!0,2,!0,!o):c<w&&d>=x?a._u(c,d,l,p,!0,1,!0,!o):c>=w&&d>=x&&a._u(c,d,l,p,!0,3,!0,!o))))}function da(a,b,c,e,f,g,h,i){var j,k,l,m,o,q,r,s,t,u,v,w=g&&g.incrementLoadTask,x=w.isBusyFunc;for(h=h||0,j=h,a.suspendPaint(),a.suspendCalcService(),k=g.openMode===d.OpenMode.incremental,l=30,k&&(m=new Date),o=a.Q5J=a.Q5J||{nextIndex:0},q=a.Bj(3);j<c;){if(r=b[j])for(s=0;s<e;s++)ca(a,r[s],j,s,q,o,f);if(j++,!i&&x&&x())break;if(k&&(t=new Date,!i&&t-m>l))break}a.resumeCalcService(),a.resumePaint(),g.loadStatus.formulaLoad+=j-h,k&&(u=g.loadStatus.formulaLoad/g.loadStatus.total,v=+(g.fullRecalc?.3*u+.5:.4*u+.6).toFixed(5),g.incrementLoadTask.progress&&g.incrementLoadTask.progress({progress:v,sheetName:a.name(),step:n.Kb(p().STEP.loadSheetFormula,[a.name()])})),j<c&&g.incrementLoadTask.pushTask(da,[a,b,c,e,f,g,j])}function ea(a,b,c,e){var f=d.Worksheet._n;f&&l(f,function(d,f){var g=f.fromJsonAfterFormula;g&&g.call(a,b,c,e)})}function fa(a,b,c,e){var f=d.Worksheet._n;f&&l(f,function(d,f){var g=f.fromJsonAfterSJSFormula;g&&g.call(a,b,c,e)})}function ga(a,b,c,e,f,g){var h,i=d.Worksheet._n,j=!1,k=e.getReferenceSheetNames(),m=a&&a.NjK,n=function(b){if(k.hasOwnProperty(b)){j=!0;var c=a.VCJ(b);m.sheetsState[b]||m.refSheetsState[b]||!c||(m.refSheetsState[b]=1,m.getSheet(b,function(a){c.cdK(a,f,g,!0),i&&l(i,function(b,d){d.refSheetLazyLoaded&&d.refSheetLazyLoaded.call(c,a,f,g)})}))}};for(h in k)n(h);j&&i&&l(i,function(a,d){d.afterRefSheetLazyLoaded&&d.afterRefSheetLazyLoaded.call(b,c,f,g)})}F=d.Worksheet.prototype,F.resetCalc=function(){V.call(this),this.W8J=!0},F.recalcAll=function(a){var b,c,d,e,f,g,h,i,j,l,m,n,o,p,q,r=S(this);if(r){if(this.suspendPaint(),r.suspend(!0),a)for(b=this.parent,c=void 0,c=b&&b.sheets||[this],d=0;d<c.length;d++){if(e=c[d],f=e.Tu,g=e.yj(),f)for(h in f)i=f[h],j=i.Lf,j!==k&&(l=r.unparse(g,j,0,0),i.Lf=r.parse(g,l,0,0));for(m=g.getCalcSourceModel(),n=m.getAllNodes(),o=0;o<n.length;o++)p=n[o],q=p.calc,q&&p.Lf&&na(r,q)}r.resume(a),this.resumePaint()}},F.recalcRange=function(a,b,c,d){var e=S(this);e&&e.recalcRange(this.yj(),a,b,c,d)},F.recalcRows=function(a){var b,c=S(this);if(c&&!c.ignoreDirty()){for(c.suspend(),b=0;b<a.length;b++)c.recalculate(this.ft,a[b],-1);c.resume(!1)}},F.recalcCols=function(a){var b,c=S(this);if(c&&!c.ignoreDirty()){for(c.suspend(),b=0;b<a.length;b++)c.recalculate(this.ft,-1,a[b]);c.resume(!1)}},F.zq=function(a,b,c){var d,e=S(this);e&&!e.ignoreDirty()&&(d=this.ft,1===c?d=this.sDc:2===c&&(d=this.uDc),e.recalculate(d,a,b))},F.getCalcService=function(){return this.Wu||(this.Wu=new f.CalcService,this.yj(d.SheetArea.colHeader).setCalcService(this.Wu),this.yj(d.SheetArea.rowHeader).setCalcService(this.Wu),this.yj().setCalcService(this.Wu),this.Wu.initParserContext(this.yj())),this.Wu},F.Cf=function(){return this.getCalcService()},F.suspendCalcService=function(a){var b=S(this);b&&b.suspend(a)},F.resumeCalcService=function(a){var b=S(this);b&&b.resume(a)},F.yj=function(a){return q(a)||3===a?this.ft:1===a?this.sDc:2===a?this.uDc:j},F.Bj=function(a){var b=this;return 1===a?(!b.rDc&&b.sDc&&(b.rDc=b.Cf().getSourceModel(b.sDc)),b.rDc):2===a?(!b.tDc&&b.uDc&&(b.tDc=b.Cf().getSourceModel(b.uDc)),b.tDc):(!b.et&&b.ft&&(b.et=b.Cf().getSourceModel(b.ft)),b.et)},F.vDc=function(a,b,c,d,e){var f=this.Bj(e);return f&&f.tg(a,b,c,d,!0,!0)},F.Ns=function(a,b,c,d,e,f){var g=this.vDc(a,b,c,d,3);return!g&&e&&(d=this.getColumnCount(2),g=this.vDc(a,0,c,d,2)),!g&&f&&(c=this.getRowCount(1),g=this.vDc(0,b,c,d,1)),g},F.Ms=function(a,b,c,d,e){var f=this.Bj(e);return f&&f.tg(a,b,c,d,!1,!0)},F.Vq=function(a,b,c,d,e,f,g){var h,i;return void 0===e&&(e=!0),h=e&&this.Ns(a,b,c,d,f,g),i=!e&&Y(this,a,b,c,d,f,g),!h&&!i||(this.Os(4,p().Exp_ChangePartOfArray),!1)},F.addCustomFunction=function(a){this.Xu(a),this.recalcAll()},F.Xu=function(a){if(!(a&&a instanceof f.Functions.Function))throw Error(p().Exp_InvalidCustomFunction);a.name=m(a.name),this.Su[a.name]=a},F.getCustomFunction=function(a){return a?this.Su[m(a)]:j},F.removeCustomFunction=function(a){a&&(delete this.Su[m(a)],this.recalcAll())},F.clearCustomFunctions=function(){this.Su={},this.recalcAll()},F.Pu=function(a){var b,c,d;return a?(b=this,c=b.parent,d=b.getCustomFunction(a),!d&&c&&c.getCustomFunction&&(d=c.getCustomFunction(a)),d):j},F.addCustomName=function(a,b,c,d,e){this.Yu(a,b,c,d,!1,e)},F.getCustomName=function(a){return a?this.Tu[m(a)]:k},F.getCustomNames=function(){var a=[];return l(this.Tu,function(b,c){a.push(c)}),a},F.removeCustomName=function(a){var b,c;a&&(b=m(a),delete this.Tu[b],c={},c[b]=b,this.Zu(c,!1))},F.clearCustomNames=function(){var a=this,b=a.Tu;a.Tu={},this.Zu(b,!1)},F.createNameInfo=function(a,b,c,d,e){var f,h=this,i=S(h),k=h.yj();return i&&k?(f=i.parse(k,b,d,e),new g.NameInfo(a,f,d,e,c)):j},F.H$a=function(a){var b,c=this,d=!c.Tu[m(a)];return d&&(b=c.tables,b&&(d=!b.findByName(a))),d},F.isValidCustomName=function(a){return a&&d.Ul.G$a(a)&&this.H$a(a)},F.Yu=function(a,b,c,d,e,f){var h,i,j,k,l=this;if(!a||!b||!e&&!l.isValidCustomName(a))throw Error(p().Exp_InvalidCustomName);if(h=S(l),i=l.yj(),h&&i){if(j=void 0,e)try{j=h.parse(i,b,c,d,!1,!1,!0)}catch(a){}else j=h.parse(i,b,c,d);l.Tu[m(a)]=new g.NameInfo(a,j,c,d,f),e||(k={},k[a]=a,this.Zu(k,!0))}},F.siK=function(a,b,c,d,e,f,h,i){var j,k,l,n=this;if(!a||!b||!f&&!n.isValidCustomName(a))throw Error(p().Exp_InvalidCustomName);j=S(n),k=n.yj(),j&&k&&(n.Tu[m(a)]=new g.NameInfo(a,c,d,e,h),f||(l={},l[a]=a,this.Zu(l,!0)))},F.Zu=function(a,b){var c,d=this.Bj();if(d){for(c in a)d.updateNameCalc(c,b);this.recalcAll()}},F.$u=function(a){var b,c,d;return a?(b=this,c=b.parent,d=b.getCustomName(a),!d&&c&&c.getCustomName&&(d=c.getCustomName(a)),d):j},F.setFormula=function(a,b,c,d){this._u(a,b,c,j,!1,d)},F._u=function(a,b,c,e,f,g,h,i,l){var m,n,o,r,s,t,u,v,w,x,y,z,A,B,C=this;return q(g)&&(g=3),a<0||a>=C.getRowCount(g)||b<0||b>=C.getColumnCount(g)?void C.Os(0,p().Exp_IndexOutOfRange):(m=a>=0?a:0,n=b>=0?b:0,o=C.yj(g),r=C.options.keepUnknownFormulas,s=C.Wu,s.forceR1C1Formula?(t=s.useR1C1,s.useR1C1=!0,e=e||(c&&s?s.parse(o,c,m,n,!1,f,!1,r):j),s.useR1C1=t):e=e||(c&&s?s.parse(o,c,m,n,!1,f,f,r):j),e&&i&&(e.ensureSingle=!0),u=C.tables,void(3===g&&a>=0&&b>=0&&u&&!(v=u.Hma(a,b,1,1,c,e))||(w=r&&c&&!e,x=C.Bj(g),y=C.conditionalFormats,x&&(z=x.getFormula(a,b),A=C.ITa,x.t$J=!0,x.setFormula(a,b,c,e,f,k,A.dUa(),l,r),delete x.t$J,x.usedRange&&E(x.usedRange,a,b,z,c),w&&(B=x.getNode(a,b,!0),B&&(B.H$J=c)),y&&y.Nm(),C.hasFormula(a,b,g)&&A.VkK(a,b,g),h?C.aPJ(C,[{row:a,col:b}],0):(C.Bq("formula",a,b,g,z,c),C.Wq(d.Events.WorksheetDataChanged,{type:"formula"}))),C.t4&&C.t4(a,b,1,1,g),C.$p())))},F.P5J=function(a,b,c,d,e,f,g,h){var i,k,l,m,n,o=this,q=this.Cf();if(a<0||a>=o.getRowCount()||b<0||b>=o.getColumnCount())return void o.Os(0,p().Exp_IndexOutOfRange);if(k=o.Bj(g))for(l=a;l<c+a;l++)for(m=b;m<d+b;m++)l===a&&m===b&&(o._u(a,b,e,j,!1,g),i=k.Kf(a,b),o.Q5J=o.Q5J||{nextIndex:0},n=o.Q5J.nextIndex,o.Q5J[n]={formula:q.unparse(this.ft,i,a,b,!1,!0),baseRow:a,baseColumn:b,lastRow:a+c-1,lastColumn:b+d-1},o.Q5J.nextIndex++,i.S5J=n),o._u(l,m,e,i,!0,g,!0,!0)},F.setArrayFormula=function(a,b,c,d,e,f){this.bv(a,b,c,d,e,!1,f)},F.bv=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,q,r;if(void 0===g&&(g=3),i=this,a<0||a+c>i.getRowCount()||b<0||b+d>i.getColumnCount())return void i.Os(0,p().Exp_IndexOutOfRange);if(i.ITa.MTa(a,b,c,d))return void i.Os(0,p().Exp_ArrayFormulaSpan);if(j=i.tables,!(3===g&&a>=0&&b>=0&&j)||(k=j.Hma(a,b,c,d,e))){if(l=i.Bj(g),m=i.conditionalFormats,l){for(i.suspendEvent(),n=[],o=a;o<a+c;o++)for(n[o]=[],q=b;q<b+d;q++)n[o][q]=l.getFormula(o,q);for(l.setArrayFormula(a,b,c,d,e,f,i.ITa.dUa(),h),o=a;o<a+c;o++)for(q=b;q<b+d;q++)l.usedRange&&E(l.usedRange,o,q,n[o][q],e);if(i.resumeEvent(),m&&m.Nm(),i.jm<1){for(r=[],o=a;o<a+c;o++)for(q=b;q<b+d;q++)r.push({row:o,col:q});i.Bu(a,b,c,d,r,5,g,e)}}i.$p()}},F.getFormula=function(a,b,c,d){var e=this.Bj(c);return e?e.getFormula(a,b,d):j},F.Ima=function(a,b,c){var d=this.Bj(c);return d?d.Kf(a,b):j},F.getFormulaInformation=function(a,b,c,e){var f,g,h,i,j,k={},l=this.Bj(c);return l&&(f=l.Kf(a,b),f?(g=l.Qf(a,b),k.hasFormula=!0,g&&!g.isDynamicArray&&(k.baseRange=new d.Range(g.row,g.col,g.rowCount,g.colCount)),k.isArrayFormula=g&&!g.isDynamicArray,a=g?g.row:a,b=g?g.col:b,e||(k.formula=this.Wu.unparse(this.ft,f,a,b),k.formulaWithCulture=this.Wu.unparse(this.ft,f,a,b,!0)),k.hasFormula=!!k.formula):(h=this.ITa.getDynamicArrayInfo(a,b),h&&h.isValid&&(i=h.row,j=h.col,a===i&&b===j||(f=l.Kf(i,j),e||(k.formulaWithCulture=this.Wu.unparse(this.ft,f,i,j,!0)),k.hasFormula=!0,k.isDynamicArray=!0)))),k},F.zCc=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r;for(c||(c=this,d=a,e=b,f=[]),g=c.bPJ(d,e),h=this.name(),i=0;i<g.length;i++){if(j=g[i],k=j.sheetName+"_"+j.row+"_"+j.col+"_"+j.rowCount+"_"+j.colCount,f[k])return!1;if(f[k]=!0,(j.row<=a&&a<j.row+j.rowCount||j.rowCount===-1)&&(j.col<=b&&b<j.col+j.colCount||j.colCount===-1)&&h===j.sheetName)return!0;for(l=j.sheetName===h?c:c.parent.getSheetFromName(j.sheetName),m=j.rowCount,n=j.row,o=j.colCount,p=j.col,m===-1&&(m=l.getRowCount(),n=0),o===-1&&(o=l.getColumnCount(),p=0),q=n;q<m+n;q++)for(r=p;r<o+p;r++)if(this.zCc(a,b,l,n,p,f))return!0}return!1},F.getPrecedents=function(a,b){var c,d,e,f,g,h=[],i=this.Bj();return i&&(c=i.Mf(a,b)||i.Kf(a,b),d=this.getFormulaInformation(a,b,3,!0),e=d.baseRange,f=e?e.row:a,g=e?e.col:b,this.VGb(c,f,g,h),h=Z(h)),h},F.getDependents=function(a,b){var c=[],d=this.parent&&this.parent.sheets||[this],e=this.name();return d.forEach(function(d){var f,g,h,i,j,k=d.getRowCount(),l=d.getColumnCount(),m=d.name();for(f=0;f<k;f++)for(g=0;g<l;g++)for(h=d.getPrecedents(f,g),i=0;i<h.length;i++)if(j=h[i],j.sheetName===e&&(j.row===-1||j.row<=a&&a+1<=j.row+j.rowCount)&&(j.col===-1||j.col<=b&&b+1<=j.col+j.colCount)){c.push({row:f,col:g,rowCount:1,colCount:1,sheetName:m});break}}),c};function ha(a){return function(b){var c=b.ah.xf,d=c?c.kj.name():this.name(),e=c?c.kj._id:this._id;a[e+" "+b.row+" "+b.column]={row:b.row,col:b.column,rowCount:1,colCount:1,sheetName:d}}}F.bPJ=function(a,b){var c,d,e={},f=this.Bj().qg(a,b),g=this.Bj().ug();return f&&(c=f[0],c&&c.forEach(ha(e))),g&&(d=g[0],d&&d.forEach(function(c){if((c.row===-1||c.row<=a&&a+1<=c.row+c.rowCount)&&(c.col===-1||c.col<=b&&b+1<=c.col+c.colCount)){var d=c.content;d.forEach(ha(e))}})),ia(e)};function ia(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c}F.VGb=function(a,b,c,d){var e,g,h,i,j,k;if(a)switch(e=a.type){case f.ExpressionType.reference:case f.ExpressionType.structReference:g=a.getRange(b,c),d.push({row:g.row,col:g.col,rowCount:g.rowCount,colCount:g.colCount,sheetName:a.source&&a.source.kj?a.source.kj.name():this.name()});break;case f.ExpressionType.operator:this.VGb(a.value,b,c,d),this.VGb(a.value2,b,c,d);break;case f.ExpressionType.expand:case f.ExpressionType.parentheses:this.VGb(a.value,b,c,d);break;case f.ExpressionType.name:h=this.$u(a.value),this.VGb(h.getExpression(),b,c,d);break;case f.ExpressionType.function:for(i=a.arguments,j=0;j<i.length;j++)k=i[j],this.VGb(k,b,c,d)}},F.hasFormula=function(a,b,c){var d=this.Bj(c);return!!d&&d.hasFormula(a,b)},F.dv=function(){var a=this.Bj();a&&a.kVJ(function(a){a.ng(),a.og()})},F.clearFormula=function(a,b,c,d,e){var f,g,h=this;for(a<0&&(a=0,c=h.getRowCount()),b<0&&(b=0,d=h.getColumnCount()),f=0;f<c;f++)if(e(h,f+a))for(g=0;g<d;g++)h.setFormula(f+a,g+b,j)},F.nameFunctionsFromJSON=function(a,b,c,e){var f,g,h,i,j,k,l,m,n;if(a){if(f=this,g=a.customFunctions)for(h in g)g.hasOwnProperty(h)&&(i=g[h],j=d.getTypeFromString(i.typeName),j&&(k=new j,k.fromJSON(i,b),f.Xu(k)));if(l=a.names,l&&l.length>0){for(m=0;m<l.length;m++)n=l[m],f.Yu(U(n.name),n.formula,n.row,n.col,!0,n.comment);f.dv()}e&&e()}},F.formulaFromJSON=function(a,b,c){var d,e,f;a&&(d=this,d.Q5J=a.sharedFormulas,e=c&&c.ignoreFormula,f=c&&c.incrementalLoading,[a.colHeaderData,a.rowHeaderData,a.data].forEach(function(a,b){var g,h,i,j;a&&!e&&a.dataTable&&(g=b+1,h=a.dataTable,i=d.getRowCount(g),j=d.getColumnCount(g),f?aa(d,h,i,j,c,0,g):ba(d,h,i,j,g))}),f?c.incrementLoadTask.pushTask(ea,[d,a,b,c]):ea(d,a,b,c))};function ja(a,b,c,d,e,f,g){if(f&&a.lossless&&[a.lossless.colHeaderData,a.lossless.rowHeaderData].forEach(function(a,c){var d,f,h,i;a&&a.dataTable&&(d=c+1,f=a.dataTable,h=b.getRowCount(d),i=b.getColumnCount(d),g?aa(b,f,h,i,e,0,d):ba(b,f,h,i,d))}),f&&c.mhK&&a.lossless.tree&&a.lossless.tree.length>0){delete c.mhK;var h=null,j=a.lossless.tree;"rangeCalc"===j[j.length-1].k&&(h=j.pop()),i.IiK(b.Bj(),j,e.lhK),h&&i.hhK(b.Bj(),h,e.lhK)}g?e.incrementLoadTask.pushTask(fa,[b,a,d,e]):fa(b,a,d,e)}F.formulaFromSJSFormat=function(a,b,c,e){var f,g,h,i=this,j=i.yj(),k=!c||c.includeFormulas!==!1,l=d.Util.mkK(c),m=d.Util.lkK(c,i.parent&&i.parent.NjK),o=i.Bj(3);j.q$a=!0,k&&a.lossless&&a.lossless.tree&&c.lhK&&(o.mhK=!0,j.setReferenceSheetNames(a.lossless.referenceSheetNames)),f=u(a,d.XFileConstants.HbK),f?(g=f.rowCount,h=f.colCount,e?(k&&da(i,f,g,h,a.lossless,c,0,e),ja(a,i,o,b,c,k,l)):(k&&c.incrementLoadTask.addTask(da,[i,f,g,h,a.lossless,c,0],n.Kb(p().STEP.loadSheetFormula,[i.name()]),function(){var a=c.loadStatus.formulaLoad/c.loadStatus.total;return c.fullRecalc?m?.5:a*d.STEP_RATE.loadSheetFormulaWithCalc+d.STEP_RATE.loadSheetDataWithCalc+d.STEP_RATE.parseFile+d.STEP_RATE.loadFileData:m?.6:a*d.STEP_RATE.loadSheetFormula+d.STEP_RATE.loadSheetData+d.STEP_RATE.parseFile+d.STEP_RATE.loadFileData},i.name()),c.incrementLoadTask.addTask(ja,[a,i,o,b,c,k,l]))):e?ja(a,i,o,b,c,k,l):c.incrementLoadTask.addTask(ja,[a,i,o,b,c,k,l])},F.nameFunctionFromSJSFormat=function(a,b,c){var e,f,h,k,l,m,n=this,o=n?n.yj():j,p=a.lossless&&a.lossless.customFunctions;if(p)for(e in p)p.hasOwnProperty(e)&&(f=p[e],h=d.getTypeFromString(f.typeName),h&&(k=new h,k.fromJSON(f),n.Xu(k)));l=a.lossless&&a.lossless.definedNames,m=a.lossless&&a.lossless.nExpr,l&&l.length>0&&(l.forEach(function(a){var b=""+a.c_[0];"_xlnm.Print_Titles"===a.name?sa(n,b):m&&m[a.e]?n.siK(U(a.name),g.processFunctionPrefix(d.Ul.oaa(b)),i.exprFromJSON(m[a.e],o.getParserContext(!1)),0,0,!0,a.comment,"_xlnm.Print_Area"!==a.name):n.Yu(U(a.name),g.processFunctionPrefix(d.Ul.oaa(b)),0,0,!0,a.comment,"_xlnm.Print_Area"!==a.name)}),n.dv())},F.ev=function(a){var b=this,c=b.Wu;c&&!a||(b.Wu=a?a:new f.CalcService,b.yj(d.SheetArea.colHeader).setCalcService(b.Wu),b.yj(d.SheetArea.rowHeader).setCalcService(b.Wu),b.yj(d.SheetArea.viewport).setCalcService(b.Wu),b.Wu.initParserContext(b.yj()),c?(a.setSourceModel(b.sDc,c.getSourceModel(b.sDc)),a.setSourceModel(b.uDc,c.getSourceModel(b.uDc)),a.setSourceModel(b.ft,c.getSourceModel(b.ft))):(b.rDc=b.Wu.getSourceModel(b.sDc),b.tDc=b.Wu.getSourceModel(b.uDc),b.et=b.Wu.getSourceModel(b.ft)),b.et.usedRange=new d.BaseUsedRange)},F.setCalc=function(a,b){this.Wu=a,this.ft=b||this.ft,this.et=a.getSourceModel(this.ft),this.parent&&(this.parent.Wu=a)},F.fv=function(){this.gv(!1,1)},F.mUa=function(a,b){var c,e,f,g,h,i,j,k,l=this,m=a.changeType,n=a.row,o=a.rowCount,p=a.col,q=a.colCount,r=l.Bj(),s=r.usedRange;r&&(c=l.ITa,e=c.dUa(),f=S(r),g=r.xf,h=f.ih(),i=f.lh.asyncManager,"addingRows"===m?l.Vq(n,0,0,l.getColumnCount(),void 0,!0,!1)?(j=l.Bj(2),h.onBeforeAddRemoveRows(r,n,j),b||d.clearSpillValuesOnAddRemove(c,n,o,!0,!0),la(l,n,o,!0,!0),[r,j].forEach(function(a){a.addRows(n,o)}),i.addRows(g,n,o)):a.canAdd=!1:"addRows"===m?(f.suspend(),j=l.Bj(2),h.onAfterAddRemoveRows(r,n,o,!0,b,j),f.resume(!1),e&&e.push({type:"addRows",row:n,rowCount:o}),s&&s.addHeadInfo(n,o,!0)):"deletingRows"===m?l.Vq(n,0,o,l.getColumnCount(),void 0,!0,!1)?(j=l.Bj(2),h.onBeforeAddRemoveRows(r,n,j),b||d.clearSpillValuesOnAddRemove(c,n,o,!1,!0),la(l,n,o,!1,!0),[r,j].forEach(function(a){a.deleteRows(n,o)}),i.deleteRows(g,n,o)):a.canDelete=!1:"setRowCount"===m?(f.suspend(),j=l.Bj(2),n<o?(r.Ag(n+1,0,o-n,l.getColumnCount()),j.Ag(n+1,0,o-n,l.getColumnCount())):(r.Ag(o+1,0,n-o,l.getColumnCount()),j.Ag(o+1,0,n-o,l.getColumnCount())),f.S$J(m),f.resume(!1)):"setColumnCount"===m?(f.suspend(),k=l.Bj(1),p<q?(r.Ag(0,p+1,l.getRowCount(),q-p),k.Ag(0,p+1,l.getRowCount(),q-p)):(r.Ag(0,q+1,l.getRowCount(),p-q),k.Ag(0,q+1,l.getRowCount(),p-q)),f.S$J(m),f.resume(!1)):"deleteRows"===m?(f.suspend(),j=l.Bj(2),h.onAfterAddRemoveRows(r,n,o,!1,b,j),f.resume(!1),e&&e.push({type:"deleteRows",row:n,rowCount:o}),s&&s.removeHeadInfo(n,o,!0)):"addingColumns"===m?l.Vq(0,p,l.getRowCount(),0,void 0,!1,!0)?(k=l.Bj(1),h.onBeforeAddRemoveColumns(r,p,k),b||d.clearSpillValuesOnAddRemove(c,p,q,!0,!1),la(l,p,q,!0,!1),[r,k].forEach(function(a){a.addColumns(p,q)}),i.addColumns(g,n,o)):a.canAdd=!1:"addColumns"===m?(f.suspend(),k=l.Bj(1),h.onAfterAddRemoveColumns(r,p,q,!0,b,k),f.resume(!1),e&&e.push({type:"addColumns",col:p,colCount:q}),s&&s.addHeadInfo(p,q,!1)):"deletingColumns"===m?l.Vq(0,p,l.getRowCount(),q,void 0,!1,!0)?(k=l.Bj(1),h.onBeforeAddRemoveColumns(r,p,k),b||d.clearSpillValuesOnAddRemove(c,p,q,!1,!1),la(l,p,q,!1,!1),[r,k].forEach(function(a){a.deleteColumns(p,q)}),i.deleteColumns(g,n,o)):a.canDelete=!1:"deleteColumns"===m&&(f.suspend(),k=l.Bj(1),h.onAfterAddRemoveColumns(r,p,q,!1,b,k),f.resume(!1),e&&e.push({type:"deleteColumns",col:p,colCount:q}),s&&s.removeHeadInfo(p,q,!1)))},F.CeK=function(a,b,c,d){var e,f,g,h=c.type,i=this;if(d){if("addRows"===h)c.changeType="addingRows",i.mUa(c),c.changeType="addRows",i.mUa(c);else if("deleteRows"===h)c.changeType="deletingRows",i.mUa(c),c.changeType="deleteRows",i.mUa(c);else if("addColumns"===h)c.changeType="addingColumns",i.mUa(c),c.changeType="addColumns",i.mUa(c);else if("deleteColumns"===h)c.changeType="deletingColumns",i.mUa(c),c.changeType="deleteColumns",i.mUa(c);else if("customName"===h)e=a.parse(i,c.newFormula,0,0),c.nameInfo.fg(e);else if("condition"===h){for(f=[],g=0;g<c.newFormulas.length;g++)e=a.parse(i,c.newFormulas[g],0,0),f.push(e);c.condition.setExpressions(f)}}else if("addRows"===h)c.changeType="deletingRows",i.mUa(c,!0),c.changeType="deleteRows",i.mUa(c,!0);else if("deleteRows"===h)c.changeType="addingRows",i.mUa(c,!0),c.changeType="addRows",i.mUa(c,!0);else if("addColumns"===h)c.changeType="deletingColumns",
i.mUa(c,!0),c.changeType="deleteColumns",i.mUa(c,!0);else if("deleteColumns"===h)c.changeType="addingColumns",i.mUa(c,!0),c.changeType="addColumns",i.mUa(c,!0);else if("customName"===h)e=a.parse(i,c.formula,0,0),c.nameInfo.fg(e);else if("condition"===h){for(f=[],g=0;g<c.formulas.length;g++)e=a.parse(i,c.formulas[g],0,0),f.push(e);c.condition.setExpressions(f)}},F.nUa=function(a,b,c){var d=c.type,e=this;"addRows"===d?(c.changeType="deletingRows",e.mUa(c,!0),c.changeType="deleteRows",e.mUa(c,!0)):"deleteRows"===d?(c.changeType="addingRows",e.mUa(c,!0),c.changeType="addRows",e.mUa(c,!0)):"addColumns"===d?(c.changeType="deletingColumns",e.mUa(c,!0),c.changeType="deleteColumns",e.mUa(c,!0)):"deleteColumns"===d?(c.changeType="addingColumns",e.mUa(c,!0),c.changeType="addColumns",e.mUa(c,!0)):"customName"===d?c.nameInfo.fg(c.expr):"condition"===d&&c.condition.setExpressions(c.expressions)},F.DeK=function(a,b){var c,d,e=this,f=S(e),g=e.Bj();if(f.suspend(),b)for(c=0;c<a.length;c++)d=a[c],d.type?e.CeK(f,g,d,b):d.newValue&&e.setFormula(d[0],d[1],d.formula);else for(c=a.length-1;c>=0;c--)d=a[c],d.type?e.CeK(f,g,d,b):d.newValue||e.setFormula(d[0],d[1],d.formula);f.resume(!1)},F.gUa=function(a){var b,c,d,e,f,g,h,i,j,k=S(this),l=this.Bj();for(k.suspend();a.length;){if(b=a.pop(),c=b[0],d=b[1],e=l.Kf(c,d),f=this.ITa.getDynamicArrayInfo(c,d),g=[],f)for(h=f.row;h<f.row+f.rowCount;h++)for(g[h]=[],i=f.col;i<f.col+f.colCount;i++)g[h][i]=this.getValue(h,i);if(b.type?this.nUa(k,l,b):l.$Va.apply(l,b),j=l&&l.usedRange,j&&(E(j,b[0],b[1],e,b[2]),f))for(h=f.row;h<f.row+f.rowCount;h++)for(i=f.col;i<f.col+f.colCount;i++)h===b[0]&&i===b[1]||E(j,h,i,g[h][i],b[2])}k.resume(!1)},F.getReferenceRange=function(a){var b,c,e,g,h=this.yj(),i=this.getCalcService(),j=i.parse(h,a,0,0),k=j.baseTable;return j&&k&&a===k.name()?(b=k.range(),c=k.kj&&k.kj.name()):(e=i.lh.evaluateExpression(j,h.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0),e instanceof f.CalcReference&&(c=e.getSource().getName(),e.getRangeCount()>0&&(g=0,b=d.kf(e.getRow(g),e.getColumn(g),e.getRowCount(g),e.getColumnCount(g))))),{sheetName:c,range:b}},F.C4J=function(a,b,c){var d,e=this,f="string"==typeof c&&e.parent&&e.parent.dJb(c);return f&&a!==-1&&b!==-1?(d=f.getExpression(),M(e,c)?N(e,d,a,b):g.evaluateExpression(e,d,a,b)):k},F.D4J=function(a,b,c){var d,e,h,i,j,k,l,m,n=this;if(a===-1&&(a=0),b===-1&&(b=0),d=!!n.ODJ,e=n.getCell(a,b,3),h=g.rangeToFormula(e,a,b,3),i=c.trim(),"="===i.charAt(0)&&i.indexOf("@")>=0&&!K(i)&&(i=i.replace(/@/g,h)),i.indexOf("{{")>=0&&i.indexOf("}}")>=0){for(j=i.split(/{{|}}/),""===j[0]&&j.shift(),""===j[j.length-1]&&j.pop(),k=0;k<j.length;k++)j[k].indexOf("=")===-1?j[k]='"'+j[k]+'"':d&&K(j[k])?j[k]=j[k].replace(/=/g,""):(j[k].indexOf("@")>=0&&(j[k]=j[k].replace(/@/g,h)),l=g.evaluateFormula(n,j[k]),l instanceof f.CalcError?j[k]='"'+l+'"':j[k]=j[k].replace(/=/g,""));i="=CONCAT("+j.join(",")+")"}m=n.parent,m.dJb(c)||m.E4J(m.UHb,c,i,a,b,!0,"",n.ODJ)},F.B4J=function(a,b,c,d){var e=this;return M(e,a)?N(e,b,c,d):g.evaluateExpression(e,b,c,d)};function ka(a,b){if(!b)return!0;var c=a.getRow(),e=a.getColumn(),f=a.getExpression(),g=f.getRange(c,e);return!!g&&(g instanceof d.Range||(g=new d.Range(g.row,g.col,g.rowCount,g.colCount)),!g.containsRange(b))}function la(a,b,c,d,e,f){var g,h,i,j,k,m,n,o,p,r=!d&&a.ITa.dUa(),s=!!f;if(!a.parent||!a.parent.sheets)return g=a.getCustomNames(),void(g&&l(g,function(g,j){ka(j,f)&&(h=j.getExpression(),i=ma(a,a,b,c,d,e,h,s),i!==h&&j.fg(i,r))}));for(j=a.parent.sheets,k=a.parent.getCustomNames(),m=a.parent.XLb(),n=!q(a.parent.AO)&&a.parent.fKJ(),k&&l(k,function(g,j){ka(j,f)&&(h=j.getExpression(),i=ma(null,a,b,c,d,e,h,s),i!==h&&j.fg(i,r))}),m&&l(m,function(g,j){ka(j,f)&&(h=j.getExpression(),i=ma(null,a,b,c,d,e,h,s),i!==h&&j.fg(i,r))}),n&&l(n,function(g,j){ka(j,f)&&(h=j.getExpression(),i=ma(null,a,b,c,d,e,h,s),i!==h&&j.fg(i,r))}),o=function(k){g=j[k].getCustomNames(),g&&l(g,function(g,l){ka(l,f)&&(h=l.getExpression(),i=ma(j[k],a,b,c,d,e,h,s),i!==h&&l.fg(i,r))})},p=0;p<j.length;p++)o(p)}b.wDc=la;function ma(a,b,c,d,e,g,h,i){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O;if(h){if(k=b.yj(),l=f.Hh(f.Errors.Reference,k),9===h.type){if(n=h.value,o=h.value2,p=ma(a,b,c,d,e,g,n,i),q=o&&ma(a,b,c,d,e,g,o,i),n!==p||o!==q)return f.Kh(h.operatorType,p,q)}else if(7===h.type){for(r=!1,s=[],t=void 0,u=0;u<h.arguments.length;u++)t=h.arguments[u],v=ma(a,b,c,d,e,g,t,i),r=r||t!==v,s.push(v);if(r)return f.Jh(h,s)}else if(1===h.type&&h.sf()){if(m=h.source||a&&a.yj(),w=h.row,x=h.column,y=w,z=x,m&&m===k&&(g&&!h.rowRelative||!g&&!h.columnRelative)){if(g&&e)w+=w>=c?d:0;else if(!g&&e)x+=x>=c?d:0;else if(g){if(w>=c+d)w-=d;else if(w>=c)return l}else if(x>=c+d)x-=d;else if(x>=c)return l;if(w!==y||x!==z)return f.rf(k,j,w,x,h.rowRelative,h.columnRelative)}}else if(1===h.type){if(m=h.source||a&&a.yj(),A=h.row,B=h.column,C=h.endRow,D=h.endColumn,E=h.rowRelative,F=h.columnRelative,G=h.endRowRelative,H=h.endColumnRelative,I=A,J=B,K=C,L=D,m&&m===k){if(g&&e)A+=!E&&A>=c?d:0,C+=!G&&C>=c?d:0;else if(!g&&e)B+=!F&&B>=c?d:0,D+=!H&&D>=c?d:0;else if(g&&!e){if(!E&&A>=c&&!G&&C<c+d)return l;if(E&&G||C<c)return h;if(!E)if(A>=c+d)A-=d;else if(A<c);else{if(G)return l;A>c&&(A=c)}if(!G)if(C>=c+d)C-=d;else{if(E)return l;C<c+d&&(C=c-1)}}else{if(!F&&B>=c&&!H&&D<c+d)return l;if(F&&H||D<c)return h;if(!F)if(B>=c+d)B-=d;else if(B<c);else{if(H)return l;B>c&&(B=c)}if(!H)if(D>=c+d)D-=d;else{if(F)return l;D<c+d&&(D=c-1)}}if(B!==J||D!==L||A!==I||C!==K)return f.uf(k,j,A,B,C,D,E,F,G,H)}}else if(10===h.type){if(M=h.value,N=ma(a,b,c,d,e,g,M,i),M!==N)return f.Lh(N)}else 13===h.type&&(m=h.source||a&&a.yj(),m&&m===k&&!g&&(O=h,h=O.offsetWhenInsertRemoveColumn(c,d,e,i)));return h}}function na(a,b){var c,d,e,f,g,h,i,j=b.ah,k=j.getSource(),l=-1,m=-1;b.name?(d=b.name,f=b.id,q(f)?c=j.getNodeByName(d):(c={Lf:b.expression},e=!0)):(l=b.row,m=b.column,l=void 0===l?-1:l,m=void 0===m?-1:m,c=j.getNode(l,m)),g=c.Lf,h=c.Pf,i=a.unparse(k,g,l<0?0:l,m<0?0:m),h&&(a.allowDynamicArray!==!0||a.allowDynamicArray===!0&&!h.isDynamicArray)?l===h.row&&m===h.col&&j.setArrayFormula(h.row,h.col,h.rowCount,h.colCount,i):d?e?j.setFormula(f,d,i):j.setFormulaByName(d,i):j.setFormula(l,m,i,null,!0,!0),c.Lf.CCc=g.CCc}function oa(a){var b,c,e,g,h,i,j,k,l,m,n=S(a),o=a.Bj(d.SheetArea.colHeader),p=a.Bj(d.SheetArea.rowHeader),q=a.Bj(d.SheetArea.viewport),r=[o,p,q];for(b=0;b<r.length;b++){if(c=r[b],!c)return;for(e=c.getAllNodes(),g=0;g<e.length;g++)if(h=e[g],i=h.calc)for(j=i.Ze,k=void 0,l=0;l<j.length;l++)m=i[j[l]],m&&m.forEach(function(a){a&&a instanceof f.PathCalc&&na(n,a)})}}function pa(a,b,c,d,e,f,g,i,j,k){h.CalcOperatorAdjustor.copyFormula(a.Bj(),b,c,d.Bj(),e,f,g,i,j,k)}b.vyb=pa;function qa(a,b){var c=a.offset(0,0,!1,0,0);return c.rowRelative=c.endRowRelative=c.columnRelative=c.endColumnRelative=b,c}function ra(a,b,c,d,e,g,i,j,k,l){var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;if(l){if(9===l.type){if(m=l.value,n=l.value2,o=ra(a,b,c,d,e,g,i,j,k,m),p=n&&ra(a,b,c,d,e,g,i,j,k,n),m!==o||n!==p)return f.Kh(l.operatorType,o,p)}else if(7===l.type){for(q=!1,r=[],s=void 0,t=0;t<l.arguments.length;t++)s=l.arguments[t],u=ra(a,b,c,d,e,g,i,j,k,s),q=q||s!==u,r.push(u);if(q)return f.Jh(l,r)}else if(1===l.type){if(v=!Q(l)&&!O(l),w=!R(l)&&!P(l),x=b.yj(),(!l.source||l.source===x)&&v&&w)return y=e.yj(),z=new h.MoveSwapInfo(x,c,d,y,g,i,j,k),A=qa(l,!0),B={isCustomName:!0},C=h.adjustFormulaOnMoveSwap(x,0,0,A,z,!0,B),C===A?l:1===C.type&&qa(C,!1)||C}else if(10===l.type&&(D=l.value,E=ra(a,b,c,d,e,g,i,j,k,D),D!==E))return f.Lh(E);return l}}b.uyb=ra;function sa(a,b){var c,d,e,f,h,i,j,k=a.printInfo&&a.printInfo();if(k)for(c=b.split(","),d=0;d<c.length;d++)for(e=g.formulaToRanges(a,c[d],0,0),f=0;f<e.length;f++)for(h=e[f].ranges,i=0;i<h.length;i++)j=h[i],j.col===-1||j.colCount===-1?(k.repeatRowStart(j.row),k.repeatRowEnd(j.row+j.rowCount-1)):j.row!==-1&&j.rowCount!==-1||(k.repeatColumnStart(j.col),k.repeatColumnEnd(j.col+j.colCount-1))}function ta(a,b,c,d,e){var f=a[b];f&&(d=f.xf,q(e)||(d.WOJ=e),f.toJSON({data:c}),delete d.WOJ)}function ua(a,b,c,d,e,f){a&&(b&&!b.fullRecalc?a.resumeWithoutCalc():a.resume(!1),delete a.Q$J),c.MIb(),delete c.q$a,f.resumePaint()}d.Worksheet.$n("calc",{priority:1e3,init:V,dispose:function(a){var b,c,d,e=this;a.clearCache!==!1&&(e.ft=j,e.uDc=j,e.sDc=j,e.Wu=j,b=e.et,b&&(a.isSheetDestroy===!0?b.eHb():b.rzb(),e.et=j),c=e.tDc,c&&(a.isSheetDestroy===!0?c.eHb():c.rzb(),e.tDc=j),d=e.rDc,d&&(a.isSheetDestroy===!0?d.eHb():d.rzb(),e.rDc=j))},attach:function(a){var b=this;a instanceof d.Workbook?b.ev(a.Wu):b.ev()},onLayoutChanged:function(a){this.Cf().isAdjustSuspended()||this.mUa(a)},toJson:function(a,b){var c,e,f,g,h,i,j,k,m=this,n=m.Su;d.GC$.isEmptyObject(n)||(a.customFunctions=n),c=b&&b.newWorkSheetName,e=[],f=m.getCustomNames(),g=S(m),h=m.Bj(),i=h.xf,f&&g&&(!q(c)&&h&&i&&(i.WOJ=c),l(f,function(a,b){var c,d,f=b.getName(),h=b.getRow(),i=b.getColumn(),j=b.getExpression(),k=b.getComment();j&&(c=g.unparse(m.yj(),j,h,i,!1,!0,!0),d={name:f,formula:c,row:h,col:i},k&&(d.comment=k),e.push(d))}),e.length>0&&(a.names=e),delete i.WOJ),j=b&&b.ignoreFormula,j||(k=[m.et,m.rDc,m.tDc],[a.data,a.colHeaderData,a.rowHeaderData].forEach(function(a,b){ta(k,b,a,i,c)}),m.Q5J&&m.Q5J.nextIndex>0&&(a.sharedFormulas=m.Q5J))},fromJson:function(a,b,c,d){var e=this,f=c&&c.incrementalLoading;f||(e.clearCustomFunctions(),e.clearCustomNames()),d&&(e.nameFunctionsFromJSON(a,b,c),e.formulaFromJSON(a,b,c))},bdK:function(a,b,c){var e,f,h,j,k,m,n,o,p,r,t,u,v,w=this,x=w.Su;d.GC$.isEmptyObject(x)||(a.lossless.customFunctions=x),e=c&&c.newWorkSheetName,f=[],h=[],j=w.getCustomNames(),k=S(w),m=w.Bj(),n=m.xf,o={},w.parent&&(p=w.parent.yv,o=p&&p.getUsedCustomNames()||{}),j&&k&&!w.ODJ&&(!q(e)&&m&&n&&(n.WOJ=e),r=!c||c.includeUnusedNames!==!1,l(j,function(a,b){var d,e,j,l=b.getName(),m=b.getRow(),n=b.getColumn(),p=b.getExpression(),q=b.getComment();l.toUpperCase()!==s&&p&&(r||o[l])&&(d=z(g.encodeNameFormula(k.unparse(w.yj(),p,m,n,!1,!0,!0))),e={name:l,comment:q,formula:d},c&&c.includeCalcModelCache&&(j=i.exprToJSON(p),f.push(j),e.e=f.length-1),h.push(e))}),h.length>0&&(a.lossless.definedNames=h),f.length>0&&(a.lossless.nExpr=f),delete n.WOJ),t=c&&c.includeFormulas===!1,t||(u=w.et,u&&(n=u.xf,q(e)||(n.WOJ=e),u.bdK(a,c),delete n.WOJ),v=[w.rDc,w.tDc],a.lossless&&[a.lossless.colHeaderData,a.lossless.rowHeaderData].forEach(function(a,b){ta(v,b,a,n,e)})),!t&&d.Util.KlK(c)&&(c&&c.includeCalcModelCache&&(a.lossless.tree=i.JiK(w.Bj())),n=w.yj(),a.lossless.referenceSheetNames=n&&n.getReferenceSheetNames(),W(w,a.lossless))},cdK:function(a,b,c,e){var f,g,h=this,i=h.parent,j=d.Util.lkK(c,h.parent&&h.parent.NjK),k=c&&!c.fullRecalc,l=h.yj();h.suspendPaint(),i&&i.Wu&&(f=i.Wu,f.suspend(),f.Q$J=k),g=d.Util.mkK(c),g||(h.clearCustomFunctions(),h.clearCustomNames()),j&&(l.q$a=!0,h.nameFunctionFromSJSFormat(a,b,c),h.formulaFromSJSFormat(a,b,c,e),e?ga(i,h,a,l,b,c):c.incrementLoadTask.addTask(ga,[i,h,a,l,b,c])),e?ua(f,c,l,j,k,h):c.incrementLoadTask.addTask(function(a,b,c,d,e,f){ua(a,b,c,d,e,f)},[f,c,l,j,k,h])},setName:function(a){var b,c,d;oa(this),b=this.Bj(),c=S(b),d=c.lh.asyncManager,d.changeSourceName(a.oldName,a.newName)},beforeSetName:function(){this.uja&&(this.parent||this).tja()}}),d.lUa.$n("calc",{isInvalidFormula:function(a){var b=j,c=k;try{a.allowDynamicArray&&(q(g.SheetParserContext.CUJ)&&(g.SheetParserContext.CUJ=new d.Worksheet),b=g.SheetParserContext.CUJ,b.getCalcService()&&(c=b.getCalcService().allowDynamicArray,b.getCalcService().allowDynamicArray=!0)),g.formulaToExpression(b,a.value)}catch(b){a.isInvalid=!0}finally{q(b)||q(c)||!b.getCalcService()||b.getCalcService().allowDynamicArray===c||(b.getCalcService().allowDynamicArray=c)}}})},"./dist/plugins/sparkline/functions-sparkline.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-calc"),e=c("Core"),f=c("Common"),g=c("./dist/plugins/sparkline/sparkline-wrapper.js"),k=d.Convert.Fh,l=d.Convert.Ca,m=d.Functions&&d.Functions.Function,n=d.Functions&&d.Functions.bi,o=f.Common.j.Fa,p=f.Common.j.jk,q=e.GC$,r=q.inherit,s=q.extend,t=f.Sparklines.SparklineRender,u=f.Sparklines.SparklineExRenders,v=d.Errors.Value,w=e.util.fp,x=e.Vn.Xn,y=e.To.No,z=Math.floor,A=Math.min,B=null,C=void 0,D=isNaN,E=parseFloat,F=NaN,G="12px Calibri",H="PIESPARKLINE",I="AREASPARKLINE",J="SCATTERSPARKLINE",K="BULLETSPARKLINE",L="SPREADSPARKLINE",M="STACKEDSPARKLINE",N="HBARSPARKLINE",O="VBARSPARKLINE",P="VARISPARKLINE",Q="BOXPLOTSPARKLINE",R="CASCADESPARKLINE",S="PARETOSPARKLINE",T="MONTHSPARKLINE",U="YEARSPARKLINE",V="LINESPARKLINE",W="COLUMNSPARKLINE",X="WINLOSSSPARKLINE",Y="RANGEBLOCKSPARKLINE",Z="GAUGEKPISPARKLINE",$="HISTOGRAMSPARKLINE",_="IMAGE",function(a){a[a.fit=1]="fit",a[a.entireFit=2]="entireFit",a[a.originFit=3]="originFit",a[a.custom=4]="custom"}(aa||(aa={}));function Aa(a){return 0===a}function Ba(a){return 0===a||2===a}function Ca(a){return Ba(a)||8===a}function Da(a){return 0===a||1===a}function Ea(a){return 0<=a&&a<=2}function Fa(a){return 2===a||3===a}function Ga(a){return 1===a||2===a}function Ha(a,b){var c,d,e,f,g,h,i,j,m,n,o=[];if(k(a))for(c=0,d=a.getRangeCount();c<d;c++)for(e=a.getRowCount(c),f=a.getColumnCount(c),g=0;g<e;g++)for(h=0;h<f;h++)o.push(a.getValue(c,g,h));else if(b&&l(a))for(i=a.getRowCount(),j=a.getColumnCount(),m=0;m<i;m++)for(n=0;n<j;n++)o.push(a.getValue(m,n));return o}function Ia(a,b,c){var d,e,f,g,h,i,j,m,n,o=[];if(k(a)){if(d=a.getRangeCount(),d>b)for(e=a.getRowCount(b),f=a.getColumnCount(b),g=0;g<e;g++)for(o[g]=[],h=0;h<f;h++)o[g].push(a.getValue(b,g,h))}else if(c&&l(a))for(i=a.getRowCount(),j=a.getColumnCount(),m=0;m<i;m++)for(o[m]=[],n=0;n<j;n++)o[m][n]=a.getValue(m,n);return o}function Ja(a){var b;return k(a)?b=a.getValue(0,0,0):o(a)||(b=a),b}ba=function(){function a(a,b){this.name=a,this.value=b,this.typeName="SparklineExValue"}return a.prototype.toString=function(){return""},a}(),b.SparklineExValue=ba,ca=function(){function a(){var a,b,c=this.createFunction();c&&(a=c.name,b=c.evaluate,c.evaluate=function(){var c=b.call(this,arguments);return c instanceof d.CalcError?c:c?new ba(a,c):B},this.Cj=a,a&&!d.Functions.findGlobalFunction(a)&&(d.Functions.ci[a]=c)),this.typeName=""}return a.prototype.name=function(){return this.Cj},a.prototype.createFunction=function(){return B},a.prototype.paint=function(a,b,c,d,e,f,g){},a.prototype.toJSON=function(){var a,b={};for(a in this)this.hasOwnProperty(a)&&(b[a]=this[a]);return b},a.prototype.fromJSON=function(a){if(a)for(var b in a)o(a[b])||(this[b]=a[b])},a}(),b.SparklineEx=ca,da=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.PieSparkline=da,s(da.prototype,{createFunction:function(){var a=new m(H,1,255);return a.evaluate=function(a){var b=a[0],c=Ha(b,!0);return c.length<=0&&!o(b)&&c.push(b),{values:c,colors:Array.prototype.slice.call(a,1)}},a.acceptsReference=Aa,a.acceptsArray=Aa,a},paint:u[H]}),ea=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.AreaSparkline=ea,s(ea.prototype,{createFunction:function(){var a=new m(I,1,7);return a.evaluate=function(a){return{points:Ha(a[0],!0),mini:a[1],maxi:a[2],line1:a[3],line2:a[4],colorPositive:a[5],colorNegative:a[6]}},a.acceptsReference=Aa,a.acceptsArray=Aa,a},paint:u[I]}),fa=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.ScatterSparkline=fa,s(fa.prototype,{createFunction:function(){var a=new m(J,1,18);return a.evaluate=function(a){var b=Ia(a[0],0,!0),c=Ia(a[1],0,!0);return{points1:b,points2:c,minX:a[2],maxX:a[3],minY:a[4],maxY:a[5],hLine:a[6],vLine:a[7],xMinZone:a[8],xMaxZone:a[9],yMinZone:a[10],yMaxZone:a[11],tags:a[12],drawSymbol:a[13],drawLines:a[14],color1:a[15],color2:a[16],dash:a[17]}},a.acceptsReference=Da,a.acceptsArray=Da,a},paint:u[J]}),ga=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.BulletSparkline=ga,s(ga.prototype,{createFunction:function(){var a=new m(K,3,17);return a.evaluate=function(a){return{measure:Ja(a[0]),target:Ja(a[1]),maxi:Ja(a[2]),good:Ja(a[3]),bad:Ja(a[4]),forecast:Ja(a[5]),tickUnit:Ja(a[6]),colorScheme:a[7],vertical:a[8],measureColor:a[9],targetColor:a[10],maxiColor:a[11],goodColor:a[12],badColor:a[13],forecastColor:a[14],allowMeasureOverMaxi:a[15],barSize:a[16]}},a.acceptsReference=function(a){return 0<=a&&a<=6},a},paint:u[K]}),ha=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.SpreadSparkline=ha,s(ha.prototype,{createFunction:function(){function a(a){var b,c,d,e,f=[];for(c=0,d=0,e=a.length;c<e;c++)b=E(a[c]),!D(b)&&isFinite(b)&&(f[d]=b,d++);return f}function b(a){var b,c,d,e,f,g={};for(b=0,c=void 0,d=a.length;b<d;b++)c=a[b],g[c]?g[c]++:g[c]=1;e=[];for(f in g)g.hasOwnProperty(f)&&e.push({key:E(f),value:g[f]});return e.sort(function(a,b){return a.key-b.key})}var c=new m(L,1,7);return c.evaluate=function(c){var d,e,f,g,h,i,j,k,l=Ha(c[0],!0),m=[];if(!o(l)&&(l=a(l),m=b(l),d=c[4],3===d))for(e=0,f=m.length;e<f;e++){for(g=m[e],h=g.value,i=[],j=Math.max(100,10*h),k=0;k<j+h-1;k++)i.push(Math.random());g.randomNumbers=i}return{spreadData:m,showAverage:c[1],scaleStart:c[2],scaleEnd:c[3],style:d,colorScheme:c[5],vertical:c[6]}},c.acceptsReference=Aa,c.acceptsArray=Aa,c},paint:u[L]}),ia=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.StackedSparkline=ia,s(ia.prototype,{createFunction:function(){var a=new m(M,1,13);return a.evaluate=function(a){return{points:Ha(a[0],!0),colorRange:Ha(a[1],!0),labelRange:Ha(a[2],!0),maximum:a[3],targetRed:a[4],targetGreen:a[5],targetBlue:a[6],targetYellow:a[7],color:a[8],highlightPosition:a[9],vertical:a[10],textOrientation:a[11],textSize:a[12]}},a.acceptsReference=Ea,a.acceptsArray=Ea,a},paint:u[M]}),ja=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.HBarSparkline=ja,s(ja.prototype,{createFunction:function(){var a=new m(N,1,4);return a.evaluate=function(a){return{value:Ja(a[0]),colorScheme:a[1],axisVisible:a[2],barHeight:a[3]}},a.acceptsReference=Aa,a},paint:u[N]}),ka=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.VBarSparkline=ka,s(ka.prototype,{createFunction:function(){var a=new m(O,1,4);return a.evaluate=function(a){return{value:Ja(a[0]),colorScheme:a[1],axisVisible:a[2],barWidth:a[3]}},a.acceptsReference=Aa,a},paint:u[O]}),la=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.VariSparkline=la,s(la.prototype,{createFunction:function(){var a=new m(P,1,10);return a.evaluate=function(a){return{variance:Ja(a[0]),reference:Ja(a[1]),mini:Ja(a[2]),maxi:Ja(a[3]),mark:Ja(a[4]),tickUnit:Ja(a[5]),legend:a[6],colorPositive:a[7],colorNegative:a[8],vertical:a[9]}},a.acceptsReference=function(a){return 0<=a&&a<=5},a},paint:u[P]}),ma=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.BoxPlotSparkline=ma,s(ma.prototype,{createFunction:function(){function a(a,b){return k(a)&&!D(b)&&0<=b&&b<=100?n.PERCENTILE.evaluate(a,b/100):F}function b(a){return k(a)?n.STDEVP.evaluate(a):F}var c=new m(Q,1,10);return c.evaluate=function(c){var d=c[0];return{points:Ha(d,!0),boxPlotClass:c[1],showAverage:c[2],scaleStart:Ja(c[3]),scaleEnd:Ja(c[4]),acceptableStart:Ja(c[5]),acceptableEnd:Ja(c[6]),colorScheme:c[7],style:c[8],vertical:c[9],perc02:a(d,2),perc09:a(d,9),perc10:a(d,10),perc90:a(d,90),perc91:a(d,91),perc98:a(d,98),q1:a(d,25),q3:a(d,75),median:a(d,50),stDev:b(d)}},c.acceptsReference=Aa,c.acceptsArray=Aa,c},paint:u[Q]}),na=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.CascadeSparkline=na,s(na.prototype,{createFunction:function(){var a=new m(R,1,10);return a.evaluate=function(a){return{points:Ha(a[0],!0),pointIndex:Ja(a[1]),labels:Ha(a[2],!0),minimum:Ja(a[3]),maximum:Ja(a[4]),colorPositive:a[5],colorNegative:a[6],vertical:a[7],itemTypeRange:Ha(a[8],!0),colorTotal:a[9]}},a.acceptsReference=Ca,a.acceptsArray=Ca,a},paint:u[R]}),oa=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.ParetoSparkline=oa,s(oa.prototype,{createFunction:function(){var a=new m(S,2,12);return a.evaluate=function(a){return{points:Ha(a[0],!0),pointIndex:Ja(a[1]),colorRange:Ha(a[2],!0),target:Ja(a[3]),target2:Ja(a[4]),highlightPosition:Ja(a[5]),label:a[6],vertical:a[7],targetColor:a[8],target2Color:a[9],labelColor:a[10],barSize:a[11]}},a.acceptsReference=Ba,a.acceptsArray=Ba,a},paint:u[S]}),pa=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.MonthSparkline=pa,s(pa.prototype,{createFunction:function(){var a=new m(T,3,7);return a.evaluate=function(a){var b,c,d,e,f,g,h,i,j,m=a[0],n=a[1],o=a[2],p=o;for((k(o)||l(o))&&(p=Ia(o,0,!0)),b=a[3],c=[],(k(b)||l(b))&&(c=Ia(b,0,!0)),d=[],e=[],f=0,g=p.length;f<g;f++)h=p[f],h&&(i=h[0],"string"==typeof i&&(i=new Date(i)),i&&i.getFullYear()===m&&i.getMonth()+1===n&&(j=i.getDate()-1,d[j]=h[1],c.length>0&&(e[j]=c[f][0])));return c.length>0?{year:m,month:n,values:d,colors:e}:{year:m,month:n,values:d,emptyColor:b,startColor:a[4],middleColor:a[5],endColor:a[6]}},a.acceptsReference=Fa,a.acceptsArray=Fa,a},paint:u[T]}),qa=function(a){za(b,a);function b(){return a.call(this)||this}return b.daysOfMonth=function(a,b){switch(b){case 2:var c=a%4===0&&a%100!==0||a%400===0;return c?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},b.dayInYear=function(a){var c,d=a.getFullYear(),e=a.getMonth(),f=a.getDate();for(c=1;c<e+1;c++)f+=b.daysOfMonth(d,c);return f},b}(ca),b.YearSparkline=qa,s(qa.prototype,{createFunction:function(){var a=new m(U,2,6);return a.evaluate=function(a){var b,c,d,e,f,g,h,i,j,m=a[0],n=a[1],o=n;for((k(n)||l(n))&&(o=Ia(n,0,!0)),b=a[2],c=[],(k(b)||l(b))&&(c=Ia(b,0,!0)),d=[],e=[],f=0,g=o.length;f<g;f++)h=o[f],h&&(i=h[0],"string"==typeof i&&(i=new Date(i)),i&&i.getFullYear()===m&&(j=qa.dayInYear(i)-1,d[j]=h[1],c.length>0&&(e[j]=c[f][0])));return c.length>0?{year:m,values:d,colors:e}:{year:m,values:d,emptyColor:b,startColor:a[3],middleColor:a[4],endColor:a[5]}},a.acceptsReference=Ga,a.acceptsArray=Ga,a},paint:u[U]}),ra=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.HistogramSparkline=ra,s(ra.prototype,{createFunction:function(){var a=this,b=new m($,1,9);return b.acceptsArray=function(){return!0},b.evaluate=function(b){var c,e,f,g,h,i,j,k,l,m=b[0],n=[];if(!(m instanceof d.CalcArray||m instanceof d.CalcReference))throw d.CalcError;if(n=a.OIc(m),c=b[1],o(c)&&(c=!0),e=b[2]===!0,f=b[3],o(f)&&(f=1),f<=0)throw d.CalcError;if(g=b[4],o(g)&&(g=1),g>1||g<=0)throw d.CalcError;return h=b[5]||"#5B9BD5",i=b[6],j=b[7]||"#000000",k=b[8]||"#C0C0C0",l=c?a.PIc(n,f):a.QIc(n),{values:l,continuous:c,paintLabel:e,barWidth:g,barColor:h,labelFontStyle:i,labelColor:j,edgeColor:k}},b.acceptsReference=function(a){return 0===a},b},OIc:function(a){var b,c,e=[];if(a instanceof d.CalcArray)for(b=a.toArray(1),c=0;c<b.length;c++)e.push(b[c]);else b=Ia(a,0),b.forEach(function(a){a.forEach(function(a){o(a)||"number"!=typeof a||isNaN(a)||e.push(a)})});return e},PIc:function(a,b){var c,d,e,g,h,i,j,k=[],l=0,m=this;for(a.forEach(function(a){k[l]=a,l++}),c=[],d=g=k[0],k.forEach(function(a){d=Math.min(a,d),g=Math.max(a,g)}),e=z(d/b)*b,h=Math.ceil(g/b)*b,i=1!==k.length?Math.round((h-e)/b):1,l=0;l<i;l++)c[l]=f.Common.o.Lma(l*b+e,15);for(g>=c[l-1]&&(c[l]=c[l-1]+b),j=[],l=0,i=c.length-1;l<i;l++)j[l]={value:0};for(j.length>0&&(j[0].axis="["+c[0]+","+c[1]+"]"),l=1;l<c.length-1;l++)o(c[l+1])?j[l].axis="("+c[l]+","+(c[l]+b)+"]":j[l].axis="("+c[l]+","+c[l+1]+"]";return k.forEach(function(a){var b=m.RIc(c,a);j[b].value++}),j.length>0&&0===j[0].value&&j.splice(0,1),j},QIc:function(a){var b,c,d,e,f=this,g={};for(b=0,c=a.length;b<c;++b)d=a[b],void 0===g[d]?g[d]=1:g[d]++;return e=f.SIc(g),e.sort(function(a,b){return a-b}),e.map(function(a){return{axis:a,value:g[a]}})},SIc:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&void 0!==a[b]&&null!==a[b]&&c.push(b);return c},RIc:function(a,b){var c,d,e,f,g=a.length;if(a[0]===b)return 0;if(0===g)return 0;c=0,d=g-1,e=z(d/2);do{if(f=e,b>a[e]&&b<=a[e+1])return e;b<=a[e]?(d=e,e=z((d+c)/2)):b>a[e+1]&&(c=e,e=z((e+d)/2))}while(f!==e)},paint:function(a,b,c,d,f,g,h){var i,j,k=b.labelFontStyle,l=h.zoomFactor;o(k)&&(k=a.font),i=e.To.No(k,l),j=e.To.Ko(i.font),b.afterZoomFontStyle={fontStyle:j.fontStyle,fontFamily:j.fontFamily,fontSize:j.fontSize,fontWeight:j.fontWeight,fontPixelSize:i.fontSize},u[$](a,b,c,d,f,g,h)}}),sa=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.ImageSparkline=sa,s(sa.prototype,{createFunction:function(){var a=new m(_,1,10);return a.evaluate=function(a){var b=a[0],c=a[1]||aa.fit,f=a[2],g=a[3],h=a[4]||0,i=a[5]||0,j=a[6],k=a[7],l=a[8],m=a[9];if([0,1,2].indexOf(l)===-1&&(l=e.VerticalAlign.center),[0,1,2].indexOf(m)===-1&&(m=e.HorizontalAlign.center),c===aa.custom&&(f===C||g===C))throw d.CalcError;return f=f<0?0:f,g=g<0?0:g,i=i<0?0:i,h=h<0?0:h,j=j<0?0:j,k=k<0?0:k,[1,2,3,4].indexOf(c)===-1&&(c=1),{url:b,drawType:c,height:f,width:g,clipY:h,clipX:i,clipWidth:k,clipHeight:j,vAlign:l,hAlign:m}},a},FBJ:function(a,b,c,d,f){var g,h,i,j,k,l,m,n,o=a.width,p=a.height,q=a.x,r=a.y,s=b.width,t=b.height,u={clipX:0,clipY:0,clipHeight:t,clipWidth:s,paintX:0,paintY:0,paintHeight:0,paintWidth:0};if(u=this.MBJ(u,b,c),g=o/p,h=u.clipWidth/u.clipHeight,g<h)switch(i=d.vAlign,u.paintWidth=o,j=o/h,u.paintHeight=j,u.paintX=q,i){case e.VerticalAlign.top:u.paintY=r;break;case e.VerticalAlign.center:k=p-j,u.paintY=r+k/2;break;case e.VerticalAlign.bottom:u.paintY=r+p-j}else switch(l=d.hAlign,u.paintHeight=p,m=p*h,u.paintWidth=m,u.paintY=r,l){case e.HorizontalAlign.left:u.paintX=q;break;case e.HorizontalAlign.center:n=o-m,u.paintX=q+n/2;break;case e.HorizontalAlign.right:u.paintX=q+o-m}return u},GBJ:function(a,b,c,d,e){var f={cutX:0,cutY:0,cutHeight:b.width,cutWidth:b.height,paintX:a.x,paintY:a.y,paintHeight:a.height,paintWidth:a.width};return this.MBJ(f,b,c)},MBJ:function(a,b,c){var d=b.width,e=b.height,f=c.clipX||0,g=c.clipY||0;return o(c.clipX)||(a.clipX=A(c.clipX,d)),o(c.clipY)||(a.clipY=A(c.clipY,e)),o(c.clipWidth)?a.clipWidth=d-a.clipX:a.clipWidth=c.clipWidth+f>d?d-f:c.clipWidth,o(c.clipHeight)?a.clipHeight=e-a.clipY:a.clipHeight=c.clipHeight+g>e?e-g:c.clipHeight,a},HBJ:function(a,b,c,d,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t=a.width,u=a.height,v=a.x,w=a.y,x={imgWidth:b.width,imgHeight:b.height,offsetX:0,offsetY:0};if(x=this.NBJ(x,b,c),g=x.imgWidth,h=x.imgHeight,i=x.offsetX,j=x.offsetY,k=g*f,l=h*f,m={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},n=d.hAlign,o=d.vAlign,k>t){switch(m.paintWidth=t,m.paintX=v,p=(k-t)/k*g,n){case e.HorizontalAlign.left:m.clipX=x.offsetX;break;case e.HorizontalAlign.center:m.clipX=x.offsetX+p/2;break;case e.HorizontalAlign.right:m.clipX=x.offsetX+p}m.clipWidth=t}else{switch(m.clipWidth=g,m.clipX=0,m.paintWidth=k,q=t-k,n){case e.HorizontalAlign.general:case e.HorizontalAlign.left:m.paintX=v;break;case e.HorizontalAlign.center:m.paintX=v+q/2;break;case e.HorizontalAlign.right:m.paintX=v+q}m.clipX+=i}if(l>u){switch(m.paintY=w,m.paintHeight=u,r=(l-u)/l*h,o){case e.VerticalAlign.top:m.clipY=x.offsetY;break;case e.VerticalAlign.center:m.clipY=x.offsetY+r/2;break;case e.VerticalAlign.bottom:m.clipY=x.offsetY+r}m.clipHeight=u}else{switch(m.clipHeight=h,m.clipY=0,m.paintHeight=l,s=u-l,o){case e.VerticalAlign.top:m.paintY=w;break;case e.VerticalAlign.center:m.paintY=w+s/2;break;case e.VerticalAlign.bottom:m.paintY=w+s}m.clipY+=j}return m},IBJ:function(a,b,c,d,f){var g,h,i,j,k,l,m,n,p,q,r,s,t,u,v,w,x,y={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},z=b.customWidth*f,A=b.customHeight*f;if(null===z||z<0||null===A||z<0)return y;if(g=a.width,h=a.height,i=a.x,j=a.y,k={imgWidth:b.width,imgHeight:b.height,offsetX:0,offsetY:0},k=this.NBJ(k,b,c),l=k.imgWidth,m=k.imgHeight,n=k.offsetX,p=k.offsetY,q=d.hAlign,r=d.vAlign,z>g){switch(y.paintWidth=g,y.paintX=i,s=(z-g)/z,t=s*l,q){case e.HorizontalAlign.left:y.clipX=k.offsetX;break;case e.HorizontalAlign.center:y.clipX=k.offsetX+t/2;break;case e.HorizontalAlign.right:y.clipX=k.offsetX+t}y.clipWidth=k.imgWidth*(1-s)}else{switch(y.clipWidth=l,y.clipX=0,y.paintWidth=z,u=g-z,q){case e.HorizontalAlign.general:case e.HorizontalAlign.left:y.paintX=i;break;case e.HorizontalAlign.center:y.paintX=i+u/2;break;case e.HorizontalAlign.right:y.paintX=i+u}y.clipX+=n}if(A>h){switch(y.paintY=j,y.paintHeight=h,v=(A-h)/A,w=v*m,r){case e.VerticalAlign.top:y.clipY=k.offsetY;break;case e.VerticalAlign.center:y.clipY=k.offsetY+w/2;break;case e.VerticalAlign.bottom:y.clipY=k.offsetY+w}y.clipHeight=k.imgHeight*(1-v)}else{switch(y.clipHeight=o(c.clipHeight)?m:k.imgHeight,y.clipY=0,y.paintHeight=A,x=h-A,r){case e.VerticalAlign.top:y.paintY=j;break;case e.VerticalAlign.center:y.paintY=j+x/2;break;case e.VerticalAlign.bottom:y.paintY=j+x}y.clipY+=p}return y},NBJ:function(a,b,c){var d=b.width,e=b.height;return o(c.clipX)||(a.offsetX=A(d,c.clipX)),o(c.clipY)||(a.offsetY=A(e,c.clipY)),o(c.clipWidth)?a.imgWidth=d-a.offsetX:a.imgWidth=c.clipWidth+a.offsetX>d?d-a.offsetX:c.clipWidth,o(c.clipHeight)?a.imgHeight=e-a.offsetY:a.imgHeight=c.clipHeight+a.offsetY>e?e-a.offsetY:c.clipHeight,a},paint:function(a,b,c,d,e,f,g){var h,i,j,k,l;if(!o(b)&&!o(b.url)&&p(b.url)&&""!==b.url.trim()){h=this,i=g.sheet,j={x:c,y:d,width:e,height:f},k=i.vu();try{l=b.url,k.ko(l)?h.JBJ(a,b,j,g):k.fo(l)}catch(a){}}},JBJ:function(a,b,c,d){var e,f,g,h,i,j,k,l=this,m=b.url,n=d.sheet,o=b.drawType,p=n.bt;if(m&&"string"==typeof m&&p.CHb(m)){switch(e=p.lo(m),f={width:e.width,height:e.height},g={clipY:b.clipY,clipX:b.clipX,clipWidth:b.clipWidth,clipHeight:b.clipHeight},h={vAlign:b.vAlign,hAlign:b.hAlign},j=d.zoomFactor,o){case aa.fit:i=l.FBJ(c,f,g,h,j);break;case aa.entireFit:i=l.GBJ(c,f,g,h,j);break;case aa.originFit:i=l.HBJ(c,f,g,h,j);break;case aa.custom:f.customWidth=b.width,f.customHeight=b.height,i=l.IBJ(c,f,g,h,j)}i.img=e,k="IMAGESPARKLINE",u[k](a,i,c.x,c.y,c.width,c.height,d)}}});function Ka(a,b){function c(a){var b,c,d,e,f,g={},h=!1,i=!0,j="",k="";if(a){for(a=a.substr(1,a.length-2),b=0,c=a.length;b<c;b++)d=a.charAt(b),":"===d?i=!1:","!==d||h?"'"===d||'"'===d||("("===d?h=!0:")"===d&&(h=!1),i?j+=d:k+=d):(g[j]=k,j="",k="",i=!0);j&&(g[j]=k);for(e in g)g.hasOwnProperty(e)&&(f=g[e],o(f)||("TRUE"===f.toUpperCase()?g[e]=!0:"FALSE"===f.toUpperCase()?g[e]=!1:!D(f)&&isFinite(f)&&(g[e]=E(f))))}return g}function d(a){return new e.Range(a.getRow(0),a.getColumn(0),a.getRowCount(0),a.getColumnCount(0))}function f(a){return new e.Range(0,0,a.getRowCount(),a.getColumnCount())}var h=new m(a,2,5);return h.evaluate=function(a){var e,h,i,j,m,n,p,q,r,s,t,u,v,w,x=a[0],y=l(x);if((k(x)||y)&&(e=y?1:x.getRangeCount(),e>0)){h=y?f(x):d(x),i=y?"":x.getSource().getSheet().name(),j=a[1],m=a[2],n=void 0,p=void 0,q=void 0,r=l(m),(k(m)||r)&&(q=r?"":m.getSource().getSheet().name(),e=r?1:m.getRangeCount(),e>0&&(n=r?f(m):d(m),p=a[3])),s=c(a[4]||"{}"),t={ac:"axisColor",fmc:"firstMarkerColor",hmc:"highMarkerColor",lastmc:"lastMarkerColor",lowmc:"lowMarkerColor",mc:"markersColor",nc:"negativeColor",sc:"seriesColor",deca:"displayEmptyCellsAs",rtl:"rightToLeft",dh:"displayHidden",dxa:"displayXAxis",sf:"showFirst",sh:"showHigh",slast:"showLast",slow:"showLow",sn:"showNegative",sm:"showMarkers",mmax:"manualMax",mmin:"manualMin",maxat:"maxAxisType",minat:"minAxisType",lw:"lineWeight"};for(u in t)t.hasOwnProperty(u)&&s.hasOwnProperty(u)&&(s[t[u]]=s[u]);return v=new g.SparklineSetting(s),w=v.options,1===w.maxAxisType&&(w.maxAxisType=0),1===w.minAxisType&&(w.minAxisType=0),{data:h,dataSheetName:i,dataOrientation:j,dateAxisData:n,dateAxisDataSheetName:q,dateAxisOrientation:p,
sparklineType:b,displayDateAxis:n&&!o(p),setting:v,values:Ia(x,0,!0),dateValues:Ia(m,0,!0)}}},h.acceptsReference=Ba,h.acceptsArray=Ba,h}function La(a,b,c,d,f,h,i){var j,k,l=g.Sparkline.cT,m=i.sheet,n=m.parent.getSheetFromName(b.dataSheetName),o=m.parent.getSheetFromName(b.dateAxisDataSheetName),p=b.setting;p&&p.options||(p=new g.SparklineSetting(p)),j=p.options.displayHidden,k={sparklineType:b.sparklineType,displayDateAxis:b.displayDateAxis,zoomFactor:i.zoomFactor,values:l(b.values,n||m,j,b.data,b.dataOrientation),dateValues:l(b.dateValues,o||m,j,b.dateAxisData,b.dateAxisOrientation,!0),settings:p,getColor:function(a){if(m&&a){var b=e.Rm.Om(m,a);if(b)return b}return a}},(new t).paint(a,k,c,d,f,h)}ta=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.LineSparkline=ta,s(ta.prototype,{createFunction:function(){return Ka(V,0)},paint:La}),ua=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.ColumnSparkline=ua,s(ua.prototype,{createFunction:function(){return Ka(W,1)},paint:La}),va=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.WinlossSparkline=va,s(va.prototype,{createFunction:function(){return Ka(X,2)},paint:La}),wa=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.RangeBlockSparkline=wa,s(wa.prototype,{createFunction:function(){var a=new m(Y,2,2);return a.evaluate=function(a){var b=a[0],c=b.source.getSheet(),f=a[1],g=0,h=f.getSource().getSheet(),i=f.getRow(g),j=f.getColumn(g),k=f.getRowCount(g),l=f.getColumnCount(g),m=new e.Range(b.row,b.column,1,1),n=new e.Range(i,j,k,l);if(c.name()===h.name()&&n.containsRange(m))throw d.CalcError;return{templateSheetName:h.name(),templateRange:{row:i,col:j,rowCount:k,colCount:l},bindingObject:a[2]}},a.isContextSensitive=function(){return!0},a.acceptsReference=Aa,a},paint:function(a,b,d,e,f,g,k){var l,m,n,o,p,q,r=b.templateSheetName,s=b.templateRange;r&&(l=k.sheet,m=l.parent,n=m&&m.getSheetFromName(r),n&&(i||(o=c("CellTypes"),i=o.RCc,h=o.QCc,j=o.paintRangeTemplate),p=(new i).YE(n,s),q=(new h).YE(n,s),j(a,{x:d,y:e,width:f,height:g},b.bindingObject,k,p,q.XJb)))}}),xa=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.GaugeKPISparkline=xa;function Ma(a,b,c,d,e,f,g,h){if(o(a)||o(b)||o(c)||o(d))return!1;if(D(a)||D(b)||D(c)||D(d))return!1;if(c>=d||b<c||b>d||a<c||a>d)return!1;if(!o(g)&&0!==g&&1!==g&&2!==g)return!1;if(0===g||o(g)){if(!o(e)&&!o(f)&&(D(f)||D(e)||e>=f||e<-180||f>180))return!1;if(!o(h)&&(D(h)||h>1||h<0))return!1}return!0}function Na(a,b,c){return{value:a,font:b,label:c,normalFontHeight:w(b),normalFontWidth:x(c,b),fontAfterZoom:null}}s(xa.prototype,{createFunction:function(){var a=new m(Z,4,255);return a.evaluate=function(a){var b,c,e,f,g,h,i,j,k,l,m,n=[],p=a.length,q=Ja(a[0]),r=Ja(a[1]),s=Ja(a[2]),t=Ja(a[3]),u=Ja(a[5]),w=Ja(a[6]),x=Ja(a[7]),y=Ja(a[8]),z=Ja(a[10]),A=Ja(a[11]),B=Ja(a[12]),C=a[4],E=a[13];if(!Ma(q,r,s,t,z,A,E,B))return v;for(a[9]instanceof d.CalcArray&&(j=a[9].toArray(2),c=j[0],e=j[1],f=j[2],g=j[3]),c=c||"16px Calibri",e=e||"bold 22px Calibri",f=f||G,g=g||G,u=o(u)?q:u,w=o(w)?r:w,x=o(x)?s:x,y=o(y)?t:y,k={minAngle:o(z)?-90:z,maxAngle:o(A)?90:A,radiusRatio:o(B)?0:B,targetValueOption:Na(q,c,u),currentValueOption:Na(r,e,w),minValueOption:Na(s,f,x),maxValueOption:Na(t,g,y),gaugeType:o(E)?0:E,ranges:void 0,showLabel:!!o(C)||!!C},l=14;l<p;l++)if(m=a[l],m instanceof d.CalcArray){if(b=m.toArray(0),h=b[0],i=b[1],o(h)||o(i)||D(h)||D(i)||h>i||h<s||h>t||i>t||i<s)return v;n.push({start:h,end:i,color:b[2]})}return k.ranges=n,k},a.acceptsArray=function(a){return 9===a||a>=14},a.acceptsReference=function(a){return a<=3&&a>=0||a>=5&&a<=8||a>=10&&a<=12},a},paint:function(a,b,c,d,e,f,g){var h=g.zoomFactor;b.currentValueOption.fontAfterZoom=y(b.currentValueOption.font,h).font,b.targetValueOption.fontAfterZoom=y(b.targetValueOption.font,h).font,b.minValueOption.fontAfterZoom=y(b.minValueOption.font,h).font,b.maxValueOption.fontAfterZoom=y(b.maxValueOption.font,h).font,u[Z](a,b,c,d,e,f,g)}}),ya={},b.w_a=ya;function Oa(a){a&&(ya[a.name()]=a)}m&&(Oa(new da),Oa(new ea),Oa(new fa),Oa(new ga),Oa(new ha),Oa(new ia),Oa(new ja),Oa(new ka),Oa(new la),Oa(new ma),Oa(new na),Oa(new oa),Oa(new pa),Oa(new qa),Oa(new ta),Oa(new ua),Oa(new va),Oa(new wa),Oa(new xa),Oa(new ra),Oa(new sa)),s(e.Workbook.prototype,{addSparklineEx:function(a){this.dT||(this.dT={});var b=this.dT;a&&(b[a.name()]=a)},getSparklineEx:function(a){var b,c=ya[a];return c?c:(b=this.dT,b&&b[a])},removeSparklineEx:function(a){var b=this.dT;b&&(b[a]=void 0)}}),e.Workbook.$n("sparklineEx",{toJson:function(a){var b,c,d,e=this.dT,f=[];if(e){for(b in e)e.hasOwnProperty(b)&&(c=e[b],d=c.toJSON(),d&&d.typeName&&f.push(d));f.length>0&&(a.sparklineExs=f)}},fromJson:function(a){var b,c,d,f,g=a.sparklineExs;if(g)for(b=0;b<g.length;b++)c=g[b],d=e.getTypeFromString(c.typeName),d&&(f=new d,f.fromJSON(c),this.addSparklineEx(f))},bdK:function(a,b,c){var d,e,f,g=this.dT,h=[];if(g){for(d in g)g.hasOwnProperty(d)&&(e=g[d],f=e.toJSON(),f&&f.typeName&&h.push(f));h.length>0&&(a.workbook.lossless.sparklineExs=h)}},cdK:function(a,b,c){var d,f,g,h,i=a.workbook.lossless,j=i&&i.sparklineExs;if(j)for(d=0;d<j.length;d++)f=j[d],g=e.getTypeFromString(f.typeName),g&&(h=new g,h.fromJSON(f),this.addSparklineEx(h))}})},"./dist/plugins/sparkline/sparkline-wrapper.entry.js":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/sparkline/functions-sparkline.js"),b.w_a=d.w_a,b.PieSparkline=d.PieSparkline,b.AreaSparkline=d.AreaSparkline,b.ScatterSparkline=d.ScatterSparkline,b.BulletSparkline=d.BulletSparkline,b.SpreadSparkline=d.SpreadSparkline,b.StackedSparkline=d.StackedSparkline,b.HBarSparkline=d.HBarSparkline,b.VBarSparkline=d.VBarSparkline,b.VariSparkline=d.VariSparkline,b.BoxPlotSparkline=d.BoxPlotSparkline,b.CascadeSparkline=d.CascadeSparkline,b.ParetoSparkline=d.ParetoSparkline,b.MonthSparkline=d.MonthSparkline,b.YearSparkline=d.YearSparkline,b.LineSparkline=d.LineSparkline,b.ColumnSparkline=d.ColumnSparkline,b.WinlossSparkline=d.WinlossSparkline,b.RangeBlockSparkline=d.RangeBlockSparkline,b.GaugeKPISparkline=d.GaugeKPISparkline,b.SparklineEx=d.SparklineEx,b.SparklineExValue=d.SparklineExValue,b.HistogramSparkline=d.HistogramSparkline,b.ImageSparkline=d.ImageSparkline,e=c("./dist/plugins/sparkline/sparkline-wrapper.js"),b.EmptyValueStyle=e.EmptyValueStyle,b.SparklineAxisMinMax=e.SparklineAxisMinMax,b.SparklineSetting=e.SparklineSetting,b.SparklineType=e.SparklineType,b.DataOrientation=e.DataOrientation,b.Sparkline=e.Sparkline},"./dist/plugins/sparkline/sparkline-wrapper.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("@grapecity/js-calc"),g=c("SheetsCalc"),h=d.Ul,i=h.JcK,j=h.IcK,k=d.range_parser.CcK,l=d.NodeHelper.qca,m=d.NodeHelper.oca,n=h.QcK,o=h.PcK,p=d.range_parser.FcK,q=d.GC$.isEmptyObject,r=d.kf,s=e.Common.j.Fa,t=e.Common.k,u=t.Fb,v=t.ac,w=t.Bb,x=e.Sparklines.Vd,y=e.Sparklines.SparklineRender,z=null,A=void 0,B=Math.max,C=Number.MAX_VALUE,D=d.UsedRangeUtil.SZJ,function(a){a[a.line=0]="line",a[a.column=1]="column",a[a.stacked=2]="stacked"}(E||(E={})),function(a){a[a.span=2]="span",a[a.gap=0]="gap",a[a.zero=1]="zero"}(F||(F={})),function(a){a[a.individual=0]="individual",a[a.group=1]="group",a[a.custom=2]="custom"}(G||(G={})),d.GC$.extend(d.lUa.prototype,{FUa:function(a){var b,c,d,e=this,f=e.zTa,g=arguments[1];if(f){switch(f.originalSparklines||(f.originalSparklines=[]),b={type:a},a){case 0:c=g,d=void 0,d=c&&c.sparkline?c.sparkline:z,b.changeInfo={row:c.row,col:c.col,sparkline:d};break;case 12:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:b.changeInfo=g}f.originalSparklines.push(b)}},IUa:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=a.changeInfo;switch(a.type){case 12:p.sparkline?(p.sparkline.row=p.row,p.sparkline.column=p.col,o.ZA.JUa(p.row,p.col,p.sparkline)):o.ZA.JUa(p.row,p.col,z);break;case 0:o.ZA.JUa(p.row,p.col,p.sparkline),p.sparkline&&!o.ZA.contains(p.sparkline.group())&&o.ZA.add(p.sparkline.group());break;case 1:for(c=void 0,d=void 0,e=void 0,f=v(p),g=0;g<f;g++)c=p[g].row,d=p[g].col,e=o.ZA.KUa(c,d),0===g&&e.cb.count()===f&&o.ZA.remove(e.cb),this.ZA.add(e.group(p[g].group).cb);break;case 2:for(h=[],i=0;i<v(p);i++)h.push(o.ZA.KUa(p[i].row,p[i].col));o.ZA.kj.groupSparkline(h);break;case 3:b=o.ZA.KUa(p.row,p.col),b.sparklineType(p.sparklineType);break;case 4:b=o.ZA.KUa(p.row,p.col),b.setting(p.setting);break;case 5:p.sparkline.data(p.data);break;case 15:b=o.ZA.KUa(p.row,p.col),b.dataSheetName(p.dataSheetName);break;case 6:b=o.ZA.KUa(p.row,p.col),b.dataOrientation(p.dataOrientation);break;case 7:b=o.ZA.KUa(p.row,p.col),b.displayDateAxis(p.displayDateAxis);break;case 8:j=void 0,k=p.rangeInfo,j=k?r(k.row,k.col,k.rowCount,k.colCount):k,p.group.dateAxisData(j);break;case 16:p.group.dateAxisDataSheetName(p.dateAxisDataSheetName);break;case 9:p.group.dateAxisOrientation(p.dateAxisOrientation);break;case 10:for(l=p.group.PS,l.forEach(function(a){o.ZA.vZa(a)}),p.group.PS=p.innerList,m=p.group.PS,n=0;n<v(m);n++)m[n].group(p.group);m.forEach(function(a){o.ZA.tZa(a)});break;case 11:b=o.ZA.KUa(p.row,p.col),b.group(p.group);break;case 13:u(o.ZA.groups(),p),o.ZA.yZa(p);break;case 14:o.ZA.groups().push(p),o.ZA.zZa(p)}},LUa:function(a){var b,c=v(a);for(b=c-1;b>=0;b--)this.IUa(a[b])},MUa:function(a,b){this.ZA.rI(a,b)},NUa:function(a,b){this.ZA.GR(a,b)},OUa:function(a,b){this.ZA.tI(a,b)},PUa:function(a,b){this.ZA.HR(a,b)},QUa:function(a,b,c,d){this.ZA.clear(a,b,c,d)},wZa:function(){var a=this.zTa;return a?(a.xZa||(a.xZa=[]),a.xZa):z}}),d.lUa.$n("sparkline",{init:function(){var a=this.kj;this.ZA=new J(a)},undo:function(a){var b,c,d=a.originalSparklines;d&&this.LUa(d),b=this.kj,c=a.xZa,c&&c.forEach(function(a){var c=b.parent.getSheetFromName(a.sheetName).ITa;c.undo(a.changes)})}}),H={init:function(){this.ZA=this.ITa.ZA},getUsedRange:function(a){var b,c,e;a.type&d.UsedRangeType.sparkLine&&(b=this,c=b.ZA,e=c.getUsedRange(),D(a.range,e))},dispose:function(a){if(a.clearCache!==!1){var b=this;b.ZA&&(b.ZA.kj=z,b.ZA.evaluator=z,b.ZA=z),b.ITa&&(b.ITa.ZA=z)}},onLayoutChanged:function(a){var b,c=a.changeType,d=a.row,e=a.rowCount,f=a.col,g=a.colCount,h=this.ITa;"addRows"===c?h.MUa(d,e):"deleteRows"===c?h.NUa(d,e):"addColumns"===c?h.OUa(f,g):"deleteColumns"===c?h.PUa(f,g):"clear"===c&&(b=a.type,3===a.sheetArea&&16===(16&b)&&h.QUa(d,f,e,g))},toJson:function(a,b){var c=b&&b.ignoreStyle;c||(a.sparklineGroups=this.ZA.toJSON())},bdK:function(a,b,c){var e,f,g=!c||c.includeStyles!==!1;g&&(e=this.ZA.bdK(),f=i(a,d.XFileConstants.Xkb),e.c_.length>0&&f.c_.push({n_:"ext",c_:[e],r_:[0,1]}))},fromJson:function(a,b,c){var d=c&&c.ignoreStyle,e=this,f=e.ZA,g=a.sparklineGroupManager,h=b?g&&g.groups:a.sparklineGroups;h&&!d&&f.RUa(h,b)},cdK:function(a,b,c){var d=c&&c.includeStyles===!1,e=this,f=e.ZA,g=j(a,"extLst&ext&sparklineGroups"),h=g&&g.c_;h&&!d&&(f.EeK(h,c),f.groups().forEach(function(a){a.PS.forEach(function(a){f.SUa(a)})}))},setName:function(a){var b=a.oldName,c=a.newName;this.ZA.jOa(b,c)}},d.Worksheet.$n("sparkline",H);function U(a,b,c,d){var e=g.formulaToRanges(a,b,c,d),f=e[0],h=f&&f.ranges&&f.ranges[0];return h?{range:h,sheetName:f.sheetName}:z}I={getSparkline:function(a,b){return this.ZA?this.ZA.KUa(a,b):z},setSparkline:function(a,b,c,d,e,f,h,i){var j,k,l,m,n,o,p,q,r,t,u,v,w,x=this,y=x.ZA;if(!y)return z;if("string"==typeof c&&(l=U(x,c,a,b),m=x.getCustomName(c)||x.parent.getCustomName(c),n=void 0,s(m)||(n=g.formulaToRanges(x,g.expressionToFormula(x,m.getExpression(),a,b,1===x.parent.options.referenceStyle))),n?(k=c,o=ia(n),p=o.ranges,q=o.sheetName,c=p,j=q):l&&(c=l.range,j=l.sheetName),!l&&!n))return z;if(r=new T(a,b,c,d,e,f,k),j&&j!==x.name()&&r.dataSheetName(j),h&&!s(i)){if(t=void 0,"string"==typeof h&&(u=U(x,h,a,b),m=x.getCustomName(h)||x.parent.getCustomName(h),n=void 0,s(m)||(n=g.formulaToRanges(x,g.expressionToFormula(x,m.getExpression(),a,b,1===x.parent.options.referenceStyle))),n?(r.group().T$J=h,v=ia(n),p=v.ranges,q=v.sheetName,h=p,t=q):u&&(h=u.range,t=u.sheetName),!u&&!n))return z;r.dateAxisData(h),t&&t!==x.name()&&r.dateAxisDataSheetName(t),r.dateAxisOrientation(i),r.group().displayDateAxis=!0}return w=x.getSparkline(a,b),x.removeSparkline(a,b),V.call(x,a,b,w,r),x.$p(),r},ZLb:function(a,b,c){var d=this,e=d.getSparkline(a,b);V.call(this,a,b,e,c)},removeSparkline:function(a,b){var c,d,e,f=this,g=f.ZA;g&&(c=f.getSparkline(a,b),d={row:a,col:b,sparkline:c},f.ITa.FUa(0,d),c&&(e=c.group(),e.remove(c),e.count()<=0&&g.remove(e),V.call(f,a,b,c,z)),f.$p())},groupSparkline:function(a){var b,c,d,e,f,g,h=this,i=h.ZA;if(!i)return z;for(b=z,c=[],d=h.ITa.zTa!==A,e=0;e<a.length;e++)f=a[e],f&&(d&&c.push({group:f.group().clone(),row:f.row,col:f.column}),b?(g=f.group(),g.remove(f),b.add(f),g.count()<=0&&i.remove(g)):b=f.group());return h.$p(),h.ITa.FUa(1,c),b},ungroupSparkline:function(a){var b,c,d,e,f,g,h=this,i=h.ZA;if(i&&a){for(b=[],c=[],d=h.ITa.zTa!==A,b=b.concat(a.PS),e=0;e<b.length;e++)f=b[e],f&&(d&&c.push({row:f.row,col:f.column}),a.remove(f),g=a.clone(),g.add(f),i.add(g));i.remove(a),h.ITa.FUa(2,c),h.$p()}}};function V(a,b,c,e){var f=this,g=f.ZA;g.JUa(a,b,e),e&&g.add(e.group()),f.Bq("sparkline",a,b,3,c,e),f.Wq(d.Events.WorksheetDataChanged,{type:"sparkline"})}d.GC$.extend(d.Worksheet.prototype,I),J=function(){function a(a){this.Ub=[],this.kj=a,this.xn={},this.qZa=[],this.rZa=[]}return a.prototype.getUsedRange=function(){var a,b,c,d,e,f,g,h=this,i=h.xn,j={};if(i)for(a=Object.keys(i),b=void 0,c=void 0,d=void 0,e=0,f=a;e<f.length;e++)g=f[e],b=i[g],c=b.row,d=b.column,D(j,{minRow:c,minCol:d,maxRow:c,maxCol:d});return j},a.prototype.RUa=function(a,b){var c=this;c.fromJSON(a,b),c.groups().forEach(function(a){a.PS.forEach(function(a){c.SUa(a)})})},a.prototype.EeK=function(a,b){var c=this,d=c.kj;c.cdK(a,b),c.groups().forEach(function(a){a.PS.forEach(function(a){c.SUa(a),a.row>=d.getRowCount()&&d.setRowCount(a.row+1),a.column>=d.getColumnCount()&&d.setColumnCount(a.column+1)})})},a.prototype.SUa=function(a){a&&this.JUa(a.row,a.column,a)},a.prototype.JUa=function(a,b,c){if(this.kj.ITa.zTa){var d={row:a,col:b,sparkline:this.KUa(a,b),newSparkline:c};this.kj.ITa.FUa(12,d)}c?this.xn[W(a,b)]=c:delete this.xn[W(a,b)]},a.prototype.KUa=function(a,b){return this.xn[W(a,b)]||z},a.prototype.groups=function(a){return 0===arguments.length?this.Ub:void(this.Ub=a)},a.prototype.add=function(a){var b=this;b.kj.ITa.FUa(13,a),b.groups().push(a),a.ZA=b,a.QS(),b.zZa(a)},a.prototype.zZa=function(a){var b=this;b.sZa(a),a.all().forEach(function(a){b.tZa(a)})},a.prototype.remove=function(a){var b=this;b.kj.ITa.FUa(14,a),u(b.groups(),a),b.yZa(a)},a.prototype.yZa=function(a){var b=this;b.uZa(a),a.all().forEach(function(a){b.vZa(a)})},a.prototype.contains=function(a){return w(this.groups(),a)},a.prototype.count=function(){return this.groups().length},a.prototype.rI=function(a,b){Z(this.Ub,a,b,!0,this),$(a,b,!0,this.rZa,this.qZa,this.kj.ITa.wZa())},a.prototype.tI=function(a,b){Z(this.Ub,a,b,!1,this),$(a,b,!1,this.rZa,this.qZa,this.kj.ITa.wZa())},a.prototype.GR=function(a,b){da(this.Ub,a,b,!0,this),fa(a,b,!0,this.rZa,this.qZa,this.kj.ITa.wZa())},a.prototype.HR=function(a,b){da(this.Ub,a,b,!1,this),fa(a,b,!1,this.rZa,this.qZa,this.kj.ITa.wZa())},a.prototype.jOa=function(a,b){this.rZa.forEach(function(c){c.dateAxisDataSheetName()===a&&c.dateAxisDataSheetName(b)}),this.qZa.forEach(function(c){c.dataSheetName()===a&&c.dataSheetName(b)})},a.prototype.tZa=function(a){var b,c,d=this.kj,e=a.dataSheetName();e&&e!==d.name()&&(b=d.parent.getSheetFromName(e),b&&(c=b.ZA.qZa,c.indexOf(a)<0&&c.push(a)))},a.prototype.vZa=function(a){var b,c,d,e=a.dataSheetName();e&&(b=this.kj.parent.getSheetFromName(e),b&&(c=b.ZA.qZa,d=c.indexOf(a),d>=0&&c.splice(d,1)))},a.prototype.sZa=function(a){var b,c,d=this.kj,e=a.dateAxisDataSheetName();e&&e!==d.name()&&(b=d.parent.getSheetFromName(e),b&&(c=b.ZA.rZa,c.indexOf(a)<0&&c.push(a)))},a.prototype.uZa=function(a){var b,c,d,e=a.dateAxisDataSheetName();e&&(b=this.kj.parent.getSheetFromName(e),b&&(c=b.ZA.rZa,d=c.indexOf(a),d>=0&&c.splice(d,1)))},a.prototype.clear=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n=this;if(0===arguments.length){for(e=n.Ub,f=v(e)-1;f>-1;f--)if(g=e[f]){for(h=g.count()-1;h>-1;h--)i=g.PS[h],n.JUa(i.row,i.column,z),g.remove(i);n.remove(g)}}else for(j=a;j<a+c;j++)for(k=b;k<b+d;k++)l=n.RS(j,k),l&&(n.JUa(l.row,l.column,z),m=l.group(),m.remove(l),0===m.count()&&n.remove(m))},a.prototype.RS=function(a,b){var c,d,e,f,g=this.Ub;for(c=0;c<g.length;c++)for(d=g[c],e=0;e<d.count();e++)if(f=d.PS[e],f&&f.row===a&&f.column===b)return f;return z},a.prototype.Zz=function(a,b,c,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,A,B=this,C=B.kj;if(C){for(j=new d.KTa,k=c-a,l=e-b,o=C.getRowCount(),p=C.getColumnCount(),t=f,u=g,v=C.ZA,w=!i&&C.CMc(),m=0,q=0;m<f&&c+m<o;m++)if(w&&0===C.getRowHeight(c+m))f++;else if(h&&C.Ps&&C.Ps(c+m))q++;else{for(n=0,r=0,g=u;n<g&&e+n<p;n++)w&&0===C.getColumnWidth(e+n)?g++:(x=C.getSparkline(a+q,b+r),x&&(y=x.clone(),y.row=c+m,y.column=e+n,s(y.dateAxisData())&&y.dateAxisData(y.group().T$J),z=y.dateAxisData(),w&&(k=c-a+m-q,l=e-b+n-r),!s(z)&&B.SS(z,k,l,o,p)&&s(y.group().customName)&&y.dateAxisData(z.offset(l,k)),s(y.data())&&y.data(y.a$J),A=y.data(),!s(A)&&B.SS(A,k,l,o,p)&&s(y.a$J)&&y.data(A.offset(l,k)),B.add(y.group()),j.set(m,n,y)),r++);q++}for(m=0,f=t;m<f&&c+m<o;m++)if(w&&0===C.getRowHeight(c+m))f++;else if(!(h&&C.Ps&&C.Ps(c+m)))for(n=0,g=u;n<g&&e+n<p;n++)w&&0===C.getColumnWidth(e+n)?g++:v.JUa(c+m,e+n,j.get(m,n))}},a.prototype.SS=function(a,b,c,d,e){var f,g,h,i,j=this.TS(a);return!!j&&(f=B(j.row,0),g=B(j.col,0),h=j.row<0?d:j.rowCount,i=j.col<0?e:j.colCount,!(f+b<0||g+c<0||f+h+b>d||g+i+c>e))},a.prototype.aB=function(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t=this.kj;if(t){for(j=t.CMc(),k=g,l=f,this.US(a,b,c,e,f,g),m=t.ZA,n=new d.KTa,q=t.getRowCount(),r=t.getColumnCount(),o=0,h=0;o<f&&o+c<q;o++)if(j&&0===t.getRowHeight(c+o))f++;else{for(p=0,i=0,g=k;p<g&&e+p<r;p++)j&&0===t.getColumnWidth(e+p)?g++:(s=t.getSparkline(a+h,b+i),s&&(s.row=c+o,s.column=e+p,n.set(h,i,s)),m.JUa(a+h,b+i,z),i++);h++}for(o=0,h=0,f=l;o<f&&o+c<q;o++)if(j&&0===t.getRowHeight(c+o))f++;else{for(p=0,i=0,g=k;p<g&&e+p<r;p++)j&&0===t.getColumnWidth(e+p)?g++:(t.removeSparkline(c+o,e+p),m.JUa(c+o,e+p,n.get(h,i)),i++);h++}}},a.prototype.US=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,z,A,B,C=this;if(g&&(C=g),h=C.kj,i=h.CMc(),j=r(a,b,e,f),m=f,s=h.getRowCount(),t=h.getColumnCount(),u=C.Ub,i)for(o=0,q=0;o<e&&o+c<s;o++)if(0!==h.getRowHeight(c+o)){for(n=0,p=0,f=m;n<f&&n+d<t;n++)if(0!==h.getColumnWidth(d+n)){if(v=h.getSparkline(a+q,b+p))for(k=c-a+o-q,l=d-b+n-p,w=v.cb,x=w.PS,y=0;y<x.length;y++)z=x[y],z&&C.HMc(z,k,l,j);p++}else f++;q++}else e++;else for(k=c-a,l=d-b,y=0;y<u.length;y++)for(A=u[y],x=A.PS,B=0;B<x.length;B++)v=x[B],v&&C.HMc(v,k,l,j)},a.prototype.HMc=function(a,b,c,d){var e,f,g,h,i=this;s(a.dateAxisData())&&a.dateAxisData(a.group().T$J),e=a.dateAxisData(),f=i.TS(e),f&&d.containsRange(f)&&d.contains(a.row,a.column)&&a.dateAxisData(e.offset(c,b)),s(a.data())&&a.data(a.a$J),g=a.data(),h=i.TS(g),h&&d.containsRange(h)&&d.contains(a.row,a.column)&&a.data(g.offset(c,b))},a.prototype.TS=function(a){return a},a.prototype._A=function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,A=this,B=A.kj;if(B){if(a===B)return void A.Zz(b,c,d,e,f,g);for(j=d-b,k=e-c,l=B.ZA,m=!i&&B.CMc(),n=B.getRowCount(),o=B.getColumnCount(),p=g,q=0,t=0;q<f&&d+q<n;q++)if(m&&0===B.getRowHeight(d+q))f++;else if(h&&B.Ps&&B.Ps(d+q))t++;else{for(r=0,u=0,g=p;r<g&&e+r<o;r++)m&&0===B.getColumnWidth(e+r)?g++:(v=a.getSparkline(b+t,c+u),v?(w=v.clone(),w.row=d+q,w.column=e+r,s(w.dateAxisData())&&w.dateAxisData(w.group().T$J),x=w.dateAxisData(),m&&(j=d+q-b-t,k=e-c+r-u),!s(x)&&A.SS(x,j,k,n,o)&&w.dateAxisData(x.offset(k,j)),s(w.data())&&w.data(w.a$J),y=w.data(),!s(y)&&A.SS(y,j,k,n,o)&&w.data(y.offset(k,j)),A.add(w.group()),l.JUa(d+q,e+r,w)):l.JUa(d+q,e+r,z),u++);t++}}},a.prototype.$A=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u=this,v=u.kj;if(v){if(a===v)return void u.aB(b,c,d,e,f,g);for(h=v.CMc(),i=g,j=a.ZA,k=v.ZA,p=v.getRowCount(),q=v.getColumnCount(),u.VS(a,b,c,d,e,f,g),l=0,n=0;l<f&&d+l<p;l++)if(h&&0===v.getRowHeight(d+l))f++;else for(m=0,o=0,g=i;m<g&&e+m<q;m++)h&&0===v.getColumnWidth(e+m)?g++:(r=a.getSparkline(b+n,c+o),r?(r.row=d+l,r.column=e+m,s=r.group(),t=s.clone(),s.remove(r),s.count()<=0&&j.remove(s),t.add(r),u.add(t),k.JUa(d+l,e+m,r)):k.JUa(d+l,e+m,z),j.JUa(b+n,c+o,z))}},a.prototype.VS=function(a,b,c,d,e,f,g){var h=this,i=h.kj;a&&i&&h.US(b,c,d,e,f,g,a.ZA)},a.prototype.toJSON=function(){var a,b=this.Ub,c=[];for(a=0;b&&a<b.length;a++)c.push(b[a].toJSON());return 0===c.length?A:c},a.prototype.bdK=function(){var a,b,c,d=this.Ub,e={n_:"sparklineGroups",c_:[],r_:[2]};for(a=0;d&&a<d.length;a++)b=d[a],c=b.bdK(),e.c_.push(c);return e},a.prototype.fromJSON=function(a,b){var c,d,e;for(this.Ub.length=0,this.xn={},c=0;a&&c<a.length;c++)d=a[c],e=new S,e.fromJSON(d,b),this.add(e)},a.prototype.cdK=function(a,b){var c,d,e;for(this.Ub.length=0,this.xn={},c=0;a&&c<a.length;c++)d=a[c],e=new S,e.cdK(d,b),this.add(e)},a}();function W(a,b){return a+"_"+b}function X(a,b,c){return c?a>c.row+c.rowCount-1?c:a>c.row?r(c.row,c.col,c.rowCount+b,c.colCount):r(c.row+b,c.col,c.rowCount,c.colCount):z}function Y(a,b,c){return c?a>c.col+c.colCount-1?c:a>c.col?r(c.row,c.col,c.rowCount,c.colCount+b):r(c.row,c.col+b,c.rowCount,c.colCount):z}function Z(a,b,c,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,t,u,v=new d.KTa;for(g=0;g<a.length;g++){if(h=a[g],i=h.PS,h.displayDateAxis){if(s(h.dateAxisData())&&h.dateAxisData(h.T$J),j=void 0,k=h.dateAxisData(),k instanceof d.Range)j=_(b,c,e,k);else for(l=0;l<k.length;l++)j.push.apply(j,_(b,c,e,k[l]));h.dateAxisData(j)}for(l=0;l<i.length;l++)m=i[l],n=e?m.row:m.column,b<=n&&(v.set(g,l,m),f.JUa(m.row,m.column,z),e?m.row+=c:m.column+=c),s(m.data())&&m.data(m.a$J),o=void 0,p=m.data(),p instanceof d.Range?(o=_(b,c,e,p),m.data(o)):m.data(m.a$J)}for(q=0;q<a.length;q++)for(r=a[q],t=r.PS,u=0;u<t.length;u++)f.SUa(v.get(q,u))}function $(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,t,u,v;for(h=0;h<e.length;h++)if(i=e[h],i.displayDateAxis){if(j=i.OW(),k=j.ITa,l=!1,g&&!k.zTa&&(k.zTa=[],l=!0),s(i.dateAxisData())&&i.dateAxisData(i.T$J),m=void 0,n=i.dateAxisData(),n instanceof d.Range)m=_(a,b,c,n);else for(o=0;o<n.length;o++)m.push.apply(m,_(a,b,c,n[o]));i.dateAxisData(m),l&&(g.push({sheetName:j.name(),changes:k.zTa}),k.zTa=A)}for(o=0;o<f.length;o++)p=f[o],q=p.bT(),r=q.ITa,t=!1,g&&!r.zTa&&(r.zTa=[],t=!0),s(p.data())&&p.data(p.a$J),u=void 0,v=p.data(),v instanceof d.Range?(u=_(a,b,c,v),p.data(u)):p.data(p.a$J),t&&(g.push({sheetName:q.name(),changes:r.zTa}),r.zTa=A)}function _(a,b,c,d){var e;return e=c?X(a,b,d):Y(a,b,d)}function aa(a,b,c){var d=ca(c.col,c.col+c.colCount-1,a,a+b-1);return d?r(c.row,d.start,c.rowCount,d.end-d.start+1):z}function ba(a,b,c){var d=ca(c.row,c.row+c.rowCount-1,a,a+b-1);return d?r(d.start,c.col,d.end-d.start+1,c.colCount):z}function ca(a,b,c,d){var e,f,g,h,i,j,k=-1;if(d<a)return g=d-c+1,k=a-g,e=b-g,{start:k,end:e};if(c>b)return k=a,e=b,{start:k,end:e};if(c<=a){for(h=b-a+1,i=0,f=a;f<=d&&f<=b;f++)i++;return k=c,e=k+h-i-1,{start:k,end:e}}for(j=0,f=a;f<=b;f++)k===-1&&(f<c||f>d)&&(k=f),(f<c||f>d)&&j++;return k!==-1&&j>0?(e=k+j-1,{start:k,end:e}):z}function da(a,b,c,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,t,u,w=new d.KTa,x=a.length,y=0;for(g=x-1;g>-1;g--){if(h=a[g],h.displayDateAxis){if(s(h.dateAxisData())&&h.dateAxisData(h.T$J),i=void 0,j=h.dateAxisData(),j instanceof d.Range)i=ea(b,c,e,j);else for(k=0;k<j.length;k++)i.push.apply(i,ea(b,c,e,j[k]));if(s(i)){h.clear(),f.remove(h);continue}h.dateAxisData(i)}for(l=[],l=l.concat(h.PS),m=v(l),y=B(m,y),k=m-1;k>-1;k--)n=l[k],o=e?n.row:n.column,o>=b&&o<b+c&&s(n.a$J)?(h.remove(n),f.JUa(n.row,n.column,z)):(b<=o&&(f.JUa(n.row,n.column,z),e?n.row-=c:n.column-=c,w.set(g,k,n)),s(n.data())&&n.data(n.a$J),p=void 0,q=n.data(),q instanceof d.Range?p=ea(b,c,e,q):(n.data(n.a$J),p=n.data()),s(p)?h.remove(n):n.data(p));h.count()<=0&&f.remove(h)}for(t=0;t<x;t++)for(u=0;u<y;u++)r=w.get(t,u),r&&f.SUa(r)}function ea(a,b,c,d){var e;return e=c?ba(a,b,d):aa(a,b,d)}function fa(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y=e.length;for(h=y-1;h>-1;h--)if(i=e[h],i.displayDateAxis){if(j=i.OW(),k=j.ITa,l=!1,g&&!k.zTa&&(k.zTa=[],l=!0),s(i.dateAxisData())&&i.dateAxisData(i.T$J),m=void 0,n=i.dateAxisData(),n instanceof d.Range)m=ea(a,b,c,n);else for(o=0;o<n.length;o++)m.push.apply(m,ea(a,b,c,n[o]));s(m)?(i.clear(),i.ZA.remove(i)):i.dateAxisData(m),l&&(g.push({sheetName:j.name(),changes:k.zTa}),k.zTa=A)}for(p=f.length,o=p-1;o>-1;o--)q=f[o],r=q.bT(),t=r.ITa,u=!1,g&&!t.zTa&&(t.zTa=[],u=!0),s(q.data())&&q.data(q.a$J),v=void 0,w=q.data(),w instanceof d.Range?v=ea(a,b,c,w):(q.data(q.a$J),v=q.data()),s(v)?(x=q.group(),x.remove(q),x.count()<=0&&x.ZA.remove(x)):q.data(v),u&&(g.push({sheetName:r.name(),changes:t.zTa}),t.zTa=A)}!function(a){a[a.gaps=0]="gaps",a[a.zero=1]="zero",a[a.connect=2]="connect"}(K=b.EmptyValueStyle||(b.EmptyValueStyle={})),function(a){a[a.individual=0]="individual",a[a.group=1]="group",a[a.custom=2]="custom"}(L=b.SparklineAxisMinMax||(b.SparklineAxisMinMax={})),M=e.Common.pc.bc(255,149,179,215),N=e.Common.pc.bc(255,36,64,98),O={axisColor:"black",firstMarkerColor:M,highMarkerColor:"Blue",lastMarkerColor:M,lowMarkerColor:"Blue",markersColor:N,negativeColor:"Brown",seriesColor:N,displayEmptyCellsAs:0,rightToLeft:!1,displayHidden:!1,displayXAxis:!1,showFirst:!1,showHigh:!1,showLast:!1,showLow:!1,showNegative:!1,showMarkers:!1,manualMax:0,manualMin:0,maxAxisType:0,minAxisType:0,lineWeight:1},P=function(){function a(a){var b,c=this;c.options={};for(b in O)O.hasOwnProperty(b)&&(c.options[b]=a&&a[b]?a[b]:O[b]);c.WS=z}return a.prototype.clone=function(){return new a(this.options)},a.prototype.toJSON=function(){var a,b=this,c=b.options,d={};for(a in c)O[a]!==c[a]&&(d[a]=c[a]);return q(d)?A:d},a}(),b.SparklineSetting=P,function(a){a[a.line=0]="line",a[a.column=1]="column",a[a.winloss=2]="winloss"}(Q=b.SparklineType||(b.SparklineType={})),function(a){a[a.vertical=0]="vertical",a[a.horizontal=1]="horizontal"}(R=b.DataOrientation||(b.DataOrientation={})),S=function(){function a(a,b){var c=this;c.displayDateAxis=!1,c.ZA=z,c.PS=[],c.XS=z,c.YS=1,c.T$J=z,c.setting=b,c.sparklineType=a}return a.prototype.OW=function(){var a=this,b;return a.ZA&&(b=a.ZA.kj),b},a.prototype.TUa=function(){var a,b=this,c=b.OW();c&&c.ITa.zTa&&(a={group:b,innerList:b.PS.concat()},c.ITa.FUa(10,a))},a.prototype.add=function(a){var b,c=this;a&&(c.TUa(),c.PS.push(a),a.group(c),c.QS(),b=c.ZA,b&&b.tZa(a),c.onGroupChanged())},a.prototype.clear=function(){this.TUa();var a=this.ZA;a&&this.PS.forEach(function(b){a.vZa(b)}),this.PS=[]},a.prototype.all=function(){return this.PS},a.prototype.remove=function(a){var b,c=this,d=c.PS;return c.TUa(),u(d,a),a.onSparklineChanged(),a.cb=c.clone(),c.QS(),b=c.ZA,b&&b.vZa(a),c.onGroupChanged(),d},a.prototype.contains=function(a){return w(this.PS,a)},a.prototype.onGroupChanged=function(){var a,b,c=this.PS;if(c)for(a=0;a<c.length;a++)b=c[a],b&&b.onSparklineChanged()},a.prototype.clone=function(){var b=this,c=b.setting?b.setting.clone():z,d=new a(b.sparklineType,c);return d.displayDateAxis=b.displayDateAxis,d.T$J=b.T$J,d.XS=b.XS,d.nZa=b.nZa,d.YS=b.YS,d},a.prototype.dateAxisData=function(a){var b,c,d,e,f,h,i,j,k,l,m=this;if(s(m.T$J)||m.U$J(),0===arguments.length)return m.XS;if(b=m.OW(),b&&b.ITa.zTa){if("string"==typeof a){if(c=b.getCustomName(a)||b.parent.getCustomName(a),s(c))return m.XS;d=g.formulaToRanges(b,g.expressionToFormula(b,c.getExpression()),0,0,1===m.OW().parent.options.referenceStyle),m.T$J=a,e=ia(d),f=e.ranges,h=e.sheetName,a=f,m.nZa=h}i=void 0,j=void 0,i=m.XS?{row:m.XS.row,col:m.XS.col,rowCount:m.XS.rowCount,colCount:m.XS.colCount}:z,j=a?{row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount}:z,k={group:m,rangeInfo:i,newRangeInfo:j},b.ITa.FUa(8,k)}l=m.XS,m.XS=a,l!==a&&m.onGroupChanged()},a.prototype.U$J=function(){var a,b,c,d,e=this;s(e.OW())||(a=ha(e.OW(),e.T$J),s(a)||(b=ia(a),c=b.ranges,d=b.sheetName,e.XS=c,e.nZa=d))},a.prototype.dateAxisDataSheetName=function(a){var b,c,d,e=this;return 0===arguments.length?e.nZa:(b=e.nZa,c=e.OW(),c&&c.ITa.zTa&&(d={group:e,dateAxisDataSheetName:b,newDateAxisDataSheetName:a},c.ITa.FUa(16,d)),b!==a&&(b&&c&&c.ZA.uZa(e),e.nZa=a,a&&c&&c.ZA.sZa(e),e.onGroupChanged()),e)},a.prototype.dateAxisOrientation=function(a){var b,c,d,e=this;return 0===arguments.length?e.YS:(b=e.OW(),b&&b.ITa.zTa&&(c={group:e,dateAxisOrientation:e.YS,newDateAxisOrientation:a},b.ITa.FUa(9,c)),d=e.YS,e.YS=a,void(d!==a&&e.onGroupChanged()))},a.prototype.count=function(){return this.PS.length},a.prototype.QS=function(){var a,b,c,d,e,f,g,h,i=this,j=i.setting,k=i.PS;if(j&&(a=j.options,a.groupMaxValue=-C,a.groupMinValue=C,b=1===a.maxAxisType,c=1===a.minAxisType,b||c))for(d=0;d<k.length;d++)e=k[d],f=i.ZS(e),g=f.min,h=f.max,b&&a.groupMaxValue<h&&(a.groupMaxValue=h),c&&a.groupMinValue>g&&(a.groupMinValue=g)},a.prototype.ZS=function(a){var b,c,d,e,f,g,h,i=-C,j=C;if(s(a.data())&&a.data(a.a$J),b=a.data())for(c=a.bT(),d=c&&c.parent.getSheetFromName(a.dataSheetName()),e=a.$S(b,a.dataOrientation(),!1,d||c),f=0;f<e.length;f++)g=e[f],g===x&&(g=0),"number"==typeof g&&(h=g,i=i<h?h:i,j=j>h?h:j);return{min:j,max:i}},a.prototype.toJSON=function(){var a,b,c,d=this,e={setting:d.setting?d.setting.toJSON():z,displayDateAxis:d.displayDateAxis,sparklineType:d.sparklineType,axisOrientation:d.YS,sparklines:d.PS.map(function(a){return a.toJSON()})},f=d.XS,g=d.T$J;g?e.axisReference=g:f&&(e.axisReference={row:f.row,col:f.col,rowCount:f.rowCount,colCount:f.colCount,sheetName:d.nZa}),a={};for(b in e)e.hasOwnProperty(b)&&(c=e[b],ga(b,c)||(a[b]=c));return q(a)?A:a},a.prototype.bdK=function(){var a,b,c,e={n_:"sparklineGroup"},f=this,g=f.OW();return s(f.sparklineType)||(e.type=E[f.sparklineType]),f.displayDateAxis&&(e.dateAxis="1"),a=f.setting.options,!s(a.lineWeight)&&3*(""+a.lineWeight)/4-.75>.001&&(e.lineWeight=3*(""+a.lineWeight)/4),a.displayEmptyCellsAs?e.displayEmptyCellsAs=F[a.displayEmptyCellsAs]:e.displayEmptyCellsAs=F[0],a.showMarkers&&(e.markers="1"),a.showHigh&&(e.high="1"),a.showLow&&(e.low="1"),a.showFirst&&(e.first="1"),a.showLast&&(e.last="1"),a.showNegative&&(e.negative="1"),a.displayXAxis&&(e.displayXAxis="1"),a.displayHidden&&(e.displayHidden="1"),a.rightToLeft&&(e.rightToLeft="1"),a.minAxisType&&(e.minAxisType=G[a.minAxisType]),a.maxAxisType&&(e.maxAxisType=G[a.maxAxisType]),a.manualMin&&(e.manualMin=a.manualMin),a.manualMax&&(e.manualMax=a.manualMax),e.c_=[o(a.seriesColor||"rgba(36,64,98,1.0)",!1,"colorSeries"),o(a.negativeColor||"brown",!1,"colorNegative"),o(a.axisColor||"black",!1,"colorAxis"),o(a.markersColor||"rgba(36,64,98,1.0)",!1,"colorMarkers"),o(a.firstMarkerColor||"rgba(149,179,215,1.0)",!1,"colorFirst"),o(a.lastMarkerColor||"rgba(149,179,215,1.0)",!1,"colorLast"),o(a.highMarkerColor||"blue",!1,"colorHigh"),o(a.lowMarkerColor||"blue",!1,"colorLow")],b=f.XS,b&&e.c_.push({n_:"f",c_:[(f.nZa?d.IndexHelper.Wfa(f.nZa):g.name())+"!"+p([r(b.row,b.col,b.rowCount,b.colCount)])]}),c={n_:"sparklines",c_:f.PS.map(function(a){return a.bdK()})},e.c_.push(c),e},a.prototype.fromJSON=function(a,b){var c,d,e,f,g,h,i,j,k;if(a&&(c=this,d=a.displayDateAxis,e=a.sparklineType,f=a.axisReference,g=a.axisOrientation,h=a.sparklines,c.setting=new P(a.setting),s(d)||(c.displayDateAxis=d),s(e)||(c.sparklineType=e),s(f)||("string"==typeof f?c.T$J=f:(c.XS=r(f.row,f.col,f.rowCount,f.colCount),c.nZa=f.sheetName)),s(g)||(c.YS=g),h))for(c.PS=[],i=0,j=h.length;i<j;i++)k=new T,k.fromJSON(h[i]),c.add(k)},a.prototype.cdK=function(a,b){var c,d,e,f,g,h,j,l,m=this,n=m.FeK(a);m.setting=new P(n),c="1"===a.dateAxis,d=E[a.type]||0,s(c)||(m.displayDateAxis=c),s(d)||(m.sparklineType=d),e=i(a,"f"),e&&(f=e.c_&&e.c_[0],g=f&&f.split("!"),g&&(h=k(g[1])[0]||z,s(h)||(m.XS=r(h.row,h.col,h.rowCount,h.colCount)),
j=1===h.rowCount?1:0,s(j)||(m.YS=j))),l=i(a,"sparklines"),l&&(m.PS=[],l.c_.forEach(function(a){var c=new T;c.cdK(a,b),m.add(c)}))},a.prototype.FeK=function(a){var b={};return s(a.manualMax)||(b.manualMax=l(a.manualMax,0)),s(a.manualMin)||(b.manualMin=l(a.manualMin,0)),s(a.lineWeight)||(b.lineWeight=4*l(a.lineWeight,1)/3),s(a.displayEmptyCellsAs)||(b.displayEmptyCellsAs=F[a.displayEmptyCellsAs]||0),s(a.markers)||(b.showMarkers=m(a.markers,!1)),s(a.high)||(b.showHigh=m(a.high,!1)),s(a.low)||(b.showLow=m(a.low,!1)),s(a.first)||(b.showFirst=m(a.first,!1)),s(a.last)||(b.showLast=m(a.last,!1)),s(a.negative)||(b.showNegative=m(a.negative,!1)),s(a.displayXAxis)||(b.displayXAxis=m(a.displayXAxis,!1)),s(a.displayHidden)||(b.displayHidden=m(a.displayHidden,!1)),s(a.rightToLeft)||(b.rightToLeft=m(a.rightToLeft,!1)),s(a.minAxisType)||(b.minAxisType=G[a.minAxisType]||0),s(a.maxAxisType)||(b.maxAxisType=G[a.maxAxisType]||0),a.c_.forEach(function(a){"colorSeries"===a.n_&&(b.seriesColor=n(a)||"rgba(36,64,98,255)"),"colorNegative"===a.n_&&(b.negativeColor=n(a)||"Brown"),"colorAxis"===a.n_&&(b.axisColor=n(a)||"Black"),"colorMarkers"===a.n_&&(b.markersColor=n(a)||"rgba(36,64,98,255)"),"colorFirst"===a.n_&&(b.firstMarkerColor=n(a)||"rgba(149,179,215,255)"),"colorLast"===a.n_&&(b.lastMarkerColor=n(a)||"rgba(149,179,215,255)"),"colorHigh"===a.n_&&(b.highMarkerColor=n(a)||"Blue"),"colorLow"===a.n_&&(b.lowMarkerColor=n(a)||"Blue")}),b},a}();function ga(a,b){var c=!1;return"setting"===a||"axisReference"===a?c=b===z:"displayDateAxis"===a?c=b===!1:"axisOrientation"===a?c=1===b:"sparklines"===a&&(c=0===b.length),c}T=function(){function a(a,b,c,d,e,f,g){var h=this;h.row=a,h.column=b,h._S=d,h._data=c,h.cb=new S(e,f),h.cb.add(h),h.a$J=g}return a.prototype.group=function(a){var b,c,d,e,f=this;return 0===arguments.length?(b=f.cb,b||(b=new S,b.add(f),f.cb=b),b):(c=f.cb,d=f.bT(),d&&d.ITa.zTa&&(e={row:f.row,col:f.column,group:c,newGroup:a},d.ITa.FUa(11,e)),a!==c&&(c&&c.remove(f),f.cb=a,a&&!a.contains(f)&&a.add(f),f.onSparklineChanged()),d&&d.$p(),f)},a.prototype.sparklineType=function(a){var b,c,d,e,f=this;return 0===arguments.length?f.group().sparklineType:(b=f.group(),c=b.sparklineType,c!==a&&(b.sparklineType=a,d=f.bT(),d&&d.ITa.zTa&&(e={row:f.row,col:f.column,sparklineType:c,newSparklineType:a},d.ITa.FUa(3,e)),f.onSparklineChanged(),d&&d.$p()),f)},a.prototype.onSparklineChanged=function(){var a=this,b=a.bT();b&&b.Wq(d.Events.SparklineChanged,{sheet:b,sheetName:b.name(),sparkline:a})},a.prototype.setting=function(a){var b,c,e=this,f=e.group(),g=e.bT(),h=g&&g.ITa.zTa;return 0===arguments.length?(b=void 0,b=h?d.GC$.extend(!0,{},f.setting):f.setting):(h&&(c={row:e.row,col:e.column,setting:d.GC$.extend(!0,{},f.setting),newSetting:d.GC$.extend(!0,{},a)},g.ITa.FUa(4,c)),f.setting=a,g&&g.$p(),e)},a.prototype.data=function(a){var b,c,e,f,h,i,j,k=this;if(s(k.a$J)||k.V$J(),b=k.bT(),0===arguments.length)return s(k.a$J)?k._data:s(b)?[]:(c=b.getCustomName(k.a$J)||b.parent.getCustomName(k.a$J),s(c)?[]:(e=g.formulaToRanges(b,g.expressionToFormula(b,c.getExpression()),k.row,k.column,1===b.parent.options.referenceStyle),e[0]&&k._data!==e[0].ranges&&(k._data=e[0].ranges,k.onSparklineChanged()),k._data));if("string"==typeof a){if(k.a$J=a,!b)return k;if(c=b.getCustomName(a)||b.parent.getCustomName(a),e=void 0,s(c))return k;e=g.formulaToRanges(b,g.expressionToFormula(b,c.getExpression()),k.row,k.column,1===b.parent.options.referenceStyle),f=ia(e),h=f.ranges,i=f.sheetName,a=h,k.oZa=i}return b&&b.ITa.zTa&&(j={row:k.row,col:k.column,sparkline:k,data:d.GC$.extend(!0,{},k._data),newData:d.GC$.extend(!0,{},a)},b.ITa.FUa(5,j)),k._data!==a&&(k._data=a,k.onSparklineChanged()),b&&b.$p(),k},a.prototype.dataSheetName=function(a){var b,c,d,e=this;return 0===arguments.length?e.oZa:(b=e.oZa,c=e.bT(),c&&c.ITa.zTa&&(d={row:e.row,col:e.column,dataSheetName:b,newDataSheetName:a},c.ITa.FUa(15,d)),b!==a&&(b&&c&&c.ZA.vZa(e),e.oZa=a,a&&c&&c.ZA.tZa(e),e.onSparklineChanged()),e)},a.prototype.dataOrientation=function(a){var b,c,d=this;return 0===arguments.length?d._S:(b=d.bT(),b&&b.ITa.zTa&&(c={row:d.row,col:d.column,dataOrientation:d._S,newDataOrientation:a},b.ITa.FUa(6,c)),d._S!==a&&(d._S=a,d.onSparklineChanged()),b&&b.$p(),d)},a.prototype.dateAxisData=function(a){var b=this,c=b.group();return 0===arguments.length?(s(c.dateAxisData())&&c.dateAxisData(c.T$J),c.dateAxisData()):(c.dateAxisData(a),b)},a.prototype.dateAxisDataSheetName=function(a){var b=this,c=b.group();return 0===arguments.length?c.dateAxisDataSheetName():(c.dateAxisDataSheetName(a),b)},a.prototype.dateAxisOrientation=function(a){var b=this,c=b.group();return 0===arguments.length?c.dateAxisOrientation():(c.dateAxisOrientation(a),b)},a.prototype.displayDateAxis=function(a){var b,c,d=this,e=d.group();return 0===arguments.length?e.displayDateAxis:(b=d.bT(),b&&b.ITa.zTa&&(c={row:d.row,col:d.column,displayDateAxis:e.displayDateAxis,newDisplayDateAxis:a},b.ITa.FUa(7,c)),e.displayDateAxis=a,d)},a.prototype.clone=function(){var b=this,c=new a;return c.row=b.row,c.column=b.column,s(b.a$J)?c.data(b.data()):c.a$J=b.a$J,c.dataSheetName(b.dataSheetName()),c.dataOrientation(b.dataOrientation()),c.group(b.group().clone()),c},a.prototype.paintSparkline=function(a,b,c,e,f){var g,h,i,j,k,l=this,m=l.bT();this.vKb&&(m=this.vKb),s(l.data())&&l.data(l.a$J),s(l.dateAxisData())&&l.dateAxisData(l.group().T$J),i=l.W$J(!0),j=l.W$J(!1),k={sparklineType:l.sparklineType(),displayDateAxis:l.displayDateAxis(),zoomFactor:m.zoom(),values:i,dateValues:j,settings:l.setting(),getColor:function(a){if(m&&a){var b=d.Rm.Om(m,a);if(b)return b}return a}},(new y).paint(a,k,b,c,e,f)},a.prototype.W$J=function(a){var b,c,d,e,f,g=this,h=[],i=a?g.dataSheetName():g.dateAxisDataSheetName(),j=a?g.rKb:g.tKb,k=a?g.dataOrientation():g.dateAxisOrientation(),l=a?g.data():g.dateAxisData(),m=g.bT();if(this.vKb&&(m=this.vKb),j)h=j;else if("string"==typeof i)c=g.X$J(m,i),h=g.$S(l,k,!a,c||m);else if("object"==typeof i)for(d=i,e=0;e<d.length;e++)c=g.X$J(m,d[e]),f=g.$S(l[e],k,!a,c||m),h=h.concat(f);else s(i)&&(h=g.$S(l,k,!a,m));return h},a.prototype.X$J=function(a,b){var c,d,e=/^\[\d+\].+/g;return c=a.parent.getSheetFromName(b),d=a.parent.G$J,e.test(b)&&d&&(c=d.parseSource(b,!0)),c},a.prototype.sKb=function(a){var b=this;return s(b.data())&&b.data(b.a$J),b.$S(b.data(),b.dataOrientation(),!1,a)},a.prototype.uKb=function(a){var b=this;return s(b.dateAxisData())&&b.dateAxisData(b.group().T$J),b.$S(b.dateAxisData(),b.dateAxisOrientation(),!0,a)},a.prototype.$S=function(b,c,d,e){var f=this,g=f.setting().options.displayHidden;return a.cT(A,e,g,b,c,d)},a.prototype.bT=function(){var a=this.group(),b=a&&a.ZA;return b?b.kj:z},a.prototype.toJSON=function(){var a,b=this;return s(b.a$J)?(b._data=b._data,a={row:b._data.row,rowCount:b._data.rowCount,col:b._data.col,colCount:b._data.colCount,sheetName:b.oZa}):a=b.a$J,{row:b.row,col:b.column,orientation:b._S,data:a}},a.prototype.bdK=function(){var a,b=this,c=b.bT(),e=b._data;return a=s(b.a$J)?(b.oZa?d.IndexHelper.Wfa(b.oZa):c.name())+"!"+p([r(e.row,e.col,e.rowCount,e.colCount)]):b.a$J,{n_:"sparkline",c_:[{n_:"f",c_:[a]},{n_:"sqref",c_:[p([r(b.row,b.column,1,1)])]}],lossless:{_S:b._S}}},a.prototype.fromJSON=function(a){var b,c,d,e,f,g;a&&(b=this,c=a.row,d=a.col,e=a.orientation,f=a.data,s(c)||(b.row=c),s(d)||(b.column=d),s(e)||(b._S=e),f&&("string"==typeof f?b.a$J=f:(g=f,b._data=r(g.row,g.col,g.rowCount,g.colCount),b.oZa=g.sheetName)))},a.prototype.cdK=function(a,b){var c,e,f,g=this,h=d.Util.KlK(b)?void 0:1;a.c_.forEach(function(a){"f"===a.n_&&(f=a.c_[0].split("!"),1===f.length?g.a$J=f[0]:c=k(f[1])[0]||z),"sqref"===a.n_&&(e=k(a.c_[0])[0]||z)}),s(e)||(s(e.row)||(g.row=e.row),s(e.col)||(g.column=e.col),c&&(h=1===c.rowCount?1:0,g._data=r(c.row,c.col,c.rowCount,c.colCount),g.oZa=f[0])),s(h)||(g._S=h),a.lossless&&(g._S=a.lossless._S)},a.prototype.V$J=function(){var a,b,c,d,e=this;s(e.bT())||(a=ha(e.bT(),e.a$J),s(a)||(b=ia(a),c=b.ranges,d=b.sheetName,e._data=c,e.oZa=d))},a.cT=function(b,c,d,e,f,g){var h,i=[];if(s(e))return i;if(!(e instanceof Array))return a.Y$J(b,c,d,e,f,g);for(e=e,h=0;h<e.length;h++)i.push.apply(i,a.Y$J(b,c,d,e[h],f,g,!0));return i},a.Y$J=function(b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p=[],q=1===f;if(c&&e)for(i=0,j=h?q?e.rowCount:e.colCount:1;i<j;i++)for(k=0,l=q?e.colCount:e.rowCount;k<l;k++)m=q?i:k,n=q?k:i,o=b?b[m][n]:c.getValue(e.row+m,e.col+n),o=a.Z$J(c,o,e,m,n,d,g),p.push(o);return p},a.Z$J=function(a,b,c,d,g,h,i){var j="number";return b instanceof f.CalcError?A:(!h&&a.getRowHeight&&(a.getRowHeight(c.row+d)<=0||a.getColumnWidth(c.col+g)<=0)?b=NaN:s(b)||(i?b=typeof b===j?e.Common.l.Xb(b):Date.parse(b):typeof b!==j&&(b=x)),b)},a}(),b.Sparkline=T;function ha(a,b){var c=a.parent,d=a.getCustomName(b)||c.getCustomName(b);if(!s(d))return g.formulaToRanges(a,g.expressionToFormula(a,d.getExpression()),0,0,1===c.options.referenceStyle)}function ia(a){var b=[],c=[];return a.forEach(function(a){b=b.concat(a.ranges);for(var d=0;d<a.ranges.length;d++)c.push(a.sheetName)}),{ranges:b,sheetName:c}}},"./dist/plugins/statusBar/baseStatusBar.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/statusBar/statusItem.js"),f=d.GC$,g="statusItem",h=null,i="left",j="right",k=function(){function a(a){this.yzb=[],this.zzb=[],this.Azb=[],this.mi=0,this.qo=h,this.ET=a,this.Bzb()}return a.prototype.Bzb=function(){var a=this.qo,b=this.Czb;a||(a=this.qo=document.createElement("div"),b=this.Czb=document.createElement("div")),this.ET.appendChild(a),this.ET.appendChild(b)},a.prototype.Dzb=function(a){a.name||(a.name=g+this.mi,this.mi++)},a.prototype.mL=function(a,b){return a instanceof e.StatusItem&&!this.Jp(a.name)&&(this.Dzb(a),b>=0&&b<this.yzb.length?this.yzb.splice(b,0,a):this.yzb.push(a),a.align=a.align||i,a.Ezb(this.ET),!0)},a.prototype.Fzb=function(a,b){var c,d,e,f,g,i=!1,k=this.yzb,l=b>=0&&b<k.length,m=h,n=h;if(l&&(m=k[b],n=m.Gzb()),this.mL(a,b)){c=a.align===j;try{c?(d=this.Azb,e=d.indexOf(m),f=d.length,g=f-1,n&&e>=0&&e<g?n=d[e+1].Gzb():n===h?n=d[0].Gzb():(n&&e<0||e===g)&&(n=h),this.Azb.push(a)):this.zzb.push(a),this.qo.insertBefore(a.Gzb(),n),this.xc&&a.onBind(this.xc),i=!0}catch(b){c?this.Azb.splice(this.Azb.indexOf(a),1):this.zzb.splice(this.zzb.indexOf(a),1),this.yzb.splice(this.yzb.indexOf(a),1)}}return i},a.prototype.Hzb=function(a){var b=this.yzb,c=!1,d,e;for(d=0;d<b.length;d++)if(e=b[d],a===e.name){c=!0;break}return!!c&&(e.onUnbind(),e.align===j?this.Azb.splice(this.Azb.indexOf(e),1):this.zzb.splice(this.zzb.indexOf(e),1),this.yzb.splice(d,1),this.qo.removeChild(e.Gzb()),!0)},a.prototype.Jp=function(a){var b=this.yzb,c,d;for(c=0;c<b.length;c++)if(d=b[c],a===d.name)return d;return h},a.prototype.Izb=function(a){this.xc=a,this.yzb.forEach(function(b){b.onBind(a),b.onUpdate()})},a.prototype.nmK=function(){this.yzb.forEach(function(a){a.omK()})},a.prototype.hZ=function(){this.zzb=[],this.Azb=[],f(this.qo).empty()},a.prototype.Jzb=function(){var a=this,b=this.qo,c=i,d;this.hZ(),this.yzb.forEach(function(e){c=e.align,d=e.Gzb(),d.style.float=c,c===j?a.Azb.unshift(e):(a.zzb.unshift(e),b.appendChild(d))}),this.Azb.forEach(function(a){b.appendChild(a.Gzb())})},a.prototype.Kzb=function(){this.yzb.forEach(function(a){a.onUpdate()}),this.Jzb()},a.prototype.Lzb=function(){var a=[];return this.yzb.forEach(function(b){a.push(b.Mzb())}),a},a.prototype.Nzb=function(a){var b=this.yzb,c=a.name,d,e;for(d=0;d<b.length;d++)if(e=b[d],e.name===c){e.Nzb(a);break}},a.prototype.Ozb=function(){return this.yzb},a.prototype.Pzb=function(){var a=this,b=a.yzb,c,d;for(this.xc=h,c=0;c<b.length;c++)d=b[c],d.onUnbind()},a.prototype.no=function(){var a=this,b=a.yzb,c,d;if(this.qo){for(c=0;c<b.length;c++)d=b[c],a.qo.removeChild(d.Qzb),d.onDispose();this.qo.parentElement&&this.qo.parentElement.removeChild(this.qo),this.Czb.parentElement&&this.Czb.parentElement.removeChild(this.Czb),this.qo=h,this.Czb=h}this.mi=h,this.yzb=h,this.zzb=h,this.Azb=h},a}(),b.BaseStatusBar=k},"./dist/plugins/statusBar/statusBar.entry.js":function(a,b,c){"use strict";var d,e,f;function g(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/statusBar/statusBar.js"),b.StatusBar=e.StatusBar,f=c("./dist/plugins/statusBar/statusItem.js"),b.StatusItem=f.StatusItem,g(c("./dist/plugins/statusBar/statusBar.ns.js")),b.findControl=function(a){return"string"==typeof a&&(a=document.getElementById(a)),d.GC$(a).data("statusbar")}},"./dist/plugins/statusBar/statusBar.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("@grapecity/js-calc"),g=c("SheetsCalc"),h=c("ContextMenu"),i=c("./dist/plugins/statusBar/statusBar.ns.js"),j=c("./dist/plugins/statusBar/statusItem.js"),k=c("./dist/plugins/statusBar/baseStatusBar.js"),l=d.GC$,m=d.Ul,n=m.Nl,o=m.nl,p=e.Common.j,q=e.Common.u.Kb,r=p.Fa,s=d.Commands.ActionBase,t=f.Convert.vf,u=null,v=l.inherit,w="gc-statusbar-",x="slider-",y=w+x+"btn",z=w+x+"add-btn",A=w+x+"back-progress",B=w+x+"back",C=w+x+"middle-line",D=w+x+"drag-bar",E=w+"zoom-panel",F=w+x+"btn-container",G=w+x+"add-btn-container",H="gc-statusbar",I=w+"menu-host",J="gc.spread.",K="100",L="%",M="px",N="cellMode",O="average",P="count",Q="numericalCount",R="min",S="max",T="sum",U="zoomSlider",V="zoomPanel",W="div",X="span",Y="none",Z="inline",$="inline-block",_=15,aa=25,ba=400,ca=100,da=100,ea=10,fa=1,ga=4,ha=120,ia=.7,ja=8,ka=10,la=w+"progress-item-item-container",ma=w+"progress-item-wrapper",na=w+"progress-item-bar",oa=w+"progress-item-status",pa=w+"progress-item-sheet-name",qa="progress",ra="right",sa="statusbarZoom",ta="statusBar",ua="click",va="mousedown",wa="mouseup",xa="mousemove",ya="contextmenu",za=".statusbar",Aa="invalidateLayout",Ba=101,Ca=103,Da=102,Ea=105,Fa=104,Ga=109,Ha="(",Ia=")",Ja="formatter",Ka="_autoFormatter",La="_SUBTOTALFORSTATUSBAR",Ma=[O,P,Q,R,S,T],Na=!!h,h&&(Oa=h.MenuView,Pa=h.Cyb),Qa=new e.Common.ResourceManager(i.SR,"StatusBar"),Ra=Qa.getResource.bind(Qa);function $a(a,b){var c=e.Common.CultureManager.q4().NumberFormat.listSeparator;return La+Ha+a+c+b+Ia}function _a(a,b){a.splice(b,1)}function ab(a,b){var c,d=b,e=b.length,f=[];if(e>1){for(f.push(b[0]),c=1;c<e;c++)f=bb(a,b[c],f);return f}return d}function bb(a,b,c){var d,e,f,g,h,i,j=a.getRowCount(3),k=a.getColumnCount(3),l=[],m=[];for(l.push(b),g=c.length,h=0;h<g;h++)for(d=c[h],i=0;i<l.length;)e=l[i],f=e.getIntersect(d,j,k),f?(m=a.v_a(e,f,j,k),_a(l,i),l=m.concat(l),i+=m.length):i++;return l.concat(c)}function cb(a){var b,c,d,e,f,g,h,i,j,k,l,m=a.getActiveRowIndex(),n=a.getActiveColumnIndex(),o=a.getValue(m,n);if("number"==typeof o)return{row:m,col:n};for(b=a.getSelections(),f=0,g=b;f<g.length;f++)for(h=g[f],h=a.Tq(h),i=0,j=h.rowCount;i<j;i++)for(k=0,l=h.colCount;k<l;k++)if(c=h.row+i,d=h.col+k,e=a.getValue(c,d),"number"==typeof e)return{row:c,col:d};return{row:m,col:n}}function db(a,b,c){var d=a.tq(b,c,Ja);return d||(d=a.tq(b,c,Ka)),d}function eb(a){var b=a;return a>0&&a<=4&&(b=Math.floor(+parseFloat((100*a).toPrecision(12)))),b}function fb(a,b,c){if(a&&a.parent&&a.parent.options.allowUserZoom){var e={sheet:a,sheetName:a.name(),newZoomFactor:b,oldZoomFactor:c,cancel:!1};if(a.Wq(d.Events.ViewZooming,e),e&&e.cancel===!0)return;b=e.newZoomFactor,b!==c&&(a.wu().execute({cmd:sa,sheetName:a.name(),newZoomFactor:b,oldZoomFactor:c}),ib(a,b,c))}}function gb(a){for(var b,c,d,e={top:a.offsetTop,left:a.offsetLeft},f=a.offsetParent;f;)e.top+=f.offsetTop,e.left+=f.offsetLeft,f=f.offsetParent;return b=document.body,c=b.clientTop,d=b.clientLeft,isNaN(c)||(e.top+=c),isNaN(d)||(e.left+=d),e}function hb(a){return""!==a}Sa=function(a){Za(b,a);function b(b,c){var d=a.call(this,b,c)||this;return d.Rzb=za+d.name,d}return b.prototype.onBind=function(a){var b=this,c;b.xc=a,a.bind(d.Events.EditorStatusChanged+b.Rzb,function(a,d){c=b.Szb(d.newStatus),b.Tzb(c)}),a.bind(d.Events.ActiveSheetChanged+b.Rzb,function(){b.onUpdate()})},b.prototype.onUpdate=function(){var b,c,e;a.prototype.onUpdate.call(this),b=d.UCJ(this.xc),b&&(c=b.editorStatus(),e=this.Szb(c),this.Tzb(e))},b.prototype.Szb=function(a){var b;switch(a){case 0:b=Ra().cellModeReady;break;case 1:b=Ra().cellModeEnter;break;case 2:b=Ra().cellModeEdit}return b},b.prototype.Tzb=function(a){if(a!==this.value){this.value=a,this.tipText=q(Ra().toolTipCellMode,[a]);var b=this.TJa;b&&(b.parentElement.title=this.tipText,r(this.value)||(b.innerText=this.value+""))}},b.prototype.onUnbind=function(){this.xc&&(this.xc.unbind(d.Events.EditorStatusChanged+this.Rzb),this.xc.unbind(d.Events.ActiveSheetChanged+this.Rzb),this.xc=u)},b}(j.StatusItem),Ta=function(a){Za(b,a);function b(b,c){var d=a.call(this,b,c)||this;return d.Uzb=": ",d.k$a=!1,d.Uk=c.prefix,d.Rzb=za+d.name,d.$Lb=Number.MAX_VALUE,d}return b.prototype.omK=function(){this.Ucc={}},b.prototype.onBind=function(a){var b=this;b.xc=a,b.omK(),a.bind(d.Events.SelectionChanging+b.Rzb,function(a,c){b.$G=c.newSelections,b.Vzb(c)}),a.bind(d.Events.SelectionChanged+b.Rzb,function(a,c){var d=b.$G||[],e=c.newSelections;JSON.stringify(d)!==JSON.stringify(e)&&b.Vzb(c),b.$G=u}),a.bind(d.Events.ValueChanged+b.Rzb,function(a,c){var d=c.sheet,e=c.row,f=c.col;d.vp(e,f)&&b.onUpdate()}),a.bind(d.Events.RangeChanged+b.Rzb,function(){b.onUpdate()}),a.bind(d.Events.DragFillBlockCompleted+b.Rzb,function(){b.onUpdate()}),a.bind(d.Events.ActiveSheetChanged+b.Rzb,function(){b.onUpdate()}),a.bind(d.Events.TopRowChanged+b.Rzb,function(){b.TaK(!0)}),a.bind(d.Events.ColumnWidthChanged+b.Rzb,function(){b.TaK(!0)}),a.bind(d.Events.RowHeightChanged+b.Rzb,function(){b.TaK(!0)}),a.bind(d.Events.RowChanged+b.Rzb,function(){b.TaK(!1)}),a.bind(d.Events.ColumnChanged+b.Rzb,function(){b.TaK(!1)}),a.bind(d.Events.RangeFiltered+b.Rzb,function(){b.TaK(!1)}),a.bind(d.Events.TableFiltered+b.Rzb,function(){b.TaK(!1)}),a.bind(d.Events.TableFilterCleared+b.Rzb,function(){b.TaK(!1)}),a.bind(d.Events.RangeFilterCleared+b.Rzb,function(){b.TaK(!1)})},b.prototype.TaK=function(a){this.k$a=a},b.prototype._Lb=function(a){var b=d.UCJ(this.xc),c=0;return a.forEach(function(a){var d=b.Tq(a);c+=d.rowCount*d.colCount}),c<this.$Lb},b.prototype.Vzb=function(a){var b,c,d=this,e=a.sheet,f=a.newSelections;d._Lb(f)?1===f.length&&1===f[0].rowCount&&1===f[0].colCount?(b=d.Wzb(e,u),d.Tzb(b[d.name])):(c=d.aMb(ab(e,f)),hb(c)?(b=d.Wzb(e,c),d.Tzb(b[d.name])):r(d.value)&&d.Xzb(!1)):d.Tzb(u)},b.prototype.Wzb=function(a,b){var c,d,e,f,h,i,j,k,l,m,n,o,p,q=this,s=g.evaluateFormula,v=0,w=u,x=u,y=u,z=u,A=u;return b&&(c=q.Ucc,d=c[b],!q.k$a||r(d)?(q.TaK(!1),v=s(a,$a(Ca,b)),v>1&&(w=s(a,$a(Da,b)),w>0&&(e=s(a,$a(Ba,b)),f=s(a,$a(Ea,b)),h=s(a,$a(Fa,b)),i=s(a,$a(Ga,b)),t(e)||t(f)||t(h)||t(i)||(j=cb(a),k=j.row,l=j.col,m=a.getCellType(k,l),n=db(a,k,l),o={},y=m.format(e,n,o),z=m.format(f,n,o),A=m.format(h,n,o),x=m.format(i,n,o)))),c[b]={average:y,numericalCount:w,minimum:z,maximum:A,sum:x,count:v}):(y=d.average,w=d.numericalCount,z=d.minimum,A=d.maximum,x=d.sum,v=d.count)),p={},p.average=y,p.numericalCount=w>0?w:u,p.min=z,p.max=A,p.sum=x,p.count=v>1?v:u,p},b.prototype.Xzb=function(a){this.Qzb&&(this.Qzb.style.display=a?$:Y)},b.prototype.Tzb=function(a){var b=this.Uzb,c=this.TJa,d=this.Uk,e=this.visible,f=!1;this.value=a,c.innerText=d+b+a,!r(a)&&e&&(f=!0),this.Xzb(f)},b.prototype.Av=function(a){if(a){var b=a.menuContent,c=a.tipText;this.menuContent=b,this.Uk=b,this.tipText=c,this.Qzb.title=c}},b.prototype.onUpdate=function(){var b,c,e,f,g,h;a.prototype.onUpdate.call(this),b=this,c=d.UCJ(b.xc),c?(e=c.getSelections(),b._Lb(e)?1===e.length&&1===e[0].rowCount&&1===e[0].colCount?(f=b.Wzb(c,u),b.Tzb(f[b.name])):(g=b.aMb(ab(c,e)),hb(g)?(f=b.Wzb(c,g),h=f[b.name],(r(h)||h!==b.value)&&(b.value=h,b.Tzb(h))):r(b.value)&&b.Xzb(!1)):b.Tzb(u)):b.Tzb(u)},b.prototype.onUnbind=function(){var a=this.xc,b=this.Rzb;a&&(a.unbind(d.Events.SelectionChanging+b),a.unbind(d.Events.SelectionChanged+b),a.unbind(d.Events.ValueChanged+b),a.unbind(d.Events.RangeChanged+b),a.unbind(d.Events.DragFillBlockCompleted+b),a.unbind(d.Events.ActiveSheetChanged+b),a.unbind(d.Events.TopRowChanged+b),a.unbind(d.Events.RowChanged+b),a.unbind(d.Events.ColumnChanged+b),a.unbind(d.Events.RangeFiltered+b),a.unbind(d.Events.TableFiltered+b),a.unbind(d.Events.TableFilterCleared+b),a.unbind(d.Events.RangeFilterCleared+b),this.xc=u)},b.prototype.aMb=function(a,b,c,d,e){var h,i=this.kh;return i||(i=this.kh=new f.Parser),h=this.Dh,h||(h=this.Dh=new g.SheetParserContext(u,(!!e),f.pf(b,c))),g.TLb(i,h,a,b,c,d,!0)},b.prototype.onDispose=function(){a.prototype.onDispose.call(this),this.kh=u,this.Ucc=u,this.Dh&&(this.Dh.no(),this.Dh=u)},b}(j.StatusItem),Ua=function(a){Za(b,a);function b(b,c,d){var e=a.call(this,c,d)||this;return e.min=aa,e.max=ba,e.middle=ca,e.step=ea,e.Yzb=fa,e.Zzb=ga,e.$zb=ha,e._zb=Math.round((e.$zb+e.Yzb)/2),e.aAb=Math.round((e.$zb+e.Zzb)/2),e.bAb=!1,e.cAb=b,e.Rzb=za+e.name,e}return b.prototype.onCreateItemView=function(a){var b,c,d,e,f,g,h,i,j=this,k=j._v,m=k+M;a.style.display=this.visible?Z:Y,b=this.dAb,b||(b=this.dAb=n(W)),l(b).addClass(F),b.style.height=m,b.style.lineHeight=m,c=this.eAb,c||(c=this.eAb=n(W)),c.title=Ra().toolTipZoomOut,l(c).addClass(y),c.style.height=m,c.addEventListener(ua,function(){j.fAb(!1)}),d=this.gAb,d||(d=this.gAb=n(W)),l(d).addClass(G),d.style.height=m,d.style.lineHeight=m,e=this.hAb,e||(e=this.hAb=n(W)),e.title=Ra().toolTipZoomIn,l(e).addClass(z),e.style.height=m,e.addEventListener(ua,function(){j.fAb(!0)}),f=this.iAb,f||(f=this.iAb=n(W)),l(f).addClass(A),f.style.marginTop=Math.floor(k/2+1)+M,f.addEventListener(ua,function(){return!1}),g=this.jAb,g||(g=this.jAb=n(W)),l(g).addClass(C),g.style.top=Math.floor((k-ja)/2+1)+M,g.style.left=j._zb+M,h=this.kAb,h||(h=this.kAb=n(W)),h.title=Ra().toolTipSlider,l(h).addClass(D),h.style.top=Math.floor((k-ka)/2+1)+M,h.style.right=j.aAb+M,h.addEventListener(va,function(){j.bAb=!0}),document.addEventListener(wa,function(){j.bAb=!1}),document.addEventListener(xa,function(a){if(j.bAb){var b=a.pageX,c=gb(f).left,d=f.offsetWidth,e=j.Zzb,g=c+d+e-b;j.lAb(g)}}),i=this.mAb,i||(i=this.mAb=n(W)),i.title=Ra().toolTipSlider,l(i).addClass(B),i.style.height=m,i.style.lineHeight=m,i.addEventListener(ua,function(a){var b,c,d,e=a.target;e!==h&&(e===g?b=j.aAb:(c=a.offsetX,d=i.offsetWidth,b=d-c),j.lAb(b))}),b.appendChild(c),a.appendChild(b),i.appendChild(g),i.appendChild(f),i.appendChild(h),a.appendChild(i),d.appendChild(e),a.appendChild(d)},b.prototype.M4=function(){this.xc&&this.xc.focus()},b.prototype.onBind=function(a){jb(this,a)},b.prototype.onUpdate=function(){kb(this)},b.prototype.fAb=function(a){var b,c=this,d=this.value;d%10===0?d=a?d+this.step:d-this.step:(b=d/10,d=a?Math.ceil(b):Math.floor(b),d=10*d),d=d>this.max?this.max:d,d=d<this.min?this.min:d,c.nAb(d)},b.prototype.lAb=function(a){var b,c,e,f,g,h,i,j,k,l,m=this;a<0&&(a=0),a>m.$zb&&(a=m.$zb+m.Zzb),c=m.value/100,e=m.aAb,f=m.$zb,g=3*m.Zzb/2,h=m.min,i=m.middle,j=m.max,k=a<=e?(e-a)/e*(j-i)+i:(f-a+g)/e*(i-h)+h,k<=h+5?k=h:k>=j-5&&(k=j),b=k/100,l=d.UCJ(this.xc),fb(l,b,c),m.M4()},b.prototype.nAb=function(a){if(a){a=eb(a);var b=d.UCJ(this.xc);fb(b,a/100,this.value/100),this.M4()}},b.prototype.oAb=function(a){var b=this,c=b.min,d=b.middle,e=b.max,f=b.Zzb,g=b.aAb,h=b.$zb,i;i=a<=d?(a-c)/(d-c)*g-f/2:(a-d)/(e-d)*g+g-f/2,i=h-i,this.pAb(i)},b.prototype.pAb=function(a){var b,c=this,d=c.Zzb/2,e=c.Zzb;a<=e?a+=e:a<c.$zb&&(a+=d),b=c.kAb,b.style.right=a+M},b.prototype.qAb=function(a){a&&(a=eb(a)),a!==this.value&&(this.value=parseInt(a+"",10),this.oAb(this.value))},b.prototype.rAb=function(a){return a===this.iAb||a===this.jAb||a===this.kAb||a===this.mAb},b.prototype.sAb=function(a){var b=a.target;this.rAb(b)&&this.tAb(ia)},b.prototype.uAb=function(a){var b=a.target;this.rAb(b)&&this.tAb(1)},b.prototype.tAb=function(a){this.kAb.style.opacity=a+""},b.prototype.Av=function(a){if(a){var b=a.tipText;this.menuContent=a.menuContent,this.tipText=b,this.eAb.title=b[0],this.hAb.title=b[1],this.kAb.title=b[2],this.mAb.title=b[2]}},b.prototype.onUnbind=function(){lb(this)},b.prototype.onDispose=function(){this.cAb=u,j.StatusItem.prototype.onDispose.call(this)},b}(j.StatusItem),Va=function(a){Za(b,a);function b(b,c){var d=a.call(this,b,c)||this;return d.Rzb=za+d.name,d}return b.prototype.onCreateItemView=function(a){a.style.display=this.visible?Z:Y;var b=this.vAb;b||(b=this.vAb=n(X)),l(b).addClass(E),b.innerText=K+L,a.appendChild(b)},b.prototype.onBind=function(a){jb(this,a)},b.prototype.onUpdate=function(){kb(this)},b.prototype.qAb=function(a){var b;a&&(b=eb(a)),b!==parseInt(this.value+"",10)&&(b=parseInt(b,10),this.value=b+L,this.wAb(b))},b.prototype.wAb=function(a){var b=this.vAb;b&&(b.innerText=a+L)},b.prototype.onUnbind=function(){lb(this)},b}(j.StatusItem),Wa=function(a){Za(b,a);function b(b,c){var d=a.call(this,b,c)||this;return d.Rzb=za+d.name,d.Vo=120,d.Qb=0,d}return b.prototype.onBind=function(a){var b=this;b.xc=a,a.bind(d.Events.ProgressChanged+b.Rzb,function(a,c){b.u4=c.sheetName,b.onUpdate(c.progress)})},b.prototype.onUpdate=function(a){if(void 0!==a){var b=this,c=b.LiK,d=b.MiK,e=b.Qb,f=b.visible,g=b.NiK,h=b.u4;a&&1!==a&&e!==a&&f?(b.Qzb.style.display=$,l(c).width(b.Vo*a),d.innerHTML=(100*a).toFixed(2)+"%",g.innerHTML=h?"("+h+")":""):(a<=0||a>=1||f===!1)&&(b.Qzb.style.display=Y,l(d).empty(),l(g).empty()),b.Qb=a}},b.prototype.onCreateItemView=function(a){var b,c,d,e,f=this,g=n(W);l(g).addClass(la),b=n(W),l(b).addClass(ma),l(b).width(f.Vo),g.appendChild(b),c=this.LiK=n(W),l(c).addClass(na),d=this.MiK=n(W),l(d).addClass(oa),e=this.NiK=n(W),l(e).addClass(pa),b.appendChild(c),g.appendChild(d),g.appendChild(e),a.appendChild(g),f.Qzb.style.display=Y},b.prototype.onUnbind=function(){this.xc&&(this.xc.unbind(d.Events.ProgressChanged+this.Rzb),this.xc=u)},b}(j.StatusItem);function ib(a,b,c){a.Wq(d.Events.UserZooming,{sheet:a,sheetName:a.name(),oldZoomFactor:c,newZoomFactor:b}),a.Wq(d.Events.ViewZoomed,{sheet:a,sheetName:a.name(),oldZoomFactor:c,newZoomFactor:b})}function jb(a,b){a.xc=b,b.bind(d.Events.ActiveSheetChanged+a.Rzb,function(){a.onUpdate()})}function kb(a){var b,c;j.StatusItem.prototype.onUpdate.call(a),b=d.UCJ(a.xc),c=b?b.zoom():1,a.qAb(c)}function lb(a){a.xc&&(a.xc.unbind(d.Events.ActiveSheetChanged+a.Rzb),a.xc=u)}Xa=function(){function a(a,b){var c,d;a&&(c=this,d=c.xAb=new k.BaseStatusBar(a),c.yAb(d,b),c.qo=d.qo,this.Czb=d.Czb,c.zAb={},c.AAb(a),c.maxCalcCells=5e4,l(a).data("statusbar",c))}return Object.defineProperty(a.prototype,"maxCalcCells",{get:function(){return this.$Lb},set:function(a){this.$Lb=a;var b=this.xAb.Ozb();b.forEach(function(b){b instanceof Ta&&(b.$Lb=a)})},enumerable:!0,configurable:!0}),a.prototype.yAb=function(a,b){var c,d,e,f,g,h,i,j=["formulaAverage","formulaCount","formulaNumericalCount","formulaMin","formulaMax","formulaSum"],k=["toolTipFormulaAverage","toolTipFormulaCount","toolTipFormulaNumericalCount","toolTipFormulaMin","toolTipFormulaMax","toolTipFormulaSum"],l=[Ra().formulaAverage,Ra().formulaCount,Ra().formulaNumericalCount,Ra().formulaMin,Ra().formulaMax,Ra().formulaSum],m=[Ra().toolTipFormulaAverage,Ra().toolTipFormulaCount,Ra().toolTipFormulaNumericalCount,Ra().toolTipFormulaMin,Ra().toolTipFormulaMax,Ra().toolTipFormulaSum],n=[!0,!0,!1,!1,!1,!0],o=[];for(l.forEach(function(a,b){var c={};c.menuContent=a,c.prefix=a,c.align=ra,c.tipText=m[b],c.visible=n[b],c.BAb=j[b],c.CAb=k[b],o.push(c)}),c={menuContent:Ra().cellMode,value:Ra().cellModeReady,tipText:q(Ra().toolTipCellMode,[Ra().cellModeReady]),BAb:"cellMode",CAb:"toolTipCellMode"},d={value:da,menuContent:Ra().zoomSlider,showStatusInContexMenu:!1,align:ra,BAb:"zoomSlider",CAb:["toolTipZoomOut","toolTipZoomIn","toolTipSlider"]},e={value:da+L,tipText:Ra().toolTipZoomPanel,menuContent:Ra().zoom,align:ra,BAb:"zoom",CAb:"toolTipZoomPanel"},f={value:0,menuContent:Ra().progressItem,showStatusInContexMenu:!1,BAb:qa,CAb:qa},g=[new Sa(N,c),new Wa(qa,f),new Ta(Ma[0],o[0]),new Ta(Ma[1],o[1]),new Ta(Ma[2],o[2]),new Ta(Ma[3],o[3]),new Ta(Ma[4],o[4]),new Ta(Ma[5],o[5]),new Ua(this,U,d),new Va(V,e)],b&&b.items instanceof Array&&(g=g.concat(b.items)),i=0;i<g.length;i++)h=g[i],a.mL(h);a.Jzb()},a.prototype.AAb=function(a){var b,c=this.qo,d=this.Czb,e=a.clientHeight;c&&(l(c).addClass(H),l(d).addClass(I),b=e,e<_&&(a.style.minHeight=_+M,b=_),d.style.top="-"+b+M)},a.prototype.DAb=function(){var a=this.qo;a&&(this.EAb=this.FAb.bind(this),a.addEventListener(ya,this.EAb))},a.prototype.FAb=function(a){var b,c,d,e,f,g;o(a),b=this,c=b.zAb,d=b.xc,Na&&d&&(b.Ela||(b.Ela=new Pa(b.Czb,l(b.xc.sv))),e=c.menuView,f=b.qo,g=gb(f).left,e.hostInfo={top:f.getBoundingClientRect().top,left:f.getBoundingClientRect().left,width:f.clientWidth,height:f.clientHeight},c.menuData=b.xAb.Lzb(),b.Ela.OT(e,c.menuData,a.clientX-g,a.offsetY,d))},a.prototype.GAb=function(a){if(Na){var b=new mb;this.zAb.menuView=b,this.nla(a)}},a.prototype.nla=function(a){var b=this,c=a.commandManager(),d={canUndo:!1,execute:function(a,c){var d=c.commandOptions;b.xAb.Nzb(d)}};c.register(J+ta,d)},a.prototype.nmK=function(){this.xAb.nmK()},a.prototype.bind=function(a){this.unbind(),a&&(this.xc=a,a.cAb=this,this.xAb.Izb(a),this.GAb(a),this.DAb())},a.prototype.unbind=function(){this.xAb&&this.xAb.Pzb(),this.xc&&(this.xc.cAb=u,this.xc=u),this.qo&&(this.qo.removeEventListener(ya,this.EAb),this.EAb=u),this.Ela&&(this.Ela.close(),this.Ela=u)},a.prototype.add=function(a,b){return this.xAb.Fzb(a,b)},a.prototype.remove=function(a){return this.xAb.Hzb(a)},a.prototype.get=function(a){return this.xAb.Jp(a)},a.prototype.all=function(){return this.xAb.Ozb()},a.prototype.update=function(){this.xAb.Kzb()},a.prototype.dispose=function(){this.unbind(),this.zAb=u,this.Ela=u,this.xAb&&(l(this.xAb.ET).data("statusbar",u),this.xAb.no(),this.xAb=u),this.qo&&(this.qo=u)},a}(),b.StatusBar=Xa,Na&&v(mb,Oa);function mb(){Na&&Oa.call(this)}mb.prototype.getCommandOptions=function(a){return a},Ya=function(a){Za(b,a);function b(b,c){var d=a.call(this)||this;return d.kj=b,d.HAb=c,d}return b.prototype.canExecute=function(){return!0},b.prototype.execute=function(){var a,b=this,c=b.kj,e=b.HAb,f=e.newZoomFactor;if(this.canExecute()){c.ITa.startTransaction();try{c.zoom(f)}finally{a=d.Commands.bWa(c.name()),e[a]=c.ITa.endTransaction()}return!0}return!1},b.prototype.canUndo=function(){return!0},b.prototype.undo=function(){var a=this,b=a.kj,c=a.HAb,e=d.Commands.bWa(b.name()),f=c[e][0].value,g=b.zoom();return f!==g&&(b.zoom(f),ib(b,f,g)),!0},b}(s),d.Commands[sa]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,Ya,b,c)}},d.Worksheet.$n(sa,{setHost:function(a){if(a){var b=this.wu();b[sa]||b.register(sa,d.Commands[sa])}},onLayoutChanged:function(a){var b=a.changeType,c,d;b===Aa&&(c=this.parent,c&&!c.isPaintSuspended()&&(d=c.cAb,d&&d.update()))}});function nb(a){var b=a.cAb;b&&b.nmK()}d.Workbook.$n(ta,{onCultureChanged:function(){var a=this.cAb,b=Ra(),c=[],d,e;a&&a.xAb&&a.xAb.Ozb().forEach(function(a){d=a.CAb,e=b[d],d instanceof Array&&(d.forEach(function(a){c.push(b[a])}),e=c),a.Av({menuContent:b[a.BAb],tipText:e})})},preFromJson:function(){nb(this)},preFromSJSFormat:function(){nb(this)}})},"./dist/plugins/statusBar/statusBar.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/statusBar/statusBar.res.en.js");b.SR={en:d}},"./dist/plugins/statusBar/statusBar.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.cellMode="Cell Mode",b.cellModeReady="Ready",
b.cellModeEnter="Enter",b.cellModeEdit="Edit",b.formulaAverage="Average",b.formulaCount="Count",b.formulaNumericalCount="Numerical Count",b.formulaMin="Min",b.formulaMax="Max",b.formulaSum="Sum",b.zoomSlider="Zoom Slider",b.zoom="Zoom",b.toolTipCellMode="In {0} mode",b.toolTipFormulaAverage="Average of selected cells",b.toolTipFormulaCount="Number of selected cells that contain data",b.toolTipFormulaNumericalCount="Number of selected cells that contain numerical data",b.toolTipFormulaMin="Minimum value in selection",b.toolTipFormulaMax="Maximum value in selection",b.toolTipFormulaSum="Sum of selected cells",b.toolTipZoomOut="Zoom Out",b.toolTipZoomIn="Zoom In",b.toolTipSlider="Zoom",b.toolTipZoomPanel="Zoom level",b.progressItem="Progress"},"./dist/plugins/statusBar/statusItem.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=d.Ul.Nl,g=d.GC$,h=e.Common.j,i=h.Fa,j="gc-statusbar-statusitem-container",k="div",l="span",m="none",n="inline-block",o="mousemove",p="mouseout",q=null,r="left",s="auto",t="gc.spread.",u="statusBar",v="10px",w="px",x=15;function z(a,b,c,d){return{name:a,menuContent:b,visible:c,status:d,command:t+u}}y=function(){function a(a,b){if(this._marginLeft=0,this._marginRight=0,this.Vo=s,this.Qzb=q,this.TJa=q,this.name=a,b){var c=b.align,d=b.menuContent,e=b.tipText,f=b.visible,g=b.showStatusInContexMenu,h=b.value,j=b.BAb,k=b.CAb;this.align=i(c)?r:c,this.menuContent=i(d)?q:d,this.tipText=i(e)?"":e,this.visible=!!i(f)||f,this.showStatusInContexMenu=!!i(g)||g,this.value=i(h)?q:h,this.BAb=i(j)?q:j,this.CAb=i(k)?q:k}}return a.prototype.Ezb=function(a){var b,c,d=this.align===r;this._marginLeft=d?v:0,this._marginRight=d?0:v,b=a.clientHeight,this._v=b>x?b:x,c=this.IAb(),this.Qzb=c,this.onCreateItemView(c),this.QQ(c)},a.prototype.IAb=function(){var a=this.Qzb,b=this._v&&this._v+w;return a||(a=this.Qzb=f(k),a.title=this.tipText,g(a).addClass(j),g(a).css({height:b,lineHeight:b,float:this.align,marginLeft:this._marginLeft+"",marginRight:this._marginRight+""}),this.visible===!1&&(a.style.display=m)),a},a.prototype.onCreateItemView=function(a){var b=this.TJa;b||(b=this.TJa=f(l),b.innerText=this.value+""),a.appendChild(b)},a.prototype.omK=function(){},a.prototype.onBind=function(a){},a.prototype.QQ=function(a){a.addEventListener(o,this.sAb.bind(this)),a.addEventListener(p,this.uAb.bind(this))},a.prototype.Gzb=function(){return this.Qzb},a.prototype.sAb=function(a){},a.prototype.uAb=function(a){},a.prototype.Mzb=function(){var a=this.JAb();return a.type=u,a.workArea=u,a},a.prototype.Nzb=function(a){this.visible=!a.visible,this.onUpdate()},a.prototype.JAb=function(){var a=this.showStatusInContexMenu?this.KAb():null;return z(this.name,this.menuContent,this.visible,a)},a.prototype.KAb=function(){return this.value},a.prototype.D4=function(){this.Qzb&&(this.Qzb.style.display=this.visible?n:m)},a.prototype.Av=function(a){a&&(this.menuContent=a.menuContent,this.tipText=a.tipText,this.Qzb.title=this.tipText)},a.prototype.onUpdate=function(a){a&&this.TJa&&(this.TJa.innerHTML=a),this.D4()},a.prototype.onUnbind=function(){},a.prototype.onDispose=function(){this.onUnbind(),this.TJa=q,this.Qzb&&(this.Qzb.removeEventListener(o,this.sAb),this.Qzb.removeEventListener(p,this.uAb),g(this.Qzb).empty(),this.Qzb=q)},a}(),b.StatusItem=y},"./dist/plugins/table/table-action.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/table/table-util.js"),g=f.Util.bMb,h=f.Util.UIb,i=f.Util.VIb,j=f.Util._getTable,k=f.Util.cNb,l=d.Commands.ActionBase,m=e.Common.j.Fa,n="tableResize",o="tableInsertRows",p="tableDeleteRows",q="tableInsertColumns",r="tableDeleteColumns",s="tableToRange",t="tableTotalRowFormula",u="DoInsertRows",v="tableShowFooter",w="tableInsertRowsAboveForContextMenu",x="tableInsertRowsBelowForContextMenu",y="tableDeleteRowsForContextMenu",z="tableInsertColumnsLeftForContextMenu",A="tableInsertColumnsRightForContextMenu",B="tableDeleteColumnsForContextMenu",C=void 0,D=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d.cMb=c,d.dMb=c.tableName,d.eMb=c.resizeToRange,d}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k=this,l=!1;if(k.canExecute()){a=k.kj,b=a.ITa,c=k.dMb,e=k.cMb,b.startTransaction(),k.Lz(a,!0);try{f=a.tables.findByName(c),f&&(h=f.range(),i=k.eMb,a.tables.resize(f,i),g(a,f,h,i),l=!0)}finally{k.Mz(a,!0),j=d.Commands.bWa(a.name()),e[j]=b.endTransaction()}}return l},b.prototype.undo=function(){var a,b,c,e,f,h=this,i=h.kj,j=h.dMb,k=!1;if(h.canUndo()){h.Lz(i,!0);try{a=h.cMb,b=i.ITa,c=i.tables.findByName(j),e=d.Commands.bWa(i.name()),f=a[e],f&&(b.undo(f),g(i,c,a.resizeToRange,c.range()),k=!0)}finally{h.Mz(i,!0)}}return k},b}(l),d.Commands[n]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,D,b,c)}},E=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d.fMb=c,d.dMb=c.tableName,d.cj=c.row,d.Jb=c.count,d.gMb=c.isAfter,d}return b.prototype.execute=function(){var a,b,c,e,f,g,i,j,k,l,m=this,n=!1;if(m.canExecute()){a=m.kj,b=a.ITa,c=m.dMb,e=m.cj,f=m.Jb,g=m.gMb,b.startTransaction(),m.Lz(a,!0);try{i=a.tables.findByName(c),i&&(j=i.Xj,i.Nia(e,f,g),n=!0,k=i.Xj,k-j===f&&h(a,i,o,e,f,g))}finally{m.Mz(a,!0),l=d.Commands.bWa(a.name()),m.fMb[l]=b.endTransaction()}}return n},b.prototype.undo=function(){var a,b,c,e,f,g,i,j,l,m=this,n=m.kj,o=!1;if(m.canUndo()){m.Lz(n,!0);try{a=m.fMb,b=n.ITa,c=d.Commands.bWa(n.name()),e=a[c],f=a.row,g=a.count,i=a.isAfter,e&&(b.undo(e),j=n.tables.findByName(m.dMb),j&&(l=i?f+1:f,j.kfc(l,g),j.NAb(),j.dOb(l,g,k(!0)),h(n,j,p,f,g,C,j.xKb())),o=!0)}finally{m.Mz(n,!0)}}return o},b}(l),d.Commands[o]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,E,b,c)}},F=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d.fMb=c,d.dMb=c.tableName,d.cj=c.row,d.Jb=c.count,d.gMb=c.isAfter,d}return b.prototype.execute=function(){var a,b,c,e,f,g,i,j,k=this,l=!1;if(k.canExecute()){a=k.kj,b=a.ITa,c=k.dMb,e=k.cj,f=k.Jb,g=k.gMb,b.startTransaction(),k.Lz(a,!0);try{i=a.tables.findByName(c),i&&(i.hMb(e,f,g,!1),h(a,i,o,e,f,g),k.fMb.row=e,k.fMb.count=f,l=!0)}finally{k.Mz(a,!0),j=d.Commands.bWa(a.name()),k.fMb[j]=b.endTransaction()}}return l},b.prototype.undo=function(){var a,b,c,e,f,g,i,j,l,m,n,o,q=this,r=q.kj,s=!1;if(q.canUndo()){q.Lz(r,!0);try{a=q.fMb,b=r.ITa,c=d.Commands.bWa(r.name()),e=a[c],f=a.row,g=a.count,i=a.isAfter,e&&(j=r.tables.findByName(q.dMb),l=j&&j.LZ(),m=void 0,n=i?f+1:f,l&&(o=j.dataRange(),m=l.slice(n-o.row,n-o.row+g)),b.undo(e),j&&(j.kfc(n,g),j.NAb(),j.dOb(n,g,k(!0)),h(r,j,p,f,g,i,m||j.xKb())),s=!0)}finally{q.Mz(r,!0)}}return s},b}(l),d.Commands[u]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,F,b,c)}},G=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d.iMb=c,d.dMb=c.tableName,d.rCJ=c.changeRows,d}return b.prototype.execute=function(){var a,b,c,e,f,g,i,j,k,l,m,n=this,o=!1;if(n.canExecute()){a=n.kj,b=a.ITa,c=n.dMb,e=n.rCJ,b.startTransaction(),n.Lz(a,!0);try{if(f=a.tables.findByName(c))for(g=e.length-1;g>=0;g--)i=e[g].row,j=e[g].count,k=f.Xj,f.STa(i,j),o=!0,l=f.Xj,k-l===j&&h(a,f,p,i,j,C,f.xKb())}finally{n.Mz(a,!0),m=d.Commands.bWa(a.name()),n.iMb[m]=b.endTransaction()}}return o},b.prototype.undo=function(){var a,b,c,e,f,g,i,j,k,l=this,m=l.kj,n=!1;if(l.canUndo()){l.Lz(m,!0);try{if(a=l.iMb,b=m.ITa,c=d.Commands.bWa(m.name()),e=a[c],f=l.rCJ,e)for(b.undo(e),g=m.tables.findByName(l.dMb),g&&g.NAb(),n=!0,i=f.length-1;i>=0;i--)j=f[i].row,k=f[i].count,h(m,g,o,j,k,!1)}finally{l.Mz(m,!0)}}return n},b}(l),d.Commands[p]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,G,b,c)}},H=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d.jMb=c,d.dMb=c.tableName,d.dj=c.col,d.Jb=c.count,d.gMb=c.isAfter,d}return b.prototype.execute=function(){var a,b,c,e,f,g,h,j,k,l,m=this,n=!1;if(m.canExecute()){a=m.kj,b=a.ITa,c=m.dMb,e=m.dj,f=m.Jb,g=m.gMb,b.startTransaction(),m.Lz(a,!0);try{h=a.tables.findByName(c),h&&(j=h.OZ,h.kMb(e,f,g),n=!0,k=h.OZ,k-j===f&&i(a,h,q,e,f,g))}finally{m.Mz(a,!0),l=d.Commands.bWa(a.name()),m.jMb[l]=b.endTransaction()}}return n},b.prototype.undo=function(){var a,b,c,e,f,g,h,j=this,k=j.kj,l=!1;if(j.canUndo()){j.Lz(k,!0);try{a=j.jMb,b=k.ITa,c=d.Commands.bWa(k.name()),e=a[c],f=a.col,g=a.count,e&&(b.undo(e),h=k.tables.findByName(j.dMb),h&&h.NAb(),l=!0,i(k,h,r,f,g))}finally{j.Mz(k,!0)}}return l},b}(l),d.Commands[q]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,H,b,c)}},I=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d.lMb=c,d.dMb=c.tableName,d.dj=c.col,d.Jb=c.count,d}return b.prototype.execute=function(){var a,b,c,e,f,g,h,j,k,l=this,m=!1;if(l.canExecute()){a=l.kj,b=a.ITa,c=l.dMb,e=l.dj,f=l.Jb,b.startTransaction(),l.Lz(a,!0);try{g=a.tables.findByName(c),g&&(h=g.OZ,g.TTa(e,f),m=!0,j=g.OZ,h-j===f&&i(a,g,r,e,f))}finally{l.Mz(a,!0),k=d.Commands.bWa(a.name()),l.lMb[k]=b.endTransaction()}}return m},b.prototype.undo=function(){var a,b,c,e,f,g,h,j=this,k=j.kj,l=!1;if(j.canUndo()){j.Lz(k,!0);try{a=j.lMb,b=k.ITa,c=d.Commands.bWa(k.name()),e=a[c],f=a.col,g=a.count,e&&(b.undo(e),h=k.tables.findByName(j.dMb),h&&h.NAb(),l=!0,i(k,h,q,f,g,!1))}finally{j.Mz(k,!0)}}return l},b}(l),d.Commands[r]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,I,b,c)}},J=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this;return d.mMb=c,d.dMb=c.tableName,d}return b.prototype.execute=function(){var a,b,c,e,f,g=this,h=!1;if(g.canExecute()){a=g.kj,b=a.ITa,c=g.dMb,b.startTransaction(),g.Lz(a,!0);try{e=a.tables.findByName(c),e&&(a.tables.remove(e,3),h=!0)}finally{g.Mz(a,!0),f=d.Commands.bWa(a.name()),g.mMb[f]=b.endTransaction()}}return h},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{a=g.mMb,b=h.ITa,c=d.Commands.bWa(h.name()),e=a[c],e&&(b.undo(e),f=h.tables.findByName(g.dMb),f&&f.NAb(),i=!0)}finally{g.Mz(h,!0)}}return i},b}(l),d.Commands[s]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,J,b,c)}},K=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this,e=d;return e.nMb=c,e.cj=c.row,e.dj=c.col,e.Yw=c.newValue,d}return b.prototype.execute=function(){var a,b,c,e,f,g,h=this,i=!1;if(h.canExecute()){a=h.kj,b=a.ITa,b.startTransaction(),h.Lz(a,!0);try{c=h.cj,e=h.dj,f=h.Yw,a.setFormula(c,e,f),f||a.setValue(c,e,null),i=!0}finally{h.Mz(a,!0),g=d.Commands.bWa(a.name()),h.nMb[g]=b.endTransaction()}}return i},b.prototype.undo=function(){var a,b,c,e,f=this,g=f.kj,h=!1;if(f.canUndo()){f.Lz(g,!0);try{a=f.nMb,b=g.ITa,c=d.Commands.bWa(g.name()),e=a[c],e&&(b.undo(e),h=!0)}finally{f.Mz(g,!0)}}return h},b}(l),d.Commands[t]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,K,b,c)}},L=function(a){M(b,a);function b(b,c){var d=a.call(this,b)||this,e=d;return e.oMb=c,d.dMb=c.tableName,d}return b.prototype.execute=function(){var a,b,c,e,f,g=this,h=!1;if(g.canExecute()){a=g.kj,b=a.ITa,c=g.dMb,b.startTransaction(),g.Lz(a,!0);try{e=a.tables.findByName(c),e&&(e.showFooter(!0),h=!0)}finally{g.Mz(a,!0),f=d.Commands.bWa(a.name()),g.oMb[f]=b.endTransaction()}}return h},b.prototype.undo=function(){var a,b,c,e,f=this,g=f.kj,h=!1;if(f.canUndo()){f.Lz(g,!0);try{a=f.oMb,b=g.ITa,c=d.Commands.bWa(g.name()),e=a[c],e&&(b.undo(e),h=!0)}finally{f.Mz(g,!0)}}return h},b}(l),d.Commands[v]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,L,b,c)}},d.Commands[w]={canUndo:!0,execute:function(a,b,c){var e,f,g,h,i,k,l;return b.cmd=w,m(b.row)&&m(b.count)?(e=d.Commands.bT(a,b),f=b.selections,g=void 0,h=void 0,i=void 0,k=void 0,1===f.length&&(g=f[0],h=j(e,g),h&&(i=g.row,k=g.rowCount,l=h.footerIndex()===i,b.row=l?i-1:i,b.count=k,b.tableName=h.name(),b.isAfter=l),d.Commands.h4(a,E,b,c))):d.Commands.h4(a,E,b,c)}},d.Commands[x]={canUndo:!0,execute:function(a,b,c){if(b.cmd=x,m(b.row)&&m(b.count)){var e=d.Commands.bT(a,b),f=b.selections,g=void 0,h=void 0,i=void 0,k=void 0;return 1===f.length&&(g=f[0],h=j(e,g),h&&(i=g.row,k=g.rowCount,b.row=i,b.count=k,b.tableName=h.name(),b.isAfter=!0),d.Commands.h4(a,E,b,c))}return d.Commands.h4(a,E,b,c)}},d.Commands[y]={canUndo:!0,execute:function(a,b,c){var e,f,g,h,i,k,l,n,o,p;if(b.cmd=y,m(b.changeRows)&&m(b.changeRows)){for(e=d.Commands.bT(a,b),f=b.selections,g=void 0,h=void 0,i=void 0,b.changeRows=[],k=0;k<f.length;k++){if(l=f[k],n=j(e,l),!n)return!1;if(g){if(g!==n)return!1}else g=n}for(k=0;k<f.length;k++)for(o=k+1;o<f.length;o++){if(l=f[k],p=f[o],l.row>=p.row&&l.row<=p.row+p.rowCount-1)return!1;if(l.row+l.rowCount-1>=p.row&&l.row+l.rowCount-1<=p.row+p.rowCount-1)return!1;if(l.row<=g.cj||l.row+l.rowCount>g.cj+g.Xj)return!1;if(p.row<=g.cj||p.row+p.rowCount>g.cj+g.Xj)return!1}for(f.sort(function(a,b){return a.row-b.row}),k=0;k<f.length;k++)l=f[k],h=l.row,i=l.rowCount,b.changeRows.push({row:h,count:i});return b.tableName=g.name(),d.Commands.h4(a,G,b,c)}return d.Commands.h4(a,G,b,c)}},d.Commands[z]={canUndo:!0,execute:function(a,b,c){if(b.cmd=z,m(b.col)&&m(b.count)){var e=d.Commands.bT(a,b),f=b.selections,g=void 0,h=void 0,i=void 0,k=void 0;return 1===f.length&&(g=f[0],h=j(e,g),h&&(i=g.col,k=g.colCount,b.col=i,b.count=k,b.tableName=h.name(),b.isAfter=!1),d.Commands.h4(a,H,b,c))}return d.Commands.h4(a,H,b,c)}},d.Commands[A]={canUndo:!0,execute:function(a,b,c){if(b.cmd=A,m(b.col)&&m(b.count)){var e=d.Commands.bT(a,b),f=b.selections,g=void 0,h=void 0,i=void 0,k=void 0;return 1===f.length&&(g=f[0],h=j(e,g),h&&(i=g.col,k=g.colCount,b.col=i,b.count=k,b.tableName=h.name(),b.isAfter=!0),d.Commands.h4(a,H,b,c))}return d.Commands.h4(a,H,b,c)}},d.Commands[B]={canUndo:!0,execute:function(a,b,c){if(b.cmd=B,m(b.col)&&m(b.count)){var e=d.Commands.bT(a,b),f=b.selections,g=void 0,h=void 0,i=void 0,k=void 0;return 1===f.length&&(g=f[0],h=j(e,g),h&&(i=g.col,k=g.colCount,b.col=i,b.count=k,b.tableName=h.name()),d.Commands.h4(a,I,b,c))}return d.Commands.h4(a,I,b,c)}},d.Commands.pMb=function(a){a.register(n,d.Commands[n]),a.register(o,d.Commands[o]),a.register(u,d.Commands[u]),a.register(p,d.Commands[p]),a.register(q,d.Commands[q]),a.register(r,d.Commands[r]),a.register(s,d.Commands[s]),a.register(t,d.Commands[t]),a.register(v,d.Commands[v]),a.register(w,d.Commands[w]),a.register(x,d.Commands[x]),a.register(y,d.Commands[y]),a.register(z,d.Commands[z]),a.register(A,d.Commands[A]),a.register(B,d.Commands[B])}},"./dist/plugins/table/table-event.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/table/table.js"),g=c("./dist/plugins/table/table.ns.js"),h=c("./dist/plugins/table/table-util.js"),i=e.Common.j.Fa,j=null,k=Math.abs,l=10,m="tableResize",n=new e.Common.ResourceManager(g.SR,"Tables"),o=n.getResource.bind(n),p=h.Util.qMb,q=h.Util.rMb,r=h.Util.sMb,d.GC$.extend(d.iI.prototype,{sIb:function(a,b){var c,d=this.uIb(a,b);d&&(c=this,c.o4=c.$G=b.ITa.getSelections(),b.setSelection(d.row,d.col,d.rowCount,d.colCount))},uIb:function(a,b){var c,e,g,h,k,l,m,n,o=b.getSelections(),p=a.tableSelectInfo;if(!b.isEditing()||b.getActiveRowIndex()===a.row&&b.getActiveColumnIndex()===a.col||b.endEdit(),c=p.table,e=0,g=0,c.NZ&&(e=1),c.MZ&&(g=1),h=j,k=p.action,l=b.Cw&&b.Cw.zLb(),!i(l)&&l.length>0&&(o=l),k===f.TableSelectionType.TABLE_ROW_SELECT)h=d.kf(a.row,c.dj,1,c.OZ);else if(k===f.TableSelectionType.TABLE_COL_SELECT){for(m=0;m<o.length;m++)if(n=o[m],n.col===a.col&&n.row===c.cj+g&&1===n.colCount&&n.rowCount===c.Xj-g-e){h=d.kf(c.cj,a.col,c.Xj,1);break}i(h)&&(h=d.kf(c.cj+g,a.col,c.Xj-g-e,1))}else if(k===f.TableSelectionType.TABLE_CORNER_SELECT){for(m=0;m<o.length;m++)if(n=o[m],n.col===c.dj&&n.row===c.cj+g&&n.colCount===c.OZ&&n.rowCount===c.Xj-g-e){h=d.kf(c.cj,c.dj,c.Xj,c.OZ);break}i(h)&&(h=d.kf(c.cj+g,c.dj,c.Xj-g-e,c.OZ))}else k===f.TableSelectionType.TABLE_SELECT&&(h=d.kf(c.cj,c.dj,c.Xj,c.OZ));return h},rJb:function(a,b){var c,d,e,f,g,h,i,k,m,n,o,r,s,t,u,v=this.kj,w=j;return v&&!v.options.isProtected&&!v.isEditing()&&b&&b.showResizeHandle()?(c=a.row,d=a.col,e=a.x,f=a.y,g=a.rowViewportIndex,h=a.colViewportIndex,i=p(v,b),k=q(v,b),c===i&&d===k&&(m=v.getCellRect(c,d,g,h),n=m.x,o=m.y,r=m.width,s=m.height,t=n+r,u=o+s,e>=t-l&&e<=t&&f>=u-l&&f<=u&&(w={x:e,y:f,table:b})),w):w},tIb:function(a){var b,c,d,e,f,g=this;g.wIb!==!0&&g.OG!==!0&&(b=g.kj,c=a.resizeTableHitInfo,d=c&&c.table,d&&!d.qJb()&&(g.wIb=!0,g.OG=!0,g.tMb=d,g.uMb=d.cj,g.vMb=d.dj,g.wMb=d.Xj,g.xMb=d.OZ,e=g.uMb+g.wMb-1,f=g.vMb+g.xMb-1,g.yMb=b.getCellRect(e,f),g.zMb=d.range(),g.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},g.qG()))},xIb:function(){var a,b=this,c=b.kj;b.rG&&b.wIb&&b.OG&&b.tMb&&(b.AMb(),b.BMb()&&(b.CMb=b.DMb(),b.EMb(),b.FMb(),a=b.GMb,a||(a=b.HMb()),a.equals(b.IMb)||(b.GMb=d.kf(b.IMb.row,b.IMb.col,b.IMb.rowCount,b.IMb.colCount),r(c,b.tMb,b.HMb(),b.IMb))),b.NG())},CIb:function(){var a,b=this,c=b.kj;return b.RG(),b.wIb&&b.OG&&b.IMb&&b.tMb?(b.wIb=!1,b.OG=!1,void(b.KMb()?(a=b.HMb(),b.LMb(),a.equals(b.IMb)?c.yl.MMb():c.wu().execute({cmd:m,sheetName:c.name(),tableName:b.tMb.name(),resizeToRange:b.IMb}),b.JMb()):(b.JMb(),c.yl.MMb()))):void b.JMb()},HMb:function(){var a=this.tMb;return d.kf(a.cj,a.dj,a.Xj,a.OZ)},AMb:function(){var a=this,b=a.fH(),c=a.gH();a.NMb=b,a.OMb=c},BMb:function(){var a=this,b=a.uMb,c=a.vMb,d=a.NMb,e=a.OMb,f=a.tMb,g=f.MZ,h=g?b+1:b,i=c;return d>=h&&e>=i},DMb:function(){var a,b=this,c=b.$F,d=b.yMb,e=d.x+d.width,f=d.y+d.height,g=c.x,h=c.y,i=k(f-h),j=k(e-g);return a=i>=j?h<f?2:3:g<e?0:1},EMb:function(){var a=this,b=a.uMb,c=a.vMb,e=a.NMb,f=a.OMb,g=a.CMb,h=a.wMb,i=a.xMb;switch(g){case 0:case 1:i=k(f-c)+1;break;case 2:case 3:h=k(e-b)+1}a.IMb?(a.IMb.rowCount=h,a.IMb.colCount=i):a.IMb=d.kf(b,c,h,i)},FMb:function(){var a=this,b=a.kj;b.yl.MMb(),a.zMb=a.PMb()},PMb:function(){var a=this,b=a.IMb,c=b.row,e=b.col,f=b.rowCount,g=b.colCount;return d.kf(c,e,f,g)},LMb:function(){var a=this,b=a.tMb,c=a.CMb;2===c&&b.NZ&&(a.IMb.rowCount+=1)},KMb:function(){var a=this,b=a.kj,c=!1,e=b.ITa,g=b.tables,h=a.tMb,i=a.IMb,j=i.row,k=i.col,l=i.rowCount,m=i.colCount,n=a.NMb,r=a.OMb,s=p(b,h),t=q(b,h),u=a.CMb,v=h.xr;return s&&t?f.hasRowFilter(b,new d.Range(j,k,l,m))?c:(e.MTa(j,k,l,m)||e.qu(j,k,l,m)?b.Os(6,o().Exp_TableResizeToSpan):v&&v.isFiltered()?2===u?b.Os(6,o().Exp_TableResizeWithHidden):3===u&&h.NZ?b.Os(6,o().Exp_TableResizeWithFilter):c=!0:2===u&&a.QMb(s,n)||0===u&&a.RMb(t,r)?b.Os(6,o().Exp_TableResizeWithHidden):1===u&&(g.rn(j,t+1,l,r-t)||g.HZ(j,t+1,l,r-t))||3===u&&(g.rn(s+1,k,n-s,m)||g.HZ(s+1,k,n-s,m))?b.Os(6,o().Exp_TableResizeToTable):c=!0,c):c},QMb:function(a,b){var c=this,d=c.kj,e,f=!1;for(e=a;e>b;e--)if(d.getRowHeight(e)<=0){f=!0;break}return f},RMb:function(a,b){var c=this,d=c.kj,e,f=!1;if(!f)for(e=a;e>b;e--)if(d.getColumnWidth(e)<=0){f=!0;break}return f},JMb:function(){var a=this;a.wIb=!1,a.OG=!1,a.rG=j,a.IMb=j,a.GMb=j}})},"./dist/plugins/table/table-render.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.GC$.extend,f="tableRender",e(d.oJ.prototype,{MMb:function(){var a=this,b=a.kj;b.Xq>0||a.im()}}),d.Worksheet.$n(f,{paintAdornment:function(a){var b=this,c=a.ctx,d=b.mm;d&&d.rG&&d.wIb&&g(b,c,d.iH(),d.jH())}});function g(a,b,c,d){var e=a.mm,f=e.IMb,g=a.getRangeRect(c,d,f);b.strokeStyle=a.getSelectionBorderColor(),b.strokeRect(g.x,g.y,g.width,g.height)}},"./dist/plugins/table/table-theme.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.GC$.each,f=d.GC$.isEmptyObject,g=d.Ul.Ol,h=JSON.stringify,i=JSON.parse,j=d.Ul.Pl,k=d.Ul.McK,l=d.NodeHelper.pca,m=Math.floor,n=void 0,o=null,p="headerRowStyle",q="footerRowStyle",r="wholeTableStyle",s="highlightLastColumnStyle",t="highlightFirstColumnStyle",u="firstRowStripStyle",v="secondRowStripStyle",w="firstColumnStripStyle",x="secondColumnStripStyle",y="firstHeaderCellStyle",z="lastHeaderCellStyle",A="firstFooterCellStyle",B="lastFooterCellStyle",C=[p,q,r,s,t,u,v,w,x,y,z,A,B],D="firstRowStripSize",E="secondRowStripSize",F="firstColumnStripSize",G="secondColumnStripSize",H=[D,E,F,G],I="name",J="bold 11pt calibri",K={wholeTable:"wholeTableStyle",headerRow:"headerRowStyle",totalRow:"footerRowStyle",firstColumn:"highlightFirstColumnStyle",lastColumn:"highlightLastColumnStyle",firstRowStripe:"firstRowStripStyle",secondRowStripe:"secondRowStripStyle",firstColumnStripe:"firstColumnStripStyle",secondColumnStripe:"secondColumnStripStyle",firstHeaderCell:"firstHeaderCellStyle",lastHeaderCell:"lastHeaderCellStyle",firstTotalCell:"firstFooterCellStyle",lastTotalCell:"lastFooterCellStyle"},L="borderLeft",M="borderTop",N="borderRight",O="borderBottom",P="borderHorizontal",Q="borderVertical",R=["backColor","foreColor","font",L,M,N,O,P,Q,"textDecoration"];function da(){var a,b={};for(a=1;a<=28;a++)a<=21&&(b["TABLESTYLELIGHT"+a]=!0),a<=11&&(b["TABLESTYLEDARK"+a]=!0),b["TABLESTYLEMEDIUM"+a]=!0;return b}S=da(),T=function(){function a(a,b,c,d,f,g,h,i,j,k){var l=this,m=arguments;e(R,function(a,b){l[b]=m[a]})}return a.prototype.Yo=function(a,b,c,d,f){var h=this;c&&g(h[L])&&!g(a[L])&&(a[L]=h[L],a[L].level=20),b&&g(h[M])&&!g(a[M])&&(a[M]=h[M],a[M].level=20),f&&g(h[N])&&!g(a[N])&&(a[N]=h[N],a[N].level=20),d&&g(h[O])&&!g(a[O])&&(a[O]=h[O],a[O].level=20),b||!g(h[P])||g(a[M])||(a[M]=h[P],a[M].level=20),d||!g(h[P])||g(a[O])||(a[O]=h[P],a[O].level=20),c||!g(h[Q])||g(a[L])||(a[L]=h[Q],a[L].level=20),f||!g(h[Q])||g(a[N])||(a[N]=h[Q],a[N].level=20),e(R,function(b,c){c.indexOf("border")>=0||g(h[c])&&!g(a[c])&&(a[c]=h[c])})},a.prototype.Uo=function(){var b=new a,c=h(this.toJSON());return b.fromJSON(i(c)),b},a.prototype.toJSON=function(){var a=this,b={};return e(R,function(c,d){var e=a[d],g=e&&e.toJSON?e.toJSON():e;b[d]=f(g)?n:g}),b},a.prototype.fromJSON=function(a,b){if(a){var c=this;e(R,function(e,f){var h,i=a[f];g(i)&&(f.indexOf("border")>=0?(h=new d.LineBorder,h.fromJSON(i,b),c[f]=h):c[f]=i)})}},a}(),b.TableStyle=T,d.GC$.extend(d.StyleManager.prototype,{addTableTheme:function(a){var b=this,c=b.GeK;c||(c=b.GeK={}),c[a.name()]=a},getTableTheme:function(a){var b,c,d=this,e=d.GeK;return e||(e=d.GeK={}),S[a.toUpperCase()]?(b=a.substr(10).toLowerCase(),e[b]?e[b]:(c=new U,ea(c,X[b]),d.addTableTheme(c),c)):e[a]}});function ea(a,b){a.name(b.name()),e(H,function(c,d){a[d](b[d]())}),e(C,function(c,d){var e=b[d]();a[d](e?e.Uo():o)}),a.builtInName(b.builtInName(),!1)}U=function(){function a(){}return a.prototype.toJSON=function(){var a,b,c=this,d=c.builtInName();return d?{buildInName:d}:(a={name:c.name()},e(C,function(d,e){b=c[e](),b&&(a[e]=b.toJSON())}),e(H,function(d,e){b=c[e](),1!==b&&(a[e]=b)}),f(a)?n:a)},a.prototype.fromJSON=function(a,b){var c,d,f,h;if(a){if(c=this,d=a.buildInName)return void ea(c,X[d.toLowerCase()]);f=a.name,h=g(f)?f:a.Cj,g(h)&&c.name(h,!1),e(H,function(b,d){var e=a[d]!==n?a[d]:a["_"+d];e&&c[d](e,!1)}),e(C,function(d,e){var f,g=a[e]!==n?a[e]:a["_"+e];g&&(f=new T,f.fromJSON(g,b),c[e](f,!1))})}},a.prototype.cdK=function(a,b){var c,f,g,h,i,j=this;for(j.name(a.name),c=k(a,"tableStyleElement"),f=function(a){var c=l(a.dxfId,0),f=a.type,g=l(a.size,1),h=new T,i=K[f||"wholeTable"];"function"==typeof j[i]&&void 0!==a.dxfId&&(b.getDxf(c,h,!0),e(R,function(a,b){b.indexOf("border")>=0&&h[b]===o&&(h[b]=new d.LineBorder)}),j[i](h,!1)),"firstRowStripe"!==f&&"secondRowStripe"!==f&&"firstColumnStripe"!==f&&"secondColumnStripe"!==f||j[f.substr(0,f.length-1)+"Size"](g,!1)},g=0,h=c;g<h.length;g++)i=h[g],f(i);b.addTableTheme(j)},a.prototype.bdK=function(a){var b,c,f=this,g=[],h={n_:"tableStyle",c_:g},i=f.builtInName();return i!==o&&i!==n?h.name="TableStyle"+i:(h.name=f.name(),b=0,e(C,function(e,h){if(c=f[h]()){var i=a.getDxfIndex(c);i!==n&&(b++,g.push({n_:"tableStyleElement",type:d.SJSStylePropsToStyleProps[h],dxfId:i}))}}),e(H,function(a,d){c=f[d](),c&&(b++,g.push({n_:"tableStyleElement",type:d.replace("Size","e"),size:c}))}),h.count=b,h.pivot=0),h},a}(),b.TableTheme=U,U.prototype.name=j(I),U.prototype.builtInName=j("builtInName"),e(C,function(a,b){U.prototype[b]=j(b)}),e(H,function(a,b){U.prototype[b]=j(b,1)}),V="white",W="black";function fa(a,b){return isNaN(b)?b:new d.LineBorder(a,b)}function ga(a,b,c,d,e,f,g,h,i,j){var k=new T;return b&&(k.backColor=b),c&&(k.foreColor=c),d&&(k.font=J),e&&(k.borderLeft=fa(a,e)),f&&(k.borderTop=fa(a,f)),g&&(k.borderRight=fa(a,g)),h&&(k.borderBottom=fa(a,h)),i&&(k.borderHorizontal=fa(a,i)),j&&(k.borderVertical=fa(a,j)),k}function ha(a){return 0===a?"Text 1":"Accent "+a}function ia(a){var b=ha(a),c=b+" 80",d=new U;return d[p](ga(b,0,b,1,0,0,0,1)),d[r](ga(b,0,b,0,0,1,0,1)),d[u](ga(b,c)),d[t](ga(b,0,b,1)),d[s](ga(b,0,b,1)),d[w](ga(b,c)),d[q](ga(b,0,b,1,0,1)),d}function ja(a){var b=ha(a),c=new U;return c[p](ga(b,b,V,1)),c[r](ga(b,0,0,0,1,1,1,1)),c[u](ga(b,0,0,0,0,1)),c[v](ga(b,0,0,0,0,1)),c[w](ga(b,0,0,0,1)),c[x](ga(b,0,0,0,1)),c[t](ga(b,0,0,1)),c[s](ga(b,0,0,1)),c[q](ga(b,0,0,1,0,6)),c}function ka(a){var b=ha(a),c=b+" 80",d=new U;return d[p](ga(b,0,0,1,0,0,0,2)),d[r](ga(b,0,0,0,1,1,1,1,1,1)),d[u](ga(b,c)),d[w](ga(b,c)),d[t](ga(b,0,0,1)),d[s](ga(b,0,0,1)),d[q](ga(b,0,0,1,0,6)),d}function la(a){var b=ha(a),c=b+" 20",d=b,e=b+" 80",f=new U;return f[p](ga(c,d,V,1)),f[r](ga(c,0,0,0,1,1,1,1,1)),f[u](ga(c,e)),f[w](ga(c,e)),f[t](ga(c,0,0,1)),f[s](ga(c,0,0,1)),f[q](ga(c,0,W,1,0,6)),f}function ma(a){var b=ha(a),c=V,d=b,e=b+" 60",f=b+" 80",g=new U;return g[p](ga(c,d,V,1,0,0,0,2,0,1)),g[r](ga(c,f,0,0,0,0,0,0,1,1)),g[u](ga(c,e)),g[w](ga(c,e)),g[t](ga(c,d,V,1)),g[s](ga(c,d,V,1)),g[q](ga(c,d,V,1,0,2,0,0,0,1)),g}function na(a){var b=ha(a),c="#D3D3D3",e=b,f=c,g=0===a?W:c,h=new U;return h[p](ga(W,e,V,1,0,2,0,2)),h[r](ga(g,0,0,0,1,new d.LineBorder(W,2),1,new d.LineBorder(W,2),0===a?1:0,1)),h[u](ga(g,f)),h[w](ga(g,f)),h[t](ga(g,e,V)),h[s](ga(g,e,V)),h[A](ga(g,e,V,1)),h[B](ga(g,e,V,1)),h[q](ga(W,0,W,0,0,6)),h}function oa(a){var b=ha(a),c=b,e=b+" 40",f=b+" 80",g=b+" 60",h=b+" 80",i=new U;return i[p](ga(e,f,W,1,1,1,1,1,0,1)),i[r](ga(e,f,0,0,1,1,1,1,1,1)),i[u](ga(e,g)),i[w](ga(e,g)),i[t](ga(e,0,0,1)),i[s](ga(e,0,0,1)),i[q](ga(e,h,W,1,1,new d.LineBorder(c,2),1,1,0,1)),i}function pa(a){var b=ha(a),c=W,d=0===a?b+" 25":b+" -25",e=0===a?b+" 50":b,f=0===a?b:b+" -50",g=new U;return g[p](ga(V,c,V,1,0,0,0,2)),g[r](ga(b,e,V)),g[u](ga(b,d)),g[w](ga(b,d)),g[t](ga(V,d,V,1,0,0,2)),g[s](ga(V,d,V,1,2)),g[q](ga(V,f,V,1,0,2)),g}function qa(a){var b,c,d,e,f,g;function h(a,b){if(a<0||a>3)return"";var c={tableBackground:["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"],stripColor:["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"],headerColor:["Text 1","Accent 2","Accent 4","Accent 6"]};return c[b][a]}return b=ha(a),c=h(a,"headerColor"),d=h(a,"stripColor"),e=h(a,"tableBackground"),f=e,g=new U,g[p](ga(b,c,V)),g[r](ga(b,e)),g[u](ga(b,d)),g[w](ga(b,d)),g[t](ga(b,0,0,1)),g[s](ga(b,0,0,1)),g[q](ga(W,f,0,1,0,6)),g}for(X=function(){function a(){}return a}(),b.TableThemes=X,Y=1;Y<=28;Y++)Z=Y-1,$=m(Z/7),Y<=21&&$>=0&&$<3&&(_=[ia,ja,ka][$](Z%7),aa="Light"+Y,_.name&&_.name(aa),_.builtInName&&_.builtInName(aa),X["light"+Y]=_),Y<=11&&$>=0&&$<2&&(_=[pa,qa][$](Z%7),ba="Dark"+Y,_.name(ba),_.builtInName(ba),X["dark"+Y]=_),$>=0&&$<4&&(_=[la,ma,na,oa][$](Z%7),ca="Medium"+Y,_.name(ca),_.builtInName(ca),X["medium"+Y]=_)},"./dist/plugins/table/table-util.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("SheetsCalc"),f=c("@grapecity/js-calc"),g=c("Common"),h=c("./dist/plugins/table/table.ns.js"),i=c("./dist/plugins/table/table.js"),j=d.Ul.Ol,k=null,l=void 0,m=Math.max,n=g.Common.j.Fa,o=0,p=new g.Common.ResourceManager(h.SR,"Tables"),q=p.getResource.bind(p);function r(a){throw Error(a)}function s(a,b,c,d,e){!d&&e&&(d=F(a,e,b,c)),f&&a._u(b,c,d,e)}function t(a,b,c,d){a.setValue(b,c,d)}function u(a){a.suspendPaint()}function v(a){a.resumePaint()}function w(a){return a.Cf().ih()}function x(a){f&&a.suspendCalcService()}function y(a,b){f&&a.resumeCalcService(b)}function z(a){a&&(u(a),a.suspendEvent(),x(a))}function A(a){a&&(y(a),a.resumeEvent(),v(a))}function B(a){return a.rowCount}function C(a){return a.colCount}function D(a){return a&&!(/\d/.test(a[0])||/[\s\+\-\*\\:%!\[\]]/.test(a)||["C","c","R","r"].indexOf(a)!==-1||/^[A-Za-z]{1,3}(\$)?\d+$/.test(a)||/^[Rr]\d*[Cc]\d*$/.test(a)||a.length>=255)}function E(a,b,c,d,e){var f,g=a.yj();return g.WLb=e,f=a.Wu.parse(g,b,c,d,!1,!1,!1),delete g.WLb,f}function F(a,b,c,d,e){return e=e===l||e,a.Wu.unparse(a.yj(),b,c,d,!1,e)}function G(a){var b,c,d,e;return!!a&&(D(a)||r(q().Exp_TableNameInvalid),b=this,c=b.name(),d=b.tc,a!==c&&(!d||(e=d.findByName(a),!e||b===e)))}function H(a,b,c,d,e){var f,g,h,i;for(f=c;f>=b;f--)for(h=d;h<=e;h++){if(g=a.Iq(f,h),K(g))return f;if(J(a,f,h))return f;if(i=a.ITa.findSpan(f,h))return i.row+i.rowCount-1}return-1}function I(a,b,c,d,e){var f,g,h,i;for(g=e;g>=d;g--)for(f=b;f<=c;f++){if(h=a.Iq(f,g),K(h))return g;if(J(a,f,g))return g;if(i=a.ITa.findSpan(f,g))return i.col+i.colCount-1}return-1}function J(a,b,c){var d=a.getValue(b,c),e,f;return!(d===k||!j(d))||(!!(e=a.getSparkline&&a.getSparkline(b,c))||(f=a.Iq(b,c),K(f)))}function K(a){return!(!a||!(a.backColor||a.backgroundImage||a.borderBottom||a.borderLeft||a.borderRight||a.borderTop||a.cellType||a.diagonalDown||a.diagonalUp))}function L(a,b,c,d,e,f,g,h){return a>=e&&!(b===g&&b+d-1===h)&&(b<g&&b+d>=g||b>=g&&b<=h&&b+d-1>h)}function M(a,b,c,d,e,f,g,h){return b>=g&&!(a===e&&a+c-1===f)&&(a<e&&a+c>=e||a>=e&&a<=f&&a+c-1>f)}function N(a,b,c){return{col:b,leadingCellRow:c,row:a}}function O(a,b,c){var d=k,e=b.cj,f=b.endRow();for(c&&(f-=b.NZ?1:0);f>=e&&a.getRowHeight(f)<=0;)f--;return f>=e&&(d=f),d}function P(a,b){for(var c=k,d=b.dj,e=b.endColumn();e>=d&&a.getColumnWidth(e)<=0;)e--;return e>=d&&(c=e),c}function Q(a){var b,c,d,e,f=a.ITa,g=f.XTa(3).dataTable,h=f.getLastNonNullRow(3,!0),i=a.getRowCount(),j=a.getColumnCount(),k=-1;for(d=i-1;d>-1;d--)if(b=g[d])for(e=0;e<j;e++)if(c=b[e],c&&!n(c.value))return m(d,h);return m(k,h)}function R(a,b){var c,e,f,g=b.tc,h=b.cj,i=b.Xj,j=h+i-1,k=b.dj,l=k+b.OZ-1,n=Q(a),o=g?g.SMb():-1;return n=m(n,o),c=j,n>j&&(e=j+1,f=new d.Range(e,k,n-j,l-k+1),c=m(H(a,e,n,k,l),g.SMb(f))),c}function S(a){var b,c,d,e,f=a.ITa,g=f.XTa(3).dataTable,h=f.getLastNonNullCol(3,!0),i=a.getRowCount(),j=a.getColumnCount(),k=-1;for(d=j-1;d>-1;d--)for(e=0;e<i;e++)if(b=g[e],c=b&&b[d],c&&!n(c.value))return m(d,h);return m(k,h)}function T(a,b){var c,e,f,g=b.tc,h=b.cj,i=h+b.Xj-1,j=b.dj,k=b.OZ,l=j+k-1,n=S(a),o=g?g.TMb():-1;return n=m(n,o),c=l,n>l&&(e=l+1,f=new d.Range(h,e,i-h+1,n-l),c=m(I(a,h,i,e,n),g.TMb(f))),c}function U(a,b,c,d,e,f,g,h,i,j){var k,l,m=a.getRowCount()-1,n=a.getColumnCount()-1,o=a.ITa.getSpans(),p=b.tc&&b.tc.l$;return!h&&(!i&&m-d<g||i&&n-f<g)?(j||r(q().Exp_TableAddRowNoEnoughRoom),!0):(k=i?M:L,l=o.some(function(a){var b=a.row,g=a.col,h=a.rowCount,i=a.colCount;return k(b,g,h,i,c,d,e,f)}),l?j||r(q().Exp_TableAddRowIntersectSpan):p&&(l=p.some(function(a){var b=a.cj,g=a.dj,h=a.Xj,i=a.OZ;return k(b,g,h,i,c,d,e,f)}),l&&!j&&r(q().Exp_TableAddRowIntersectTable)),l)}function V(a,b,c){var e,f,g,h=b.row,i=b.col,j=h+b.rowCount,k=i+b.colCount;for(e=h;e<j;e++)for(f=i;f<k;f++)if(g=a.getCell(e,f),g.value()||a.ITa.findSpan(e,f)){if(c&&c.equals(new d.Range(g.row,g.col,1,1)))continue;return new d.Range(e,f,1,1)}return l}function W(a,b,c,d,e,f,g){var h,i,j;for(h=b;h<=c;h++)for(i=d;i<=e;i++)if(j=a.tq(h,i,"locked"),f&&!j||g&&j)return!1;return!0}function X(a,b,c,d,e,f,g){var h,j,l,m,n,o,p,q,r,s;if(e){if(!f&&!g)return k;if(h=a.kj,j=0,l=0,a.NZ&&(j=1),a.MZ&&(l=1),b===i.TableSelectionType.TABLE_ROW_SELECT){if(!W(h,c,c,a.dj,a.endColumn(),f,g))return k;
}else if(b===i.TableSelectionType.TABLE_COL_SELECT){for(m=h.getSelections(),n=!0,o=0,p=m;o<p.length;o++)if(q=p[o],q.col===d&&q.row===a.cj+l&&1===q.colCount&&q.rowCount===a.Xj-l-j){if(!W(h,a.cj,a.endRow(),d,d,f,g))return k;n=!1}if(n&&!W(h,a.cj+l,a.endRow()-j,d,d,f,g))return k}else if(b===i.TableSelectionType.TABLE_CORNER_SELECT){for(m=h.getSelections(),n=!0,r=0,s=m;r<s.length;r++)if(q=s[r],q.col===a.dj&&q.row===a.cj+l&&q.colCount===a.OZ&&q.rowCount===a.Xj-l-j){if(!W(h,a.cj,a.endRow(),a.dj,a.endColumn(),f,g))return k;n=!1}if(n&&!W(h,a.cj+l,a.endRow()-j,a.dj,a.endColumn(),f,g))return k}else if(b===i.TableSelectionType.TABLE_SELECT&&!W(h,a.cj,a.endRow(),a.dj,a.endColumn(),f,g))return k}return{action:b,table:a}}function Y(a,b){var c=a.cj;return b-(a.MZ?c+1:c)}function Z(a,b){var c=a.dj;return b-c}function $(a){var b=o;return a&&o++,b}function _(a){return"string"==typeof a}function aa(a,b,c,e){var f={sheet:a,table:b,oldRange:c,newRange:e};a.Wq(d.Events.TableResizing,f)}function ba(a,b,c,e){var f={sheet:a,table:b,oldRange:c,newRange:e};a.Wq(d.Events.TableResized,f)}function ca(a,b,c,e,f,g,h){var i={sheet:a,table:b,propertyName:c,row:Y(b,e),count:f};n(g)||(i.isAfter=g),h&&(i.deletedItem=h),a.Wq(d.Events.TableRowsChanged,i)}function da(a,b,c,e,f,g){var h={sheet:a,table:b,propertyName:c,col:e-b.dj,count:f};n(g)||(h.isAfter=g),a.Wq(d.Events.TableColumnsChanged,h)}function ea(a,b,c){var d=0;if(a.VZ(b,c))for(d=2;a.VZ(b+d,d);)d++;return d>0&&(b+=d),b}function fa(a){return a&&"="===a[0]}function ga(a){var b,c,d,f=-1;if(a)for(b=a.arguments,c=void 0,d=0;d<b.length;d++)if(c=b[d],c instanceof e.xzb){f=d;break}return f}function ha(a,b,c){var d=a.dataRange(),e=d.row,f=d.col,g=c?e:f;return g+b}function ia(a){var b=a;return a&&"="===a[0]&&(b=a.slice(1)),b}function ja(a,b){var c,d;for(d=0;d<a.length;d++)if(c=a[d],c&&b===c.col)return c;return k}function ka(a,b){var c,d,e;if(!b)return null;for(c=b.row;c<b.row+b.rowCount;c++)for(d=b.col;d<b.col+b.colCount;d++)if(a.tables&&(e=a.tables.find(c,d)))return e;return null}function la(a,b){return b?a.tables.s$(b.row,b.col,b.rowCount,b.colCount):null}function ma(a){return n(a)||("string"!=typeof a&&(a+=""),a=a.replace(/\r\n?/g,"\n")),a}function na(a){return a===l}b.Util={throwError:r,setFormulaToSheet:s,setValue:t,suspendPaint:u,resumePaint:v,ih:w,suspendCalcService:x,resumeCalcService:y,UMb:z,VMb:A,getRowCount:B,getColCount:C,isValidTableName:D,formulaToExpression:E,expressionToFormula:F,checkTableName:G,WMb:N,qMb:O,rMb:P,XMb:R,YMb:T,ZMb:U,$Mb:V,_Mb:X,aNb:Y,bNb:Z,cNb:$,dNb:_,sMb:aa,bMb:ba,UIb:ca,VIb:da,eNb:ea,bW:fa,fNb:ga,gNb:ha,hNb:ia,iNb:ja,_getTable:ka,Pda:la,jNb:ma,kNb:na}},"./dist/plugins/table/table.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),c("./dist/plugins/table/table.interface.js"),c("./dist/plugins/table/table-event.js"),c("./dist/plugins/table/table-render.js"),c("./dist/plugins/table/table-action.js"),c("./dist/plugins/table/table-util.js"),d(c("./dist/plugins/table/table-theme.js")),d(c("./dist/plugins/table/table.js")),d(c("./dist/plugins/table/table.ns.js"))},"./dist/plugins/table/table.interface.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0})},"./dist/plugins/table/table.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib,Jb,Kb,Lb,Mb,Nb,Ob,Pb,Qb,Rb,Sb,Tb,Ub,Vb,Wb,Xb,Yb,Zb,$b,_b,ac,bc,cc=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),dc=this&&this.__assign||function(){return dc=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},dc.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("SheetsCalc"),f=c("Common"),g=c("@grapecity/js-calc"),h=c("Filters"),i=c("Bindings"),j=c("./dist/plugins/table/table.ns.js"),k=c("./dist/plugins/table/table-theme.js"),l=c("./dist/plugins/table/table-util.js"),m=d.Ul.Pl,n=d.Ul.Ol,o=d.Ul.bc,p=d.GC$.inArray,q=d.GC$.each,r=d.GC$.isEmptyObject,s=f.Common.j.Fa,t=f.Common.l,u=f.Common.k.Bb,v=f.Common.D,w=d.Ul.JcK,x=d.Ul.McK,y=d.Ul.LcK,z=d.NodeHelper.pca,A=d.NodeHelper.oca,B=d.Ul.oaa,C=d.Ul.naa,D=d.Util.Sha,E=d.Util.Tja,F=d.Util.WaK,G=d.Util.addXLFNPrefix,H=d.Util.XaK,I=d.Util.ZaK,J=d.Util.NhK,K=d.Util.OhK,L=l.Util.throwError,M=l.Util.setFormulaToSheet,N=l.Util.setValue,O=l.Util.suspendPaint,P=l.Util.resumePaint,Q=l.Util.ih,R=l.Util.suspendCalcService,S=l.Util.resumeCalcService,T=l.Util.getRowCount,U=l.Util.getColCount,V=l.Util.checkTableName,W=l.Util.isValidTableName,X=l.Util.formulaToExpression,Y=l.Util.expressionToFormula,Z=l.Util.WMb,$=l.Util.qMb,_=l.Util.rMb,aa=l.Util.XMb,ba=l.Util.YMb,ca=l.Util.ZMb,da=l.Util.$Mb,ea=l.Util._Mb,fa=l.Util.aNb,ga=l.Util.bNb,ha=l.Util.cNb,ia=l.Util.dNb,ja=l.Util.UMb,ka=l.Util.VMb,la=l.Util.UIb,ma=l.Util.VIb,na=l.Util.eNb,oa=l.Util.bW,pa=l.Util.fNb,qa=l.Util.gNb,ra=l.Util.hNb,sa=l.Util.iNb,ta=l.Util.Pda,ua=l.Util.jNb,va=l.Util.kNb,wa=d.range_parser.getRangeString,xa=d.range_parser.CcK,ya=d.range_parser.EcK,za=null,Aa=void 0,Ba=Math.min,Ca=Math.ceil,Da=Math.max,Ea=JSON.stringify,Fa=JSON.parse,Ga="name",Ha="cellType",Ia="value",Ja="formatter",Ka="highlightFirstColumn",La="highlightLastColumn",Ma="bandRows",Na="bandColumns",Oa="autoGenerateColumns",Pa="headerRowStyle",Qa="footerRowStyle",Ra="wholeTableStyle",Sa="highlightLastColumnStyle",Ta="highlightFirstColumnStyle",Ua="firstRowStripStyle",Va="secondRowStripStyle",Wa="firstColumnStripStyle",Xa="secondColumnStripStyle",Ya="firstHeaderCellStyle",Za="lastHeaderCellStyle",$a="firstFooterCellStyle",_a="lastFooterCellStyle",ab="firstRowStripSize",bb="secondRowStripSize",cb="firstColumnStripSize",db="secondColumnStripSize",eb=".table",fb="Column",gb="id",hb="dataField",ib="footerFormula",jb="dataAreaFormulaStr",kb="isArrayFormula",lb="dataAreaFormula",mb="footerValue",nb="footerRowStyles",ob=[gb,Ga,Ha,Ia,Ja,hb,ib,lb,mb],pb=4,qb=2,rb="table",sb="tableResize",tb="#485DB1",ub="tableInsertRows",vb="DoInsertRows",wb="tableShowFooter",xb="tableDeleteRows",yb="tableInsertColumns",zb="tableDeleteColumns",Ab="collection",Bb="tableColumn",Cb="property",Db="dataSource",Eb="rowsChange",Fb="showFooter",Gb="range",Hb="columns",Ib="tableExpression",Jb="sheetExpression",Kb="number",Lb="string",Mb="custom",Nb=d.XFileConstants.bbK,Ob=d.XFileConstants.LbK,Pb=new f.Common.ResourceManager(j.SR,"Tables"),Qb=Pb.getResource.bind(Pb),Rb=d.UsedRangeUtil.RZJ,Sb=d.UsedRangeUtil.SZJ,Tb={backColor:0,foreColor:0,borderBottom:1,borderLeft:1,borderRight:1,borderTop:1,font:0,textDecoration:0},function(a){a.TABLE_ROW_SELECT="tableRowSelect",a.TABLE_COL_SELECT="tableColSelect",a.TABLE_CORNER_SELECT="tableCornerSelect",a.TABLE_SELECT="tableSelect"}(Ub=b.TableSelectionType||(b.TableSelectionType={})),function(a){a[a.deleted=0]="deleted",a[a.dirty=1]="dirty"}(Vb||(Vb={}));function ec(a,b){return!(!a||!b||a.color!==b.color||a.type!==b.type)||!a&&!b}function fc(a,b){var c,d,e=!1;if(s(a[b]))e=!0;else for(d=a.length-1;d>b;d--)if(c=d-1,s(a[c])){e=!0;break}return e}function gc(a,b,c){var d=a.parent,f=Q(a);function g(b,d){q(b,function(b,g){var h=g.getExpression(),i=e.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(h,d,-1,-1,c);i!==h&&(g.fg(i),f.invalidName(a.yj(),g.getName()))})}d?(g(d.getCustomNames(),b),q(d.sheets,function(a,c){g(c.getCustomNames(),b)})):g(a.getCustomNames(),b),f.onAfterRemoveTable(b,c)}function hc(a,b){var c={position:d.ButtonPosition.right,imageType:d.ButtonImageType.dropdown,visibility:d.ButtonVisibility.onSelected,useButtonStyle:!1,command:"openList"},e=[{text:Qb().Table_None,value:null},{text:Qb().Table_Average,value:"=SUBTOTAL(101,["+b+"])"},{text:Qb().Table_Count,value:"=SUBTOTAL(103,["+b+"])"},{text:Qb().Table_Count_Numbers,value:"=SUBTOTAL(102,["+b+"])"},{text:Qb().Table_Max,value:"=SUBTOTAL(104,["+b+"])"},{text:Qb().Table_Min,value:"=SUBTOTAL(105,["+b+"])"},{text:Qb().Table_Sum,value:"=SUBTOTAL(109,["+b+"])"},{text:Qb().Table_StdDev,value:"=SUBTOTAL(107,["+b+"])"},{text:Qb().Table_Var,value:"=SUBTOTAL(110,["+b+"])"}],f={items:e},g=new d.Style;return g.cellButtons=[c],g.dropDowns=[{type:d.DropDownType.list,option:f,submitCommand:"tableTotalRowFormula"}],g}function ic(a){var b=a.tables;b.all().forEach(function(a){a.formulaFromJSON()})}d.Worksheet.$n(rb,{priority:2e3,getUsedRange:function(a){var b,c,e;a.type&d.UsedRangeType.table&&(b=this,c=b.tables,e=c.getUsedRange(),Sb(a.range,e))},init:function(){var a=this;a.tables=a.ITa.noa,a.unbind(eb),a.bind(d.Events.BeforeDragDrop+eb,function(b,c){var d,e=a,f=a.tables,g=Qb().Exp_DragDropChangePartOfTable,h=c.fromRow,i=c.fromColumn,j=T(c),k=c.columnCount,l=e.mm.gA,m=l.row,n=l.col,o=c.isDragInsert,p=c.isDragCopy,q=za;!o||h!==-1&&i!==-1||(i>=0?(a.isDragCopy&&(n<=i||n>=i+k)||!p&&(n<i||n>i+k))&&(d=!1,f.HZ(-1,n,-1,1)&&(d=!0,q=Qb().Exp_DragDropShiftTableCell),d||p||!f.HZ(-1,i,-1,k)||(q=g)):h>=0&&i<0&&(p&&(m<=h||m>=h+j)||!p&&(m<h||m>h+j))&&!p&&f.HZ(h,-1,j,-1)&&(q=g)),c.invalidMessage=q}),a.bind(d.Events.RowChanged+eb,function(b,c){var d=a.tables,e=d.$m,f=c.propertyName;"isVisible"===f?(c.newValue===!1?e[c.row]=0:e[c.row]=Aa,d.lNb(c.row)):"height"===f&&(e[c.row]=Aa,d.lNb(c.row))}),a.bind(d.Events.RowHeightChanged+eb,function(b,c){var d,e,f,g,h,i=a.tables,j=i.$m;for(d=0,e=c.rowList;d<e.length;d++)f=e[d],j[f]=Aa,g=c.sheet,h=g.getRowHeight(f),i.lNb(f,h>0)}),a.bind(d.Events.ColumnChanged+eb,function(b,c){var d=a.tables,e=d.an;"isVisible"===c.propertyName?(c.newValue===!1?e[c.col]=0:e[c.col]=Aa,d.mNb(c.col)):"width"===c.propertyName&&(e[c.col]=Aa,d.mNb(c.col))}),a.bind(d.Events.ColumnWidthChanged+eb,function(b,c){var d,e,f,g=a.tables,h=g.an;for(d=0,e=c.colList;d<e.length;d++)f=e[d],h[f]=Aa,g.mNb(f)}),a.bind(d.Events.RangeFiltered+eb,function(b,c){var d,e=a.tables,f=e.$m,g=c.sheet.xr.range;for(d=0;d<g.rowCount;d++)f[g.row+d]=Aa,e.lNb(g.row+d)}),a.bind(d.Events.TableFiltered+eb,function(b,c){var d,e=a.tables,f=e.$m,g=c.table.range();for(d=0;d<g.rowCount;d++)f[g.row+d]=Aa,e.lNb(g.row+d)}),a.bind(d.Events.TableFilterCleared+eb,function(b,c){var d=a.tables;d.Nm()}),a.t4&&a.bind(d.Events.RangeChanged+eb,function(b,c){var d,e,f=c.changedCells;if(f)for(d=0;d<f.length;d++)e=f[d],a.t4(e.row,e.col,1,1,e.sheetArea)})},resetBinding:function(a){this.tables.IZ()},initBinding:function(a){var b,c,d,e,f=this,g=f.tables;for(g.IZ(),R(f),b=g.all(),c=0,d=b.length;c<d;c++)e=b[c],e&&e.JZ();S(f)},dispose:function(a){a.clearCache!==!1&&(this.unbind(eb),this.tables&&(this.tables.no(),this.tables=null))},clearPendingChanges:function(){var a=this.tables;a&&a.Hfc()},onGroupChanged:function(a){var b,c,d=this,e=d.tables;if(a.fromSetCollapsed)for(b=a.isRow?e.$m:e.an,c=a.start;c<=a.end;c++)b[c]=Aa,a.isRow?e.lNb(c):e.mNb(c)},onLayoutChanged:function(a){var b,c=this,d=a.changeType,e=a.row,f=a.rowCount,g=a.col,h=a.colCount,i=c.tables;"addRows"===d?(i.rI(e,f),i.Nm()):"addRows2"===d?i.KZ(e,f):"deleteRows"===d?(i.GR(e,f),i.Nm()):"addColumns"===d?(i.tI(g,h),i.Nm()):"deleteColumns"===d?(i.HR(g,h),i.Nm()):"addColumns2"===d||"deleteColumns2"===d?i.nNb(g):"clear"===d?(b=a.sheetArea,a.ignoreTable||3!==b&&!s(b)||i.$b(e,g,f,h,a.type)):"setRowCount"===d?i.Nm():"setColumnCount"===d&&i.Nm()},toJson:function(a,b){var c,d,e,f,g;function h(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=a.tables.all();for(c=0,d=p.length;c<d;c++)if(e=p[c],f=e.LZ(),g=e.dataRange(),h=g.row,i=g.col,j=h+T(g)-1,k=i+U(g)-1,f)for(l=h;l<=j;l++)for(m=i;m<=k;m++)n=e.ge(l,m),n.gt&&(o=n.Qb,t.Ska(o)&&(o=t.Daa(o)),a.qI(b,l,m,o))}c=this,d=c.tables,e=b&&b.ignoreStyle,f=b&&b.newWorkSheetName,e||(d&&(a.tables=d.toJSON(f,b)),b&&b.includeBindingSource&&(g=a.data,g.dataTable=g.dataTable||{},h(c,g.dataTable)))},bdK:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.tables,u=c&&c.includeStyles===!1;if(s&&!u&&(s.bdK(a),c&&c.includeBindingSource))for(d=s.all(),e=0,f=d.length;e<f;e++)if(g=d[e],h=g.LZ(),i=g.dataRange(),j=i.row,k=i.col,l=j+T(i)-1,m=k+U(i)-1,h)for(n=j;n<=l;n++)for(o=k;o<=m;o++)p=g.ge(n,o),p.gt&&(q=p.Qb,t.Ska(q)&&(q=t.Daa(q)),r._dK(a,n,o,q,b.sharedStrings))},fromJson:function(a,b,c){var d=this,e=d.tables,f=a.tableManager,g=b?f&&f.tables:a.tables,h=c&&c.ignoreStyle;n(g)&&!h&&e&&e.fromJSON(g,b,a.isApplyRefilter)},fromJsonAfterFormula:function(a,b,c){ic(this)},fromJsonAfterSJSFormula:function(a){ic(this)},cdK:function(a,b,c){var d=this,e=c&&c.includeStyles===!1,f=d.tables,g=w(a,Ob),h=a.rels;n(g)&&n(h)&&!e&&f&&f.cdK(g,h,b,c)},lastNonNullRowAndCol:function(){var a,b,c,d,e,f,g=this,h=g.tables,i=0,j=0,k=h.all();if(k)for(a=0,b=k.length;a<b;a++)c=k[a],c&&(d=c.range(),e=d.row+T(d)-1,f=d.col+U(d)-1,e>i&&(i=e),f>j&&(j=f));return{lastNonNullRow:i,lastNonNullCol:j}},paintCell:function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this;a.isPrinting||a.sheetArea!==d.SheetArea.viewport||t.options.isProtected||(b=t.tables,c=a.ctx,e=a.cell,f=e.row,g=e.col,h=b.find(f,g),h&&h.showResizeHandle()&&!h.qJb()&&(i=$(t,h),j=_(t,h),f===i&&g===j&&(k=e.x,l=e.y,m=e.width,n=e.height,o=t.zoom(),p=Ca(pb*o),q=Ca(qb*o),r=k+m,s=l+n,c&&m>0&&n>0&&(c.save(),c.rect(k,l,m,n),c.clip(),c.fillStyle=tb,c.beginPath(),c.moveTo(r-p,s),c.lineTo(r,s),c.lineTo(r,s-q),c.lineTo(r-p,s-q),c.fill(),c.beginPath(),c.moveTo(r,s-q),c.lineTo(r-q,s-q),c.lineTo(r-q,s-p),c.lineTo(r,s-p),c.fill(),c.restore()))))},composeTableFooterList:function(a){var b=a.table,c=a.row,d=a.col,e=a.style;b.oNb(c,d,e)},refSheetLazyLoaded:function(a,c,e){var f,g,h,i=this,j=i.tables.all();j.length>0&&b.MAb&&(f=a.rels.c_.filter(function(a){return a.Type===d.RelationshipConstants.B7}).map(function(a){return d.Util.LhK(a.Target)}),g=c.tables,h={},d.GC$.each(f,function(a,b){var c=g[b];c&&(h[c.name]=c)}),d.GC$.each(j,function(a,d){var f,g,i,j=h[d.name()];j&&(f=w(j,"autoFilter"),g=w(j,"sortState"),i=d.xr||new b.MAb,nc(d,i,f,g,c.styleManager),e.isApplyRefilter&&d.xr.reFilter())}))}}),d.Worksheet.prototype.UIb=function(a,b,c,d,e,f){var g=f?Aa:a.xKb();la(this,a,b,c,d,e,g)},d.Worksheet.prototype.VIb=function(a,b,c,d,e){ma(this,a,b,c,d,e)},d.Workbook.prototype.jga=function(a){var b,c,d,e=this.sheets;if(e)for(d=0;d<e.length;d++)if(c=e[d].tables,c&&(b=c.findByName(a)))return b;return za};function jc(a,b,c){var e,f,g,h;if(a&&a.length>0&&(e=a[b]))return f=e.cellType(),g=e.formatter(),h=c,f&&(h||(h=new d.Style),h.cellType=f),g&&(h||(h=new d.Style),h.formatter=g),h}function kc(a){var b,c,d,e=a.c_[0],f=e&&e.c_[0];if(f)return b={N9:{altText:f.altText,altTextSummary:f.altTextSummary}},c=e["xmlns:x14"],d={N9:{uri:e.uri}},d["x14:table"]=b,d.N9["xmlns:x14"]=c,{ext:d,attr:{}}}function lc(a){if(a&&a.c_)return kc(a)}function mc(a,b,c,d,e,f,g){var h,i,j,k,l,m;if(a.ITa&&(h=a.ITa.sheetModels[3].RTa(b,c),i=h&&h.style,i&&f&&"string"==typeof i)){if(e[i])return void(h.style=e[i]);if(j=f.Mq(i),!j)return;j=j.clone(!0);for(k in Tb)Tb.hasOwnProperty(k)&&(s(j[k])||(l=Tb[k],0===l?j[k]===d[k]&&(j[k]=Aa):1===l&&ec(j[k],d[k])&&(j[k]=Aa)));m=g.cmK+g.emK+i,g.emK++,j.name=m,f.Kq(j),h.style=m,e[i]=m}}function nc(a,b,c,d,e,f){b&&(b.table(a),c=c||{lossless:{}},c&&(c.lossless||(c.lossless={}),a.showHeader()===!1&&(c.lossless.showTableHeader=!1),c.ref||(c.lossless.showFilterButton=!1),c.lossless.range={row:a.cj+1,col:a.dj,rowCount:a.Xj-1-(a.showFooter()?1:0),colCount:a.OZ},b.cdK(c,d,e)),a.xr!==b&&(a.xr=b),f?a.xr.reFilter():(a.NVJ=!0,a.zWJ()))}function oc(){var a=0;return function(){return a++,a}}Wb=oc();function pc(a,b){var c=a;return typeof b[a]===Kb?(b[a]++,c+="_"+b[c]):b[a]=0,c}Xb=function(){function a(a,b,c,d,e,f,g){var h,i=this;for(i.MZ=!g||g.showHeader===Aa||g.showHeader,i.NZ=!(!g||g.showFooter===Aa)&&g.showFooter,i.pNb=!(!g||g.useFooterDropDownList===Aa)&&g.useFooterDropDownList,i.qNb=!(!g||g.showResizeHandle===Aa)&&g.showResizeHandle,i.rNb=[],i.wq=za,i.xr=za,i.tc=za,i.Sgc=!1,n(a)&&i.name(a),i.cj=n(b)?b:-1,i.dj=n(c)?c:-1,i.Xj=n(d)?d:-1,i.OZ=n(e)?e:-1,n(f)&&i.style(f),i.Nz=[],h=0;h<i.OZ;h++)i.Nz.push(new _b(h+1));i.ZX=za,i.LAb={},i.sNb=[],i.Ts=[],i.tNb=[],i.lfc=[],i.uNb=[],i.vNb=[],i.wNb=!0}return a.prototype.no=function(){var a=this;a.Nz=[],a.rNb=[],a.Ts=[],a.tNb=[],a.lfc=[],a.LAb={},a.sNb=[],a.kj=za,a.tc=za,a.xr&&(a.xr.no(),a.xr=za),a.Nm()},a.prototype.Nm=function(){this.uNb=[],this.vNb=[]},a.prototype.range=function(){var a=this;return d.kf(a.cj,a.dj,a.Xj,a.OZ)},a.prototype.dataRange=function(){var a=this,b=a.MZ?a.cj+1:a.cj,c=a.MZ?a.Xj-1:a.Xj;return a.NZ&&c--,d.kf(b,a.dj,c,a.OZ)},a.prototype.headerIndex=function(){return this.MZ?this.cj:-1},a.prototype.footerIndex=function(){return this.NZ?this.cj+this.Xj-1:-1},a.prototype.showHeader=function(a){var b,c=this;return 0===arguments.length?c.MZ:(c.MZ!==a&&(b=c.kj,b&&b.suspendPaint(),c.qVa(a),b&&b.resumePaint()),c)},a.prototype.qVa=function(a){var b,c,d=this,e=d.kj;e&&e.ITa.pVa(d,"showHeader",d.MZ,a),b=d.MZ=a,b?(d.cj>0&&(d.cj=d.cj-1,d.Xj+=1),d.PZ()):(c=d.cj,d.cj=d.cj+1,d.Xj-=1,d.QZ(c),d.RZ()),e&&g&&e.recalcRange(d.cj+(a?0:-1),d.dj,1,d.OZ)},a.prototype.showFooter=function(a,b){var c,d=this;if(0===arguments.length)return d.NZ;if(d.NZ!==a){c=d.kj,c&&c.suspendPaint();try{d.rVa(a,!!b&&b)}finally{c&&c.resumePaint()}}return d},a.prototype.expandBoundRows=function(a){var b=this;return 0===arguments.length?b.Sgc:(b.Sgc!==a&&(b.Sgc=a),b)},a.prototype.rVa=function(a,b){var c,d,e,f,h,i,j,k,l,m,n,o=this,p=o.kj;if(p&&p.ITa.pVa(o,Fb,o.NZ,a),c=o.Xj,a){if((!p||o.cj+c<p.getRowCount())&&(!b||o.xNb(!0,c)))for(o.NZ=a,o.Xj+=1,d=o.Nz,e=d.length,f=o.footerIndex(),h=o.dj,i=0;i<e;i++)j=d[i],k=j&&j.footerFormula(),l=h+i,k&&(m=Y(p,k,f,l),m&&(k=X(p,m,f,l),j.footerFormula(k)));o.SZ()}else o.NZ=a,n=o.cj+c-1,o.Xj-=1,o.QZ(n),o.NAb(),o.LNb(0),b&&o.xNb(!1,c);p&&g&&p.recalcRange(o.cj+o.Xj+(a?-1:0),o.dj,1,o.OZ)},a.prototype.xNb=function(a,b){var c,e=this,f=e.kj,g=e.cj+b,h=e.dj,i=e.OZ,j=h+i-1,k=aa(f,e),l=k>=g,m=da(f,new d.Range(g,h,k-g+1,j-h+1)),n=m&&m.row,o=n===g;return(!o||!ca(f,e,g,k,h,j,1))&&(o&&l&&(c=a?g+1:g-1,f.moveTo(g,h,c,h,k-g+1,i,2047)),!0)},a.prototype.yNb=function(a){var b,c,d,e,f=this,g=f.Nz,h=g.length,i=f.dj,j=[],k=f.name();for(b=0;b<h;b++)c=i+b,d=f.getColumnName(b),j.push(hc(k,d)),a||(0===b?f.j$(c,Qb().Table_Total,!0):b===h-1&&(e=g[b].footerFormula(),e||(f.zNb(c)?f.i$(b,"=SUBTOTAL(109,"+k+"["+d+"])"):f.i$(b,"=SUBTOTAL(103,"+k+"["+d+"])"))));f.rNb=j},a.prototype.zNb=function(a){var b,c,d=this,e=d.kj,f=d.dataRange(),g=!0,h=f.rowCount,i=f.row;for(b=0;b<h;b++)if(c=e.getValue(i+b,a),!s(c)&&typeof c!==Kb){g=!1;break}return g},a.prototype.ANb=function(){return this.rNb&&this.rNb.length>0},a.prototype.BNb=function(a,b,c){var d=this,e=this.kj;d.ANb()&&(e&&e.ITa.pVa(d,nb,d.CNb(),c),b>=0&&(c?d.rNb.splice(a,b,c):d.rNb.splice(a,b)))},a.prototype.CNb=function(){var a=this,b=a.rNb,c=[];return b.forEach(function(a){a&&c.push(a.clone())}),c},a.prototype.DNb=function(a,b,c){var d=this,e=n(c)?hc(d.name(),c):za;d.ANb()&&d.BNb(a,b,e)},a.prototype.useFooterDropDownList=function(a){var b=this,c=b.kj;return 0===arguments.length?b.pNb:(c&&(c.suspendPaint(),b.pNb!==a&&(c.ITa.pVa(b,"useFooterDropDownList",b.pNb,a),b.pNb=a,b.pNb&&!b.ANb()&&(b.yNb(),b.e$())),c.resumePaint()),b)},a.prototype.showResizeHandle=function(a){var b=this,c=b.kj;return 0===arguments.length?b.qNb:(c&&(c.suspendPaint(),b.qNb!==a&&(c.ITa.pVa(b,"showResizeHandle",b.qNb,a),b.qNb=a),c.resumePaint()),b)},a.prototype.rowFilter=function(){var a=this;return!a.xr&&b.MAb&&(a.xr=new b.MAb(a),a.xr.EZ(a.dataRange())),a.xr},a.prototype.bindColumns=function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=[];if(a)for(b=a.length,l.autoGenerateColumns||(b=Ba(l.OZ,a.length)),c=0;c<b;c++)d=l.Nz[c],d||(d=new _b(l.TZ()),l.Nz[c]=d),e=a[c],f=e.id(),g=e.name(),h=e.dataField(),i=e.value(),j=na(l,g,c),d.id(f),d.name(j),d.dataField(h),d.value(i),d.cellType(e.cellType()),d.formatter(e.formatter()),k={name:j,value:i,dataField:h},h&&m.push(k),l.DNb(c,1,j);l.ENb=m,l.wq&&(l.wq.qia=m)},a.prototype.bindingPath=function(a){var b=this;return 0===arguments.length?b.UZ:(b.UZ=a,b.JZ(),b)},a.prototype.bind=function(a,b,c){var d=this,e=c;return s(a)||d.bindColumns(a),s(c)&&(e=d.LZ()),b&&(d.UZ=b,e=i.LL(e,b)),i.qL&&e&&d.FNb(e),d},a.prototype.getColumnName=function(a){var b,c,d=this.Nz;return d&&0<=a&&a<d.length&&(b=d[a])?(c=b.name(),c!==za&&(c=o(c)),c):za},a.prototype.setColumnName=function(a,b){var c,d,e,f,g=this;return g.VZ(b)?g:(c=g.Nz,c&&0<=a&&a<c.length&&(d=c[a],d||(d=g.Nz[a]=new _b(g.TZ())),e=d.name(),f=g.kj,e!==b&&f&&(f.ITa.sVa(g,d,"name",e,b),d.name(b)),g.MZ&&f&&f.setText(g.headerIndex(),g.dj+a,b),g.WZ(e,d.name(),a)),g)},a.prototype.WZ=function(a,b,c){var d,e=this,f=e.Nz,g=f[c];e.DNb(c,1,g.name()),d=this.ZX,d&&d.onColumnNameChanged(a,b)},a.prototype.setColumnDataField=function(a,b){var c,d,e,f=this,g=f.Nz;return g&&0<=a&&a<g.length&&(c=g[a],c||(c=f.Nz[a]=new _b(f.TZ())),d=f.kj,e=c.dataField(),d&&b!==e&&d.ITa.sVa(f,c,"dataField",e,b),c.dataField(b)),f},a.prototype.getColumnDataField=function(a){var b,c,d=this.Nz;return d&&0<=a&&a<d.length&&(b=d[a])?(c=b.dataField(),c!==za&&(c=o(c)),c):za},a.prototype.getColumnFormula=function(a){var b,c,d,e,f=this.Nz,g=this.kj;return f&&g&&0<=a&&a<f.length&&(b=f[a])?(c=this.footerIndex(),d=this.dj+a,e=b.footerFormula(),e&&Y(g,e,c,d,!1)):za},a.prototype.setColumnFormula=function(a,b){return this.i$(a,b),this},a.prototype.setColumnDataFormula=function(a,b){var c,d,e,f,h,i,j,k,l,m;if(g){if(c=this,d=c.Nz,d&&0<=a&&a<d.length&&(e=d[a])){for(f=c.kj,R(f),h=a+c.dj,i=c.cj,j=c.Xj,c.showHeader()&&(i++,j--),c.showFooter()&&j--,k=X(f,b,i,h,!0),l=e.dataAreaFormula(),f&&k!==l&&f.ITa.sVa(c,e,"dataAreaFormula",l,b),e.GNb(b),e.dataAreaFormula(k),m=i;m<i+j;m++)M(f,m,h,b,k);S(f,!1)}return c}},a.prototype.getColumnValue=function(a){var b,c,d=this,e=d.Nz;return e&&0<=a&&a<e.length&&(b=e[a])?d.NZ&&b.footerFormula()&&(c=d.kj)?c.getValue(d.footerIndex(),d.dj+a):b.footerValue():za},a.prototype.setColumnValue=function(a,b){var c,d,e=this,f=e.Nz,g=e.kj;return f&&0<=a&&a<f.length&&(c=f[a],c&&(d=c.footerValue(),g&&b!==d&&g.ITa.sVa(e,c,"footerValue",d,b),c.footerValue(b)),e.NZ&&g&&N(g,e.footerIndex(),e.dj+a,b)),e},a.prototype.filterButtonVisible=function(a,b){var c,d,e,f,g=this,h=g.kj,i=g.rowFilter();if(!(a<0||a>=g.OZ))switch(c=arguments,c.length){case 0:return i&&i.filterButtonVisible();case 1:if(d=c[0],e=typeof d,"number"===e)return i&&i.filterButtonVisible(d);if("boolean"===e&&i){for(O(h),f=0;f<g.OZ;f++)i.filterButtonVisible(f,d);P(h)}return g;case 2:return i&&i.filterButtonVisible(a,b),g}},a.prototype.allowAutoExpand=function(a){var b=this,c=b.kj;return 0===arguments.length?b.wNb:(b.wNb!==a&&(c.ITa.pVa(b,"allowAutoExpand",b.wNb,a),b.wNb=a),b)},a.prototype.Aq=function(){return!!this.ZX},a.prototype.Yv=function(a){var b=this,c=b.tc;b.HNb(a),b.kj&&b.kj.ITa&&b.kj.ITa.INb(b,c)},a.prototype.HNb=function(a){var b,c=this;c.tc=a,c.kj=a&&a.kj,b=c.xr,a&&b&&b.kj!==a.kj&&b.table(c)},a.prototype.HeK=function(a){var b,c,d,e=this,f=e.kj,g=f.getDefaultStyle(),h=e.cj,i=e.dj,j=e.Xj,k=e.OZ,l={},m=f.parent,n=e.MZ?1:0,o=n+(e.NZ?1:0);for(b=0;b<k;b++)for(c=b+i,e.MZ&&mc(f,h,c,g,l,m,a),e.NZ&&mc(f,e.footerIndex(),c,g,l,m,a),d=0;d<j-o;d++)mc(f,d+h+n,c,g,l,m,a)},a.prototype.$$J=function(a){var b=this,c=[];q(b.Nz,function(a,b){var d=b.dataField();d&&c.push({name:b.name(),value:b.value(),dataField:d})}),c.length>0&&(b.ENb=c,a.qia=b.ENb)},a.prototype.Fu=function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=l.autoGenerateColumns(),n=l.xr&&l.xr.qZ;if(l.RZ(),b=l.kj,b&&(c=l.dataRange(),m?b.cg(c.row,c.col,T(c),U(c),3,17,!1,!0):q(l.Nz,function(a,d){var e=d.dataField();e&&b.cg(c.row,c.col+a,T(c),1,3,17,!1,!0)})),m&&(d=l.range(),l.$b(d.row,d.col,T(d),U(d)),l.SZ(d.col,U(d),!0)),l.$$J(a),l.wq=a,a){if(e={row:l.cj,col:l.dj,rowCount:l.Xj,colCount:l.OZ},f=a.getRowCount(),g=a.getColumnCount(),l.MZ&&f++,l.NZ&&f++,l.Xj=f,m){for(l.OZ=g,l.Nz=[],h=a.rL(),i=0;i<l.OZ;i++)j=new _b(i+1),l.Nz[i]=j,h&&(j.name(h[i]),j.dataField(h[i]));l.pNb&&(l.rNb=[],l.QNb(l.dj))}else k=[],l.Nz.forEach(function(a){var b=a.dataField();b&&k.push(b)}),a.Nka(k);b&&b.ITa.pVa(l,Gb,e,{row:l.cj,col:l.dj,rowCount:l.Xj,colCount:l.OZ})}l.xr&&(l.xr.EZ(l.dataRange()),l.xr.qZ=n)},a.prototype.XZ=function(a){var b,c,d,e,f,g=this,h=g.wq;if(h&&(b=h.rL()))for(c=g.Nz[a-g.startColumn()],d=c&&c.dataField(),e=0,f=b.length;e<f;e++)if(b[e]===d)return e;return-1},a.prototype.ge=function(a,b){var c,d=!1,e=Aa,f=this,g=f.wq,h=a-f.dataRange().row;return g&&h<g.getRowCount()&&(c=f.XZ(b),c>=0&&(d=!0,e=g.getValue(h,c).value)),{gt:d,Qb:e}},a.prototype.yq=function(a,b,c,d){var e,f,g,h,i,j,k=this,l=k.wq,m=fa(k,a),n=k.xr,o=!1;return l&&(e=k.XZ(b),e>=0&&(d&&n&&n.isRowFilteredOut(a)||(g=l.getValue(m,e),f=g.value,h=k.kj,i=h&&h.ITa,i&&g.hasBinding&&f!==c&&(j=ha(!0),k.JNb(a,m,j),i.KNb(k,a,za,j,Vb.dirty),i.Cp(a,b,{Ep:f})),l.setValue(m,e,c,i&&i.zTa)),o=!0)),k.NVJ=!0,o},a.prototype.Gq=function(a,b,c){var e=new d.Style;return this.Yo(a,b,e,c),e},a.prototype.D3=function(a){var b,c=this.tc.$m,d=c[a];return d!==Aa?d:(b=this.kj,d=c[a]=b.getRowHeight(a))},a.prototype.C3=function(a){var b=this.kj;return b.getColumnWidth(a)},a.prototype.Yo=function(a,b,c,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q=this,R=Q.style(),S=Q.Nz,T=Q.headerIndex(),U=Q.footerIndex();if(!R)return void(T!==a&&U!==a&&(f=jc(S,b-Q.dj),f&&Q.Oka(c,f)));if(g=Q.kj,h=Q.MZ,i=Q.NZ,j=Q.highlightLastColumn(),k=Q.highlightFirstColumn(),l=h?a===Q.cj+1:a===Q.cj,m=i?a===Q.cj+Q.Xj-2:a===Q.cj+Q.Xj-1,n=b===Q.dj,o=b===Q.dj+Q.OZ-1,p=h?a===T:a===Q.cj,q=i?a===U:a===Q.cj+Q.Xj-1,r=R[Sa](),s=R[Ta](),t=new d.Style,T===a)u=R[Za](),o&&j&&u&&u.Yo(t,!0,!0,!0,!0),v=R[Ya](),n&&k&&v&&v.Yo(t,!0,!0,!0,!0),w=R[Pa](),w&&w.Yo(t,!0,n,!0,o),o&&j&&r&&r.Yo(t,!0,!0,!1,!0),n&&k&&s&&s.Yo(t,!0,!0,!1,!0);else if(U===a)x=R[_a](),o&&j&&x&&x.Yo(t,!0,!0,!0,!0),y=R[$a](),n&&k&&y&&y.Yo(t,!0,!0,!0,!0),z=R[Qa](),z&&z.Yo(t,!0,n,!0,o),o&&j&&r&&r.Yo(t,!1,!0,!0,!0),n&&k&&s&&s.Yo(t,!1,!0,!0,!0);else{if(o&&j&&r&&r.Yo(t,p,!0,q,!0),n&&k&&s&&s.Yo(t,p,!0,q,!0),A=h?a-Q.cj-1:a-Q.cj,B=b-Q.dj,C=void 0,D=void 0,E=void 0,F=void 0,G=void 0,H=void 0,I=void 0,J=!e||"cellType"!==e&&"formatter"!==e,Q.bandRows()&&J&&(C=R[ab](),D=C+R[bb](),D>0)){if(E=Q.uNb[a],void 0===E){if(d.mn.nn&&d.mn.sn){for(K=d.mn.sn,L=Q.dataRange().row;K[L]===-1;)L++;if(L>a)return;A=K[a]-K[L]}else if(g){for(M=0,L=Q.dataRange().row;L<a;L++)Q.D3(L)>0&&M++;A=M}E=Q.uNb[a]=A%D}F=R[Ua](),G=R[Va](),E<C&&F?(H=0===E,I=m||E===C-1,F.Yo(t,H,n,I,o)):E>=C&&G&&(H=E===C,I=m||E===D-1,G.Yo(t,H,n,I,o))}if(Q.bandColumns()&&J&&(C=R[cb](),D=C+R[db](),D>0)){if(E=Q.vNb[b],void 0===E){if(N=0,g)for(O=Q.dj;O<b;O++)Q.C3(O)>0&&N++;E=Q.vNb[b]=N%D}F=R[Wa](),G=R[Xa](),E<C&&F?(H=0===E,I=o||E===C-1,F.Yo(t,l,H,m,I)):E>=C&&G&&(H=E===C,I=o||E===D-1,G.Yo(t,l,H,m,I))}jc(S,B,t)}P=R[Ra](),P&&P.Yo(t,p,n,q,o),Q.Oka(c,t)},a.prototype.oNb=function(a,b,c){var d,e,f,g=this,h=g.NZ,i=g.pNb,j=g.footerIndex(),k=j===a;k&&h&&g.ANb()&&(d=g.rNb[b-g.dj],d&&i&&(e=c.cellButtons,f=c.dropDowns,s(e)&&(e=[]),c.cellButtons=e.concat(d.cellButtons),s(f)&&(f=[]),c.dropDowns=f.concat(d.dropDowns)))},a.prototype.Oka=function(a,b){var c=a,d=20,e,f,g,h;s(c.backColor)&&(c.backColor=b.backColor),va(c.foreColor)&&(c.foreColor=b.foreColor),s(c.themeFont)&&s(c.font)?(c.themeFont=b.themeFont,c.font=b.font):!s(c.themeFont)&&s(c.font)&&(c.font=b.font),s(c.borderLeft)&&(e=b.borderLeft,c.borderLeft=e&&e.Uo()||e,c.borderLeft&&(c.borderLeft.level=d)),s(c.borderTop)&&(f=b.borderTop,c.borderTop=f&&f.Uo()||f,c.borderTop&&(c.borderTop.level=d)),s(c.borderRight)&&(g=b.borderRight,c.borderRight=g&&g.Uo()||g,c.borderRight&&(c.borderRight.level=d)),s(c.borderBottom)&&(h=b.borderBottom,c.borderBottom=h&&h.Uo()||h,c.borderBottom&&(c.borderBottom.level=d)),s(c.textDecoration)&&(c.textDecoration=b.textDecoration),s(c.cellType)&&(c.cellType=b.cellType),s(c.formatter)&&(c.formatter=b.formatter)},a.prototype.YZ=function(a,b){var c,d,e,f,g,h=this;if((a!==h.cj||b!==h.dj)&&(c=h.kj)){if((a<0||c.getRowCount()<a+h.Xj||b<0||c.getColumnCount()<b+h.OZ)&&L(Qb().Exp_TableMoveOutOfRange),d=h.tc,e=void 0,f=void 0,d)for(e=d.l$,f=0,g=e.length;f<g;f++)if(e[f]===h){e.splice(f,1),h.ZZ();break}c.moveTo(h.cj,h.dj,a,b,h.Xj,h.OZ,3),e&&f<=g&&(h.$Z(a,b),e.splice(f,0,h),h._Z()),this.LNb(1)}},a.prototype.$Z=function(a,b){var c=this,d=c.kj;d&&d.ITa.pVa(c,Gb,{row:c.cj,col:c.dj,rowCount:c.Xj,colCount:c.OZ},{row:a,col:b,rowCount:c.Xj,colCount:c.OZ}),c.cj=a,c.dj=b,c.a$(),c.Nm()},a.prototype.ZZ=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,r,t=this,u=t.kj;if(u&&g){for(d=t.Nz,e=t.footerIndex(),f=t.range(),h=t.dataRange(),i=h.row,j=T(h),s(a)&&(a=0,b=d.length);a<b;a++)if(k=d[a],l=f.col+a,k){for(k.footerFormula()&&e>=0&&(M(u,e,l,za),N(u,e,l,za)),m=k.GNb(),n=ra(m),o=void 0,p=void 0,q=0;q<j;q++)p=i+q,o=u.getFormula(p,l),s(o)||(s(t.MNb)&&(t.MNb=[]),M(u,p,l,za),t.MNb.push({row:p,col:l,formula:o})),s(o)||!s(n)&&Y(u,X(u,n,t.cj,l),p,l)===o||(s(t.NNb)&&(t.NNb=[]),r=sa(t.NNb,l),s(r)?(r={},r.col=l,r.rowIndexes=[],r.rowIndexes.push(p),t.NNb.push(r)):r.rowIndexes.push(p));if(k.GNb(Aa),k.dataAreaFormula())for(q=0;q<j;q++)p=i+q,M(u,p,l,za),N(u,p,l,za)}c===!0&&(t.MNb=[])}},a.prototype.ONb=function(a,b,c){var d,e,f,g,h,i,j=this,k=j.kj,l=j.MNb;if(l&&l.length>0){for(f=0;f<l.length;f++)e=l[f],d=!0,e&&(g=e.row,h=e.col,i=e.formula,g>=a&&(c===!0&&(g+=b),c===!1&&(g<a+b?d=!1:g-=b)),d&&M(k,g,h,i));j.MNb=[]}j.Gj(a,b,!0,c)},a.prototype.PNb=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=this,A=z.kj,B=z.MNb;if(B&&B.length>0){for(f=0;f<B.length;f++)e=B[f],d=!0,e&&(g=e.row,h=e.col,i=e.formula,h>=a&&(c===!0&&(h+=b),c===!1&&(h<a+b?d=!1:h-=b)),d&&M(A,g,h,i));for(j=z.NNb||[],k=void 0,f=0;f<j.length;f++)k=j[f],k&&(l=k.col,l>=a&&(c===!0&&(k.col+=b),c===!1&&l>=a+b&&(k.col-=b)));for(z.Gj(a,b,!1,c),m=z.Nz,n=m.length,o=z.dataRange(),p=o.row,q=o.col,r=o.rowCount,s=void 0,t=void 0,u=void 0,v=void 0,w=void 0,f=0;f<n;f++)if(t=m[f],w=q+f,t&&(u=t.dataAreaFormula())){for(s=p,x=0;x<j.length;x++)if(k=j[x],k&&k.col===w){for(;k.rowIndexes.indexOf(s)>-1&&s<p+r;)s++;break}s<p+r&&(v=A.getFormula(s,w),v&&t.dataAreaFormula(X(A,v,p,w)))}z.MNb=[],z.NNb=[]}else y=A.uja&&(A.parent||A).tja(),y&&y.length>0&&z.Gj(a,b,!1,c,Aa,!0)},a.prototype.Gj=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n=this,o=n.kj,p=n.Nz,q=n.footerIndex(),r=n.dataRange(),s=r.row,t=r.col,u=r.rowCount,v=r.colCount,w=o.Bj(),x=o.Wu;if(x&&w&&(g=x.ih()))if(l=w.xf,f)l.O$J=!0,g.Gj(l,a,b,c,d,!0),delete l.O$J;else if(e||(g.Dj(w,s,t,u,v),g.Gj(l,a,b,c,d,!0)),n.NZ)for(e||(g.Dj(w,q,t,1,v),g.Gj(w.xf,a,b,c,d,!1)),m=0;m<v;m++)h=p[m],h&&(i=h.footerFormula(),k=t+m,i&&(j=o.getFormula(q,k),j&&(o&&o.ITa.sVa(n,h,"footerFormula",i,j),h.footerFormula(X(o,j,q,k)))))},a.prototype._Z=function(){var a,b,c,d=this,e=d.kj;e&&g&&(a=d.footerIndex(),b=d.range(),c=d.dataRange(),q(d.Nz,function(d,f){var g,h,i,j=b.col+d,k=f.footerFormula(),l=f.dataAreaFormula();if(k&&a>=0&&M(e,a,j,za,k),l)for(g=0,h=T(c);g<h;g++)i=c.row+g,M(e,i,j,za,l)}))},a.prototype.b$=function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=this,I=H.dataRange();if(!a.equals(H.range())){if(b=a.row,c=a.col,e=T(a),f=U(a),g=H.MZ,h=H.NZ,i=H.pNb,j=0,k=1,g&&(j+=1),h&&(j+=1),n=H.kj,n&&((e<j||f<k||b+e>n.getRowCount()||c+f>n.getColumnCount())&&L(Qb().Exp_TableResizeOutOfRange),b===H.cj&&a.intersect(H.cj,H.dj,H.Xj,H.OZ)||L(Qb().Exp_TableResizeInvalidRange),m={row:H.cj,col:H.dj,rowCount:H.Xj,colCount:H.OZ},l=H.Nz.slice()),o=H.Nz,p=c,q=c+f-1,r=H.dj,s=H.dj+H.OZ-1,t=H.OZ,H.dj=c,H.OZ=f,p<r){for(u=0,v=p;v<r;v++)w=new _b(H.TZ()),o.splice(u,0,w),u++;g&&H.PZ(0,r-p),h&&H.SZ(0,r-p)}else p<=s&&(H.ZZ(r,p),o.splice(0,p-r));if(q>s){for(v=s+1;v<=q;v++)w=new _b(H.TZ()),o.push(w);g&&H.PZ(t,q-s),h&&H.SZ(t,q-s),i&&H.QNb(t);
}else q>=r&&(H.ZZ(q,s),o.splice(o.length-(s-q),s-q));e!==H.Xj&&(x=H.wq,y=H.dataRange(),z=y.row,A=T(y),x?e>H.Xj?(B=z+A-1,C=e-H.Xj,n&&(D=B+C+1,E=da(n,new d.Range(D,p,n.getRowCount()-D,q)),E&&E.row<D||H.hMb(B,C,!0,!1))):n&&(F=H.Xj-e,H.STa(z+A-F,F)):(G=void 0,h&&(H.SZ(),G=H.footerIndex()),H.Xj=e,H.TNb(),h&&(H.e$(),H.QZ(G)))),n&&(n.ITa.pVa(H,Gb,m,{row:H.cj,col:H.dj,rowCount:H.Xj,colCount:H.OZ}),n.ITa.pVa(H,Hb,l,H.Nz.slice())),H.a$(!1),H.f$(I,H.dataRange()),H.NAb(),H.LNb(0)}},a.prototype.f$=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this,n=m.ZX;n&&(c=a.col,d=T(a),e=U(a),f=b.col,g=T(b),h=U(b),i=a.row+d,j=c+e,k=b.row+g,l=f+h,k<i&&n.onRowsRemoved(g,i-k),k>i&&n.onRowsAdded(d,k-i),f>c&&n.onColumnsRemoved(0,f-c),l<j&&n.onColumnsRemoved(h,j-l),f<c&&n.onColumnsAdded(0,c-f),l>j&&n.onColumnsAdded(c+e-f,l-j))},a.prototype.a$=function(a){var b=this,c=b.xr;c&&(c.EZ(b.dataRange()),a!==!1&&c.reFilter())},a.prototype.RZ=function(){var a=this.xr;a&&(a.unfilter(),a.reset())},a.prototype.VZ=function(a,b){var c,d;for(a!==za&&(a=o(a)),c=0;c<this.OZ;c++)if(c!==b&&(d=this.getColumnName(c),a===d))return!0;return!1},a.prototype.g$=function(a){var b,c,d,e=this,f=e.Nz;return e.MZ&&f?(b=a-e.dj,0<=b&&b<f.length&&(c=f[b])?(d=c.name(),s(d)||(d=o(d)),d):za):za},a.prototype.h$=function(a,b){var c,d,e,f,g,h=this,i=h.Nz;h.MZ&&i&&(c=i.length,d=a-h.dj,0<=d&&d<c&&(e=i[d],e&&(f=e.name(),g=h.kj,g&&b!==f&&g.ITa.sVa(h,e,"name",f,b),e.name(b),h.WZ(f,e.name(),d))))},a.prototype.i$=function(a,b,c){var d,e,f=this,h=f.Nz,i=f.footerIndex(),j=f.dj+a,k=f.kj;g&&0<=a&&a<h.length&&(d=h[a],b&&!c&&k&&(c=X(k,b,i,j),f.NZ&&M(k,i,j,b,c)),d&&(e=d.footerFormula(),k&&c!==e&&k.ITa.sVa(f,d,"footerFormula",e,b),d.footerFormula(c)))},a.prototype.j$=function(a,b,c){var d,e,f,g,h=this,i=h.Nz;(c||h.NZ)&&i&&(d=a-h.dj,0<=d&&d<i.length&&(e=i[d],e&&(f=e.footerValue(),b!==f&&(g=h.kj,g&&(g.ITa.sVa(h,e,"footerValue",f,b),g.ITa.Cp(h.cj+h.Xj-1,a,{Ep:e.footerValue()}))),e.footerValue(b))))},a.prototype.TZ=function(){var a,b,c=this.Nz,d=c&&c.length,e=[];for(b=0;b<d;b++)a=c[b],a&&a.k$()&&e.push(a.id());if(e.sort(function(a,b){return a-b}),d=e.length,d>0){for(b=0;b<d;b++)if(e[b]!==b+1)return b+1;return d+1}return 1},a.prototype.dga=function(a,b){var c,d,e,f;if(a&&!this.VZ(a,b))return a;if(d=fb,e=0,a)d=a,e=1;else if(b>0&&(a=this.Nz[b-1].name(),f=/[0-9]+$/.exec(a))){if(d=a.substr(0,f.index),e=parseInt(a.substr(f.index),10),c=d+(e+1),!this.VZ(c))return c;d=a,e=1}for(;;)if(e++,c=d+e,!this.VZ(c))return c},a.prototype.PZ=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o=this,q=o.Nz,r=o.kj;if(o.MZ&&q&&r)for(d=q.length,e=o.headerIndex(),f=o.dj,s(a)&&(a=0),s(b)&&(b=d),i=Ba(d,a+b),k=a;k<i;k++)h=q[k],h&&(l=o.tc.l$,m=p(o,l),m>-1&&l.splice(m,1),j=ua(r.getValue(e,f+k)),m>-1&&l.splice(m,0,o),M(r,e,f+k,za),j&&(c?(o.RNb=c,r.setText(e,f+k,h.name()),delete o.RNb):(g&&r.zq(e,f+k),n=o.dga(j,k),n===j?(r.ITa.sVa(o,h,"name",h.name(),j),h.name(j)):r.setText(e,f+k,n))))},a.prototype.QNb=function(a){var b,c,d=this.Nz;for(b=a;b<d.length;b++)c=hc(this.name(),d[b].name()),this.rNb.push(c)},a.prototype.SZ=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this,p=o.Nz,q=o.kj;if(o.NZ&&p&&q)for(o.useFooterDropDownList()&&!o.ANb()&&o.yNb(),d=p.length,e=o.footerIndex(),f=o.dj,s(a)&&(a=0),s(b)&&(b=d),s(c)&&(c=o.SNb),h=Ba(d,a+b),k=a;k<h;k++)g=p[k],g&&(j=q.getValue(e,f+k),s(j)||c?(o.RNb=c,N(q,e,f+k,g.footerValue()),delete o.RNb):(l=g.footerValue(),j!==l&&q.ITa.sVa(o,g,"footerValue",l,j),g.footerValue(j)),i=q.Ima&&q.Ima(e,f+k),i&&!c?(m=g.dataAreaFormula(),i!==m&&(n=Y(q,i,e,f+k),q.ITa.sVa(o,g,"dataAreaFormula",m,n)),g.footerFormula(i)):o.S3||(o.RNb=c,M(q,e,f+k,za,g.footerFormula()),delete o.RNb))},a.prototype.m$=function(a,b){var c,d,e,f,g,h,i=this,j=i.Nz;if(i.MZ&&j)for(c=j.length,s(a)&&(a=0),s(b)&&(b=c),e=Ba(c,a+b),f=a;f<e;f++)d=j[f],d&&(g=d.name(),h=i.kj,h&&g!==za&&h.ITa.sVa(i,d,"name",g),d.name(za),i.WZ(g,d.name(),f))},a.prototype.n$=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.dataRange();if(k.containsRange(a)){for(b=a.row,c=a.col,d=T(a),e=U(a),f=[],g=0;g<d;g++)for(h=0;h<e;h++)j.yq(b+g,c+h,za,!0),f.push({columnName:j.getColumnName(c+h-k.col),row:b+g-k.row,data:""});i=j.ZX,i&&i.onDataChanged(f)}},a.prototype.o$=function(a,b){var c,d,e,f,g,h,i=this,j=i.Nz;if(i.NZ&&j)for(s(a)&&(a=0),s(b)&&(b=j.length),d=Ba(j.length,a+b),e=a;e<d;e++)c=j[e],c&&(f=i.kj,g=c.footerFormula(),f&&za!==g&&f.ITa.sVa(i,c,"footerFormula",g),c.footerFormula(za),h=c.footerValue(),f&&za!==h&&f.ITa.sVa(i,c,"footerValue",h),c.footerValue(za))},a.prototype.e$=function(){var a,b,c,d,e,f,g,h=this,i=h.Nz;if(h.NZ&&i&&(a=h.kj))for(b=i.length,d=h.dj,f=h.footerIndex(),g=0;g<b;g++)c=i[g],c&&(e=d+g,N(a,f,e,c.footerValue()),M(a,f,e,za,c.footerFormula()))},a.prototype.QZ=function(a){var b,c,d,e,f=this,g=f.kj;if(g&&!(a<0||g.getRowCount()<=a))for(b=f.dj,c=f.OZ,e=0;e<c;e++)d=b+e,M(g,a,d,za),N(g,a,d,za)},a.prototype.rI=function(a,b,c,d,e,f){var g,h,i,j,k,l=this,m=!1,n=c?1:0;return a>=l.cj+l.Xj+n?m:(g=l.kj,g&&(h=g.ITa,i={row:l.cj,col:l.dj,rowCount:l.Xj,colCount:l.OZ}),f||l.mfc(a,b,!1),j=l.cj,k=l.cj+l.Xj-1+n,a<=j&&!e?l.cj+=b:a<=k&&(d||(m=l.c$(a,b)),l.Xj+=b),g&&h.pVa(l,Gb,i,{row:l.cj,col:l.dj,rowCount:l.Xj,colCount:l.OZ}),m)},a.prototype.KZ=function(a,b,c){var d,e,f,g,h,i=this,j=i.cj+i.Xj-1;!c&&a>=i.cj&&a<=j&&i.TNb(a,b),c||(i.Gj(a,b,!0,!0,!0),i.UNb()),d=i.ZX,e=i.dataRange(),f=e.row,g=i.endRow(),a>=f&&a<=g&&d&&d.onRowsAdded(a-f,b),h=i.xr,h&&(i.NVJ=!0,h.rI(a,b),i.l9J&&i.kj.filterRowsVisibleInfo.NTa(a,b))},a.prototype.c$=function(a,b){var c,d,e,f=this,g=f.wq;return!!g&&(c=this.kj,d=c&&c.ITa.zTa,e=void 0,d&&(e=d.tableChanges,e||(d.tableChanges=e=[])),g.uL(fa(f,a),b,e),!0)},a.prototype.TNb=function(a,b){if(g){var c=this,d=c.kj,e=c.dataRange();s(a)&&(a=e.row),s(b)&&(b=e.rowCount),R(d),q(c.Nz,function(e,f){var g,h,i=f.dataAreaFormula();if(i)for(g=e+c.dj,h=a;h<a+b;h++)M(d,h,g,za,i)}),S(d,!1)}},a.prototype.UNb=function(){if(g){var a=this,b=a.kj,c=b.Bj(),d=a.dataRange(),e,f;s(e)&&(e=d.row),s(f)&&(f=d.rowCount),R(b),q(a.Nz,function(b,d){var g,h,i,j,k=d.VNb();if(k&&k.isArrayFormula)for(g=k.isDynamicArray,h=b+a.dj,i=e;i<e+f;i++)s(c.Qf(i,h))&&(j={row:i,col:h,rowCount:1,colCount:1,isDynamicArray:g},c.Xf(i,h,j))}),S(b,!1)}},a.prototype.tI=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s=this,t=c?1:0;if(!(a>=s.dj+s.OZ+t)){if(g=s.dj,j=s.kj,j&&(i={row:s.cj,col:s.dj,rowCount:s.Xj,colCount:s.OZ},h=s.Nz.slice()),a<=s.dj&&!e)s.dj+=b;else if(a<s.dj+s.OZ+t&&(f=!0,s.OZ+=b,k=s.Nz)){for(l=a-s.dj,m=0;m<b;m++)n=s.TZ(),o=l+m,p=new _b(n),p.name(s.dga(za,o)),k.splice(o,0,p),q=s.getColumnName(o),s.DNb(o,0,q);d&&s.PZ(l,Aa,!0)}s.xr&&s.xr.tI(a,b,f),a>=g&&(r=s.ZX,r&&r.onColumnsAdded(a-g,b)),j&&(j.ITa.pVa(s,Gb,i,{row:s.cj,col:s.dj,rowCount:s.Xj,colCount:s.OZ}),j.ITa.pVa(s,Hb,h,s.Nz.slice()))}},a.prototype.nNb=function(){var a,b,c,d,e=this,f=e.kj,g=f.Bj();g&&e.NZ&&(a=e.Nz,b=e.footerIndex(),c=e.dj,a.forEach(function(a,e){d=g.Kf(b,c+e),s(d)||a.footerFormula(d)}))},a.prototype.GR=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this,x=!1;if(a>=w.cj+w.Xj)return x;if(f=w.dataRange(),g=f.row,h=T(f),i=w.cj,j=w.cj+w.Xj-1,k=w.kj,l=w.wq,p=[],r="_backupRowsChange",k&&(n=k.ITa,n&&(q={row:w.cj,col:w.dj,rowCount:w.Xj,colCount:w.OZ},p.push(Gb),m=n.zTa,m&&(o=m.tableChanges,o||(m.tableChanges=o=[])))),e||w.mfc(a,b,!0),a<i?a+b<=i&&(w.cj-=b):a===i?w.MZ||(w.Xj-=Ba(j-a+1,b),!c&&l&&(p.push(r),l.wL(fa(w,a),Ba(j-a+1,b),o),x=!0)):a<=j&&(w.Xj-=Ba(j-a+1,b),!c&&l&&(p.push(r),l.wL(fa(w,a),Ba(j-a+1,b),o),x=!0),a===j&&w.NZ&&(p.push(Fb),w.NZ=!1)),w.xr&&(w.NVJ=!0,w.xr.GR(a,b)),a>=g&&a<g+h&&(s=w.ZX,s&&s.onRowsRemoved(a-g,b)),n&&p&&p.length>0)for(t=0,u=p;t<u.length;t++)switch(v=u[t]){case Gb:n.pVa(w,Gb,q,{row:w.cj,col:w.dj,rowCount:w.Xj,colCount:w.OZ});break;case Fb:n.pVa(w,Fb,w.NZ);break;case r:n.KNb(w,a,b,d,Vb.deleted)}return x},a.prototype.HR=function(a,b){var c,d,e,f,g,h,i,j=this,k=j.Nz;a>=j.dj+j.OZ||(c=j.kj,c&&(d={row:j.cj,col:j.dj,rowCount:j.Xj,colCount:j.OZ},e=j.Nz.slice()),f=j.dj,g=j.dj,h=j.dj+j.OZ-1,a<g?a+b<=g?j.dj-=b:(j.dj=a,j.OZ-=a+b-g,k&&(k.splice(0,a+b-g),j.DNb(0,a+b-g))):(j.OZ-=Ba(h-a+1,b),k&&(k.splice(a-g,Ba(h-a+1,b)),j.DNb(a-g,Ba(h-a+1,b)))),j.xr&&j.xr.HR(a,b),a>=f&&(i=j.ZX,i&&i.onColumnsRemoved(a-f,b)),c&&(c.ITa.pVa(j,Gb,d,{row:j.cj,col:j.dj,rowCount:j.Xj,colCount:j.OZ}),c.ITa.pVa(j,Hb,e,j.Nz.slice())))},a.prototype.$b=function(a,b,c,e){var f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=c,t=e,u=r.kj;u&&(s=u.getRowCount(),t=u.getColumnCount()),f=a<0?0:a,g=b<0?0:b,h=a<0?s:c,i=b<0?t:e,j=d.kf(f,g,h,i),k=r.headerIndex(),r.MZ&&f<=k&&k<f+h&&(l=d.kf(k,r.dj,1,r.OZ),m=j.getIntersect(l,s,t),m&&r.m$(m.col-r.dj,U(m))),n=r.dataRange(),o=j.getIntersect(n,s,t),o&&r.n$(o),p=r.footerIndex(),r.NZ&&f<=p&&p<f+h&&(q=d.kf(p,r.dj,1,r.OZ),m=j.getIntersect(q,s,t),m&&r.o$(m.col-r.dj,U(m))),r.xr&&r.xr.$b(a,b,c,e)},a.prototype.toJSON=function(a,b){var c,d,e,f,g,h,i,j,k,l=this,m=l.style(),n=l.rowFilter(),o="columns";for(s(a)?c=l.name():(c=a,l.fOJ=c),d={name:[c,za],row:[l.cj,-1],col:[l.dj,-1],rowCount:[l.Xj,-1],colCount:[l.OZ,-1],showHeader:[l.MZ,!0],showFooter:[l.NZ,!1],useFooterDropDownList:[l.pNb,!1],showResizeHandle:[l.qNb,!1],highlightFirstColumn:[l.highlightFirstColumn(),!1],highlightLastColumn:[l.highlightLastColumn(),!1],bandRows:[l.bandRows(),!0],expandBoundRows:[l.expandBoundRows(),!1],bandColumns:[l.bandColumns(),!1],style:[m?m.toJSON():za,za],autoGenerateColumns:[l.autoGenerateColumns(),!0],bindingPath:[l.bindingPath(),Aa],rowFilter:[n?n.toJSON():za,za],reservedElement:[lc(l.IeK),za],allowAutoExpand:[l.wNb,!0]},d[o]=[[]],e=0;e<l.Nz.length;e++)f=l.Nz[e].toJSON(),g=f[ib],h=f[lb],g&&(b&&b.ignoreFormula?(delete f[ib],f[mb]=l.kj.getValue(l.cj+l.Xj-1,l.dj+e)):f[ib]=Y(l.kj,g,l.footerIndex(),e+l.dj)),h&&(f[lb]=Y(l.kj,h,l.dataRange().row,e+l.dj)),d[o][0][e]=f;d[o][1]=za,i={};for(j in d)k=d[j],k[0]!==k[1]&&(i[j]=k[0]);return r(i)?Aa:i},a.prototype.bdK=function(a,b,c,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y=this,z=y.kj,A=z.name(),B=y.style(),C=y.rowFilter(),D=y.Nz,E=c.styleManager,F=c.sharedStrings;if(a.xmlns=d.XFileConstants.QbK,a.id=y._id,a.c_=[],a.n_=d.XFileConstants.S8,g=y.name()||za,g&&(g=g.split(" ").join("_"),a.name=g,a.displayName=pc(g.split("-").join("_"),f)),a.ref=wa([y.range()]),y.MZ!==!0&&(a.headerRowCount=0),y.NZ!==!1&&(a.totalsRowCount=1),C&&!z.ODJ&&C.bdK(a,E,e),D&&D.length>0){for(h=[],i=y.footerIndex(),j=y.dataRange().row,k=y.dj,l=void 0,m=0;m<D.length;m++)n=D[m],o=m+y.dj,p=n.name(),y.MZ&&!s(p)&&(s(l)&&(l=J(b,A)),K(l,y.cj,o,""+p,F)),q={},h.push(n.bdK(z,j,i,m+k,e,q)),r=q.v,y.NZ&&!s(r)&&(s(l)&&(l=J(b,A)),K(l,y.cj+y.Xj-1,o,""+r,F));t={n_:"tableColumns",count:D.length,c_:h},a.c_.push(t)}B&&(B.builtInName()?u="TableStyle"+B.builtInName():(u=B.name(),s(u)&&(u="CustomTableStyle_"+Wb(),B.name(u)))),v={n_:"tableStyleInfo",name:u},v.showFirstColumn=y.highlightFirstColumn()!==!1?"1":"0",v.showLastColumn=y.highlightLastColumn()!==!1?"1":"0",v.showRowStripes=y.bandRows()!==!0?"0":"1",v.showColumnStripes=y.bandColumns()!==!1?"1":"0",a.c_.push(v),w={useFooterDropDownList:[y.pNb,!1],showResizeHandle:[y.qNb,!1],expandBoundRows:[y.expandBoundRows(),!1],autoGenerateColumns:[y.autoGenerateColumns(),!0],bindingPath:[y.bindingPath(),Aa],extLst:[y.IeK,za],allowAutoExpand:[y.wNb,!0]},x=a.lossless={},Object.keys(w).forEach(function(a){var b=w[a];b[0]!==b[1]&&(x[a]=b[0])})},a.prototype.fromJSON=function(a,c,e){var f,g,h,j,l,m,o,p,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;if(a){if(f=this,g=f.kj,q([Ga,Ka,La,Ma,Na,Oa],function(b,c){n(a[c])&&f[c](a[c],!1)}),h=a.row,n(h)&&(f.cj=h),j=a.col,n(j)&&(f.dj=j),l=a.rowCount,n(l)&&(f.Xj=l),m=a.colCount,n(m)&&(f.OZ=m),qc(g,new d.Range(h,j,l,m))&&(g.rowFilter().reset(),g.rowFilter(void 0)),o=a.showHeader,n(o)&&(f.MZ=o),p=a.showFooter,n(p)&&(f.NZ=p),r=a.expandBoundRows,n(r)&&(f.Sgc=r),s=a.useFooterDropDownList,n(s)&&(f.pNb=s),t=a.showResizeHandle,n(t)&&(f.qNb=t),u=a.style,u&&(v=new k.TableTheme,v.fromJSON(u,c),f.style(v)),w=a.dataSource,x=a.dataBinding,y=a.bindingPath,c?(w&&i.qL&&(f.wq=new i.qL,f.wq.bind(w)),x&&i.qL&&(f.wq=new i.qL,f.wq.fromJSON(x))):y&&(f.UZ=y,z=g&&g.getDataSource&&g.getDataSource(),i.CellBindingSource&&z instanceof i.CellBindingSource&&(A=i.LL(z.getSource(),y),A&&(f.wq=new i.qL,f.wq.bind(A)))),B=a.columns){for(C=B,D=C.length,E=f.Nz=[],F=void 0,G=void 0,H=0;H<D;H++)G=C[H],F=new _b(f.TZ()),F.fromJSON(G),I=F.name(),J=f.dga(I,H),E.push(F),J!==I&&f.setColumnName(H,J);f.pfc()}f.pNb&&f.yNb(!0),K=a.rowFilter,K&&(L=b.MAb&&new b.MAb,L&&(L.table(f),L.fromJSON(K,c),f.xr=L,e?f.xr.reFilter():(f.NVJ=!0,f.zWJ()))),M=a.reservedElement,M&&(f.IeK=M),N=a.allowAutoExpand,n(N)&&(f.wNb=N)}},a.prototype.cdK=function(a,c,d,e){var f,g,h,j,k,l,m,o,p,q,r,t,u,v,y,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P;if(a){if(f=this,g=a.ref,h=d&&d.onlyTableData,f.name(a.name),s(g)||(j=xa(g,!0)[0],f.cj=j.row,f.dj=j.col,f.Xj=j.rowCount,f.OZ=j.colCount),f.MZ=z(a.headerRowCount,1)>=1,f.NZ=z(a.totalsRowCount,-1)>=1,k=w(a,"tableColumns"),l=w(a,"autoFilter"),m=w(a,"sortState"),o=w(a,"tableStyleInfo"),p=w(a,"extLst"),!h&&o&&(q=o.name,s(q)||(r=c.getTableTheme(q),f.style(r)),s(o.showFirstColumn)||f.highlightFirstColumn(A(o.showFirstColumn,!1)),s(o.showLastColumn)||f.highlightLastColumn(A(o.showLastColumn,!1)),s(o.showRowStripes)||f.bandRows(A(o.showRowStripes,!1)),s(o.showColumnStripes)||f.bandColumns(A(o.showColumnStripes,!1))),t=a.lossless,h||s(t)||(u=t.bindingPath,v=t.autoGenerateColumns,y=t.expandBoundRows,B=t.useFooterDropDownList,C=t.showResizeHandle,D=t.allowAutoExpand,u&&(f.UZ=u,E=f.kj,F=E&&E.getDataSource&&E.getDataSource(),i.CellBindingSource&&F instanceof i.CellBindingSource&&(G=i.LL(F.getSource(),u),G&&(f.wq=new i.qL,f.wq.bind(G)))),n(v)&&f.autoGenerateColumns(v),n(y)&&(f.Sgc=y),n(B)&&(f.pNb=B),n(C)&&(f.qNb=C),n(D)&&(f.wNb=D)),k&&(H=x(k,"tableColumn"),!s(H))){for(I=f.Nz=[],J=0,K=H.length;J<K;J++)L=H[J],M=new _b,M.cdK(L,h),N=M.name(),O=f.dga(N,J),O!==N&&M.name(O),I.push(M);f.pfc()}h||(f.pNb&&f.yNb(!0),P=b.MAb&&new b.MAb,nc(f,P,l,m,c,e),p&&(f.IeK=p))}},a.prototype.zWJ=function(){var a,b,c=this,d=c.xr,e=c.kj.filterRowsVisibleInfo.rowsVisibleInfo,f=d.range;if(!s(f))for(a=0;a<f.rowCount;a++)if(e[f.row+a]!==!1)for(b=0;b<f.colCount;b++)d.QX(f.row+a,f.col+b)},a.prototype.formulaFromJSON=function(){var a,b,c,d,e,f,g=this,h=g.kj,i=h.Bj(),j=g.Nz,k=g.footerIndex(),l=g.dataRange().row,m=g.dj;for(c=0;c<j.length;c++)a=j[c],b=c+m,d=a.footerFormula(),d&&typeof d===Lb&&a.footerFormula(X(h,d,k,b)),e=a.dataAreaFormula(),e&&i&&(f=i.Qf(l,b),s(f)||a.VNb({isArrayFormula:!0,isDynamicArray:f.isDynamicArray})),e&&typeof e===Lb&&a.dataAreaFormula(X(h,e,l,b))},a.prototype.pfc=function(){var a,b,c,d=this,e=d.Nz,f=e.length;for(c=0;c<f;c++)a=e[c],b=a.id(),b<1&&a.id(d.TZ())},a.prototype.startRow=function(){return this.cj},a.prototype.startColumn=function(){return this.dj},a.prototype.endRow=function(){return this.cj+this.Xj-1},a.prototype.endColumn=function(){return this.dj+this.OZ-1},a.prototype.hasHeadersRow=function(){return this.MZ},a.prototype.hasTotalsRow=function(){return this.NZ},a.prototype.tableName=function(){return this.name()},a.prototype.getColumnIndexInTable=function(a){a=a.toLowerCase().replace(/\u00A0/g," ");var b=-1,c=f.Common.u.Gb(a,"\r\n","\n");return s(a)||q(this.Nz,function(d,e){var f=(""+e.name()).toLowerCase().replace(/\u00A0/g," ");if(f===a||f===c)return b=d,!1}),b},a.prototype.source=function(){var a=this.kj;return a&&a.yj&&a.yj()},a.prototype.JZ=function(){var a,b,c,d=this,e=d.kj;e&&(a=d.bindingPath(),a&&(b=e.getDataSource&&e.getDataSource(),i.CellBindingSource&&b instanceof i.CellBindingSource&&(c=i.LL(b.getSource(),a),d.FNb(c))))},a.prototype.FNb=function(a){var b,c,d,e,f,h,j,k=this,l=k.kj;if(a){b=k.dataRange(),c=b.row,d=T(b),e=new i.qL,e.bind(a,l.ITa.zTa),f=e.getRowCount();try{O(l),k.wq=za,f>d?k.Sgc?l.addRows(c+d,f-d):(h=l.wq,h&&h.kLb&&(h.lLb=!0),k.XNb=!0,0===d?k.Nia(c,f):k.Nia(c+d-1,f-d,!0,!0),delete k.XNb):f<d&&(k.Sgc?l.deleteRows(c+f,d-f):(k.XNb=!0,k.STa(c+f,d-f,!0),delete k.XNb)),k.Fu(e),j=g&&l.Cf(),j&&!j.IsSuspended()&&l.recalcAll()}finally{P(l)}}},a.prototype.clone=function(){var b=this,c=new a,d=Ea(b.toJSON());return c.Yv(b.tc),c.fromJSON(Fa(d)),c},a.prototype.p$=function(a){var b=new i.qL;b.bind(a),this.wq=b},a.prototype.Az=function(a){if(a&&!a.bindingPath()){var b=a.wq;b&&this.p$(b.getSource())}},a.prototype.LZ=function(){var a=this.wq;return a?a.getSource():za},a.prototype.q$=function(){var a=this.wq;return a?a.getRowCount():0},a.prototype.YNb=function(a,b){var c,d=this.sNb;b?d.push(a):(c=d.indexOf(a),c!==-1&&d.splice(c,1))},a.prototype.LNb=function(a){var b=this;b.sNb.forEach(function(c){c.MOb(b,a)}),2===a&&(b.sNb=[])},a.prototype.wzb=function(a,b,c){var d,e,f,g=this;g.OAb||(d=g.LAb,e=d[c],e||(e=d[c]={}),f=[a,b].join(","),e[f]=!0)},a.prototype.NAb=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,o=n.kj,p=o&&o.getCalcService&&o.getCalcService();if(n.OAb=!0,p){d=n.LAb,e=void 0;for(e in d)if(f=p.jh[e]){g=f.dUa(),h=d[e];for(i in h)j=i.split(","),k=+j[0],l=+j[1],m=f.Kf(k,l),m?(n.ZNb(k,l)||n.$Nb(m,a,b,c,!1,k,l),f.fg(k,l,m,void 0,!1,g)):delete h[i]}else delete d[e]}delete n.OAb},a.prototype._Nb=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,o=n.kj,p=o&&o.getCalcService();if(n.OAb=!0,p){d=n.LAb,e=void 0;for(e in d){f=p.jh[e],g=d[e];for(h in g)i=h.split(","),j=+i[0],k=+i[1],l=f.Kf(j,k),l&&a===j&&b===k&&(m=pa(l),m>-1&&(l.arguments[m]=c))}}delete n.OAb},a.prototype.ZNb=function(a,b){var c,d,e=this,f=e.footerIndex(),g=!1;return f>-1&&a===f&&(c=e.dj,d=c+e.OZ,g=b>=c&&b<d),g},a.prototype.sort=function(a,b){var c=this,d=c.kj,e=c.dataRange(),f=c.rowFilter();d&&0<=a&&a<e.colCount&&(d.suspendPaint(),d.sortRange(e.row,e.col,e.rowCount,e.colCount,!0,[{index:a+e.col,ascending:b}]),f&&(f.zZ={index:a+e.col,ascending:b}),d.resumePaint())},a.prototype.qJb=function(){return!!this.wq},a.prototype.hMb=function(a,b,c,e,f,g){var h,i,j,k,l,m,n,o=this,p=o.kj,q=o.tc,r=o.cj,s=o.dj,t=o.Xj,u=o.OZ,v=r+t-1,w=c?a+1:a,x=w+b,y=o.dataRange();ja(p);try{o.l9J=!0,o.nJb(!1),o.aOb(),q.h9J=o,o.rI(w,b,c,!1,!0,g),o.NAb(),h=d.CopyToOptions.value|d.CopyToOptions.formula|d.CopyToOptions.comment|d.CopyToOptions.outline|d.CopyToOptions.sparkline|d.CopyToOptions.span|d.CopyToOptions.style|d.CopyToOptions.tag|d.CopyToOptions.bindingPath|d.CopyToOptions.hyperlink,e&&!o.bOb&&(i=v+1,j=i+b,k=f-i+1,p.moveTo(i,s,j,s,k,u,h)),l=v-w+1,(!c||a!==v)&&l>0&&(p.mJb=!0,p.KFc=y,p.moveTo(w,s,x,s,l,u,h),delete p.KFc,delete p.mJb),m=p.ITa,n=o.dataRange(),m._Ua&&m._Ua(w,b,[n],!0),m.CVa&&m.CVa(w,b,[n],!0),q.h9J=Aa,o.cOb(),o.KZ(w,b,!0),o.TNb(),o.ONb(w,b,!0),o.UNb(),o.tc.Nm()}finally{o.l9J=Aa,o.nJb(!0),ka(p),o.LNb(0),p.recalcAll(!0)}},a.prototype.nJb=function(a){this.kj.nJb(a)},a.prototype.insertRows=function(a,b,c){if(!(s(a)||s(b)||b<=0)){var d=this;a=qa(d,a,!0),d.Nia(a,b,c)}},a.prototype.Nia=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r;s(a)||s(b)||b<=0||(e=this,f=e.kj,g=e.dataRange(),h=g.row,i=g.rowCount,j=h+i,0===i&&a===h||!(a<h||a>=j)||L(Qb().Exp_RowParamOutOfRange),k=e.cj,l=e.dj,m=e.Xj,n=e.OZ,o=k+m-1,p=l+n-1,q=aa(f,e),r=q>o,ca(f,e,o+1,q,l,p,b)||e.hMb(a,b,c,r,q,d))},a.prototype.deleteRows=function(a,b){if(!(s(a)||s(b)||b<=0)){var c=this;a=qa(c,a,!0),c.STa(a,b)}},a.prototype.STa=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,A,B;if(!(s(a)||s(b)||b<=0||(e=this,f=e.kj,g=e.dataRange(),h=g.row,i=g.rowCount,(a<h||a>=h+i)&&L(Qb().Exp_RowParamOutOfRange),j=e.cj,k=e.dj,l=e.Xj,m=e.OZ,n=j+l-1,o=k+m-1,(l<=1||a===h&&!e.MZ&&!e.NZ&&b>=i)&&L(Qb().Exp_TableDeleteCountInvalid),p=aa(f,e),q=p>n,ca(f,e,n+1,p,k,o,b,!0)))){ja(f);try{e.nJb(!1),r=e.qJb(),t=void 0,r&&(t=ha(!0),e.dOb(a,b,t)),e.aOb(),u=e.tc,u.h9J=e,e.GR(a,b,Aa,t,c),e.NAb(),v=Ba(b,n-a+1),f.clear(a,k,v,m,3,383),w=d.CopyToOptions.value|d.CopyToOptions.formula|d.CopyToOptions.comment|d.CopyToOptions.outline|d.CopyToOptions.sparkline|d.CopyToOptions.span|d.CopyToOptions.style|d.CopyToOptions.tag|d.CopyToOptions.bindingPath|d.CopyToOptions.hyperlink,a+b<=n&&f.moveTo(a+b,k,a,k,n-b-a+1,m,w),q&&(x=n+1,y=x-v,z=p-x+1,f.moveTo(x,k,y,k,z,m,w)),A=f.ITa,B=e.dataRange(),A.aVa&&A.aVa(a,b,[B],!0),u.h9J=Aa,e.cOb(),e.TNb(),e.ONb(a,b,!1),e.tc.Nm()}finally{e.nJb(!0),ka(f),e.LNb(0),f.recalcAll(!0)}}},a.prototype.insertColumns=function(a,b,c){if(!(s(a)||s(b)||b<=0)){var d=this;a=qa(d,a,!1),d.kMb(a,b,c)}},a.prototype.kMb=function(a,b,c){var f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,A,B,C,D,E,F;if(!(s(a)||s(b)||b<=0||(f=this,g=f.kj,h=f.dataRange(),i=h.row,j=h.col,k=h.rowCount,l=h.colCount,(a<j||a>=j+l)&&L(Qb().Exp_ColParamOutOfRange),m=f.cj,n=f.dj,o=f.Xj,p=f.OZ,q=m+o-1,r=n+p-1,t=ba(g,f),u=t>r,ca(g,f,m,q,r+1,t,b,!1,!0)))){v=c?a+1:a,w=v+b,ja(g);try{f.nJb(!1),f.aOb(),x=f.tc,x.h9J=f,y=!f.qJb(),z=r+1,A=z+b,B=t-z+1,C=d.CopyToOptions.value|d.CopyToOptions.formula|d.CopyToOptions.comment|d.CopyToOptions.outline|d.CopyToOptions.sparkline|d.CopyToOptions.span|d.CopyToOptions.style|d.CopyToOptions.tag|d.CopyToOptions.bindingPath|d.CopyToOptions.hyperlink,u&&g.moveTo(m,z,m,A,o,B,C),f.tI(v,b,c,y,!0),f.eOb(v,b,!0),f.NAb(v,b,!0),c&&a===r||(g.mJb=!0,D=f.NZ?1:0,g.moveTo(i,v,i,w,k+D,r-v+1,C),delete g.mJb),E=g.ITa,F=f.dataRange(),E.bVa&&E.bVa(v,b,[F],!0),E.EVa&&E.EVa(v,b,[F]),x.h9J=Aa,f.cOb(Aa,!0),f.TNb(),f.PNb(v,b,!0),e.wDc(g,v,b,!0,!1,h),f.tc.Nm()}finally{f.nJb(!0),ka(g),f.LNb(0),g.recalcAll(!0)}}},a.prototype.deleteColumns=function(a,b){if(!(s(a)||s(b)||b<=0)){var c=this;a=qa(c,a,!1),c.TTa(a,b)}},a.prototype.TTa=function(a,b){var c,f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,A;if(!(s(a)||s(b)||b<=0||(c=this,f=c.kj,g=c.dataRange(),h=g.col,i=g.colCount,(a<h||a>=h+i)&&L(Qb().Exp_ColParamOutOfRange),j=c.cj,k=c.dj,l=c.Xj,m=c.OZ,n=j+l-1,o=k+m-1,p=c.NZ?1:0,(m<=1||a===k&&b>=m)&&L(Qb().Exp_TableDeleteCountInvalid),q=ba(f,c),r=q>o,ca(f,c,j,n,o+1,q,b,!0,!0)))){ja(f);try{c.nJb(!1),c.aOb(),t=c.tc,t.h9J=c,t.h9J.XkK=new d.Range(j,k,l,m),c.HR(a,b),c.eOb(a,b,!1),c.NAb(a,b,!1),u=Ba(b,o-a+1),f.clear(j,a,l,u,3,383),v=d.CopyToOptions.value|d.CopyToOptions.formula|d.CopyToOptions.comment|d.CopyToOptions.outline|d.CopyToOptions.sparkline|d.CopyToOptions.span|d.CopyToOptions.style|d.CopyToOptions.tag|d.CopyToOptions.bindingPath|d.CopyToOptions.hyperlink,a+b<=o&&(f.mJb=!0,f.moveTo(j,a+b,j,a,l-p,o-b-a+1,v),delete f.mJb),r&&(w=o+1,x=w-u,y=q-w+1,f.moveTo(j,w,j,x,l,y,v)),z=f.ITa,A=c.dataRange(),z.cVa&&z.cVa(a,b,[A],!0),z.FVa&&z.FVa(a,b),delete t.h9J.XkK,t.h9J=Aa,c.cOb(!0),c.TNb(),c.PNb(a,b,!1),e.wDc(f,a,b,!1,!1,g),c.tc.Nm()}finally{c.nJb(!0),ka(f),c.LNb(0),f.recalcAll(!0)}}},a.prototype.aOb=function(){var a=this,b=a.kj,c=a.tc,d=c.l$;b&&b.ITa.tVa([a],[],2),d.splice(d.indexOf(a),1),a.ZZ()},a.prototype.cOb=function(a,b){var c=this;c.XNb=!0,c.SNb=a,c.tc.Cz(c,Aa,b),delete c.SNb,delete c.XNb},a.prototype.eOb=function(a,b,c){var d,e,f,g,h=this,i=h.Nz,j=i.length,k=ga(h,a);for(f=k;f<j;f++)g=void 0,c?f>k+b-1&&(g=f-b):f>=k&&(g=f+b),d=i[f],e=d.footerFormula(),e&&h.$Nb(e,a,b,c,!0,g)},a.prototype.$Nb=function(a,b,c,d,f,g,h){var i,j,k,l,m,n,o,p=this,q=p.kj;if(c>0&&a&&a.arguments)for(i=a.arguments,j=void 0,k=void 0,l=0;l<i.length;l++)j=i[l],j instanceof e.xzb&&(q&&(f?(m=g,q.ITa.fOb(this,j,m)):(n=g,o=h,q.ITa.gOb(p,j,n,o))),j.JUa(),k=j.offsetWhenInsertRemoveColumn(b,c,d,f),i[l]=k)},a.prototype.ru=function(a){var b,c,d,e,f,g,h,i=this,j=i.wq,k=i.kj,l=i.MZ?1:0,m=i.cj+l+a,n=i.dj;if(!j||0===j.getRowCount())return za;if(b=i.OZ,c={},d=j.ru(a))for(e in d)v(d,e)&&"function"!=typeof e&&(c[e]=d[e]);for(f=0;f<b;f++)g=i.Nz[f],h=g&&g.dataField(),g&&h&&h.length>0&&s(c[h])&&(c[h]=k.getValue(m,n+f));return c},a.prototype.dOb=function(a,b,c){var d,e,f,g,h,i=this,j=[],k=i.wq;if(k)for(f=k.getRowCount(),g=0;g<b;g++)d=a+g,h=za,e=fa(i,d),e<f&&(h=i.ru(e)),j.push({key:c,data:h});i.Ts=j},a.prototype.xKb=function(){var a=[],b=this.Ts;return b&&q(b,function(b,c){c&&!d.GC$.isFunction(c)&&a.push(c.data)}),a},a.prototype.JNb=function(a,b,c){var d,e,f,g,h,i=this;i.kj.gga>0||(d=i.tNb,e=i.wq,e&&(f=za,g=e.getRowCount(),b<g&&(f=i.ru(b)),h={key:c,data:f},d[a]=h))},a.prototype.mfc=function(a,b,c){var d,e,f,g=this;if(!(g.kj.gga>0))if(d=g.tNb,c)e=d.splice(a,b),g.lfc.push({rowIndex:a,count:b,deletedDirtyItems:e});else for(f=0;f<b;f++)d.splice(a,0,za)},a.prototype.kfc=function(a,b){this.tNb.splice(a,b)},a.prototype.nfc=function(){var a,b,c,d,e,f,g=this,h=g.lfc;if(h&&h.length>0)for(a=h.pop(),b=a.rowIndex,c=a.count,d=a.deletedDirtyItems,e=0;e<c;e++)f=d[e],g.tNb[b+e]=dc({},f)},a.prototype.getDirtyRows=function(){var a,b,c,d=this,e=d.tNb,f=[];for(c=0;c<e.length;c++)a=e[c],s(a)||(b=fa(d,c),f.push({row:b,originalItem:a.data,item:d.ru(b)}));return f},a.prototype.clearPendingChanges=function(){this.tNb=[]},a.prototype.footerRowDropDowns=function(a,b){var c,d,e,f,g=this,h=g.rNb[a];if(h){if(1===arguments.length)return h.dropDowns&&h.dropDowns.slice();if(c=h.dropDowns[0],b)return d=b.listOption,e=b.submitCommand,f=b.type,d&&(c.option=d),e&&(c.submitCommand=e),n(f)&&(c.type=f),g}},a.prototype.checkTableLastRow=function(a){var b=this,c=b.dataRange();return b.headerIndex()===a||c.row+c.rowCount-1!==a},a.prototype.checkTableLastCol=function(a){var b=this,c=b.dataRange();return c.col+c.colCount-1!==a},a.prototype.UIb=function(a,b,c,d,e){var f,g,h,i=this,j=i.kj;la(j,i,c?xb:ub,a,b,d,e),f=j.ITa,g=c?ub:xb,h=!c&&Aa,f&&f.ZVa(["tableRowsChanged",i,g,a,b,h,c])},a.prototype.VIb=function(a,b,c,d){var e,f,g,h=this,i=h.kj;ma(i,h,c?zb:yb,a,b,d),e=i.ITa,f=c?yb:zb,g=!c&&Aa,e&&e.ZVa(["tableColumnsChanged",h,f,a,b,g])},a}(),b.Table=Xb;function qc(a,b){var c,d=a&&a.rowFilter&&a.rowFilter();return!s(d)&&(c=d.range,c.intersect(b.row,b.col,b.rowCount,b.colCount))}b.hasRowFilter=qc;function rc(a){return function(b,c){var d=this,e=d.kj;e&&b!==c&&(Xb.ao(e,"tableNameChanged",{oldName:c,newName:b}),e.ITa.pVa(d,a,c,b))}}function sc(a,b){var c=this;c.Nm(),rc("style").call(c,a,b)}d.Zn(Xb);function tc(a,b,c,d,e){a.wu().execute({cmd:ub,sheetName:a.name(),tableName:b.name(),row:c,count:d,isAfter:e})}function uc(a,b,c,d,e){a.wu().execute({cmd:vb,sheetName:a.name(),tableName:b.name(),row:c,count:d,isAfter:e})}function vc(a,b){a.wu().execute({cmd:wb,sheetName:a.name(),tableName:b.name()})}Yb={101:"average",102:"countNums",103:"count",104:"max",105:"min",107:"stdDev",109:"sum",110:"let"};function wc(a){var b,c;if(!s(a))return b=/\[\S[\S\s]*\S\]/,a=a.trim(),"SUBTOTAL("!==a.substr(0,9)||!b.test(a)||a.indexOf("[[")?"custom":(c=a.substring(9,12),Yb[c]||Mb)}function xc(a){return a.indexOf("LET(")>-1}Xb.prototype.name=m(Ga,"",rc(Ga),V),Xb.prototype.bandRows=m(Ma,!0,rc(Ma)),Xb.prototype.bandColumns=m(Na,!1,rc(Na)),Xb.prototype.highlightFirstColumn=m(Ka,!1,rc(Ka)),Xb.prototype.highlightLastColumn=m(La,!1,rc(La)),Xb.prototype.style=m("style",Aa,sc),Xb.prototype.autoGenerateColumns=m(Oa,!0,rc(Oa)),h&&h.HideRowFilter&&(Zb=h.HideRowFilter,$b=function(a){cc(b,a);function b(b){var c=a.call(this)||this,d=c;return d.table(b),d.sYJ=!1,c}return b.prototype.oZ=function(){return 0},b.prototype.pZ=function(){return this.range.colCount},b.prototype.table=function(a){var b=this;return 0===arguments.length?b.sj:(b.sj=a,void(a&&(b.kj=a.kj)))},b.prototype.unfilter=function(b,c){var d,e=this,f=e.kj;f&&f.suspendPaint(),a.prototype.unfilter.call(this,b,c),d=e.sj,d&&d.tc&&d.tc.Nm(),f&&f.resumePaint()},b.prototype.rI=function(b,c){var d=this,e=d.sj;a.prototype.rI.call(this,b,c),e&&d.BZ(e.dataRange())},b.prototype.GR=function(b,c){var d=this,e=d.sj;a.prototype.GR.call(this,b,c),e&&d.BZ(e.dataRange())},b.prototype.oLb=function(b,c,d,e,f){var g,h=this,i=h.sj;a.prototype.oLb.call(this,b,c,d,e,f),i&&i.Aq()&&(g=i.getSlicerData(),g.refresh())},b.prototype.toJSON=function(){var b=this,c=a.prototype.toJSON.call(b),d=b.sj;return d&&(c.tableName=d.name()),c},b.prototype.no=function(){this.sj=za,this.kj=za},b}(Zb),b.MAb=$b),_b=function(){function a(a,b,c,d,e,f){var g=this;g.id(a),g.dataField(b),g.name(c||b||fb+g.id()),g.formatter(d),g.cellType(e),g.value(f)}return a.prototype.k$=function(){return this.id()>0},a.prototype.toJSON=function(){var a=this,b={};return q(ob,function(c,d){var e=a[d]();s(e)||(d===Ha&&e.toJSON&&"function"==typeof e.toJSON?b[d]=e.toJSON():b[d]=e)}),r(b)?Aa:b},a.prototype.bdK=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q=this,r=q.name();return r=D(r,"\r",""),g={n_:"tableColumn",id:q.id(),name:C(D(r,"\n","_x000a_"))},h=q.footerFormula(),i=q.footerValue(),h&&(e&&e.includeFormulas===!1?(h=Aa,i=a.getValue(c,d)):(j=Y(a,h,c,d),k=wc(j))),l=k===Mb,l?g.totalsRowFunction=Mb:h?g.totalsRowFunction=k:s(i)||(g.totalsRowLabel=C(E(""+i,!0)),f.v=i),m=q.dataAreaFormula(),s(m)||(m=Y(a,m,b,d),xc(m)||(s(g.c_)&&(g.c_=[]),n={n_:"calculatedColumnFormula",c_:[C(G(m))]},g.c_.push(n))),l&&!s(j)&&(o={n_:"totalsRowFormula",c_:[C(j)]},s(g.c_)&&(g.c_=[]),g.c_.push(o)),p=g.lossless,s(q.cellType())||(s(p)&&(p=g.lossless={}),p[Ha]=q.cellType().toJSON()),s(q.value())||(s(p)&&(p=g.lossless={}),p[Ia]=q.value()),s(q.formatter())||(s(p)&&(p=g.lossless={}),p[Ja]=q.formatter()),s(q.dataField())||(s(p)&&(p=g.lossless={}),p[hb]=q.dataField()),g},a.prototype.fromJSON=function(a){if(a){var b=this;q(ob,function(c,e){var f,g,h,i,j=a[e]!==Aa?a[e]:a["_"+e];s(j)||e===Ha&&(f=j.typeName,g=d.CellTypes&&d.CellTypes._o,h=g&&g[f]||g[j.type]||d.getTypeFromString(f),h&&(i=new h,i.fromJSON(j,!1),j=i)),s(j)||b[e](j,!1)})}},a.prototype.cdK=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,t,u;a&&(c=this,c.id(z(a[gb],0)),e=a[Ga],s(e)||(f=D(e,"_x000d__x000a_","\n"),c.name(B(D(f,"_x000a_","\n")))),g=a.totalsRowLabel,s(g)||c.footerValue(B(g)),b||(h=a.totalsRowFunction,s(h)||(i=h,h===Mb&&(i=B(y(w(a,"totalsRowFormula")))),c.footerFormula(i)),j=w(a,"calculatedColumnFormula"),s(j)||(k=""+y(j),c.dataAreaFormula(B(F(k)))),l=a.lossless,s(l)||(m=l[Ha],s(m)||(n=m.typeName,o=d.CellTypes&&d.CellTypes._o,p=o&&o[n]||o[m.type]||d.getTypeFromString(n),p&&(q=new p,q.fromJSON(m),m=q),s(m)||c.cellType(m)),r=l[Ia],s(r)||c.value(r),t=l[Ja],s(t)||c.formatter(t),u=l[hb],s(u)||c.dataField(u))))},a}(),b.TableColumn=_b,_b.prototype.id=function(a){var b=m(gb,Aa,function(a){var b=this;b.name()||b.name(fb+a)});return 0===arguments.length?b.call(this):s(a)?this:b.call(this,a)},_b.prototype.name=m(Ga,Aa,function(a){if(!a){var b=this;b.name(fb+b.id())}}),_b.prototype.formatter=m(Ja),_b.prototype.cellType=m(Ha),_b.prototype.value=m(Ia),_b.prototype.dataField=m(hb),_b.prototype.footerValue=m(mb),_b.prototype.dataAreaFormula=m(lb),_b.prototype.footerFormula=m(ib),_b.prototype.GNb=m(jb),_b.prototype.VNb=m(kb);function yc(a,b){var c,d;for(c=b.row;c<b.row+b.rowCount;c++)for(d=b.col;d<b.col+b.colCount;d++)if(!s(a.getValue(c,d)))return!1;return!0}ac=function(){function a(a){this.kj=a,this.l$=[],this.$m=[],this.an=[]}return a.prototype.getUsedRange=function(){var a,b,c,d,e=this,f=e.all(),g={};if(f)for(a=void 0,b=0,c=f;b<c.length;b++)d=c[b],Sb(g,Rb(d.range()));return g},a.prototype.no=function(){var a,b,c=this,d=c.l$,e=d.length;for(b=0;b<e;b++)a=d[b],a&&a.no();c.l$=[],c.h9J=Aa,c.Nm(),c.kj=za},a.prototype.Nm=function(){var a,b,c,d,e=this;for(e.$m=[],e.an=[],a=e.l$,b=a.length,d=0;d<b;d++)c=a[d],c.Nm()},a.prototype.lNb=function(a,b){var c,d,e=this,f=e.l$,g=f.length;for(d=0;d<g;d++)c=f[d],!b&&fc(c.uNb,a)?c.uNb=[]:s(c.uNb[a])||(c.uNb[a]=Aa)},a.prototype.mNb=function(a){var b,c,d=this,e=d.l$,f=e.length;for(c=0;c<f;c++)b=e[c],fc(b.vNb,a)?b.vNb=[]:s(b.vNb[a])||(b.vNb[a]=Aa)},a.prototype.add=function(a,b,c,d,e,f,g){var h=this;return h.LA(h.kj,a,b,c,d,e,!0),h.Cz(new Xb(a,b,c,d,e,f||k.TableThemes.medium2,g))},a.prototype.addFromDataSource=function(a,b,c,d,e,f){var g,h,j,k,l,m;if(d||L(Qb().Exp_TableDataSourceNullError),i.qL)return g=this,h=g.kj,h.suspendPaint(),j=new i.qL,j.bind(d),k=j.getRowCount()+1,l=j.getColumnCount(),m=g.add(a,b,c,k,l,e,f),m.Fu(j),h.clearPendingChanges(),h.resumePaint(),m},a.prototype.find=function(a,b){return this.RS(a,b)},a.prototype.RS=function(a,b,c){var d,e,f,g,h=this,i=h.l$;for(c===!0&&h.h9J&&(i=i.concat([h.h9J])),d=i.length,f=0;f<d;f++)if(e=i[f],g=e.range(),g.row<=a&&a<g.row+T(g)&&g.col<=b&&b<g.col+U(g))return e;return za},a.prototype.findByName=function(a){return this.g9J(a)},a.prototype.g9J=function(a,b){var c,d,e,f=this,g=f.l$;for(b===!0&&f.h9J&&(g=g.concat([f.h9J])),c=g.length,e=0;e<c;e++)if(d=g[e],d.name().toLowerCase()===a.toLowerCase())return d;return za},a.prototype.Ccc=function(a,b,c,e){var f,g,h=this.l$,i=h.length,j=d.kf(a,c,b,e),k=[];for(g=0;g<i;g++)f=h[g],j.containsRange(f.range())&&k.push(f);
return k},a.prototype.s$=function(a,b,c,d){var e,f,g=this.l$,h=g.length,i=[];for(f=0;f<h;f++)e=g[f],e.range().intersect(a,b,c,d)&&i.push(e);return i},a.prototype.OHb=function(){var a=this,b=a.kj,c=a.find(b.Jl,b.Kl);if(c)return b.cm(new d.Range((-1),c.dj,(-1),c.OZ))},a.prototype.Cz=function(a,b,c){var d,e;if(a)return d=this,d.findByName(a.name())&&L(Qb().Exp_TableHasSameNameError),e=d.kj,e.suspendPaint(),a.Yv(d),e.ITa.tVa([],[a],1),d.l$.push(a),a.XNb||a.JZ(),a.showHeader()&&a.PZ(Aa,Aa,c),!b&&a.showFooter()&&a.SZ(),d.t$(a),e.resumePaint(),a},a.prototype.vV=function(a){var b,c=this,d=p(a,c.l$);return d>-1?(b=c.kj,b&&b.ITa.tVa([a],[],2),c.l$.splice(d,1),c.u$([a],!1),a):za},a.prototype.remove=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v=this;if(ia(a)&&(a=v.findByName(a)),a&&(b=b||0,a.RZ(),a=v.vV(a))){c=a.range(),e=v.kj;try{if(O(e),f=c.row,g=c.row+T(c),h=c.col,i=c.col+U(c),j=void 0,k=void 0,l=a.showHeader(),m=a.headerIndex(),1!==(1&b))for(j=f;j<g;j++)for(k=h;k<i;k++)M(e,j,k,za),N(e,j,k,za);else if(a.qJb()){if(l)for(j=m,k=h;k<i;k++)e.setValue(j,k,a.getColumnName(k-c.col));for(n=a.dataRange(),o=n.row,p=o+T(n),q=void 0,r=void 0,t=void 0,j=o;j<p;j++)for(k=h;k<i;k++)r=a.Nz[ga(a,k)],r&&(q=a.ru(fa(a,j)),t=q[r.dataField()],s(t)||e.setValue(j,k,t))}else if(l)for(j=m,k=h;k<i;k++)e.setValue(j,k,a.getColumnName(k-c.col));if(2===(2&b))for(j=f;j<g;j++)for(k=h;k<i;k++)u=e.getStyle(j,k)||new d.Style,a.Yo(j,k,u),e.setStyle(j,k,u)}finally{P(e)}a.LNb(2)}return a},a.prototype.move=function(a,b,c){var d,e,f,g=this,h=g.kj;if(ia(a)&&(a=g.findByName(a)),a&&b>=0&&c>=0&&(d=a.range(),e=g.s$(b,c,T(d),U(d)),f=e.length,0===f||1===f&&e[0]===a)){O(h);try{a.YZ(b,c)}finally{P(h)}}},a.prototype.resize=function(a,b){var c,e,f,g,h,i,j,k,l,m,n=this,o=n.kj;if(ia(a)&&(a=n.findByName(a)),a&&(c=a.range(),e=a.dataRange(),f=arguments,g=b,3===f.length&&(g=d.kf(c.row,c.col,f[1],f[2])),g&&(h=T(g),i=U(g),h>=0&&i>=0&&(j=n.s$(g.row,g.col,h,i),j.length<=1)))){ja(o);try{a.b$(g),a.qJb()||(k=o.conditionalFormats,l=o.uja,m=g.rowCount-c.rowCount,k&&k.cPJ(c,e,m),l&&l.cPJ(c,e,m))}finally{ka(o)}}},a.prototype.all=function(){var a=[];return q(this.l$,function(b,c){a.push(c)}),a},a.prototype.Hfc=function(a){var b,c=a||this.l$,d=c.length;for(b=0;b<d;b++)c[b].clearPendingChanges()},a.prototype.xfc=function(a,b,c,d){var e,f,g=[],h=this.l$,i=h.length;for(e=0;e<i;e++)f=h[e],f.cj>=a&&f.dj>=b&&f.cj+f.Xj<=a+c&&f.dj+f.OZ<=b+d&&g.push(f);return g},a.prototype.yfc=function(a,b,c,d){var e=this,f=e.s$(a,b,c,d),g=e.xfc(a,b,c,d),h=[];return g.length>0?f.forEach(function(a){g.indexOf(a)===-1&&h.push(a)}):h=f,h},a.prototype.zfc=function(a,b,c){var d,e,f,g=a.length;for(e=0;e<g;e++)if(d=a[e],f=d.range(),f.row<=b&&b<f.row+T(f)&&(c<0||f.col<=c&&c<f.col+U(f)))return!0;return!1},a.prototype.LA=function(a,b,c,e,f,h,i){var j,k,l,m;return b?W(b)?c<0||f<1||c+f>a.getRowCount()?(i&&L(Qb().Exp_TableInvalidRow),!1):e<0||h<1||e+h>a.getColumnCount()?(i&&L(Qb().Exp_TableInvalidColumn),!1):(j=a.tables,j.rn(c,e,f,h)?(i&&L(Qb().Exp_TableIntersectError),!1):j.findByName(b)?(i&&L(Qb().Exp_TableHasSameNameError),!1):qc(a,new d.Range(c,e,f,h))?(i&&L(Qb().Exp_TableRangeHasFilterError),!1):(k=g&&a.Ms(c,e,f,h),l=k&&k.ranges,m=!0,l&&q(k,function(a,b){if(T(b)>1||U(b)>1)return i&&L(Qb().Exp_ArrayFormulaTable),m=!1,!1}),m)):(i&&L(Qb().Exp_TableNameInvalid),!1):(i&&L(Qb().Exp_TableEmptyNameError),!1)},a.prototype.cIb=function(a,b,c,d){var e,f,g=[],h=this.l$;for(e=0;e<h.length;e++)f=h[e],f.cj>=a&&f.dj>=b&&f.cj+f.Xj<=a+c&&f.dj+f.OZ<=b+d&&g.push(f.name());return g},a.prototype.HZ=function(a,b,c,e){var f,g,h,i,j=this.all();if(j)for(f=d.kf(a,b,c,e),g=j.length,h=void 0,i=0;i<g;i++)if(h=j[i].range(),f.intersect(h.row,h.col,T(h),U(h))&&!f.containsRange(h))return!0;return!1},a.prototype.rn=function(a,b,c,d){var e,f,g=this.l$,h=g.length;for(f=0;f<h;f++)if(e=g[f],e.range().intersect(a,b,c,d))return!0;return!1},a.prototype._getTable=function(a,b,c,d,e){var f,g,h,i=a.tables.all(),j=i.length,k=[];for(g=0;g<j;g++)f=i[g],h=f.range(),h.row>=b&&h.col>=c&&h.row+h.rowCount<=b+d&&h.colCount+h.col<=c+e&&k.push({table:f,index:g});return k},a.prototype.zxb=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n=c.tables.all(),o=n.length;if(!s(b)&&(g=d.row-b.row,h=d.col-b.col,i=this._getTable(a,b.row,b.col,b.rowCount,b.colCount),0!==i.length))for(j=0;j<o;j++)for(f=n[j],k=0;k<i.length;k++)if(l=i[k],(!e||j!==l.index)&&(m=l.table.range(),f.range().intersect(m.row+g,m.col+h,m.rowCount,m.colCount)))return c.Os(6,Qb().Exp_TableIntersectError),!0;return!1},a.prototype.KZ=function(a,b){var c,d,e=this,f=e.l$;for(c=0,d=f.length;c<d;c++)f[c].KZ(a,b);e.kj.filterRowsVisibleInfo.NTa(a,b)},a.prototype.rI=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o=this,p=o.l$,q=[];for(c=0,e=p.length;c<e;c++)f=p[c],g=f.LZ(),u(q,g)?f.rI(a,b,!0):(h=f.rI(a,b),h&&q.push(g));i=o.kj;try{for(O(i),j=void 0,k=void 0,c=0,e=p.length;c<e;c++)f=p[c],j=f.q$(),k=f.dataRange(),j>0&&j!==T(k)&&(l=j,f.showHeader()&&(l+=1),f.showFooter()&&(l+=1),m=f.range(),n=d.kf(m.row,m.col,l,U(k)),f.b$(n))}finally{P(i)}},a.prototype.tI=function(a,b){var c,d,e=this.l$,f=e.length;for(d=0;d<f;d++)c=e[d],c.tI(a,b)},a.prototype.nNb=function(a){var b,c,d,e,f=this.l$,g=f.length;for(e=0;e<g;e++)b=f[e],c=b.dj,d=b.endColumn(),c<=a&&d>=a&&b.nNb()},a.prototype.GR=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=q.l$,s=[],t=[],v=[];for(c=0,e=r.length;c<e;c++)f=r[c],g=f.LZ(),h=f.range(),i=a<=h.row&&h.row+T(h)<=a+b,i?v.push(f):(u(s,g)?f.GR(a,b,!0):(f.qJb()&&f.dOb(a,b,ha(!0)),j=f.GR(a,b),j&&s.push(g)),t.push(f));q.kj.filterRowsVisibleInfo.PTa(a,b),q.kj.ITa.tVa(v,[],2),q.l$=t,q.u$(v,!0),k=q.kj;try{for(O(k),r=q.l$,l=void 0,m=void 0,c=0,e=r.length;c<e;c++)f=r[c],l=f.q$(),m=f.dataRange(),l>0&&l!==T(m)&&(n=l,f.showHeader()&&(n+=1),f.showFooter()&&(n+=1),o=f.range(),p=d.kf(o.row,o.col,n,U(m)),f.b$(p))}finally{P(k)}},a.prototype.HR=function(a,b){var c,d,e,f,g=this,h=g.l$,i=[],j=[],k=h.length;for(d=0;d<k;d++)c=h[d],e=c.range(),f=a<=e.col&&e.col+U(e)<=a+b,f?j.push(c):(c.HR(a,b),i.push(c));g.kj.ITa.tVa(j,[],2),g.l$=i,g.u$(j,!0)},a.prototype.$b=function(a,b,c,e,f){var g,h,i,j,k,l=this,m=d.kf(a,b,c,e),n=[],o=l.kj;if(1===(1&f)){for(j=[],g=l.l$,h=g.length,k=0;k<h;k++)i=g[k],m.containsRange(i.range())?n.push(i):j.push(i);for(h=j.length,k=0;k<h;k++)i=j[k],i.$b(a,b,c,e);o&&o.ITa.tVa(n,[],2),l.l$=j}if(2===(2&f))for(g=l.l$,h=g.length,k=0;k<h;k++)i=g[k],m.containsRange(i.range())&&(o&&o.ITa.pVa(i,"style",i.style()),i.style(za));return l.u$(n,!0),n},a.prototype.u$=function(a,b){if(a&&0!==a.length){var c=this.kj;d.GC$.each(a,function(a,b){b.Aq()&&b.getSlicerData().onTableRemoved(b),b.ANb()&&(c&&c.ITa.pVa(b,nb,b.CNb()),b.rNb=[])}),g&&gc(this.kj,a,b)}},a.prototype.t$=function(a){a&&a.Aq()&&a.getSlicerData().onTableAdded(a)},a.prototype.v$=function(a){for(var b=1,c=this,d=a,e=c.gOJ();!this.hOJ(d,e);)d=a+b,b++;return d},a.prototype.gOJ=function(){var a,b,c,d,e,f,g,h=[],i=this.kj.parent,j=i.sheets;for(b=0,c=j;b<c.length;b++)for(d=c[b],a=d.tables.all(),e=0,f=a;e<f.length;e++)g=f[e],h.push(g);return h},a.prototype.hOJ=function(a,b){var c,d,e;for(c=0,d=b;c<d.length;c++)if(e=d[c],e.name().toLowerCase()===a.toLowerCase())return!1;return!0},a.prototype.ge=function(a,b){var c=this,d=!1,e=za,f=c.find(a,b);return f&&(f.showHeader()&&a===f.headerIndex()?(e=f.g$(b),s(e)||(e=o(e)),d=!0):(e=f.ge(a,b),d=e.gt,e=e.Qb)),{gt:d,Qb:e}},a.prototype.yq=function(a,b,c){var d=this,e=!1,f=!0,g=d.find(a,b);return g&&g.RNb!==!0&&(g.showHeader()&&a===g.headerIndex()?g.VZ(c)?f=!1:(c=s(c)?c:o(c),g.h$(b,c)):g.showFooter()&&a===g.footerIndex()?g.j$(b,c):e=g.yq(a,b,c)),e||!f},a.prototype.Hma=function(a,b,c,d,e,f){var h=this.find(a,b);if(g&&h){if(c>1||d>1)return this.kj.Os(0,Qb().Exp_ArrayFormulaTable),!1;if(h.showHeader()&&a===h.headerIndex()&&e)return!1;!h.RNb&&h.showFooter()&&a===h.footerIndex()&&(s(e)||h.j$(b,za),h.i$(b-h.dj,e,f))}return!0},a.prototype.IZ=function(){var a,b,c,d=this.all();for(a=0,b=d.length;a<b;a++)c=d[a],c.bindingPath()&&(c.wq=za)},a.prototype.dB=function(a,b){var c,d,e,f=[],g=this;if(g&&(c=g.all()))for(e=c.length-1;e>=0;e--)d=c[e],a.containsRange(d.range())&&(b&&(this.kj&&this.kj.ITa.tVa([d],[],2),g.l$.splice(e,1),d.ZZ(Aa,Aa,b)),f.push(d));return f},a.prototype.eB=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n=this,o=[];for(g=0,h=a.length;g<h;g++)i=a[g],j=void 0,k=void 0,f?k=i:(j=i.bindingPath()?Aa:i.LZ(),k=new Xb,k.Yv(n),k.fromJSON(Fa(Ea(i.toJSON()))),k.name(n.v$(k.name())),o.push(k)),l=k.range(),k.S3=!0,k.$Z(d+l.row-b,e+l.col-c),n.Cz(k,f),f?(m=k.ZX,m&&(m.kj=n.kj,m.refresh())):j&&k.p$(j),k.S3=!1;for(g=0;g<o.length;g++)o[g].formulaFromJSON()},a.prototype.R3=function(a){for(var b=0,c=a.length;b<c;b++)a[b]._Z()},a.prototype.toJSON=function(a,b){var c,d,e=this.l$,f=[];if(e)for(c=0;c<e.length;c++)d=a?this.v$(e[c].name()):Aa,f.push(e[c].toJSON(d,b));return 0===f.length?Aa:f},a.prototype.bdK=function(a){var b,c,e,f,g,h,i,j,k;if(a&&(b=a.rels,c=this.l$,e=c.length,b&&e>0)){for(f=[],g=0;g<e;g++)h=c[g],i=H(b),j=d.XFileConstants.abK+i,k=h._id,b.c_.push({n_:d.XFileConstants.dbK,Id:j,Type:d.RelationshipConstants.B7,Target:"../tables/"+d.XFileConstants.S8+k+"."+d.XFileConstants.r8}),f.push({n_:"tablePart","r:id":j});a.c_||(a.c_=[]),a.c_.push({n_:Ob,count:e,c_:f})}},a.prototype.fromJSON=function(a,b,c){var d,e,f,g;if(a)for(this.l$=[],this.Nm(),d=0,e=a.length;d<e;d++)f=a[d],g=new Xb,g.Yv(this),this.l$.push(g),g.fromJSON(f,b,c)},a.prototype.cdK=function(a,b,c,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s=a&&a.c_,t=!d.Util.KlK(e);if(s&&b){for(f=this,g=d.Util.lkK(e,f.kj.parent&&f.kj.parent.NjK),g||(f.l$=[]),f.Nm(),h=c.tables,i=c.styleManager,j=[],k=0,l=s.length;k<l;k++)m=s[k][Nb],n=I(b.c_,m),o=n&&n.Target,o&&(o=o.split("/").pop().slice(0,-4),p=h[o],q=p.name,r=void 0,g&&(r=f.findByName(q)),r||(r=new Xb(q),r.Yv(f),f.l$.push(r)),r.cdK(p,i,e),j.push(r.range()),t&&r.HeK(i));d.Util.alK(e)&&d.Util.JkK(f.kj,j,Aa,c)}},a.prototype.containTableHeaderTotalRowForSheet=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=this.kj;if(m&&(a=m.getSelections(),b=m.tables,c=void 0,d=void 0,e=void 0,b&&a))for(f=b.l$,g=void 0,h=void 0,i=void 0,j=void 0,k=0;k<a.length;k++)for(c=a[k],d=c.row,e=d+c.rowCount-1,l=0;l<f.length;l++)if(g=f[l],h=g.range(),i=g.headerIndex(),j=g.footerIndex(),!c.containsRange(h)&&(i>=d&&i<=e||j>=d&&j<=e))return!0;return!1},a.prototype.containTableHeaderTotalRow=function(){var a,b,c,d,e,f,g,h,i,j=this.kj,k=!1;if(j&&(a=j.getSelections(),b=j.tables,c=void 0,d=void 0,b&&a)){if(a.length>1)return k;e=a[0],f=ta(j,e),g=void 0,h=void 0,i=void 0,f&&1===f.length&&(c=e.row,d=c+e.rowCount-1,g=f[0],h=g.headerIndex(),i=g.footerIndex(),(h>=c&&h<=d||i>=c&&i<=d)&&(k=!0))}return k},a.prototype.noRoomToInsertColumn=function(){var a,b,c,d,e,f,g,h,i=this.kj;return!!(i&&(a=i.getSelections(),b=i.tables,b&&a&&1===a.length&&(c=a[0],d=c.row,e=c.col,f=c.colCount,g=b.find(d,e),h=i.getColumnCount(3),g&&g.endColumn()+f>=h)))},a.prototype.noRoomToInsertRow=function(){var a,b,c,d,e,f,g,h,i=this.kj;return!!(i&&(a=i.getSelections(),b=i.tables,b&&a&&1===a.length&&(c=a[0],d=c.row,e=c.col,f=c.rowCount,g=b.find(d,e),h=i.getRowCount(3),g&&g.endRow()+f>=h)))},a.prototype.checkTableRow=function(){var a,b,c,d,e,f,g,h=this.kj;return!!(h&&(a=h.getSelections(),b=h.tables,b&&a&&1===a.length&&(c=a[0],d=c.row,e=c.col,f=b.find(d,e),g=f&&f.range(),f&&g&&!f.MZ&&!f.NZ&&1===g.rowCount)))},a.prototype.checkTableCol=function(){var a,b,c,d,e,f,g,h=this.kj;return!!(h&&(a=h.getSelections(),b=h.tables,b&&a&&1===a.length&&(c=a[0],d=c.row,e=c.col,f=b.find(d,e),g=f&&f.range(),g&&1===g.colCount)))},a.prototype.isAcrossTables=function(){var a,b,c,d,e=this.kj,f=!1;if(e&&(a=e.getSelections(),b=e.tables,b&&a)){if(a.length>1)return f;c=a[0],d=ta(e,c),d&&(f=d.length>1)}return f},a.prototype.isWholeTableCol=function(){var a,b,c,d,e,f,g,h,i,j=this.kj,k=!1;return j&&(a=j.getSelections(),b=j.tables,b&&a&&(a.length>1?k=!0:(c=a[0],d=ta(j,c),1===d.length&&(e=d[0],f=e.dj,g=e.OZ,h=c.col,i=c.colCount,k=f===h&&g===i)))),k},a.prototype.containTableHeader=function(){var a,b,c,d,e,f,g,h,i=this.kj,j=!1;if(i&&(a=i.getSelections(),b=i.tables,c=void 0,d=void 0,b&&a)){if(a.length>1)return j;e=a[0],f=ta(i,e),f&&1===f.length&&(g=f[0],h=g.headerIndex(),c=e.row,d=c+e.rowCount-1,c<=h&&d>=h&&(j=!0))}return j},a.prototype.wKb=function(){var a,b,c,d,e,f,g,h,i=this.kj,j=!1;if(i&&(a=i.getSelections(),b=i.tables,b&&a)){if(c=i.getActiveRowIndex(),d=i.getActiveColumnIndex(),a.length>1||!b.find(c,d))return j;for(e=b.l$,f=a[0],g=void 0,h=0;h<e.length;h++)g=e[h],f&&f.intersect(g.cj,g.dj,g.Xj,g.OZ)&&(j=!0)}return j},a.prototype.SMb=function(a){var b,c,d,e,f,g,h=-1,i=this,j=i.l$;if(j)for(b=j.length,c=void 0,d=void 0,e=void 0,f=void 0,g=0;g<b;g++)c=j[g].range(),a&&!c.intersect(a.row,a.col,a.rowCount,a.colCount)||(d=c.row,e=c.rowCount,f=d+e-1,h<f&&(h=f));return h},a.prototype.TMb=function(a){var b,c,d,e,f,g,h=-1,i=this,j=i.l$;if(j)for(b=j.length,c=void 0,d=void 0,e=void 0,f=void 0,g=0;g<b;g++)c=j[g].range(),a&&!c.intersect(a.row,a.col,a.rowCount,a.colCount)||(d=c.col,e=c.colCount,f=d+e-1,h<f&&(h=f));return h},a.prototype.jIb=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t=this;if(!(t.kj.options.isProtected||a&&c&&yc(a,c))&&(h=t.all(),0!==h.length))for(g&&(l=g.shiftInfo,m=g.applyDragFillAfterTableExpand,l&&(i=l.shiftCells,j=l.isCopy,k=l.isFirst)),p=0,q=h;p<q.length;p++)n=q[p],n.wNb&&(o=n.range(),r=c&&c.equals(o),s=c&&0!==t.kj.ITa.getSpans(c,3).length,i?j&&k&&b.col===o.col&&b.colCount===o.colCount&&b.row>o.row&&c.col===o.col&&c.colCount===o.colCount&&c.row>o.row&&b&&o.contains(b.row,b.col,1,b.colCount)&&c&&o.containsRange(c)&&(t._$J(n,o,b),l.ignoreFooterShiftIndex=n.footerIndex()):c&&(r||s)||(n.bOb=e,t.hOb(n,o,b,d,f,m),delete n.bOb))},a.prototype.hOb=function(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this,B=A.kj,C=null,D=!1,E=b.row,F=b.col,G=b.rowCount,H=b.colCount,I=E+G-1,J=new d.Range(E,F,G,H);if(a.showFooter()){if(h=new d.Range(E+G-1,F,1,H),c.row===h.row&&c.col>=F&&c.col+c.colCount<=F+H)return;D=!0,J.rowCount--}if(f&&(i=a.showHeader()?G-1:G,f.push(new d.Range(E,F,i,H))),j=c.row,k=c.col,l=c.row+c.rowCount-1,m=c.col+c.colCount-1,n=E+G-1,o=F+H-1,p=Aa,q=B.getRowCount(),r=J.contains(j-1,k)&&!J.contains(j,k),D||(r=r&&m<=o&&k>=F),s=J.contains(j,k-1)&&!J.contains(j,k)&&l<=I&&j>=b.row,t=J.contains(j,k)&&!J.contains(l,m)){if(u=Da(n,l)-E+1,v=Da(o,m)-F+1,m>o&&(w=da(B,new d.Range(E,o+1,G,m-o)),w&&m>w.col&&(v=H)),C=new d.Range(E,F,u,v),D&&(C.rowCount++,l++),l>n&&(p=da(B,new d.Range(n+1,F,C.row+C.rowCount-1,H))),p&&(x=l-p.row+1,x>0)){if(da(B,new d.Range(q-Math.abs(x),F,Math.abs(x),H)))return void B.Os(6,Qb().Exp_TableAddRowNoEnoughRoom);g!==!0&&B.moveTo(p.row,F,C.row+C.rowCount,F,q-C.row-C.rowCount,H,2047)}}else if(r&&!D){if(C=new d.Range(j,F,c.rowCount,H),y=da(B,C,c),y&&!c.containsRange(y))return}else if(s&&(C=new d.Range(E,k,b.rowCount,c.colCount),y=da(B,C,c),y&&!c.containsRange(y)))return;if(r&&!D&&oa(e)&&(a.useFooterDropDownList(!0),vc(B,a)),C){if(b.containsRange(C))return;z=b.union(C),A.a_J(a,z)}},a.prototype._$J=function(a,b,c){var e,f=this,g=b.row,h=b.col,i=b.rowCount,j=b.colCount,k=new d.Range(g+(a.showHeader()?1:0),h,i-(a.showHeader()?1:0),j);k.contains(c.row,c.col,1,c.colCount)&&(e=new d.Range(g,h,i+c.rowCount,j),f.a_J(a,e))},a.prototype.a_J=function(a,b){var c=this.kj,d=c.getParent();d&&d.commandManager().execute({cmd:sb,sheetName:c.name(),tableName:a.name(),resizeToRange:b})},a.prototype.pJb=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=this,H=this.kj,I=H.options,J=I.isProtected,K=I.protectionOptions,L=K.allowSelectLockedCells!==!1,M=K.allowSelectUnlockedCells!==!1;if(J&&!L&&!M)return za;if(d=c.col,e=c.row,f=2,g=18,h=18,i=5,j=10,k=6,l=Ub.TABLE_SELECT,m=Ub.TABLE_CORNER_SELECT,n=Ub.TABLE_COL_SELECT,o=Ub.TABLE_ROW_SELECT,p=H.getActiveRowIndex(),q=H.getActiveColumnIndex(),c.rowViewportIndex===-1&&c.colViewportIndex!==-1&&(r=H.getCellRect(e,d,c.rowViewportIndex,c.colViewportIndex),s=G.find(p,q),s instanceof Xb&&(t=H.lq-H.frozenRowCount(),s.showHeader()&&p>=s.cj&&p<s.cj+s.Xj&&q>=s.dj&&q<s.dj+s.OZ&&s.cj<t&&s.cj+s.Xj>t&&c.col<s.dj+s.OZ&&c.col>=s.dj)))if(a>r.x+i&&a<r.x+r.width-h&&b<r.height-i){for(u=H.getSelections(),v=0;v<u.length;v++)if(w=u[v],!(w.col===c.col&&1===w.colCount&&w.row===s.cj&&w.rowCount===s.Xj||w.col===c.col&&1===w.colCount&&w.row===-1&&w.rowCount===H.getRowCount()))return ea(s,n,e,d,J,L,M)}else if(a>r.x+h)return ea(s,"default",e,d,J,L,M);if(x=H.getCellRect(e,d),G.find(e,d)instanceof Xb&&c.colViewportIndex!==-1&&c.rowViewportIndex!==-1){if(y=!1,s=G.find(e,d),z=G.find(p,q),u=H.getSelections(),A=!0,1===u.length&&(B=u[0],B.row<=e&&B.row+B.rowCount>e&&B.col<=d&&B.col+B.colCount>d&&(A=!1)),s===z&&(y=!0),d===s.dj&&e===s.cj){if(A&&y&&(a<=x.x+f||b<=x.y+f))return ea(s,l,e,d,J,L,M);if(a>x.x+f&&a<x.x+g&&b>x.y+f&&b<x.y+k)return ea(s,m,e,d,J,L,M);if(a>x.x+g&&b>x.y+f&&b<x.y+k)return ea(s,n,e,d,J,L,M);if(a>x.x+f&&a<x.x+g&&b>x.y+k)return ea(s,o,e,d,J,L,M)}if(d===s.dj+s.OZ-1&&e===s.cj){if(A&&y&&(a>=x.x+H.getColumnWidth(d)-2||b<=x.y+f))return ea(s,l,e,d,J,L,M);if(a<x.x+H.getColumnWidth(d)-2&&b>x.y+f&&b<x.y+k)return ea(s,n,e,d,J,L,M)}if(d===s.dj&&e===s.cj+s.Xj-1){if(A&&y&&(a<=x.x+f||b>=x.y+H.getRowHeight(e)-f))return ea(s,l,e,d,J,L,M);if(a>x.x+f&&a<x.x+g&&b<x.y+H.getRowHeight(e)-f)return ea(s,o,e,d,J,L,M)}if(A&&y&&d>s.dj&&d<s.dj+s.OZ&&e===s.cj&&b<=x.y+f)return ea(s,l,e,d,J,L,M);if(d>s.dj&&d<s.dj+s.OZ&&e===s.cj&&b>x.y+f&&b<x.y+k)return ea(s,n,e,d,J,L,M);if(A&&y&&e>s.cj&&e<s.cj+s.Xj&&d===s.dj&&a<=x.x+f)return ea(s,l,e,d,J,L,M);if(e>s.cj&&e<s.cj+s.Xj&&d===s.dj&&a>x.x+f&&a<x.x+g)return ea(s,o,e,d,J,L,M);if(C=H.getColumnWidth(s.dj+s.OZ-1),D=H.getRowHeight(s.cj+s.Xj-1),E=x.x+C,F=x.y+D,y&&(e>s.cj&&e<s.cj+s.Xj&&d===s.dj+s.OZ-1&&a>=E-f&&a<=E||d>s.dj&&d<s.dj+s.OZ&&e===s.cj+s.Xj-1&&b>=F-f&&b<=F)){if(d===s.dj+s.OZ-1&&e===s.cj+s.Xj-1&&b>=F-j&&a>=E-j)return za;if(A)return ea(s,l,e,d,J,L,M)}}return za},a.prototype.eJb=function(a,b){var c,d,e,f,g=this,h=g.kj;if(g.find(a,b)instanceof Xb){for(c=g.find(a,b),d=0,c.NZ&&(d=1),e=0,c.MZ&&(e=1);a>0&&0===h.getRowHeight(a-1);)a--;if(1===e&&b===c.dj&&a===c.cj)return f=$(h,c,!0),Z(f,c.dj+c.OZ-1,f);if(b===c.dj&&a===c.cj)return f=$(h,c,!0),Z(f,c.dj+c.OZ-1,f);if(a>c.cj&&a<c.cj+c.Xj-d&&b===c.dj)return a===c.cj+e?(a=$(h,c,!0),Z(a,c.dj+c.OZ-1,a)):Z(a-1,c.dj+c.OZ-1,a-1)}return null},a.prototype.fJb=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.kj;if(r.find(a,b)instanceof Xb){for(c=r.find(a,b),e=0,c.NZ&&(e=1),f=0,c.MZ&&(f=1),g=s.getRowCount()-1;a+1<s.getRowCount()&&0===s.getRowHeight(a+1);)a++;if(g!==a&&b===c.dj+c.OZ-1&&a<c.cj+c.Xj-e)return h=c.cj+c.Xj,i=c.dj,j=c.OZ,k=i+j-1,l=Z(a+1,c.dj,a+1),a===h-e-1&&(c.wNb?(m=aa(s,c),1===e&&ca(s,c,h,m,i,k,1,!0,!1,!0)||(n=da(s,new d.Range(h,i,m-h+1,k-i+1)),o=n&&n.row,p=o===h,h!==s.getRowCount()&&(p?tc(s,c,a,1,!0):uc(s,c,a,1,!0)))):l=Z(a,k+1,a)),l;if(s.getRowCount()-1===a&&b===c.dj+c.OZ-1&&0===e){for(q=c.cj+f;q+1<s.getRowCount()&&0===s.getRowHeight(q);)q++;return q+1===s.getRowCount()&&0===s.getRowHeight(q)?Z(c.cj,c.dj,c.cj):Z(q,c.dj,q)}}return null},a.prototype._7J=function(a,b){var c,d,e,f,g=this,h=g.kj;if(g.find(a,b)instanceof Xb){for(c=g.find(a,b),d=0,c.NZ&&(d=1),e=0,c.MZ&&(e=1);b>0&&0===h.getColumnWidth(b-1);)b--;if(b===c.dj&&(a===c.cj||a===c.cj+e))return f=_(h,c),{col:f,leadingCellCol:f,row:c.cj+c.Xj-1-d};if(b===c.dj&&(a===c.cj||a===c.cj+e))return f=_(h,c),{col:f,leadingCellCol:f,row:c.cj+c.Xj-1-d};if(b>c.dj&&b<c.dj+c.OZ&&(a===c.cj||a===c.cj+e))return b===c.dj?(b=_(h,c),{col:b,leadingCellCol:b+1,row:c.cj+c.Xj-1-d}):{col:b-1,leadingCellCol:b-1,row:c.cj+c.Xj-1-d}}return null},a.prototype.fg=function(){var a,b,c=this,d=c.l$,e=d.length;for(b=0;b<e;b++)a=d[b],a.e$()},a.prototype.LNb=function(a,b){var c,d,e,f,g,h,i=this,j=i.l$,k=j.length;for(c=0;c<k;c++)d=j[c],a?(e=d.cj,f=d.cj+d.Xj-1,e<=b&&b<=f&&d.LNb(0)):(g=d.dj,h=d.dj+d.OZ-1,g<=b&&b<=h&&d.LNb(0))},a.prototype.WFc=function(a,b,c,d,e){var f,g,h,i=this.s$(a,b,c,d),j=[];for(f=0,g=i.length;f<g;f++)h=i[f].dataRange(),e?h.rowCount+=c:h.colCount+=d,j.push(h);return j},a}(),b.TableManager=ac,function(a){a[a.none=0]="none",a[a.keepData=1]="keepData",a[a.keepStyle=2]="keepStyle"}(bc=b.TableRemoveOptions||(b.TableRemoveOptions={}));function zc(a,b){var c,d;return"Object"===b.constructor.name&&(c=a.findByName(b.tableName),c&&(c.wq?b=c.wq:(d=new i.qL,d.fromJSON(b),c.wq=b=d))),b}d.GC$.extend(d.lUa.prototype,{INb:function(a,b){var c,d=this,e=d.zTa;e&&(e.tableChanges||(e.tableChanges=[]),c=e.tableChanges,delete c.isRestored,c.push({type:"changeTableManager",table:a,oldTableManager:b}))},pVa:function(a,b,c,d){var e,f=this,g=f.zTa;g&&(g.tableChanges||(g.tableChanges=[]),e=g.tableChanges,delete e.isRestored,e.push({type:Cb,table:a,name:b,value:c,newValue:d}))},tVa:function(a,b,c){var d,e,f=this,g=f.zTa;g&&(g.tableChanges||(g.tableChanges=[]),d=g.tableChanges,e=f.noa,delete d.isRestored,d.push({type:Ab,tableList:e.l$.slice(),changedTables:a,addedTables:b,changeType:c}))},sVa:function(a,b,c,d,e){var f,g=this,h=g.zTa;h&&(h.tableChanges||(h.tableChanges=[]),f=h.tableChanges,delete f.isRestored,f.push({tableName:a.name(),type:Bb,tableColumn:b,name:c,value:d,newValue:e}))},vVa:function(a,b,c){var d,e=this,f=a.getValue(b,c),g=f.value,h=e.zTa;h&&(h.tableChanges||(h.tableChanges=[]),d=h.tableChanges,delete d.isRestored,d.push({type:Db,bindingManager:a,row:b,col:c,oldValue:g}))},KNb:function(a,b,c,d,e){var f,g=this,h=g.zTa;h&&(h.tableChanges||(h.tableChanges=[]),f=h.tableChanges,delete f.isRestored,f.push({type:Eb,table:a,key:d,row:b,count:c,stateType:e}))},fOb:function(a,b,c){var d,e=this,f=e.zTa;f&&(f.tableExpressionChanges||(f.tableExpressionChanges=[]),d=f.tableExpressionChanges,d.push({type:Ib,table:a,expression:b,col:c}))},gOb:function(a,b,c,d){var e,f=this,g=f.zTa;g&&(g.sheetExpressionChanges||(g.sheetExpressionChanges=[]),e=g.sheetExpressionChanges,e.push({type:Jb,table:a,expression:b,row:c,col:d}))},JeK:function(a){var b,c,e,f,g,h,i;if(a){for(b=null,c=this.noa,Cc(c,a.rUa,!0),e=function(e){var f,g,h,i,j,l,m,n,o,p,q=a[e],r=void 0;switch(q.type){case Ab:if(2===q.changeType)for(f=function(a){var b=q.changedTables[a],d=c.l$.findIndex(function(a){return a.name===b.name});d>=0&&c.l$.splice(d,1)},g=0;g<q.changedTables.length;g++)f(g);else if(1===q.changeType&&q.addedTables)for(h=q.addedTables,g=0;g<h.length;g++)i=h[g],i&&"Object"===i.constructor.name&&(i=Dc(c,i),c.l$.push(i));break;case Bb:r=c.findByName(q.tableName),j=q.tableColumn,"name"===q.name&&(j=q.value),l=r.Nz.findIndex(function(a){return a.name()===j}),l>=0&&(m=r.Nz[l],m[q.name](q.newValue),"name"===q.name&&r.WZ(j,q.newValue,l));break;case Cb:r=q.table,r?(n=q.name,o=q.newValue,n===Gb?(r.cj=o.row,r.dj=o.col,r.Xj=o.rowCount,r.OZ=o.colCount):n===Hb?(o=o&&o.map(function(a){if(a&&"Object"===a.constructor.name){var b=new _b;return b.fromJSON(a),b}return a}),r.Nz=o):n===nb?(o=o&&o.map(function(a){if(a&&"Object"===a.constructor.name){var b=new d.Style;return b.fromJSON(a,!1,null),b}return a}),r.rNb=o):("style"===n&&o&&o.buildInName&&(o=k.TableThemes[o.buildInName.toLowerCase()]),r[n](o))):"name"===q.name&&(r=c.findByName(q.value),r&&r.name(q.newValue));break;case"changeTableManager":break;case Db:p=zc(c,q.bindingManager),p.setValue(q.row,q.col,q.oldValue);break;case Eb:b=r=q.table,"Object"===r.constructor.name&&(r=c.findByName(r.name)),Ac(r,q.row,q.count,q.key,q.stateType)}},f=0;f<a.length;f++)e(f);if(b)for(b.ZX&&b.ZX.refresh(),g=this.kj.slicers&&this.kj.slicers.all(),f=0;f<g.length;f++)if(h=g[f],h.ZX===b.ZX&&h.$X)for(i=0;i<h.$X.length;i++)h.$X[i].onDataChanged()}},wVa:function(a){var b,c,d,e,f,g,h,i,j;if(a)for(b=this.noa,c=void 0,Cc(b,a.bindingChanges),d=a.length-1;d>=0;d--)switch(e=a[d],f=void 0,e.type){case Ab:g=e.changedTables,b.l$=e.tableList,g&&g.length>0&&g.forEach(function(a){a&&(a.e$(),a.JZ())});break;case Bb:e.tableColumn[e.name](e.value);break;case Cb:f=e.table,h=e.name,i=e.value,h===Gb?(f.cj=i.row,f.dj=i.col,f.Xj=i.rowCount,f.OZ=i.colCount,f.ZX&&Bc(c,f.ZX)):h===Hb?f.Nz=i:h===nb?f.rNb=i:f[h](i),f.LNb(0);break;case"changeTableManager":f=e.table,j=e.oldTableManager,f.HNb(j);break;case Db:e.bindingManager.setValue(e.row,e.col,e.oldValue);break;case Eb:Ac(e.table,e.row,e.count,e.key,e.stateType),c=e}},lOb:function(a){var b,c,d,e,f,g,h;if(a){for(b=void 0,c=a.length-1;c>=0;c--)d=a[c],d.type===Ib&&(b=d.table,e=d.expression,f=d.col,g=void 0,g=b.Nz[f].footerFormula(),g&&(h=pa(g),h>-1&&(g.arguments[h]=e)));b&&b.e$()}},mOb:function(a){var b,c,d,e,f;if(a)for(b=a.length-1;b>=0;b--)c=a[b],c.type===Jb&&(d=c.expression,e=c.row,f=c.col,c.table._Nb(e,f,d))}});function Ac(a,b,c,d,e){var f,g,h=0===e,i=h?a.Ts:a.tNb,j=-1;for(g=0;g<i.length;g++)if(f=i[g],f&&f.key===d){j=g;break}j>-1&&i.splice(j,s(c)?1:c),h&&a.nfc()}function Bc(a,b){var c,d,e,f,g;b.refresh(),a&&(c=a.table,d=a.row,e=a.count,f=a.stateType,g=c.getSlicerData(),g&&(0===f?g.onRowsAdded(d,e):g.onRowsRemoved(d,e)))}function Cc(a,b,c){var d,e,f;if(b)for(d=b.length-1;d>=0;d--)e=b[d],f=zc(a,e.bindingManager),c?f.heK(e):f.sUa(e)}function Dc(a,b){var c=new Xb;return c.Yv(a),c.fromJSON(b),c}function Ec(a,b){var c,d;if(b)for(c=0;c<b.length;c++)d=b[c],d&&"Object"===d.constructor.name&&(b[c]=a.findByName(d.name),b[c]||(b[c]=Dc(a,d)))}function Fc(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.table&&"Object"===d.table.constructor.name&&(d.table=a.findByName(d.table.name)),Ec(a,d.tableList),Ec(a,d.changedTables)}d.lUa.$n(rb,{priority:7e3,init:function(){this.noa=new ac(this.kj)},clearPendingChanges:function(a){var b=this.tables;b&&b.Hfc(a.tableList)},undoAddRows:function(a){var b=this,c=b.kj,d=a.row,e=a.rowCount,f=c.tables.s$(d,-1,e,-1);f.forEach(function(a){a.dOb(d,e,ha(!0))})},getValue:function(a){var b,c,d=a.row,e=a.col,f=a.sheetArea,g=this.kj.tables;3===f&&g&&(b=g.find(d,e),b&&(c=g.ge(d,e),a.isValueGet=c.gt,a.value=c.Qb))},setValue:function(a){var b,c,d,e=a.row,f=a.col,g=a.value,h=a.sheetArea,i=this.kj.tables;3===h&&i&&(b=i.find(e,f),b&&(c=a.changes,d=void 0,c&&(d=c.tableChanges,d||(c.tableChanges=[])),a.isValueSet=i.yq(e,f,g)))},applyChanges:function(a){var b,c,d,e=this,f=a.changes,g=a.isUndo;f&&(b=f.tableChanges,c=f.tableExpressionChanges,d=f.sheetExpressionChanges,b&&(Fc(e.noa,b),g?e.wVa(b):e.JeK(b)),g&&(c&&e.lOb(c),d&&e.mOb(d))),e.noa.Nm()},undo:function(a){var b=a.tableChanges,c=a.tableExpressionChanges,d=a.sheetExpressionChanges;b&&!b.isRestored&&this.wVa(b),c&&this.lOb(c),d&&this.mOb(d),this.noa.Nm()}}),d.Workbook.$n(rb,{init:function(){d.Commands.pMb(this.commandManager())},onCultureChanged:function(){Qb()},preFromSJSFormat:function(a,b,c){var d,e,f,g,h,i,j,l,m,n=c&&c.includeStyles===!1;if(!n&&(d=a.styles,e=d.tableStyles,f=b.styleManager,e&&(f.addDefaultStyleName("defaultTableStyle",e.defaultTableStyle||"TableStyleMedium2"),g=z(e.count,0),g>0&&(h=x(e,"tableStyle")))))for(i=0,j=h;i<j.length;i++)l=j[i],l&&0===+l.pivot&&l.count>0&&(m=new k.TableTheme,m.cdK(l,f))},preToSJSFormat:function(a,b,c){var e,f,g,h,i,j,k,l=c&&c.fileType===d.OpenSaveFileType.excel,m=c&&c.includeStyles===!1;if(l&&!m)for(e=this.ECJ,f=0,g=e;f<g.length;f++)h=g[f],i=h.kj,j=i.getRowCount(),k=i.getColumnCount(),h.$VJ===d.SheetType.tableSheet&&j>0&&k>0&&i.tables.Cz(new Xb(i.name()+"Table",0,0,j,k,h.Pm,{showHeader:!1}))},bdK:function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p=this,q=a.tables,r=b&&b.styleManager,s=c&&c.fileType===d.OpenSaveFileType.excel,t=c&&c.includeStyles===!1;if(!t)for(e={},f=0,g=d.tkK(p);f<g;f++)if(h=d.bT(p,f),h&&(i=h.tables,j=i&&i.all(),j&&j.length>0))for(k=0,l=j;k<l.length;k++)m=l[k],q||(q=a.tables={}),n=q[d.XFileConstants.S8+m._id]={},m.bdK(n,a,b,c,e),o=m.style(),o&&!o.builtInName()&&r.addTableStyle(o.bdK(r)),s&&!t&&h.ODJ&&i.vV(m)}})},"./dist/plugins/table/table.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/table/table.res.en.js");b.SR={en:d}},"./dist/plugins/table/table.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",b.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",b.Exp_TableEmptyNameError="The table name cannot be empty.",b.Exp_TableNameInvalid="The table name is not valid.",b.Exp_TableInvalidRow="Invalid row index or row count.",b.Exp_TableInvalidColumn="Invalid column index or column count.",b.Exp_TableIntersectError="The tables cannot be intersected.",b.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",b.Exp_TableRangeHasFilterError="The current table range contains a filter range.",b.Exp_TableDataSourceNullError="Table datasource cannot be null.",b.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",b.Exp_TableResizeOutOfRange="The invalid row count, column count, and table cannot be resized out of the sheet.",b.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",b.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",b.Exp_TableResizeToSpan="Cannot complete operation: A table cannot overlap with a table or merged cells.",b.Exp_TableResizeWithFilter="Cannot shift cells in a filtered range or table.",b.Exp_TableResizeWithHidden="Cannot resize a table that's adjacent to a hidden row or column.",b.Exp_TableResizeToTable="Cannot complete operation: Operations that include cells both inside and outside a table range, and operation that affect cells that overlap multiple tables are not allowed.",b.Exp_RowParamOutOfRange="The param row out of data range of table.",b.Exp_ColParamOutOfRange="The param col out of data range of table.",b.Exp_TableDeleteCountInvalid="The param count to delete will cause empty table.",b.Exp_TableAddRowIntersectSpan="This won't work because it would move cells in a span on your worksheet.",b.Exp_TableAddRowIntersectTable="This won't work because it would move cells in a table on your worksheet.",b.Exp_TableAddRowNoEnoughRoom="Cannot insert new cells because it would push non-empty cells of the end of worksheet. These cells might appear empty but have blank values, some formatting, or a formula. Delete enough rows or columns to make room for what you want to insert and then try again.",b.Table_Total="Total",b.Table_None="None",b.Table_Average="Average",b.Table_Count="Count",b.Table_Count_Numbers="Count Numbers",b.Table_Max="Max",b.Table_Min="Min",b.Table_Sum="Sum",b.Table_StdDev="StdDev",b.Table_Var="Var"},"./dist/plugins/touch/touch.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/touch/touch.js"))},"./dist/plugins/touch/touch.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("./dist/plugins/touch/touch.res.en.js"),b.SR={en:f},g=d.Common.j.Fa,h=e.Go,i=e.GC$,j=i.extend,k=i.isEmptyObject,l=e.Ul.Nl,m=e.Ul.nl,n=e.Ul.Ml.mozilla,o=e.Im.Lm,p=e.Ul.rl(),q=p.ipad,r=q||p.iphone,s=null,t=void 0,u=Math.abs,v=Math.min,w=Math.max,x=Math.pow,y=Math.atan2,z=Math.PI,A=Math.round,B=Math.sqrt,C=Math.atan,D=Math.log,E=Math.floor,F=100,G="touch",H="none",I="MSPointerDown",J="MSPointerMove",K="MSPointerUp",L="pointerdown",M="pointermove",N="pointerup",O="touchstart",P="touchmove",Q="touchend",R="MSPOINTER_TYPE_TOUCH",S=isNaN,T=parseInt,U=parseFloat,V=window,W=document,X=V.Yl,Y="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",
Z="AAAAAElFTkSuQmCC",$=1,e.Rxb.touch=!0,_=new d.Common.ResourceManager(b.SR,"Touch"),aa=_.getResource.bind(_);function $a(a){return a.height}function _a(a){return a.width}function ab(a){clearInterval(a)}function bb(){return(new Date).valueOf()}function cb(a,b){var c,d,e,f,g,h,i,j;return!(!a||!b)&&(c=13,d=15,e=c,f=c,g=d,h=d,i=a.X-b.X,j=a.Y-b.Y,u(i)<e&&u(j)<f&&B(i*i+j*j)<v(g,h))}function db(a){var b=a.zCJ();return b instanceof e.Worksheet?b:b&&b.kj}function eb(a){return a.getSelections()}function fb(a){return a.frozenTrailingColumnCount()}function gb(a){return a.frozenTrailingRowCount()}function hb(a,b){return a.getColumnCount(b)}function ib(a,b){return a.getRowCount(b)}ba=400,ca=1e3,da=20;function jb(a){var b=i(a).offset(),c=W.body,d=0,e=0;return b&&(d=b.top+c.clientTop||0,e=b.left+c.clientLeft||0),{FB:d,EB:e}}ea=function(){function a(){var a=this;a.rM=[],a.sM={length:0},a.tM=new fa,a.uM=new ga}return a.prototype.vM=function(a){this.tM.vM=a},a.prototype.wM=function(a){this.tM.wM=a},a.prototype.xM=function(a){var b=this;b.tM.xM=function(c){if(a){a(c);var d=b.yM;d&&d.zM()}}},a.prototype.AM=function(a){this.tM.AM=a},a.prototype.BM=function(a){this.tM.BM=a},a.prototype.CM=function(a){this.uM.CM=a},a.prototype.DM=function(a){this.uM.DM=a},a.prototype.EM=function(a){this.uM.EM=a},a.prototype.FM=function(a){this.GM=a},a.prototype.HM=function(a){this.IM=a},a.prototype.JM=function(a,b){var c=b?b.KM:this.LM.KM;return e.Ul.Z3(a,c)},a.prototype.MM=function(a,b){var c,d,e,f,g,h,i=this,j=b.pointerType,k=b.target,l=b.offsetX,n=b.offsetY;j!==b[R]&&j!==G||(c=i.JM(k,a),d=c.EB,e=c.FB,f=i.NM(a,k,b.pointerId,new ha(l+d,n+e),b.timeStamp),f&&m(b),"sheet"===i.LM.OM&&(g=b.pageX-(l+d),h=b.pageY-(n+e),i.LM.KM.canvasOffset={top:h,left:g}))},a.prototype.PM=function(a){var b,c,d=this,e=a.pointerType,f=a.pointerId;if(e===a[R]||e===G){if(d.sM[f]===t)return!1;b=d.JM(a.target),c=d.aB(f,new ha(a.offsetX+b.EB,a.offsetY+b.FB),a.timeStamp),c&&m(a)}},a.prototype.QM=function(a){var b,c,d=this,e=a.pointerType,f=a.pointerId;if(e===a[R]||e===G){if(d.sM[f]===t)return!1;b=d.JM(a.target),c=d.RM(f,new ha(a.offsetX+b.EB,a.offsetY+b.FB)),c&&m(a)}},a.prototype.SM=function(a){var b,c,d=this,e=a.pointerType,f=a.pointerId;if(e===a[R]||e===G){if(d.sM[f]===t)return!1;b=d.JM(a.target),c=d.TM(f,new ha(a.offsetX+b.EB,a.offsetY+b.FB)),c&&m(a)}},a.prototype.UM=function(a,b){var c,d,e,f=jb(a.KM),g=b.changedTouches,h=!1;for(c=0;c<g.length;c++)d=g[c],e=n?bb():b.timeStamp,h=this.NM(a,b.target,d.identifier,new ha(d.pageX-f.EB,d.pageY-f.FB),e)||h;h&&m(b)},a.prototype.VM=function(a){var b,c,d,e=this,f=jb(e.LM.KM),g=a.changedTouches,h=!1;for(b=0;b<g.length;b++)c=g[b],d=n?bb():a.timeStamp,h=e.aB(c.identifier,new ha(c.pageX-f.EB,c.pageY-f.FB),d)||h;h&&m(a)},a.prototype.WM=function(a){var b,c,d=this,e=jb(d.LM.KM),f=a.changedTouches,g=!1;for(b=0;b<f.length;b++)c=f[b],g=d.RM(c.identifier,new ha(c.pageX-e.EB,c.pageY-e.FB))||g;g&&m(a)},a.prototype.XM=function(a){var b,c,d=this,e=jb(d.LM.KM),f=a.changedTouches,g=!1;for(b=0;b<f.length;b++)c=f[b],g=d.TM(c.identifier,new ha(c.pageX-e.EB,c.pageY-e.FB))||g;g&&m(a)},a.prototype.YM=function(a){var b,c,d=this,e=d.LM,f=d.ZM;e!==f&&(b=i(e.KM).offset(),c=i(f.KM).offset(),a.X+=b.left-c.left,a.Y+=b.top-c.top)},a.prototype.$M=function(a,b){var c,d,e,f,g,h=this,i=h.rM;for(h.ZM=s,h.yM=s,d=0;d<i.length;d++)if(i[d]===a){if(e=i[d],f=s,g=s,e._M&&!e._M()){for(d=0;d<i.length;d++)if(c=i[d],c!==e&&c.aN>=0&&c.aN<e.aN&&(!c._M||c._M())){f=c;break}if(f===s)return!1}if(e.bN&&!e.bN()){for(d=0;d<i.length;d++)if(c=i[d],c!==e&&c.aN>=0&&c.aN<e.aN&&(!c.bN||c.bN())){g=c;break}if(g===s)return!1}f===s&&(f=e),g===s&&(g=e),h.LM=e,h.ZM=f,h.cN=g,h.vM(g.dN||s),h.wM(f.eN||s),h.BM(f.fN||s),h.AM(f.gN||s),h.xM(f.hN||s),h.CM(g.iN||s),h.DM(g.jN||s),h.EM(g.kN||s),h.FM(f.GM||s),h.HM(f.IM||s),f.lN&&(h.yM=e.lN);break}return!0},a.prototype.NM=function(a,b,c,d,e){var f=this;return f.sM[c]===t&&(!(0===f.sM.length&&!f.$M(a,b))&&(!!f.ZM&&(f.sM.length>=f.ZM.mN||(!f.yM||!f.yM.nN())&&(f.YM(d),f.yM&&0===f.sM.length&&f.yM.oN(),f.sM[c]={id:c,time:bb(),position:d},f.sM.length++,f.tM.pN(b,c,d,e),f.tM.qN(c,d,f.sM.length,e),1===f.sM.length&&f.uM.qN(d),1===f.sM.length&&f.GM&&f.GM({rN:d}),!0))))},a.prototype.aB=function(a,b,c){var d=this;return d.sM[a]!==t&&((!d.yM||!d.yM.sN())&&(d.YM(b),d.sM[a]={id:a,time:bb(),position:b},d.tM.tN(a,b,c),!0))},a.prototype.RM=function(a,b){var c=this;return c.sM[a]!==t&&(delete c.sM[a],c.sM.length--,(!c.yM||!c.yM.uN())&&(c.YM(b),c.tM.vN(a),c.tM.wN(),0===c.sM.length&&(c.uM.vN(b),c.uM.wN()),0===c.sM.length&&c.IM&&c.IM({rN:b}),c.yM&&0===c.sM.length&&0===c.tM._process&&c.yM.zM(),!0))},a.prototype.TM=function(a,b){return this.RM(a,b)},a.prototype.xN=function(a,b){var c,f,h,j,k,l=this,m="."+a.OM,n=".gcSheet",o=I+n,p=J+n+m,q=K+n+m,r="MSPointerCancel"+n+m,s="MSLostPointerCapture"+n+m,t=L+n,u=M+n+m,v=N+n+m,w="LostPointerCapture"+n+m,x="pointercancel"+n+m,y=O+n,z=P+n,A=Q+n,B="touchcancel"+n;function C(){i(W).bind(p,F).bind(q,G).bind(u,F).bind(v,G).bind(r,R).bind(s,R).bind(w,R).bind(x,R)}function D(){i(W).unbind(p).unbind(u).unbind(q).unbind(v).unbind(r).unbind(x).unbind(s).unbind(w)}function E(b){C(),l.MM(a,b)}function F(a){l.PM(a)}function G(a){l.QM(a),0===l.sM.length&&D()}function R(a){l.SM(a),0===l.sM.length&&D()}c=a.KM,f=l.rM,h=d.Common.k.Cb(f,a),h>=0&&b||h<0&&!b||(j=e.Ul._Va(),b?j?(k=c.style,g(k.msTouchAction)||(k.msTouchAction=H),g(k.touchAction)||(k.touchAction=H),i(c).bind(o,E).bind(t,E)):(i(c).bind(y,function(b){l.UM(a,b)}),i(c).bind(z,function(a){l.VM(a)}).bind(A,function(a){l.WM(a)}).bind(B,function(a){l.XM(a)})):j?i(c).unbind(o).unbind(t):i(c).unbind(y).unbind(z).unbind(A).unbind(B),b?f.push(a):f.splice(h,1))},a.prototype.no=function(){var a,b=this,c=b.rM;for(a=c.length-1;a>=0;a--)b.xN(c[a],!1)},a}(),b.TouchEventProvider=ea;function kb(a,b){var c=y(b.Y,b.X)-y(a.Y,a.X);return c>z?c-=2*z:c<-z&&(c+=2*z),c}function lb(a,b){return B((b.X-a.X)*(b.X-a.X)+(b.Y-a.Y)*(b.Y-a.Y))}function mb(a,b,c){var d=new ha(c._Center.X,c._Center.Y),e=new ha(b.X-d.X,b.Y-d.Y),f=new ha(a.X-d.X,a.Y-d.Y),g=v(1,x(lb(b,d)/c._Radius,4)),h=kb(e,f);return S(h)?0:h*g}function nb(a){return u(a)<=2.220446049250313e-16}function ob(a,b){var c=!1,d=!1,e;return 0!==a&&(e=C(b/a)/z*180,e<20&&(c=!0)),0===a?d=!0:(e=C(b/a)/z*180,e>75&&e<105&&(d=!0)),{yN:c,zN:d}}fa=function(){function a(){var a=this;a.AN=0,a.BN=0,a.CN=1,a.DN=0,a.EN=0,a._process=0,a.FN=511,a.GN=new oa,a.HN=20,a.IN=new ia}return a.prototype.pN=function(a,b,c,d){var e,f=this;3===f._process&&f.JN(!0),f.KN=2===f._process&&1===f.GN.MN(),f.NN=a,e={},e.Np=b,e.ON=c,e.PN=c,f.GN.QN(e),f.RN=d,f.GN.MN()>1&&(f.SN=!1,f.TN=!1,1===f._process&&f.UN())},a.prototype.qN=function(a,b,c,d){0===this._process&&1===c&&this.VN(this.GN.WN(0).PN)},a.prototype.tN=function(a,b,c){var d,e,f,g,h,i,j,k=this;if(0!==k.FN&&k.GN.XN(a)){if(1===k._process&&1===k.GN.MN()){if(d=k.YN(),!k.ZN(1)&&!k.ZN(2)&&!d)return;if(e=k.GN.$N(a).PN,cb(b,e))return;f=u(b.X-e.X),g=u(b.Y-e.Y),k._N(f,g)}if(!(c-k.RN<da)){if(k.GN.$N(a).aO=b,h=k.GN.MN(),h>1)for(i=0;i<h;i++)if(j=k.GN.WN(i),!j.aO)return;for(k.bO(c),k.RN=c,h=k.GN.MN(),i=0;i<h;i++)j=k.GN.WN(i),j.ON=j.aO,j.aO=s}}},a.prototype.wN=function(){var a=this;a.cO&&(a.dO(a.cO),a.cO=s)},a.prototype.vN=function(a){var b=this;b.GN.XN(a)&&(b.GN.eO(a),2===b._process?0===b.GN.MN()&&(b.ZN(64)||b.ZN(256)||b.ZN(128)?b.fO():b.JN(!0)):3===b._process?b.JN(!0):1===b._process&&b.JN(!1))},a.prototype.bO=function(a){var b,c,d,e,f,g=this,h=g.gO(),i=h.hO,j=h.iO,k=h.SH,l=g.jO(),m=l.kO,n=l.eb,o=l.lO;if(g.AN+=i,g.BN+=j,g.CN*=n,g.DN+=m,g.EN+=o,b={},b.lO=o,b.kO=m,b.mO=a-g.RN,b.hO=i,b.iO=j,g.IN.nO(b),g.oO=k,1===g._process||2===g._process){if(1===g._process&&(c=g.UN()))return;if(d=new na,d.pO=o,d.qO=m,d.rO=n,d.sO=new ha(i,j),e=new ja(g.IN),f=new ra(g.NN,g.tO(),d,(!1),k,e),g.uO(f),f.vO)return void g.JN(!0)}},a.prototype.UN=function(){var a,b=this;return b._process=2,a=new ta(b.NN,b.GN.MN(),b.tO(),b.GN.WN(0).PN),b.wO(a),!!a.vO&&(b.JN(!0),!0)},a.prototype._N=function(a,b){var c=ob(a,b);this.SN=c.yN,this.TN=c.zN},a.prototype.gO=function(){var a=0,b=0,c=this.xO(),d=c.yO,e=c.zO,f=new ha(d.X,d.Y);return a=d.X-e.X,b=d.Y-e.Y,{hO:a,iO:b,SH:f}},a.prototype.jO=function(){var a,b=this,c=0,d=1,e=0;return b.ZN(16)&&1===b.GN.MN()&&b.YN()&&(c=mb(b.GN.WN(0).aO,b.GN.WN(0).ON,b.AO)),b.GN.MN()>1&&(a=b.BO(),c=a.kO,d=a.eb,e=a.lO),c=c/z*180,{kO:c,eb:d,lO:e}},a.prototype.BO=function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.xO(),n=m.yO,o=m.zO,p=l.YN(),q=p?l.AO._Center:new ha(0,0),r=0,s=1,t=0,u=0,v=0,w=0,x=0,y=l.GN.MN();for(a=0;a<y;a++)b=l.GN.WN(a),c=b.aO,d=b.ON,e=lb(c,n),f=lb(d,o),g=p?new ha(d.X-q.X,d.Y-q.Y):new ha(d.X-o.X,d.Y-o.Y),h=p?new ha(c.X-q.X,c.Y-q.Y):new ha(c.X-n.X,c.Y-n.Y),i=lb(d,q),j=lb(c,q),f>=l.HN&&e>=l.HN&&(v++,w+=e,x+=f,(!p||i>=l.HN)&&j>=l.HN&&(k=kb(g,h),r+=k,u++));return u>0&&l.ZN(16)?r/=u:r=0,v>0&&l.ZN(32)?(l.KN||(s=w/x),t=(w-x)/v,l.CO=w/v):l.CO=0,{kO:r,eb:s,lO:t}},a.prototype.ZN=function(a){return 0!==(this.FN&a)},a.prototype.xO=function(){var a,b,c,d,e,f,g=0,h=0,i=0,j=0,k=this.GN,l=k.MN();for(a=0;a<l;a++)b=k.WN(a),c=b.ON,d=b.aO,g+=c.X,h+=c.Y,i+=d.X,j+=d.Y;return e=new ha(g/l,h/l),f=new ha(i/l,j/l),{yO:f,zO:e}},a.prototype.YN=function(){var a=this.AO;return a&&!S(a._Radius)},a.prototype.VN=function(a){var b=this,c=new ua(b.NN,b.FN,s,a);return c.DO=511,b.EO(c),b.FO=c.DO,0===c.DO?(b.JN(!1),!1):(b.FN=c.DO,b.AO=c.GO,b._process=1,!0)},a.prototype.JN=function(a){var b,c=this,d=3===c._process;c._process=0,c.HO&&(ab(c.HO),c.HO=s),a&&(b=new qa(c.NN,c.tO(),d,pb(c.oO),new ja(c.IN)),3===c._process?c.cO=b:c.dO(b)),c.IN.IO(),c.GN.IO(),c.AO=s,c.AN=0,c.BN=0,c.CN=1,c.DN=0,c.EN=0,c.SN=!1,c.TN=!1,c.FN=0},a.prototype.fO=function(){var a,b,c=this,d={},e=new ja(c.IN);return d.JO=c.ZN(64)?e.KO().X:0,d.LO=c.ZN(64)?e.KO().Y:0,d.MO=c.ZN(256)?e.pO():0,d.NO=c.ZN(128)?e.OO():0,0===d.JO&&0===d.LO&&0===d.MO&&0===d.NO?void c.JN(!0):(d.PO=new ma(d.JO,d.LO),d.QO=new ka(d.MO),d.RO=new la(d.NO),e=new ja(s,d.JO,d.LO,d.NO,d.MO),a=new sa(c.NN,c.tO(),new na,e,d.QO,d.RO,d.PO),c.SO(a),d.PO=a.TO,d.QO=a.QO,d.RO=a.RO,d.PO.UO<=0&&d.PO.VO<=0&&d.PO.WO(.003),d.QO.XO()<=0&&d.QO.WO(.002),d.RO.XO()<=0&&d.RO.WO(.003),b=bb(),d.YO=b,d.ZO=b,d.$O=0,d._O=0,c._process=3,void(c.HO=V.setInterval(function(){try{c.aP(d)}catch(a){}},20)))},a.prototype.aP=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=bb(),q=p-a.ZO;if(0!==q){if(b=a.JO,c=a.LO,d=a.MO,e=a.NO,a.JO=o.bP(q,a.PO.UO,a.JO),a.LO=o.bP(q,a.PO.VO,a.LO),a.MO=o.bP(q,a.QO.XO(),a.MO),a.NO=o.bP(q,a.RO.XO(),a.NO),b=(b+a.JO)/2,c=(c+a.LO)/2,d=(d+a.MO)/2,e=(e+a.NO)/2,a.ZO=p,f=!1,nb(b)&&nb(c)&&nb(d)&&nb(e)&&(f=!0),g=q*b,h=q*c,i=q*d,j=q*e,k=1,o.CO>0&&(o.CO+2*i<0&&(i=-o.CO/2+1),0!==o.CO&&(k=(o.CO+2*i)/o.CO)),o.EN+=i,o.DN+=j,o.AN+=g,o.BN+=h,o.CN*=k,o.CO+=i,o.oO=new ha(o.oO.X+g,o.oO.Y+h),a.$O+=g,a._O+=h,f){if(g=A(a.$O),h=A(a._O),nb(g)&&nb(h))return void o.JN(!0)}else u(a.$O)>=1&&(g=a.$O,a.$O-=g),u(a._O)>=1&&(h=a._O,a._O-=h);return l=new na,l.sO=new ha(g,h),l.rO=k,l.pO=i,l.qO=j,m=new ja(s,a.JO,a.LO,a.NO,a.MO),n=new ra(o.NN,o.tO(),l,(!0),pb(o.oO),m),o.uO(n),n.vO?void o.JN(!0):void(f&&o.JN(!0))}},a.prototype.bP=function(a,b,c){if(nb(c))return 0;var d;return d=c<0?c+b*a:c-b*a,(d<0&&c>0||d>0&&c<0)&&(d=0),d},a.prototype.tO=function(){var a=this,b=new na;return b.pO=a.EN,b.qO=a.DN,b.rO=a.CN,b.sO=new ha(a.AN,a.BN),b},a.prototype.cP=function(a,b,c,d){var e,f=this,g=new na,h=new na,i=0,j=0,k=0,l=0,m=f.ZN(4)&&f.SN,n=f.ZN(8)&&f.TN;return!f.ZN(1)||n||a&&!f.ZN(64)||(g.sO.X=b.sO.X,h.sO.X=c.sO.X,i=d.KO().X),!f.ZN(2)||m||a&&!f.ZN(64)||(g.sO.Y=b.sO.Y,h.sO.Y=c.sO.Y,j=d.KO().Y),!f.ZN(32)||a&&!f.ZN(256)?(g.rO=b.rO,h.rO=1):(g.rO=b.rO,g.pO=b.pO,h.rO=c.rO,h.pO=c.pO,l=d.pO()),!f.ZN(16)||a&&!f.ZN(128)||(g.qO=b.qO,h.qO=c.qO,k=d.OO()),e=new ja(s,i,j,k,l),new pa(g,h,e)},a.prototype.EO=function(a){this.vM&&a&&this.vM(a)},a.prototype.wO=function(a){this.wM&&a&&this.wM(a)},a.prototype.dO=function(a){var b,c=this;c.xM&&a&&(b=c.cP(!1,a.dP,a.dP,a.eP),a.dP=b.dP,a.eP=b.eP,c.xM(a))},a.prototype.SO=function(a){var b,c=this;c.AM&&a&&(b=c.cP(!1,a.dP,a.fP,a.eP),a.dP=b.dP,a.fP=b.fP,a.eP=b.eP,c.AM(a))},a.prototype.uO=function(a){var b,c=this;c.BM&&a&&(b=c.cP(a.gP,a.dP,a.fP,a.eP),a.dP=b.dP,a.fP=b.fP,a.eP=b.eP,c.BM(a))},a}(),ga=function(){function a(){}return a.prototype.qN=function(a){var b,c=this;c._pointerCount++,c._pointerCount>1||(b=bb(),c.hP&&cb(a,c.hP)&&b-c.iP<ba?c.Jb++:(c.hP=a,c.Jb=1),c.jP=a,c.iP=b)},a.prototype.wN=function(){var a=this;a.cO&&(a.cO instanceof va?a.kP(a.cO):a.cO instanceof wa&&a.lP(a.cO),a.cO=s)},a.prototype.vN=function(a){var b,c=this;c._pointerCount--,c._pointerCount>0||(b=bb(),cb(a,c.jP)?b-c.iP>ca?c.cO=new wa(c.jP):c.Jb>1?(c.Jb=0,c.mP(new xa(c.hP)),c.hP=s):c.cO=new va(c.jP):c.hP=s)},a.prototype.nP=function(){this.hP=s},a.prototype.kP=function(a){this.CM&&a&&this.CM(a)},a.prototype.mP=function(a){this.DM&&a&&this.DM(a)},a.prototype.lP=function(a){this.EM&&a&&this.EM(a)},a}(),ha=function(){function a(a,b){this.X=a,this.Y=b}return a}(),b.oP=ha;function pb(a){return new ha(a?A(a.X):-1,a?A(a.Y):-1)}ia=function(){function a(){var a=this;a.Jb=0,a.oI=0,a.pP=10,a.qP=[]}return a.prototype.rP=function(a){var b,c,d,e,f,g,h=this;if(0===h.Jb)return 0;for(b=0,c=(1+h.Jb)*h.Jb/2,d=h.Jb-1;d>=0;d--)e=0,f=h.sP(d),0===a?e=f.hO:1===a?e=f.iO:2===a?e=f.lO:3===a&&(e=f.kO),g=h.tP(e,f.mO),g*=d+1,b+=g;return b/c},a.prototype.tP=function(a,b){return a/b},a.prototype.sP=function(a){return this.qP[this.uP(a)]},a.prototype.vP=function(){return this.qP[this.Jb-1]},a.prototype.nO=function(a){var b,c,d=this;for(10===d.Jb&&d.wP(),d.Jb++,d.qP[d.uP(d.Jb-1)]=a,b=da*d.pP,c=0;c<d.Jb;c++)a.mO-d.qP[c].mO>b&&(d.wP(),c--)},a.prototype.wP=function(){var a=this;a.oI++,a.oI===a.pP&&(a.oI=0),a.Jb--},a.prototype.IO=function(){this.Jb=0},a.prototype.uP=function(a){return(this.oI+a)%this.pP},a}(),ja=function(){function a(a,b,c,d,e){var f=this;a?f.qP=a:(f.xP=new ha(b,c),f.yP=d,f.lO=e)}return a.prototype.KO=function(){var a=this;return a.xP||(a.xP=new ha(a.qP.rP(0),a.qP.rP(1))),a.xP},a.prototype.OO=function(){var a=this;return g(a.yP)&&(a.yP=a.qP.rP(3)),a.yP},a.prototype.pO=function(){var a=this;return g(a.lO)&&(a.lO=a.qP.rP(2)),a.lO},a}(),ka=function(){function a(a){this.zP=a,this.AP=0}return a.prototype.XO=function(){var a=this,b=a._DesiredExpansion,c=a._DesiredDeceleration,d=a.zP;return S(b)||0===b?S(c)?a.AP:c:.5*d*d/b},a.prototype.WO=function(a){this.AP=a},a}(),la=function(){function a(a){this.zP=a,this.AP=0}return a.prototype.XO=function(){var a=this,b=a._DesiredRotation,c=a._DesiredDeceleration,d=a.zP;return S(b)||0===b?S(c)?a.AP:c:.5*d*d/b},a.prototype.WO=function(a){this.AP=a},a}(),ma=function(){function a(a,b){var c=this;c.BP=a,c.CP=b,c.UO=0,c.VO=0,c.AP=0,c.DP=B(a*a+b*b)}return a.prototype.EP=function(){var a=this,b=a._DesiredDisplacement,c=a.DP,d=a.BP,e=a.CP,f=a.XO();S(b)||0===b?S(f)||0===f?(a.UO=0,a.VO=0):(a.UO=f*u(d)/c,a.VO=f*u(e)/c):(a.UO=.5*c*u(d)/b,a.VO=.5*c*u(e)/b)},a.prototype.XO=function(){var a=this,b=a._DesiredDeceleration;return S(b)&&S(a._DesiredDisplacement)?a.AP:b},a.prototype.WO=function(a){this.AP=a,this.EP()},a}(),na=function(){function a(){var a=this;a.sO=new ha(0,0),a.rO=0,a.qO=0,a.pO=0}return a}(),oa=function(){function a(){this.FP=[]}return a.prototype.XN=function(a){var b,c,d=this.FP;for(b=0;b<d.length;b++)if(c=d[b],c.Np===a)return!0;return!1},a.prototype.QN=function(a){this.FP.push(a)},a.prototype.eO=function(a){var b,c=this.FP;for(b=0;b<c.length;b++)if(c[b].Np===a){c.splice(b,1);break}},a.prototype.MN=function(){return this.FP.length},a.prototype.WN=function(a){return this.FP[a]},a.prototype.$N=function(a){var b,c,d=this.FP;for(b=0;b<d.length;b++)if(c=d[b],c.Np===a)return c;return s},a.prototype.IO=function(){var a=this.FP;a.splice(0,a.length)},a}(),pa=function(){function a(a,b,c){var d=this;d.dP=a,d.fP=b,d.eP=c}return a}(),qa=function(){function a(a,b,c,d,e){var f=this;f.GP=a,f.dP=b,f.gP=c,f.rN=d,f.eP=e}return a}(),b.ManipulationCompletedEventArgs=qa,ra=function(){function a(a,b,c,d,e,f){var g=this;g.GP=a,g.dP=b,g.fP=c,g.gP=d,g.rN=e,g.eP=f}return a}(),b.ManipulationDeltaEventArgs=ra,sa=function(){function a(a,b,c,d,e,f,g){var h=this;h.GP=a,h.dP=b,h.fP=c,h.eP=d,h.QO=e,h.RO=f,h.TO=g}return a}(),ta=function(){function a(a,b,c,d){var e=this;e.GP=a,e.HP=b,e.dP=c,e.rN=d}return a}(),b.ManipulationStartedEventArgs=ta,ua=function(){function a(a,b,c,d){var e=this;e.GP=a,e.DO=b,e.GO=c,e.rN=d}return a}(),b.ManipulationStartingEventArgs=ua,va=function(){function a(a){this.rN=a}return a}(),wa=function(){function a(a){this.rN=a}return a}(),xa=function(){function a(a){this.rN=a}return a}();function qb(a,b){var c=a*b;return c>4?c=4:c<.5&&(c=.5),c}ya=function(){function a(a){this.kj=a}return a.prototype.IP=function(a,b){var c=this.Xs;return c?a===e.En.Nn(c)&&b===e.En.On(c)||e.En.Pn(c,a,b):(c=l("canvas"),e.En.Kn(c,s,this.kj),e.En.Pn(c,a,b)),c},a.prototype.JP=function(a,b,c,d){var f=this,g=e.En.Nn(a),h=e.En.On(a),i=f.IP(g,h),j=i.getContext("2d"),k=e.En.Ln(i),l=e.En.Mn(i);e.Bn.Cn(j,1,1),j.drawImage(a,0,0,_a(i),$a(i),0,0,_a(i),$a(i)),e.Bn.Cn(j,k,l),f.Xs=i,f.KP=b,f.LP=c,f.MP=d},a.prototype.NP=function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o=this,p=o.kj,q=e.En.Nn(a),r=e.En.On(a),t=fb(p),u=gb(p),v=t>0?1:0,w=u>0?1:0,x=o.LP,y=Ab(p),z=o.KP,A=p.am(),B=b/o.MP,C=a.getContext("2d"),D=e.En.Ln(a),E=e.En.Mn(a),F=o.Xs;C.save(),C.fillStyle=c,C.fillRect(0,0,q,r),m=p.rowOutlines,n=p.columnOutlines,m&&m.jp(p,C,s,!0),n&&n.jp(p,C,s,!1),d=x.x+_a(x),f=x.y+$a(x),g=z.lt-d-v,h=z.ot-f-w,i=y.x+_a(y),j=y.y+$a(y),k=g*B,l=h*B,d*=D,f*=E,g*=D,h*=E,i*=D,j*=E,k*=D,l*=E,e.Bn.Cn(C,1,1),C.drawImage(F,d,f,g,h,i,j,k,l),t>0&&(d=z.lt-v,f=x.y+$a(x),g=z.js+v,h=z.ot-f-w,i=A.lt-v,j=y.y+$a(y),k=A.js+v,l=h*B,d*=D,f*=E,g*=D,h*=E,i*=D,j*=E,k*=D,l*=E,C.drawImage(F,d,f,g,h,i,j,k,l)),u>0&&(d=x.x+_a(x),f=z.ot-w,g=z.lt-d-v,h=z.gs+w,i=y.x+_a(y),j=A.ot-w,k=g*B,l=A.gs+w,d*=D,f*=E,g*=D,h*=E,i*=D,j*=E,k*=D,l*=E,C.drawImage(F,d,f,g,h,i,j,k,l)),t>0&&u>0&&(d=z.lt-v,f=z.ot-w,g=z.js+v,h=z.gs+w,i=A.lt-v,j=A.ot-w,k=A.js+v,l=A.gs+w,d*=D,f*=E,g*=D,h*=E,i*=D,j*=E,k*=D,l*=E,C.drawImage(F,d,f,g,h,i,j,k,l)),e.Bn.Cn(C,D,E),C.restore()},a.prototype.OP=function(){var a=this,b=a.kj,c=b.zoom(),d=b.yl.vI();d&&a.JP(d.canvas,b.am(),Ab(b),c)},a.prototype.PP=function(a){var b,c,d,f,g,h,i=this,j=i.kj;if(j.endEdit()&&(b=qb(a,i.MP),c=j.zoom(),d=j.name(),c!==b)){if(f={sheet:j,sheetName:d,oldZoomFactor:c,newZoomFactor:b,cancel:!1},j.Wq(e.Events.ViewZooming,f),f&&f.cancel===!0)return;b=f.newZoomFactor,j.XSa(b),j.Wq(e.Events.UserZooming,{sheet:j,sheetName:d,oldZoomFactor:c,newZoomFactor:b}),j.Wq(e.Events.ViewZoomed,{sheet:j,sheetName:d,oldZoomFactor:c,newZoomFactor:b}),j.invalidateLayout(),g=j.yl,h=g.bm(),h&&i.NP(h.canvas,b,g.zI(!1)),j.QP&&j.QP(s,b),j.RP&&j.RP(s)}},a.prototype.SP=function(a){var b,c=this,d=c.kj,f=d.name(),g=qb(a,c.MP),h=d.zoom();if(g!==h){if(b={sheet:d,sheetName:f,oldZoomFactor:h,newZoomFactor:g,cancel:!1},d.Wq(e.Events.ViewZooming,b),b&&b.cancel===!0)return;g=b.newZoomFactor,d.XSa(g),d.Wq(e.Events.UserZooming,{sheet:d,sheetName:f,oldZoomFactor:h,newZoomFactor:g}),d.Wq(e.Events.ViewZoomed,{sheet:d,sheetName:f,oldZoomFactor:h,newZoomFactor:g})}d.oq=!0,d.jq=!0,d.$p()},a}(),b.TP=ya,za=200,Aa=20;function rb(a,b,c,d){var e,f,g,h,i,j,k,l=c,m=0,n=0,o=a.ss,p=a.am(),q=p.qt,r=a.jt(1).findRow(l),t=a.parent,u=t&&t.options.scrollByPixel&&t.options.scrollbarMaxAlign;if(r)if(b>0){for(e=a.Rt(-1),m=q-r.y;l>e&&m<b;)l--,m+=o.Sl(l);n=b-m}else if(b<0){if(g=0,h=d,u){if(i=a.frozenRowCount(),j=a.getRowCount()-a.frozenTrailingRowCount()-1,k=a.PHb(a.tNc(p),i,j),f=k.cj,g=k.UP,h=d+b,l>f||l===f&&h<g)return s}else f=a.ns();for(m=-(r.y+$a(r)-q);l<f&&m>b;)l++,m-=o.Sl(l);n=b-m,u&&l===f&&h<g&&(n=g+o.Sl(l),b=n+m)}return{cj:l,UP:n,b_J:b}}function sb(a,b,c,d){var e,f,g,h,i,j,k,l=c,m=0,n=0,o=a.ss,p=a.am(),q=p.pt,r=a.it(1).findCol(l),t=a.parent,u=t&&t.options.scrollByPixel&&t.options.scrollbarMaxAlign;if(r)if(b>0){for(e=a.Ot(-1),m=q-r.x;l>e&&m<b;)l--,m+=o._m(l);n=b-m}else if(b<0){if(g=0,h=d,u){if(i=a.frozenColumnCount(),j=a.getColumnCount()-a.frozenTrailingColumnCount()-1,k=a.QHb(a.wNc(p),i,j),f=k.dj,g=k.UP,h=d+b,l>f||l===f&&h<g)return s}else f=a.ps();for(m=-(r.x+_a(r)-q);l<f&&m>b;)l++,m-=o._m(l);n=b-m,u&&l===f&&h<g&&(n=g+o._m(l),b=n+m)}return{dj:l,UP:n,c_J:b}}function tb(a,b){return T(-b/(a/b+1)+b+"")}function ub(a,b){return T(b*(-b/(a-b)-1)+"")}function vb(a,b,c,d,e,f){a.fillStyle=b,a.fillRect(c,d,e,f)}function wb(a,b,c,d,f){var g,h,i,j,k,l=e.Im.Km(0,"gc-columnHeader-normal"),m=l&&l.backgroundImage,n=l&&l.backgroundColor;if(m&&m.indexOf("linear-gradient")!==-1)for(h=e.Ul.wl(m),g=a.createLinearGradient(b+d/2,c,b+d/2,c+f),i=0,j=h.length;i<j;i++)k=h[i],g.addColorStop(k.point,k.color);else n&&(g=n);return g}function xb(){var a=e.Im.Km(0,"gc-rowHeader-normal");return a&&a.backgroundColor}function yb(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=a.am(),o=a.yl,p=a.options,q=p.sheetAreaOffset,r=q.left,s=q.top,t=o.zI(!1),u=o.bm(),v=o.vI(),w=a.jt(1),x=Ab(a),y=n.zNc,z=n.xNc,A=n.ANc,B=n.uNc,C=n.zr,D=r>=1?1:0,E=s>=1?1:0,F=_a(n);u.save(),v.save(),e=a.Rt(-1),f=w.findRow(e),f&&(c=n.qt,d=f.y-c-1-E,d>0&&(b?(g=n.Br,h=xb(),vb(u,h,C,c,g-1,d+1),vb(v,h,C,c,g-1,d+1),vb(u,t,C+g,c,F-g-x.width,d),vb(v,t,C+g,c,F-g-x.width,d)):(vb(u,t,C,c,F,d),vb(v,t,C,c,F,d)))),B>$&&(d=B-$-E,vb(u,t,C,A,F,d),vb(v,t,C,A,F,d)),i=a.it(1),c=n.Ar,d=$a(n),j=a.Ot(-1),k=i.findCol(j),k&&(C=n.pt,F=k.x-C-1-D,F>0&&(b?(l=n.Cr,m=wb(u,C,c,F+1,l-1),vb(u,m,C,c,F+1,l-1),vb(v,m,C,c,F+1,l-1),vb(u,t,C,c+l,F,d-l-x.height),vb(v,t,C,c+l,F,d-l-x.height)):(vb(u,t,C,c,F,d),vb(v,t,C,c,F,d)))),z>$&&(F=z-$-D,vb(u,t,y,c,F,d),vb(v,t,y,c,F,d)),v.restore(),u.restore()}function zb(a,b,c,d,e,f){a.beginPath(),a.strokeStyle=b,a.moveTo(c,d),a.lineTo(e,f),a.stroke()}function Ab(a){var b=a.options,c=b.sheetAreaOffset;return a.Gt&&a.Gt()||{x:c.left,y:c.top,width:0,height:0}}function Bb(a,b){var c,d,e,f,g,h,i,j=a.am(),k=a.yl,l=k.bm(),m=a.jt(1),n=Ab(a),p=a.Rt(-1),q=m.findRow(p),r=o("gc-group").color;q&&(c=j.qt,d=q.y-c,d>0&&b&&n.width>0&&0===j.Br&&zb(l,r,j.kt-.5,c,j.kt-.5,q.y)),e=a.it(1),f=a.Ot(-1),g=e.findCol(f),g&&(h=j.pt,i=g.x-h,i>0&&b&&n.height>0&&0===j.Cr&&zb(l,r,h,j.nt-.5,g.x,j.nt-.5))}function Cb(a,b){var c,d,f,g,h,i=a.am(),j=a.yl,k=a.options.gridline.color,l=e.Im.Km(0,"gc-columnHeader-normal"),m=l&&l.borderBottomColor,n=j.bm(),o=a.jt(1),p=Ab(a),q=i.zr,r=_a(i),s=a.Rt(-1),t=o.findRow(s);t&&(c=i.qt,d=t.y-c,d>0&&(zb(n,k,q,t.y-.5,q+r-p.width,t.y-.5),b&&(0===p.width&&zb(n,k,i.zr-.5,c,i.zr-.5,t.y),zb(n,m,i.kt-.5,c,i.kt-.5,t.y)))),f=a.it(1),c=i.Ar,d=$a(i),g=a.Ot(-1),h=f.findCol(g),h&&(q=i.pt,r=h.x-q,r>0&&(zb(n,k,h.x-.5,c,h.x-.5,c+d-p.height),b&&(0===p.height&&zb(n,k,q,i.Ar-.5,h.x,i.Ar-.5),zb(n,m,q,i.nt-.5,h.x,i.nt-.5))))}function Db(a,b){var c=0;return a||(c|=1),b||(c|=2),c}function Eb(a,b){var c=0;return c|=0!==a?1:0,c|=0!==b?2:0}Ba=function(){function a(a){this.kj=a}return a.prototype.VP=function(a){var b=this.kj;b.eCb=a},a.prototype.WP=function(a){var b=this.kj;b.cCb=a},a.prototype.XP=function(){var a=this.kj;a.invalidateLayout()},a.prototype.ju=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,w,x,y,z,A,B,C,D,E,F,G,H=this,I=H.kj,J=I.options,K=I.lq,L=I.cCb,M=rb(I,a,K,L);if(!M)return!1;if(f=M.cj,g=M.UP,a=M.b_J,I.lq=f,I.Xq>0)return!1;if(h=I.Dr(),i=I.am(),j=i.qt,k=I.tNc(i),l=i.gs,m=i.ot,n=i.uNc,o=h?h.x:i.x,p=_a(i),t=J.sheetAreaOffset,w=I.BBJ,p+=t.left,a<0)H.YP=0,H.ZP=0,x=void 0,y=void 0,z=I.jt(1),z&&z.length>0&&(x=z.findRow(f)),x&&(y=z[z.length-1],y.row>=f&&(q=2+t.top,r=j+u(a),s=v(j+k,y.y+$a(y))-r,s>=0&&(s-=q,H.WP(g-$a(x)),c.x=o,c.y=r,c.width=p,c.height=s,c.tx=o,c.ty=j,A=w?k:k+l+n,d.x=o,d.y=j+s,d.width=p,d.height=A-s)));else if(a>0){if(B=I.Rt(-1),C=void 0,D=void 0,E=I.parent&&I.parent.options.scrollByPixel,E&&g>0&&(a-=g,g=0),f===B&&g>0)if(H.YP>0&&H.ZP>0){if(C=H.YP+a,D=tb(C,za),a=D-H.ZP,g=D,a<=0)return b;if(b&&D>=Aa)return!0;H.YP=C,H.ZP=D}else{if(g>=za&&(a-=g-(za-1),g=za-1,a<=0))return b;if(C=ub(g,za),D=g,b&&D>=Aa)return!0;H.YP=C,H.ZP=D}else H.YP=0,H.ZP=0;F=w?k:k+l,a<F&&(q=2+t.top,r=j,s=k-a,gb(I)>0&&(s-=$),H.WP(g),!w&&n>0&&(G=v(h.height-l-$,m-$+a),e.x=o,e.y=m-$,e.width=p,e.height=l+$,e.tx=o,e.ty=G),c.x=o,c.y=r,c.width=p,c.height=s+(w?0:v(a,n)-$),c.tx=o,c.ty=r+a,d.x=o,d.y=r,d.width=p,d.height=a+q)}return!1},a.prototype.lu=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,w,x,y,z,A,B,C,D,E,F,G,H,I=this,J=I.kj,K=J.qq,L=J.eCb,M=sb(J,a,K,L);if(!M)return!1;if(f=M.dj,g=M.UP,a=M.c_J,J.qq=f,J.Xq>0)return!1;if(h=J.Dr(),i=J.am(),j=i.pt,k=J.wNc(i),l=i.js,m=i.lt,n=i.xNc,o=h?h.y:i.y,p=$a(i),x=J.options.sheetAreaOffset,y=J.CBJ,p+=x.top,a<0)I.$P=0,I._P=0,z=void 0,A=void 0,B=J.it(1),B&&B.length>0&&(z=B.findCol(f)),z&&(A=B[B.length-1],A.col>=f&&(q=2+x.left,r=j+u(a),s=v(j+k,A.x+_a(A))-r,s>=0&&(s-=q,I.VP(g-_a(z)),c.x=r,c.y=o,c.width=s,c.height=p,c.tx=j,c.ty=o,C=y?k:k+l+n,d.x=j+s,d.y=o,d.width=C-s,d.height=p)));else if(a>0){if(D=J.Ot(-1),E=J.parent&&J.parent.options.scrollByPixel,E&&g>0&&(a-=g,g=0),f===D&&g>0)if(I.$P>0&&I._P>0){if(t=I.$P+a,w=tb(t,za),a=w-I._P,g=w,a<=0)return b;if(b&&w>=Aa)return!0;I.$P=t,I._P=w}else{if(g>=za&&(a-=g-(za-1),g=za-1,a<=0))return b;if(t=ub(g,za),w=g,b&&w>=Aa)return!0;I.$P=t,I._P=w}else I.$P=0,I._P=0;F=y?k:k+l,a<F&&(q=2+x.left,r=j,s=k-a,fb(J)>0&&(s-=$),I.VP(g),G=0,!y&&n>0&&(G=l,H=v(h.width-G-$,m-$+a),e.x=m-$,e.y=o,e.width=G+$,e.height=p,e.tx=H,e.ty=o),c.x=r,c.y=o,c.width=s+(y?0:v(a,n)-$),c.height=p,c.tx=r+a,c.ty=o,d.x=r,d.y=o,d.width=a+q,d.height=p)}return!1},a.prototype.aQ=function(a,b,c,d){var f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P=this,Q=P.kj,R=!0,S=!0,T=Q.yl,U=T.bm(),V=0!==(2&c),W=0!==(1&c);if(W||V)return k={},l={},m=Q.Dr(),n=Q.am(),o=m?m.y:n.y,p=$a(n),q=m?m.x:n.x,r=_a(n),V&&(h={},f={},R=P.ju(b,d,f,h,k),s=k.x,t=k.y,u=_a(k),x=$a(k),y=k.tx,z=k.ty,g(s)||T.Ow(s,t,u,x,y,z),T.Ow(f.x,f.y,_a(f),$a(f),f.tx,f.ty)),W&&(i={},j={},S=P.lu(a,d,i,j,l),A=l.x,B=l.y,C=_a(l),D=$a(l),E=l.tx,F=l.ty,g(A)||T.Ow(A,B,C,D,E,F),T.Ow(i.x,i.y,_a(i),$a(i),i.tx,i.ty),V||(h=j)),G=Q.parent,G&&!G.options.scrollbarShowMax&&(W&&(Q.oq=!0),V&&(Q.jq=!0)),P.XP(),H=Q.rowOutlines&&!Q.rowOutlines.iT()?1:0,I=Q.columnOutlines&&!Q.columnOutlines.iT()?1:0,W&&V?T._l(U,new e.Rect(h.x,h.y,_a(h),$a(h)+H),new e.Rect(j.x,j.y,_a(j)+I,$a(j))):T._l(U,new e.Rect(h.x,h.y,_a(h)+I,$a(h)+H)),J=new e.Rect(q,o,r,p),K=Q.getSelections(),K&&K.length>0&&(L=Q.getRangeRect(1,1,K[0]),M=w(J.x+J.width,L.x+L.width),N=w(J.y+J.height,L.y+L.height),J.x=v(J.x,L.x),J.y=v(J.y,L.y),J.width=M-J.x+1,J.height=N-J.y+1),T.dm(J),T.Pw(U,J),Cb(Q,!0),yb(Q,!0),P.bQ(W,V),Bb(Q,!0),O=Q.options.sheetAreaOffset,Q.options.rowHeaderVisible||T.B0a(U,new e.Rect(q,o,2,p+O.top)),Q.options.colHeaderVisible||T.B0a(U,new e.Rect(q,o,r+O.left,2)),R&&S},a.prototype.bQ=function(a,b){var c=this.kj;b&&c.os(),a&&c.qs(),c.mm.Qw()},a.prototype.dQ=function(a,b,c){function d(a,b,c,d){return a/=c,x(.75,a)*d*(b?1:-1)}function e(a,b,c){return a=u(a),a/=c,D(a)/D(.75)*b}var f=this,g=f.kj,h=za,i=10,j=20,k=100,l=e(a,i,h),m=e(b,i,h),n=a,o=b,p=0,q=0,r=!1,t=!1;f.jI=V.setInterval(function(){var e,u,v,w,x;return r&&t?(g.ss.jn(),e=g.parent,e&&!e.options.scrollbarShowMax&&(g.oq=!0,g.jq=!0),g.ss.kn(),g.cCb=0,g.eCb=0,g.$p(),g.qs(),g.os(),ab(f.jI),void(f.jI=s)):(l+=j,m+=j,void(l>k&&m>k?(f.aQ(a-p,b-q,Db(r,t),c),r=!0,t=!0):(l>k&&!r&&(f.aQ(a-p,0,1,c),r=!0),m>k&&!t&&(f.aQ(0,b-q,2,c),t=!0),u=d(l,a>0,i,h),v=d(m,b>0,i,h),w=E(n-u),x=E(o-v),f.aQ(w,x,Db(r,t),c),n=u,o=v,p+=w,q+=x)))},j)},a.prototype.qG=function(a){var b=this,c=b.kj,d=c.ss;b.jI&&(d.kn(),ab(b.jI),b.jI=s),b.$P=0,b._P=0,b.YP=0,b.ZP=0,b.eQ=c.lq,b.fQ=c.qq,a&&d.b8J()},a.prototype.NG=function(a,b){var c=this,d=c.kj,f=d.parent,g=f.options.scrollbarAppearance===e.ScrollbarAppearance.mobile,h=f.VJc,i=f.UJc,j=f.ku,k=T(a.X+""),l=T(a.Y+""),m=Eb(k,l);return g&&(0!==l&&(h.Jwa(e.ScrollbarState.show),j.Rec(!0)),0!==k&&(i.Jwa(e.ScrollbarState.show),j.Rec(!1))),this.aQ(k,l,m,b)},a.prototype.gQ=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=o.kj,q=o.eQ,r=p.lq,s=o.fQ,t=p.qq,u=p.parent&&p.parent.options.scrollByPixel;return u?(p.ss.kn(),p.$p(),void o.rKJ()):(b=p.am(),c=b.pt,d=b.qt,e=p.it(1),g=p.ps(),h=1,e&&e.length>0&&(f=e.findCol(t),t<g&&f&&f.x+_a(f)-c<_a(f)/2?t++:h=-1),i=p.jt(1),k=p.ns(),l=1,i&&i.length>0&&(j=i.findRow(r),r<k&&j&&j.y+$a(j)-d<$a(j)/2?r++:l=-1),m=0,n=0,e&&e.length>0&&(f=e.findCol(t),m=c-f.x),i&&i.length>0&&(j=i.findRow(r),n=d-j.y),r!==q&&p.mq(r,0,q),t!==s&&p.rq(t,0,s),m=h*m,n=l*n,void o.dQ(m,n,a))},a.prototype.rKJ=function(){var a=this,b=a.kj,c=a.eQ,d=b.lq,f=a.fQ,g=b.qq;c!==d&&b.Wq(e.Events.TopRowChanged,{sheet:b,sheetName:b.name(),oldTopRow:c,newTopRow:d}),f!==g&&b.Wq(e.Events.LeftColumnChanged,{sheet:b,sheetName:b.name(),oldLeftCol:f,newLeftCol:g})},a}();function Fb(a,b,c,d,e){var f,g,h,i,j,k=a.parent,l=a.mm,m=a.options,n=b.rowViewportIndex,o=b.colViewportIndex,p=eb(a),q=s;return a.CH&&p.length>0&&(f=p[p.length-1],g=f.row,h=f.row+f.rowCount-1,i=f.col,j=f.col+f.colCount-1,k&&!k.options.allowUserResize||(g!==-1&&i===-1&&n>=0&&o<0&&m.rowHeaderVisible?(q=l.mH(a,b,e,2,d),!q||"sizeRow"!==q.action&&"sizeHiddenRow"!==q.action||2!==q.sheetArea||q.index===h||(q=s)):g===-1&&i!==-1&&n<0&&o>=0&&m.colHeaderVisible&&(q=l.oH(a,b,e,1,c),!q||"sizeCol"!==q.action&&"sizeHiddenCol"!==q.action||1!==q.sheetArea||q.index===j||(q=s)))),q}function Gb(a,b,c,d){var e,f,h,i,j,k,l,m,n;if(0===a.selectionPolicy())return s;for(e=b.hitTestType,f=Tb(a),h=eb(a),i=3,a.CH&&h.length>0&&(j=h[h.length-1],j.row!==-1&&j.col!==-1?i=3:j.row!==-1?i=2:j.col!==-1&&(i=1)),k=0;k<f.length;k++)if(l=f[k],l&&(l.x-=_a(l),l.y-=$a(l),l.width*=3,l.height*=3,l.contains(c,d)))return g(b.row)&&(m=a.jt(1),m&&m.length>0&&(b.row=m[m.length-1].row)),g(b.col)&&(n=a.it(1),n&&n.length>0&&(b.col=n[n.length-1].col)),{x:c,y:d,type:i,isHeader:!1,isFirstIndicator:0===k};return 1===e?{x:c,y:d,type:1,isHeader:!0}:2===e?{x:c,y:d,type:2,isHeader:!0}:s}function Hb(a,b,c,d){var e,f,h,i,j,k,l,m,n,o,p,q,r=s,t=b.rowViewportIndex,u=b.colViewportIndex;if(g(t)||g(u))return r;if(e=a.parent,f=a.Ix(),t>=0&&u>=0&&1===a.ITa.getSelections().length){if(h=a.Tq(f),i=fb(a),j=gb(a),k=hb(a)-i,l=ib(a)-j,1===u&&i>0&&h.col<k&&h.col+h.colCount>k&&(m=a.Hr(u),m&&m.length>0&&(n=m[m.length-1],c>n.x+_a(n))))return r;if(1===t&&j>0&&h.row<l&&h.row+h.rowCount>l&&(o=a.Gr(t),o&&o.length>0&&(p=o[o.length-1],d>p.y+$a(p))))return r}return q=Qb(a),q&&(r||(q.x-=_a(q),q.y-=$a(q),q.width*=3,q.height*=3,q.contains(c,d)&&(r={action:"drag",side:"corner"})),e&&e.options.allowUserDragFill||r&&"corner"===r.side&&(r.side=s)),r}function Ib(a,b,c,d){var e,f,h,i,j,k,l,m,n=!1,o=a.ITa.getSelections();for(e=0,f=o.length;e<f;e++){if(h=o[e],i=3===d||g(d),i&&(h=a.Tq(h)),j=h.row,k=h.col,l=h.rowCount,m=h.colCount,i)n=j<=b&&b<j+l&&k<=c&&c<k+m;else if(2===d)n=k===-1&&j<=b&&b<j+l;else if(1===d)n=j===-1&&k<=c&&c<k+m;else if(0===d)return n;if(n)break}return n}function Jb(a,b,c,d,f){b===d&&c===f||(a.ITa.setCellState(b,c,e.CellStatesType.active,!1,e.SheetArea.viewport),a.DIb&&a.DIb(e.CellStatesType.active,b,c,e.SheetArea.viewport),a.ITa.setCellState(d,f,e.CellStatesType.active,!0,e.SheetArea.viewport),a.DIb&&a.DIb(e.CellStatesType.active,d,f,e.SheetArea.viewport))}function Kb(a,b,c,d){var e,f,g,h;b||(e=eb(a),f=e[e.length-1],g=a.Jl,h=a.Kl,c?3===d?(a.Jl=f.row+f.rowCount-1,a.Kl=f.col+f.colCount-1):2===d?(a.Jl=f.row+f.rowCount-1,a.Kl=0):1===d&&(a.Jl=0,a.Kl=f.col+f.colCount-1):3===d?(a.Jl=f.row,a.Kl=f.col):2===d?(a.Jl=f.row,a.Kl=0):1===d&&(a.Jl=0,a.Kl=f.col),Jb(a,g,h,a.Jl,a.Kl))}function Lb(a,b,c,d){var e,f,g,h;b||(e=eb(a),f=e[e.length-1],g=a.Jl,h=a.Kl,c&&(3===d?(a.Jl=f.row,a.Kl=f.col):2===d?(a.Jl=f.row,a.Kl=0):1===d&&(a.Jl=0,a.Kl=f.col)),Jb(a,g,h,a.Jl,a.Kl))}Ca=function(){function a(a){var b=this;b.KN=!1,b.hQ=new ya(a),b.iQ=new Ba(a),b.kj=a}return a.prototype.jQ=function(a){var b=this,c=b.kj,d=c.am(),e=d.pt,f=d.qt,g=d.zNc,h=d.ANc,i=d.lt,j=d.ot,k=a.rN,l=c.BBJ,m=c.CBJ,n=0,o=b.kQ(k.X,k.Y),p=o.dragInfo,q=o.x,r=o.y;o&&(o.resizeInfo||p&&"corner"===p.side||o.selectionHitInfo)?(n|=2,n|=1):(f<=r&&(l&&r<j||!l&&r<h)&&(n|=2),e<=q&&(m&&q<i||!m&&q<g)&&(n|=1),n|=96,c.parent&&(n|=12)),a.DO=n},a.prototype.lQ=function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o=this,p={e:b,r:s};if(a.ao(o,"preProcessManipulationStarted",p),!p.r)if(c=b.rN,d=o.kj,e=d.parent,f=d.mm,g=d.yl,h=o.kQ(c.X,c.Y),i=h.dragInfo,j=h.selectionHitInfo,d.yt=h,h.resizeInfo){if(!d.endEdit())return;
f.fG(h)}else if(i&&"corner"===i.side)f.hG&&f.hG(h);else if(j){if(!d.endEdit())return;k=j.isHeader,l=j.isFirstIndicator,m=j.type,k&&f.ZG(h,!0),n=h.hitTestType,h.hitTestType=m,f.bH(h),h.hitTestType=n,Kb(d,k,l,m),d.mQ=!1,g.DH()}else d.nQ&&(d.nQ().oQ=!1),d.mQ=!1,g.DH(),b.HP>1&&e&&e.options.allowUserZoom?(o.KN=!1,o.hQ.OP()):(o.KN=!0,o.iQ.qG(1===b.HP))},a.prototype.pQ=function(b){var c,d,e,f,g,h,i,j,k,l,m=this,n={e:b,r:s};if(a.ao(m,"preProcessManipulationDelta",n),!n.r&&(c=b.rN,d=m.kj,e=d.mm,f=d.yt,g=c.X,h=c.Y,f))if(i=f.dragInfo,j=f.selectionHitInfo,f.resizeInfo)e.$F={e:b,x:g,y:h},e.WG();else if(i&&"corner"===i.side)e.$F={e:b,x:g,y:h},e.CG&&e.CG();else if(j||e.xG){if(j){if(!e.rG||!e.OG)return;if(e.j8J===!0)return;k=j.type,e.$F={e:b,x:g,y:h},3===k?e.cH():2===k?e.dH():1===k&&e.eH()}}else m.KN?b.vO=m.iQ.NG(b.fP.sO,b.gP):(l=b.dP.rO,m.hQ.PP(l))},a.prototype.qQ=function(b){var c,d,e,f,g,h=this,i={e:b,r:s};a.ao(h,"preProcessManipulationCompleted",i),i.r||(c=h.kj,d=c.mm,c.mQ=!0,e=c.yt,f=e.selectionHitInfo,e.resizeInfo?d.YG():e.dragInfo&&d.BG?(d.xH&&d.xH(),c.parent.touchToolStrip.rQ()):f||d.xG?(d.hH(),f&&Lb(c,f.isHeader,f.isFirstIndicator,f.type),c.yl.im()):(c.nQ&&(c.nQ().oQ=!0),h.KN?h.iQ.gQ(b.gP):(g=b.dP.rO,h.hQ.SP(g))))},a.prototype.sQ=function(b){var c,d,f,h,i,j,k,l,m,n,o,p,r,u,v,w,x,y,z,A,B,C,D,E,G,H,I,J,K,L,M,N=this,O={e:b,r:s};if(a.ao(N,"preProcessTapped",O),O.r)return void N.kj.repaint();if(c=b.rN,d=N.kj,f=d.parent,h=!1,d.Uja=t,N.tQ(),d.uQ&&d.uQ(),i=d.ITa.Ky,i&&i.vQ(),j=d.mm,k=N.kQ(c.X,c.Y,!0),l=k.filterButtonHitInfo,m=k.hitTestType,n=k.row,o=k.col,p=k.outlineHitInfo)d.isEditing()||(r=p.what,u=d.rowOutlines,v=d.columnOutlines,"rg"===r||"rgh"===r?u&&u.UL(d,p):"cg"!==r&&"cgh"!==r||v&&v.UL(d,p));else if(d.yt=k,l){if(!d.endEdit())return;w=l.rowFilter,w&&w.openFilterDialog(l)}else if(k.resizeInfo);else if(d.Qs(k.rowViewportIndex<0?-1:n,k.colViewportIndex<0?-1:o)){if(d.wQ&&!j.BG&&f.touchToolStrip.rQ(),x=d.getActiveRowIndex(),y=d.getActiveColumnIndex(),z=k.cellTypeHitInfo){if(A=d.getCellType(z.row,z.col,m),z.sheet||(z.sheet=d),N.Sia(A,z))if(B=z.sheetArea,!g(B)&&3!==B||n===x&&o===y)d.yl.DH();else{if(d.suspendPaint(),!d.endEdit())return;if(C={sheet:d,sheetName:d.name(),row:x,col:y,cancel:!1},d.Wq(e.Events.LeaveCell,C),C&&C.cancel===!0)return;D=d.ITa.getSelections(),E=d.ITa.getSpan(n,o),G=[e.kf(E.row,E.col,E.rowCount,E.colCount)],d.yu(D,G),d.Wq(e.Events.FloatingElementSelected,{type:"worksheet"}),H=z.isReservedLocation&&z.isFocusAware,d.Sr(n,o,t,t,H?0:1),I={sheet:d,sheetName:d.name(),row:n,col:o},d.Wq(e.Events.EnterCell,I),d.Wq(e.Events.FormulaTextboxEnterCell,I),d.Au(D),d.Uja=!0,j.cs&&j.cs(n,o),d.resumePaint(),h=!0}A.processCellAndPaddingMouseDown(z),A.XGb(z)}if(z&&z.isReservedLocation)return!0;z&&(z.cellButtonHitInfo||z.outlineColumnHitInfo)&&(h=!0),d.Wq(e.Events.CellClick,{sheet:d,sheetName:d.name(),sheetArea:m,row:k.row,col:k.col});try{if(j.mG=k,J=d.isEditing(),K=d.endEdit(),d.CH&&q&&J&&K&&(j.shift=!1),J&&x===d.getActiveRowIndex()&&y===d.getActiveColumnIndex()&&!K)return}finally{j.mG=s}if(g(n)||g(o))return;3===m&&j.cs&&j.cs(n,o),Ib(d,n,o,m)&&!h?N.xQ=V.setTimeout(function(){var a={x:k.x,y:k.y,handled:!1},b=f.touchToolStrip;d.Wq(e.Events.TouchToolStripOpening,a),a.handled||b.open(k.x,k.y-F),N.tQ()},ba+20):(d.Wq(e.Events.FloatingElementSelected,{type:"worksheet"}),L=d.ITa.getSelections(),j.ZG(k),M=d.ITa.getSelections(),d.yu(L,M),j.hH())}},a.prototype.Sia=function(a,b){return!(a&&a.activeOnClick&&!a.activeOnClick()&&b.isReservedLocation)},a.prototype.d_J=function(a,b){var c,d,e,f,g=this,h=g.kj,i=g.kQ(a,b,!0);i&&i.row>=0&&i.col>=0&&i.rowViewportIndex>=0&&i.colViewportIndex>=0&&!i.resizeInfo&&(c=h.isCtrlPressed(i.hitTestType),c||h.Tr(),d=h.Er(i.row),e=h.Fr(i.col),f=!0,h.Jl===i.row&&h.Kl===i.col||(f=!1),h.Kr(i.row,i.col,d,e,f),c?h.$p():h.RXJ(i.row,i.col,1,1),h.mm.dI(!1,!0),h.EF(h.Ws(),i.row,i.col))},a.prototype.yQ=function(b){var c,d,f,g,h=this,i={e:b,r:s};a.ao(h,"preProcessDoubleTapped",i),i.r||(c=h.kj,d=b.rN,h.tQ(),f=c.yt,f&&(g=!1,3===f.hitTestType?h.d_J(d.X,d.Y):g=c.mm.k$J(f),g||c.Wq(e.Events.CellDoubleClick,{sheet:c,sheetName:c.name(),sheetArea:f.hitTestType,row:f.row,col:f.col})))},a.prototype.zQ=function(a){var b,c=this,d=c.kj,e=a.rN,f=c.kQ(e.X,e.Y);d.isEditing()?f.row===d.Jl&&f.col===d.Kl||d.mm.cI(f):(c._target=f,b=c.kQ(e.X,e.Y,!0),b&&b.cellTypeHitInfo&&b.cellTypeHitInfo.isEditing||d.mm.cI(b))},a.prototype.AQ=function(a){var b,c,d,e,f=this,g=f.kj;g.isEditing()||(b=f._target,c=!0,b&&(d=b.cellTypeHitInfo,d&&d.isReservedLocation?c=!1:(e=g.getCellType(b.row,b.col),e&&e.isEditing()&&(c=!1))),c&&g.mm.dI(!0))},a.prototype.kQ=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,u=this,v=u.kj;return v.am(),d={x:a,y:b,rowViewportIndex:s,colViewportIndex:s,row:-1,col:-1,resizeInfo:s,hitTestType:s,outlineHitInfo:s,filterButtonHitInfo:s,dragInfo:s,cellTypeHitInfo:s,selectionHitInfo:s},e=v.rowOutlines,f=v.columnOutlines,e&&(g=e.hitTest(v,a,b)),!g&&f&&(g=f.hitTest(v,a,b)),g?d.outlineHitInfo=g:(h=void 0,i=void 0,h=v.nr(b),i=v.or(a),d.rowViewportIndex=h,d.colViewportIndex=i,d.row=v.pr(b,h),d.col=v.qr(a,i,b,h,d.row),h>=0&&h<=2&&i>=0&&(j=v.rr(h,i,t,d.row,d.col),j&&(d.row=j.row,d.col=j.col)),d.hitTestType=v.sr(h,i),k=void 0,l=void 0,m=void 0,n=void 0,o=void 0,k=Fb(v,d,a,b,10),m=v.xr,n=m&&m.hitTest(d,a,b),n||(p=v.tables,q=p&&p.find(d.row,d.col),r=q&&q.xr,n=r&&r.hitTest(d,a,b)),v.wQ?(l=Hb(v,d,a,b),d.dragInfo=l):k?d.resizeInfo=k:n?d.filterButtonHitInfo=n:c?d.cellTypeHitInfo=v.yr(d,a,b):(o=Gb(v,d,a,b),d.selectionHitInfo=o)),d},a.prototype.tQ=function(){var a=this,b=a.xQ;b&&(clearTimeout(b),a.xQ=s)},a}(),b.TouchEventHandler=Ca,e.Zn(Ca),Da=function(){function a(a,b,c){var d=this;d.BQ=c,d.yM=new Qa(b),d.CQ=new Ca(b),d.DQ=new Ra(a,"sheet",d.yM,100,10),d.BQ.xN(d.DQ,!0)}return a.prototype.EQ=function(){var a=this,b=a.CQ,c=a.DQ;c.dN=function(a){return b.jQ(a)},c.eN=function(a){return b.lQ(a)},c.fN=function(a){return b.pQ(a)},c.hN=function(a){return b.qQ(a)},c.iN=function(a){return b.sQ(a)},c.jN=function(a){return b.yQ(a)},c.GM=function(a){return b.zQ(a)},c.IM=function(a){return b.AQ(a)}},a.prototype.FQ=function(){var a=this,b=a.DQ;b&&(a.BQ.xN(b,!1),b.dN=s,b.eN=s,b.fN=s,b.gN=s,b.hN=s,b.iN=s,b.jN=s,b.kN=s,b.GM=s,b.IM=s,a.DQ=s)},a.prototype.GQ=function(a){return this.yM.GQ()},a.prototype.HQ=function(a){return this.yM.HQ()},a.prototype.IQ=function(a){return this.yM.IQ()},a}(),Ea="gc-toolstrip-button",Fa="gc-toolstrip-text",Ga="gc-toolstrip-image",Ha="gc-toolstrip-item",Ia="gc-touch-sperate-line",Ja="height",Ka="width",La="px",Ma="button",Na=function(a){Za(b,a);function b(b,c){var d,f=a.call(this,c,e.Ul.vl(b.qo))||this,g=f;return g.JQ=32,g.KQ=45,g.LQ={},g.MQ=!1,g.OC=b,d=g.yo(),g.NQ=d,d.addClass("gc-toolstrip-default ui-state-default well"),d.appendTo(g.zo()),d.hide(),g.OQ(),g.PQ(),g.QQ(),f}return b.prototype.open=function(a,b){var c,d,f,g,h=this,j=db(h.OC);if(j&&(e.Vl.Zl(s,!0),h.NQ.css({left:a,top:b}),h.Ao(),h.MQ=!0,h.Do(),!k(h.LQ))){c=h.LQ;for(d in c)c.hasOwnProperty(d)&&(f=c[d],g=!f.RQ||f.RQ.call(h),g?i("#"+d).show():i("#"+d).hide())}},b.prototype.add=function(a){var b,c,d,e;a&&(b=this,c=b.LQ,a instanceof Pa?(d=a.name(),d&&(c[d]=a,b.SQ(a.TQ(Ia,b.KQ+La)))):a instanceof Oa&&(e=a.name(),b.getItem(e)||(c[e]=a,b.SQ(a.TQ(Ga,b.JQ+La,Fa,Ea)))))},b.prototype.getItem=function(a){return this.LQ[a]},b.prototype.getItems=function(){var a,b=this,c=[],d=b.LQ;if(!k(d)){for(a in d)d.hasOwnProperty(a)&&c.push(d[a]);return c}return s},b.prototype.remove=function(a){var b,c=this;return c.getItem(a)?(i("#"+a).parent().remove(),b=c.LQ[a],delete c.LQ[a],b):s},b.prototype.clear=function(){var a=this;a.NQ&&(a.NQ.find("td."+Ha).remove(),a.LQ={})},b.prototype.close=function(){var a,b,c=this;X.Hm(),c.NQ&&c.NQ.hide(),c.MQ=!1,c.Eo(),a=db(c.OC),a&&(a.zt(),b=eb(a),b.length>0&&!a.wQ&&b[0].row===-1&&b[0].col===-1&&a.Tr())},b.prototype.imageAreaHeight=function(a){var b=this;return 0===arguments.length?b.JQ:(a>0&&(b.JQ=a,b.NQ.find("span."+Ga).css(Ja,a+La)),b)},b.prototype.itemHeight=function(a){var b=this,c=b.NQ.find("button."+Ea);return 0===arguments.length?U(c.css(Ja)):(a>0&&c.css(Ja,a+La),b)},b.prototype.itemWidth=function(a){var b,c,d=this,e=d.NQ.find("button."+Ea);return 0===arguments.length?U(e.css(Ka)):(a>0&&(b="min-width",c=U(e.css(b)),c>a&&e.css(b,a+La),e.css(Ka,a+La)),d)},b.prototype.separatorHeight=function(a){var b=this;return 0===arguments.length?b.KQ:(a>0&&(b.KQ=a,b.NQ.find("div."+Ia).css(Ja,a+La)),b)},b.prototype.OQ=function(){var a="table",b=this,c=i(l(a)).css({padding:0,display:a}).attr({cellspacing:0,cellpadding:0});b.UQ=i(l("tr")).appendTo(c),c.appendTo(b.NQ)},b.prototype.no=function(){var a=this,b=a.NQ;b&&(a.MQ&&(X.Hm(),a.Eo()),b.unbind("click"),b.remove(),a.NQ=s)},b.prototype.QQ=function(){var a=this;a.NQ.bind("click",function(b){var c,d,e,f=b.target,g=f.tagName.toLowerCase();g===Ma?c=f.id:(d=f.parentElement,d&&d.tagName.toLowerCase()===Ma&&(c=d.id)),e=a.LQ[c],c&&e&&e.VQ.call(a)})},b.prototype.SQ=function(a){this.NQ&&a&&i(l("td")).append(a).appendTo(this.UQ).addClass(Ha)},b.prototype.PQ=function(){var a,b,c,d,e,f,g;function h(a){for(var b=0,c=a+b;W.getElementById(c);)b++,c=a+b;return c}a="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA",b={0:Y+a+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+Z,1:Y+a+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+Z,2:Y+a+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:Y+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="},c=this,d=b[0],e=b[1],f=b[2],g=b[3],c.WQ=new Oa(h("wijspread_toolstrip_paste"),aa().ToolStrip_PasteText,d,c.XQ),c.YQ=new Oa(h("wijspread_toolstrip_cut"),aa().ToolStrip_CutText,e,c.ZQ),c.$Q=new Oa(h("wijspread_toolstrip_copy"),aa().ToolStrip_CopyText,f,c._Q),c.aR=new Oa(h("wijspread_toolstrip_autofill"),aa().ToolStrip_AutoFillText,g,c.bR,c.cR),c.add(c.WQ),c.add(c.YQ),c.add(c.$Q),c.add(new Pa(c.cR)),c.add(c.aR)},b.prototype.cR=function(){var a,b,c,d=db(this.OC);if(!d)return!1;if(a=eb(d),0===a.length)return!1;for(b=0;b<a.length;b++)if(c=a[b],c.row===-1&&c.col===-1)return!1;return!0},b.prototype.bR=function(){var a,b;this.close(),a=db(this.OC),a&&(b=eb(a).length,b<=1&&(a.wQ=!0,a.yl.im()))},b.prototype.rQ=function(){var a=db(this.OC);a&&(a.wQ=!1,a.yl.im())},b.prototype._Q=function(){var a,b=db(this.OC);b&&(a=Mb(b),a?this.dR=b.wu().execute({cmd:"copyFloatingObjects",sheetName:b.name()}):this.dR=b.ux(!0)),this.close()},b.prototype.ZQ=function(){var a,b=db(this.OC);b&&(a=Mb(b),a?this.dR=b.wu().execute({cmd:"cutFloatingObjects",sheetName:b.name()}):this.dR=b.sx(!0)),this.close()},b.prototype.XQ=function(){var a=this,b=a.dR,c=db(a.OC);c&&!g(b)&&(c.isPasteFloatingObject&&c.isPasteFloatingObject()?c.wu().execute({cmd:"pasteFloatingObjects",sheetName:c.name()}):c.vx({pasteHtml:b.copyHtml,pasteText:b.copyText})),a.close()},b.prototype.eR=function(){var a=this,b="span."+Fa;i("#"+a.WQ.Cj).find(b).text(aa().ToolStrip_PasteText),i("#"+a.YQ.Cj).find(b).text(aa().ToolStrip_CutText),i("#"+a.$Q.Cj).find(b).text(aa().ToolStrip_CopyText),i("#"+a.aR.Cj).find(b).text(aa().ToolStrip_AutoFillText)},b}(h),b.TouchToolStrip=Na;function Mb(a){var b=a.wr,c=!1;return b&&b.zR().forEach(function(a){a&&a.isSelected()&&(c=!0)}),c}function Nb(a,b,c){var d,e=l("span"),f=W.body;return e.className=c,e.style.font=a,e.style.cssFloat="left",e.textContent=b,f.insertBefore(e,s),d=i(e).width(),f.removeChild(e),d}Oa=function(){function a(a,b,c,d,e){this._font="normal 12px Arial";var f=this;f.Cj=a,f._text=b,f.fR=c,d&&(f.VQ=d),e&&(f.RQ=e)}return a.prototype.name=function(a){var b=this;return 0===arguments.length?b.Cj:(i("#"+b.Cj).attr("id",a),i("#"+b.Cj+"Text").attr("id",a+"Text"),i("#"+b.Cj+"Image").attr("id",a+"Image"),b.Cj=a,b)},a.prototype.text=function(a){var b=this;return 0===arguments.length?b._text:(b._text=a,i("#"+b.name()+"Text").text(a),b)},a.prototype.font=function(a){var b=this,c=i("#"+b.name()+"Text");return 0===arguments.length?b._font:(b._font=a,c.css("font",a),b)},a.prototype.foreColor=function(a){var b=this,c=i("#"+b.name()+"Text");return 0===arguments.length?b.Nra?b.Nra:c.css("color"):(c.css("color",a),b)},a.prototype.image=function(a){var b=this;return 0===arguments.length?b.fR:(b.fR=a,i("#"+b.name()+"Image").css("background-image","url("+a+")"),b)},a.prototype.TQ=function(a,b,c,d){var e,f,g,h,j=this,k=j.name(),m=j.font(),n=j.text(),o=i(l("span"));return o.attr("id",k+"Image"),o.addClass(a),o.css({"background-image":"url("+j.image()+")","background-repeat":"no-repeat",display:"block",height:b,"background-position-x":"50%"}),e=i(l("span")),e.attr("id",k+"Text"),e.addClass(c),e.css("font",m),e.text(n),f=Nb(m,n,c),g=60,f>g&&(g=f),h=i(l(Ma)),h.attr("type",Ma),h.attr("id",k),h.addClass(d+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),h.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:g+La}),h.append(o),h.append(e),h[0]},a}(),b.TouchToolStripItem=Oa,Pa=function(){function a(a){function b(){for(var a="separator",b=0,c=a+(""+b);W.getElementById(c);)b++,c=a+(""+b);return c}this.Cj=b(),a&&(this.RQ=a)}return a.prototype.name=function(){return this.Cj},a.prototype.TQ=function(a,b){var c=i(l("div"));return c.attr("id",this.name()),c.addClass(a),c.css({width:"1px",height:b,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),c[0]},a}(),b.TouchToolStripSeparator=Pa,Qa=function(){function a(a){this.tc=a}return a.prototype.oN=function(){this.gR=2,this.tc.CH=!0},a.prototype.zM=function(){this.gR=0,this.hR=bb()},a.prototype.nN=function(){return 1===this.gR},a.prototype.uN=function(){return 1===this.gR},a.prototype.sN=function(){return 1===this.gR},a.prototype.GQ=function(){var a=this;if(2===a.gR)return!0;if(a.hR){if(bb()-a.hR<=200)return a.iR++,!0;a.hR=0,a.iR=0,a.gR=1}else a.gR=1;return a.tc.CH=!1,!1},a.prototype.HQ=function(){var a=this;return a.iR?(a.iR--,!0):2===a.gR||(a.gR=0,!1)},a.prototype.IQ=function(){return 2===this.gR},a}(),b.jR=Qa,Ra=function(){function a(a,b,c,d,e){var f=this;f.KM=a,f.lN=c,f.OM=b,f.mN=d,f.aN=e}return a}(),b.kR=Ra,Sa=function(){function a(){}return a.prototype.lR=function(a,b){var c,d,e=a,f=e.touches,h=e.targetTouches,i=e.changedTouches;e.isPrimary!==!1&&(f&&f.length>=1&&h&&h.length>=1&&(f[0].clientX!==h[0].clientX||f[0].clientY!==h[0].clientY)||(m(a),c=g(i)?e:i[0],d=W.createEvent("MouseEvents"),d.initMouseEvent(b,!0,!0,V,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,s),a.target.dispatchEvent(d)))},a.prototype.NM=function(a){var b,c=a.pointerType;if(!c||c===a[R]||c===G){if(b=a.data,b.mR)return;b.mR=!0,b.nR=!1,b.lR(a,"mouseover"),b.lR(a,"mousemove"),b.lR(a,"mousedown")}},a.prototype.aB=function(a){var b,c=a.pointerType;if(!c||c===a[R]||c===G){if(b=a.data,!b.mR)return;b.nR=!0,b.lR(a,"mousemove")}},a.prototype.RM=function(a){var b,c=a.pointerType;if(!c||c===a[R]||c===G){if(b=a.data,!b.mR)return;b.lR(a,"mouseup"),b.lR(a,"mouseout"),b.nR||b.lR(a,"click"),b.mR=!1}},a.prototype.oR=function(a,b,c){var d,f,h,j,k,l,m,n,o,p,q,r=this,s=c.charAt(0);"."!==s&&(c="."+c),d=I+c,f=J+c,h=K+c,j=L+c,k=M+c,l=N+c,m=O+c,n=P+c,o=Q+c,p=e.Ul._Va(),b?p?(q=a.style,g(q.msTouchAction)||(q.msTouchAction=H),g(q.touchAction)||(q.touchAction=H),i(a).bind(d,r,r.NM).bind(j,r,r.NM),i(W).bind(f,r,r.aB).bind(k,r,r.aB).bind(h,r,r.RM).bind(l,r,r.RM)):i(a).bind(m,r,r.NM).bind(n,r,r.aB).bind(o,r,r.RM):p?(i(a).unbind(d).unbind(j),i(W).unbind(f).unbind(k).unbind(h).unbind(l)):i(a).unbind(m).unbind(n).unbind(o)},a}(),b.pR=Sa,Ta="newSheet",Ua="tab",Va="allSheets",Wa=function(){function a(a){this.MJc=a}return a.prototype.lQ=function(a){var b,c,d,f,g,h,i,j,k,l,m=this,n=a.rN,o=m.MJc,p=o.qJc(),q=db(o.OC);o.FD&&o.GD(q,!1),b="resize",c=o.hitTest(n.X,n.Y),d=c.element,d===b?(o.HD=!0,o.ID=n.X):d!==Ua&&d!==Ta&&""!==d||(f=o.Xs,g=e.En.Nn(f),h=e.En.On(f),i=m.IP(g,h),j=i.getContext("2d"),k=e.En.Ln(i),l=e.En.Mn(i),e.Bn.Cn(j,1,1),j.drawImage(f,0,0,_a(i),$a(i),0,0,_a(i),$a(i)),e.Bn.Cn(j,k,l),m.Xs=i,m.qR=o.gq,m.rR=o.VC(),m.sR=o.UC(),m.KC=o.TC(),o.SC=p),m.tR=o.jw(-1),m.uR=o.rD(o.sD())},a.prototype.pQ=function(a){var b,c,d,f,h,i,j,k,l,m,n,o,p,q,r,s,t,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=this,K=a.rN.X,L=J.MJc,M=L.qJc();if(L.HD)b=K-L.ID,c=L.OC,d=c.options,f=c.xs.clientWidth,d.tabStripRatio=c.Iv()+b/f,h=L.rJc()/f,i=1,c.Iv()<h?(d.tabStripRatio=h,L.ID=L.rJc()):c.Iv()>=i?(d.tabStripRatio=i,L.ID=f):L.ID=K;else{if(j=J.Xs,k=J.qR,!j||g(k))return;l=J.tR,m=J.uR,n=J.KC,o=J.rR,p=J.sR,q=M?a.dP.sO.X:a.dP.sO.Y,r=J.vR(q,k),L.gq=r.gq,s=r.Oz,q>0&&k===l&&L.gq===l?s=0:q<0&&k===m&&L.gq===m&&(s=0),q>0&&q>s+n?q=s+n:q<0&&q<s-n&&(q=s-n),0!==q&&(t=L.Xs,v=t.getContext("2d"),w=e.En.Ln(t),x=e.En.Mn(t),v.save(),v.clearRect(0,0,e.En.Nn(t),e.En.On(t)),y=L.Dr(),L.dD(v,y),M?(z=void 0,A=0,B=void 0,C=$a(y),D=void 0,E=void 0,q>0?(z=o,D=z+q,B=p-D,B>0&&(e.Bn.Cn(v,1,1),v.drawImage(j,z*w,A,B*w,C*x,D*w,A,B*w,C*x),e.Bn.Cn(v,w,x)),E=q-s,p-o<=q&&(E=0),B=s,z=o,B>0&&(e.Bn.Dn(v,E,0),L.iE(v,new e.Rect(z,A,B,C)),e.Bn.Dn(v,-E,0))):q<0&&(D=o,z=D+u(q),B=p-z,B>0&&(e.Bn.Cn(v,1,1),v.drawImage(j,z*w,A,B*w,C*x,D*w,A,B*w,C*x),e.Bn.Cn(v,w,x)),E=q-s,p-o<=u(q)&&(E=0),B=u(s),z=p-B,B>0&&(e.Bn.Dn(v,E,0),L.iE(v,new e.Rect(z,A,B,C)),e.Bn.Dn(v,-E,0))),e.Bn.Cn(v,1,1),z=0,B=o,v.drawImage(j,z*w,A,B*w,C*x,z*w,A,B*w,C*x),F=e.Im.Lm(""),G=T(F.zIndex),G>2007&&(z=p,B=y.x+_a(y)-L.rJc()-z,v.drawImage(j,z*w,A,B*w,C*x,z*w,A,B*w,C*x)),z=_a(y)-L.rJc(),B=L.rJc(),v.drawImage(j,z*w,A,B*w,C*x,z*w,A,B*w,C*x),e.Bn.Cn(v,w,x)):(z=0,A=void 0,B=_a(y),C=void 0,H=void 0,I=void 0,q>0?(A=o,H=A+q,C=p-H,C>0&&(e.Bn.Cn(v,1,1),v.drawImage(j,z*w,A*x,B*w,C*x,z*w,H*x,B*w,C*x),e.Bn.Cn(v,w,x)),I=q-s,p-o<=q&&(I=0),C=s,A=o,C>0&&(e.Bn.Dn(v,0,I),L.iE(v,new e.Rect(z,A,B,C)),e.Bn.Dn(v,0,-I))):q<0&&(H=o,A=H+u(q),C=p-A,C>0&&(e.Bn.Cn(v,1,1),v.drawImage(j,z*w,A*x,B*w,C*x,z*w,H*x,B*w,C*x),e.Bn.Cn(v,w,x)),I=q-s,p-o<=u(q)&&(I=0),C=u(s),A=p-C,C>0&&(e.Bn.Dn(v,0,I),L.iE(v,new e.Rect(z,A,B,C)),e.Bn.Dn(v,0,-I))),e.Bn.Cn(v,1,1),A=0,C=o,v.drawImage(j,z*w,A*x,B*w,C*x,z*w,A*x,B*w,C*x),F=e.Im.Lm(""),G=T(F.zIndex),G>2007&&(A=p,C=y.y+$a(y)-L.rJc()-A,v.drawImage(j,z*w,A*x,B*w,C*x,z*w,A*x,B*w,C*x)),A=$a(y)-L.rJc(),C=L.rJc(),v.drawImage(j,z*w,A*x,B*w,C*x,z*w,A*x,B*w,C*x),e.Bn.Cn(v,w,x)),v.restore())}},a.prototype.qQ=function(a){var b=this.MJc;b.HD?(b.HD=!1,b.OC.aq()):(b.SC=t,b.repaint())},a.prototype.sQ=function(a){var b,c,d,e,f=this.MJc,g=f.OC,h=a.rN,i=db(g);f.FD&&f.GD(i,!1),b=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],c=f.hitTest(h.X,h.Y),d=c.element,g.mv=!0;try{b.indexOf(d)>=0?f.JD(c.index,!0):d===Ua?f.KD(c.index,c.position):d===Ta?f.MD(c.position):d===Va&&this.mYJ(a)}finally{g.mv=!1,e=db(g),e!==i&&(e.CH=!0,e.zt())}},a.prototype.yQ=function(a){return this.MJc.cE(a.rN.X,a.rN.Y)},a.prototype.IP=function(a,b){var c=this.Xs;return c?a===e.En.Nn(c)&&b===e.En.On(c)||e.En.Pn(c,a,b):(c=l("canvas"),e.En.Kn(c,this.MJc.OC),e.En.Pn(c,a,b)),c},a.prototype.vR=function(a,b){var c=this,d=c.MJc,e=d.WC,f=d.sJc,g=c.tR,h=c.uR,i=d.qJc(),j=b,k=0;if(a>0){for(;j>=g&&!(k>a);)k+=i?e[j]:f,j--;j<g&&(j=g)}else if(a<0&&h!==-1){for(;j<=h&&!(k<a);)k-=i?e[j]:f,j++;j>h&&(j=h)}return{gq:j,Oz:k}},a.prototype.mYJ=function(a){var b=this.MJc;b.mYJ({pageX:1,pageY:1})},a}(),Xa=function(){function a(a,b,c){var d,e,f=this;f.yM=new Qa(f),f.DQ=new Ra(a,"tabStrip",f.yM,1,(-1)),f.BQ=c,f.CQ=new Wa(b),d=f.CQ,e=f.DQ,e.eN=function(a){return d.lQ(a)},e.fN=function(a){return d.pQ(a)},e.hN=function(a){return d.qQ(a)},e.iN=function(a){return d.sQ(a)},e.jN=function(a){return d.yQ(a)}}return a.prototype.EQ=function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!0)},a.prototype.FQ=function(){var a=this,b=a.BQ;b&&b.xN(a.DQ,!1)},a.prototype.GQ=function(a){return this.yM.GQ()},a.prototype.HQ=function(a){return this.yM.HQ()},a.prototype.IQ=function(a){return this.yM.IQ()},a}();function Ob(a,b,c,d){var e=a.vu();e.ko(b)?c.drawImage(e.lo(b),d.x,d.y,_a(d),$a(d)):e.fo(b)}function Pb(a,b){var c,d,f,g,h,i,j,k,l,m,n,o,p,q=a.am(),r=16,s=eb(a);a.CH&&s.length>0&&(h=s[s.length-1],i=h.row,j=h.row+h.rowCount-1,k=h.col,l=h.col+h.colCount-1,m=a.parent,n="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",m&&!m.options.allowUserResize||(i!==-1&&k===-1&&a.getRowResizable(j)?(o=a.Er(j),c=Y+n+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",d=a.getCellRect(j,hb(a,2)-1,o,-1),g=q.fm(o),g.y<=d.y&&d.y+$a(d)<=g.y+$a(g)&&(f=new e.Rect(q.kt-r,d.y+$a(d)-r/2,r,r))):i===-1&&k!==-1&&a.getColumnResizable(l)&&(p=a.Fr(l),c=Y+n+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+Z,d=a.getCellRect(ib(a,1)-1,l,-1,p),g=q.gm(p),g.x<=d.x&&d.x+_a(d)<=g.x+_a(g)&&(f=new e.Rect(d.x+_a(d)-r/2,q.nt-r,r,r))),c&&f&&Ob(a,c,b,f)))}function Qb(a){var b,c,d,f,g=s,h=eb(a),i=h.length;return a.CH&&i>0&&(b=h[i-1],c=a.cm(b),d=17,f=20,g=new e.Rect(c.x+_a(c)-d,c.y+$a(c),d,f)),g}function Rb(a,b,c){var d=a.Er(b),f=a.Fr(c),g=a.jt(d),h=a.it(f),i=0,j=0,k=0,l=0;return g.length>0&&(i=g[0].row,j=g[g.length-1].row),h.length>0&&(k=h[0].col,l=h[h.length-1].col),e.kf(i,k,j-i+1,l-k+1)}function Sb(a,b,c,d,e,f){var g=a.Er(b),h=a.Fr(c),i=a.am(),j=i.Ft(g,h),k=Rb(a,b,c),l=k.row<=b&&b<=k.row+k.rowCount-1&&j.y<=e&&e<=j.y+$a(j),m=k.col<=c&&c<=k.col+k.colCount-1&&j.x<=d&&d<=j.x+_a(j);return f&&f.colCheck?m:f&&f.rowCheck?l:m&&l}function Tb(a){var b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,A,B=eb(a),C=[];if(a.CH&&B.length>0)for(b=B[B.length-1],c=a.cm(b),d=8,f=a.am(),g=b.row,h=b.row+b.rowCount-1,i=b.col,j=b.col+b.colCount-1,b.row!==-1&&b.col!==-1?(Sb(a,g,i,c.x,c.y)&&(C[0]=new e.Rect(c.x-d,c.y-d,2*d,2*d)),Sb(a,h,j,c.x+_a(c),c.y+$a(c))&&(C[1]=new e.Rect(c.x+_a(c)-d,c.y+$a(c)-d,2*d,2*d))):b.row!==-1?(k=f.Ft(1,0),l=f.Ft(1,1),m=k.x+(_a(k)+_a(l))/2-d,n=hb(a)-1-fb(a),o=a.it(1),p=o.findCol(n),p&&(q=a.it(0),r=q[0]||o[0],r&&(m=r.x+(p.x+_a(p)-r.x)/2-d)),Sb(a,g,i,m+d,c.y,{rowCheck:!0})&&(C[0]=new e.Rect(m,c.y-d,2*d,2*d)),Sb(a,h,j,m+d,c.y+$a(c),{rowCheck:!0})&&(C[1]=new e.Rect(m,c.y+$a(c)-d,2*d,2*d))):b.col!==-1&&(k=f.Ft(0,1),l=f.Ft(1,1),t=k.y+($a(k)+$a(l))/2-d,u=ib(a)-1-gb(a),v=a.jt(1),w=v.findRow(u),w&&(x=a.jt(0),y=x[0]||v[0],y&&(t=y.y+(w.y+$a(w)-y.y)/2-d)),Sb(a,g,i,c.x,t+d,{colCheck:!0})&&(C[0]=new e.Rect(c.x-d,t,2*d,2*d)),Sb(a,h,j,c.x+_a(c),t+d,{colCheck:!0})&&(C[1]=new e.Rect(c.x+_a(c)-d,t,2*d,2*d))),z=void 0,A=C.length-1;A>=0;A--)z=C[A],(!z||z.x<0||z.y<0)&&(C[A]=s);return C}function Ub(a,b,c){var d,f,g,h;if(e.needPaintSelection(a)){if(a.isEditing()||!b||0===a.selectionPolicy())return;if(d=Tb(a),f=d.length,g=void 0,f>0){for(c.save(),c.fillStyle=a.m_a()||"white",c.strokeStyle=a.getSelectionBorderColor(),h=0;h<f;h++)g=d[h],g&&(c.beginPath(),c.arc(g.x+_a(g)/2,g.y+$a(g)/2,_a(g)/2,0,2*Math.PI,!1),c.fill(),c.stroke());c.restore()}}}function Vb(a,b){var c,d=Qb(a);d&&(c=Y+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+Z,Ob(a,c,b,d))}e.oJ.prototype.DH=function(){var a=this,b=a.kj,c=eb(b),d=c.length;b.Xq<=0&&d>0&&a.im(c[d-1],t,t,!0)},e.Worksheet.$n(G,{init:function(){this.wQ=!1,this.mQ=!0},setHost:function(a){var b=this,c=b.parent,d=c&&c.BQ||new ea,e=new Da(a[0],b,d);e.EQ(),b.wR=e},dispose:function(a){var b=this;b.wR&&b.wR.FQ(),a.clearCache!==!1&&(b.wR=s)},startEdit:function(){this.CH&&this.yl.DH()},paintAdornment:function(a){var b=this,c=a.ctx;b.CH&&(b.options.isProtected||Pb(b,c),b.wQ?Vb(b,c):Ub(b,b.mQ,c))},preProcessMouseDown:function(a){var b=a.e,c=this.wR;(r||c.GQ(b))&&(m(b),a.r=!0)},preProcessMouseMove:function(a){var b=a.e,c=this.wR;(r||c.IQ(b))&&(m(b),a.r=!0)},preProcessMouseUp:function(a){var b=a.e,c=this.wR;(r||c.HQ(b))&&(m(b),a.r=!0)},preProcessMouseDbClick:function(a){(r||this.CH)&&(a.r=!0)},preProcessMouseOut:function(a){r&&(a.r=!0)},preProcessMouseWheel:function(a){r&&(a.r=!0)}}),e.Workbook.$n(G,{init:function(){this.BQ=new ea},setHost:function(){var a=this;a.touchToolStrip=new Na(a,a.pZJ())},dispose:function(){var a=this,b=a.BQ,c=a.touchToolStrip;b&&b.no(),c&&(c.no(),a.touchToolStrip=s)},onCultureChanged:function(){var a=this.touchToolStrip;a&&a.eR()}}),e.DC.$n(G,{setHost:function(){var a=this,b=new Xa(a.Xs,a,a.OC.BQ);b.EQ(),a.wR=b},dispose:function(){var a=this,b=a.wR;b&&(b.FQ(),a.wR=s)},preProcessMouseDown:function(a){var b=this.wR,c=a.e;(r||b.GQ(c))&&(m(c),a.r=!1)},preProcessMouseMove:function(a){var b=this.wR,c=a.e;(r||b.IQ(c))&&(m(c),a.r=!1)},preProcessMouseUp:function(a){var b=this.wR,c=a.e;(r||b.HQ(c))&&(m(c),a.r=!1)},preProcessMouseDbClick:function(a){var b=db(this.OC);(r||b&&b.CH)&&(a.r=!1)},preProcessMouseOut:function(a){r&&(a.r=!1)}}),Ya=".gcScrollbar",e.hv.$n(G,{initEvents:function(a){var b=this.xR=new Sa;b.oR(a,!0,Ya)},dispose:function(a){var b=this.xR;b&&b.oR(a,!1,Ya)}})},"./dist/plugins/touch/touch.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ToolStrip_PasteText="Paste",b.ToolStrip_CutText="Cut",b.ToolStrip_CopyText="Copy",b.ToolStrip_AutoFillText="AutoFill"},"./dist/plugins/validation/datavalidation-event.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("@grapecity/js-calc"),g=c("./dist/plugins/validation/datavalidation.js"),h=e.Common.j.Fa,i=e.Common.l,j=e.Common.u,k=d.Ul,l=d.kf,m=k.rl(),n=k.Ml,o=d.GC$,p=k.Nl,q=k.hZa,r=k.nl,s=document,t=Math.max,u=Math.min,v="position",w="absolute",x="border",y="padding",z="box-shadow",A="font",B="background-color",C="top",D="left",E="z-index",F="outline",G="auto",H="white",I="none",J="size",K="gcUIElement",o.extend(d.iI.prototype,{cs:function(a,b){var c,d,e,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa;function Ga(a,b){if(a&&a[b])return"function"==typeof a[b]?a[b]():a[b]}if(c=this,d=c.kj,e=d&&d.parent,e&&(L=d.hm(),L&&(M=e.getActiveSheet(),M||(N=e.getActiveSheetTab(),N&&(M=N.kj)),M&&d.name()===M.name()&&(O=d.getDataValidator(a,b),O&&(P=d.getCellRect(a,b),!c.oG(P)&&(Q=e.pZJ(),R=e.getHost(),S=k.vl(R),Ga(O,"showInputMessage")&&Ga(O,"inputMessage")&&(T=j.Gb,U=j.Ob,V=T(U(Ga(O,"inputTitle")),"\n","<br/>"),W=T(U(Ga(O,"inputMessage")),"\n","<br/>"),X=p("span"),o(X).css(v,w).css(x,"1px #C0C0C0 solid").css(y,"3px 8px 3px 8px").css(B,"#FFFFFF").css(z,"1px 2px 5px rgba(0,0,0,0.4)").css(A,"normal normal normal 12px/normal Arial").width(G).height(G).css(C,P.y+P.height+5).css(D,P.x+P.width/2).css(E,S).html("<b>"+V+"</b><br/>"+W).attr(K,"gcValidationInputMessage").appendTo(Q),d.KH=X),O&&3===Ga(O,"type")&&Ga(O,"inCellDropdown")&&Ga(O,"condition"))))))){for(Y=Ga(O,"condition").getValidListImp(d,a,b),Z=Ga(O,"condition").cJc(),$=Y.length,_=p("select"),aa=d.getText(a,b),ba=-1,ca=s.createDocumentFragment(),da=RegExp(String.fromCharCode(32),"g"),ea=String.fromCharCode(160),fa=0;fa<$;fa++)ga=Y[fa].text,h(ga)||f&&ga instanceof f.CalcError||(ba<0&&ga===aa&&(ba=fa),ga instanceof Date&&(ga=i.Vb(ga,"M/d/yyyy h:mm:ss")),ha=p("option"),ha.value=ga,ha.text=ga.replace(da,ea),ca.appendChild(ha));_.appendChild(ca),_.selectedIndex=ba>0?ba:0,ia=d.getActualStyle(a,b),ja=d.yl,ka=ia&&ia.font?ia.font:ja.Bl(),d.zoom()>1&&(ka=ja.Cl(ka)),la=d.ITa.getSpans(l(a,b,1,1)),ma=1,la&&la.length>0&&la[0]&&(ma=la[0].colCount),na=b+ma-1===d.getColumnCount()-1,oa=d.Sl(a),pa=d.parent&&d.parent.options.useTouchLayout,oa=pa?u(50,oa):u(15,oa),qa=m,ra=n.safari&&(qa.ipad||qa.iphone),sa=qa.android,ta=void 0,ua=void 0,va=void 0,wa=void 0,xa=void 0,ra?(ta=P.width+3,ua=P.height+3,va=P.y-1.5,wa=P.x-1.5,xa=H):(ta=t(P.width+(na?0:oa),d.defaults.colWidth),ua=$>8?140:G,va=P.y+P.height,ya=P.x+P.width+(na?0:oa)-ta,wa=ya<d.Vs().left?P.x:ya,xa=""),za=o(_).css(F,I).css(v,w).css(A,q(ka)).css(E,S).css(B,xa).width(ta).height(ua).css(D,wa).attr(K,"gcValidationSelect").appendTo(Q).attr(J,$>2?$:2).hide().bind("click",function(){sa||(c.pG(_,a,b,Y,Z),ra&&o(d.y$).show())}).bind("keydown",function(e){13!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey?27!==e.keyCode||e.ctrlKey||e.shiftKey||e.altKey||o(_).hide():c.pG(_,a,b,Y,Z),ra&&o(d.y$).show()}).bind("change",function(){sa&&c.pG(_,a,b,Y,Z)}),Aa=o(R).height(),ua=za.outerHeight()+1,ra||(ua+va>Aa&&va>ua?va=P.y-ua:(Ba=R.getBoundingClientRect(),Ca=window.innerHeight,Da=Ba.y,Ea=Ca-(Da+va),ua>Ea&&za.height(Ea))),za.css(C,va),ra&&za.bind("blur",function(){c.pG(_,a,b,Y,Z),o(d.y$).show()}),d.lm=_,Fa=p("input"),Fa.type="image",Fa.src=g.zW(),Fa.alt="v",o(Fa).css(v,w).width(oa).height(oa).css(C,P.y+P.height-(oa+3)).css(D,P.x+P.width-(na?oa:0)).css(E,S).css(B,H).css(x,"1px solid gray").attr(K,"gcValidationButton").appendTo(Q).bind("click",function(a){d.isEditing()&&!d.endEdit()||(o(d.lm).toggle().focus(),ra&&o(d.y$).toggle(),r(a))}),d.y$=Fa}}})},"./dist/plugins/validation/datavalidation.entry.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),c("./dist/plugins/validation/datavalidation-event.js");var d=c("./dist/plugins/validation/datavalidation.js");b.CriteriaType=d.CriteriaType,b.DataValidationResult=d.DataValidationResult,b.ErrorStyle=d.ErrorStyle,b.DefaultDataValidator=d.DefaultDataValidator,b.HighlightType=d.HighlightType,b.HighlightPosition=d.HighlightPosition,b.zW=d.zW,b.bW=d.bW,b.createNumberValidator=d.createNumberValidator,b.createDateValidator=d.createDateValidator,b.createTimeValidator=d.createTimeValidator,b.createTextLengthValidator=d.createTextLengthValidator,b.createFormulaValidator=d.createFormulaValidator,b.createFormulaListValidator=d.createFormulaListValidator,b.createListValidator=d.createListValidator},"./dist/plugins/validation/datavalidation.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("ConditionalFormatting"),g=c("SheetsCalc"),h=c("@grapecity/js-calc"),i=d.Common.l,j=e.UsedRangeUtil.SZJ,k=e.UsedRangeUtil.RZJ,l=e.XFileConstants.Xkb,m=e.XFileConstants.JbK,n=e.XFileConstants.KbK,o="1",p=!!h,q=f.$V,r=d.Common.u.Db,s=d.Common.j.Fa,t=d.Common.j.C4,u=i.Ra,v=e.GC$,w=null,x=void 0,y=e.Ul,z=y.Pl,A=y.Ol,B=y.T$a,C=y.GcK,D=y.Rha,E=y.HcK,F=y.naa,G=y.oaa,H=y.UcK,I=y.WcK,J=y.VcK,K=e.Util.WaK,L=e.Util.addXLFNPrefix,M=e.Util.Tja,N=y.JcK,O=y.XcK,P=y.IcK,Q=y.LcK,R=e.range_parser.CcK,S=e.range_parser.FcK,T=e.kf,U=Math.min,V=Math.max,W=d.Common.l,X=".validator",Y="red",Z=1,$=5,_={type:0,color:Y},aa={type:1,color:Y,position:Z},ba={type:2,color:Y,position:$,image:null},function(a){a[a.none=0]="none",a[a.whole=1]="whole",
a[a.decimal=2]="decimal",a[a.list=3]="list",a[a.date=4]="date",a[a.time=5]="time",a[a.textLength=6]="textLength",a[a.custom=7]="custom"}(ca||(ca={})),function(a){a[a.stop=0]="stop",a[a.warning=1]="warning",a[a.information=2]="information"}(da||(da={})),ea={0:"equal",1:"notEqual",2:"greaterThan",4:"lessThan",3:"greaterThanOrEqual",5:"lessThanOrEqual",6:"between",7:"notBetween"},fa={equal:0,notEqual:1,greaterThan:2,greaterThanOrEqual:3,lessThan:4,lessThanOrEqual:5,between:6,notBetween:7},ga=window;function qa(a){if(s(a))return 0;if("number"==typeof a)return a;if("string"==typeof a){var b=parseFloat(a);if(!isNaN(b)&&""+b===a)return b}return w}function ra(a){var b,c,e,f,g;if(a instanceof Date)return a;if("string"==typeof a){if(b=d.Common.l.Qa(a),!b)if(isNaN(a)){if(d.Common.l.fvb(a))return w;if(b=new Date(a),isNaN(b.valueOf()))return w;try{if(c=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,e=d.Common.u,f=e.ib(d.Common.u.Db(a.replace(/ |\n/g,"")," ")," "),g=c.exec(f),g&&4===g.length&&(g.indexOf(""+b.getFullYear())===-1||g.indexOf(""+b.getMonth())===-1||g.indexOf(""+b.getDate())===-1))return w}catch(a){return w}}else if(b=d.Common.l.Xb(parseFloat(a)),!b)return w;return b}return"number"==typeof a?isNaN(a)?w:(b=d.Common.l.Xb(a),b?b:w):w}function sa(a){return!s(a)&&a instanceof Date?u(a):a}function ta(a,b){var c,d,e;if(!s(a))return 1===a||2===a?c=ya(b.operator,b.value1,b.value2,1===a):3===a?b.value?c=Fa(b.value):b.formula&&(c=Ea(b.formula)):4===a||5===a?(d=b.value1,e=b.value2,d&&"/OADate("===d.substr(0,8)&&(d=W.Rka(d)),e&&"/OADate("===e.substr(0,8)&&(e=W.Rka(e)),c=5===a?Ba(b.operator,d,e):Aa(b.operator,d,e)):6===a?c=Ca(b.operator,b.value1,b.value2):7===a&&void 0!==b.formula&&(c=Da(b.formula)),c?c.condition():void 0}!function(a){a[a.anyValue=0]="anyValue",a[a.wholeNumber=1]="wholeNumber",a[a.decimalValues=2]="decimalValues",a[a.list=3]="list",a[a.date=4]="date",a[a.time=5]="time",a[a.textLength=6]="textLength",a[a.custom=7]="custom"}(ha=b.CriteriaType||(b.CriteriaType={})),function(a){a[a.forceApply=0]="forceApply",a[a.discard=1]="discard",a[a.retry=2]="retry"}(ia=b.DataValidationResult||(b.DataValidationResult={})),function(a){a[a.stop=0]="stop",a[a.warning=1]="warning",a[a.information=2]="information"}(ja=b.ErrorStyle||(b.ErrorStyle={})),function(a){a[a.circle=0]="circle",a[a.dogEar=1]="dogEar",a[a.icon=2]="icon"}(ka=b.HighlightType||(b.HighlightType={})),function(a){a[a.topLeft=0]="topLeft",a[a.topRight=1]="topRight",a[a.bottomRight=2]="bottomRight",a[a.bottomLeft=3]="bottomLeft",a[a.outsideLeft=4]="outsideLeft",a[a.outsideRight=5]="outsideRight"}(la=b.HighlightPosition||(b.HighlightPosition={})),ma=["errorStyle","ignoreBlank","preciseCompareDate","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"];function ua(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;return a.intersect(b,c,d,e)?(g=a.rowCount,h=a.colCount,i=V(0,a.row),j=V(0,a.col),k=!1,l=!1,m=!1,b=V(0,b),c=V(0,c),f||(f=[-1,-1]),n=f[0],o=f[1],g===-1&&(g=n-i,l=!0),h===-1&&(h=o-j,k=!0),d===-1&&(d=n-b),e===-1&&(e=o-c,m=!0),p=i,q=i+g-1,r=j,s=j+h-1,t=b,u=b+d-1,v=c,w=c+e-1,x=[],p!==-1&&r!==-1&&t!==-1&&v!==-1&&(v-r>0&&(y=T(p,r,l?-1:g,v-r),x.push(y)),s-w>0&&(z=T(p,w+1,l?-1:g,s-w),x.push(z)),t-p>0&&(A=T(p,V(v,r),t-p,k&&m?-1:U(w,s)-V(v,r)+1),x.push(A)),q-u>0&&(B=T(u+1,V(v,r),q-u,k&&m?-1:U(w,s)-V(v,r)+1),x.push(B))),x.PAb=!0,x):[a]}function va(a,b){if(!s(a)){if("string"==typeof a&&(a=K(a)),3===b)return a;if(4===b||5===b){var c=parseFloat(a);isNaN(c)||(a=ra(a))}return!a||a instanceof Date||(a=H(a)),a}}na=function(){function a(b){var c=this;c.id=a.w$,a.w$++,c.QAb=t(_),b&&(c.condition(b),c.condition().ignoreBlank(c.ignoreBlank())),c.n5=[]}return a.prototype.value1=function(a,b){var c,d=this.condition(),e=d&&d.item1()?d.item1():d;return e?(c=e.formula(a,b),c&&c.length>0?"="+r(v.trim(""+c),"="):e.expected()):w},a.prototype.value2=function(a,b){var c,d=this.condition(),e=d&&d.item2()?d.item2():d;return e?(c=e.formula(a,b),c&&c.length>0?"="+r(v.trim(""+c),"="):e.expected()):w},a.prototype.isValid=function(a,b,c,d,e){var f,g,h,i=this,j=i.condition(),k=s(e)||e===!0;if(j){if(i.ignoreBlank()&&(s(d)||""===d))return!0;if(f=d,g=void 0,!s(d))switch(i.type()){case 0:return!0;case 2:case 1:g=k?qa(d):d,s(g)||(f=g);break;case 4:case 5:g=k?ra(d):d,s(g)||(f=g);break;case 7:case 3:case 6:}a&&(a.lRa=!0),h=void 0;try{h=j.evaluate(a,b,c,f,f)}catch(a){h=!0}finally{a&&(a.lRa=!1)}return h}return!0},a.prototype.reset=function(){var a=this;a.errorStyle(0),a.ignoreBlank(!0),a.preciseCompareDate(!1),a.inCellDropdown(!0),a.showInputMessage(!0),a.showErrorMessage(!0),a.inputTitle(""),a.errorTitle(""),a.inputMessage(""),a.errorMessage(""),a.comparisonOperator(6),a.type(0),a.condition(w),a.n5.length=0},a.prototype.getValidList=function(a,b,c){var d=this.condition();return d!==w&&3===this.type()&&12===d.conType()?d.getValidList(a,b,c):w},a.prototype.highlightStyle=function(a){var b,c,d,e=this;if(0===arguments.length)return e.QAb;if(!s(a)){if(e.QAb.type!==a.type)switch(b=a.type){case 1:e.QAb=t(aa);break;case 2:e.QAb=t(ba);break;default:e.QAb=t(_)}c=e.QAb;for(d in c)c.hasOwnProperty(d)&&a.hasOwnProperty(d)&&(c[d]=a[d]);return e.kj&&e.kj.repaint(),e}},a.prototype.toJSON=function(a){var b,c=this,d={};return ma.forEach(function(b){var e=c[b]();c[b].isDefault(e)||(d[b]=e&&e.toJSON?e.toJSON(a):e)}),b=c.n5.map(Va),d.ranges=g.rangesToFormula(b,0,0,15,!1),d.highlightStyle=JSON.stringify(c.QAb),v.isEmptyObject(d)?x:d},a.prototype.fromJSON=function(a,b,c){var d,e,f,h,i;a&&!v.isEmptyObject(a)&&(d=this,a.ranges&&(d.n5=g.formulaToRanges(c,a.ranges,0,0,!0)[0].ranges),a.highlightStyle&&(d.QAb=JSON.parse(a.highlightStyle)),ma.forEach(function(e){var f,g,h=a[e];A(h)&&("condition"===e?(f=q(),f.fromJSON(a.condition,c,b),d.condition(f,!1),g=f.ranges(),g&&g.length?d.n5=g:f.ranges(d.n5),f.context(c)):d[e](h,!1))}),e=a.validatorInfo,e&&(f=c.Wu.useR1C1,h=ta(a.type,e),i=e.operator,h&&(h.ranges(d.n5),h.ignoreBlank(d.ignoreBlank()),h.context(c),f&&B(h),d.condition(h)),s(i)||d.comparisonOperator(i)))},a.prototype.clone=function(b){var c,d;return this.Nja?(c=this.condition(),c&&c.initExpression(),this):(d=new a,d.fromJSON(this.toJSON(b),!1,b||this.kj),d.n5=[],d)},a.prototype.context=function(a){if(a){this.xc=a;var b=this.condition();b&&(b.ranges(this.n5),b.context(a))}return this.xc},a.prototype.xja=function(a){var b,c;if(a){for(b=this.n5,c=0;c<b.length;c++)if(b[c].containsRange(a))return;b.push(a)}},a.prototype.IW=function(a,b){var c,d,e,f,g,h,i,j,k=this,l=k.n5;a&&l.length&&(c=a.row,d=a.col,e=a.rowCount,f=a.colCount,g=[],h=!1,i=k.kj,j=i&&[i.getRowCount(),i.getColumnCount()],l.forEach(function(a){var b=ua(a,c,d,e,f,j);b.PAb&&(h=!0),g.push(b)}),k.n5=[].concat.apply([],g),h&&b.RAb(k))},a.prototype.l1=function(){return this.n5},a.prototype.yyb=function(){var a=this;a.condition()&&a.condition().initExpression()},a.prototype.dPJ=function(a){this.condition()&&this.condition().ranges(a)},a.prototype.cPJ=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this,p=!1;for(o.yyb(),d=o.n5,e=0,f=d.length;e<f;e++)g=d[e],h=g.row,i=g.rowCount,j=g.col,k=g.colCount,l=h===a.row&&i===a.rowCount&&a.col<=j&&k<=a.colCount,m=h===b.row&&i===b.rowCount&&b.col<=j&&k<=b.colCount,n=l||m,n&&(d[e]=T(h,j,i+c,k),p=!0);return p&&o.dPJ(d),p},a.prototype.rI=function(a,b,c,d){var e,f,g,h,i,j,k;if(!(a<0||b<=0)){for(this.condition()&&this.condition().initExpression(),e=0;e<this.n5.length;e++)if(f=this.n5[e],g=f.row,c&&c.length>0){for(h=!1,i=0,j=c.length;i<j;i++)if(k=c[i]){if(d===!0&&!k.containsRange(f))continue;if(k.row===g&&k.row+k.rowCount-b===g+f.rowCount&&g===a){f.rowCount+=b,h=!0;break}a<=g&&(f.row+=b)}if(h)break}else a<=g?f.row+=b:a<=g+f.rowCount&&(f.rowCount+=b);this.condition()&&this.condition().ranges(this.n5)}},a.prototype.GR=function(a,b){if(!(a<0||b<=0)){this.condition()&&this.condition().initExpression();var c=[];this.n5.forEach(function(d){var e,f=d.row,g=d.rowCount;a<f?(e=a+b-f,e<=0?f-=b:(f-=e,d.rowCount-=e),f<0&&(d.rowCount+=f,f=0),d.row=f):f<=a&&a<f+g&&(d.rowCount-=U(b,f+g-a)),(d.rowCount>0||d.row===-1&&d.rowCount===-1)&&c.push(d)}),this.n5=c,this.condition()&&this.condition().ranges(this.n5)}},a.prototype.tI=function(a,b,c){var d,e,f,g,h,i,j,k;if(!(a<0||b<=0)){for(this.condition()&&this.condition().initExpression(),d=0;d<this.n5.length;d++){if(e=this.n5[d],c&&c.length>0){for(f=!1,g=!1,h=0,i=c.length;h<i;h++)if(j=c[h],!j||j.containsRange(e)){if(j&&j.col===e.col&&j.col+j.colCount-b===e.col+e.colCount&&j.col===a){e.colCount+=b,g=!0;break}}else f=!0;if(f)continue;if(g)break}k=e.col,a<=k?e.col+=b:a<=k+e.colCount&&(e.colCount+=b)}this.condition()&&this.condition().ranges(this.n5)}},a.prototype.HR=function(a,b){if(!(a<0||b<=0)){this.condition()&&this.condition().initExpression();var c=[];this.n5.forEach(function(d){var e,f=d.col,g=d.colCount;a<f?(e=a+b-f,e<=0?f-=b:(f-=e,d.colCount-=e),f<0&&(d.colCount+=f,f=0),d.col=f):f<=a&&a<f+g&&(d.colCount-=U(b,f+g-a)),(d.colCount>0||d.col===-1&&d.colCount===-1)&&c.push(d)}),this.n5=c,this.condition()&&this.condition().ranges(this.n5)}},a.prototype.vlK=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,p=this;c?(d=N(a,"sqref"),d&&(e=g.formulaToRanges(b,d.c_[0],0,0,!0)[0].ranges),p.n5=e):p.n5=g.formulaToRanges(b,a.sqref,0,0,!0)[0].ranges,f=Na(a.type),h=fa[a.operator],s(f)||p.type(f),s(h)&&(h=6),p.comparisonOperator(h),a.allowBlank===o?p.ignoreBlank(!0):p.ignoreBlank(!1),s(a.error)||p.errorMessage(G(a.error)),s(a.errorTitle)||p.errorTitle(G(a.errorTitle)),s(a.errorStyle)||p.errorStyle(ja[a.errorStyle]),s(a.prompt)||p.inputMessage(G(a.prompt)),a.showDropDown===o&&p.inCellDropdown(!1),s(a.promptTitle)||p.inputTitle(G(a.promptTitle)),a.showErrorMessage!==o&&p.showErrorMessage(!1),a.showInputMessage!==o&&p.showInputMessage(!1),i=a.c_,i&&i.length>0&&(c?i.forEach(function(a){if(a){var b=N(a,"f");l=G(b&&b.c_[0]),"formula1"===a.n_&&(j=va(l,f)),"formula2"===a.n_&&(k=va(l,f))}}):i.forEach(function(a){a&&(l=G(Q(a)),"formula1"===a.n_&&(j=va(l,f)),"formula2"===a.n_&&(k=va(l,f)))})),s(f)||(m=void 0,1===f||2===f?m=ya(h,Ua(j),k,1===f):3===f?(l=j?j:k,l&&(m='"'===l[0]&&'"'===l[l.length-1]?Fa(J(l)):Ea(H(l)))):4===f||5===f?m=5===f?Ba(h,j,k):Aa(h,j,k):6===f?m=Ca(h,j,k):7===f&&void 0!==j&&(m=Da(j)),m&&(n=m.condition(),n&&(n.ranges(p.n5),n.ignoreBlank(p.ignoreBlank()),n.context(b),p.condition(n)))),p.kj=b,a.lossless&&a.lossless.highlightStyle&&(p.QAb=JSON.parse(a.lossless.highlightStyle))},a.w$=1,a}(),b.DefaultDataValidator=na,oa={errorStyle:z("errorStyle",0),ignoreBlank:z("ignoreBlank",!0,function(a){this.condition()&&this.condition().ignoreBlank(a)}),preciseCompareDate:z("preciseCompareDate",!1,function(a){this.condition()&&this.condition().preciseCompareDate(a)}),inCellDropdown:z("inCellDropdown",!0),showInputMessage:z("showInputMessage",!0),showErrorMessage:z("showErrorMessage",!0),inputTitle:z("inputTitle",""),errorTitle:z("errorTitle",""),inputMessage:z("inputMessage",""),errorMessage:z("errorMessage",""),comparisonOperator:z("comparisonOperator",6),condition:z("condition",w),type:z("type",0)},v.extend(na.prototype,oa);function wa(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg=="}b.zW=wa;function xa(a){return p&&a&&"="===a[0]}b.bW=xa;function ya(a,b,c,d){var e,f,g,h,i=w,j=w,k=w,l=w;return xa(b)?i=r(b,"="):j=b,xa(c)?k=r(c,"="):l=c,e=w,6===a&&(f=q(1,3,j,i),f.integerValue(d),g=q(1,5,l,k),g.integerValue(d),e=q(0,1,w,w,w,w,w,f,g)),7===a&&(f=q(1,4,j,i),f.integerValue(d),g=q(1,2,l,k),g.integerValue(d),e=q(0,0,w,w,w,w,w,f,g)),a>=0&&a<=5&&(e=q(1,a,j,i),e.integerValue(d)),h=new na(e),h.type(d?1:2),h.comparisonOperator(a),h}b.createNumberValidator=ya;function za(a,b,c,d,e){var f,g,h,i,j,k=w,l=w,m=w,n=w;if(xa(b)?k=r(b,"="):l=b,xa(c)?m=r(c,"="):n=c,f=w,6===a&&(g=q(d,5,l,k),h=q(d,3,n,m),f=q(0,1,w,w,w,w,w,g,h)),7===a&&(g=q(d,2,l,k),h=q(d,4,n,m),f=q(0,0,w,w,w,w,w,g,h)),a>=0&&a<=5){switch(a){case 0:i=0;break;case 1:i=1;break;case 2:i=4;break;case 3:i=5;break;case 4:i=2;break;case 5:i=3}f=q(d,i,l,k)}return j=new na(f),j.type(e),j.comparisonOperator(a),j}function Aa(a,b,c){return za(a,b,c,5,4)}b.createDateValidator=Aa;function Ba(a,b,c){return za(a,b,c,13,5)}b.createTimeValidator=Ba;function Ca(a,b,c){var d,e,f,g,h=w,i=w,j=w,k=w;return xa(b)?h=r(b,"="):i=b,xa(c)?j=r(c,"="):k=c,d=w,6===a&&(e=q(7,3,i,h),f=q(7,5,k,j),d=q(0,1,w,w,w,w,w,e,f)),7===a&&(e=q(7,4,i,h),f=q(7,2,k,j),d=q(0,0,w,w,w,w,w,e,f)),a>=0&&a<=5&&(d=q(7,a,i,h)),g=new na(d),g.type(6),g.comparisonOperator(a),g}b.createTextLengthValidator=Ca;function Da(a){if(!p)return w;var b=new na(q(4,w,w,r(a,"="),4));return b.type(7),b}b.createFormulaValidator=Da;function Ea(a){if(!p)return w;var b=new na(f.Condition.fromFormula(a));return b.type(3),b}b.createFormulaListValidator=Ea;function Fa(a){var b=new na(f.Condition.fromSource(a));return b.type(3),b}b.createListValidator=Fa,v.extend(e.Worksheet.prototype,{getDataValidator:function(a,b,c){var d=this.dDJ(a,b,c);return d?d[0]:x},dDJ:function(a,b,c){return s(c)&&(c=3),3===c?this.uja.Aja(a,b):x},setDataValidator:function(a,b,c,d,f,g){var h,i,j,k,l=this,m=l.uja;if(arguments.length<5&&(f=c,g=d,c=a===-1?-1:1,d=b===-1?-1:1),s(g)&&(g=3),3===g){if(h=l.getDataValidator(a,b,g),i=1===c&&1===d,i&&h===f)return;l.ITa.zVa(),j=T(a,b,c,d),m.Cja(j),f&&m.Bja(f,j),l.ITa.zVa(!0),k="validator",i&&(l.Bq(k,a,b,g,h,f),l.Wq(e.Events.WorksheetDataChanged,{type:"dataValidation"}),a!==-1&&b===-1?l.kq(a,g,k,f,h):a===-1&&b!==-1&&l.pq(b,g,k,f,h)),l.$p()}},isValid:function(a,b,c,d){var e,f=this;try{if(f.Ku=a,f.Lu=b,f.Mu=c,f.Ju=!0,e=f.getDataValidator(a,b))return e.isValid(f,a,b,c,d)}finally{f.Ku=-1,f.Lu=-1,f.Mu=w,f.Ju=!1}return!0},hm:function(){var a,b,c,d,e=this;return!e.x$&&(e.x$=!0,a=e.KH,a&&(b=a.parentNode,b&&b.removeChild(a),e.KH=w),c=e.y$,c&&(v(c).unbind("click"),b=c.parentNode,b&&b.removeChild(c),e.y$=w),d=e.lm,d&&(v(d).unbind("keydown").unbind("blur").unbind("click").unbind("change"),b=d.parentNode,b&&b.removeChild(d),e.lm=w),e.x$=!1,!0)},tja:function(){var a,b,c,d=this,e=[],f=d.uja,g=f&&f.Dja;if(g)for(a in g)b=g[a],c=b&&b.condition(),c&&c.getExpressions&&c.getExpressions().length>0&&e.push({validator:b,sheet:d});return e}}),v.extend(e.Workbook.prototype,{tja:function(){var a=[],b=this,c=b.sheets;return c.forEach(function(b){var c=b.tja();c&&c.length&&c.forEach(function(b){a.push(b)})}),a}}),v.extend(e.CellRange.prototype,{validator:function(a){var b=this,c=b.sheet,d=b.sheetArea,e=b.row,f=b.col,g=b.rowCount,h=b.colCount;return 0===arguments.length?c.getDataValidator(e,f,d):(c.setDataValidator(e,f,g,h,a,d),b)}});function Ga(a){return this.Tq(a)}function Ha(a,b){if(a&&b&&b.length)return b.map(Ga.bind(a))}function Ia(a,b,c){var d=a.rowCount,e=a.colCount,f=T(a.row,a.col,d,e);return 0===a.row&&d===b&&(f.row=-1),0===a.col&&e===c&&(f.col=-1),f}function Ja(a,b){var c=a.getRowCount(),d=a.getColumnCount();return b.map(function(a){return Ia(a,c,d)})}function Ka(a,b){var c,d=a.cellCache;return d||(a.cellCache=d={}),c=d[b],c||(d[b]=c={}),c}function La(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,t,u,v=d.e_J,w=a.row,x=a.col,y=a.rowCount,z=a.colCount,A=w+y,B=x+z;if(A-1>=b&&(y=b-w),B-1>=c&&(z=c-x),A!==b)if(B!==c)for(o=0,p=w;o<y;o++,p++)for(q=Ka(v,p),h=0,i=x;h<z;h++,i++)l=q[i],l&&l!==e&&l.IW(a,d),q[i]=e;else for(o=0,p=w;o<y;o++,p++)q=v.rowCache,q||(v.rowCache=q={}),r=q[p],r||(q[p]=r={}),l=r.dv,t=r.cacheStartColIndex,u=r.cacheColCount,l&&l!==e&&l.IW(a,d),r.dv=e,r.cacheStartColIndex=x,(s(r.cacheColCount)||g===!1&&(f>t||0===x&&f===t)&&f<t+u)&&(r.cacheColCount=z);else for(h=0,i=x;h<z;h++,i++)j=v.colCache,j||(v.colCache=j={}),k=j[i],k||(j[i]=k={}),l=k.dv,m=k.cacheStartRowIndex,n=k.cacheRowCount,l&&l!==e&&l.IW(a,d),k.dv=e,k.cacheStartRowIndex=w,(s(k.cacheRowCount)||g===!0&&(f>m||0===w&&f===m)&&f<m+n)&&(k.cacheRowCount=y)}function Ma(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=b.e_J,t=a.row,u=a.col,v=a.rowCount,w=a.colCount,y=b.WS,z=y.getRowCount(),A=y.getColumnCount(),B=s.colCache,C=s.rowCache,D=s.cellCache;if(B)for(c=u;c<u+w;c++)if(d=B[c],e=d&&d.cacheStartRowIndex,f=d&&d.cacheRowCount,d&&t>=e&&t<e+f)if(t>e&&t<z){for(g=e;g<t;g++)h=Ka(s,g),g<t&&(h[c]=d.dv);d.cacheStartRowIndex=t+v}else t+v===z&&(i=d.dv,i&&i.IW(a,b),B[c]=x);if(C)for(j=t;j<t+v;j++)if(h=C[j],k=h&&h.cacheStartColIndex,l=h&&h.cacheColCount,h&&u>=k&&u<k+l)if(u>k&&u<A){for(m=k;m<u;m++)n=Ka(s,j),m<u&&(n[m]=h.dv);h.cacheStartColIndex=u+w}else u+w===A&&(i=h.dv,i&&i.IW(a,b),C[j]=x);if(D)for(j=0,o=t,p=v;j<p;j++,o++)if(h=D[o])for(c=0,q=u,r=w;c<r;c++,q++)i=h[q],i&&i.IW(a,b),h[q]=x}function Na(a){switch(a){case"none":return ha.anyValue;case"whole":return ha.wholeNumber;case"decimal":return ha.decimalValues;case"list":return ha.list;case"date":return ha.date;case"time":return ha.time;case"textLength":return ha.textLength;case"custom":return ha.custom}}function Oa(a){var b,c,d=[];if(a)for(b in a)c=a[b],c&&d.push(c);return d}pa=function(){function a(a){this.WS=a,this.Dja={},this.e_J={},this.SAb=[]}return a.prototype.getUsedRange=function(){var a,b,c,d,e,f,g,h=this,i=h.Aja(),l={};if(i)for(a=void 0,b=0,c=i;b<c.length;b++)for(d=c[b],a=d.l1(),e=0,f=a;e<f.length;e++)g=f[e],j(l,k(g));return l},a.prototype.no=function(){this.WS=w},a.prototype.UV=function(a){return Ha(this.WS,a)},a.prototype.EW=function(a){return Ja(this.WS,a)},a.prototype.QV=function(a,b,c){var d,e,f=this,g=f.Dja;if(s(b)?f.e_J={}:f.e_J.cellCache={},g)for(d in g)e=g[d],e&&(a&&delete e.yja,f.FW(e,!0,b,c));f.Fja()},a.prototype.RAb=function(a){var b=this.SAb;b.indexOf(a)===-1&&b.push(a)},a.prototype.FW=function(a,b,c,d){var e=this,f=e.UV(a.l1()),g=e.WS,h=g.getRowCount(),i=g.getColumnCount();f&&(e.SAb.length=0,f.forEach(function(b){La(b,h,i,e,a,c,d)}),b||e.Fja())},a.prototype.GW=function(a){var b=this,c=b.UV(a.l1());b.SAb.length=0,c.forEach(function(a){Ma(a,b)}),b.Fja()},a.prototype.HW=function(a){var b=this;a&&Ma(b.WS.Tq(a),b),b.Fja()},a.prototype.Fja=function(){var a,b=this.SAb;b.length&&(a=this.Dja,b.forEach(function(b){b.l1().length?b.condition()&&b.condition().ranges(b.l1()):(delete a[b.id],delete b.kj)}),b.length=0)},a.prototype.Bja=function(a,b){var c=this,d=c.WS;if(b&&(a.kj&&d!==a.kj&&(a=a.clone(d)),a.kj=d,a.xja(b)),d)return a.context(d),c.Dja[a.id]=a,c.FW(a),a},a.prototype.Cja=function(a){if(a){var b=this,c=b.WS;b.HW(a),c.$p()}},a.prototype.$b=function(){var a=this,b=a.WS;b&&(a.Dja={},a.QV())},a.prototype.Aja=function(a,b){var c,d,e,f,g,h,i,j,k=this,l=k.Dja;return 0===arguments.length?Oa(l):(c=[],d=k.e_J,a===x&&(a=-1),b===x&&(b=-1),a===-1&&b===-1?Oa(l):(f=d.colCache,g=f&&f[b],g&&(a>=g.cacheStartRowIndex&&a<g.cacheStartRowIndex+g.cacheRowCount||a===-1&&0===g.cacheStartRowIndex)?(c.push(g.dv),c):(h=d.rowCache,i=h&&h[a],i&&(b>=i.cacheStartColIndex&&b<i.cacheStartColIndex+i.cacheColCount||b===-1&&0===i.cacheStartColIndex)?(c.push(i.dv),c):(j=d.cellCache,j&&(a!==-1&&b!==-1?(e=j[a],e&&e[b]&&c.push(e[b])):a===-1?v.each(j,function(a,d){var e=d[b];e&&c.indexOf(e)===-1&&c.push(e)}):(e=j[a],e&&v.each(e,function(a,b){b&&c.indexOf(b)===-1&&c.push(b)}))),c))))},a.prototype.cPJ=function(a,b,c){var d,e,f=this,g=f.WS,h=g.ITa,i=f.Dja,j=!1;if(!s(i)){h.zVa();for(d in i)e=i[d],e&&e.cPJ(a,b,c)&&(j=!0);j&&f.QV()}},a.prototype._V=function(a,b,c,d,e){var f,g,h=this,i=h.Dja;if(i)for(f in i)g=i[f],g&&(c?g.rI(a,b,d,e):g.tI(a,b,d));h.QV(x,a,c)},a.prototype.rI=function(a,b,c,d){this._V(a,b,!0,c,d)},a.prototype.tI=function(a,b,c){this._V(a,b,!1,c)},a.prototype.aW=function(a,b,c){var d,e,f=this,g=f.Dja;if(g)for(d in g)e=g[d],e&&(c?e.GR(a,b):e.HR(a,b),0===e.n5.length&&(g[d]=x));f.QV()},a.prototype.GR=function(a,b){this.aW(a,b,!0)},a.prototype.HR=function(a,b){this.aW(a,b,!1)},a.prototype.toJSON=function(a){var b,c,d=this.Dja,e=[];for(b in d)c=d[b],c&&e.push(c.toJSON(a));return e},a.prototype.fromJSON=function(a,b,c){var d=this,e=d.WS;d.Dja={},a&&a.length&&(a.forEach(function(a){var f=new na;f.fromJSON(a,b,c),f.kj=e,d.Dja[f.id]=f}),d.QV())},a.prototype.vja=function(a,b,c){this.WS.setDataValidator(a,b,c)},a}(),v.extend(e.lUa.prototype,{zVa:function(a){var b,c,d,e,f,g=this,h=g.zTa;if(h&&(a||!h.originalValidators)){b=g.uja.Dja,c=[];for(d in b)e=b[d],e&&(f=e.n5.map(function(a){return T(a.row,a.col,a.rowCount,a.colCount)}),c.push({validator:e,ranges:f}));a?h.currentValidators=c:h.originalValidators=c}},BVa:function(a){var b,c,d;a&&(b=this.kj,c=this.uja,d={},a.forEach(function(a){var c,e=a.validator;"Object"===e.constructor.name&&(c=new na,c.fromJSON(e,!1,b),e=c),e.n5=a.ranges,e.condition()&&e.condition().ranges(e.n5),d[e.id]=e}),c.Dja=d,c.QV(!1))},CVa:function(a,b,c,d){this.zVa(),this.uja.rI(a,b,c,d),this.zVa(!0)},DVa:function(a,b){this.zVa(),this.uja.GR(a,b),this.zVa(!0)},EVa:function(a,b,c){this.zVa(),this.uja.tI(a,b,c),this.zVa(!0)},FVa:function(a,b){this.zVa(),this.uja.HR(a,b),this.zVa(!0)},GVa:function(a){this.zVa(),this.uja.HW(a),this.zVa(!0)},HVa:function(){this.zVa(),this.uja.QV(),this.zVa(!0)}}),e.lUa.$n("validator",{init:function(){this.uja=new pa(this.kj)},applyChanges:function(a){var b,c=a.changes,d=a.isUndo;c&&(b=d?c.originalValidators:c.currentValidators,b&&this.BVa(b))},undo:function(a){var b=a.originalValidators;b&&this.BVa(b)},dispose:function(a){var b=a&&a.clearCache;b!==!1&&this.uja&&(this.uja.no(),this.uja=w)}});function Pa(a){return"string"==typeof a&&(a='"'+a+'"'),a}function Qa(a){var b=a.Yw;return s(b)?(b=a.expected(),Pa(E(b))):b}function Ra(a){if(s(a))return w;var b=a.conType(),c,d;return 0===b?Sa(a):1===b||7===b?(d=a.formula(),s(d)&&(d=a.expected()),{firstFormula:d}):4===b?{firstFormula:s(a.formula())?a.expected():a.formula()}:12===b||5===b||13===b?{firstFormula:Qa(a)}:{firstFormula:w}}function Sa(a){if(s(a))return w;var b=w,c=w;return a.item1()&&(b=0===a.item1().conType()?Sa(a.item1()).firstFormula:Ra(a.item1()).firstFormula),a.item2()&&(c=0===a.item2.conType?Sa(a.item2()).firstFormula:Ra(a.item2()).firstFormula),{firstFormula:b,secondFormula:c}}function Ta(a){var b,c=typeof a;return"string"===c||"number"===c?C(""+a):s(a)||(b=a,s(b.item1))?"":Ta(b.item1)}function Ua(a){if(!s(a)){var b=+a;return isNaN(b)?a:b}}function Va(a){var b=a.row,c=a.col,d=a.rowCount,f=a.colCount;return b===-1&&c===-1?c=0:(b!==-1&&d!==-1&&b+d>e.MAX_ROW_COUNT&&(d=e.MAX_ROW_COUNT-b),c!==-1&&f!==-1&&c+f>e.MAX_COLUMN_COUNT&&(f=e.MAX_COLUMN_COUNT-c)),T(b,c,d,f)}function Wa(a){var b=a.map(Va);return g.rangesToFormula(b,0,0,15,!1).split(", ").join(" ")}e.Worksheet.$n("validator",{getUsedRange:function(a){var b,c,d;a.type&e.UsedRangeType.dataValidation&&(b=this,c=b.uja,d=c.getUsedRange(),j(a.range,d))},init:function(){var a=this;a.uja=a.ITa.uja,a.Gu(e.Events.FloatingElementSelected+X),a.Fu(e.Events.FloatingElementSelected+X,function(b,c){"worksheet"!==c.type&&a.hm()})},dispose:function(a){var b=this;b.hm(),a.clearCache&&b.uja.$b(),a.clearCache!==!1&&b.Gu(e.Events.FloatingElementSelected+X)},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=a.rowCount,e=a.col,f=a.colCount,g=a.sheetArea,h=this.ITa,i=this.tables;"addRows"===b?h.CVa(c,d,i&&i.WFc(c,-1,d,-1,!0)):"deleteRows"===b?h.DVa(c,d):"addColumns"===b?h.EVa(e,f,i&&i.WFc(-1,e,-1,f,!1)):"deleteColumns"===b?h.FVa(e,f):"clear"===b?3===g&&2===(2&a.type)&&h.GVa(T(c,e,d,f)):"setColumnCount"!==b&&"setRowCount"!==b||3!==g&&1!==g||h.HVa()},toJson:function(a,b){var c,d=this.uja,e=b&&b.ignoreStyle;d&&!e&&(c=d.toJSON(this),c&&c.length&&(a.validations=c))},fromJson:function(a,b,c){var d,e=c&&c.ignoreStyle;a&&a.validations&&!e&&(d=a.validations,this.uja.fromJSON(d,b,this))},bdK:function(a,b,c){var d,f,g,h,i,j,k,p,q,r,t,u,v,w,x,y,z,A,B,C,E,G,H,I,J,K,P,Q,R=this,T=R.uja,U=c&&c.includeStyles===!1,V=c&&c.fileType===e.OpenSaveFileType.excel;if(!U&&T&&!R.ODJ){d=T.Dja,f={n_:m,c_:[]},g=f.c_,h=0,i=[];for(j in d)if(k=d[j],k&&k.n5&&k.n5.length>0){if(p={n_:n},h++,q=k.comparisonOperator(),r=k.ignoreBlank(),t=k.errorMessage(),u=k.errorTitle(),v=k.errorStyle(),w=k.inputMessage(),x=k.inCellDropdown(),y=k.inputTitle(),z=k.showErrorMessage(),A=k.showInputMessage(),6!==q&&(p.operator=ea[q]),r!==!1&&(p.allowBlank=o),t&&(p.error=F(M(t))),u&&(p.errorTitle=F(u)),0!==v&&(p.errorStyle=da[v]),w&&(p.prompt=F(M(w))),x===!1&&(p.showDropDown=o),y&&(p.promptTitle=F(y)),z!==!1&&(p.showErrorMessage=o),A!==!1&&(p.showInputMessage=o),B=k.condition(),C=k.n5,p.sqref=Wa(C),B){if(E=k.type(),p.type=ca[E],G=Ra(B),H=G.firstFormula,I=G.secondFormula,V&&(O(H)||O(I)))return;p.c_=[],J=R.name(),K=R.parent&&R.parent.$dK(),D(H,J,K)||D(I,J,K)?(p.n_=n,s(H)||p.c_.push({n_:"formula1",c_:[{n_:"f",c_:[F(L(H))]}]}),s(I)||p.c_.push({n_:"formula2",c_:[{n_:"f",c_:[F(L(I))]}]}),p.c_.push({n_:"sqref",c_:[S(C)]}),i.push(p)):(s(H)||(4===E||5===E?p.c_.push({n_:"formula1",c_:[sa(H)+""]}):p.c_.push({n_:"formula1",c_:[F(L(H))]})),s(I)||(4===E||5===E?p.c_.push({n_:"formula2",c_:[sa(I)+""]}):p.c_.push({n_:"formula2",c_:[F(L(I))]})))}k.QAb&&(p.lossless={highlightStyle:JSON.stringify(k.QAb)}),g.push(p)}g.length>0&&(f.count=h,a.c_.push(f)),i.length>0&&(P=N(a,l),Q={n_:"ext",r_:[1,9],c_:[{n_:m,c_:i,r_:[2],count:i.length}]},P.c_.push(Q))}},cdK:function(a,b,c){var d,e,f,h,i,j,k,n,o,p=this,q=p.uja,r=q.Dja,s=c&&c.includeStyles===!1;if(!s&&q&&g){if(d=N(a,m),e=d&&d.c_,f=N(a,l),h=P(f,"ext&dataValidations"),e&&e.length>0)for(i=e.length-1;i>=0;i--)j=e[i],k=new na,k.vlK(j,p),r[k.id]=k;if(h&&h.c_&&h.c_.length>0)for(n=h.c_,i=n.length-1;i>=0;i--)o=n[i],k=new na,k.vlK(o,p,!0),r[k.id]=k;q.QV()}}}),e.Style.$n("validator",{fromJson:function(a){if("validator"===a.p){var b=new na;b.fromJSON(a.v,a.noSchema,a.context),this.validator=b,a.r=!0}}}),ga.Yl.km.push(function(a,b){!b&&a.hm&&a.hm()})},"./node_modules/process/browser.js":function(a,b){var c,d,e,f,g,h,i=a.exports={};function j(){throw Error("setTimeout has not been defined")}function k(){throw Error("clearTimeout has not been defined")}!function(){try{c="function"==typeof setTimeout?setTimeout:j}catch(a){c=j}try{d="function"==typeof clearTimeout?clearTimeout:k}catch(a){d=k}}();function l(a){if(c===setTimeout)return setTimeout(a,0);if((c===j||!c)&&setTimeout)return c=setTimeout,setTimeout(a,0);try{return c(a,0)}catch(b){try{return c.call(null,a,0)}catch(b){return c.call(this,a,0)}}}function m(a){if(d===clearTimeout)return clearTimeout(a);if((d===k||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(a);try{return d(a)}catch(b){try{return d.call(null,a)}catch(b){return d.call(this,a)}}}e=[],f=!1,h=-1;function n(){f&&g&&(f=!1,g.length?e=g.concat(e):h=-1,e.length&&o())}function o(){var a,b;if(!f){for(a=l(n),f=!0,b=e.length;b;){for(g=e,e=[];++h<b;)g&&g[h].run();h=-1,b=e.length}g=null,f=!1,m(a)}}i.nextTick=function(a){var b,c=Array(arguments.length-1);if(arguments.length>1)for(b=1;b<arguments.length;b++)c[b-1]=arguments[b];e.push(new p(a,c)),1!==e.length||f||l(o)};function p(a,b){this.fun=a,this.array=b}p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={};function q(){}i.on=q,i.addListener=q,i.once=q,i.off=q,i.removeListener=q,i.removeAllListeners=q,i.emit=q,i.prependListener=q,i.prependOnceListener=q,i.listeners=function(a){return[]},i.binding=function(a){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw Error("process.chdir is not supported")},i.umask=function(){return 0}},"./node_modules/util/node_modules/inherits/inherits_browser.js":function(a,b){"function"==typeof Object.create?a.exports=function a(b,c){b.super_=c,b.prototype=Object.create(c.prototype,{constructor:{value:b,enumerable:!1,
writable:!0,configurable:!0}})}:a.exports=function a(b,c){b.super_=c;var d=function(){};d.prototype=c.prototype,b.prototype=new d,b.prototype.constructor=b}},"./node_modules/util/support/isBufferBrowser.js":function(a,b){a.exports=function a(b){return b&&"object"==typeof b&&"function"==typeof b.copy&&"function"==typeof b.fill&&"function"==typeof b.readUInt8}},"./node_modules/util/util.js":function(a,b,c){(function(a){var d,e,f,g,h=Object.getOwnPropertyDescriptors||function a(b){var c,d=Object.keys(b),e={};for(c=0;c<d.length;c++)e[d[c]]=Object.getOwnPropertyDescriptor(b,d[c]);return e},i=/%[sdj%]/g;b.format=function(a){var b,c,d,e,f,g;if(!y(a)){for(b=[],c=0;c<arguments.length;c++)b.push(j(arguments[c]));return b.join(" ")}for(c=1,d=arguments,e=d.length,f=(a+"").replace(i,function(a){if("%%"===a)return"%";if(c>=e)return a;switch(a){case"%s":return d[c++]+"";case"%d":return+d[c++];case"%j":try{return JSON.stringify(d[c++])}catch(a){return"[Circular]"}default:return a}}),g=d[c];c<e;g=d[++c])f+=v(g)||!C(g)?" "+g:" "+j(g);return f},b.deprecate=function(c,d){if(void 0!==a&&a.noDeprecation===!0)return c;if(void 0===a)return function(){return b.deprecate(c,d).apply(this,arguments)};var e=!1;function f(){if(!e){if(a.throwDeprecation)throw Error(d);a.traceDeprecation?console.trace(d):console.error(d),e=!0}return c.apply(this,arguments)}return f},d={},b.debuglog=function(c){if(A(e)&&(e=a.env.NODE_DEBUG||""),c=c.toUpperCase(),!d[c])if(RegExp("\\b"+c+"\\b","i").test(e)){var f=a.pid;d[c]=function(){var a=b.format.apply(b,arguments);console.error("%s %d: %s",c,f,a)}}else d[c]=function(){};return d[c]};function j(a,c){var d={seen:[],stylize:l};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),u(c)?d.showHidden=c:c&&b.Ia(d,c),A(d.showHidden)&&(d.showHidden=!1),A(d.depth)&&(d.depth=2),A(d.colors)&&(d.colors=!1),A(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=k),n(d,a,d.depth)}b.inspect=j,j.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},j.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function k(a,b){var c=j.styles[b];return c?"\x1b["+j.colors[c][0]+"m"+a+"\x1b["+j.colors[c][1]+"m":a}function l(a,b){return a}function m(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function n(a,c,d){var e,f,g,h,i,j,k,l,u,v;if(a.customInspect&&c&&F(c.inspect)&&c.inspect!==b.inspect&&(!c.constructor||c.constructor.prototype!==c))return e=c.inspect(d,a),y(e)||(e=n(a,e,d)),e;if(f=o(a,c))return f;if(g=Object.keys(c),h=m(g),a.showHidden&&(g=Object.getOwnPropertyNames(c)),E(c)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return p(c);if(0===g.length){if(F(c))return i=c.name?": "+c.name:"",a.stylize("[Function"+i+"]","special");if(B(c))return a.stylize(RegExp.prototype.toString.call(c),"regexp");if(D(c))return a.stylize(Date.prototype.toString.call(c),"date");if(E(c))return p(c)}return j="",k=!1,l=["{","}"],t(c)&&(k=!0,l=["[","]"]),F(c)&&(u=c.name?": "+c.name:"",j=" [Function"+u+"]"),B(c)&&(j=" "+RegExp.prototype.toString.call(c)),D(c)&&(j=" "+Date.prototype.toUTCString.call(c)),E(c)&&(j=" "+p(c)),0!==g.length||k&&0!=c.length?d<0?B(c)?a.stylize(RegExp.prototype.toString.call(c),"regexp"):a.stylize("[Object]","special"):(a.seen.push(c),v=k?q(a,c,d,h,g):g.map(function(b){return r(a,c,d,h,b,k)}),a.seen.pop(),s(v,j,l)):l[0]+j+l[1]}function o(a,b){if(A(b))return a.stylize("undefined","undefined");if(y(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return x(b)?a.stylize(""+b,"number"):u(b)?a.stylize(""+b,"boolean"):v(b)?a.stylize("null","null"):void 0}function p(a){return"["+Error.prototype.toString.call(a)+"]"}function q(a,b,c,d,e){var f,g,h=[];for(f=0,g=b.length;f<g;++f)K(b,f+"")?h.push(r(a,b,c,d,f+"",!0)):h.push("");return e.forEach(function(e){e.match(/^\d+$/)||h.push(r(a,b,c,d,e,!0))}),h}function r(a,b,c,d,e,f){var g,h,i;if(i=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},i.get?h=i.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):i.set&&(h=a.stylize("[Setter]","special")),K(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(i.value)<0?(h=v(c)?n(a,i.value,null):n(a,i.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),A(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function s(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function t(a){return Array.isArray(a)}b.isArray=t;function u(a){return"boolean"==typeof a}b.isBoolean=u;function v(a){return null===a}b.isNull=v;function w(a){return null==a}b.isNullOrUndefined=w;function x(a){return"number"==typeof a}b.isNumber=x;function y(a){return"string"==typeof a}b.isString=y;function z(a){return"symbol"==typeof a}b.isSymbol=z;function A(a){return void 0===a}b.isUndefined=A;function B(a){return C(a)&&"[object RegExp]"===H(a)}b.isRegExp=B;function C(a){return"object"==typeof a&&null!==a}b.isObject=C;function D(a){return C(a)&&"[object Date]"===H(a)}b.isDate=D;function E(a){return C(a)&&("[object Error]"===H(a)||a instanceof Error)}b.isError=E;function F(a){return"function"==typeof a}b.isFunction=F;function G(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||void 0===a}b.isPrimitive=G,b.isBuffer=c("./node_modules/util/support/isBufferBrowser.js");function H(a){return Object.prototype.toString.call(a)}function I(a){return a<10?"0"+a.toString(10):a.toString(10)}f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function J(){var a=new Date,b=[I(a.getHours()),I(a.getMinutes()),I(a.getSeconds())].join(":");return[a.getDate(),f[a.getMonth()],b].join(" ")}b.log=function(){console.log("%s - %s",J(),b.format.apply(b,arguments))},b.inherits=c("./node_modules/util/node_modules/inherits/inherits_browser.js"),b.Ia=function(a,b){var c,d;if(!b||!C(b))return a;for(c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a};function K(a,b){return Object.prototype.hasOwnProperty.call(a,b)}g="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0,b.promisify=function a(b){if("function"!=typeof b)throw new TypeError('The "original" argument must be of type Function');if(g&&b[g]){var c=b[g];if("function"!=typeof c)throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(c,g,{value:c,enumerable:!1,writable:!1,configurable:!0}),c}function c(){var a,c,d,e=new Promise(function(b,d){a=b,c=d}),f=[];for(d=0;d<arguments.length;d++)f.push(arguments[d]);f.push(function(b,d){b?c(b):a(d)});try{b.apply(this,f)}catch(a){c(a)}return e}return Object.setPrototypeOf(c,Object.getPrototypeOf(b)),g&&Object.defineProperty(c,g,{value:c,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(c,h(b))},b.promisify.custom=g;function L(a,b){if(!a){var c=Error("Promise was rejected with a falsy value");c.reason=a,a=c}return b(a)}function M(b){if("function"!=typeof b)throw new TypeError('The "original" argument must be of type Function');function c(){var c,d,e,f,g=[];for(c=0;c<arguments.length;c++)g.push(arguments[c]);if(d=g.pop(),"function"!=typeof d)throw new TypeError("The last argument must be of type Function");e=this,f=function(){return d.apply(e,arguments)},b.apply(this,g).then(function(b){a.nextTick(f,null,b)},function(b){a.nextTick(L,b,f)})}return Object.setPrototypeOf(c,Object.getPrototypeOf(b)),Object.defineProperties(c,h(b)),c}b.callbackify=M}).call(this,c("./node_modules/process/browser.js"))},"./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js":function(a,b,c){var d="object"==typeof d?d:{};d.Spread=d.Spread||{},d.Spread.CalcEngine=d.Spread.CalcEngine||{},d.Spread.CalcEngine.AdvancedFunctions=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./src/advancedFunctions.entry.ts")}({"./src/advancedFunctions.entry.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("CalcEngine");b.Functions=d.Functions,c("./src/functions-db.ts"),c("./src/functions-eng.ts"),c("./src/functions-fin.ts"),c("./src/functions-lookup.ts"),c("./src/functions-stat.ts")},"./src/functions-db.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("CalcEngine"),f=d.Common.q,g=null,h=e.Convert.Pa,i=e.Convert.Na,j=e.Convert.vf,k=e.Convert.Nh,l=e.Errors.DivideByZero,m=e.Errors.Value,n=e.Functions.ak,o=e.Functions.jk,p=isNaN,q=d.Common.u,r=q.kb,s=e.sR().Exp_InvalidCast,t=function(){function a(a,b,c){this.Gk=a,this.Hk=b,this.Wob=c}return a.prototype.Ik=function(a){var b={"=":9,"<>":10,"<":11,"<=":12,">":13,">=":14},c=e.evaluateOperator(b[this.Gk],a,this.Hk);return!!e.Functions.ik(c)&&e.Convert.Vh(c)},a}();function z(a,b){return[a,b].join(",")}u=function(){function a(a,b,c){var d=this;if(d.cj=0,d.Jk=a,d.Kk=c,d.Xob={},3===arguments.length){if(d.Lk=d.Mk(a,b),a.rowCount<2||a.colCount<1||c.rowCount<2||c.colCount<1||d.Lk<0||d.Jk.colCount<=d.Lk)throw s}else if(2===arguments.length&&(d.Lk=-1,a.rowCount<2||a.colCount<1||c.rowCount<2||c.colCount<1))throw s}return a.prototype.Mk=function(a,b){var c,d;if(o(b)){for(c=0;c<a.colCount;c++)if(d=e.Convert.bc(a[0][c]),d&&this.Nk(d,b))return c;return-1}return e.Convert.Rh(b)-1},a.prototype.Ok=function(){var a=this;if(a.cj<=0||a.Jk.rowCount<=a.cj)throw e.sR().Exp_InvalidOperation;return a.Jk[a.cj][a.Lk]},a.prototype.Pk=function(){for(var a=this,b=!1,c=a.Jk.rowCount;!b&&a.cj<c;)a.cj++,a.cj<c&&(b=a.Qk());return b},a.prototype.Rk=function(a){var b,c,f,h,i;if(o(a)){for(b=["=","<>","<=",">=","<",">"],c=e.Convert.bc(a),f=void 0,h=void 0,f=0;f<b.length;f++)if(d.Common.u.kb(c,b[f]))return c=c.substring(b[f].length),i=d.Common.o.lb(c),p(i)?this.Nk("true",c)?a=!0:this.Nk("false",c)?a=!1:(a=c,h=0===f):a=i,new t(b[f],a,h);return new t("=",a)}return a?new t("=",a):g},a.prototype.Yob=function(a,b){var c,d=this,e=d.Xob,f=z(a,b),g=e[f];return g||(c="_"+f,e[c]||(g=e[f]=d.Rk(d.Kk[a][b]),e[c]=!0)),g},a.prototype.Qk=function(){var a,b,c,d,e,g,h,i,j,k=this,l=!1,m=k.Kk,n=k.cj,p=m.rowCount,q=m.colCount,s=k.Jk,t=k.Zob;if(!t){for(d=m[0],t=[],b=0;b<q;b++){if(c=k.Mk(s,d[b]),c<0)return!1;t[b]=c}k.Zob=t}for(a=1;!l&&a<p;a++)for(l=!0,b=0;l&&b<q;b++)if(e=k.Yob(a,b)){if(g=s[n][t[b]],"="===e.Gk&&(h=e.Hk,o(h)&&o(g))){i=f.ub(h,!0),j=e.Wob,l=i?f.sb("^"+i+(j?"$":"")).test(g):j?g.toLowerCase()===h.toLowerCase():r(g,h,!0);continue}l=e.Ik(g)}return l},a.prototype.Nk=function(a,b){return a.toLowerCase()===b.toLowerCase()},a}();function A(a,b,c,d){for(var e,f=0,g=new u(a,b,c);g.Pk();)e=g.Ok(),e=d?i(e):e,e&&f++;return k(f)}function B(a,b,c,d,e,f,g){for(var n,o,q,r,s=g?1:0,t=0,v=0,w=new u(a,b,c);w.Pk();)if(n=w.Ok(),i(n)){if(o=h(n),p(o))return m;s=g?s*o:s+o,t+=o*o,v++}else if(j(n))return n;return f||g?k(s):(q=Math.max(0,(v*t-s*s)/(v*(v-e))),r=d?Math.sqrt(q):q,v<=1?l:k(r))}function C(a,b,c){for(var d,f,g=0,h=0,n=new u(a,b,c);n.Pk();){if(d=n.Ok(),j(d))return d;if(i(d)){if(f={value:0},!e.Convert.Th(d,f))return m;g+=f.value,h++}}return 0===h?l:k(g/h)}function D(a,b,c){return A(a,b,c,!0)}function E(a,b,c){return A(a,b,c,!1)}function F(a,b,c){var d,f=new u(a,b,c);return f.Pk()?(d=f.Ok(),f.Pk()?e.Errors.Number:d):m}function G(a,b,c){for(var d,f,g=!1,l=-e.Functions.hk,n=new u(a,b,c);n.Pk();){if(d=n.Ok(),j(d))return d;if(i(d)){if(f=h(d),p(f))return m;(!g||f>l)&&(l=f),g=!0}}return g?k(l):0}function H(a,b,c){for(var d,f,g=!1,l=e.Functions.hk,n=new u(a,b,c);n.Pk();){if(d=n.Ok(),j(d))return d;if(i(d)){if(f=h(d),p(f))return m;(!g||d<l)&&(l=d),g=!0}}return g?k(l):0}function I(a,b,c){return B(a,b,c,!1,0,!1,!0)}function J(a,b,c){return B(a,b,c,!0,1)}function K(a,b,c){return B(a,b,c,!0,0)}function L(a,b,c){return B(a,b,c,!1,0,!0)}function M(a,b,c){return B(a,b,c,!1,1)}function N(a,b,c){return B(a,b,c,!1,0)}v="!= 1",w={Yi:!0,Hi:4,Ii:0},x={Yi:!0},y=[w,x,w],n("DAVERAGE",C,3,3,y,v,v),n("DCOUNT",D,3,3,y,v,v),n("DCOUNTA",E,3,3,y,v,v),n("DGET",F,3,3,y,v,v),n("DMAX",G,3,3,y,v,v),n("DMIN",H,3,3,y,v,v),n("DPRODUCT",I,3,3,y,v,v),n("DSTDEV",J,3,3,y,v,v),n("DSTDEVP",K,3,3,y,v,v),n("DSUM",L,3,3,y,v,v),n("DVAR",M,3,3,y,v,v),n("DVARP",N,3,3,y,v,v)},"./src/functions-eng.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("CalcEngine"),f=d.Common.k.ac,g=void 0,h=Math.abs,i=Math.sin,j=Math.cos,k=Math.sqrt,l=Math.log,m=Math.pow,n=Math.exp,o=Math.E,p=Math.atan2,q=parseFloat,r=isNaN,s=e.Errors.NotAvailable,t=e.Errors.Number,u=e.Errors.Value,v=e.Functions.ak,w=e.Functions.qk,x=e.Convert.Nh,y=e.Convert.vf,z=e.Functions.MathHelper,A=z.Dk,B=e.Functions.Wi,C=0xffffffffffff,D=e.Convert.Th;function eb(a,b){return new e.Functions.Ui(a,b)}E=eb(1,0);function fb(a,b){return{Ld:a,_c:b}}function gb(a,b){var c=[],d;for(d=0;d<f(a);d++)c.push(fb(a[d],b[d]));return c.push(fb(null,0)),c}F=.00220462262184878,G=7e3*F,H=F/100,I=F/112,J=F/14,K=F/2240,L=gb(["g","sg","lbm","u","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","ton","uk_ton","LTON","brton"],[1,685217658567918e-19,F,6.02214179421676e23,.0352739619495804,G,H,H,I,I,I,J,110231131092439e-20,K,K,K]),M=1e4/254,N=M/12,O=N/3,P=O/1760,Q=M/45,R=6*M,S=.00062136994949495,T=1.05700083402462e-16,U=3.24077928966473e-17,V=gb(["m","mi","Nmi","in","ft","yd","ang","Pica","ell","ly","pc","pica","survey_mi","parsec","Picapt"],[1,P,1/1852,M,N,O,1e10,2834.64566929134,Q,T,U,R,S,U,2834.64566929134]),W=365.25,X=24*W,Y=60*X,Z=60*Y,$=gb(["yr","day","hr","mn","sec","d","min","s"],[1,W,X,Y,Z,W,Y,Z]),_=.007500637554192,aa=gb(["Pa","atm","mmHg","p","at","psi","Torr"],[1,986923266716013e-20,_,1,986923266716013e-20,.000145037737730209,.0075006168270417]),ba=1e5,ca=gb(["N","dyn","lbf","dy","pond"],[1,ba,.22480894309971,ba,101.971621297793]),da=745.69987158227,ea=gb(["HP","W","h","w","PS"],[1,da,1,da,1.013869665424]),fa=624150964712042e4,ga=1/(3600*da),ha=1/3600,ia=.000947817120313317,ja=.239005736137667,ka=gb(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,1e-7,ja,ja,fa,ga,ha,.737562149277265,ia,fa,ga,ha,ia]),la=gb(["T","ga"],[1,1e4]),ma=.00492892159375,na=1e27*ma,oa=.000139870932189991,pa=.00017406322338,qa=.30078125,ra=8.2073596535e-44,sa=492892159375e-17,ta=1.18251117638e-15,ua=64467860511e-16,va=7.75941468987e-16,wa=112266,xa=1740632233796e-18,ya=4351580584491e-18,za=gb(["tsp","tspm","tbs","oz","cup","pt","qt","uk_qt","gal","uk_gal","l","uk_pt","us_pt","lt","ang3","ang^3","barrel","bushel","ft3","ft^3","in3","in^3","ly3","ly^3","m3","m^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Pica3","Pica^3","Picapt3","Picapt^3","GRT","regton","MTON","L"],[1,.98578431875,1/3,1/6,1/48,1/96,1/192,.00433684471160932,1/768,.00108421117790233,ma,.00867368942321863,1/96,ma,na,na,1/32256,oa,pa,pa,qa,qa,ra,ra,sa,sa,ta,ta,ua,ua,va,va,wa,wa,wa,wa,xa,xa,ya,ma]),Aa=gb(["admkn","kn","m/h","m/hr","m/s","m/sec","mph"],[1,1.00063930885529,1853.184,1853.184,.514773333333333,.514773333333333,1.15151515151515]),Ba=10.7639104167097,Ca=144*Ba,Da=Ba/9,Ea=.000247105381467165,Fa=.000247104393046628,Ga=Da/3097600,Ha=2.91553349598123e-7,Ia=8035216.07043214,Ja=1.11725076312873e-32,Ka=gb(["m2","m^2","ft2","ft^2","in2","in^2","yd2","yd^2","uk_acre","us_acre","ang2","ang^2","ar","ha","Morgen","mi2","mi2","Nmi2","Nmi^2","Pica2","Picapt2","Pica^2","Picapt^2","ly2","ly^2"],[1,1,Ba,Ba,Ca,Ca,Da,Da,Ea,Fa,1e20,1e20,.01,1e-4,4e-4,Ga,Ga,Ha,Ha,Ia,Ia,Ia,Ia,Ja,Ja]),La=gb(["bit","byte"],[1,.125]),Ma={bit:"bit",byte:"byte"},Na={K:"K",kel:"kel",cel:"cel",C:"C",F:"F",fah:"fah",Rank:"Rank",Reau:"Reau"},Oa={day:"day",d:"d",yr:"yr",hr:"hr",mn:"mn",min:"min",sec:"sec",s:"s"},Pa=273.15,Qa=459.67,Ra=["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],Sa=gb(Ra,[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]),Ta=gb(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24,Math.pow(2,80),Math.pow(2,70),Math.pow(2,60),Math.pow(2,50),Math.pow(2,40),Math.pow(2,30),Math.pow(2,20),Math.pow(2,10)]),Ua=["sg","lbm","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","uk_ton","lcwt","hweight","stone","uk_ton","LTON","brton","ton","mi","Nmi","in","ft","yd","ell","Pica","survey_mi","Picapt","psi","Torr","lbf","HP","h","PS","HPh","flb","BTU","hh","btu","tsp","tspm","tbs","oz","cup","pt","us_pt","uk_pt","qt","UK_qt","gal","uk_gal","barrel","bushel","ft3","ft^3","in3","in^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Picapt3","Picapt^3","Pica3","Pica^3","GRT","regton","MTON","kn","admkn","uk_acre","us_acre","ft2","ft^2","in2","in^2","ly2","ly^2","Morgen","mi2","mi^2","Nmi2","Nmi^2","Pica2","Picapt^2","Pica^2","Picapt^2","yd2","yd^2"];function hb(a,b,c){var d,f,g,h,i,j,k,l=100,n=.5*a,o=n*n;for(n=m(n,q(b)),d=e.Functions.tk(b),f=1,g=0,h=q(b),i=n/d,j=.9*i,k=!1;i!==j&&0!==l;)n*=o,++g,d*=g,++h,f*=h,j=i,i=c||k?i+n/d/f:i-n/d/f,l--,k=!k;return i}function ib(a,b){var c=m(b,10),d=parseInt(a,b);return r(d)?t:c/2<=d?d-c:d}function jb(a,b,c){a<0&&(a+=m(b,10));var d=a.toString(b),e=c-f(d),g;for(g=0;g<e;g++)d="0"+d;return d.toUpperCase()}function kb(a,b){if(a<0)return t;var c=ib(a,b);return y(c)?t:c}function lb(a,b,c){var d=jb(a,c,b.Qb);return 0<=d&&b.Qb<f(d)&&b.$i?t:d}function mb(a,b,c,d,e){var g,h;return a<0?t:(g=ib(a,c),y(g)?t:e&&(g<-e||e-1<g)?t:(h=jb(g,d,b.Qb),0<=g&&b.Qb<f(h)&&b.$i?t:h))}function nb(a,b){var c=Number.POSITIVE_INFINITY,d=a.Pi(),e=a.Qi();return r(d)||d===c||r(e)||e===c?t:a.bc(b)}function ob(a,b,c,d){var e=a,f=b,g=c.Pi(),h=c.Qi();return a=d?e*g-f*h:e+g,b=d?e*h+f*g:f+h,{Ri:a,Si:b}}function pb(a,b){var c,d,g,h,i,j,k,l,m=b?1:0,n=0;for(d=0;d<f(a);d++)if(e.Convert.Ca(a[d]))for(k=a[d],g=0;g<k.rowCount;g++)for(h=0;h<k.columnCount;h++){if(c=B(k.getValue(g,h)),!c)return t;j=ob(m,n,c,b),m=j.Ri,n=j.Si}else if(e.Convert.Fh(a[d]))for(l=a[d],i=0;i<l.getRangeCount();i++)for(g=0;g<l.getRowCount(i);g++)for(h=0;h<l.getColumnCount(i);h++){if(c=B(l.getValue(i,g,h)),!c)return t;j=ob(m,n,c,b),m=j.Ri,n=j.Si}else{if(c=B(a[d]),!c)return t;j=ob(m,n,c,b),m=j.Ri,n=j.Si}return nb(eb(m,n))}function qb(a,b){return x(hb(a,b,!0))}function rb(a,b){return x(hb(a,b,!1))}function sb(a,b){var c,d,e,f,g,i,j,k,m,n=1.7976931348623157e308,o=.5772156649015329,p=0,q=.25*a*a,r=1,s=0,t=1,u=2/a;if(b>0){for(s=-o,f=1;f<b;f++)s+=1/f,r*=f+1;if(t=u,1===b)p=1/a;else{for(g=r/b,i=1,j=1,c=g,f=1;f<b;f++){if(g/=b-f,i*=f,j*=-q,d=g*j/i,c+=d,n-h(d)<h(c)||u>1&&n/u<t)return n;t*=u}if(c*=.5,d=h(c),t>1&&n/t<d||d>1&&n/d<t)return n;p=c*t}}k=2*l(a/2),m=-o,0===b?(s=m,d=1):(s+=1/b,d=1/r),c=(m+s-k)*d,e=1;do d*=q/(e*(e+b)),m+=1/e,s+=1/(e+b),c+=(m+s-k)*d,e++;while(h(d/c)>1.1102230246251565e-16);return c=.5*c/t,0!==(1&b)&&(c=-c),p+=c,x(p)}function tb(a,b){var c=[.0007969367292973471,.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],d=[.0007621256162081731,.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],e=[.0009244088105588637,.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],f=[.0005713231280725487,.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],g=[-.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],h=[.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372],m=[64.3178256118178,856.4300259769806,3882.4018360540163,7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],n=[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,2826.1927851763908,336.0936078106983],o=[15592.436785523574,-14663929.59039716,5435264770.518765,-982136065717.9115,87590639439536.7,-0xc5090e8ec6601,0x9d4a5b305a0018,-0x41b52d6418d9ec],p=[1263204747.9017804,-647355876379.1603,114509511541823.73,-8127702555013251,0x2cf35a16e6cd620,-0xacf20aeef158b80],r=[1041.2835366425984,626107.330137135,268919633.39381415,86400248710.3935,20297961275010.555,3171577528429750.5,0x37a4bf79f36ba00],s=[594.3015923461282,235564.09294306856,73481194.44597217,18760131610.870617,3882312774962.3857,620557727146953.8,0xf41f1e2a3d2440,0x3721e321ece8fe00],t=[-4794432209.782018,1956174919465.5657,-249248344360967.72,9708622510473064],u=[-899971225.7055594,452228297998.19403,-72749424522181.83,0xd15a1534be241],v=[499.563147152651,173785.4016763747,48440965.83399621,11185553704.535683,2112775201154.892,310518229857422.56,0x710505f9ecba70,0x17be34c7b662cc00],w=[620.8364781180543,256987.25675774884,83514679.14319493,22151159547.97925,4749141220799.914,784369607876235.9,89522233618462740,0x49de55d9c0a4e400],y=.7978845608028654,z=2.356194490192345,A=.7853981633974483;function B(a,b,c,d){var e=0,f=q(b[e]),g=c;e++,d&&(f+=a,g--);do f=f*a+q(b[e]),e++,--g;while(0!==g);return f}function C(a,b){var l,o,p,q,r,s=b?c:d,x=b?e:f,C=b?g:h,D=b?m:n,E=b?t:u,F=b?v:w,G=b?5.783185962946784:14.681970642123893,H=b?30.471262343662087:49.2184563216946;return a<=5?(o=a*a,b&&a<1e-5?1-o/4:(l=B(o,E,3)/B(o,F,8,!0),p=(o-G)*(o-H),p*=l,b?p:p*a)):(l=5/a,o=b?25/(a*a):l*l,p=B(o,s,6)/B(o,x,6),q=B(o,C,7)/B(o,D,7,!0),r=a-(b?A:z),p=p*j(r)-l*q*i(r),p*y/k(a))}function D(a,b){var q,t,u,v,w,x=b?c:d,D=b?e:f,E=b?g:h,F=b?m:n,G=b?o:p,H=b?r:s,I=b?1:a,J=b?7:5,K=b?7:8;return a<=5?(t=a*a,q=I*B(t,G,J)/B(t,H,K,!0),q+=.6366197723675814*(b?l(a)*C(a,!0):C(a,!1)*l(a)-1/a)):(q=5/a,t=b?25/(a*a):q*q,u=B(t,x,6)/B(t,D,6),v=B(t,E,7)/B(t,F,7,!0),w=a-(b?A:z),u=u*i(w)+q*v*j(w),u*y/k(a))}function E(a,b){var c=D(a,!0),d=D(a,!1),e=1,f=2*e,g;if(0===b)return c;if(1===b)return d;do g=f*d/a-c,c=d,d=g,f+=2,++e;while(e<b);return g}return x(E(a,b))}function ub(a){return kb(a,2)}function vb(a){return kb(a,16)}function wb(a){return kb(a,8)}function xb(a,b){return mb(a,b,2,16)}function yb(a,b){return mb(a,b,2,8)}function zb(a,b){return lb(a,b,2)}function Ab(a,b){return lb(a,b,16)}function Bb(a,b){return lb(a,b,8)}function Cb(a,b){return mb(a,b,16,2,512)}function Db(a,b){return mb(a,b,8,2,512)}function Eb(a,b){return mb(a,b,16,8,536870912)}function Fb(a,b){return mb(a,b,8,16,549755813888)}function Gb(a,b){var c,d=w(a*k(2)),e=2*d-1;return b.$i&&(d=w(b.Qb*k(2)),c=2*d-1,e=c-e),e}function Hb(a){return Gb(a,{$i:!1})}function Ib(a){return 1-Gb(a,{$i:!1})}function Jb(a,b){return e.Zh.Yh(a,b)?1:0}function Kb(a,b){return a>=b?1:0}function Lb(a,b,c){return"i"!==c&&"j"!==c?e.Errors.Value:nb(eb(a,b),c)}function Mb(a){return x(k(a.Ri*a.Ri+a.Si*a.Si))}function Nb(a){return x(a.Si)}function Ob(a){return 0===a.Ri&&0===a.Si?e.Errors.DivideByZero:x(p(a.Si,a.Ri))}function Pb(a){return nb(eb(a.Ri,-a.Si))}function Qb(a){return nb(eb(j(a.Ri)*A(a.Si,!1),-i(a.Ri)*A(a.Si,!0)))}function Rb(a,b){var c=a.Ri,d=a.Si,e=b.Ri,f=b.Si;return nb(eb((c*e+d*f)/(e*e+f*f),(d*e-c*f)/(e*e+f*f)))}function Sb(a){return nb(eb(n(a.Ri)*j(a.Si),n(a.Ri)*i(a.Si)))}function Tb(a){var b=a.Ri,c=a.Si;return nb(eb(l(k(b*b+c*c)),p(c,b)))}function Ub(a){var b=a.Ri,c=a.Si,d=z.Ek(o,10);return nb(eb(d*l(k(b*b+c*c)),d*p(c,b)))}function Vb(a){var b=a.Ri,c=a.Si,d=z.Ek(o,2);return nb(eb(d*l(k(b*b+c*c)),d*p(c,b)))}function Wb(a,b){var c,d,e=a.Ri,f=a.Si;return 0===e&&0===f?b>0?"0":t:(c=k(e*e+f*f),d=p(f,e),nb(eb(m(c,b)*j(b*d),m(c,b)*i(b*d))))}function Xb(a){return x(a.Ri)}function Yb(a){return nb(eb(i(a.Ri)*A(a.Si,!1),j(a.Ri)*A(a.Si,!0)))}function Zb(a){var b,c,d=a.Ri,e=a.Si;return 0===d&&0===e?"0":(b=k(d*d+e*e),c=p(e,d),nb(eb(k(b)*j(c/2),k(b)*i(c/2))))}function $b(a,b){return nb(eb(a.Ri-b.Ri,a.Si-b.Si))}function _b(){return pb(arguments,!0)}function ac(){return pb(arguments,!1)}function bc(a){var b,c=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"];for(b=0;c[b];b++)if(0===a.localeCompare(c[b]))return!1;return!0}function cc(a,b,c){var d,e,g,h,i,j,k=0,l=1;for(d=0;a[d].Ld;d++)if(0===c.localeCompare(a[d].Ld))return k=a[d]._c,{Tk:!0,Uk:l,Vk:k};if(b)for(d=0;b[d].Ld;d++)e=c.substr(0,1),g=b[d].Ld.substr(0,1),e===g&&bc(c)&&(l=b[d]._c);for(d=0;a[d].Ld;d++)if(h=f(a[d].Ld),i=c.substr(1,h),j=a[d].Ld.substr(0,h),i===j&&bc(c))return k=a[d]._c,{Tk:!0,Uk:l,Vk:k};return{Tk:!1,Uk:l,Vk:k}}function dc(a,b,c){var d,e,g,h,i,j,k,l,m,n,o;if(qc(b).unit&&qc(c).unit)return kc(a,b,c);if(d=hc(b,c),1===d)return s;if(2===d)return ic(a,b,c);if(fc(b)&&fc(c))return gc(a,b,c);if(ec(b)||ec(c))return s;for(e=[L,V,aa,ca,ka,ea,la,za,la,Aa,Ka],g=0;g<f(e);g++)if(h=e[g],i=cc(h,Sa,b),j=i.Tk,k=i.Vk,l=i.Uk,i=cc(h,Sa,c),m=i.Tk,n=i.Uk,o=i.Vk,j&&m&&0!==k&&0!==n)return a*l/k*o/n;return s}function ec(a){if(Ua.indexOf(a)>=0)return!1;var b=[a.slice(0,1),a.slice(1)],c=b[0],d=b[1];return Ra.indexOf(c)>=0&&Ua.indexOf(d)>=0}function fc(a){for(var b=0;b<$.length;b++)if(a===$[b].Ld)return!0;return"sec"===a.slice(1)||"s"===a.slice(1)}function gc(a,b,c){var d=cc($,Sa,b),e=cc($,Sa,c);return a*d.Uk/d.Vk*e.Vk/e.Uk}function hc(a,b){var c=a.indexOf("bit")>-1||a.indexOf("byte")>-1,d=b.indexOf("bit")>-1||b.indexOf("byte")>-1;return c&&d?2:d||c?1:0}function ic(a,b,c){var d=jc(b),e=jc(c);return a*d.Uk/d.Vk*e.Vk/e.Uk}function jc(a){var b,c,d,e,f,g,h;if(a.indexOf(Ma.bit)>-1?(b=[a.slice(0,-3),a.slice(-3)],d=b[0],f=b[1]):a.indexOf(Ma.byte)>-1&&(c=[a.slice(0,-4),a.slice(-4)],d=c[0],f=c[1]),d)for(h=0;Ta[h].Ld;h++)d===Ta[h].Ld&&(e=Ta[h]._c);else e=1;return f===Ma.bit?g=La[0]._c:f===Ma.byte&&(g=La[1]._c),{Uk:e,Vk:g}}function kc(a,b,c){var d,e=qc(b);switch(e.unit){case Na.Rank:d=oc(a,c);break;case Na.Reau:d=pc(a,c);break;case Na.C:case Na.cel:d=lc(a,c);break;case Na.F:case Na.fah:d=mc(a,c);break;case Na.K:case Na.kel:d=nc(a*e.prefixNumber,c)}return d}function lc(a,b){var c,d=qc(b);switch(d.unit){case Na.Rank:return 9*a/5+32+Qa;case Na.Reau:return.8*a;case Na.cel:case Na.C:return a;case Na.F:case Na.fah:return 9*a/5+32;case Na.K:case Na.kel:return c=d.prefixNumber,(a+Pa)/c}}function mc(a,b){var c,d=qc(b);switch(d.unit){case Na.Rank:return a+Qa;case Na.Reau:return 4*(a-32)/9;case Na.F:case Na.fah:return a;case Na.C:case Na.cel:return 5*(a-32)/9;case Na.K:case Na.kel:return c=d.prefixNumber,(5*(a-32)/9+Pa)/c}}function nc(a,b){var c,d=qc(b);switch(d.unit){case Na.Rank:return 9*a/5;case Na.Reau:return.8*(a-Pa);case Na.C:case Na.cel:return a-Pa;case Na.F:case Na.fah:return 9*(a-Pa)/5+32;case Na.K:case Na.kel:return c=d.prefixNumber,a/c}}function oc(a,b){var c,d=qc(b);switch(d.unit){case Na.Rank:return a;case Na.Reau:return.8*(a-Qa-32)*5/9;case Na.C:case Na.cel:return 5*(a-Qa-32)/9;case Na.F:case Na.fah:return a-Qa;case Na.K:case Na.kel:return c=d.prefixNumber,(Pa+5*(a-Qa-32)/9)/c}}function pc(a,b){var c,d=qc(b);switch(d.unit){case Na.Rank:return 1.25*a*9/5+32+Qa;case Na.Reau:return a;case Na.C:case Na.cel:return 1.25*a;case Na.F:case Na.fah:return 1.25*a*9/5+32;case Na.K:case Na.kel:return c=d.prefixNumber,(1.25*a+Pa)/c}}function qc(a){var b,c,d=1;if(Na[a])return{unit:a,prefixNumber:d};if("K"===Na[a.slice(1)]||"kel"===Na[a.slice(1)]){for(b=a.slice(0,1),a=a.slice(1),c=0;Sa[c].Ld;c++)b===Sa[c].Ld&&(d=Sa[c]._c);return{unit:a,prefixNumber:d}}return{unit:void 0,prefixNumber:d}}function rc(a,b,c,d){var e,f;if(""===a&&""===b)return u;if(e={value:0},f={value:0},D(a,e)===!0&&D(b,f)===!0){if(a=e.value,b=f.value,a<0||a>C||a%1!==0)return t;if("bitOperator"===c){if(b<0||b>C||b%1!==0)return t}else if("shiftOperator"===c&&0===a)return 0;return d(a,b)}return u}function sc(a,b){return rc(a,b,"bitOperator",function(a,b){return a&b})}function tc(a,b){return rc(a,b,"bitOperator",function(a,b){return a|b})}function uc(a,b){return rc(a,b,"bitOperator",function(a,b){return a^b})}function vc(a,b){return rc(a,b,"shiftOperator",function(a,b){if(b>=48)return t;if(b<0&&a<1<<-b)return 0;var c=a<<b;return c>C?t:c})}function wc(a,b){return rc(a,b,"shiftOperator",function(c,d){return d>53?t:b>=0?a>>b:a<<-b})}function xc(a,b){if(""===a)return t;if(a===!0||a===!1)return u;var c=B(a);return c?b(c):t}function yc(a){return xc(a,function(a){return nb(Jc(a),a.lja())})}function zc(a){return xc(a,function(a){return Qc(Gc(a),eb(0,0))?t:nb(Pc(Hc(a),Gc(a)),a.lja())})}function Ac(a){return xc(a,function(a){return Qc(a,eb(0,0))?t:nb(Lc(a),a.lja())})}function Bc(a){return xc(a,function(a){return Qc(Ic(a),eb(0,0))?t:nb(Mc(a),a.lja())})}function Cc(a){return xc(a,function(a){return Qc(Hc(a),eb(0,0))?t:nb(Nc(a),a.lja())})}function Dc(a){return xc(a,function(a){return Qc(Jc(a),eb(0,0))?t:nb(Oc(a),a.lja())})}function Ec(a){return xc(a,function(a){return nb(Ic(a),a.lja())})}function Fc(a){return xc(a,function(a){return nb(Kc(a),a.lja())})}function Gc(a){var b=a.Pi(),c=a.Qi();return eb(i(b)*A(c,!1),j(b)*A(c,!0))}function Hc(a){var b=a.Pi(),c=a.Qi();return eb(j(b)*A(c,!1),-(i(b)*A(c,!0)))}function Ic(a){var b=a.Pi(),c=a.Qi();return eb(A(b,!0)*j(c),A(b,!1)*i(c))}function Jc(a){var b=a.Pi(),c=a.Qi();return eb(A(b,!1)*j(c),A(b,!0)*i(c))}function Kc(a){return Pc(Gc(a),Hc(a))}function Lc(a){return Pc(E,Gc(a))}function Mc(a){return Pc(E,Ic(a))}function Nc(a){return Pc(E,Hc(a))}function Oc(a){return Pc(E,Jc(a))}function Pc(a,b){var c,d,e=a.Pi(),f=a.Qi(),g=b.Pi(),h=b.Qi();return Math.abs(h)<Math.abs(g)?(c=h/g,eb((e+f*c)/(g+h*c),(f-e*c)/(g+h*c))):(d=g/h,eb((f+e*d)/(h+g*d),(-e+f*d)/(h+g*d)))}function Qc(a,b){return a.Pi()===b.Pi()&&a.Qi()===b.Qi()}Va={Hi:0},Wa={Hi:5},Xa={Hi:5,aj:["checkLength 10"]},Ya={Zi:!0,Hi:2,_i:1,aj:["< 1","> 10"]},Za={Hi:2,aj:"< 0"},$a={Hi:8},_a={Hi:8,Oi:!0},ab=[Va,Za],bb=[{Hi:0,aj:"<= 0"},Za],cb=[Va,{Hi:0,_i:0}],db=[Xa,Ya],v("BESSELI",qb,2,2,ab),v("BESSELJ",rb,2,2,ab),v("BESSELK",sb,2,2,bb),v("BESSELY",tb,2,2,bb),v("BIN2DEC",ub,1,1,Xa),v("BIN2HEX",xb,1,2,db,g,g,{bk:1}),v("BIN2OCT",yb,1,2,db,g,g,{bk:1}),v("DEC2BIN",zb,1,2,[{Hi:0,aj:["< -512","> 511"]},Ya],g,g,{bk:1}),v("DEC2HEX",Ab,1,2,[{Hi:0,aj:["< -549755813888","> 549755813887"]},Ya],g,g,{bk:1}),v("DEC2OCT",Bb,1,2,[{Hi:0,aj:["< -536870912","> 536870911"]},Ya],g,g,{bk:1}),v("HEX2BIN",Cb,1,2,db,g,g,{bk:1}),v("HEX2DEC",vb,1,1,Xa),v("HEX2OCT",Eb,1,2,db,g,g,{bk:1}),v("OCT2BIN",Db,1,2,db,g,g,{bk:1}),v("OCT2DEC",wb,1,1,Xa),v("OCT2HEX",Fb,1,2,db,g,g,{bk:1}),v("ERF",Gb,1,2,[Va,{Zi:!0,Hi:0}],g,g,{bk:1}),v("ERF.PRECISE",Hb,1,1,Va),v("ERFC",Ib,1,1,Va),v("ERFC.PRECISE",Ib,1,1,Va),v("DELTA",Jb,1,2,cb,g,g,{
bk:1}),v("GESTEP",Kb,1,2,cb,g,g,{bk:1}),v("COMPLEX",Lb,2,3,[Va,Va,{Hi:5,_i:"i"}],g,g,{bk:2}),v("IMABS",Mb,1,1,$a),v("IMAGINARY",Nb,1,1,$a),v("IMARGUMENT",Ob,1,1,$a),v("IMCONJUGATE",Pb,1,1,$a),v("IMCOS",Qb,1,1,$a),v("IMDIV",Rb,2,2,[$a,_a]),v("IMEXP",Sb,1,1,$a),v("IMLN",Tb,1,1,_a),v("IMLOG10",Ub,1,1,_a),v("IMLOG2",Vb,1,1,_a),v("IMREAL",Xb,1,1,$a),v("IMSIN",Yb,1,1,$a),v("IMSQRT",Zb,1,1,$a),v("IMSUB",$b,2,2,[$a,$a]),v("IMPOWER",Wb,2,2,[$a,{Hi:2}]),v("IMPRODUCT",_b,1,255,g,-1,-1),v("IMSUM",ac,1,255,g,-1,-1),v("CONVERT",dc,3,3,[{Hi:1},Wa,Wa]),v("BITAND",sc,0,2),v("BITLSHIFT",vc,0,2),v("BITOR",tc,0,2),v("BITRSHIFT",wc,0,2),v("BITXOR",uc,0,2),v("IMCOSH",yc,1,1),v("IMCOT",zc,1,1),v("IMCSC",Ac,1,1),v("IMCSCH",Bc,1,1),v("IMSEC",Cc,1,1),v("IMSECH",Dc,1,1),v("IMSINH",Ec,1,1),v("IMTAN",Fc,1,1)},"./src/functions-fin.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("CalcEngine"),f=d.Common.j.C4,g=isFinite,h=parseInt,i=d.Common.j,j=i.Ea,k=i.Ca,l=i.Fa,m=d.Common.k.ac,n=e.Convert.Rh,o=e.Convert.vf,p=e.Convert.Nh,q=e.Convert.Ph,r=e.Convert.Pa,s=e.Convert.CalcConvertedError,t=null,u=void 0,v=Math.pow,w=Math.abs,x=Math.ceil,y=Math.log,z=Math.sqrt,A=Math.floor,B=Math.max,C=Math.min,D=e.Errors.DivideByZero,E=e.Errors.Value,F=e.Errors.Number,G=e.Functions.ak,H=e.Functions.MathHelper,I=H.Ak,J=e.Functions.hk,K=e.Functions.lk,L=e.Functions.nk,M=e.Functions.mk,N=e.Functions.pk,O=e.Functions.vk,P=e.Convert.Th;function xa(a){return a.getMonth()}function ya(a){return a.getDate()}function za(a){return a.getFullYear()}function Aa(a,b){var c=za(a),d=new Date(c,b,1),e=L(za(d),xa(d));ya(a)>e&&a.setDate(e),a.setMonth(b)}function Ba(a){return a instanceof Date?d.Common.l.Ra(a):a}function Ca(a,b,c){var d=za(b)-za(a),f=xa(b)-xa(a)+12*d,g=ya(b)-ya(a),h=-1;return 0===c?h=e.Functions.uk(a,b):j(c,[1,2,3])>=0?h=Ba(b)-Ba(a):4===c&&(h=30*f+g),h}function Da(a,b,c,d,e){var f,h=v(1+a,b),i=g(h)?h:F;return 0===a?b:o(i)||(h=(h-1)/a,f=g(h)?h:F,o(f))?F:(h=(-c*i-d)/((1+a*e)*f),g(h)?h:F)}function Ea(a,b,c,d){var e=za(b),f=xa(b),g=ya(b),h=new Date(1,0,1),i=0,j=g===L(e,f),k=12/c,l=e-za(a);h.setFullYear(1),l>0&&(l=(l-1)*c);do h=new Date(e,f,g),l++,Aa(h,f-l*k),j&&(i=L(za(h),xa(h)),h=new Date(za(h),xa(h),i));while(M(a,h)<0);return d&&(h=new Date(e,f,g),l--,Aa(h,f-l*k),j&&(i=L(za(h),xa(h)),h=new Date(za(h),xa(h),i))),h}function Fa(a,b,c,d){return N(Ea(a,b,c,!1),a,d)}function Ga(a,b,c,d){var e;return e=j(d,[0,2,4,5])>=0?360/c:3===d?365/c:N(Ea(a,b,c,!1),Ea(a,b,c,!0),1)}function Ha(a,b,c,d){return N(a,Ea(a,b,c,!0),d)}function Ia(a,b,c){var d=za(b),e=xa(b),f=ya(b),g=new Date(d,e,f),i=e-xa(a)+12*(d-za(a));if(Aa(g,xa(g)-i),f===L(d,e))for(;ya(g)!==L(za(g),xa(g));)g.setDate(ya(g)+1);return ya(a)>=ya(g)&&i--,h(""+(1+i/(12/c)))}function Ja(a,b,c){return b>0?(c.Wk?c.Xk?w(a-c.Yk)<w(c.Zk-c.Yk)&&(c.Zk=a,c.$k=b):b<c.$k&&(c.Zk=a,c.$k=b):(c.Zk=a,c.$k=b,c.Wk=!0),[!1,c]):b<0?(c.Xk?c.Wk?w(a-c.Zk)<w(c.Zk-c.Yk)&&(c.Yk=a,c._k=b):-b<-c._k&&(c.Yk=a,c._k=b):(c.Yk=a,c._k=b,c.Xk=!0),[!1,c]):isNaN(b)?[!1,c]:(c.al=a,[!0,c])}function Ka(a,b,c,d,e){var f,g=Ea(a,c,d,!0),h=Ea(a,c,d,!1);if(M(g,b)>=0)return N(a,b,e)/Ga(h,g,d,e);for(f=N(a,g,e)/Ga(h,g,d,e);;){if(h=new Date(za(g),xa(g),ya(g)),Aa(g,xa(g)+12/d),M(g,b)>=0)return f+=N(h,b,e)/Ga(h,g,d,e);f+=1}}function La(a,b,c,d,e,f,g){var i,j,k,l=Fa(a,b,f,g),m=Ha(a,b,f,g),n=Ga(a,b,f,g),o=h(""+Ia(a,b,f)),p=0,q=100*c/f,r=1+d/f,s=m/n;for(i=0;i<o;i++)p+=q/v(r,s+i);return j=e/v(r,o-1+m/n),k=l/n*q,j+p-k}function Ma(a,b,c,d,e,f,g,i,j){var k,l,m,n,o,p,q=N(i,a,g),r=N(a,j,g),s=N(i,j,g),t=Ga(a,b,f,g),u=h(""+Ia(a,b,f)),w=100*c/f,y=1+d/f;if(r>t)switch(g){case 0:case 4:k=N(j,b,g),u=1+h(""+x(k/t));break;default:for(l=new Date(za(j),xa(j),ya(j)),u=0;u<32767;u++)if(m=new Date(za(l),xa(l),ya(l)),Aa(l,xa(l)+12/f),M(l,b)>=0){u+=h(""+x(N(m,b,g))/Ga(m,l,f,g))+1;break}q=t*Ka(i,a,j,f,g),r=t*Ka(a,j,j,f,g),s=t*Ka(i,j,j,f,g)}return n=e/v(y,u-1+r/t),o=s/t/v(y,r/t),p=v(y,-r/t)*(v(y,-u)-1/y)/(1/y-1),n+w*(o+p-q/t)}function Na(a,b){var c=a.substr(0,3),d={ATS:13.7603,BEF:40.3399,DEM:1.95583,ESP:166.386,EUR:1,FIM:5.94573,FRF:6.55957,GRD:340.75,IEP:.787564,ITL:1936.27,LUX:40.3399,LUF:40.3399,NLG:2.20371,PTE:200.482,SIT:245.18};return d[c]?I(d[c],b):-1}function Oa(a,b,c,d,e){var f,g=v(1+a,b);return 0===a?f=(c+d)/b:(f=d*a/(g-1)+c*a/(1-1/g),e>0&&(f/=1+a)),-f}function Pa(a,b,c,d,e){var f=v(1+a,b),g=e>0?1+a:1;return-(0===a?d+c*b:d*f+c*g*(f-1)/a)}function Qa(a,b,c,d,e,f,g){if(f<e||f>c||0!==g&&1!==g)return F;var h=Oa(b,c,d,0,g),i=0,j,k;for(1===e&&(a&&(i=h),g<=0&&(i+=a?d*b:-d),e++),j=e;j<=f;j++)k=g>0?Pa(b,j-2,h,d,1)-h:Pa(b,j-1,h,d,0),i+=a?h-k*b:k;return a?i:i*b}function Ra(a,b,c,d){var e=v(1+c,d),f=-(a*e*c+b*(e-1));return g(f)?f:F}function Sa(a,b,c,d,e){return j(d,[1,2,4])<0||M(b,c)>=0?F:a(b,c,d,e)}function Ta(a,b,c,d,e,f){function g(a,b,c,d){var e=0,f,g=0,h=100;for(a*=h/r(c),b/=c,b++,f=1;f<d;f++)e+=f*a/v(b,f);for(e+=d*(a+h)/v(b,d),f=1;f<d;f++)g+=a/v(b,f);return g+=(a+h)/v(b,d),e/=g,e/=r(c)}if(j(f,[1,2,4])<0||M(b,c)>0)return F;var h=g(d,e,f,Ia(b,c,f));return a?h/(1+e/f):h}function Ua(a,b,c,d,e,f,g,h,i){var k,l,m,n;if(j(g,[1,2,4])<0||M(b,c)>0||M(d,b)>0)return F;k=new Date(za(d),xa(d),ya(d));do Aa(k,xa(k)+12/g);while(M(k,c)<0);return l=Ka(d,b,k,g,h),m=Ka(d,c,k,g,h),n=Ka(b,c,k,g,h),a?(f*g+100*e*(m-l*(1+i*n/g)))/(i*n+g):(g*(f-i)+100*e*(m-l))/(n*i+100*e*l*n/g)}function Va(a,b,c){var d,e,f,g;return 0===c?D:(d=b<0?x(b):A(b),e=v(10,x(H.Ek(c,10))),f=b-d,g=a?f*e/c:f*c/e,p(d+g))}function Wa(a,b,c,d){var e,f,g=m(b),h=0,i=1+a,j=0;if(i>=.75&&i<=1.25&&g>12&&d&&(j=2.5),c)for(e=0;e<g;e++){if(f=-(e-j)*b[e]*Math.pow(i,-(e-j)-1),isNaN(f))return h;h+=f}else for(e=0;e<g;e++){if(f=b[e]*Math.pow(i,-(e-j)),isNaN(f))return h;h+=f}return h}function Xa(a,b,c,d){var e,f,h=0,i=m(b);for(a<=-1&&(a=-1+1e-10),e=0;e<i;e++){if(f=Ba(d[e])-Ba(d[0]),f<0)return[!1,c];h+=b[e]/H.Ck(a,f/365)}return g(h)?c=isNaN(h)?5e-324:h:h===Number.POSITIVE_INFINITY?c=J:h===Number.NEGATIVE_INFINITY&&(c=-J),[!0,c]}function Ya(a,b,c,d){var e,f,g;return a>-1&&0!==a?(e=c,f=v(1+a,e.bl-(d?1:0)),g=(v(1+a,e.bl)-1)/a,b=d?-e.cl*g/a+f*e.bl*(e.dl+e.cl*(e.Nc+1/a)):e.dl*f+e.cl*(1+a*e.Nc)*g+e.el,[!0,b,c]):[!1,b,c]}function Za(a,b,c,d,e,f,g,h,i,j,l,m,n,o,p){var q,r,s,t,u=0,v=0,w=c-e,x=c+e,y=2===a;if(w<f.fl&&(w=c),x>f.gl&&(x=c),w===x)return y?[!1,d,f,g]:[!1,d,f];if(0===a?(q=b(g,h,i,w,l,m,n,o,p)-j,r=b(g,h,i,x,l,m,n,o,p)-j):1===a?(q=b(w,g,u,h),r=b(x,g,v,h)):(q=Ya(w,u,g),r=Ya(x,v,g)),k(q)){if(t=q[2],u=q[1],s=q[0],!s)return y?[s,d,f,t]:[s,d,f]}else u=q;if(k(r)){if(t=r[2],v=r[1],s=r[0],!s)return y?[s,d,f,t]:[s,d,f]}else v=r;return d=(v-u)/(x-w),y?[!0,d,f,t]:[!0,d,f]}function $a(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o;return d<c.fl||d>c.gl?[!1,c]:(n=a?Wa(d,e):b(e,f,g,d,i,j,k,l,m)-h,o=Ja(d,n,c),c=o[1],[!!o[0],c])}function _a(a,b,c,d,e){if(b>a.gl)return[!1,a,c];var f=Xa(b,d,c,e);return c=f[1],f[0]?(f=Ja(b,c,a),a=f[1],[!!f[0],a,c]):[f[0],a,c]}function ab(a,b,c){var d,e,f=0;return b<a.fl||b>a.gl?[!1,a,c]:(d=Ya(b,f,c),c=d[2],f=d[1],d[0]?(e=Ja(b,f,a),a=e[1],[!!e[0],a,c]):[d[0],a,c])}function bb(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,q=0,r=a?15:2;if(!c.Wk||!c.Xk)return a?[!1,c,d]:[!1,c];for(l=w(c.Zk-c.Yk)/(w(c.Zk)+w(c.Yk)),k=0;k<100+4*r;k++)if(m=0,n=0,o=void 0,o=k%4===0?1:k%4===2?2:3,p=void 0,p=a?ib(c,d,l,q,n,o):b?jb(!0,c,q,m,n,o,Xa,l,e,d,Za):jb(!1,c,q,m,n,o,La,l,f,g,h,d,e,i,j),c=p[1],a&&(d=p[2]),q=a?p[3]:p[2],p[0])return a?[!0,c,d]:[!0,c];return a?[!1,c,d]:[!1,c]}function cb(a,b,c,d,e,f,g,h,i,j,k){var m,n,o,p,q,r,s,v=0,x=a?15:2;if(!b.Wk||!b.Xk)return[!1,b];for(n=w(b.Zk-b.Yk)/(w(b.Zk)+w(b.Yk)),m=0;m<100+4*x;m++)if(o=0,p=0,q=void 0,q=m%4===0?1:m%4===2?2:3,r=a?jb(!0,b,v,o,p,q,Wa,n,u,c,Za):jb(!1,b,v,o,p,q,Ma,n,g,h,i,c,d,j,k,e,f),b=r[1],v=r[2],o=r[3],!(a&&r[0]===t||!a&&l(r[0]))){if(r[0])return[!0,b];if(p=a?Wa(o,c):Ma(c,d,g,o,i,j,k,e,f)-h,s=Ja(o,p,b),b=s[1],s[0])return[!0,b];if(n=w(b.Zk-b.Yk)/(w(b.Zk)+w(b.Yk)),n<b.hl)return b._k<p&&(p=b._k,o=b.Yk),b.$k<p&&(o=b.Zk),b.al=o,[!0,b]}return[!1,b]}function db(a,b,c,d,e,f,g,h,i,j,l,m,n){var o,p,q,r,s,t,u,v,x,y,z,A,B,C,D,E,F,G,H=c.hl/2,I=!1;for(p=0;p<20;p++){if(d<c.fl||d>c.gl){if(!a||c.Xk&&c.Wk||!(d<=-1))return[!1,c];d=-1,I=!0}if(s=a?Xa(d,e,0,f):b(e,f,g,d,i,j,l,m,n)-h,k(s)){if(r=s[1],q=s[0],!q)return[q,c]}else r=s;if(t=Ja(d,r,c),c=t[1],t[0])return[!0,c];if(I)return[!1,c];if(u=c.Xk&&c.Wk?w(c.Zk-c.Yk):c.gl-c.fl,v=(w(d)<1e-10?u:w(d))/1e6,x=0,t=a?Za(1,Xa,d,x,v,c,e,f):Za(0,b,d,x,v,c,e,f,g,h,i,j,l,m,n),c=t[2],x=t[1]<0?t[1]:-t[1],q=t[0],!q)return[q,c];if(0===x)return[!1,c];if(y=d-1.000001*r/x,y===d)return c.al=d,[!0,c];if(a&&c.Xk&&c.Wk&&(z=[c.Zk,c.Yk],A=z[0],B=z[1],y<A==y<B&&(C=!0,A>B&&(o=[B,A],A=o[0],B=o[1],C=!1),D=[c.$k,c._k],E=D[0],F=D[1],y=A+w((C?E:F)/(F-E))*(B-A))),G=w(y-d)/(w(d)+w(y)),d=y,G<H)return c.al=d,[!0,c]}return[!1,c]}function eb(a,b,c){for(var d,e,g,h,i,j,k,l=a.hl/2,m=0;0===b[m];)m++;for(d=b.slice(m),g=[!1,null],h=[c],.1!==c&&h.push(.1),h.push(-.1,.99*a.gl,a.fl+.01),i=0;!g[0]&&i<h.length;i++)g=gb(f(a),d,h[i],l),fb(g,d);if(!g[0]){for(j=0,i=1,k=d.length;i<k;i++)j+=d[i];e=-j/d[0]-1,g=gb(f(a),d,e,l)}return g}function fb(a,b){var c,e,f,g;a[0]&&(c=a[1].al,e=15,"number"==typeof c&&c>-10&&c<10&&(f=""+c,(f.indexOf("000000000000")>1||f.indexOf("999999999999")>1)&&(e=14)),c=d.Common.o.Lma(c,e),g=mb(c,b),(g>.001||g<-.001)&&(a[0]=!1))}function gb(a,b,c,d){var e,f,g,h,i,j;for(e=0;e<32;e++){if(c<a.fl||c>a.gl)return[!1,a];if(f=Wa(c,b,!1,!0),g=Ja(c,f,a),a=g[1],g[0])return[!0,a];if(h=Wa(c,b,!0,!0),0===h)return[!1,a];if(i=c-1.0000001*f/h,i===c)return a.al=c,[!0,a];if(j=w(i-c)/(w(c)+w(i)),c=i,j<d)return a.al=c,[!0,a]}return[!1,a]}function hb(a,b,c){var d,e,f,g,h,i,j,k,l=a.hl/2;for(d=0;d<100;d++){if(e=void 0,f=void 0,g=void 0,h=0,i=0,c<a.fl||c>a.gl)return[!1,a,b];if(j=Ya(c,h,b),b=j[2],h=j[1],g=j[0],!g)return[g,a,b];if(k=Ja(c,h,a),a=k[1],k[0])return[!0,a,b];if(j=Ya(c,i,b,!0),b=j[2],i=j[1],g=j[0],!g)return[g,a,b];if(0===i)return[!1,a,b];if(e=c-1.000001*h/i,e===c)return a.al=c,[!0,a,b];if(f=w(e-c)/(w(c)+w(e)),c=e,f<l)return a.al=c,[!0,a,b]}return[!1,a,b]}function ib(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p;if(1===f){if(i=void 0,g=(a.Zk+a.Yk)/2,j=Ya(g,e,b),b=j[2],e=j[1],h=j[0],!h)return[t,a,b,d];if(0===e)return a=Ja(g,e,a)[1],[!0,a,b,d];if(i=z(e*e-a.$k*a._k),0===i)return[t,a,b,d]}else if(2===f){if(k=void 0,l=void 0,m=0,n=0,c>.1)return f=3,ib(a,b,c,d,e,f);if(o=d%4,d++,0===o)k=a.Zk,m=a.$k;else if(2===o)k=a.Yk,m=a._k;else if(k=(a.Zk+a.Yk)/2,j=Ya(k,m,b),b=j[2],m=j[1],h=j[0],!h)return[t,a,b,d];if(l=w(a.Zk-a.Yk)/1e6,p=Za(2,void 0,k,n,l,a,b),b=p[3],a=p[2],n=p[1],h=p[0],!h||0===n)return[t,a,b,d];if(g=k-1.01*m/n,g<a.Zk&&g<a.Yk||g>a.Zk&&g>a.Yk)return[t,a,b,d]}return[!1,a,b,d]}function jb(a,b,c,d,e,f,g,h,i,j,l,m,n,o,p,q,r){var s,u,v,x,y,A,B,C,D;switch(f){case 0:d=b.Zk-b.$k*((b.Yk-b.Zk)/(b._k-b.$k));break;case 1:if(d=(b.Zk+b.Yk)/2,s=a?g(d,j,e,i):g(m,n,i,d,l,o,p,q,r)-j,k(s)){if(e=s[1],!s[0])return[t,b,c,d,e,f]}else e=s;if(0===e)return b=Ja(d,e,b)[1],[!0,b,c,d,e,f];if(u=z(e*e-b.$k*b._k),0===u)return[t,b,c,d,e,f];d+=(d-b.Zk)*e/u;break;case 3:d=(b.Zk+b.Yk)/2;break;case 2:if(v=void 0,x=0,y=void 0,A=0,h>.1)return f=3,jb(a,b,c,d,e,f,g,h,i,j,l,m,n,o,p);if(B=c%4,c++,0===B)v=b.Zk,x=b.$k;else if(2===B)v=b.Yk,x=b._k;else if(v=(b.Zk+b.Yk)/2,s=a?g(v,j,x,i):g(m,n,i,v,l,o,p,q,r)-j,k(s)){if(x=s[1],!s[0])return[t,b,c,d,e,f]}else x=s;if(y=w(b.Zk-b.Yk)/1e6,C=a?l(1,g,v,A,y,b,j,i):Za(0,g,v,A,y,b,m,n,i,j,l,o,p,q,r),b=C[2],A=C[1],!C[0]||0===A)return[t,b,c,d,e,f];if(d=v-1.01*x/A,d<b.Zk&&d<b.Yk||d>b.Zk&&d>b.Yk)return[t,b,c,d,e,f]}return s=a?g(d,j,e,i):g(m,n,i,d,l,o,p,q,r)-j,k(s)&&(e=s[1],!s[0])?[t,b,c,d,e,f]:(D=Ja(d,e,b),D[0]?[!0,b,c,d,e,f]:(h=w(b.Zk-b.Yk)/(w(b.Zk)+w(b.Yk)),h<b.hl?(b._k<e&&(e=b._k,d=b.Yk),b.$k<e&&(e=b.$k,d=b.Zk),b.al=d,[!0,b,c,d,e,f]):[!1,b,c,d,e,f]))}function kb(a,b,c,d,e){e=e?1:0;var f=v(1+a,b);return f=0===a?c*b+d:d*f+c*(1+a*e)*(f-1)/a,p(-f)}function lb(a,b){for(var c=0;c<m(b);c++)b[c]!==s&&(a*=1+b[c]);return a}function mb(a,b){var c,d,e,f=arguments,g=0,h=1;for(d=1;d<m(f);d++){if(e=q(f[d],1,!0,!0,!1,!0),e.isError)return e[0];for(c=0;c<m(e);c++)e[c]!==s&&(g+=e[c]/v(1+a,h),h++)}return g}function nb(a,b,c,d,e){if(e=e?1:0,0===a)return p(-(c*b+d));var f=v(1+a,b);return a===-1?D:p(-(d+c*(1+a*e)*(f-1)/a)/f)}function ob(a,b,c,d,e){var f,g,h;return M(a,b)>=0?F:(f=Ca(a,b,e),g=K(a,e),f<=0||g<=0?F:(h=1-d*f/g,h<=0?F:c/h))}function pb(a,b,c){var d=m(b),e=m(c),f=0,g;if(d!==e)return F;if(b.some(function(a){return a===s}))return E;for(g=0;g<d;g++)f+=b[g]/v(1+a,(c[g]-c[0])/365);return f}function qb(a,b,c,d,e,f){return Qa(!1,a,b,c,d,e,f)}function rb(a,b,c,d,e,f){return Qa(!0,a,b,c,d,e,f)}function sb(a,b,c,d,e,f){if(b>=c+1||0!==f&&1!==f)return F;var g=Da(a,c,d,e,f);return Ra(d,g,a,b-1)}function tb(a,b,c,d){return p(d*a*(b/c-1))}function ub(a,b,c,d,e){e=e?1:0;var f=v(1+a,b);return f=0===a?(c+d)/b:(c*f+d)/((1+a*e)*(f-1)/a),p(-f)}function vb(a,b,c,d,e,f){var g,h;return f=f?1:0,b>=c+1?F:(g=Da(a,c,d,e,f),o(g)||(h=Ra(d,g,a,b-1),o(h))?F:g-h)}function wb(a,b,c,d){return Sa(Fa,a,b,c,d)}function xb(a,b,c,d){return Sa(Ga,a,b,c,d)}function yb(a,b,c,d){return Sa(Ha,a,b,c,d)}function zb(a,b,c){return Ba(Ea(a,b,c,!0))}function Ab(a,b,c){return Sa(zb,a,b,c)}function Bb(a,b,c){return Sa(Ia,a,b,c)}function Cb(a,b,c){return Ba(Ea(a,b,c,!1))}function Db(a,b,c){return Sa(Cb,a,b,c)}function Eb(a){var b=L(a.getFullYear(),a.getMonth());return b===a.getDate()}function Fb(a,b,c,d,e,f){var g,h,i,k,l,m,n,o,p,q,r,s;if(j(e,[1,2,4])<0||M(a,b)>0)return F;for(g=Ia(a,b,e),h=Ga(a,b,e,f),i=Ea(a,b,e,!1),k=N(i,a,f),0===f&&31===a.getDate()&&1===i.getMonth()&&Eb(i)&&k++,l=h-k,m=l/h,n=v(1+d/e,g-1+m),o=100/n,p=o*(g-1+m),q=0;q<g;q++)r=q+m,s=100*c/(e*v(1+d/e,r)),o+=s,p+=s*r;return p/o/e}function Gb(a,b,c,d,e){return d<0||c<0?F:Ta(!0,a,b,c,d,e)}function Hb(a,b,c,d,e){return e=e?1:0,0===a?0===b?D:p(-(c+d)/b):p(y((b*(1+a*e)-d*a)/(c*a+b*(1+a*e)))/y(1+a))}function Ib(a,b,c,d,e,f,g){var h,i,k,l,m,n,o,p,q,r,s;if(j(f,[1,2,4])<0||M(a,b)>0)return F;if(h=Ia(a,b,f),h<=1)return i=Fa(a,b,f,g),k=Ha(a,b,f,g),l=Ga(a,b,f,g),m=f*l/k,n=e/100+c/f-(d/100+i/l*c/f),o=d/100+i/l*c/f,n/o*m;if(q=.1,r={fl:0,gl:1e3,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},s=db(!1,La,r,q,a,b,c,d,e,f,g),r=s[1],p=s[0],!p){for(q=1e-10;q<r.gl;q*=2)r=$a(!1,La,r,q,a,b,c,d,e,f,g)[1];s=bb(!1,!1,r,a,b,c,d,e,f,g),r=s[1],p=s[0]}return p?r.al:F}function Jb(a,b,c,d,e){return M(a,b)>=0?F:(d/c-1)/O(a,b,e)}function Kb(a,b,c,d,e,f){var g,h,i,j;return M(a,b)>=0?F:(g=O(c,b,f),h=O(c,a,f),i=O(a,b,f),j=1+g*d,j/=e/100+h*d,j--,j/=i)}function Lb(a,b,c,d,e,f,g){function h(a,b,c,d,e,f,g){var h,i,j,k,l,m,n=1/f;if(i=n<3?1:n<5?1.5:n<=6?2:2.5,f*=i,l=O(b,c,g),o(l))return 0;for(j=A(l*f*a+.5),a-=j,k=a-d,h=0;h<e;h++){if(j=A(f*a+.5),k-=j,k<0)return m=e-h,0===m||1===m?A(.5*a+.5):0;a-=j}return j}var i=1/f;return i>0&&i<1||i>1&&i<2||i>2&&i<3||i>4&&i<5||M(b,c)>0?F:h(a,b,c,d,e,f,g)}function Mb(a,b,c,d,e,f,g){function h(a,b,c,d,e,f,g){var h,i,j,k,l=a*f,m=a-d,p=O(b,c,g);return o(p)?0:(h=p*f*a,i=(a-d-h)/l,j=n((a-d-h)/l),k=0===e?h:e<=j?l*(i<1?i:1):e===j+1?m-l*j-h:0)}return M(b,c)>0?F:h(a,b,c,d,e,f,g)}function Nb(a,b,c,d,e,f,g,h,i){var k,l,m,n=.1;if(j(h,[1,2,4])<0||M(c,a)>0||M(a,d)>0||M(d,b)>0)return F;if(k={fl:0,gl:1e3,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},l=db(!1,Ma,k,n,a,b,e,f,g,h,i,c,d),k=l[1],m=l[0]){for(n=1e-10;n<k.gl;n*=2)k=$a(!1,Ma,k,n,a,b,e,f,g,h,i,c,d)[1];l=cb(!1,k,a,b,c,d,e,f,g,h,i),k=l[1],m=l[0]}return m?k.al:F}function Ob(a,b,c,d,e,f,g,h){return Ua(!1,a,b,c,d,f,g,h,e)}function Pb(a,b,c,d,e,f,g,h){return Ua(!0,a,b,c,d,f,g,h,e)}function Qb(a,b,c){var d,e,f=Ba(b)-Ba(a);return M(a,b)>=0||f>365?F:(d=365*c,e=360-c*f,0===e?D:e<0?F:p(d/e))}function Rb(a,b,c){var d=Ba(b)-Ba(a);return M(a,b)>=0||d>365?F:(100-c)/c*(360/d)}function Sb(a,b){var c,d,e,f,g,h=m(a),i=[],j=!1,k=!1,l={fl:-1,gl:9999999,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0};for(w(b)>1&&(b=.1),c=-1,d=0,e=0;e<h;e++)f=a[e],f!==s&&(0!==f&&(d=i.length+1,c===-1&&(c=i.length)),i.push(f),f>0&&(j=!0),f<0&&(k=!0));return i=i.slice(c,d+1),!j||!k||m(i)<2?F:(g=eb(l,i,b),l=g[1],g[0]?l.al:F)}function Tb(a,b,c){var d,e,f,g,h=0,i=0,j=0,k=0,l=0,n=[],o=m(a);if(o<2)return D;for(d=0;d<o;d++)e=a[d],e!==s&&(n.push(e),j++,0!==e&&(e>0?h++:i++));if(i<1||h<1)return D;for(f=0;f<j;f++)g=n[f],0!==g&&(g>0?k+=g/v(1+c,f):l+=g/v(1+b,f));return 0===l||0===k||c<=-1?D:v(-k*v(1+c,j)/(l*(1+c)),1/(j-1))-1}function Ub(a,b,c,d){for(var e=.5,f=c-e,g=c+e,h=0,i=0;Xa(f,a,i,b)[1]*Xa(g,a,i,b)[1]>0&&h<d;)h++,f-=e,g+=e;return h>=d?[0,0]:[f,g]}function Vb(a,b,c,d){var e,f,g=100,h=d.hl,i=d.Xk&&d.Wk?[d.Zk,d.Yk]:Ub(a,b,c,g),j=i[0],k=i[1],l=Xa(j,a,0,b)[1],m=Xa(k,a,0,b)[1],n=0;for(e=0;e<g&&!(l*m>0);e++)if(n=(j+k)/2,f=Xa(n,a,0,b)[1],f*l<0?(k=n,m=f):(j=n,l=f),w(j-k)<h)return[!0,n];return[!1,n]}Q=2.98023e-9,R=4.88281e-9;function Wb(a,b,c){var d,e,f,g,h,i,j,k,l=m(a),n=m(b);if(l!==n)return F;for(f=l-1;f>=0;f--)d=a[f]>0||d,e=a[f]<0||e,b[f]===s&&(0!==a[f]?b[f]=0:(a.splice(f,1),b.splice(f,1)));return d&&e?(g=a[0],0===g?0===c?R:Q:(h={fl:-1,gl:1e10,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},i=db(!0,Za,h,c,a,b),h=i[1],i[0]?(j=h.al,Math.abs(j)<h.hl?Q:j):(k=Vb(a,b,c,h),k[0]?k[1]:F))):F}function Xb(a,b,c,d,e,f){var g,h,i,j,k,l;if(e=e?1:0,g=v(1.7976931348623157e298,1/a),h={hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0,fl:B(-1e10,-g+1),gl:C(1e10,g-1)},i={bl:a,cl:b,dl:c,el:d,Nc:e},j=hb(h,i,f),i=j[2],h=j[1],k=j[0],!k){for(l=2;(!h.Xk||!h.Wk)&&l<100;l*=2)j=ab(h,f*l,i),i=j[2],h=j[1],j=ab(h,f/l,i),i=j[2],h=j[1];j=bb(!0,!1,h,i),h=j[1],k=j[0]}return k?h.al:F}function Yb(a,b,c,d,e){var f,g,h,i=e/c;return i>=1?(i=1,g=1===d?a:0):g=a*v(1-i,d-1),h=a*v(1-i,d),f=g-(h<b?b:h),f<0?0:f}function Zb(a,b,c,d,e,f){var g,h,i,j=0,k=0,l=x(e),m=l,n=a-b,o=!1;for(i=1;i<=m;i++)o?h=k:(g=Yb(a,b,c,i,f),k=n/(d-(i-1)),k>g?(h=k,o=!0):(h=g,n-=g)),i===m&&(h*=e+1-l),j+=h;return j}function $b(a,b,c,d,e,f,g){var h,i,j,k,l=A(d),m=l,n=x(e),o=n,p=0;if(g)for(h=m+1;h<=o;h++)i=Yb(a,b,c,h,f),h===m+1?i*=C(e,l+1)-d:h===o&&(i*=e+1-n),p+=i;else j=c,k=void 0,d!==A(d)&&f>1&&d>=c/2&&(k=d-c/2,d=c/2,e-=k,j+=1),a-=Zb(a,b,c,j,d,f),p=Zb(a,b,c,c-d,e-d,f);return p}function _b(a,b,c,d,e,f,g){return e<d?F:a<b&&0===d&&1===e?a-b:$b(a,b,c,d,e,f,g)}function ac(a,b,c,d,e,f,g){var h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;if(j(f,[1,2,4])<0||M(a,c)>=0)return F;if(1===f||0===g||4===g)return bc(a,b,c,d,e,f,g);for(h=a.getFullYear(),i=a.getMonth(),k=a.getDate(),l=c.getFullYear(),m=c.getMonth(),n=c.getDate(),o=b.getMonth(),p=b.getDate(),q=[],r=[],s=[],t=[31,28,31,30,31,30,31,31,30,31,30,31],u=0;u<f;u++)q[u]=(o+12*u/f)%12,r[u]=p<=t[q[u]]?p:t[q[u]],2===g?s[u]=360/f:3===g&&(s[u]=365/f);for(u=0;u<f;u++)v=u===f-1?0:u+1,w=q[v]>q[u]?2001:2002,s[u]=Ba(new Date(w,q[v],r[v]))-Ba(new Date(2001,q[u],r[u]));for(x=0,y=Ba(c);h<l||h===l&&i<m||h===l&&i===m&&k<n;){for(u=0;u<f&&(i<q[u]||i===q[u]&&k<r[u])&&(0===u||q[u]>q[u-1]);)u++;for(;u<f&&(i>q[u]||i===q[u]&&k>=r[u])&&(u++,i!==q[u-1]||k!==r[u-1]););u--,v=u===f-1?0:u+1,w=i+12/f>=12?h+1:h,z=Ba(new Date(h,i,k)),A=Math.min(Ba(new Date(w,q[v],r[v])),y),x+=e*d/f*(A-z)/s[u],h=w,i=q[v],k=r[v]}return x}function bc(a,b,c,d,e,f,g){var h=Ca(a,c,g),i=K(a,g);return h<0||i<=0?F:e*d*(h/i)}function cc(a,b,c,d,e){if(M(a,b)>0)return F;var f=Ca(a,b,e),g=K(a,e);return f<0||g<=0?F:d*c*f/g}function dc(a,b,c,d,e){if(M(a,b)>=0)return F;var f=K(a,e),g=Ca(a,b,e);return g<=0||f<=0?F:(d-c)/d*(f/g)}function ec(a,b){return v(1+a/b,b)-1}function fc(a,b,c,d,e){if(M(a,b)>=0)return F;var f=Ca(a,b,e),g=K(a,e);return f<=0||g<=0?F:(d-c)/c*(g/f)}function gc(a,b){return b*(v(1+a,1/b)-1)}function hc(a,b,c,d,e){var f,g,h,i,j=c+(e<12?1:0);if(j<d)return F;if(0===a)return 0;for(f=I(1-v(b/a,1/c),3),g=0,h=0,i=1;i<=d;i++)h=1===i?a*f*e/12:i===c+1?(a-g)*f*(12-e)/12:(a-g)*f,g+=h;return h}function ic(a,b,c,d,e){var f,g=0,h=0;if(c<d)return F;if(a<=b)return 0;for(f=1;f<=d;f++)h=(a-g)*(e/c),h=C(h,a-g-b),g+=h;return h}function jc(a,b,c){return(a-b)/c}function kc(a,b,c,d){return d>c?F:(a-b)*(c-d+1)*2/(c*(c+1))}function lc(a,b){return b<1?D:Va(!0,a,b)}function mc(a,b){return 0===b?D:Va(!1,a,b)}function nc(a,b,c,d,e,f,g){return j(f,[1,2,4])<0||M(a,b)>0?F:La(a,b,c,d,e,f,g)}function oc(a,b,c,d,e){if(M(a,b)>=0)return F;var f=Ca(a,b,e),g=K(a,e);return f<=0||g<=0?F:d-c*d*f/g}function pc(a,b,c,d,e,f){var g,h,i,j,k;return M(a,b)>=0?F:(g=Ca(a,b,f),h=Ca(c,b,f),i=Ca(c,a,f),j=K(a,f),i<=0||j<=0||g<=0||h<=0?F:(k=1+g/j*e,0===k?F:(100+h/j*d*100)/k-i/j*d*100))}function qc(a,b,c,d,e,f,g,h,i){return j(h,[1,2,4])<0||M(c,a)>0||M(a,d)>0||M(d,b)>0?F:Ma(a,b,e,f,g,h,i,c,d)}function rc(a,b,c){var d=Ba(b)-Ba(a);return M(a,b)>=0||d>365?F:100*(1-c*d/360)}function sc(a){var b=Na(a,2);return b>=0?b:F}function tc(a,b,c,d,e){var f,g,h,i;function k(a){var b=a.substr(0,3),c=["BEF","LUF","ESP","ITL","PTE","GRD","LUX"];return j(b,c)>=0?0:2}function l(a){var b=a.substr(0,3),c=["BEF","LUF","ESP","ITL","LUX"];return j(b,c)>=0?0:2}return f=0,d||(f=l(c)),e.$i||(e.Qb=k(b)),h=Na(b,e.Qb),i=Na(c,e.Qb),h>=0&&i>=0?(g=a*i/h,d||(g=I(g,f)),g):E}function uc(a,b,c,d){var e,f,g;return""===a&&""===b&&""===c?E:(e={value:0},a=P(a,e),f={value:0},b=P(b,f),g={value:0},c=P(c,g),a===!0&&b===!0&&c===!0?d(e,f,g):E)}function vc(a,b,c){return uc(a,b,c,function(a,b,c){var d,e;return b.value>0&&a.value>0&&c.value>0?(d=(Math.log(c.value)-Math.log(b.value))/Math.log(1+a.value),e=Math.abs(d),e<=1.79769e308?e>=2.2250738585072014e-308?d:0:D):F})}function wc(a,b,c){return uc(a,b,c,function(b,c,d){if(c.value>0&&b.value>0&&d.value>=0){a=Math.pow(d.value/c.value,1/b.value)-1;var e=Math.abs(a);if(e<=1.79769e308)return e>=2.2250738585072014e-308?a:0}return F})}S={Hi:0},T={_i:0,Hi:0},U={Hi:0,aj:"<= 0"},V={Hi:0,aj:"< 1"},W={Hi:0,aj:"< 0"},X={_i:.1,Hi:0},Y={_i:2,Hi:0},Z={_i:1e3,Hi:0,aj:"<= 0"},$={Hi:6},_={Hi:5},aa={_i:!1,Hi:7},ba={Hi:2},ca={Hi:2,aj:"<= 0"},da={Hi:2,aj:"< 1"},ea={_i:0,Hi:2},fa={_i:0,Hi:2,aj:["< 0","> 4"]},ga={_i:0,Hi:2,aj:["< 0","> 4","= 2"]},ha={Hi:2,aj:"= 0",bj:D},ia={Hi:2,aj:"< 0"},ja={Hi:4,Ii:1,Ji:!0,Ki:!0},ka={Hi:4,Ii:1,Ji:!0,Mi:!0,Ki:!0},la={Hi:4,Ii:4,Ji:!0,Ki:!0,Mi:!0,breakOnConvertError:!0},ma={Hi:4,Ii:1,Ji:!0,Ki:!0,breakOnConvertError:!0},na={Hi:4,Ii:11,Ji:!0,Ki:!0,breakOnConvertError:!0},oa=[$,$,ba,fa],pa=[$,$,S,S,ba,fa],qa=[$,$,U],ra=[S,$,$,S,ba,U,ga],sa=[S,S,S,T,T],ta=[$,$,U,U,fa],ua=[U,ca,U,da,ba,ba],va=[U,da],wa=[S,ia],G("FV",kb,3,5,sa,u,u,{bk:[3,4]}),G("FVSCHEDULE",lb,2,2,[S,ja],1,1),G("NPV",mb,2,u,S,"> 0","> 0"),G("PV",nb,3,5,sa,u,u,{bk:[3,4]}),G("RECEIVED",ob,4,5,ta,u,u,{bk:3}),G("XNPV",pb,3,3,[S,ma,ma],"!= 0","!= 0"),G("CUMIPMT",qb,6,6,ua),G("CUMPRINC",rb,6,6,ua),G("IPMT",sb,4,6,[S,V,V,S,T,ea],u,u,{bk:[4,5]}),G("ISPMT",tb,4,4,[S,ba,ha,S]),G("PMT",ub,3,5,[S,{Hi:0,aj:"= 0",bj:D},S,T,T],u,u,{bk:[3,4]}),G("PPMT",vb,4,6,[S,V,S,S,T,T],u,u,{bk:[4,5]}),G("COUPDAYBS",wb,3,4,oa,u,u,{bk:3}),G("COUPDAYS",xb,3,4,oa,u,u,{bk:3}),G("COUPDAYSNC",yb,3,4,oa,u,u,{bk:3}),G("COUPNCD",Ab,3,4,oa,u,u,{bk:3}),G("COUPNUM",Bb,3,4,oa,u,u,{bk:3}),G("COUPPCD",Db,3,4,oa,u,u,{bk:3}),G("DURATION",Fb,5,6,pa,u,u,{bk:5}),G("MDURATION",Gb,5,6,pa,u,u,{bk:5}),G("NPER",Hb,3,5,[{Hi:0,aj:"<= -1"},S,S,T,T],u,u,{bk:[3,4]}),G("YIELD",Ib,6,7,[$,$,W,U,U,ba,fa],u,u,{bk:6}),G("YIELDDISC",Jb,4,5,[$,$,U,U,fa],u,u,{bk:3}),G("YIELDMAT",Kb,5,6,[$,$,$,W,U,fa],u,u,{bk:5}),G("AMORDEGRC",Lb,6,7,ra,u,u,{bk:6}),G("AMORLINC",Mb,6,7,ra,u,u,{bk:6}),G("ODDFYIELD",Nb,8,9,[$,$,$,$,W,U,U,ba,fa],u,u,{bk:8}),G("ODDLYIELD",Ob,7,8,[$,$,$,W,U,U,S,fa],u,u,{bk:7}),G("ODDLPRICE",Pb,7,8,[$,$,$,W,W,U,ba,fa],u,u,{bk:7}),G("TBILLEQ",Qb,3,3,qa),G("TBILLYIELD",Rb,3,3,qa),G("IRR",Sb,1,2,[ka,X],0,0,{bk:1}),G("MIRR",Tb,3,3,[ka,S,S],0,0),G("XIRR",Wb,2,3,[na,la,X],"!= 2","!= 2",{bk:2}),G("RATE",Xb,3,6,[U,S,S,T,{_i:0,Hi:2,aj:"< 0",bj:E},X],u,u,{bk:[3,4,5]}),G("VDB",_b,5,7,[W,W,ia,W,W,Y,aa],u,u,{bk:[5,6]}),G("ACCRINT",ac,6,8,[$,$,$,U,Z,ba,fa],u,u,{bk:[4,6,7]}),G("ACCRINTM",cc,3,5,[$,$,U,Z,fa],u,u,{bk:[3,4]}),G("DISC",dc,4,5,[$,$,U,U,fa],u,u,{bk:3}),G("EFFECT",ec,2,2,va),G("INTRATE",fc,4,5,ta,u,u,{bk:3}),G("NOMINAL",gc,2,2,va),G("DB",hc,4,5,[W,S,da,da,{_i:12,Hi:2,aj:["< 1","> 12"]}],u,u,{bk:3}),G("DDB",ic,4,5,[W,S,ca,ca,{_i:2,Hi:0,aj:"<= 0"}],u,u,{bk:3}),G("SLN",jc,3,3,[S,S,ha]),G("SYD",kc,4,4,[S,W,da,ca]),G("DOLLARDE",lc,2,2,wa),G("DOLLARFR",mc,2,2,wa),G("PRICE",nc,6,7,[$,$,W,W,U,ba,fa],u,u,{bk:6}),G("PRICEDISC",oc,4,5,ta,u,u,{bk:3}),G("PRICEMAT",pc,5,6,[$,$,$,W,W,fa],u,u,{bk:5}),G("ODDFPRICE",qc,8,9,[$,$,$,$,W,W,U,ba,fa],u,u,{bk:8}),G("TBILLPRICE",rc,3,3,[$,$,U]),G("EURO",sc,1,1,_),G("EUROCONVERT",tc,3,5,[S,_,_,aa,{Zi:!0,Hi:2,_i:3,aj:"< 3",bj:E}],u,u,{bk:[3,4]}),G("PDURATION",vc,3,3),G("RRI",wc,3,3)},"./src/functions-lookup.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("CalcEngine"),f=null,g=void 0,h=d.Common.q,i=d.Common.j,j=d.Common.l,k=d.Common.o.Lma,l=j.lb,m=i.Fa,n=i.G,o=d.Common.k.ac,p=j.Ska,q=j.Ra,r=e.Convert.vf,s=e.Convert.Rh,t=e.Convert.Sh,u=e.Convert.Na,v=e.Convert.Pa,w=e.Convert.Fh,x=e.Convert.Ca,y=e.Convert.bc,z=e.Errors.Value,A=e.Errors.Reference,B=e.Errors.Number,C=e.Errors.NotAvailable,D=e.Errors.Null,E=e.Errors.Calc,F=e.Functions.ak,G=e.Functions.ik,H=e.Functions.jk,I=1048576,J=16384;function da(a,b,c){return a&&1===b&&1===c&&null===a[0][0]}function ea(a){return w(a)||x(a)||Array.isArray(a)}function fa(a,b,c,d){return{row:a,col:b,rowCount:c,colCount:d}}function ga(a,b,c){var d,e;return m(a)?f:a.isArray||a.isReference?(d=a.colCount,b>d&&(e=b,b=c,c=e),a[c*d+b]):a[0]}function ha(a,b,c,d){return!(!c||null!==a&&null!==b)||!m(b)&&(!!((m(a)||u(a,!0))&&u(b,!0)||G(a)&&G(b)||d&&(H(a)&&u(b)||H(b)&&u(a)))||!(!H(a)||!H(b)))}function ia(a,b,c,d,e){if(a<0||b<0||b<a||c<a||c>b)return-1;if(e)return K=a,L=b,M=c,N=c,O=d,P=d,M;if(O){if(M++,M>L){if(O!==P)return-1;M=N-1,O=!1}}else if(M--,M<K){if(O!==P)return-1;M=N+1,O=!0}return M}function ja(a,b,c){var d=l(a),e=c;return d===b?e=0:d>b?e=1:d<b&&(e=2),e}function ka(a,b,c){var d,f,g;return a===b?0:H(a)?b||0!==o(a)?u(b)&&!u(a)?1:G(b)?2:H(b)?(d=e.Zhc(a,b,c),d<0?d=2:d>0&&(d=1),d):b instanceof Date?ja(a,b,1):-1:0:H(b)?a||0!==o(b)?u(a)?2:G(a)?1:a instanceof Date?ja(a,b,2):-1:0:G(a)&&u(b)?1:G(b)&&u(a)?2:(f=v(a),g=v(b),f=k(f,15),g=k(g,15),f===g?0:f<g?2:1)}function la(a,b,c){var d=ga(a,b,c);return m(d)?0:d}function ma(a,b,c,d){var e,g,h,i,j=-1,k=0,l=-1,m=-1,n=d?b.rowCount:b.colCount;if(n--,n<k)return-1;for(;k<=n;){for(e=f,g=void 0,h=a[0],c>=1!=(2===j)&&(l=m),m=s((k+n)/2),m=ia(k,n,m,c>=0,!0),g=m;!ha(h,e)&&m!==-1&&(e=d?ga(b,0,m):ga(b,m,0),!ha(h,e));)m=ia(0,0,0,!1,!1),c>=0&&m<g?n=m:c<0&&m>g&&(k=m);if(m===-1&&c>=1!=(2===j))return l;if(m===-1)return-1;if(j=ka(h,e,!1),c>=1&&1===j)k=m+1;else if(c>=1&&2===j)n=m-1;else if(c<=-1&&1===j)n=m-1;else if(c<=-1&&2===j)k=m+1;else if(0===j){for(;c<=-1&&m>k||c>=0&&m<n;){if(i=0,i=c>=0?m+1:m-1,e=d?la(b,0,i):la(b,i,0),null===e)return-1;if(!ha(h,e))break;if(j=ka(h,e,!1),0!==j)break;m=i}return m}}return c>=1!=(2===j)?m:l}function na(a,b,c){var d,e,g,i,j,l,m,n,o,p,r=b,s=a[0],t=H(s);if(s===f&&(s=0),d=r.xkK=r.xkK||{},e=(c?t?"0":"1":t?"2":"3")+s,d[e])return d[e];if(g=h.zb(s),j=-1,t&&g&&(i=h.sb(g)),l=c?r.rowCount:r.colCount,m=c?r.colCount:1,g){for(n=0;n<l;n++)if(i.lastIndex=0,i.test(r[n*m])){j=n;break}}else if(t){for(s=s.toLowerCase(),n=0;n<l;n++)if(o=r[n*m],o&&o.toLowerCase&&o.toLowerCase()===s){j=n;break}}else for(s instanceof Date&&(s=q(s)),p=k(s,15),n=0;n<l;n++)if(o=r[n*m],o instanceof Date&&(o=q(o)),o===s||k(o,15)===p){j=n;break}return d[e]=j,j}function oa(a,b,c,d,e,g,i,j){var k,l,m,n,o,p,q=f,r=-1,s=a[0],t=H(s),u=!j&&h.zb(s),v=d?b.rowCount:b.colCount;for(t&&u&&(m=h.sb(u)),l=0;l<v;l++)if(o=e?v-1-l:l,n=d?ga(b,0,o):ga(b,o,0),ha(s,n,g,i))if(p=H(n),t&&p&&u?(m.lastIndex=0,k=m.test(n)?0:1):k=ka(s,n,!1),c>=1&&1===k)k=-1,r>=0&&(k=ka(n,q,!1)),(r<0||r>=0&&1===k)&&(r=o,q=n);else if(c<=-1&&2===k)k=-1,r>=0&&(k=ka(n,q,!1)),(r<0||r>=0&&2===k)&&(r=o,q=n);else if(0===k)return o;return r}function pa(a,b){var c,d,e,f,g;if(!b)for(c=o(a),d=void 0,d=1;d<c;d++)if(e=a[d-1],f=a[d],g=ka(e,f,!1),2===g)return!1;return!0}Q=e.CalcReference.prototype,R=function(a){ca(b,a);function b(b,c,d,e,f,g){var h,i=a.call(this,b,[fa(c,d,e,f)])||this;return i.getValue=function(a,b,c){var d=this,e=d.Nc,f;return f=0===e?d.getRow(0)+1+b:1===e?d.getColumn(0)+1+c:Q.getValue.call(d,a,b,c)},h=i,h.cj=c,h.Lk=d,h.Xj=e,h.Yj=f,h.Nc=g,i}return b.prototype.type=function(){return this.Nc},b.prototype.toArray=function(a,b){var c=this,d=[],e=c.cj,f=c.Lk,g=c.Nc,h=c.getRangeCount(),i=c.Xj,j=c.Yj,k,l,m,n,o,p;for(k=0;k<h;k++)for(b||(m=[],d.push(m)),o=0;o<i;o++)for(b||(n=[],m.push(n)),p=0;p<j;p++)l=0===g?e+1+o:1===g?f+1+p:Q.getValue.call(c,k,e+o,f+p),b?d.push(l):n.push(l);return b||1!==h||(d=d[0]),d.rowCount=i,d.colCount=j,d.rangeCount=h,d},b}(e.CalcReference),S=function(a){ca(b,a);function b(b){var c=a.call(this,g)||this;return c.il=b,c}return b.prototype.getRowCount=function(){return e.CalcArrayHelper.getColumnCount(this.il)},b.prototype.getColumnCount=function(){return e.CalcArrayHelper.getRowCount(this.il)},b.prototype.getValue=function(a,b){return e.CalcArrayHelper.getValue(this.il,b,a)},b}(e.CalcArray);function qa(a,b,c){var d,f,h,i,j,k;if(!a)return z;if(d=b!==g,b=d?b:a.getReference(a.source,fa(a.row,a.column,a.rowCount,a.columnCount)),!b||1!==b.getRangeCount())return z;if(i=[],c){if(j=b.getRow(0)+1,h=b.getRowCount(0),h>1){for(f=0;f<h;f++)i.push([j+f]);return new e.CalcArray(i)}return j}if(k=b.getColumn(0)+1,h=b.getColumnCount(0),h>1){for(f=0;f<h;f++)i.push(k+f);return new e.CalcArray([i])}return k}function ra(a,b,c,d,f,h){var i,j,k,l,m,n,o,p;return a&&c instanceof e.CalcReference?(m=a.source&&a.source.Af.dynamicReferences,k=c.getRowCount(0),l=c.getColumnCount(0),j=c.create([{row:c.getRow(0),col:c.getColumn(0),rowCount:h?k:1,colCount:h?1:l}]),m&&Ja(a,c,j.getRow(0),j.getColumn(0),j.getRowCount(0),j.getColumnCount(0),h&&c.yf[0].rowUndefine,!h&&c.yf[0].colUndefine)):(c instanceof e.CalcArray?(k=c.getRowCount(),l=c.getColumnCount()):Array.isArray(c)&&(k=c.rowCount,l=c.colCount),j=c),h&&d>l||!h&&d>k?A:(j.HkK=!0,i=e.Convert.Ph(j,0,!0,!1,!1),i.isError||i.isConvertError?A:(n=f||f===g?ma(b,i,1,h):na(b,i,h),n>=0?a&&c instanceof e.CalcReference?(o=h?n:d-1,p=h?d-1:n,m&&Ja(a,c,c.getRow(0)+o,c.getColumn(0)+p,1,1),c.getValue(0,o,p)):h?la(i,d-1,n):la(i,n,d-1):C))}function sa(a,b){return qa(a,b,!0)}function ta(a,b){return qa(a,b,!1)}function ua(a){return ea(a)?e.CalcArrayHelper.getRowCount(a):1}function va(a){return ea(a)?e.CalcArrayHelper.getColumnCount(a):1}function wa(a){return new S(a)}function xa(a,b,c,d,e){return ra(a,b,c,d,e,!1)}function ya(a,b,c,d,e){return ra(a,b,c,d,e,!0)}function za(a,b,c,d,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=b.getRowCount(),t=b.getColumnCount(),u=1===s&&1===t,v=c.getRowCount(),w=c.getColumnCount(),x=1===s&&t>=1,y=1===v&&w>=1;if(u){if(v>1&&w>1)return z}else if(x&&t!==w||!x&&s!==v)return z;if(h=Da(a,e.Convert.Ph(b,0,!0),f,g),h===C)return i="string"==typeof d?d:C,u?i:new e.CalcArray([[i]]);if(h===z)return z;if(h>0){if(u)return c;if(h-=1,j=[],e.Convert.Ca(c)){if(x)for(k=0;k<v;k++)l=c.getValue(0,h),j.push([l]);else m=y?[c.getValue(0,h)]:[c.getValue(h,0)],j.push(m);return new e.CalcArray(j)}if(c instanceof e.CalcReference)return n=c,o=n.getRow(),p=n.getColumn(),q=v,r=w,x?(p=n.getColumn()+h,r=1):(o=n.getRow()+h,q=1),n.create([{row:o,col:p,rowCount:q,colCount:r}])}}function Aa(a,b,c){var d,f,h,i,j,k,l,n=[];if(b)for(d=0;d<b.length;d++)n.push(b[d]);if(b.colCount<=b.rowCount?(n.colCount=b.colCount,n.rowCount=Math.ceil(n.length/n.colCount)):(n.rowCount=b.rowCount,n.colCount=Math.ceil(n.length/n.rowCount)),m(b.isReference)||(n.isReference=b.isReference),m(b.isArray)||(n.isArray=b.isArray),n.rangeCount=b.rangeCount,f=-1,i=n.colCount,j=n.rowCount,k=a,c===g)return l=i>j?xa(g,k,n,j,!0):ya(g,k,n,i,!0),r(l)?C:l;if(h=e.Convert.Ph(c,0,!0,!1,!1)){
if(h.colCount>1&&h.rowCount>1)return C}else h=n;return f=ma(k,n,1,!(i>j)),f>=0?(i=h.colCount,j=h.rowCount,i>j?la(h,f,j-1):la(h,i-1,f)):C}function Ba(a){var b=arguments;return a<1||o(b)<=a?z:m(b[a])?0:b[a]}function Ca(a,b,c){var d,e,h,i=a,j=b;return j.isArray||j.isReference?(d=j.colCount,e=j.rowCount,h=-1,d>1&&e>1?C:1===c&&!pa(j,!0)||c===-1&&!pa(j,!1)?C:(c===g?c=1:c===f&&(c=0),1===c?h=ma(i,j,1,e>1):0===c?h=na(i,j,e>1):c===-1&&(h=ma(i,j,-1,e>1)),h===-1?C:h+1)):C}function Da(a,b,c,d){var e,f,g,i,j,k,l,n,o,p,q,r,s=b;if(!s.isArray&&!s.isReference)return C;if(e=s.colCount,f=s.rowCount,e>1&&f>1)return z;if(2===c&&(2===d||d===-2))return z;if(g=2===d&&!pa(s,!0),i=d===-2&&!pa(s,!1),g||i)return C;if(j=a,k=a&&a[0],l=-1,m(c)&&(c=0),(m(d)||0===d)&&(d=1),d===-1&&(n=!0),0!==c&&2!==c||(o=0),1===d||d===-1){if(1===c)o=-1;else if(c===-1){if(h.ub(k))return C;o=1}l=oa(j,s,o,f>1,n,!0,!0,0===c)}else if(2===d||d===-2){if(1===e&&1===f){if(p=0,q=s[p],!ha(k,q))return C;if(r=ka(k,q,!1),0===r)return p+1;if(0===c)return 0===r?p+1:C;if(1===c)return 2===r?p+1:C;if(c===-1)return 1===r?p+1:C}o=2===d?1:-1,l=ma(j,s,o,f>1)}return l===-1?C:0!==c||Za(k,s[l])?Za(k,s[l])?l+1:2===d&&1===c?l+2:d===-2&&c===-1?l+2:l+1:C}function Ea(a,b,c,d){return a+=b,d?0!==c&&(a+="[",a+=""+c,a+="]"):a+=c,a}function Fa(a,b,c){return c||(a+="$"),a+=b}function Ga(a,b,c){c||(a+="$");for(var e=a.length;b>.1;b=parseInt(""+(b-1)/26,10))a=d.Common.u.Eb(a,e,String.fromCharCode("A".charCodeAt(0)+(b-1)%26));return a}function Ha(a,b){if(b&&0<o(b)){var c=void 0,d=!e.ei(b[0])&&"_"!==b[0];for(c=1;!d&&c<o(b);c++)d=!e.fi(b[c])&&"_"!==b[c];d?(a+="'",a+=b.replace("'","''"),a+="'"):a+=b,a+="!"}return a}function Ia(a,b,c,d,e){var f=3===c||4===c||7===c||8===c,g=2===c||4===c||6===c||8===c,h="";return a<1&&(d||!f)||a>I||b<1&&(d||!g)||b>J||c<1||8<c?z:(h=Ha(h,e),d?(h=Ga(h,b,g),h=Fa(h,a,f)):(h=Ea(h,"R",a,f),h=Ea(h,"C",b,g)),h)}function Ja(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o;a&&a.identity&&(i=a.gkK,j=b.getSource(),i&&j.getRangeKey&&(k=c,l=d,m=e,n=f,g&&(k=m=-1),h&&(l=n=-1),o=j.getRangeKey(j,{id:j.id,row:k,col:l,rowCount:m,colCount:n}),i.nOb||(i.nOb={}),i.nOb[o]={id:j.id,row:c,col:d,rowCount:e,colCount:f,rowUndefine:g,colUndefine:h}))}function Ka(a,b,c,d,h){var i,j,k,l,n,p,q,r,u,v,w,x,y,B;function C(a){return!m(a)&&!a._error}if(i=f,j=a,k=j!==f&&j.acceptsReference,l=j!==f&&j.arrayFormulaMode,!ea(b))return c=c!==g?s(c):0,d=d!==g?s(d):0,c<0||d<0?z:c>1||d>1?A:b;if(b instanceof e.CalcReference){if(n={value:-1},p=b,h===g&&(h=1),h=C(h)&&t(h,n)?n.value-1:i,h>=p.getRangeCount())return A;if(h===i||h<0)return z;if(q=p.getRowCount(h),r=p.getColumnCount(h),u=p.getRow(h),v=p.getColumn(h),w=void 0,x=void 0,3===o(arguments)){if(1!==q&&1!==r)return A;1!==r?(d=c,c=1):1!==q&&(d=1)}if(m(c)&&(c=0),c=C(c)&&t(c,n)?n.value-1:i,c===-1){if(1!==q&&!k&&!l&&(u>j.row||j.row>=u+q))return z}else{if(c<-1||c===i)return z;if(q<=c&&!b.yf[0].rowUndefine)return A;w=c+u}if(m(d)&&(d=0),d=C(d)&&t(d,n)?n.value-1:i,d===-1){if(1!==r&&!k&&!l&&(v>j.column||j.column>=v+r))return z}else{if(d<-1||d===i)return z;if(r<=d&&!b.yf[0].colUndefine)return A;x=d+v}return c===-1&&d===-1?(w=u,x=v):c===-1?(w=u,r=1):d===-1?(x=v,q=1):(r=1,q=1),y=a.source&&a.source.Af.dynamicReferences,y&&Ja(a,p,w,x,q,r,c===-1&&b.yf[0].rowUndefine,d===-1&&b.yf[0].colUndefine),p.create([fa(w,x,q,r)])}return e.Convert.Ca(b)?(B=b,q=B.getRowCount(),c=c!==g?s(c):-1,d=d!==g?s(d):-1,h=h!==g?s(h)-1:1,1!==h?A:(c===-1&&d===-1?c=d=0:d===-1&&1===q&&(d=c,c=1),c=c===-1?0:c,d=d===-1?0:d,q=B.getRowCount(),r=B.getColumnCount(),c<0||d<0||h<0?z:(c>q&&1===q&&d===g&&(d=c,c=0),q<c||r<d?A:0===c&&0===d?B.slice(0,0,q,r):0===c?B.slice(0,d-1,q,1):0===d?B.slice(c-1,0,1,r):B.getValue(c-1,d-1)))):void 0}function La(a,b,c,d,f,h){var i,j,k,l;return a?b&&b instanceof e.CalcReference&&1===b.getRangeCount()?(i=f!==g?s(f):b.getRowCount(0),j=h!==g?s(h):b.getColumnCount(0),k=b.getRow(0)+c,l=b.getColumn(0)+d,i<0&&(k+=i+1,i=Math.abs(i)),j<0&&(l+=j+1,j=Math.abs(j)),Ja(a,b,k,l,i,j,m(f)&&b.yf[0].rowUndefine,m(h)&&b.yf[0].colUndefine),k<0||l<0?A:b.create([{row:k,col:l,rowCount:i,colCount:j}])):z:C}function Ma(a,b,c){var d,f,g,h,j,k,l,m,n,o,p,q;return a?b&&"!"!==b[0]?(d=a.row,f=a.column,g={row:d,col:f},h=a.parser,h||(h=a.parser=new e.Parser),j=a.source,k=j.parserContext,k?(k.useR1C1=!c,k.row=g&&g.row||0,k.column=g&&g.col||0,k.baseIdentity=g,k.source=a.source):(j.parserContext=k=a.source?a.source.getParserContext(!c,g):new e.ParserContext(a.source,(!c),g),k.onlyValidateSourceNameWithSpecial=!0),c?l=h.parse(k,b):(n=j.expressions,n||(n=j.expressions={}),l=n[b],l||(l=h.parse(k,b),n[b]=l)),l?(o=!1,7===l.type&&"ANCHORARRAY"===l.functionName&&(l=l.arguments[0],o=!0),8===l.type&&(l.source?(m=l.source,l=m.getCustomName(l.value)):l=a.getName(l.value)),!l||i.Ea(l.type,[1,13])<0?A:(m=l.source||a.source,25===l.type||26===l.type?m.getValueByName(l.nameIdentity):(p=l.getRange(d,f),13===l.type&&(m=l.source),q=null,q=m.getReference(p),o&&(q=q.getSpillRef()),Ja(a,q,q.getRow(0),q.getColumn(0),q.getRowCount(0),q.getColumnCount(0),q.yf[0].rowUndefine,q.yf[0].colUndefine),q))):A):A:C}function Na(a,b){var c,d="__hyperlink__";return c=2===arguments.length?new String(y(b)):new String(y(a)),c[d]=y(a),c}function Oa(){var a,b=0;for(a=0;a<o(arguments);a++){if(0===arguments[a].length)return D;arguments[a].isReference&&(b+=arguments[a].rangeCount)}return b}function Pa(a,b){var c=b.getRow(0),d=b.getColumn(0),e=b.getSource().getCalcSourceModel().getFormula(c,d);return e?"="+e:C}function Qa(a,b){var c=b.getRow(0),d=b.getColumn(0),e=b.getSource().getCalcSourceModel().getFormula(c,d);return!!e}function Ra(a,b){void 0===b&&(b=!1);var c;return c=w(a)||x(a)?a.toArray(0,!1):a.length&&a[0].length?a:[[a]],c?Sa(c,b):r(a)?a:z}function Sa(a,b){var c,d,e,f,g,h,i;if(void 0===b&&(b=!1),d=a.rowCount,e=a.colCount,d||e||(d=a.length,e=a[0].length),f=a,b){for(f=[],g=0;g<e;g++)for(h=[],f.push(h),i=0;i<d;i++)h.push(a[i][g]);c=[e,d],d=c[0],e=c[1]}return f.rowCount=d,f.colCount=e,f}function Ta(a){return 1===a||a===-1}function Ua(a,b){var c=b.length;a.sort(function(a,d){var f,g,h,i;for(f=0;f<c;f++)if(g=b[f],h=g[0],i=e.pOb(a[h],d[h]),0!==i)return g[1]?i:-i;return 0})}function Va(a,b,c){if(c)a.forEach(function(a,c){a.push(b[c][0])});else{var d=b[0];a.forEach(function(a,b){a.push(d[b])})}}function Wa(a){if(a&&a.length&&a.length>=0){for(var b=0;b<a.length;b++)if("number"!=typeof a[b])return!1;return!0}return!1}function Xa(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,s,t,u,v,y,A,B,C,D;if(void 0===b&&(b=1),void 0===c&&(c=1),void 0===d&&(d=!1),f=[].concat(Ra(a,d)),r(f))return f;if(g=f,h=[],w(b)||x(b)){if(l=b.toArray(0,!1),m=l.rowCount,n=l.colCount,o=0,w(c)||x(c)){if(j=c.toArray(0,!1),o=j.rowCount,1!==n){if(n<1||1!==j.colCount&&j.colCount!==n||1!==m||!Wa(l[0]))return z;if(p=[],p.push(a),d)for(g=Sa(g,d),q=0;q<n;q++){for(s=[],t=0;t<g[0].length;t++)s.push(g[l[0][q]-1][t]);p.push(new e.CalcArray([s])),1===o?p.push(j[0][0]):p.push(j[q][0])}else for(q=0;q<n;q++){for(s=[],t=0;t<g.length;t++)s.push([g[t][l[0][q]-1]]);p.push(new e.CalcArray(s)),1===o?p.push(j[0][0]):p.push(j[q][0])}return Ya.apply(Ya,p)}if(1!==j.colCount||1!==o&&o!==m)return z;1===o&&(o=0,k=j[0][0])}else k=c;for(i=0;i<m;i++)h.push([l[i][0],i<o?j[i][0]:k])}else if(w(c)||x(c)){if(j=c.toArray(0,!1),1!==j.colCount||1!==j.rowCount)return z;h.push([b,j[0][0]])}else h.push([b,c]);for(u=g.colCount,v=[],y=0,A=h;y<A.length;y++){if(B=A[y],C=B[0],D=B[1],C<1||C>u||!Ta(D))return z;v.push([C-1,1===D])}return Ua(g,v),new e.CalcArray(d?Sa(g,d):g)}function Ya(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,s,t,u,v,y,A,B,C,D,E,F,G,H,I;for(void 0===c&&(c=1),d=[],f=3;f<arguments.length;f++)d[f-3]=arguments[f];if(i=0,j=0,k=z,x(a)?g=a:w(a)&&(h=a,i=h.getRow(),j=h.getColumn()),l=g||h){if(m=l.getColumnCount(),n=l.getRowCount(),r(a))return k;for(o=[],p=void 0,q=0,s=0,t=void 0,u=void 0,v=1,y=arguments.length;v<y;v+=2){if(A=arguments[v],B=[].concat(Ra(A)),r(B))return k;if(C=A.getRowCount(),D=A.getColumnCount(),q||(p=1===D,q=p?2:1,u=[].concat(Ra(a,!p))),!(!p&&1===C&&D===m||p&&1===D&&C===n))return k;if(E=x(A),w(A)&&(F=void 0,p?(G=A.getColumn(),F=j-G,F>=0&&F<m?t=F:E=!0):(H=A.getRow(),F=i-H,F>=0&&F<n?t=F:E=!0)),E&&(s+=1,p?(t=m,m++):(t=n,n++),Va(u,B,p)),I=arguments[v+1]||1,!Ta(I))return k;o.push([t,1===I])}return Ua(u,o),s&&u.forEach(function(a){a.length-=s}),new e.CalcArray(p?u:Sa(u,!0))}return k}function Za(a,b){return!!(a===b||p(a)&&p(b)&&q(a)===q(b)||r(a)&&r(b)&&a._code===b._code)}function $a(a,b){var c,d,e,f;for(c=0,d=a.length;c<d;c++)if(e=a[c],f=b[c],!Za(e,f))return!1;return!0}function _a(a,b,c){var d,f,g,h;return void 0===b&&(b=!1),void 0===c&&(c=!1),d=Ra(a,b),r(d)?d:(f=d,g=[],h=f.rowCount,f.forEach(function(a,b){var d,e,i;if(!a.duplicated){for(d=0,e=b+1;e<h;e++)i=f[e],$a(a,i)&&(i.duplicated=!0,d++);c&&0!==d||g.push(a)}}),new e.CalcArray(b?Sa(g,b):g))}function ab(a,b,c){var d,f,g,h=Ra(a);return r(h)?h:(d=h,f=[].concat(Ra(b)),g=[],1===f.length&&f[0].length===d[0].length?d.forEach(function(a,b){var c=[];a.forEach(function(a,b){f[0][b]&&c.push(a)}),g.push(c)}):d.forEach(function(a,b){f[b][0]&&g.push(a)}),0===g.length?m(c)?E:c:new e.CalcArray(g))}function bb(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;if(x(b))return b.getValue(0,0);if(w(b)){if(c=b,d=c.getColumn(),e=c.getRow(),f=c.getColumnCount(),g=c.getRowCount(),h=a.row,i=a.column,j=h-e,k=i-d,l=void 0,m=void 0,n=a.source===c.getSource(),1===g&&(!n||e!==h)&&k>=0&&k<f)m=i,l=e;else if(1===f&&(!n||d!==i)&&j>=0&&j<g)m=d,l=h;else{if(1!==g||1!==f)return z;m=d,l=e}return c.create([{row:l,col:m,rowCount:1,colCount:1}])}return b}function cb(a,b){return b instanceof e.CalcReference?b.getSpillRef():A}function db(){var a,b,c,d,f,g,h,i,j=arguments,k=j.length;if(1===k)return new e.CalcArray(j[0]);for(a=0,b=0;b<k;b++)a=Math.max(a,j[b].colCount);for(c=[],d=0;d<k;d++)for(f=j[d],g=0;g<f.rowCount;g++){for(h=[],i=f.colCount,b=0;b<i;b++)h.push(f[g][b]);for(b=i;b<a;b++)h.push(C);c.push(h)}return new e.CalcArray(c)}function eb(){var a,b,c,d,f,g,h,i,j=arguments,k=j.length;if(1===k)return new e.CalcArray(j[0]);for(a=0,b=0;b<k;b++)a=Math.max(a,j[b].rowCount);for(c=[],d=0;d<a;d++){for(f=[],g=0;g<k;g++)for(h=j[g],i=d<h.rowCount,b=0;b<h.colCount;b++)f.push(i?h[d][b]:C);c.push(f)}return new e.CalcArray(c)}function fb(a,b,c,d){var e,g,h=a.rowCount,i=a.colCount,j=1===c||3===c,k=2===c||3===c,l=function(a){j&&a===f||k&&r(a)||d(a)};if(b)for(e=0;e<i;e++)for(g=0;g<h;g++)l(a[g][e]);else for(g=0;g<h;g++)for(e=0;e<i;e++)l(a[g][e])}function gb(a){var b,c=Array(a);for(b=0;b<a;b++)c[b]=[];return c}function hb(a,b,c){var d=[];return fb(a,c,b,function(a){d.push(a===f?0:a)}),new e.CalcArray([d])}function ib(a,b,c){var d=[];return fb(a,c,b,function(a){d.push([a===f?0:a])}),new e.CalcArray(d)}function jb(a,b,c){var d,f,g,h,i=a.rowCount,j=a.colCount;if(1!==i&&1!==j)return z;if(m(b)||b<=0)return B;if(d=Math.max(i,j),d<=b)return new e.CalcArray(a);if(f=[],g=[],fb(a,!1,0,function(a){g.push(a),g.length===b&&(f.push(g),g=[])}),g.length>0){for(c=m(c)?C:c,h=g.length;h<b;h++)g.push(c);f.push(g)}return new e.CalcArray(f)}function kb(a,b,c){var d,f,g,h,i=a.rowCount,j=a.colCount;if(1!==i&&1!==j)return z;if(m(b)||b<=0)return B;if(d=Math.max(i,j),d<=b)return new e.CalcArray(a);if(f=gb(b),g=0,fb(a,!1,0,function(a){f[g].push(a),g++,g===b&&(g=0)}),g>0)for(c=m(c)?C:c,h=g;h<b;h++)f[h].push(c);return new e.CalcArray(f)}function lb(a,b,c,d,f){var g,h,i,j=0===b&&c===a.rowCount,k=0===d&&f===a.colCount;if(j&&k)return new e.CalcArray(a);for(g=[],h=b;h<c;h++)i=a[h],g[h-b]=k?i:i.slice(d,f);return new e.CalcArray(g)}function mb(a,b,c){var d,e,f,g,h=a.rowCount,i=a.colCount;return da(a,h,i)?z:(b=m(b)?h:b,c=m(c)?i:c,(b>h||b<-h)&&(b=h),(c>i||c<-i)&&(c=i),d=b>0?0:h+b,e=b>0?b:h,f=c>0?0:i+c,g=c>0?c:i,lb(a,d,e,f,g))}function nb(a,b,c){var d,e,f,g,h=a.rowCount,i=a.colCount;return b=m(b)?0:b,c=m(c)?0:c,b>=h||b<=-h||c>=i||c<=-i?E:(d=b>=0?b:0,e=b>=0?h:h+b,f=c>=0?c:0,g=c>=0?i:i+c,lb(a,d,e,f,g))}function ob(a,b){var c,d=Array(b);if("function"==typeof d.fill)d.fill(a,0,b);else for(c=0;c<b;c++)d[c]=a;return d}function pb(a,b,c,d){var f,g,h,i,j,k=a.rowCount,l=a.colCount;if(b=m(b)?k:b,c=m(c)?l:c,da(a,k,l)||b<k||c<l)return z;if(f=b>k,g=c>l,!f&&!g)return new e.CalcArray(a);for(d=m(d)?C:d,h=ob(d,c-l),i=[],j=0;j<k;j++)i.push(g?a[j].concat(h):a[j]);for(j=k;j<b;j++)i.push(ob(d,c));return new e.CalcArray(i)}function qb(a){var b,c,d,f,g,h,i;if(r(a))return a;if(x(a)||w(a)){if(c=a.getRowCount(),d=a.getColumnCount(),1!==c&&1!==d)return z;if(f=1===c&&1===d,g=f?1:5,h=e.Convert.Ph(a,g,!0,!0,!0),h.isConvertError)return z;if(h.isError)return h[0];if(h.some(function(a){return a===e.Convert.CalcConvertedError}))return z;b=h}else{if(i={},!t(a,i))return z;b=[i.value]}return b}function rb(a,b){var c,d,f,g,h=[],i=e.Convert.Ph(a[0],0,!1,!1,!1,!1),j=b?i.rowCount:i.colCount;for(c=1;c<a.length;c++){if(d=qb(a[c]),r(d))return d;for(f=0;f<d.length;f++){if(g=d[f],0===g||g>j||g<-j)return z;h.push(g)}}return 0===h.length?z:{array:i,indexNumbers:h}}function sb(){var a,b,c,d,f,g,h=rb(arguments,!0);if(r(h))return h;for(a=h.array,b=h.indexNumbers,c=a.rowCount,d=[],f=0;f<b.length;f++)g=b[f],g=g>0?g-1:c+g,d.push(a[g]);return new e.CalcArray(d)}function tb(){var a,b,c,d,f,g,h,i,j=rb(arguments,!1);if(r(j))return j;for(a=j.array,b=j.indexNumbers,c=a.rowCount,d=a.colCount,f=gb(c),g=0;g<b.length;g++)for(h=b[g],h=h>0?h-1:d+h,i=0;i<c;i++)f[i].push(a[i][h]);return new e.CalcArray(f)}T={_i:!0,Hi:7},U={Hi:7},V={Hi:2},W={Hi:2},X={_i:1,Hi:2},Y={Hi:2,aj:"<= 0",bj:z},Z={Hi:2,aj:["< 0","> 3"],bj:z},$={Hi:2,aj:["= 0"],bj:E},_={_i:0,Hi:2},aa={Hi:4,Ii:0,Ji:!0},ba={Hi:4,Ii:0,Xi:!0},F("ADDRESS",Ia,2,5,[V,V,X,T,{_i:"",Hi:5}],g,g,{bk:[2,3,4]}),F("INDEX",Ka,2,4,g,0,0,{bk:[1,2,3],FHJ:[0],f_J:!0,dk:!0,fk:3}),F("OFFSET",La,3,5,[{},V,V],0,0,{bk:[3,4],FHJ:[0],VXJ:!0,dk:!0,fk:2,returnReference:!0}),F("ROW",sa,0,1,g,-1,g,{dk:!0,FHJ:-1,expandColumns:!1}),F("COLUMN",ta,0,1,g,-1,g,{bk:0,dk:!0,FHJ:-1,expandRows:!1}),F("ROWS",ua,1,1,g,-1,-1,{FHJ:-1,expandColumns:!1,g_J:"setRowCount"}),F("COLUMNS",va,1,1,g,-1,-1,{FHJ:-1,expandRows:!1,g_J:"setColumnCount"}),F("TRANSPOSE",wa,1,1,g,-1,-1),F("LOOKUP",Aa,2,3,[aa,{Hi:4,Ii:0,Ji:!0,xTa:!0}],"!= 0","!= 0",{fk:1}),F("HLOOKUP",xa,3,4,[aa,{},Y,U],1,1,{dk:!0,f_J:!0,FHJ:[1]}),F("VLOOKUP",ya,3,4,[aa,{},Y,U],1,1,{dk:!0,f_J:!0,FHJ:[1],TAb:!0}),F("XLOOKUP",za,3,6,[aa,{},{},{Hi:5},{Hi:2,_i:0},{Hi:2,_i:1}],[1,2],[1,2],{bk:[3,4,5]}),F("VSTACK",db,1,255,ba,-1,-1,g,!0),F("HSTACK",eb,1,255,ba,-1,-1,g,!0),F("TOROW",hb,1,3,[ba,Z,U],0,0,{bk:[1,2]},!0),F("TOCOL",ib,1,3,[ba,Z,U],0,0,{bk:[1,2]},!0),F("WRAPROWS",jb,2,3,[ba,V],0,0,{bk:[2],gk:-1},!0),F("WRAPCOLS",kb,2,3,[ba,V],0,0,{bk:[2],gk:-1},!0),F("TAKE",mb,2,3,[ba,$,$],0,0,{bk:[1,2]},!0),F("DROP",nb,2,3,[ba,_,_],0,0,{bk:[1,2]},!0),F("EXPAND",pb,2,4,[ba,Y,Y],0,0,{bk:[1,2,3]},!0),F("CHOOSEROWS",sb,2,255,g,-1,-1,g,!0),F("CHOOSECOLS",tb,2,255,g,-1,-1,g,!0),F("CHOOSE",Ba,2,255,V,">= 1",">= 1",{gk:">= 1",isBranch:!0,findTestArgument:0,findBranchArgument:function(a){var b={value:-1};return r(a)?-1:(t(a,b),b.value)}}),F("MATCH",Ca,2,3,[aa,{Hi:4,Ii:0,Ji:!0,HkK:!0},W],1,1,{}),F("XMATCH",Da,2,4,[aa,aa,W,W],1,1,{}),F("INDIRECT",Ma,1,2,[{Hi:5},T],g,g,{bk:2,VXJ:!0,dk:!0}),F("HYPERLINK",Na,1,2),F("AREAS",Oa,1,g,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),F("FORMULATEXT",Pa,1,1,g,-1,g,{dk:!0}),F("ISFORMULA",Qa,1,1,g,-1,g,{dk:!0}),F("SORT",Xa,1,4,g,[0,1,2],[0,1,2],{bk:[1,2,3]},!0),F("SORTBY",Ya,2,g,g,[0,"%= 1"],[0,"%= 1"],g,!0),F("UNIQUE",_a,1,3,g,[0],[0],{bk:[1,2]},!0),F("FILTER",ab,2,3,g,[0,1,2],[0,1,2],g,!0),F("@",bb,1,1,g,[0],[0],{dk:!0},!0),F("ANCHORARRAY",cb,1,1,g,[0],[0],{dk:!0},!0)},"./src/functions-stat.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("CalcEngine"),f=d.Common.k.ac,g=null,h=void 0,i=isNaN,j=isFinite,k=parseInt,l=Math.pow,m=Math.max,n=Math.min,o=Math.floor,p=Math.sin,q=Math.tan,r=Math.PI,s=Math.atan,t=Math.exp,u=Math.abs,v=Math.sqrt,w=Math.log,x=Math.round,y=e.Errors.DivideByZero,z=e.Errors.Value,A=e.Errors.NotAvailable,B=e.Errors.Number,C=e.Errors.Null,D=e.Convert.Nh,E=e.Convert.Ph,F=e.Convert.Rh,G=e.Convert.Pa,H=e.Convert.Fh,I=e.Functions.MathHelper,J=I.Bk,K=I.xk,L=e.Convert.Na,M=e.Convert.vf,N=e.Functions.Ogc,O=e.Functions.sk,P=e.Functions.sja,Q=e.Functions.qk,R=e.Functions.ik,S=e.Functions.jk,T=e.Functions.Na,U=e.Functions.hk,V=e.Convert.CalcConvertedError,W=e.Functions.ak,X=e.Convert.Th,Y=e.Convert.Sh;function Za(a){var b,c=0;for(b=0;b<a.length;b++)a[b]!==V&&c++;return c}function $a(a){var b,c,d,e=6;return 0===a?b=0:(c=.5*Math.abs(a),c>=.5*e?b=1:c<1?(d=c*c,b=((((((((.000124818987*d-.001075204047)*d+.005198775019)*d-.019198292004)*d+.059054035642)*d-.151968751364)*d+.319152932694)*d-.5319230073)*d+.797884560593)*c*2):(c-=2,b=(((((((((((((-45255659e-12*c+.00015252929)*c-19538132e-12)*c-.000676904986)*c+.001390604284)*c-.00079462082)*c-.002034254874)*c+.006549791214)*c-.010557625006)*c+.011630447319)*c-.009279453341)*c+.005353579108)*c-.002141268741)*c+.000535310849)*c+.999936657524)),a>0?.5*(b+1):.5*(1-b)}function _a(a,b,c){var d,e,g,h,i,j=f(a);if(b!==a[0]){for(g=0,h=a[0],e=1;e<j&&a[e]<b;e++)a[e]!==h&&(g=e,h=a[e]);a[e]!==h&&(g=e),b===a[e]?d=c?g/(j-1):(e+1)/(j+1):0===g?d=0:(i=(b-a[g-1])/(a[g]-a[g-1]),d=c?(g-1+i)/(j-1):(g+i)/(j+1))}else d=c?0:1/(j+1);return d}function ab(a,b,c,d){var e,g,h=[];return sb(a,h),e=f(h),0===e||b<h[0]||b>h[e-1]?A:(g=1===e?1:_a(h,b,d),0!==g?x(g*l(10,c))/l(10,c):g)}function bb(a,b,c){var d,e,f,g,h,i=300,j=1e-50,k=1e-20,l=a+b,m=a+1,n=a-1,o=1,p=1-l*c/m;for(u(p)<j&&(p=j),p=1/p,d=p,e=1;e<=i&&(f=e+e,g=(b-e)*e*c/((n+f)*(a+f)),p=1+g*p,u(p)<j&&(p=j),o=1+g/o,u(o)<j&&(o=j),p=1/p,d*=p*o,g=0-(a+e)*(l+e)*c/((a+f)*(m+f)),p=1+g*p,u(p)<j&&(p=j),o=1+g/o,u(o)<j&&(o=j),p=1/p,h=p*o,d*=h,!(u(h-1)<k));e++);return d}function cb(a){var b=[2.2250738585072014e-308,1.7976931348623157e308,l(2,-53),l(2,-52),I.Ek(2,10)];return b[a-1]||0}function db(a,b,c){var d,e=0,f=0;if(b<1)return 0;for(d=1;d<=b;d++)if(e=b-d,f+=u(G(a[e])),f>c)return e;return e}function eb(a,b,c){var d,e,f,g,h;if(c<1||c>1e3||a<-1.1||a>1.1)return NaN;for(d=2*a,f=e=0,g=0,h=1;h<=c;h++)f=e,e=g,g=d*e-f+G(b[c-h]);return.5*(g-f)}function fb(a){var b,c=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1.809129475572494e-11,6.221098041892606e-14,-3.399615005417722e-16,2.683181998482699e-18,-2.868042435334643e-20,3.9628370610464347e-22,-6.831888753985767e-24,1.4292273559424982e-25,-3.5475981581010704e-27,1.025680058010471e-28,-3.401102254316749e-30,1.276642195630063e-31],d=db(c,15,cb(3)),e=1/v(cb(3)),f=t(n(w(cb(2)/12),-w(12*cb(1))));return a<10?NaN:a>=f?4.930380657631324e-32:a<e?(b=10/a,eb(b*b*2-1,c,d)/a):1/(12*a)}function gb(a){var b=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,4.1640416213865184e-7,-7.359582837807599e-8,1.3117611876241675e-8,-2.3546709317742423e-9,4.2522773276035e-10,-7.71908941348408e-11,1.407574648135907e-11,-2.5769072058024682e-12,4.734240666629442e-13,-8.724901267474264e-14,1.612461490274055e-14,-2.9875652015665774e-15,5.548070120908289e-16,-1.0324619158271569e-16,1.9250239203049852e-17,-3.595507346526515e-18,6.726454253787686e-19,-1.260262416873522e-19,2.364488440860621e-20,-4.4419377050807936e-21,8.354659446403425e-22,-1.5731559416479563e-22,2.9653128740247425e-23,-5.594958348181595e-24,1.056635426883568e-24,-1.9972483680670205e-25,3.778297781883936e-26,-7.153158688908174e-27,1.3552488463674214e-27,-2.5694673048487566e-28,4.8747756066216946e-29,-9.254211253084972e-30,1.757859784176024e-30,-3.341002667773101e-31,6.353393618023618e-32],c=db(b,43,.1*cb(3));return a<=-1?NaN:u(a)<=.375?a*(1-a*eb(a/.375,b,c)):w(a+1)}function hb(a){var b,c,d,e,f,g,h=1,i=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,7.7823e-12,-3.6968e-12,5.1e-13,-2.06e-14,-5.4e-15,1.4e-15];if(a>171)return 1e308;if(a===F(a))if(a>0)for(b=1,e=2;e<a;e++)b*=e;else b=1e308;else{if(u(a)>1){for(d=u(a),f=F(d),h=1,c=1;c<=f;c++)h*=d-c;d-=f}else d=a;for(g=i[24],c=23;c>=0;c--)g=g*d+i[c];b=1/(g*d),u(a)>1&&(b*=h,a<0&&(b=-r/(a*b*p(r*a))))}return b}function ib(a){var b,c,d,e,f,g=0,h=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],i=a;if(a<=0)return 1e308;if(1===a||2===a)return 0;for(a<=7&&(g=F(7-a),i=a+g),c=1/(i*i),d=2*r,e=h[9],b=8;b>=0;b--)e=e*c+h[b];if(f=e/i+.5*w(d)+(i-.5)*w(i)-i,a<=7)for(b=1;b<=g;b++)f-=w(i-1),i-=1;return f}function jb(a,b){var c,d,e,f=d=a;return b<f&&(f=b),b>d&&(d=b),f<0?NaN:0===f?U:f>=10?(c=fb(f)+fb(d)-fb(f+d),w(d)*-.5+.9189385332046728+c+(f-.5)*w(f/(f+d))+d*gb(-f/(f+d))):d>=10?(c=fb(d)-fb(f+d),e=pd(f),M(e)?NaN:G(e)+c+f-f*w(f+d)+(d-.5)*gb(-f/(f+d))):w(hb(f)*(hb(d)/hb(f+d)))}function kb(a,b,c){var d,e,f,g,h,i,j,k,l,p,q,r=cb(3),s=w(r),u=cb(1),v=w(u),x=a,y=b,z=c;if(y/(y+z)<a&&(x=1-x,y=c,z=b),(y+z)*x/(y+1)<r)d=0,f=y*w(m(x,u))-w(y)-jb(y,z),f>v&&0!==x&&(d=t(f)),x===a&&y===b||(d=1-d);else{if(i=z-o(z),0===i&&(i=1),f=y*w(x)-jb(i,y)-w(y),d=0,f>=v&&(d=t(f),e=d*y,1!==i))for(h=F(m(s/w(x),4)),j=1;j<=h;j++)g=j,e=e*(g-i)*x/g,d+=e/(y+g);if(z>1){for(f=y*w(x)+z*w(1-x)-jb(y,z)-w(z),k=F(m(f/v,0)),e=t(f-k*v),l=1/(1-x),p=z*l/(y+z-1),q=0,h=F(z),z===h&&(h-=1),j=1;j<=h&&!(p<=1&&e/r<=q);j++)g=j,e=(z-g+1)*l*e/(y+z-g),e>1&&(k-=1,e*=u),0===k&&(q+=e);d+=q}x===a&&y===b||(d=1-d),d=m(n(d,1),0)}return d}function lb(a){var b,c;return a=.7071067811865475*-a,b=G(a),i(b)?z:(c=Q(b*v(2)),M(c)?NaN:.5*(2-2*c))}function mb(a,b,c,d){var e,f,g,h,i,j,k,l,n,o,p,q,r,s;function t(a,b){return a<0&&b>0||a>0&&b<0}for(e=1e-307,f=2.22045e-16,g=a.ge(b),h=a.ge(c),j=0;j<1e3&&!t(g,h);j++)u(g)<=u(h)?(i=b,b+=2*(b-c),b<0&&(b=0),c=i,h=g,g=a.ge(b)):(i=c,c+=2*(c-b),b=i,g=h,h=a.ge(c));if(0===g)return b;if(0===h)return c;if(!t(g,h))return d.jl=!0,0;for(k=b,l=g,n=c,o=h,p=b,q=g,r=.5*(b+c),s=!0,j=0;j<500&&u(q)>e&&c-b>m(u(b),u(c))*f;)s&&(l!==o&&o!==q&&q!==l?(r=k*q*o/(q-l)/(o-l)+p*o*l/(o-q)/(l-q)+n*l*q/(l-o)/(q-o),s=b<r&&r<c):s=!1),s||(r=.5*(b+c),n=c,o=h,s=!0),k=n,n=p,p=r,l=o,o=q,q=a.ge(r),t(g,q)?(c=p,h=q):(b=p,g=q),s=s&&2*u(q)<=u(o),++j;return p}function nb(a,b){var c,d,e,g,h=f(b);for(c=0;c<h;c++)d=G(b[c]),e=d-a.M,g=e/(a.N+1),a.M+=g,a.Q+=a.N*e*g,a.N++,a.kl+=d}function ob(a){var b,c=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],d=1.000000000190015,e=a,f=a+5.5;for(f-=(a+.5)*w(f),b=0;b<=5;b++)++e,d+=c[b]/e;return-f+w(2.5066282746310007*d/a)}function pb(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=0===c||1===c?0:t(ob(a+b)-ob(a)-ob(b)+a*w(c)+b*w(1-c)),s=c>=(a+1)/(a+b+2);for(s&&(d=a,a=b,b=d,c=1-c),e=4.450147717014403e-308,f=100,g=a+b,h=a+1,i=a-1,j=1,k=1-g*c/h,u(k)<e&&(k=e),k=1/k,l=k,m=1,n=2;m<=f;m++,n+=2)if(o=m*(b-m)*c/((i+n)*(a+n)),k=1+o*k,u(k)<e&&(k=e),j=1+o/j,u(j)<e&&(j=e),k=1/k,l*=k*j,o=-(a+m)*(g+m)*c/((a+n)*(h+n)),k=1+o*k,u(k)<e&&(k=e),j=1+o/j,u(j)<e&&(j=e),k=1/k,p=k*j,l*=p,u(G(p-1))<5e-324)return q=r*l/a,s?1-q:q;return B}function qb(a,b){var c,d,e,g,h=f(b);for(c=0;c<h;c++)d=b[c],d!==V&&(e=d-a.M,g=e/(a.N+1),a.M+=g,a.Q+=a.N*e*g,a.N++,a.kl+=d)}function rb(a){a.sort(function(a,b){return a-b})}function sb(a,b){var c,d;for(c=0;c<f(a);c++)d=a[c],d!==V&&b.push(d);rb(b)}function tb(a){var b,c=[];for(b=0;b<f(a);b++)sb(a[b],c);return c}function ub(a,b,c){var d,e,f,g,h,i,j,k,m,n,o,p=Math.expm1||function(a){return t(a)-1},q=Math.log1p||function(a){return w(1+a)};return a<=0?0:a>=1?1:1===c?l(a,b):1===b?-p(c*q(-a)):(e=.5-a+.5,f=q(-a),g=a,h=w(a),i=b,j=c,k=a>b/(b+c),k&&(i=c,j=b,g=e,e=a,h=f,f=w(a)),d=vb(g,i,j),d/=i,m=i/(i+j),n=j/(i+j),o=i>1&&j>1&&m<.97&&n<.97?wb(g,i,j)*g*e:t(i*h+j*f-xb(!1,i,j)),d*=o,k&&(d=.5-d+.5),d>1&&(d=1),d<0&&(d=0),d)}function vb(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=2.22045e-16,o=1,p=1,q=1-(b+c)/(b+1)*a;0===q?(d=0,e=1,g=1):(d=1,e=1/q,g=d*e),f=1,h=1,i=5e4,j=!1;do k=b+2*h,l=h*(c-h)*a/((k-1)*k),m=-(b+h)*(b+c+h)*a/(k*(k+1)),o=(d+l*o)*e,p=(q+l*p)*e,d=o+m*d*e,q=p+m*q*e,0!==q&&(e=1/q,f=d*e,j=u(g-f)<u(g)*n),g=f,h+=1;while(h<i&&!j);return g}function wb(a,b,c){var d,e,f,g,h,i,j;return 1===b?1===c?1:2===c?-2*a+2:a<=.01?c+c*t((c-1)*w(1-a))-1:c*l(.5-a+.5,c-1):1===c?2===b?b*a:b*l(a,b-1):a<=0&&!(b<1&&0===a)||a>=1&&!(c<1&&1===a)?0:(d=w(cb(2)),e=w(cb(1)),f=w(a<.1?1+a:1-a),g=w(a),h=(b-1)*g,i=(c-1)*f,j=xb(!1,b,c),h<d&&h>e&&i<d&&i>e&&j<d&&j>e&&h+i<d&&h+i>e?l(a,b-1)*l(.5-a+.5,c-1)/xb(!0,b,c):t(h+i-j))}function xb(a,b,c){var d,e,f,g,h,i,j,k,l,m=c,n=b,o=171.624376956302;return b>c&&(d=m,m=n,n=d),a&&m+n<o?zb(m)/zb(m+n)*zb(n):(e=6.02468004077673,f=e-.5,g=Bb(m),g/=Bb(m+n),g*=Bb(n),h=m+n+f,i=a?g*v(h/(m+f)/(n+f)):w(g)+.5*(w(h)-w(m+f)-w(n+f)),j=n/(m+f),k=m/(n+f),l=-m*w(1+j)-n*w(1+k)-f,a?t(l)*i:l+i)}function yb(a){var b=Bb(a),c=6.02468004077673,d=a+c-.5,e=l(d,a/2-.25);return b*=e,b/=t(d),b*=e,a<=20&&a===I.wk(a)&&(b=x(b)),b}function zb(a){var b,c,d=w(r),e=w(cb(2)),f=171.624376956302;return a>f?B:a>=1?yb(a):a>=.5?yb(a+1)/a:a>=-.5?(b=yb(a+2)-w(a+1)-w(u(a)),b>=e?B:yb(a+2)/(a+1)/a):(c=yb(1-a)+w(u(p(r*a))),c-d>=e?0:c<0&&d-c>e?B:t(d-c)*(p(r*a)<0?-1:1))}function Ab(a){var b=171.624376956302;return a>=b?yb(a):a>=1?w(yb(a)):a>=.5?w(yb(a+1)/a):yb(a+2)-w(a+1)-w(a)}function Bb(a){var b,c,d,e,f=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],g=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(a<=1)for(b=f[12],c=g[12],d=11;d>=0;--d)b*=a,b+=f[d],c*=a,c+=g[d];else for(e=1/a,b=f[0],c=g[0],d=1;d<=12;++d)b*=e,b+=f[d],c*=e,c+=g[d];return b/c}function Cb(a,b){return a<=0?0:Db(b/2,a/2)}function Db(a,b){var c=a*w(b)-b-Ab(a),d=t(c);return b>a+1?1-d*Fb(a,b):d*Eb(a,b)}function Eb(a,b){var c=.5*cb(3),d=a,e=1/a,f=e,g=1;do d+=1,e=e*b/d,f+=e,g+=1;while(e/f>c&&g<=1e4);return g>1e4?z:f}function Fb(a,b){var c,d,e,f,g=cb(3),h=.5*g,i=1/g,j=0,k=1-a,l=b+2-a,m=b+1,n=1,o=l*b,p=b,q=m/o,r=!1;do j+=1,k+=1,c=k*j,l+=2,d=m*l-n*c,e=o*l-p*c,0!==e&&(f=d/e,r=u((q-f)/f)<=h,q=f),n=m,m=d,p=o,o=e,u(d)>i&&(n*=g,m*=g,p*=g,o*=g);while(!r&&j<1e4);return r?q:z}function Gb(a,b){var c,d;if(a<=0)return 0;if(b*a>1391e3)c=t((.5*b-1)*w(.5*a)-.5*a-w(2)-Ab(.5*b));else{for(b%2<.5?(c=.5,d=2):(c=1/v(2*a*r),d=1);d<b;)c*=a/d,d+=2;c=a>=1425?t(w(c)-a/2):c*t(-a/2)}return c}function Hb(a,b,c,d){var e,f,g,h=J(c,a);return M(h)?h:(e=G(h),h=J(d-c,b-a),M(h)?h:(f=G(h),h=J(d,b),M(h)?h:(g=G(h),D(e*f/g))))}function Ib(a,b,c){var d,e,f=ub(b/(b+a*a),b/2,.5);switch(c){case 1:return.5*f;case 2:return f;case 3:return l(1+a*a/b,-(b+1)/2)/(v(b)*xb(!0,.5,b/2));case 4:return d=b/(a*a+b),e=.5*ub(d,.5*b,.5),a<0?e:1-e}return z}function Jb(a,b,c){return{ge:function(d){return a-Ib(d,b,c)}}}function Kb(a,b,c){var d={jl:!1},e=Jb(a,b,c),f=mb(e,.5*b,b,d);return d.jl?A:f}function Lb(a,b){var c=!1,d=0,e,g,h,i,j;for(g=0;g<f(b);g++)for(j=b[g],h=0;h<f(j);h++)if(i=j[h],L(i)||R(i)||S(i))e=S(i)?0:G(i),(!c||a&&e>d||!a&&e<d)&&(d=e),c=!0;else if(M(i))return i;return d}function Mb(a,b,c,d){var e,g,h,i=0,j=0,k=0;for(e=0;e<f(b);e++)g=b[e],g!==V&&(g<c?i++:c<g?k++:j++);return 0===j?A:(h=(0===d?k:i)+1,a?h:h+(j-1)/2)}function Nb(a,b,c){var d,h,i,j,k,l,m,n;for(i=0;i<f(a);i++)for(k=a[i],l=!!k.isArray,m=!!k.isReference,j=0;j<f(k);j++)if(h=k[j],h===g);else if(S(h)){if(e.ExcelCompatibleCalcMode){if(l)continue;if(m){b.n++;continue}}if(n={value:0},e.Convert.Th(h,n))d=n.value,b.ll+=d,b.ml+=d*d;else if(!k.isArray&&!k.isReference)return z;b.n++}else{if(M(h))return h;!L(h)||c&&"boolean"==typeof h&&k.isArray||(d=G(h),b.ll+=d,b.ml+=d*d,b.n++)}}function Ob(a,b,c,d){var e,f={ll:0,ml:0,n:0},g=Nb(a,f,d);return M(g)?g:f.n<=b?y:(e=m(0,(f.n*f.ml-f.ll*f.ll)/(f.n*(f.n-b))),e=c?v(e):e,D(e))}function Pb(a,b,c){var d,e,g,h,i,j=0,k=0,l=0,m=0,n=f(b);if(n!==f(c))return A;for(g=0;g<n;g++)d=b[g],e=c[g],d!==V&&e!==V&&(j+=d,k+=e,m++);if(m<=1)return y;for(h=j/m,i=k/m,g=0;g<n;g++)d=b[g],e=c[g],d!==V&&e!==V&&(l+=(d-h)*(e-i));return D(a?l/m:l/(m-1))}function Qb(a,b){var c,d,e,g,h=a?1:0,i=0;for(e=0;e<f(b);e++)for(c=b[e],g=0;g<f(c);g++)if(d=c[g],d!==V){if(d<=0)return B;h=a?h*d:h+1/d,i++}return a?i<=0?y:D(l(h,1/i)):0===h?y:D(i/h)}function Rb(a,b,c,d,f){var i,j,k,l,m,n,o,p,q,r,s,u,x,y,z,C,D,F,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=b.rowCount,Z=b.colCount;if(a?c=c!==h?E(c,1,!1,!0,!0):b:(i=c!==h?c:function(a,b){var c=[];for(j=0;j<a;j++)for(c[j]=[],k=0;k<b;k++)c[j][k]=j*b+k+1;return new e.CalcArray(c)}(Y,Z),c=E(i,1,!1,!0,!0)),l=c.rowCount,m=c.colCount,Y===l&&Z===m&&(d||!f)){for(p=a?l*m:G(l*m),F=0,H=0,I=0,J=0,K=0,L=void 0,j=0;j<l;j++)for(k=0;k<m;k++)q=c[j][k],r=b[j][k],a&&(r=w(r)),F+=q,H+=q*q,I+=r,J+=r*r,K+=q*r;return z=p*H-F*F,o=d?(p*K-F*I)/z:K/H,L=d?(I*H-F*K)/z:0,a&&(o=t(o),L=t(L)),x=[[o,L]],f&&(x[1]=[],x[2]=[],x[3]=[],x[4]=[],M=p*H-F*F,N=p*J-I*I,O=p*K-F*I,P=J-L*I-o*K,Q=O*O/(M*N),p<3?(x[1][0]=B,x[1][1]=B,x[2][1]=B,x[3][0]=B):(x[1][0]=v(P*p/(M*(p-2))),x[1][1]=v(P*H/(M*(p-2))),x[2][1]=v((N-O*O/M)/(p*(p-2))),x[3][0]=1===Q?B:Q*(p-2)/(1-Q)),x[2][0]=Q,x[3][1]=p-2,x[4][0]=N/p-P,x[4][1]=P),new e.CalcArray(x)}if(1===Z&&Y===l||1===Y&&Z===m){if(r=[],q=[],p=l,o=m,1===Z){for(j=0;j<p;j++)r[j]=b[j][0],a&&(r[j]=w(r[j]));q=c}else{for(j=0;j<o;j++)r[j]=b[0][j],a&&(r[j]=w(r[j]));for(j=0;j<o;j++)for(q[j]=[],k=0;k<p;k++)q[j][k]=c[k][j]}for(R=[],n=0;n<o+1;n++)R[n]=[];for(s=0;s<o+1;s++)for(u=0;u<o+2;u++)R[s][u]=0;for(S=[],s=0;s<o+2;s++)S[s]=0;for(T=f?[]:g,n=0;n<p;n++)for(S[o+1]+=r[n]*r[n],R[0][o+1]+=r[n],S[0]=R[0][o+1],j=0;j<o;j++)for(R[0][j+1]+=q[n][j],R[j+1][0]=R[0][j+1],R[j+1][o+1]+=q[n][j]*r[n],S[j+1]=R[j+1][o+1],k=j;k<o;k++)R[k+1][j+1]+=q[n][j]*q[n][k],R[j+1][k+1]=R[k+1][j+1];if(R[0][0]=p,f){for(s=0;s<o+1;s++)for(T[s]=[],u=0;u<o+1;u++)T[s][u]=0;for(j=0;j<o+1;j++)T[j][j]=1}for(U=d?0:1,j=U;j<o+1;j++){if(0===R[j][j]){for(y=!1,k=j+1;!y&&k<o+1;k++)if(0!==R[k][j]){for(n=0;n<o+2;n++)z=R[j][n],R[j][n]=R[k][n],R[k][n]=z;if(f)for(n=0;n<o+1;n++)z=T[j][n],T[j][n]=T[k][n],T[k][n]=z;y=!0}if(!y)return B}for(C=1/R[j][j],n=U;n<o+2;n++)R[j][n]*=C;if(f)for(n=U;n<o+1;n++)T[j][n]*=C;for(k=U;k<o+1;k++)if(k!==j){for(C=-R[k][j],n=U;n<o+2;n++)R[k][n]+=C*R[j][n];if(f)for(n=U;n<o+1;n++)T[k][n]+=C*T[j][n]}d||(R[0][o+1]=0)}for(x=a?[[],o+1]:[[]],j=0;j<o+1;j++)x[0][j]=a?t(R[o-j][o+1]):R[o-j][o+1];if(f){if(a)x[1]=[],x[2]=[],x[3]=[],x[4]=[];else for(s=1;s<5;s++)for(x[s]=[],u=0;u<o+1;u++)x[s][u]=0;for(V=void 0,W=void 0,X=void 0,W=S[o+1]-S[0]*S[0]/p,V=S[o+1],j=0;j<o+1;j++)V-=R[j][o+1]*S[j];if(X=W-V,x[2][0]=0===W?B:X/W,x[4][0]=X,x[4][1]=V,z=d?p-o-1:p-o,0===z){for(j=0;j<o+1;j++)x[1][j]=B;x[2][1]=B}else{for(D=V/G(z),d||(x[1][o]=A),j=U;j<o+1;j++)x[1][o-j]=v(D*T[j][j]);x[2][1]=v(D)}for(x[3][0]=0===V?B:G(z)*X/(V*G(o)),x[3][1]=G(z),j=2;j<5;j++)for(k=2;k<o+1;k++)x[j][k]=A}return new e.CalcArray(x)}return B}function Sb(a,b){var c,d,e,g,h,i=0,j=0,k=0,l=[];for(e=0;e<f(b);e++)for(h=b[e],l.push(h),g=0;g<f(h);g++)c=h[g],c!==V&&(i+=c,k++);for(d=i/k,e=0;e<f(b);e++)for(h=l[e],g=0;g<f(h);g++)c=h[g],c!==V&&(j+=a?(c-d)*(c-d):u(c-d));return a?D(j):0===k?y:D(j/k)}function Tb(a,b,c,f){b=b!==h?E(b,0,!1,!0,!1):a,c=c!==h?E(c,0,!1,!0,!1):b;var g,i;for(g=0;g<a.rowCount;g++)for(i=0;i<a.colCount;i++)if(!L(a[g][i]))return z;for(g=0;g<b.rowCount;g++)for(i=0;i<b.colCount;i++)if(!L(b[g][i]))return z;for(g=0;g<c.rowCount;g++)for(i=0;i<c.colCount;i++)if(!L(c[g][i]))return z;return d.Common.qc(a,b,c,f,G,e.CalcArray,z,A)}function Ub(a,b,c,f){return b=b!==h?E(b,1,!1,!0,!0):a,c=c!==h?E(c,1,!1,!0,!0):b,d.Common.sc(a,b,c,f,e.CalcArray,B,A)}function Vb(a,b,c){var d,e,g,h,i,j=0,k=0,l=0,m=0,n=f(b),o=0;if(n!==f(c))return A;for(d=0;d<n;d++)e=b[d],g=c[d],e!==V&&g!==V&&(j+=e,k+=g,l+=g*g,m+=g*e,o++);return 0===o?y:o*l-k*k===0?y:(h=(o*m-k*j)/(o*l-k*k),i=j/o-h*(k/o),D(i+h*a))}function Wb(){
return N(arguments,2,1)}function Xb(){return O(arguments,2,7)}function Yb(a,b){return P([a,b],16)}function Zb(){return N(arguments,2,4)}function $b(){return Lb(!0,arguments)}function _b(){return N(arguments,2,5)}function ac(){return Lb(!1,arguments)}function bc(a,b){return P([a,b],14)}function cc(a,b){return P([a,b],15)}function dc(){var a,b,c,d,e=arguments,h=0,i=0;for(a=0;a<f(e);a++)for(d=e[a],b=0;b<f(d);b++)c=d[b],L(c,!0)||R(c)?(h+=G(c),i++):(c===g||S(c))&&i++;return 0===i?y:D(h/i)}function ec(a,b,c,d){var e,g,i,j,k,l,m,n,p,q,r,s,t,u=c,v=d.source&&d.source.Af.dynamicReferences,w=v&&c!==h&&H(c);if(c!==h){if(a=E(a,0,!0,!1,!1),c=E(c,1,!0,!1,!1,!0,h,!0),c.isError)return c[0]}else{if(a=E(a,1,!0,!1,!1,!0,h,!0),a.isError)return a[0];c=a}if(e=0,g=0,i=K(b),a.rowCount!==c.rowCount||a.colCount!==c.colCount)return z;for(n=a.rowCount,w&&(j=u.getRow(0),k=u.getColumn(0),l=d.gkK,m=u.getSource(),w=l&&m.getRangeKey),p=0;p<f(a);p++)if(q=a[p],i&&i(q,!0)&&(r=c[p],w&&(s={id:m.id,row:j+p%n,col:k+o(p/n),rowCount:1,colCount:1},t=m.getRangeKey(m,s),l.nOb||(l.nOb={}),l.nOb[t]=s),r!==V)){if(M(r))return r;e+=r,g++}return 0===g?y:D(e/g)}function fc(a,b,c,d,f){var g,h,i,j=b,k=b,l=a?j.getRowCount():k.getRowCount(0),m=a?j.getColumnCount():k.getColumnCount(0),n=[];for(g=0;g<l;g++)for(n[g]=[],h=0;h<m;h++)i=a?j.getValue(g,h):k.getValue(0,g,h),n[g][h]=ec(c,i,d,f);return new e.CalcArray(n)}function gc(a,b,c,d){return e.Convert.Fh(c)?fc(!1,c,b,d,a):e.Convert.Ca(c)?fc(!0,c,b,d,a):ec(b,c,d,a)}function hc(){return P(arguments,12)}function ic(){return P(arguments,13)}function jc(){return Qb(!0,arguments)}function kc(){return Qb(!1,arguments)}function lc(a,b){var c,d,e,f=0,g=[];for(sb(a,g),c=Za(g),d=k(""+c*b/2),e=d;e<c-d;e++)f+=G(g[e]);return f/(c-2*d)}function mc(a,b){var c,d,f,g,h,i,j,k,l,m,n,o,p=0,q=b.rowCount,r=b.colCount;for(c=0;c<q;c++)for(d=0;d<r;d++)b[c][d]!==V&&p++;for(g=a.rowCount,h=a.colCount,i=[],j=[],k=p+1,p=0,c=0;c<q;c++)for(d=0;d<r;d++)f=b[c][d],f!==V&&(i[p]=G(f),p++);for(l=i.slice(0),rb(i),c=0;c<k;c++)j[c]=[0];for(c=0;c<g;c++)for(d=0;d<h;d++)if(f=a[c][d],L(f)){for(m=G(f),n=!1,o=0;!n&&o<p;o++)m<=i[o]&&(j[l.indexOf(i[o])][0]++,n=!0);n||j[p][0]++}return new e.CalcArray(j)}function nc(a,b,c){var d=e.CalcArrayHelper;if(e.Convert.Fh(a)){if(1!==d.getLength(a))return z;a=d.getValueByIndex(a,0)}return a=G(a),i(a)?z:Mb(!0,b,a,c)}function oc(){var a,b,c,d,e,g,h=arguments,i=0,j=0,k=0,m=0,n=f(h),o=[];if(n>0){for(g=h[0],o.push(g),d=0;d<f(g);d++)a=g[d],a!==V&&(i+=a,j+=a*a,m++);if(m<=3)return y;if(b=i/m,c=v((m*j-i*i)/(m*(m-1))),0===c)return y;for(e=0;e<n;e++)for(g=o[e],d=0;d<f(g);d++)a=g[d],a!==V&&(k+=l((a-b)/c,4));return D(m*(m+1)*k/((m-1)*(m-2)*(m-3))-3*(m-1)*(m-1)/((m-2)*(m-3)))}}function pc(a,b,c){return ab(a,b,c,!0)}function qc(a,b,c){return ab(a,b,c,!1)}function rc(a,b){return P([a,b],17)}function sc(){return N(arguments,2,2)}function tc(){return N(arguments,2,3)}function uc(a){var b,c=0;for(b=0;b<f(a);b++)a[b]!==g&&""!==a[b]||c++;return c}function vc(a,b){var c,d,e=0,h=0===b||"*"===b,i=K(b);for(c=0;c<f(a);c++)d=a[c],h&&d===g||!i||!i(d,!1,!0)||e++;return D(e)}function wc(a,b){var c,d,f,g,h,j,k,l,m;if(b.isArray||b.isReference){for(c=void 0,d=void 0,f=0,g=[],h=b.rowCount,j=b.colCount,k=0;k<h;k++){for(l=[],m=0;m<j;m++,f++)d=vc(a,b[f]),M(d)?l.push(d):(c=G(d),i(c)?l.push(z):l.push(c));g.push(l)}return new e.CalcArray(g)}return vc(a,b[0])}function xc(){return Sb(!1,arguments)}function yc(){return Ob(arguments,1,!0,!0)}function zc(){return O(arguments,2,8)}function Ac(){return Ob(arguments,0,!0,!1)}function Bc(){return O(arguments,2,10)}function Cc(){return Ob(arguments,1,!1,!1)}function Dc(){return O(arguments,2,11)}function Ec(){return Ob(arguments,0,!1,!1)}function Fc(a,b){return Pb(!0,a,b)}function Gc(){return Sb(!0,arguments)}function Hc(a,b,c){var d=xd(a/2);return M(d)?d:-G(d)*(b/v(c))}function Ic(a,b,c){return 1===c?y:b*Kb(a,c-1,2)/v(c)}function Jc(a,b){var c,d,e,g,h=0,i=0,j=0,k=0,l=0,m=f(a);if(m!==f(b))return A;for(g=0;g<m;g++)c=a[g],d=b[g],d!==V&&c!==V&&(h+=c,i+=d,j+=d*d,k+=d*c,l++);return 0===l?y:l*j-i*i===0?y:(e=(l*k-i*h)/(l*j-i*i),D(h/l-e*(i/l)))}function Kc(a,b,c,d){return Rb(!1,a,b,c,d)}function Lc(a,b){var c,d,e,g,h,i=0,j=0,k=0,l=0,m=0,n=f(b);if(n!==f(a))return A;for(c=0;c<n;c++)d=a[c],e=b[c],e===V||d===V||M(e)||M(d)||(g=G(d),h=G(e),i+=g,j+=h,k+=h*h,l+=h*g,m++);return m*k-j*j===0?y:D((m*l-j*i)/(m*k-j*j))}function Mc(a,b,c,d){return Rb(!0,a,b,c,d)}function Nc(a,b){var c,d,e,g,h,i=0,j=0,k=0,l=0,m=0,n=0,o=f(a);if(o!==f(b))return A;for(e=0;e<o;e++)g=a[e],h=b[e],g!==V&&h!==V&&(d=g,c=h,i+=d,j+=d*d,k+=c,l+=c*c,m+=c*d,n++);return n*(n-2)===0||n*l-k*k===0?y:v((n*j-i*i-(n*m-k*i)*(n*m-k*i)/(n*l-k*k))/(n*(n-2)))}function Oc(a){var b,c=a,d=c+5.5;return d-=(c+.5)*w(d),b=1.000000000190015+76.18009172947146/(a+1),b-=86.50532032941678/(a+2),b+=24.01409824083091/(a+3),b-=1.231739572450155/(a+4),b+=.001208650973866179/(a+5),b-=5395239384953e-18/(a+6),w(2.506628274631001*b/c)-d}function Pc(a,b,c,d,e){var f,g,h,i,j,k,l,m;return a<d||e<a||d===e?B:(f=(a-d)/(e-d),g=Oc(b+c),h=Oc(b),i=Oc(c),j=w(f),k=w(1-f),l=t(g-h-i+b*j+c*k),m=f<(b+1)/(b+c+2)?l*bb(b,c,f)/b:1-l*bb(c,b,1-f)/c,D(m))}function Qc(a,b,c,d,e,f){if(a<e||f<a||e===f)return B;var g=(a-e)/(f-e);return d?ub(g,b,c):wb(g,b,c)/(f-e)}function Rc(a,b,c,d,e){var f,g,h,i,j,k,n,o,p,q,r,s,x,y,z,A,B,C,E,F=2.30753,G=.27061,H=.99229,I=.04481,J=3e-308,K=1e-300,L=J,M=1-2.22e-16,N=5,O=6,P=2,Q=jb(b,c);for(a<=.5?(i=a,o=b,q=c,f=0):(i=1-a,o=c,q=b,f=1),r=v(-w(i*i)),A=r-(F+G*r)/(1+(H+I*r)*r),o>1&&q>1?(r=(A*A-3)/6,s=1/(o+o-1),x=1/(q+q-1),n=2/(s+x),z=A*v(n+r)/n-(x-s)*(r+N/O-P/(3*n)),E=o/(o+q*t(z+z))):(r=q+q,x=1/(9*q),x=r*l(1-x+A*v(x),3),x<=0?E=1-t((w((1-i)*q)+Q)/q):(x=(4*o+r-P)/x,E=x<=1?t((w(i*o)+Q)/o):1-P/(x+1))),r=1-o,x=1-q,B=0,j=1,E<L?E=L:E>M&&(E=M),C=m(K,l(10,-13-2.5/(o*o)-.5/(i*i))),y=p=0,g=0;g<1e3;g++){for(A=kb(E,o,q),A=(A-i)*t(Q+r*w(E)+x*w(1-E)),A*B<=0&&(p=m(u(j),J)),k=1,h=0;h<1e3;h++){if(j=k*A,u(j)<p&&(y=E-j,y>=0&&y<=1)){if(p<=C)return 0!==f&&(E=1-E),D((e-d)*E+d);if(u(A)<=C)return 0!==f&&(E=1-E),D((e-d)*E+d);if(0!==y&&1!==y)break}k/=3}if(y===E)return 0!==f&&(E=1-E),D((e-d)*E+d);E=y,B=A}return 0!==f&&(E=1-E),D((e-d)*E+d)}function Sc(a,b,c){var d,e,f,g;if(2*a>b)return Sc(b-a,b,1-c);for(d=0,e=0,f=0,g=1;d<a||e<a||f<b-a;)d<a&&g<1?(d++,g*=(b-a+d)/d):e<a?(e++,g*=c):(f++,g*=1-c);return g}function Tc(a,b,c,d){return d*(b-a)/(a+1)*c/(1-c)}function Uc(a,b,c,d){return d*a/(b-a+1)*(1-c)/c}function Vc(a,b,c,d){var e,f,g,h,i,j,k,l;if(0===c&&d===a)return 1;if(0===b)return 0===c?1:0;if(1===b)return d===a?1:0;if(c===d)return Sc(c,a,b);if(e=Math.floor(a*b),c<=e&&d>=e?(f=e,g=Sc(f,a,b)):(h=Sc(c,a,b),i=Sc(d,a,b),h>i?(f=c,g=h):(f=d,g=i)),0===g)return 0;for(j=g,k=g,l=f;l<d&&(k=Tc(l,a,b,k),0!==k);l++)j+=k;for(k=g,l=f;l>c&&(k=Uc(l,a,b,k),0!==k);l--)j+=k;return j}function Wc(a,b,c,d){return b<a?B:d?Vc(b,c,0,a):Sc(a,b,c)}function Xc(a,b,c){if(a+b-1<=0)return B;var d=J(a+b-1,b-1);return M(d)?d:D(G(d)*l(c,b)*l(1-c,a))}function Yc(a,b,c,d){if(a+b-1<=0)return B;if(d)return 1-ub(1-c,a+1,b);var e=l(c,b),f;for(f=0;f<a;f++)e*=(f+b)/(f+1)*(1-c);return e}function Zc(a,b,c){for(var d,e,f=0,g=a;f+1<g;)d=o((f+g)/2),e=Vc(a,b,0,d),e>=c?g=d:f=d;return g}function $c(a,b){var c,d,e,f,g,h,i=w(v(r)),j=1/v(r),k=0,l=a,m=.5*l,n=b%2===0;if(b>1&&(k=t(-m)),g=Q(-v(l)),M(g))return g;if(h=G(g),d=n?k:2*h,b>2){if(l=.5*(b-1),e=n?1:.5,m>20){for(c=n?0:i,f=w(m);e<=l;)c=w(e)+c,d+=t(f*e-m-c),e+=1;return d}for(c=n?1:j/v(m),f=0;e<=l;)c*=m/e,f+=c,e+=1;return f*k+d}return d}function _c(a,b,c){return c?Cb(a,b):Gb(a,b)}function ad(a,b){var c=od(1-a,.5*b,2);return G(c)}function bd(a,b){return{ge:function(c){return a-Cb(c,b)}}}function cd(a,b){var c=bd(a,b),d={jl:!1},e=mb(c,.5*b,b,d);return d.jl?A:e}function dd(a,b){var c,d,e,g,h=0,i=a.rowCount,j=a.colCount;if(i!==b.rowCount||j!==b.colCount)return A;if(i>1&&j>1)c=(i-1)*(j-1);else if(i>1&&1===j)c=i-1;else{if(!(1===i&&j>1))return A;c=j-1}for(d=0;d<f(a);d++)if(e=a[d],g=b[d],e!==V&&g!==V){if(0===g)return y;h+=(e-g)*(e-g)/g}return h<0?B:$c(h,c)}function ed(a,b){var c,d,g,h,i,j,k,l,m=e.ExcelCompatibleCalcMode?5:1,n=E(a,m,!0,!1,!1,!0),o=E(b,m,!0,!1,!1,!0),p=0,q=0,r=0,s=0,t=0,u=f(o);if(u!==f(n))return A;for(i=0,j=0;j<u;j++){if(k=n[j],l=o[j],M(k))return k;if(M(l))return l;k!==V&&l!==V&&(p+=k,q+=l,r+=k*k,s+=l*l,i++)}if(i<=1)return y;if(c=p/i,d=q/i,g=v((i*r-p*p)/(i*(i-1))),h=v((i*s-q*q)/(i*(i-1))),0===g||0===h)return y;for(j=0;j<u;j++)k=n[j],l=o[j],k!==V&&l!==V&&(t+=(k-c)*(l-d));return D(t/G((i-1)*g*h))}function fd(a,b,c){var d=t(-b*a);return D(c?1-d:b*d)}function gd(a,b,c){var d=b*a/(b*a+c),e=.5*b,f=.5*c,g=Pc(d,e,f,0,1);return M(g)?g:1-G(g)}function hd(a,b,c,d){if(d){var e=ub(c/(c+b*a),c/2,b/2);return 1-e}return l(b/c,b/2)*l(a,b/2-1)/(l(1+a*b/c,(b+c)/2)*xb(!0,b/2,c/2))}function id(a,b,c){var d=1-a,e=Rc(1-d,c/2,b/2,0,1);return M(e)?e:(1/G(e)-1)*(c/b)}function jd(a,b,c){var d=1-a,e=Rc(d,c/2,b/2,0,1);return M(e)?e:(1/G(e)-1)*(c/b)}function kd(a){return w((1+a)/(1-a))/2}function ld(a){var b=t(2*a)-1,c=t(2*a)+1;return!j(b)&&b>0&&!j(c)&&c>0?1:b/c}function md(a,b){var c,d,e,f,g,h,i={N:0,M:0,Q:0,kl:0};return qb(i,a),f=i.N-1,1===i.N?y:(c=i.Q/(i.N-1),0===c?y:(i.N=0,i.M=0,i.Q=0,i.kl=0,qb(i,b),g=i.N-1,1===i.N?y:(d=i.Q/(i.N-1),0===d?y:(h=gd(c/d,f,g),M(h)?h:(e=2*(1-G(h)),e>1&&(e=2-e),e)))))}function nd(a,b,c,d){var e,f,g,h,k,m,o,p,q,r,s,x,z,A,C,D,E,F,H,I,J,K,L,N;if(d===!1)return e=l(c,b),i(e)||!j(e)?y:(f=1/(e*hb(b)),g=l(a,b-1),h=t(-(a/c)),k=g*h,f*k);if(I=1/3,J=1e8,K=1e37,L=1e3,N=-88,a/=c,a<=0)return B;if(b>L)return m=3*v(b)*(l(a/b,I)+1/(9*b)-1),H=vd(m,0,1,!0),M(H)?H:G(H);if(a>J)return 1;if(a<=1||a<b){if(H=pd(b+1),M(H))return H;x=b*w(a)-a-G(H),z=1,F=1,C=b;do C+=1,z=z*a/C,F+=z;while(z>2.220446049250313e-16);x+=w(F),F=0,x>=N&&(F=t(x))}else{if(H=pd(b),M(H))return H;for(x=b*w(a)-a-G(H),C=1-b,D=C+a+1,z=0,m=1,o=a,p=a+1,q=a*D,F=p/q;;){if(C+=1,D+=2,z+=1,E=C*z,r=D*p-E*m,s=D*q-E*o,u(s)>0){if(A=r/s,u(F-A)<=n(2.220446049250313e-16,2.220446049250313e-16*A))break;F=A}m=p,o=q,p=r,q=s,u(r)>=K&&(m/=K,o/=K,p/=K,q/=K)}x+=w(F),F=1,x>=N&&(F=1-t(x))}return F}function od(a,b,c){var d,e,f,g,h,i,j,k,m,n,o,p,q,r,s,x,y,z,A,B=4.67,C=6.66,D=6.73,E=13.32,F=60,H=70,I=84,J=105,K=120,L=127,N=140,O=1175,P=210,Q=252,R=2264,S=294,T=346,V=420,W=462,X=606,Y=672,Z=707,$=735,_=889,aa=932,ba=966,ca=1141,da=1182,ea=1278,fa=1740,ga=2520,ha=5040,ia=5e-7,ja=.01,ka=5e-7,la=20,ma=2e-6,na=.999998;if(a<ma)return 0;if(a>na)return U;if(j=2*b,f=b-1,A=pd(b),M(A))return A;if(h=G(A),j<-1.24*w(a)){if(g=l(a*b*t(h+.6931471805599453*b),1/b),g<ia)return NaN}else if(j>.32){if(A=wd(a,0,1),M(A))return A;y=G(A),i=.222222/j,g=j*l(y*v(i)+1-i,3),g>2.2*j+6&&(g=-2*(w(1-a)-f*w(.5*g)+h))}else{g=.4,d=w(1-a)+h+.6931471805599453*f;do m=g,i=1+g*(B+g),k=g*(D+g*(C+g)),x=-.5+(B+2*g)/i-(D+g*(E+3*g))/k,g-=(1-t(d+.5*g)*k/i)/x;while(u(m/g-1)>ja)}for(z=1;z<=la;z++){if(m=g,i=.5*g,A=nd(i,b,1,!0),M(A))return A;if(k=a-G(A),x=k*t(.6931471805599453*b+h+i-f*w(g)),e=x/g,d=.5*x-e*f,n=(P+d*(N+d*(J+d*(I+d*(H+F*d)))))/V,o=(V+d*($+d*(ba+d*(ca+ea*d))))/ga,p=(P+d*(W+d*(Z+aa*d)))/ga,q=(Q+d*(Y+da*d)+f*(S+d*(_+fa*d)))/ha,r=(I+R*d+f*(O+X*d))/ga,s=(K+f*(T+L*f))/ha,g+=x*(1+.5*x*n-e*f*(n-e*(o-e*(p-e*(q-e*(r-e*s)))))),u(m/g-1)>ka)return.5*c*g}return.5*c*g}function pd(a){return ib(a)}function qd(a,b,c,d){return a>n(b,c)||a<m(0,b-d+c)||b>d||c>d?B:Hb(a,b,c,d)}function rd(a,b,c,d,e){var f,g;if(a>n(b,c)||a<m(0,b-d+c)||b>d||c>d)return B;if(e){for(f=0,g=0;g<=a;g++)f+=Hb(g,b,c,d);return f}return Hb(a,b,c,d)}function sd(a,b,c){return Q((w(a)-b)/c)}function td(a,b,c,d){if(d)return Q((w(a)-b)/c);var e=(w(a)-b)/c;return.3989422804014327*t(-(e*e)/2)/c/a}function ud(a,b,c){var d,e=xd(a);return M(e)?e:(d=G(e),D(t(b+c*d)))}function vd(a,b,c,d){return d?Q((a-b)/c):D(t(-((a-b)*(a-b))/(2*c*c))/(v(2*r)*c))}function wd(a,b,c){var d,e,f,g,h,i=a-.5;if(u(i)<=.42)d=i*i,e=i*(((-25.44106049637*d+41.39119773534)*d-18.61500062529)*d+2.50662823884)/((((3.13082909833*d-21.06224101826)*d+23.08336743743)*d+-8.4735109309)*d+1);else{if(d=a,i>0&&(d=1-a),!(d>2.220446049250313e-16))return d>1e-300?(e=-2*w(a),d=w(6.283185307179586*e),d=d/e+(2-d)/(e*e)+(-14+6*d-d*d)/(2*e*e*e),e=v(e*(1-d)),i<0?-e:e):i<0?-U:U;d=v(-w(d)),e=(((2.32121276858*d+4.85014127135)*d-2.29796479134)*d-2.78718931138)/((1.63706781897*d+3.54388924762)*d+1),i<0&&(e=-e)}return f=(e-0)/1,g=.3989422804014327*t(-.5*f*f)/1,h=vd(e,0,1,!0),M(h)?h:(e-=(h-a)/g,b+c*e)}function xd(a){return wd(a,0,1)}function yd(a,b){return b?lb(a):t(-l(a,2)/2)/v(2*r)}function zd(a,b){var c,d,e,g,h=0,i=0,j=0,k=0,l=0,m=f(a);if(m!==f(b))return A;for(c=0,d=0;d<m;d++)e=a[d],g=b[d],T(e)&&T(g)&&(h+=e,i+=g,j+=e*e,k+=g*g,l+=e*g,c++);return c*j-h*h===0||c*k-i*i===0?y:(c*l-h*i)/v((c*j-h*h)*(c*k-i*i))}function Ad(a,b){var c,d,e,g,h,i=0,j=0,k=0,l=0,m=0,n=0,o=f(b);if(o!==f(a))return A;for(c=0;c<o;c++)d=b[c],e=a[c],T(d)&&T(e)&&(i+=d,j+=e,k+=d*d,l+=e*e,m+=d*e,n++);return g=v((n*k-i*i)*(n*l-j*j)),0===g?y:(h=(n*m-i*j)/g,D(h*h))}function Bd(a,b,c){var d,f=0;if(c)for(d=0;d<=a;d++)f+=t(-b)*l(b,d)/e.Functions.tk(d);else f=t(-b)*l(b,a)/e.Functions.tk(a);return D(f)}function Cd(a,b,c,d){var e,g,j,k,l,m,n=c;if(d!==h&&(n=G(d),i(n)))return z;if(e=0,g=0,j=f(a),j!==f(b))return A;for(k=0;k<j;k++)if(l=a[k],m=b[k],l!==V&&m!==V){if(m<=0||1<m)return B;c<=l&&l<=n&&(e+=m),g+=m}return 1!==g?B:e}function Dd(){var a,b,c,d,e,g,h=arguments,i=0,j=0,k=0,m=0,n=[];for(c=0;c<f(h);c++)for(g=h[c],n.push(g),d=0;d<f(g);d++)e=g[d],e!==V&&(i+=e,j+=e*e,m++);if(m<=2)return y;if(a=i/m,b=v((m*j-i*i)/(m*(m-1))),0===b)return y;for(c=0;c<f(n);c++)for(g=n[c],d=0;d<f(g);d++)e=g[d],e!==V&&(k+=l((e-a)/b,3));return D(m*k/((m-1)*(m-2)))}function Ed(){var a,b,c,d,e,g,h,i,j,k,m=arguments,n=0,o=0,p=[];for(c=0;c<f(m);c++){if(g=m[c],1===f(m)&&0===f(g))return C;for(d=0;d<f(g);d++)e=g[d],h={value:0},e!==V&&"boolean"!=typeof e&&X(e,h)&&(n+=h.value,o++,p.push(h.value))}if(o<=2)return y;for(a=n/o,i=0,j=0,k=0,c=0;c<p.length;c++)k=p[c]-a,j+=l(k,2),i+=l(k,3);return b=v(j/o),0===b?y:D(i/o/b/b/b)}function Fd(a,b,c){return(a-b)/c}function Gd(a,b,c){var d,e,f,g,h,i,j,k,l,m;if(1!==c&&2!==c)return B;if(d=b,e=a/v(d),f=d/(d+a*a),g=d-2,h=d%2,i=1,j=1,d=1,k=2+h,l=k,g>=2)for(m=F(k);m<=g&&(j=j*f*(l-1)/l,i+=j,i!==d);m+=2)d=i,l+=2;return 1!==h?c*(1-(.5+.5*e*v(f)*i)):(1===b&&(i=0),c*(1-(.5+.3183098862*(e*f*i+s(e)))))}function Hd(a,b,c){return Ib(a,b,c?4:3)}function Id(a,b){return Gd(a,b,1)}function Jd(a,b){return Gd(a,b,2)}function Kd(a,b){var c,d,e,f,g,h,i,j,k,m,n,o=1e-12,p=a/2,r=p;if(b>1e20)return xd(p);if(r<.5?(m=0,h=2*r):(m=1,h=2*(1-r)),u(b-2)<o)i=h>0?v(2/(h*(2-h))-2):U;else if(G(b)<1+o)h>0?(g=1.5707963267948966*(h+1),i=-q(g)):i=U;else{if(c=1/(b-.5),d=48/(c*c),e=((20700*c/d-98)*c-16)*c+96.36,f=((94.5/(d+e)-3)/d+1)*v(1.5707963267948966*c)*b,k=l(f*h,2/b),k>.05+c){if(n=xd(.5*h),M(n))return n;j=G(n),k=j*j,b<5&&(e+=.3*(b-4.5)*(j+.6)),e=(((.05*f*j-5)*j-7)*j-2)*j+d+e,k=(((((.4*k+6.3)*k+36)*k+94.5)/e-k-3)/d+1)*j,k=c*k*k,k=k>.002?t(k)-1:.5*k*k+k}else k=((1/(((b+6)/(b*k)-.089*f-.822)*(b+2)*3)+.5/(b+4))*k-1)*(b+1)/(b+2)+1/k;i=v(b*k)}return 0!==m&&(i=-i),D(i)}function Ld(a,b){return a<.5?-Kb(1-a,b,4):Kb(a,b,4)}function Md(a,b,c,d){var e,g,h,k,l,m,n,o,p,q,r,s,t,w,x,z,C,D,E,F,H={N:0,M:0,Q:0,kl:0};if(1!==c&&2!==c)return B;if(1===d){if(q=void 0,r=void 0,s=void 0,t=void 0,w=void 0,x=void 0,z=void 0,f(a)!==f(b))return A;for(C=f(a),z=0;z<C;z++)a[z]=a[z]-b[z];for(t=w=x=q=0,z=0;z<C;z++)D=a[z],r=D-t,s=r/(x+1),t+=s,w+=x*r*s,x++,q+=D;if(x-1===0||0===x)return y;if(k=v(w/(x-1)),i(k)||!j(k))return B;e=q/x,h=e/(k/v(x)),n=x-1}else H.N=0,H.M=0,H.Q=0,H.kl=0,nb(H,a),l=H.Q/(H.N-1),e=H.kl/H.N,o=H.N,H.N=0,H.M=0,H.Q=0,H.kl=0,nb(H,b),m=H.Q/(H.N-1),g=H.kl/H.N,p=H.N,2!==d?(E=l/o/(l/o+m/p),n=1/(E*E/G(o-1)+(1-E)*(1-E)/G(p-1))):n=G(o+p-2),h=(e-g)/v(l/G(o)+m/G(p));return h=u(h),F=pb(.5*n,.5,n/(n+h*h)),M(F)?F:.5*c*G(F)}function Nd(a,b,c,d){var e=t(-l(a/c,b));return D(d?1-e:b/l(c,b)*l(a,b-1)*e)}function Od(a,b,c){var d,e,g,j,k,l,m=0,n=0,o=0,p=0;if(c!==h&&(m=G(c),i(m)))return z;for(j=0;j<f(a);j++)k=a[j],k!==V&&(g=G(k),n+=g,o+=g*g,p++);return 0===p?A:1===p?y:(d=n/p,e=c!==h?m:v((p*o-n*n)/(p*(p-1))),0===e?y:(l=Q((d-b)/(e/v(p))),M(l)?l:D(1-G(l))))}function Pd(a,b){a=G(F(a)),b=G(F(b));var c=1,d;if(a<0||b<0||a<b)return B;for(d=a-b+1;d<=a;d++)c*=d;return D(c)}function Qd(a,b){return Pb(!1,a,b)}function Rd(){var a,b,c,d=0,g=[],h=tb(arguments),i=f(h);for(a=0;a<i;a++){for(b=0,c=a+1;c<i;c++)h[a]===h[c]&&b++;b>d?(d=b,g=[],g.push([h[a]])):b===d&&g.push([h[a]])}return 0===d?A:new e.CalcArray(g)}function Sd(a,b){return P([a,b],18)}function Td(a,b){return P([a,b],19)}function Ud(a,b,c){return a.rowCount>1||a.colCount>1?z:Mb(!1,b,a[0],c)}function Vd(a,b){var c,d=b;return a>=0&&a<2147483647&&d>=0&&d<2147483647&&(a=Math.pow(k(a),k(d)),c=Math.abs(a),c<=1.79769e308)?c>=2.2250738585072014e-308?a:0:B}function Wd(a){var b,c;return""===a?z:(b={value:0},X(a,b)===!0?(a=.3989422804014327*Math.exp(.5*-(b.value*b.value)),c=Math.abs(a),c<=1.79769e308?c>=2.2250738585072014e-308?a:0:B):z)}function Xd(a,b,c,d){var e,f,g,h={value:0};return a=Y(a,h),e={value:0},b=X(b,e),f={value:0},c=Y(c,f),4===arguments.length&&d?(g={value:0},d=Y(d,g)):(d=c,g=f),a===!0&&b===!0&&c===!0&&d===!0?(a=h.value,b=e.value,c=f.value,d=g.value,a>=0&&a<=2147483646&&b>=0&&b<=1&&c>=0&&c<=a&&d>=c&&d<=a?Vc(a,b,c,d):B):z}function Yd(a){var b,c,d;if(a>0)a=Math.exp(ib(a));else{if(b=Math.abs(k(a)),c=a+b,0===c)return B;a=Math.pow(-1,b-1)*Math.exp(ib(-c))*Math.exp(ib(1+c))/Math.exp(ib(b+1-c))}return d=Math.abs(a),d<=1.79769e308?d>=2.2250738585072014e-308?a:0:B}function Zd(a){a=$a(a)-.5;var b=Math.abs(a);return b<=1.79769e308?b>=2.2250738585072014e-308?a:0:B}Z={Hi:7},$={_i:!0,Hi:7},_={Hi:2},aa={Hi:2,aj:"< 1"},ba={Hi:2,aj:"< 0"},ca={Hi:2,aj:["< 1","> 10000000000"]},da={Hi:0},ea={Hi:0,aj:["< 0",">= 1"]},fa={Hi:0,aj:["<= 0",">= 1"]},ga={Hi:0,aj:"<= 0"},ha={_i:0,Hi:0},ia={_i:1,Hi:0},ja={Hi:0,aj:["< 0","> 1"]},ka={Hi:0,aj:"< 0"},la={Hi:0,aj:["< 1","> 10000000000"]},ma={Hi:0,aj:["< 1",">= 10000000000"]},na={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0},oa={Hi:4,Ii:1,Ji:!0,Ki:!0},pa={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0,Xi:!0},qa={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},ra={Hi:4,Ii:1,Ki:!0,Mi:!0},sa={Hi:4,Ii:0,Ji:!0},ta={Hi:4,Ii:1,Ji:!0},ua={Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0},va={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},wa={Hi:4,Ii:0,Ji:!0,Ki:!0,Mi:!0,Xi:!0},xa={Hi:4,Ii:1,Ki:!0,Li:!0},ya={Hi:4,Ii:1,Ji:!0,Ki:!0,qOb:!0,Mi:!0},za=[na,{Hi:2}],Aa=[na,da,{_i:3,Hi:2,aj:"< 1"}],Ba=[fa,ga,aa],Ca=[fa,ga,ga,ha,ia],Da=[ba,ba,ja,Z],Ea=[ba,ja,fa],Fa=[ka,la],Ga=[ja,ca],Ha=[oa,oa],Ia=[ka,ga,Z],Ja=[ka,ma,ma],Ka=[ja,ma,ma],La=[na,na],Ma=[ka,ga,ga,Z],Na=[ja,ga,ga],Oa=[ja,da,ga],Pa=[da,da,ga,Z],Qa=[ta,ta],Ra=[ba,ka,Z],Sa=[ka,aa],Ta=[ua,ua,_,{Hi:2,aj:["< 1","> 3"]}],Ua=[ka,ga,ga,Z],Va=[na,da],Wa=[xa,{},$,{_i:!1,Hi:7}],Xa=[{},na,ha],Ya=[ya,da],W("TREND",Tb,1,4,[{Hi:4,Ii:0,Ki:!0},{},{},$],[0,1,2],[0,1,2],{bk:[1,2,3]}),W("GROWTH",Ub,1,4,[xa,{},{},$],"!= 3","!= 3",{bk:[1,2,3]}),W("FORECAST",Vb,3,3,[da,na,na],"> 0","> 0"),W("AVERAGE",Wb,1,h,h,-1,-1),W("STDEV",Xb,1,h,h,-1,-1),W("STDEV.S",Xb,1,h,h,-1,-1),W("PERCENTILE",Yb,2,2,h,0,0),W("PERCENTILE.INC",Yb,2,2,h,0,0),W("MAX",Zb,1,h,h,-1,-1),W("MAXA",$b,1,h,va,-1,-1),W("MIN",_b,1,h,h,-1,-1),W("MINA",ac,1,h,va,-1,-1),W("LARGE",bc,2,2,Ya,0,0),W("SMALL",cc,2,2,Ya,0,0),W("AVERAGEA",dc,1,h,wa,-1,-1),W("AVERAGEIF",gc,2,3,h,[0,1,2],[0,1,2],{bk:2,FHJ:[2],f_J:!0,dk:!0}),W("MEDIAN",hc,1,h,pa,-1,-1),W("MODE",ic,1,h,pa,-1,-1),W("MODE.SNGL",ic,1,h,pa,-1,-1),W("GEOMEAN",jc,1,h,qa,-1,-1),W("HARMEAN",kc,1,h,pa,-1,-1),W("TRIMMEAN",lc,2,2,[na,ea],0,0),W("FREQUENCY",mc,2,2,[ra,ra],-1,-1),W("RANK",nc,2,3,Xa,[0,1],[0,1],{bk:2}),W("RANK.EQ",nc,2,3,Xa,[0,1],1,{bk:2}),W("KURT",oc,1,h,pa,-1,-1),W("PERCENTRANK",pc,2,3,Aa,0,0,{bk:2}),W("PERCENTRANK.INC",pc,2,3,Aa,0,0,{bk:2}),W("PERCENTRANK.EXC",qc,2,3,Aa,0,0,{bk:2}),W("QUARTILE",rc,2,2,za,0,0),W("QUARTILE.INC",rc,2,2,za,0,0),W("COUNT",sc,1,h,h,-1,-1,{gk:-1}),W("COUNTA",tc,1,h,h,-1,-1,{gk:-1}),W("COUNTBLANK",uc,1,1,sa,-1,-1),W("COUNTIF",wc,2,2,[sa,sa],[0,1],[0,1],{gk:[1]}),W("AVEDEV",xc,1,h,pa,-1,-1),W("STDEVA",yc,1,h,wa,-1,-1),W("STDEVP",zc,1,h,h,-1,-1),W("STDEV.P",zc,1,h,h,-1,-1),W("STDEVPA",Ac,1,h,wa,-1,-1),W("VAR",Bc,1,h,h,-1,-1),W("VAR.S",Bc,1,h,h,-1,-1),W("VARA",Cc,1,h,wa,-1,-1),W("VARP",Dc,1,h,h,-1,-1),W("VAR.P",Dc,1,h,h,-1,-1),W("VARPA",Ec,1,h,wa,-1,-1),W("COVAR",Fc,2,2,Ha,-1,-1),W("COVARIANCE.P",Fc,2,2,Ha,-1,-1),W("DEVSQ",Gc,1,h,pa,-1,-1),W("CONFIDENCE",Hc,3,3,Ba),W("CONFIDENCE.NORM",Hc,3,3,Ba),W("CONFIDENCE.T",Ic,3,3,Ba),W("INTERCEPT",Jc,2,2,[pa,pa],-1,-1),W("LINEST",Kc,1,4,Wa,[0,1],[0,1],{bk:[1,2,3],fk:1}),W("SLOPE",Lc,2,2,[pa,pa],-1,-1,{fk:1}),W("LOGEST",Mc,1,4,Wa,[0,1],[0,1],{bk:[1,2,3]}),W("STEYX",Nc,2,2,Ha,-1,-1),W("BETADIST",Pc,3,5,[da,ga,ga,ha,ia],h,h,{bk:[3,4]}),W("BETA.DIST",Qc,4,6,[da,ga,ga,Z,ha,ia],h,h,{bk:[5,6]}),W("BETAINV",Rc,3,5,Ca,h,h,{bk:[3,4]}),W("BETA.INV",Rc,3,5,Ca,h,h,{bk:[3,4]}),W("BINOMDIST",Wc,4,4,Da),W("BINOM.DIST",Wc,4,4,Da),W("NEGBINOMDIST",Xc,3,3,[_,_,ea]),W("NEGBINOM.DIST",Yc,4,4,[ba,aa,ea,Z]),W("CRITBINOM",Zc,3,3,Ea),W("BINOM.INV",Zc,3,3,Ea),W("CHIDIST",$c,2,2,Fa),W("CHISQ.DIST.RT",$c,2,2,Fa),W("CHISQ.DIST",_c,3,3,[ka,ca,Z]),W("CHIINV",ad,2,2,Ga),W("CHISQ.INV.RT",ad,2,2,[ja,aa]),W("CHISQ.INV",cd,2,2,Ga),W("CHITEST",dd,2,2,Ha,-1,-1),W("CHISQ.TEST",dd,2,2,Ha,-1,-1),W("CORREL",ed,2,2,h,-1,-1),W("EXPONDIST",fd,3,3,Ia),W("EXPON.DIST",fd,3,3,Ia),W("FDIST",gd,3,3,Ja),W("F.DIST",hd,4,4,[ka,la,la,Z]),W("F.DIST.RT",gd,3,3,Ja),W("FINV",id,3,3,Ka),W("F.INV.RT",id,3,3,Ka),W("F.INV",jd,3,3,[ja,ca,ca]),W("FISHER",kd,1,1,{Hi:0,aj:["<= -1",">= 1"]}),W("FISHERINV",ld,1,1,da),W("FTEST",md,2,2,La,-1,-1),W("F.TEST",md,2,2,La,-1,-1),W("GAMMADIST",nd,4,4,Ma),W("GAMMA.DIST",nd,4,4,Ma),W("GAMMAINV",od,3,3,Na),W("GAMMA.INV",od,3,3,Na),W("GAMMALN",pd,1,1,ga),W("GAMMALN.PRECISE",pd,1,1,ga),W("HYPGEOMDIST",qd,4,4,[ba,ba,ba,ba]),W("HYPGEOM.DIST",rd,5,5,[ba,ba,ba,ba,Z]),W("LOGNORMDIST",sd,3,3,[ga,da,ga]),W("LOGNORM.DIST",td,4,4,[ga,da,ga,Z]),W("LOGINV",ud,3,3,Oa),W("LOGNORM.INV",ud,3,3,Oa),W("NORMDIST",vd,4,4,Pa),W("NORM.DIST",vd,4,4,Pa),W("NORMINV",wd,3,3,Oa),W("NORM.INV",wd,3,3,Oa),W("NORMSDIST",Q,1,1,da,h,h),W("NORMSINV",xd,1,1,ja),W("NORM.S.INV",xd,1,1,ja),W("NORM.S.DIST",yd,2,2,[da,Z]),W("PEARSON",zd,2,2,Qa,-1,-1),W("RSQ",Ad,2,2,Qa,[0,1],[0,1]),W("POISSON",Bd,3,3,Ra),W("POISSON.DIST",Bd,3,3,Ra),W("PROB",Cd,3,4,[ua,oa,da],[0,1],[0,1],{bk:3}),W("SKEW",Dd,1,h,pa,-1,-1),W("STANDARDIZE",Fd,3,3,[da,da,ga]),W("TDIST",Gd,3,3,[ka,aa,_]),W("T.DIST",Hd,3,3,[da,aa,Z]),W("T.DIST.RT",Id,2,2,Sa),W("T.DIST.2T",Jd,2,2,Sa),W("TINV",Kd,2,2,Ga),W("T.INV.2T",Kd,2,2,Ga),W("T.INV",Ld,2,2,[{Hi:0,aj:["<= 0","> 1"]},ca]),W("TTEST",Md,4,4,Ta,[0,1],[0,1]),W("T.TEST",Md,4,4,Ta,[0,1],[0,1]),W("WEIBULL",Nd,4,4,Ua),W("WEIBULL.DIST",Nd,4,4,Ua),W("ZTEST",Od,2,3,Va,0,0,{bk:2}),W("Z.TEST",Od,2,3,Va,0,0,{bk:2}),W("PERMUT",Pd,2,2),W("COVARIANCE.S",Qd,2,2,Ha,-1,-1),W("MODE.MULT",Rd,1,h,qa,-1,-1),W("PERCENTILE.EXC",Sd,2,2,[na,fa],0,0),W("QUARTILE.EXC",Td,2,2,[va,_],0,0),W("RANK.AVG",Ud,2,3,[ua,ta,ha],[0,1],1,{bk:2}),W("PERMUTATIONA",Vd,2,2,[da,da]),W("PHI",Wd,1,1),W("BINOM.DIST.RANGE",Xd,3,4,[{_i:0},{_i:0},{_i:0}]),W("GAMMA",Yd,1,1,ga),W("GAUSS",Zd,1,1,da),W("SKEW.P",Ed,1,h,wa,-1,-1)},CalcEngine:function(a,b){a.exports=c("@grapecity/js-calc")},Common:function(a,b){a.exports=c("Common")}}),a.exports=d.Spread.CalcEngine.AdvancedFunctions},"./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js":function(a,b,c){a.exports=c("./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js")},"./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js":function(a,b,c){var d="object"==typeof d?d:{};d.Spread=d.Spread||{},d.Spread.CalcEngine=d.Spread.CalcEngine||{},d.Spread.CalcEngine.BasicFunctions=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./src/basicFunctions.entry.ts")}({"./node_modules/webpack/buildin/global.js":function(a,b){var c;c=function(){return this}();try{c=c||Function("return this")()}catch(a){"object"==typeof window&&(c=window)}a.exports=c},"./src/basicFunctions.entry.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("CalcEngine");b.Functions=d.Functions,c("./src/functions-basic.ts")},"./src/functions-basic.ts":function(a,b,c){"use strict";(function(a){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("CalcEngine"),f=d.Common.q,g=d.Common.u,h=d.Common.l,i=d.Common.CultureManager,j=d.Common.u.Sa,k=h.Ra,l=h.Xb,m=h.Qa,n=h.mb,o=d.Common.k.ac,p=d.Common.j,q=p.Ea,r=p.Fa,s=null,t=void 0,u=isNaN,v=parseFloat,w=parseInt,x=Math.round,y=Math.abs,z=Math.sqrt,A=Math.max,B=Math.min,C=Math.floor,D=Math.exp,E=Math.log,F=Math.PI,G=Math.random,H=Math.pow,I=e.Errors.Null,J=e.Errors.DivideByZero,K=e.Errors.Value,L=e.Errors.Reference,M=e.Errors.Name,N=e.Errors.Calc,O=e.Errors.NotAvailable,P=e.Errors.Number,Q=e.Convert.CalcConvertedError,R=e.Convert.vf,S=e.Convert.Fh,T=e.Convert.Ca,U=e.Convert.Uh,V=e.Convert.Rh,W=e.Convert.Pa,X=e.Convert.bc,Y=e.Convert.Na,Z=e.Convert.Ph,$=e.Convert.Nh,_=e.Zh.tryExtractToSingleValue,aa=e.Functions.ik,ba=e.Functions.Na,ca=h.Ska,da=e.Functions.jk,ea=e.Functions.kk,fa=e.Functions.UAb,ga=e.Functions.VAb,ha=e.Functions.WAb,ia=e.Functions.nk,ja=e.Functions.tk,ka=e.Functions.Ogc,la=e.Functions.mja,ma=e.Functions.sk,na=e.Functions.MathHelper,oa=na.zk,pa=na.wk,qa=e.Functions.ak,ra=e.Convert.Th,sa=e.Convert.Uh,ta=e.Convert.jja,ua=2048,va=1e4,wa=d.Formatter.lxb,xa=21,ya="(&}",za=["qqqq","qqq","qq","q","QQQQ","QQQ","QQ","Q","YYYY","YYY","YY","Y","ww","w"],Aa={1:"1st quarter",2:"2nd quarter",3:"3rd quarter",4:"4th quarter"},Ba=new Date(1900,0,1),Ca=new Date(9999,11,31);function $a(a,b){for(;0!==b;){var c=a%b;a=b,b=c}return a}function _a(a,b,c,d){return 0===b||0===a?0:0!==c&&a<0?d===!0?pa(a/Math.abs(b))*Math.abs(b):oa(a/Math.abs(b))*Math.abs(b):d===!0?oa(a/Math.abs(b))*Math.abs(b):pa(a/Math.abs(b))*Math.abs(b)}function ab(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,p,q,r,s,t=a[0];a[1].HkK=!0,d=Z(a[1],1,2,!1,!1,!0),e=d.rowCount,f=d.colCount,g=[],j=t.source&&t.source.Af,k=j.dynamicReferences,l=k&&t.gkK;function u(b){return b.getRowCount?b.getRowCount()!==a[1].getRowCount()||b.getColumnCount()!==a[1].getColumnCount():b.rowCount!==e||b.colCount!==f}function v(a){var b=a.getSource();return function(c){return{id:b.id,source:b,row:a.getRow(0)+C(c/f),col:a.getColumn(0)+c%f,rowCount:1,colCount:1}}}if(l&&S(a[1])&&!c&&(d.getRef=v(a[1])),n=0,b?(h=[],p=c?function(a){i=d[a],h.push(i)}:function(a){i=d[a],i!==Q&&h.push(i)}):p=function(a){if(i=d[a],i!==Q){if(R(i))return n=i,!0;n+=i}},q=d.getRef?function(a){return Ub(l,d.getRef(a)),p(a)}:p,r=j.g4J,u(a[2]))return K;if(a.length<=3)m=q;else{for(s=4;s<o(a);s+=2){if(u(a[s]))return K;g.push(r.h4J(a[s],a[s+1],!1)),l&&S(a[s])&&(a[s].getRef=v(a[s]))}m=function(b){for(var c=0;c<g.length;c++)if(a[2*c+4].getRef&&Ub(l,a[2*c+4].getRef(b)),!g[c].i4J(b))return;return q(b)}}return r.j4J(a[2],a[3],m),b?b(h):n}function bb(a,b){return b=b<0?C(b):Math.ceil(b),(a&&b%2===0||!a&&b%2!==0)&&(b+=b<0?-1:1),b}function cb(a,b,c){return b>0&&c<0?P:b<0&&c>0?(c=-c,a?pa(b/c)*c:oa(b/c)*c):a?oa(b/c)*c:pa(b/c)*c}function db(a,b,c){var d,e,f,g=na.yk(y(c));return b=c<0?b/g:b*g,d=oa(b),e=pa(b),a&&(f=d,d=e,e=f),b=b<0?d:e,b=c<0?b*g:b/g,$(b)}function eb(a,b,c,d){var e=b?-1:1,f=0,g,h,i;if(o(c)!==o(d))return O;for(i=0;i<o(c);i++)g=c[i],h=d[i],g!==Q&&h!==Q&&(f+=a?(g-h)*(g-h):g*g+e*h*h);return $(f)}function fb(a){return $(y(a))}function gb(a){return a=W(a),isNaN(a)?K:pa(a)}function hb(a,b){var c=1,d;if(a<b)return P;for(b=B(a-b,b),d=1;d<=b;d++)c*=a-d+1,c/=d;return $(c)}function ib(a,b){var c=1,d;for(d=1;d<=b;d++)c*=a+d-1;for(d=2;d<=b;d++)c/=d;return $(c)}function jb(a,b){var c,d,e,f,g,h,i;if(!a||a.length>255)return 0;if(c=a.length,0===c)return 0;if("-"===a[0])return P;for(d=0;d<c&&" "===a[d];)d++;if(e=0,d===c)return 0;for(f=1,g=c-1;g>=d;g--){if(h=a.charCodeAt(g)|" ".charCodeAt(0),i=h-"a".charCodeAt(0)>=0?h-87:h-48,i<0||i>=b)return P;e+=i*f,f*=b}return e}function kb(a){return 180*a/F}function lb(a){return bb(!0,a)}function mb(a){return bb(!1,a)}function nb(a){return ja(a)}function ob(a){var b=1,c;for(c=a;c>1;c-=2)b*=c;return b}function pb(a){return $(E(a))}function qb(a,b){return a-b*C(a/b)}function rb(){return F}function sb(a,b){if(0===a&&b<0)return J;if(0===a&&0===b)return P;var c=e.Functions.MathHelper.iEc(a,b);return c===Number.POSITIVE_INFINITY||c===Number.NEGATIVE_INFINITY||isNaN(c)?P:c}function tb(){var a,b,c,d,e=arguments,f=0;for(a=0;a<o(e);a++){if(b=e[a],c=void 0,d=void 0,R(b))return b;if(S(b)||T(b)){if(c=Z(b,1,!0,!0,!1),c.isError)return c[0]}else c=Z(b,1,!0,!0,!0);for(d=0;d<o(c);d++)c[d]!==Q&&(f+=c[d])}return f}function ub(){var a,b,c,d,f,g;if(!e.ExcelCompatibleCalcMode)return tb.apply(null,arguments);for(a=arguments,b=0,c=0;c<o(a);c++){if(d=a[c],f=void 0,g=void 0,R(d))return d;if(S(d)||T(d)){if(f=Z(d,5,!0,!0,!1,!0),f.isError)return f[0]}else f=Z(d,1,!0,!0,!1,!0);for(g=0;g<o(f);g++)f[g]!==Q&&(b+=f[g])}return b}function vb(a){return 0===a?0:-1}function wb(){var a,b,c,d,e=arguments,f=0;for(a=0;a<o(e);a++)for(c=e[a],b=0;b<o(c);b++){if(d=c[b],d===Q)return K;if(d<0)return P;f=$a(f,V(d))}return f}function xb(){var a,b,c,d,e=arguments,f=1,g=[];for(a=0;a<o(e);a++)for(c=e[a],b=0;b<o(c);b++)if(d=c[b],d!==Q){if(d=V(d),d<0)return P;if(0===d)return 0;g.push(d)}for(b=0;b<o(g);b++)d=g[b],f/=$a(f,d),f*=d;return f}function yb(){return ka(arguments,2,6)}function zb(a){return z(a)}function Ab(a,b){return w(""+a/b)}function Bb(a){var b,c=arguments,d=[];for(b=1;b<o(c);b++)d[b-1]=c[b];return Db(a,0,d)}function Cb(a){var b,c=arguments,d=[];for(b=1;b<o(c);b++)d[b-1]=c[b];return Db(a,1,d)}function Db(a,b,c){var d=K;return q(a,[1,101,2,102,3,103,4,104,5,105,6,106,9,109])>=0?d=ka(c,b,a):q(a,[7,107,8,108,10,110,11,111])>=0&&(d=ma(c,b,a)),d}function Eb(a,b,c){var d,e=arguments,f=[];for(d=3;d<o(e);d++)f[d-3]=e[d];return la(f,c,b,a)}function Fb(a,b){return cb(!0,a,b)}function Gb(a,b){return cb(!1,a,b)}function Hb(a,b,c){return _a(a,b,c,!0)}function Ib(a,b,c){return _a(a,b,c,!1)}function Jb(a,b,c){var d=""+a.toString(b);return c&&d.length<c?Array.apply(null,{length:c-d.length+1}).join(0)+d:d}function Kb(a,b){return a<0&&b>0||b<0&&a>0?P:pa(a/b+.5)*b}function Lb(a,b){return na.Ak(a,b)}function Mb(a,b){return db(!1,a,b)}function Nb(a,b){return db(!0,a,b)}function Ob(a){return $(D(a))}function Pb(a,b){return oa(a/y(b))*y(b)}function Qb(a,b){return pa(a/y(b))*y(b)}function Rb(a,b){return 1===b?J:$(na.Ek(a,b))}function Sb(a){return $(na.Ek(a,10))}function Tb(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,u=a.source&&a.source.Af,v=u&&u.dynamicReferences,w=d!==t&&S(d);return d=d!==t?d:b,e=0,f=T(b),g=T(d),(f?1:b.getRangeCount())!==(g?1:d.getRangeCount())?K:(h=d,d===b||g||(j=f?b.getRowCount():b.getRowCount(0),k=f?b.getColumnCount():b.getColumnCount(0),j===d.getRowCount(0)&&k===d.getColumnCount(0)||(l=d.getRow(0),m=d.getColumn(0),h=d.create([{row:l,col:m,rowCount:j,colCount:k}]),i=!0)),h.HkK=!0,n=h.toArray(1,2,!1),n.isError?n[0]:(w&&(o=h.getRow(0),p=h.getColumn(0),q=a.gkK,r=d.getSource(),w=q&&r.getRangeKey,i&&!v&&w&&Ub(q,{id:r.id,source:r,row:o,col:p,rowCount:j,colCount:k})),s=u.g4J,
s.j4J(b,c,function(a){var b=n[a];b&&b!==Q&&(e+=b),v&&w&&Ub(q,{id:r.id,source:r,row:o+C(a/k),col:p+a%k,rowCount:1,colCount:1})}),$(e)))}function Ub(a,b){var c,d=b&&b.source;d&&d.getRangeKey&&(c=d.getRangeKey(d,b),a.nOb||(a.nOb={}),a.nOb[c]=b)}function Vb(){return ab(arguments)}function Wb(){return ab(arguments,function(a){var b=null;return a.length>0&&(b=Math.max.apply(null,a)),b})}function Xb(){return ab(arguments,function(a){var b=null;return a.length>0&&(b=Math.min.apply(null,a)),b})}function Yb(){var a,b=arguments,c=o(b),d=[b[0],b[1]];for(a=1;a<c;a++)d[a+1]=b[a];return ab(d,function(a){return a.length},!0)}function Zb(a){return ab(arguments,function(a){var b,c,d=0,e=0;for(b=0;b<a.length;b++){if(c=a[b],R(c))return c;d+=c,e++}return 0===e?J:$(d/e)})}function $b(a){for(var b=[],c=0,d=[];c<a;c++)d[c]=0;for(c=0;c<a;c++)b[c]=d.slice(0),b[c][c]=1;return new e.CalcArray(b)}function _b(){var a,b,c,d,e,f,g,h=arguments,i=0,j=[],k=0;for(a=0;a<o(h);a++){if(d=Z(h[a],1,!0,!0,!1,!0),d.isError)return d[0];if(d.isConvertError)return K;if(0===a)b=d.rowCount,c=d.colCount,k=o(d);else if(d.rowCount!==b||d.colCount!==c)return K;j.push(d)}for(a=0;a<k;a++){for(e=1,f=0;f<o(h);f++){if(g=j[f][a],g===Q){if(1===k)return K;e=0;break}e*=g}i+=e}return $(i)}function ac(){var a,b,c,d,e=arguments,f=0;for(b=0;b<o(e);b++)for(d=e[b],c=0;c<o(d);c++)a=d[c],a!==Q&&(f+=a*a);return $(f)}function bc(a,b){return eb(!1,!0,a,b)}function cc(a,b){return eb(!1,!1,a,b)}function dc(a,b){return eb(!0,!1,a,b)}function ec(a,b,c,d){var e,f,g=0;for(e=0;e<o(d);e++){if(f=W(d[e]),u(f))return K;g+=f*H(a,b+e*c)}return $(g)}function fc(a){return $(z(a*F))}function gc(a){return F*a/180}function hc(a){return $(Math.sin(a))}function ic(a){var b=hc(a);return 0===b?J:1/b}function jc(a){return $(Math.cos(a))}function kc(a){var b=jc(a);return 0===b?J:1/b}function lc(a){return $(Math.tan(a))}function mc(a){return 0===a?J:$(1/Math.tan(a))}function nc(a){return $(Math.asin(a))}function oc(a){return $(Math.acos(a))}function pc(a){return $(na.Dk(a,!0))}function qc(a){if(a>709||a<-709)return 0;var b=pc(a);return 0===b?J:1/b}function rc(a){return $(na.Dk(a,!1))}function sc(a){if(a>709||a<-709)return 0;var b=rc(a);return 0===b?J:1/b}function tc(a){return $(E(a+z(a*a+1)))}function uc(a){return $(E(a+z(a*a-1)))}function vc(a){return $(Math.atan(a))}function wc(a){return $(a<0?Math.PI+Math.atan(1/a):Math.atan(1/a))}function xc(a,b){return 0===a&&0===b?J:$(Math.atan2(b,a))}function yc(a){var b=D(a),c=D(-a);return $(b-c)/(b+c)}function zc(a){if(0===a)return J;if(a>10)return 1;if(a<-10)return-1;var b=yc(a);return 1/b}function Ac(a){return $(E((1+a)/(1-a))/2)}function Bc(a){return Ac(1/a)}function Cc(a){var b=a.rowCount,c=1,d,e,f,g,h,i,j,k;if(a.rangeCount>1||b!==a.colCount)return K;for(d=0;d<b-1;d++){if(0===a[d][d]){for(i=!1,e=d+1;!i&&e<b;e++)if(0!==a[e][d]){for(g=d;g<b;g++)j=a[d][g],a[d][g]=a[e][g],a[e][g]=j;c*=-1,i=!0}if(!i)return 0}for(f=d+1;f<b;f++)if(0!==a[f][d])for(k=a[f][d]/a[d][d],h=d;h<b;h++)a[f][h]-=k*a[d][h]}for(d=0;d<b;d++)c*=a[d][d];return c}function Dc(a){var b=a.rowCount,c=[],d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(a.rangeCount>1||b!==a.colCount)return K;for(d=0;d<b;d++)for(c[d]=[b],h=0;h<b;h++)c[d][h]=d===h?1:0;for(f=0;f<b;f++){if(0===a[f][f]){for(t=!1,i=f+1;!t&&i<b;i++)if(0!==a[i][f]){for(k=f;k<b;k++)r=a[f][k],a[f][k]=a[i][k],a[i][k]=r;for(l=1;l<b;l++)s=c[f][l],c[f][l]=c[i][l],c[i][l]=s;t=!0}if(!t)return P}for(j=0;j<b;j++)if(j!==f&&0!==a[j][f]){for(p=a[j][f]/a[f][f],m=f;m<b;m++)a[j][m]-=p*a[f][m];for(n=0;n<b;n++)c[j][n]-=p*c[f][n]}}for(g=0;g<b;g++)for(q=a[g][g],o=0;o<b;o++)c[g][o]/=q;return new e.CalcArray(c)}function Ec(a,b){var c,d,f,g,h,i,j=a.rowCount,k=a.colCount,l=b.rowCount,m=b.colCount,n=[];if(k!==l)return K;for(f=0;f<j;f++)for(n[f]=c=[],d=a[f],g=0;g<m;g++){for(i=0,h=0;h<l;h++)i+=d[h]*b[h][g];c[g]=i}return new e.CalcArray(n)}function Fc(){var a,b,c,d,e=arguments,f=0,g=1;for(b=0;b<o(e);b++)for(a=e[b],c=0;c<o(a);c++){if(d=V(a[c]),d<0||170<d)return P;f+=d,g*=ja(d)}return f<0||170<f?P:ja(f)/g}function Gc(){return y(2*G()-1)}function Hc(a,b){return b<a?P:V(a+G()*(b-a+1))}function Ic(a,b){var c,d,e,f,g,h,i,j,k=["M","D","C","L","X","V","I"],l=[1e3,500,100,50,10,5,1],m=7,n=[];if(c=aa(b)?b?0:4:b,c>4||c<0)return K;for(d=0;d<m;d+=2){if(2<=d&&l[d-2]-l[d]<=a){for(e=d,f=d-2,g=void 0,g=0;g<c&&e+1<m&&l[f]-l[e+1]<=a;g++)e++;n.push(k[e]),n.push(k[f]),a+=l[e],a-=l[f]}if(1<=d&&l[d-1]<=a&&(n.push(k[d-1]),a-=l[d-1]),1<=d&&l[d-1]-l[d]<=a){for(h=d,i=d-1,j=void 0,j=0;j<c&&h+1<m&&l[i]-l[h+1]<=a;j++)h++;n.push(k[h]),n.push(k[i]),a+=l[h],a-=l[i]}for(;l[d]<=a;)n.push(k[d]),a-=l[d]}return n.join("")}function Jc(a){var b,c,d,e,f,g,h,i,j,k;if(!a.length)return 0;if(a.length>255)return K;for(a=a.toLowerCase(),b=0,c=a.length-1,e=0,h=-1;c>=0&&" "===a[c];)c--;for(i=0;i<=c&&" "===a[i];)i++;j=!1,i<=c&&"-"===a[i]&&(j=!0,i++);do{for(d=c,k=a[d],--c;c>=i&&(a[c].charCodeAt(0)|" ".charCodeAt(0))===k.charCodeAt(0);)--c;switch(k){case"i":f=d-c,g=1;break;case"v":f=5*(d-c),g=5;break;case"x":f=10*(d-c),g=10;break;case"l":f=50*(d-c),g=50;break;case"c":f=100*(d-c),g=100;break;case"d":f=500*(d-c),g=500;break;case"m":f=1e3*(d-c),g=1e3;break;default:return K}g>=h?(b+=f-e,h=g,e=0):e+=f}while(c>=i);return 0!==e&&(b-=e),j&&(b=-b),b}function Kc(a,b,c,d){var f,g,h,i,j,k,l;if(void 0===a&&(a=1),void 0===b&&(b=1),void 0===c&&(c=1),void 0===d&&(d=1),f=c,0===a||0===b)return N;if(a<0||b<0)return K;if("string"==typeof c||c instanceof Date){if(g={},!e.Convert.Th(c,g))return K;f=g.value}for(h=[],i=0,j=f;i<a;i++)for(k=[],h.push(k),l=0;l<b;l++)k.push(j),j+=d;return new e.CalcArray(h)}function Lc(a,b,c,d,f){var g,h,i,j,k,l;if(void 0===a&&(a=1),void 0===b&&(b=1),void 0===c&&(c=0),void 0===d&&(d=1),void 0===f&&(f=!1),0===a||0===b)return N;if(a<0||b<0)return K;if(c>d)return K;if(f&&(c!==C(c)||d!==C(d)))return K;for(g=d-c,f&&g++,h=[],i=0;i<a;i++)for(j=[],h.push(j),k=0;k<b;k++)l=c+G()*g,f&&(l=w(l)),j.push(l);return new e.CalcArray(h)}function Mc(a,b){var c,d,f,g,h=!0;for(c=0;c<o(b);c++)for(f=b[c],d=0;d<o(f);d++){if(e.ExcelCompatibleCalcMode){if("string"==typeof f[d]||r(f[d]))continue;h=!1}if(g={value:s},f[d]=ra(f[d],g)?g.value:Q,a){if(!f[d])return!1}else if(f[d]&&f[d]!==Q)return!0}return e.ExcelCompatibleCalcMode&&h?K:!!a}function Nc(){return Mc(!0,arguments)}function Oc(){return Mc(!1,arguments)}function Pc(a){var b,c;return e.ExcelCompatibleCalcMode&&"string"==typeof a?K:(b={},c=e.Convert.Uh(a,b),c?!b.value:K)}function Qc(a,b,c){var d,e,f=a,g=b,h=_(f);return R(a)?a:(d=c!==t?c:2!==o(arguments)&&null,e={},U(h.value,e),e.value?g:d)}function Rc(a,b){return R(a)?r(b)?0:b:a}function Sc(a,b){var c,d,e,f;if(!R(a)&&S(a)){if(a.getRangeCount()>1)return K;if(c=0,d=0,e=this.y0a)if(c=e.row,d=e.col,f=a.yf&&a.yf[0],f&&1===f.rowCount&&1===f.colCount)c=0,d=0;else if(f&&(c+1>f.rowCount||d+1>f.colCount))return b;a=a.getValue(0,c,d)}return Rc(a,b)}function Tc(){return!0}function Uc(){return!1}function Vc(a,b){return ta(a)?b:a}function Wc(){var a,b,c;for(a=0,b=arguments.length;a<b;a+=2){if(c={value:!1},R(arguments[a]))return arguments[a];if(!U(arguments[a],c))return K;if(c.value)return arguments[a+1]}return O}function Xc(){var a,b,c,d,e=arguments;if(e.length<3)return K;if(a=e[0],R(a))return a;for(a===s&&(a=0),b=1,c=e.length-1;b<c;b++){if(d=e[b],b++,R(d))return d;if(d===s&&(d=0),da(a)&&da(d)){if(a.toUpperCase()===d.toUpperCase())return e[b]}else if(a===d)return e[b]}return e.length%2===0?e[e.length-1]:O}function Yc(){var a,b,c,d=0;for(a=0;a<o(arguments);a++)for(c=arguments[a],b=0;b<o(c);b++)c[b]&&d++;return!!(d%2)}function Zc(a,b,c){var d,e,f,g,h=a.source&&a.source.Af&&a.source.Af.lh;if(!h)return N;d=a.localScopes;try{if(a.lambdaFunctionCallDepth++,d.enterScope(),d.saveThenSwitchClosure(b.closure),f=b.parameters,f.length!==c.length)return K;for(g=0;g<f.length;g++)a.localScopes.setVariable(f[g].value,c[g]);e=h.evaluate(b.calculation,a,!1,!1)}finally{a.lambdaFunctionCallDepth--,d.exitScope(),d.restoreClosure()}return e}function $c(a){return!T(a)||1===a.getColumnCount()&&1===a.getRowCount()}function _c(a){return T(a)?a.getValue(0,0):a}function ad(a,b,c){return a[b*a.colCount+c]}function bd(){var a,b,c,d,f,g,h,i,j,k,l,m,n=arguments,p=o(n),q=n[0],r=n[p-1];if(!e.isLambdaFunction(r))return K;for(a=[],b=0,c=0,d=1;d<p-1;d++){if(f=ef(n[d],0),R(f))return f;b=Math.max(b,f.rowCount),c=Math.max(c,f.colCount),a.push(f)}if(r.parameters.length!==a.length)return K;for(g=[],h=0;h<b;h++){for(i=[],j=0;j<c;j++){for(k=[],l=!1,d=0;d<a.length;d++){if(!(h<a[d].rowCount&&j<a[d].colCount)){l=!0;break}k.push(ad(a[d],h,j))}if(l)i.push(O);else{if(m=Zc(q,r,k),m&&m.pause)return m;if(!$c(m))return N;m=_c(m),i.push(m)}}g.push(i)}return new e.CalcArray(g)}function cd(a,b,c,d){var f,g,h,i,j,k;if(c=ef(c,0,!1),R(c))return c;if(!e.isLambdaFunction(d)||2!==d.parameters.length)return K;for(f=c.rowCount,g=c.colCount,h=b,i=0;i<f;i++)for(j=0;j<g;j++)if(k=ad(c,i,j),h=b===s&&0===i&&0===j?k:Zc(a,d,[h,k]),h&&h.pause)return h;return h}function dd(a,b,c,d){var f,g,h,i,j,k,l,m;if(c=ef(c,0,!1),R(c))return c;if(!e.isLambdaFunction(d)||2!==d.parameters.length)return K;for(f=c.rowCount,g=c.colCount,h=[],i=b,j=0;j<f;j++){for(k=[],l=0;l<g;l++){if(m=ad(c,j,l),i=b===s&&0===j&&0===l?m:Zc(a,d,[i,m]),i&&i.pause)return i;if(!$c(i))return N;i=_c(i),k.push(i)}h.push(k)}return new e.CalcArray(h)}function ed(a,b,c,d){var f,g,h,i,j;if(!e.isLambdaFunction(d)||2!==d.parameters.length)return K;if(b<=0||c<=0)return K;for(f=[],g=0;g<b;g++){for(h=[],i=0;i<c;i++){if(j=Zc(a,d,[g+1,i+1]),j&&j.pause)return j;if(!$c(j))return N;j=_c(j),h.push(j)}f.push(h)}return new e.CalcArray(f)}function fd(a,b,c){var d,f,g,h,i,j,k;if(!e.isLambdaFunction(c)||1!==c.parameters.length)return 2===arguments.length?O:K;if(b=ef(b,0,!1),R(b))return b;for(d=b.rowCount,f=b.colCount,g=[],h=0;h<d;h++){for(i=[],j=0;j<f;j++)i.push(ad(b,h,j));if(k=Zc(a,c,[new e.CalcArray([i])]),k&&k.pause)return k;if(!$c(k))return N;k=_c(k),g.push([k])}return new e.CalcArray(g)}function gd(a,b,c){var d,f,g,h,i,j,k;if(!e.isLambdaFunction(c)||1!==c.parameters.length)return 2===arguments.length?O:K;if(b=ef(b,0,!1),R(b))return b;for(d=b.rowCount,f=b.colCount,g=[],h=0;h<f;h++){for(i=[],j=0;j<d;j++)i.push(ad(b,j,h));if(k=Zc(a,c,[new e.CalcArray([i])]),k&&k.pause)return k;if(!$c(k))return N;k=_c(k),g.push(k)}return new e.CalcArray([g])}function hd(a){var b,c=a.getFullYear(),d=a.getMonth(),e=a.getDate(),f=e;for(b=0;b<d;b++)f+=ia(c,b);return f}function id(a){if(da(a)){if(7!==o(a)||u(w(a)))return K}else if(!u(a)){if(C(a)<1||C(a)>17)return P;a=""+a}var b=["1","2","3","4","5","6","7"],c=[0,0,0,0,0,0,0],d;switch(o(a)){case 1:if(q(a,b)>=0){d=w(a),c[(d+4)%7]=1,c[(d+5)%7]=1;break}return P;case 2:if("1"===a[0]&&q(a[1],b)>=0){d=w(a[1]),c[(d+5)%7]=1;break}return P;case 7:for(d=0;d<7;d++)c[d]=w(a[d]);break;default:return K}return c}function jd(a,b,c,d,e){var f,g=Bd(b,3);if(R(g))return g;for(f=V(g);c<0;++c)b.setDate(b.getDate()-1),f=0===f?6:f-1,(a&&(5===f||6===f)||!a&&e[f]||d.indexOf(k(b))>=0)&&c--;for(;c>0;--c)b.setDate(b.getDate()+1),f=6===f?0:f+1,(a&&(5===f||6===f)||!a&&e[f]||d.indexOf(k(b))>=0)&&c++;return k(b)}function kd(a,b,c,d,e,f){var g,h,i,j,k,m,n,p,q;if(f&&(a=a!==t?a:"0000011",h=id(a),R(h)))return h;if(b!==t&&(g=Z(b,4,!0,!0,!1)),!g)return e;if(g.isError)return g[0];for(i=o(g),j=[],k=0;k<i;k++)m=g[k],n=l(m),p=n.getDay(),q=o(h)?h[Bd(n,3)]:6===p||0===p,j.indexOf(m)===-1&&!q&&m>=c&&m<=d&&j.push(m);return e-=o(j)}function ld(a,b,c,d,e,f){var g,h,i,j=V(k(b)),l=V(k(c)),m=!1;return j>l&&(g=b,b=c,c=g,h=j,j=l,l=h,m=!0),i=l-j+1,i=f(b,c,i,d),a&&R(i)?i:i<=0?0:(i=kd(d,e,j,l,i,a),i=m?-i:i)}function md(a,b,c){var d,f;return b=e.Convert.Wh(b),d=new Date(b.getFullYear(),b.getMonth(),1),d.setMonth(d.getMonth()+c),f=ia(d.getFullYear(),d.getMonth()),d.setDate(a?f:B(b.getDate(),f)),d}function nd(a,b,c){a<=1899&&(a+=1900);var d=new Date(a,b-1,c);return d<new Date(1899,11,30)?P:d}function od(a,b,c){var d=l(0);return d.setHours(a),d.setMinutes(b),d.setSeconds(c),d.setMilliseconds(0),d.getHours()<0&&d.getMinutes()<0&&d.getSeconds()<0?P:d}function pd(a){var b,c,d,e;if(da(a)&&(b=m(a),b||(b=new Date(a),b&&!u(b.valueOf())||(b=null))),!b)return K;if(d=b.getFullYear(),e=hd(b),d<1900)return K;for(c=1900;c<d;c++)e+=365,ea(c)&&e++;return e}function qd(a){var b;return da(a)&&(b=m(a)),b?(60*(60*b.getHours()+b.getMinutes())+b.getSeconds())/86400:K}function rd(){return new Date}function sd(){var a=new Date;return a.setHours(0,0,0,0),a}function td(a){if(e.ExcelCompatibleCalcMode){var b=a.getMilliseconds();if(b>500)return new Date(a.getTime()+1e3-b)}return a}function ud(a){return a=td(a),a.getHours()}function vd(a){return a=td(a),a.getMinutes()}function wd(a){return a=td(a),a.getSeconds()}function xd(a){return a=td(a),a.getDate()}function yd(a){return a=td(a),a.getMonth()+1}function zd(a){return a=td(a),a.getFullYear()}function Ad(a,b){var c,d,e;return a=td(a),1===b||17===b||r(b)||2===b||11===b||12===b||13===b||14===b||15===b||16===b?(c=hd(a),d=new Date(a.getFullYear(),0,1).getDay(),2===b?d-=1:11===b||12===b||13===b||14===b||15===b?d=d-b+10:16===b&&(d+=1),d<0&&(d=7+d),e=c-1-(6-d),e<0&&(e=0),7===d&&16===b?V(e/7)+(e%7!==0?1:0):1+V(e/7)+(e%7!==0?1:0)):21===b?Ld(a):P}function Bd(a,b){a=td(a);var c=a.getDay();switch(b){case 1:return c+1;case 2:return 0===c?7:c;case 3:return 0===c?6:c-1;default:return P}}function Cd(a,b){return md(!1,a,b)}function Dd(a,b){return md(!0,a,b)}function Ed(a,b,c){return jd(!0,a,b,c)}function Fd(a,b,c,d){r(c)&&0===b&&(c=1);var e=id(c);return R(e)?e:"1111111"===e.join("")?K:jd(!1,a,b,d,e)}function Gd(a,b,c){function d(a,b,c){var d=V(k(b)-k(a))%7,e=V(Bd(a,2)+d),f=0===a.getDay()?1:2;return d=e>5?e-5:0,d=d>f?f:d,c-=d,c-=2*C(c/7)}return ld(!1,a,b,t,c,d)}function Hd(a,b,c,d){var e,f,g,h,i,j,k;if(d=d!==t?d:"0000011",e=id(d),f=0,g=0,R(e))return e;for(h=0;h<o(e);h++)1===e[h]&&f++;if(c<30){for(h=0;h<c;h++)e[(V(Bd(a,3))+h)%7]&&g++;return c-=g}for(i=c,j=0,k=0,h=0;h<i&&V(Bd(a,3)+h)%7!==0;h++)j++;for(h=0;h<j;h++)e[(V(Bd(a,3))+h)%7]&&g++;for(h=0;h<i&&(V(Bd(b,3))+7-h)%7!==6;h++)k++;for(h=0;h<k;h++)e[(V(Bd(b,3))+7-h)%7]&&g++;return i=i-j-k,c-=V(i/7)*f,c-=g}function Id(a,b,c,d){return ld(!0,a,b,c,d,Hd)}function Jd(a,b,c){var d,f,g;function h(){var a=[];return a[0]=function(a,b){return b.getFullYear()-a.getFullYear()+(b.getMonth()<a.getMonth()||b.getMonth()===a.getMonth()&&b.getDate()<a.getDate()?-1:0)},a[1]=function(a,b){return 12*(b.getFullYear()-a.getFullYear())+(b.getMonth()-a.getMonth())+(b.getDate()<a.getDate()?-1:0)},a[2]=function(a,b){return(b.getTime()-a.getTime())/864e5},a[3]=function(a,b){var c=new Date(b.getFullYear(),b.getMonth()+(b.getDate()<a.getDate()?-1:0),a.getDate());return(b.getTime()-c.getTime())/864e5},a[4]=function(a,b){return b.getMonth()-a.getMonth()+(b.getMonth()<a.getMonth()||b.getMonth()===a.getMonth()&&b.getDate()<a.getDate()?12:0)+(b.getDate()<a.getDate()?-1:0)},a[5]=function(a,b){var c,d=b.getFullYear()+(b.getMonth()<a.getMonth()||b.getMonth()===a.getMonth()&&b.getDate()<a.getDate()?-1:0),e=a.getMonth(),f=a.getDate(),g=ea(a.getFullYear());return 1!==e||29!==f||ea(d)||f--,!g&&1===e&&28===f&&ea(d)&&f++,c=new Date(d,e,f),(b-c)/864e5},a}if(a.setHours(0,0,0,0),b.setHours(0,0,0,0),e.ExcelCompatibleCalcMode&&(a<Ba||b>Ca))return P;if(c=c.toLocaleUpperCase(),d=h(),f=q(c,["Y","M","D","MD","YM","YD"]),b<a)return P;if(f<0)throw e.sR().Exp_NotSupported;return(g=d[f])(a,b)}function Kd(a,b){var c,d,e={value:0};if(!ra(a,e))return K;if(c={value:0},!ra(b,c))return K;d=2958465;function f(a){return a>=0&&a<d+1}return f(e.value)&&f(c.value)?e.value-c.value:P}function Ld(a){var b,c,d;if(isNaN(a))return P;function e(a){var b=new Date(a,0,4),c=b.getDay();return 0===c&&(c=7),b.setDate(b.getDate()+1-c),b}return b=new Date(1900,1,28),a.getTime()<=b.getTime()&&a.setDate(a.getDate()-1),c=a.getFullYear(),1900===c?c+=400:9999===c&&(c-=400),a.setYear(c),a.getTime()<new Date(c,11,29).getTime()&&c--,d=e(c+1),a.getTime()<d.getTime()&&(d=e(c)),w(""+(a.getTime()-d.getTime())/864e5/7)+1}function Md(a){var b,c,d,e=""+a,f="",g=[];if(a<0&&(e=e.substr(1),f="-"),c=e.split("."),d=o(c),d<1||d>2)return K;for(2===d&&(g.push(c[1]),g.push(".")),e=c[0],b=o(e)-3;b>=0;b-=3)g.push(e.substr(b,3)),b>0&&g.push(",");return g.push(e.substring(0,b+3)),g.reverse(),f+g.join("")}function Nd(a,b){var c,d,e,f,g=[],h=o(a);for(c=0;c<h;c++){if(e=a[c],f=o(e),0===f&&"concat"===b)return I;for(d=0;d<f;d++)r(e[d])||g.push(X(e[d]))}return g.join("")}function Od(a,b,c){var d,e,f=[],g=0;for(d=0;d<b.length;d++)e=fa(b[d]),"fourByte"===e?0===g?g++:(g=0,f.push(b[d-1]+b[d])):f.push(b[d]);return c>=f.length?b:f.splice(a?0:f.length-c,c).join("")}function Pd(a){var b=[],c,d;for(c=0;c<o(a);c++)d=a.charCodeAt(c),0<=d&&d<=31||127===d||128<=d&&d<=159||b.push(a[c]);return b.join("")}function Qd(a){var b,c,d,e,f;for(a=a.trim(),b=[],c=!0,d=0;d<o(a);d++)e=a.charAt(d),f=" "===e||"\t"===e||"\n"===e,f&&!c||b.push(e),c=!f;return b.join("")}function Rd(a,b){function c(a){var b=Md(a),c=[];return a<0&&(b=b.substr(1)),c.push("$"),c.push(b),a<0&&(c.push(")"),c.unshift("(")),c.join("")}return a=W(Lb(a,b)),c(a)}function Sd(a,b,c){var d,e,f,g,h,i=0;if(b<0&&(i=V(H(10,y(b))),a/=i),a=W(Lb(a,A(0,b))),b<0&&(a*=i),d=c?""+a:Md(a),b>0)if(e=d.indexOf("."),e===-1)for(d+=".",f=0;f<b;f++)d+="0";else for(g=d.length-(e+1),h=g;h<b;h++)d+="0";return d}function Td(a,b){var c,e;if(""===b)return X(a);r(a)&&(a=0),"string"==typeof a&&(a=a.trim());try{return c=d.Formatter&&d.Formatter.GeneralFormatter,c?(e=new c(b),e.format(a)):""+a}catch(a){return K}}function Ud(a){if(!a)return 0;if("boolean"==typeof a)return K;if(a instanceof Date&&(a=""+h.Ra(a)),"string"!=typeof a)return a;var b=m(a),c;return r(b)?Vd(a):(c=k(b),R(c)?qd(b):c)}function Vd(a){var b,c,f,g,h,i,j,k=d.Common.CultureManager.q4().NumberFormat;if(a=a.trim(),"$"!==a[0]&&a[0]!==k.currencySymbol||(a=a.substring(1)),b=v(a),u(b))return K;for("-"===a[0]&&"."===a[1]&&(a=a.replace(a[1],"0.")),"."===a[0]&&(a="0"+a),c=a.length,f=0,h=0,i=0,j=[];f<c;f++){for(g=a[f];f<c&&e.isDigit(g.charCodeAt(0));)j.push(g),f++,g=a[f];if(f===c){if(h&&f-h<=3)return K;break}if(g===k.numberGroupSeparator){if(i||h&&f-h<=3)return K;h=f}else if(g===k.numberDecimalSeparator){if(i||h&&f-h<=3)return K;j.push("."),i=f}else j.push(g)}return W(j.join(""))}function Wd(a){return a.toLowerCase()}function Xd(a){return a.toUpperCase()}function Yd(a){var b,c,d,f=o(a),g=[];if(f>0)for(b=a.toUpperCase(),c=a.toLowerCase(),d=1,g[0]=b[0];d<f;)g[d]=e.ei(a[d-1])?c[d]:b[d],d++;return g.join("")}function Zd(a){return String.fromCharCode(a)}function $d(a){return a[0].charCodeAt(0)}function _d(a,b,c,d){var e,f,g=o(a);return b=B(b,g+1),c=B(c||0,g-b+1),e=a.substring(0,b-1),f=a.substr(b-1+c),e.concat(d).concat(f)}function ae(a,b,c,d){var f,g,h,i,j,k,l,m;if(qe()||e.usedbcs){for(f=[],g=void 0,h=0,i=0;i<a.length;i++)g=a[i],j=fa(a[i]),"doubleByte"===j&&(h++,g=a[i]),f[i+h]=g;return k=f.length,b=B(b,k+1),c=B(c||0,k-b+1),r(f[b-1])?(f[b-1]=" ",f[b]=" "):r(f[b-2])&&b>=2&&(f[b-2]=" ",f[b-1]=" "),l=f.slice(0,b-1).join(""),m=f.slice(b-1+c).join(""),l.concat(d).concat(m)}return _d(a,b,c,d)}function be(a,b,c,d){var e,f,h,i,j,k,l=o(b);if(o(arguments)>3){if(f=V(d),h=0,i=void 0,f<1)return K;for(i=0;i<f;i++){if(h=a.indexOf(b,h),h===-1)return a;h+=l}j=a.substring(0,h-l),k=a.substr(h),e=j.concat(c).concat(k)}else e=g.yb(a,b,c);return e}function ce(){return Nd(arguments,"concatenate")}function de(){return Nd(arguments,"concat")}function ee(a,b){var c,d,e,f,g,h,i;if(a.isReference&&0===a.length)return I;if(c={value:!1},d=!!r(b[0])||b[0],!sa(d,c))return K;for(d=c.value,e=arguments,f=[],g=[],h=o(e),i=2;i<h;i++)fe(f,e[i],d);return fe(g,e[0],!1),ge(f,g)}function fe(a,b,c){var d,e=o(b);if(0===e)return I;for(d=0;d<e;d++)r(b[d])||""===b[d]?c||a.push(""):a.push(X(b[d]))}function ge(a,b){if(0===a.length)return"";if(1===b.length)return a.join(b[0]);for(var c=a[0],d=1,e=0;d<a.length;d++,e++)e===b.length&&(e=0),c+=b[e]+a[d];return c}function he(a,b){return Od(!0,a,b)}function ie(a,b){return Od(!1,a,b)}function je(a,b,c){var d,f,g,h,i,j,k,l,m;if(qe()||e.usedbcs){for(d=[],f=void 0,g=0,h=void 0,i=0,h=0;h<b.length;h++)if(f=b[h],j=fa(b[h]),"fourByte"===j){if(g%2===0){g++;continue}g++,f=b[h-1]+b[h],d[d.length]=f}else"doubleByte"===j&&(i++,f=b[h]),k=g>0?g/2:0,d[h-k+i]=f;return a||(d=ha(d)),l=d.length,c>=l?b:(m=void 0,a?(m=d.slice(0,c-1<0?0:c),m.length>0&&r(m[m.length-1])&&(m[m.length-1]="\u200b")):(m=d.slice(l-c),m.length>0&&r(m[0])&&(m[0]="\u200b")),m.join(""))}return Od(a,b,c)}function ke(a,b){return je(!0,a,b)}function le(a,b){return je(!1,a,b)}function me(a,b,c){b--;var d=o(a);return b>=d?"":d<b+c?a.substr(b):a.substr(b,c)}function ne(a,b,c){var d,f,g;return qe()||e.usedbcs?(d=ga(a),f=d.length,b--,b<0?K:b>=f?"":f<b+c?d.slice(b).join(""):(g=d.slice(b,b+c),"singleByte"!==fa(g[g.length-1])&&(g[g.length-1]="\u200b",r(g[0])&&(g[g.length]="\u200b")),g.join(""))):me(a,b,c)}function oe(a,b){var c=[],d;if(b<0||b*o(a)>32767)return K;for(d=0;d<b;d++)c.push(a);return c.join("")}function pe(a){return a?a.length:0}function qe(){var a=d.Common.CultureManager.q4();return!!a.isJCKCulture}function re(a){var b,c,f,g;if(!a)return 0;if(qe()||e.usedbcs){for(b=0,c=0;c<a.length;c++)if(8203!==a[c].charCodeAt(0)&&(f=fa(a[c]),g=d.Common.CultureManager.q4(),"doubleByte"===f&&9390!==a[c].charCodeAt(0))){if("ja-jp"===(g&&g.name().toLocaleLowerCase())&&(711===a[c].charCodeAt(0)||9356===a[c].charCodeAt(0)||8212===a[c].charCodeAt(0)))continue;b++}return a.length+b}return a.length}function se(a,b,c){if(c<1||o(b)<c)return K;var d=b.indexOf(a,c-1);return d===-1?K:d+1}function te(a,b,c){var d,f,g,h,i,j;return qe()||e.usedbcs?(d=ga(b),f=ga(a),g=d.length,c<1||g<c?K:(h=ve(d),i=ve(f),j=h.indexOf(i,c-1),j===-1?K:j+1)):se(a,b,c)}function ue(a,b,c){var d=-1,e,g;return e=f.ub(a),e?(g=f.sb(e).exec(b),d=r(g)?-1:g.index):d=b.toLowerCase().indexOf(a.toLowerCase(),c-1),d===-1?K:d+1}function ve(a){for(var b=0;b<a.length;b++)r(a[b])&&a[b-1]&&2!==a[b-1].length&&(a[b]="\u200b");return a.join("")}function we(a){for(var b=0;b<a.length;b++)r(a[b])&&(a[b]="\u200b");return a}function xe(a,b,c){var d,f,g,h;return qe()||e.usedbcs?(d=ga(b),f=ga(a),g=d.length,c<1||g<c?K:(h=ue(ve(f),ve(d),c),h===K?K:h)):ue(a,b,c)}function ye(a,b){return a===b}function ze(a){return da(a)?a:""}function Ae(a){if(a){var b=a;return b<=0||b>1114111?K:b>=55296&&b<=57343?O:b<1048576?String.fromCharCode(b):(b-=1048576,String.fromCharCode((b>>10)+55296,(1023&b)+56320))}return K}function Be(a){var b,c,d=X(a);return""===d||null===d?K:(b=d.charCodeAt(0),b>=55296&&b<=56319?1===d.length?K:(c=d.charCodeAt(1),c>=56320&&c<=57343?b|c<<8:1):b>=56320&&b<=57343?b-53248+53248:b)}function Ce(a){var b,c;function d(a){var b,c,d,e,f=["\u0e25\u0e49\u0e32\u0e19","\u0e2a\u0e34\u0e1a","\u0e23\u0e49\u0e2d\u0e22","\u0e1e\u0e31\u0e19","\u0e2b\u0e21\u0e37\u0e48\u0e19","\u0e41\u0e2a\u0e19",""],g=["\u0e28\u0e39\u0e19\u0e22\u0e4c","\u0e2b\u0e19\u0e36\u0e48\u0e07","\u0e2a\u0e2d\u0e07","\u0e2a\u0e32\u0e21","\u0e2a\u0e35\u0e48","\u0e2b\u0e49\u0e32","\u0e2b\u0e01","\u0e40\u0e08\u0e47\u0e14","\u0e41\u0e1b\u0e14","\u0e40\u0e01\u0e49\u0e32"],h=["\u0e25\u0e1a","\u0e1a\u0e32\u0e17","\u0e16\u0e49\u0e27\u0e19","\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c","\u0e22\u0e35\u0e48","\u0e40\u0e2d\u0e47\u0e14",","," ","\u0e3f"],i="",j=a+"",k=j.length;for(b=k;b>0;--b){if(c=w(j[k-b]),d=g[c],e=1<b?(b-1)%6:6,1===e&&2===c&&(d=h[4]),1===c)switch(e){case 0:case 6:i+=b<k?h[5]:d;break;case 1:break;default:i+=d}else{if(0===c){0===e&&(i+=f[e]);continue}i+=d}i+=f[e]}return i}return a?(b=Math.abs(w(a)),c=parseFloat((Math.abs(a)-b).toFixed(2)),0!==b?0===c?(a<0?"\u0e25\u0e1a":"")+d(b)+"\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19":(a<0?"\u0e25\u0e1a":"")+d(b)+"\u0e1a\u0e32\u0e17"+d(100*c)+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c":0!==c?(a<0?"\u0e25\u0e1a":"")+d(100*c)+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c":"\u0e28\u0e39\u0e19\u0e22\u0e4c\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19"):K}function De(a,b,c,d,e){var f,g=function(c,d){var e,f,g=-1,h=-1;for(e=0;e<b.length;e++)f=c?a.indexOf(b[e],d):a.lastIndexOf(b[e],d),f===-1||g!==-1&&!(c?f<g:f>g)||(g=f,h=e);return{index:g,delimiterIndex:h}};if(1===d&&(a=a.toLocaleLowerCase(),b=b.map(function(a){return a.toLocaleLowerCase()})),c>0){for(f=g(!0),c--;f.index!==-1&&c>0;)f=g(!0,f.index+1),c--;if(1===e&&f.index===-1&&0===c)return{index:a.length,delimiterIndex:-1,isMatchEnd:!0}}else{for(f=g(!1),c++;f.index!==-1&&c<0;)f=g(!1,f.index-1),c++;if(1===e&&f.index===-1&&0===c)return{index:-1,delimiterIndex:-1,isMatchEnd:!0}}return{isMatchEnd:!1,index:f.index,delimiterIndex:f.delimiterIndex}}function Ee(a,b,c,d,e,f){var g,h,i,j,k=a.length;return r(b)||0===b.length?O:b.some(function(a){return a.length>k})?O:b.some(function(a){return 0===a.length})?c>0?a:"":c>k?K:(g=De(a,b,c,d,e),h=g.index,i=g.delimiterIndex,j=g.isMatchEnd,j?h===-1?a:"":h!==-1?a.substring(h+b[i].length):r(f)?O:f)}function Fe(a,b,c,d,e,f){var g,h,i,j=a.length;return r(b)||0===b.length?O:b.some(function(a){return a.length>j})?O:b.some(function(a){return 0===a.length})?c>0?"":a:c>j?K:(g=De(a,b,c,d,e),h=g.index,i=g.isMatchEnd,i?h===-1?"":a:h!==-1?a.substring(0,h):r(f)?O:f)}function Ge(a,b,c){return"function"==typeof a.replaceAll?a.replaceAll(b,c):a.replace(RegExp(f.Ab(b),"g"),c)}function He(a,b,c){var d,e,f;if(r(b))return[a];if(d=b[0],b.length>1)for(e=1;e<b.length;e++)a=Ge(a,b[e],d);return f=a.split(d),c&&(f=f.filter(function(a){return a.length>0})),f}function Ie(a,b,c,d,f,g){var h,i,j;return 0===a.length||r(b)&&r(c)||b&&(0===b.length||b.some(function(a){return 0===a.length}))||c&&(0===c.length||c.some(function(a){return 0===a.length}))?K:(1===f&&(a=a.toLowerCase(),c&&(c=c.map(function(a){return a.toLowerCase()})),b&&(b=b.map(function(a){return a.toLowerCase()}))),h=He(a,c,d),i=h.map(function(a){return He(a,b,d)}),i=i.filter(function(a){return a.length>0}),j=A.apply(null,i.map(function(a){return a.length})),g=r(g)?O:g,i.forEach(function(a){for(var b=j-a.length;b>0;)a.push(g),b--}),new e.CalcArray(i))}function Je(a){return R(a)}function Ke(a){return!!R(a)&&a._code!==O._code}function Le(a){return!!R(a)&&a._code===O._code}function Me(a){if(!r(a)&&R(a)){var b=q(a._code,[I._code,J._code,K._code,L._code,M._code,P._code,O._code]);if(b>=0)return b+1}return O}function Ne(a){return Y(a,e.ExcelCompatibleCalcMode)}function Oe(a){return pa(y(a))%2===0}function Pe(a){return pa(y(a))%2!==0}function Qe(a){return ba(a)||ca(a)?W(a):aa(a)?a?1:0:R(a)?a:0}function Re(a){return r(a)}function Se(a){return aa(a)}function Te(a){return da(a)}function Ue(a){return!da(a)}function Ve(a){return S(a)}function We(a){return aa(a)?4:ba(a)||ca(a)?1:da(a)?2:R(a)?16:T(a)?64:e.isLambdaFunction(a)?128:K}function Xe(){return O}function Ye(a,b){var c,d,f=0,g=a.source.kj;if(T(b))return O;if(b instanceof e.CalcReference||r(b))return c=b,d=c&&(c.xf||c.references[0].xf)||a.source,g.parent.getSheetIndex(d.kj.name())+1;if(Y(b)||da(b))for(f;f<g.parent.sheets.length;f++)if(b.toUpperCase()===g.parent.sheets[f].name().toUpperCase())return f+1;return O}function Ze(a,b){var c,d,f,g=a.source.kj;return r(b)?g.parent.sheets.length:T(b)||Y(b)?O:da(b)?K:b instanceof e.CalcReference?(c=b,(d=c.references)?d.length:(f=c.xf||a.source,g.parent.getSheetIndex(f.kj.name())+1)):O}function $e(){var a=new e.Functions.AsyncFunction("REFRESH",1,3);a.evaluate=_e,e.Functions.bi.REFRESH=a}function _e(a,b){return b}function af(a){return a>=55296&&a<=57343}function bf(a,b){return!(a<55296||a>56319)&&(b>=56320&&b<=57343)}function cf(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==a)return a;try{return Function("return this")}catch(a){}}function df(a){var b,c,d,e,f,g,h=cf();if(h&&h.encodeURIComponent)return encodeURIComponent(a).replace(/[!~'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()});if(b="",c=a.length-1,c<0)return"";for(d=0;d<=c;d++)if(e=a.charCodeAt(d),e>="A".charCodeAt(0)&&e<="Z".charCodeAt(0)||e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)||e>="a".charCodeAt(0)&&e<="z".charCodeAt(0)||e==="-".charCodeAt(0)||e==="_".charCodeAt(0)||e===".".charCodeAt(0))b+=a[d];else{if(f=void 0,af(e)){if(c===d||!bf(e,a.charCodeAt(d+1)))return null;f=[e,a.charCodeAt(d+1)],d++}else f=[e];for(g=0;g<f.length;g++)b+="%",b+=f[g].toString(16).toUpperCase()}return b}function ef(a,b,c){void 0===c&&(c=!0);var d;return a!==s||c?R(a)?O:d=T(a)?Z(a,b,!0,!0,!1):Z(a,b,!0,!0,!0):K}function ff(a){var b,c,d,e,f,g,h,i,j,k,l,m=[];for(b=1;b<arguments.length;b++)m[b-1]=arguments[b];if(c=m[0],d=m[1],e=[],f=[],g=d&&d.getSource()&&d.getSource().getSheet()||a.source&&a.source.kj,h=g&&g.pivotTables&&d&&g.pivotTables.findPivotTable(d.getRow(),d.getColumn()),r(h))return L;for(i=2;i<m.length;i+=2)j=m[i],k=m[i+1],S(j)&&(j=j.getValueByIndex(0)),l={fieldName:j,itemName:k},S(k)||T(k)?f.push(l):e.push(l);return S(c)&&(c=c.getValueByIndex(0)),f.length>0?gf(c,h,e,f):h.evaluateGetPivotDataFunction(c,e)}function gf(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=1,z=1,A=[],B=[],C=[];for(f=0,g=d;f<g.length;f++){if(h=g[f],i=h.fieldName,j=h.itemName,R(j))return j;if((S(j)||T(j))&&(h.itemName=Z(j,0,!1,!1,!1),h.itemName.isError))return h.itemName[0];k=b.getField(i),l=k.pivotArea,m=h.itemName.rowCount,n=h.itemName.colCount,y=y>m?y:m,z=z>n?z:n,m>n||m===n&&1===l?A.push(h):(n>m||m===n&&2===l)&&B.push(h)}for(o=0;o<y;o++){for(p=[],q=0;q<z;q++){for(r=[],s=0,t=A;s<t.length;s++)u=t[s],u.itemName.colCount>1?r.push({fieldName:u.fieldName,itemName:u.itemName[o]&&u.itemName[o][q]}):r.push({fieldName:u.fieldName,itemName:u.itemName[o]&&u.itemName[o][0]});for(v=0,w=B;v<w.length;v++)x=w[v],x.itemName.rowCount>1?r.push({fieldName:x.fieldName,itemName:x.itemName[o]&&x.itemName[o][q]}):r.push({fieldName:x.fieldName,itemName:x.itemName[0]&&x.itemName[0][q]});p.push(b.evaluateGetPivotDataFunction(a,c.concat(r)))}C.push(p)}return new e.CalcArray(C)}function hf(){var a,b,c,d,f,g,h,i,j,k,l,m,n,p,q,s,t,u=arguments,v=o(u);if(v<2||v%2!==0)return O;for(b=0;b<v;b+=2){if(f=u[b],g=u[b+1],h=ef(f,2),i=ef(g,0),R(h))return h;if(R(i))return i;if(h.isError||i.isError)return O;if(j=h.length,k=i.length,r(d))d=k;else if(d!==k)return O;if(j>k)return O;if(j<k){if(c===!1||j>1)return O;for(r(a)&&(a=[]),l=i.rowCount,m=i.colCount,n=h[0],p=0;p<l;p++){for(q=a[p],r(q)&&(q=a[p]=[]),s=0;s<m;s++)r(q[s])&&(q[s]={}),q[s][n]=i[s+p*m];a[p]=q}c=!0}else{if(c===!0)return O;for(r(a)&&(a={}),t=0;t<k;t++)a[h[t]]=i[t];c=!1}}return c?new e.CalcArray(a):a}function jf(){var a,b=arguments,c=b[0],d=b[1].split(".");function e(a){var b,c=d.length;for(b=0;b<c;b++)if(a=a[d[b]],r(a))return O;return a}return a=c,r(c)||"object"!=typeof c?O:(T(c)?a.array=a.array.map(function(a){return Array.isArray(a)?a.map(function(a){return e(a)}):e(a)}):a=e(a),a)}function kf(a){var b,c,d,f,g;try{if(b=a&&JSON.parse(a),Array.isArray(b)&&b.length>0){for(c=!0,d=0;d<b.length;d++)if(!Array.isArray(b[d])){c=!1;break}if(c)b=new e.CalcArray(b);else{for(f=[],g=0;g<b.length;g++)f.push([b[g]]);b=new e.CalcArray(f)}}return b}catch(a){return K}}function lf(a){return nf(a,"AaK9#@BXHN\uff27S")}function mf(a){return nf(a,"\uff21\uff41\uff2b\uff19\uff03\uff20\uff22\uff38\uff3a\uff2e\uff33")}function nf(a,b){var c,d,f,g="";if(a&&(c=typeof a),"number"===c||"boolean"===c)g=a+"";else if(a instanceof Date)g=""+h.Ra(a);else{if("object"===c)return K;"string"===c&&(g=a)}return d=new e.KPJ((!0),b),f=d.checkText(g),f.CheckedText}function of(){var a=new e.Functions.AsyncFunction("WEBSERVICE",1,1);a.defaultValue=function(){return""},a.evaluate=pf,e.Functions.bi.WEBSERVICE=a}function pf(a,b){var c,d,e,f=b;if(!f||f.length>ua)return K;if(c=null,XMLHttpRequest&&(c=new XMLHttpRequest),d=function(b){a.setAsyncResult(b)},e=["application/json","application/xml","application/x-java-applet","application/java-archive","application/javascript","video/vnd.dlna.mpeg-tts"],null===c)return K;try{c.open("GET",f,!0),c.onreadystatechange=function(){var a,b,f;4===c.readyState&&(200===c.status?(a=c.response,b=a&&a.type,!b||b.indexOf("text")===-1&&e.indexOf(b)===-1?d(K):(f=new FileReader,f.onloadend=function(){d(f.result)},f.onerror=function(){d(K)},f.readAsText(a))):d(K))},c.onerror=function(){d(K)},c.timeout=va,c.ontimeout=function(){d(K)},c.responseType="blob",c.send(null)}catch(a){return K}}function qf(a){
return""===a||r(a)}function rf(a){return wa.Lc(a)||wa.Lc(a,za)}function sf(a){var b,c,d,e="",f=!1;for(b=0,c=a.length;b<c;b++)d=a[b],'"'===d?f=!f:f||"Y"!==d||(d=ya),e+=d;return e}function tf(a){return a.split(ya).join("y")}function uf(a){return a.formatters[0].Rd}function vf(a){return a.Ic&&a.Ic.cultureInfo()||i.q4(a.cultureName)||i.q4()}function wf(a,b,c,d){return d=uf(d),Df(a,b,c,vf(d),d.wOb)}function xf(){return/qqqq|qqq|qq|q|QQQQ|QQQ|QQ|Q|yyyy|yyy|yy|y|ww|w/g}function yf(a,b,c){if(!a)return[b.slice(c),c];var d=a.index,e=a[0].length,f=d+e;return c<d?[b.slice(c,d),f]:c===d?["",f]:["",c]}function zf(a){return Nb(yd(a)/3,0)}function Af(a,b){return Ad(a,r(b)?b:V(b))}function Bf(a){var b=new Date(a.getTime()),c=(b.getDay()+6)%7,d=b.getDate()-c,e=d+3;return b.setDate(e),b.getFullYear()}function Cf(a,b,c,d){var e=Bf(b),f=b.getFullYear();return n(e===f?b:new Date(e,0,1),a,d,c)}function Df(a,b,c,d,e){var f,g,h,i,k="",l=0,m=d.DateTimeFormat.eras,n=xf();for(h=0;f=n.exec(b),g=yf(f,b,l),k+=g[0],l=g[1],f;h++)switch(f[0]){case"QQQQ":case"qqqq":k+=Aa[zf(a)];break;case"QQQ":case"qqq":k+="Q"+zf(a);break;case"QQ":case"qq":k+=j(zf(a),2);break;case"Q":case"q":k+=zf(a);break;case"yyyy":case"yyy":k+=m?Cf("ee",a,e,d):j(Bf(a),4);break;case"yy":k+=m?Cf("ee",a,e,d):j(Bf(a)%100,2);break;case"y":k+=m?Cf("e",a,e,d):""+Bf(a)%100;break;case"ww":i=Af(a,c),k+=R(i)?i:j(i,2);break;case"w":k+=Af(a,c)}return""+k}function Ef(){function a(){this.Ci=[{Hi:6},{Hi:5},{Hi:2}],this.on={}}a.prototype=new e.Functions.Function("DATEPART",2,3),a.prototype.evaluate=function(a,b,c){var e,f,g,h,i;return qf(b)||!rf(b)?"":(e=this.on,f=xa===c&&/Y/g.test(b)&&/w/g.test(b),f&&(b=sf(b)),e[b]||(g=d.Formatter&&d.Formatter.GeneralFormatter,e[b]=g?new g(b):s),h=e[b],i=h.format(a),f&&(i=tf(i)),/q|Q|w|y/g.test(i)&&(i=wf(a,i,c,h)),i)},e.Functions.bi.DATEPART=new a}Da={Hi:0},Ea={Hi:0,aj:"= 0",bj:J},Fa={Hi:0,aj:"= 0",bj:0},Ga={_i:1,Hi:0,aj:"= 0",bj:0},Ha={Hi:2,aj:"< 0"},Ia={Hi:0,aj:["> 134217728","< -134217728"]},Ja={Hi:1},Ka={Hi:2},La={_i:1,Hi:2},Ma={_i:1,Hi:2,aj:"< 0",bj:K},Na={_i:1,Hi:2,aj:["= 0"],bj:K},Oa={_i:0,Hi:2,aj:["< 0","> 1"],bj:K},Pa={Hi:5},Qa={Hi:6},Ra={Hi:2,aj:"< 0",bj:K},Sa={_i:!1,Hi:7},Ta={_i:[],Hi:4,Ii:4,Ji:!0,Ki:!0,Li:!0},Ua={Hi:4,Ii:1,Ki:!0,Li:!0},Va={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},Wa={Hi:4,Ii:3,Ji:!0,Ki:!0,Xi:!0},Xa={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},Ya={Hi:4,Ii:2,Ji:!0,Ki:!0,Xi:!0},Za=[0,"%= 1 && >= 3"];function Ff(a,b){if(!a||8!==a.type)throw e.sR().Exp_FormulaInvalid;if(b.indexOf(a.value)!==-1)throw e.sR().Exp_FormulaInvalid;if(a.value.indexOf(".")>-1)throw e.sR().Exp_FormulaInvalid}qa("ABS",fb,1,1,Da),qa("ACOS",oc,1,1,{Hi:0,aj:["> 1","< -1"]}),qa("ACOT",wc,1,1,Da),qa("ASIN",nc,1,1,{Hi:0,aj:["> 1","< -1"]}),qa("ATAN",vc,1,1,Da),qa("ATAN2",xc,2,2,[Da,Da]),qa("COS",jc,1,1,Da),qa("SEC",kc,1,1,Ia),qa("CEILING",Fb,2,2,[Fa,Fa]),qa("ODD",lb,1,1,Ja),qa("EVEN",mb,1,1,Ja),qa("FLOOR",Gb,2,2,[Fa,Fa]),qa("LN",pb,1,1,{Hi:1,aj:"<= 0"}),qa("SQRT",zb,1,1,{Hi:0,aj:"< 0"}),qa("SIN",hc,1,1,Da),qa("CSC",ic,1,1,Ia),qa("TAN",lc,1,1,Da),qa("COT",mc,1,1,Ia),qa("SIGN",vb,1,1,{Hi:1,aj:"> 0",bj:1}),qa("GCD",wb,1,t,Va,-1,-1),qa("LCM",xb,1,t,Va,-1,-1),qa("PRODUCT",yb,1,t,t,-1,-1),qa("POWER",sb,2,2,[Da,Da]),qa("MOD",qb,2,2,[Da,{Hi:0,aj:"= 0",bj:J}]),qa("QUOTIENT",Ab,2,2,[Da,Ea],t,t),qa("SUBTOTAL",Bb,2,t,Ka,"!= 0",t,{g_J:"filter"}),qa("_SUBTOTALFORSTATUSBAR",Cb,2,5e3,Ka,"!= 0",t,{g_J:"filter"}),qa("INT",gb,1,1,t,t,t),qa("MROUND",Kb,2,2,[Fa,Fa]),qa("ROUND",Lb,2,2,[Da,Ka]),qa("ROUNDDOWN",Mb,2,2,[Da,Ka]),qa("ROUNDUP",Nb,2,2,[Da,Ka]),qa("TRUNC",Mb,1,2,[Da,{_i:0,Hi:2}],t,t,{bk:1}),qa("EXP",Ob,1,1,Da),qa("LOG",Rb,1,2,[{Hi:0,aj:"<= 0"},{_i:10,Hi:0,aj:"<= 0"}],t,t,{bk:1}),qa("LOG10",Sb,1,1,{Hi:0,aj:"<= 0"}),qa("SUM",ub,1,t,t,-1,-1),qa("SUMIF",Tb,2,3,t,[0,2],t,{bk:2,FHJ:[2],f_J:!0,fk:4,gk:1,dk:!0}),qa("SUMIFS",Vb,3,t,t,[0,"%= 1"],t,{FHJ:Za,f_J:!0,fk:4,dk:!0}),qa("SUMPRODUCT",_b,1,t,t,-1,-1,{fk:1}),qa("SUMSQ",ac,1,t,Va,-1,-1),qa("SUMX2MY2",bc,2,2,Va,-1,-1),qa("SUMX2PY2",cc,2,2,Va,-1,-1),qa("SUMXMY2",dc,2,2,Va,-1,-1),qa("SERIESSUM",ec,4,4,[Da,Ka,Ka,{Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0}],3,3),qa("PI",rb,0,0),qa("SQRTPI",fc,1,1,{Hi:0,aj:"< 0"}),qa("DEGREES",kb,1,1,Ja),qa("RADIANS",gc,1,1,Da),qa("COSH",rc,1,1,Da),qa("SECH",sc,1,1,Da),qa("ACOSH",uc,1,1,{Hi:0,aj:"< 1"}),qa("SINH",pc,1,1,Da),qa("CSCH",qc,1,1,Da),qa("ASINH",tc,1,1,Da),qa("TANH",yc,1,1,Da),qa("COTH",zc,1,1,{Hi:0}),qa("ATANH",Ac,1,1,{Hi:0,aj:["<= -1",">= 1"]}),qa("ACOTH",Bc,1,1,{Hi:0}),qa("MDETERM",Cc,1,1,Ua,-1,-1),qa("MINVERSE",Dc,1,1,Ua,-1,-1),qa("MMULT",Ec,2,2,[Ua,Ua],-1,-1),qa("FACT",nb,1,1,{Hi:3,aj:["< 0","> 170"]}),qa("FACTDOUBLE",ob,1,1,{Hi:3,aj:["< 0","> 300"]}),qa("MULTINOMIAL",Fc,1,t,{Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},-1,-1),qa("RAND",Gc,0,0,t,t,t,{ck:!0}),qa("RANDBETWEEN",Hc,2,2,[Ka,Ka],t,t,{ck:!0}),qa("COMBIN",hb,2,2,[Ha,Ha]),qa("COMBINA",ib,2,2,[Ha,Ha]),qa("DECIMAL",jb,2,2,[{_i:"0",Hi:5},{Hi:0,aj:["> 36","< 2"]}]),qa("CEILING.MATH",Hb,1,3,[Da,{Hi:0,_i:1},{Hi:0,_i:0}]),qa("FLOOR.MATH",Ib,1,3,[Da,{Hi:0,_i:1},{Hi:0,_i:0}]),qa("BASE",Jb,2,3,[{Hi:0,aj:["< 0",">= 9007199254740992"]},{Hi:3,aj:["> 36","< 2"]},{Hi:3,_i:0,aj:["< 0",">= 256"]}]),qa("ROMAN",Ic,1,2,[{Hi:2,aj:["< 0","> 3999"],bj:K},{_i:0}],t,t,{bk:1}),qa("ARABIC",Jc,1,1,Pa),qa("CEILING.PRECISE",Pb,1,2,[Fa,Ga]),qa("ISO.CEILING",Pb,1,2,[Fa,Ga]),qa("FLOOR.PRECISE",Qb,1,2,[Fa,Ga]),qa("MAXIFS",Wb,3,t,t,[0,"%= 1"],[0,"%= 1"],{FHJ:Za,f_J:!0,dk:!0}),qa("MINIFS",Xb,3,t,t,[0,"%= 1"],[0,"%= 1"],{FHJ:Za,f_J:!0,dk:!0}),qa("AVERAGEIFS",Zb,3,t,t,[0,"%= 1"],[0,"%= 1"],{FHJ:Za,f_J:!0,dk:!0}),qa("COUNTIFS",Yb,2,t,t,"%= 0","%= 0",{FHJ:["%= 0 && >= 2"],f_J:!0,dk:!0}),qa("MUNIT",$b,1,1,{Hi:2,aj:"<= 0",bj:K}),qa("SEQUENCE",Kc,1,4,[Ka,Ka,Da,Da],t,t,{bk:[0,1,2,3]},!0),qa("RANDARRAY",Lc,0,5,[Ka,Ka,Da,Da],t,t,{ck:!0,bk:[0,1,2,3,4]},!0),qa("AGGREGATE",Eb,3,t,t,"> 1","> 1",{fk:1,dk:!0,g_J:"filter"}),qa("AND",Nc,1,t,Xa,-1,-1),qa("OR",Oc,1,t,Xa,-1,-1),qa("NOT",Pc,1,1),qa("IF",Qc,2,3,t,[1,2],[1,2],{gk:[1,2],bk:2,isBranch:!0,findTestArgument:0,findBranchArgument:function(a){if(e.Convert.vf(a))return-1;var b={value:!1};return U(a,b),b.value?1:2}}),qa("IFERROR",Sc,2,2,t,t,t,{gk:-1}),qa("TRUE",Tc,0,0),qa("FALSE",Uc,0,0),qa("IFNA",Vc,2,2,t,t,t,{gk:-1}),qa("IFS",Wc,2,254,t,0,t,{gk:-1}),qa("SWITCH",Xc,3,253,t,t,t,{gk:-1}),qa("XOR",Yc,1,t,Wa,-1,-1),qa("LET",t,3,253,t,t,t,{argsValidator:function(a,b,c,d){var f,g;if(c%2===0)throw e.sR().Exp_FormulaInvalid;for(f=[],g=0;g<d.length-1;g+=2)Ff(d[g],f),f.push(d[g].value)}}),qa("LAMBDA",t,1,253,t,t,t,{argsValidator:function(a,b,c,d){var e,f=[];for(e=0;e<d.length-1;e++)Ff(d[e],f),f.push(d[e].value)}}),qa("MAP",bd,2,t,t,-1,-1,{isContextSensitive:!0},!0),qa("REDUCE",cd,3,3,t,-1,-1,{isContextSensitive:!0},!0),qa("SCAN",dd,3,3,t,-1,-1,{isContextSensitive:!0},!0),qa("BYROW",fd,1,2,t,-1,-1,{isContextSensitive:!0},!0),qa("BYCOL",gd,1,2,t,-1,-1,{isContextSensitive:!0},!0),qa("MAKEARRAY",ed,3,3,[Ma,Ma],t,t,{isContextSensitive:!0},!0),qa("DATE",nd,3,3,[{Hi:2,aj:["< 0","> 9999"]},Ka,Ka]),qa("TIME",od,3,3,[Ka,Ka,Ka]),qa("DATEVALUE",pd,1,1,{Ni:!0}),qa("TIMEVALUE",qd,1,1,{Ni:!0}),qa("NOW",rd,0,0,t,t,t,{ck:!0}),qa("TODAY",sd,0,0,t,t,t,{ck:!0}),qa("HOUR",ud,1,1,Qa),qa("MINUTE",vd,1,1,Qa),qa("SECOND",wd,1,1,Qa),qa("DAY",xd,1,1,Qa),qa("MONTH",yd,1,1,Qa),qa("YEAR",zd,1,1,Qa),qa("WEEKNUM",Ad,1,2,[Qa,La],t,t,{bk:1}),qa("WEEKDAY",Bd,1,2,[Qa,La],t,t,{bk:1}),qa("EDATE",Cd,2,2,[Qa,Ka]),qa("EOMONTH",Dd,2,2,[Qa,Ka]),qa("WORKDAY",Ed,2,3,[Qa,Ka,Ta],2,2,{bk:2}),qa("WORKDAY.INTL",Fd,2,4,[Qa,Ka,{_i:"0000011"},Ta],[3],[2,3],{bk:[2,3]}),qa("DAYS360",e.Functions.uk,2,3,[Qa,Qa,{_i:!1,Hi:7}],t,t,{bk:2}),qa("NETWORKDAYS",Gd,2,3,[Qa,Qa],2,2,{bk:2}),qa("NETWORKDAYS.INTL",Id,2,4,[Qa,Qa],[2,3],[2,3],{bk:[2,3]}),qa("YEARFRAC",e.Functions.vk,2,3,[Qa,Qa,{_i:0,Hi:2}],t,t,{bk:2}),qa("DATEDIF",Jd,3,3,[Qa,Qa,Pa]),qa("DAYS",Kd,2,2),qa("ISOWEEKNUM",Ld,1,1,Qa),qa("CLEAN",Pd,1,1,Pa),qa("TRIM",Qd,1,1,Pa),qa("DOLLAR",Rd,1,2,[Da,{_i:2,Hi:2,aj:"> 99",bj:K}],t,t,{bk:1}),qa("FIXED",Sd,1,3,[Da,{_i:2,Hi:2},{_i:!1,Hi:7}],t,t,{bk:[1,2]}),qa("TEXT",Td,2,2,[{},Pa]),qa("VALUE",Ud,1,1,t,t,t),qa("LOWER",Wd,1,1,Pa),qa("UPPER",Xd,1,1,Pa),qa("PROPER",Yd,1,1,Pa),qa("CHAR",Zd,1,1,{Hi:2,aj:["> 255","< 1"],bj:K}),qa("CODE",$d,1,1,{Hi:5,Ni:!0}),qa("REPLACE",_d,4,4,[Pa,{Hi:2,aj:"< 1",bj:K},Ra,Pa],t,t,{bk:2}),qa("SUBSTITUTE",be,3,4,[Pa,{Hi:5,Ni:!0},Pa],t,t,{bk:3}),qa("CONCATENATE",ce,1,t,{Hi:4,Ii:0,Ji:!0,Xi:!0},t,-1),qa("LEFT",he,1,2,[Pa,Ma],t,t,{bk:1}),qa("MID",me,3,3,[Pa,{Hi:2,aj:"<= 0",bj:K},Ra]),qa("RIGHT",ie,1,2,[Pa,Ma],t,t,{bk:1}),qa("REPT",oe,2,2,[Pa,Ka]),qa("LEN",pe,1,1,Pa),qa("FIND",se,2,3,[Pa,Pa,La],t,t,{bk:2}),qa("SEARCH",ue,2,3,[Pa,Pa,Ma],t,t,{bk:2}),qa("EXACT",ye,2,2,[Pa,Pa]),qa("T",ze,1,1),qa("UNICHAR",Ae,1,1,[{Hi:2,bj:K}]),qa("UNICODE",Be,1,1),qa("BAHTTEXT",Ce,1,1,[{Hi:0,bj:K}]),qa("CONCAT",de,1,t,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),qa("TEXTJOIN",ee,3,t,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),qa("FINDB",te,2,3,[Pa,Pa,La],t,t,{bk:2}),qa("LEFTB",ke,1,2,[Pa,Ma],t,t,{bk:1}),qa("RIGHTB",le,1,2,[Pa,Ma],t,t,{bk:1}),qa("MIDB",ne,3,3,[Pa,Ra,Ra]),qa("LENB",re,1,1,Pa),qa("REPLACEB",ae,4,4,[Pa,{Hi:2,aj:"< 1",bj:K},Ra,Pa],t,t,{bk:2}),qa("SEARCHB",xe,2,3,[Pa,Pa,Ma],t,t,{bk:2}),qa("TEXTAFTER",Ee,2,6,[Pa,Ya,Na,Oa,Oa,Pa],[1],[1],{bk:[2,3,4,5]}),qa("TEXTBEFORE",Fe,2,6,[Pa,Ya,Na,Oa,Oa,Pa],[1],[1],{bk:[2,3,4,5]}),qa("TEXTSPLIT",Ie,2,6,[Pa,Ya,Ya,Sa,Oa,Pa],[1,2],[1,2],{bk:[1,2,3,4,5]},!0),qa("ENCODEURL",df,0,1,Pa),qa("ISERROR",Je,1,1,t,t,t,{gk:-1}),qa("ISERR",Ke,1,1,t,t,t,{gk:-1}),qa("ISNA",Le,1,1,t,t,t,{gk:-1}),qa("ERROR.TYPE",Me,1,1,t,t,t,{gk:-1}),qa("ISNUMBER",Ne,1,1,t,t,t,{gk:-1}),qa("ISEVEN",Oe,1,1,Da,t,t),qa("ISODD",Pe,1,1,Da,t,t),qa("N",Qe,1,1,t,t,t),qa("ISBLANK",Re,1,1,t,t,t,{gk:-1}),qa("ISLOGICAL",Se,1,1,t,t,t,{gk:-1}),qa("ISTEXT",Te,1,1,t,t,t,{gk:-1}),qa("ISNONTEXT",Ue,1,1,t,t,t,{gk:-1}),qa("ISREF",Ve,1,1,t,-1,t,{gk:-1}),qa("TYPE",We,1,1,t,t,-1,{gk:-1}),qa("NA",Xe,0,0),qa("SHEET",Ye,0,1,t,-1,t,{dk:!0}),qa("SHEETS",Ze,0,1,t,-1,t,{dk:!0}),qa("GETPIVOTDATA",ff,2,253,t,-1,-1,{dk:!0}),qa("OBJECT",hf,2,t,t,-1,-1),qa("PROPERTY",jf,2,2,t),qa("FILTERJSON",kf,1,1,t),qa("ASC",lf,1,1),qa("DBCS",mf,1,1),qa("ISOMITTED",t,1,1,t,-1,-1),Ef(),of(),$e()}).call(this,c("./node_modules/webpack/buildin/global.js"))},CalcEngine:function(a,b){a.exports=c("@grapecity/js-calc")},Common:function(a,b){a.exports=c("Common")}}),a.exports=d.Spread.CalcEngine.BasicFunctions},"./node_modules_local/@grapecity/js-calc-basicfunctions/index.js":function(a,b,c){a.exports=c("./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js")},"./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js":function(a,b,c){var d="object"==typeof d?d:{};d.Spread=d.Spread||{},d.Spread.CalcEngine=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./src/calc.entry.ts")}({"./src/Parser.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/calc.common.ts"),f=void 0,g=null,h="string",i="boolean",j="TRUE",k="FALSE",l="ARRAY",m=d.Common.u,n=d.Common.j,o=n.Fa,p="Exp_FormulaInvalidChar",q="Exp_FormulaInvalid",r="Exp_NoSyntax";function F(){throw e.sR()[q]}function G(a,b,c){throw m.Kb(e.sR()[c||p],[a,b])}b.di=["+","-","%","+","-","*","/","^","&","=","<>","<","<=",">",">=",":",","," ","."],b.preOperaterTypesMap={"+":0,"-":1},b.operaterTypesMap={":":15,",":16,"+":3,"-":4,"*":5,"/":6,"^":7,"%":2,"&":8,"=":9,"<":11,"<>":10,"<=":12,">":13,">=":14},s={":":0," ":1,".":2,"^":3,"*":4,"/":4,",":5,"+":6,"-":6,"&":7,"<":8,"=":8,">":8,">=":8,"<=":8,"<>":8},t=".",u=",",v=";",w=",",x=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1];function H(a){return a<=255}function I(a){return a<=127}function J(a){return a===e.getBoolean().boolean_true||a===j}function K(a){return a===e.getBoolean().boolean_false||a===k}function L(a){return a>=48&&a<=57}b.isDigit=L;function M(a){var b=a.charCodeAt(0);return!H(b)||(I(b)?(b|=32,b>=96&&b<=122):0===x[b]||1===x[b])}b.ei=M;function N(a){var b=a.charCodeAt(0);return!H(b)||(I(b)?b<=57?b>=48:(b|=32,b>=96&&b<=122):0===x[b]||1===x[b])}b.fi=N;function O(a){var b=a.charCodeAt(0);return I(b)?b>=48&&b<=57:8===x[b]||10===x[b]}b.isNumber=O;function P(a,b,c,d,e,f){var g,h,i=a.length,j=c===d?0:1,k=[],l=0;for(g=b+1;g<i;g++)if(h=a[g],h===e&&(k.push(h),g++,l++,h=a[g]),h===c&&j++,h===d)if(j--,c===d&&g+2<i&&a[g+1]===c)k.push(c),g++,l++;else{if(0===j)return{result:k,endIndex:g,skipCount:l};k.push(h)}else k.push(h);f&&G(d,c,r)}function Q(a,b,c){var d,f,g,h,i=a.length,j=i-b;for(d=0;d<e.ErrorList.length;d++)if(f=e.ErrorList[d],g=f.length,b+g<=i&&(h=a.slice(b,b+g),g<=j&&f===h.join("").toUpperCase()))return{result:h,endIndex:b+g-1};c&&G([a[b],b])}function R(a){return 0!==a.type&&!(7===a.type&&"ANCHORARRAY"!==a.functionName)&&a.type<9}function S(a,b,c){var d,e,f=a.length,g=0,h=[];for(d=b;d<f;d++)if(e=a[d],L(e.charCodeAt(0)))0===g?g=2:3===g?g=4:1===g?g=2:5!==g&&6!==g||(g=7),h.push(e);else if(e===c){if(2===g)g=4;else{if(0!==g&&1!==g)return{};g=3}h.push(".")}else if("+"===e||"-"===e){if(0===g)g=1;else{if(5!==g)return{num:h,endIndex:d-1};g=6}h.push(e)}else if("E"===e||"e"===e){if(2!==g&&4!==g)return{};g=5,h.push(e)}else if(2===g||4===g||7===g)return{num:h,endIndex:d-1};return 2===g||4===g||7===g?{num:h,endIndex:f-1}:{}}y=[].push;function T(a,b){return y.apply(a,b),a}z=function(){function a(a,b,c,d,e){var f,g,h;this.oi=[],e=e||0,f=this,f.Qb=a,g=Array.isArray(a)?a.join(""):a,f.Nc=b,f.mi=c,f.li=d||c+a.length-1,0===b&&0===e&&a&&(h=g.toUpperCase(),(J(h)||K(h))&&(e=5,g=h)),f.ni=g,f.hi=e}return a.prototype.type=function(){return this.Nc},a.prototype.subType=function(){return this.hi},a.prototype.stringValue=function(){return this.ni},a}(),b.FormulaToken=z,A=function(){function a(a){void 0===a&&(a=5e3),this.priority=a}return a.prototype.resolveToken=function(a,b,c,d,e){return 0},a.prototype.unparse=function(a,b,c,d){return!0},a}(),b.TokenResolver=A;function U(a){var b,c,d=[];if(a.indexOf(":")>-1&&a.indexOf("[")===-1)for(b=a.split(":"),c=0;c<b.length;c++)d.push("'"+b[c].replace(/'/g,"''")+"'");return d}function V(a){var b,c,d;for(b=0,c=a;b<c.length;b++)if(d=c[b],0===d.type||d.arguments&&V(d.arguments))return!0;return!1}B=function(){function a(){}return a.prototype.setParserOption=function(b){var c,e;b!==f&&d.Common.CultureManager.q4()?(e="object"==typeof b&&b.NumberFormat?b.NumberFormat:d.Common.CultureManager.q4().NumberFormat,c=b?e:{}):(c={},e=c),u=a.listSeparator=c.listSeparator||",",t=c.numberDecimalSeparator||".",!b&&a.numberDecimalSeparator||(a.numberGroupSeparator=e.numberGroupSeparator||",",a.numberDecimalSeparator=e.numberDecimalSeparator||"."),v=a.arrayGroupSeparator=c.arrayGroupSeparator||";",w=a.arrayListSeparator=c.arrayListSeparator||","},a.prototype.parseDotOperator=function(a,b,c){var d,f,g,h,i,j=b[c];if(b[c-1]&&"#"===b[c-1].Qb&&"."!==j.ni[0])return 0;if(b[c+1]&&":"===b[c+1].Qb)return 0;if(0===j.Nc&&0===j.hi&&!e.JYJ(a.source,j.ni)&&(d=j.ni.lastIndexOf("."),d>=0)){if(f=j.ni.substring(d+1),f.indexOf("]")>=0)return 0;if(g=new z(j.ni.substring(0,d).split(""),0,j.mi,j.mi+d-1),h=new z(["."],5,j.mi+d,j.mi+d),i=new z(f.split(""),0,j.mi+d+1,j.li),i.KYJ=!0,d===j.ni.length-1)return 0===d?b.splice(c,1,h):b.splice(c,1,g,h),1+this.parseDotOperator(a,b,c);if(d>0)return b.splice(c,1,g,h,i),2+this.parseDotOperator(a,b,c);if(0===d)return b.splice(c,1,h,i),1}return 0},a.prototype.parse=function(a,b){var c,d,f;if(b=e.ZUJ(b),this.setParserOption(a.culture),c=b.split(""),this.gi=c,a.piK=!1,d=this.parseToTokens(a,c,!a.ignoreError),a.source&&a.piK)for(f=0;f<d.length;f++)f+=this.parseDotOperator(a,d,f);return this.buildExpressionTree(a,d,!a.ignoreError)},a.prototype.unparse=function(a,b,c){return void 0===c&&(c=[]),this.Cma(a,b,c),c.join("")},a.prototype.Cma=function(a,b,c){var d,e;if(b)for(b.e5J&&!a.Eh&&c.push("@"),this.setParserOption(a.culture),d=a.getResolvers(),e=0;e<d.length&&!d[e].unparse(a,this,b,c);e++);},a.prototype.parseToTokens=function(a,c,d){var e,f,g,h,i,j,k,m,n,o,p,q,r,s,x;for(void 0===d&&(d=!0),e=this,f=function(b,c,d){return c.length>0&&(c.indexOf(".")>=0&&(a.piK=!0),b.push(new z(c,0,d))),[]},g=c.length,h=[],i=[],j=-1,k=[],o=0;o<g&&" "===c[o];)o++;for("="===c[o]&&o++,n=o,r=function(o){var r,x,A,B,C,D,E,F,H,I,J=c[o],K=J.charCodeAt(0),M=void 0;if(64===K)k=f(h,k,n),h.push(new z(c[o],4,o,o)),n=o+1;else if(K>=97&&K<=122||K>=65&&K<=90)k.push(J);else if(34===K)k.length>0&&(k=f(h,k,n)),M=P(c,o,'"','"',"",d),M?(r=new z(M.result,0,o,o+M.result.length+2,3),M.skipCount&&(r.HTa=c.slice(o,M.endIndex+1).join(""),r.li+=M.skipCount),h.push(r),o=M.endIndex,n=o+1):(T(k,c.slice(o,g)),o=g-1);else if(39===K)M=P(c,o,"'","'","",d),M?(x=U(M.result.join("")),A=[],x.length>1&&(B=x.join(":").split(""),A=e.parseToTokens(a,B,d)),A&&A.length>0?(A.forEach(function(a){a.mi+=o,a.li+=o}),T(h,A)):(k.push("'"),T(k,M.result),k.push("'")),o=M.endIndex):(k.push("'"),o=g-1);else if(91===K)if(M=P(c,o,"[","]","'",d))k.push("["),T(k,M.result),k.push("]"),o=M.endIndex;else{if(e.lda&&0===k.length&&("R"===k[0]||"r"===k[0]||"C"===k[0]||"c"===k[0]))return s=o,"continue";T(k,c.slice(o,g)),o=g-1}else{if(13===K||10===K)return s=o,"continue";if(35===K)C=Q(c,o),C?(h.push(new z(C.result,0,o,o+C.result.length-1,6)),n=o+1,o=C.endIndex):(k=f(h,k,n),h.push(new z(c[o],6,o,o)),n=o+1);else if(33===K)0===k.length,D=h.length,D>0&&0===h[D-1].Nc?(E=h[D-1],y.apply(E.Qb,k),h[D-1]=new z(E.Qb,0,E.mi,o,12)):h.push(new z(k,0,n,o,12)),k=[],n=o+1;else if(43===K||45===K)F=0===h.length?null:h[h.length-1],0!==k.length?(k=f(h,k,n),h.push(new z(J,5,o)),n=o+1):(F&&7===F.Nc&&h.pop(),!F||2!==F.hi&&6!==F.Nc&&0!==F.Nc?(h.push(new z(J,4,o)),n=o+1):(h.push(new z(J,5,o)),n=o+1));else if(J===t||L(K))k.length>0?k.push(J):(H=S(c,o,t),H.num?(p=H.endIndex,I=H.num,p<=g-2&&"!"===c[p+1]?(T(k,I),n=p):(h.push(new z(I,0,o,p,4)),n=p+1),o=p):k.push(J));else if(123===K)k.length>0&&(d?G(J,o):k=f(h,k,n)),m=new z(l,1,o,o,1),h.push(m),++j,i[j]=m,n=o+1;else if(J===v&&j>=0&&i[j].value===l)k=f(h,k,n),j<0&&d&&G(J,o),h.push(new z(v,3,o,o)),n=o+1;else if(125===K)k=f(h,k,n),p<0&&d&&G(J,o),q=i[j],j--,q=new z(J,q.Nc,o,o,2),h.push(q),n=o+1;else if(32===K)k=f(h,k,n),n=o+1;else if(J===u||J===w||J===v)k=f(h,k,n),j<0||1!==i[j].Nc?h.push(new z(u,5,o,o,10)):h.push(new z(J,3,o,o)),n=o+1;else if(37===K)k=f(h,k,n),h.push(new z(c[o],6,o,o)),n=o+1;else if(o+2<=g&&b.operaterTypesMap[J+c[o+1]])k=f(h,k,n),h.push(new z(c.slice(o,o+2),5,o,o+1,5)),o++,n=o+1;else if(b.operaterTypesMap[J])k=f(h,k,n),h.push(new z(J,5,o,o)),n=o+1;else if("("===J)k.length>0?(m=new z(k,1,n,o,1),k=[]):m=new z(J,2,o,o,1),h.push(m),++j,i[j]=m,n=o+1;else if(")"===J){if(k=f(h,k,n),j<0)return d&&G(J,o),f(h,J,o),n=o+1,s=o,"continue";q=i[j],j--,q=new z(J,q.Nc,o,o,2),h.push(q),n=o+1}else if(":"===J)k=f(h,k,n),h.push(new z(J,5,o,o,11)),n=o+1;else if("\r"===J||"\n"===J);else{if("\\"===J){if(o++,o>=g)return d&&G(J,o),s=o,"continue";k.push(J),J=c[o]}k.push(J)}}s=o},x=o;x<g;x++)r(x),x=s;return f(h,k,n),h},a.prototype.buildExpressionTree=function(a,b,c){var d,f,h,i,j;return this.nWJ(b),d=a.keepUnknownFormulas,a.qiK=!1,f=this.ii(a,b,c),d&&(0===f.length||V(f))?g:(h=this.ji(a,f,c),c&&(h||F(),this.rSa(h)),a.qiK&&this.$UJ(h,new e.LocalScopes,!1,!1,a,c),i=a.source,j=i&&i.q$a,!j&&h&&(h.CCc=!0),h)},a.prototype.rSa=function(a){for(var b,c,d,f,g,h;10===a.type;)a=a.value;if(b=this,9===a.type)a.value||F(),b.rSa(a.value),a.value2&&b.rSa(a.value2);else if(7===a.type)if(c=a.arguments,d=c.length,f=a.function,e.isExpression(f))this.rSa(f);else for(f&&f.sEc(f.minArgs,f.maxArgs,d,c),g=0;g<d;g++)h=c[g],f?f.tEc(h,g):e.uEc(h,g),b.rSa(h)},a.prototype.ji=function(a,b,c){var d,f,g,h,i,j,k=this.ki(a,b,c);for(h=3;h<k.length;)if(i=k[h],j=k[h-2],9!==j.type&&c&&F(),i&&9===i.type){for(;h>=3&&s[i.value]>=s[j.value];)f=k[h-3],g=k[h-1],d=e.Kh(j.operatorType,f,g),k.splice(h-3,3,d),h-=2,h>=3&&(j=k[h-2]);h+=2}else h++;if(1===k.length)return k[0];for(h=k.length-2;h>0;h-=2)f=k[h-1],g=k[h+1],9!==k[h].type&&c&&F(),d=e.Kh(k[h].operatorType,f,g),k.splice(h-1,3,d);return d},a.prototype.aVJ=function(a,b,c){var d,f,g,h,i,j;if(!a||a.length<=0)return a;for(d=a,f=0,g=[],h=[],i=0;i<=d.length;i++)j=d[i],i===d.length||c(j)?(f===i?g.push(new e.Expression(11)):g.push(this.ji(b,h)),f=i+1,h=[]):h.push(j);return g},a.prototype.ki=function(a,b,c){var d,g,h,i,j,k,l,m,n,p,q,r;for(b=Array.isArray(b)?b:[b],d=[],g=b.length,h=0;h<g;h++){if(i=b[h],j=i,10===i.type){if(k=d.length>0?d[d.length-1]:f,k&&7===k.type){l=this.aVJ(i.value,a,function(a){return a.value===u}),d[d.length-1]=e.bVJ(k,l);continue}i.value=this.ji(a,i.value),j=i}else 7===i.type&&(m=function(a){return 0===a.type&&a.value===u},i.arguments=this.aVJ(i.arguments,a,m));d.push(j)}for(b=d,d=[],g=b.length,h=0;h<g;h++){if(i=b[h],j=i,9===i.type)if(0===i.operatorType||1===i.operatorType)if(h===g-1)c&&F();else{for(n=h;!o(b[n])&&9===b[n].type&&b[n].operatorType<=1;)n++;if(o(b[n])){if(!c)return;F()}for(p=b[n],q=n-1;q>=h;q--)j=e.Kh(b[q].operatorType,p),p=j;j=p,h=n}else if(2===i.operatorType){if(0!==h){j=e.Kh(i.operatorType,d[d.length-1]),d[d.length-1]=j;continue}c&&F()}else if("#"===i.value){if(0!==h){if(b[h+1]&&8===b[h+1].type&&8===d[d.length-1].type){d[d.length-1].value+="#"+b[h+1].value,h++;continue}r=a.getFunction("ANCHORARRAY"),j=e.Jh(r,[d[d.length-1]]),d[d.length-1]=j;continue}c&&F()}else if("@"===i.value){if(b[h+1]&&9!==b[h+1].type){r=a.getFunction("@"),j=e.Jh(r,[b[h+1]]),d[d.length]=j,h++;continue}j.type=8}d.push(j)}return d},a.prototype.ii=function(a,b,c){var d,e,f=[];for(d=0,e=b.length;d<e;)d=this.resolveToken(a,b,f,d,c);return f},a.prototype.addDynamicCell=function(a){var b,c=a.source&&a.source.getCalcService&&a.source.getCalcService();c&&(c.UXJ||(c.UXJ={}),b=a.source.id+","+a.row+","+a.column,c.UXJ[b]={id:a.source.id,row:a.row,col:a.column})},a.prototype.resolveToken=function(a,b,c,d,h){var i,j,k,l,m,n,o=b[d],p=a.getResolvers();for(i=0;i<p.length;i++)if(j=p[i].resolveToken(a,this,b,d,h)){k=j.expr,l=d-1,k&&j.index!==f?d=j.index-1:k=j,o.KYJ&&(k.LYJ=o.ni),m=c.length>0?c[c.length-1]:g,m&&R(k)&&(R(m)||"#"===m.value)&&(n=b[l].li,n<o.mi-1&&c.push(e.Kh(17," "))),(15===k.operatorType||k.function&&k.function.haveDynamicListener)&&this.addDynamicCell(a),c.push(k);break}return d+1},a.prototype.resolveSubTokens=function(a,b,c,d,e){for(var f=[];c<b.length&&2!==b[c].hi;)if(c=this.resolveToken(a,b,f,c,d),e){c--;break}return{exprs:f,index:c+1}},a.prototype.nWJ=function(a){a.forEach(function(a){1===a.Nc&&a.ni!==l&&(a.ni=a.ni.toUpperCase())})},a.prototype.h_J=function(a,b,c){9===a.type&&18===a.operatorType&&(a.value=c||this.unparse(b,a),a.type=8,delete a.operatorType)},a.prototype.$UJ=function(a,b,c,d,f,g){var h,i,j,k,l,m,n;if(a)if(Array.isArray(a))for(h=0;h<a.length;h++)this.$UJ(a[h],b,c,d,f,g);else if(9===a.type&&18===a.operatorType&&(i=this.unparse(f,a),b.hasVariable(i)&&this.h_J(a,f,i)),8===a.type)b.hasVariable(a.value)&&(a.type=100,a.t0a=c,a.eVJ=d,a.value=b.getVariable(a.value),g||(a.value=a.value.replace(/\./g,"_")));else if(7===a.type){if(j=a.functionName,k=a.function,l=a.arguments,"LET"===j){for(b.enterScope(),m=l.length-1,h=0;h<m;h+=2){if(n=l[h],this.h_J(n,f),8!==n.type)return;this.$UJ(l[h+1],b,c,d,f,g),b.setVariable(n.value,n.value),this.$UJ(n,b,c,d,f,g)}this.$UJ(l[m],b,c,d,f,g),b.exitScope()}else if("LAMBDA"===j){for(b.enterScope(),m=l.length-1,h=0;h<m;h++){if(n=l[h],8!==n.type)return;b.setVariable(n.value,n.value),this.$UJ(n,b,c,d,f,g)}this.$UJ(l[m],b,c,d,f,g),b.exitScope()}else for(h=0;h<l.length;h++)c=e.getFunctionAcceptsArray(k,h),d=e.getFunctionAcceptsReference(k,h),this.$UJ(l[h],b,c,d,f,g);e.isExpression(k)&&this.$UJ(k,b,c,d,f,g),j&&b.hasVariable(j)&&(a.isLocalFunctionName=!0,a.functionName=b.getVariable(j))}else 9===a.type?(c=d=e.MYJ(a.operatorType),this.$UJ(a.value,b,c,d,f,g),this.$UJ(a.value2,b,c,d,f,g)):(this.$UJ(a.value,b,c,d,f,g),this.$UJ(a.value2,b,c,d,f,g))},a}(),b.Parser=B,C=function(){function a(a,b,c,d){this.Eh=!1,this.ignoreError=!1;var e=this;e.useR1C1=b,e.baseIdentity=c,e.option=d,e.source=a}return a.prototype.getExternalSource=function(a,b){var c,d=this.source.getCalcService(),e=d.getAllSourceModels();for(c=0;c<e.length;c++)if(m.Mb(e[c].getSource().getName(),b))return e[c].getSource();return g},a.prototype.getExternalSourceToken=function(a){return a.getName()},a.prototype.setSource=function(a){this.source=a},a.prototype.getResolvers=function(){var a=(this.source||this.kj).getCalcService();return a&&a.getResolvers()},a.prototype.addResolver=function(a){var b=(this.source||this.kj).getCalcService();b&&b.addResolver(a)},a.prototype.getFunction=function(a){var b,c=a,d=e.getMapping()&&e.getMapping().builtInFunctionsMapping;if(!o(d))for(b in d)d[b].alias===a&&(c=b);return this.source&&this.source.getCustomFunction(c)||e.Functions.findGlobalFunction(a)},a}(),b.ParserContext=C,e.CalcSource.prototype.getParserContext=function(a,b,c){return new C(this,a,b,c)};function W(a,b,c){var d,e;if(!b||0===b.length||X(a,b)||X(a,c))return[];if(d=b,c)for(d.push(":"),e=0;e<c.length;e++)d.push(c[e]);return d}function X(a,b){if(!b||0===b.length||!a.Eh)return!1;var c="'"===b[0]?1:0;return"["===b[c]&&b.indexOf("]")>c}D=function(a){E(c,a);function c(){return null!==a&&a.apply(this,arguments)||this}return c.prototype.resolveToken=function(a,c,d,g,h){var i,j,k,n,o,p,q,r,s,t,u,w,x=d[g],y=x.ni,z=x.Qb,A=x.Nc,B=null,C=x.hi,D=a.source&&a.source.Af&&a.source.Af.allowDynamicArray;if(0===A&&12===C){if(o=void 0,y&&(o=y,"'"===o.charAt(0)&&(o=o.substring(1,o.length-1))),g++,o&&(B=a.getExternalSource("",o)),x=d[g],!x)return i=new e.Expression(8),i.value=y,i;y=x.ni}if(0===A)0===x.hi?(k=y.toUpperCase(),J(k)||K(k)?(x.hi=5,x.ni=k,i=new e.Expression(4),i.value=J(k)):(i=new e.Expression(8),i.value=y)):4===x.hi?(i=new e.Expression(2),i.value=parseFloat(y),i.originalValue=y):3===x.hi?(i=new e.Expression(3),i.value=y):5===x.hi?(i=new e.Expression(4),i.value=J(y)):6===x.hi?(i=new e.Expression(5),i.value=e.CalcError.parse(y)):7===x.hi&&(i=new e.Expression(8),i.value=y);else if(1===A){if(y===l){for(i=new e.Expression(6),g++,k=[[]],j=0,p=0,q=0;g<d.length&&2!==d[g].hi;){if(x=d[g],g<d.length-1&&4===x.Nc&&"-"===x.ni&&4===d[g+1].hi&&(g++,x=d[g],x.Qb.unshift("-"),x.ni="-"+x.ni),3===x.Nc){if(x.ni===v){if(p!==q)throw m.Kb(e.sR().Exp_InvalidArrayColumns,[x.mi]);k.push([]),j++,q=0}}else{if(0!==x.Nc||4!==x.hi&&3!==x.hi&&5!==x.hi&&6!==x.hi)throw e.sR().Exp_InvalidArray;r=x.ni,s=r,4===x.hi?s=parseFloat(r):5===x.hi?s="TRUE"===r.toUpperCase():6===x.hi&&(s=e.CalcError.parse(r)),k[j].push(s),0===j&&p++,q++}g++}if(p!==q)throw m.Kb(e.sR().Exp_InvalidArrayColumns,[x.mi]);return g++,i.value=new e.CalcArray(k),{expr:i,index:g}}if(z.length>0)return"SINGLE"===y&&(t=a.source,t&&t.q$a&&(y="@")),i=new e.Expression(7),i.functionName=y,"LET"!==y&&"LAMBDA"!==y||(a.qiK=!0),u=a.getFunction(i.functionName)||e.Functions.findGlobalFunction(i.functionName),D===!1&&u&&u.isDynamicArrayFunction===!0&&(u=f),i.function=u,(n=c.resolveSubTokens(a,d,g+1,void 0,"@"===z[0]&&D))?(i.arguments=n.exprs,{expr:i,index:n.index}):(i.arguments=[],i)}else if(4===A)i=e.Kh(b.preOperaterTypesMap[y],y);else if(6===A||5===A)w=b.operaterTypesMap[y],"."===y&&(w=18),i=e.Kh(w,y);else if(2===A){if(i=new e.Expression(10),n=c.resolveSubTokens(a,d,g+1))return i.value=n.exprs,{expr:i,index:n.index};h&&F()}else 3===A&&(i=new e.Expression(0),i.value=y);return B&&i&&(i.source=B,i={expr:i,index:g+1}),i},c.prototype.unparse=function(a,b,c,d){var f,g,h,i,j=this;if(6===c.type||4===c.type||2===c.type||5===c.type||3===c.type)j.qi(a,c,d);else if(9===c.type)j.ri(a,b,c,d);else if(10===c.type)d.push("("),b.Cma(a,c.value,d),d.push(")");else if(7===c.type)f=e.isFunction(c.function)&&c.function.name||c.functionName,"ANCHORARRAY"!==f||a.Eh?"@"!==f||a.Eh?!c.functionName&&e.isExpression(c.function)?(j.unparse(a,b,c.function,d),d.push("("),j.unparseArguments(a,b,c,d),d.push(")")):(c.isLocalFunctionName&&a.Eh&&(f=e.XLPMPrefix+f),"@"===f&&(f="SINGLE"),g=e.getMapping()&&e.getMapping().builtInFunctionsMapping,h=g&&g[f],h&&h.alias&&(f=h.alias),T(d,f.split("")),d.push("("),j.unparseArguments(a,b,c,d),d.push(")")):(d.push("@"),b.Cma(a,c.arguments[0],d)):(b.Cma(a,c.arguments[0],d),d.push("#"));else{if(1===c.type||8===c.type)return j.unparseRefenceExpressions(a,b,c,d),!0;if(100!==c.type)return!1;i=a.Eh?e.XLPMPrefix+c.value:c.value,T(d,i.split(""))}return!0},c.prototype.unparseArguments=function(a,b,c,d){for(var e=0;e<c.arguments.length;e++)0!==e&&d.push(u),b.Cma(a,c.arguments[e],d)},c.prototype.unparseSource=function(a,b,c,d){if(a.getExternalSourceToken){if(c!==e.BangSource){var f=W(a,a.getExternalSourceToken(c).split(""),d&&a.getExternalSourceToken(d).split(""));if(!(f.length>0))return!1;y.apply(b,f)}return b.push("!"),!0}return!1},c.prototype.unparseRefenceExpressions=function(a,b,c,d){if(c.source===e.BangSource)d.push("!");else if(c.source){var f=this.unparseSource(a,d,c.source,c.endSource);if(!f)return void d.push("#","R","E","F","!")}8===c.type&&d.push(c.value)},c.prototype.ri=function(a,c,d,e){var f=d.operatorType;2===f?(c.Cma(a,d.value,e),e.push("%")):0===f||1===f?(e.push(b.di[f]),c.Cma(a,d.value,e)):18===f?(c.Cma(a,d.value,e),e.push(b.di[f]),d.value2&&d.value2.NYJ?e.push(d.value2.value):c.Cma(a,d.value2,e)):(c.Cma(a,d.value,e),e.push(b.di[f]),c.Cma(a,d.value2,e))},c.prototype.qi=function(a,b,c){var d,j,k,l,n,o,p,q,r=e.sR().Exp_InvalidArray;if(3===b.type)c.push('"'),c.push(m.Gb(b.value,'"','""')),c.push('"');else if(2===b.type)d=b.originalValue||""+b.value,"."!==t&&(d=d.replace(".",t)),c.push(d);else if(4===b.type)c.push(b.value?e.getBoolean().boolean_true:e.getBoolean().boolean_false);else if(6===b.type){if(c.push("{"),j=b.value,j.getRowCount()<=0)throw r;for(k=0,l=j.getRowCount();k<l;k++)for(k>=1&&c.push(v),n=0,o=j.getColumnCount();n<o;n++){if(0!==n&&c.push(w),p=j.getValue(k,n),p===f||p===g)throw r;q=typeof p,q===h?(c.push('"'),c.push(m.Gb(p,'"','""')),c.push('"')):q===i?c.push(p?e.getBoolean().boolean_true:e.getBoolean().boolean_false):"number"===q&&"."!==t?c.push((""+p).replace(".",t)):c.push(""+p)}c.push("}")}else 5===b.type?c.push(""+b.value):11===b.type},c}(A),b.DefaultTokenResolver=D,e.ParserWrapper.XAb=function(){if(B.numberDecimalSeparator===f){var a=new B;a.setParserOption(!0)}return B.numberDecimalSeparator},e.ParserWrapper.YAb=function(){if(B.numberGroupSeparator===f){var a=new B;a.setParserOption(!0)}return B.numberGroupSeparator}},"./src/calc.common.ts":function(a,b,c){
"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/calcEngine.res.en.ts"),f=c("./src/text_Filter/text_Filter.ts"),b.KPJ=f.KPJ,g=c("./src/map.ts"),b.ExcelCompatibleCalcMode=!1,b.SR={en:e.resource},b.ErrorCodeList=[0,7,15,23,29,42,36,99,100],b.XLPMPrefix="_xlpm.",h="number",i="string",j="boolean",k="TRUE",l="FALSE",m="object",n="#NULL!",o="#DIV/0!",p="#VALUE!",q="#REF!",r="#NAME?",s="#N/A",t="#NUM!",u="#SPILL!",v="#CALC!",w=1,x=2,y=[n,o,p,q,r,s,t,u,v],b.ErrorList=y,b.BAND_INDEX_CONST=-2147483648,b.MAX_ROW_COUNT=1048576,b.MAX_COLUMN_COUNT=16384,z=d.Common.j,A=z.Ca,B=z.Fa,C=z.Ea,D=d.Common.k.ac,E=d.Common.q,F=parseInt,G=isNaN,H=d.Common.l,I=H.Ra,J=d.Common.u,K=d.Common.o;function ua(a){return a&&a.toUpperCase()}function va(a){var b,c;if(a){if(7===a.type&&("SUBTOTAL"===a.functionName||"AGGREGATE"===a.functionName))return!0;for(b=a.arguments&&a.arguments.length,c=0;c<b;c++)if(va(a.arguments[c]))return!0;if(va(a.value)||va(a.value2))return!0}return!1}function wa(a,b){var c,d=a&&a.getCustomNameInfo&&a.getCustomNameInfo(b);return!d&&a&&(c=a.Cf().getGlobalSourceModel(),d=c&&c.getSource().getCustomNameInfo(b)),d}b.JYJ=wa;function xa(a){return 15===a||16===a||17===a}b.MYJ=xa;function ya(a){return a.indexOf(b.XLPMPrefix)>-1?a.replace(/_xlpm\./g,""):a}b.ZUJ=ya;function za(a){var b=(a&&a.message)+"";return b=b.toLowerCase(),"maximum call stack size exceeded"===b||"too much recursion"===b||"out of stack space"===b}b.isStackOverflowError=za,L=new d.Common.ResourceManager(b.SR,"CalcEngine"),b.sR=L.getResource.bind(L),b.getMapping=function(){return qa&&qa.resourceMapping},b.getBoolean=function(){var a=b.getMapping()&&b.getMapping().booleanMapping;return{boolean_true:a&&a.boolean_true||k,boolean_false:a&&a.boolean_false||l}},M=null,N=void 0,O=Math.abs,P=Math.exp,Q=Math.log,R=Math.pow,S=Math.floor,T=Math.ceil,U={},b.BangSource=U,V={},b.RefErrorSource=V,b.missingArgument=W,X={},Y=function(){function a(c,d){if(B(d)){var e=a.nf(c);if(!e)throw b.sR().Exp_NotSupported;this._error=e.error,this._code=e.code}else this._error=c,this._code=d}return a.prototype.toString=function(){var a=b.getMapping()&&b.getMapping().clacErrorMapping,c=a&&a[this._error];return c||this._error},a.prototype.clone=function(){return new a(this._error)},a.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},a.parse=function(b){try{return new a(b)}catch(a){return N}},a.riK=function(c){for(var d=0;d<b.ErrorCodeList.length;d++)if(c===b.ErrorCodeList[d])return new a(y[d],c);return N},a.nf=function(a){var c,d;if(a)for(c=0;c<y.length;c++)if(d=y[c],d===a||d===ua(a))return{error:d,code:b.ErrorCodeList[c]};return N},a}(),b.CalcError=Y,Z={Name:new Y(r),Null:new Y(n),DivideByZero:new Y(o),NotAvailable:new Y(s),Value:new Y(p),Reference:new Y(q),Number:new Y(t),Spill:new Y(u),Calc:new Y(v)},b.Errors=Z,$=Z.Value,_=Z.Reference,aa=Z.Number,ba=Z.DivideByZero,ca=Z.NotAvailable,da=Z.Null,ea={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},fa=function(){function a(){}return a}(),b.ParserWrapper=fa;function Aa(a){return isNaN(a)||!isFinite(a)}function Ba(a,b){var c,e,f,g,k,l,m,n,o,p,q,r,s,t,u;if(!a)return b.value=0,!0;e=typeof a;try{if(e===h)c=a;else if(e===i){if(/[\f\n\r\t\v]/.test(a))return!1;if(f=a,a=a.trim(),0===a.length)return b.value=0,!0;if(g=fa.XAb(),k=fa.YAb(),"."!==g&&"."!==k&&a.indexOf(".")>=0||","!==g&&","!==k&&a.indexOf(",")>=0)return!1;if(l=!1,m=!1,n=a[0],o=a[a.length-1],"("===a[0]&&")"===o){if(m=!0,a=a.substring(1,a.length-1).trim(),n=a[0],"+"===n||"-"===n)return!1;o=a[a.length-1]}if("%"===n?(l=!0,a=a.substring(1)):"%"===o?(l=!0,a=a.substring(0,a.length-1)):"$"===n&&(a=a.substring(1)),""===a)return!1;if(a.indexOf(k)>=0&&(p=E.qb("^\\ *[\\+|\\-]?\\ *\\d+(\\"+k+"\\d{3,})+(\\"+g+"\\d*)?([E|e][\\+|\\-]?\\d+)?\\ *$"),q=E.qb("^0+\\"+k),p.test(a)&&!q.test(a)&&(a=a.replace(E.qb("[ \\"+k+"]"),""))),a=a.trim()," "===a[1]&&("+"===a[0]?a=a.replace(/^\+ +/,"+"):"-"===a[0]&&(a=a.replace(/^\- +/,"-"))),"."!==g&&(a=a.replace(g,".")),a.indexOf(g)!==a.lastIndexOf(g))return!1;if(a.length>=2&&"0"===a[0]&&"x"===a[1])return!1;if(c=(+a).valueOf(),l&&(c/=100),m&&(c=-c),Aa(c)){if(a=f.trim(),r=a.charCodeAt(0),r|=32,a.length>4&&r>=97&&r<=122&&(s=a[0]+a[1]+a[2],s=s.toUpperCase(),!ea[s]))return!1;if(n=a[0],o=a[a.length-1],"/"===n||"-"===n||":"===n||"/"===o||"-"===o)return!1;if(p=E.qb("[\\'\\$\\#\\*\\%\\!\\@\\&\\(\\)\\=\\;\\\"\\<\\>\\?\\,\\z\\Z]"),p.test(a))return!1;if(t=d.Common.CultureManager.getCultureInfo(),u=t&&t.DateTimeFormat&&t.DateTimeFormat.shortDatePattern,u&&u.indexOf("d")<u.indexOf("M")?c=d.Common.l.Qa(a):(c=new Date(a+" 00:00:00"),Aa(c.valueOf())&&(c=new Date(a))),Aa(c.valueOf()))return!1;c=H.Ra(c)}}else if(e===j)c=a?1:0;else{if(!(a instanceof Date))return!1;c=H.Ra(a)}}catch(a){return!1}return b.value=c,!0}function Ca(a){var c={value:0};if(Ba(a,c))return c.value;throw b.sR().Exp_InvalidCast}function Da(a,b){return b&&(a===M||a===N||typeof a===i&&""===a.trim())}function Ea(a,b){try{if(a)if(typeof a===j);else if(a instanceof Date)a=0!==H.Ra(a);else{if(!Ga(a))return!1;a=0!==a}else a=!1}catch(a){return!1}return b.value=a,!0}function Fa(a,b,c,e,f){var g,k,l;if(Ha(a))return a;if(g={value:M},k=X,0!==b&&Da(a,e))return k;switch(b){case 1:case 5:if(c&&5!==b){if(typeof a===j&&f)return k;a=Ba(a,g)?g.value:k}else typeof a===h||(a=a instanceof Date?H.Ra(a):k);break;case 11:a=Ba(a,g)?g.value:k;break;case 4:typeof a===i?(l=d.Common.l.Qa(a),a=l!==N&&l!==M?H.Ra(l):k):c?a=Ba(a,g)?g.value:k:typeof a===h||a instanceof Date||(a=k);break;case 3:c?a=Ba(a,g)?g.value:k:typeof a!==j&&(a=k);break;case 2:a=a===M||a===N?"":""+a}return a}ga=function(){function a(a,b){this.array=a,this.referenceInTwoDimension=b}return a.prototype.getRowCount=function(){return this.array.length},a.prototype.getColumnCount=function(){var a=this.array[0];return a&&a.length||0},a.prototype.getValue=function(a,b){var c,d=this.array,e=a;return"number"!=typeof b&&(c=a,e=c.row,b=c.column),e<0||b<0||e>=d.length||b>=d[0].length?$:this.array[e][b]},a.prototype.getValueByIndex=function(a){var b=this.getColumnCount(),c=S(a/b),d=a%b;return this.getValue(c,d)},a.prototype.f5J=function(){var a,b,c,d=this,e=0,f=0;if(e=d.getRowCount())for(f=d.getColumnCount(),a=0;a<e;a++)for(b=0;b<f;b++)c=this.array[a][b],Ja(c)&&(this.array[a][b]=c.getValueByIndex(0))},a.prototype.toArray=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p;if(void 0===b&&(b=!0),h=this,i=0,j=0,k=[],n=X,i=h.getRowCount())for(j=h.getColumnCount(),o=0;o<i;o++)for(b||(m=[],k.push(m)),p=0;p<j;p++){if(l=h.getValue(o,p),h.referenceInTwoDimension&&Ja(l)&&(l=l.getValueByIndex(0)),c&&Ha(l))return k=[l],k.isError=!0,k;if(l=Fa(l,a,!1,f),d&&l===n)return k=[l],k.isConvertError=!0,k;b?k.push(l):m.push(l)}return k.rowCount=i,k.colCount=j,k.rangeCount=1,k},a.prototype.slice=function(b,c,d,e){var f,g,h,i=this,j=i.array,k=[];for(b=b<0?0:b,c=c<0?0:c,d=b+d>i.getRowCount()?i.getRowCount()-b:d,e=c+e>i.getColumnCount()?i.getColumnCount()-c:e,g=0;g<d;g++)for(f=[],k.push(f),h=0;h<e;h++)f.push(j[g+b][h+c]);return new a(k)},a}(),b.CalcArray=ga;function Ga(a,b){var c=typeof a;return c===h||c===m&&a instanceof Date||!b&&(c===j||!isNaN(a)&&!isNaN(parseFloat(a)))}function Ha(a){return a instanceof Y}function Ia(a){return a instanceof ga}function Ja(a){return a instanceof la}ha=["o","n","s","b","d"],ia=function(){function a(){}return a.jja=function(a){return Ha(a)&&a._code===b.ErrorCodeList[5]},a.Nh=function(a){return isNaN(a)||!isFinite(a)?aa:a},a.Ph=function(b,c,d,e,f,g,h,i){var j,k,l;if(b&&b.length&&b.rowCount&&b.colCount)return b;if(Ia(b))j=b.toArray(c,d,e,f,g),j.isArray=!0;else if(Ja(b))j=b.toArray(c,d,e,f,g,h,i),j.isReference=!0;else if(A(b)){if(j=[],0===b.length)return j;if(A(b[0]))return a.Oh(b,c,!0);for(k=0;k<b.length;k++)l=Fa(b[k],c,!1),l===a.CalcConvertedError&&(j.isConvertError=!0),j.push(l);j.rowCount=1,j.colCount=b.length,j.rangeCount=1}else b=Fa(b,c,!0,g),e&&a.vf(b)?(j=[$],j.isError=!0):b===a.CalcConvertedError?(j=[a.CalcConvertedError],j.isConvertError=!0):d?(j=[],j.push(b)):(j=[[]],j[0].push(b)),j.rowCount=1,j.colCount=1,j.rangeCount=1;return j},a.Oh=function(b,c,d){var e,f,g,i,k,l,m,n,o,p,q,r,s;if(!b||!b.length||!b[0].length)return e=[],e.isError=!0,[[$]];if(0===c)return b;if(f=ha[c],g=b.length,i=b[0].length,n={value:M},o=!1,p=!1,q=a.CalcConvertedError,e=b[f],!e)for(e=[],b[f]=e,r=0;r<g;r++)for(k=b[r],l=e[r]=[],s=0;s<i;s++)if(m=k[s],Ha(m))o||(e.isError=!0,o=!0),l.push(m);else{switch(c){case 1:case 5:d&&5!==c?Ba(m,n)?m=n.value:(p||(p=!0,e.isConvertError=!0),m=0):typeof m===h||m instanceof Date||(p||(p=!0,e.isConvertError=!0),m=q);break;case 3:d?Ea(m,n)?m=n.value:(p||(p=!0,e.isConvertError=!0),m=!1):typeof m!==j&&(p||(p=!0,e.isConvertError=!0),m=q);break;case 2:m=m===M||m===N?"":""+m}l.push(m)}return e},a.Rh=function(a){var c=Ca(a);if(O(c)<1e21)return parseInt(""+c,10);throw b.sR().Exp_InvalidCast},a.Sh=function(a,b){if(""===a)return!1;var c=Ba(a,b);return!!c&&(O(b.value)<1e21&&(b.value=parseInt(""+b.value,10),!0))},a.Vh=function(c){if(!c)return!1;if(typeof c===j)return c;if(c instanceof Date)return 0!==H.Ra(c);if(a.Na(c))return 0!==c;if(a.vf(c))return!1;throw b.sR().Exp_InvalidCast},a.bc=function(a){try{if(a===N||a===M)return"";if(typeof a===j)return a?k:l;if(typeof a===i)return a;if(a instanceof Date)return""+H.Ra(a);if(Ia(a))throw b.sR().Exp_InvalidCast;return typeof a===h?""+K.Lma(a,qa.CALC_PRECISION||15):""+a}catch(a){throw b.sR().Exp_InvalidCast}},a.Wh=function(c){var d={value:M};if(a.Xh(c,d))return d.value;throw b.sR().Exp_InvalidCast},a.Xh=function(a,b){var c,e,f,g;if(a)if(a===!0)b.value=d.Common.l.Xb(1);else if(a instanceof Date)b.value=new Date(a.valueOf());else if(typeof a===i){if(c=d.Common.l.Qa(a),!c)if(isNaN(a)){if(c=new Date(a),isNaN(c.valueOf()))return!1;try{if(e=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,f=J.ib(J.Db(a.replace(/ |\n/g,"")," ")," "),g=e.exec(f),g&&4===g.length&&(g.indexOf(""+c.getFullYear())===-1||g.indexOf(""+c.getMonth())===-1||g.indexOf(""+c.getDate())===-1))return!1}catch(a){return!1}}else if(c=d.Common.l.Xb(parseFloat(a)),!c)return!1;b.value=c}else{if(typeof a!==h)return!1;b.value=d.Common.l.Xb(a)}else b.value=d.Common.l.Xb(0);return!0},a.CalcConvertedError=X,a.Ca=Ia,a.Na=Ga,a.vf=Ha,a.Fh=Ja,a.wf=Fa,a.j$a=Da,a.Qh=Aa,a.Pa=Ca,a.Th=Ba,a.Uh=Ea,a}(),b.Convert=ia,function(a){a[a.unknow=0]="unknow",a[a.reference=1]="reference",a[a.number=2]="number",a[a.string=3]="string",a[a.boolean=4]="boolean",a[a.error=5]="error",a[a.array=6]="array",a[a.function=7]="function",a[a.name=8]="name",a[a.operator=9]="operator",a[a.parentheses=10]="parentheses",a[a.missingArgument=11]="missingArgument",a[a.expand=12]="expand",a[a.structReference=13]="structReference",a[a.field=14]="field",a[a.fieldItem=15]="fieldItem",a[a.tableSheetReference=22]="tableSheetReference",a[a.nameIdentity=25]="nameIdentity",a[a.externalNameIdentity=26]="externalNameIdentity",a[a.LocalName=100]="LocalName"}(ja=b.ExpressionType||(b.ExpressionType={})),ka=function(){function a(a){this.type=a}return a.prototype.sf=function(){return M},a.prototype.offset=function(a,b,c,d,e){return M},a.prototype.offsetWhenCopy=function(a,b,c,d,e,f,g,h,i,j){return M},a.prototype.getRange=function(a,b){var c,d=[];for(c=2;c<arguments.length;c++)d[c-2]=arguments[c];return M},a.prototype.forEachNodes=function(a){a(this),this.value&&this.value.forEachNodes&&this.value.forEachNodes(a),this.value2&&this.value2.forEachNodes&&this.value2.forEachNodes(a),this.arguments&&this.arguments.forEach&&this.arguments.forEach(function(b){b.forEachNodes&&b.forEachNodes(a)})},a}(),b.Expression=ka,la=function(){function a(a,b){var c=this;c.xf=a,b?(c.yf=b,c.zf=b.length):c.zf=1}return a.prototype.getRangeCount=function(){return this.zf},a.prototype.getSource=function(){return this.xf},a.prototype.create=function(b){return new a(this.xf,b)},a.prototype.getKey=function(){var a=[],b=this.xf;return this.yf.forEach(function(c){a.push(b.getRangeKey(b,c))}),1===a.length?a[0]:0===a.length?M:a.join(",")},a.prototype.toArray=function(a,b,c,d,e,f,g){var h=this.xf,i=h.referenceToArray;return i&&i.call(h,this,a,b,c,d,e,f,g)},a.prototype.getRow=function(a){return this.yf?this.yf[a||0].row:0},a.prototype.getColumn=function(a){return this.yf?this.yf[a||0].col:0},a.prototype.getRowCount=function(a){return this.yf?this.yf[a||0].rowCount:this.xf.getRowCount()},a.prototype.getColumnCount=function(a){return this.yf?this.yf[a||0].colCount:this.xf.getColumnCount()},a.prototype.getValue=function(a,b,c){var d,e,f;if(typeof a===h?(d=arguments[1],e=arguments[2],b=arguments[0]):(a=a,d=a.row,e=a.col),b=b||0,d>=0||e>=0){if(f=this.yf,!f)return this.xf.getValue(d,e);if(b<f.length)return this.xf.getValue(d+f[b].row,e+f[b].col)}return _},a.prototype.getValueByIndex=function(a){var b=this.getColumnCount(),c=S(a/b),d=a%b;return this.getValue(0,c,d)},a.prototype.isHiddenRow=function(a,b,c){return this.xf.isHiddenRow(b+this.getRow(a),c)},a.prototype.isSubtotal=function(a,b,c){var d,e=this.xf;return 0===a&&b<e.getRowCount()&&c<e.getColumnCount()&&(d=e.getCalcSourceModel().ATa(b,c),va(d))},a.prototype.getSpillRef=function(){var b,c,d,e,f,g,h,i,j,k=this;if(1!==k.getRowCount()||1!==k.getColumnCount())return _;if(b=k.getSource(),c=k.getRow(),d=k.getColumn(),e=db(c,d),f=new a(b,[e]),b&&b.RLb){if(g=b.RLb().getAnchorCell(c,d))return g.isValid?(e.rowCount=g.rowCount,e.colCount=g.colCount,f):Z.Spill;if(h=b.getCalcSourceModel(),i=h.Qf(c,d))return i.row===c&&i.col===d?(e.rowCount=i.rowCount,e.colCount=i.colCount,new a(b,[e])):void 0;if(j=h.Kf(c,d),!j||33!==j.type)return j&&("@"===j.functionName||j)?(e.rowCount=1,e.colCount=1,new a(b,[e])):void 0;f.isSpillError=!0,e.rowCount=1,e.colCount=1}return _},a}(),b.CalcReference=la,ma=function(){function a(b){this.id=a.sourceId,a.sourceId++,this.Af=b,this.Bf=null}return a.prototype.getCalcService=function(){return this.Af},a.prototype.Cf=function(){return this.Af},a.prototype.setCalcService=function(a){this.Af=a},a.prototype.getCalcSourceModel=function(){return this.Bf},a.prototype.setCalcSourceModel=function(a){this.Bf=a},a.prototype.getValue=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a];return M},a.prototype.getName=function(a){return""},a.prototype.getField=function(a){return M},a.prototype.getFieldItem=function(a){return M},a.prototype.setValue=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a]},a.prototype.getReference=function(a){return new la(this,a&&[a])},a.prototype.getSources=function(a){return[this]},a.prototype.referenceToArray=function(a,b,c,d,e,f,g,h){return a.toArray(b,c,d,e,f,g,h)},a.prototype.setFormula=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a]},a.prototype.setArrayFormula=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a]},a.prototype.getRowCount=function(){return 1e3},a.prototype.getColumnCount=function(){return 100},a.prototype.isHiddenRow=function(a,b){return!1},a.prototype.startCalculation=function(){},a.prototype.endCalculation=function(){},a.prototype.getCustomFunction=function(a){return M},a.prototype.getCustomName=function(a){return M},a.prototype.getCustomNameInfo=function(a){return M},a.prototype.refresh=function(){},a.prototype.toJSON=function(a,b){var c,d=[];for(c=2;c<arguments.length;c++)d[c-2]=arguments[c]},a.prototype.bdK=function(a,b){var c,d=[];for(c=2;c<arguments.length;c++)d[c-2]=arguments[c]},a.sourceId=1,a}(),b.CalcSource=ma;function Ka(a,b,c){var d=new ka(5);return b&&(d.source=b),c&&(d.endSource=c),d.value=a,d}b.Hh=Ka,b.Ih=Ka(_);function La(a,b){var c=new ka(7);return c.arguments=b,a instanceof ka?(c.function=a.function,c.functionName=a.functionName):(c.function=a.name&&a,c.functionName=a.name||a),c}b.Jh=La;function Ma(a,b){var c=new ka(7);return c.arguments=b,c.function=a,c}b.bVJ=Ma;function Na(a,b){var c=new ka(12);return c.value=a,c.needExpendIndexs=b,c}b.createExpandExpression=Na;function Oa(a,b,c){var d=new ka(9);return d.operatorType=a,d.value=b,18===a&&c&&c.LYJ&&(c=Qa(c.LYJ),c.NYJ=!0),d.value2=c,d}b.Kh=Oa;function Pa(a){var b=new ka(10);return b.value=a,b}b.Lh=Pa;function Qa(a){var b=new ka(3);return b.value=a,b}b.createStringExpression=Qa;function Ra(a){var b=new ka(2);return b.value=a,b}b.createNumberExpression=Ra;function Sa(a){var b=new ka(4);return b.value=a,b}b.createBooleanExpression=Sa,na=function(){function a(){}return a.Yh=function(a,b){var c=16777216,d=a===b||O(a-b)<O(a)/(c*c);return!!d||(a=K.Lma(a,15),b=K.Lma(b,15),O(a-b)<O(a)/(c*c))},a.getArrayValue=function(a,b,c){return a?b<a.getRowCount()&&c<a.getColumnCount()?a.getValue(b,c):c>=a.getColumnCount()&&1===a.getColumnCount()&&b<a.getRowCount()?a.getValue(b,0):b>=a.getRowCount()&&1===a.getColumnCount()&&c<a.getColumnCount()?a.getValue(0,c):$:$},a.tryExtractToSingleValue=function(a){var b,c=!0;return(Ja(a)||Ia(a))&&(b=ia.Ph(a,0,!1,!0),b.isError?a=b[0]:1===b.rowCount&&1===b.colCount?a=b[0][0]:(a=b,c=!1)),{value:a,success:c}},a}(),b.Zh=na;function Ta(a,b){return a.charAt(b)}b.charAtFunc=Ta;function Ua(a,b){for(var c=a.length,d=!1;b<c&&!isNaN(+Ta(a,b));)b++,d=!0;for(b<c&&"."===Ta(a,b)&&b++;b<c&&!isNaN(+Ta(a,b));)b++,d=!0;if(b<c&&("E"===Ta(a,b)||"e"===Ta(a,b)))for(b++,d=!1,b<c&&("+"===Ta(a,b)||"-"===Ta(a,b))&&b++;b<c&&!isNaN(+Ta(a,b));)b++,d=!0;return{Vi:d,mi:b}}function Va(a){return"string"==typeof a}oa=function(){function a(a){this.Di=a}return a.prototype.$j=function(a){var b,c,d,e,f,g,h,i,j=this.Di;if(z.Ca(j)||(j=[j]),j[0]===-1)return!0;for(b=0;b<j.length;b++)if(c=j[b],d=void 0,e=void 0,Va(c)){for(f=c.split(" && "),g=!0,h=0;h<f.length;h++)i=f[h].split(" "),d=i[0],e=F(i[1]),"!="===d&&a!==e||">"===d&&a>e||">="===d&&a>=e||"%="===d&&a%2===e||(g=!1);if(g)return!0}else if(a===c)return!0;return!1},a.prototype._j=function(){return this.Di},a}();function Wa(a,c){if(!a||8===a.type&&a.value.indexOf("'")>=0)throw b.sR().Exp_FormulaInvalid}b.uEc=Wa,pa=function(){function a(){this.context=[{}],this.closure={},this.backupClosure=[]}return a.prototype.getVariable=function(a){var b,c;for(a=ua(a),c=this.context.length-1;c>=0&&(b=this.context[c][a],b===N);c--);return b===N&&this.closure&&(b=this.closure[a]),b},a.prototype.setVariable=function(a,b){a=ua(a),this.context[this.context.length-1][a]=b},a.prototype.hasVariable=function(a){return a=ua(a),this.getVariable(a)!==N},a.prototype.enterScope=function(){this.context.push({})},a.prototype.exitScope=function(){this.context.pop()},a.prototype.saveThenSwitchClosure=function(a){this.backupClosure.push(this.closure),this.closure=a},a.prototype.restoreClosure=function(){this.backupClosure.length>0?this.closure=this.backupClosure.pop():this.closure={}},a.prototype.createClosure=function(){var a,b={};for(this.copyTo(this.closure,b),a=0;a<this.context.length;a++)this.copyTo(this.context[a],b);return b},a.prototype.copyTo=function(a,b){var c,d,e=Object.keys(a);for(c=0;c<e.length;c++)d=e[c],b[d]=a[d]},a}(),b.LocalScopes=pa,function(a){var c,e,f,h,i,j,k,l,n,o,p,q,r,s,t,u,v,y,A,J,L;!function(a){a[a.normal=0]="normal",a[a.allwaysExpand=1]="allwaysExpand",a[a.neverExpand=2]="neverExpand"}(c=a.ArrayArgumentEvaluateMode||(a.ArrayArgumentEvaluateMode={})),e=function(){function a(a,b,c,d){void 0===b&&(b=0),void 0===c&&(c=0),this.name=a,this.minArgs=b,this.maxArgs=c;var e=this;e.$h=d,e.typeName=""}return a.prototype.description=function(){var a=this,c=b.sR()._h;return a.$h?a.$h:c&&c[a.name]},a.prototype.acceptsArray=function(a){return!1},a.prototype.acceptsReference=function(a){return!1},a.prototype.acceptsError=function(a){return!1},a.prototype.acceptsMissingArgument=function(a){return!1},a.prototype.isVolatile=function(){return!1},a.prototype.isContextSensitive=function(){return!1},a.prototype.isBranch=function(){return!1},a.prototype.findTestArgument=function(){return-1},a.prototype.findBranchArgument=function(a){return-1},a.prototype.expandRows=function(){return!0},a.prototype.expandColumns=function(){return!0},a.prototype.skipPrecedent=function(a){return!1},a.prototype.returnReference=function(){return!1},a.prototype.evaluate=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a]},a.prototype.evaluateWithContext=function(a,b){var c=this,d=b;return c.isContextSensitive()&&(d=[a].concat(d)),c.evaluate.apply(c,d)},a.prototype.toJSON=function(){var a,b={};for(a in this)this.hasOwnProperty(a)&&(b[a]=this[a]);return b},a.prototype.fromJSON=function(a){if(a)for(var b in a)a[b]!==N&&(this[b]=a[b])},a.prototype.sEc=function(a,c,d,e){if(d<a||d>c)throw b.sR().Exp_FormulaInvalid},a.prototype.tEc=function(a,b){Wa(a,b)},a.ai=function(b,c,d){var e,f=new a(b,0,255);if(c&&"function"==typeof c&&(f.evaluate=c),d)for(e in d)d.hasOwnProperty(e)&&"override"!==e&&(f[e]=d[e]);return f},a}(),a.Function=e,f=function(a){ta(b,a);function b(b,c,d,e){return a.call(this,b,c,d,e)||this}return b.prototype.isContextSensitive=function(){return!0},b.prototype.evaluate=function(a,b){return this.evaluateAsync.apply(this,arguments)},b.prototype.evaluateAsync=function(a,b){this.evaluate.apply(this,arguments)},b.prototype.defaultValue=function(){return 0},b.prototype.evaluateMode=function(){return 0},b.prototype.evaluateWhenArgumentsIsSame=function(){return!0},b.prototype.interval=function(){return 1e4},b}(e),a.AsyncFunction=f,h=function(a){ta(b,a);function b(b,c){var d=this,e=b.arguments,f=e.slice(0,e.length-1),g=e[e.length-1];return d=a.call(this,"LAMBDA",f.length,f.length)||this,d.parameters=f,d.calculation=g,d.closure=c,d}return b.prototype.acceptsArray=function(a){return!0},b.prototype.acceptsReference=function(a){return!0},b.prototype.acceptsError=function(a){return!0},b}(e),a.LambdaFunction=h,a.AsyncFunctionEvaluateMode={onRecalculation:0,calculateOnce:1,onInterval:2},a.bi={},a.ci={};function U(b,c){return c.name=ua(c.name),a.ci[ua(b)]=c,c}a.defineGlobalCustomFunction=U;function V(c){var d,e,f;return c?(c=ua(c),d=a.bi,e=a.ci,f=b.getMapping()&&b.getMapping().builtInFunctionsMapping,d&&(ea(f,c)||d[c])||e&&e[c]):_()}a.findGlobalFunction=V;function W(){return _()}a.findGlobalFunctions=W;function Z(b){if(!b)return a.bi={},void(a.ci={});b=ua(b);var c=a.bi,d=a.ci;c[b]?delete c[b]:d[b]&&delete d[b]}a.removeGlobalFunction=Z;function _(){var b,c,d=a.bi,e=a.ci,f=[];for(b in d)f.push(d[b]);for(c in e)f.push(e[c]);return f}function ea(b,c){var d,e=a.bi;if(!B(b))for(d in b)if(b[d].alias===c)return e[d];return N}i=b.sR().Exp_Format,j=function(){function b(a,b,c){this.Ri=a,this.Si=b,this.kja=c||"i"}return b.prototype.Pi=function(){return this.Ri},b.prototype.Qi=function(){return this.Si},b.prototype.lja=function(){return this.kja},b.prototype.bc=function(b){b=b||"i";var c=this,d=c.Ri,e=c.Si,f="",g=a.CALC_PRECISION;return g&&(d=K.Lma(d,g),e=K.Lma(e,g)),0===d&&0!==e||(f+=""+d),e===-1?f+="-":0!==d&&e>0&&(f+="+"),e!==-1&&0!==e&&1!==e&&(f+=""+e),0!==e&&(f+=b),f},b}(),a.Ui=j;function fa(a){function c(a){var c,d,e,f,g=0,h=0,k=!1,l=0,m=0,n=0,o=a.length;if(!a)throw b.sR().Exp_ArgumentNull;if(0===o)throw i;if(n<o&&("+"===Ta(a,n)||"-"===Ta(a,n))&&n++,f=Ua(a,n),n=f.mi,c=f.Vi,n<o&&("+"===Ta(a,n)||"-"===Ta(a,n))?(l=n,n++,f=Ua(a,n),n=f.mi,d=f.Vi,n<o&&("i"===Ta(a,n)||"j"===Ta(a,n))&&(e=Ta(a,n),n++,k=!0),m=n-l):n<o&&("i"===Ta(a,n)||"j"===Ta(a,n))?(e=Ta(a,n),n++,m=n,d=c,k=!0,c=!1):l=n,n<o)throw i;if(l>0){if(!c)throw i;g=parseInt(a.substr(0,l),10)}if(m>0){if(!k)throw i;if(1===m||2===m&&"+"===Ta(a,l))h=1;else if(2===m&&"-"===Ta(a,l))h=-1;else{if(!d)throw i;h=parseInt(a.substr(l,m-1),10)}}return new j(g,h,e)}try{return a?"number"==typeof a?new j(a,0):"string"==typeof a?c(a):null:new j(0,0)}catch(a){return null}}a.Wi=fa,k=ia.Th,l=ia.Rh,n=ia.Pa,o=ia.Na,p=ia.Ph,q=ia.Nh,r=ia.vf,s=na.Yh;function ha(c,d,f){var g,h,i;if(B(c))throw b.sR().Exp_InvalidFunctionName;if(c=c.toUpperCase(),a.bi[c])throw b.sR().Exp_InvalidOverrideFunction;if(g=a.bi[c]){if(!f||!f.override)throw b.sR().Exp_OverrideNotAllowed}else a.bi[c]=g=new e(c,0,255);return d&&"function"==typeof d&&(g.evaluate=d),"function"==typeof f.argsValidator&&(h=g.sEc,g.sEc=function(a,b,c,d){h(a,b,c,d),f.argsValidator(a,b,c,d)}),"function"==typeof f.subExpressionValidator&&(i=g.tEc,g.tEc=function(a,b){i(a,b),f.subExpressionValidator(a,b)}),z.H(f,function(a,b){var c;C(a,["acceptsReference","acceptsArray","acceptsError","acceptsMissingArgument","skipPrecedent"])>=0?(c=new oa(b),g[a]=function(a){return c.$j(a)}):C(a,["isVolatile","isBranch","findTestArgument","returnReference","isContextSensitive","expandColumns","expandRows"])>=0?(c=new oa(b),g[a]=function(){return c._j()}):f.hasOwnProperty(a)&&(g[a]=b)}),g}function ja(a,b,c,d,e,f,g,h,i){return h||(h={}),c!==N&&(h.minArgs=c),d!==N&&(h.maxArgs=d),f!==N&&(h.acceptsReference=f),g!==N&&(h.acceptsArray=g),e!==N&&(h.Ci=e),h.bk!==N&&(h.acceptsMissingArgument=h.bk),h.ck!==N&&(h.isVolatile=h.ck),h.dk!==N&&(h.isContextSensitive=h.dk),h.VXJ!==N&&(h.haveDynamicListener=h.VXJ),h.FHJ!==N&&(h.skipPrecedent=h.FHJ),h.fk!==N&&(h.arrayArgumentEvaluateMode=h.fk),h.gk!==N&&(h.acceptsError=h.gk),i!==N&&(h.isDynamicArrayFunction=i),ha(a,b,h)}a.ak=ja,a.hk=1.79769e308;function ka(a){return"boolean"==typeof a}a.ik=ka,a.jk=Va;function ma(a){return"number"==typeof a}a.Na=ma;function pa(a){return a%400===0||a%4===0&&a%100!==0||1900===a}a.kk=pa,t=pa;function qa(a,b){switch(b){case 0:case 2:case 4:return 360;case 1:return t(a.getFullYear())?366:365;case 3:return 365;default:return-1}}a.lk=qa;function ra(a,b){return a-b}a.mk=ra;function sa(a,b){return C(b,[0,2,4,6,7,9,11])>=0?31:C(b,[3,5,8,10])>=0?30:1===b?t(a)?29:28:void 0}a.nk=sa,u=sa;function va(a,b,c,d){var e,f,g=c.getFullYear(),h=c.getMonth(),i=c.getDate(),j=d.getFullYear(),k=d.getMonth(),l=d.getDate();return a?(e=1===h&&u(g,h)===i,f=1===k&&u(j,k)===l,b?(e&&(i=30),f&&(l=30)):(e&&f&&(l=30),e&&(i=30)),31===l&&i>=30&&(l=30)):31===l&&(b?(l=1,k++):l=30),31===i&&(i=30),360*(j-g)+30*(k-h)+l-i}function wa(a,b,c){var d,e,f=1;return ra(a,b)>0&&(e=a,a=b,b=e,f=-1),d=C(c,[1,2,3])>=0?f*l(I(b)-I(a)):C(c,[4,5])>=0?f*va(!1,5===c,a,b):f*va(!0,6===c,a,b)}a.pk=wa;function xa(a){var b,c,d;return 0===a?c=0:(d=.5*O(a),d>=3?c=1:d<1?(b=d*d,c=((((((((.000124818987*b-.001075204047)*b+.005198775019)*b-.019198292004)*b+.059054035642)*b-.151968751364)*b+.319152932694)*b-.5319230073)*b+.797884560593)*d*2):(d-=2,c=(((((((((((((-45255659e-12*d+.00015252929)*d-19538132e-12)*d-.000676904986)*d+.001390604284)*d-.00079462082)*d-.002034254874)*d+.006549791214)*d-.010557625006)*d+.011630447319)*d-.009279453341)*d+.005353579108)*d-.002141268741)*d+.000535310849)*d+.999936657524)),a>0?.5*(c+1):.5*(1-c)}a.qk=xa;function ya(a,c,d,e,f){var g,h,i,j,k,l,m,n,o,r,s,t,u,v,w=d<100,x=2===d||102===d,y=x||3===d||103===d,z=5===d||105===d,A=4===d||104===d||z,C=9===d||109===d,E=1===d||101===d||C||e,F=6===d||106===d,G=F?1:0,H=!1,I=0;for(g=0;g<D(a);g++){if(r=a[g],s=void 0,y?s=p(r,0,!1,!1,!1,x):(t=1,(!b.ExcelCompatibleCalcMode||Ia(r)||Ja(r))&&(t=5),s=p(r,t,!1,!1,!1,!0)),s.isError)return s[0];if(s.isConvertError)return $;for(u=s.rangeCount,v=s.isReference,h=0;h<u;h++)for(i=u>1?s[h]:s,v&&(j=r.getRow(h),k=r.getColumn(h)),l=0;l<D(i);l++)if(2===c||!v||!r.isHiddenRow(h,l,w))for(n=i[l],m=0;m<D(n);m++)if(!(1!==c&&2!==c&&v&&r.isSubtotal(h,l+j,m+k)||(o=n[m],null===o||o===X))){if(o&&o._error&&!y)return f&&(f.sumx=0,f.sumx2=0,f.n=0),o;y&&!B(o)&&(!x||""!==o&&ia.Na(o,!0))?G++:A&&(!H||z&&o<G||!z&&o>G)?G=o:E?e?(f.sumx+=o,f.sumx2+=o*o,f.n++,f.values.push(o),f.values[0]!==o&&(f.allSame=!1)):(G+=o,I++):F&&(G*=o,I++),H=!0}}return E?C?G:e?void 0:0===I?ba:q(G/I):F?q(I>0?G:0):G}a.Ogc=ya;function za(a,b,c){var d,e,f=c%100,g=7===f||8===f,h=7===f||10===f?1:0,i={sumx:0,sumx2:0,n:0,values:[],allSame:!1},j=ya(a,b,c,!0,i);if(j&&j._error)return j;if(i.n<=h)return ba;if(i.allSame)j=0;else if(s(i.n*i.sumx2,i.sumx*i.sumx))for(j=0,d=i.sumx/i.n,e=0;e<i.n;e++)j+=R(i.values[e]-d,2);else j=i.sumx2-i.sumx*i.sumx/i.n;return j/=i.n-h,q(g?Math.sqrt(j):j)}a.sk=za;function Aa(a,b,c,d){var e,f,g,h,i,j,k,o,q,s,t,u,v,w,x,y,z,A,B,C;if(null===c)return $;if(c=parseInt(c,10),c<=0||c>19)return $;b||(b=0),e=1===b||3===b||5===b||7===b,f=1===b||2===b||3===b||0===b,g=2===b||3===b||6===b||7===b,h=2===c,i=h||3===c,j=12===c,k=13===c,o=14===c,q=15===c,s=16===c,t=17===c,u=18===c,v=19===c,w=o||q||s||t||u||v,x=[];function E(a){var b,d,j,k,l,n,o,q,s,t,u,v=[];if(b=i?p(a,0,!1,!1,!1,!1):p(a,5,!1,!1,!1,!1),b.isConvertError)return $;for(t=b.rangeCount,u=b.isReference,d=0;d<t;d++)for(j=t>1?b[d]:b,u&&(k=a.getRow(d),l=a.getColumn(d)),n=0;n<D(j);n++)if(!(u&&a.isHiddenRow(d,n,!1)&&e))for(q=j[n],o=0;o<D(q);o++)if(!(u&&f&&a.isSubtotal(d,n+k,o+l)||(s=q[o],null===s||g&&r(s)||r(s)&&h))){if(!g&&r(s)&&3!==c)return s;typeof s===m&&0===Object.keys(s).length||v.push(s)}return v}function F(a){var b,c=a.getRow(0),e=a.getColumn(0),f=a.getRowCount(0),g=a.getColumnCount(0);if(1===f&&1===g)b=a.getValue(0,0,0);else if(1!==f&&1===g&&c<=d.row&&d.row<c+f)b=a.getValue(0,d.row-c,0);else{if(!(1===f&&1!==g&&e<=d.column&&d.column<e+g))return $;b=a.getValue(0,0,d.column-e)}return b===M||""===b?aa:isNaN(parseInt(b,10))?$:parseFloat(b)}if(y=D(a),w){if(2!==y)return $;if(x=E(a[0]),x._error)return x;if(z=void 0,a[1]===M)return aa;if(a[1]instanceof la)z=F(a[1]);else if(a[1]instanceof ga)z=a[1].array[0][0];else{if(isNaN(parseInt(a[1],10)))return $;z=n(a[1])}return z._error?z:(17!==c&&19!==c||(z=l(z)),Ya([x,z],c))}for(A=0;A<y;A++)if(!(a[A]instanceof la))return $;for(A=0;A<y;A++){if(B=E(a[A]),!(B instanceof Array))return B;x.push.apply(x,B)}return j||k?Ya([x],c):7===c||8===c||10===c||11===c?(C=f?1:0,za(x,C,c)):ya(x,1,c)}a.mja=Aa;function Ca(a){var b=a.charCodeAt(0);return b>=0&&b<129||63728===b||b>=65377&&b<65440||b>=63729&&b<63732?"singleByte":b>=55296&&b<=57343?"fourByte":"doubleByte"}a.UAb=Ca;function Da(a){var b,c=[];for(b=0;b<a.length;b++)B(a[b])?(c[b]=a[b+1],b++):c[b]=a[b];return c.length===a.length-1&&(c[c.length]=N),c}a.WAb=Da;function Ea(a){var b,c,d,e,f=[],g=0,h=0;for(c=0;c<a.length;c++){if(b=a[c],d=Ca(a[c]),"doubleByte"===d||"fourByte"===d)if("fourByte"===d){if(g%2===0){g++;continue}h++,g++,b=a[c-1]+a[c]}else h++,b=a[c];e=g>0?g/2:0,f[c-e+h]=b}return Da(f)}a.VAb=Ea;function Fa(a,b){var c,d;for(void 0===b&&(b=!0),c=[],d=0;d<D(a);d++)Ka(a[d],c,b);return c}function Ga(a){a.sort(function(a,b){return a-b})}function Ka(a,b,c){var d,e;for(void 0===c&&(c=!0),d=0;d<D(a);d++)e=a[d],e!==X&&b.push(e);c&&Ga(b)}function La(){var a,b,c,d=[];for(a=0;a<arguments.length;a++)d[a]=arguments[a];return b=Fa(arguments[0]),c=D(b),0===c?aa:c%2===0?(n(b[c/2-1])+n(b[c/2]))/2:b[F(""+c/2)]}function Ma(){var a,b,c,d,e,f,g,h,i=[];for(a=0;a<arguments.length;a++)i[a]=arguments[a];for(b=M,c=0,d=Fa(arguments[0],!1),e=D(d),f=0;f<e;f++){for(h=0,g=0;g<e;g++)g!==f&&d[g]===d[f]&&h++;h>c&&(c=h,b=d[f])}return 0===c?ca:b}function Na(a,b){return Pa(!0,a,b)}function Oa(a,b){return Pa(!1,a,b)}function Pa(a,b,c){var d,e=[];return Ka(b,e),d=D(e),c<1||d<c?aa:(c=a?T(c):S(c),a?e[d-c]:e[c-1])}function Qa(a,b){var c,d,e;return a=p(a,1,!0,!0,!1,!0),b=n(b),a.isError?a[0]:a.isConvertError||G(b)?$:(c=[],Ka(a,c),!D(c)||b<0||b>1?aa:(d=b*(D(c)-1),e=d%1,d=F(""+d),0===e?c[d]:n(c[d])+e*(n(c[d+1])-n(c[d]))))}function Ra(a,b){var c=C(b,[0,1,2,3,4]);return c<0?aa:Qa(a,.25*c)}function Sa(a,b){var c,d,e,f,g,h,i=D(a),j=[];for(c=0;c<i;c++)o(a[c],!0)&&j.push(a[c]);return j.length?(d=j.length,Ga(j),e=b*(d+1)-1,f=e%1,e<0||d-1<e?aa:(g=S(e),h=j[g],0===f?h:h+f*(j[g+1]-h))):aa}function Xa(a,b){var c=C(b,[1,2,3]);return c<0?aa:Sa(a,.25*(c+1))}function Ya(a,b){var c=12===b,d=13===b,e=14===b,f=15===b,g=16===b,h=17===b,i=18===b,j=19===b;return c?La(a):d?Ma(a):e?Na(a[0],a[1]):f?Oa(a[0],a[1]):g?Qa(a[0],a[1]):h?Ra(a[0],a[1]):i?Sa(a[0],a[1]):j?Xa(a[0],a[1]):da}a.sja=Ya;function Za(a){var b=1,c;for(c=a;c>1;c--)b*=c;return b}a.tk=Za;
function $a(a,b,c){var d=a.getDate(),e=b.getDate(),f=a.getMonth(),g=b.getMonth(),h=a.getFullYear(),i=b.getFullYear();return d=31===d?30:d,c?e=31===e?30:e:31===e&&(d<30?(e=1,g++,g>12&&(g=1,i++)):e=30),30*(12*(i-h)+g-f)+e-d}a.uk=$a;function _a(a,b,c){var d,e,f,g,h,i,j,k,m,o=wa(a,b,c);return o<0&&(o=-o,e=a,a=b,b=e),1===c?(f=a.getFullYear(),g=b.getFullYear(),h=void 0,i=void 0,j=void 0,k=void 0,h=new Date(a.valueOf()),h.setFullYear(h.getFullYear()+1),ra(b,h)>0?(k=g+1-f,h=new Date(f,0,1),i=new Date(g+1,0,1),j=l(I(i)-I(h))-365*(g+1-f)):(k=1,j=t(f)&&a.getMonth()<x||t(g)&&256*b.getMonth()+b.getDate()>=256*w+29?1:0),m=n(j)/n(k),d=365+m):d=qa(new Date,c),o/d}function ab(a,b,c){return c<0||c>4?aa:_a(a,b,c)}a.vk=ab;function bb(a,b,c){var d;return 0===a?d=b<=c:1===a?d=b>=c:2===a?d=b!==c:3===a?d=b<c:4===a?d=b===c:5===a&&(d=b>c),d}function cb(a,c){var e,f,g,h=-1,i=!0,j={value:0},l=E.zb(c);if(4!==a&&2!==a||!l||(f=c.replace(/\*+/g,"*"),f!==c&&(l=E.zb(f)),e=function(b){if(""===b)return 2===a;var c=E.sb(l);return c.lastIndex=0,4===a?c.test(b):!c.test(b)}),4===a&&d.Common.F(c,Date))return function(a,b){var d={value:null};return!(!a||!ia.Xh(a,d))&&d.value.getTime()===c.getTime()};Va(c)&&(g=Y.parse(c),g&&(c=g));function m(a){return 0===(""+a).trim().length}return B(c)?h=0:l?i=!1:m(c)||G(parseFloat(c))||!k(c,j)?i=!1:h=j.value,function(d,f,g){var j,m;return(""!==c||4===a||2===a)&&(g&&(r(d)||r(c))?r(d)&&r(c)?d._code!==c._code?2===a:0===a||1===a||4===a:2===a:!(!f&&d instanceof Y)&&(B(d)&&(d=""),j={value:0},!(b.ExcelCompatibleCalcMode&&i&&!o(d,!0)&&4!==a&&2!==a)&&(b.ExcelCompatibleCalcMode&&i&&"boolean"==typeof d?2===a:i&&k(d,j)?""===d||d.trim&&""===d.trim()?2===a:bb(a,j.value,h):l&&o(d,!0)?2===a:(m=B(c)?"":(""+c).toUpperCase(),l&&e?e(""+d):bb(a,(""+d).toUpperCase(),m)))))}}v=function(){function a(a,b,c,d){var e,f,g;if(this.criteria=a,"function"==typeof b&&(e=b,b=null),c&&(c.HkK=!0),b=b||p(c,0,2,!1,!1),e){for(f=[],g=0;g<D(b);g++)f[g]=e(b[g]);b=f}this.array=b,a!==M&&"function"!=typeof a&&(d&&b.k4J?this.useMap=!0:this.criteria=function(b){return b===a})}return a.prototype.l4J=function(a){var b,c=this.criteria,d=this.array;if(!B(c))if(this.useMap)d.k4J.has(c)&&d.k4J.get(c).forEach(function(b){a(b)});else for(b=0;b<D(d);b++)if(c(d[b])&&a(b))return},a.prototype.i4J=function(a){return this.criteria&&this.criteria(this.array[a])},a.prototype.dispose=function(){delete this.criteria,delete this.array},a}(),a.RangeCriteria=v,function(a){a[a.unCompatibleDoubleEqual=0]="unCompatibleDoubleEqual",a[a.compatibleDoubleEqual=1]="compatibleDoubleEqual",a[a.stringEqual=2]="stringEqual"}(y||(y={})),A=function(){function c(){this.referenceCache={}}return c.prototype.dispose=function(){delete this.referenceCache},c.prototype.xk=function(a){var b,c,d;if(B(a))return[4,0];if(o(a))return[4,a];if(Va(a)){switch(b=B(a)?"":a.toUpperCase(),c=b[0],d=b[1],c+d){case"<>":return[2,2===b.length?null:b.substring(2)];case"<=":return[0,2===b.length?null:b.substring(2)];case">=":return[1,2===b.length?null:b.substring(2)]}switch(c){case"=":return[4,1===b.length?null:b.substring(1)];case"<":return[3,1===b.length?null:b.substring(1)];case">":return[5,1===b.length?null:b.substring(1)]}return[4,a.toUpperCase()]}return[4,a]},c.m4J=function(a){return 0===(""+a).trim().length},c.n4J=function(b){return ka(b)||a.jk(b)&&("TRUE"===b.toUpperCase()||"FALSE"===b.toUpperCase())},c.o4J=function(a){return ka(a)?a:"TRUE"===a.toUpperCase()},c.getCompareFunction=function(a){return 0===a?function(a,b){return a<=b}:1===a?function(a,b){return a>=b}:2===a?function(a,b){return a!==b}:3===a?function(a,b){return a<b}:4===a?function(a,b){return a===b}:5===a?function(a,b){return a>b}:void 0},c.prototype.p4J=function(d,e,f,g){var h,i,j,k,l=null,m=E.zb(e);return m&&(i=e.replace(/\*+/g,"*"),i!==e&&(m=E.zb(i))),4===f||2===f?m?"^[\\s\\S]*$"===m?l=b.ExcelCompatibleCalcMode?4===f?function(b){return a.jk(b)}:function(b){return!a.jk(b)}:4===f?function(b){return""!==b&&a.jk(b)}:function(b){return!Ha(b)&&(""===b||!a.jk(b))}:(j=E.sb(m),l=4===f?function(b){return j.lastIndex=0,a.jk(b)&&j.test(b)}:function(b){return!Ha(b)&&(j.lastIndex=0,!a.jk(b)||!j.test(b))}):""===e?l=4===f?function(a){return""===a||B(a)}:function(a){return""!==a&&!B(a)}:4===f?(h=this.q4J(d,y.stringEqual,g,function(a){return a&&a.toUpperCase&&a.toUpperCase()}),l=e):l=b.ExcelCompatibleCalcMode?function(a){return e!==(a&&a.toUpperCase&&a.toUpperCase())}:function(a){return!Ha(a)&&e!==(a&&a.toUpperCase&&a.toUpperCase())}:(k=c.getCompareFunction(f),l=b.ExcelCompatibleCalcMode?function(a){return Va(a)&&k(a.toUpperCase(),e)}:m?function(a){return!Ha(a)&&(B(a)&&(a=""),!ma(a)&&!H.Ska(a)&&k((""+a).toUpperCase(),e))}:function(a){return!Ha(a)&&(B(a)&&(a=""),k((""+a).toUpperCase(),e))}),new v(l,h,d,g)},c.prototype.q4J=function(a,b,c,d){var e,f,h,i,j;if(Ja(a)&&this.referenceCache){if(e=a.getKey()+","+b,f=this.referenceCache[e],!f)for(this.referenceCache[e]=f=[],h=a.toArray(0,2,!1,!1),i=0;i<D(h);i++)f[i]=d(h[i]);return c&&!f.k4J&&(f.k4J=j=g.createMap(),f.forEach(function(a,b){var c=j.get(a);c||(c=[],j.set(a,c)),c.push(b)})),f}return d},c.prototype.h4J=function(e,f,g){var h,i,j,l=this.xk(f),m=l[0],n=l[1],o=null,p={value:n},q={value:0},r=c.getCompareFunction(m);if(b.ExcelCompatibleCalcMode)if(null===n)4===m?o=function(a){return B(a)}:2===m&&(o=function(a){return!B(a)});else if(c.n4J(n))i=c.o4J(n),o=4===m?i:2===m?function(a){return a!==i}:function(a){return ka(a)&&r(a,i)};else if(!c.m4J(n)&&k(n,p))4===m?0===p.value?o=function(a){return 0===a||"0"===a}:(h=this.q4J(e,y.compatibleDoubleEqual,g,function(a){return!c.n4J(a)&&Ba(a,q)?q.value:N}),o=p.value):o=2===m?function(a){return a=H.Ska(a)?I(a):a,!ma(a)||a!==p.value}:function(a){return a=H.Ska(a)?I(a):a,ma(a)&&r(a,p.value)};else{if(a.jk(n))return this.p4J(e,n,m,g);Ha(n)&&(o=n)}else if(null===n)o=4===m?function(a){return B(a)}:2===m?function(a){return!Ha(a)&&(!B(a)&&!c.m4J(a))}:f;else if(!c.n4J(n)||4!==m&&2!==m)if(4===m&&d.Common.F(n,Date))n=n.getTime(),o=function(a){if(a&&ia.Xh(a,q))return q.value.getTime()===n};else if(!c.m4J(n)&&k(n,p))4===m?(h=this.q4J(e,y.unCompatibleDoubleEqual,g,function(a){return B(a)||c.m4J(a)||!Ba(a,q)?N:q.value}),o=p.value):o=2===m?function(a){return!Ha(a)&&(a=H.Ska(a)?I(a):a,!(!B(a)&&!c.m4J(a)&&Ba(a,q)&&q.value===p.value))}:function(b){if(b=H.Ska(b)?I(b):b,!B(b)&&!c.m4J(b)){if(Ba(b,q))return r(q.value,p.value);if(a.jk(b))return r((""+b).toUpperCase(),(""+n).toUpperCase())}return!1};else{if(a.jk(n))return this.p4J(e,n,m,g);Ha(n)&&(o=null)}else j=(""+n).toUpperCase(),o=4===m?function(a){return c.n4J(a)&&(""+a).toUpperCase()===j}:2===m?function(a){return!Ha(a)&&(!c.n4J(a)||(""+a).toUpperCase()!==j)}:function(a){return ka(a)&&r(a,j)};return new v(o,h,e,g)},c.prototype.j4J=function(a,b,c){var d=this.h4J(a,b,!0);d.l4J(c)},c}(),a.RangeCriteriaManager=A,J={},L=function(){function b(){}return b.wk=function(a){var b=S(a);return s(a,b+1)?b+1:b},b.i_J=function(a){var b,c,d;if(o(a))return[4,a];switch(b=B(a)?"":(""+a).toUpperCase(),c=b[0],d=b[1],c+d){case"<>":return[2,b.substring(2)];case"<=":return[0,b.substring(2)];case">=":return[1,b.substring(2)]}switch(c){case"=":return[4,b.substring(1)];case"<":return[3,b.substring(1)];case">":return[5,b.substring(1)]}return[4,a]},b.xk=function(a){var c,d;return J||(J=J={}),c=J[a],c||(d=b.i_J(a),c=J[a]=cb(d[0],d[1])),c},b.yk=function(a){var b=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][a];return a>308&&(a=308),B(b)?R(10,parseFloat(a)):b},b.zk=function(a){var b=T(a);return s(a,b-1)?b-1:b},b.Ak=function(a,c){for(var d,e,f=b.yk(O(c)),g=T,h=S,i=c,j=i<0?a/f:a*f;O(i)>2&&j===1/0;)i=Math.round(i/2),f=b.yk(O(i)),j=i<0?a/f:a*f;return a=j,d=a.toExponential(),e=F(d.split("e")[1])+1,e<=15&&e>=-85&&(a=parseFloat(a.toFixed(15-e))),a=a<0?g(a-.5):h(a+.5),a=c<0?a*f:a/f,q(a)},b.Bk=function(a,b){var c,d;if(a<0||b<0||a<b)return aa;for(c=1,b=Math.min(a-b,b),d=1;d<=b;d++)c*=a-d+1,c/=d;return q(c)},b.iEc=function(a,b){if(a<0&&O(b)<1){var c=(1/b).toPrecision(15);if(parseFloat(c)===parseInt(c,10)&&parseInt(c,10)%2!==0)return-R(-a,b)}return R(a,b)},b.Ck=function(b,c){var d=O(b)>.5?R(1+b,c):P(c*Q(1+b));return isFinite(d)?G(d)&&(d=5e-324):d===Number.POSITIVE_INFINITY?d=a.hk:d===Number.NEGATIVE_INFINITY&&(d=-a.hk),d},b.Dk=function(a,b){return(P(a)+(b?-1:1)*P(-a))/2},b.Ek=function(a,b){return G(a)?a:G(b)?b:1!==b&&1===a||0!==b&&b!==Number.POSITIVE_INFINITY?Q(a)/Q(b):NaN},b}(),a.MathHelper=L}(qa||(qa={})),b.Functions=qa,ra=function(a,b){return a.localeCompare(b)},navigator&&"th"===navigator.language&&(ra=function(a,b){var c=a.localeCompare(b);return 0===c&&a!==b?a>b?1:-1:c});function Xa(a,b,c){var e,f;try{f=d.Common.CultureManager.getCultureInfo(),e=f.localeCompare?c?f.localeCompare(a,b):f.localeCompare(a.toLowerCase(),b.toLowerCase()):c?ra(a,b):ra(a.toLowerCase(),b.toLowerCase())}catch(d){e=c?ra(a,b):ra(a.toLowerCase(),b.toLowerCase())}return e}b.Zhc=Xa;function Ya(a,b,c){var d,e,f,g,h,k,l,m,n,o;if(void 0===c&&(c=!0),Ha(a))return a;if(Ha(b))return b;if(e=typeof a===j,f=typeof b===j,e||f)d=e&&f?a===b?0:a>b?1:-1:e?1:-1;else{if(g=typeof a===i,h=typeof b===i,k=g||h,l=k?"":0,a=a===M||a===N?l:a,b=b===M||b===N?l:b,m=function(){return a===b?0:g&&h?Xa(a,b,c):g?1:h?-1:(a=K.Lma(a,15),b=K.Lma(b,15),a-b)},!k){if(n={value:0},o={value:0},!Ba(a,n)||!Ba(b,o))return $;a=n.value,b=o.value}d=m()}return d}b.pOb=Ya;function Za(a){return a instanceof qa.Function}b.isFunction=Za;function $a(a){return a instanceof qa.LambdaFunction}b.isLambdaFunction=$a;function _a(a){return a instanceof ka}b.isExpression=_a;function ab(a,b){return!Za(a)||a.acceptsArray(b)}b.getFunctionAcceptsArray=ab;function bb(a,b){return!Za(a)||a.acceptsReference(b)}b.getFunctionAcceptsReference=bb;function cb(a){return a&&a.arrayArgumentEvaluateMode}b.getFunctionArrayArgumentEvaluateMode=cb,sa=function(a){ta(b,a);function b(b){var c=a.call(this,M)||this;return c.u4=b,c}return b.prototype.startCalculation=function(){},b.prototype.endCalculation=function(){},b.prototype.getValue=function(){return Z.Reference},b.prototype.getReference=function(){var a=new la(this,[db(0,0)]);return a.getValue=function(){return Z.Reference},a},b.prototype.referenceToArray=function(){var a=[Z.Reference];return a.isError=!0,a},b.prototype.getName=function(){return this.u4},b.prototype.setValue=function(){},b}(ma),b.ErrorSource=sa;function db(a,b){return{row:a,col:b}}},"./src/calc.entry.ts":function(a,b,c){"use strict";var d,e;function f(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),f(c("./src/calc.common.ts")),f(c("./src/Parser.ts")),f(c("./src/evaluator.ts")),f(c("./src/calc.ts")),f(c("./src/referenceExpression.ts")),f(c("./src/map.ts")),d=c("./src/calc.ts"),Object.defineProperty(b,"supportRowColumnFormula",{set:function(a){d.supportRowColumnFormula=a},get:function(){return d.supportRowColumnFormula}}),Object.defineProperty(b,"approximatelyEqual",{set:function(a){d.approximatelyEqual=a},get:function(){return d.approximatelyEqual}}),e=c("./src/calc.common.ts"),Object.defineProperty(b,"ExcelCompatibleCalcMode",{set:function(a){e.ExcelCompatibleCalcMode=a},get:function(){return e.ExcelCompatibleCalcMode}})},"./src/calc.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/calc.common.ts"),f=c("./src/referenceExpression.ts"),g=c("./src/Parser.ts"),h=c("./src/evaluator.ts"),i=c("./src/map.ts"),j=d.Common.F,k=d.Common.A,l=d.Common.B,m=d.Common.u,n=d.Common.l,o=null,p=void 0,q=Math.abs,r=e.Errors.Name,s=e.Errors.Reference,t=e.Errors.Value,u=e.Errors.NotAvailable,v=e.Errors.Calc,w=e.Convert.Ca,x=e.Convert.Fh,y=m.Nb,z=d.Common.j,A=z.Fa,B=Math.min,C={},D="cellListeners",E="rowSliceListeners",F="nameIDListeners",G="number",H="string",I="boolean",b.approximatelyEqual=function(a,b,c){if(void 0===a&&(a=0),void 0===b&&(b=0),a===b||j(a,e.CalcError)&&j(b,e.CalcError)&&a._code===b._code)return!0;var d=1;return j(a,Date)&&j(b,Date)?d=864e5:j(a,Date)?a=n.Ra(a):j(b,Date)&&(b=n.Ra(b)),q(b-a)/d<c};function V(a,b){var c,d,e,f=a.ah&&a.ah.getSource();f&&(c=a.row,d=a.column,e=f.getValue(c,d),f.setValue(c,d,b,e))}b.supportRowColumnFormula=!1,J=function(){function a(a){this.Ze=[],this.ah=a}return a.prototype.getKey=function(){return""},a.prototype.hasListeners=function(){var a,b,c,d,e=this,f=e.Ze;for(a=0,b=f;a<b.length;a++)if(c=b[a],d=this[c],d&&d.size>0)return!0;return!1},a.prototype.gmb=function(a,b,c){var d,e,f,g;b.p9J?(this.q9J||(this.q9J=i.createMap()),d=this.q9J):(this[a]||(this.Ze.push(a),this[a]=i.createMap()),d=this[a]),e=b.getKey(),b.YDc&&b.YDc.length>=1&&(f=b.YDc,g=f[f.length-1],g.push(this),e="?"+e),c?d.set(e,b):d.delete(e)},a.prototype.bJJ=function(a,b,c){var d=this[a],e=b.getKey();e="!"+e,d||(this.Ze.push(a),d=this[a]=i.createMap()),c?d.set(e,b):d.delete(e)},a.prototype.Yg=function(){var a,b,c,d,e=[];for(a=0;a<arguments.length;a++)e[a]=arguments[a];for(b=this.Ze,c=0;c<b.length;c++)d=this[b[c]],d&&d.forEach(function(a){a&&a.bh()});this.q9J&&this.q9J.forEach(function(a){a&&a.bh()})},a.prototype.Bg=function(){var a,b,c,d,e=[];for(a=0;a<arguments.length;a++)e[a]=arguments[a];for(b=this.Ze,c=0;c<b.length;c++)d=this[b[c]],d&&d.forEach(function(a){!a||a.dh||a.eh||a.fh()})},a.prototype.gh=function(){var a,b,c,d,e,f,g,h,i,j,k,l=[];for(a=0;a<arguments.length;a++)l[a]=arguments[a];for(b=l[0],c=this,d=this.Ze,e=b?1:-1,f=0;f<d.length;f++)g=this[d[f]],g&&g.forEach(function(a,d){if("?"===d[0]){if(!b&&c.ZDc)for(;c.ZDc.indexOf(a)>=0;)c.ZDc.splice(c.ZDc.indexOf(a),1),a.delay--}else a&&(a.delay+=e,b&&a.y$a&&a.y$a())});if(h=c.node&&c.node.Pf,h&&h.isDynamicArray)for(i=0;i<h.rowCount;i++)for(j=0;j<h.colCount;j++)0===i&&0===j||(k=c.ah.getNode(i+h.row,j+h.col),k&&k.calc&&k.calc.gh(b))},a.prototype.bh=function(){},a.prototype.fh=function(){},a.prototype.ng=function(){},a.prototype.og=function(){},a.prototype.ZAb=function(){return this.ah.Cf()},a}(),b.BaseCalc=J,K=function(a){U(b,a);function b(b,c){var d=a.call(this,b)||this;return d.name=c,d.delay=0,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.name},b.prototype.og=function(){var a=this;a.ah.Og(a.name,!0)},b.prototype.ng=function(){var a=this;a.ah.Og(a.name,!1)},b.prototype.bh=function(){this.ZAb().onAddAdjust(this,3)},b.prototype.fh=function(){this.ZAb().pg(this,3)},b}(J),b.NameIDCalc=K,L=function(a){U(b,a);function b(b,c,d){var e=a.call(this,b)||this;return e.id=c,e.name=d,e.delay=0,e}return b.prototype.getKey=function(){var a=this;return a.ah.getName()+","+a.id+"#"+a.name},b.prototype.og=function(){var a=this;a.ah.Ig(a.id,a.name,!0)},b.prototype.ng=function(){var a=this;a.ah.Ig(a.id,a.name,!1)},b.prototype.ZAb=function(){return this.ah.Af},b.prototype.bh=function(){this.ZAb().onAddAdjust(this,6)},b.prototype.fh=function(){this.ZAb().pg(this,6)},b}(J),b.PathCalc=L,M=function(){function a(){this.autoCalculation=!0,this.jh={},this.useR1C1=!1,this.allowDynamicArray=!1,this.iterativeCalculation=!0,this.iterativeCalculationMaximumIterations=1e3,this.iterativeCalculationMaximumChange=.01,this.dynamicReferences=!0,this.mh=0,this.Bka=0,this.hmb=[];var a=this;a.kh=new g.Parser,a.lh=new h.Evaluator(a),a.nh=a.uzb&&a.uzb(),a.addResolver(new g.DefaultTokenResolver),a.hkK={ikK:!0}}return a.prototype.j_J=function(a,b,c){var d,e,f=this;if(f.k_J=f.k_J||{},d=f.k_J[b]=f.k_J[b]||[],c)d.push(a);else for(e=0;e<d.length;e++)d[e]===a&&(d.splice(e,1),e--)},a.prototype.S$J=function(a){var b=this,c=b.k_J&&b.k_J[a];c&&c.forEach(function(a){a.fh()})},a.prototype.getResolvers=function(){return this.hmb},a.prototype.addResolver=function(a){var b,c=this.hmb;for(b=0;;b++)if(!c[b]||a.priority>c[b].priority){c.splice(b,0,a);break}},a.prototype.dispose=function(){var a=this;a.jh={},a.oh=o},a.prototype.cloneFrom=function(a){var b=this;b.useR1C1=a.useR1C1,b.mh=a.mh,b.qh=a.qh,b.calcOnDemand=a.calcOnDemand,b.dynamicReferences=a.dynamicReferences},a.prototype.ih=function(){return this.nh},a.prototype.getExternalSource=function(a,b){var c,d,e=this,f=e.getAllSourceModels();for(c=0,d=f.length;c<d;c++)if(m.Mb(f[c].getSource().getName(),b))return f[c].getSource();return o},a.prototype.getSourceModel=function(a){var b=this.jh[a.id];return b||(b=a.createSourceModel?a.createSourceModel(this):this.createSourceModel(this,a),this.jh[a.id]=b,a.setCalcSourceModel(b),a.setCalcService(this)),b},a.prototype.getGlobalSourceModel=function(a){return this.oh||(a=a||new e.CalcSource,a.createSourceModel?this.oh=a.createSourceModel(this):this.oh=this.createSourceModel(this,a),a.setCalcSourceModel(this.oh)),this.oh},a.prototype.setSourceModel=function(a,b){this.jh[a.id]=b,b.setCalcService(this)},a.prototype.getAllSourceModels=function(){var a,b=[],c=this.jh;for(a in c)b.push(c[a]);return b},a.prototype.removeSource=function(a){var b,c,d,e,f,g;this.suspend(),b=this.jh[a.id],b&&(""!==a.getName()&&this.onRemoveSource(a),delete this.jh[a.id]),this.clearDirties(),c=this.jh;for(e in c)d=c[e],d.addDirtyNodesForCalc(!1);f=this.Dh&&this.Dh.kj,g=a&&a.kj,f&&g&&g===f&&(this.Dh=null),this.resume(!1)},a.prototype.clearSource=function(){this.jh={},this.Dh=null,this.clearDirties()},a.prototype.ignoreDirty=function(){return this.qh},a.prototype.suspend=function(a){this.mh++,this.qh=!!a},a.prototype.resume=function(a){var b=this;b.mh--,b.mh<0&&(b.mh=0),b.IsSuspended()||(b.rh=o,b.qh=!1,b.recalculateAll(a))},a.prototype.suspendAdjust=function(){this.Bka++},a.prototype.resumeAdjust=function(){var a=this;a.Bka--,a.Bka<0&&(a.Bka=0)},a.prototype.isAdjustSuspended=function(){return this.Bka>0},a.prototype.clearDirties=function(a){var b,c,d,e,f=this,g=f.imb,h=f.jmb;if(g){b=!1;for(c in g)if(g.hasOwnProperty(c)){if(a&&a[c]){b=!0;continue}for(d=g[c];d;)e=d.eh,d.$l=!1,e?(d.eh=e.dh=p,d=e):d=o;delete g[c],h&&!A(h[c])&&delete h[c]}b||(f.imb=f.jmb=o)}},a.prototype.F9J=function(){this.hkK.ikK=!1,this.hkK={ikK:!0}},a.prototype.resumeWithoutCalc=function(){this.mh--,this.mh<0&&(this.mh=0),this.clearDirties({3:!0,6:!0}),this.qh=!1,this.imb&&this.recalculateAll(!1),this.F9J()},a.prototype.IsSuspended=function(){return this.mh>0},a.prototype.recalculateAll=function(a,b){var c=this;c.IsSuspended()||(c.u$J=!0,c.jVJ(a,b),delete c.u$J,c.dZJ&&(c.dZJ.forEach(function(a){a[0].Ag(a[1].row,a[1].col,a[1].rowCount,a[1].colCount)}),c.jVJ(!1,!0),delete c.dZJ))},a.prototype.processDynamicRef=function(){var a,b,c,d,e,f,g,h,i,j=this;if(j.UXJ){if(a=j.imb,b=null,a)for(b=[],c=void 0,d=a[0];d;d=c)b.push(d),c=d.eh;e=j.jh;for(f in e)g=e[f],g.addDirtyNodesForCalc(!0,!1);if(a=j.imb)for(c=void 0,d=a[0];d;d=c)c=d.eh,j.Bh(d,0);for(h in j.UXJ)j.UXJ.hasOwnProperty(h)&&(i=j.UXJ[h],g=j.jh[i.id],g&&g.processDynamicListenerForCell(i.row,i.col));delete j.UXJ,b&&b.length>0&&b.forEach(function(a){j.pg(a,0)}),this.F9J()}},a.prototype.jVJ=function(a,b){var c,d,f,g=this;g.HIb=Date.now(),a&&g.imb&&delete g.UXJ,g.g4J=new e.Functions.RangeCriteriaManager,b||g.lh.startCache(),d=g.jh;for(f in d)c=d[f],c.getSource().startCalculation(),c.addDirtyNodesForCalc(a,b);g.Gg(!0,a);for(f in d)c=d[f],c.getSource().endCalculation();b||g.lh.endCache(),g.g4J.dispose(),this.F9J(),delete g.HIb},a.prototype.SXJ=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,o,q,r,s,t,u=this,v=u.imb;for(a=v[0];a;a=a.eh)a.isVolatile&&(b=a.row,c=a.column,d=a.ah,e=d.xf,f=d.BTa(b,c)||d.ATa(b,c),g=!0,f&&(h=ka(b,c),i=e.getValue(b,c),j=!1,k=p,l=p,m=p,o=p,q=d.Qf(b,c),q&&q.isDynamicArray!==!0&&(j=!0,k=q.row,l=q.col,m=q.rowCount,o=q.colCount),r=u.Hg(e,f,h,j,!0,q&&q.isDynamicArray!==!0&&la(k,l,m,o),u.allowDynamicArray),a.tOb||a.nOb?g=!0:(s="hyperlink",i!==r||"string"==typeof r&&r[s]?i instanceof Date?r instanceof Date&&i.valueOf()===r.valueOf()?g=!1:typeof r===G&&(t=n.Ra(i),t===r&&(g=!1)):typeof i===G&&typeof r===G&&(g=i!==r):g=!1)),f&&!g&&u.Bh(a,0))},a.prototype.Gg=function(a,b){var c,d,e,f,g,h,i=this,j=i.imb;if(j){if(i.calcOnDemand||!a||b||i.SXJ(),a){e=j[1]||j[2];for(c in j)j.hasOwnProperty(c)&&(f=parseInt(c,10),e&&1!==f&&2!==f||(d=j[c],d&&(d.ah.addListenersToDirty(i,f),d.processed=!0)));for(c in j)j.hasOwnProperty(c)&&(d=j[c],d&&(d.processed?delete d.processed:d.ah.addListenersToDirty(i,parseInt(c,10))))}for(c in j)j.hasOwnProperty(c)&&j[c].ah.initDelay(i,parseInt(c,10));for(c in j)j.hasOwnProperty(c)&&j[c].ah.adjustDelayOfListeners(i,parseInt(c,10),!0);do{g=!1;for(c in j)j.hasOwnProperty(c)&&(h=j[c].ah.calculateDirtyNodes(i,parseInt(c,10)),h&&(g=!0))}while(g);for(c in j)j.hasOwnProperty(c)&&j[c].ah.calculateIterations(i,parseInt(c,10));i.imb=i.jmb=p}},a.prototype.initParserContext=function(a){var b=this.Dh;b||(this.Dh=a.getParserContext(this.useR1C1))},a.prototype.getParserContext=function(a){var b=this,c=b.Dh;return c||(a?b.Dh=c=a.getParserContext(b.useR1C1):c=new g.ParserContext(o,b.useR1C1)),c.setSource(a),c},a.prototype.parseWithContext=function(a,b){return this.kh.parse(a,b)},a.prototype.unparseWithContext=function(a,b){return this.kh.unparse(a,b)},a.prototype.pg=function(a,b){var c,d,e,f,g,h=this;isNaN(b)||(!h.H9J||0!==b||(e=h.k_J&&h.k_J[h.H9J],e&&e.indexOf(a)>=0))&&(f=h.imb,g=h.jmb,f||(f=h.imb={},g=h.jmb={}),c=f[b],d=g[b],a.$l=!0,a&&!a.dh&&a!==c&&(c?d.eh=a:f[b]=a,a.dh=d,a.eh=o,g[b]=a))},a.prototype.Bh=function(a,b){var c,d,e,f,g,h=this;isNaN(b)||(a.$l=!1,d=h.imb,e=h.jmb,d&&(c=h.imb[b]),a&&(a.dh||a===c)&&(f=a.dh,g=a.eh,f?f.eh=g:d&&(g?d[b]=g:delete d[b]),g?g.dh=f:e&&(f?e[b]=f:delete e[b]),a.dh=o,a.eh=o))},a.prototype.evaluateExpression=function(a,b,c){var d=this;return d.lh.evaluateExpression(b,a.getEvaluatorContext(c,!1),!1)},a.prototype.onClearExpr=function(a,b){this.lh&&this.lh.asyncManager.clearCell(a,b)},a.prototype.parse=function(a,b,c,d,e,f,g,h){var i,j,k=this,l=k.rh,m=k.getParserContext(a);return m.useR1C1=!g&&k.useR1C1,m.ignoreError=f,m.keepUnknownFormulas=h,m.row=c,m.column=d,m.culture=e,l?(i=l[b])?i:(j=k.kh.parse(m,b),l[b]=j,j):k.kh.parse(m,b)},a.prototype.unparse=function(a,b,c,d,e,f,g){var h,i=this.getParserContext(a);return i.useR1C1=this.useR1C1,i.row=c,i.column=d,i.culture=e,i.addSheetName=g,f&&(i.Eh=!0,i.useR1C1=!1),h=this.kh.unparse(i,b),i.Eh=!1,h},a.prototype.recalculate=function(a,b,c,d){var e=this.getSourceModel(a);c===-1?e.Ag(b,0,1,e.cC()):b===-1?e.Ag(0,c,e.rC(),1):e.Ag(b,c,1,1),this.IsSuspended()||this.recalculateAll(!1,d)},a.prototype.recalculateByName=function(a,b){var c,d;b&&(c=W(this,a),d=c.mg(y(b),!0),this.pg(d,3),this.IsSuspended()||this.recalculateAll(!1))},a.prototype.recalcRange=function(a,b,c,d,e){var f=this.getSourceModel(a);c===-1?f.Ag(b,0,d,f.cC()):b===-1?f.Ag(0,c,f.rC(),e):f.Ag(b,c,d,e),this.IsSuspended()||this.recalculateAll(!1)},a.prototype.evaluate=function(a,b,c,d,f){var g=this,h=b instanceof e.Expression?b:g.parse(a,b,c,d);return g.lh.evaluateExpression(h,a.getEvaluatorContext(ka(c,d),!1),!1,f,f)},a.prototype.QhK=function(a,b,c,d,e){var f,g,h;if(!A(b))return f=this.lh,g=e,g||(g=a.getEvaluatorContext(c,!1,o,b),g.ShK=d),f.asyncManager.startCalcCell(a,c),h=this.lh.evaluateExpression(b,g,d,!0,!0),f.asyncManager.endCalcCell(),e?void(f.asyncManager.ThK(c.PhK)&&g.UhK(h)):new Promise(function(a,b){f.asyncManager.VhK(c.PhK)?g.UhK=a:a(h)}).then(function(a){return f.asyncManager.WhK(c.PhK),a})},a.prototype.Hg=function(a,b,c,d,f,g,h,i,j){var k,l,m,n,q,r,s,v,w,x,y,z,B,C,D;if(!A(b)){if(k=c.row||0,l=c.col||0,m=g?g.row:k,n=g?g.col:l,q=a.getEvaluatorContext(c,d,g,b,j),q.lCJ=i,s=4===arguments.length&&d||h,this.allowDynamicArray&&!d&&(q.Exb=!b.ensureSingle),r=this.lh.evaluateExpression(b,q,f,s&&!b.ensureSingle,s&&!b.ensureSingle),r&&r.pause)return r;if(d&&arguments.length<=5)return r;if(!d&&h&&(e.Convert.Fh(r)||e.Convert.Ca(r)))return r;if(e.Convert.Fh(r)){if(v=r.getRowCount(0),w=r.getColumnCount(0),1!==r.getRangeCount())return t;try{if(x=d?k-m:k-r.getRow(0),y=d?l-n:l-r.getColumn(0),z=ka(0,0),1===v&&1===w);else if(1===v&&w>1&&y>=0&&y<w)z.col=y;else if(v>1&&1===w&&x>=0&&x<v)z.row=x;else{if(!(d&&x<v&&y<w))return d?u:t;z.row=x,z.col=y}r=r.getValue(z,0)}catch(a){return t}}else if(e.Convert.Ca(r))if(d){if(B=r,C=B.getRowCount(),D=B.getColumnCount(),1!==C&&k-m>=C||1!==D&&l-n>=D)return u;r=r.getValue(1===C?0:k-m,1===D?0:l-n)}else r=r.getValueByIndex(0);return r===p||r===o?f===!1?r:0:r}},a.prototype.onAddAdjust=function(a,b){this.nh.hh(a,b)},a.prototype.onRemoveSource=function(a){this.nh.ph(a)},a.prototype.createSourceModel=function(a,b){return new O(a,b)},a.prototype.vcc=function(){var a,b,c,d=this.jh;for(a in d)b=d[a],b instanceof O&&(c=b.getAllNodes(),c.forEach(function(a){var b=a.calc;b&&(b.$l=!1,(b.eh||b.dh)&&(b.dh=b.eh=o))}))},a}(),b.CalcService=M;function W(a,b){return a.getSourceModel(b)}function X(a,b){var c,d,e,f,g,h;if(a)for(c in a)if(d=+c,e=a[c])for(f in e)g=+f,h=e[f],h&&b.setValue(d,g,h.value,h.oldValue,h.isAnchorCell!==!0)}b.setSpillValues=X;function Y(a,b){return[a,b].join(",")}function Z(a,b){var c=b.split(",").map(function(a){return+a}),d=c[0],e=c[1],f=a[d];return f&&f[e]}function $(a,b,c){if(a){var d=c.anchors,e={};a.forEach(function(a){var f,g,h,i,j,k,l,m,n=a.row,o=a.col,p=Y(n,o);for(b.Ag(n,o,1,1),e[p]=!0,f=a.rowCount,g=a.colCount,h=1,i=0;i<f;i++){for(;h<g;h++)if(j=c.getAnchorItem(i+n,h+o)){k=j.anchorRefs;for(l in k)p!==l&&k[l]&&(m=Z(d,l),m&&!e[l]&&(b.Ag(m.row,m.col,1,1),e[l]=!0))}h=0}})}}b.markAnchorCellDirty=$,N=function(){function a(){}return a.getLength=function(a,b){return w(a)?a.getRowCount()*a.getColumnCount():x(a)?(b=b?b:0,a.getRowCount(b)*a.getColumnCount(b)):void 0},a.getRowCount=function(a,b){return w(a)?a.getRowCount():x(a)?(b=b?b:0,a.getRowCount(b)):void 0},a.getColumnCount=function(a,b){return w(a)?a.getColumnCount():x(a)?(b=b?b:0,a.getColumnCount(b)):void 0},a.getValueByIndex=function(a,b,c){if(w(a))return a.getValueByIndex(b);if(x(a)){c=c?c:0;var d=a.getColumnCount(c);return a.getValue(c,parseInt(""+b/d,10),b%d)}},a.getValue=function(a,b,c,d){return w(a)?a.getValue(b,c):x(a)?(d=d?d:0,a.getValue(d,b,c)):void 0},a}(),b.CalcArrayHelper=N;function _(a,b,c,d,e,f){aa(a.tOb,a.nOb)&&(a.tOb&&(ca(c,a,a.tOb,!1),delete a.tOb),a.nOb&&(a.delay+=ca(c,a,a.nOb,!0,f),a.tOb=a.nOb,delete a.nOb))}function aa(a,b){return(!A(a)||!A(b))&&(!(!A(a)&&!A(b))||Object.keys(a).join()!==Object.keys(b).join())}function ba(a,b,c,d,e,f,g,h,i){var j,k,l,m=0;for(j=0;j<e;j++)for(k=0;k<f;k++)l=b.qg(j+c,k+d,!0),g&&l&&l.bJJ(0,a,h),i&&l&&l.$l&&m++;return m}function ca(a,b,c,d,e){var f,g,h,i,j,k=0;for(f in c)if(c.hasOwnProperty(f)){if(g=!1,h=c[f],i=a.jh[h.id],!i)continue;i&&ma(h)&&(j=i.ug(!0),j.Jg(h.rowUndefine?-1:h.row,h.colUndefine?-1:h.col,h.rowUndefine?-1:h.rowCount,h.colUndefine?-1:h.colCount,b,d,!0),g=!0),!i||g&&!e||(k+=ba(b,i,h.row,h.col,h.rowCount,h.colCount,!g,d,e))}return k}O=function(){function a(a,b){this.Ef=0,this.Ff=0,this.Gf=[],this.eOc=[],this.DCc=[],this.dataTable={},this.dataTableByName={},this.Hf=[],this.If=[],this.B5=0;var c=this;c.xf=b,c.Af=a}return a.prototype.getNode=function(a,b,c){var d,e=this,f=o;return a>=0&&b>=0?(d=e.dataTable[a],c&&!d&&(d=e.dataTable[a]={},a>e.Ef&&(e.Ef=a)),d&&(f=d[b],c&&!f&&(f=d[b]={},b>e.Ff&&(e.Ff=b)))):a===-1&&b>=0?(f=e.If[b],c&&!f&&(f=e.If[b]={},b>e.Ff&&(e.Ff=b))):a>=0&&b===-1?(f=e.Hf[a],c&&!f&&(f=e.Hf[a]={},b>e.Ff&&(e.Ff=b))):a===-1&&b===-1&&(f=e.Jf,c&&!f&&(f=e.Jf={})),f},a.prototype.getNodeByName=function(a,b){var c=this,d=c.dataTableByName[a];return b&&!d&&(d=c.dataTableByName[a]={}),d},a.prototype.Kf=function(a,b){var c=this.getNode(a,b);return c&&c.Lf},a.prototype.Mf=function(a,b){var c=this.getNode(a,b);return c&&c.Nf},a.prototype.Qf=function(a,b){return this.getWorkingNodeInfo(a,b,2)},a.prototype.BTa=function(a,b){return this.getWorkingNodeInfo(a,b,1)},a.prototype.ATa=function(a,b){return this.getWorkingNodeInfo(a,b,0)},a.prototype.CTa=function(a){var b=this.getNodeByName(a);return b&&b.Nf},a.prototype.DTa=function(a){var b=this.getNodeByName(a);return b&&b.Lf},a.prototype.clearAll=function(){var a=this;a.clear(-1,-1,-1,-1),a.dataTable={},a.dataTableByName={},a.Hf=[],a.If=[],a.Jf=o},a.prototype.clear=function(a,b,c,d,e){this.$b(a,b,c,d,e)},a.prototype.rzb=function(){var a=this;fa(a.Hf),fa(a.If),fa(a.dataTable,!0),fa(a.dataTableByName),a.eHb()},a.prototype.eHb=function(){var a=this;a.dataTable={},a.dataTableByName={},a.Hf=[],a.If=[],a.Jf=o,a.Gf=[],a.eOc=[],a.vg=o,a.xg=o},a.prototype.addRows=function(a,b){var c,d=this,e=d.rC();if(!(a<0||a>e||b<0))for(k(d.dataTable,e,a,b),k(d.Hf,e,a,b),c=0;c<b;c++)d.dataTable[a+c]&&(d.dataTable[a+c]={rs:"n"})},a.prototype.deleteRows=function(a,b){var c=this,d=c.rC();a<0||a>=d||b<=0||(a+b>d&&(b=d-a),l(c.dataTable,d,a,b),l(c.Hf,d,a,b))},a.prototype.addColumns=function(a,b){var c,d,e=this,f=e.rC(),g=e.cC();if(!(a<0||a>g||b<0)){for(c=0;c<f;c++)d=e.dataTable[c],d&&a<g&&k(d,g,a,b);k(this.If,g,a,b)}},a.prototype.deleteColumns=function(a,b){var c,d,e=this,f=e.rC(),g=e.cC();if(!(a<0||a>=g||b<0)){for(c=0;c<f;c++)d=this.dataTable[c],d&&l(d,g,a,b);l(this.If,g,a,b)}},a.prototype.ETa=function(a,b,c){var d,e,f=[a,b];return c&&(f.newValue=c),d=this.getNode(a,b),d&&(d.Lf&&(e=d.Pf,(!e||e&&e.row===a&&e.col===b)&&this.getSource().setFormula(a,b,this.getFormula(a,b),e,!0)),f.push(d.Lf,d.Nf,d.Pf)),f},a.prototype.FTa=function(a,b,c,d){a&&a.push(this.ETa(b,c,d))},a.prototype.dUa=function(){var a=this.getSource(),b=a&&a.getSheet(),c=b&&b.ITa;return c&&c.dUa()},a.prototype.$Va=function(a,b,c,d,e){var f=this;a===-1?f.kg(b,c,d):b===-1?f.jg(a,c,d):f.ig(a,b,c,d,e)},a.prototype.Rf=function(a,b,c,d){var e=this.getNode(a,b,!!c);e&&(d&&d.push([a,b,e.Lf]),e.Lf=c)},a.prototype.GTa=function(a,b,c,d,e,f,g){var h=this.getNode(a,b,!!c);h&&(this.FTa(g,a,b),h.Lf=c,(h.Nf||d)&&(h.Nf=d),(h.Pf||e)&&(h.Pf=e),h.isVolatile&&!c?this.Tf(h):(f||h.isVolatile)&&(h.isVolatile=f))},a.prototype.Sf=function(a,b,c){this.GTa(a,b,p,p,p,!1,c)},a.prototype.Uf=function(a,b,c,d,e,f){var g=this.getNode(b,c);g&&g.Lf&&a.GTa(d,e,g.Lf,g.Nf,g.Pf,g.isVolatile,f)},a.prototype.ega=function(a,b){var c=this.dataTable[a];return c&&c[b]},a.prototype.Wf=function(a,b,c){var d=this.getNode(a,b,!!c);d&&(d.Nf=c)},a.prototype.Xf=function(a,b,c){var d=this.getNode(a,b,!!c);d&&(d.Pf=c)},a.prototype.Yf=function(a,b){var c=this.getNode(a,b);return c&&c.calc},a.prototype.Zf=function(a,b,c){var d=this.getNode(a,b,!0);d&&(d.calc&&d.calc.isVolatile&&this.Tf(d),d.calc&&d.calc.isPivotData&&this.fOc(d),d.calc=c,c&&(c.node=d))},a.prototype.Q3=function(a,b,c){var d=this.getNode(a,b,!0);d&&d.calc&&(d.calc.isVolatile&&this.Tf(d),d.calc.isPivotData&&this.fOc(d),this.Af.Bh(d.calc,c),d.calc=p)},a.prototype.$f=function(a,b,c,d,e){var f,g,h=this,i=h.usedRange;c>=0&&d>=0?(f=h.dataTable[c],f||(f=h.dataTable[c]={}),g=f[d],f[d]=e,e&&e.calc&&delete e.calc,i&&na(i,c,d,g,e)):c>=0&&d===-1&&a>=0&&b===-1?h.Hf[c]=e:d>=0&&c===-1&&b>=0&&a===-1&&(h.If[d]=e)},a.prototype._f=function(a,b,c,d){var e=this,f=e.getNode(a,b),g=e.getNode(c,d);f&&f.Lf?e.$f(a,b,c,d,f):g&&g.Lf&&e.$f(a,b,c,d,o),g&&g.Lf?e.$f(c,d,a,b,g):f&&f.Lf&&e.$f(c,d,a,b,o)},a.prototype.ECc=function(a,b,c){a.isIterativeCalc||(a.isIterativeCalc=!0,this.DCc.push(a),b||V(a,c))},a.prototype.FCc=function(a){delete a.isIterativeCalc},a.prototype.GCc=function(){var a,b=this,c=[],d=b.DCc,e=b.DCc.length;for(a=0;a<e;a++)d[a].isIterativeCalc&&c.push(d[a]);return b.DCc=c,b.DCc},a.prototype.lmb=function(){return this.Gf},a.prototype.gOc=function(){return this.eOc},a.prototype.bg=function(a){a.isVolatile||(a.isVolatile=!0,this.Gf.push(a))},a.prototype.hOc=function(a){a.isPivotData||(a.isPivotData=!0,this.eOc.push(a))},a.prototype.Tf=function(a){var b,c,d,e,f;if(a.isVolatile=p,b=this,b.B5++,b.B5>100){for(b.B5=0,c=[],d=b.Gf,e=b.Gf.length,f=0;f<e;f++)d[f].isVolatile&&c.push(d[f]);b.Gf=c}},a.prototype.fOc=function(a){var b,c,d,e,f;for(a.isPivotData=p,b=this,c=[],d=b.eOc,e=b.eOc.length,f=0;f<e;f++)d[f].isPivotData&&c.push(d[f]);b.eOc=c},a.prototype.getCalcService=function(){return this.Af},a.prototype.setCalcService=function(a){
this.Af=a},a.prototype.Cf=function(){return this.Af},a.prototype.getSource=function(){return this.xf},a.prototype.hasFormula=function(a,b){return a=a!==p?a:-1,b=b!==p?b:-1,!!this.ATa(a,b)},a.prototype.setFormula=function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,q,r,s=this;if(c&&0===c.length&&(c=o),j=i&&c&&!d,e||j||!s.dg(a,b,1,1)||s.eg(),k=s.getFormula(a,b),l=s.Qf(a,b),f||k!==c&&(""!==k||c)&&(k||""!==c)||k===c&&l){if(m=s.Cf(),n=o,m)try{q=a>=0?a:0,r=b>=0?b:0,n=d||(c?m.parse(s.xf,c,q,r,!1,e,p,i):o),s.fg(a,b,n,p,!1,g,h)}catch(a){if(!e&&!j)throw a}a>=0&&b>=0&&s.xf.setFormula(a,b,c,p)}},a.prototype.getFormula=function(a,b,c){var d,e,f=this.Cf();return f&&(d=this.ATa(a,b))?(e=this.Qf(a,b),a=e&&e.isDynamicArray!==!0?e.row:a,b=e&&e.isDynamicArray!==!0?e.col:b,f.unparse(this.xf,d,a,b,c)):o},a.prototype.setFormulaByName=function(a,b,c,d,e){var f,g,h,i;if(a&&(a=y(a),f=this,b&&0===b.length&&(b=o),g=f.getFormulaByName(a),g!==b&&(""!==g||b)&&(g||""!==b))){if(h=f.Cf(),i=o,h)try{i=b?h.parse(f.xf,b,0,0,!1,c):o,f.gg(a,i,p,!1,d,e)}catch(a){if(!c)throw a}f.xf.setFormula({name:a},b)}},a.prototype.getFormulaByName=function(a){var b,c=this.Cf();return c&&a&&(b=this.DTa(y(a)))?c.unparse(this.xf,b,0,0):o},a.prototype.eg=function(){throw e.sR().Exp_ArrayFormulaPart},a.prototype.rC=function(){return B(this.xf.getRowCount())},a.prototype.cC=function(){return B(this.xf.getColumnCount())},a.prototype.setArrayFormula=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n=this;if(e&&0===e.length&&(e=o),!n.xf.q$a&&n.dg(a,b,c,d)&&n.eg(),a=a<0?0:a,b=b<0?0:b,j=n.Cf()){if(n.$b(a,b,c,d,g),e){try{j.forceR1C1Formula?(k=j.useR1C1,j.useR1C1=!0,i=e?j.parse(n.xf,e,a,b,!1,f,!1):o,j.useR1C1=k):i=e?j.parse(n.xf,e,a,b,!1,f,f):o}catch(a){if(!f)throw a;return}for(l=a;l<a+c;l++)for(m=b;m<b+d;m++)n.fg(l,m,i,la(a,b,c,d),!1,g,h)}a>=0&&b>=0&&n.xf.setArrayFormula(a,b,c,d,j.unparse(n.xf,i,a,b))}},a.prototype.getWorkingNodeInfo=function(a,b,c){var d,e=this,f=e.xf;return a>=f.getRowCount()||b>=f.getColumnCount()?d:(a>=0&&b>=0?(d=e.getNode(a,b),(!d||0===c&&!d.Lf||1===c&&!d.Nf||2===c&&!d.Pf)&&(d=e.getNode(a,-1)),(!d||0===c&&!d.Lf||1===c&&!d.Nf||2===c&&!d.Pf)&&(d=e.getNode(-1,b))):d=a>=0&&b===-1?e.getNode(a,-1):a===-1&&b>=0?e.getNode(-1,b):e.getNode(-1,-1),d&&(0===c&&d.Lf||1===c&&d.Nf||2===c&&d.Pf))},a.prototype.fg=function(a,b,c,d,e,f,g){var i,j,k,l,m,n,o,q,r,s,t=this,u=t.Cf();u.nia&&u.lh.asyncManager.endCalcCell(),i=d!==p&&null!==d,j=i?d.row:a,k=i?d.col:b,l=t.xf,m=new h.EvaluateContext(l,ka(j,k),i),c&&c.T5J||(n=u.allowDynamicArray?ia(m,c,i,i?a-d.row:0,i?b-d.col:0,!0,!0):ha(m,c,i,i?a-d.row:0,i?b-d.col:0),o=m.rOb,o&&(delete m.rOb,1===o&&(q=u.unparse(l,c,j,k),c=u.parse(l,q,j,k))),n=n===c?p:n,n&&(n.ensureSingle=c.ensureSingle),A(n)&&!A(c&&c.S5J)&&(c.T5J=!0)),d!==p&&(r=d),a>=0&&b>=0?((e===p||e)&&(s=c?u.unparse(l,c,a,b):p,t.xf.setFormula(a,b,s,r)),t.ig(a,b,c,n,r,f,g)):a>=0&&b===-1?t.jg(a,c,n,f,g):a===-1&&b>=0&&t.kg(b,c,n,f,g),u.autoCalculation&&!u.IsSuspended()&&u.recalculateAll(!1)},a.prototype.gg=function(a,b,c,d,e,f){var g,i,j=this,k=j.Cf(),l=new h.EvaluateContext(j.xf,ka(0,0),(!1)),m=ia(l,b,!1,0,0);m=m===b?p:m,d!==p&&!d||e||(g=j.getFormulaByName(a),i=b?k.unparse(j.xf,b,0,0):p,j.xf.setFormulaByName&&j.xf.setFormulaByName(a,i,g)),j.lg(a,b,m,null,f),k.autoCalculation&&!k.IsSuspended()&&(e||k.recalculateAll(!1))},a.prototype.getRowExpression=function(a){return this.Kf(a,-1)},a.prototype.getColumnExpression=function(a){return this.Kf(-1,a)},a.prototype.lg=function(a,b,c,d,e){var f,g=this,h=g.mg(a,!0);h&&(e||h.ng(),f=this.getNodeByName(a,!0),f.Lf=b,d&&(d[0].push("dataTable",a),d[1]=f.Lf),c=b&&c?c:p,f.Nf=c,e||h.og(),h.fh())},a.prototype.ig=function(a,b,c,d,e,f,g){var h,i=this,j=i.qg(a,b,!0);j&&(i.FTa(f,a,b),h=i.Af,h.onClearExpr(i.xf,ka(a,b)),ca(h,j,j.tOb,!1),delete j.tOb,delete j.nOb,j.ng(),i.Rf(a,b,c),c?((d||i.Mf(a,b))&&i.Wf(a,b,d),e&&e.isDynamicArray===!0||i.Xf(a,b,e)):(i.Wf(a,b,p),i.Xf(a,b,p)),i.mhK||j.og(),j.fh())},a.prototype.jg=function(a,b,c,d,e){var f=this,g=f.rg(a,!0);g&&(f.FTa(d,a,-1),e||g.ng(),f.Rf(a,-1,b),(c||f.Mf(a,-1))&&f.Wf(a,-1,c),e||g.og(),g.fh())},a.prototype.kg=function(a,b,c,d,e){var f=this,g=f.sg(a,!0);g&&(f.FTa(d,-1,a),e||g.ng(),f.Rf(-1,a,b),(c||f.Mf(-1,a))&&f.Wf(-1,a,c),e||g.og(),g.fh())},a.prototype.$b=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=a<0?0:a,m=b<0?0:b,n=a<0?k.rC():c,q=b<0?k.cC():d,r=l+n-1,s=m+q-1,t=function(a,b){if(f=k.Mf(a,b),g=k.Kf(a,b),f||g){h=k.Qf(a,b);var c=h&&h.isDynamicArray!==!0?la(h.row,h.col,h.rowCount,h.colCount):p;k.fg(a,b,o,c,!0,e)}},u=k.usedRange;for(i=l;i<=r&&i>=0;i++)for(b<0&&(t(i,-1),u&&u.removeRowAndColInfo(i,-1)),j=m;j<=s&&j>=0;j++)i===l&&a<0&&(t(-1,j),u&&u.removeRowAndColInfo(-1,j)),t(i,j),u&&u.removeRowAndColInfo(i,j);a<0&&b<0&&t(a,b)},a.prototype.dg=function(a,b,c,d){return this.tg(a,b,c,d,!0,!0)},a.prototype.tg=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o=this,p=a<0?0:a,q=b<0?0:b,r=a<0?o.rC():c,s=b<0?o.cC():d,t=p+(0===r?1:r)-1,u=q+(0===s?1:s)-1,v=!1,w=[],x=[],y=o.dataTable;for(i=p;i<=t&&i>=0&&!(i>o.Ef);i++)if(h=y[i])for(j=q;j<=u&&j>=0&&!(j>o.Ff);j++)if(g=h[j])if(k=g.Pf,l=void 0,k&&!k.isDynamicArray){if(k.row<p||k.row+k.rowCount-1>t||k.col<q||k.col+k.colCount-1>u){if(e)return m=k.row===a&&0===c,n=k.col===b&&0===d,!m&&!n;v=!0}if(i!==k.row&&i!==p)continue;w.push(la(k.row,k.col,k.rowCount,k.colCount)),l=g.Lf,x.push(l),j=k.col+k.colCount-1}else f||(l=g.Lf,l&&(w.push({row:i,col:j}),x.push(l)));return!e&&{hasPart:v,ranges:w,formulas:x}},a.prototype.getCalcObj=function(){var a,b,c,d,e,f,g,h,i,j,k,l=[];for(a=0;a<arguments.length;a++)l[a]=arguments[a];if(b=l[0],c=l[1],d=this,e=b.row,f=b.column,g=null,isNaN(e)||isNaN(f))b.name&&(g=d.mg(b.name,c));else if(e>=0&&f>=0)if(b.sf())g=d.qg(e,f,c);else for(h=b.endRow,i=b.endColumn,g=[],j=e;j<=h;j++)for(k=f;k<=i;k++)g.push(d.qg(j,k,c));else e>=0?g=d.rg(e,c):f>=0&&(g=d.sg(f,c));return g},a.prototype.mg=function(a,b){var c=this,d=o,e=c.getNodeByName(a,b);return e&&(d=e.calc,!d&&b&&(d=new K(c,a),e.calc=d,d.node=e)),d},a.prototype.kVJ=function(a){var b,c,d,e=this.dataTable;for(b in e)for(c in e[b])d=e[b][c],d&&d.calc&&a(d.calc)},a.prototype.qg=function(a,b,c){var d,e,f,g=this,h=o;if(a>=0&&b>=0){if(d=g.dataTable,e=d[a],!e){if(!c)return h;e=d[a]={},a>g.Ef&&(g.Ef=a)}if(f=e[b],!f)return c&&(f=e[b]={},h=new P(g,a,b),f.calc=h,h.node=f,b>g.Ff&&(g.Ff=b)),h;h=f.calc,!h&&c&&(h=new P(g,a,b),f.calc=h,h.node=f,a>g.Ef&&(g.Ef=a),b>g.Ff&&(g.Ff=b))}return h},a.prototype.rg=function(a,b){var c=this,d=o;return a>=0&&(d=c.Yf(a,-1),!d&&b&&(d=new Q(c,a),c.Zf(a,-1,d),a>c.Ef&&(c.Ef=a))),d},a.prototype.sg=function(a,b){var c=this,d=o;return a>=0&&(d=c.Yf(-1,a),!d&&b&&(d=new R(c,a),c.Zf(-1,a,d),a>c.Ff&&(c.Ff=a))),d},a.prototype.ug=function(a){var b=this;return!b.vg&&a&&(b.vg=new T(b)),b.vg},a.prototype.wg=function(a,b){var c,d=this;return a=y(a),d.xg||(d.xg={}),c=d.xg[a],!c&&b&&(c=d.xg[a]=new S(d,a)),c},a.prototype.updateNameCalc=function(a,b){var c=this.wg(y(a));c&&(c.updateListening(!0,b),c.fh())},a.prototype.yg=function(a,b){var c,d,e=this,f=B(e.Ff,a+b-1);for(c=a;c!==-1&&c<=f;c++)e.isDirty(-1,c)&&(d=e.sg(c,!0),e.Af.pg(d,2))},a.prototype.zg=function(a,b){var c,d,e=this,f=B(e.Ef,a+b-1);for(c=a;c!==-1&&c<=f;c++)e.isDirty(c,-1)&&(d=e.rg(c,!0),e.Af.pg(d,1))},a.prototype.Ag=function(a,b,c,d){var e,f,g,h=this,i=null,j=B(h.Ef,a+c-1),k=B(h.Ff,b+d-1);for(e=a;e<=j;e++)for(f=b;f<=k;f++)h.ega(e,f)&&(h.Af.calcOnDemand?(i=h.qg(e,f,!1),i&&(i.Bg(),i.$l=!0)):(i=h.qg(e,f,!0),h.Af.pg(i,0)));h.zg(a,c),h.yg(b,d),g=h.ug(!1),g&&g.Bg(a,b,c,d)},a.prototype.ZZJ=function(){var a,b=this;b.kVJ(function(a){a.l_J(b)}),a=b.ug(!1),a&&a.l_J(b)},a.prototype.HCc=function(){var a,b,c,d,e,f=this,g=f.lmb().concat(f.GCc()).concat(f.gOc());for(c=0;c<g.length;c++)d=g[c],f.Af.calcOnDemand&&d&&(d.isVolatile||d.isIterativeCalc)&&(d.$l=!0,d.Bg()),d&&(d.isVolatile||d.isIterativeCalc||d.isPivotData)&&d instanceof P&&!f.Dg(d)&&(e=f.qg(d.row,d.column,!0),f.Af.pg(e,0),a=f.rg(d.row,!1),a&&!f.Eg(a)&&f.zg(d.row,1),b=f.sg(d.column,!1),b&&!f.Eg(b)&&f.yg(d.column,1))},a.prototype.Dg=function(a){var b=this.getCalcService().imb;return!!a.dh||a===(b&&b[0])},a.prototype.Eg=function(a){var b=this.getCalcService().imb;return a.dh||a===(b&&b[1])},a.prototype.isDirtyColumn=function(a){var b=this.getCalcService().imb;return a.dh||a===(b&&b[2])},a.prototype.isDirty=function(a,b){return!(!this.Yf(a,b)&&!this.Kf(a,b))},a.prototype.recalculateForContext=function(a,b,c){var d=this.Af,e=d.getSourceModel(a),f=b.row,g=b.col;g===-1?e.Ag(f,0,1,e.cC()):f===-1?e.Ag(0,g,e.rC(),1):e.Ag(f,g,1,1),d.IsSuspended()||d.recalculateAll(!1,c)},a.prototype.processDynamicListenerForCell=function(a,b){var c,d,e,f,g,h,i,j,k,l=this,m=l.xf,n=l.BTa(a,b)||l.ATa(a,b);n&&(c=ka(a,b),d=!1,e=void 0,f=void 0,g=void 0,h=void 0,i=l.Qf(a,b),i&&i.isDynamicArray!==!0&&(d=!0,e=i.row,f=i.col,g=i.rowCount,h=i.colCount),j=l.Af,k=l.xf.getCalcSourceModel().qg(a,b),j.Hg(l.xf,n,c,d,!0,i&&i.isDynamicArray!==!0&&la(e,f,g,h),j.allowDynamicArray,!1,k),_(k,m,j,a,b,!1))},a.prototype.recalculateCell=function(a,b){var c,d,f,g,h,i,j,k,l,m,p,q,r,s,u,w,x,y,z,B,C,D,E=this,F=E.xf,H=a.row,I=a.column,J=E.BTa(H,I)||E.ATa(H,I),K=F,L=K.q$a,M=K&&K.kj&&K.kj.ITa;if(M&&(d=M.WIb,M.WIb=!0),f=!1,J){if(g=ka(H,I),h=F.getValue(H,I,!0),i=!1,j=void 0,k=void 0,l=void 0,m=void 0,p=E.Qf(H,I),p&&p.isDynamicArray!==!0&&(i=!0,j=p.row,k=p.col,l=p.rowCount,m=p.colCount),q=E.Af,q.nia&&q.lh.asyncManager.startCalcCell(E.xf,g),r=q.Hg(E.xf,J,g,i,!0,p&&p.isDynamicArray!==!0&&la(j,k,l,m),q.allowDynamicArray,b,a),b&&r&&r.pause)return r;if(_(a,F,q,H,I,b),b&&a.delay>0)return{pause:"newDetectedRefs"};if(s=e.Convert.Fh(r)||e.Convert.Ca(r),u=!1,i||!q.allowDynamicArray||J.ensureSingle||!J.yHJ&&!s||(l=r.getRowCount?r.getRowCount():1,m=r.getColumnCount?r.getColumnCount():1,w={row:H,col:I,rowCount:l,colCount:m,isDynamicArray:!0},u=!0,E.Xf(H,I,w),x=p&&p.rowCount||1,y=p&&p.colCount||1,(l>x||m>y)&&(q.dZJ=q.dZJ||[],q.dZJ.push([E,w]))),f=!0,z=void 0,s&&(z=e.Convert.Ph(r,0,!1,!1,!1),z.isError||z.isConvertError?(r=t,s=!1):(l=z.rowCount,m=z.colCount,0===l||0===m?(r=v,s=!1):1===l&&1===m?(r=z[0][0],A(r)&&(r=0),s=!1):u||(J.e5J=!0,r=e.Functions.findGlobalFunction("@").evaluate({row:H,column:I},r),s=!1))),s)B=K.setArray(H,I,l,m,z),B&&X(B[1],K);else if(B=K.updateItem&&K.updateItem(H,I,r),B&&(X(B[0],K),c=B[1]),C="hyperlink",h!==r||"string"==typeof r&&r[C]){if(h instanceof Date){if(r instanceof Date&&h.valueOf()===r.valueOf())return!1;if(typeof r===G){if(D=n.Ra(h),D===r)return!1;r=n.Xb(r)}}F.setValue(H,I,r,h)}else f=!1;q.nia&&q.lh.asyncManager.endCalcCell(),K.Ppb&&K.Ppb(H,I)}else L||(B=K.updateItem&&K.updateItem(H,I,o),B&&(X(B[0],K),c=B[1]));return M&&(c&&$(c,E,M.bIb),M.WIb=d),f},a.prototype.recalculateNameID=function(a){var b,c,d=this,e=d.xf,f=d.CTa(a)||d.DTa(a);if(f){if(b=e.getValueByName?e.getValueByName(a):e.getValue({name:a}),c=d.Af.Hg(d.xf,f,{name:a},!1,!0),b===c)return;if(b instanceof Date&&c instanceof Date&&b.valueOf()===c.valueOf())return;e.setValueByName?e.setValueByName(a,c):e.setValue({name:a},c)}},a.prototype.addDirtyNodesForCalc=function(a,b){var c,d,e=this;a!==!1?(c=e.cC(),d=e.rC(),e.yg(0,c),e.zg(0,d),e.Ag(0,0,d,c)):b||e.HCc()},a.prototype.addListenersToDirtyForRow=function(a){for(var b,c,d,e;a.imb[1];){for(b=a.imb[1],c=b.ah,d=c.cC(),e=0;e<d;e++)a.pg(c.qg(b.row,e,!0),0);a.Bh(b,1)}},a.prototype.addListenersToDirtyForCol=function(a){for(var b,c,d,e;a.imb[2];){if(b=a.imb[2],c=b.ah,d=c.rC(),d>0)for(e=0;e<d;e++)a.pg(c.qg(e,b.column,!0),0);else b.Bg();a.Bh(b,2)}},a.prototype.Ah=function(a,b){for(var c=a.length,d=b;d;)a[c]=d,c++,d=d.eh},a.prototype.addListenersToDirty=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;if(1===b)this.addListenersToDirtyForRow(a);else if(2===b)this.addListenersToDirtyForCol(a);else if(0===b)for(c=[],a.imb[2]&&this.Ah(c,a.imb[2]),d=a.imb[0];d;d=d.eh)for(e=d.ah,f=d.row,g=d.column,h=e.rg(f,!1),i=e.sg(g,!1),j=e.ug(!1),d.Bg(),h&&h.Bg(),i&&i.Bg(),j&&(k=d.node&&d.node.Pf,k&&k.isDynamicArray?j.Bg(f,g,k.rowCount,k.colCount):j.Bg(f,g,1,1)),this.addListenersToDirtyForRow(a);a.imb[2];){for(l=a.imb[2],m=!1,n=0;n<c.length;n++)if(c[n]===l){m=!0;break}if(m)a.Bh(l,2);else{for(c[c.length]=l,e=l.ah,o=e.rC(),p=0;p<o;p++)a.pg(e.qg(p,l.column,!0),0);a.Bh(l,2)}}else if(3===b)for(q=a.imb[3];q;q=q.eh)q.Bg()},a.prototype.initDelay=function(a,c){var d,e,f,g,h,i,j;if(!a.calcOnDemand)if(0===c)for(d=null,e=a.imb[0];e;e=d)e.tOb&&(ca(a,e,e.tOb,!1),delete e.tOb),d=e.eh,f=e.ah,g=f.rC(),h=f.cC(),e.row<g&&e.column<h?(b.supportRowColumnFormula&&(i=f.sg(e.column,!1),i&&(i.delay=0)),e.delay=0,delete e.ZDc):a.Bh(e,0);else if(3===c)for(j=a.imb[3];j;j=j.eh)j.delay=0},a.prototype.adjustDelayOfListeners=function(a,b,c){var d,e,f,g,h,i,j,k;if(!a.calcOnDemand)if(0===b)for(d=a.imb[b];d;d=d.eh)e=d.ah,f=d.row,g=d.column,h=e.rg(f,!1),i=e.sg(g,!1),j=e.ug(!1),d.gh(c),h&&h.gh(c),i&&i.gh(c),j&&j.gh(f,g,c);else if(3===b)for(k=a.imb[3];k;k=k.eh)k.gh(c)},a.prototype.calculateDirtyNodes=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;if(a.calcOnDemand)return!1;if(c=!1,d=null,0===b){for(f=a.imb[b];f;f=e)if(e=f.eh,g=!1,f.f_J&&(g=!0,delete f.f_J),f.delay<=0||g){if(this.FCc(f),d=f.ah,h=f.row,i=f.column,j=d.rg(h,!1),k=d.sg(i,!1),k&&k.delay)continue;if(l=d.ug(!1),m=d.recalculateCell(f,!f.mCJ||f.mCJ<32),m&&m.pause){if(f.mCJ=f.mCJ?f.mCJ+1:1,m.branch)for(e=f,n=0;n<m.branch.length;n++)(m.branch[n].dh||m.branch[n].eh||m.branch[n]===f)&&(f.delay++,o=m.branch[n],o.ZDc=o.ZDc||[],o.ZDc.push(f))}else delete f.mCJ,a.Bh(f,0),f.gh(!1),j&&j.gh(!1),k&&k.gh(!1),l&&l.gh(h,i,!1),p=f.node&&f.node.Lf,p&&p.CCc&&delete p.CCc;c=!0}}else if(3===b)for(q=a.imb[b];q;q=e)e=q.eh,0===q.delay&&(q.Ik?q.Ik():(d=q.ah,d.recalculateNameID(q.name)),a.Bh(q,3),q.gh(!1),c=!0);return c},a.prototype.calculateIterations=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,q,r;if(!a.calcOnDemand&&0===c&&(d=a.imb[c])){if(e=null,f=!0,a.iterativeCalculation){for(h in a.jh)a.jh.hasOwnProperty(h)&&(i=a.jh[h].getSource(),i.clearValueCache&&i.clearValueCache());for(j=0;f&&j<a.iterativeCalculationMaximumIterations;j++)for(f=!1,e=d;e;e=e.eh)delete e.mCJ,g=e.node&&e.node.Lf&&e.node.Lf.CCc,this.ECc(e,!g,o),g&&(e.node.Lf.CCc=p),k=e.ah,l=e.row,m=e.column,n=k.getSource().getValue(l,m),k.recalculateCell(e),f||(q=k.getSource().getValue(l,m),b.approximatelyEqual(n,q,a.iterativeCalculationMaximumChange)||(f=!0))}else for(e=d;e;e=e.eh)g=e.node&&e.node.Lf&&e.node.Lf.CCc,this.ECc(e,!g,0),g&&(e.node.Lf.CCc=p),delete e.mCJ;for(r=null,e=d;e;e=r)r=e.eh,e.eh=p,r&&(r.dh=p)}},a.prototype.Ig=function(a,b,c,d,g,h,i){var j,k,l,m,n,q,r,s,t,u,v,w,x,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba=this;if(h&&ba.FCc(a),d){for(;12===d.type;)d=d.value;for(;10===d.type;)d=d.value;for(;12===d.type;)d=d.value;if(g){for(;12===g.type;)g=g.value;for(;10===g.type;)g=g.value;for(;12===g.type;)g=g.value}if(13===d.type){if(q=d.getRange(b,c,!0),q===o)return;d=1===q.rowCount&&1===q.colCount?f.rf(o,o,q.row,q.col,!1,!1):f.uf(o,o,q.row,q.col,q.row+q.rowCount-1,q.col+q.colCount-1,!1,!1,!1,!1)}if(g&&g!==d&&8===g.type){if(g.source instanceof e.ErrorSource)return;k=g.value,F=d.source||g.source||i||ba.xf,H=ba.Af.getGlobalSourceModel()||F.getCalcSourceModel(),I=H.getSource(),I.addUsedCustomName&&I.addUsedCustomName(k),l=F.getCustomName(k),l?G=F.getCalcSourceModel():(G=H,l=I.getCustomName(k),l||(J=F.getCalcSourceModel(),K=J&&J.wg(k,!0),K&&K.gmb(0,a,h))),m=G.wg(k,!0),m.gmb(0,a,h),g=null,l&&ba.Ig(a,b,c,l,o,h,G.getSource())}if(1===d.type&&d.endSource){if(L=d,M=L.source.getSources(L.endSource))for(j=0;j<M.length;j++)N=f.uf(M[j],o,L.row,L.column,L.endRow,L.endColumn,L.rowRelative,L.columnRelative,L.endRowRelative,L.endColumnRelative,b,c),N.isFullRow=L.isFullRow,N.isFullColumn=L.isFullColumn,ba.Ig(a,b,c,N,o,h)}else if(1===d.type){if(O=ba.xf,F=d.source!==e.BangSource&&d.source||O,G=F.getCalcSourceModel(),O&&O.q$a&&F&&O.id!==F.id&&F.getSheet&&F.getSheet()&&O.addReferenceSheetName(F.getSheet().name()),!G&&F.J$J&&F.Ig&&F.Ig(a,h,d),!G)return;if(Q=d,R=a.row===p||a.column===p,S=Q.tf(),T=f.getRangeForReference(Q,b,c),t=T.row,v=T.col,x=T.rowCount,z=T.colCount,u=t+x-1,w=v+z-1,0===S){if(0<=b&&0<=c)if(ma(T))n=G.ug(!0),R?n.Xoa(t,v,x,z,a,h):n.Jg(t,v,x,z,a,h);else for(D=t;D<=u;D++)for(E=v;E<=w;E++)A=G.qg(D,E,!0),R?A&&A.gmb(3,a,h):A&&A.gmb(0,a,h);else if(0<=b&&c===-1)for(D=t;D<=u;D++)for(E=v;E<=w;E++)Q.columnRelative||Q.endColumnRelative?(B=G.rg(D,!0),B&&B.Kg(a.row,-E,h)):(A=G.qg(D,E,!0),A&&A.gmb(1,a,h));else if(0<=c&&b===-1)for(D=t;D<=u;D++)for(E=v;E<=w;E++)Q.rowRelative||Q.endRowRelative?(C=G.sg(E,!0),C&&C.Mg(a,-D,h)):(A=G.qg(D,E,!0),A&&A.gmb(2,a,h))}else if(1===S){if(0<=b&&0<=c)n=G.ug(!0),R?n.Xoa(t,v,x,z,a,h):n.Jg(t,v,x,z,a,h);else if(0<=b&&c===-1);else if(b===-1&&0<=c)if(Q.rowRelative||Q.endRowRelative);else for(t=Q.row,u=Q.endRow,D=t;D<=u;D++)B=G.rg(D,!0),B&&B.gmb(2,a,h)}else if(2===S){if(0<=b&&0<=c)n=G.ug(!0),R?n.Xoa(t,v,x,z,a,h):n.Jg(t,v,x,z,a,h);else if(0<=b&&c===-1);else if(b===-1&&0<=c)for(E=v;E<=w;E++)C=G.sg(E,!0),C&&C.gmb(2,a,h)}else 3===S&&(n=G.ug(!0),R?n.Xoa(0,0,e.MAX_ROW_COUNT,e.MAX_COLUMN_COUNT,a,h):n.Jg(0,0,e.MAX_ROW_COUNT,e.MAX_COLUMN_COUNT,a,h))}else if(9===d.type)ba.Ig(a,b,c,d.value,g&&9===g.type&&g.value,h),d.value2&&ba.Ig(a,b,c,d.value2,g&&9===g.type&&g.value2,h);else if(8===d.type){if(d.mWJ)return;if(d.mWJ=!0,F=d.source||i||ba.xf,k=y(d.value),l=F.getCustomName(k),l?G=F.getCalcSourceModel():(G=ba.Af.getGlobalSourceModel()||F.getCalcSourceModel(),l=G.getSource().getCustomName(k),l||(J=F.getCalcSourceModel(),U=J&&J.wg(k,!0),U&&U.gmb(0,a,h))),m=G.wg(k,!0),!m)return;m.gmb(0,a,h),l&&ba.Ig(a,b,c,l,o,h,G.getSource()),d.mWJ=p}else if(7===d.type){if(d.mWJ)return;if(d.mWJ=!0,V=d.function)if(e.isExpression(V))for(ba.Ig(a,b,c,V,g&&7===g.type&&g.function instanceof e.Expression&&g.function,h),X=d.arguments.length,j=0;j<X;j++)ba.Ig(a,b,c,d.arguments[j],g&&7===g.type&&g.arguments[j],h);else for(V&&(Y=V.g_J,Y&&ba.Af.j_J(a,Y,h),V.isVolatile()&&(h?ba.bg(a):ba.Tf(a)),"GETPIVOTDATA"===V.name&&(h?ba.hOc(a):ba.fOc(a)),V instanceof e.Functions.AsyncFunction&&(ba.Af.nia=!0)),X=d.arguments.length,j=0;j<X;j++)h&&V&&V.skipPrecedent(j)&&ba.m_J(a,d,j,V,b,c)&&(a.p9J=!0),Z=!1,this.Af.dynamicReferences&&V&&V.isBranch()&&V.findTestArgument()!==j&&a instanceof P&&(d.bEc=!0,a.cEc=a.cEc||[],a.cEc[j]=[],Z=!0,a.YDc=a.YDc||[],a.YDc.push(a.cEc[j])),ba.Ig(a,b,c,d.arguments[j],g&&7===g.type&&g.arguments[j],h),Z&&a.YDc.pop(),delete a.p9J;else for(!d.isLocalFunctionName&&d.functionName&&(W=new e.Expression(8),W.value=d.functionName,ba.Ig(a,b,c,W,d,h)),X=d.arguments.length,j=0;j<X;j++)ba.Ig(a,b,c,d.arguments[j],g&&7===g.type&&g.arguments[j],h);d.mWJ=p}else if(25===d.type||26===d.type){if($=d,F=d.source||ba.xf,G=F.getCalcSourceModel(),_=G.mg($.value,!0),!_)return;_.gmb(0,a,h)}else 22!==d.type&&14!==d.type||(aa=d,aa.gmb&&aa.gmb(a,h))}},a.prototype.m_J=function(a,b,c,d,e,f){var g,h,i,j=b.arguments[c];return 12===j.type&&(j=j.value),!(j&&j.function&&j.function.name)&&(d.f_J?!(!this.Af.dynamicReferences||!j||1!==j.type&&13!==j.type&&22!==j.type)&&(g=j.source||this.xf,this.Af.Q$J&&g&&g.getRangeKey&&(h=j.getRange(e,f),h.rowUndefine&&(h.row=h.rowCount=-1),h.colUndefine&&(h.col=h.colCount=-1),h.id=g.id,i=g.getRangeKey(g,h),a.nOb||(a.nOb={}),a.nOb[i]=h,a.f_J=!0),!0):!(!j||1!==j.type&&13!==j.type&&22!==j.type))},a.prototype.Og=function(a,b){var c=this.getNodeByName(a);c&&(c.Nf||c.Lf)&&this.Ig(this.mg(a),0,0,c.Nf||c.Lf,c.Lf,b)},a.prototype.Pg=function(a,b,c,d,e){var f,g,h,i,j,k,l=this,m=a+c,n=b+d;for(i=a;i<m;i++)for(j=b;j<n;j++)f=l.Mf(i,j),g=l.Kf(i,j),(f||g)&&(h=l.Qf(i,j),k=l.qg(i,j),h&&h.isDynamicArray!==!0?l.Ig(k,h.row,h.col,f||g,g,e):l.Ig(k,i,j,f||g,g,e),e&&k.nOb&&(ca(k.ZAb(),k,k.nOb,!0,!1),k.tOb=k.nOb,delete k.nOb),e||(k.tOb&&ca(k.ZAb(),k,k.tOb,!1,!1),delete k.cEc))},a.prototype.Qg=function(a,b,c){var d,e,f=a+b;for(d=a;d!==-1&&d<f;d++)e=this.getColumnExpression(d),e&&this.Ig(this.sg(d,!1),-1,d,e,e,c)},a.prototype.Rg=function(a,b,c,d){this.Pg(a,b,c,d,!0)},a.prototype.Sg=function(a,b,c,d){this.Pg(a,b,c,d,!1)},a.prototype.Tg=function(a,b){},a.prototype.Ug=function(a,b){},a.prototype.Vg=function(a,b){this.Qg(a,b,!0)},a.prototype.Wg=function(a,b){this.Qg(a,b,!1)},a.prototype.Xg=function(a,b,c,d,e,f,g){var h,i,j,k=a+c,l=b+d,m=this;for(h=a;h<k;h++)for(i=b;i<l;i++)j=this.qg(h,i,!1),j&&(m.FTa(g,h,i),e&&j.Yg(),f&&j.Bg())},a.prototype.Zg=function(a,b,c,d,e){var f,g,h,i,j=this,k=j.Hf;if(a!==-1&&k)for(f=B(a+b,k.length),g=a;g<f;g++)h=k[g],h&&h.calc&&(j.FTa(e,g,-1),i=h.calc,c&&i.Yg(),d&&i.Bg())},a.prototype.$g=function(a,b,c,d,e){var f,g,h,i,j=this,k=j.If;if(a!==-1&&k)for(f=B(a+b,k.length),g=a;g<f;g++)h=k[g],h&&h.calc&&(j.FTa(e,-1,g),i=h.calc,c&&i.Yg(),d&&i.Bg())},a.prototype._g=function(a,b,c,d,e,f,g){var h,i,j,k;(e||f)&&(h=this,i=void 0,g&&(i=h.dUa()),0<=a&&0<=b?(h.Xg(a,b,c,d,e,f,i),h.Zg(a,c,e,f,i),h.$g(b,d,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))):0<=a&&b===-1?(h.Xg(a,0,c,h.cC(),e,f,i),h.Zg(a,c,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))):a===-1&&0<=b?(h.Xg(0,b,h.rC(),d,e,f,i),h.$g(b,d,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))):a===-1&&b===-1&&(j=h.rC(),k=h.cC(),h.Xg(0,0,j,k,e,f,i),h.Zg(0,j,e,f,i),h.$g(0,k,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))))},a.prototype.getAllNodes=function(){var a,b,c,d,e=[],f=this.dataTable,g=this.Hf,h=this.If,i=this.Jf;i&&e.push(i);for(b in g)g.hasOwnProperty(b)&&(a=g[b],a&&e.push(a));for(b in h)h.hasOwnProperty(b)&&(a=h[b],a&&e.push(a));for(c in f)if(f.hasOwnProperty(c)&&(d=f[c]))for(b in d)d.hasOwnProperty(b)&&(a=d[b],a&&e.push(a));return e},a.prototype.toJSON=function(a){b.supportRowColumnFormula?this.xf.toJSON(a,this.dataTable,this.Ef,this.Ff,this.If):this.xf.toJSON(a,this.dataTable,this.Ef,this.Ff)},a.prototype.bdK=function(a,c){b.supportRowColumnFormula?this.xf.bdK(a,this.dataTable,this.Ef,this.Ff,this.If):this.xf.bdK(a,this.dataTable,this.Ef,this.Ff,void 0,c)},a}(),b.CalcSourceModel=O,P=function(a){U(b,a);function b(b,c,d){var e=a.call(this,b)||this;return e.row=c,e.column=d,e.delay=0,e}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.row+","+a.column},b.prototype.og=function(){var a=this;a.ah.Rg(a.row,a.column,1,1)},b.prototype.ng=function(){var a=this;a.ah.Sg(a.row,a.column,1,1)},b.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,0)},b.prototype.fh=function(){this.ah.Cf().pg(this,0)},b.prototype.l_J=function(a){var b,c,d=this.ah.Cf(),e=this.Ze;for(b=0;b<e.length;b++)c=this[e[b]],c&&c.forEach(function(b){b&&b.ah&&b.ah!==a&&(b.dh||b.eh||b.fh&&b.fh(),d.calcOnDemand&&!b.$l&&(b.$l=!0,b.l_J(a)))})},b.prototype.Bg=function(){var a,b,c,d,e,f,g=this.ah.Cf(),h=this.Ze;for(a=0;a<h.length;a++)b=this[h[a]],b&&b.forEach(function(a){!a||a.dh||a.eh||a.fh(),g.calcOnDemand&&a&&!a.$l&&(a.$l=!0,a.Bg())});if(c=this.node&&this.node.Pf,c&&c.isDynamicArray)for(d=0;d<c.rowCount;d++)for(e=0;e<c.colCount;e++)0===d&&0===e||(f=this.ah.getNode(d+c.row,e+c.col),f&&f.calc&&f.calc.Bg())},b.prototype.y$a=function(){var a,b,c,d,e,f,g,h,i=this,j=i.ah,k=j.getCalcService();k&&k.nia&&(a=i.nia,b=a&&i.z$a,!b&&A(a)&&(c=j.getSource(),c&&(d=c.getName(),e=k.lh.asyncManager,f=e.y5[d],f&&(g=f[i.row],g&&(h=g[i.column],h&&(b=h[0],b?(i.nia=!0,i.z$a=b,b.h_a=i):i.nia=!1))))),b&&0===b.evaluateMode&&(b.v5=!1))},b}(J),b.CellCalc=P;function da(a,b,c){a[b]||(a[b]=[]),a[b].push(c)}function ea(a,b,c){var d,e=a[b];if(e)for(d=0;d<e.length;d++)if(e[d]===c)return void e.splice(d,1)}Q=function(a){U(b,a);function b(b,c){var d=a.call(this,b)||this;return d.row=c,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.row+",-1"},b.prototype.og=function(){this.ah.Tg(this.row,1)},b.prototype.ng=function(){this.ah.Ug(this.row,1)},b.prototype.Kg=function(a,b,c){c?da(this,E,{row:a,columnOffset:b,columnCount:1}):ea(this,E,{row:a,columnOffset:b,columnCount:1})},b.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,1)},b.prototype.fh=function(){this.ah.Cf().pg(this,1)},b}(J),b.RowCalc=Q,R=function(a){U(b,a);function b(b,c){var d=a.call(this,b)||this;return d.column=c,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+"-1,"+a.column},b.prototype.og=function(){this.ah.Vg(this.column,1)},b.prototype.ng=function(){this.ah.Wg(this.column,1)},b.prototype.Mg=function(a,b,c){this.gmb(2,a,c)},b.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,2)},b.prototype.fh=function(){this.ah.Cf().pg(this,2)},b}(J),b.ColumnCalc=R,S=function(a){U(b,a);function b(b,c){var d=a.call(this,b)||this;return d.name=c,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.name},b.prototype.updateListening=function(a,b){var c,d,e,f=this,g=f.Ze,h=function(a){var b,e,h,i=f[g[a]];if(i)for(b=[],i.forEach(function(a){a&&b.push(a)}),e=b.length,h=0;h<e;h++)c=b[h],d=c.node,c.ng(),d&&(!d.Pf||d.Pf.row===c.row&&d.Pf.col===c.column)&&c.ah.fg(c.row,c.column,d.Lf,d.Pf,!0)};for(e=0;e<g.length;e++)h(e)},b.prototype.updateListeningOnRemoved=function(){var a,b,c,d,e,f,g=this,h=g.Ze,i=g.ah,j=i.Cf();for(e=0;e<h.length;e++)f=g[h[e]],f&&f.forEach(function(e){var f,h;e&&(a=e.ah,b=e.row,c=e.col,b=b===p?-1:b,c=c===p?-1:c,d=a.Kf(b,c),f=a.Qf(b,c),d&&(h=j.ih().adjustFormulaOnRemoveName(i,d,g.name),h!==d&&a.fg(b,c,h,f,!0)))})},b.prototype.fh=function(){var a,b,c=this.Ze;for(a=0;a<c.length;a++)b=this[c[a]],b&&b.forEach(function(a){a&&a.fh()})},b}(J),b.NameCalc=S,T=function(a){U(b,a);function b(b){return a.call(this,b)||this}return b.prototype.processListener=function(b,c,d,e,f,g,h,j){var k,l,m,n,o,p=this,q=p[b],r=c+","+d+","+e+","+f;if(3!==b||g instanceof K){if(g.p9J)return void a.prototype.gmb.call(this,b,g,h);if(g.YDc&&g.YDc.length>=1&&(m=g.YDc,n=m[m.length-1],n.push(this),r="?"+r),j&&(r="!"+r),q||(p.Ze.push(b),p[b]=q=i.createMap()),k=q.get(r),!k){if(!h)return;k={},q.set(r,k),k.content=i.createMap(),k.row=c,k.col=d,k.rowCount=e,k.colCount=f}if(o=g.getKey(),h){if(k.content.has(o))return;k.content.set(o,g)}else k.content.has(o)&&(k.content.delete(o),k.content.size<1&&(delete k.content,q.delete(r)));p.clearListenersCache()}},b.prototype.Jg=function(a,b,c,d,e,f,g){this.processListener(0,a,b,c,d,e,f,g)},b.prototype.Xoa=function(a,b,c,d,e,f){this.processListener(3,a,b,c,d,e,f)},b.prototype.Yg=function(a,b,c,d){this.visit(0,a,b,c,d)},b.prototype.clearListenersCache=function(){var a,b=this.Ze;for(a=0;a<b.length;a++)delete this[b[a]+"cached"]},b.prototype.getListeners=function(a,b){var c,e,f=a[b],g=this[f];return g&&(e=f+"cached",c=this[e],c||(c=this[e]=new d.Common.rbush(16),g.forEach(function(a){a&&c.insert({minX:a.col,minY:a.row,maxX:a.col+a.colCount-1,maxY:a.row+a.rowCount-1,item:a})}))),c},b.prototype.visit=function(a,b,c,d,e){var f,g,h,i,j,k,l,m=this.Ze,n=this.ZAb();if(C.minX=c,C.minY=b,C.maxX=c+e-1,C.maxY=b+d-1,0===a){for(f=0;f<m.length;f++)if(g=this[m[f]])for(h=this.getListeners(m,f),i=h.search(C),j=0;j<i.length;j++)k=i[j].item.content,k.forEach(function(a){a.bh()});this.q9J&&this.q9J.forEach(function(a){a&&a.bh()})}else for(f=0;f<m.length;f++)if(g=this[m[f]])for(h=this.getListeners(m,f),i=h.search(C),j=0;j<i.length;j++)l=i[j].item,l.G9J&&l.G9J.ikK||(l.G9J=n.hkK,k=i[j].item.content,k.forEach(function(a){a.fh()}))},b.prototype.Bg=function(a,b,c,d){this.visit(1,a,b,c,d)},b.prototype.l_J=function(a){var b,c,d=this.Ze;for(b=0;b<d.length;b++)c=this[d[b]],c&&c.forEach(function(b){b&&b.content.forEach(function(b){b&&b.ah&&b.ah!==a&&b.fh&&b.fh()})})},b.prototype.gh=function(a,b,c){var d,e,f,g,h,i,j=this.Ze,k=c?1:-1;for(C.minX=b,C.minY=a,C.maxX=b,C.maxY=a,d=0;d<j.length;d++)if(e=this[j[d]])for(f=this.getListeners(j,d),g=f.search(C),h=0;h<g.length;h++)i=g[h].item.content,i&&i.forEach(function(a){a.delay+=k})},b.prototype.og=function(){},b.prototype.ng=function(){},b}(J),b.RangeCalc=T;function fa(a,b){var c,d,e;for(c in a)d=a[c],d&&(b?fa(d):(e=d.calc,e&&e.ng()))}function ga(a,b){if(!a.function){var c=b.getNameInfo(a.functionName);c&&(a.functionName=c.Cj)}}function ha(a,b,c,d,i,j,k){var l,m,n,q,v,w,x,y,z,B,C,D,E,F,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ha,ia,la=a.row,ma=a.column,na=[],oa=0,pa=a.arrayIdentity?a.arrayIdentity.row:la,qa=a.arrayIdentity?a.arrayIdentity.col:ma;for(na[oa]={expr:b,acceptsArray:j||!1,acceptsRef:k||!1,index:-1},l=0,m=0,n=!1,v=d,w=i,x=!1;oa>=0;){if(y=na[oa],oa--,z=y.acceptsArray,B=y.acceptsRef,b=y.expr,C=o,b){if(7===b.type){if(O=b,P=O.arguments.length,!O.function){if(!a){C=e.Hh(r);continue}O.function=a.getFunction(O.functionName),ga(O,a)}if(Q=O.function,R=y.index,N=y.neeedExpendindexs,R<0?(y.arrayArgumentEvaluateMode=x,y.arrayFormulaCatchValue=c,e.getFunctionArrayArgumentEvaluateMode(Q)&&(x=e.getFunctionArrayArgumentEvaluateMode(Q)),y.args=[]):(e.getFunctionAcceptsArray(Q,R)?l--:n&&(N||(N=[],y.neeedExpendindexs=N),O.arguments[R]!==D,N.push(R)),y.args.push(D)),R===P-1){if(x=y.arrayArgumentEvaluateMode,c=y.arrayFormulaCatchValue,S=y.args,T=!1,S&&S.length>0)for(U=0;U<S.length;U++)if(S[U]!==O.arguments[U]){T=!0;break}C=T?e.Jh(O,S):b,N&&N.length>0&&(C=e.createExpandExpression(C,N),n=!0)}else 0===R&&Q&&3===e.getFunctionArrayArgumentEvaluateMode(Q)&&3===x&&(x=0),n=!1,R++,y.index=R,e.getFunctionAcceptsArray(Q,R)&&l++,++oa,na[oa]=y,++oa,na[oa]={expr:O.arguments[R],acceptsArray:e.getFunctionAcceptsArray(Q,R),acceptsRef:e.getFunctionAcceptsReference(Q,R),index:-1}}else if(1===b.type&&b.sf())m&&(F=b.source!==e.BangSource&&b.source||a.source,J=F.getRowCount(),K=F.getColumnCount(),L=b.rowRelative?(b.row+pa)%e.MAX_ROW_COUNT%J:b.row,M=b.columnRelative?(b.column+qa)%e.MAX_COLUMN_COUNT%K:b.column,L=L<0?L+J:L,M=M<0?M+K:M,b=f.rf(b.source&&F,o,L,M,!1,!1));else if(1===b.type||13===b.type){if(13===b.type){if(V=b,E=V.getRange(la,ma),V.tzb(la,ma,a.source.id),!E){V._error?(delete V._error,C=D=s,a.rOb=1):(C=b,D=b);continue}b=f.uf(V.source===a.source?o:V.source,o,E.row,E.col,E.row+E.rowCount-1,E.col+E.colCount-1)}W=b.source!==e.BangSource&&b.source,X=b,m&&(F=W||a.source,J=e.MAX_ROW_COUNT,K=e.MAX_COLUMN_COUNT,Y=X.rowRelative?(X.row+pa)%J:X.row,Z=X.columnRelative?(X.column+qa)%K:X.column,$=X.endRowRelative?(X.endRow+pa)%J:X.endRow,_=X.endColumnRelative?(X.endColumn+qa)%K:X.endColumn,Y=Y<0?Y+J:Y,Z=Z<0?Z+K:Z,$=$<0?$+J:$,_=_<0?_+K:_,aa=void 0,Y>$&&(aa=Y,Y=$,$=aa),Z>_&&(aa=Z,Z=_,_=aa),J=F.getRowCount(),K=F.getColumnCount(),Y>=J?(Y%=J,$%=J):$>=J&&($=J-1),Z>=K?(Z%=K,_%=K):_>=K&&(_=K-1),b.row===e.BAND_INDEX_CONST&&(Y=$=e.BAND_INDEX_CONST),b.column===e.BAND_INDEX_CONST&&(Z=_=e.BAND_INDEX_CONST),b=f.uf(W,b.endSource,Y,Z,$,_,!1,!1,!1,!1)),B&&(z||!c&&1!==x&&3!==x)||la<0||ma<0||4===x||X.source&&X.source.J$J||(l>0&&!c&&1!==x&&3!==x||0===l||2===x?(E=X.getRange(la,ma),c||(B||z)&&1===x?!X.isFullColumn&&1!==E.rowCount&&v>=E.rowCount||!X.isFullRow&&1!==E.colCount&&w>=E.colCount?C=e.Hh(u):(L=(X.isFullColumn?0:E.row)+(1===E.rowCount?0:v),M=(X.isFullRow?0:E.col)+(1===E.colCount?0:w),C=f.rf(W,b.endSource,L,M,!1,!1)):E.rowCount>1&&E.colCount>1||E.rowCount>1&&!X.isFullColumn&&(la<E.row||la>=E.row+E.rowCount)||E.colCount>1&&!X.isFullRow&&(ma<E.col||ma>=E.col+E.colCount)?C=e.Hh(t):(L=X.isFullColumn||E.rowCount>1?la:E.row,M=X.isFullRow||E.colCount>1?ma:E.col,C=f.rf(W,b.endSource,L,M,!1,!1))):n=!0)}else if(9===b.type)ba=e.MYJ(b.operatorType),c&&A(b.value2)&&(ba=z=!1),y.index===-1?(y.index=b.value2?0:1,++oa,na[oa]=y,++oa,na[oa]=ja(b.value,ba,ba,-1)):0===y.index?(D!==b.value&&(C=e.Kh(b.operatorType,D,b.value2),y.expr=C),n&&(N=[],N.push(0),y.neeedExpendindexs=N,n=!1),y.index=1,++oa,na[oa]=y,++oa,na[oa]=ja(b.value2,ba,ba,-1)):(C=b.value2&&D!==b.value2?e.Kh(b.operatorType,b.value,D):A(b.value2)&&D!==b.value?e.Kh(b.operatorType,D,p):b,N=y.neeedExpendindexs,n&&(N?N.push(1):N=[b.value2&&b.value2===q?1:0]),N&&(C=e.createExpandExpression(C,N),n=!0));else if(10===b.type)y.index===-1?(y.index=0,++oa,na[oa]=y,++oa,na[oa]=ja(b.value,z,B,-1)):b.value!==D&&(C=e.Lh(D));else if(8===b.type)1===y.index?(m--,C=D,y.context&&(a=y.context)):(m++,++oa,na[oa]=ja(b,z,B,1,a),ca=void 0,da=a,ea=void 0,b.source?(ea=b.source===e.BangSource?a.source:b.source,da=new h.EvaluateContext(ea),da.cloneFrom(a),ca=ea.getCustomName(b.value)):(ca=a.getName(b.value),a.source.getCustomName(b.value)||(da=new h.GloableEvaluateContext(a.source),da.cloneFrom(a))),ca||(ca=e.Hh(r)),a=da||a,++oa,na[oa]=ja(ca,z,B,-1,a));else if(6===b.type)if(fa=b,
!z&&(l>0||c||1===x||3===x))n=!0,q=b;else if(!z&&0===l)if(v>=fa.value.RowCount&&fa.value.RowCount>1||w>=fa.value.colCount&&fa.value.colCount>1)C=e.Hh(u);else try{1===fa.value.RowCount&&(v=0),1===fa.value.colCount&&(w=0),ha=fa.value.getValue(v,w),typeof ha===H?C=e.createStringExpression(ha):typeof ha===G?C=e.createNumberExpression(ha):typeof ha===I?C=e.createBooleanExpression(ha):ha._error?C=e.Hh(ha):(ia=new g.Parser,C=ia.parse(a.source.getParserContext(a.useR1C1,ka(0,0)),""+ha))}catch(a){C=e.Hh(u)}}else;C===o&&(C=b),D=C}return C}b.qJJ=ha;function ia(a,b,c,d,i,j,k){var l,m,n,q,v,w,x,y,z,B,C,D,E,F,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ha,ia,la,ma,na,oa,pa,qa,ra=a.row,sa=a.column,ta=[],ua=0,va=a.arrayIdentity?a.arrayIdentity.row:ra,wa=a.arrayIdentity?a.arrayIdentity.col:sa;for(ta[ua]={expr:b,acceptsArray:j||!1,acceptsRef:k||!1,index:-1},l=0,m=0,n=!1,v=d,w=i,x=!1;ua>=0;){if(y=ta[ua],ua--,z=y.acceptsArray,B=y.acceptsRef,b=y.expr,C=o,b){if(7===b.type){if(O=b,P=O.arguments,Q=P.length,!O.function){if(!a){C=e.Hh(r);continue}R=O.functionName,O.function=a.getFunction(R),ga(O,a)}if(S=O.function,T=y.index,N=y.neeedExpendindexs,T<0?(y.arrayArgumentEvaluateMode=x,y.arrayFormulaCatchValue=c,e.getFunctionArrayArgumentEvaluateMode(S)&&(x=e.getFunctionArrayArgumentEvaluateMode(S)),y.args=[]):(e.getFunctionAcceptsArray(S,T)?l--:n&&(N||(N=[],y.neeedExpendindexs=N),O.arguments[T]!==D,N.push(T)),y.args.push(D)),T===Q-1){if(x=y.arrayArgumentEvaluateMode,c=y.arrayFormulaCatchValue,U=y.args,V=!1,U&&U.length>0)for(W=0;W<U.length;W++)if(U[W]!==O.arguments[W]){V=!0;break}C=V?e.Jh(O,U):b,N&&N.length>0&&(C=e.createExpandExpression(C,N),n=!0)}else 0===T&&S&&3===e.getFunctionArrayArgumentEvaluateMode(S)&&3===x&&(x=0),n=!1,T++,y.index=T,e.getFunctionAcceptsArray(S,T)&&l++,++ua,ta[ua]=y,++ua,ta[ua]={expr:O.arguments[T],acceptsArray:e.getFunctionAcceptsArray(S,T),acceptsRef:e.getFunctionAcceptsReference(S,T),index:-1}}else if(1===b.type&&b.sf())m&&(F=b.source!==e.BangSource&&b.source||a.source,J=F.getRowCount(),K=F.getColumnCount(),L=b.rowRelative?(b.row+va)%e.MAX_ROW_COUNT%J:b.row,M=b.columnRelative?(b.column+wa)%e.MAX_COLUMN_COUNT%K:b.column,L=L<0?L+J:L,M=M<0?M+K:M,b=f.rf(b.source&&F,o,L,M,!1,!1));else if(1===b.type||13===b.type){if(13===b.type){if(X=b,E=X.getRange(ra,sa),X.tzb(ra,sa,a.source.id),!E){X._error?(delete X._error,C=D=s,a.rOb=1):(C=b,D=b);continue}b=f.uf(X.source===a.source?o:X.source,o,E.row,E.col,E.row+E.rowCount-1,E.col+E.colCount-1)}Y=b.source!==e.BangSource&&b.source,Z=b,m&&(F=Y||a.source,J=e.MAX_ROW_COUNT,K=e.MAX_COLUMN_COUNT,$=Z.rowRelative?(Z.row+va)%J:Z.row,_=Z.columnRelative?(Z.column+wa)%K:Z.column,aa=Z.endRowRelative?(Z.endRow+va)%J:Z.endRow,ba=Z.endColumnRelative?(Z.endColumn+wa)%K:Z.endColumn,$=$<0?$+J:$,_=_<0?_+K:_,aa=aa<0?aa+J:aa,ba=ba<0?ba+K:ba,ca=void 0,$>aa&&(ca=$,$=aa,aa=ca),_>ba&&(ca=_,_=ba,ba=ca),J=F.getRowCount(),K=F.getColumnCount(),$>=J?($%=J,aa%=J):aa>=J&&(aa=J-1),_>=K?(_%=K,ba%=K):ba>=K&&(ba=K-1),b.row===e.BAND_INDEX_CONST&&($=aa=e.BAND_INDEX_CONST),b.column===e.BAND_INDEX_CONST&&(_=ba=e.BAND_INDEX_CONST),b=f.uf(Y,b.endSource,$,_,aa,ba,!1,!1,!1,!1)),k||B&&(z||!c&&1!==x&&3!==x)||ra<0||sa<0||(l>0&&!c&&1!==x&&3!==x||0===l||2===x?(E=Z.getRange(ra,sa),c||(B||z)&&1===x?!Z.isFullColumn&&1!==E.rowCount&&v>=E.rowCount||!Z.isFullRow&&1!==E.colCount&&w>=E.colCount?C=e.Hh(u):(L=(Z.isFullColumn?0:E.row)+(1===E.rowCount?0:v),M=(Z.isFullRow?0:E.col)+(1===E.colCount?0:w),C=f.rf(Y,b.endSource,L,M,!1,!1)):E.rowCount>1&&E.colCount>1||E.rowCount>1&&!Z.isFullColumn&&(ra<E.row||ra>=E.row+E.rowCount)||E.colCount>1&&!Z.isFullRow&&(sa<E.col||sa>=E.col+E.colCount)?C=e.Hh(t):(L=Z.isFullColumn||E.rowCount>1?ra:E.row,M=Z.isFullRow||E.colCount>1?sa:E.col,C=f.rf(Y,b.endSource,L,M,!1,!1))):n=!0)}else if(9===b.type)da=e.MYJ(b.operatorType),ea=B&&a.source&&a.source.Af&&a.source.Af.allowDynamicArray,y.index===-1?(c&&A(b.value2)&&(da=z=!1),y.index=b.value2?0:1,++ua,ta[ua]=y,++ua,ta[ua]=ja(b.value,da||z,da||ea,-1)):0===y.index?(D!==b.value&&(C=e.Kh(b.operatorType,D,b.value2),y.expr=C),n&&(N=[],N.push(0),y.neeedExpendindexs=N,n=!1),y.index=1,++ua,ta[ua]=y,++ua,ta[ua]=ja(b.value2,da||z,da||ea,-1)):(C=b.value2&&D!==b.value2?e.Kh(b.operatorType,b.value,D):A(b.value2)&&D!==b.value?e.Kh(b.operatorType,D,p):b,N=y.neeedExpendindexs,n&&(N?N.push(1):N=[b.value2&&b.value2===q?1:0]),N&&(C=e.createExpandExpression(C,N),n=!0));else if(10===b.type)y.index===-1?(y.index=0,++ua,ta[ua]=y,++ua,ta[ua]=ja(b.value,z,B,-1)):b.value!==D&&(C=e.Lh(D));else if(8===b.type)1===y.index?(b.mWJ=p,m--,C=D,y.context&&(a=y.context)):b.mWJ||(b.mWJ=!0,m++,++ua,ta[ua]=ja(b,z,B,1,a),fa=void 0,ha=a,ia=void 0,b.source?(ia=b.source===e.BangSource?a.source:b.source,ha=new h.EvaluateContext(ia),ha.cloneFrom(a),fa=ia.getCustomName(b.value)):(fa=a.getName(b.value),a.source.getCustomName(b.value)||(ha=new h.GloableEvaluateContext(a.source),ha.cloneFrom(a))),fa||(fa=e.Hh(r)),a=ha||a,++ua,ta[ua]=ja(fa,z,B,-1,a));else if(6===b.type)if(la=b,ma=b.value,!z&&(l>0||c||1===x||3===x))n=!0,q=b;else if(!z&&0===l)if(na=ma.getRowCount(),oa=ma.getColumnCount(),v>=na&&na>1||w>=oa&&oa>1)C=e.Hh(u);else if(c||!(a.source&&a.source.Af&&a.source.Af.allowDynamicArray))try{1===na&&(v=0),1===oa&&(w=0),pa=la.value.getValue(v,w),typeof pa===H?C=e.createStringExpression(pa):typeof pa===G?C=e.createNumberExpression(pa):typeof pa===I?C=e.createBooleanExpression(pa):pa._error?C=e.Hh(pa):(qa=new g.Parser,C=qa.parse(a.source.getParserContext(a.useR1C1,ka(0,0)),""+pa))}catch(a){C=e.Hh(u)}}else;C===o&&(C=b),D=C}return C}b.Mh=ia;function ja(a,b,c,d,e){return{expr:a,acceptsArray:b,acceptsRef:c,index:d,context:e}}function ka(a,b){return{row:a,col:b}}b.pf=ka;function la(a,b,c,d){return{row:a,col:b,rowCount:c,colCount:d}}b.qf=la;function ma(a){return a.row===-1||a.col===-1||a.rowUndefine||a.colUndefine||a.rowCount*a.colCount>1}function na(a,b,c,d,e){d===e||!A(d)&&!A(e)||A(a)||(!A(d)&&A(e)&&a.removeRowAndColInfo(b,c),A(d)&&!A(e)&&a.addRowAndColInfo(b,c))}},"./src/calcEngine.res.en.ts":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0});function i(a,b){return{description:a,parameters:b}}function j(a,b){return{name:a,repeatable:b}}d="[start_num]",e="[significance]",f="[match_mode]",g="[if_not_found]",h="[pad_with]",b.resource={Exp_InvalidCast:"Invalid Cast Exception",Exp_FormulaInvalidChar:"The formula contains an invalid character: '{0}' at index on {1}",Exp_FormulaInvalid:"Invalid Formula",Exp_InvalidFunctionName:"Invalid function name",Exp_InvalidOverrideFunction:"Cannot override built-in function",Exp_InvalidArray:"Invalid array",Exp_OverrideNotAllowed:"Attempt to override function while override is not allowed",Exp_NoSyntax:"No syntax '{0}' to match the syntax '{1}'.",Exp_IsValid:"'{0}' is invalid.",Exp_InvalidParameters:"Invalid function parameter at {0}.",Exp_InvalidArrayColumns:"The length of array columns are not equal at {0}.",Exp_ExprIsNull:"The argument 'expr' is null",Exp_InvalidOperation:"Invalid Operation Exception",Exp_ArgumentNull:"Argument Null Exception",Exp_CriteriaIsNull:"Criteria is null",Exp_Format:"Format",Exp_ArrayFormulaPart:"Cannot change part of an array.",Exp_NotSupported:"Not Supported Exception",Exp_DuplicatedChar:"Duplicated Character",Exp_ArgumentOutOfRangeException:"Argument Out Of Range Exception",Exp_ArgumentException:"Argument Exception",_h:{ABS:i("This function calculates the absolute value of the specified value.",[j("number")]),ACCRINT:i("This function calculates the accrued interest for a security that pays periodic interest.",[j("issue"),j("first_interest"),j("settlement"),j("rate"),j("par"),j("frequency"),j("basis")]),ACCRINTM:i("This function calculates the accrued interest at maturity for a security that pays periodic interest.",[j("issue"),j("settlement"),j("rate"),j("par"),j("basis")]),ACOS:i("This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[j("number")]),ACOSH:i("This function calculates the inverse hyperbolic cosine of the specified value.",[j("number")]),ADDRESS:i("This function uses the row and column numbers to create a cell address in text.",[j("row_num"),j("column_num"),j("abs_num"),j("a1style"),j("sheet_text")]),AGGREGATE:i("This function aggregate a list of numbers using a specified built-in function.",[j("function_num"),j("options"),j("ref1"),j("ref2",!0)]),AMORDEGRC:i("This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[j("cost"),j("date_purchased"),j("first_period"),j("salvage"),j("period"),j("rate"),j("basis")]),AMORLINC:i("This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[j("cost"),j("date_purchased"),j("first_period"),j("salvage"),j("period"),j("rate"),j("basis")]),AND:i("Check whether all arguments are True, and returns True if all arguments are True.",[j("logical1"),j("logical2")]),ASIN:i("This function calculates the arcsine, that is, the angle whose sine is the specified value.",[j("number")]),ASINH:i("This function calculates the inverse hyperbolic sine of a number.",[j("number")]),ATAN:i("This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[j("number")]),ATAN2:i("This function calculates the arctangent of the specified x- and y-coordinates.",[j("x_num"),j("y_num")]),ATANH:i("This function calculates the inverse hyperbolic tangent of a number.",[j("number")]),AVEDEV:i("This function calculates the average of the absolute deviations of the specified values from their mean.",[j("number1"),j("number2",!0)]),AVERAGE:i("This function calculates the average of the specified numeric values.",[j("number1"),j("number2",!0)]),AVERAGEA:i("This function calculates the average of the specified values, including text or logical values as well as numeric values.",[j("value1"),j("value2",!0)]),AVERAGEIF:i("This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[j("range"),j("criteria"),j("[average_range]")]),AVERAGEIFS:i("This function calculates the average of all cells that meet multiple specified criteria.",[j("average_range"),j("criteria_range1",!0),j("criteria1",!0)]),BESSELI:i("This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[j("value"),j("order")]),BESSELJ:i("This function calculates the Bessel function of the first kind.",[j("value"),j("order")]),BESSELK:i("This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[j("value"),j("order")]),BESSELY:i("This function calculates the Bessel function of the second kind.",[j("value"),j("order")]),BETADIST:i("This function calculates the cumulative beta distribution function.",[j("x"),j("alpha"),j("beta"),j("lower"),j("upper")]),BETAINV:i("This function calculates the inverse of the cumulative beta distribution function.",[j("probability"),j("alpha"),j("beta"),j("lower"),j("upper")]),BIN2DEC:i("This function converts a binary number to a decimal number",[j("number")]),BIN2HEX:i("This function converts a binary number to a hexadecimal number.",[j("number"),j("places")]),BIN2OCT:i("This function converts a binary number to an octal number.",[j("number"),j("places")]),BINOMDIST:i("This function calculates the individual term binomial distribution probability.",[j("number_s"),j("trials"),j("probability_s"),j("cumulative")]),CEILING:i("This function rounds a number up to the nearest multiple of a specified value.",[j("number"),j("significance")]),CHAR:i("This function returns the character specified by a number.",[j("number")]),CHIDIST:i("This function calculates the one-tailed probability of the chi-squared distribution.",[j("value"),j("deg_freedom")]),CHIINV:i("This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[j("probability"),j("deg_freedom")]),CHITEST:i("This function calculates the test for independence from the chi-squared distribution.",[j("actual_range"),j("expected_range")]),CHOOSE:i("This function returns a value from a list of values.",[j("index_num"),j("value1"),j("value2",!0)]),CLEAN:i("This function removes all non-printable characters from text.",[j("text")]),CODE:i("This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[j("text")]),COLUMN:i("This function returns the column number of a reference.",[j("reference")]),COLUMNS:i("This function returns the number of columns in an array.",[j("array")]),COMBIN:i("This function calculates the number of possible combinations for a specified number of items.",[j("number"),j("number_chosen")]),COMPLEX:i("This function converts real and imaginary coefficients into a complex number.",[j("real_num"),j("image_num"),j("suffix")]),CONCATENATE:i("This function combines multiple text strings or numbers into one text string.",[j("text1"),j("text2",!0)]),CONFIDENCE:i("This function returns confidence interval for a population mean.",[j("alpha"),j("standard_dev"),j("size")]),CONVERT:i("This function converts a number from one measurement system to its equivalent in another measurement system.",[j("number"),j("from_unit"),j("to_unit")]),CORREL:i("This function returns the correlation coefficient of the two sets of data.",[j("array1"),j("array2")]),COS:i("This function returns the cosine of the specified angle.",[j("number")]),COSH:i("This function returns the hyperbolic cosine of the specified value.",[j("number")]),COUNT:i("This function returns the number of cells that contain numbers.",[j("value1"),j("value2",!0)]),COUNTA:i("This function returns the number of number of cells that contain numbers, text, or logical values.",[j("value1"),j("value2",!0)]),COUNTBLANK:i("This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[j("cellrange")]),COUNTIF:i("This function returns the number of cells that meet a certain condition",[j("cellrange"),j("criteria")]),COUNTIFS:i("This function returns the number of cells that meet multiple conditions.",[j("criteria_range1",!0),j("criteria1",!0)]),COUPDAYBS:i("This function calculates the number of days from the beginning of the coupon period to the settlement date.",[j("settlement"),j("maturity"),j("frequency"),j("basis")]),COUPDAYS:i("This function returns the number of days in the coupon period that contains the settlement date.",[j("settlement"),j("maturity"),j("frequency"),j("basis")]),COUPDAYSNC:i("This function calculates the number of days from the settlement date to the next coupon date.",[j("settlement"),j("maturity"),j("frequency"),j("basis")]),COUPNCD:i("This function returns a date number of the next coupon date after the settlement date.",[j("settlement"),j("maturity"),j("frequency"),j("basis")]),COUPNUM:i("This function returns the number of coupons due between the settlement date and maturity date.",[j("settlement"),j("maturity"),j("frequency"),j("basis")]),COUPPCD:i("This function returns a date number of the previous coupon date before the settlement date.",[j("settlement"),j("maturity"),j("frequency"),j("basis")]),COVAR:i("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[j("array1"),j("array2")]),CRITBINOM:i("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[j("trials"),j("probability_s"),j("alpha")]),CUMIPMT:i("This function returns the cumulative interest paid on a loan between the starting and ending periods.",[j("rate"),j("nper"),j("pval"),j("start_period"),j("end_period"),j("paytype")]),CUMPRINC:i("This function returns the cumulative principal paid on a loan between the start and end periods.",[j("rate"),j("nper"),j("pval"),j("start_period"),j("end_period"),j("paytype")]),DATE:i("This function returns the DateTime object for a particular date, specified by the year, month, and day.",[j("year"),j("month"),j("day")]),DATEDIF:i("This function returns the number of days, months, or years between two dates.",[j("start_date"),j("end_date"),j("unit")]),DATEVALUE:i("This function returns a DateTime object of the specified date.",[j("date_text")]),DAVERAGE:i("This function calculates the average of values in a column of a list or database that match the specified conditions.",[j("database"),j("field"),j("criteria")]),DAY:i("This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[j("date")]),DAYS360:i("This function returns the number of days between two dates based on a 360-day year.",[j("start_date"),j("end_date"),j("method")]),DB:i("This function calculates the depreciation of an asset for a specified period using the fixed\u2011declining balance method",[j("cost"),j("salvage"),j("life"),j("period"),j("month")]),DCOUNT:i("This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[j("database"),j("field"),j("criteria")]),DCOUNTA:i("This function counts the non-blank cells in a column of a list or database that match the specified conditions",[j("database"),j("field"),j("criteria")]),DDB:i("This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[j("cost"),j("salvage"),j("life"),j("period"),j("factor")]),DEC2BIN:i("This function converts a decimal number to a binary number.",[j("number"),j("places")]),DEC2HEX:i("This function converts a decimal number to a hexadecimal number",[j("number"),j("places")]),DEC2OCT:i("This function converts a decimal number to an octal number",[j("number"),j("places")]),DEGREES:i("This function converts the specified value from radians to degrees",[j("angle")]),DELTA:i("This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[j("number1"),j("number2")]),DEVSQ:i("This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[j("number1"),j("number2",!0)]),DGET:i("This function extracts a single value from a column of a list or database that matches the specified conditions.",[j("database"),j("field"),j("criteria")]),DISC:i("This function calculates the discount rate for a security.",[j("settlement"),j("maturity"),j("price"),j("redemption"),j("basis")]),DMAX:i("This function returns the largest number in a column of a list or database that matches the specified conditions.",[j("database"),j("field"),j("criteria")]),DMIN:i("This function returns the smallest number in a column of a list or database that matches the specified conditions.",[j("database"),j("field"),j("criteria")]),DOLLAR:i("This function converts a number to text using currency format, with the decimals rounded to the specified place.",[j("number"),j("decimals")]),DOLLARDE:i("This function converts a fraction dollar price to a decimal dollar price.",[j("fractional_dollar"),j("fraction")]),DOLLARFR:i("This function converts a decimal number dollar price to a fraction dollar price.",[j("decimal_dollar"),j("fraction")]),DPRODUCT:i("This function multiplies the values in a column of a list or database that match the specified conditions.",[j("database"),j("field"),j("criteria")]),DSTDEV:i("This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[j("database"),j("field"),j("criteria")]),DSTDEVP:i("This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[j("database"),j("field"),j("criteria")]),DSUM:i("This function adds the numbers in a column of a list or database that match the specified conditions.",[j("database"),j("field"),j("criteria")]),DURATION:i("This function returns the Macaulay duration for an assumed par value of $100.",[j("settlement"),j("maturity"),j("coupon"),j("yield"),j("frequency"),j("basis")]),DVAR:i("This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[j("database"),j("field"),j("criteria")]),DVARP:i("This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[j("database"),j("field"),j("criteria")]),EDATE:i("This function calculates the date that is the indicated number of months before or after a specified date.",[j("start_date"),j("months")]),EFFECT:i("This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[j("nominal_rate"),j("npery")]),EOMONTH:i("This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[j("start_date"),j("months")]),ERF:i("This function calculates the error function integrated between a lower and an upper limit.",[j("lower_limit"),j("upper_limit")]),ERFC:i("This function calculates the complementary error function integrated between a lower limit and infinity.",[j("lowerlimit")]),"ERROR.TYPE":i("This function returns a number corresponding to one of the error values.",[j("error_val")]),EURO:i("This function returns the equivalent of one Euro based on the ISO currency code.",[j("code")]),EUROCONVERT:i("This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[j("number"),j("source"),j("target"),j("full_precision"),j("triangulation_precision")]),EVEN:i("This function rounds the specified value up to the nearest even integer.",[j("number")]),EXACT:i("This function returns true if two strings are the same; otherwise, false.",[j("text1"),j("text2")]),EXP:i("This function returns e raised to the power of the specified value.",[j("number")]),EXPONDIST:i("This function returns the exponential distribution or the probability density.",[j("value"),j("lambda"),j("cumulative")]),FACT:i("This function calculates the factorial of the specified number.",[j("number")]),FACTDOUBLE:i("This function calculates the double factorial of the specified number.",[j("number")]),FALSE:i("This function returns the value for logical FALSE.",[]),FDIST:i("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[j("value"),j("deg_freedom1"),j("deg_freedom2")]),FIND:i("This function finds one text value within another and returns the text value\u2019s position in the text you searched.",[j("find_text"),j("within_text"),j(d)]),FINV:i("This function returns the inverse of the F probability distribution.",[j("probability"),j("deg_freedom1"),j("deg_freedom2")]),FISHER:i("This function returns the Fisher transformation for a specified value.",[j("value")]),FISHERINV:i("This function returns the inverse of the Fisher transformation for a specified value.",[j("value")]),FIXED:i("This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[j("number"),j("decimals"),j("no_commas")]),FLOOR:i("This function rounds a number down to the nearest multiple of a specified value.",[j("number"),j("significance")]),FORECAST:i("This function calculates a future value using existing values.",[j("value"),j("Yarray"),j("Xarray")]),FREQUENCY:i("This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[j("data_array"),j("bins_array")]),FTEST:i("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[j("array1"),j("array2")]),FV:i("This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[j("rate"),j("numper"),j("paymt"),j("pval"),j("type")]),FVSCHEDULE:i("This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[j("principal"),j("schedule")]),GAMMADIST:i("This function returns the gamma distribution.",[j("x"),j("alpha"),j("beta"),j("cumulative")]),GAMMAINV:i("This function returns the inverse of the gamma cumulative distribution.",[j("probability"),j("alpha"),j("beta")]),GAMMALN:i("This function returns the natural logarithm of the Gamma function, G(x).",[j("value")]),GCD:i("This function returns the greatest common divisor of two numbers.",[j("number1"),j("number2")]),GEOMEAN:i("This function returns the geometric mean of a set of positive data.",[j("number1"),j("number2",!0)]),GESTEP:i("This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[j("number"),j("step")]),GROWTH:i("This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[j("y"),j("x"),j("newx"),j("constant")]),HARMEAN:i("This function returns the harmonic mean of a data set.",[j("number1"),j("number2",!0)]),HEX2BIN:i("This function converts a hexadecimal number to a binary number.",[j("number"),j("places")]),HEX2DEC:i("This function converts a hexadecimal number to a decimal number.",[j("number")]),HEX2OCT:i("This function converts a hexadecimal number to an octal number.",[j("number"),j("places")]),HLOOKUP:i("This function searches for a value in the top row and then returns a value in the same column from a specified row.",[j("lookup_value"),j("table_array"),j("row_index_num"),j("range_lookup")]),HOUR:i("This function returns the hour that corresponds to a specified time.",[j("time")]),HYPGEOMDIST:i("This function returns the hypergeometric distribution.",[j("sample_s"),j("number_sample"),j("population_s"),j("number_pop")]),IF:i("This function performs a comparison and returns one of two provided values based on that comparison.",[j("logical_test"),j("value_if_true"),j("value_if_false")]),IFERROR:i("This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[j("value"),j("value_if_error")]),IMABS:i("This function returns the absolute value or modulus of a complex number.",[j("complexnum")]),IMAGINARY:i("This function returns the imaginary coefficient of a complex number.",[j("complexnum")]),IMARGUMENT:i("This function returns the argument theta, which is an angle expressed in radians.",[j("complexnum")]),IMCONJUGATE:i("This function returns the complex conjugate of a complex number.",[j("complexnum")]),IMCOS:i("This function returns the cosine of a complex number.",[j("complexnum")]),IMDIV:i("This function returns the quotient of two complex numbers.",[j("complexnum"),j("complexdenom")]),IMEXP:i("This function returns the exponential of a complex number.",[j("complexnum")]),IMLN:i("This function returns the natural logarithm of a complex number.",[j("complexnum")]),IMLOG2:i("This function returns the base-2 logarithm of a complex number.",[j("complexnum")]),IMLOG10:i("This function returns the common logarithm of a complex number.",[j("complexnum")]),IMPOWER:i("This function returns a complex number raised to a power.",[j("complexnum"),j("powernum")]),IMPRODUCT:i("This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[j("complexnum1"),j("complexnum2",!0)]),IMREAL:i("This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[j("complexnum")]),IMSIN:i("This function returns the sine of a complex number in the x+yi or x+yj text format.",[j("complexnum")]),IMSQRT:i("This function returns the square root of a complex number in the x+yi or x+yj text format.",[j("complexnum")]),IMSUB:i("This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[j("complexnum1"),j("complexnum2")]),IMSUM:i("This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[j("complexnum1"),j("complexnum2",!0)]),INDEX:i("This function returns a value or the reference to a value from within an array or range.",[j("array"),j("row_num"),j("column_num"),j("area_num")]),INDIRECT:i("This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[j("ref_text"),j("[a1_style]")]),INT:i("This function rounds a specified number down to the nearest integer.",[j("number")]),INTERCEPT:i("This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[j("dependent"),j("independent")]),INTRATE:i("This function calculates the interest rate for a fully invested security.",[j("settlement"),j("maturity"),j("investment"),j("redemption"),j("basis")]),IPMT:i("This function calculates the payment of interest on a loan.",[j("rate"),j("per"),j("nper"),j("pval"),j("fval"),j("type")]),IRR:i("This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[j("arrayvals"),j("estimate")]),ISBLANK:i("This function tests whether a value, an expression, or contents of a referenced cell is empty.",[j("cellreference")]),ISERR:i("This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[j("cellreference")]),ISERROR:i("This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[j("cellreference")]),ISEVEN:i("This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[j("cellreference")]),ISLOGICAL:i("This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[j("cellreference")]),ISNA:i("This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[j("cellreference")]),ISNONTEXT:i("This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[j("cellreference")]),ISNUMBER:i("This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[j("cellreference")]),ISODD:i("This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[j("cellreference")]),ISPMT:i("This function calculates the interest paid during a specific period of an investment.",[j("rate"),j("per"),j("nper"),j("pv")]),ISREF:i("This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[j("cellreference")]),ISTEXT:i("This function tests whether a value, an expression, or contents of a referenced cell has text data.",[j("cellreference")]),KURT:i("This function returns the kurtosis of a data set.",[j("number1"),j("number2"),j("number3"),j("number4",!0)]),LARGE:i("This function returns the nth largest value in a data set, where n is specified.",[j("array"),j("n")]),LCM:i("This function returns the least common multiple of two numbers.",[j("number1"),j("number2")]),LEFT:i("This function returns the specified leftmost characters from a text value, and based on the number of characters you specify.",[j("text"),j("num_chars")]),
LEN:i("This function returns the length of the number of characters in a text string.",[j("text")]),LINEST:i("This function calculates the statistics for a line.",[j("y"),j("x"),j("constant"),j("stats")]),LN:i("This function returns the natural logarithm of the specified number.",[j("value")]),LOG:i("This function returns the logarithm base Y of a number X.",[j("number"),j("base")]),LOG10:i("This function returns the logarithm base 10 of the number given.",[j("number")]),LOGEST:i("This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[j("y"),j("x"),j("constant"),j("stats")]),LOGINV:i("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[j("probability"),j("mean"),j("standard_dev")]),LOGNORMDIST:i("This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[j("x"),j("mean"),j("standard_dev")]),LOOKUP:i("This function searches for a value and returns a value from the same location in a second area.",[j("lookup_value"),j("lookup_vector"),j("result_vector")]),LOWER:i("This function converts text to lower case letters.",[j("text")]),MATCH:i("This function returns the relative position of a specified item in a range.",[j("lookup_value"),j("lookup_array"),j("match_type")]),XMATCH:i("This function returns the relative position of an item in an array. By default, an exact match is required.",[j("lookup_value"),j("lookup_array"),j(f),j("[search_mode]")]),XLOOKUP:i("This function searches a range or an array for a match and returns the corresponding item from a second range or array. By default, an exact match is used.",[j("lookup_value"),j("lookup_array"),j("return_array"),j(g),j(f),j("[search_mode]")]),MAX:i("This function returns the maximum value, the greatest value, of all the values in the arguments.",[j("number1"),j("number2",!0)]),MAXA:i("This function returns the largest value in a list of arguments, including text and logical values.",[j("value1"),j("value2",!0)]),MDETERM:i("This function returns the matrix determinant of an array.",[j("array")]),MDURATION:i("This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[j("settlement"),j("maturity"),j("coupon"),j("yield"),j("frequency"),j("basis")]),MEDIAN:i("This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[j("number1"),j("number2",!0)]),MID:i("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of characters you specify.",[j("text"),j("start_num"),j("num_chars")]),MIN:i("This function returns the minimum value, the least value, of all the values in the arguments.",[j("number1"),j("number2",!0)]),MINA:i("This function returns the minimum value in a list of arguments, including text and logical values.",[j("value1"),j("value2",!0)]),MINUTE:i("This function returns the minute corresponding to a specified time.",[j("time")]),MINVERSE:i("This function returns the inverse matrix for the matrix stored in an array.",[j("array")]),MIRR:i("This function returns the modified internal rate of return for a series of periodic cash flows.",[j("values"),j("finance_rate"),j("reinvest_rate")]),MMULT:i("This function returns the matrix product for two arrays.",[j("array1"),j("array2")]),MOD:i("This function returns the remainder of a division operation.",[j("dividend"),j("divisor")]),MODE:i("This function returns the most frequently occurring value in a set of data.",[j("number1"),j("number2",!0)]),MONTH:i("This function returns the month corresponding to the specified date value.",[j("date")]),MROUND:i("This function returns a number rounded to the desired multiple.",[j("number"),j("multiple")]),MULTINOMIAL:i("This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[j("number1"),j("number2",!0)]),MUNIT:i("The function returns the unit matrix for the specified dimension.",[j("dimension")]),N:i("This function returns a value converted to a number.",[j("value")]),NA:i("This function returns the error value #N/A that means not available.",[]),SHEET:i("Returns the sheet number of reference sheet.",[j("[value]")]),SHEETS:i("Returns the number of sheets in a reference.",[j("[reference]")]),NEGBINOMDIST:i("This function returns the negative binomial distribution.",[j("number_f"),j("number_s"),j("probability_s")]),NETWORKDAYS:i("This function returns the total number of complete working days between the start and end dates.",[j("start_date"),j("end_date"),j("holidays")]),NOMINAL:i("This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[j("effect_rate"),j("npery")]),NORMDIST:i("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[j("x"),j("mean"),j("standard_dev"),j("cumulative")]),NORMINV:i("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[j("probability"),j("mean"),j("standard_dev")]),NORMSDIST:i("This function returns the standard normal cumulative distribution function.",[j("value")]),NORMSINV:i("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[j("probability")]),NOT:i("This function reverses the logical value of its argument.",[j("logical")]),NOW:i("This function returns the current date and time.",[]),NPER:i("This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[j("rate"),j("paymt"),j("pval"),j("fval"),j("type")]),NPV:i("This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[j("rate"),j("value1"),j("value2",!0)]),OBJECT:i("This function converts the property/expression sequence to an object.",[j("property1",!0),j("expression1",!0)]),OCT2BIN:i("This function converts an octal number to a binary number.",[j("number"),j("places")]),OCT2DEC:i("This function converts an octal number to a decimal number.",[j("number")]),OCT2HEX:i("This function converts an octal number to a hexadecimal number.",[j("number"),j("places")]),ODD:i("This function rounds the specified value up to the nearest odd integer.",[j("number")]),ODDFPRICE:i("This function calculates the price per $100 face value of a security with an odd first period.",[j("settlement"),j("maturity"),j("issue"),j("first_coupon"),j("rate"),j("yield"),j("redemption"),j("frequency"),j("basis")]),ODDFYIELD:i("This function calculates the yield of a security with an odd first period.",[j("settlement"),j("maturity"),j("issue"),j("first_coupon"),j("rate"),j("price"),j("redemption"),j("frequency"),j("basis")]),ODDLPRICE:i("This function calculates the price per $100 face value of a security with an odd last coupon period.",[j("settlement"),j("maturity"),j("last_interest"),j("rate"),j("yield"),j("redemption"),j("frequency"),j("basis")]),ODDLYIELD:i("This function calculates the yield of a security with an odd last period.",[j("settlement"),j("maturity"),j("last_interest"),j("rate"),j("price"),j("redemption"),j("frequency"),j("basis")]),OFFSET:i("This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[j("reference"),j("rows"),j("cols"),j("height"),j("width")]),OR:i("This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[j("logical1"),j("logical2",!0)]),PEARSON:i("This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[j("array_ind"),j("array_dep")]),PERCENTILE:i("This function returns the nth percentile of values in a range.",[j("array"),j("n")]),PERCENTRANK:i("This function returns the rank of a value in a data set as a percentage of the data set.",[j("array"),j("x"),j("significance")]),PERMUT:i("This function returns the number of possible permutations for a specified number of items.",[j("number"),j("number_chosen")]),PI:i("This function returns PI as 3.1415926536.",[]),PMT:i("This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[j("rate"),j("nper"),j("pval"),j("fval"),j("type")]),POISSON:i("This function returns the Poisson distribution.",[j("nevents"),j("mean"),j("cumulative")]),POWER:i("This function raises the specified number to the specified power.",[j("number"),j("power")]),PPMT:i("This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[j("rate"),j("per"),j("nper"),j("pval"),j("fval"),j("type")]),PRICE:i("This function calculates the price per $100 face value of a periodic interest security",[j("settlement"),j("maturity"),j("rate"),j("yield"),j("redemption"),j("frequency"),j("basis")]),PRICEDISC:i("This function returns the price per $100 face value of a discounted security.",[j("settlement"),j("maturity"),j("discount"),j("redemption"),j("basis")]),PRICEMAT:i("This function returns the price at maturity per $100 face value of a security that pays interest.",[j("settlement"),j("maturity"),j("issue"),j("rate"),j("yield"),j("basis")]),PROB:i("This function returns the probability that values in a range are between two limits.",[j("x_range"),j("prob_range"),j("lower_limit"),j("upper_limit")]),PRODUCT:i("This function multiplies all the arguments and returns the product.",[j("number1"),j("number2",!0)]),PROPER:i("This function capitalizes the first letter in each word of a text string.",[j("text")]),PROPERTY:i("This function returns the value of property path in object.",[j("data_expression"),j("property_path")]),PV:i("This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[j("rate"),j("numper"),j("paymt"),j("fval"),j("type")]),QUARTILE:i("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[j("array"),j("quart")]),QUOTIENT:i("This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[j("numerator"),j("denominator")]),RADIANS:i("This function converts the specified number from degrees to radians.",[j("angle")]),RAND:i("This function returns an evenly distributed random number between 0 and 1.",[]),RANDBETWEEN:i("This function returns a random number between the numbers you specify.",[j("bottom"),j("top")]),RANGEBLOCKSPARKLINE:i("This function returns a rangetemplate.",[j("template_range"),j("data_expression")]),RANK:i("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[j("number"),j("ref"),j("order")]),RATE:i("This function returns the interest rate per period of an annuity.",[j("nper"),j("pmt"),j("pval"),j("fval"),j("type"),j("guess")]),RECEIVED:i("This function returns the amount received at maturity for a fully invested security.",[j("settlement"),j("maturity"),j("investment"),j("discount"),j("basis")]),REPLACE:i("This function replaces part of a text string with a different text string, based on the number of characters you specify.",[j("old_text"),j("start_num"),j("num_chars"),j("new_text")]),REPT:i("This function repeats text a specified number of times.",[j("text"),j("number_times")]),RIGHT:i("This function returns the specified rightmost characters from a text value, and based on the number of characters you specify.",[j("text"),j("num_chars")]),ROMAN:i("This function converts an Arabic numeral to a Roman numeral text equivalent.",[j("number"),j("form")]),ROUND:i("This function rounds the specified value to the nearest number, using the specified number of decimal places.",[j("number"),j("num_digits")]),ROUNDDOWN:i("This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[j("number"),j("num_digits")]),ROUNDUP:i("This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[j("number"),j("num_digits")]),ROW:i("This function returns the number of a row from a reference.",[j("reference")]),ROWS:i("This function returns the number of rows in an array.",[j("array")]),RSQ:i("This function returns the square of the Pearson product moment correlation coefficient (R-squared) through data points in known y's and known x's.",[j("array_dep"),j("array_ind")]),SEARCH:i("This function finds one text string in another text string and returns the index of the starting position of the found text.",[j("find_text"),j("within_text"),j(d)]),SECOND:i("This function returns the seconds (0 to 59) value for a specified time.",[j("time")]),SERIESSUM:i("This function returns the sum of a power series.",[j("x"),j("n"),j("m"),j("coefficients")]),SIGN:i("This function returns the sign of a number or expression.",[j("cellreference")]),SIN:i("This function returns the sine of the specified angle.",[j("angle")]),SINH:i("This function returns the hyperbolic sine of the specified number.",[j("number")]),SKEW:i("This function returns the skewness of a distribution.",[j("number1"),j("number2",!0)]),SLN:i("This function returns the straight-line depreciation of an asset for one period.",[j("cost"),j("salvage"),j("life")]),SLOPE:i("This function calculates the slope of a linear regression.",[j("array_dep"),j("array_ind")]),SMALL:i("This function returns the nth smallest value in a data set, where n is specified.",[j("array"),j("n")]),SQRT:i("This function returns the positive square root of the specified number.",[j("value")]),SQRTPI:i("This function returns the positive square root of a multiple of pi (p).",[j("multiple")]),STANDARDIZE:i("This function returns a normalized value from a distribution characterized by mean and standard deviation.",[j("x"),j("mean"),j("standard_dev")]),STDEVA:i("This function returns the standard deviation for a set of numbers, text, or logical values.",[j("value1"),j("value2",!0)]),STDEVP:i("This function returns the standard deviation for an entire specified population (of numeric values).",[j("number1"),j("number2",!0)]),STDEVPA:i("This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[j("value1"),j("value2",!0)]),STEYX:i("This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[j("array_dep"),j("array_ind")]),SUBSTITUTE:i("This function substitutes a new string for specified characters in an existing string.",[j("text"),j("old_text"),j("new_text"),j("instance_num")]),SUBTOTAL:i("This function calculates a subtotal of a list of numbers using a specified built-in function.",[j("function_num"),j("ref1"),j("ref2",!0)]),SUM:i("This function returns the sum of cells or range of cells.",[j("number1"),j("number2",!0)]),SUMIF:i("This function adds the cells using a given criteria.",[j("range"),j("criteria"),j("sum_range")]),SUMIFS:i("This function adds the cells in a range using multiple criteria.",[j("sum_range"),j("criteria_range1",!0),j("criteria1",!0)]),SUMPRODUCT:i("This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[j("array1"),j("array2",!0)]),SUMSQ:i("This function returns the sum of the squares of the arguments.",[j("number1"),j("number2",!0)]),SUMX2MY2:i("This function returns the sum of the difference of the squares of corresponding values in two arrays.",[j("array_x"),j("array_y")]),SUMX2PY2:i("This function returns the sum of the sum of squares of corresponding values in two arrays.",[j("array_x"),j("array_y")]),SUMXMY2:i("This function returns the sum of the square of the differences of corresponding values in two arrays.",[j("array_x"),j("array_y")]),SYD:i("This function returns the sum-of-years' digits depreciation of an asset for a specified period.",[j("cost"),j("salvage"),j("life"),j("period")]),T:i("This function returns the text in a specified cell.",[j("value")]),TAN:i("This function returns the tangent of the specified angle.",[j("angle")]),TANH:i("This function returns the hyperbolic tangent of the specified number.",[j("number")]),TBILLEQ:i("This function returns the equivalent yield for a Treasury bill (or T-bill)",[j("settlement"),j("maturity"),j("discount")]),TBILLPRICE:i("This function returns the price per $100 face value for a Treasury bill (or T-bill).",[j("settlement"),j("maturity"),j("discount")]),TBILLYIELD:i("This function returns the yield for a Treasury bill (or T-bill).",[j("settlement"),j("maturity"),j("priceper")]),TDIST:i("This function returns the probability for the t-distribution.",[j("x"),j("deg_freedom"),j("tails")]),TEXT:i("This function formats a number and converts it to text.",[j("value"),j("format_text")]),TIME:i("This function returns the TimeSpan object for a specified time.",[j("hour"),j("minute"),j("second")]),TIMEVALUE:i("This function returns the TimeSpan object of the time represented by a text string.",[j("time_text")]),TINV:i("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[j("probability"),j("deg_freedom")]),TODAY:i("This function returns the date and time of the current date.",[]),TRANSPOSE:i("This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[j("array")]),TREND:i("This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[j("y"),j("x"),j("newx"),j("constant")]),TRIM:i("This function removes extra spaces from a string and leaves single spaces between words.",[j("text")]),TRIMMEAN:i("This function returns the mean of a subset of data excluding the top and bottom data.",[j("array"),j("percent")]),TRUE:i("This function returns the value for logical TRUE.",[]),TRUNC:i("This function removes the specified fractional part of the specified number.",[j("number"),j("num_digits")]),TTEST:i("This function returns the probability associated with a t-test.",[j("array1"),j("array2"),j("tails"),j("type")]),TYPE:i("This function returns the type of value.",[j("value")]),UPPER:i("This function converts text to uppercase letters.",[j("text")]),VALUE:i("This function converts a text string that is a number to a numeric value.",[j("text")]),VAR:i("This function returns the variance based on a sample of a population, which uses only numeric values.",[j("number1"),j("number2",!0)]),VARA:i("This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[j("value1"),j("value2",!0)]),VARP:i("This function returns variance based on the entire population, which uses only numeric values.",[j("number1"),j("number2",!0)]),VARPA:i("This function returns variance based on the entire population, which includes numeric, logical, or text values.",[j("value1"),j("value2",!0)]),VDB:i("This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[j("cost"),j("salvage"),j("life"),j("start_period"),j("end_period"),j("factor"),j("no_switch")]),VLOOKUP:i("This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[j("lookup_value"),j("table_array"),j("col_index_num"),j("range_lookup")]),WEEKDAY:i("This function returns the number corresponding to the day of the week for a specified date.",[j("date"),j("type")]),WEEKNUM:i("This function returns a number that indicates the week of the year numerically.",[j("date"),j("weektype")]),DATEPART:i("This function formats a date and converts it to text.",[j("date"),j("format_text"),j("weektype")]),WEIBULL:i("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[j("x"),j("alpha"),j("beta"),j("cumulative")]),WORKDAY:i("This function returns the number of working days before or after the starting date.",[j("start_date"),j("days"),j("holidays")]),XIRR:i("This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[j("values"),j("dates"),j("guess")]),XNPV:i("This function calculates the net present value for a schedule of cash flows that may not be periodic.",[j("rate"),j("values"),j("dates")]),YEAR:i("This function returns the year as an integer for a specified date.",[j("date")]),YEARFRAC:i("This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[j("start_date"),j("end_date"),j("basis")]),YIELD:i("This function calculates the yield on a security that pays periodic interest.",[j("settlement"),j("maturity"),j("rate"),j("price"),j("redemption"),j("frequency"),j("basis")]),YIELDDISC:i("This function calculates the annual yield for a discounted security.",[j("settlement"),j("maturity"),j("price"),j("redemption"),j("basis")]),YIELDMAT:i("This function calculates the annual yield of a security that pays interest at maturity.",[j("settlement"),j("maturity"),j("issue"),j("rate"),j("price"),j("basis")]),ZTEST:i("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[j("array"),j("x"),j("sigma")]),HBARSPARKLINE:i("This function returns a data set used for representing a Hbar sparkline",[j("value"),j("colorScheme"),j("axisVisible"),j("barHeight")]),VBARSPARKLINE:i("This function returns a data set used for representing a Vbar sparkline",[j("value"),j("colorScheme"),j("axisVisible"),j("barWidth")]),VARISPARKLINE:i("This function returns a data set used for representing a variance sparkline",[j("variance"),j("reference"),j("mini"),j("maxi"),j("mark"),j("tickunit"),j("legend"),j("colorPositive"),j("colorNegative"),j("vertical")]),PIESPARKLINE:i("This function returns a data set used for representing a pie sparkline",[j("range|percentage"),j("color",!0)]),AREASPARKLINE:i("This function returns a data set used for representing a area sparkline",[j("points"),j("mini"),j("maxi"),j("line1"),j("line2"),j("colorPositive"),j("colorNegative")]),SCATTERSPARKLINE:i("This function returns a data set used for representing a scatter sparkline",[j("points1"),j("points2"),j("minX"),j("maxX"),j("minY"),j("maxY"),j("hLine"),j("vLine"),j("xMinZone"),j("xMaxZone"),j("yMinZone"),j("yMaxZone"),j("tags"),j("drawSymbol"),j("drawLines"),j("color1"),j("color2"),j("dash")]),LINESPARKLINE:i("This function returns a data set used for representing a line sparkline",[j("data"),j("dataOrientation"),j("dateAxisData"),j("dateAxisOrientation"),j("setting")]),COLUMNSPARKLINE:i("This function returns a data set used for representing a column sparkline",[j("data"),j("dataOrientation"),j("dateAxisData"),j("dateAxisOrientation"),j("setting")]),WINLOSSSPARKLINE:i("This function returns a data set used for representing a win/loss sparkline",[j("data"),j("dataOrientation"),j("dateAxisData"),j("dateAxisOrientation"),j("setting")]),BULLETSPARKLINE:i("This function returns a data set used for representing a bullet sparkline",[j("measure"),j("target"),j("maxi"),j("good"),j("bad"),j("forecast"),j("tickunit"),j("colorScheme"),j("vertical"),j("measureColor"),j("targetColor"),j("maxiColor"),j("goodColor"),j("badColor"),j("forecastColor"),j("allowMeasureOverMaxi"),j("barSize")]),SPREADSPARKLINE:i("This function returns a data set used for representing a spread sparkline",[j("points"),j("showAverage"),j("scaleStart"),j("scaleEnd"),j("style"),j("colorScheme"),j("vertical")]),STACKEDSPARKLINE:i("This function returns a data set used for representing a stacked sparkline",[j("points"),j("colorRange"),j("labelRange"),j("maximum"),j("targetRed"),j("targetGreen"),j("targetBlue"),j("tragetYellow"),j("color"),j("highlightPosition"),j("vertical"),j("textOrientation"),j("textSize")]),BOXPLOTSPARKLINE:i("This function returns a data set used for representing a boxplot sparkline",[j("points"),j("boxPlotClass"),j("showAverage"),j("scaleStart"),j("scaleEnd"),j("acceptableStart"),j("acceptableEnd"),j("colorScheme"),j("style"),j("vertical")]),CASCADESPARKLINE:i("This function returns a data set used for representing a cascade sparkline",[j("pointsRange"),j("pointIndex"),j("labelsRange"),j("minimum"),j("maximum"),j("colorPositive"),j("colorNegative"),j("vertical"),j("itemTypeRange"),j("colorTotal")]),PARETOSPARKLINE:i("This function returns a data set used for representing a pareto sparkline",[j("points"),j("pointIndex"),j("colorRange"),j("target"),j("target2"),j("highlightPosition"),j("label"),j("vertical"),j("targetColor"),j("target2Color"),j("labelColor"),j("barSize")]),MONTHSPARKLINE:i("This function returns a data set used for representing a month sparkline",[j("year"),j("month"),j("dataRange"),j("emptyColor"),j("startColor"),j("middleColor"),j("endColor")]),YEARSPARKLINE:i("This function returns a data set used for representing a year sparkline",[j("year"),j("dataRange"),j("emptyColor"),j("startColor"),j("middleColor"),j("endColor")]),GAUGEKPISPARKLINE:i("This function returns a data set used for representing a gauge KPI sparkline",[j("targetValue"),j("currentValue"),j("minValue"),j("maxValue"),j("showLabel"),j("targetValueLabel"),j("currentValueLabel"),j("minValueLabel"),j("maxValueLabel"),j("fontArray"),j("minAngle"),j("maxAngle"),j("radiusRatio"),j("gaugeType"),j("colorRange"),j("...")]),HISTOGRAMSPARKLINE:i("This function returns a data set used for representing a histogram sparkline",[j("dateRange"),j("continuous"),j("paintLabel"),j("scale"),j("barWidth"),j("barColor"),j("labelFontStyle"),j("labelColor"),j("edgeColor")]),"CEILING.PRECISE":i("This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[j("number"),j(e)]),"COVARIANCE.S":i("This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[j("array1"),j("array2")]),"FLOOR.PRECISE":i("This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[j("number"),j(e)]),"PERCENTILE.EXC":i("This function returns the nth percentile of values in a range.",[j("array"),j("k")]),"QUARTILE.EXC":i("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[j("array"),j("quart")]),"RANK.AVG":i("This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[j("number"),j("ref"),j("[order]")]),"MODE.MULT":i("This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[j("number1"),j("number2",!0)]),"STDEV.P":i("This function returns the standard deviation for an entire specified population (of numeric values).",[j("number1"),j("number2",!0)]),"VAR.P":i("This function returns variance based on the entire population, which uses only numeric values.",[j("number1"),j("number2",!0)]),"COVARIANCE.P":i("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[j("array1"),j("array2")]),"MODE.SNGL":i("This function returns the most frequently occurring value in a set of data.",[j("number1"),j("number2",!0)]),"PERCENTILE.INC":i("This function returns the nth percentile of values in a range.",[j("array"),j("k")]),"QUARTILE.INC":i("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[j("array"),j("quart")]),"RANK.EQ":i("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[j("number"),j("ref"),j("[order]")]),STDEV:i("This function returns standard deviation is estimated based on a sample.",[j("number1"),j("number2",!0)]),"STDEV.S":i("This function returns standard deviation is estimated based on a sample.",[j("number1"),j("number2",!0)]),"VAR.S":i("This function returns the variance based on a sample of a population, which uses only numeric values.",[j("number1"),j("number2",!0)]),"BETA.INV":i("This function calculates the inverse of the cumulative beta distribution function.",[j("probability"),j("alpha"),j("beta"),j("[lower]"),j("[upper]")]),"BINOM.DIST":i("This function calculates the individual term binomial distribution probability.",[j("number_s"),j("trials"),j("probability_s"),j("cumulative")]),"BINOM.INV":i("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[j("trials"),j("probability_s"),j("alpha")]),"CHISQ.DIST.RT":i("This function calculates the one-tailed probability of the chi-squared distribution.",[j("value"),j("deg_freedom")]),"CHISQ.INV.RT":i("This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[j("probability"),j("deg_freedom")]),"CHISQ.TEST":i("This function calculates the test for independence from the chi-squared distribution.",[j("actual_range"),j("expected_range")]),"CONFIDENCE.NORM":i("This function returns confidence interval for a population mean.",[j("alpha"),j("standard_dev"),j("size")]),"EXPON.DIST":i("This function returns the exponential distribution or the probability density.",[j("value"),j("lambda"),j("cumulative")]),"F.DIST.RT":i("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[j("value"),j("deg_freedom1"),j("deg_freedom2")]),"F.INV.RT":i("This function returns the inverse of the F probability distribution.",[j("probability"),j("deg_freedom1"),j("deg_freedom2")]),"F.TEST":i("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[j("array1"),j("array2")]),"GAMMA.DIST":i("This function returns the gamma distribution.",[j("x"),j("alpha"),j("beta"),j("cumulative")]),"GAMMA.INV":i("This function returns the inverse of the gamma cumulative distribution.",[j("probability"),j("alpha"),j("beta")]),"LOGNORM.INV":i("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[j("probability"),j("mean"),j("standard_dev")]),"NORM.DIST":i("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[j("x"),j("mean"),j("standard_dev"),j("cumulative")]),"NORM.INV":i("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[j("probability"),j("mean"),j("standard_dev")]),"NORM.S.INV":i("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[j("probability")]),
"PERCENTRANK.INC":i("This function returns the rank of a value in a data set as a percentage of the data set.",[j("array"),j("n"),j(e)]),"POISSON.DIST":i("This function returns the Poisson distribution.",[j("nevents"),j("mean"),j("cumulative")]),"T.INV.2T":i("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[j("probability"),j("deg_freedom")]),"T.TEST":i("This function returns the probability associated with a t-test.",[j("array1"),j("array2"),j("tails"),j("type")]),"WEIBULL.DIST":i("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[j("x"),j("alpha"),j("beta"),j("cumulative")]),"Z.TEST":i("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[j("array"),j("x"),j("[sigma]")]),"T.DIST.RT":i("This function returns the right-tailed t-distribution.",[j("x"),j("deg_freedom")]),"T.DIST.2T":i("This function returns the two-tailed t-distribution.",[j("x"),j("deg_freedom")]),"ISO.CEILING":i("This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[j("number"),j(e)]),"BETA.DIST":i("This function returns the beta distribution.",[j("x"),j("alpha"),j("beta"),j("cumulative"),j("lower"),j("upper")]),"GAMMALN.PRECISE":i("This function returns the natural logarithm of the gamma function.",[j("value")]),"ERF.PRECISE":i("This function returns the error function.",[j("lowerlimit")]),"ERFC.PRECISE":i("This function returns the complementary ERF function.",[j("lowerlimit")]),"PERCENTRANK.EXC":i("This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[j("array"),j("x"),j(e)]),"HYPGEOM.DIST":i("This function returns the hypergeometric distribution.",[j("sample_s"),j("number_sample"),j("population_s"),j("number_pop"),j("cumulative")]),"LOGNORM.DIST":i("This function returns the log normal distribution of x.",[j("x"),j("mean"),j("stdev"),j("cumulative")]),"NEGBINOM.DIST":i("This function returns the negative binomial distribution.",[j("number_f"),j("number_s"),j("probability_s"),j("cumulative")]),"NORM.S.DIST":i("This function returns the standard normal distribution.",[j("z"),j("cumulative")]),"T.DIST":i("This function returns the t-distribution.",[j("x"),j("deg_freedom"),j("cumulative")]),"F.DIST":i("This function returns the F probability distribution.",[j("x"),j("deg_freedom1"),j("deg_freedom2"),j("cumulative")]),"CHISQ.DIST":i("This function returns the chi-squared distribution.",[j("x"),j("deg_freedom"),j("cumulative")]),"F.INV":i("This function returns the inverse of the F probability distribution.",[j("probability"),j("deg_freedom1"),j("deg_freedom2")]),"T.INV":i("This function returns the left-tailed inverse of the t-distribution.",[j("probability"),j("deg_freedom")]),"CHISQ.INV":i("This function returns the inverse of left-tailed probability of the chi-squared distribution.",[j("probability"),j("deg_freedom")]),"CONFIDENCE.T":i("This function returns the confidence interval for a Student's t distribution.",[j("alpha"),j("standard_dev"),j("size")]),"NETWORKDAYS.INTL":i("This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[j("start_date"),j("end_date"),j("[weekend]"),j("[holidays]")]),"WORKDAY.INTL":i("This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[j("start_date"),j("days"),j("[weekend]"),j("[holidays]")]),REFRESH:i("This function decides how to re-calculate the formula. Can use the evaluateMode argument to specific the formula re-calculate on the reference value changed, evaluate once , re-calculate or interval.",[j("formula"),j("evaluateMode"),j("interval")]),DAYS:i("This function returns the number of days between two dates.",[j("end_date"),j("start_date")]),ISOWEEKNUM:i("This function returns the number of the ISO week number of the year for a given date.",[j("date")]),BITAND:i('This function returns a bitwise "AND" of two numbers.',[j("number1"),j("number2")]),BITLSHIFT:i('This function returns a bitwise "OR" of two numbers.',[j("number"),j("shift_amount")]),BITOR:i('This function returns a bitwise "OR" of two numbers.',[j("number1"),j("number2")]),BITRSHIFT:i('This function returns a bitwise "OR" of two numbers.',[j("number"),j("shift_amount")]),BITXOR:i('This function returns a bitwise "XOR" of two numbers.',[j("number1"),j("number2")]),IMCOSH:i("This function returns the hyperbolic cosine of a complex number in x+yi or x+yj text format.",[j("complexnum")]),IMCOT:i("This function returns the cotangent of a complex number in x+yi or x+yj text format.",[j("complexnum")]),IMCSC:i("This function returns the cosecant of a complex number in x+yi or x+yj text format.",[j("complexnum")]),IMCSCH:i("This function returns the hyperbolic cosecant of a complex number in x+yi or x+yj text format.",[j("complexnum")]),IMSEC:i("This function returns the secant of a complex number in x+yi of x+yj text format.",[j("complexnum")]),IMSECH:i("This function returns the hyperbolic secant of a complex number in x+yi or x+yj text format.",[j("complexnum")]),IMSINH:i("This function returns the hyperbolic sine of a complex number in x+yi of x+yj text format.",[j("complexnum")]),IMTAN:i("This function returns the tangent of a complex number in x+yi or x+yj text format.",[j("complexnum")]),PDURATION:i("This function returns the number of periods required by an investment to reach a specified value.",[j("rate"),j("pval"),j("fval")]),RRI:i("This function returns an equivalent interest rate for the growth of an investment.",[j("nper"),j("pval"),j("fval")]),ISFORMULA:i("This function tests whether contains a formula of a referenced cell.",[j("cellreference")]),IFNA:i("This function returns the value you specify if the formula returns the #N/A error value, otherwise returns the result of the formula.",[j("value"),j("value_if_na")]),IFS:i("This function checks whether one or more conditions are met and returns a value that corresponds to the first TRUE condition.",[j("logical_test1"),j("value_if_true1",!0)]),SWITCH:i("This function evaluates one value (called the expression) against a list of values, and returns the result corresponding to the first matching value. If there is no match, an optional default value may be returned.",[j("expression"),j("value1"),j("result1"),j("[default_or_value2]",!0),j("[result2]",!0)]),XOR:i("This function returns a logical exclusive or of all arguments.",[j("logical",!0)]),AREAS:i("This function returns the number of areas in a reference.",[j("reference")]),FORMULATEXT:i("This function returns a formula as a string.",[j("reference")]),HYPERLINK:i("This function creates a shortcut or jump that opens a document stored on a network server, an intranet, or the Internet.",[j("link_location"),j("friendly_name")]),ACOT:i("This function calculates the inverse arccotangent of a number.",[j("number")]),ACOTH:i("This function calculates the inverse hyperbolic arccotangent of a number.",[j("number")]),ARABIC:i("This function converts a Roman numeral text to an Arabic numeral equivalent.",[j("text")]),BASE:i("This function converts a number into a text representation with the given radix (base).",[j("number"),j("radix"),j("[min_length]")]),"CEILING.MATH":i("This function round  a number up to the nearest integer or to the nearest multiple of significance.",[j("number"),j(e),j("[mode]")]),COMBINA:i("This function calculates the number of possible combinations with repetitions for a specified number of items.",[j("number"),j("number_chosen")]),COT:i("This function returns the cotangent of the specified angle.",[j("angle")]),COTH:i("This function returns the hyperbolic cotangent of the specified number.",[j("value")]),CSC:i("This function returns the cosecant of the specified angle.",[j("angle")]),CSCH:i("This function returns the hyperbolic cosecant of the specified number.",[j("value")]),DECIMAL:i("This function converts a text representation of a number in a given base into a decimal number.",[j("text"),j("radix")]),"FLOOR.MATH":i("This function round a number down to the nearest integer or to the nearest multiple of significance.",[j("number"),j(e),j("[mode]")]),SEC:i("This function returns the secant of the specified angle.",[j("angle")]),SECH:i("This function returns the hyperbolic secant of the specified value.",[j("value")]),"BINOM.DIST.RANGE":i("This function calculates the probability of a trial result using a binomial distribution.",[j("trials"),j("probability_s"),j("number_s"),j("[number_s2]")]),GAMMA:i("This function returns the gamma function value.",[j("number")]),MAXIFS:i("This function returns the maximum value among cells specified by a given set of conditions or criteria.",[j("max_range"),j("criteria_range",!0),j("criteria",!0)]),GAUSS:i("This function calculates the probability that a member of a standard normal population will fall between the mean and z standard deviations from the mean.",[j("number")]),MINIFS:i("This function returns the minimum value among cells specified by a given set of conditions or criteria.",[j("min_range"),j("criteria_range",!0),j("criteria",!0)]),PERMUTATIONA:i("This function returns the number of permutations for a given number of object that can be selected from the total objects.",[j("number"),j("number_chosen")]),PHI:i("This function returns the value of the density function for a standard normal distribution.",[j("value")]),"SKEW.P":i("This function returns the skewness of a distribution base on a poopulation: a characterization of the degree of asymmetry of a distribution around its mean.",[j("number1"),j("number2",!0)]),BAHTTEXT:i('This function converts a number to Thai text and adds a suffix of "Baht"',[j("number")]),CONCAT:i('This function combines multiple text strings or numbers into one text string, the function will stay available for compatibility with "CONCATENATE" function.',[j("text1"),j("text2",!0)]),FINDB:i("This function finds one text value within another and returns the text value's position in the text you searched, and counts each double-byte characte as 2 when set DBCS as the default language.",[j("find_text"),j("within_text"),j(d)]),LEFTB:i("This function returns the specified leftmost characters from a text value, and based on the number of bytes you specify.",[j("text"),j("num_bytes")]),LENB:i("This function returns the length of the number of bytes in a text string.",[j("text")]),MIDB:i("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of bytes you specify.",[j("text"),j("start_num"),j("num_bytes")]),REPLACEB:i("This function replaces part of a text string with a different text string, based on the number of bytes you specify.",[j("old_text"),j("start_byte"),j("num_bytes"),j("new_text")]),RIGHTB:i("This function returns the specified rightmost characters from a text value, and based on the number of bytes you specify.",[j("text"),j("num_bytes")]),SEARCHB:i("This function finds one text string in another text string and returns the index of the starting position of the found text, and counts each double-byte characte as 2 when set DBCS as the default language.",[j("find_text"),j("within_text"),j(d)]),TEXTJOIN:i("This function combines multiple ranges and/or strings into one text, and the text includes a delimiter you specify between each text value.",[j("delimiter"),j("ignore_empty"),j("text1"),j("text2",!0)]),UNICHAR:i("This function returns the Unicode character of a given numeric reference.",[j("number")]),UNICODE:i("This function returns the number corresponding to the first character of the text.",[j("text")]),ENCODEURL:i("This function returns a URL-encoded string.",[j("text")]),BC_QRCODE:i("This function returns a data set for representing a QRCode",[j("value"),j("color"),j("backgroundColor"),j("errorCorrectionLevel"),j("model"),j("version"),j("mask"),j("connection"),j("connectionNo"),j("charCode"),j("charset"),j("quietZoneLeft"),j("quietZoneRight"),j("quietZoneTop"),j("quietZoneBottom")]),BC_EAN13:i("This function returns a data set for representing a EAN13.",[j("value"),j("color"),j("backgroundColor"),j("showLabel"),j("labelPosition"),j("addOn"),j("addOnLabelPosition"),j("fontFamily"),j("fontStyle"),j("fontWeight"),j("textDecoration"),j("textAlign"),j("fontSize"),j("quietZoneLeft"),j("quietZoneRight"),j("quietZoneTop"),j("quietZoneBottom")]),BC_EAN8:i("This function returns a data set for representing a EAN8.",[j("value"),j("color"),j("backgroundColor"),j("showLabel"),j("labelPosition"),j("fontFamily"),j("fontStyle"),j("fontWeight"),j("textDecoration"),j("textAlign"),j("fontSize"),j("quietZoneLeft"),j("quietZoneRight"),j("quietZoneTop"),j("quietZoneBottom")]),BC_CODABAR:i("This function returns a data set for representing a CODABAR.",[j("value"),j("color"),j("backgroundColor"),j("showLabel"),j("labelPosition"),j("checkDigit"),j("nwRatio"),j("fontFamily"),j("fontStyle"),j("fontWeight"),j("textDecoration"),j("textAlign"),j("fontSize"),j("quietZoneLeft"),j("quietZoneRight"),j("quietZoneTop"),j("quietZoneBottom")]),BC_CODE39:i("This function returns a data set for representing a CODE39.",[j("value"),j("color"),j("backgroundColor"),j("showLabel"),j("labelPosition"),j("labelWithStartAndStopCharacter"),j("checkDigit"),j("nwRatio"),j("fullASCII"),j("fontFamily"),j("fontStyle"),j("fontWeight"),j("textDecoration"),j("textAlign"),j("fontSize"),j("quietZoneLeft"),j("quietZoneRight"),j("quietZoneTop"),j("quietZoneBottom")]),BC_CODE93:i("This function returns a data set for representing a CODE93.",[j("value"),j("color"),j("backgroundColor"),j("showLabel"),j("labelPosition"),j("checkDigit"),j("fullASCII"),j("fontFamily"),j("fontStyle"),j("fontWeight"),j("textDecoration"),j("textAlign"),j("fontSize"),j("quietZoneLeft"),j("quietZoneRight"),j("quietZoneTop"),j("quietZoneBottom")]),BC_CODE128:i("This function returns a data set for representing a CODE128.",[j("value"),j("color"),j("backgroundColor"),j("showLabel"),j("labelPosition"),j("codeSet"),j("fontFamily"),j("fontStyle"),j("fontWeight"),j("textDecoration"),j("textAlign"),j("fontSize"),j("quietZoneLeft"),j("quietZoneRight"),j("quietZoneTop"),j("quietZoneBottom")]),BC_GS1_128:i("This function returns a data set for representing a GS1_128.",[j("value"),j("color"),j("backgroundColor"),j("showLabel"),j("labelPosition"),j("fontFamily"),j("fontStyle"),j("fontWeight"),j("textDecoration"),j("textAlign"),j("fontSize"),j("quietZoneLeft"),j("quietZoneRight"),j("quietZoneTop"),j("quietZoneBottom")]),BC_CODE49:i("This function returns a data set for representing a CODE49.",[j("value"),j("color"),j("backgroundColor"),j("showLabel"),j("labelPosition"),j("grouping"),j("groupNo"),j("fontFamily"),j("fontStyle"),j("fontWeight"),j("textDecoration"),j("textAlign"),j("fontSize"),j("quietZoneLeft"),j("quietZoneRight"),j("quietZoneTop"),j("quietZoneBottom")]),BC_PDF417:i("This function returns a data set for representing a PDF417.",[j("value"),j("color"),j("backgroundColor"),j("errorCorrectionLevel"),j("rows"),j("columns"),j("compact"),j("quietZoneLeft"),j("quietZoneRight"),j("quietZoneTop"),j("quietZoneBottom")]),BC_DATAMATRIX:i("This function returns a data set for representing a DATAMATRIX.",[j("value"),j("color"),j("backgroundColor"),j("eccMode"),j("ecc200SymbolSize"),j("ecc200EncodingMode"),j("ecc00_140SymbolSize"),j("structuredAppend"),j("structureNumber"),j("fileIdentifier"),j("quietZoneLeft"),j("quietZoneRight"),j("quietZoneTop"),j("quietZoneBottom")]),FILTER:i("This function filter a range or array.",[j("array"),j("include"),j("if_empty")]),RANDARRAY:i("This function returns an array of random numbers.",[j("rows"),j("columns"),j("min"),j("max"),j("whole_number")]),SEQUENCE:i("This function returns a sequence of numbers.",[j("rows"),j("columns"),j("start"),j("step")]),SINGLE:i("This function returns a single value when given a value, range or array.",[j("value")]),SORT:i("This function sorts a range or array.",[j("array"),j("sort_index"),j("sort_order"),j("by_col")]),SORTBY:i("This function sorts a range or array based on the values in a corresponding range or array.",[j("array"),j("by_array1"),j("sort_order1"),j("by_array2",!0),j("sort_order2",!0)]),UNIQUE:i("This function returns the unique values from a range or array.",[j("array"),j("by_col"),j("exactly_once")]),QUERY:i("This function returns data from data manager tables in a worksheet.",[j("tableAndRows"),j("columns"),j("returnObject")]),LET:i("This function assigns calculation results to names. Useful for storing intermediate calculations and values by defining names inside a formula. These names only apply within the scope of the LET function.",[j("name1"),j("name_value1"),j("calculation_or_name2"),j("[name_value2, ...")]),IMAGE:i("This function input an URL or a base64 string to show an image in cell",[j("URL"),j("[mode]"),j("[height]"),j("[width]"),j("[clipY]"),j("[clipX]"),j("[clipHeight]"),j("[clipWidth]"),j("[vAlign]"),j("[hAlign]")]),GETPIVOTDATA:i("This function extracts data stored in a PivotTable",[j("data_field"),j("pivot_table"),j("[field1, item1]"),j("...")]),WEBSERVICE:i("This function returns data from a web service",[j("url")]),FILTERJSON:i("This function parses json string to a scalar value, an object or an array of objects.",[j("json_string")]),ASC:i("The ASC function changes full-width(double-byte) characters to half-width(single-byte) characters, Use with double-byte character sets (DBCS).",[j("text")]),DBCS:i("The DBCS function converts half-width(single-byte) letters within a character string to full-width(double-byte) characters.",[j("text")]),LAMBDA:i("Creates a function value, which can be called within formulas.",[j("parameter_or_calculation"),j("[parameter_or_calculation]",!0)]),MAP:i("Returns an array formed by mapping each value in the array(s) to a new value by applying a LAMBDA to create a new value.",[j("array"),j("lambda_or_array",!0)]),REDUCE:i("Reduces an array to an accumulated value by applying a LAMBDA to each value and returning the total value in the accumulator.",[j("init_value"),j("array"),j("function")]),SCAN:i("Scans an array by applying a LAMBDA to each value and returns an array that has each intermediate value.",[j("init_value"),j("array"),j("function")]),MAKEARRAY:i("Returns a calculated array of a specified row and column size, by applying a LAMBDA.",[j("rows"),j("cols"),j("function")]),BYCOL:i("Applies a LAMBDA to each column and returns an array of the results. For example, if the original array is 3 columns by 2 rows, the returned array is 3 columns by 1 row.",[j("array"),j("function")]),BYROW:i("Applies a LAMBDA to each row and returns an array of the results. For example, if the original array is 3 columns by 2 rows, the returned array is 1 column by 2 rows.",[j("array"),j("function")]),ISOMITTED:i("Checks whether the value in a LAMBDA is missing and returns TRUE or FALSE.",[j("argument")]),TEXTBEFORE:i("Returns text that occurs before a given character or string.",[j("text"),j("delimiter"),j("[instance_num]"),j(f),j("[match_end]"),j(g)]),TEXTAFTER:i("Returns text that occurs after given character or string.",[j("text"),j("delimiter"),j("[instance_num]"),j(f),j("[match_end]"),j(g)]),TEXTSPLIT:i("Splits text strings by using column and row delimiters.",[j("text"),j("col_delimiter"),j("[row_delimiter]"),j("[ignore_empty]"),j(f),j(h)]),VSTACK:i("Appends arrays vertically and in sequence to return a larger array.",[j("array1"),j("[array2]",!0)]),HSTACK:i("Appends arrays horizontally and in sequence to return a larger array.",[j("array1"),j("[array2]",!0)]),TOROW:i("Returns the array in a single row.",[j("array"),j("[ignore]"),j("[scan_by_column]")]),TOCOL:i("Returns the array in a single column.",[j("array"),j("[ignore]"),j("[scan_by_column]")]),WRAPROWS:i("Wraps the provided row or column of values by rows after a specified number of elements to form a new array.",[j("vector"),j("wrap_count"),j(h)]),WRAPCOLS:i("Wraps the provided row or column of values by columns after a specified number of elements to form a new array.",[j("vector"),j("wrap_count"),j(h)]),TAKE:i("Returns a specified number of contiguous rows or columns from the start or end of an array.",[j("array"),j("rows"),j("[columns]")]),DROP:i("Excludes a specified number of rows or columns from the start or end of an array.",[j("array"),j("rows"),j("[columns]")]),EXPAND:i("Expands or pads an array to specified row and column dimensions.",[j("array"),j("rows"),j("[columns]"),j(h)]),CHOOSEROWS:i("Returns the specified rows from an array.",[j("array"),j("row_num1"),j("[row_num2]",!0)]),CHOOSECOLS:i("Returns the specified columns from an array.",[j("array"),j("col_num1"),j("[col_num2]",!0)])},Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_TableSheetName_Description:"TableSheet name for ",Fbx_CustomName_Description:"Custom name for ",B2:{All:{name:"#All",description:"Returns the entire contents of the table, or specified table columns including column headers, data and total rows."},Data:{name:"#Data",description:"Returns the data cells of the table or specified table columns."},Headers:{name:"#Headers",description:"Returns the columns headers for the table, or specified table columns."},Totals:{name:"#Totals",description:"Returns the total rows for the table or specified table columns."},thisRow:{name:"#This Row",description:"This row."}}}},"./src/evaluator.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/calc.common.ts"),f=c("./src/calc.ts"),g=d.Common.j.Fa,h=null,i=void 0,j=Math.pow,k=Math.min,l=Math.max,m="string",n="boolean",o=e.Convert.Th,p=e.Convert.vf,q=e.Convert.Ph,r=e.Convert.Ca,s=e.Convert.Fh,t=e.Errors.Reference,u=e.Errors.Value,v=e.Errors.Name,w=e.Errors.NotAvailable,x=e.Errors.DivideByZero,y=e.Errors.Number,z=e.Errors.Calc;function M(a,b,c,d){return{row:a,col:b,rowCount:c,colCount:d}}function N(a,b){var c,d,e,f=a.getRangeCount(),g=a.xf,h=b.gkK;for(c=0;c<f;c++)d=a.yf[c],d.id=g.id,g.getRangeKey&&(e=g.getRangeKey(g,d),h&&(h.nOb||(h.nOb={}),h.nOb[e]=d))}function O(a){return a&&a.getRowCount&&(a.getRowCount()>1||a.getColumnCount()>1)}A=function(){function a(a,b,c,d,f,g){this.si=0,this.ti=0,this.ui=0,this.localScopes=new e.LocalScopes,this.lambdaFunctionCallDepth=0;var h=this;h.source=a,h.arrayFormulaMode=!!c,h.identity=b||h.$Ab(0,0),h.arrayIdentity=d,h.row=d?d.row:h.identity.row||0,h.column=d?d.col:h.identity.col||0,h.rowOffset=d?h.identity.row-d.row:h.row,h.columnOffset=d?h.identity.col-d.col:h.column,h.Lf=f,h.gkK=g}return a.prototype.$Ab=function(a,b){return{row:a,col:b}},a.prototype.fga=function(a){return a===e.BangSource?this.source:a},a.prototype.getValue=function(a,b){return a?this.fga(a).getValue(b):t},a.prototype.getReference=function(a,b){return a?this.fga(a).getReference(b):t},a.prototype.getSheetRangeReference=function(a){return!a||!a.source||!a.endSource||a.source instanceof e.ErrorSource?t:this.fga(a.source).getSheetRangeReference(a)},a.prototype.getFunction=function(a){var b=this;return b.source?b.source.getCustomFunction(a):h},a.prototype.getName=function(a){var b,c,d=this,e=d.source?d.source.getCustomName(a):h;return!e&&d.source&&(b=d.source.Cf(),c=b&&b.getGlobalSourceModel(),e=c&&c.getSource().getCustomName(a)),e},a.prototype.getNameInfo=function(a){return e.JYJ(this.source,a)},a.prototype.getField=function(a){var b=this;return b.source?b.source.getField(a):h},a.prototype.getFieldItem=function(a){var b=this;return b.source?b.source.getFieldItem(a):h},a.prototype.vi=function(){return this.ui>0},a.prototype.wi=function(){this.ui++},a.prototype.xi=function(){this.ui--},a.prototype.SetAsyncResult=function(a,b){this.source.Cf().lh.SetAsyncResult(a,b)},a.prototype.cloneFrom=function(a){var b=this;b.acceptsReference=a.acceptsReference,b.arrayFormulaMode=a.arrayFormulaMode},a}(),b.EvaluateContext=A,e.CalcSource.prototype.getEvaluatorContext=function(a,b,c,d,e){return new A(this,a,b,c,d,e)},B=function(){function a(a,b){this.id=a.si,a.si++,this.ctx=a,this.row=a.row+(a.arrayFormulaMode&&a.rowOffset||0),this.col=a.column+(a.arrayFormulaMode&&a.columnOffset||0),this.node=b}return a.prototype.setAsyncResult=function(a){this.node.Fi=a,this.node.v5=!0,this.ctx.SetAsyncResult(this,a);var b=this.ctx.source;b.o9J||(b.o9J=!0,setTimeout(function(){b.refresh(),delete b.o9J},200))},a.prototype.getFormula=function(){return this.ctx.source.getCalcService().unparse(this.ctx.source,this.expression,this.row,this.col)},a.prototype.jJc=function(){var a,b=this.node&&this.node.parent&&this.node.parent.oi||[];for(a=0;a<b.length;a++)if(!b[a].v5)return!1;return!0},a}(),b.AsyncEvaluateContext=B,C=function(a){L(b,a);function b(b,c,d,e,f,g,i,j){var k=a.call(this,b,isNaN(j)?h:{row:i,col:j},c,isNaN(g)?h:{row:d,col:e,rowCount:f,colCount:g})||this,l=b.Cf().getGlobalSourceModel(b);return k.yi=l&&l.getSource(),k}return b.prototype.getName=function(a){var b=this;return b.yi?b.yi.getCustomName(a):h},b}(A),b.GloableEvaluateContext=C;function P(a,b){return a&&b?a.row===b.row&&a.col===b.col:a===b}D=function(){function a(a){this.service=a,this.asyncManager=new F(this)}return a.prototype.evaluateExpression=function(a,b,c,f,g){var j,k,l=void 0===a.type&&a.Lf?a.Lf:a,m=this.evaluate(l,b,!!f,!!g);return m&&m.pause?m:e.isLambdaFunction(m)?z:m===i||m===h?c===!1?m:0:((r(m)&&!f||s(m)&&!g)&&(m=this.getOneValue(b,m)),j=15,"number"==typeof m&&m>-10&&m<10&&(k=""+m,(k.indexOf("000000000000")>1||k.indexOf("999999999999")>1)&&(j=14)),d.Common.o.Lma(m,e.Functions.CALC_PRECISION||j))},a.prototype.evaluate=function(a,b,c,d){var f,g,j,k;if(!a)throw e.sR().Exp_ExprIsNull;if(void 0===a.type){if(a._error)return a;a.Lf&&(a=a.Lf)}for(;10===a.type;)a=a.value;if(f=this,j=h,12===a.type?(j=a.needExpendIndexs,a=a.value):b.Exb&&(c=!0,j=[]),k=a.type,k>=2&&k<=6)g=f.evaluateConst(a,b,c);else if(1===k||13===k||22===k)g=f.evaluateReference(a,b,d,c);else if(8===k)g=f.evaluateName(a,b,c,d);else if(100===k)g=f.evaluateLocalName(a,b,c,d);else if(9!==k||a.value2){if(9===k)g=f.evaluateBinaryOperation(a,b,c,d,j);else if(7===k){if(a.bEc&&b.lCJ&&(g=f.evaluateBranchFunction(a,b,c,d,j),g&&g.pause))return g;g=f.evaluateFunction(a,b,c,d,j)}else if(11===k)g=i;else if(14===k)g=f.evaluateField(a,b);else if(15===k)g=f.evaluateFieldItem(a,b);else if(b.evaluate)return b.evaluate(a,c,d)}else g=f.evaluateUnaryOperation(a,b,c,d,j);return g},a.prototype.evaluateConst=function(a,b,c){var d=a.value;return r(d)?c||b&&(b.arrayFormulaMode||b.vi())?d:d.getValue(0,0):d},a.prototype.evaluateReference=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,v,w;if(!b)return u;if(f=a.source||b.source,g=isNaN(b.row)?0:b.row,h=isNaN(b.column)?0:b.column,i=a.getRange&&a.getRange(g,h),j=a.type,!i)return 13===j?u:t;if(k=i.row<0?0:i.row,l=i.col<0?0:i.col,m=i.rowCount,n=i.colCount,i.row<0&&(i.rowUndefine=!0),i.col<0&&(i.colUndefine=!0),d&&(o=f.getRowCount(),p=f.getColumnCount(),(m===-1||m>o)&&(m=o),(n===-1||n>p)&&(n=p)),c||b.arrayFormulaMode)return a.endSource?b.getSheetRangeReference({source:a.source,endSource:a.endSource,row:k,col:l,rowCount:m,colCount:n}):b.getReference(f,i);if(d&&(m>1||n>1)){for(q=[],r=0;r<m;r++)for(q[r]=[],s=0;s<n;s++)q[r][s]=f.getValue(r+k,s+l);return new e.CalcArray(q)}if(m>1||n>1){if(v=g>=i.row&&g<i.row+m,w=h>=i.col&&h<i.col+n,v&&w)k=g,l=h;else{if(!v&&!w)return u;if(v&&1===n)k=g;else{if(!w||1!==m)return u;l=h}}b.Lf&&b.Lf.ensureSingle&&(a.e5J=!0)}else if(i.row===-1&&m===-1){if(1!==n)return u;k=g}else if(i.col===-1&&n===-1){if(1!==m)return u;l=h}return f.getValue(k,l)},a.prototype.evaluateName=function(a,b,c,d){var e,g,h;return b?(a.source&&(e=a.source,b=e.getEvaluatorContext(b.identity,b.arrayFormulaMode,b.arrayIdentity)),(g=b.getName(a.value))?(h=f.Mh(b,g,!1,0,0,c,d),this.evaluate(h,b,c,d)):v):v},a.prototype.evaluateLocalName=function(a,b,c,d){var f,g,h,i,j,k;if(!a.value||!b||!b.localScopes.hasVariable(a.value))return v;if(f=b.localScopes.getVariable(a.value),g=b.source&&b.source.Af&&b.source.Af.allowDynamicArray,g||(c=a.t0a,d=a.eVJ),b.arrayFormulaMode&&b.vi())return f;if(r(f)&&!c)return this.getOneValue(b,f);if(s(f)&&!d){if(h=f,c&&1===h.getRangeCount()){for(i=[],j=0;j<h.getRowCount(0);j++)for(i[j]=[],k=0;k<h.getColumnCount(0);k++)i[j][k]=h.getValue(0,j,k);return new e.CalcArray(i)}return this.getOneValue(b,f)}return f},a.prototype.evaluateUnaryOperation=function(a,b,c,d,f){var g,h,i=!1;return f&&f.length>0&&(c=!0,i=!0),g=b.Exb,g&&(c=!0),h=this.evaluate(a.value,b,c,i),h&&h.pause?h:e.Convert.vf(h)?h:h===e.missingArgument?w:this.evaluateWithArgs(a,function(d){var e=d[0];return e&&e.getRowCount&&c&&b.Lf&&(b.Lf.ensureSingle&&!c?e=U(b,e):b.Lf.yHJ=!0),T(a.operatorType,e,c)},b,f,[h],c,d)},a.prototype.evaluateBinaryOperation=function(a,b,c,d,f){var g,h,i,j,k,l,m,n,o,p=b.Exb;if(p&&(c=!0),g=[c,c],h=e.MYJ(a.operatorType),i=[h,h],f&&f.length>0)for(j=0;j<f.length;j++)g[f[j]]=!0,i[f[j]]=!0;for(k=function(a,b){if(0===b){for(;10===a.type;)a=a.value;if(7===a.type&&a.function&&e.isFunction(a.function)&&a.function.TAb)return null}return b},l=[a.value,a.value2],m=[],j=0;j<2;j++){if(n=this.evaluate(l[j],b,g[j],i[j]),n&&n.pause)return n;if(o=k(l[j],n),e.Convert.vf(o))return o;if(o===e.missingArgument)return w;m[j]=o}return this.evaluateWithArgs(a,function(d){var e=d[0],f=d[1];return a.operatorType<=14&&b.Lf&&(O(e)||O(f))&&(b.Lf&&b.Lf.ensureSingle&&!c?(e=U(b,e,l[0]),f=U(b,f,l[1])):b.Lf.yHJ=!0),T(a.operatorType,e,f)},b,f,m,c,d)},a.prototype.evaluateField=function(a,b){var c,d;return b?(a.source&&(c=a.source,b=c.getEvaluatorContext(b.identity,b.arrayFormulaMode,b.arrayIdentity)),d=b.getField(a.value),g(d)?w:d):v},a.prototype.evaluateFieldItem=function(a,b){var c,d;return b?(a.source&&(c=a.source,b=c.getEvaluatorContext(b.identity,b.arrayFormulaMode,b.arrayIdentity)),d=b.getFieldItem(a.value),g(d)?w:d):v},a.prototype.startCache=function(){this.Bi={},this.service.nia&&this.asyncManager.startCalc()},a.prototype.endCache=function(){this.Bi=h},a.prototype.evaluateBranchFunction=function(a,b,c,d,f){var g,h,i,j,k,l,m,n=b.row+","+b.column;if(!(a.aEc&&a.aEc[n]&&a.aEc[n].ikK)&&e.isFunction(a.function))return g=a.function,h=a.arguments.length,i=g.findTestArgument(),j=this.preprocessFunction(b,g,h,f,c),k=j.acceptsArrays,l=j.keepArrayValuesFlagSet,m=this.testArgGetBranch(b,g,a,k[i],!1,i),m&&m.pause?m:(l&&delete b.Exb,m.branchArgument>=0&&"number"==typeof m.branchArgument?(a.aEc=a.aEc||{},a.aEc[n]=b.source.getCalcService().hkK,{pause:"Branch",branch:b.gkK.cEc[m.branchArgument]}):void(m.testArgValue._error||delete a.bEc))},a.prototype.evaluateLetFunction=function(a,b,c,d){var e,f,g,h,i,j,k=a.arguments.length,l=this;for(b.localScopes.enterScope(),f=1;f<k-1;f+=2){if(g=a.arguments[f-1],h=a.arguments[f],i=g.value,e=l.evaluate(h,b,c,d),e&&e.pause)return e;b.localScopes.setVariable(i,e)}return j=l.evaluate(a.arguments[k-1],b,c,d),j&&j.pause?j:(b.localScopes.exitScope(),j)},a.prototype.evaluateLambdaFunction=function(a,b,c,d){return b.source&&b.source.Af&&b.source.Af.allowDynamicArray&&(b.Lf.yHJ=!0),new e.Functions.LambdaFunction(a,b.localScopes.createClosure())},a.prototype.evaluateISOMITTEDFunction=function(a,b,c,d){var e=a.arguments[0];return e&&100===e.type&&null===b.localScopes.getVariable(e.value)},a.prototype.preprocessFunction=function(a,b,c,d,e){var f,g,i,j,k=[],l=[],m=a.Exb,n=!1,o=h;for(!m&&(1===b.arrayArgumentEvaluateMode||4===b.arrayArgumentEvaluateMode&&e)&&(m=a.Exb=!0,
n=!0),f=0;f<c;f++)k[f]=b.acceptsArray(f),l[f]=b.acceptsReference(f),b.isBranch()&&a.Lf&&a.Lf.ensureSingle&&!e&&(k[f]=!1,l[f]=!1);if(d&&d.length>0||m){for(o=[],f=0;f<c;f++)o[f]=!0;for(g=m?c:d.length,f=0;f<g;f++)i=m?f:d[f],k[i]=!0,l[i]=!0,j=!(b.acceptsReference(i)&&!b.acceptsArray(i)),j&&m&&b.acceptsReference(i)&&(j=!1),o[i]=j}return b.isBranch()&&(a.arrayFormulaMode||a.vi())&&(k[b.findTestArgument()]=!0,l[b.findTestArgument()]=!0),{acceptsArrays:k,acceptsReferences:l,getReferenceValues:o,keepArrayValuesFlagSet:n}},a.prototype.testArgGetBranch=function(a,b,c,d,e,f){var g,h=-1,i=a.Exb;return a.arrayFormulaMode&&(a.Exb=!0),b.acceptsArray(f)&&a.wi(),g=this.evaluate(c.arguments[f],a,d,e),g&&g.pause?g:(b.acceptsArray(f)&&a.xi(),a.Exb=i,s(g)||r(g)||(h=b.findBranchArgument(g)),{testArgValue:g,branchArgument:h})},a.prototype.evaluateFunction=function(a,b,c,d,f){var g;try{g=!a.function||e.isExpression(a.function)?this.evaluateLambdaFunctionCall(a,b,c,d,f):this.evaluateBuildInFunction(a,b,c,d,f)}catch(a){if(e.isStackOverflowError(a)){if(b.lambdaFunctionCallDepth>=2)throw a;g=y}else g=u}return g},a.prototype.evaluateBuildInFunction=function(a,b,c,d,f){if(!a||!a.function||!e.isFunction(a.function))return v;var g=a.function,h=a.functionName,i=this,j=b.ti;return"LET"===h?i.evaluateLetFunction(a,b,c,d):"LAMBDA"===h?i.evaluateLambdaFunction(a,b,c,d):"ISOMITTED"===h?i.evaluateISOMITTEDFunction(a,b,c,d):i.evaluateFunctionCore(a,function(a,c,f){var h,k,l,m,n,o=ba(a,g.Ci);return a=o.Di,o.Ei?g.isContextSensitive()?(b.acceptsReference=d||b.vi(),g instanceof e.Functions.AsyncFunction?(i.T4=i.T4||{},g.evaluateWhenArgumentsIsSame()?i.evaluateAsyncFunction(b,c,g,j,a,f):i.evaluateWithCache(g,a,function(){return i.evaluateAsyncFunction(b,c,g,j,a,f)},i.T4)):g.evaluateWithContext(b,a)):(k=b.arrayFormulaMode,k&&(g.y0a={row:b.rowOffset,col:b.columnOffset}),l=e.getMapping()&&e.getMapping().builtInFunctionsMapping,m=l&&l[g.name]&&l[g.name].specialFun,n=function(){return m&&m.apply(g,a)||g.evaluate.apply(g,a)},h=k?i.evaluateWithCache(g,a,n,i.Bi):n(),delete g.y0a,h):o.Fi},b,c,d,f)},a.prototype.tryGetLambdaFunction=function(a,b,c,d){var f,g;if(e.isExpression(a.function))f=this.evaluate(a.function,b,c,d);else if(a.isLocalFunctionName?f=b.localScopes.getVariable(a.functionName):(g=b.getName(a.functionName),g&&(f=this.evaluate(g,b,c,d))),!f)return v;return f&&f.pause?f:p(f)?f:e.isLambdaFunction(f)?f:u},a.prototype.evaluateLambdaFunctionCall=function(a,b,c,d,f){var g,h,i=this,j=this.tryGetLambdaFunction(a,b,c,d);return j&&j.pause?j:p(j)?j:(g=j,h=e.Jh(j,a.arguments),this.evaluateFunctionCore(h,function(a){var e,f,h,j=b.localScopes;try{if(b.lambdaFunctionCallDepth++,j.enterScope(),j.saveThenSwitchClosure(g.closure),f=g.parameters,f.length!==a.length)return u;for(h=0;h<f.length;h++)b.localScopes.setVariable(f[h].value,a[h]);e=i.evaluate(g.calculation,b,c,d)}finally{b.lambdaFunctionCallDepth--,j.exitScope(),j.restoreClosure()}return e},b,c,d,f))},a.prototype.evaluateFunctionCore=function(a,b,c,d,f,g){var i,j,k,l,m,n,o,p,q,t,u,w,x,y,z,A,B,C,D,E;if(!a||!a.function||!e.isFunction(a.function))return v;if(i=a.arguments.length,j=this,k=a.function,l=[],n=h,k instanceof e.Functions.AsyncFunction&&this.asyncManager.startCalcFunction(k,a,c),0!==i){if(p=j.preprocessFunction(c,k,i,g,d),q=p.acceptsArrays,t=p.acceptsReferences,n=p.getReferenceValues,o=p.keepArrayValuesFlagSet,u=void 0,w=void 0,x=void 0,k.isBranch()){if(w=k.findTestArgument(),y=j.testArgGetBranch(c,k,a,q[w],t[w],w),y&&y.pause)return y;u=y.testArgValue,x=y.branchArgument}for(z=0;z<i;z++){if(w===z)m=u;else{if(x>=0&&z!==x){l[z]=null;continue}if(k.acceptsArray(z)&&c.wi(),m=j.evaluate(a.arguments[z],c,q[z],t[z]),m&&m.pause)return m;k.acceptsArray(z)&&c.xi()}if(!k.acceptsArray(z)&&r(m)||!k.acceptsReference(z)&&s(m))if(A=r(m)?m:h,B=s(m)?m:h,A&&1===A.getRowCount()&&1===A.getColumnCount())m=A.getValue(0,0);else if(B&&1===B.getRowCount(0)&&1===B.getColumnCount(0))m=B.getValue(0,0,0);else{if(C=[],D=!1,g)for(E=0;E<g.length;E++)C.push(g[E]),g[E]===z&&(D=!0);D||(C.push(z),g=C),!k.acceptsReference(z)&&m.referenceInTwoDimension&&m.f5J()}if(e.Convert.vf(m)&&!k.acceptsError(z))return k instanceof e.Functions.AsyncFunction&&this.asyncManager.endCalcFunction(),m;m!==e.missingArgument||k.acceptsMissingArgument(z)||(m=h),l[z]=m,m&&"INDIRECT"!==a.functionName&&m.ck&&m.xf&&N(m,c)}}return o&&delete c.Exb,j.evaluateWithArgs(a,b,c,g,l,d,f,n)},a.prototype.evaluateAsyncFunction=function(a,b,c,d,e,f){var g,h,j=this.asyncManager.getNode();if(j.v5)g=j.Fi;else if(j.canEvaluate()){if(h=new B(a,j),g=c.evaluateWithContext(h,e),h.notAsync)return g;g===i?g=j.Fi!==i?j.Fi:c.defaultValue():1===j.evaluateMode&&(j.v5=!0)}else g=j.Fi!==i?j.Fi:c.defaultValue();return j.Fi=g,f||this.asyncManager.endCalcFunction(),g},a.prototype.evaluateWithCache=function(a,b,c,d){var f,g,h,j,k,l,m,n,o,p,q,r;if(d)if(g=!1,f=d[a.name+b.length])for(h=0;h<f.length;h++){if(j=f[h],g=!1,j.args.length===b.length){for(g=!0,k=0;k<b.length;k++)if(l=j.args[k],m=b[k],l!==m){if(!(l instanceof e.CalcReference&&m instanceof e.CalcReference)){g=!1;break}if(n=l.zf,l.xf!==m.xf||n!==m.zf){g=!1;break}for(o=0;o<n;o++)if(l.getRow(o)!==m.getRow(o)||l.getColumn(o)!==m.getColumn(o)||l.getRowCount(o)!==m.getRowCount(o)||l.getColumnCount(o)!==m.getColumnCount(o)){g=!1;break}}g&&!P(j.y0a,a.y0a)&&(g=!1)}if(g)return j.flag++,j.value}else f=d[a.name+b.length]=[];if(p=c(),d&&p!==i){if(q=f.length,q>=100){for(r=[],h=0;h<q;h++)f[h].flag>0&&r.push(f[h]);r.sort(function(a,b){return b.flag-a.flag}),q=Math.min(50,r.length),f=r.slice(0,q),d[a.name+b.length]=f}f.push({args:b,value:p,flag:0,y0a:a.y0a})}return p},a.prototype.SetAsyncResult=function(a){if(a.jJc()){var b=a.ctx;b.identity&&b.identity.PhK?this.service.QhK(b.source,b.Lf,b.identity,b.ShK,b):b.source.Cf().recalculate(b.source,a.row,a.col,!0)}},a.prototype.evaluateWithArgs=function(a,b,c,d,f,g,h,i){var j,k,l,m,n,o,p,q,t,v,x,y,z,A,B=c.Exb;if(!B||d&&d.length>0||(d=[],j=7===a.type&&a.function,j&&f.forEach(function(a,b){(!j.acceptsArray(b)&&r(a)||!j.acceptsReference(b)&&s(a))&&d.push(b)})),d&&d.length>0){if(l=this.Gi(c,a,f,d,i),!l)return w;for(m=[],n=l[0].length,o=l[0][0].length,p=0;p<n;p++)for(m[p]=[],q=0;q<o;q++)try{for(t=[],v=0;v<f.length;v++)t[v]=l[v][p][q];if(k=b(t,a,p+1!==n||q+1!==o),s(k)&&!B){if(7===a.type&&(j=a.function,j.returnReference&&j.returnReference()))return k;k=this.getOneValue(c,k)}m[p][q]=k,c.Lf.yHJ=!0}catch(a){if(e.isStackOverflowError(a))throw a;m[p][q]=u}return new e.CalcArray(m,B)}try{if(k=b(f,a),15===a.operatorType&&k&&k.ck&&N(k,c),c.arrayFormulaMode&&c.vi())return k;if(r(k)&&!g)return this.getOneValue(c,k);if(s(k)&&!h){if(x=k,g&&1===x.getRangeCount()){for(y=[],z=0;z<x.getRowCount(0);z++)for(y[z]=[],A=0;A<x.getColumnCount(0);A++)y[z][A]=x.getValue(0,z,A);return new e.CalcArray(y)}return!g&&c.Lf&&c.Lf.ensureSingle&&(k.getColumnCount()>1||k.getRowCount()>1)&&(a.e5J=!0),this.getOneValue(c,k)}return k}catch(a){if(e.isStackOverflowError(a))throw a;return u}},a.prototype.getOneValue=function(a,b){var c,d,e,f,g,h;return s(b)?(e=b,f=e.getRowCount(0),g=e.getColumnCount(0),e.getRangeCount()>1||!a.arrayFormulaMode&&f>1&&g>1?b=u:(a.rowOffset!==-1||a.columnOffset!==-1?(c=1===f?0:a.arrayFormulaMode?a.rowOffset:a.rowOffset-e.getRow(0),d=1===g?0:a.arrayFormulaMode?a.columnOffset:a.columnOffset-e.getColumn(0)):(c=1===f?0:a.row-e.getRow(0),d=1===g?0:a.column-e.getColumn(0)),b=c>=f||d>=g?w:e.getValue(0,c,d))):r(b)&&(h=b,!a.arrayFormulaMode||a.rowOffset===-1&&a.columnOffset===-1?b=h.getValue(0,0):(c=1===h.getRowCount()?0:a.rowOffset,d=1===h.getColumnCount()?0:a.columnOffset,b=c>=h.getRowCount()||d>=h.getColumnCount()?w:h.getValue(c,d))),s(b)||r(b)?this.getOneValue(a,b):b},a.prototype.Gi=function(a,b,c,f,g){var j,k,l,m,n,o,p,q,t,u,v,x,y,z,A,B,C,D,E,F=1,G=1,H=-1,I=!0,J=!0,K=1,L=1,N=7===b.type?b:h,O=N&&N.function,P=a.arrayFormulaMode||a.source&&a.source.Af&&a.source.Af.allowDynamicArray;if(O&&e.isFunction(O)&&!O.expandRows()&&(I=!1),O&&e.isFunction(O)&&!O.expandColumns()&&(J=!1),O&&e.isFunction(O)&&O.isBranch()&&(P||a.vi())){if(H=O.findTestArgument(),l=[],m=!1,f)for(n=0;n<f.length;n++)l.push(f[n]),f[n]===H&&(m=!0);if(m||r(c[H])||s(c[H])){for(o=0;o<N.arguments.length;o++)o!==H&&d.Common.k.Cb(l,o)<0&&(r(c[o])||s(c[o]))&&l.push(o);f=l}}for(p=[],q=0,t=f[q],u=c.length,y=[],v=0;v<u;v++)x=c[v],j=h,k=h,K=L=1,v===t?(j=r(x)?x:h,k=s(x)?x:h,(j||k)&&(K=j&&j.getRowCount()||(I&&k?k.getRowCount(0):1),L=j&&j.getColumnCount()||(J&&k?k.getColumnCount(0):1)),q++,t=q<f.length?f[q]:-1):g===i&&(j=r(x)?x:h,k=s(x)?x:h,(j||k)&&(K=j&&j.getRowCount()||(I&&k?k.getRowCount(0):1),L=j&&j.getColumnCount()||(J&&k?k.getColumnCount(0):1))),y[v]=[j,k,x,K,L],F=K>F?K:F,G=L>G?L:G;for(v=0;v<u;v++){if(z=p[v]=[],A=y[v],j=A[0],k=A[1],x=A[2],K=A[3],L=A[4],(j||k)&&(1!==K&&K!==F||1!==L&&L!==G)&&(H===-1||v===H)&&!P)return;for(B=0;B<F;B++)for(C=z[B]=[],D=0;D<G;D++)1!==K&&B>=K||1!==L&&D>=L?C[D]=w:j?(E=j.getValue(1===K?0:B,1===L?0:D),r(E)&&(E=E.getValue(0,0)),C[D]=E):k?!g||g[v]?C[D]=k.getValue(0,1===K?0:B,1===L?0:D):C[D]=k.create([M(k.getRow(0)+(1===K?0:B),k.getColumn(0)+(1===L?0:D),1,1)]):C[D]=x}return p},a}(),b.Evaluator=D,E=function(){function a(a,b){this.id=a,this.Fi=i,this.v5=!1,this.oi=[],this.r4J=!1,b!==i&&(this.evaluateMode=b)}return a.prototype.canEvaluate=function(){var a,b=this.oi;for(a=0;a<b.length;a++)if(!b[a].v5)return!1;return!0},a}(),b.AsyncFunctionNode=E,F=function(){function a(a){var b=this;b.w5=[],b.x5=-1,b.y5={},b.lh=a,b.vQa=0}return a.prototype.startCalc=function(){var a,b,c,d,e,f,g,h,i;if(this.vQa)for(b in this.y5)if(c=this.y5[b])for(d in c)if(e=c[d])for(f in e)if(g=e[f],g&&(g.root.oi=[],a=g.length,a>0))for(h=0;h<a;h++)i=g[h],0===i.evaluateMode&&(i.v5=!1)},a.prototype.startCalcCell=function(a,b){var c,d,e,f,g,h=this,i=a.getName(),j=b.row,k=b.col;h.source=a,b.PhK?(d=h.y5["-"],d||(d=h.y5["-"]={}),c=d[b.PhK],c?c=c[0]:(e=new E((-1)),d[b.PhK]=[],c=d[b.PhK][0]=[],c.root=e)):(f=h.y5[i],f||(f=h.y5[i]={}),g=f[j],g||(g=f[j]={}),c=g[k],c||(e=new E((-1)),c=g[k]=[],c.root=e)),h.vQa++,h.x5=0,h.cellNodes=c,h.row=j,h.col=k,h.w5[0]=c.root,h.evaluateMode=-1},a.prototype.ThK=function(a){var b,c=this.y5["-"][a][0].root.oi;for(b=0;b<c.length;b++)if(!c[b].v5)return!1;return!0},a.prototype.VhK=function(a){return this.y5["-"][a][0].length>0},a.prototype.WhK=function(a){delete this.y5["-"][a]},a.prototype.startCalcFunction=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=this,p=b.arguments,q=!1;if(0!==o.w5.length&&o.cellNodes||(q=!0,o.startCalcCell(c.source,c.identity)),d=o.evaluateMode,e=a.evaluateMode(),"REFRESH"===a.name?(e=p[1]?o.lh.evaluate(p[1],c,!1,!1):0,o.evaluateMode=e):d!==-1&&(e=d),g=c.identity?c.identity.PhK?c.identity.PhK:c.identity.row+"|"+c.identity.col:"0",b.pLc&&b.pLc[g]?(f=b.pLc[g],f.r4J&&(f.r4J=!1,o.cellNodes.push(f))):(b.pLc=b.pLc||{},f=b.pLc[g]=new E(o.cellNodes.length,e),o.cellNodes.push(f)),o.currentNode=f,o.w5[o.x5].oi.indexOf(f)<0&&(o.w5[o.x5].oi.push(f),f.parent=o.w5[o.x5],f.oi=[]),o.w5.push(f),o.x5++,2===e&&d===-1){for(h=6e4,i=o.intervals,j=a.interval()||h,"REFRESH"===a.name&&(f.isRefresh=!0,j=p[2]?o.lh.evaluate(p[2],c,!1,!1):h),i||(o.intervals=i={}),k=i[j],k||"object"!=typeof window||(k=i[j]=[],k.intervalObj=window.setInterval(function(){var a,b,c=o.intervals[j];for(l=0;l<c.length;l++)a=c[l],b=a.node,b.v5=!1,b.isRefresh&&Q(b),o.lh.service.recalculate(a.source,a.row,a.col,!0),o.source.refresh()},j)),m=!1,l=0;l<k.length;l++)if(n=k[l],n.source===o.source&&n.node===f&&n.row===o.row&&n.col===o.col){m=!0;break}m||k.push({source:o.source,node:f,row:o.row,col:o.col})}return q&&o.endCalcCell(),f},a.prototype.getNode=function(){return this.currentNode},a.prototype.endCalcFunction=function(){this.w5.pop(),this.x5--,this.currentNode=this.currentNode.parent},a.prototype.endCalcCell=function(){var a=this;a.x5=-1,a.w5=[]},a.prototype.clearCell=function(a,b){var c,d,e,f,g,h,j,k,l,m,n,o,p,q,r=this;if(r.vQa&&(c=a.getName(),d=b.row,e=b.col,r.source=a,f=r.y5[c],f&&(g=f[d],g&&(h=g[e],h&&(j=h[0],k=j&&j.h_a,k&&(delete k.nia,delete k.z$a),j&&(j.v5=!1,j.r4J=!0),g[e]=i,r.vQa--))),"object"==typeof window)){l=r.intervals;for(m in l)if(n=l[m]){for(o=[],p=0;p<n.length;p++)q=n[p],q.source===a&&q.row===b.row&&q.col===b.col||o.push(q);o.length?o.length!==n.length&&(o.intervalObj=n.intervalObj,l[m]=o):(l[m]=i,window.clearInterval(n.intervalObj))}}},a.prototype.setAsyncResult=function(a,b){a.Fi=b},a.prototype.addRows=function(a,b,c){this.GQa(a,b,c,!0)},a.prototype.deleteRows=function(a,b,c){this.GQa(a,b,c,!1)},a.prototype.GQa=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r=this;if(r.vQa){if(e=a.getName(),f=r.y5[e]){g={};for(h in f)i=f[h],i&&(j=parseInt(h,10),d?(k=j>=b?j+c:j,g[k]=i):j<b?g[j]=i:j>=b+c&&(g[j-c]=i));r.y5[e]=g}l=r.intervals;for(m in l)if(n=l[m]){for(o=[],p=0;p<n.length;p++)q=n[p],q.source===a&&d&&q.row>=b?q.row+=c:q.source===a&&!d&&(q.row<b||q.row>=b+c)&&(q.row=q.row<b?q.row:q.row-c,o.push(q));d||o.length===n.length||(o.intervalObj=n.intervalObj,l[m]=o)}}},a.prototype.addColumns=function(a,b,c){this.HQa(a,b,c,!0)},a.prototype.deleteColumns=function(a,b,c){this.HQa(a,b,c,!1)},a.prototype.HQa=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this;if(t.vQa){if(e=a.getName(),f=t.y5[e])for(g in f)if(h=f[g]){i={};for(j in h)k=h[j],k&&k.length&&(l=parseInt(j,10),d?(m=l>=b?l+c:l,i[m]=k):l<b?i[l]=k:l>=b+c&&(i[l-c]=k));f[g]=i}n=t.intervals;for(o in n)if(p=n[o]){for(q=[],r=0;r<p.length;r++)s=p[r],s.source===a&&d&&s.col>=b?s.col+=c:s.source===a&&!d&&(s.col<b||s.col>=b+c)&&(s.col=s.col<b?s.col:s.col-c,q.push(s));d||q.length===p.length||(q.intervalObj=p.intervalObj,n[o]=q)}}},a.prototype.changeSourceName=function(a,b){var c,d=this;d.vQa&&(c=d.y5[a],c&&(d.y5[b]=c,delete d.y5[a]))},a}();function Q(a){var b,c;for(c=0;c<a.oi.length;c++)b=a.oi[c],b.v5=!1,b.oi.length>0&&Q(b)}function R(a){var b,c=!0,d=a;return a&&a.getValue&&(b=q(a,0,!1,!1),b.isError?d=b[0]:1===b.rowCount&&1===b.colCount?d=b[0][0]:(d=b,c=!1)),{value:d,success:c}}function S(a,b,c){var d=w,e=1===a.rowCount,f=1===a.colCount;return e&&f?a[0][0]:(e&&c<a.colCount?d=a[0][c]:f&&b<a.rowCount?d=a[b][0]:b<a.rowCount&&c<a.colCount&&(d=a[b][c]),d)}function T(a,b,c){return p(b)?b:p(c)?c:e.isLambdaFunction(b)||e.isLambdaFunction(c)?u:a<=2?V(a,b,c):a<=14?W(a,b,c):18===a?e.Functions.bi.PROPERTY.evaluate(b,c):$(a,b,c)}b.evaluateOperator=T;function U(a,b,c){c=c||b;var d=a.row,f=a.column;return c.e5J=!0,e.Functions.findGlobalFunction("@").evaluate({row:d,column:f},b)}function V(a,b,c){var d,f,g,h,i,j,k,l;if(0===a)return b;if(""===b&&1===a)return u;if(!b)return 0;if(d=R(b),d.success)return X(a,d.value);if(c){for(f=[],g=d.value,h=g.rowCount,i=g.colCount,j=0;j<h;j++)for(k=f[j]=[],l=0;l<i;l++)k[l]=X(a,g[j][l]);return new e.CalcArray(f)}}function W(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(d=a<=7?X:8===a?Y:Z,f=R(b),g=R(c),f.success&&g.success)return d(a,f.value,g.value);for(b=f.value,c=g.value,h=f.success?1:b.rowCount,i=f.success?1:b.colCount,j=g.success?1:c.rowCount,k=g.success?1:c.colCount,l=Math.max(h,j),m=Math.max(i,k),n=[],o=0;o<l;o++){for(p=[],q=0;q<m;q++)r=f.success?b:S(b,o,q),s=g.success?c:S(c,o,q),r===w||s===w?p.push(w):p.push(d(a,r,s));n.push(p)}return new e.CalcArray(n)}function X(a,b,c){var f,g,h,j;function k(a){return"string"==typeof a&&0===a.trim().length}if(k(b)||k(c))return u;if(f={value:0},!o(b,f))return b instanceof e.CalcError?b:u;if(g=f.value,c!==i){if(!o(c,f))return c instanceof e.CalcError?c:u;h=f.value}else h=0;return 1===a?-g:2===a?g/100:3===a?e.Zh.Yh(g,-h)?0:g+h:4===a?e.Zh.Yh(g,h)?0:g-h:5===a?d.Common.o.Lma(g*h,e.Functions.CALC_PRECISION||15):6===a?h?g/h:x:7===a?!g&&h<0?x:0===g&&0===h?y:(j=e.Functions.MathHelper.iEc(g,h),j===Number.POSITIVE_INFINITY||j===Number.NEGATIVE_INFINITY||isNaN(j)?y:j):void 0}function Y(a,b,c){if(8===a)return p(b)?b:p(c)?c:e.Convert.bc(b)+e.Convert.bc(c)}function Z(a,b,c){var d=e.pOb(b,c,!1);return p(d)?d:9===a&&0===d||10===a&&0!==d||11===a&&d<0||12===a&&d<=0||13===a&&d>0||14===a&&d>=0}function $(a,b,c){var d,f,g,h,i,j,m,n,o,p,q,r,s;if(!b||!c||(1!==b.getRangeCount()||1!==c.getRangeCount())&&16!==a||b.endSource||c.endSource)return u;if(d=b.getSource(),!d||d!==c.getSource())return u;if(16===a)f=b.yf.concat(c.yf);else{if(g=15===a?k:l,h=15===a?l:k,i=b.getRow(0),j=b.getColumn(0),m=c.getRow(0),n=c.getColumn(0),o=g(i,m),p=g(j,n),q=h(i+b.getRowCount(0),m+c.getRowCount(0))-o,r=h(j+b.getColumnCount(0),n+c.getColumnCount(0))-p,q<1||r<1)return e.Errors.Null;f=[M(o,p,q,r)]}return s=new e.CalcReference(d,f),s.ck=!0,s}G=e.Convert.Pa,H=e.Convert.Rh,I=e.Convert.bc,J=e.Convert.Xh,K=e.Convert.Vh;function _(a,b){var c,d,f,g=!0;switch(b.Hi){case 0:c=G(a),d=!0;break;case 1:c=parseFloat(a),d=!0;break;case 2:c=H(a),d=!0;break;case 3:c=parseInt(a,10),d=!0;break;case 4:c=q(a,b.Ii,b.Ji||!1,b.Ki||!1,b.Li||!1,b.Mi,b.xTa,b.qOb),c.isError&&(c=c[0],g=!1),c.isConvertError&&(c=u,g=!1);break;case 5:c=I(a),b.Ni&&""===c&&(c=u,g=!1);break;case 6:f={value:h},J(a,f)?c=f.value:(c=u,g=!1);break;case 7:c=K(a);break;case 8:c=e.Functions.Wi(a),!c||b.Oi&&0===c.Pi()&&0===c.Qi()?(c=e.Errors.Number,g=!1):c={Ri:c.Pi(),Si:c.Qi()};break;default:c=a}return d&&isNaN(c)&&(c=u,g=!1),{Ti:c,Ei:g}}function aa(a,b,c){var d,f,g,h,j;for(Array.isArray(b)||(b=[b]),d=a.Ti,f=0;f<b.length;f++)if(g=b[f].split(" "),h=g[0],j=parseInt(g[1],10),"<"===h&&d<j||">"===h&&d>j||"<="===h&&d<=j||">="===h&&d>=j||"="===h&&d===j||"!="===h&&d!==j||"checkLength"===h&&d.length>j)return a.Ti=c===i?e.Errors.Number:c,void(a.Ei=!1)}function ba(a,b){var c,d,f,g,h,j=[];if(!b)return{Di:a,Ei:!0};if(b.Xi)for(f=0;f<a.length;f++)j.push(b);else j=Array.isArray(b)?b:[b];for(d=0;d<j.length;d++){if(g=j[d],g.Yi&&!a[d])throw e.sR().Exp_ArgumentNull;if(h=a[d]!==i){if(c=_(a[d],g),g.aj&&aa(c,g.aj,g.bj),!c.Ei)break;a[d]=g.Zi?{$i:h,Qb:c.Ti}:c.Ti}else a[d]=g.Zi?{$i:h,Qb:g._i}:g._i}return c?{Di:a,Ei:c.Ei,Fi:c.Ti}:void 0}},"./src/map.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a){if(this.nva=Object.create(null),this.s4J={},this.t4J=null,this.size=0,a)for(var b=0,c=a.length;b<c;b++)this.set(a[b][0],a[b][1])}return a.prototype.has=function(a){return!!this.nva[this.u4J(a)]},a.prototype.get=function(a){var b=this.nva[this.u4J(a)];return b&&b.value},a.prototype.delete=function(a){var b,c,d=this.u4J(a),e=this.nva[d];if(!e)return!1;if(this.size--,this.size){if(b=void 0,e!==this.t4J)for(b=this.t4J;b&&b.next!==e;)b=b.next;c=e.next,b?b.next=c:this.t4J=c,c&&(c.prev=b)}else this.t4J=null;return delete this.nva[d],delete this.s4J[d],!0},a.prototype.set=function(a,b){var c,d=this.nva,e=this.u4J(a);return d[e]?d[e].value=b:(this.size++,c=d[e]={key:a,keyStamp:e,value:b,next:this.t4J},this.t4J=c),this},a.prototype.clear=function(){var a,b=this.nva;for(a in b)Object.prototype.hasOwnProperty.call(b,a)&&delete b[a];this.s4J={},this.t4J=null,this.size=0},a.prototype.forEach=function(a,b){for(var c=this.t4J;c;){a.call(b,c.value,c.key,this);do c=c.next;while(c&&!this.nva[c.keyStamp])}},a.prototype.toString=function(){return"[object Map]"},a.prototype.u4J=function(a){switch(typeof a){case"undefined":return"undefined";case"object":if(null===a)return"null";break;case"boolean":return"?"+a;case"number":return"+"+a;case"string":return","+a}return""},a}();function e(){return Map&&(""+Map).indexOf("[native code]")!==-1&&new Map([[1,1]]).size?new Map:new d}b.createMap=e},"./src/referenceExpression.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/calc.common.ts"),f=void 0,g=d.Common.j,h=g.Fa,i=Math.abs,j=Math.min,k=function(a){l(b,a);function b(b){return a.call(this,b)||this}return b.prototype.sf=function(){var a=this;return a.endRow===f||a.endColumn===f},b.prototype.tf=function(){var a=this;return a.isFullRow&&a.isFullColumn?3:a.isFullRow?1:a.isFullColumn?2:0},b.prototype.getRange=function(a,b){return o(this,a,b)},b.prototype.offset=function(a,b,c,d,e){var f,g=this,h=g.source,i=g.endSource;return g.sf()?m(h,i,g.row+(g.rowRelative||c?a:0),g.column+(g.columnRelative||c?b:0),g.rowRelative,g.columnRelative):(f=n(h,i,g.row+(g.rowRelative||c?a:0),g.column+(g.columnRelative||c?b:0),g.endRow+(g.isFullColumn||!g.endRowRelative&&!c?0:a),g.endColumn+(g.isFullRow||!g.endColumnRelative&&!c?0:b),g.rowRelative,g.columnRelative,g.endRowRelative,g.endColumnRelative,d,e),f.isFullRow=g.isFullRow,f.isFullColumn=g.isFullColumn,f)},b.prototype.offset2=function(a,b,c,d,f,g){var h,i=this,j=i.endRowRelative?i.endRow+f:i.endRow;return j>=e.MAX_ROW_COUNT-1&&(c=0),h=i.endColumnRelative?i.endColumn+g:i.endColumn,h>=e.MAX_COLUMN_COUNT-1&&(d=0),n(i.source,i.endSource,i.row+(i.isFullColumn?0:a),i.column+(i.isFullRow?0:b),i.endRow+(i.isFullColumn?0:c),i.endColumn+(i.isFullRow?0:d),i.rowRelative,i.columnRelative,i.endRowRelative,i.endColumnRelative,f,g)},b}(e.Expression),b.ReferenceExpression=k;function m(a,b,c,d,e,f){var g=new k(1);return g.row=c,g.column=d,g.rowRelative=e,g.columnRelative=f,a&&(g.source=a),b&&(g.endSource=b),g}b.rf=m;function n(a,b,c,d,f,g,i,l,m,n,o,p,q){var r,s,t,u,v,w=new k(1);return h(f)||(f=m?j(f+o,e.MAX_ROW_COUNT-1)-o:j(f,e.MAX_ROW_COUNT-1)),h(g)||(g=n?j(g+p,e.MAX_COLUMN_COUNT-1)-p:j(g,e.MAX_COLUMN_COUNT-1)),0===(l?d+p:d)&&(n?g+p:g)===e.MAX_COLUMN_COUNT-1&&(d=g=e.BAND_INDEX_CONST),w.isFullRow=d===e.BAND_INDEX_CONST,o=o||0,p=p||0,s=c-(i?0:o),t=d-(l?0:p),u=f-(m?0:o),v=g-(n?0:p),0===(i?c+o:c)&&(m?f+o:f)===e.MAX_ROW_COUNT-1&&(c=f=e.BAND_INDEX_CONST),w.isFullColumn=c===e.BAND_INDEX_CONST,s>u&&(r=c,c=f,f=r,r=i,i=m,m=r),t>v&&(r=d,d=g,g=r,r=l,l=n,n=r),w.row=c,w.column=d,w.endRow=f,w.endColumn=g,w.rowRelative=i,w.columnRelative=l,w.endRowRelative=m,w.endColumnRelative=n,w.isArrayReference=q,w.isFullColumn&&w.isFullRow&&(w.rowRelative=!1,w.endRowRelative=!1),a&&(w.source=a),b&&(w.endSource=b),w}b.uf=n;function o(a,b,c){var d={row:-1,col:-1,rowCount:-1,colCount:-1},f,g,h,j;return a.isFullRow?(d.col=-1,d.colCount=-1):(a.columnRelative?(h=a.column+c,h=h>=e.MAX_COLUMN_COUNT?h%e.MAX_COLUMN_COUNT:h):h=a.column,a.sf()?(d.col=h,d.colCount=1):(a.endColumnRelative?(j=a.endColumn+c,j=j>=e.MAX_COLUMN_COUNT?j%e.MAX_COLUMN_COUNT:j):j=a.endColumn,d.col=h<=j?h:j,d.colCount=i(j-h)+1)),a.isFullColumn?(d.row=-1,d.rowCount=-1):(a.rowRelative?(f=a.row+b,f=f>=e.MAX_ROW_COUNT?f%e.MAX_ROW_COUNT:f):f=a.row,a.sf()?(d.row=f,d.rowCount=1):(a.endRowRelative?(g=a.endRow+b,g=g>=e.MAX_ROW_COUNT?g%e.MAX_ROW_COUNT:g):g=a.endRow,d.row=f<=g?f:g,d.rowCount=i(g-f)+1)),d}b.getRangeForReference=o},"./src/text_Filter/charProcess.ts":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=function(){function a(){this.otherChar=0,this.control=1,this.numeric=2,this.mathSymbol=3,this.symbol=4,this.punctuation=5,this.space=6,this.upperCase=7,this.lowerCase=8,this.katakana=9,this.hiragana=10,this.farEastPunctuation=11,this.hangul=12,this.fullWidth=32768}return a}(),b.CharType=d,e=function(){function a(){this.minValue="\0",this.maxValue="\uffff",this.ANSI_START=0,this.ANSI_END=255,this.BOTH_WIDTH_START=65280,this.BOTH_WIDTH_END=65519,this.FULL_ALPHA_START=65281,this.FULL_UPPER_START=65313,this.FULL_UPPER_END=65338,this.FULL_ALPHA_END=65374,this.CJK_HALF_SYMBOL_START=65377,this.CJK_HALF_SYMBOL_END=65380,this.KANA_HALF_START=65381,this.KANA_HALF_END=65439,this.HANGUL_HALF_START=65440,this.HANGUL_HALF_END=65500,this.FULL_SYMBOL_START=65504,this.FULL_SYMBOL_END=65510,this.HALF_VARIANTS_START=65512,this.HALF_VARIANTS_END=65518,this.KATAKANA_VOICED="\uff9e",this.KATAKANA_SEMI_VOICED="\uff9f",this.tab="\t",this.space=" ",this.LPJ=["\0","\x80","\u0100","\u0180","\u0250","\u02b0","\u0300","\u0370","\u0400","\u0530","\u0590","\u0600","\u0700","\u0780","\u0900","\u0980","\u0a00","\u0a80","\u0b00","\u0b80","\u0c00","\u0c80","\u0d00","\u0d80","\u0e00","\u0e80","\u0f00","\u1000","\u10a0","\u1100","\u1200","\u13a0","\u1400","\u1680","\u16a0","\u1780","\u1800","\u1e00","\u1f00","\u2000","\u2070","\u20a0","\u20d0","\u2100","\u2150","\u2190","\u2200","\u2300","\u2400","\u2440","\u2460","\u2500","\u2580","\u25a0","\u2600","\u2700","\u2800","\u2e80","\u2f00","\u2ff0","\u3000","\u3040","\u30a0","\u3100","\u3130","\u3190","\u31a0","\u3200","\u3300","\u3400","\u4e00","\ua000","\ua490","\uac00","\uf900","\ufb00","\ufb50","\ufe20","\ufe30","\ufe50","\ufe70","\uff00","\ufff0"],this.blocks=["BASIC_LATIN","LATIN_1_SUPPLEMENT","LATIN_EXTENDED_A","LATIN_EXTENDED_B","IPA_EXTENSIONS","SPACING_MODIFIER_LETTERS","COMBINING_DIACRITICAL_MARKS","GREEK","CYRILLIC","ARMENIAN","HEBREW","ARABIC","SYRIAC","THAANA","DEVANAGARI","BENGALI","GURMUKHI","GUJARATI","ORIYA","TAMIL","TELUGU","KANNADA","MALAYALAM","SINHALA","THAI","LAO","TIBETAN","MYANMAR","GEORGIAN","HANGUL_JAMO","ETHIOPIC","CHEROKEE","UNIFIED_CANADIAN_ABORIGINAL_SYLLABIC","OGHAM","RUNIC","KUMER","MONGOLIAN","LATIN_EXTENDED_ADDITIONAL","GREEK_EXTENDED","GENERAL_PUNCTUATION","SUPERSCRIPTS_AND_SUBSCRIPTS","CURRENCY_SYMBOLS","COMBINING_MARKS_FOR_SYMBOLS","LETTERLIKE_SYMBOLS","NUMBER_FORMS","ARROWS","MATHEMATICAL_OPERATORS","MISCELLANEOUS_TECHNICAL","CONTROL_PICTURES","OPTICAL_CHARACTER_RECOGNITION","ENCLOSED_ALPHANUMERICS","BOX_DRAWING","BLOCK_ELEMENTS","GEOMETRIC_SHAPES","MISCELLANEOUS_SYMBOLS","DINGBATS","BRAILLE_PATTERNS","CJK_RADICALS_SUPPLEMENT","KANGXI_RADICALS","IDEOGRAPHIC_DESCRIPTION_CHARACTERS","CJK_SYMBOLS_AND_PUNCTUATION","HIRAGANA","KATAKANA","BOPOMOFO","HANGUL_COMPATIBILITY_JAMO","KANBUN","BOPOMOFO_EXTENDED","ENCLOSED_CJK_LETTERS_AND_MONTHS","CJK_COMPATIBILITY","CJK_UNIFIED_IDEOGRAPHS_EXTENSION","CJK_UNIFIED_IDEOGRAPHS","YI_SYLLABLES","YI_RADICALS","HANGUL_SYLLABLES","CJK_COMPATIBILITY_IDEOGRAPHS","ALPHABETIC_PRESENTATION_FORMS","ARABIC_PRESENTATION_FORMS_A","COMBINING_HALF_MARKS","CJK_COMPATIBILITY_FORMS","SMALL_FORM_VARIANTS","ARABIC_PRESENTATION_FORMS_B","HALFWIDTH_AND_FULLWIDTH_FORMS","SPECIALS"],this.MPJ=["\uff01","\uff10","\uff1a","\uff21","\uff3b","\uff41","\uff5b","\uff61","\uff65","\uffa0","\uffe0","\uffe8"],this.NPJ=new d,this.OPJ=[this.NPJ.symbol|this.NPJ.fullWidth,this.NPJ.numeric|this.NPJ.fullWidth,this.NPJ.symbol|this.NPJ.fullWidth,this.NPJ.upperCase|this.NPJ.fullWidth,this.NPJ.symbol|this.NPJ.fullWidth,this.NPJ.lowerCase|this.NPJ.fullWidth,this.NPJ.symbol|this.NPJ.fullWidth,this.NPJ.farEastPunctuation,this.NPJ.katakana,this.NPJ.hangul,this.NPJ.symbol|this.NPJ.fullWidth,this.NPJ.symbol],this.PPJ=["\u30fb","\u30f2","\u30a1","\u30a3","\u30a5","\u30a7","\u30a9","\u30e3","\u30e5","\u30e7","\u30c3","\u30fc","\u30a2","\u30a4","\u30a6","\u30a8","\u30aa","\u30ab","\u30ad","\u30af","\u30b1","\u30b3","\u30b5","\u30b7","\u30b9","\u30bb","\u30bd","\u30bf","\u30c1","\u30c4","\u30c6","\u30c8","\u30ca","\u30cb","\u30cc","\u30cd","\u30ce","\u30cf","\u30d2","\u30d5","\u30d8","\u30db","\u30de","\u30df","\u30e0","\u30e1","\u30e2","\u30e4","\u30e6","\u30e8","\u30e9","\u30ea","\u30eb","\u30ec","\u30ed","\u30ef","\u30f3","\u3099","\u309a"],this.QPJ=["\uff67","\uff71","\uff68","\uff72","\uff69","\uff73","\uff6a","\uff74","\uff6b","\uff75","\uff76","\uff76","\uff77","\uff77","\uff78","\uff78","\uff79","\uff79","\uff7a","\uff7a","\uff7b","\uff7b","\uff7c","\uff7c","\uff7d","\uff7d","\uff7e","\uff7e","\uff7f","\uff7f","\uff80","\uff80","\uff81","\uff81","\uff6f","\uff82","\uff82","\uff83","\uff83","\uff84","\uff84","\uff85","\uff86","\uff87","\uff88","\uff89","\uff8a","\uff8a","\uff8a","\uff8b","\uff8b","\uff8b","\uff8c","\uff8c","\uff8c","\uff8d","\uff8d","\uff8d","\uff8e","\uff8e","\uff8e","\uff8f","\uff90","\uff91","\uff92","\uff93","\uff6c","\uff94","\uff6d","\uff95","\uff6e","\uff96","\uff97","\uff98","\uff99","\uff9a","\uff9b","\uff9c","\uff9c","\uff68","\uff6a","\uff66","\uff9d","\uff73","\uff76","\uff79","\uff9c","\uff68","\uff6a","\uff66","\uff65","\uff70"],this.RPJ=["\uff67","\uff68","\uff69","\uff6a","\uff6b","\uff6c","\uff6d","\uff6e","\uff6f"],this.SPJ=[0,0,0,0,0,0,0,0,0,0,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,0,-1,1,-1,1,-1,1,0,0,0,0,0,-3,1,2,-3,1,2,-3,1,2,-3,1,2,-3,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1,0,0],this.TPJ=["\u2018","\u2019","\u201c","\u201d"],this.UPJ=["\u30fc"],this.VPJ=["\u3000","\u3001","\u3002","\u300c","\u300d","\u201c","\u201d","\u2018","\u2019","\u309b","\u309c","\uffe5"],this.WPJ=[" ","\uff64","\uff61","\uff62","\uff63",'"','"',"'","'","\uff9e","\uff9f","\xa5"]}return a}(),b.XPJ=e,f=function(){function a(){this.charCategory=new e,this.charType=new d}return a.prototype.isAlphabet=function(a){var b=this;return b.isUpper(a)||b.isLower(a)},a.prototype.isHiragana=function(a){var b=this;return(b.getCharType(a)&~b.charType.fullWidth)===b.charType.hiragana||b.charCategory.UPJ[0]===a},a.prototype.getCharType=function(a){var b=this,c=b.charType.otherChar,d=b.belongTo(a);if("\x7f"===a||"\0"<=a&&a<="\x1f"||"\x80"<=a&&a<="\x9f")return b.charType.control;if("A"<=a&&a<="Z")return b.charType.upperCase;if("a"<=a&&a<="z")return b.charType.lowerCase;if("0"<=a&&a<="9")return b.charType.numeric;switch((b.isFullWidthSymbol(a)||b.isHalfWidthSymbol(a))&&(c=b.charType.symbol),8216!==a.charCodeAt(0)&&8217!==a.charCodeAt(0)&&8220!==a.charCodeAt(0)&&8221!==a.charCodeAt(0)||(c=b.charType.punctuation),12288===a.charCodeAt(0)&&(c=b.charType.space),b.charCategory.blocks[d]){case"HALFWIDTH_AND_FULLWIDTH_FORMS":return b.multiWidthDetails(a);case"KATAKANA":return b.charType.katakana|b.charType.fullWidth;case"HIRAGANA":return b.charType.hiragana|b.charType.fullWidth}return b.isFarEastBlock(d,a)&&(c|=b.charType.fullWidth),c},a.prototype.isLower=function(a){var b=this;return(b.getCharType(a)&~b.charType.fullWidth)===b.charType.lowerCase},a.prototype.isUpper=function(a){var b=this;return(b.getCharType(a)&~b.charType.fullWidth)===b.charType.upperCase},a.prototype.belongTo=function(a){for(var b=this,c=0,d=83,e=d>>1;d-c>1;)a>=b.charCategory.LPJ[e]?c=e:d=e,e=d+c>>1;return e},a.prototype.isFullWidthSymbol=function(b){for(var c=0;c<a.fullWidthSymbolArray.length;c++)if(b===a.fullWidthSymbolArray[c])return!0;return!1},a.prototype.isHalfWidthSymbol=function(b){for(var c=0;c<a.halfWidthSymbolArray.length;c++)if(b===a.halfWidthSymbolArray[c])return!0;return!1},a.prototype.multiWidthDetails=function(a){for(var b=this,c=0,d=b.charCategory.MPJ.length,e=d>>1;d-c>1;)a>=b.charCategory.MPJ[e]?c=e:d=e,e=d+c>>1;return b.charCategory.OPJ[e]},a.prototype.isFarEastBlock=function(a,b){var c,d=this;switch(d.charCategory.blocks[a]){case"CJK_COMPATIBILITY":case"CJK_COMPATIBILITY_FORMS":case"CJK_COMPATIBILITY_IDEOGRAPHS":case"CJK_RADICALS_SUPPLEMENT":case"CJK_SYMBOLS_AND_PUNCTUATION":case"CJK_UNIFIED_IDEOGRAPHS":case"CJK_UNIFIED_IDEOGRAPHS_EXTENSION":case"HALFWIDTH_AND_FULLWIDTH_FORMS":case"BOPOMOFO":case"BOPOMOFO_EXTENDED":case"HIRAGANA":case"KATAKANA":case"KANBUN":case"HANGUL_COMPATIBILITY_JAMO":case"HANGUL_JAMO":case"HANGUL_SYLLABLES":return!0;default:for(c=0;c<d.charCategory.TPJ.length;c++)if(b===d.charCategory.TPJ[c])return!0;if(b.charCodeAt(0)>255)return!0;if(8216===b.charCodeAt(0)||8217===b.charCodeAt(0)||8220===b.charCodeAt(0)||8221===b.charCodeAt(0))return!0}return!1},a.prototype.isFullWidth=function(a){var b,c,d=this;return!!d.isFullWidthSymbol(a)||!d.isHalfWidthSymbol(a)&&(b=d.belongTo(a),c=d.isFarEastBlock(b,a),"HALFWIDTH_AND_FULLWIDTH_FORMS"===d.charCategory.blocks[b]&&(c=(d.multiWidthDetails(a)&d.charType.fullWidth)===d.charType.fullWidth),c)},a.prototype.toHalfWidth=function(a){return this.toHalfWidthEx(a)},a.prototype.toHalfWidthEx=function(a){var b,c,d,e,f=this,g=f.getCharType(a),h=f.isMultiWidth(a);if((g&f.charType.fullWidth)===f.charType.fullWidth)switch(g&~f.charType.fullWidth){case f.charType.punctuation:case f.charType.upperCase:case f.charType.lowerCase:case f.charType.symbol:case f.charType.numeric:case f.charType.mathSymbol:b=f.getFullHalfWidthSpecialChar(a,!1),b!==!1?a=b:h&&(c="!",a=String.fromCharCode(a.charCodeAt(0)-(f.charCategory.LPJ[81].charCodeAt(0)+1)+c.charCodeAt(0)));
break;case f.charType.katakana:if(d=a.charCodeAt(0)-(f.charCategory.LPJ[62].charCodeAt(0)+1),d<0||d>91)return a;if(a=f.charCategory.QPJ[d],e=f.charCategory.SPJ[d],e>0)return a+=String.fromCharCode(1===e?f.charCategory.KATAKANA_VOICED.charCodeAt(0):f.charCategory.KATAKANA_SEMI_VOICED.charCodeAt(0));break;case f.charType.space:a=" ";break;case f.charType.hangul:}return a},a.prototype.isMultiWidth=function(a){var b=this,c=b.belongTo(a),d=b.charCategory.blocks[c];return"KATAKANA"===d||"CJK_SYMBOLS_AND_PUNCTUATION"===d||"HALFWIDTH_AND_FULLWIDTH_FORMS"===d||"BASIC_LATIN"===d&&a>=" "},a.prototype.getFullHalfWidthSpecialChar=function(a,b){var c,d,e,f,g=this;for(b===!0?(c=g.charCategory.WPJ,d=g.charCategory.VPJ):(c=g.charCategory.VPJ,d=g.charCategory.WPJ),e=-1,f=0;f<c.length;){if(c[f]===a){e=f;break}f++}return e!==-1&&f<d.length&&d[f]},a.prototype.toFullWidth=function(a){var b,c,d,e,f,g={},h=this;if(g.text=a,g.processedAll=!1,0===a.length)return g;if(b=a.substring(0,1),h.isMultiWidth(b)){if(b<h.charCategory.LPJ[1])return" "===b?(g.text="\u3000",g):(c="!",g.text=String.fromCharCode(b.charCodeAt(0)-c.charCodeAt(0)+(h.charCategory.LPJ[81].charCodeAt(0)+1)),g);if((h.multiWidthDetails(b)&h.charType.katakana)===h.charType.katakana){if(b.charCodeAt(0)<h.charCategory.KANA_HALF_START)return d=h.getFullHalfWidthSpecialChar(b,!0),g.text=d!==!1?d:b,g;if(b=h.charCategory.PPJ[b.charCodeAt(0)-h.charCategory.KANA_HALF_START],a.length<2)return g.text=b,g;e=a.charCodeAt(1)-(h.charCategory.KATAKANA_VOICED.charCodeAt(0)-1),1!==e&&2!==e||(g.processedAll=!0,f=h.charCategory.SPJ[b.charCodeAt(0)-(h.charCategory.LPJ[62].charCodeAt(0)+1)],0!==f&&((2&Math.abs(f))===e&&(b=String.fromCharCode(b.charCodeAt(0)+1)),b=String.fromCharCode(b.charCodeAt(0)+1))),1===e&&"\u30a6"===b&&(b="\u30f4")}}return g.text=b,g},a.prototype.isUpperKana=function(a){return!this.isLowerKana(a)},a.prototype.isLowerKana=function(b){return a.lowerKana.search(b)!==-1},a.prototype.hasLowerKana=function(b){return a.upperKana.search(b)!==-1||this.isLowerKana(b)},a.prototype.toUpperKana=function(b){var c=a.lowerKana.search(b);return c===-1?b:a.upperKana.substr(c,1)},a.prototype.toLowerKana=function(b){var c=a.upperKana.search(b);return c>=a.upperKana.length-4&&c<a.upperKana.length?b:c===-1?b:a.lowerKana.substr(c,1)},a.prototype.toKatakana=function(a){var b,c=this;return c.isCharOfType(a,c.charType.hiragana|c.charType.fullWidth)?(b=c.getFullHalfWidthSpecialChar(a,!1),b!==!1?b:String.fromCharCode(a.charCodeAt(0)-c.charCategory.LPJ[61].charCodeAt(0)+c.charCategory.LPJ[62].charCodeAt(0))):a},a.prototype.isCharOfType=function(a,b){return this.getCharType(a)===b},a.prototype.isKatakana=function(a){var b=this;return(b.getCharType(a)&~b.charType.fullWidth)===b.charType.katakana},a.prototype.toHiragana=function(a){var b=this;return b.isKatakana(a)?(b.isFullWidth(a)||(a=b.toFullWidth(a).text),b.isCharOfType(a,b.charType.katakana|b.charType.fullWidth)?a>="\u30f7"&&a<="\u30ff"?a:"\u30f5"===a?"\u304b":"\u30f6"===a?"\u3051":String.fromCharCode(a.charCodeAt(0)+b.charCategory.LPJ[61].charCodeAt(0)-b.charCategory.LPJ[62].charCodeAt(0)):a):a},a.prototype.isDigit=function(a){var b=this;return(b.getCharType(a)&~b.charType.fullWidth)===b.charType.numeric},a.prototype.isSurrogate=function(a){return null!==a&&a.charCodeAt(0)>="\ud800".charCodeAt(0)&&a.charCodeAt(0)<="\udfff".charCodeAt(0)},a.lowerKana="\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308e\u30a1\u30a3\u30a5\u30a7\u30a9\u30c3\u30e3\u30e5\u30e7\u30ee\uff67\uff68\uff69\uff6a\uff6b\uff6c\uff6d\uff6e\uff6f\u30f5\u30f6\u3095\u3096",a.upperKana="\u3042\u3044\u3046\u3048\u304a\u3064\u3084\u3086\u3088\u308f\u30a2\u30a4\u30a6\u30a8\u30aa\u30c4\u30e4\u30e6\u30e8\u30ef\uff71\uff72\uff73\uff74\uff75\uff94\uff95\uff96\uff82\u30ab\u30b1\u304b\u3051",a.fullWidthSymbolArray=["\u3001","\u3002","\uff0c","\uff0e","\u30fb","\uff1a","\uff1b","\uff1f","\uff01","\u309b","\u309c","\xb4","\uff40","\xa8","\uff3e","\uffe3","\uff3f","\u30fd","\u30fe","\u309d","\u309e","\u3003","\u4edd","\u3005","\u3006","\u3007","\u30fc","\u2014","\u2010","\uff0f","\u301c","\u2016","\uff5c","\u2026","\u2025","\u2018","\u2019","\u201c","\u201d","\uff08","\uff09","\u3014","\u3015","\uff3b","\uff3d","\uff5b","\uff5d","\u3008","\u3009","\u300a","\u300b","\u300c","\u300d","\u300e","\u300f","\u3010","\u3011","\uff0b","\u2212","\xb1","\xd7","\xf7","\uff1d","\u2260","\uff1c","\uff1e","\u2266","\u2267","\u221e","\u2234","\u2642","\u2640","\xb0","\u2032","\u2033","\u2103","\uffe5","\uff04","\xa2","\xa3","\uff05","\uff03","\uff06","\uff0a","\uff20","\xa7","\u2606","\u2605","\u25cb","\u25cf","\u25ce","\u25c7","\u25c6","\u25a1","\u25a0","\u25b3","\u25b2","\u25bd","\u25bc","\u203b","\u3012","\u2192","\u2190","\u2191","\u2193","\u3013","\uff07","\uff02","\uff0d","\u3033","\u3034","\u3035","\u303b","\u303c","\u30ff","\u309f","\u2208","\u220b","\u2286","\u2287","\u2282","\u2283","\u222a","\u2229","\u2284","\u2285","\u228a","\u228b","\u2209","\u2205","\u2305","\u2306","\u2227","\u2228","\xac","\u21d2","\u21d4","\u2200","\u2203","\u2295","\u2296","\u2297","\u2225","\u2226","\u2985","\u2986","\u3018","\u3019","\u3016","\u3017","\u2220","\u22a5","\u2312","\u2202","\u2207","\u2261","\u2252","\u226a","\u226b","\u221a","\u223d","\u221d","\u2235","\u222b","\u222c","\u2262","\u2243","\u2245","\u2248","\u2276","\u2277","\u2194","\u212b","\u2030","\u266f","\u266d","\u266a","\u2020","\u2021","\xb6","\u266e","\u266b","\u266c","\u2669","\u25ef","\uff3c","\uff5e","\uffe0","\uffe1","\uffe2","\u2015"],a.halfWidthSymbolArray=["\\","~","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","]","^","_","`","{","|","}","\uff61","\uff62","\uff63","\uff64","\uff65","\xa1","\xa4","\xa5"],a}(),b.YPJ=f},"./src/text_Filter/emoji_helper.ts":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/calc.common.ts"),e=function(){function a(){}return a.isEmoji=function(b,c,d){d.emojiCharLength=0;try{if(a.isEmojiEnclosedAlphanumericSymbol(b,c))return d.emojiCharLength=2,!0;if(a.isEmojiInSpecificRange(b,c)||a.isEmojiInUnicodeStandardSymbol(b,c))return a.isHighSurrogate(b,c)?d.emojiCharLength=2:d.emojiCharLength=1,!0}catch(a){}return!1},a.isEmojiEnclosedAlphanumericSymbol=function(b,c){return!(c>=b.length-1)&&(!a.isHighSurrogate(b,c)&&!(!a.contains(a.ZPJ,a.convertToUtf32(b,c))||a.$PJ!==a.convertToUtf32(b,c+1)))},a.isEmojiInSpecificRange=function(b,c){var d,e=a.convertToUtf32(b,c),f=Math.floor(a._PJ.length/2);for(d=0;d<f;d++)if(a._PJ[2*d]<=e&&e<=a._PJ[2*d+1])return!0;return!1},a.isEmojiInUnicodeStandardSymbol=function(b,c){var d=a.convertToUtf32(b,c);return a.contains(a.aQJ,d)},a.contains=function(a,b){for(var c,d=0,e=a.length-1;d<=e;){if(c=Math.floor((d+e)/2),a[c]===b)return!0;a[c]>b?e=c-1:d=c+1}return!1},a.convertFromUtf32=function(a){if(a<0||a>1114111||a>=55296&&a<=57343)throw Error(d.sR().Exp_ArgumentOutOfRangeException);return a<65536?String.fromCharCode(a):(a-=65536,String.fromCharCode(Math.floor(a/1024)+55296,a%1024+56320))},a.convertToUtf32=function(a,b){var c,e;if(b<0||b>=a.length)throw Error(d.sR().Exp_ArgumentOutOfRangeException);if(c=a.charCodeAt(b)-55296,c<0||c>2047)return a.charCodeAt(b);if(c>1023)throw Error(d.sR().Exp_ArgumentException);if(b>=a.length-1)throw Error(d.sR().Exp_ArgumentException);if(e=a.charCodeAt(b+1)-56320,e<0||e>1023)throw Error(d.sR().Exp_ArgumentException);return 1024*c+e+65536},a.isHighSurrogate=function(a,b){var c=a.charCodeAt(b);return c>=55296&&c<=56319},a.isLowSurrogate=function(a,b){var c=a.charCodeAt(b);return c>=56320&&c<=57343},a.$PJ=8419,a.ZPJ=[35,48,49,50,51,52,53,54,55,56,57],a._PJ=[9728,9983,9984,10175,10240,10495,11008,11263,19904,19967,65936,65999,118784,119039,119040,119295,119296,119375,119552,119647,126976,127023,127024,127135,127136,127231,127232,127487,127488,127743,127744,128511,128512,128591,128640,128767,128768,128895],a.aQJ=[169,174,8194,8195,8197,8252,8265,8482,8505,8596,8597,8598,8599,8600,8601,8617,8618,8986,8987,9193,9194,9195,9196,9200,9203,9410,9642,9643,9654,9664,9723,9724,9725,9726,10548,10549,12336,12349,12951,12953],a}(),b.bQJ=e},"./src/text_Filter/text_Filter.ts":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/text_Filter/charProcess.ts"),e=c("./src/text_Filter/emoji_helper.ts"),f=c("./src/calc.common.ts"),function(a){a[a.DBCS_UpperAlphabet=2147483650]="DBCS_UpperAlphabet",a[a.SBCS_UpperAlphabet=1073741825]="SBCS_UpperAlphabet",a[a.DBCS_LowerAlphabet=2147483656]="DBCS_LowerAlphabet",a[a.SBCS_LowerAlphabet=1073741828]="SBCS_LowerAlphabet",a[a.DBCS_Number=2147483680]="DBCS_Number",a[a.SBCS_Number=1073741840]="SBCS_Number",a[a.DBCS_Binary=2147483776]="DBCS_Binary",a[a.SBCS_Binary=1073741888]="SBCS_Binary",a[a.DBCS_Hexadecimal=2147484160]="DBCS_Hexadecimal",a[a.SBCS_Hexadecimal=1073742080]="SBCS_Hexadecimal",a[a.DBCS_Symbol=2147485696]="DBCS_Symbol",a[a.SBCS_Symbol=1073742848]="SBCS_Symbol",a[a.DBCS_NumberSymbol=2147491840]="DBCS_NumberSymbol",a[a.SBCS_NumberSymbol=1073745920]="SBCS_NumberSymbol",a[a.DBCS_Katakana=2147516416]="DBCS_Katakana",a[a.SBCS_Katakana=1073758208]="SBCS_Katakana",a[a.DBCS_Space=2147614720]="DBCS_Space",a[a.SBCS_Space=1073807360]="SBCS_Space",a[a.TwoBytes=2148007936]="TwoBytes",a[a.FourBytes=2147745792]="FourBytes",a[a.DBCS_ShiftJIS=2148532224]="DBCS_ShiftJIS",a[a.DBCS_JISX0208=2149580800]="DBCS_JISX0208",a[a.Emoji=4194304]="Emoji",a[a.IVS=8388608]="IVS",a[a.DBCS_Hiragana=2164260864]="DBCS_Hiragana",a[a.Upper_SBCS_Katakana=1207959552]="Upper_SBCS_Katakana",a[a.Upper_DBCS_Katakana=2415919104]="Upper_DBCS_Katakana",a[a.Upper_DBCS_Hiragana=2684354560]="Upper_DBCS_Hiragana",a[a.All=3321888768]="All",a[a.DBCS_All=2214592512]="DBCS_All",a[a.SBCS_All=1107296256]="SBCS_All",a[a.DBCS=2147483648]="DBCS",a[a.SBCS=1073741824]="SBCS"}(g=b.CharacterType||(b.CharacterType={})),h={"\uff21":g.DBCS_UpperAlphabet,A:g.SBCS_UpperAlphabet,"\uff41":g.DBCS_LowerAlphabet,a:g.SBCS_LowerAlphabet,"\uff2b":g.DBCS_Katakana,K:g.SBCS_Katakana,"\uff19":g.DBCS_Number,9:g.SBCS_Number,"\uff03":g.DBCS_NumberSymbol,"#":g.SBCS_NumberSymbol,"\uff20":g.DBCS_Symbol,"@":g.SBCS_Symbol,"\uff22":g.DBCS_Binary,B:g.SBCS_Binary,"\uff38":g.DBCS_Hexadecimal,X:g.SBCS_Hexadecimal,"\uff2a":g.DBCS_Hiragana,"\uff3a":g.DBCS_All,"\uff2d":g.DBCS_ShiftJIS,"\uff29":g.DBCS_JISX0208,H:g.SBCS_All,N:g.Upper_SBCS_Katakana,"\uff2e":g.Upper_DBCS_Katakana,"\uff27":g.Upper_DBCS_Hiragana,"\uff33":g.DBCS_Space,S:g.SBCS_Space,"\uff34":g.FourBytes,"\uff24":g.TwoBytes,"\uff25":g.Emoji,"\uff36":g.IVS},i=function(){function a(a,b,c){void 0===c&&(c=!0);var e=this;e.format=b,e.includeFormat="",e.excludeFormat="",e.includeNormalChar="",e.excludeNormalChar="",e.allowTypes=g.All,e.excludeTypes=g.All,e.include=!0,e.autoConvert=a,e.charExInstance=new d.YPJ,e.keepInvalidChar=c,e.parseFormat(e.format)}return a.prototype.parseFormat=function(a){var b=this;b.includeFormat=b.getIncludeFormat(a),b.excludeFormat=b.getExcludeFormat(a),b.parseIncludeFormat(b.includeFormat),b.parseExcludeFormat(b.excludeFormat)},a.prototype.getIncludeFormat=function(a){var b,c,d;if(null===a||0===a.length)return"";for(b="",c=0;c<a.length;c++)if(d=a.substring(c,c+1),"\\"===d){if(c===a.length-1)throw f.sR().Exp_FormulaInvalid;b=b+d+a.substring(c+1,c+2),c++}else{if("^"===d)return b;b+=d}return b},a.prototype.getExcludeFormat=function(a){var b,c,d,e;if(null===a||0===a.length)return"";for(b=0,c="",d=0;d<a.length;d++)if(e=a.substring(d,d+1),"\\"===e){if(d===a.length-1)throw f.sR().Exp_FormulaInvalid;0!==b&&(c=c+e+a.substring(d+1,d+2)),d++}else if("^"===e){if(b++,b>1)throw f.sR().Exp_DuplicatedChar}else 0!==b&&(c+=e);return 1===b&&(c="^"+c),c},a.prototype.parseIncludeFormat=function(a){var b,c,d,e=this;if(null===a||0===a.length)return e.allowTypes=g.All,e.includeNormalChar="",void(e.includeFormat="");for(e.allowTypes=0,e.includeNormalChar="",b=0;b<a.length;b++)switch(a.charCodeAt(b)){case 94:break;case 92:if(b===a.length-1)throw f.sR().Exp_FormulaInvalid;e.includeNormalChar=e.includeNormalChar+a.substring(b+1,b+2),b++;break;default:c=a[b],d=h[c],d?e.allowTypes|=d:e.includeNormalChar=e.includeNormalChar+a.substring(b,b+1)}},a.prototype.parseExcludeFormat=function(a){var b,c,d,e=this;if(null===a||0===a.length)return e.excludeTypes=g.All,e.excludeNormalChar="",void(e.excludeFormat="");if("^"===a)return e.excludeTypes=g.All,e.excludeNormalChar="",void(e.excludeFormat="^");for(e.excludeTypes=0,e.excludeNormalChar="",b=0;b<a.length;b++)switch(a.charCodeAt(b)){case 94:0===b&&(e.include=!1);break;case 92:if(b===a.length-1)throw f.sR().Exp_FormulaInvalid;e.excludeNormalChar=e.excludeNormalChar+a.substring(b+1,b+2),b++;break;default:c=a[b],d=h[c],d?e.excludeTypes|=d:e.excludeNormalChar=e.excludeNormalChar+a.substring(b,b+1)}},a.prototype.checkText=function(a){var b,c,d,e=this,f=a.length,g={IsInputValid:!0,CheckedText:""};for(b=0;b<f;)c=a.substring(b,b+1),"\t"!==c&&"\r"!==c&&"\n"!==c?(d=e.check(a,b),e.isNullOrUndefined(d.index)?(c=d,b++):(b=d.index,c=d.strValue),""===c&&(g.IsInputValid=!1)):b++,g.CheckedText+=c;return g},a.prototype.check=function(a,b){var c,d,e=this;return c=null!==b?a.substring(b,b+1):a,d=e.IsValid(c),d?c:e.autoConvert?null!==b?e.Convert(a,b):e.Convert(c):""},a.prototype.IsValid=function(a){var b=this;if(""!==b.excludeFormat){if(b.IsValidProcess(a,b.excludeTypes,b.excludeNormalChar))return!1;if(""!==b.includeFormat)return b.IsIncludeValid(a)}else if(""!==b.includeFormat)return b.IsIncludeValid(a);return!0},a.prototype.Convert=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this;if(c=null===b?a:a.substring(b,b+1),d=!1,m.charExInstance.isAlphabet(c))return e=m.charExInstance.isLower(c)?c.toUpperCase():c.toLowerCase(),(d=m.IsValid(e))?e:(c=m.charExInstance.isFullWidth(c)?m.charExInstance.toHalfWidth(c):m.charExInstance.toFullWidth(c).text,(d=m.IsValid(c))?c:(e=m.charExInstance.isFullWidth(e)?m.charExInstance.toHalfWidth(e):m.charExInstance.toFullWidth(e).text,d=m.IsValid(e),d?e:m.keepInvalidChar?c:""));if(m.charExInstance.isHiragana(c)){if(m.charExInstance.isLowerKana(c)){if(f=m.charExInstance.toUpperKana(c),d=m.IsValid(f))return f}else if(m.charExInstance.hasLowerKana(c)&&(g=m.charExInstance.toLowerKana(c),d=m.IsValid(g)))return g;if(e=m.charExInstance.toKatakana(c),d=m.IsValid(e))return e;if(m.charExInstance.isLowerKana(e)){if(f=m.charExInstance.toUpperKana(e),d=m.IsValid(f))return f}else if(m.charExInstance.hasLowerKana(e)&&(g=m.charExInstance.toLowerKana(e),d=m.IsValid(g)))return g;if(h=m.charExInstance.toHalfWidthEx(e),d=m.IsValid(h))return h;if(m.charExInstance.isLowerKana(h)){if(h=m.charExInstance.toUpperKana(h),d=m.IsValid(h))return h}else if(m.charExInstance.hasLowerKana(h)&&(h=m.charExInstance.toLowerKana(h),d=m.IsValid(h)))return h;return m.keepInvalidChar?c:""}if(m.charExInstance.isKatakana(c)){if(m.charExInstance.isLowerKana(c)){if(f=m.charExInstance.toUpperKana(c),d=m.IsValid(f))return f}else if(m.charExInstance.hasLowerKana(c)&&(g=m.charExInstance.toLowerKana(c),d=m.IsValid(g)))return g;if(i=!1,e=c,m.charExInstance.isFullWidth(c)){if(j=m.charExInstance.toHalfWidthEx(c),j.length>0&&(d=m.IsValid(j)))return j;if(m.charExInstance.isLowerKana(j)){if(j=m.charExInstance.toUpperKana(j),d=m.IsValid(j))return j}else if(m.charExInstance.hasLowerKana(j)&&(j=m.charExInstance.toLowerKana(j),d=m.IsValid(j)))return j}else{if(null===b){if(e=m.charExInstance.toFullWidth(c).text,!m.charExInstance.isKatakana(e))return m.keepInvalidChar?c:"";if(d=m.IsValid(e))return e}else{if(b+1<a.length?(k=m.charExInstance.toFullWidth(a.substring(b,b+2)),e=k.text,i=k.processedAll):e=m.charExInstance.toFullWidth(c).text,!m.charExInstance.isKatakana(e))return m.keepInvalidChar?c:"";if(d=m.IsValid(e))return b++,i&&b++,l={},l.index=b,l.strValue=e,l}if(m.charExInstance.isLowerKana(e)){if(f=m.charExInstance.toUpperKana(e),d=m.IsValid(f))return f}else if(m.charExInstance.hasLowerKana(e)&&(g=m.charExInstance.toLowerKana(e),d=m.IsValid(g)))return g}if(e=m.charExInstance.toHiragana(e),d=m.IsValid(e))return null!==b?(b++,i&&b++,l={},l.index=b,l.strValue=e,"\u3094"===e&&(i?l.strValue="\u3046\u309b":l.strValue=""),l):"\u3094"===e?m.keepInvalidChar?c:"":e;if(m.charExInstance.isLowerKana(e)){if(f=m.charExInstance.toUpperKana(e),d=m.IsValid(f))return f}else if(m.charExInstance.hasLowerKana(e)&&(g=m.charExInstance.toLowerKana(e),d=m.IsValid(g)))return g}return c=m.charExInstance.isFullWidth(c)?m.charExInstance.toHalfWidth(c):m.charExInstance.toFullWidth(c).text,d=m.IsValid(c),d?c:m.keepInvalidChar?c:""},a.prototype.IsIncludeValid=function(a){var b=this;return b.IsValidProcess(a,b.allowTypes,b.includeNormalChar)},a.prototype.IsValidProcess=function(a,b,c){var d,f,h=this;if(c.indexOf(a)!==-1)return!0;if("\t"===a||"\r"===a||"\n"===a)return!0;if(0===b)return!1;if(d=!1,b===g.All||(b&g.Emoji)===(0|g.Emoji)&&e.bQJ.isEmoji(a,0,{})||(b&g.FourBytes)===(0|g.FourBytes)&&h.IsFourBytes(a))return!0;if(1===a.length&&a.length>1)return!1;if(h.charExInstance.isFullWidth(a)){if((b&g.DBCS)!==(0|g.DBCS))return!1;(b&g.DBCS_All)===(0|g.DBCS_All)&&"\u3000"!==a||(b&g.DBCS_LowerAlphabet)===(0|g.DBCS_LowerAlphabet)&&h.IsLower(a)||(b&g.DBCS_UpperAlphabet)===(0|g.DBCS_UpperAlphabet)&&h.IsUpper(a)||(b&g.DBCS_Number)===(0|g.DBCS_Number)&&h.IsNumber(a)||(b&g.DBCS_Binary)===(0|g.DBCS_Binary)&&h.IsBinary(a)||(b&g.DBCS_Hexadecimal)===(0|g.DBCS_Hexadecimal)&&h.IsHex(a)||(b&g.DBCS_Symbol)===(0|g.DBCS_Symbol)&&h.IsSymbol(a)||(b&g.DBCS_NumberSymbol)===(0|g.DBCS_NumberSymbol)&&h.IsNumberSymbol(a)||(b&g.Upper_DBCS_Katakana)===(0|g.Upper_DBCS_Katakana)&&h.IsKatakana(a)&&h.IsUpperKana(a)||(b&g.Upper_DBCS_Hiragana)===(0|g.Upper_DBCS_Hiragana)&&h.IsHiragana(a)&&h.IsUpperKana(a)||(b&g.DBCS_Space)===(0|g.DBCS_Space)&&h.IsFormatSpace(a)||(b&g.FourBytes)===(0|g.FourBytes)&&h.IsFourBytes(a)||(b&g.TwoBytes)===(0|g.TwoBytes)&&!h.IsFourBytes(a)&&"\u3000"!==a?d=!0:(b&g.DBCS_Katakana)===(0|g.DBCS_Katakana)&&h.IsKatakana(a)?(f=h.IsHiragana(a),d=!f||(!!h.include||(b&g.DBCS_Hiragana)===(0|g.DBCS_Hiragana))):(b&g.DBCS_Hiragana)===(0|g.DBCS_Hiragana)&&h.IsHiragana(a)&&(f=h.IsKatakana(a),d=!f||(!!h.include||(b&g.DBCS_Katakana)===(0|g.DBCS_Katakana)))}else{if((b&g.SBCS)!==g.SBCS)return!1;((b&g.SBCS_All)===g.SBCS_All&&" "!==a||(b&g.SBCS_LowerAlphabet)===g.SBCS_LowerAlphabet&&h.IsLower(a)||(b&g.SBCS_UpperAlphabet)===g.SBCS_UpperAlphabet&&h.IsUpper(a)||(b&g.SBCS_Number)===g.SBCS_Number&&h.IsNumber(a)||(b&g.SBCS_Binary)===g.SBCS_Binary&&h.IsBinary(a)||(b&g.SBCS_Hexadecimal)===g.SBCS_Hexadecimal&&h.IsHex(a)||(b&g.SBCS_Symbol)===g.SBCS_Symbol&&h.IsSymbol(a)||(b&g.SBCS_NumberSymbol)===g.SBCS_NumberSymbol&&h.IsNumberSymbol(a)||(b&g.SBCS_Katakana)===g.SBCS_Katakana&&h.IsKatakana(a)||(b&g.Upper_SBCS_Katakana)===g.Upper_SBCS_Katakana&&h.IsKatakana(a)&&h.IsUpperKana(a)||(b&g.SBCS_Space)===g.SBCS_Space&&h.IsFormatSpace(a))&&(d=!0)}return d},a.prototype.IsUpper=function(a){return this.charExInstance.isUpper(a)},a.prototype.IsLower=function(a){return this.charExInstance.isLower(a)},a.prototype.IsNumber=function(a){return this.charExInstance.isDigit(a)},a.prototype.IsBinary=function(a){return a=this.IsFullWidth(a)?this.ToHalfWidth(a):a,"0"===a||"1"===a},a.prototype.IsHex=function(a){var b=this;return a=b.IsFullWidth(a)?b.ToHalfWidth(a):a,"A"===a||"B"===a||"C"===a||"D"===a||"E"===a||"F"===a||"a"===a||"b"===a||"c"===a||"d"===a||"e"===a||"f"===a||b.IsDigit(a)},a.prototype.IsNumberSymbol=function(a){var b=this;return a=b.IsFullWidth(a)?b.ToHalfWidth(a):a,b.IsDigit(a)||"+"===a||"-"===a||"$"===a||"%"===a||"\\"===a||","===a||"."===a},a.prototype.IsKatakana=function(a){return this.charExInstance.isKatakana(a)},a.prototype.IsHiragana=function(a){return this.charExInstance.isHiragana(a)},a.prototype.IsFullWidth=function(a){return this.charExInstance.isFullWidth(a)},a.prototype.ToHalfWidth=function(a){return this.charExInstance.toHalfWidth(a)},a.prototype.IsDigit=function(a){return this.charExInstance.isDigit(a)},a.prototype.IsFourBytes=function(a){var b,c=this.charExInstance,d=a.substring(0,1);if(2===d.length)for(b=0;b<d.length;b++)if(c.isSurrogate(d[b]))return!0;return!1},a.prototype.IsFormatSpace=function(a){return" "===a||"\u3000"===a},a.prototype.IsSymbol=function(a){var b=this;return b.charExInstance.isHalfWidthSymbol(a)||b.charExInstance.isFullWidthSymbol(a)},a.prototype.IsUpperKana=function(a){return this.charExInstance.isUpperKana(a)},a.prototype.isNullOrUndefined=function(a){return null===a||void 0===a},a}(),b.KPJ=i},Common:function(a,b){a.exports=c("Common")}}),a.exports=d.Spread.CalcEngine},"./node_modules_local/@grapecity/js-calc/index.js":function(a,b,c){a.exports=c("./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js")},"./node_modules_local/@grapecity/js-data-manager/dist/gc.data.js":function(a,b,c){var d="object"==typeof d?d:{};d.Data=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s="./dist/src/dataManager.entry.js")}({"./dist/src/calculation/calcSource.js":function(a,b,c){"use strict";var d,e,f,g=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),b.DataManagerCalcSource=b.DataManagerReference=void 0,d=c("CalcEngine"),e=function(){function a(){this.row=[],this.field=[]}return a.prototype.parseRowIndex=function(a,b,c){var d=b.num;return b.relative||(b.num===-1?d=a-1:d--),c*b.relative+d},a.prototype.getValueImp=function(a){var b,c,e,f,g,h,i,j=this.table.length();if(this.field.SNJ&&this.field.SNJ[this.rowString])return this.field.SNJ[this.rowString];if(b=[],0===this.row.length)for(c=0;c<j;c++)b.push(this.field.getValue(c));for(e=0;e<this.row.length;e++)if(f=this.row[e],2===f.length)for(g=this.parseRowIndex(j,f[0],a),h=this.parseRowIndex(j,f[1],a),i=g;i<=h;i++)b.push(this.field.getValue(i));else if(f.type)if("key"===f.type)c=this.table.vQJ(f.value),b=b.concat(this.field.getValues(c));else for(i="odd"===f.type?1:0;i<j;i+=2)b.push(this.field.getValue(i));else c=this.parseRowIndex(j,f,a),b.push(this.field.getValue(c));if(1===b.length)b=b[0];else if(0===b.length)return null;return b instanceof Array&&(b=b[0]instanceof Array?new d.CalcArray(b):new d.CalcArray([b])),this.jOJ||(this.field.SNJ=this.field.SNJ||{},this.field.SNJ[this.rowString]=b),b},a.prototype.getValuesImp=function(a,b){var c=this.field.getValues(a,b);return c[0]instanceof Array?new d.CalcArray(c):new d.CalcArray([c])},a.prototype.getValue=function(a,b){return this.K4J(),a instanceof Array?this.getValuesImp(a,b):this.getValueImp(a)},a.prototype.K4J=function(){this.field=this.table.TNJ(this.HL)},a}(),b.DataManagerReference=e,f=function(a){g(b,a);function b(b,c){var d=a.call(this,b)||this;return d.sj=c,d}return b.prototype.TDJ=function(){return this._allFieldNames},b.prototype.oSJ=function(a){this.pSJ=a},b.prototype.L$a=function(a,b){this.xc=a,this.oI=b},b.prototype.getField=function(a){var b=this.xc,c=this.oI;return a.getValue(b,c)},b}(d.CalcSource),b.DataManagerCalcSource=f},"./dist/src/calculation/functions/functions.entry.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j;Object.defineProperty(b,"__esModule",{value:!0}),b.addCustomFunctions=void 0,d=c("./dist/src/calculation/functions/scope.js"),e=c("./dist/src/calculation/functions/hierarchyParent.js"),f=c("./dist/src/calculation/functions/hierarchyChildren.js"),g=c("./dist/src/calculation/functions/hierarchyOnlyChildren.js"),h=c("./dist/src/calculation/functions/hierarchyLevel.js"),i=c("./dist/src/calculation/functions/hierarchyLevelRowNumber.js"),j=c("./dist/src/calculation/functions/query.js");function k(){d.addScopeCustomFunctions(),e.addParentCustomFunctions(),f.addChildrenCustomFunctions(),g.addOnlyChildrenCustomFunctions(),h.addLevelCustomFunctions(),i.addLevelRowNumberCustomFunctions(),j.addQueryFunction()}b.addCustomFunctions=k},"./dist/src/calculation/functions/hierarchyChildren.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),b.addChildrenCustomFunctions=void 0,d=c("CalcEngine"),e=c("./dist/src/dataSource/utils.js"),f="CHILDREN";function g(){function a(){this.Ci=[{Hi:3,aj:["< 1","> 999"]},{Hi:5}]}a.prototype=new d.Functions.Function(f,2,2),a.prototype.isContextSensitive=function(){return!0},a.prototype.evaluate=function(a,b,c){var f,g=[],h=a.source.sj,i=a.source.xc;return h.d7J()&&(f=h.z6J(i),!e.isNullOrUndefined(f)&&b>0&&!e.isNullOrEmpty(c)&&(e.traversalTree(f,{invoking:function(a){if(b--,0===b){var d=a.mi,e=h._dataSource.J4J(d),f=h._getValueByField(c,e);return g.push(f),{cancelDeepRecursion:!0}}if(0===a.children.length)return{cancelDeepRecursion:!0}},invoked:function(){b++}}),a.source.xc=i)),new d.CalcArray([g])},d.Functions.defineGlobalCustomFunction(f,new a)}b.addChildrenCustomFunctions=g},"./dist/src/calculation/functions/hierarchyLevel.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),b.addLevelCustomFunctions=void 0,d=c("CalcEngine"),e=c("./dist/src/dataSource/utils.js"),f="LEVEL";function g(){function a(){}a.prototype=new d.Functions.Function(f),a.prototype.isContextSensitive=function(){return!0},a.prototype.evaluate=function(a){var b,c=a.source.sj,d=a.source.xc;if(c.d7J()&&(b=c.z6J(d),!e.isNullOrUndefined(b)))return b.level},d.Functions.defineGlobalCustomFunction(f,new a)}b.addLevelCustomFunctions=g},"./dist/src/calculation/functions/hierarchyLevelRowNumber.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),b.addLevelRowNumberCustomFunctions=void 0,d=c("CalcEngine"),e=c("./dist/src/dataSource/utils.js"),f="LEVELROWNUMBER";function g(){function a(){}a.prototype=new d.Functions.Function(f),a.prototype.isContextSensitive=function(){return!0},a.prototype.evaluate=function(a){var b,c=a.source.sj,d=a.source.xc;if(c.d7J()&&(b=c.z6J(d),!e.isNullOrUndefined(b)))return b.getCurrentIndex()+1},d.Functions.defineGlobalCustomFunction(f,new a)}b.addLevelRowNumberCustomFunctions=g},"./dist/src/calculation/functions/hierarchyOnlyChildren.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),b.addOnlyChildrenCustomFunctions=void 0,d=c("CalcEngine"),e=c("./dist/src/dataSource/utils.js"),f="ONLYCHILDREN";function g(){function a(){this.Ci=[{Hi:5}]}a.prototype=new d.Functions.Function(f,1,1),a.prototype.isContextSensitive=function(){return!0},a.prototype.evaluate=function(a,b){var c,f=[],g=a.source.sj,h=a.source.xc;return g.d7J()&&(c=g.z6J(h),e.isNullOrUndefined(c)||e.isNullOrEmpty(b)||(e.traversalTree(c,function(a){if(0===a.children.length){var c=a.mi,d=g._dataSource.J4J(c),e=g._getValueByField(b,d);f.push(e)}}),a.source.xc=h)),new d.CalcArray([f])},d.Functions.defineGlobalCustomFunction(f,new a)}b.addOnlyChildrenCustomFunctions=g},"./dist/src/calculation/functions/hierarchyParent.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),b.addParentCustomFunctions=void 0,d=c("CalcEngine"),e=c("./dist/src/dataSource/utils.js"),f="PARENT";function g(){function a(){this.Ci=[{Hi:3,aj:["< 1","> 999"]},{Hi:5}]}a.prototype=new d.Functions.Function(f,2,2),a.prototype.isContextSensitive=function(){return!0},a.prototype.evaluate=function(a,b,c){var d,f,g,i,j,k=a.source.sj,l=a.source.xc;if(k.d7J()&&(d=k.z6J(l),!e.isNullOrUndefined(d)&&b>0&&!e.isNullOrEmpty(c)&&(f=h(d,b),!f.isRoot)))return g=f.mi,i=k._dataSource.J4J(g),j=k._getValueByField(c,i),a.source.xc=l,j},d.Functions.defineGlobalCustomFunction(f,new a)}b.addParentCustomFunctions=g;function h(a,b){return 0===b||a.isRoot?a:h(a.parent,b-1)}},"./dist/src/calculation/functions/query.js":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0}),b.addQueryFunction=void 0,d=c("CalcEngine"),e="QUERY";function f(){if(!d.Functions.findGlobalFunction(e)){var a=new d.Functions.AsyncFunction(e,1,3);a.isContextSensitive=function(){return!0},a.evaluateAsync=function(a,b,c,e){var f,g=a.ctx.source.kj.parent.dataManager();function h(){var f,h,i,j;(null===(i=null===(h=null===(f=a.ctx)||void 0===f?void 0:f.gkK)||void 0===h?void 0:h.node)||void 0===i?void 0:i.Lf)?(j=g.uQJ(b,c,e),j&&(e?a.setAsyncResult(j[0]):a.setAsyncResult(new d.CalcArray(j)))):g.uQJ(b,c,e,!0)}function i(){var f=g.uQJ(b,c,e,h);f&&(e?a.setAsyncResult(f[0]):a.setAsyncResult(new d.CalcArray(f)))}f=g.M5J(b,c,e),f.table&&f.table.B9J().then(function(){i()})},a.acceptsReference=function(a){return!0},a.acceptsArray=function(a){return!0},d.Functions.defineGlobalCustomFunction(e,a)}}b.addQueryFunction=f},"./dist/src/calculation/functions/scope.js":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),b.addScopeCustomFunctions=void 0,d=c("CalcEngine"),e=c("./dist/src/dataSource/utils.js"),f="CALCULATE",g="REMOVEFILTERS";function h(){function a(){}a.prototype=new d.Functions.Function(f,2,2),a.prototype.isContextSensitive=function(){return!0},a.prototype.isReverseArgs=function(){return!0},a.prototype.evaluate=function(a,b,c){return a.source.oI=b.start,a.source.xc=b.context,c},d.Functions.defineGlobalCustomFunction(f,new a);function b(){}b.prototype=new d.Functions.Function(g,0,255),b.prototype.isContextSensitive=function(){return!0},b.prototype.evaluate=function(a){var b,c,d,e=[];for(b=1;b<arguments.length;b++)e[b-1]=arguments[b];return c={start:a.source.oI,context:a.source.xc},d=a.source.pSJ,a.source.oI=0,a.source.xc=i(d,e),c},d.Functions.defineGlobalCustomFunction(g,new b)}b.addScopeCustomFunctions=h;function i(a,b){var c=j(a.groupOptions.slice(0,a.path.length),b);return k(a.path,c)?a.entireScope:l(a.path,c)}function j(a,b){var c,d;if(b&&b.length>0){for(c=-1,a.reverse(),d=0;d<a.length;d++)if(a[d].field!==b[d]){e.isNullOrUndefined(b[d])&&b.length<=d&&(c=a.length-d-1);break}return c}return-1}function k(a,b){return b===-1||a.length-1<=b}function l(a,b){var c=a[b],d=[];return m(c,d),d}function m(a,b){var c,d,e,f,g,h,i=b.length,j=a.recordIndexes;if(j)for(c=0,d=j.length;c<d;c++)b[i+c]=j[c];else for(e=a.children,f=0,g=e;f<g.length;f++)h=g[f],m(h,b)}},"./dist/src/calculation/queryFunctionResolver.js":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),b.QueryFunctionSolver=void 0,d=c("Common"),e=null,f=d.Common.u.kb;function h(a,b,c){return function(d){var e=[];return e.push(d.xQJ(d.vQJ(a),b||d._dataSource.U,c)),e}}g=function(){function a(){}return a.parseParam=function(b,c,d,g){var i,j=Object.keys(g.tables),k=new a,l=function(a){var i,l,m,n,o=j[a];b===o?(k.getValue=function(a){return a.iNb(e,e,c,d)},k.table=g.tables[o]):f(b,o)&&(k.table=g.tables[o],i=b[o.length],l=b.substr(o.length+1),"#"===i?(m=parseInt(l,10),k.getValue=function(a){var b=[];return b.push(a.xQJ(m,c||a._dataSource.U,d)),b}):"/"===i?k.getValue=h(l,c,d):"?"===i?(n=l.split("=",2),1===n.length?k.getValue=h(l,c,d):k.getValue=function(a){return a.iNb(n[1],n[0],c,d)}):delete k.table)};for(i=0;i<j.length;i++)l(i);return k},a}(),b.QueryFunctionSolver=g},"./dist/src/calculation/tokenResolver.js":function(a,b,c){"use strict";var d,e,f,g,h,i=this&&this.__extends||function(){
var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),b.DataManagerTokenResolver=void 0,d=c("CalcEngine"),e=c("./dist/src/calculation/calcSource.js"),f=c("./dist/src/dataSource/utils.js"),g=function(a){i(b,a);function b(b){var c=a.call(this,14)||this;return c.value=b,c}return b.prototype.gmb=function(a,b){if(this.value instanceof e.DataManagerReference){var c=this.value.table;c.n_J(a,this.value.HL[0],b)}},b}(d.Expression),h=function(a){i(b,a);function b(b){return a.call(this,b)||this}return b.prototype.resolveToken=function(a,b,c,d,f){var h,i,j,k=c[d],l=k.ni,m=a.source,n=m&&m.sj;if(n&&0===k.Nc&&"["===l[0]&&"]"===l[l.length-1]){if(h=new e.DataManagerReference,i=this.UDJ(h,l,1),i===-1)return;if(h.rowString=l.substring(1,i),i=this.VDJ(h,l,i),i===-1)return;return h.table=n,h.HL=h.field,h.field=n.TNJ(h.field),j=new g(h),{expr:j,index:d+1}}},b.prototype.UDJ=function(a,b,c){var d,e,g,h,i=!1;function j(a,c){for(var d=c?a+1:a;b[d]>="0"&&b[d]<="9";)d++;for(;" "===b[d];)d++;return{value:parseInt(b.substring(a,d),10),end:d}}function k(a){for(var c=a;c<b.length&&"["!==b[c]&&"]"!==b[c]&&","!==b[c];)c++;return{type:"key",value:b.substring(a,c).trim(),end:c}}function l(a){var c,d,e=b[a],f=b[a+1];return"@"===e?(i=!0,"+"===f||"-"===f?(c=j(a+1,!0),c.end<=a+1?-1:{num:c.value,end:c.end,relative:!0}):{num:0,end:a+1,relative:!0}):"#"===e?(c=j(a+1),c.end>a+1?{num:c.value,end:c.end,relative:!1}:"last"===b.substr(a+1,4)?{num:-1,end:a+5,relative:!1}:"odd"===b.substr(a+1,3)?{type:"odd",end:a+4}:"even"===b.substr(a+1,4)?{type:"even",end:a+5}:-1):"$"===e?(d=k(a+1),d.end>=b.length?-1:d):-1}for(d=null;c<b.length&&(e=b[c],"["!==e&&"]"!==e);)if(d||"@"!==e&&"#"!==e&&"$"!==e)if(","===e&&d)d=!1,c++;else{if(" "!==e)break;c++}else{if(g=l(c),g===-1)return-1;if(":"!==b[g.end]||f.isNullOrUndefined(g.num))a.row.push(g),c=g.end;else{for(c=g.end+1;" "===b[c];)c++;if(h=l(c),h===-1||f.isNullOrUndefined(h.num))return-1;a.row.push([g,h]),c=h.end}d=!0}return a.jOJ=i,d===!1?-1:c},b.prototype.VDJ=function(a,b,c){var d,e,f;function g(a){for(var c=a;"]"!==b[c];)c++;return{str:b.substring(a,c),end:c}}function h(a){for(var c=a;"."!==b[c]&&"]"!==b[c];)c++;return{str:b.substring(a,c),end:c}}for(d=null;c<b.length;)if(e=b[c],"["!==e||d){if("]"===e)break;if(" "===e)c++;else if("."===e&&d)c++,d=!1;else{if("."===e||d)return-1;f=h(c),a.field.push(f.str),c=f.end,d=!0}}else{if(f=g(c+1),f.end<=c+1)return-1;a.field.push(f.str),c=f.end+1,d=!0}return c===b.length-1?c:-1},b.prototype.unparse=function(){return!1},b}(d.TokenResolver),b.DataManagerTokenResolver=h},"./dist/src/dataManager.entry.js":function(a,b,c){"use strict";var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c),Object.defineProperty(a,d,{enumerable:!0,get:function(){return b[c]}})}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||b.hasOwnProperty(c)||d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),e(c("./dist/src/dataSource/dataSource.entry.js"),b),e(c("./dist/src/table/table.entry.js"),b),e(c("./dist/src/viewField/viewField.entry.js"),b),e(c("./dist/src/view/view.entry.js"),b),e(c("./dist/src/interfaces/interface.js"),b),e(c("./dist/src/interfaces/styleOptions.js"),b),e(c("./dist/src/interfaces/validatorOptions.js"),b),e(c("./dist/src/interfaces/conditionalFormatOptions.js"),b),e(c("./dist/src/dataManager.js"),b)},"./dist/src/dataManager.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o;Object.defineProperty(b,"__esModule",{value:!0}),b.isView=b.DataManager=void 0,d=c("CalcEngine"),e=c("./dist/src/table/table.js"),f=c("./dist/src/view/view.js"),g=c("./dist/src/dataSource/utils.js"),h=c("./dist/src/dataSource/dataSource.js"),i=c("./dist/src/calculation/functions/functions.entry.js"),j=c("./dist/src/calculation/tokenResolver.js"),k=c("./dist/src/calculation/queryFunctionResolver.js"),l=c("./dist/src/relationship.js"),m=null,n=d.Convert.Fh,o=function(){function a(a){this.BXJ={},this.tables={},this.relationships=[],this.wQJ={},a||(a=new d.CalcService),this.updateCalcService(a),i.addCustomFunctions()}return a.prototype.addTable=function(a,b){var c=new e.Table(a,b);return this.tables[a]=c,c.ZDJ(this),c},a.prototype.removeTable=function(a){var b,c=this.tables[a],d=this.relationships;for(b=d.length-1;b>=0;b--)d[b].sourceTable!==c&&d[b].targetTable!==c||(d[b].Fb(),d.splice(b,1));c.ZDJ(m),delete this.tables[a]},a.prototype.addRelationship=function(a,b,c,d,e,f){var g=new l.Relationship(a,b,c,d,e,f);return this.relationships.push(g),g},a.prototype.removeRelationship=function(a){var b,c=this.relationships;for(b=0;b<c.length;b++)if(c[b].sourceRelationshipName===a){c[b].Fb(),c.splice(b,1);break}},a.prototype.updateCalcService=function(a){var b,c,d,e=a.getResolvers(),f=!0;for(b=0,c=e;b<c.length;b++)if(d=c[b],d instanceof j.DataManagerTokenResolver){f=!1;break}f&&a.addResolver(new j.DataManagerTokenResolver(8e3)),this.Wu=a},a.prototype.M5J=function(a,b,c){var d,e;return n(a)?a=a.getValueByIndex(0):g.isString(a)||(a=""+a),g.isString(b)?b=[b]:n(b)?b=b.toArray(0,!0):b&&b.array&&(b=b.array[0]),d=a+"-"+(b&&b.join(",")),e=this.wQJ[d],e||(e=this.wQJ[d]=k.QueryFunctionSolver.parseParam(a,b,c,this)),e},a.prototype.uQJ=function(a,b,c,d){var e,f=this.M5J(a,b,c);function g(){d()}return d===!0&&f.table._dataSource.unbind(h.ONCHANGE,g),d&&f.table&&f.table._dataSource.bind(h.ONCHANGE,g),e=f.getValue?f.getValue(f.table):[[]],0===e.length&&(e=[[]]),e},a.prototype.toJSON=function(){var a,b,c=this.tables,d=[];for(a in c)c.hasOwnProperty(a)&&d.push(c[a].toJSON());return b=this.relationships.map(function(a){return{sourceTableName:a.sourceTable.name,sourceFieldName:a.sourceFieldName,sourceRelationshipName:a.sourceRelationshipName,targetTableName:a.targetTable.name,targetFieldName:a.targetFieldName,targetRelationshipName:a.targetRelationshipName}}),{tables:d,relationships:b}},a.prototype.fromJSON=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this.tables={},q=a.tables;for(b=0,c=q;b<c.length;b++){if(d=c[b],e=d.dataSourceOption.schema,f=e&&e.columns,f)for(g in f)f.hasOwnProperty(g)&&(h=f[g],h&&"date"===h.dataType&&Array.isArray(h.lookup)&&(h.lookup=h.lookup.map(function(a){return new Date(a)})));i=this.addTable(d.name,d.dataSourceOption),i.QWJ=!0,i.fromJSON(d)}for(this.relationships=[],j=a.relationships,k=0,l=j;k<l.length;k++)m=l[k],n=p[m.sourceTableName],o=p[m.targetTableName],this.addRelationship(n,m.sourceFieldName,m.sourceRelationshipName,o,m.targetFieldName,m.targetRelationshipName)},a}(),b.DataManager=o;function p(a){return a instanceof f.View}b.isView=p},"./dist/src/dataSource/dataReader/BasicReader.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),b.BasicReader=void 0,d=c("./dist/src/dataSource/utils.js"),e=void 0,f=function(){function a(a){var b,c,f,g=this;g.i6=a,d.isNullOrUndefined(a)||(g.HL=a.HL,b=a.dataPath,c=a.countPath,f=a.parse,d.isFunction(b)?g.$DJ=b:g.$DJ=function(a){return d.isString(b)&&b?d.LL(a,b):a},d.isFunction(c)?g._DJ=c:g._DJ=function(a){return d.isString(c)&&c?parseInt(d.LL(a,c),10):e},d.isFunction(f)&&(g.parse=f))}return a.prototype.parse=function(a){return this.aEJ=a,Promise.resolve(a)},a.prototype.read=function(a){return Promise.resolve(this.$DJ(a))},a.prototype.total=function(a){return this._DJ(a)},a}(),b.BasicReader=f},"./dist/src/dataSource/dataReader/ColumnJsonReader.js":function(a,b,c){"use strict";var d,e,f,g=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),b.ColumnJsonReader=void 0,d=c("./dist/src/dataSource/dataReader/BasicReader.js"),e=c("./dist/src/dataSource/utils.js"),f=function(a){g(b,a);function b(b){var c=a.call(this,b)||this,d=c,f=b.dataPath;return e.isFunction(f)?d.$DJ=f:d.$DJ=function(a){var b,c,g,h,i,j,k,l;for(a=e.isString(f)?e.LL(a,f):a,b=d.HL=d.HL||e.keys(a),c=d.aEJ=[],g=a[b[0]].length,h=0;h<g;h++){for(i={},j=0,k=b;j<k.length;j++)l=k[j],i[l]=a[l][h];c.push(i)}return c},c}return b.prototype.parse=function(a){var b=this;return new Promise(function(c,d){var f,g;e.isNullOrUndefined(a)&&d("value cannot be null or empty"),f=b.HL=b.HL||e.keys(a),g=e.reduce(f,function(b,c){return b&&e.isArray(a[c])},!0),g||d("The value of each property in column JSON should be an array"),c(a)})},b}(d.BasicReader),b.ColumnJsonReader=f},"./dist/src/dataSource/dataReader/CsvReader.js":function(a,b,c){"use strict";var d,e,f,g=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),b.CsvReader=void 0,d=c("./dist/src/dataSource/dataReader/BasicReader.js"),e=c("./dist/src/dataSource/utils.js"),f=function(a){g(b,a);function b(b){var c=a.call(this,b)||this;return c.bEJ=b.delimiter||['"'],c.vua=b.separator||",",c}return b.prototype.parse=function(a){for(var b,c,d,f,g=this,h=g.bEJ,i=g.vua,j=a.split(""),k=0,l=j.length,m=[];k<l;){for(d=[];k<l&&"\r"!==j[k]&&"\n"!==j[k];){if(b=c=k,e.indexOf(h,j[k])>-1){for(++k,b=c=k;k<l;){if(e.indexOf(h,j[k])>-1){if(e.indexOf(h,j[k+1])===-1)break;++k,j[k]=""}++k,c=k}for(e.indexOf(h,j[k])>-1&&++k;k<l&&"\r"!==j[k]&&"\n"!==j[k]&&i!==j[k];)++k}else for(;k<l&&"\r"!==j[k]&&"\n"!==j[k]&&i!==j[k];)++k,c=k;d.push(j.slice(b,c).join("")),i===j[k]&&++k}"\r"!==j[k]&&"\n"!==j[k]||++k,d.length>0&&m.push(d)}return f=m.shift(),g.aEJ=e.isNullOrUndefined(g.HL)?e.map(m,function(a){return e.zipObject(f,a)}):e.map(m,function(a){return e.pick(e.zipObject(f,a),g.HL)}),g.HL=g.HL||f,Promise.resolve(g.aEJ)},b}(d.BasicReader),b.CsvReader=f},"./dist/src/dataSource/dataReader/JsonReader.js":function(a,b,c){"use strict";var d,e,f=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),b.JsonReader=void 0,d=c("./dist/src/dataSource/dataReader/BasicReader.js"),e=function(a){f(b,a);function b(b){return a.call(this,b)||this}return b}(d.BasicReader),b.JsonReader=e},"./dist/src/dataSource/dataReader/XmlReader.js":function(a,b,c){"use strict";var d,e,f,g=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),b.XmlReader=void 0,d=c("./dist/src/dataSource/dataReader/BasicReader.js"),e=c("./dist/src/dataSource/utils.js"),f=function(a){g(b,a);function b(b){var c=a.call(this,b)||this,d=c,f=b.dataPath;return e.isFunction(f)?d.$DJ=f:d.$DJ=function(a){if(a=e.isString(f)?e.LL(a,f):a,e.isNullOrUndefined(a))return a;var b=d.HL;return b?a=a.map(function(a){return e.pick(a,b)}):c.HL=e.keys(a[0]),a},c}return b.prototype.parse=function(a){var b=new DOMParser,c=b.parseFromString(a.trim(),"text/xml"),d=this.documentToJSObject(c);return Promise.resolve(d)},b.prototype.documentToJSObject=function(a){var b,c,d={},e=a.children;for(b=0,c=e.length;b<c;b++)this.elementToJSObject(e[b],d);return d},b.prototype.elementToJSObject=function(a,b){var c,d,e,f,g,h=a.children,i=h.length,j=a.nodeName;if(0===i)b[j]=a.textContent;else{for(c={},d=b[j],void 0!==d?Array.isArray(d)?b[j].push(c):b[j]=[d,c]:b[j]=c,e=a.attributes,f=0;f<e.length;f++)g=e[f],c[g.nodeName]=g.nodeValue;for(f=0;f<i;f++)this.elementToJSObject(h[f],c)}},b}(d.BasicReader),b.XmlReader=f},"./dist/src/dataSource/dataSource.entry.js":function(a,b,c){"use strict";var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c),Object.defineProperty(a,d,{enumerable:!0,get:function(){return b[c]}})}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||b.hasOwnProperty(c)||d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),e(c("./dist/src/dataSource/dataSource.js"),b),e(c("./dist/src/dataSource/dataSource.interface.js"),b),e(c("./dist/src/dataSource/utils.js"),b)},"./dist/src/dataSource/dataSource.interface.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0})},"./dist/src/dataSource/dataSource.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),z=this&&this.__assign||function(){return z=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},z.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),b.DataSource=b.HierarchyNode=b.ONCHANGE=b.DELETE=b.UPDATE=b.INSERT=b.CREATE=void 0,d=c("./dist/src/dataSource/dataTransport/localDataTransport.js"),e=c("./dist/src/dataSource/dataTransport/remoteDataTransport.js"),f=c("./dist/src/dataSource/event.js"),g=c("./dist/src/dataSource/dataReader/JsonReader.js"),h=c("./dist/src/dataSource/dataReader/ColumnJsonReader.js"),i=c("./dist/src/dataSource/dataReader/CsvReader.js"),j=c("./dist/src/dataSource/dataReader/XmlReader.js"),k=c("./dist/src/dataSource/utils.js"),l=c("Common"),m=null,n=void 0,b.CREATE="create",b.INSERT="insert",b.UPDATE="update",b.DELETE="delete",o="onBeforeSend",p="onFailed",q="onBeforeEnd",r="onReady",s="user cancel the request at step ",b.ONCHANGE="onChange",t=Number.NaN,u="__HIERARCHY__";function A(a){return""+u+a}function B(a){return"string"==typeof a&&a.indexOf(u)>-1}function C(a){return B(a)?n:a}function D(a,b){var c=b;return"odata"!==a&&"odata4"!==a||!b.value?"graphql"!==a&&"rest"!==a||!b.data||(c=b.data):c=b.value,c}function E(a,b){var c,d,e={};for(c in a)a.hasOwnProperty(c)&&(d=b[c],e[c]=k.isNullOrUndefined(d)?a[c]:d);return e}function F(a,b,c,d,e){var f,g,h,i,j,k,l;for("string"==typeof c?f=g=c:(f=c.childrenField1||"children",g=c.childrenField2||"children"),h=a[f]||[],i=b[g]||[],j=0;j<h.length;j++)k=h[j],l=i[j],d&&d(k,l,a,b),F(k,l,c,d,e),e&&e(k,l,a,b)}function G(a,b){var c,d,e,f,g;if(k.isNullOrUndefined(a)||k.isNullOrUndefined(b))return a===b;if(c=Object.keys(a),d=Object.keys(b),c.length!==d.length)return!1;for(e=0,f=c;e<f.length;e++)if(g=f[e],a[g]!==b[g])return!1;return!0}function H(a,b){var c,d,e,f=[];for(c=0;c<b;c++){d={};for(e in a)a.hasOwnProperty(e)&&(d[e]=a[e].data[c]);f[c]=d}return f}function I(a){return"xml"===a?"xml":"csv"===a?"text":"json"}function J(a){var b,c,d,e,f,g,h=null===(b=a.schema)||void 0===b?void 0:b.type,i=a.remote;h&&i&&(c=i.read,c&&"object"==typeof c&&(c.dataType=I(h)),d=i.update,d&&"object"==typeof d&&(d.dataType=I(h)),e=i.delete,e&&"object"==typeof e&&(e.dataType=I(h)),f=i.create,f&&"object"==typeof f&&(f.dataType=I(h)),g=i.batch,g&&"object"==typeof g&&(g.dataType=I(h)))}v=function(){function a(){}return a}(),w=function(a){y(b,a);function b(b){var c,d=a.call(this)||this;return d.oi=[],c=d,c._data=b.data,c.Yzc=b.isRoot,c.U5J=b.getData,c.V5J=b.getFieldData,c.W5J=b.idField,c.X5J=!k.isNullOrUndefined(b.idField),c.Y5J=b.sequenceField,c.Z5J=!k.isNullOrUndefined(b.sequenceField),Object.defineProperty(c,"data",{get:function(){return c.U5J(c.mi)}}),Object.defineProperty(c,"isRoot",{get:function(){return c.Yzc}}),Object.defineProperty(c,"id",{get:function(){if(c.X5J){var a=c.V5J(c.W5J,c.mi);return k.isNullOrUndefined(a)?a=c._id:c._id!==a&&(c._id=a),a}return c._id},set:function(a){c._id=a,k.isNullOrUndefined(c.P7J)&&(c.P7J=a)}}),Object.defineProperty(c,"parentId",{get:function(){return k.isNullOrUndefined(c.parent)?n:c.parent.id}}),Object.defineProperty(c,"parent",{get:function(){return c.hqa},set:function(a){c.setParent(a),k.isNullOrUndefined(c.Q7J)&&!k.isNullOrUndefined(a)&&(c.Q7J=a.id)}}),Object.defineProperty(c,"level",{get:function(){return c.aN},set:function(a){c.aN=a}}),Object.defineProperty(c,"children",{get:function(){return c.oi},set:function(a){c.oi=a}}),Object.defineProperty(c,"sequence",{get:function(){return c.Z5J?c.V5J(c.Y5J,c.mi):c.$5J},set:function(a){c.$5J=a,k.isNullOrUndefined(c.R7J)&&(c.R7J=a)}}),d}return b.prototype.M9J=function(){return this.$5J},b.prototype.setParent=function(a,b){var c=!k.isNullOrUndefined(this.parent);c&&this.parent.a6J(this),this.hqa=a,k.isNullOrUndefined(a)?c&&(this.level=t):(this.level=a.level+1,k.isNullOrUndefined(b)?a.b6J(this):a.c6J(this,b))},b.prototype.updateChildrenLevel=function(){var a=this.level;this.children.forEach(function(b){b.level=a+1,b.updateChildrenLevel()})},b.prototype.promote=function(a){this.setParent(a,this.parent.getCurrentIndex()+1),this.updateChildrenLevel()},b.prototype.demote=function(a,b){this.parent=a,b=b!==!1,b?this.updateChildrenLevel():this.children.forEach(function(b){b.parent=a})},b.prototype.getCurrentIndex=function(){return this.parent.children.indexOf(this)},b.prototype.getPrevSibling=function(){return this.parent.children[this.getCurrentIndex()-1]},b.prototype.getNextSibling=function(){return this.parent.children[this.getCurrentIndex()+1]},b.prototype.c6J=function(a,b){this.children.splice(b,0,a)},b.prototype.b6J=function(a){this.children.push(a)},b.prototype.a6J=function(a){var b=this.children.indexOf(a);this.children.splice(b,1)},b.prototype.getChildrenIndexes=function(a){var b=[];return k.traversalTree(this,{invoked:function(a){b.push(a.mi)}},a?function(a){return-a.sequence}:n),b},b.prototype.getFieldValue=function(a){return this.V5J(a,this.mi)},b}(v),b.HierarchyNode=w,x=function(){function a(a){this.JMJ={},this.d6J=[],this.UlK=!0;var c=this;Object.defineProperty(this,"options",{get:function(){return c.i6},set:function(a){var b,d,e,f,g,h,i,j;J(a),b=c.i6,c.i6=a,d=b&&b.remote&&b.remote.read&&b.remote.read.url,e=a&&a.remote&&a.remote.read&&a.remote.read.url,f=d!==e,c._VJ(a.remote,a.data),g=b&&b.schema,h=a&&a.schema,i=g&&h&&(g.type!==h.type||g.dataPath!==h.dataPath||g.countPath!==h.countPath),i&&c.aWJ(a.schema),j=c.FWJ,j&&(f||i)&&(c.bWJ(),c.load())}}),c._events={},c.options=z({data:m,batch:!1},a),this._VJ(a.remote,a.data),c.bind([o,q,r,b.ONCHANGE,p],a),this.aWJ(a.schema),c.bWJ()}return a.prototype._VJ=function(a,b){this.cEJ=a?new e.RemoteDataTransport(a):new d.LocalDataTransport({data:b||[]})},a.prototype.aWJ=function(a){var b,c;a=a||{},c=a.type||"json","json"===c?b=new g.JsonReader(a):"columnJson"===c?b=new h.ColumnJsonReader(a):"csv"===c?b=new i.CsvReader(a):"xml"===c&&(b=new j.XmlReader(a)),this.dEJ=b},a.prototype.bWJ=function(){this._data={},this.FMJ=0,this.U=[]},a.prototype.GMJ=function(a,b,c){var d,e,f,g=this,h={};for(d in g._data)g._data.hasOwnProperty(d)&&(e=g._data[d],0!==b?(f=e.data.splice(a,b),h[d]={data:f}):a>=e.data.length?e.data[a]=c[d]:e.data.splice(a,0,c[d]));return g.FMJ=g.FMJ-b,c&&g.FMJ++,H(h,b)},a.prototype.HMJ=function(a,b){var c,d,e=this,f={};for(c in e._data)e._data.hasOwnProperty(c)&&(d=e._data[c],f[c]={data:d.data.slice(a,b)});return H(f,b-a)},a.prototype.IMJ=function(a,b,c){var d,e;if(!k.isNullOrUndefined(b))if(d=this,c)for(e in b)Object.prototype.hasOwnProperty.call(d._data,e)&&(d._data[e].data[a]=b[e]);else for(e in d._data)d._data.hasOwnProperty(e)&&(d._data[e].data[a]=b[e])},a.prototype.ojb=function(a){var b,c=this,d={};for(b in c._data)c._data.hasOwnProperty(b)&&(d[b]=c._data[b].data[a]);return d},a.prototype.eEJ=function(a){var b,c,d;return!(!a||!a.reload)||(b=this,c=this.fEJ,d=b.FMJ,0===d||(k.isNullOrUndefined(c)||d!==c,!1))},a.prototype.gBa=function(a,b){var c,d=this.JMJ;return d[a]||(c=void 0,b?c=l.Common.l.Qa(a,b):(c=new Date(a),isNaN(c)&&(c=new Date(a.replace(" ","T")))),d[a]=c),d[a]},a.prototype.WMJ=function(a,b){return b?0===b.split("|").indexOf(a):!!a},a.prototype.XMJ=function(a,b){return b&&(a=a.replace(b,".")),a=a.replace(/,/g,""),+a||0},a.prototype.YMJ=function(a,b,c,d){if("rowOrder"===b)return a;if(d){if(!b||"number"===b)return a;a+=""}return"date"===b?"NULL"===a||""===a?null:this.gBa(a,c):"boolean"===b?this.WMJ(a,c):"number"===b?this.XMJ(a,c):a},a.prototype.o_J=function(a,b){var c="number"==typeof a;return k.isNullOrUndefined(b)||k.isNullOrUndefined(a)||"string"!=typeof a&&!k.isNumber?a:this.YMJ(a,b.dataType,b.dataPattern,c)},a.prototype.KMJ=function(a,b){var c,d,e,f;for(c in a)if(a.hasOwnProperty(c)&&(d=a[c])){if(e=b[c],f="number"==typeof e,k.isNullOrUndefined(e)||"string"!=typeof e&&!f)continue;b[c]=this.YMJ(e,d.dataType,d.dataPattern,f)}},a.prototype.ZMJ=function(a,b,c){var d,e,f,g=this._data[a].data;for(d=0;d<g.length;d++)e=g[d],f="number"==typeof e,k.isNullOrUndefined(e)||"string"!=typeof e&&!f||(g[d]=this.YMJ(e,b,c,f));this.isHierarchy()&&"rowOrder"===b&&(this.UlK=!0)},a.prototype.f4J=function(a,b){var c,d;a===b||k.isNullOrEmpty(b)||(c=this,c._data[b]=c._data[a],delete c._data[a],d=c.b4J(a),c.c4J(a,k.isNullOrEmpty(d)?a:d,b))},a.prototype.b4J=function(a){var b=this,c=b.i6.schema,d,e,f;if(!(k.isNullOrUndefined(c)||k.isNullOrUndefined(c.columns)||(d=c.columns,e=d[a],k.isNullOrUndefined(e)||(f=e.dataName,k.isNullOrEmpty(f)))))return f},a.prototype.c4J=function(a,b,c){var d=this,e=d.i6.schema,f,g;k.isNullOrUndefined(e)&&(d.i6.schema=e={}),f=e.columns,k.isNullOrUndefined(f)&&(e.columns=f={}),g=f[a],k.isNullOrUndefined(g)&&(f[a]=g={}),k.isNullOrEmpty(g.dataName)&&(g.dataName=b),k.isNullOrEmpty(c)||(f[c]=f[a],delete f[a])},a.prototype.e6J=function(a){var b=this;return a=b.p_J(a,{isServerToClient:!0})},a.prototype.f6J=function(a){var b=this;return a=k.clone(a,!0),b.g6J(a),a=b.p_J(a)},a.prototype.p_J=function(a,b){var c,d,e,f,g,h,i;if(b=b||{},c=this,d=c.i6.schema,e=b.isServerToClient,f=b.isClone,!k.isNullOrUndefined(a)&&!k.isNullOrUndefined(d)&&!k.isNullOrUndefined(d.columns)){g=d.columns,h=[];for(i in g)k.isNullOrUndefined(g[i].dataName)||g[i].dataName===i||h.push(e?[g[i].dataName,i]:[i,g[i].dataName]);h.length>0&&(a=f?k.clone(a,!0):a,k.isArray(a)?a.forEach(function(a){c.q_J(h,a)}):k.isObject(a)&&c.q_J(h,a))}return a},a.prototype.q_J=function(a,b){a.forEach(function(a){var c=a[0],d=a[1];b[d]=b[c],delete b[c]})},a.prototype.r_J=function(){var a,b,c,d,e=this,f=e.i6.schema;if(!k.isNullOrUndefined(f)&&!k.isNullOrUndefined(f.columns)){a=f.columns,b={},c={};for(d in a)a.hasOwnProperty(d)&&(k.isNullOrUndefined(a[d].dataName)||(b[a[d].dataName]=d),(a[d].dataType||a[d].dataPattern)&&(c[d]={dataType:a[d].dataType,dataPattern:a[d].dataPattern}));return[b,c]}return[{},{}]},a.prototype.h6J=function(){var a,b,c,d=this,e=d.i6.schema,f=[];if(!k.isNullOrUndefined(e)&&!k.isNullOrUndefined(e.columns)){a=e.columns;for(b in a)a.hasOwnProperty(b)&&(c=a[b],c.isPrimaryKey&&f.push(b))}return f},a.prototype.g6J=function(a){var b,c,d,e=this;!k.isNullOrUndefined(a)&&e.isHierarchy()&&"Level"===e.i6J()&&(b=e.j6J(),k.isNumber(b)&&(c=e.k6J(),d=a[c],a[c]=d-b))},a.prototype.l6J=function(a){var b=this,c=b.d6J;return c.map(function(b,c){b.mi=c,a||(b.sequence=c+1);var d=b._data;return b._data=n,d})},a.prototype.m6J=function(a){var b=this,c=b.n6J,d=b.d6J=[];return k.traversalTree(c,function(a){a.level=a.parent.level+1,d.push(a)},a?{isOrderChildren:!0,getValue:function(a){return a.$5J}}:n),b.l6J(a)},a.prototype.o6J=function(a,b,c,d,e){var f,g,h,i,j,l,m,n,o=this,p=!k.isNullOrEmpty(d),q=b,r=d;for(b=o.p6J(b),c=o.p6J(c),d=o.p6J(d),f={},g=0;g<a.length;g++)h=a[g],i=new w(o.q6J({data:h,idField:q,sequenceField:r})),j=h[b],i.id=j,f[j]=i,p&&(i.sequence=h[d]);for(l=new w({isRoot:!0}),l.level=e-1,g=0;g<a.length;g++)j=a[g][b],m=a[g][c],i=f[j],n=f[m],k.isNullOrUndefined(n)?(l.id=m,i.parent=l):i.parent=n;return o.n6J=l,o.m6J(p)},a.prototype.r6J=function(a,b,c,d,e){var f,g,h,i,j,l,m,o,p,q=this,r=!k.isNullOrEmpty(d),s=b,t=d;for(b=q.p6J(b),c=q.p6J(c),d=q.p6J(d),f=n,g=0;g<a.length;g++)h=a[g][c],(h<f||f===n)&&(f=h);for(i=q.n6J=new w({isRoot:!0}),i.level=f+e-1,j=[i],g=0;g<a.length;g++){for(l=a[g],m=new w(q.q6J({data:l,idField:s,sequenceField:t})),o=k.isNullOrEmpty(b)?A(g):l[b],h=l[c]+e,m.id=o,r&&(m.sequence=l[d]),p=j[j.length-1];p.level>=h;)p=j.pop().parent;m.parent=p,j.push(m)}return q.m6J(r)},a.prototype.s6J=function(a,b,c,d,e){var f,g,h,i=this,j=i.d6J=[],l=!k.isNullOrEmpty(d),m=b,o=d;return b=i.p6J(b),c=i.p6J(c),d=i.p6J(d),g=i.n6J=new w({isRoot:!0}),g.level=e-1,h=[g],k.traversalTree((f={},f[c]=a,f),{invoking:function(a){var c=new w(i.q6J({data:a,idField:m,sequenceField:o}));c.id=k.isNullOrEmpty(b)?A(j.length):a[b],l&&(c.sequence=a[d]),c.parent=h[h.length-1],j.push(c),h.push(c)},invoked:function(){h.pop()}},l?d:n,c),i.l6J(l)},a.prototype.t6J=function(a,b,c,d,e,f){var g,h,i,j,l,m,n,o,p,q=this,r=!k.isNullOrEmpty(e),s=b,t=e;for(b=q.p6J(b),c=q.p6J(c),e=q.p6J(e),g={},h=0;h<a.length;h++)i=a[h],j=new w(q.q6J({data:i,idField:s,sequenceField:t})),l=i[c],j.id=k.isNullOrEmpty(b)?A(h):i[b],g[l]=j,r&&(j.sequence=i[e]);for(m=q.r_J(),n=new w({isRoot:!0}),n.level=f-1,h=0;h<a.length;h++)l=a[h][c],j=g[l],o=d(q.S7J(a[h],m,h)),p=g[o],k.isNullOrUndefined(p)?j.parent=n:j.parent=p;return q.n6J=n,q.m6J(r)},a.prototype.S7J=function(a,b,c){var d=this,e={index:c};return Object.defineProperty(e,"data",{get:function(){var c,e=b[0],f=b[1],g={},h=function(b){var c,h;a.hasOwnProperty(b)&&(c=a[b],h=e[b]||b,Object.defineProperty(g,h,{get:function(){return d.o_J(c,f[h])}}))};for(c in a)h(c);return g}}),e},a.prototype.q6J=function(a){var b=this;return{data:a.data,idField:a.idField,sequenceField:a.sequenceField,getData:b.ojb.bind(b),getFieldData:b.u6J.bind(b)}},a.prototype.v6J=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this,o=n.i6.schema;return n.isHierarchy()&&(c=o.hierarchy.type.trim(),d=null===(b=o.hierarchy.column)||void 0===b?void 0:b.trim(),e=o.hierarchy.levelOffset||0,f=n.h6J(),g=n.w6J(a),"Parent"===c?(h=f[0],i=d,a=n.o6J(a,h,i,g,e)):"Level"===c?(h=f[0],j=d,a=n.r6J(a,h,j,g,e)):"ChildrenPath"===c?(h=f[0],k=d,a=n.s6J(a,h,k,g,e)):"Custom"===c&&(h=f[0],l=d,m=o.hierarchy.parse,a=n.t6J(a,h,l,m,g,e)),n.N9J(),n.UlK=!1),a},a.prototype.N9J=function(){var a,b,c=this,d=c.w6J(),e=c.d6J.slice();for(k.isNullOrEmpty(d)||e.sort(function(a,b){return a.M9J()-b.M9J()}),a=0;a<e.length;a++)b=e[a],b.prev=e[a-1],b.next=e[a+1]},a.prototype.w6J=function(a){var b,c,d,e=this,f=e.i6.schema;if(!k.isNullOrUndefined(f)&&!k.isNullOrUndefined(f.columns)){b=f.columns;for(c in b)if(Object.prototype.hasOwnProperty.call(b,c)&&(d=b[c],"rowOrder"===d.dataType&&(d.EhK||e.FhK(c,a))))return d.EhK=!0,c}},a.prototype.FhK=function(a,b){var c,d,e;if(!k.isNullOrUndefined(a)&&k.isArray(b)){if(0===b.length)return!0;for(c=this,a=c.p6J(a),d=0;d<b.length;d++)if(e=b[d][a],!k.isNullOrUndefined(e))return k.isNumber(e)}},a.prototype.C7J=function(){var a=this;return!!a.isHierarchy()&&("Parent"!==a.i6J()||!k.isNullOrUndefined(a.w6J()))},a.prototype.AaK=function(){return this.options.schema.hierarchy.summaryFields},a.prototype.j6J=function(){return this.options.schema.hierarchy.levelOffset},a.prototype.x6J=function(){return this.options.schema.hierarchy.unparse},a.prototype.k6J=function(){return this.options.schema.hierarchy.column},a.prototype.i6J=function(){return this.options.schema.hierarchy.type},a.prototype.y6J=function(){var a=this.h6J(),b=a[0];return b},a.prototype.isHierarchy=function(){var a,b,c=this.options.schema;return!k.isNullOrUndefined(c)&&!k.isNullOrUndefined(c.hierarchy)&&!k.isNullOrUndefined(null===(a=c.hierarchy.type)||void 0===a?void 0:a.trim())&&!k.isNullOrUndefined(null===(b=c.hierarchy.column)||void 0===b?void 0:b.trim())&&("Custom"!==c.hierarchy.type||k.isFunction(c.hierarchy.parse)&&k.isFunction(c.hierarchy.unparse))},a.prototype.VlK=function(){return this.UlK},a.prototype.WlK=function(){this.UlK=!0},a.prototype.z6J=function(a){var b=this;return a=b.lEJ(a),b.A6J(a)},a.prototype.A6J=function(a){var b=this,c=b.d6J;return c[a]},a.prototype.B6J=function(){return this.n6J},a.prototype.BaK=function(a){var b=this,c=b.AaK();if(!k.isNullOrUndefined(c))return c[a]},a.prototype.CaK=function(a,b){var c,d=this,e=d.BaK(a);if(!k.isNullOrEmpty(e)&&(c=d.z6J(b),!k.isNullOrUndefined(c)&&c.children.length>0))return e},a.prototype.p6J=function(a){var b,c,d=this,e=d.i6.schema;if(!k.isNullOrUndefined(e)&&!k.isNullOrUndefined(e.columns)){b=e.columns;for(c in b)if(c===a)return b[c].dataName||a}return a},a.prototype.C6J=function(a,b,c){var d=this;return d.D6J(c,k.isNumber(a)?d.lEJ(a):a,d.lEJ(b))},a.prototype.D6J=function(a,b,c){var d=this,e=d.d6J,f=d.w6J(),g,h=function(a){return d.isHierarchy()?d.d6J[a].sequence:d._data[f].data[a]};return a?(b=e[c].next&&e[c].next.mi,k.isNullOrUndefined(b)?(g=h(c),Math.floor(g)===g?g+=.5:g=(g+Math.ceil(g))/2):g=(h(c)+h(b))/2):(b=e[c].prev&&e[c].prev.mi,k.isNullOrUndefined(b)?(g=h(c),g=g<=1?g/2:g-.5):g=(h(b)+h(c))/2),g},a.prototype.E6J=function(a,b,c,d){var e,f,g,h,i,j,l,m,o,p,q,r,s,t,u=this,v=u.w6J(),w=u.isHierarchy();if(k.isNullOrUndefined(v)&&!w||b===c||k.isNullOrUndefined(b)||k.isNullOrUndefined(c))return!1;if(c=u.lEJ(c),d=k.isNumber(d)?u.lEJ(d):d,h=u.lEJ(b),i=u.d6J,j=i[h],l=i[c],w){if(l.parent!==j.parent)return!1;m=j.parent.children,o=m.indexOf(j),p=m.indexOf(l),q=0,a=o<p,a?(q=null===(f=j.getNextSibling())||void 0===f?void 0:f.mi,m.splice(p+1,0,j),m.splice(o,1)):(q=h,m.splice(o,1),m.splice(p,0,j)),"Custom"===u.i6J()&&u.H6J(q),k.isNullOrUndefined(d)||(r=i[d],s=j.parent===r,t=j.parent.parent===r.parent,(s||t)&&(d=n))}return g=u.D6J(a,d,c),w&&k.isNullOrUndefined(v)&&(j.sequence=g),u.O9J(a,c,h),u.T7J(h,(e={},e[v]=g,e)),!0},a.prototype.O9J=function(a,b,c){var d,e,f=this,g=f.isHierarchy();g&&(d=f.A6J(k.isNumber(c)?c:f.d6J.length-1),e=f.A6J(b),k.isNullOrUndefined(d.prev)||(d.prev.next=d.next),k.isNullOrUndefined(d.next)||(d.next.prev=d.prev),a?(d.prev=e,d.next=e.next,k.isNullOrUndefined(e.next)||(e.next.prev=d),e.next=d):(d.next=e,d.prev=e.prev,k.isNullOrUndefined(e.prev)||(e.prev.next=d),e.prev=d))},a.prototype.MaK=function(a,b){var c,d=this,e=d.isHierarchy();if(e)for(b=b||1,c=0;c<b;c++)d.NaK(c+a)},a.prototype.NaK=function(a){var b=this,c=b.A6J(a);k.isNullOrUndefined(c.prev)||(c.prev.next=c.next),k.isNullOrUndefined(c.next)||(c.next.prev=c.prev)},a.prototype.F6J=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o;if(this.isHierarchy()&&(e=this,f=e.d6J,g=e.k6J(),a=e.lEJ(a),h=f[a],!h.parent.isRoot)){for(i=e.i6J(),j=h.parent.children.slice(h.getCurrentIndex()+1),k=h.parent.parent,h.promote(k),"Parent"===i?e.T7J(a,(b={},b[g]=C(h.parentId),b)):"Level"===i&&e.G6J(a),l=0,m=j;l<m.length;l++)n=m[l],n.parent=h,o=n.mi,"Parent"===i?e.T7J(o,(c={},c[g]=h.id,c)):"Level"===i&&e.T7J(o,(d={},d[g]=n.level,d));"Custom"===i&&e.H6J(a)}},a.prototype.I6J=function(a,b){this.LaK(a,b)},a.prototype.LaK=function(a,b,c){var d,e,f,g,h,i,j,l,m,n;this.isHierarchy()&&(b=b!==!1,g=this,h=g.d6J,i=g.k6J(),a=c?a:g.lEJ(a),j=h[a],l=j.getPrevSibling(),k.isNullOrUndefined(l)||(m=j.children.slice(),j.demote(l,b),n=g.i6J(),b?"Parent"===n?g.T7J(a,(d={},d[i]=C(j.parentId),d)):"Level"===n?g.G6J(a):"Custom"===n&&g.H6J(a):"Parent"===n?(g.T7J(a,(e={},e[i]=C(j.parentId),e)),m.forEach(function(a){var b;g.T7J(a.mi,(b={},b[i]=C(j.parentId),
b))})):"Level"===n?g.T7J(a,(f={},f[i]=h[a].level,f)):"Custom"===n&&g.H6J(a)))},a.prototype.T7J=function(a,b,c,d){this.U7J(a,b,c,d)},a.prototype.U7J=function(a,c,d,e){var f=this;f.aMJ({action:b.UPDATE,index:a,item:c,t_J:!0,V7J:!0}),d&&d({type:b.UPDATE,success:!0})},a.prototype.G6J=function(a,b,c){var d,e,f,g=this,h=g.d6J,i=g.k6J(),j=h[a].getChildrenIndexes().concat(a);for(e=0;e<j.length;e++)f=j[e],g.T7J(f,(d={},d[i]=h[f].level,d),b,c)},a.prototype.H6J=function(a,b,c){var d=this,e=!1,f=d.k6J();k.traversalTree(d.n6J,function(g){var h,i,j,l;a===g.mi&&(e=!0),e&&(i=g,j=g.mi,l=d.J6J(i),k.isNullOrUndefined(l)||d.T7J(j,(h={},h[f]=l,h),b,c))})},a.prototype.J6J=function(a){var b=this,c=b.k6J(),d=b.x6J(),e=a.data,f=e[c],g=d(b.W7J(a));if(f!==g)return g},a.prototype.W7J=function(a){var b={};return Object.defineProperty(b,"data",{get:function(){return a.data}}),Object.defineProperty(b,"index",{get:function(){return a.getCurrentIndex()}}),Object.defineProperty(b,"parentData",{get:function(){return a.parent.isRoot?m:a.parent.data}}),b},a.prototype.K6J=function(a,b,c){var d=this,e=d.A6J(a);return d.L6J(e.parent,b?e.getCurrentIndex():e.getCurrentIndex()+1,c)},a.prototype.M6J=function(a){var b=this,c=b.A6J(a),d=c.getPrevSibling(),e;return e=k.isNullOrUndefined(d)?b.D6J(!1,n,c.mi):b.D6J(!1,d.mi,c.mi),{sequence:e,offset:0}},a.prototype.N6J=function(a,b){var c,d,e=this;return a=e.lEJ(a),c=e.M6J(a).sequence,d=e.K6J(a,!0,b),d.sequence=c,e.O9J(!1,a),d},a.prototype.O6J=function(a){var b=this,c=b.A6J(a),d=c.getNextSibling(),e;return e=k.isNullOrUndefined(d)?b.D6J(!0,n,c.mi):b.D6J(!0,d.mi,c.mi),{sequence:e,offset:b.P6J(c)}},a.prototype.Q6J=function(a,b){var c,d,e=this;return a=e.lEJ(a),c=e.O6J(a).sequence,d=e.K6J(a,!1,b),d.sequence=c,e.O9J(!0,a),d},a.prototype.R6J=function(a,b){var c,d,e=this;return a=e.lEJ(a),c=e.M6J(a).sequence,d=e.K6J(a,!0,b),d.sequence=c,e.LaK(a,!0,!0),e.O9J(!1,a),d},a.prototype.S6J=function(a){var b,c,d,e=this,f=e.A6J(a),g=f.children;return g.length>0?(d=g[g.length-1],b=e.D6J(!0,n,d.mi),c=e.P6J(f)):(b=e.D6J(!0,n,f.mi),c=1),{sequence:b,offset:c}},a.prototype.T6J=function(a,b){var c,d,e=this;return a=e.lEJ(a),c=e.S6J(a).sequence,d=e.K6J(a,!1,b),d.sequence=c,e.P9J(e.d6J.length-1),e.O9J(!0,a),d},a.prototype.P9J=function(a){var b=this,c=b.A6J(a),d=c.getPrevSibling();k.isNullOrUndefined(d)||c.demote(d)},a.prototype.L6J=function(a,b,c){var d=this,e=d.d6J,f=d.y6J(),g=d.w6J(),h=new w(d.q6J({idField:f,sequenceField:g})),i=d.FMJ+1;return k.isNullOrUndefined(c)||k.isNullOrUndefined(c[f])?h.id=A(i):h.id=c[f],h.mi=i-1,h.setParent(a,b),e.push(h),h},a.prototype.Q9J=function(a){var b,c,d,e,f,g=this,h=g.w6J(),i=g.k6J(),j=g.i6J();return"Parent"===j?(b={},b[i]=C(a.parentId),e=b):"Level"===j?(c={},c[i]=a.level,e=c):"Custom"===j&&(f=g.J6J(a),k.isNullOrUndefined(f)||(d={},d[i]=f,e=d)),k.isNullOrEmpty(h)||(e=e||{},e[h]=a.M9J()),e},a.prototype.V6J=function(a,b,c){var d,e,f=this,g=f.z6J(a);return b?(e=g.getNextSibling(),k.isNullOrUndefined(e)||(d=c===!1?e:g)):d=c===!1?g:g.getPrevSibling(),f.P6J(d)},a.prototype.P6J=function(a){var b,c=1,d=function(a){return a.children.reduce(function(a,b){return a+d(b)},a.children.length)};return k.isNullOrUndefined(a)?0:(b=d(a),b+c)},a.prototype.W6J=function(a){var b=this,c=b.z6J(a);return b.P6J(c)},a.prototype.X6J=function(a){var b,c,d=this;d.isHierarchy()&&(b=d.y6J(),!k.isNullOrUndefined(b)&&B(a[b])&&(a[b]=n),"Parent"===d.i6J()&&(c=d.k6J(),B(a[c])&&(a[c]=n)))},a.prototype.Y6J=function(a){var b,c,d,e,f,g=this;g.isHierarchy()&&"Parent"===g.i6J()&&(b=g.y6J(),k.isNullOrUndefined(b)||(c=g.A6J(a),d=c.children,e=c.id=c.P7J=g.u6J(b,a),f=g.k6J(),d.forEach(function(a){var b;a.Q7J=e,g.updateItemValues(a.mi,(b={},b[f]=e,b))})))},a.prototype.load=function(a){var c=this,d=c.options.remote,e=c.gEJ(a);return c.eEJ(e)?(c.FWJ=!0,c.Vpb(e).then(function(a){var b={type:"read",data:d&&d.read&&!k.isFunction(d.read)?D(d.read.adapter,a):a};return c.Wq(q,b)?Promise.reject({cancel:!0,type:"read",step:o}):c.dEJ.parse(b.data)}).then(function(a){return c.fEJ=c.dEJ.total(a),c.dEJ.read(a)}).then(function(a){var d,f,g,h,i,j,l,m;if(c._data=c._data||{},c.FMJ=c.FMJ||0,c.U=c.U||[],a){for(a=k.isArray(a)?a:[a],a=c.v6J(a),d=0,f=c.r_J(),g=f[0],h=f[1],i=0,j=a.length;i<j;i++)for(l in a[i])m=a[i][l],l=g[l]||l,c._data[l]||(c._data[l]={data:[]},c.U.push(l)),c._data[l].data[d+i]=c.o_J(m,h[l]);c.FMJ=d+a.length,a=c.iEJ(e).data,c.Wq(b.ONCHANGE,{action:b.INSERT,index:d,items:a})}return c.fEJ=c.FMJ,c.Wq(r,{type:"read",success:!0,items:a}),a}).catch(function(a){var b=a&&a.cancel===!0?s+a.step:c.jEJ(a);return c.Wq(r,{type:"read",success:!1,reason:b}),Promise.reject(b)})):Promise.resolve(c.iEJ(e).data)},a.prototype.length=function(){return"number"==typeof this.fEJ?this.fEJ:this.FMJ},a.prototype.setLength=function(a){var b=this,c=b._data,d=b.fEJ;d?this.fEJ=a:c&&(this.FMJ=a)},a.prototype.iEJ=function(a){var b,c=this,d=c.kEJ(),e=0,f=c.FMJ,g=d?c.lEJ(e):0,h=c.mEJ||[];for(d||(h=[]),b=[];f>0&&g<c.FMJ;)h[g]||(b.push(c.ojb(g)),f--),g++;return{data:b}},a.prototype.WNJ=function(a,b){var c,d,e=this,f=e.kEJ(),g=0,h=e.FMJ,i=f?e.lEJ(g):0,j=e.mEJ||[];for(f||(j=[]),c=[],d=0;h>0&&i<e.FMJ;)j[i]||(a.indexOf(d)>-1&&(c[d]=e.ojb(i)),d++,h--),i++;return{data:c}},a.prototype.nEJ=function(a){return a?this.WNJ(a).data:this.iEJ().data},a.prototype.lmK=function(a,b){var c,d,e,f,g,h,i,j=this,l=j.i6J(),m=[];if(k.isNullOrUndefined(b)||a.length!==b.length)return m;if("Level"===l)for(f=0;f<a.length;f++)g=a[f],m.push(E(g,b[f]));else"ChildrenPath"===l&&(h=j.p6J(j.k6J()),i=[(c={},c[h]=m,c)],F((d={},d[h]=a,d),(e={},e[h]=b,e),h,function(a,b){var c,d=E(a,b);delete d[h],c=i[i.length-1],k.isArray(c[h])||(c[h]=[]),c[h].push(d),i.push(d)},function(){i.pop()}));return m},a.prototype.mmK=function(a){var b,c,d,e,f,g,h,i,j,l,m,n,o,p,q,r=this,s=r.i6J();if(!k.isNullOrUndefined(a)){if(e=r.B6J(),h=r.k6J(),"Level"===s){for(f="children",j=r.p6J(h),b={},b[f]=[],b.data={},g=b,l=[g],m=0;m<a.length;m++){for(n=a[m],o=n[j],p=l[l.length-1];p.data.level>=o;)l.pop(),p=l[l.length-1];c={data:n},c[f]=[],q=c,p[f].push(q),l.push(q)}i=function(a){return a.data}}else"ChildrenPath"===s&&(f=h,d={},d[f]=a,g=d,i=function(a){return a});F(e,g,{childrenField2:f},function(a,b){r.e6J(i(b)),r.IMJ(a.mi,i(b))})}},a.prototype.Z6J=function(a,b,c,d){var e=this;return e.qEJ({body:a},b).then(function(d){var f,g="batch"===b,h={type:b,batch:g,data:e.lmK(a,d)};return e.Wq(q,h)?Promise.reject({cancel:!0,type:b,batch:g,step:q}):(a=h.data,e.mmK(a),f={type:b,success:!0,batch:g,items:k.isArray(a)?a:[a]},delete e.pEJ,delete e.mEJ,delete e.oEJ,delete e.w9J,c&&c(f),e.Wq(r,f),g?Promise.resolve(e.iEJ()):n)}).catch(function(a){var c=a&&a.cancel===!0?s+a.step:e.jEJ(a),f={type:b,success:!1,reason:c};e.Wq(p,{type:f}),d&&d(f)})},a.prototype.$6J=function(){var a,b=this;if(b.isHierarchy())return a=b.i6J(),"Level"===a||"ChildrenPath"===a},a.prototype._6J=function(a,b,c,d){var e,f,g,h,i,j,l,m=this,n=m.i6J();return b=b||m.mEJ||[],"Level"===n?(f=m.B6J(),g=[],k.traversalTree(f,function(c){var d,e=c.mi;b[e]||(d=m.ojb(e),("create"===a||"batch"===a&&m.isInserted(e,!0))&&m.X6J(d),d=m.f6J(d),g.push(d))}),m.Z6J(g,a,c,d)):"ChildrenPath"===n?(f=m.B6J(),h=m.k6J(),i=m.p6J(h),j=[],l=[(e={},e[i]=j,e)],k.traversalTree(f,{invoking:function(c){var d,e,f=c.mi;b[f]||(d=m.ojb(f),("create"===a||"batch"===a&&m.isInserted(f,!0))&&m.X6J(d),delete d[h],d=m.f6J(d),l.length>0&&(e=l[l.length-1],k.isArray(e[i])||(e[i]=[]),e[i].push(d)),l.push(d))},invoked:function(a){b[a.mi]||l.pop()}}),m.Z6J(j,a,c,d)):Promise.resolve(void 0)},a.prototype.a7J=function(){var a,b,c,d,e,f,g,h,i,j,l,o=this;if(o.isHierarchy()){for(b=o.d6J,c=o.B6J(),d=b.reduce(function(a,b){return a[b.P7J]=b,b.id=b.P7J,b.sequence=b.R7J,b.parent=m,a},(a={},a[c.P7J]=c,a)),e=0;e<b.length;e++)o.isInserted(e,!0)||(f=b[e],f.parent=d[f.Q7J]);if(g=o.options.schema.hierarchy.levelOffset||0,c.level=g-1,"Level"===o.i6J()){for(h=o.k6J(),i=n,e=0;e<b.length;e++)o.isInserted(e,!0)||(j=o.AWJ(e)[h],k.isNumber(j)||(j=o.u6J(h,e)),(j<i||i===n)&&(i=j));c.level=i+g-1}o.d6J=[],l=!k.isNullOrEmpty(o.w6J()),o.m6J(l)}},a.prototype.cancelChanges=function(){var a,c,d,e,f=this,g=f.getHeldActions();g&&0!==g.length&&(f.a7J(),a=f.oEJ,c=f.mEJ||[],d=f.pEJ||[],e=[],k.forEach(g,function(g){var h=g.sourceIndex,i=g.type;i===b.UPDATE?(f.IMJ(h,a[h]),d[h]=[!!d[h]&&d[h][0],!1]):i===b.DELETE?(c[h]=n,d[h]&&d[h][0]?e.push(h):d[h]&&d[h][1]&&(f.IMJ(h,a[h]),d[h]=[!1,!1]),k.isNullOrUndefined(f.fEJ)||(f.fEJ+=1)):i===b.INSERT&&e.push(h)}),k.forEachRight(e,function(a){f.GMJ(a,1),d.splice(a,1),k.isNullOrUndefined(f.fEJ)||(f.fEJ-=1)}),f.clearBatchCache_())},a.prototype.getChanges=function(){return this.I4J(!1)},a.prototype.isDataLengthChanged=function(){return this.getChanges().some(function(a){return"delete"===a.type||"insert"===a.type})},a.prototype.submitChanges=function(a){var c,d,e,f,g,h,i,j=this;return j.hasCachedActions()?j.$6J()?(c=(j.mEJ||[]).slice(),j._6J("batch",n,function(){for(var a=j.FMJ-1;a>=0;a--)c[a]===!0&&(j.GMJ(a,1),j.d6J[a].parent=m,j.d6J.splice(a,1));j.d6J.forEach(function(a,b){a.mi=b})})):(d=j.oEJ,e=j.mEJ||[],f=j.pEJ||[],g=j.getHeldActions(),h=[],i=b.UPDATE,k.isNullOrUndefined(g)||g.forEach(function(a){a.dataItem=j.f6J(a.dataItem),a.oldDataItem=j.f6J(a.oldDataItem)}),j.qEJ({body:g},"batch").then(function(c){var l,o,r,s={type:i,batch:!0,data:c};return j.Wq(q,s)?Promise.reject({cancel:!0,type:i,batch:!0,step:q}):(l=s.data,(l||[]).forEach(function(a){a.succeed&&a.data&&j.e6J(a.data)}),l.length!==g.length,o=[],k.forEach(g,function(a,c){var e=l[c];e.succeed?a.type===b.UPDATE?(d&&(d[a.sourceIndex]=n),f[a.sourceIndex][1]=n):a.type===b.INSERT?(f[a.sourceIndex]=[],d[a.sourceIndex]=n,e.data&&(j.IMJ(a.sourceIndex,e.data),j.Y6J(a.sourceIndex))):a.type===b.DELETE&&h.push(a.sourceIndex):o.push({localAction:a,response:e})}),k.forEachRight(h,function(a){e.splice(a,1),j.GMJ(a,1),d&&d.splice(a,1),f.splice(a,1),j.isHierarchy()&&(j.d6J[a].parent=m,j.d6J.splice(a,1))}),j.isHierarchy()&&j.d6J.forEach(function(a,b){a.mi=b}),o.length>0?(r={type:i,errorData:o},j.Wq(p,{type:r})||(j.w9J=[],k.forEach(o,function(c,d){var f=c.response,g=c.localAction,h=g.sourceIndex;g.type===b.DELETE&&(e[h]=n),j.x9J(h,{type:g.type,success:!1,reason:f.reason}),a(h,f.reason,g.type)}))):delete j.w9J,Promise.resolve(j.iEJ()))}).catch(function(a){var b=a&&a.cancel===!0?s+a.step:j.jEJ(a),c={type:i,reason:b};j.Wq(p,{type:c})})):Promise.resolve(void 0)},a.prototype.getHeldActions=function(){var a=this;return a.hasCachedActions()?a.I4J(!0):m},a.prototype.I4J=function(a){var c,d,e,f,g,h,i=this,j=[],k=i.pEJ||[],l=i.mEJ||[],m=i.oEJ;for(e=0;e<i.FMJ;e++){if(c=k[e],d=null,l[e]===!0)d={type:b.DELETE,dataItem:i.ojb(e)};else if(c&&c[0])d={type:b.INSERT,dataItem:i.ojb(e)},a&&i.isHierarchy()&&i.X6J(d.dataItem);else if(c&&c[1]){if(f=m[e],g=i.ojb(e),!a){f=z({},f);for(h in f)f.hasOwnProperty(h)&&f[h]===g[h]&&(delete f[h],delete g[h])}d={type:b.UPDATE,dataItem:g,oldDataItem:f}}d&&(a?d.sourceIndex=e:d.index=this.J4J(e),j.push(d))}return j},a.prototype.clearBatchCache_=function(){var a=this;delete a.mEJ,delete a.oEJ,delete a.w9J},a.prototype.hasCachedActions=function(){var a,b,c,d,e,f,g,h,i=this;if(!i.kEJ())return!1;if(a=i.pEJ,b=i.mEJ,!a&&!b)return!1;if(b)for(c=0,d=b;c<d.length;c++)if(e=d[c])return!0;if(a)for(f=0,g=a;f<g.length;f++)if(h=g[f],h&&(h[0]===!0||h[1]===!0))return!0;return!1},a.prototype.bind=function(a,b){var c,d,e,g,h,i,j=this;if(b)for(c=k.isArray(a)?a:[a],d=0,e=c;d<e.length;d++)g=e[d],h=k.isFunction(b)?b:b[g],h&&(i=j._events[g]=j._events[g]||new f.Event,i.addHandler(h,j))},a.prototype.unbind=function(a,b){var c,d=this;return k.isNullOrUndefined(a)?(k.forEach(d._events,function(a){a.removeAllHandlers()}),void(d._events={})):(c=d._events[a],void(c&&(b?c.removeHandler(b,d):c.removeAllHandlers())))},a.prototype.Wq=function(a,b){var c=this,d=c._events[a];return!!d&&(b=b||{},b.cancel=!1,b.eventName=a,d.raise(c,b),b.cancel)},a.prototype.s_J=function(a){var b=this;return b._events.hasOwnProperty(a)&&b._events[a].hasHandlers},a.prototype.gEJ=function(a){return a=z({},a)},a.prototype.rEJ=function(a){return a},a.prototype.getDirtyIndexes=function(){var a=this,b=a.pEJ||[];return Object.keys(b).map(function(a){return parseInt(a,10)})},a.prototype._LJ=function(a,b){var c=this,d=c.pEJ||[];return a=b?a:c.lEJ(a),d[a]||[]},a.prototype.isInserted=function(a,b){return this._LJ(a,b)[0]},a.prototype.isUpdated=function(a){return this._LJ(a)[1]},a.prototype.getErrorInfo=function(a){var b=this,c=b.w9J;if(!k.isNullOrUndefined(c))return a=b.lEJ(a),c[a]},a.prototype.x9J=function(a,b){var c=this,d=c.w9J=c.w9J||[];d[a]=b},a.prototype.o5J=function(){this.pEJ=n,this.mEJ=n,this.oEJ=n,this.w9J=n},a.prototype.AWJ=function(a){var b=this,c=b.oEJ=b.oEJ||[];return c[a]},a.prototype.insertItem=function(a,c,d,e){var f=this;a=f.lEJ(a),f.aMJ({action:b.INSERT,index:a,item:c,V7J:!0}),f.isHierarchy()&&"Custom"===f.i6J()&&f.H6J(a),d&&d({type:b.CREATE,success:!0})},a.prototype.updateItem=function(a,c,d,e){var f=this;f.aMJ({action:b.UPDATE,index:a,item:c}),d&&d({type:b.UPDATE,success:!0})},a.prototype.updateItemValues=function(a,c,d,e){var f=this;f.aMJ({action:b.UPDATE,index:a,item:c,t_J:!0}),d&&d({type:b.UPDATE,success:!0})},a.prototype.resetItem=function(a,c,d){var e,f=this,g=f.oEJ=f.oEJ||[];a=f.lEJ(a),e=g[a],f.isHierarchy()&&(e=f.X7J(a,e)),f.IMJ(a,e),f.clearChangedStatus(a),f.x9J(a),c&&c({type:b.UPDATE,success:!0})},a.prototype.X7J=function(a,b){var c,d,e,f,g,h=this,i=h.isHierarchy();return i?(c=h.ojb(a),d=h.i6J(),e=h.k6J(),f=h.w6J(),g=z({},b),"Parent"!==d&&"Level"!==d&&"Custom"!==d||(g[e]=c[e]),k.isNullOrEmpty(f)||(g[f]=c[f]),g):b},a.prototype.saveItem=function(a,c,d){var e,f,g,h,i,j,k,l=this;if(a=l.lEJ(a),e=l.pEJ||[],f=e[a]||[],g=f[0],h=f[1],f.length>0&&(g||h)){if(l.isHierarchy()&&(i=l.d6J,j=i[a].parent,k=!j.isRoot&&e[j.mi]&&e[j.mi][0],k))return void(d&&d({type:b.CREATE,success:!1}));l.gMJ(a,l.ojb(a),g?b.INSERT:b.UPDATE,c,d)}},a.prototype.gMJ=function(a,c,d,e,f){var g=this,h=d===b.INSERT,i=h?b.CREATE:b.UPDATE,j=g.kEJ(),k=g.tEJ(i),l=g.hEJ();return j||!k||l?void(l&&(g.pEJ[a]=[],g.oEJ[a]=n,e&&e({type:i,success:!0}))):g.$6J()?void g._6J(h?b.CREATE:b.UPDATE,n,e,f):(h&&g.X6J(c),c=g.f6J(c),void g.qEJ({body:c},h?b.CREATE:b.UPDATE).then(function(d){var f,h={type:i,data:E(c,d)};return g.Wq(q,h)?Promise.reject({cancel:!0,type:i,step:q}):(g.e6J(h.data),g.IMJ(a,h.data),g.pEJ[a]=[],g.oEJ[a]=n,g.x9J(a),f={type:i,success:!0,items:[h.data]},i===b.CREATE&&g.Y6J(a),e&&e(f),g.Wq(r,f),n)}).catch(function(b){var c=b&&b.cancel===!0?s+b.step:g.jEJ(b),d={type:i,success:!1,reason:c};g.x9J(a,d),g.Wq(p,{type:d}),f(d)}))},a.prototype.aMJ=function(a){var c,d,e,f,g,h,i,j,l,m=this,o=m.kEJ(),p=m.oEJ=m.oEJ||[];o&&(c=m.mEJ=m.mEJ||[]),d=a.action,e=a.index,f=a.item,g=a.t_J,h=a.V7J,e=h?e:m.lEJ(e),m.pEJ=m.pEJ||[],i=m.pEJ,d===b.INSERT?(0===m.FMJ&&0===m.U.length&&m.mXJ(),m.FMJ<e&&(m.FMJ=e),j=e,k.isNullOrUndefined(j)&&(j=m.FMJ),m.GMJ(j,0,f),p.length>=e?p.splice(e,0,z({},f)):p[e]=z({},f),o&&(c.length>=e?c.splice(e,0,n):c[e]=n),i.length>=e?i.splice(e,0,[!0]):i[e]=[!0],k.isNullOrUndefined(m.fEJ)||(m.fEJ+=1),m.Wq(b.ONCHANGE,{action:d,index:e,items:[a.item]})):d===b.UPDATE&&(l=m.ojb(e),p[e]||(p[e]=z({},l)),m.IMJ(e,f,g),m.pEJ[e]?m.pEJ[e]=[m.pEJ[e][0],!0]:m.pEJ[e]=[!1,!0],G(f,p[e])&&m.clearChangedStatus(e),m.Wq(b.ONCHANGE,{action:d,index:e,items:[a.item],oldItems:[l]}))},a.prototype.clearChangedStatus=function(a){var b=this;b.pEJ[a][1]=!1,b.pEJ[a][0]!==!0&&(b.oEJ[a]=n)},a.prototype.get=function(a){var b,c,d,e,f=this,g=f._data;if(a=f.lEJ(a),g&&a<f.FMJ){for(b={},c=0,d=f.U;c<d.length;c++)e=d[c],b[e]=g[e].data[a];return b}return n},a.prototype.u6J=function(a,b){var c=this,d=c._data;return d&&d[a]&&b<c.FMJ?d[a].data[b]:n},a.prototype.getFieldValue=function(a,b){var c=this,d=c._data;return b=c.lEJ(b),d&&d[a]&&b<c.FMJ?d[a].data[b]:n},a.prototype.getFieldOriginalValue=function(a,b){var c,d=this,e=d._data;return b=d.lEJ(b),e&&e[a]&&b<d.FMJ?(c=d.AWJ(b),k.isNullOrUndefined(c)?e[a].data[b]:c[a]):n},a.prototype.b7J=function(a,c,d){var e,f,g,h,i,j,l=this,m=l.kEJ()||!l.tEJ(b.DELETE)||l.hEJ()||l.isInserted(a);return!m&&l.$6J()?(a=l.lEJ(a),e=l.A6J(a),f=e.getChildrenIndexes(!0).concat(a),g=f.reduce(function(a,b){return a[b]=!0,a},[]),h=function(){f.forEach(function(a){l.aW(a,1,!1)}),l.d6J.forEach(function(a,b){a.mi=b})},l.bind(q,h),void l._6J(b.DELETE,g,function(a){l.unbind(q,h),a.removedCount=f.length,c&&c(a)},function(a){l.unbind(q,h),d&&d(a)})):void(l.isHierarchy()&&(a=l.lEJ(a),e=l.A6J(a),i=e.getChildrenIndexes(!0).concat(a),j=i.map(function(a){return function(b,c){l.Ola(a,1,b,c)}}),k.promiseSerialExecute(j).then(function(b){l.kEJ()||(i.sort(function(a,b){return b-a}),i.forEach(function(a){l.aW(a,1,!1)}),l.d6J.forEach(function(a,b){a.mi=b})),"Custom"===l.i6J()&&l.H6J(a+(l.kEJ()?i.length:0));var d=b[b.length-1];d.removedCount=i.length,c&&c(d)}).catch(function(a){d&&d(a)})))},a.prototype.remove=function(a,b,c,d){var e=this;e.isHierarchy()?e.b7J(a,c,d):e.Ola(a,b,c,d)},a.prototype.Ola=function(a,c,d,e){var f,g,h,i=this;a<0||a>=i.length()||(f=b.DELETE,i.kEJ()||!i.tEJ(b.DELETE)||i.hEJ()||i.isInserted(a)?(!i.kEJ()&&i.isHierarchy()||i.aW(a,c),g={type:f,success:!0},d&&d(g)):(h=i.HMJ(a,a+c),i.p_J(h),i.qEJ({body:h},b.DELETE).then(function(b){if(i.Wq(q,{type:f,data:h}))return Promise.reject({cancel:!0,type:f,step:q});i.isHierarchy()||i.aW(a,c),i.p_J(h,{isServerToClient:!0}),i.x9J(a);var e={type:f,success:!0,items:[h]};return d&&d(e),i.Wq(r,e),n}).catch(function(b){var c=b&&b.cancel===!0?s+b.step:i.jEJ(b),d={type:f,success:!1,reason:c};i.x9J(a,d),i.Wq(p,{type:d}),e(d)})))},a.prototype.aW=function(a,c,d){var e,f,g,h,i,j,l,n,o=this,p=o.kEJ(),q=o.pEJ||[],r=o.oEJ||[];if(p){for(f=void 0,g=o.mEJ=o.mEJ||[],h=c,i=[],e=[],f=o.lEJ(a),o.isHierarchy()&&(j=o.d6J,j[f].parent=m,o.MaK(a,c)),l=f;l<o.FMJ&&(g[l]!==!0&&e.length<c&&(e.push(o.ojb(l)),i.push(l),g[l]=!0,h-=1),0!==h);l++);k.forEachRight(i,function(a){q[a]&&q[a][0]&&(g.splice(a,1),q.splice(a,1),r.splice(a,1),o.GMJ(a,1))})}else e=o.GMJ(a,c),q.splice(a,c),r.splice(a,c),o.isHierarchy()&&(j=o.d6J,j[a].parent=m,o.MaK(a,c),j.splice(a,c),d!==!1&&j.forEach(function(a,b){a.mi=b}));n=e.length,k.isNullOrUndefined(o.fEJ)||(o.fEJ-=n,o.fEJ=Math.max(o.fEJ,0)),o.Wq(b.ONCHANGE,{action:b.DELETE,items:e})},a.prototype.mXJ=function(){var a,b,c=this,d=null===(a=c.options.schema)||void 0===a?void 0:a.columns;if(d)for(b in d)Object.prototype.hasOwnProperty.call(d,b)&&(c._data[b]={data:[]},c.U.push(b))},a.prototype.hEJ=function(){return k.isNullOrUndefined(this.options.remote)},a.prototype.kEJ=function(){var a=this.options;return(a.batch||!1)&&!this.hEJ()},a.prototype.tEJ=function(a){var b=this,c=b.options,d=b.cEJ;return!!c.autoSync&&!k.isNullOrUndefined(d.i6[a])},a.prototype.qEJ=function(a,c){var d=this,e=c||b.UPDATE;return a=d.cEJ.setupRequestOptions(a,c||b.UPDATE),a?d.Wq(o,{type:e,requestParams:a})?Promise.reject({cancel:!0,type:e,step:o}):d.cEJ.postData(a):Promise.reject({cancel:!0,type:e,step:o})},a.prototype.Vpb=function(a){var b=this;return a=b.rEJ(a),a=b.cEJ.setupRequestOptions(a,"read"),a?b.Wq(o,{type:"read",requestParams:a})?Promise.reject({cancel:!0,type:"read",step:o}):b.cEJ.getData(a):Promise.reject({cancel:!0,type:"read",step:o})},a.prototype.jEJ=function(a){return k.isString(a)?a:a instanceof Error?a.message:"some error happened"},a.prototype.lEJ=function(a){var b,c,d,e,f=this.mEJ;if(k.isNullOrUndefined(f)||0===f.length)return a;for(b=0,c=0,d=0,e=f.length;d<=e;d++)if(f[d])c+=1;else{if(b===a)break;b+=1}return a+c},a.prototype.J4J=function(a){var b,c,d=this.mEJ;if(k.isNullOrUndefined(d)||0===d.length)return a;for(b=0,c=Math.min(d.length,a);b<=c;b++)d[b]&&(a-=1);return a},a}(),b.DataSource=x},"./dist/src/dataSource/dataTransport/localDataTransport.js":function(a,b,c){"use strict";var d,e=this&&this.__assign||function(){return e=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},e.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),b.LocalDataTransport=void 0,d=function(){function a(a){a&&(this._data=a.data,this.i6=e({},a))}return a.prototype.getData=function(a){var b=this;return Promise.resolve(b._data)},a.prototype.postData=function(a){var b=this;return Promise.resolve(b._data)},a.prototype.setupRequestOptions=function(a,b){return{}},a}(),b.LocalDataTransport=d},"./dist/src/dataSource/dataTransport/remoteDataTransport.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__assign||function(){return o=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},o.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),b.RemoteDataTransport=void 0,c("./node_modules/whatwg-fetch/fetch.js"),d=c("./node_modules/fetch-jsonp/build/fetch-jsonp.js"),e=c("./dist/src/dataSource/utils.js"),f=null,g=void 0,h="jsonp",i="read",j="create",k="update",l="delete",m="Content-Type",n=function(){function a(a){var b=this;b.i6=o({},a)}return a.prototype.getData=function(a){var b=this,c=this,f=c.i6[a.requestType],i=a.dataType,j=i===h?d:fetch;return a.requestData=g,a.requestType=g,e.isFunction(f)?f(a):j(a.url,a).then(function(a){if(!a.ok)throw a;return b.uEJ(i)?a.json():a.text()})},a.prototype.postData=function(a){var b=this,c=this,d=c.i6[a.requestType],f=a.dataType,h=a.requestData;return a.requestData=g,a.requestType=g,e.isFunction(d)?d(h,a):fetch(a.url,a).then(function(a){if(!a.ok)throw a;return b.uEJ(f)?a.json():a.text()})},a.prototype.uEJ=function(a){return void 0===a||"json"===a||a===h},a.prototype.setupRequestOptions=function(a,b){var c,d,e,f,g,n,p;if(a=a||{},c=this,d=c.i6[b],d)return e=d.body,f=a.body,f?(a.headers=a.headers||{},c.i6.dataConverter?(a.body=f=c.i6.dataConverter(f,b||i),a.headers[m]="application/plain;"):(a.body="string"==typeof f?f:JSON.stringify(f),a.headers[m]="application/json; charset=utf-8")):e&&(a.body="string"==typeof e?e:JSON.stringify(e),a.headers={},a.headers[m]="application/json; charset=utf-8"),p=d.method,b===i?(d.dataType===h&&(g={mode:"no-cors"}),n={method:p||"GET"}):b===j||b===k||"batch"===b?n={method:p||"POST"}:b===l&&(n={method:p||"DELETE"}),o(o(o(o(o({},d),n),g),a),{requestType:b,requestData:f})},a}(),b.RemoteDataTransport=n},"./dist/src/dataSource/event.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),b.Event=b.EventHandler=void 0,d=function(){function a(a,b,c){var d=this;d.handler=a,d.owner=b,d.priority=c}return a}(),b.EventHandler=d,e=null,f=function(){function a(){this.qwa=[]}return Object.defineProperty(a.prototype,"hasHandlers",{get:function(){return this.qwa.length>0},enumerable:!1,configurable:!0}),a.prototype.addHandler=function(a,b,c){void 0===c&&(c=1);var e=this,f=new d(a,b,c);e.qwa.push(f),e.sortHandlers()},a.prototype.removeHandler=function(a,b){var c,d,e=this,f=e.qwa,g=f.length;for(c=0;c<g;c++)if(d=f[c],d.handler===a&&d.owner===b){e.qwa.splice(c,1);break}},a.prototype.sortHandlers=function(){this.qwa.sort(function(a,b){var c=a.priority,d=b.priority;return c<d?1:c>d?-1:0})},a.prototype.removeHandlersByPriority=function(a){var b,c,d=this,f=d.qwa,g=f.length,h=e,i=e;for(b=0;b<g;b++)if(c=f[b],c.priority===a)h===e&&(h=b),i=b;else if(h!==e)break;h!==e&&i!==e&&d.qwa.splice(h,i-h+1)},a.prototype.removeAllHandlers=function(){this.qwa.length=0},a.prototype.raise=function(a,b){var c,d,f,g,h,i=!1,j=function(){i=!0};for(b===e?b={stopPropagation:j}:b.stopPropagation=j,c=this,d=c.qwa.length,f=c.qwa.slice(0,d),g=0;g<d&&!i;g++)h=f[g],h.handler.call(h.owner,a,b)},a}(),b.Event=f},"./dist/src/dataSource/utils.js":function(a,b,c){"use strict";var d,e,f,g,h,i=this&&this.__spreadArrays||function(){var a,b,c,d,e,f,g,h;for(a=0,b=0,c=arguments.length;b<c;b++)a+=arguments[b].length;for(d=Array(a),e=0,b=0;b<c;b++)for(f=arguments[b],g=0,h=f.length;g<h;g++,e++)d[e]=f[g];return d};Object.defineProperty(b,"__esModule",{value:!0}),b.getUniqueArray=b.LL=b.format=b.promiseAllSerial=b.promiseSerialExecute=b.traversalTree=b.bubbleTree=b.swapArrayItems=b.getActualType=b.isNullOrEmpty=b.isNullOrUndefined=b.isNull=b.isUndefined=b.map=b.pick=b.isString=b.zipObject=b.clone=b.findIndex=b.indexOf=b.reduce=b.keys=b.forEachRight=b.forEach=b.isBoolean=b.isNumber=b.isFunction=b.isObject=b.isArray=void 0,d=c("Common"),e=c("CalcEngine"),f=d.Common.CultureManager,g=d.Common.o,h=d.Common.l,b.isArray=Array.isArray;function j(a){return a&&!b.isArray(a)&&"object"==typeof a}b.isObject=j;function k(a){return"function"==typeof a}b.isFunction=k;function l(a){return"number"==typeof a}b.isNumber=l;function m(a){return"boolean"==typeof a}b.isBoolean=m;function n(a,c){var d,e,f,g,h;if(b.isArray(a))for(d=0;d<a.length;d++)c(a[d],d,a);else for(e=Object.keys(a),f=0,g=e;f<g.length;f++)h=g[f],c(a[h],h,a)}b.forEach=n;function o(a,c){var d,e,f,g,h;if(b.isArray(a))for(d=a.length-1;d>=0;d--)c(a[d],d,a);else for(e=Object.keys(a),e.reverse(),f=0,g=e;f<g.length;f++)h=g[f],c(a[h],h,a)}b.forEachRight=o;function p(a){return Object.keys(a)}b.keys=p;function q(a,c,d){if(b.isArray(a))return a.reduce(c,d);throw Error("NOT SUPPORT")}b.reduce=q;function r(a,b,c){return void 0===c&&(c=0),a.indexOf(b,c)}b.indexOf=r;function s(a,b){for(var c=0,d=a.length;c<d;c++)if(b(a[c],c,a))return c;return-1}b.findIndex=s;function t(a,b){var c,d,e,f,g,h,i;if(void 0===b&&(b=!1),A(a)||"object"!=typeof a)return a;if(a&&a instanceof Array)return a.map(function(a){return t(a,b)});if(a&&"object"==typeof a){for(c={},d=p(a),e=0,f=d;e<f.length;e++)g=f[e],h=a[g],b?(i=C(h),"object"===i||"array"===i?c[g]=t(h,b):c[g]=h):c[g]=h;return c}return a}b.clone=t;function u(a,b){var c,d,e;for(void 0===a&&(a=[]),void 0===b&&(b=[]),c={},d=Math.min(a.length,b.length),e=0;e<d;e++)c[a[e]]=b[e];return c}b.zipObject=u;function v(a){return"string"==typeof a}b.isString=v;function w(a,b){var c,d,e,f;if(v(b))return a[b];for(c={},d=0,e=b;d<e.length;d++)f=e[d],c[f]=a[f];return c}b.pick=w;function x(a,c){if(b.isArray(a))return a.map(c);throw Error("NOT SUPPORT")}b.map=x;function y(a){return void 0===a}b.isUndefined=y;function z(a){return null===a}b.isNull=z;function A(a){return y(a)||z(a)}b.isNullOrUndefined=A;function B(a){return""===a||A(a)}b.isNullOrEmpty=B;function C(a){var b=Object.prototype.toString.call(a);return b.match(/\[\w+\s(\w+)\]/)[1].toLowerCase()}b.getActualType=C;function D(a,b,c,d){b<0||b>a.length||c<0||c>a.length||b===c||d<=0||a.splice.apply(a,i([c-(b<c?d-1:0),0],a.splice(b,d)))}b.swapArrayItems=D;function E(a,b){var c=a.parent;c&&(b(c),E(c,b))}b.bubbleTree=E;function F(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o=a[d||"children"]||[];for(B(c)?e=o.slice():(h=void 0,i=void 0,"string"==typeof c?f=c:"function"==typeof c?g=c:"object"==typeof c&&(f=c.field,g=c.getValue,h=c.compareFn,i=c.isOrderChildren),e=i?o:o.slice(),f?e.sort(function(a,b){return a[f]-b[f]}):g?e.sort(function(a,b){return g(a)-g(b)}):h&&e.sort(h)),j=b,"object"==typeof b&&(j=b.invoking,k=b.invoked),m=0;m<e.length;m++){if(n=e[m],j&&(l=j(n,a),l&&l.cancel))return l;if(l&&l.cancelDeepRecursion||(l=F(n,b,c,d)),l&&l.cancel)return l;if(k&&(l=k(n,a),l&&l.cancel))return l}}b.traversalTree=F;function G(a){return a}function H(a){return void 0===a&&(a=0),new Promise(function(b,c){setTimeout(function(){b("timeout")},a)})}function I(a){var b=a.callback,c=a.timeout,d=void 0===c?5e3:c,e=a.retryCount,f=void 0===e?1:e;return Promise.race([b(),H(d)]).then(function(a){if("timeout"===a){if(f>0)return--f,I({callback:b,retryCount:f});throw"timeout"}return Promise.resolve(a)})}function J(a,b){return K(a.map(function(a){return function(){return new Promise(a)}}),b)}b.promiseSerialExecute=J;function K(a,b){var c=[];return a.reduce(function(a,d){return a.then(function(a){return c.push(Promise.resolve(a)),G(b?I({callback:d,timeout:b.timeout,retryCount:b.retryCount}):d())})},Promise.resolve({})).then(function(a){return c.shift(),c.push(Promise.resolve(a)),Promise.all(c)})}b.promiseAllSerial=K;function L(a){return"string"==typeof a&&("="===a.charAt(0)||a.indexOf("{{")>=0&&a.indexOf("}}")>=0)}function M(a,b){var c,i,j,k,l;if(A(a)||""===a)return"";if(c=L(b),!b||"General"===b||c)return"boolean"==typeof a||a instanceof Boolean?(e&&(a=a?e.getBoolean().boolean_true:e.getBoolean().boolean_false),(""+a).toUpperCase()):a instanceof Date?(i=f.q4(f.culture()).DateTimeFormat,j=i.shortDatePattern,0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()||(j=i.defaultDatePattern),h.Vb(a,j)):("number"==typeof a&&(a=g.nb(""+a)),""+a);try{return k=d.Formatter&&d.Formatter.GeneralFormatter,k?(l=null,l="string"==typeof b?new k(b):b,l.format(a,{})):""+a}catch(b){return""+a}}b.format=M;function N(a,b){var c,d;if(A(a)||A(b))return a;for(c=b.split(".");c.length>0;)d=c.shift(),a=a[d];return a}b.LL=N;function O(a){var b,c,d,e,f;if(a&&a.length>0){for(b={},c=[],d=0,e=a;d<e.length;d++)f=e[d],b[f]||(b[f]=!0,c.push(f));return c}return a}b.getUniqueArray=O},"./dist/src/interfaces/conditionalFormatOptions.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.c=void 0,b.c=0},"./dist/src/interfaces/interface.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),b.RelationshipMap=b.RowColumnStates=b.StateRuleDirection=b.DEFAULT_VIEW_NAME=void 0,b.DEFAULT_VIEW_NAME="defaultView",function(a){a[a.none=0]="none",a[a.row=1]="row",a[a.column=2]="column",a[a.both=3]="both"}(d=b.StateRuleDirection||(b.StateRuleDirection={})),function(a){a[a.hover=1]="hover",a[a.readonly=4]="readonly",a[a.active=16]="active",a[a.selected=32]="selected",a[a.dirty=64]="dirty",a[a.inserted=128]="inserted",a[a.updated=256]="updated"}(e=b.RowColumnStates||(b.RowColumnStates={})),function(a){a[a.OneToOne=0]="OneToOne",a[a.OneToMany=1]="OneToMany"}(f=b.RelationshipMap||(b.RelationshipMap={}))},"./dist/src/interfaces/styleOptions.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.s=void 0,b.s=0},"./dist/src/interfaces/validatorOptions.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.v=void 0,b.v=0},"./dist/src/relationship.js":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),b.Relationship=void 0,d=c("./dist/src/interfaces/interface.js"),e=c("./dist/src/dataSource/utils.js"),f=void 0,g=function(){function a(a,b,c,d,e,f){this.sourceTable=a,this.sourceFieldName=b,this.sourceRelationshipName=c,this.targetTable=d,this.targetFieldName=e,this.targetRelationshipName=f,c&&(this.sourceField=a.WDJ(b,c,d,e,this)),f&&(this.targetField=d.WDJ(e,f,a,b,this))}return a.prototype.u_J=function(a){return a===this.targetRelationshipName},a.prototype.Fb=function(){this.sourceTable&&this.sourceTable.QJJ(this),this.targetTable&&this.targetTable.QJJ(this)},a.prototype.v_J=function(a){return this.relationshipMap===d.RelationshipMap.OneToMany&&a===this.sourceRelationshipName?d.RelationshipMap.OneToOne:this.relationshipMap},a.prototype.w_J=function(){var a=this.sourceTable,b=this.sourceFieldName;if(a.x_J())return a.PEJ(b)&&!a.y_J()?d.RelationshipMap.OneToOne:d.RelationshipMap.OneToMany},a.prototype.z_J=function(a){var b=this.relationshipMap;return e.isNullOrUndefined(b)&&(b=this.relationshipMap=this.w_J()),e.isNullOrUndefined(b)?a:b===d.RelationshipMap.OneToOne?{Nc:"object"}:{Nc:"array"}},a.prototype.XDJ=function(){var a,b,c,d,f,g,h,i,j;function k(a,b,c){a[b]?(a[b].push(c),a.Nc="array"):a[b]=[c]}for(a=this.sourceField.YDJ={Nc:"object"},b=this.targetField.YDJ=this.z_J({}),c=this.z_J({Nc:"object"}),d=this.sourceTable.getDataSync(),f=this.targetTable.getDataSync(),g=0;g<d.length;g++)h=d[g][this.sourceFieldName],e.isNullOrUndefined(h)||k(c,h,g);for(i=function(d){var g=f[d][j.targetFieldName];e.isNullOrUndefined(g)||c[g]&&(b[d]=c[g],c[g].forEach(function(b){k(a,b,d)}))},j=this,g=0;g<f.length;g++)i(g);this.targetField.type=c.Nc,this.sourceField.type=a.Nc},a.prototype.Nm=function(){this.sourceField.YDJ=f,this.targetField.YDJ=f,this.targetTable.IWJ(),this.sourceTable.IWJ()},a}(),b.Relationship=g},"./dist/src/table/calcField.js":function(a,b,c){"use strict";
var d,e,f,g=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),b.CalcField=void 0,d=c("CalcEngine"),e=c("./dist/src/dataSource/utils.js"),f=function(a){g(b,a);function b(b,c){var d,e=a.call(this)||this;e.calcSource=c.vDJ,e.calcService=e.calcSource.getCalcService(),e.rOa=b;try{d=e.expression=e.calcService.parse(e.calcSource,b,0,0),e.calcService&&d&&(e.ah=e.calcService.getGlobalSourceModel(),e.ah.Ig(e,0,0,d,d,!0))}catch(a){}return e.Xm=[],e}return b.prototype.getKey=function(){var a=this;return"T:"+a.calcSource.sj.name+":"+a.rOa},b.prototype.fh=function(){this.ZAb().pg(this,3)},b.prototype.ZAb=function(){return this.calcService},b.prototype.Ik=function(){this.QV()},b.prototype.QV=function(){this.Xm=[]},b.prototype.getValue=function(a){if(!this.expression)return"Invalid Formula";var b=this.Xm[a];return e.isUndefined(b)?(this.calcSource.L$a(a),b=this.Xm[a]=this.calcService.evaluateExpression(this.calcSource,this.expression,{row:a,col:0})):b},b.prototype.getValues=function(a,b){var c,d,e=[];for(b=b||0,c=b,d=a.length;c<d;c++)e.push(this.getValue(a[c]));return e},b}(d.BaseCalc),b.CalcField=f},"./dist/src/table/hierarchyField.js":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),b.HierarchyField=void 0,d=c("./dist/src/dataSource/utils.js"),e=c("./dist/src/table/calcField.js"),f=c("./dist/src/table/tableField.js"),g=function(){function a(a,b){this.rOa=a,this.sj=b,this.DaK=new e.CalcField(this.BaK(),b),this.EaK=new f.TableField(a,b)}return a.prototype.getKey=function(){return this.DaK.getKey()},a.prototype.fh=function(){this.DaK.fh()},a.prototype.ZAb=function(){return this.DaK.ZAb()},a.prototype.Ik=function(){this.QV()},a.prototype.BaK=function(){return this.sj.isHierarchy()?this.sj._dataSource.BaK(this.rOa):void 0},a.prototype.QV=function(){var a=this.BaK();d.isNullOrEmpty(a)?this.DaK=null:d.isNullOrUndefined(this.DaK)||a!==this.DaK.rOa?this.DaK=new e.CalcField(a,this.sj):this.DaK.QV(),this.EaK=new f.TableField(this.rOa,this.sj)},a.prototype.FaK=function(a){var b,c=this.sj;if(c.isHierarchy())return b=c.z6J(a),!d.isNullOrUndefined(b)&&b.children.length>0},a.prototype.getValue=function(a){return!d.isNullOrUndefined(this.DaK)&&this.FaK(a)?this.DaK.getValue(a):this.EaK.getValue(a)},a.prototype.getValues=function(a,b){var c,d,e=[];for(b=b||0,c=b,d=a.length;c<d;c++)e.push(this.getValue(a[c]));return e},a.prototype.setValue=function(a,b){return this.EaK.setValue(a,b)},a.prototype.setItemValue=function(a,b,c,d){this.EaK.setItemValue(a,b,c,d)},a.prototype.hasItem=function(a){this.EaK.hasItem(a)},a.prototype.insertItem=function(a,b){this.EaK.insertItem(a,b)},a.prototype.getOriginalValue=function(a){return this.EaK.getOriginalValue(a)},a.prototype.getRelatedTable=function(){return this.EaK.getRelatedTable()},a.prototype.getRelationMaps=function(){return this.EaK.getRelationMaps()},a.prototype.getHostTableIndexes=function(a){return this.EaK.getHostTableIndexes(a)},a}(),b.HierarchyField=g},"./dist/src/table/table.entry.js":function(a,b,c){"use strict";var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c),Object.defineProperty(a,d,{enumerable:!0,get:function(){return b[c]}})}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||b.hasOwnProperty(c)||d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),e(c("./dist/src/table/tableEvents.js"),b),e(c("./dist/src/table/table.js"),b)},"./dist/src/table/table.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o;Object.defineProperty(b,"__esModule",{value:!0}),b.Table=b.updateFilterIndexesCacheOnRemove=b.updateFilterIndexesCacheOnUpdate=b.updateFilterIndexesCacheOnInsert=b.generateFilterIndexCache=void 0,d=c("./dist/src/dataSource/dataSource.js"),e=c("./dist/src/calculation/calcSource.js"),f=c("./dist/src/dataSource/utils.js"),g=c("./dist/src/view/view.js"),h=c("./dist/src/interfaces/interface.js"),i=c("./dist/src/table/tableEvents.js"),j=c("./dist/src/table/calcField.js"),k=c("./dist/src/table/tableField.js"),l=c("./dist/src/table/hierarchyField.js"),m=null,n=void 0;function p(a,b,c){var d={syncDone:!1,asyncCount:0,args:void 0,succeededArgs:void 0,failedArgs:void 0,onSucceeded:a,onFailed:b,onEnd:c,invoke:function a(){0===d.asyncCount&&d.syncDone&&(d.failedArgs?d.onFailed&&d.onFailed(d.failedArgs):d.onSucceeded&&d.onSucceeded(d.succeededArgs),d.onEnd&&d.onEnd(d.succeededArgs||d.failedArgs))},execute:function a(b){b&&(d.onEnd=b),d.syncDone=!0,d.invoke()},suspend:function a(){return d.asyncCount++,{succeed:function a(b){d.succeededArgs=b,d.resume()},fail:function a(b){d.failedArgs=b,d.resume()}}},resume:function a(){d.asyncCount--,d.invoke()}};return d}function q(a,b){var c,d,e,f;for(c in a)if(a.hasOwnProperty(c)){d=a[c];for(e in b)if(b.hasOwnProperty(e)&&(f=b[e],d===f&&d.OG))return!0}}function r(a,b){return q(b.views,a.A_J)}function s(a,b,c,d){var e,g,h,i,j,k,l;if(0!==b){for(h=c&&c.dataType,i=c&&c.dataMap,j=!!h,k=0;k<b;k++)l=d(k),i&&!f.isNullOrUndefined(i[l])&&(l=i[l]),j||f.isNullOrUndefined(l)||(g=l,j=!0),l instanceof Date&&(l=l.toISOString()),e||(e={}),e[l]||(e[l]=[]),e[l]&&e[l].push(k);return h?e.CL=h:e.CL=j?typeof g:"object",e}}b.generateFilterIndexCache=s;function t(a,b,c,d){var e,g,h,i,j;for(e in a)a.hasOwnProperty(e)&&(g=a[e],h=d&&d[e],i=h&&h.dataMap,g&&(j=c[e],i&&!f.isNullOrUndefined(i[j])&&(j=i[j]),j instanceof Date&&(j=j.toISOString()),g[j]?g[j].push(b):g[j]=[b]))}b.updateFilterIndexesCacheOnInsert=t;function u(a,b,c,d,e,g){var h,i=a[c],j=g&&g.dataMap;i&&e!==d&&(j&&(f.isNullOrUndefined(j[d])||(d=j[d]),f.isNullOrUndefined(j[e])||(e=j[e])),d instanceof Date&&(d=d.toISOString()),e instanceof Date&&(e=e.toISOString()),h=i[d],h&&(h.length>1?h.splice(h.indexOf(b),1):delete i[d],i[e]?i[e].push(b):i[e]=[b]))}b.updateFilterIndexesCacheOnUpdate=u;function v(a,b,c){var d,e,g,h,i;for(d in a)if(a.hasOwnProperty(d)&&(e=a[d]))for(g in e)if(e.hasOwnProperty(g)&&f.isArray(e[g])&&(h=e[g],f.isArray(h))){for(i=0;i<h.length;i++)h[i]>=b+c?h[i]-=c:h[i]>=b&&h[i]<b+c&&(h.splice(i,1),i--);0===h.length&&delete e[g]}}b.updateFilterIndexesCacheOnRemove=v,o=function(){function a(a,b){this.AEJ={},this.GNJ={},this.B_J=0,Object.defineProperty(this,"name",{get:function(){return this.Cj},set:function(a){var b,c,d,e,f=this.Cj;if(this.Cj=a,b=this.EEJ){for(c in this.A_J)this.A_J.hasOwnProperty(c)&&(d=this.A_J[c],d.C_J(f,a));e=b.tables,delete e[f],e[a]=this}}}),Object.defineProperty(this,"options",{get:function(){return this._dataSource.options},set:function(a){this.DEJ=!0,this._dataSource.options=a}}),this.name=a;var c;c=b instanceof d.DataSource?b:new d.DataSource(b),this._dataSource=c,this.views={},this.A_J={},this.HL=[],this.BEJ={},this.CEJ=[],this.DEJ=!0,this.Ze={}}return a.prototype.n_J=function(a,b,c){var d,e,g;(f.isNullOrUndefined(b)||""===b)&&(b="*"),"="===b[0]?(d=this.TNJ(b),d.gmb(0,a,c)):(e=this.Ze[b],e||(e=this.Ze[b]={}),g=a.getKey(),c?e[g]=a:delete e[g])},a.prototype.Bg=function(a){var b,c,d;a.indexOf(".")>-1&&(a=a.split(".")[0]),b=this.Ze[a];for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d=b[c],d.fh());b=this.Ze["*"];for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d=b[c],d.fh())},a.prototype.ZDJ=function(a){var b,c;if(this.EEJ=a,a)this.vDJ=new e.DataManagerCalcSource(a.Wu,this);else{this.vDJ=m;for(b in this.A_J)this.A_J.hasOwnProperty(b)&&(c=this.A_J[b],c.D_J(this))}},a.prototype.F4J=function(a,b,c){var d=this.vDJ;return d.getCalcService().parse(d,a,b||0,c||0)},a.prototype.G4J=function(a,b,c){var d=this.vDJ;return d.L$a(b),d.getCalcService().evaluateExpression(d,a,{row:b||0,col:c||0})},a.prototype.getDataSync=function(a){return this._dataSource.nEJ(a)},a.prototype.B9J=function(a,b){var c,d,e,f,g,h=this;if(a){if(a.indexOf(h)>=0)return m}else{if(h.N5J)return h.N5J;c=!0,a=[],b=[]}for(a.push(h),b.push(new Promise(function(a){return h.DEJ?h.fetch().then(a):void a(null)})),d=h.HL,e=0;e<d.length;e++)f=d[e],g=f.targetTable,g&&g.B9J(a,b);if(c)return h.N5J=Promise.all(b),h.N5J},a.prototype.fetch=function(a){var b,c,d=this;return d.QWJ&&(b=d.columns),c=d.length(),d._dataSource.load({reload:a}).then(function(e){var g,h,i,j,k,l,m,o,p,q=d._dataSource.options.schema;if(d.DEJ&&(g=d.get(0),f.isNullOrUndefined(g)&&q&&q.columns&&(g=q.columns),g&&(h=f.keys(g),i=d.columns={},j=d.HL,h.forEach(function(a){var c=b&&b[a];i[a]=d.$MJ(a,c),j.push({name:a})})),d.DEJ=!1),q&&q.columns){k=q.columns,l=[];for(m in k)k[m]&&k[m].indexed&&l.push(m);d.TOJ(l)}if(d.createIndexes(d.CEJ),d.QWJ=!1,a){if(c!==d.length()){o=d.views;for(p in o)o.hasOwnProperty(p)&&(o[p].fFJ=n)}d._dataSource.o5J(),d.Nm()}return Promise.resolve(e)})},a.prototype.$MJ=function(a,b){var c,d,e=this,g={name:a,value:a};if(!f.isNullOrUndefined(b)){b.value=void 0,b.name=void 0;for(d in b)b.hasOwnProperty(d)&&!f.isNullOrUndefined(b[d])&&(g[d]=b[d]);c=b.ny,delete b.ny}return Object.defineProperty(g,"dataType",{get:function(){return c},set:function(a){if(c!==a){"rowOrder"!==c&&"rowOrder"!==a||!e.isHierarchy()||e.setHierarchyOptionChanged(),c=a,e._dataSource.ZMJ(this.name,this.dataType,this.dataPattern);var b=this.value;e.Nm(b),e.FPJ(b)}}}),Object.defineProperty(g,"mappedName",{get:function(){return this.value},set:function(a){if(this.value!==a&&!f.isNullOrEmpty(a)){var b=this.value;e._dataSource.f4J(b,a),e.Nm(b),e.FPJ(a),e.d4J(b,a),e.e4J(b,a),e.HL.forEach(function(c){c.name===b&&(c.name=a)}),e.CEJ=e.CEJ.map(function(c){return c===b?a:c}),e.columns[a]=e.columns[b],delete e.columns[b],this.name=this.value=a}}}),Object.defineProperty(g,"relationship",{get:function(){var a,b,c,d=e.EEJ.relationships;for(a=0,b=d;a<b.length;a++){if(c=b[a],c.sourceTable===e&&c.sourceFieldName===this.value)return{table:c.targetTable,field:c.targetFieldName,sourceName:c.sourceRelationshipName,targetName:c.targetRelationshipName};if(c.targetTable===e&&c.targetFieldName===this.value)return{table:c.sourceTable,field:c.sourceFieldName,sourceName:c.sourceRelationshipName,targetName:c.targetRelationshipName}}},set:function(a){var b,c,d,f=e.EEJ.relationships;for(b=0,c=f;b<c.length;b++)if(d=c[b],d.sourceRelationshipName===a.sourceName){e.EEJ.removeRelationship(d.sourceRelationshipName);break}a.table&&a.field&&e.EEJ.addRelationship(e,this.value,a.sourceName,a.table,a.field,a.targetName)}}),g},a.prototype.length=function(){return this._dataSource.length()},a.prototype.getDirtyIndexes=function(){return this._dataSource.getDirtyIndexes()},a.prototype.isInserted=function(a){return this._dataSource.isInserted(a)},a.prototype.isUpdated=function(a){return this._dataSource.isUpdated(a)||this.E_J(a)},a.prototype.getErrorInfo=function(a){return this._dataSource.getErrorInfo(a)},a.prototype.E_J=function(a){var b,c,d,e,f,g,h,i=this,j=i.HL;for(i.B_J++,b=0;b<j.length;b++)if(c=j[b],d=c.targetTable,e=c.YDJ,d&&r(d,i)&&e&&e[a]&&!d.B_J)for(f=0,g=e[a];f<g.length;f++)if(h=g[f],d.isUpdated(h))return i.B_J--,!0;i.B_J--},a.prototype.insertItem=function(a,b,c,d){var e=this,f={index:a,data:b};this.Wq(i.Events.ItemInserting,f),this._dataSource.insertItem(a,b,function(d){e.HEJ(a,b),e.KNJ(a,b),e.Nm(),e.Wq(i.Events.ItemInserted,f),c&&c(d)},d)},a.prototype.updateItem=function(a,b,c,d){this._dataSource.updateItem(a,b,c,d)},a.prototype.jkK=function(a,b,c,d,e,f){var g=this;return function(h){g.NEJ(a,b,c),g.LNJ(a,d,b,c),g.Nm(),g.Wq(i.Events.ItemUpdated,e),f&&f(h)}},a.prototype.eBc=function(a,b,c,d,e,f){var g=b[c],h={index:a,data:b,field:c,originalValue:d,newValue:g};this.Wq(i.Events.ItemUpdating,h),this._dataSource.updateItem(a,b,this.jkK(a,d,g,c,h,e),f)},a.prototype.updateItemValue=function(a,b,c,d,e){var f,g,h=this._getValueByField(b,a),j=this.wEJ(a);j[b]=c,g={index:a,data:j,field:b,originalValue:h,newValue:c},this.Wq(i.Events.ItemUpdating,g),this._dataSource.updateItemValues(a,(f={},f[b]=c,f),this.jkK(a,h,c,b,g,d),e)},a.prototype.resetItem=function(a,b,c){var d,e,f,g,h,j=this,k=p(b,c);this.F_J(a,k.suspend),this._dataSource.isUpdated(a)&&(d=k.suspend(),e=d.succeed,f=d.fail,g=this.wEJ(a),h=this.BWJ(a),this.Wq(i.Events.ItemResetting,{index:a}),this._dataSource.resetItem(a,function(b){j.CWJ(a,g,h),j.Nm(),j.Wq(i.Events.ItemReset,{index:a,originalData:g,dataBeforeChanged:h}),e(b)},f)),k.execute()},a.prototype.CWJ=function(a,b,c){var d,e,g,h=this,i=h.columns;if(!f.isNullOrUndefined(b)&&!f.isNullOrUndefined(c))for(d in i)i.hasOwnProperty(d)&&(e=i[d],g=e.value instanceof Function?e.value.name:e.value,h.LNJ(a,g,b[g],c[g]))},a.prototype.F_J=function(a,b){var c,d,e=this,f=e.HL;for(e.B_J++,c=function(c){var d,g,h,i,j,k,l,m=f[c],n=m.targetTable,o=m.YDJ;if(n&&r(n,e)&&o&&o[a]&&!n.B_J){for(d=[],g=0,h=o[a];g<h.length;g++)i=h[g],n.isInserted(i)?d.push(i):n.isUpdated(i)&&(j=b(),k=j.succeed,l=j.fail,n.resetItem(i,k,l));d.length>0&&(d.sort(function(a,b){return b-a}),d.forEach(function(a){var c=b(),d=c.succeed,e=c.fail;n.Hzb(a,1,d,e)}))}},d=0;d<f.length;d++)c(d);e.B_J--},a.prototype.saveItem=function(a,b,c){var d,e,f,g=this,h=p(b,c),j=h.suspend(),k=j.succeed,l=j.fail;this.G_J(a,k,l),(this._dataSource.isUpdated(a)||this._dataSource.isInserted(a))&&(d=h.suspend(),e=d.succeed,f=d.fail,this.Wq(i.Events.ItemSaving,{index:a}),this._dataSource.saveItem(a,function(b){g.Nm(),g.Wq(i.Events.ItemSaved,{index:a}),e(b)},f)),h.execute()},a.prototype.G_J=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=p(b,c),o=n.suspend,q=this,s=q.HL;for(q.B_J++,d=0;d<s.length;d++)if(e=s[d],f=e.targetTable,g=e.YDJ,f&&r(f,q)&&g&&g[a]&&!f.B_J)for(h=0,i=g[a];h<i.length;h++)j=i[h],(f.isUpdated(j)||f.isInserted(j))&&(k=o(),l=k.succeed,m=k.fail,f.saveItem(j,l,m));n.execute(function(){return q.B_J--})},a.prototype.get=function(a){return this._dataSource.get(a)},a.prototype.remove=function(a,b,c,d){var e,f,g,h,i=this;void 0===b&&(b=1),e=p(function(){i.Hzb(a,b,c,d)},d),f=e.suspend(),g=f.succeed,h=f.fail,this.H_J(a,b,g,h),e.execute()},a.prototype.Hzb=function(a,b,c,d){var e=this,f={index:a,count:b};this.Wq(i.Events.ItemRemoving,f),this._dataSource.remove(a,b,function(d){e.IEJ(),e.MNJ(a,b),e.Wq(i.Events.ItemRemoved,f),c&&c(d)},d)},a.prototype.H_J=function(a,b,c,d){var e,g,h=p(c,d),i=h.suspend,j=this,k=j.HL;for(j.B_J++,e=function(c){var d,e,g,h,j,l,m,n=k[c],o=n.targetTable,p=n.vEJ,q=n.YDJ;if(o&&p.u_J(n.name)&&q&&q[a]&&!o.B_J){for(d=i(),e=d.succeed,g=d.fail,h=[],j=void 0,l=function(b){var c=q[a+b];h=h.concat(Object.keys(c).map(function(a){return c[a]}))},m=0;m<b;m++)l(m);h.sort(function(a,b){return b-a}),j=h.map(function(a){return function(b,c){o.remove(a,1,b,c)}}),f.promiseSerialExecute(j).then(e).catch(g)}},g=0;g<k.length;g++)e(g);h.execute(function(){return j.B_J--})},a.prototype.getChanges=function(){return this._dataSource.getChanges()},a.prototype.isDataLengthChanged=function(){return this._dataSource.isDataLengthChanged()},a.prototype.submitChanges=function(a,b,c){var d=this;return new Promise(function(e,f){d.I_J(a,function(a){e(a),b&&b(a)},function(a){f(a),c&&c(a)})})},a.prototype.I_J=function(a,b,c){var d=this,e=p(function(){d.IEJ(),d.Wq(i.Events.ChangesSubmitting,n),d._dataSource.submitChanges(function(b,c,e){a?a(b,c,e):d.Wq(i.Events.ChangesSubmittedRowFailed,{index:b,reason:c,type:e})}).then(function(a){d.Wq(i.Events.ChangesSubmitted,a),b(a)}).catch(function(a){c(a)})}),f=e.suspend(),g=f.succeed,h=f.fail;this.J_J(g,h),e.execute()},a.prototype.J_J=function(a,b){var c,d,e,f,g,h,i,j=p(a,b),k=j.suspend,l=this,m=l.HL;for(l.B_J++,c=0;c<m.length;c++)d=m[c],e=d.targetTable,f=d.YDJ,e&&f&&!e.B_J&&(g=k(),h=g.succeed,i=g.fail,e.submitChanges(n,h,i));j.execute(function(){return l.B_J--})},a.prototype.cancelChanges=function(a,b){var c=this,d=p(function(){var b={isDataLengthChanged:c.isDataLengthChanged()};c.Wq(i.Events.ChangesCancelling,n),c._dataSource.cancelChanges(),c.IEJ(),c.PNJ(),c.Wq(i.Events.ChangesCancelled,b),a&&a(n)});this.K_J(d.suspend),d.execute()},a.prototype.K_J=function(a){var b,c,d,e,f,g,h,i=this,j=i.HL;for(i.B_J++,b=0;b<j.length;b++)c=j[b],d=c.targetTable,e=c.YDJ,d&&e&&!d.B_J&&(f=a(),g=f.succeed,h=f.fail,d.cancelChanges(g,h));i.B_J--},a.prototype.ehK=function(a){return a instanceof j.CalcField||a instanceof l.HierarchyField},a.prototype.fhK=function(){var a,b,c,d,e=this.options.schema.hierarchy.column,f=[RegExp("(\\[@)("+e+")\\]|(PARENT)|(CHILDREN)|(ONLYCHILDREN)|(LEVEL)|(LEVELROWNUMBER)")];for(a in this.BEJ)Object.prototype.hasOwnProperty.call(this.BEJ,a)&&(b=this.BEJ[a],b instanceof l.HierarchyField&&(b.QV(),f.push(RegExp("(\\[@)("+b.rOa+")\\]"))));c=function(a){if(Object.prototype.hasOwnProperty.call(d.BEJ,a)){var b=d.BEJ[a];b instanceof j.CalcField&&f.some(function(a){return a.test(b.rOa)})&&b.QV()}},d=this;for(a in this.BEJ)c(a)},a.prototype.IWJ=function(){var a,b;for(a in this.BEJ)Object.prototype.hasOwnProperty.call(this.BEJ,a)&&(b=this.BEJ[a],this.ehK(b)?b.QV():this.BEJ[a]=n)},a.prototype.Nm=function(a,b){var c,d,e;if(a){for(c=this.BEJ[a],this.ehK(c)?c.QV():this.BEJ[a]=n,d=0;d<this.HL.length;d++)if(e=this.HL[d],a===e.name||a===e.sourceField)return void(e.YDJ&&e.vEJ.Nm())}else for(this.IWJ(),d=0;d<this.HL.length;d++)e=this.HL[d],e.vEJ&&e.vEJ.Nm()},a.prototype.primaryKey=function(a){var b,c,d,e,g,h,i,j;if(0===arguments.length){if(0===this.CEJ.length){for(b in this.columns)this.columns[b].isPrimaryKey&&this.CEJ.push(b);this.createIndexes(this.CEJ)}return this.CEJ.join(",")}if(!f.isNullOrUndefined(a)&&(this.CEJ=this.CEJ.concat(a.split(",")),c=this._dataSource.options.schema,!f.isNullOrUndefined(c))){d=c.columns=c.columns||{},e=[];for(b in d)Object.prototype.hasOwnProperty.call(d,b)&&(g=d[b],g.isPrimaryKey&&e.push(b));if(0===e.length)this.CEJ.forEach(function(a){d[a]=d[a]||{},d[a].isPrimaryKey=!0});else for(h=this.CEJ.slice().sort(),e.sort(),i=e,j=0;j<h.length||j<i.length;j++)if(h[j]!==i[j])return void(this.CEJ=i)}},a.prototype.getIndexes=function(){return f.keys(this.AEJ)},a.prototype.NNJ=function(){return f.keys(this.GNJ)},a.prototype.createIndexes=function(a){var b,c,d,e=this.AEJ;for(b=0,c=a;b<c.length;b++)d=c[b],e[d]||(e[d]=this.JEJ(d))},a.prototype.TOJ=function(a,b){var c,d,e,f=this.GNJ;for(c=0,d=a;c<d.length;c++)e=d[c],f[e]&&!b||(f[e]=this.ONJ(e))},a.prototype.dropIndexes=function(a){var b,c,d,e=this.AEJ;for(b=0,c=a;b<c.length;b++)d=c[b],e[d]&&delete e[d]},a.prototype.clearIndexes=function(){this.AEJ={}},a.prototype.d4J=function(a,b){var c=this.AEJ;f.isNullOrUndefined(c[a])||(c[b]=c[a],delete c[a])},a.prototype.PNJ=function(){this.GNJ={}},a.prototype.e4J=function(a,b){var c=this.GNJ;f.isNullOrUndefined(c[a])||(c[b]=c[a],delete c[a])},a.prototype.IEJ=function(){this.Nm();var a=this.getIndexes();this.clearIndexes(),this.createIndexes(a)},a.prototype.QNJ=function(){var a=this.NNJ();this.PNJ(),this.TOJ(a)},a.prototype.JEJ=function(a){var b,c,d,e,f=this.length();for(c=0;c<f;c++)d=this.get(c),e=d[a],"string"!=typeof e&&(e+=""),b||(b={}),b[e]||(b[e]=[]),b[e]&&b[e].push(c);return b},a.prototype.ONJ=function(a){var b=this;return s(a,this.length(),this.GWJ(a),function(c){return b._getValueByField(a,c)})},a.prototype.KEJ=function(a){return!!this.AEJ[a]},a.prototype.search=function(a,b){if(!f.isNullOrUndefined(a)&&!f.isNullOrUndefined(b))return f.isString(a)||(a+=""),this.KEJ(b)?this.LEJ(a,b):this.MEJ(a,b)},a.prototype.vQJ=function(a){var b,c,d,e,f,g=this.primaryKey().split(",");if(0===g.length||!this.AEJ[g[0]])return[];if(1===g.length)return this.AEJ[g[0]][a];if(a=a.split("|"),a.length!==g.length)return[];for(b=0;b<a.length;b++)a[b]=a[b].trim();for(c={},d={},this.AEJ[g[0]][a[0]].forEach(function(a){c[a]=1}),e=function(b){f.AEJ[g[b]]&&f.AEJ[g[b]][a[b]].forEach(function(a){c[a]===b&&(d[a]=b)}),c=d,d={}},f=this,b=1;b<a.length;b++)e(b);return Object.keys(c)},a.prototype.xQJ=function(a,b,c){var d,e,g,h,i,j,k,l,m,n,o,p,q,r;if(c){for(d={},e=0;e<b.length;e++)g=b[e],h=this._dataSource._data[g],d[g]=h&&h.data[a];for(i=this.EEJ.relationships,j=0,k=i;j<k.length;j++)if(l=k[j],l.sourceTable===this&&l.targetTable!==this){for(m={},n=l.sourceRelationshipName+".",o=f.keys(l.targetTable.columns),p=0,q=o;p<q.length;p++)r=q[p],m[r]=l.sourceTable._getValueByField(n+r,a);d[l.sourceRelationshipName]=m}return d}for(d=[],e=0;e<b.length;e++)h=this._dataSource._data[b[e]],d.push(h&&h.data[a]);return d},a.prototype.iNb=function(a,b,c,d){var e,f,g=[],h=this.length();for(e=0;e<h;e++)f=b&&this._dataSource._data[b].data[e],b!==m&&f!==a&&f+""!==a||g.push(this.xQJ(e,c||this._dataSource.U,d));return g},a.prototype.MEJ=function(a,b){var c,d,e,f=[],g=this.length();for(c=0;c<g;c++)d=this.get(c),e=d[b],e!==a&&e+""!==a||f.push(d);return f},a.prototype.LEJ=function(a,b){var c,d,e,f=this.AEJ,g=f[b],h=g[a],i=[];if(h)for(c=0,d=h;c<d.length;c++)e=d[c],i.push(this.get(e));return i},a.prototype.HEJ=function(a,b){var c,d,e,f=this.AEJ;for(c in f)f.hasOwnProperty(c)&&(d=f[c],d&&(e=b[c],d[e]?d[e].push(a):d[e]=[a]))},a.prototype.KNJ=function(a,b){var c=this._dataSource.options.schema;t(this.GNJ,a,b,c&&c.columns)},a.prototype.NEJ=function(a,b,c){var d,e,f,g=this.AEJ;for(d in g)g.hasOwnProperty(d)&&(e=g[d],e&&c!==b&&(f=e[b],f&&f.length>1?f.splice(f.indexOf(a),1):delete e[b],e[c]?e[c].push(a):e[c]=[a]))},a.prototype.LNJ=function(a,b,c,d){u(this.GNJ,a,b,c,d,this.GWJ(b))},a.prototype.MNJ=function(a,b){v(this.GNJ,a,b)},a.prototype.L_J=function(a,b){var c,d,e=this.GNJ,g=e&&e[a];if(g)for(c in g)if(g.hasOwnProperty(c)&&(d=g[c],f.isArray(d)&&d.some(function(a){return a===b})))return c},a.prototype.PEJ=function(a){return this.CEJ.indexOf(a)>=0},a.prototype.y_J=function(){return this.CEJ.length>1},a.prototype.x_J=function(){return this.CEJ.length>0},a.prototype.defaultView=function(){var a=this;return a.QEJ?Promise.resolve(a.QEJ):new Promise(function(b,c){a.fetch().then(function(c){var d=a.get(0),e=f.keys(d),g=a.addView(h.DEFAULT_VIEW_NAME,e);a.QEJ=g,b(g)})})},a.prototype.addView=function(a,b,c,d){var e=new g.View(a,b,c,d);return e.REJ(this),this.views[a]=e,e},a.prototype.AXJ=function(a,b){var c=new g.View(a,b);return c.REJ(this),this.EEJ.BXJ[a]=c,c},a.prototype.removeView=function(a){var b=this.views;b[a].REJ(m),delete b[a],this.M_J(a)},a.prototype.M_J=function(a){var b,c,d=this.EEJ.tables;for(b in d)d.hasOwnProperty(b)&&(c=d[b],delete c.A_J[a])},a.prototype.SEJ=function(a){return this.views[a]},a.prototype.LSb=function(a){var b,c;for(b=0;b<this.HL.length;b++)if(c=this.HL[b],c.name===a)return c;return null},a.prototype.yEJ=function(a){var b,c=this.getDataSync(a),d=[];if(a)for(b=0;b<a.length;b++)d.push(c[a[b]]);else for(b=0;b<c.length;b++)d.push(c[b]);return d},a.prototype.wEJ=function(a){return this.yEJ([a])[0]},a.prototype.BWJ=function(a){return this._dataSource.AWJ(a)},a.prototype.zEJ=function(a,b){var c,d=[];for(c=0;c<b.length;c++)d.push(this._getValueByField(a,b[c]));return d},a.prototype.TNJ=function(a){return this.BEJ[a]||!this.d7J()||f.isNullOrEmpty(this._dataSource.BaK(a))||(this.BEJ[a]=new l.HierarchyField(a,this)),this.BEJ[a]||(this.BEJ[a]="="===a[0]?new j.CalcField(a,this):new k.TableField(a,this)),this.BEJ[a]},a.prototype.UEJ=function(a){var b=this.BEJ[a];return b&&b.setValue},a.prototype.VEJ=function(a,b,c){this.FPJ(a);var d=this.BEJ[a];return this.Bg(a),d&&d.setValue&&d.setValue(b,c)},a.prototype.N_J=function(a,b,c,d,e){this.FPJ(a);var f=this.BEJ[a];return this.Bg(a),f&&f.setItemValue&&f.setItemValue(b,c,d,e)},a.prototype.O_J=function(a,b){this.FPJ(a);var c=this.BEJ[a];return c&&c.hasItem&&c.hasItem(b)},a.prototype.P_J=function(a,b,c,d,e){this.FPJ(a);var f=this.BEJ[a];return this.Bg(a),f&&f.insertItem&&f.insertItem(b,c,d,e)},a.prototype._getValueByField=function(a,b){return this.FPJ(a),this.BEJ[a].getValue(b)},a.prototype.Q_J=function(a,b){return this.FPJ(a),this.BEJ[a].getOriginalValue(b)},a.prototype.R_J=function(a){return this.FPJ(a),this.BEJ[a].getRelatedTable()},a.prototype.S_J=function(a){return this.FPJ(a),this.BEJ[a].getRelationMaps()},a.prototype.T_J=function(a){var b,c,d,e=this,f=e.EEJ,g=f.relationships;for(b=0,c=g;b<c.length;b++){if(d=c[b],d.sourceTable===e&&d.sourceFieldName===a)return d.targetTable;if(d.targetTable===e&&d.targetFieldName===a)return d.sourceTable}},a.prototype.U_J=function(a,b){return this.FPJ(a),this.BEJ[a].getHostTableIndexes(b)},a.prototype.FPJ=function(a){this.BEJ[a]||this.TNJ(a)},a.prototype.WDJ=function(a,b,c,d,e){var f={name:b,sourceField:a,targetTable:c,targetField:d,vEJ:e};return this.HL.push(f),f},a.prototype.QJJ=function(a){for(var b=this.HL.length-1;b>=0;b--)this.HL[b].vEJ===a&&this.HL.splice(b,1)},a.prototype.WEJ=function(){var a,b,c=[this],d=this.HL;for(a=0;a<d.length;a++)b=d[a].targetTable,c.indexOf(b)===-1&&c.push(b);return c},a.prototype.XEJ=function(a){var b=this,c=b.HL,d={};return c.forEach(function(c){var e=c.name;d[e]=b._getValueByField(e,a)}),d},a.prototype.bGc=function(a){var b=this.GWJ(a);return b&&b.dataType},a.prototype.GWJ=function(a){var b,c=this,d=c._dataSource.options.schema;return d&&d.columns&&d.columns[a]?b=d.columns[a]:f.isNullOrUndefined(c.columns)||(b=c.columns[a]),b},a.prototype.V_J=function(a){var b,c,d;return 0===a.length?[]:(b=this,c=b.LSb(a[0]),d=c&&c.targetTable?c.targetTable.V_J(a.slice(1)):[],d.unshift(c),d.filter(function(a){return!f.isNullOrUndefined(a)}))},a.prototype.toJSON=function(){var a,b=this.views,c=[];for(a in b)b.hasOwnProperty(a)&&c.push(b[a].toJSON());return{name:this.name,dataSourceOption:w(this._dataSource.options),primaryKey:this.primaryKey(),views:c,columns:this.LWJ(this.columns)}},a.prototype.fromJSON=function(a){var b,c,d,e,f=a.views;for(b=0,c=f;b<c.length;b++)d=c[b],e=this.addView(d.name,d.columns,!1,d.options),e.fromJSON(d);this.columns=a.columns,this.primaryKey(a.primaryKey)},a.prototype.bind=function(a,b){this._dataSource.bind(a,b)},a.prototype.unbind=function(a,b){this._dataSource.unbind(a,b)},a.prototype.Wq=function(a,b){return this._dataSource.Wq(a,b)},a.prototype.s_J=function(a){return this._dataSource.s_J(a)},a.prototype.LWJ=function(a){var b,c;for(b in a)a.hasOwnProperty(b)&&!f.isNullOrUndefined(a[b])&&(c=a[b],c.ny=c.dataType);return a},a.prototype.V6J=function(a,b,c){return this._dataSource.V6J(a,b,c)},a.prototype.W6J=function(a){return this._dataSource.W6J(a)},a.prototype.C6J=function(a,b,c){return this._dataSource.C6J(a,b,c)},a.prototype.c7J=function(){return this._dataSource.w6J()},a.prototype.C7J=function(){return this._dataSource.C7J()},a.prototype.E6J=function(a,b,c,d){return this.d7J()&&this.fhK(),this._dataSource.E6J(a,b,c,d)},a.prototype.d7J=function(){return this._dataSource.isHierarchy()},a.prototype.isHierarchy=function(){return this.d7J()},a.prototype.isHierarchyOptionChanged=function(){return this._dataSource.VlK()},a.prototype.setHierarchyOptionChanged=function(){this._dataSource.WlK()},a.prototype.z6J=function(a){return this._dataSource.z6J(a)},a.prototype.B6J=function(){return this._dataSource.B6J()},a.prototype.getHierarchyRootNode=function(){return this.B6J()},a.prototype.F6J=function(a){this._dataSource.F6J(a),this.fhK()},a.prototype.I6J=function(a,b){this._dataSource.I6J(a,b),this.fhK()},a.prototype.N6J=function(a,b){return this._dataSource.N6J(a,b)},a.prototype.Q6J=function(a,b){return this._dataSource.Q6J(a,b)},a.prototype.R6J=function(a,b){return this._dataSource.R6J(a,b)},a.prototype.T6J=function(a,b){return this._dataSource.T6J(a,b)},a.prototype.Q9J=function(a){return this._dataSource.Q9J(a)},a.prototype.CaK=function(a,b){return this._dataSource.CaK(a,b)},a}(),b.Table=o;function w(a){var b,c,d={data:a.data,remote:a.remote,autoSync:a.autoSync,batch:a.batch,schema:a.schema},e=a.remote;return e&&(b=d.remote={},c=e.read,c&&!f.isFunction(c)&&(b.read=c),c=e.create,c&&!f.isFunction(c)&&(b.create=c),c=e.update,c&&!f.isFunction(c)&&(b.update=c),c=e.delete,c&&!f.isFunction(c)&&(b.delete=c),c=e.batch,c&&!f.isFunction(c)&&(b.batch=c)),d}},"./dist/src/table/tableEvents.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Events=void 0;var d=function(){function a(){}return a.ItemInserting="ItemInserting",a.ItemInserted="ItemInserted",a.ItemUpdating="ItemUpdating",a.ItemUpdated="ItemUpdated",a.ItemResetting="ItemResetting",a.ItemReset="ItemReset",a.ItemSaving="ItemSaving",a.ItemSaved="ItemSaved",a.ItemRemoving="ItemRemoving",a.ItemRemoved="ItemRemoved",a.ChangesSubmitting="ChangesSubmitting",a.ChangesSubmittedRowFailed="ChangesSubmittedRowFailed",a.ChangesSubmitted="ChangesSubmitted",a.ChangesCancelling="ChangesCancelling",a.ChangesCancelled="ChangesCancelled",a}();b.Events=d},"./dist/src/table/tableField.js":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),b.TableField=void 0,d=c("./dist/src/dataSource/utils.js"),e=null,f=void 0;function h(a,b,c){return function(e,f,g,h){var i=a.map[e],j=i;return d.isNullOrUndefined(j)&&(i=a.map[e]=[]),f[b.targetField]=c._getValueByField(b.sourceField,e),a.relatedTable.P_J(a.subField,void 0,f,function(a){i.push(a.index),a.index=i.length-1,g&&g(a)},h)}}g=function(){function a(a,b){var c,f=this,g="string"==typeof a?a.split("."):a,i=g[0]&&b.LSb(g[0]);i&&i.targetTable?(this.relatedTable=i.targetTable,this.map=i.YDJ,this.setValue=null,this.map||(i.vEJ.XDJ(),this.map=i.YDJ),this.getRelationMaps=function(){var a=[{name:i.name,relationshipMap:i.vEJ.v_J(i.name)}];if(this.relatedTable)return this.subField?a.concat(this.relatedTable.S_J(this.subField)):a},this.getHostTableIndexes=function(a){var b,c,d,e,f=[a];return this.relatedTable?(this.subField&&(f=this.relatedTable.U_J(this.subField,a)),b=i.vEJ,c=void 0,c=b.targetTable===this.relatedTable?b.targetRelationshipName:b.sourceRelationshipName,d=this.relatedTable.LSb(c),e=d.YDJ,f.reduce(function(a,b){return a.concat(e[b])},[])):f},"object"===i.type?1===g.length?(this.getValue=function(a){var b=f.map[a];return d.isNullOrUndefined(b)?e:f.relatedTable.wEJ(b[0])},this.setValue=function(a){var b=a[g[0]];return b?a[i.sourceField]=b[i.targetField]:a[i.sourceField]=null,a}):(this.subField=g.slice(1).join("."),this.getValue=function(a){var b=f.map[a];return d.isNullOrUndefined(b)?e:f.relatedTable._getValueByField(f.subField,b[0])},this.getOriginalValue=function(a){var b=this.map[a];return d.isNullOrUndefined(b)?e:this.relatedTable.Q_J(this.subField,b[0])},this.setItemValue=function(a,b,c,g){var h=f.map[a];return d.isNullOrUndefined(h)?e:f.relatedTable.N_J(f.subField,h[0],b,c,g)},this.hasItem=function(a){var b=f.map[a];return!d.isNullOrUndefined(b)&&f.relatedTable.O_J(f.subField,b[0])},this.insertItem=h(this,i,b)):1===g.length?this.getValue=function(a){var b=f.map[a];return d.isNullOrUndefined(b)?[]:f.relatedTable.yEJ(b)}:(c=g[1]-1,isNaN(c)?(this.subField=g.slice(1).join("."),this.getValue=function(a){var b=f.map[a];return d.isNullOrUndefined(b)?e:f.relatedTable.zEJ(f.subField,b)},this.getOriginalValue=function(a){var b=this.map[a];return d.isNullOrUndefined(b)?e:this.relatedTable.Q_J(this.subField,b)},this.hasItem=function(a){var b=f.map[a];return b&&b.length>0},this.insertItem=h(this,i,b)):2===g.length?(this.arrayFieldIndex=g[1]-1,this.getValue=function(a){var b=f.map[a],c=b&&b[f.arrayFieldIndex];return d.isNullOrUndefined(c)?e:f.relatedTable.wEJ(c)}):(this.arrayFieldIndex=c,this.subField=g.slice(2).join("."),this.getValue=function(a){var b=f.map[a],c=b&&b[f.arrayFieldIndex];return d.isNullOrUndefined(c)?e:f.relatedTable._getValueByField(f.subField,c)},this.getOriginalValue=function(a){var b=this.map[a],c=b&&b[this.arrayFieldIndex];return d.isNullOrUndefined(c)?e:this.relatedTable.Q_J(this.subField,c)},this.setItemValue=function(a,b,c,e){var g=f.map[a],h=g&&g[f.arrayFieldIndex];if(!d.isNullOrUndefined(h))return f.relatedTable.N_J(f.subField,h,b,c,e)}))):(0===g.length?this.getValue=function(a){return b._dataSource.get(a)}:1===g.length?(this.getValue=function(a){return b._dataSource.getFieldValue(g[0],a)},this.getOriginalValue=function(a){return b._dataSource.getFieldOriginalValue(g[0],a)},this.getRelatedTable=function(){return b},this.setItemValue=function(a,c,d,e){return b.updateItemValue(a,g[0],c,d,e);
},this.hasItem=function(a){return b._dataSource.length()>a},this.insertItem=function(a,c,e,f){var g=d.isNullOrUndefined(a)?b.length():a;return b.insertItem(g,c,function(a){a.index=g,e&&e(a)},f)}):this.getValue=function(a){var c,d=b._dataSource.getFieldValue(g[0],a);for(c=1;d&&c<g.length;c++)d=d instanceof Array?d[g[c]-1]:d[g[c]];return d},this.setValue=function(a,b){var c,e=a,f=a,h=g.length;for(c=0;f&&c<h;c++)e=f instanceof Array?f[g[c]-1]:f[g[c]],c!==h-1&&(f=e);return f!==e&&(e!==b||d.isNullOrUndefined(e)&&d.isNullOrUndefined(b))&&(f[g[h-1]]=b),a})}return a.prototype.getValue=function(a){return null},a.prototype.getValues=function(a,b){var c,d,e=[];for(b=b||0,c=b,d=a.length;c<d;c++)e.push(this.getValue(a[c]));return e},a.prototype.setValue=function(a,b){return null},a.prototype.setItemValue=function(a,b,c,d){},a.prototype.hasItem=function(a){},a.prototype.insertItem=function(a,b){},a.prototype.getOriginalValue=function(a){return null},a.prototype.getRelatedTable=function(){if(this.relatedTable)return this.subField?this.relatedTable.R_J(this.subField):this.relatedTable},a.prototype.getRelationMaps=function(){return[]},a.prototype.getHostTableIndexes=function(a){return[a]},a}(),b.TableField=g},"./dist/src/view/view-cross.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/src/view/view.js"),f=c("./dist/src/dataSource/utils.js"),g=c("./dist/src/viewField/fieldManager.js"),h=d.Common.j.Ia,i=void 0,h(e.View.prototype,{W_J:function(){var a=this;a.nOJ.setCrossFieldValues(a.fFJ)},X_J:function(){var a=this;a.nOJ&&(a.nOJ.clearCrossFieldData(),a.W_J())},Y_J:function(a,b){var c=this;c.nOJ&&c.nOJ.removeCrossFieldValues(a,b)},Z_J:function(a){var b=this;b.nOJ&&b.nOJ.resetCrossFieldRowValues(a)},$_J:function(a,b){if("string"==typeof a){var c=!0,d=a;f.isNullOrUndefined(this.i6.cross)||(a=this.i6.cross[d],f.isNullOrUndefined(a)||(c=!1)),c&&(a={over:d,attributes:[""]})}return g.isValidCross(this.uDJ,a,b)},__J:function(){return this.a0J()&&f.isNullOrUndefined(this.nOJ)},a0J:function(){return this.aFJ.some(function(a){return a.cross})},b0J:function(a){var b,c,d,e,f,g,h,i,j,k,l,m=this,n=[],o=function(a,b){n.push({newIndex:b,columnInfos:m.aFJ.filter(function(b){return b.c0J===a}),fields:m.nOJ?m.nOJ.getFields(function(b){return b.initialOptionIndex===a}):[]})};for(b=0,c=a;b<c.length;b++)d=c[b],e=d.oldIndex,f=d.newIndex,o(e,f);for(g=function(a,b,c){a.forEach(function(a){return a.c0J=c}),b.forEach(function(a){return a.initialOptionIndex=c})},h=0,i=n;h<i.length;h++)j=i[h],k=j.columnInfos,l=j.fields,f=j.newIndex,g(k,l,f)},d0J:function(){var a=this,b=a.$EJ;return b.map(function(b){return a.e0J(b)})},f0J:function(a,b){var c,d,e,f,g,h,i,j=this,k=j.d0J(),l=j.g0J(k);if(l.length>0&&(a=l[a],b=l[b]),c=j.h0J[a],c&&"string"==typeof c.cross){if(d=j.h0J[a-1]||{},e=j.h0J[a+1]||{},d.cross===c.cross||e.cross===c.cross)return!0;if(f=j.h0J[b],g=j.h0J[a<b?b+1:b-1]||{},f.cross===c.cross||g.cross===c.cross)return!0}return h=function(a,b){return k.indexOf(a)>-1?h(a+b,b):a},i=function(a,b){var c=j.h0J[h(a,-1)]||{},d=j.h0J[h(b,1)]||{};if("string"==typeof c.cross&&c.cross===d.cross)return!0},i(a-1,a+1)||(a<b?i(b,b+1):i(b-1,b))},i0J:function(a){for(var b=this,c=0,d=function(a){return a&&0===a.length?i:a},e=function(){var d=b.aFJ[c];d.c0J===a?(b.pFJ=b.pFJ&&b.pFJ.filter(function(a){return a.field!==d.value}),b.oFJ=b.oFJ&&b.oFJ.filter(function(a){return a.field!==d.value}),b.oXJ=b.oXJ&&b.oXJ.filter(function(a){return a.field!==d.value}),b.pXJ=b.pXJ&&b.pXJ.filter(function(a){return a.field!==d.value}),b.aFJ.splice(c,1),b.nOJ&&b.nOJ.removeFields(c)):c++};c<b.aFJ.length;)e();b.pFJ=d(b.pFJ),b.oFJ=d(b.oFJ),b.oXJ=d(b.oXJ),b.pXJ=d(b.pXJ)},j0J:function(){var a=this;a.h0J.forEach(function(b,c){f.isNullOrUndefined(b.cross)||(f.isNullOrUndefined(b.k0J)&&(b.k0J=c),a.aFJ[c].k0J=b.k0J)})}})},"./dist/src/view/view-event.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/src/dataSource/utils.js"),f=c("./dist/src/table/tableEvents.js"),g=c("./dist/src/view/view.js"),h=c("./dist/src/view/view-util.js"),i=d.Common.j.Ia,j=null,k=void 0;function l(a){var b,c,d,g,h=[],i=[],j=Object.keys(f.Events);if(e.isArray(a))for(b=function(a){j.some(function(b){return b===a})?h.push(a):i.push(a)},c=0,d=a;c<d.length;c++)g=d[c],b(g);else j.some(function(b){return b===a})&&h.push(a);return[h,i]}i(g.View.prototype,{bind:function(a,b){var c=this,d=l(a),e=d[0],f=d[1];f.length>0&&(c.l0J(f,b),this.uDJ.bind(f,b)),e.length>0&&this.Fu(e,this.m0J(b))},Fu:function(a,b){var c=this,d=c.n0J(b);c.l0J(a,d),c.uDJ.bind(a,d)},unbind:function(a,b){this.uDJ.unbind(a,b)},Wq:function(a,b){return this.uDJ.Wq(a,b)},s_J:function(a){return this.uDJ.s_J(a)},l0J:function(a,b,c){var d,f,g,h,i,j,k,l,m=this;if(b)for(d=(c||m.uDJ).name,f=e.isArray(a)?a:[a],g=0,h=f;g<h.length;g++)i=h[g],j=e.isFunction(b)?b:b[i],j&&(k=m.o0J[d]=m.o0J[d]||{},l=k[i]=k[i]||[],l.push(j))},m0J:function(a){var b=this;return function(c,d){var f,g,h;if(b.p0J(d),e.isArray(a))for(f=0,g=a;f<g.length;f++)h=g[f],h.call(b,c,d);else a&&a.call(b,c,d)}},p0J:function(a){var b=this;a.hasOwnProperty("row")||Object.defineProperty(a,"row",{get:function(){return e.isNumber(a.cj)?a.cj:a.cj=b.kFJ(a.index)}})},n0J:function(a){var b=this;return function(c,d){b.q0J()&&a.call(b,c,d)}},q0J:function(a){return e.isBoolean(a)&&(this.OG=!a),!this.OG},r0J:function(a,b){var c=this;return c.q0J(!1),{success:function(b){c.q0J(!0),a&&a(b)},fail:function(a){c.q0J(!1),b&&b(a)}}},AJ:function(){var a=this;a.Fu(f.Events.ItemInserting,function(b,c){var d=c.index,e=c.data;a.RWJ(e),d===a.length()&&a.AX()&&a.DWJ(e)}),a.Fu(f.Events.ItemInserted,function(b,c){var d=c.index,e=c.data;a.s0J(d,e)}),a.Fu(f.Events.ItemUpdating,function(b,c){var d=c.data,e=c.originalValue;a.t0J(d,e)}),a.Fu(f.Events.ItemUpdated,function(b,c){var d=c.index,e=c.field,f=c.originalValue,g=c.newValue;a.u0J(d,e,f,g)}),a.Fu(f.Events.ItemReset,function(b,c){var d=c.index,e=c.originalData,f=c.dataBeforeChanged;a.v0J(d,e,f)}),a.Fu(f.Events.ItemRemoved,function(b,c){var d=c.index,e=c.count;a.w0J(d,e)}),a.Fu(f.Events.ChangesSubmitted,function(b,c){a.x0J()}),a.Fu(f.Events.ChangesCancelled,function(b,c){a.y0J(c.isDataLengthChanged)})},Lva:function(){var a,b,c,d,e,f,g,h,i=this,j=i.o0J;for(a in j)if(j.hasOwnProperty(a)){b=j[a];for(c in b)if(b.hasOwnProperty(c))for(d=b[c],e=0,f=d;e<f.length;e++)g=f[e],h=i.uDJ.EEJ.tables[a],h.unbind(c,g)}i.o0J={}},D_J:function(a){var b,c,d,e,f,g=this,h=g.o0J,i=a.name,j=h[i];for(b in j)if(j.hasOwnProperty(b))for(c=j[b],d=0,e=c;d<e.length;d++)f=e[d],a.unbind(b,f);h[i]=k},C_J:function(a,b){var c=this,d=c.o0J,e=d[a];delete d[a],d[b]=e},z0J:function(){var a,b,c,d,f,g,i,j,k;if(this.A0J())for(a=this,b=a,c=a.name,d=a.aFJ,f=a.uDJ,g=0,i=d;g<i.length;g++)j=i[g],e.isFunction(j.value)||h.isFormula(j.value)||!h.isRelation(j.value)||(k=f.R_J(j.value),!e.isNullOrUndefined(k)&&e.isNullOrUndefined(k.A_J[c])&&(k.A_J[c]=b,a.B0J(k)))},B0J:function(a){var b=this,c=b.uDJ,d=c.EEJ.relationships.reduce(function(b,d){return d.sourceTable===c&&d.targetTable===a?{relationshipName:d.sourceRelationshipName,relationFieldName:d.sourceFieldName}:d.sourceTable===a&&d.targetTable===c?{relationshipName:d.targetRelationshipName,relationFieldName:d.targetFieldName}:b},{}),g=d.relationshipName,i=d.relationFieldName,j=function(d,j){var l=b.n0J(function(a,d){var l,m,n,o,p,q,r,s=function(a,b){var c=a.value.split(".");return c[c.length-1-b]},t=b.h0J.filter(function(a){return h.isRelation(a.value)&&s(a,1)===g}),u=t;if(d.eventName!==f.Events.ItemUpdating&&d.eventName!==f.Events.ItemUpdated||(u=u.filter(function(a){return s(a,0)===d.field})),l=[k],u.forEach(function(c){var f,g,h,i=!e.isNullOrUndefined(c.cross);i?(g="string"==typeof c.cross?b.i6.cross[c.cross].over:c.cross.over,e.isNullOrUndefined(b.pFJ)||(h=e.findIndex(b.pFJ,function(a){return a.field.indexOf(c.value)>-1&&a.field.indexOf(g)>-1}),h>-1&&(f=b.pFJ[h].field))):b.GPJ(c.value)&&l.push(c.value),j.call(b,c.value,i,f)(a,d)}),d.eventName===f.Events.ItemInserted||d.eventName===f.Events.ItemRemoved||d.eventName===f.Events.ItemUpdated){if(d.eventName===f.Events.ItemUpdated&&(m=i===d.field,n=t.some(function(a){if(!e.isNullOrUndefined(a.cross)){var c=("string"==typeof a.cross?b.i6.cross[a.cross].over:a.cross.over).split(".").pop();if(c===d.field)return!0}return!1}),m||n))for(o=c.U_J(t[0].value,d.index),p=0,q=o;p<q.length;p++)r=q[p],b.Z_J(r);l.forEach(function(a){b.rWJ(k,!0,a,k)})}});b.l0J(d,l,a),a.bind(d,l)},l=function(a,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s;if(b.AX())for(j=f.relatedViewIndexes||c.U_J(a,f.index),k=0,l=j;k<l.length;k++)m=l[k],n=void 0,o=void 0,p=void 0,d?(b.Z_J(m),n=c.L_J(e,m),g={},g[e]=n,o=g,p=b.lFJ(m,(h={},h[e]=!0,h))[e]):(n=c.L_J(a,m),i={},i[a]=n,o=i,p=c._getValueByField(a,m)),q=b.BMJ(m,o).data,b.EWJ(q,n),b.LNJ(m,a,n,p),c.LNJ(m,a,n,p);else if(d)for(j=f.relatedViewIndexes||c.U_J(a,f.index),r=0,s=j;r<s.length;r++)m=s[r],b.Z_J(m)};j(f.Events.ItemRemoving,function(a,b){return function(d,e){b&&(e.relatedViewIndexes=c.U_J(a,e.index))}}),j(f.Events.ItemRemoved,function(a,b,c){return function(d,e){l(a,b,c,e)}}),j(f.Events.ItemInserted,function(a,b,c){return function(d,e){l(a,b,c,e)}}),j(f.Events.ItemUpdating,function(a,d,e){return function(f,g){var h,i,j,k,l,m,n,o,p;if(b.AX())for(j=g.relatedViewIndexes=c.U_J(a,g.index),g.relatedViewValues=[],k=0,l=j;k<l.length;k++)m=l[k],n=void 0,o=void 0,d?(o=b.lFJ(m,(h={},h[e]=!0,h)),n=o[e]):(n=c._getValueByField(a,m),i={},i[a]=n,o=i),p=b.BMJ(m,o).data,g.relatedViewValues[m]=n,b.EWJ(p,n)}}),j(f.Events.ItemUpdated,function(a,d,e){return function(f,g){var h,i,j,k,l,m,n;if(b.AX())for(i=g.relatedViewIndexes||c.U_J(a,g.index),j=0,k=i;j<k.length;j++)l=k[j],m=g.relatedViewValues[l],n=void 0,d?(n=b.lFJ(l,(h={},h[e]=!0,h))[e],a=e):n=c._getValueByField(a,l),b.LNJ(l,a,m,n),c.LNJ(l,a,m,n)}})}})},"./dist/src/view/view-filter.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/src/dataSource/utils.js"),e=c("./dist/src/table/table.js"),f=c("./dist/src/view/view-util.js"),g=c("Common"),h=c("./dist/src/view/view.js"),(i=g.Common.j.Ia)(h.View.prototype,{buildInFilter:function(a){var b,c,d,e,g,h,i,j,k,l,m,n=this.uDJ,o={};if(a.length>1){for(b=[],c=[],d=function(d){var g,h=a[d],i=h.field,j=h.operator,k=h.value,l=h.relation,m=o[i];m||(m=o[i]=n.GWJ(i)),c.push(l),g=e.C0J(i,a[d]),g=f.mapGetValueFunc(m,g),g=f.D0J(e,j,k,g),b.push(function(a,b,c){return g(a,c,b[d])})},e=this,g=0;g<a.length;g++)d(g);return f.E0J(b,c)}return h=a[0],i=h.field,j=h.operator,k=h.value,l=n.GWJ(i),m=this.C0J(i,a[0]),m=f.mapGetValueFunc(l,m),m=f.D0J(this,j,k,m,i),function(a,b,c){return m(a,c,b[0])}},SOJ:function(a){var b=this,c=b.GNJ,d=b.uDJ;return d.GNJ[a]||c[a]},TOJ:function(a,b){var c=this,d=c.uDJ,e=c.aFJ,g,h=[],i=[];a.forEach(function(a){g=e.filter(function(b){return b.value===a})[0],g&&(f.isViewColumn(g)?h.push(a):i.push(a))}),d.TOJ(i,b),c.UOJ(h)},UOJ:function(a){var b,c,d,e=this,f=e.GNJ;for(b=0,c=a;b<c.length;b++)d=c[b],f[d]||(f[d]=this.ONJ(d))},C9J:function(){this.GNJ={}},ONJ:function(a){var b=this.nOJ.getFieldByName(a);return e.generateFilterIndexCache(a,this.length(),this.GWJ(a),function(a){return b.getValue(a)})},KNJ:function(a,b){var c=this,d=c.uDJ,f=d._dataSource.options.schema;e.updateFilterIndexesCacheOnInsert(this.GNJ,a,b,f&&f.columns)},LNJ:function(a,b,c,d){var f=this;e.updateFilterIndexesCacheOnUpdate(f.GNJ,a,b,c,d,f.GWJ(b))},CWJ:function(a,b,c){var e,f,g,h,i=this,j=i.aFJ;if(!d.isNullOrUndefined(b)&&!d.isNullOrUndefined(c))for(e=0,f=j;e<f.length;e++)g=f[e],h=g.value instanceof Function?g.value.name:g.value,i.LNJ(a,h,b[h],c[h])},MNJ:function(a,b){var c=this;e.updateFilterIndexesCacheOnRemove(c.GNJ,a,b)},gFJ:function(a){var b,c,e,g,h,i,j,k,l,m,n;if(a){if(b=this,c=b.fFJ,e=[],g=b.ZEJ,h=g.length,g&&h>0&&(e=c.slice(0,h)),i=h,"function"==typeof a)for(k=h;k<c.length;k++)l=c[k],a(b.getRowData(l,!0))&&(e[i]=l,i++);else if(d.isArray(a)||(a=[a]),f.isFieldListFilter(a))m=a[0].field,n=b.SOJ(m),n||(b.TOJ([m]),n=b.SOJ(m)),f.RNJ(e,i,n,a,c);else for(j=this.buildInFilter(a),k=h;k<c.length;k++){l=c[k];try{j(b.uDJ,a,l)&&(e[i]=l,i++)}catch(a){}}b.fFJ=e}},F0J:function(){var a,b,c,d,e,f=this.fFJ,g=this.ZEJ,h=g.length;for(g&&h>0&&(a=f.slice(0,h)),b=[],c=this.length(),d=0,e=0;e<c;e++)(!a||a.indexOf(e)<0)&&(b[d]=e,d++);a&&a.length>0?this.fFJ=a.concat(b):this.fFJ=b},DWJ:function(a){var b=this,c=b.pFJ;b.AX()&&b.autoFilter&&f.addFilterInfoForFieldValue(c,a,b)},EWJ:function(a,b){var c=this,d=c.pFJ;c.AX()&&c.autoFilter&&f.addFilterInfoForFieldValue(d,a,c,b)},RIJ:function(){var a=this;a.TWJ()&&a.filter(a.pFJ)},TWJ:function(){return this.autoFilter&&this.pFJ},AX:function(){var a=this,b=a.pFJ;return d.isArray(b)&&b.length>0},filter:function(a){var b,c=this;return c.fFJ||c.eFJ(),a?c.e7J(a)?(b=c.f7J(),this.fFJ=a.reduce(function(a,c){return a.push(b[c.D7J]),a},[])):(c.gFJ(a),c.isHierarchy()&&c.g7J()):c.isHierarchy()?c.eFJ():this.F0J(),this.pFJ=a,this.fFJ.length},g7J:function(){var a,b,c,e,f,g,h=this,i=h.fFJ;if(!d.isNullOrUndefined(i)&&0!==i.length){for(a=h.f7J(),b=a.reduce(function(a,b){var c=h.getHierarchyNode(b,!0);return a[c.id]=b,a},{}),c=[],e=0;e<i.length;e++)f=i[e],g=h.getHierarchyNode(f,!0),g.visit=!0,d.bubbleTree(g,function(a){a.isRoot||(a.visit=!0)}),d.traversalTree(g,function(a){a.visit=!0});d.traversalTree(h.getHierarchyRootNode(),function(a){a.visit&&(delete a.visit,c.push(b[a.id]))}),h.fFJ=c}},f7J:function(){var a=this,b=a.fFJ,c,e=a.isHierarchy(),f=a.h7J;return e&&!d.isNullOrUndefined(f)?f:(a.eFJ(),a.sort(a.oFJ),c=a.fFJ,a.fFJ=b,e&&(a.h7J=c),c)},e7J:function(a){var b=this;return!(!b.isHierarchy()||"function"==typeof a)&&(d.isArray(a)||(a=[a]),a.some(function(a){return d.isNumber(a.D7J)}))}})},"./dist/src/view/view-group.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/src/view/view.js"),f=c("./dist/src/dataSource/utils.js"),g=c("./dist/src/viewField/groupManager.js"),h=c("./dist/src/viewField/fields.js"),i=c("./dist/src/viewField/utils.js"),j=c("./dist/src/view/view-util.js"),k=d.Common.j.Ia,l=null,m=void 0,k(e.View.prototype,{groupBy:function(a){var b,c=this;return 0===arguments.length||!f.isArray(a)||c.hasHierarchyColumn()?c.wOJ:(b=c.aFJ.filter(function(a){return a.isCross}),a=b.length>0?a.filter(function(a){return!b.some(function(b){return b.value===a.field})}):a,0===a.length?c.wOJ:(c.fFJ||c.eFJ(),c.qOJ(a),c.uOJ(),c.tOJ(a),void(this.wOJ=a)))},removeGroupBy:function(){var a=this;a.isHierarchy()||(a.tRJ(),a.PRJ(),a.uOJ(),a.wOJ=l,a.hRJ(),a.QIJ())},tRJ:function(){var a=this;a.VOJ()},PRJ:function(){var a,b,c,d,e,f=this,g=f.uDJ,h=f.pFJ,i=f.GNJ,k=f.getColumnInfos();if(h){for(e=h.length-1;e>=0;e--)a=h[e],b=k.filter(function(b){return b.name===a.field})[0],b.yPJ?(c=j.getColumnName(k[b.APJ]),d=i[a.field],d&&(g.GNJ[c]=i[a.field],delete i[a.field]),a.field=c):b.isGroup&&(h.splice(e,1),delete i[a.field]);f.pFJ=0===h.length?m:h}},hRJ:function(){var a,b,c,d,e=this;if(e.oFJ){for(a=[],b=0,c=e.oFJ;b<c.length;b++)d=c[b],delete d.fRJ,d.$OJ?g.isGroupField(d.field)&&(delete d.$OJ,delete d.YOJ,d.field=g.getGroupFieldName(d.field),a.push(d)):a.push(d);e.oFJ=0===a.length?m:a}e.pXJ=m,e.oXJ=e.oFJ},qOJ:function(a){var b,c,d,e,f,g,h,i;a&&(this.VOJ(),b=this,c=b.fFJ,d=b.nOJ||b.pOJ(),e=b.rOJ||b.qSJ(a),f=d.buildGroupFields(a,c),g=e.groupBy(f,c),h=g.rootNode,i=g.indexMap,b.rQJ=h,b.fFJ=i,d.transposeSliceFields(f))},VOJ:function(){var a,b=this;b.rOJ=null,null===(a=b.nOJ)||void 0===a?void 0:a.reset(),b.rQJ=null},vOJ:function(a){var b=this;b.autoGroup&&b.wOJ&&(!f.isString(a)||b.GPJ(a))&&b.qOJ(b.wOJ)},GPJ:function(a){var b=this;return b.wOJ&&b.wOJ.some(function(b){return b.field===a||b.summaryFields&&b.summaryFields.some(function(b){return b.formula&&b.formula.indexOf(a)>-1||b.slice&&("string"==typeof b.slice?b.slice.indexOf(a)>-1:b.slice.field&&b.slice.field.indexOf(a)>-1)})})},qSJ:function(a){var b=this,c=b.uDJ,d=c.vDJ;return b.rOJ=new g.GroupManager(a,d.oSJ.bind(d)),b.rOJ},uOJ:function(){var a,b,c=this,d=c.getColumnInfos();for(a=d.length-1;a>=0;a--)b=d[a],b.isGroup&&d.splice(a,1),b.wPJ&&(b.wPJ=m,b.APJ=m);c.setColumnInfos(d)},tOJ:function(a){var b,c,d,e,g,k,l,m,n,o,p,q=this,r=[],s=-1,t=-1,u=j.GROUP_COLUMN_WIDTH,v={},w=function(b){var c,d,e,g=q.aFJ[b];for(c=0,d=a;c<d.length;c++)e=d[c],g.value===e.field&&(g.wPJ=!0,v[i.combineName(g.value,f.findIndex(a,function(a){return a.field===g.value}))]={colInfo:g,index:b})};for(b=0;b<q.aFJ.length;b++)w(b);for(c=q.nOJ,d=c.positionOfField,e=function(b,e){var g,k,l=c.getField(d[b]),m=l.name,n=l.extra.caption,o={caption:n,value:m,name:m,isGroup:!0};t=f.findIndex(a,function(a,b){return i.combineName(a.field,b)===m}),t>-1&&(u=j.getGroupColumnWidth(a[t].field,q.aFJ),s=t,o.yPJ=!0,g=v[m],f.isNullOrUndefined(g)||(g.colInfo.APJ=b,o.APJ=g.index+e)),o.YOJ=s,o.width=u,k=l.extra,k&&h.setFieldExtraProperties(function(a){k[a]&&(o[a]=k[a])}),r.push(o)},g=0,k=d.length-c.keysOfBaseField.length;g<k;g++)e(g,k);for(l=q.mPJ,m=q.getColumnInfos(),n=0,o=m;n<o.length;n++)p=o[n],l||(p.visible=!1),r.push(p);q.setColumnInfos(r)},KSb:function(a){var b,c,d,e,g,h,i,j,k,l;if(a){for(b=this,c=b.rQJ,d=[],e=b.aFJ,g=Array.isArray(a)?a:[a],h=[],i=[],j=function(a){var c=g[a],d=e.filter(function(a){return a.value===c.field})[0];d&&f.isNumber(d.YOJ)?(c.$OJ=!0,c.fRJ=b.UMJ([c]),c.YOJ=d.YOJ,h.push(c)):i.push(c)},k=0;k<g.length;k++)j(k);l=b.UMJ(i),i.forEach(function(a){return a.fRJ=l}),b.gRJ(c,d,0,h,i),b.fFJ=d}},gRJ:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o=this,p=a.children;for(p.length>1&&d.length>0&&(h=d.filter(function(a){return a.YOJ===c}),h.length>0&&(i=h[0].fRJ,p.sort(function(a,b){return i(o.uDJ,h,a.key,b.key)}))),j=0,k=p;j<k.length;j++)if(l=k[j],g=l.recordIndexes)for(g.length>1&&e.length>0&&(h=e,i=h[0].fRJ,g.sort(function(a,b){return i(o.uDJ,h,a,b)})),f=b.length,m=0,n=g.length;m<n;m++)b[f+m]=g[m];else o.gRJ(l,b,c+1,d,e)},setGroupSliceColumnSettings:function(a,b){var c=this,d=a[b];a.isGroup&&c.isGroupSliceColumn(a)&&c.getGroupSliceColumns(a).forEach(function(a){return a[b]=d})},isGroupSliceColumn:function(a){return a.isGroup&&g.isGroupSlice(a.value)},getGroupSliceColumns:function(a){var b,c,d=this,e=[],f=a.YOJ,h=d.aFJ;if(a.isGroup)for(b=0;b<h.length;b++)c=h[b],c.YOJ===f&&g.isGroupSlice(c.value)&&e.push(c);return e},updateColumnSettingToGroupOptions:function(a,b){var c,d,e,i=this,j=i.wOJ;if(j&&a.isGroup)switch(c=g.getGroupOptionIndexesFrom(a.value),d=function(a,c){h.setFieldExtraProperties(function(d){(f.isNullOrUndefined(b)||b===d)&&(a[d]=c[d])})},c.length){case 1:d(j[c[0]],a);break;case 2:d(j[c[0]].summaryFields[c[1]],a);break;case 3:e=j[c[0]].summaryFields[c[1]].slice,"string"==typeof e&&(e=j[c[0]].summaryFields[c[1]].slice={field:e}),d(e,a)}},detailColumnsVisible:function(a){var b,c,d,e=this;if(0===arguments.length)return e.mPJ;if(e.mPJ!==a&&(e.mPJ=a,e.rOJ))for(b=e.getColumnInfos(),c=e.nOJ,d=c.positionOfField.length-c.keysOfBaseField.length;d<b.length;d++)b[d].visible=a}})},"./dist/src/view/view-sort.js":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/src/dataSource/utils.js"),f=c("./dist/src/view/view.js"),g=c("./dist/src/view/view-util.js"),h=d.Common.j.Ia;function i(a){return a.fFJ.reduce(function(b,c){var d=a.getHierarchyNode(c,!0);return e.isNullOrUndefined(d)||(b[d.id]=c),b},{})}function j(a,b){return function(c){e.isNullOrUndefined(a[c.id])||b.push(a[c.id])}}h(f.View.prototype,{TMJ:function(a){var b,c,d={},f=this.C0J(a,d);for(b=0;b<this.fFJ.length;b++)if(c=f(d,b,d),!e.isNullOrUndefined(c))return c;return null},UMJ:function(a,b){var c,d,f,h,i,j,k;if(1===a.length)return b=b||0,c=a[0],d=this.C0J(c.field,c),f=void 0,c.compare?f=function(a,c,e,f){var g=d(a,e,c[b]),h=d(a,f,c[b]);return c[b].compare(g,h,c[b].ascending)}:(h=this.TMJ(c.field),null===h?f=function(){return 0}:(i=c.ascending,f=function(a,c,e,f){var j=d(a,e,c[b]),k=d(a,f,c[b]);return g.compareValue(i,h,j,k)})),f;for(j=0;j<a.length;j++)c=a[j],k=this.RMJ(c.field),k.isGroup&&e.isNullOrUndefined(c.ascending)&&(c.compare=function(a,b){return a===b?0:1}),c.XOJ=this.UMJ([c],j);return g.multiSort},iFJ:function(a){if(a){var b=this;if(b.isHierarchy())return b.h7J=null,b.oXJ=g.getSortInfos(a),void b.i7J(a);if(b.wOJ)return b.pXJ=g.getSortInfos(a),void b.KSb(a);b.oXJ=g.getSortInfos(a),b.KWJ(a)}},KWJ:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;a&&(b=this,c=b.fFJ,e=b.ZEJ,f=e.length,e&&f>0&&(d=c.slice(0,f),c=c.slice(f)),g=Array.isArray(a)?a:[a],h=b.UMJ(g),i=g[0],j=i.startRow,k=void 0===j?0:j,l=i.endRow,m=void 0===l?b.length():l,n=c.slice(0,k),o=c.slice(k,m),o.sort(function(a,c){return h(b.uDJ,g,a,c)}),p=c.slice(m),q=n.concat(o,p),d&&d.length>0?b.fFJ=d.concat(q):b.fFJ=q)},j7J:function(){var a,b=this,c=b.uDJ.c7J();return!e.isNullOrUndefined(c)&&e.isNullOrUndefined(b.oFJ)?((!b.fFJ||b.fFJ.length<b.length())&&(b.fFJ=b.l7J()),b.fFJ&&b.fFJ.length>0&&(a={field:c,ascending:!0},b.isHierarchy()?b.i7J(a):b.KWJ(a)),!0):e.isNullOrUndefined(c)&&e.isNullOrUndefined(b.oFJ)&&b.isHierarchy()?((!b.fFJ||b.fFJ.length<b.length())&&(b.fFJ=b.l7J()),b.fFJ&&b.fFJ.length>0&&b.R9J(),!0):void 0},i7J:function(a){var b,c,d,f,g,h;a&&(b=this,c=b.getHierarchyRootNode(),d=[],f=Array.isArray(a)?a:[a],g=i(b),h=b.UMJ(f),f.forEach(function(a){return a.fRJ=h}),e.traversalTree(c,j(g,d),{compareFn:function(c,d){return a=f,h=a[0].fRJ,e.isNullOrUndefined(g[c.id])||e.isNullOrUndefined(g[d.id])?0:h(b.uDJ,a,g[c.id],g[d.id])}}),b.fFJ=d)},R9J:function(){var a=this,b=a.getHierarchyRootNode(),c=[],d=i(a);e.traversalTree(b,j(d,c),{field:"sequence",isOrderChildren:!1}),a.fFJ=c},QIJ:function(){var a=this;a.SWJ()&&a.sort(a.oFJ)},SWJ:function(){return this.autoSort&&this.oFJ},sort:function(a){var b=this;b.fFJ||b.eFJ(),b.iFJ(a),this.oFJ=a},qXJ:function(a){var b=this,c=b.autoSort,d=b.oXJ&&b.oXJ.length>0,e=b.pXJ&&b.pXJ.length>0;c&&d&&(b.isHierarchy()?b.i7J(b.oXJ):b.KWJ(b.oXJ)),b.vOJ(a),c&&e&&b.KSb(b.pXJ)}})},"./dist/src/view/view-style.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/src/view/view.js"),(f=d.Common.j.Ia)(e.View.prototype,{getStyleRules:function(){return this.i6.styleRules},getStyleRule:function(a){var b=this.getStyleRules();return b[a]},addStyleRule:function(a,b,c){var d,e;a&&(d={},b&&(d.style=b),c&&(d.rule=c),e=this.getStyleRules(),e[a]=d)},removeStyleRule:function(a){var b=this.getStyleRules();delete b[a]},clearStyleRules:function(){this.i6.styleRules={}}})},"./dist/src/view/view-util.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k=this&&this.__assign||function(){return k=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},k.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),b.G0J=b.RNJ=b.mapGetValueFunc=b.E0J=b.removeExtraInfos=b.addFilterInfoForFieldValue=b.isRelation=b.isFormula=b.isFieldListFilter=b.isViewColumn=b.isTableDataReady=b.getColumnName=b.getGroupColumnWidth=b.applyDateTimePicker=b.array_find=b.generatePinnedColumnIndexMap=b.getSortInfos=b.multiSort=b.D0J=b.compareValue=b.GROUP_COLUMN_WIDTH=void 0,d=c("Common"),e=c("./dist/src/dataSource/utils.js"),f=["eq","neq","lt","lte","gt","gte"],g=["startswith","doesnotstartwith","endswith","contains"],h=["doesnotendwith","doesnotcontain"],i=null,j=void 0,b.GROUP_COLUMN_WIDTH=100;function l(a,b,c,d){var f=a?c:d,g=a?d:c;return e.isNullOrUndefined(f)&&e.isNullOrUndefined(g)?0:e.isNullOrUndefined(f)?-1:e.isNullOrUndefined(g)?1:"number"==typeof b||b instanceof Date?f-g:f>g?1:f<g?-1:0}b.compareValue=l;function m(a,b,c,d,e){var i,j;if(c instanceof Date)if(f.indexOf(b)>-1)c=c.getTime(),i=d,d=function(a,b,c){return i(a,b,c)&&i(a,b,c).getTime()};else{if(g.indexOf(b)>-1)return function(){return!1};if(h.indexOf(b)>-1)return function(){return!0}}return j=n(a,b,c,e),function(a,b,c){return j(d(a,b,c))}}b.D0J=m;function n(a,b,c,f){var g,h,k,l,m,n=c+"",r=n&&n.length;switch(e.isString(c)&&(g=d.Common.q.ub(c)),h=a.uDJ,b){case"eq":return k=function(a){return a===c},e.isNullOrUndefined(c)&&(k=function(a){return a===i||a===j}),g?function(a){return RegExp("^"+g+"$").test(a)}:k;case"neq":return l=function(a){return a!==c},e.isNullOrUndefined(c)&&(l=function(a){return a!==i&&a!==j}),g?function(a){return!RegExp("^"+g+"$").test(a)}:l;case"lt":return function(a){return null!==a&&a<c};case"lte":return function(a){return null!==a&&a<=c};case"gt":return function(a){return a>c};case"gte":return function(a){return a>=c};case"startswith":return g?function(a){return RegExp("^"+g).test(a)}:function(a){return(a+"").substr(0,r)===c};case"doesnotstartwith":return g?function(a){return!RegExp("^"+g).test(a)}:function(a){return(a+"").substr(0,r)!==c};case"endswith":return g?function(a){return RegExp(g+"$").test(a)}:function(a){return(a+"").indexOf(c,(a+"").length-r)!==-1};case"doesnotendwith":return g?function(a){return!RegExp(g+"$").test(a)}:function(a){return(a+"").indexOf(c,(a+"").length-r)===-1};case"contains":return g?function(a){return RegExp(g).test(a)}:function(a){return(a+"").indexOf(c)>=0};case"doesnotcontain":return g?function(a){return!RegExp(g).test(a)}:function(a){return(a+"").indexOf(c)<0};case"top":case"bottom":return m=a.SOJ(f),m||(a.TOJ([f]),m=a.SOJ(f)),c=o(Object.keys(m),b,c),function(a){return c.indexOf(a)>-1};case"above":return c=p(h._dataSource._data[f].data,h.GWJ(f)),function(a){return a>c};case"below":return c=p(h._dataSource._data[f].data,h.GWJ(f)),function(a){return a<c};case"quarter":return function(a){return q(c,a)};case"month":return function(a){return(a&&a.getMonth())===c};default:return function(){return!1}}}function o(a,b,c){var d,e,f,g=[];for(d=0,e=a;d<e.length;d++)f=e[d],isNaN(f)||g.push(parseFloat(f));return c>=g.length?g:("top"===b?g=u(g,c):"bottom"===b&&(g=x(g,c)),g)}function p(a,b){var c,d,e,f,g=0;if(!a||0===a.length)return g;for(c=b&&b.dataMap,d=0,e=a;d<e.length;d++)f=e[d],c&&"number"==typeof c[f]&&(f=c[f]),"number"==typeof f&&(g+=f);return g/a.length}function q(a,b){var c=b&&b.getMonth();switch(a){case 0:return c<=2;case 1:return c>=3&&c<=5;case 2:return c>=6&&c<=8;case 3:return c>=9;default:return!1}}function r(a,b,c,d){var e,f,g,h=0;for(e=0,f=b.length;e<f&&(g=b[e],h=g.XOJ(a,b,c,d),0===h);e++);return h}b.multiSort=r;function s(a){return Array.isArray(a)?a:[a]}b.getSortInfos=s;function t(a,b){var c,d;if(0===a.length)return[];for(c=a.slice(0),d=0;d<b;d++)a.indexOf(d)===-1&&c.push(d);return c}b.generatePinnedColumnIndexMap=t;function u(a,b){var c,d,e=v(a.slice(0,b));for(c=b;c<a.length;c++)a[c]>e[0]&&(d=e[0],e[0]=a[c],a[c]=d,v(e));return e}function v(a){var b,c=a.length;for(b=Math.floor(c/2);b>=0;b--)w(a,b,c);return a}function w(a,b,c){var d,e=2*b+1,f=2*b+2,g=b;e<c&&a[e]<a[g]&&(g=e),f<c&&a[f]<a[g]&&(g=f),b!==g&&(d=a[b],a[b]=a[g],a[g]=d,w(a,g,c))}function x(a,b){var c,d,e=y(a.slice(0,b));for(c=b;c<a.length;c++)a[c]<e[0]&&(d=e[0],e[0]=a[c],a[c]=d,y(e));return e}function y(a){var b,c=a.length;for(b=Math.floor(c/2);b>=0;b--)z(a,b,c);return a}function z(a,b,c){var d,e=2*b+1,f=2*b+2,g=b;e<c&&a[e]>a[g]&&(g=e),f<c&&a[f]>a[g]&&(g=f),b!==g&&(d=a[b],a[b]=a[g],a[g]=d,z(a,g,c))}function A(a,b){var c,d,e,f;for(c=0,d=a;c<d.length;c++)if(e=d[c],f=b(e))return f}b.array_find=A;function B(a){var b,c,d,e=a.style;e||(e=a.style={}),b=e.cellButtons,b||(b=e.cellButtons=[]),c=e.dropDowns,c||(c=e.dropDowns=[]),d=A(b,function(a){return"openDateTimePicker"===a.command}),d||b.push({imageType:"dropdown",command:"openDateTimePicker",useButtonStyle:!1,buttonBackColor:"transparent"}),d=A(c,function(a){return"dateTimePicker"===a.type}),d||c.push({type:"dateTimePicker",option:{showTime:!1,calendarPage:"day",startDay:"sunday"}})}b.applyDateTimePicker=B;function C(a,c){var d,f=e.findIndex(c,function(b){return D(b)===a});return f>-1?(d=c[f],d.width||b.GROUP_COLUMN_WIDTH):b.GROUP_COLUMN_WIDTH}b.getGroupColumnWidth=C;function D(a){var b=a.value;return"string"==typeof b?b:"function"==typeof b?b.name:void 0}b.getColumnName=D;function E(a){return!a.DEJ}function F(a){var b,c,d,e,f=E(a);if(f){for(a.B_J++,b=a.WEJ(),c=0,d=b;c<d.length&&(e=d[c],!e||e.B_J||(f=F(e),f));c++);a.B_J--}return f}b.isTableDataReady=F;function G(a){return a.isGroup||a.isCross}b.isViewColumn=G;function H(a){return a[0].operator===j}b.isFieldListFilter=H;function I(a){return a[0].operator!==j&&a[0].HXJ}function J(a){return"="===a[0]}b.isFormula=J;function K(a){return a.indexOf(".")>-1}b.isRelation=K;function L(a,b,c,d){var f,g,h,i={},j=function(f){var g,h,j,l,m,n,o,p,q,r;if(f&&!i[f.field]){if(i[f.field]=!0,g=c.SOJ(f.field),g||(c.TOJ([f.field]),g=c.SOJ(f.field)),h=g&&Object.keys(g),j=b[f.field],l=void 0,j instanceof Date){for(m=new Date(j),m.setHours(0,0,0,0),n=m.toISOString().slice(0,10),l=!0,o=0,p=h;o<p.length;o++)if(q=p[o],q.startsWith(n)){l=!1;break}}else l=e.isNullOrUndefined(j)?h.indexOf("null")===-1&&h.indexOf("undefined")===-1:h.indexOf(j+"")===-1;if(!a.some(function(a){return a.field===f.field&&a.value===j})&&l&&(H(a)?a.push(k(k({},f),{value:j,isAdded:!0})):(I(a)||j===d&&void 0===d)&&a.push(k(k({},f),{value:j,operator:"eq",relation:"or",isAdded:!0}))),h.indexOf(d+"")>-1&&1===g[d].length&&d!==j)for(r=0;r<a.length;r++)if(a[r].value===d&&a[r].isAdded){a.splice(r,1);break}}};for(f=0,g=a;f<g.length;f++)h=g[f],j(h)}b.addFilterInfoForFieldValue=L;function M(a){var b,c,d,f,g;if(!e.isNullOrUndefined(a)){for(b=[],c=0,d=a;c<d.length;c++)f=d[c],g=k({},f),g.getValue&&delete g.getValue,b.push(g);return b}return a}b.removeExtraInfos=M;function N(a,b){var c=function(){var c,d=[],e=[a[0]];for(c=1;c<a.length;c++)"or"===b[c]?(d.push(e),e=[a[c]]):e.push(a[c]);return e.length>0&&d.push(e),d},d=function(a,b,c,d){return d.every(function(d){return d(a,b,c)})},e=c();return function(a,b,c){return e.some(function(e){return d(a,b,c,e)})}}b.E0J=N;function O(a,b){if(a&&a.dataMap){var c=JSON.parse(JSON.stringify(a.dataMap));return function(a,d,e){var f=b(a,d,e);return void 0!==c[f]?c[f]:f}}return b}b.mapGetValueFunc=O;function P(a,b,c,d,e){var f,g,h,k,l,m,n,o,p,q,r,s,t=[],u=!1,v=!1,w=d.map(function(a){var b=a.value;return b===i&&(u=!0),b===j&&(v=!0),a.value});for(u&&!v&&w.push(j),v&&!u&&w.push(i),f=0,g=w;f<g.length;f++)for(h=g[f],k=c&&c[h]||[],l=0,m=k;l<m.length;l++)n=m[l],t[n]=!0;for(o=b,p=a.reduce(function(a,b){return a[b]=!0,a},{}),q=0,r=e;q<r.length;q++)s=r[q],t[s]&&(b>0?p[s]||(a[o]=s,o++):(a[o]=s,o++))}b.RNJ=P;function Q(a,b,c,d,f,g,h){var i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=[],A=d.map(function(a,b){return b}),B=[];if(f&&f.length&&(A=[],i=!1,d.forEach(function(a,b){g.indexOf(b)>-1?(z.push(b),A.push(j)):(z.push(j),A.push(b)),a.isCross&&(i=!0)}),a=f[a],b=f[b],i)){for(k=[],l=[],m=0;m<d.length;m++)d[m].isCross?(k[d[m].c0J]||(k[d[m].c0J]=[],B.push(k[d[m].c0J])),n=k[d[m].c0J],n.push(m)):B.push(m),a===m&&(a=B.length-1),b===m&&(b=B.length-1);for(o=0,p=g;o<p.length;o++)q=p[o],l.push(B.indexOf(q));z=[],A=[],B.forEach(function(a,b){l.indexOf(b)>-1?(z.push(b),A.push(j)):(z.push(j),A.push(b))}),c=1}if(e.swapArrayItems(A,a,b,c),A=A.filter(function(a){return!e.isNullOrUndefined(a)}),f&&f.length){for(m=0;m<z.length;m++)void 0===z[m]&&(z[m]=A.shift());if(B&&B.length){for(r=[],s=0;s<z.length;s++)if(t=z[s],Array.isArray(B[t])){if(u=h[s].cross,"string"==typeof u){for(v=[z[s]];s+1<h.length&&u===h[s+1].cross;)v=v.concat(z[s+1]),s++;for(w=B[v[0]].length,x=[],y=0;y<w;y++)for(m=0;m<v.length;m++)x.push(B[v[m]][y]);r=r.concat(x);continue}r=r.concat(B[t])}else r.push(B[t]);z=r}}else z=A;return z}b.G0J=Q},"./dist/src/view/view.entry.js":function(a,b,c){"use strict";var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c),Object.defineProperty(a,d,{enumerable:!0,get:function(){return b[c]}})}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||b.hasOwnProperty(c)||d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),e(c("./dist/src/view/view.js"),b),e(c("./dist/src/view/view-style.js"),b),e(c("./dist/src/view/view-event.js"),b),e(c("./dist/src/view/view-group.js"),b),
e(c("./dist/src/view/view-sort.js"),b),e(c("./dist/src/view/view-filter.js"),b),e(c("./dist/src/view/view-cross.js"),b)},"./dist/src/view/view.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l=this&&this.__assign||function(){return l=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},l.apply(this,arguments)},m=this&&this.__spreadArrays||function(){var a,b,c,d,e,f,g,h;for(a=0,b=0,c=arguments.length;b<c;b++)a+=arguments[b].length;for(d=Array(a),e=0,b=0;b<c;b++)for(f=arguments[b],g=0,h=f.length;g<h;g++,e++)d[e]=f[g];return d};Object.defineProperty(b,"__esModule",{value:!0}),b.View=void 0,d=c("./dist/src/dataSource/utils.js"),e=c("./dist/src/interfaces/interface.js"),f=c("./dist/src/view/view-util.js"),g=c("./dist/src/viewField/fieldManager.js"),h=c("Common"),i=null,j=void 0;function n(a){return a instanceof Date&&!isNaN(a.valueOf())}function o(a){return h.Common.l.Daa(a)}function p(a){var b=h.Common.l.Rka(a);return b&&!n(b)&&(b=h.Common.l.Yb(a)),n(b)?b:null}k=function(){function a(a,b,c,e){void 0===c&&(c=!0),void 0===e&&(e={}),this.YEJ=10,this.ZEJ=[],this.$EJ=[],this._EJ=[],this.GNJ={},this.OG=!1,this.o0J={};var f=this;f.name=a,Object.defineProperty(f,"tableName",{get:function(){var a;return null===(a=f.uDJ)||void 0===a?void 0:a.name}}),b||(b=[]),f.h0J=d.clone(b),f.aFJ=b.map(function(a){return"string"==typeof a?a={name:a,value:a}:a.name||"string"!=typeof a.value||(a.name=a.value),a.value&&"="===a.value[0]&&(a.readonly=!0),a}),f.bFJ=c,f.autoSort=!0,f.autoFilter=!1,f.autoGroup=!0,f.mPJ=!0,f.i6=e,e.styleRules||f.clearStyleRules()}return a.prototype.A0J=function(){var a=this,b=a.uDJ;return f.isTableDataReady(b)},a.prototype.F4J=function(a,b,c){var d=this.uDJ;return d&&d.F4J(a,b,c)},a.prototype.G4J=function(a,b,c){var d=this.jFJ(b),e=this.R0J(c);return this.K9J(a,d,e)},a.prototype.K9J=function(a,b,c){var d=this.uDJ;return d&&d.G4J(a,b,c)},a.prototype.H0J=function(){var a,b,c,e,f=this,g=f.uDJ;if(g){if(f.bFJ&&(a=g.columns,b=f.aFJ,a&&b.length<=0))for(c in a)a.hasOwnProperty(c)&&(e=a[c],b.push(d.clone(e)));f.LMJ(),f.IRJ()}},a.prototype.REJ=function(a){var b=this;return a?(b.uDJ=a,b.z0J(),b.a0J()?b.A0J()&&(b.pOJ(),b.H0J()):b.H0J(),b.A0J()&&(b.w4J(),b.x4J=!0),void b.AJ()):(b.Lva(),void(b.uDJ=a))},a.prototype.LMJ=function(){var a,b,c,e,g,h,i,j,k,l,m,n,o,p=null===(b=null===(a=this.uDJ._dataSource.options)||void 0===a?void 0:a.schema)||void 0===b?void 0:b.columns;if(p)for(c=this.aFJ,e=this.isHierarchy(),g=e&&this.uDJ._dataSource.options.schema.hierarchy.column,h=["caption","width","style","conditionalFormats","validator","isPrimaryKey","readonly","required","defaultValue","headerStyle","visible","headerFit","indexed","allowSort","allowFilterByValue","allowFilterByList","dataMap","lookup"],i=0,j=c;i<j.length;i++)if(k=j[i],"string"==typeof k.value&&(l=p[k.value])){for(m=0,n=h;m<n.length;m++)o=n[m],d.isNullOrUndefined(k[o])&&(k[o]=l[o]);k.dataType=l.dataType,"date"===l.dataType&&f.applyDateTimePicker(k),!e||k.value!==g&&"rowOrder"!==l.dataType||(k.readonly=!0),l.EhK&&"rowOrder"!==l.dataType&&(k.readonly=!1,delete l.EhK)}},a.prototype.IRJ=function(){var a,b,c,e=this.i6.defaultColumnWidth||60,f=this.aFJ;for(a=0,b=f;a<b.length;a++)c=b[a],d.isNullOrUndefined(c.width)&&(c.width=e)},a.prototype.eFJ=function(a){this.j7J()||(this.fFJ=this.l7J(a))},a.prototype.l7J=function(a){var b,c,d=[],e=a||this.length(),f=this.ZEJ,g=f.length;for(g>0&&(d=f.slice(0)),b=g,c=0;c<e;c++)f.indexOf(c)===-1&&(d[b]=c,b++);return d},a.prototype.RMJ=function(a){var b,c,d=this.aFJ;for(b=0;b<d.length;b++)if(c=d[b],c.value===a||c.caption===a)return this.uDJ.columns[c.value]?c.value:f.isViewColumn(c)?{value:c.value,isGroup:c.isGroup,isCross:c.isCross}:{value:c.value};return a===this.uDJ.c7J()?a:i},a.prototype.C0J=function(a,b){var c,e,g=this,h=this.RMJ(a),i=this.uDJ,j=this.nOJ;return b?f.isViewColumn(h)?(b.getValue=j.getFieldByName(h.value),function(a,b,c){return c.getValue.getValue(b)}):h.value?(b.getValue=i.BEJ[h.value],d.isNullOrUndefined(b.getValue)&&(b.getValue={getValue:function(a){return g.uDJ._getValueByField(h.value,a)}}),function(a,b,c){return c.getValue.getValue(b)}):(b.getValue=i._dataSource._data[h].data,function(a,b,c){return c.getValue[b]}):(c=h.value+"",e=h+"",h.value?function(a,b){return a._getValueByField(c,b)}:function(a,b){return a._dataSource._data[e].data[b]})},a.prototype.GWJ=function(a){return j},a.prototype.pOJ=function(){var a=this,b=a.uDJ;return a.fFJ||a.eFJ(),a.nOJ=new g.FieldManager(a.i6,b),a.j0J(),a.aFJ=a.nOJ.prepareFields(a.aFJ),a.W_J(),a.nOJ},a.prototype.getLookup=function(a){return g.getLookupBy(this.uDJ,a)},a.prototype.isLookupField=function(a){return g.isLookupField(this.uDJ,a)},a.prototype.isLookupListField=function(a){return g.isLookupListField(this.uDJ,a)},a.prototype.isLookupRelationField=function(a){return g.isLookupRelationField(this.uDJ,a)},a.prototype.jFJ=function(a){return this.fFJ||this.eFJ(),this.fFJ[a]},a.prototype.kFJ=function(a){return this.fFJ||this.eFJ(),this.fFJ.indexOf(a)},a.prototype.length=function(){return this.uDJ.length()},a.prototype.visibleLength=function(){return this.fFJ||this.eFJ(),this.fFJ.length},a.prototype.getDirtyIndexes=function(){var a=this;return a.uDJ.getDirtyIndexes().map(function(b){return a.kFJ(b)})},a.prototype.isInserted=function(a){var b=this,c=b.jFJ(a);return b.I0J(c)},a.prototype.I0J=function(a){return this.uDJ.isInserted(a)},a.prototype.isUpdated=function(a){var b,c=this,d=c.jFJ(a);return c.OG=!0,b=c.uDJ.isUpdated(d),c.OG=!1,b},a.prototype.getErrorInfo=function(a){var b=this,c=b.jFJ(a);return this.uDJ.getErrorInfo(c)},a.prototype.insertItem=function(a,b,c,d){var e,f=this;return f.isHierarchy()?(e=f.visibleLength(),void(a<e?f.addHierarchyItemBefore(a,b,c,d):f.addHierarchyItemAfter(e-1,b,c,d))):f.m7J(a,b,c,d)},a.prototype.m7J=function(a,b,c,e){var f,g,h,i,j,k,l,m,n,o,p=this,q=p.r0J(c,e),r=q.success,s=q.fail,t=p.visibleLength();return a=a>t?t:a,f=p.jFJ(a),g=p.AMJ(b),p.RWJ(g),d.isNullOrUndefined(f)&&(p.AX()?(f=p.length(),p.DWJ(g)):f=a),h=p.uDJ.c7J(),i=!d.isNullOrUndefined(h),j=p.isHierarchy(),k=f,l=a<t,i&&!j&&(m=void 0,n=void 0,o=!1,l?(m=p.jFJ(a-1),n=k):(n=p.jFJ(a-1),o=!0),g[h]=p.uDJ.C6J(m,n,o)),(i||j)&&(k=p.AX()?p.length():t),p.uDJ.insertItem(k,g,function(b){p.s0J(k,g,l,a),r&&r(b)},s)},a.prototype.s0J=function(a,b,c,e){var f,g,h,i,k,l=this;return c?(f=l.length()-1,l.KNJ(f,b),g=l.autoFilter,h=!d.isNullOrUndefined(l.pFJ),h&&(l.autoFilter=!0),d.isNumber(e)&&!l.SWJ()?l.fFJ.splice(e,0,f):l.fFJ.push(f),l.rWJ(j,!h),void(h&&(l.autoFilter=g))):(l.KNJ(a,b),i=l.length(),k=!l.autoFilter&&!!l.fFJ,k&&l.fFJ.push(i-1),void l.rWJ(i,k))},a.prototype.AMJ=function(a){var b,c,e,f,g,h,i,j={};if(this.isHierarchy())for(b in a)a.hasOwnProperty(b)&&(j[b]=a[b]);for(c=this.aFJ,e=0,f=c;e<f.length;e++)g=f[e],b=g.value instanceof Function?g.value.name:g.value,h=a[b],d.isUndefined(h)||(i=g.value,"string"==typeof i?j[i]=h:i(j,h));return j},a.prototype.J0J=function(a,b,c){var e,f,g,h,i,j=this,k=j.nOJ,l=j.uDJ,m=k.getFieldByPosition(b),n=l.O_J(m.valueRelation,a);if(m.isOneToMany){if(n=n&&d.isNumber(m.getValueIndex(a)),!n&&(g=!1,l.P_J(m.valueRelation,a,(e={},e[m.dimRelationKey]=m.getDimValue(),e),function(b){k.setCrossFieldInsertedIndex(m,a,b.index),g=!0},c),!g))return}else if(n){if(i=!1,l.N_J(m.dimRelationPath,a,m.getDimValue(),function(){i=!0},c),!i)return}else if(h=!1,l.P_J(m.valueRelation,a,(f={},f[m.dimRelationKey]=m.getDimValue(),f),function(){h=!0},c),!h)return;return m.getRelationField(a)},a.prototype.updateItem=function(a,b,c,e,f){var g,h,j,k,l,m=f&&f.hasAddNewRowData,n=f&&f.currentModelIndex,o=this,p=m?n:o.jFJ(a),q=o.BMJ(p,b),r=q.colIndex,s=q.isCross;return s&&(h=o.nOJ,j=h.getFieldByPosition(r),j.isOneToMany||(k=h.getFields(function(a){return a.initialOptionIndex===j.initialOptionIndex&&a.name!==j.name&&!d.isNullOrUndefined(a.getValueIndex(p))}),k.length>0&&(l=k[0].name,o.eBc(a,(g={},g[l]=i,g),i,i,f)))),o.eBc(a,b,c,e,f)},a.prototype.eBc=function(a,b,c,e,f){var g=f&&f.hasAddNewRowData,h=f&&f.currentModelIndex,i=this,j=i.r0J(c,e),k=j.success,l=j.fail,m=g?h:i.jFJ(a),n=i.BMJ(m,b),o=n.data,p=n.originValueOfField,q=n.field,r=n.colIndex,s=n.isCross,t=n.isValueFunction,u=o[q],v=q;if(s){if(i.I0J(m))return void l();if(v=i.J0J(m,r,l),d.isNullOrUndefined(v))return void l()}return t?(i.t0J(o,p),i.uDJ.eBc(m,o,q,p,function(a){i.u0J(m,q,p,o[q]),k(a)},l)):(i.t0J(o,p),i.uDJ.N_J(v,m,u,function(a){i.u0J(m,q,p,o[q]),k(a)},l))},a.prototype.t0J=function(a,b){var c=this;c.RWJ(a),c.EWJ(a,b)},a.prototype.u0J=function(a,b,c,d){var e=this;e.LNJ(a,b,c,d),e.rWJ(j,!0,b,j)},a.prototype.BMJ=function(a,b){var c,e,f,g,h,i,j,k,m,n,o=this.getRowData(a,!0),p=l({},o),q=this.aFJ,r=0,s=0,t=!1,u=!1;for(f=0,g=q;f<g.length;f++){if(h=g[f],i=h.value instanceof Function?h.value.name:h.value,j=b[i],!d.isUndefined(j))if(k=h.value,"string"==typeof k){if(m=h.dataMap)for(n in m)j===m[n]&&(j=isNaN(n)?n:+n);c=p[k],p[k]=j,e=k,s=r,t=h.isCross}else u=!0,k(p,j);r++}return{data:p,originValueOfField:c,field:e,colIndex:s,isCross:t,isValueFunction:u}},a.prototype.resetItem=function(a,b,c){var e=this,f=e.r0J(b,c),g=f.success,h=f.fail,i=e.jFJ(a),j=this.getRowData(i,!0),k=e.zPJ(i);return d.isNullOrUndefined(a)||d.isNullOrUndefined(i)?void h():e.uDJ.resetItem(i,function(a){e.v0J(i,j,k),g(a)},h)},a.prototype.v0J=function(a,b,c){var d=this;d.Z_J(a),d.CWJ(a,b,c),d.rWJ(j,!0,j,j)},a.prototype.saveItem=function(a,b,c){var d=this,e=d.r0J(b,c),f=e.success,g=e.fail,h=d.jFJ(a);return d.uDJ.saveItem(h,function(a){f(a)},g)},a.prototype.getRowData=function(a,b,c){var d=this,e=b?a:d.jFJ(a);return d.lFJ(e,c)},a.prototype.S9J=function(a){return this.isHierarchy()&&this.H7J(a)},a.prototype.H7J=function(a,b){var c=this,e=c.uDJ.c7J(),f=c.isHierarchy(),g=f||!d.isNullOrUndefined(e),h=d.isNullOrUndefined(c.wOJ),i=!(c.ZEJ.length>0)||c.ZEJ.length<a&&(!d.isNumber(b)||c.ZEJ.length<b);return g&&h&&i},a.prototype.I7J=function(){var a=this;return!!d.isNullOrUndefined(a.oFJ)||!!a.oFJ[0].ascending},a.prototype.T9J=function(a,b){var c,d,e=this,f=e.getHierarchyNode(a).parent;if(b){for(d=a+1;d<e.visibleLength();d++)if(e.getHierarchyNode(d).parent===f){c=d;break}}else for(d=a-1;d>=0;d--)if(e.getHierarchyNode(d).parent===f){c=d;break}return c},a.prototype.E6J=function(a,b){var c,d,e,f,g,h,i,k,l,n,o,p=this;if(a!==b&&p.H7J(a,b)){if(c=p.isHierarchy(),d=a<b,e=d?b+1:b-1,c&&1===Math.abs(a-b)&&(b=p.T9J(a,d)),f=p.uDJ.E6J(d,p.jFJ(a),p.jFJ(b),p.jFJ(e))){if(g=p.fFJ,h=p.jFJ(a),i=1,k=[h],c)for(i=p.uDJ.W6J(h),k=[],l=a,n=l+i;l<n;l++)k.push(p.jFJ(l));d?(o=p.uDJ.W6J(p.jFJ(b)),g.splice.apply(g,m([b+o,0],k)),g.splice(a,i)):(g.splice(a,i),g.splice.apply(g,m([b,0],k))),p.h7J=j}return f}},a.prototype.moveUp=function(a){var b=this,c=1;a>0&&b.E6J(a,a-c)},a.prototype.moveDown=function(a){var b=this,c=1;a<b.visibleLength()-1&&b.E6J(a,a+c)},a.prototype.n7J=function(){var a,b,c=this,e=c.uDJ._dataSource.options.schema.hierarchy.outlineColumn,f=c.aFJ,g=-1,h=-1;for(a=0;a<f.length;a++){if(b=f[a],!d.isNullOrEmpty(b.outlineColumn)){g=a;break}h!==-1||b.value!==e&&(d.isNullOrUndefined(e)||b.value!==e.value)||(h=a)}return g!==-1?{index:g,options:f[g].outlineColumn}:{index:h,options:e}},a.prototype.getHierarchyColumnOptions=function(){return this.n7J().options},a.prototype.getHierarchyColumnIndex=function(){return this.n7J().index},a.prototype.hasHierarchyColumn=function(a){var b=this,c=b.isHierarchy(),e=c&&b.getHierarchyColumnIndex();return d.isNumber(a)?c&&e===a:!(!c||e===-1)},a.prototype.isHierarchy=function(){return this.uDJ.d7J()},a.prototype.o7J=function(a){var b=this,c=b.f7J();return b.uDJ.z6J(c[a])},a.prototype.getHierarchyNode=function(a,b){var c,d=this;if(d.isHierarchy())return c=b?a:d.jFJ(a),d.uDJ.z6J(c)},a.prototype.getHierarchyRootNode=function(){var a=this;if(a.isHierarchy())return a.uDJ.B6J()},a.prototype.promoteHierarchyLevel=function(a){var b=this;b.isHierarchy()&&this.uDJ.F6J(this.jFJ(a))},a.prototype.demoteHierarchyLevel=function(a,b){var c=this;c.isHierarchy()&&c.uDJ.I6J(c.jFJ(a),b)},a.prototype.hasRowOrder=function(){var a=this;return!d.isNullOrUndefined(a.uDJ.c7J())},a.prototype.hasHierarchyRowOrder=function(){return this.uDJ.C7J()},a.prototype.addHierarchyItemBefore=function(a,b,c,d){var e,f=this;f.S9J(a)&&(e=f.uDJ.N6J(f.jFJ(a),b),f.OaK(b,e),f.m7J(a,b,c,d))},a.prototype.addHierarchyItemAfter=function(a,b,c,d){var e,f,g=this;if(g.S9J(a))return e=g.uDJ.W6J(g.jFJ(a)),f=g.uDJ.Q6J(g.jFJ(a),b),g.OaK(b,f),g.m7J(a+e,b,c,d),e},a.prototype.addHierarchyItemAbove=function(a,b,c,d){var e,f=this;f.S9J(a)&&(e=f.uDJ.R6J(f.jFJ(a),b),f.OaK(b,e),f.m7J(a,b,c,d))},a.prototype.addHierarchyItemBelow=function(a,b,c,d){var e,f,g=this;if(g.S9J(a))return e=g.uDJ.W6J(g.jFJ(a)),f=g.uDJ.T6J(g.jFJ(a),b),g.OaK(b,f),g.m7J(a+e,b,c,d),e},a.prototype.OaK=function(a,b){var c,e=this,f=e.uDJ.Q9J(b);if(!d.isNullOrUndefined(f))for(c in f)f.hasOwnProperty(c)&&(a[c]=f[c])},a.prototype.CaK=function(a,b){if(this.isHierarchy())return this.uDJ.CaK(a,b)},a.prototype.fetch=function(a){var b,c=this,d=c.uDJ.EEJ.tables,e=Object.keys(d);if(e.length>0)return b=e.map(function(b){var c=d[b];return c&&c.fetch(a)}),Promise.all(b).then(function(a){c.z0J(),c.__J()&&(c.pOJ(),c.H0J()),c.x4J||c.w4J();var b=c;return(b.d9J||b.e9J)&&(b.d9J&&b.d9J(),b.e9J&&b.e9J()),a})},a.prototype.w4J=function(){var a,b,c,e,f,g=this.aFJ;for(a=0,b=g;a<b.length;a++)c=b[a],c.cross||(e=c.lookup,d.isArray(e)?"string"==typeof c.value&&c.value.indexOf(".")===-1&&(e=d.getUniqueArray(e),e.length>0&&(f=c.style,f||(f=c.style={}),f.cellType||(f.cellType={type:"combobox",items:e}))):d.isString(e)&&e?this.y4J(c,e):d.isObject(e)&&this.y4J(c,e.name,e.columns))},a.prototype.y4J=function(a,b,c){var d,g,h,i,j,k,l,m,n=a.style;n||(n=a.style={}),d=n.cellButtons,d||(d=n.cellButtons=[]),g=n.dropDowns,g||(g=n.dropDowns=[]),h=f.array_find(d,function(a){return"openMultiColumn"===a.command}),i=f.array_find(g,function(a){return"multiColumn"===a.type}),h||i||(j=this.z4J(b),k=j.table,l=j.field,k&&l&&k!==this.uDJ&&(m=k.columns,m&&(d.push({imageType:"ellipsis",command:"openMultiColumn",useButtonStyle:!0}),g.push({type:"multiColumn",option:{dataSource:k.views[e.DEFAULT_VIEW_NAME]||k.addView(e.DEFAULT_VIEW_NAME),bindingInfos:this.A4J(m,c),key:l}}))))},a.prototype.z4J=function(a){var b,c,d,e,f,g=this.uDJ.EEJ.relationships;for(d=0,e=g;d<e.length;d++)if(f=e[d],f.sourceRelationshipName===a){b=f.targetTable,c=f.targetFieldName;break}return{table:b,field:c}},a.prototype.A4J=function(a,b){return b?b.map(function(a){return d.isString(a)?{name:a,width:"*"}:(a=a,{name:a.value,width:d.isNullOrUndefined(a.width)?"*":a.width,displayName:a.caption,visible:a.visible})}):Object.keys(a).map(function(b){var c=a[b];return{name:c.value,width:d.isNullOrUndefined(c.width)?"*":c.width,displayName:c.caption,visible:c.visible}})},a.prototype.CXJ=function(){var a,b=this,c=b.uDJ.length(),d=[];for(a=0;a<c;a++)d.push(b.lFJ(a));return d},a.prototype.RWJ=function(a){var b,c,d,e,f,g,h,i=this.aFJ;for(b=0,c=i;b<c.length;b++)if(d=c[b],e=d.dataMap,f=d.value,"string"==typeof f){if(e)for(g in e)a[f]===e[g]&&(a[f]=isNaN(g)?g:+g);a.hasOwnProperty(f)&&(h=this.uDJ.TNJ(f),h&&h.relatedTable&&h.setValue&&h.setValue(a))}},a.prototype.SIJ=function(a,b){var c,d,e=this.ZEJ;if(e&&e.length>0){for(c=0;c<b;c++)d=e.indexOf(a+c),d>-1&&e.splice(d,1);for(c=0;c<e.length;c++)e[c]>a&&(e[c]-=b)}},a.prototype.removeRowData=function(a,b,c,e){var f=this,g=f.r0J(c,e),h=g.success,i=g.fail,j=f.uDJ,k=f.jFJ(a);return d.isNullOrUndefined(a)||d.isNullOrUndefined(k)||d.isNullOrUndefined(b)?void i():void j.remove(k,b,function(c){f.w0J(k,c.removedCount||b,a),h(c)},i)},a.prototype.w0J=function(a,b,c){var e,f,g,h,i=this;for(i.SIJ(a,b),d.isNumber(c)||(c=i.kFJ(a)),e=i.fFJ.slice(c,c+b),f=function(a,b){var c=i.fFJ[a],d=e.reduce(function(a,b){return b<c?a+1:a},0);d>0&&(i.fFJ[a]-=d)},g=0,h=i.fFJ.length;g<h;g++)f(g,h);i.fFJ.splice(c,b),i.Y_J(a,b),i.MNJ(a,b),i.rWJ(void 0,!0)},a.prototype.getChanges=function(){var a,b,c,d=this.uDJ,e=d.getChanges();for(a=0,b=e;a<b.length;a++)c=b[a],c.index=this.kFJ(c.index);return e},a.prototype.isDataLengthChanged=function(){return this.uDJ.isDataLengthChanged()},a.prototype.submitChanges=function(a){var b=this,c=b.r0J(),d=c.success,e=c.fail,f=b.uDJ;return f.submitChanges(function(c,d,e){if(a){var f=b.kFJ(c);a(f,d,e)}}).then(function(){b.x0J(),d()}).catch(e)},a.prototype.x0J=function(){},a.prototype.cancelChanges=function(){var a=this,b=a.r0J(),c=b.success,d=b.fail,e=a.isDataLengthChanged();a.uDJ.cancelChanges(function(){a.y0J(e),c()},d)},a.prototype.y0J=function(a){var b=this;b.C9J(),a&&b.eFJ(),b.X_J(),b.rWJ(j,!0)},a.prototype.K0J=function(a,b){var c,e=this,f=e.f0J(a,b),g=e.h0J.map(function(a,b){return{index:b,option:a}}),h=e.L0J(a,b);return g=h.map(function(a){return g[a]}),e.h0J=g.map(function(a){return a.option}),f?f:(c=[],g.forEach(function(a,b){d.isNullOrUndefined(a.option.cross)||a.index===b||c.push({oldIndex:a.index,newIndex:b})}),void e.b0J(c))},a.prototype.M0J=function(){var a,b=this,c=b.$EJ;return c&&c.length>0?(a=[],c.forEach(function(c,d){a.push(b.aFJ[c].value)}),a):[]},a.prototype.N0J=function(a){var b=this,c=b.aFJ;return d.isNullOrUndefined(a)?[]:a.map(function(a){return d.findIndex(c,function(b){return b.value===a})})},a.prototype.PXJ=function(a,b,c){var d,e,g,h,i,j,k,l,m,n,o,p,q=this;if(q.aFJ.forEach(function(a,b){a.zAc=b}),d=q._EJ,e=f.G0J(a,b,c,q.aFJ,q._EJ,q.$EJ,q.h0J),g=q.$EJ.map(function(a){return q.aFJ[a]}),q.aFJ=e.map(function(a){return q.aFJ[a]}),g&&g.length){for(h=[],i=q.aFJ.length,j=-1,k=0,l=g;k<l.length;k++)m=l[k],n=q.aFJ.indexOf(m),j=Math.max(n,j),h.push(n);for(o=0;o<i;o++)h.indexOf(o)===-1&&h.push(o);q._EJ=h,q.$EJ=h.slice(0,g.length)}return p=q.aFJ.reduce(function(a,b,c){return b.zAc!==c&&a.push({oldIndex:b.zAc,newIndex:c}),delete b.zAc,a},[]),q.aFJ.forEach(function(a){var b,c,d,e,f;for(b=0,c=p;b<c.length;b++)if(d=c[b],e=d.oldIndex,f=d.newIndex,a.APJ===e){a.APJ=f;break}}),q.nOJ&&q.nOJ.moveFieldsByIndexes(p),p.map(function(a){return a.oldIndex=q.O0J(a.oldIndex,d),a.newIndex=q.O0J(a.newIndex),a})},a.prototype.e0J=function(a){var b=this,c=b.aFJ,e=b.h0J,f=c[a];return f.isCross?f.c0J:d.findIndex(e,function(a){return a.value===f.value})},a.prototype.g0J=function(a){var b=this,c=b.$EJ,d=b.h0J;return a=a||c.map(function(a){return b.e0J(a)}),f.generatePinnedColumnIndexMap(a,d.length)},a.prototype.L0J=function(a,b){var c,e,g,h,i,j,k;if(a!==b)return c=this,e=c.$EJ,g=c.h0J.map(function(a,b){return{index:b}}),h=e.map(function(a){return c.e0J(a)}),i=f.generatePinnedColumnIndexMap(h,g.length),i.length>0&&(a=i[a],b=i[b]),j=h.map(function(a){var b=g[a];return b.P0J=!0,b}),d.swapArrayItems(g,a,b,1),k=g.filter(function(a){return!a.P0J}),j.forEach(function(a,b){k.splice(h[b],0,a)}),k.map(function(a){return a.index})},a.prototype.getColumnInfos=function(a,b){var c,e=[],f=this.aFJ,g=this._EJ,h=this.uDJ,i=function(c){var i,k=g.length>0?d.isNullOrUndefined(g[c])?c:g[c]:c,l=f[k];if(h.PEJ(l.value)&&(l.isPrimaryKey=!0),!a||!l.isGroup){if(b&&l.isCross&&(i=l.c0J,l=j.h0J[i],l.c0J=i,e.some(function(a){return a===l})))return"continue";e.push(l)}},j=this;for(c=0;c<f.length;c++)i(c);return e},a.prototype.Q0J=function(a){if(a.indexOf(".")>=0)return!0;var b=this.uDJ.R_J(a);return!d.isNullOrUndefined(b)&&b!==this.uDJ},a.prototype.setColumnInfos=function(a,b){this.aFJ=a,b&&this.H0J()},a.prototype.J9J=function(){var a,b,c,d,e,f,g,h=this.h0J;for(a=h.length-1;a>=0;a--)b=h[a].value,"string"==typeof b&&"="===b[0]&&h.splice(a,1);for(c=this.aFJ,a=0,d=0;a<c.length;)e=c[a],f=h[d],e.isGroup||e.isCross?a++:f&&f.cross?d++:(g=e.value,b=f&&f.value,g===b?(a++,d++):"string"==typeof g&&"="===g[0]?(h.splice(d,0,e),a++,d++):a++)},a.prototype.tDJ=function(a){var b=this.uDJ;return!!b.UEJ(a)},a.prototype.togglePinnedRows=function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(d.isNullOrUndefined(a)||this.hasHierarchyColumn())return this.ZEJ&&this.ZEJ.length;for(b=this.ZEJ,c=this.fFJ,e=a.length,f=[],g=[],h=b.length,i=0;i<e;i++)j=c[a[i]],j>-1&&(k=b.indexOf(j),k>-1?g.push(k):f.push(j));if(l=f.length,m=g.length,b.length-m+l>this.YEJ)return-1;if(m>0)for(g.sort(),i=m-1;i>=0;i--)b.splice(g[i],1);for(i=0;i<l;i++)b.push(f[i]);if(m>0||l>0){for(n=[],o=c.length,p=b.length,p>0&&(n=b.slice(0)),j=p,i=0;i<o;i++)b.indexOf(c[i])===-1&&(n[j]=c[i],j++);if(!this.TWJ()&&!this.SWJ())for(i=0;i<m;i++)q=c[g[i]],r=n.indexOf(q),s=this.LXJ(q,h,n),n.splice(r,1),s=s>r?s-1:s,n.splice(s,0,q),h>p&&h--;this.fFJ=n,this.QIJ(),this.RIJ()}return b.length},a.prototype.togglePinnedColumns=function(a){var b,c,e,g,h,i,j,k,l,m,n,o=this;if(d.isNullOrUndefined(a))return this.$EJ&&this.$EJ.length;for(b=this._EJ,c=b.length>0,a=a.filter(function(a){var d=c?b[a]:a;return!o.aFJ[d].isCross}),e=this.$EJ,g=a.length,h=[],i=[],j=0;j<g;j++)k=c?b[a[j]]:a[j],k>-1&&(l=e.indexOf(k),l>-1?i.push(l):h.push(k));if(m=h.length,n=i.length,e.length-n+m>this.YEJ)return-1;if(n>0)for(i.sort(),j=n-1;j>=0;j--)e.splice(i[j],1);for(j=0;j<m;j++)e.push(h[j]);return(m>0||n>0)&&(this._EJ=f.generatePinnedColumnIndexMap(e,this.aFJ.length)),e.length},a.prototype.R0J=function(a){var b=this,c=b._EJ;return c&&c.length>0?c[a]:a},a.prototype.O0J=function(a,b){var c=this;return b=b||c._EJ,b&&b.length>0?b.indexOf(+a):+a},a.prototype.getRowDataAsync=function(a){var b=this;return b.fetch().then(function(c){var d=b.jFJ(a);return b.lFJ(d)})},a.prototype.LXJ=function(a,b,c){for(var d=b;d<c.length;d++)if(c[d]>a)return d;return c.length},a.prototype.lFJ=function(a,b){var c,e,f,g=this,h=g.aFJ,i={},j=[],k=!!g.rOJ,l=g.uDJ;if(h.forEach(function(c,e){var f,h,m,n,o,p,q=c.value;b&&!b[q]||(c.isCross?i[c.value]=g.nOJ.getFieldByPosition(e).getValue(a):q&&!c.isGroup&&("string"==typeof q?(f=q.indexOf(".")>=0,h="="===q[0],m=l.BEJ&&d.isNullOrUndefined(l.BEJ[q]),(!k||k&&(f||h||m))&&(n=q,o=l._getValueByField(q,a),p=c.dataMap,p&&(o=p[o]||o),i[n]=o)):"function"==typeof q&&j.push({name:q.name,caption:c.caption,value:q})))}),j.length>0&&(c=g.uDJ.XEJ(a),j.forEach(function(a){i[a.name]=a.value(c)})),k){e=this.nOJ.getFieldValues(a);for(f in e)e.hasOwnProperty(f)&&(i[f]=e[f])}return i},a.prototype.zPJ=function(a){var b,c,e,f=this,g=f.aFJ,h={},i=[],j=!!f.rOJ,k=f.uDJ;if(g.forEach(function(b,c){var e,g,l,m,n,o,p=b.value;b.isCross?h[b.value]=f.nOJ.getFieldByPosition(c).getOriginalValue(a):p&&!b.isGroup&&("string"==typeof p?(e=p.indexOf(".")>=0,g="="===p[0],l=k.BEJ&&d.isNullOrUndefined(k.BEJ[p]),(!j||j&&(e||g||l))&&(m=p,n=g?k._getValueByField(p,a):k.Q_J(p,a),o=b.dataMap,o&&(n=o[n]||n),h[m]=n)):"function"==typeof p&&i.push({name:p.name,caption:b.caption,value:p}))}),i.length>0&&(b=f.uDJ.XEJ(a),i.forEach(function(a){h[a.name]=a.value(b)})),j){c=this.nOJ.S0J(a);for(e in c)c.hasOwnProperty(e)&&(h[e]=c[e])}return h},a.prototype.addColumn=function(a){"string"==typeof a?a={name:a,value:a}:a.name||"string"!=typeof a.value||(a.name=a.value),"="===a.value[0]&&(a.readonly=!0),this.aFJ.push(a)},a.prototype.getColumn=function(a){var b=this.getColumnInfos();return d.isNullOrUndefined(a)?b:b[a]},a.prototype.removeColumn=function(a){var b,c,d=this.aFJ;for(b=0;b<d.length;b++)if(c=d[b],c.value===a){d.splice(b,1);break}},a.prototype.rWJ=function(a,b,c,d){b||this.eFJ(a);var e=this.pFJ;e&&this.autoFilter&&this.filter(),this.pFJ=e,this.RIJ(),this.qXJ(c),this.h7J=j},a.prototype.excludeInsertedPinnedRows=function(){var a,b=this,c=b.ZEJ,d=[];for(a=0;a<c.length;a++)b.isInserted(a)||d.push(c[a]);return d},a.prototype.toJSON=function(){var a,b,c,e=this,g={};if(e.pXJ&&(g={sortBefore:f.removeExtraInfos(e.oXJ),sortAfter:f.removeExtraInfos(e.pXJ)}),a=e.h0J,0===a.length)0===e.aFJ.length&&e.H0J(),a=e.h0J=e.aFJ;else for(b=function(b){var c,f,g=a[b].cross;d.isNullOrUndefined(g)&&(c=e.aFJ.filter(function(c){return c.value===a[b].value})[0],c&&(a[b]=c)),f=a[b].validator,f&&"date"===f.type&&(n(f.value1)&&(f.value1=o(f.value1)),n(f.value2)&&(f.value2=o(f.value2)))},c=0;c<a.length;c++)b(c);return l(l({},g),{name:e.name,options:e.i6,columns:e.h0J,indexMap:e.fFJ,columnIndexMap:e._EJ,autoSort:e.autoSort,sortInfo:f.removeExtraInfos(e.oFJ),autoFilter:e.autoFilter,filterInfo:f.removeExtraInfos(e.pFJ),autoGroup:e.autoGroup,groupInfo:e.wOJ,detailColumnsVisible:e.mPJ,pinnedRows:e.excludeInsertedPinnedRows(),pinnedColumns:e.$EJ})},a.prototype.fromJSON=function(a){var b,c,d,e,f,g=this;if(g.fFJ=a.indexMap,b=a.columnIndexMap,c=g.aFJ,b&&c&&b.length>0&&b.length<c.length)for(d=b.length;d<c.length;d++)b[d]=d;for(d=0;d<c.length;d++)e=c[d].validator,e&&"date"===e.type&&("string"==typeof e.value1&&(f=p(e.value1),f&&(e.value1=f)),"string"==typeof e.value2&&(f=p(e.value2),f&&(e.value2=f)));g._EJ=b,g.autoSort=a.autoSort,g.oFJ=a.sortInfo,g.oXJ=a.sortInfo,a.sortAfter&&(g.oXJ=a.sortBefore,g.pXJ=a.sortAfter),g.autoFilter=a.autoFilter,g.pFJ=a.filterInfo,g.autoGroup=a.autoGroup,g.wOJ=a.groupInfo,g.mPJ=a.detailColumnsVisible,g.ZEJ=a.pinnedRows,g.$EJ=a.pinnedColumns},a}(),b.View=k},"./dist/src/viewField/fieldManager.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j=this&&this.__spreadArrays||function(){var a,b,c,d,e,f,g,h;for(a=0,b=0,c=arguments.length;b<c;b++)a+=arguments[b].length;for(d=Array(a),e=0,b=0;b<c;b++)for(f=arguments[b],g=0,h=f.length;g<h;g++,e++)d[e]=f[g];return d};Object.defineProperty(b,"__esModule",{value:!0}),b.isValidCross=b.isLookupRelationField=b.isLookupListField=b.isLookupField=b.getLookupBy=b.FieldManager=void 0,d=c("CalcEngine"),e=c("./dist/src/dataSource/utils.js"),f=c("./dist/src/interfaces/interface.js"),g=c("./dist/src/viewField/utils.js"),h=c("./dist/src/viewField/fields.js");function k(a,b){return function(c,d){var e=a.getField(d),f=e.name;return c[f]=e.getValue(b),c}}i=function(){function a(a,b){this.HL=[],this.positionOfField=[],this.keysOfBaseField=[],this.T0J=a,this.EOJ={},this.sj=b}return a.prototype.cQJ=function(a,b){return this.sj._getValueByField(a,b)},a.prototype.U0J=function(a,b){return this.sj.Q_J(a,b)},a.prototype.V0J=function(a){return this.sj.XEJ(a)},a.prototype.W0J=function(a){return G(this.sj,a)},a.prototype.X0J=function(a){return F(this.sj,a)},a.prototype.Y0J=function(a){return this.sj._dataSource._data[a].data},a.prototype.Z0J=function(a){return!e.isNullOrUndefined(this.sj._dataSource._data[a])},a.prototype.V_J=function(a){return this.sj.V_J(a.split("."))},a.prototype.$0J=function(){return this.sj.vDJ},a.prototype._0J=function(a){return y(this.sj,a)},a.prototype.a1J=function(a){return z(this.sj,a)},a.prototype.b1J=function(a){return A(this.sj,a)},a.prototype.c1J=function(a){return B(this.sj,a)},a.prototype.getField=function(a){return this.HL[a]},a.prototype.getFieldByPosition=function(a){return this.getField(this.positionOfField[a])},a.prototype.getFieldByName=function(a){return this.HL.filter(function(b){return b.name===a})[0]},a.prototype.getFields=function(a){return this.HL.filter(a)},a.prototype.getFieldValues=function(a){var b=this;return b.positionOfField.reduce(k(b,a),{})},a.prototype.S0J=function(a){var b=this;return b.positionOfField.filter(function(a){return b.keysOfBaseField.indexOf(a)===-1}).reduce(k(b,a),{})},a.prototype.moveFields=function(a,b,c){e.swapArrayItems(this.HL,a,b,c)},a.prototype.moveFieldsByIndexes=function(a){var b=this;a.forEach(function(a){a.field=b.HL[a.oldIndex]}),a.forEach(function(a){b.HL[a.newIndex]=a.field})},a.prototype.removeFields=function(a,b){this.HL.splice(a,b||1)},a.prototype.reset=function(){var a=this;a.positionOfField=a.keysOfBaseField.slice(),a.HL=a.HL.reduce(function(b,c){return a.keysOfBaseField.indexOf(c.key)>-1?b.concat(c):b},[])},a.prototype.FOJ=function(a){var b=this,c=b.EOJ,d=c[a],e=b.$0J(),f=e.getCalcService();return d||(d=c[a]=b.fixExpression(f.parse(e,a,0,0))),function(a,b){return e.L$a(a,b),f.evaluateExpression(e,d,{row:0,col:0})}},a.prototype.d1J=function(a,b){var c=this,d=c.EOJ,f=d[a],g=b||c.$0J(),h=g.getCalcService();return f||(f=d[a]=c.fixExpression(h.parse(g,a,0,0))),function(a,b){g.L$a(a,b);var c=h.lh.evaluateExpression(f,g.getEvaluatorContext({row:0,col:0},!1),!1,!0);return e.isNullOrUndefined(c.toArray)?[]:c.toArray()}},a.prototype.fixExpression=function(a){var b,c,e,f,g,h,i=this;if(a.function)for(a.function.isReverseArgs&&a.function.isReverseArgs()&&a.arguments.reverse(),b=0,c=a.arguments;b<c.length;b++)e=c[b],i.fixExpression(e);else for(f=0,g=Object.getOwnPropertyNames(a);f<g.length;f++)h=g[f],a[h]instanceof d.Expression&&i.fixExpression(a[h]);return a},a.prototype.mOJ=function(a){var b=this;return a.key=b.HL.length,b.HL.push(a),a},a.prototype.addDataBaseField=function(a,b,c){var d=this,e=d.addColumnDataField(a,b,c);return d.GOJ(e)},a.prototype.addReaderBaseField=function(a,b,c){var d=this,e=d.addColumnDataReaderField(a,"function"==typeof b?b:function(a){return d.cQJ(b,a)},c);return d.GOJ(e)},a.prototype.GOJ=function(a){var b=this,c=a.key;return b.keysOfBaseField.push(c),b.positionOfField.push(c),a},a.prototype.addColumnDataField=function(a,b,c){return this.mOJ(new h.ColumnDataField(a,b,c))},a.prototype.addColumnDataReaderField=function(a,b,c){return this.mOJ(new h.ColumnDataReaderField(a,b,c))},a.prototype.addDataField=function(a,b){return this.mOJ(new h.DataField(a,b))},a.prototype.addFormulaField=function(a,b){return this.mOJ(this.HOJ(a,b))},a.prototype.HOJ=function(a,b){return new h.FormulaField(a,b,this.FOJ(b))},a.prototype.addCategoryFormulaField=function(a,b){return this.mOJ(this.IOJ(a,b))},a.prototype.IOJ=function(a,b){return new h.CategoryFormulaField(a,b,this.FOJ(b))},a.prototype.addCategoryField=function(a,b){return this.mOJ(this.dNa(a,b))},a.prototype.dNa=function(a,b){return new h.CategoryField(a,b)},a.prototype.addSliceCategoryField=function(a){return this.mOJ(new h.SliceCategoryField(a))},a.prototype.GRJ=function(a,b,c,d,f){var h,i,j,k,l,m,n,o=this,p=a.fieldExtra,q=a.field;for(m=0,n=c.length;m<n;m++)j=c[m],i=j.result,k=j.key,l=a.sliceFields[k],e.isUndefined(l)&&(h=q.getValueByKey(k),l=o.addSliceCategoryField(g.combineName(h,a.sliceKeys.length,b.name)),l.setFieldExtra(p),a.sliceFields[k]=l,a.sliceKeys.push(l.key)),l.setData(i,d,f)},a.prototype.dQJ=function(a,b,c,d){var e=this;return g.isField(a)?e.getFieldByName(a):g.isFormula(a)?e.eQJ(d+"_formula_source",b,a,c):g.isRelated(a)?new h.ColumnDataReaderField(d+"_related_source",function(b){return e.cQJ(a,b)},null):e.getFieldByName(a)},a.prototype.eQJ=function(a,b,c,d){var e=this,f=e.HOJ(g.combineName(a,b),c);return f.evaluateFormulaBy(d),f},a.prototype.buildGroupFields=function(a,b){var c=this,d,f,h=[];return a.forEach(function(a,i){if(!e.isNullOrEmpty(a.field)){f=e.isNullOrUndefined(f)?d={}:f.group={};var j=g.combineName(a.field,i),k=c.dQJ(a.field,j,b,"group_field"),l=c.addCategoryField(j,k);l.setFieldExtra(a),h.push(l.key),f.field=l,e.isNullOrUndefined(a.summaryFields)||a.summaryFields.forEach(function(a,d){var i,k,l,m,n,o,p,q,r;e.isNullOrEmpty(a.formula)||(i=g.combineName(a.formula,d,j),k=c.addCategoryFormulaField(i,a.formula),k.setFieldExtra(a),e.isNullOrUndefined(f.formulas)&&(f.formulas=[]),l=f.formulas.push(k)-1,h.push(k.key),e.isNullOrUndefined(a.slice)||(m=a.slice,n=e.isString(m),o=n?m:m.field,p=g.combineName(o,i),q=c.dQJ(o,p,b,"slice"),q=c.dNa(g.combineName("slice_category",p),q),e.isNullOrUndefined(f.slices)&&(f.slices=[]),r=c.IOJ(g.combineName("slice_formula_result",p),a.formula),f.slices.push({field:q,formula:r,formulaIndex:l,sliceKeys:[],fieldExtra:n?{}:m,sliceFields:{},addSliceField:c.GRJ.bind(c)})))})}}),c.positionOfField=h.concat(c.keysOfBaseField),d},a.prototype.transposeSliceFields=function(a){var b=this,c,d;a.slices&&a.slices.forEach(function(f){var g;c=b.positionOfField.indexOf(a.formulas[f.formulaIndex].key),d=f.sliceKeys,e.isNullOrUndefined(f.fieldExtra.sort)||(d=d.map(function(a){return b.getField(a)}).sort(H(f.fieldExtra.sort)).map(function(a){return a.key})),(g=b.positionOfField).splice.apply(g,j([c+1,0],d))}),a.group&&b.transposeSliceFields(a.group)},a.prototype.prepareFields=function(a){var b,c,d,e,f,g,i,j,k,l,m,n,o,p,r,s,t=this,u=[];for(b=0,c=0;b<a.length;b++,c++)if(d=a[b],e=q(d),f=d.value,g=d.cross,g){if(i=t.e1J(a,b),j=i.crossColumnOptions,k=i.endColIndex,l=j.columns.length,m=t.f1J(j),0===m)continue;for(n=function(d,e){var f,g,i=c+d,j=b+e,k=t.getField(i);k.setFieldExtra(a[j]),
f={value:k.name,name:k.name,isCross:!0,c0J:j},k.isReadonly()&&(f.readonly=!0),g=k.extra,g&&h.setFieldExtraProperties(function(a){g[a]&&(f[a]=g[a])}),u.push(f),d++,e++,e>=l&&(e=0),o=d,p=e},r=0,s=0;r<m;)n(r,s),r=o,s=p;b=k,c+=m-1}else t.Z0J(e)?(t.addDataBaseField(e,t.Y0J(e),d),u.push(a[b])):(t.addReaderBaseField(e,f,d),u.push(a[b]));return x(u),u},a.prototype.e1J=function(a,b){var c,d,e=this,f=b,g=a[b],h=g.cross,i=e.g1J(h,[g],f);if("string"==typeof h){for(c=b,d=b;b<a.length&&(d++,!(d<a.length&&h!==a[d].cross));)b++;i=e.g1J(h,a.slice(c,d),f)}return{crossColumnOptions:i,endColIndex:b}},a.prototype.g1J=function(a,b,c){var d="string"==typeof a?this.T0J.cross[a]:a;return{initialOptionIndex:c,crossKeys:b.map(function(a){return a.k0J}),cross:d,columns:b,lookup:this.h1J(d,b)}},a.prototype.h1J=function(a,b){var c=this;return b.every(function(b){return c.isValidCross(a,b.value)})&&this._0J(a.over)},a.prototype.isValidCross=function(a,b){return D(this.sj,a,b)},a.prototype.f1J=function(a){var b=this,c=a.lookup,d=0;return e.isArray(c)?d=b.i1J(a):e.isString(c)?d=b.j1J(a):e.isObject(c)&&(d=b.j1J(a)),d},a.prototype.j1J=function(a){var b,c,d,f,h,i,j,k,l,m,p,q,r,x,y,z,A,B=this,C=a.cross,D=B.T0J.showCrossValueHeader,E=w(C.caption),F=0,G=n(a),H=C.over,I=s(H),J=H,K=C.attributes||[],L=K.length,M=v(K[0],!0),N=B.k1J(B.X0J(J),J),O=N.relationTableName||u(K[0]),P=N.relationTable||B.l1J(O),Q=P.length(),R=N.relationPrimaryKey||B.m1J(O,I),S=C.filter?B.d1J(o(C.filter,M),P.vDJ):null;for(e.isNullOrUndefined(S)||(c=S(null),c.length>0&&(b=c.reduce(function(a,b){var c="object"==typeof b?b[R]:b;return a[c]=!0,a},{}))),d=[],f=0;f<L;f++)h=s(K[f]),i=t(K[f]),d.push({fieldName:h,formatter:i});for(j=0;j<Q;j++)if(k=P._getValueByField(R,j),e.isNullOrUndefined(b)||b[k]){for(l=E.slice(),f=0;f<L;f++)h=d[f].fieldName,m=P._getValueByField(h,j),i=d[f].formatter,e.isNullOrUndefined(i)||(m=e.format(m,i)),l.push(m);for(p=0;p<G.length;p++)q=G[p],r=q.valueRelation,x=q.valueCaption,y=q.valueIndex,z=q.valueCrossKey,A=D?l.concat(x):l,B.n1J({path:A,value:g.combineName(r,k,H,z),valueRelation:r,dimRelationPath:J,dimRelationKey:I,dimTableName:O,dimTableKeyFieldValue:k,initialOptionIndex:y}),F++}return F},a.prototype.i1J=function(a){var b,c,d,e,f,h,i,j,k,l,m=this,o=a.cross,p=a.lookup,q=m.T0J.showCrossValueHeader,r=w(o.caption),t=0,u=n(a),v=o.over,x=s(v),y=v,z=p.length;for(b=0;b<z;b++)for(c=r.slice(),d=p[b],c.push(d),e=0;e<u.length;e++)f=u[e],h=f.valueRelation,i=f.valueCaption,j=f.valueIndex,k=f.valueCrossKey,l=q?c.concat(i):c,m.n1J({path:l,value:g.combineName(h,d,v,k),valueRelation:h,dimRelationPath:y,dimRelationKey:x,dimTableKeyFieldValue:d,initialOptionIndex:j}),t++;return t},a.prototype.setCrossFieldValues=function(a){var b,c,d,e,f,g=this,i=g.HL,j=a.length,k=i.filter(function(a){return a instanceof h.CrossField});if(k.length>0)for(b=0;b<j;b++)for(c=a[b],d={},e=0;e<k.length;e++)f=k[e],g.W_J(f,c,d)},a.prototype.W_J=function(a,b,c){var d,f=this,g=a.dimRelationPath,h=c[g];if(e.isNullOrUndefined(h)&&a.isOneToMany&&(h=c[g]=f.cQJ(g,b)),e.isArray(h))for(d=0;d<h.length;d++)if(a.o1J(h[d],a.dimTableKeyFieldValue)&&e.isNullOrUndefined(a.getValueIndex(b))){a.setValueIndex(b,d);break}},a.prototype.m1J=function(a,b){var c=this,d=c.W0J(function(c){return c.sourceFieldName===b&&c.sourceRelationshipName===a});return d?d.targetFieldName:(d=c.W0J(function(c){return c.targetFieldName===b&&c.targetRelationshipName===a}),d?d.sourceFieldName:void 0)},a.prototype.l1J=function(a){var b=this,c=b.W0J(function(b){return b.sourceRelationshipName===a||b.targetRelationshipName===a})||{},d=c.sourceRelationshipName===a?c.sourceField:c.targetField;return d?d.targetTable:{length:function(){return 0}}},a.prototype.k1J=function(a,b){return C(this.sj,a,b)},a.prototype.p1J=function(a){var b=this,c=new h.CrossField(a,b.cQJ.bind(b),b.U0J.bind(b),b.V0J.bind(b));return b.mOJ(c),b.GOJ(c),c},a.prototype.n1J=function(a){var b,c,d,e=this,f=e.p1J(a);f.isReadonly()||(b=l(e.V_J.bind(e),f),c=b.isOneToMany,d=b.relationTemplate,c&&(f.isOneToMany=c,f.valueArrayRelation=d))},a.prototype.isCrossField=function(a){return a instanceof h.CrossField},a.prototype.clearCrossFieldData=function(){var a,b,c=this,d=c.HL;for(a=0;a<d.length;a++)b=d[a],b instanceof h.CrossField&&b.clearData()},a.prototype.resetCrossFieldRowValues=function(a){var b,c,d=this,e=d.HL,f={};for(b=0;b<e.length;b++)c=e[b],c instanceof h.CrossField&&(c.clearValue(a),d.W_J(c,a,f))},a.prototype.removeCrossFieldValues=function(a,b){var c,d,e=this,f=e.HL;for(c=0;c<f.length;c++)d=f[c],d instanceof h.CrossField&&d.removeData(a,b)},a.prototype.setCrossFieldInsertedIndex=function(a,b,c){var d,f,g=this,i=g.HL,j=v(a.valueRelation,!0);for(d=0;d<i.length;d++)f=i[d],f instanceof h.CrossField&&f.isOneToMany&&a.dimTableKeyFieldValue===f.dimTableKeyFieldValue&&e.isNullOrUndefined(f.getValueIndex(b))&&j===v(f.valueRelation,!0)&&f.setValueIndex(b,c)},a}(),b.FieldManager=i;function l(a,b){var c,d,f=b.valueRelation,h=f.split("."),i=a(f),j="",k=!1,l=!1;for(c=0;c<h.length;c++)d=i[c],e.isNullOrEmpty(h[c])||(j+="."+h[c]),!l&&d&&"array"===d.type&&d.name===h[c]&&(l=!0,k=!0,j+="."+g.RelationTemplateToken);return{isOneToMany:k,relationTemplate:j.slice(1)}}function m(a,b,c,d){var e=s(a),f=b||e;return{valueRelation:a,valueCaption:f,valueIndex:c,valueCrossKey:d}}function n(a){var b,c=a.columns,d=a.crossKeys,e=a.initialOptionIndex,f=[];for(b=0;b<c.length;b++)f.push(m(c[b].value,c[b].caption,e+b,d[b]));return f}function o(a,b){return p(a,b,"")}function p(a,b,c){return!e.isNullOrEmpty(b)&&a.indexOf(b)>=0?(a=a.replace(b,c),p(a,b,c)):a}function q(a){var b=a.value;return"string"==typeof b?b:"function"==typeof b?b.name:void 0}function r(a){var b;return b="string"==typeof a||e.isNullOrUndefined(a)?a:"function"==typeof a?a.name:a.value,(b||"").split(".")}function s(a){var b=r(a);return b[b.length-1]}function t(a){if(!e.isNullOrEmpty(a.formatter))return a.formatter}function u(a){var b=r(a);return b[b.length-2]}function v(a,b){var c=r(a);return b&&c.splice(c.length-1,0,""),c.slice(0,c.length-1).join(".")}function w(a){return"string"==typeof a?[a]:a||[]}function x(a){var b,c,d,f=0,g={};for(b=0;b<a.length;b++)c=a[b].caption,e.isArray(c)?(a[b].caption=c.map(function(a){return null===a||void 0===a?void 0:""+a}),g[b]=c.length,g[b]>f&&(f=g[b])):a[b].caption=null===c||void 0===c?void 0:""+c;for(b in g)if(g[b]<f)for(d=f-g[b],c=a[b].caption;d>0;)c.unshift(),d--;for(b=0;b<a.length;b++)c=a[b].caption,e.isArray(c)&&1===c.length&&(a[b].caption=c[0])}function y(a,b){var c,d,f,g=a.R_J(b);if(!(e.isNullOrUndefined(g)||(c=g._dataSource.options.schema,e.isNullOrUndefined(c)||(d=c.columns,e.isNullOrUndefined(d)||(f=d[s(b)],e.isNullOrUndefined(f))))))return f.lookup}b.getLookupBy=y;function z(a,b){return A(a,b)||B(a,b)}b.isLookupField=z;function A(a,b){return e.isArray(y(a,b))}b.isLookupListField=A;function B(a,b){var c,d,f,g,h=y(a,b);if(e.isObject(h)&&(h=h.name),e.isString(h))return c=a.R_J(b),d=s(b),f=s(h),g=a.EEJ.relationships.find(function(a){return a.sourceTable===c&&a.sourceFieldName===d&&a.sourceRelationshipName===f}),!e.isNullOrUndefined(g)}b.isLookupRelationField=B;function C(a,b,c){var d=s(c),e=G(a,function(a){return a.sourceFieldName===d&&a.sourceTable===b});return e?{relationTable:e.targetTable,relationPrimaryKey:e.targetFieldName,relationTableName:e.sourceRelationshipName}:{}}function D(a,b,c){var d,g,h,i,j,k,l,m,n=b.over,o=b.attributes;return!(e.isNullOrEmpty(n)||e.isNullOrEmpty(c)||c===n||E(a,c))&&(d=r(c),g=A(a,n),h=!g&&(B(a,n)&&o&&o.length>0),!(!g&&!h)&&(i=C(a,F(a,n),n),!(d.indexOf(i.relationTableName)>-1)&&(j=a.S_J(n),k=a.S_J(c),!(!j.every(function(a){return a.relationshipMap===f.RelationshipMap.OneToOne})||!k.every(function(a){return a.relationshipMap===f.RelationshipMap.OneToOne}))||(l=e.findIndex(j,function(a){return a.relationshipMap===f.RelationshipMap.OneToMany}),m=e.findIndex(k,function(a){return a.relationshipMap===f.RelationshipMap.OneToMany}),l>-1&&l===m&&j[l].name===k[m].name?j.slice(l+1).every(function(a){return a.relationshipMap===f.RelationshipMap.OneToOne})&&k.slice(l+1).every(function(a){return a.relationshipMap===f.RelationshipMap.OneToOne}):void 0))))}b.isValidCross=D;function E(a,b){var c=F(a,b),d=s(b);return c.PEJ(d)||G(a,function(a){return a.sourceTable===c&&a.sourceFieldName===d||a.targetTable===c&&a.targetFieldName===d})}function F(a,b){return a.R_J(b)}function G(a,b){return a.EEJ.relationships.find(b)}function H(a){var b=a.ascending,c=a.compare;return c?function(a,d){return c(a.extra.caption,d.extra.caption,b)}:function(a,c){var d=a.extra.caption,e=c.extra.caption,f=b?d:e,g=b?e:d;return f>g?1:f<g?-1:0}}},"./dist/src/viewField/fields.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),b.CrossField=b.SliceCategoryField=b.CategoryFormulaField=b.CategoryField=b.FormulaField=b.ColumnDataReaderField=b.ColumnDataField=b.DataField=b.Field=b.setFieldExtraProperties=void 0,d=c("./dist/src/dataSource/utils.js"),e=c("./dist/src/viewField/utils.js");function p(a){["caption","width","style","headerStyle","conditionalFormats","validator","headerFit"].forEach(a)}b.setFieldExtraProperties=p,f=function(){function a(a){this.name=a}return a.prototype.setFieldExtra=function(a){var b,c=this;d.isUndefined(c.extra)&&(c.extra={}),p(function(b){c.yOJ(b,a)}),d.isNullOrUndefined(a.caption)&&(b=c.name.indexOf(e.FieldNameDelimiter),b>=0&&(c.extra.caption=c.name.substring(0,b)))},a.prototype.yOJ=function(a,b){var c=this,d=b[a];d&&(c.extra[a]=d)},a.prototype.getValue=function(a){return this.data[a]},a.prototype.getOriginalValue=function(a){return this.getValue(a)},a.prototype.zOJ=function(a,b,c){var d,e,f,g=this;for(g.data||(g.data=[]),c=c||0,e=c,f=a.length;e<f;e++)d=a[e],g.data[d]=b;return g.data},a.prototype.AOJ=function(a,b){var c,d,e,f=this;for(f.data||(f.data=[]),d=0,e=a.length;d<e;d++)c=a[d],f.data[c]=b(c);return f.data},a}(),b.Field=f,g=function(a){o(b,a);function b(b,c){var d=a.call(this,b)||this;return d.data=c||[],d}return b}(f),b.DataField=g,h=function(a){o(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.column=d,e}return b}(g),b.ColumnDataField=h,i=function(a){o(b,a);function b(b,c,d){var e=a.call(this,b)||this;return e.column=d,e.getValue=c,e}return b}(f),b.ColumnDataReaderField=i,j=function(a){o(b,a);function b(b,c,d){var e=a.call(this,b)||this;return e.formula=c,e.Ik=d,e}return b.prototype.evaluateFormulaBy=function(a){var b=this,c=b.formula,d=b.Ik;return b.AOJ(a,function(a){return q(d(a),c)})[a[0]]},b}(g),b.FormulaField=j;function q(a,b){return a._error||a._code?"Calc Error "+b+":"+a._error+","+a._code:a}k=function(a){o(b,a);function b(b,c){var d=a.call(this,b)||this;return d.BOJ=c,d.COJ={},d.Ey=[],d}return b.prototype.getKey=function(a){return this.COJ[a]},b.prototype.getMap=function(){return this.COJ},b.prototype.getValueByKey=function(a){return this.Ey[a]},b.prototype.DOJ=function(a,b){this.COJ[b]=a,this.Ey[a]=b},b.prototype.getValue=function(a){var b=this;return b.data&&b.data.length>0?b.ge(a):b.BOJ?b.BOJ.getValue(a):void 0},b.prototype.ge=function(a){var b=this;return b.Ey[b.data[a]]},b.prototype.addKey=function(a,b){var c=this,e=c.getKey(a);return d.isUndefined(e)&&(e=b,c.DOJ(e,a)),e},b}(f),b.CategoryField=k,l=function(a){o(b,a);function b(b,c,d){var e=a.call(this,b)||this;return e.Ik=d,e.formula=c,e}return b.prototype.evaluateFormulaBy=function(a,b){var c,d=this;return b=b||0,c=d.Ik(a,b),d.zOJ(a,d.addKey(c,a[b]),b),c},b}(k),b.CategoryFormulaField=l,m=function(a){o(b,a);function b(b){return a.call(this,b)||this}return b.prototype.setData=function(a,b,c){var d=this,e=d.addKey(a,b[c]);d.zOJ(b,e,c)},b}(k),b.SliceCategoryField=m,n=function(a){o(b,a);function b(b,c,d,e){var f=a.call(this,b.value)||this;return f.path=b.path,f.valueRelation=b.valueRelation,f.dimRelationPath=b.dimRelationPath,f.dimRelationKey=b.dimRelationKey,f.dimTableName=b.dimTableName,f.isDateDimValue=b.dimTableKeyFieldValue instanceof Date,f.dimTableKeyFieldValue=f.isDateDimValue?b.dimTableKeyFieldValue.getTime():b.dimTableKeyFieldValue,f.initialOptionIndex=b.initialOptionIndex,f.getValueByField=r(b,e,c),f.getOriginalValueByField=r(b,e,d),f.data=[],f}return b.prototype.setFieldExtra=function(b){a.prototype.setFieldExtra.call(this,b),this.extra.caption=this.path},b.prototype.o1J=function(a,b){var c=this,d=c.isDateDimValue;return d&&a instanceof Date?a.getTime()===b:a===b},b.prototype.q1J=function(a,b){var c=this,d=c.isOneToMany,e=c.dimRelationPath,f=c.dimTableKeyFieldValue;return!d&&c.o1J(b(e,a),f)?a:this.data[a]},b.prototype.getDimValue=function(){var a=this,b=a.isDateDimValue,c=a.dimTableKeyFieldValue;return b?new Date(c):c},b.prototype.getValueIndex=function(a){return this.q1J(a,this.getValueByField)},b.prototype.setValueIndex=function(a,b){this.data[a]=b},b.prototype.clearData=function(){this.data=[]},b.prototype.clearValue=function(a){this.data[a]=void 0},b.prototype.removeData=function(a,b){this.data.splice(a,b)},b.prototype.isReadonly=function(){return e.isFormula(this.valueRelation)||d.isFunction(this.valueRelation)},b.prototype.ge=function(a,b){var c,f=this,g=f.isOneToMany,h=f.valueArrayRelation,i=f.valueRelation,j=f.q1J(a,b);if(d.isNumber(j))return c=void 0,c=g?h.replace(e.RelationTemplateToken,j+1):i,b(c,a)},b.prototype.getValue=function(a){return this.ge(a,this.getValueByField)},b.prototype.getOriginalValue=function(a){return this.ge(a,this.getOriginalValueByField)},b.prototype.getRelationField=function(a){var b=this,c=b.isOneToMany,f=b.valueArrayRelation,g=b.valueRelation,h=b.getValueIndex(a);return c?d.isNumber(h)?f.replace(e.RelationTemplateToken,h+1):void 0:g},b}(f),b.CrossField=n;function r(a,b,c){return d.isFunction(a.valueRelation)?function(a,e){return d.isFunction(a)?a(b(e)):c(a,e)}:c}},"./dist/src/viewField/groupManager.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),b.GroupManager=b.getGroupFieldName=b.isGroupField=b.isGroupSlice=b.isGroupSummary=b.isGroupCategory=b.getGroupOptionIndexesFrom=void 0,d=c("./dist/src/dataSource/utils.js"),e=c("./dist/src/viewField/utils.js");function g(a,b){var c,e,f,g,h;if(d.isNullOrUndefined(a)||d.isNullOrUndefined(b))return a===b;if(c=Object.keys(a),e=Object.keys(b),c.length!==e.length)return!1;for(f=0,g=c;f<g.length;f++)if(h=g[f],a[h]!==b[h])return!1;return!0}function h(a){var b,c=[],d=a.split(e.FieldNameDelimiter).reverse();for(b=0;b<d.length;b+=2)c.push(d[b]);return c}b.getGroupOptionIndexesFrom=h;function i(a){return 1===h(a).length}b.isGroupCategory=i;function j(a){return 2===h(a).length}b.isGroupSummary=j;function k(a){return 3===h(a).length}b.isGroupSlice=k;function l(a){return 2===a.split(e.FieldNameDelimiter).length}b.isGroupField=l;function m(a){var b=a.split(e.FieldNameDelimiter);return b[b.length-2]}b.getGroupFieldName=m,f=function(){function a(a,b){this.i6=a,this.oSJ=b}return a.prototype.isGrouped=function(a){return g(a,this.i6)},a.prototype.groupBy=function(a,b){var c=this,d=c.KOJ(a,b);return{rootNode:d,indexMap:c.rSJ(b,function(){return c.LOJ(a,d)})}},a.prototype.rSJ=function(a,b){var c,d=this,e=d.i6;return d.xc={path:[],groupOptions:e,entireScope:a},d.oSJ(d.xc),c=b(),d.xc=null,d.oSJ(d.xc),c},a.prototype.KOJ=function(a,b){var c,d,e,f,g={};for(e=0,f=b.length;e<f;e++)d=b[e],c=g,this.MOJ(c,a,d);return g},a.prototype.MOJ=function(a,b,c){var e=this,f=b.field,g=f.getValue(c),h=f.addKey(g,c),i=e.NOJ(a,h);b.slices&&b.slices.forEach(function(a,b){d.isUndefined(i.slices)&&(i.slices=[]),d.isUndefined(i.slices[b])&&(i.slices[b]={});var f=i.slices[b];e.MOJ(f,a,c)}),b.group?e.MOJ(i,b.group,c):(d.isUndefined(i.recordIndexes)&&(i.recordIndexes=[]),i.recordIndexes.push(c))},a.prototype.NOJ=function(a,b){d.isUndefined(a.children)&&(a.childrenMap={},a.children=[]);var c=a.childrenMap[b];return d.isUndefined(c)&&(a.childrenMap[b]=c=a.children.length,a.children.push({key:b})),a.children[c]},a.prototype.LOJ=function(a,b){var c,d=this,e=b.children,f=[];for(c in e)e.hasOwnProperty(c)&&d.OOJ(e[c],a,f);return f},a.prototype.OOJ=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=c.length,s=a.recordIndexes;if(q.sSJ(a),s){for(d=0,e=s.length;d<e;d++)c[r+d]=s[d];q.POJ(b.formulas,c,r)}else{for(f=a.children,g=0,h=f;g<h.length;g++)i=h[g],q.OOJ(i,b.group,c);q.POJ(b.formulas,c,r)}if(a.slices)for(d=0,j=a.slices,k=j.length;d<k;d++){for(l=j[d],m=b.slices[d],n=m.formula,f=l.children,o=0,p=f;o<p.length;o++)i=p[o],i.result=q.QOJ(n,i.recordIndexes);m.addSliceField(m,b.formulas[m.formulaIndex],f,c,r)}q.tSJ()},a.prototype.POJ=function(a,b,c){if(a)for(var d=0,e=a.length;d<e;d++)a[d].evaluateFormulaBy(b,c)},a.prototype.QOJ=function(a,b){if(a)return a.evaluateFormulaBy(b)},a.prototype.sSJ=function(a){this.xc.path.push(a)},a.prototype.tSJ=function(){this.xc.path.pop()},a}(),b.GroupManager=f},"./dist/src/viewField/utils.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.isField=b.isRelated=b.isFormula=b.combineName=b.RelationTemplateToken=b.CaptionDelimiter=b.FieldNameDelimiter=void 0,b.FieldNameDelimiter="__",b.CaptionDelimiter="\\",b.RelationTemplateToken="{{}}";function d(){var a,c=[];for(a=0;a<arguments.length;a++)c[a]=arguments[a];return c.join(b.FieldNameDelimiter)}b.combineName=d;function e(a){return"="===a[0]}b.isFormula=e;function f(a){return a.indexOf(".")>-1}b.isRelated=f;function g(a){return a.indexOf(b.FieldNameDelimiter)>-1}b.isField=g},"./dist/src/viewField/viewField.entry.js":function(a,b,c){"use strict";var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c),Object.defineProperty(a,d,{enumerable:!0,get:function(){return b[c]}})}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||b.hasOwnProperty(c)||d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),e(c("./dist/src/viewField/groupManager.js"),b),e(c("./dist/src/viewField/fieldManager.js"),b),e(c("./dist/src/viewField/fields.js"),b),e(c("./dist/src/viewField/utils.js"),b)},"./node_modules/fetch-jsonp/build/fetch-jsonp.js":function(a,b,c){var d,e,f;!function(c,g){var h;e=[b,a],d=g,f="function"==typeof d?d.apply(b,e):d,!(void 0!==f&&(a.exports=f))}(this,function(a,b){"use strict";var c={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function d(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function e(a){try{delete window[a]}catch(b){window[a]=void 0}}function f(a){var b=document.getElementById(a);b&&document.getElementsByTagName("head")[0].removeChild(b)}function g(a){var b=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],g=a,h=b.timeout||c.timeout,i=b.jsonpCallback||c.jsonpCallback,j=void 0;return new Promise(function(c,k){var l,m=b.jsonpCallbackFunction||d(),n=i+"_"+m;window[m]=function(a){c({ok:!0,json:function b(){return Promise.resolve(a)}}),j&&clearTimeout(j),f(n),e(m)},g+=g.indexOf("?")===-1?"?":"&",l=document.createElement("script"),l.setAttribute("src",""+g+i+"="+m),b.charset&&l.setAttribute("charset",b.charset),l.id=n,document.getElementsByTagName("head")[0].appendChild(l),j=setTimeout(function(){k(Error("JSONP request to "+a+" timed out")),e(m),f(n),window[m]=function(){e(m)}},h),l.onerror=function(){k(Error("JSONP request to "+a+" failed")),e(m),f(n),j&&clearTimeout(j)}})}b.exports=g})},"./node_modules/whatwg-fetch/fetch.js":function(a,b,c){"use strict";var d,e,f,g,h,i;c.r(b),c.d(b,"Headers",function(){return n}),c.d(b,"Request",function(){return w}),c.d(b,"Response",function(){return z}),c.d(b,"DOMException",function(){return i}),c.d(b,"fetch",function(){return A}),d={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(a){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};function j(a){return a&&DataView.prototype.isPrototypeOf(a)}d.arrayBuffer&&(e=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=ArrayBuffer.isView||function(a){return a&&e.indexOf(Object.prototype.toString.call(a))>-1});function k(a){if("string"!=typeof a&&(a+=""),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(a))throw new TypeError("Invalid character in header field name");return a.toLowerCase()}function l(a){return"string"!=typeof a&&(a+=""),a}function m(a){var b={next:function(){var b=a.shift();return{done:void 0===b,value:b}}};return d.iterable&&(b[Symbol.iterator]=function(){return b}),b}function n(a){this.map={},a instanceof n?a.forEach(function(a,b){this.append(b,a)},this):Array.isArray(a)?a.forEach(function(a){this.append(a[0],a[1])},this):a&&Object.getOwnPropertyNames(a).forEach(function(b){this.append(b,a[b])},this)}n.prototype.append=function(a,b){a=k(a),b=l(b);var c=this.map[a];this.map[a]=c?c+", "+b:b},n.prototype.delete=function(a){delete this.map[k(a)]},n.prototype.get=function(a){return a=k(a),this.has(a)?this.map[a]:null},n.prototype.has=function(a){return this.map.hasOwnProperty(k(a))},n.prototype.set=function(a,b){this.map[k(a)]=l(b)},n.prototype.forEach=function(a,b){for(var c in this.map)this.map.hasOwnProperty(c)&&a.call(b,this.map[c],c,this)},n.prototype.keys=function(){var a=[];return this.forEach(function(b,c){a.push(c)}),m(a)},n.prototype.values=function(){var a=[];return this.forEach(function(b){a.push(b)}),m(a)},n.prototype.entries=function(){var a=[];return this.forEach(function(b,c){a.push([c,b])}),m(a)},d.iterable&&(n.prototype[Symbol.iterator]=n.prototype.entries);function o(a){return a.bodyUsed?Promise.reject(new TypeError("Already read")):void(a.bodyUsed=!0)}function p(a){return new Promise(function(b,c){a.onload=function(){b(a.result)},a.onerror=function(){c(a.error)}})}function q(a){var b=new FileReader,c=p(b);return b.readAsArrayBuffer(a),c}function r(a){var b=new FileReader,c=p(b);return b.readAsText(a),c}function s(a){var b,c=new Uint8Array(a),d=Array(c.length);for(b=0;b<c.length;b++)d[b]=String.fromCharCode(c[b]);return d.join("")}function t(a){if(a.slice)return a.slice(0);var b=new Uint8Array(a.byteLength);return b.set(new Uint8Array(a)),b.buffer}function u(){return this.bodyUsed=!1,this.qFJ=function(a){this.rFJ=a,a?"string"==typeof a?this.sFJ=a:d.blob&&Blob.prototype.isPrototypeOf(a)?this.tFJ=a:d.formData&&FormData.prototype.isPrototypeOf(a)?this.uFJ=a:d.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)?this.sFJ=""+a:d.arrayBuffer&&d.blob&&j(a)?(this.vFJ=t(a.buffer),this.rFJ=new Blob([this.vFJ])):d.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(a)||f(a))?this.vFJ=t(a):this.sFJ=a=Object.prototype.toString.call(a):this.sFJ="",this.headers.get("content-type")||("string"==typeof a?this.headers.set("content-type","text/plain;charset=UTF-8"):this.tFJ&&this.tFJ.type?this.headers.set("content-type",this.tFJ.type):d.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d.blob&&(this.blob=function(){var a=o(this);if(a)return a;if(this.tFJ)return Promise.resolve(this.tFJ);if(this.vFJ)return Promise.resolve(new Blob([this.vFJ]));if(this.uFJ)throw Error("could not read FormData body as blob");return Promise.resolve(new Blob([this.sFJ]))},this.arrayBuffer=function(){return this.vFJ?o(this)||Promise.resolve(this.vFJ):this.blob().then(q)}),this.text=function(){var a=o(this);if(a)return a;if(this.tFJ)return r(this.tFJ);if(this.vFJ)return Promise.resolve(s(this.vFJ));if(this.uFJ)throw Error("could not read FormData body as text");return Promise.resolve(this.sFJ)},d.formData&&(this.formData=function(){return this.text().then(x)}),this.json=function(){return this.text().then(JSON.parse)},this}g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function v(a){var b=a.toUpperCase();return g.indexOf(b)>-1?b:a}function w(a,b){b=b||{};var c=b.body;if(a instanceof w){if(a.bodyUsed)throw new TypeError("Already read");this.url=a.url,this.credentials=a.credentials,b.headers||(this.headers=new n(a.headers)),this.method=a.method,this.mode=a.mode,this.signal=a.signal,c||null==a.rFJ||(c=a.rFJ,a.bodyUsed=!0)}else this.url=a+"";if(this.credentials=b.credentials||this.credentials||"same-origin",!b.headers&&this.headers||(this.headers=new n(b.headers)),this.method=v(b.method||this.method||"GET"),this.mode=b.mode||this.mode||null,this.signal=b.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&c)throw new TypeError("Body not allowed for GET or HEAD requests");this.qFJ(c)}w.prototype.clone=function(){return new w(this,{body:this.rFJ})};function x(a){var b=new FormData;return a.trim().split("&").forEach(function(a){var c,d,e;a&&(c=a.split("="),d=c.shift().replace(/\+/g," "),e=c.join("=").replace(/\+/g," "),b.append(decodeURIComponent(d),decodeURIComponent(e)))}),b}function y(a){var b=new n,c=a.replace(/\r?\n[\t ]+/g," ");return c.split(/\r?\n/).forEach(function(a){var c,d=a.split(":"),e=d.shift().trim();e&&(c=d.join(":").trim(),b.append(e,c))}),b}u.call(w.prototype);function z(a,b){b||(b={}),this.type="default",this.status=void 0===b.status?200:b.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in b?b.statusText:"OK",this.headers=new n(b.headers),this.url=b.url||"",this.qFJ(a)}u.call(z.prototype),z.prototype.clone=function(){return new z(this.rFJ,{status:this.status,statusText:this.statusText,headers:new n(this.headers),url:this.url})},z.error=function(){var a=new z(null,{status:0,statusText:""});return a.type="error",a},h=[301,302,303,307,308],z.redirect=function(a,b){if(h.indexOf(b)===-1)throw new RangeError("Invalid status code");return new z(null,{status:b,headers:{location:a}})},i=self.DOMException;try{new i}catch(a){i=function(a,b){this.message=a,this.name=b;var c=Error(a);this.stack=c.stack},i.prototype=Object.create(Error.prototype),i.prototype.constructor=i}function A(a,b){return new Promise(function(c,e){var f,g=new w(a,b);if(g.signal&&g.signal.aborted)return e(new i("Aborted","AbortError"));f=new XMLHttpRequest;function h(){f.abort()}f.onload=function(){var a,b={status:f.status,statusText:f.statusText,headers:y(f.getAllResponseHeaders()||"")};b.url="responseURL"in f?f.responseURL:b.headers.get("X-Request-URL"),a="response"in f?f.response:f.responseText,c(new z(a,b))},f.onerror=function(){e(new TypeError("Network request failed"))},f.ontimeout=function(){e(new TypeError("Network request failed"))},f.onabort=function(){e(new i("Aborted","AbortError"))},f.open(g.method,g.url,!0),"include"===g.credentials?f.withCredentials=!0:"omit"===g.credentials&&(f.withCredentials=!1),"responseType"in f&&d.blob&&(f.responseType="blob"),g.headers.forEach(function(a,b){f.setRequestHeader(b,a)}),g.signal&&(g.signal.addEventListener("abort",h),f.onreadystatechange=function(){4===f.readyState&&g.signal.removeEventListener("abort",h)}),f.send(void 0===g.rFJ?null:g.rFJ)})}A.polyfill=!0,self.fetch||(self.fetch=A,self.Headers=n,self.Request=w,self.Response=z)},CalcEngine:function(a,b){a.exports=c("@grapecity/js-calc")},Common:function(a,b){a.exports=c("Common")}}),a.exports=d.Data},"./node_modules_local/@grapecity/js-data-manager/index.js":function(a,b,c){a.exports=c("./node_modules_local/@grapecity/js-data-manager/dist/gc.data.js")},"./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js":function(a,b){var c="object"==typeof c?c:{};c.Spread=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./src/all.entry.ts")}({"./node_modules/webpack/buildin/global.js":function(a,b){var c;c=function(){return this}();try{c=c||Function("return this")()}catch(a){"object"==typeof window&&(c=window)}a.exports=c},"./src/all.entry.ts":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/common.entry.ts"),b.Common=d,e=c("./src/plugins/commands/commands.entry.ts"),b.Commands=e,f=c("./src/plugins/formatter/formatter.entry.ts"),b.Formatter=f,g=c("./src/plugins/sparkline/sparkline.entry.ts"),b.Sparklines=g,h=c("./src/plugins/slicer/slicer.entry.ts"),b.Slicers=h},"./src/common/common.entry.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n;function o(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/colorhelper.ts"),b.pc=d.pc,e=c("./src/common/util/types.ts"),b.j=e.j,f=c("./src/common/util/arrayhelper.ts"),b.k=f.k,g=c("./src/common/util/datetimehelper.ts"),b.l=g.l,h=c("./src/common/util/numberhelper.ts"),b.o=h.o,i=c("./src/common/util/regexhelper.ts"),b.q=i.q,j=c("./src/common/util/stringhelper.ts"),b.u=j.u,k=c("./src/common/util/rbush.ts"),b.rbush=k.rbush,l=c("./src/common/util/datetimehelper.ts"),b.JLJ=l.getSR,m=c("./src/common/util/common.ts"),Object.defineProperty(b,"HandleExcelSpecialDate",{set:function(a){m.HandleExcelSpecialDate=a},get:function(){return m.HandleExcelSpecialDate}}),o(c("./src/common/util/common.ts")),n=c("./src/common/culture/cultureInfo.ts"),b.CultureInfo=n.CultureInfo,b.CultureManager=n.CultureManager,o(c("./src/common/util/functionhelper.ts"))},"./src/common/culture/cultureInfo.ts":function(a,b,c){"use strict";(function(a){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/types.ts"),e=c("./src/common/util/common.ts"),f=c("./src/common/util/arrayhelper.ts"),g="undefined"!=typeof window?window:a,h=void 0,i=null,j=d.j.H,k=d.j.Ia,l=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"],m=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"],n=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],o=l.concat(m),j(l,function(a,b){j(m,function(a,c){a<m.length-4&&o.push(b+" "+c)})}),o=o.concat(n),j(n,function(a,b){j(m,function(a,c){a<m.length-4&&o.push(b+" "+c)})}),function(a){a[a.year=1]="year",a[a.quarterOrMonth=2]="quarterOrMonth",a[a.date=3]="date"}(p=b.TimelineDateOrder||(b.TimelineDateOrder={}));function C(a){return a.split("\xa0").join(" ").toUpperCase()}function D(a){var b,c,d=[];for(b=0,c=a.length;b<c;b++)d[b]=C(a[b]);return d}function E(a,b,c){var d=C(a),e=b.indexOf(d);return e===-1&&(e=c.indexOf(d)),
e}q=function(){function a(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"\xa4",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"\u2030",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{},standardDictionaryNumbers:{Hundreds:"Hundreds",Thousands:"Thousands",Millions:"Millions",Billions:"Billions",Trillions:"Trillions"}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],defaultDatePattern:"MM/dd/yyyy H:mm:ss",firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM",filterDialogDateFormatter:"yyyy/mmmm/dd",preselectedFormatters:[],eraFormatter:["ge/M/d","ge-M-d","ge.M.d","gee/MM/dd"]},this.name=function(){return""},this.id=-1,this.LocalNumberFormat={},this.displayName="",this.predefinedFormats={},this.TimelineDateOrder=[p.quarterOrMonth,p.date,p.year],this.TimelineDateSuffix={year:"",quarter:"",month:"",date:""}}return a.prototype.ma=function(){var a,b,c,d;return this.na||(a=this.DateTimeFormat,b=a.shortDatePattern.replace(/m/g,"M"),c=[b,b+" h:mm",b+" h:mm:ss",b+" h:mm:ss.0","MMMdd","MMMd","MMM dd","MMM d"],c=c.concat(o),1041===this.id&&(d=a.eraFormatter,c=c.concat(this.X8J),c=c.concat(d)),c=c.concat(a.preselectedFormatters),this.na=c),this.na},a.prototype.oa=function(a){var b=this;return b.pa||(b.pa=D(b.DateTimeFormat.monthNames),b.qa=D(b.DateTimeFormat.monthGenitiveNames)),E(a,b.pa,b.qa)},a.prototype.ra=function(a){var b=this;return b.sa||(b.sa=D(b.DateTimeFormat.abbreviatedMonthNames),b.ta=D(b.DateTimeFormat.abbreviatedMonthGenitiveNames)),E(a,b.sa,b.ta)},a.prototype.ua=function(a){var b=this;return b.va||(b.va=D(b.DateTimeFormat.dayNames)),b.va.indexOf(C(a))},a.prototype.wa=function(a){var b=this;return b.xa||(b.xa=D(b.DateTimeFormat.abbreviatedDayNames)),b.xa.indexOf(C(a))},a}(),b.CultureInfo=q,r=function(){function a(){}return a.I=function(b){return b>=a.J()&&b<=a.K()},a.L=function(){var a,b,c=q.eras;if(c!==h){for(a=[],b=0;b<c.length;b++)a[b]=new Date(c[b].startDate.replace(/-/g,"/"));return a}return this.O},a.P=function(b){var c,d,e,f,g;switch(b){case"g":c="symbol",d=a.R;break;case"gg":c="abbreviation",d=a.S;break;case"ggg":c="name",d=a.U;break;default:return[]}if(e=q.eras,f=[],e!==h){for(g=0;g<e.length;g++)f[g]=e[g][c];return f}return d},a.K=function(){var a,b=q.eras;return b!==h&&b.length>0?(a=new Date(b[b.length-1].startDate.replace(/-/g,"/")),a.setFullYear(a.getFullYear()+99),a):this.W},a.J=function(){var a=q.eras;return a!==h&&a.length>0?new Date(a[0].startDate.replace(/-/g,"/")):this.Z},a.$=function(){var a=q.eras;return a!==h?a.length:this._},a.aa=function(){var a,b,c,d,e=q.eras;if(e!==h){for(a=[],b=1;b<e.length;b++)c=new Date(e[b-1].startDate.replace(/-/g,"/")),d=new Date(e[b].startDate.replace(/-/g,"/")),a[b-1]=d.getFullYear()-c.getFullYear()+1;return a[b-1]=99,a}return this.ba},a.ca=function(b){var c,d,e={da:-1,ea:-1};if(!a.I(b)){if(!(b>a.K()))return e;b=a.K()}for(c=0;c<a.$();c++)if(d=c+1!==a.$()?a.L()[c+1]:a.fa(a.K(),1),b<d){e.da=c,e.ea=b.getFullYear()-a.L()[c].getFullYear()+1;break}return e},a.fa=function(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds());return c.setMilliseconds(c.getMilliseconds()+b),new Date(c.valueOf())},a.ga=function(b,c){var d=a.L()[b].getFullYear();return d+c-1},a.ha=function(b,c){var d,e;for(c=c.toUpperCase(),d=a.P(b),e=0;e<d.length;e++)if(d[e]===c)return e;return-1},a.ia=function(b,c,d){var e,f,g,h=a,i=h.ca(c),j=i.da;if(j>=0&&(e=h.P(b),e.length>0))return e[j];if(f=i.ea,f>=0){if(g=""+f,"1"===g&&d)return g="\u5143";if("ee"===b)return 1===g.length&&(g="0"+g),g;if("e"===b)return g}return""},a.O=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8),new Date(2019,4,1)],a._=5,a.ba=[45,15,64,31,99],a.W=new Date(2117,11,31,23,59,59),a.Z=new Date(1868,8,8),a.ja=["1,m","2,t","3,s","4,h","5,r"],a.ka=[0,1,2,3,0,1,2,3],a.U=["\u660e\u6cbb","\u5927\u6b63","\u662d\u548c","\u5e73\u6210","\u4ee4\u548c"],a.R=["M","T","S","H","R"],a.S=["\u660e","\u5927","\u662d","\u5e73","\u4ee4"],a.la=99,a.eraExcelFormatter="[$-ja-JP-x-gannen]",a.eraInternalFormatter="[$-411]",a}(),b.aBb=r,s=function(a){B(b,a);function b(){var b,c=a.call(this)||this;return F.call(c,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),b=["MMM yyyy","MMMM yyyy"],F.call(c,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly","preselectedFormatters"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!1,b]),c.DateTimeFormat.defaultDatePattern=c.DateTimeFormat.shortDatePattern+" H:mm:ss",c.name=function(){return"en-US"},c.displayName="English (United States)",c.id=1033,c.predefinedFormats={Accounting:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',Comma:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',Currency:["[$$-409]#,##0.","[$$-409]#,##0.;[Red][$$-409]#,##0.","[$$-409]#,##0._);([$$-409]#,##0.)","[$$-409]#,##0._);[Red]([$$-409]#,##0.)"],Date:["m/d/yyyy","[$-409]dddd, mmmm dd, yyyy","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmm d, yyyy;@","[$-409]m/d/yy h:mm AM/PM;@","m/d/yy h:mm;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@","m/d/yyyy;@","[$-409]d-mmm-yyyy;@"],Time:["[$-409]h:mm:ss AM/PM","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@","mm:ss.0;@","[h]:mm:ss;@","[$-409]m/d/yy h:mm AM/PM;@","m/d/yy h:mm;@"],Special:{"Zip Code":"00000","Zip Code + 4":"00000-0000","Phone Number":"[<=9999999]###-####;(###) ###-####","Social Security Number":"000-00-0000"}},c}return b}(q),t=function(a){B(b,a);function b(){var b,c,d,e=a.call(this)||this,f={1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u3007","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\u62fe","\u5104","\u9621","\u767e","\u62fe","\u842c","\u9621","\u767e","\u62fe",""],numbers:["\u3007","\u58f1","\u5f10","\u53c2","\u56db","\u4f0d","\u516d","\u4e03","\u516b","\u4e5d"]},3:{letters:i,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},g={Hundreds:"\u767e",Thousands:"\u5343",Millions:"\u767e\u4e07",Billions:"\u5341\u5104",Trillions:"\u5146"};return F.call(e,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[0,1,"\xa5",!1,"NaN (\u975e\u6570\u5024)","-\u221e",1,1,"+\u221e",f,g]),b=["1","2","3","4","5","6","7","8","9","10","11","12",""],c=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],d=["yyyy\u5e74M\u6708d\u65e5","yyyy\u5e74M\u6708dd\u65e5","yyyy\u5e74MM\u6708d\u65e5","yyyy\u5e74MM\u6708dd\u65e5"],F.call(e,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters","EraFilterDialogDateFormatter"],[["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],b,b,"\u5348\u524d",!1,["\u65e5\u66dc\u65e5","\u6708\u66dc\u65e5","\u706b\u66dc\u65e5","\u6c34\u66dc\u65e5","\u6728\u66dc\u65e5","\u91d1\u66dc\u65e5","\u571f\u66dc\u65e5"],"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",c,c,"\u897f\u66a6 (\u65e5\u672c\u8a9e)","\u5348\u5f8c","yyyy/MM/dd",["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],"H:mm","yyyy'\u5e74'M'\u6708'","yyyy\u5e74/mmmm/d\u65e5",d,"ggge/mmmm/d\u65e5"]),e.DateTimeFormat.eras=!0,e.DateTimeFormat.defaultDatePattern=e.DateTimeFormat.shortDatePattern+" "+e.DateTimeFormat.longTimePattern,e.X8J=['gggee"\u5e74"MM"\u6708"dd"\u65e5','gggee"\u5e74"M"\u6708"d"\u65e5','ge"\u5e74"M"\u6708"d"\u65e5','ggge"\u5e74"M"\u6708"d"\u65e5','ggee"\u5e74"M"\u6708"d"\u65e5','gge"\u5e74"M"\u6708"d"\u65e5'],e.name=function(){return"ja-JP"},e.id=1041,e.displayName="Japanese (Japan)",e.isJCKCulture=!0,e.predefinedFormats={Accounting:'_-[$\xa5-411]* #,##0.00_-;-[$\xa5-411]* #,##0.00_-;_-[$\xa5-411]* "-"??_-;_-@_-',Comma:'_-* #,##0.00_-;-* #,##0.00_-;_-* "-"??_-;_-@_-',Currency:["[$\xa5-411]#,##0.","[$\xa5-411]#,##0.;[Red][$\xa5-411]#,##0.","[$\xa5-411]#,##0.;-[$\xa5-411]#,##0.","[$\xa5-411]#,##0.;[Red]-[$\xa5-411]#,##0."],Date:['yyyy"\u5e74"m"\u6708"d"\u65e5";@','yyyy"\u5e74"m"\u6708";@','m"\u6708"d"\u65e5";@',"yyyy/m/d;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@"],Time:["h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@",'h"\u6642"mm"\u5206";@','h"\u6642"mm"\u5206"ss"\u79d2";@'],Special:{"\u90f5\u4fbf\u756a\u53f7":"[<=999]000;[<=9999]000-00;000-0000","\u96fb\u8a71\u756a\u53f7\uff08\u6771\u4eac)":"[<=99999999]####-####;(00) ####-####","\u6b63\u8ca0\u8a18\u53f7 \uff08+ = \u25b3; - = \u25b2)":"'\u25b3' #,##0;'\u25b2' #,##0","\u6f22\u6570\u5b57\uff08\u5341\u4e8c\u4e07\u4e09\u5343\u56db\u767e\uff09":"[DBNum1][$-411]General","\u5927\u5b57 (\u58f1\u62fe\u5f10\u842c\u53c2\u9621\u56db\u767e)":"[DBNum2][$-411]General","\u5168\u89d2 (\uff11\uff12\uff13\uff14\uff15)":"[DBNum3][$-411]0","\u5168\u89d2 \u6841\u533a\u5207\u308a\uff08\uff11\uff12,\uff13\uff14\uff15\uff09":"[DBNum3][$-411]#,##0"}},e.TimelineDateOrder=[p.year,p.quarterOrMonth,p.date],e.TimelineDateSuffix={year:"\u5e74",quarter:"",month:"\u6708",date:"\u65e5"},e}return b}(q),u=function(a){B(b,a);function b(){var b,c,d,e=a.call(this)||this,f={1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u25cb","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u4edf","\u4f70","\u62fe","\u4ebf","\u4edf","\u4f70","\u62fe","\u4e07","\u4edf","\u4f70","\u62fe",""],numbers:["\u96f6","\u58f9","\u8d30","\u53c1","\u8086","\u4f0d","\u9646","\u67d2","\u634c","\u7396"]},3:{letters:i,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},g={Hundreds:"\u767e",Thousands:"\u5343",Millions:"\u767e\u4e07",Billions:"\u5341\u4ebf",Trillions:"\u5146"};return F.call(e,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[2,"\xa5",!1,"\u975e\u6570\u5b57","\u8d1f\u65e0\u7a77\u5927",1,1,"\u6b63\u65e0\u7a77\u5927",f,g]),b=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],c=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],d=["yyyy\u5e74M\u6708","M\u6708d\u65e5","yyyy\u5e74M\u6708d\u65e5","h\u65f6mm\u5206","h\u65f6mm\u5206ss\u79d2"],F.call(e,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters"],[["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],b,b,"\u4e0a\u5348",!1,["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],1,"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",c,c,"\u516c\u5386","\u4e0b\u5348","yyyy/M/d",["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],"H:mm","yyyy'\u5e74'M'\u6708'","yyyy\u5e74/mmmm/d\u65e5",d]),e.DateTimeFormat.defaultDatePattern=e.DateTimeFormat.shortDatePattern+" "+e.DateTimeFormat.longTimePattern,e.name=function(){return"zh-cn"},e.id=2052,e.displayName="Chinese (China)",e.isJCKCulture=!0,e.localeCompare=function(a,b){return a.localeCompare(b,"zh")},e.predefinedFormats={Accounting:'_-[$\xa5-804]* #,##0.00_-;-[$\xa5-804]* #,##0.00_-;_-[$\xa5-804]* "-"??_-;_-@_-',Comma:'_ * #,##0.00_ ;_ * -#,##0.00_ ;_ * "-"??_ ;_ @_ ',Currency:["[$\xa5-804]#,##0.","[$\xa5-804]#,##0.;[Red][$\xa5-804]#,##0.","[$\xa5-804]#,##0.;[$\xa5-804]-#,##0.","[$\xa5-804]#,##0.;[Red][$\xa5-804]-#,##0."],Date:["yyyy-mm-dd;@",'[DBNum1][$-804]yyyy"\u5e74"m"\u6708"d"\u65e5";@','[DBNum1][$-804]yyyy"\u5e74"m"\u6708";@','[DBNum1][$-804]m"\u6708"d"\u65e5";@',"[$-409]yyyy/m/d h:mm AM/PM;@",'yyyy"\u5e74"m"\u6708"d"\u65e5";@','yyyy"\u5e74"m"\u6708";@','m"\u6708"d"\u65e5";@',"mm/dd/yy;@","m/d/yy;@","yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]m","[$-409]m-d;@"],Time:["h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@",'h"\u65f6"mm"\u5206";@','h"\u65f6"mm"\u5206"ss"\u79d2";@','[$-804]AM/PM h"\u65f6"mm"\u5206";;@','[$-804]AM/PM h"\u65f6"mm"\u5206"ss"\u79d2";@','[DBNum1][$-804]h"\u65f6"mm"\u5206";@','[DBNum1][$-804]AM/PM h"\u65f6"mm"\u5206";@'],Special:{"\u90ae\u653f\u7f16\u7801":"000000","\u4e2d\u6587\u5c0f\u5199\u5b57\u6bcd":"[DBNum1][$-804]General","\u4e2d\u6587\u5927\u5199\u5b57\u6bcd":"[DBNum2][$-804]General"}},e.TimelineDateOrder=[p.year,p.quarterOrMonth,p.date],e.TimelineDateSuffix={year:"\u5e74",quarter:"",month:"",date:"\u65e5"},e}return b}(q),v=function(a){B(b,a);function b(){var b,c,d=a.call(this)||this,e={1:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\uf9d1","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\uf973","\u5104","\u9621","\u767e","\uf973","\u842c","\u9621","\u767e","\uf973",""],numbers:["\uf9b2","\u58f9","\u8cb3","\uf96b","\u56db","\u4f0d","\uf9d1","\u4e03","\u516b","\u4e5d"]},3:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]},4:{letters:["\uc870","\ucc9c","\ubc31","\uc2ed","\uc5b5","\ucc9c","\ubc31","\uc2ed","\ub9cc","\ucc9c","\ubc31","\uc2ed",""],numbers:["\u25cb","\uc77c","\uc774","\uc0bc","\uc0ac","\uc624","\uc721","\uce60","\ud314","\uad6c"]}},f={Hundreds:"\ubc31",Thousands:"\ucc9c",Millions:"\ubc31\ub9cc",Billions:"10\uc5b5",Trillions:"\uc870"};return F.call(d,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber","standardDictionaryNumbers"],[0,1,"\u20a9",!1,e,f]),b=["1","2","3","4","5","6","7","8","9","10","11","12",""],c=["1\uc6d4","2\uc6d4","3\uc6d4","4\uc6d4","5\uc6d4","6\uc6d4","7\uc6d4","8\uc6d4","9\uc6d4","10\uc6d4","11\uc6d4","12\uc6d4",""],F.call(d,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],b,b,"\uc624\uc804",!1,["\uc77c\uc694\uc77c","\uc6d4\uc694\uc77c","\ud654\uc694\uc77c","\uc218\uc694\uc77c","\ubaa9\uc694\uc77c","\uae08\uc694\uc77c","\ud1a0\uc694\uc77c"],1,"yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd h:mm:ss","yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd","h:mm:ss","M'\uc6d4' d'\uc77c'",c,c,"\uc11c\uae30","\uc624\ud6c4","yyyy-MM-dd",["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],"tt h:mm","yyyy'\ub144' M'\uc6d4'","yyyy\ub144/mmmm/d\uc77c"]),d.DateTimeFormat.defaultDatePattern=d.DateTimeFormat.shortDatePattern+" "+d.DateTimeFormat.longTimePattern,d.name=function(){return"ko-kr"},d.id=1042,d.displayName="Korean (Korea)",d.isJCKCulture=!0,d.predefinedFormats={Accounting:'_-[$\u20a9-412]* #,##0.00_-;-[$\u20a9-412]* #,##0.00_-;_-[$\u20a9-412]* "-"??_-;_-@_-',Comma:'_-* #,##0.00_-;-* #,##0.00_-;_-* "-"??_-;_-@_-',Currency:["[$\u20a9-412]#,##0.","[$\u20a9-412]#,##0.;[Red][$\u20a9-412]#,##0.","[$\u20a9-412]#,##0.;-[$\u20a9-412]#,##0.","[$\u20a9-412]#,##0.;[Red]-[$\u20a9-412]#,##0."],Date:["yyyy-mm-dd;@",'yyyy"\ub144" m"\uc6d4" d"\uc77c";@','yy"\u5e74" m"\u6708" d"\u65e5";@','yyyy"\ub144" m"\uc6d4";@','m"\uc6d4" d"\uc77c";@',"yy-m-d;@","yy-m-d h:mm;@",'m"\u6708"d"\u65e5";@',"[$-412]yy-m-d AM/PM h:mm;@","yy/m/d;@","yyyy/m/d h:mm;@","m/d;@","m/d/yy;@","mm/dd/yy;@","[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]m","[$-409]m-d;@"],Time:["h:mm;@","h:mm:ss;@","[$-412]AM/PM h:mm;@","[$-412]AM/PM h:mm:ss;@","[$-409]h:mm AM/PM;@","[$-409]h:mm:ss AM/PM;@",'yyyy"-"m"-"d h:mm;@','[$-412]yyyy"-"m"-"d AM/PM h:mm;@','[$-409]yyyy"-"m"-"d h:mm AM/PM;@','h"\uc2dc" mm"\ubd84";@','h"\uc2dc" mm"\ubd84" ss"\ucd08";@','[$-412]AM/PM h"\uc2dc" mm"\ubd84";@','[$-412]AM/PM h"\uc2dc" mm"\ubd84" ss"\ucd08";@'],Special:{"\uc6b0\ud3b8 \ubc88\ud638":"000-000","\uc804\ud654 \ubc88\ud638 (\uad6d\ubc88 4\uc790\ub9ac)":"[<=999999]####-####;(0##) ####-####","\uc804\ud654 \ubc88\ud638 (\uad6d\ubc88 3\uc790\ub9ac)":"[<=9999999]###-####;(0##) ###-####","\uc8fc\ubbfc\ub4f1\ub85d\ubc88\ud638":"000000-0000000","\uc22b\uc790(\ud55c\uc790)":"[DBNum1][$-412]General","\uc22b\uc790(\ud55c\uc790-\uac16\uc740\uc790)":"[DBNum2][$-412]General","\uc22b\uc790(\ud55c\uae00)":"[DBNum4][$-412]General"}},d.TimelineDateOrder=[p.year,p.quarterOrMonth,p.date],d.TimelineDateSuffix={year:"\ub144",quarter:"",month:"\uc6d4",date:"\uc77c"},d}return b}(q),w={invariant:new q,"en-us":new s,"ja-jp":new t,"zh-cn":new u,"ko-kr":new v};function F(a,b,c){var d,e,f,g=this;for(e=0,f=b.length;e<f;e++)d=b[e],g[a][d]=c[e]}function G(a,b){if("object"==typeof document){var c;"function"!=typeof CustomEvent?(c=document.createEvent("CustomEvent"),c.initCustomEvent("cultureChanged",!1,!1,void 0)):c=new CustomEvent("cultureChanged",{}),c.cultureInfo=a,g.gcCultureInfo=a,g.gcCultureObj=b,document.dispatchEvent(c)}}x={},y=["lsru","lsde","ls1","ls2","ls3","ls4","ls5","ls6","ls7","ls8"],z=["wmk1","wmk2"],A=function(){function a(){this.bBb=1,this.KLJ={}}return a.instance=function(){return this.cBb||(this.cBb=new this)},a.prototype.culture=function(b){return 0===arguments.length?a.dBb:void(b&&a.dBb!==b&&(a.dBb=b.toLowerCase(),this.bBb++,G(a.dBb,a.cBb.getCultureInfo())))},a.prototype.addCultureInfo=function(a,b,c){var d,f,g,h,i;if(b&&b instanceof q){if(d=b.NumberFormat&&b.NumberFormat.numberDecimalSeparator,f=b.NumberFormat.arrayListSeparator,g=b.NumberFormat.arrayGroupSeparator,d===b.NumberFormat.listSeparator||g===f)throw h=new e.ResourceManager(e.SR),h.getResource().Exp_Separator;w[a.toLowerCase()]=b}c&&"object"==typeof c&&(i=a.toLowerCase(),x[i]=k(!0,{},c),this.bBb++)},a.prototype.getCultureInfoDict=function(){return w},a.prototype.getCultureInfo=function(b){var c,d,e;if(0===arguments.length)return w[a.dBb];"string"==typeof b&&(b=b.toLowerCase()),c=w,d=i;for(e in c)if(e===b||c[e].id!==h&&c[e].id===b){d=c[e];break}return d},a.prototype.getLanguage=function(a){if("string"==typeof a){var b=a.toLowerCase();return x[b]}return i},a.prototype.getResources=function(a){var b,c=this.culture().toLowerCase();return a!==i&&a!==h||(a=c),"string"==typeof a&&(b=a.toLowerCase(),this.KLJ[b])?this.LLJ(this.KLJ[b]):i},a.prototype.LLJ=function(a){var b,c="PivotTables",d="Sheets",e="CalcEngine",f="Functions",g="TableFunctions",h=k(!0,{},a);return h[c]&&this.MLJ(h[c],z),h[d]&&this.MLJ(h[d],y),b=h[e],b&&(h[f]=b._h,h[g]=b.B2,delete b._h,delete b.B2),h},a.prototype.MLJ=function(a,b){var c,d,e;for(c=0,d=b;c<d.length;c++)e=d[c],delete a[e]},a.prototype.eBb=function(a,b,c){var d,e,g=x[a.toLowerCase()];for(d in b)f.k.Bb(y,d)||(e=this.fBb(g,d,c),null!==e&&"string"==typeof e&&"string"==typeof b[d]&&(b[d]=e));b._h&&g.Functions&&this.gBb(g.Functions,b._h),b.B2&&g.TableFunctions&&k(!0,b.B2,g.TableFunctions)},a.prototype.fBb=function(a,b,c){var d,e;if(a.hasOwnProperty(b))return a[b];if(c&&(d=a[c],d&&"object"==typeof d&&d.hasOwnProperty(b)))return d[b];for(e in a)if(d=a[e],d&&"object"==typeof d&&d.hasOwnProperty(b))return d[b];return null},a.prototype.gBb=function(a,b){var c,d,e,f,g,h,i,j={};for(c in b)if(a.hasOwnProperty(c)){d=b[c],e=a[c],f=d.parameters,g=e.parameters,d.description=e.description;for(h in f)g.hasOwnProperty(h)&&(i=g[h],"string"==typeof i&&(f[h].name=i))}return j},a.prototype.q4=function(b){var c=this.getCultureInfo(b);return c||(c=w[a.dBb],c||(c=new q)),c},a.prototype.LZa=function(a,b){var c=this.getCultureInfo(a)||this.getCultureInfo("en-US"),d=c.DateTimeFormat,e=d.filterDialogDateFormatter;return(b.indexOf("g")>=0||b.indexOf("e")>=0)&&(e=d.EraFilterDialogDateFormatter||e),e},a.dBb="en-us",a}(),b.CultureManager=A.instance()}).call(this,c("./node_modules/webpack/buildin/global.js"))},"./src/common/util/arrayhelper.ts":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=null,e=void 0;function g(a,b){var c,e;for(c in b)b.hasOwnProperty(c)&&(e=b[c],Array.isArray(e)?(a[c]=[],g(a[c],b[c])):e!==d&&"object"==typeof e?(a[c]={},g(a[c],b[c])):a[c]=b[c])}f=function(){function a(){}return a.Eb=function(a,b,c){a.splice(b,0,c)},a.Sb=function(a,b){a.push(b)},a.Bb=function(a,b){return a.indexOf(b)>-1},a.Fb=function(a,b){var c=a.indexOf(b);c>-1&&a.splice(c,1)},a.Zb=function(a,b){return a.slice(0,b).concat(a.slice(b+1))},a.Cb=function(a,b,c){return a.indexOf(b,c)},a.$b=function(a,b,c){if(!(b<0))for(var e=0;e<c&&b+e<a.length;e++)a[b+e]=d},a._b=function(a,b){var c,f;for(b<0&&(b=-1),c=b+1,f=c;f<a.length;f++)if(a[f]!==e&&a[f]!==d)return f;return-1},a.ac=function(a){return a&&a.length},a.Uo=function(a){var b=[];return g(b,a),b},a}(),b.k=f},"./src/common/util/colorhelper.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/numberhelper.ts"),e=d.o.pb,f=Math.min,g=Math.max,h=Math.abs,i=parseInt;function m(a,b,c){return c<0&&(c+=240),c>240&&(c-=240),c<40?a+((b-a)*c+20)/40:c<120?b:c<160?a+((b-a)*(160-c)+20)/40:a}function n(a,b,c){var d,e,f,g,h;return 0===c?d=e=f=i(255*b/240+"",10):(g=void 0,h=void 0,h=b<=120?i((b*(240+c)+120)/240+""):b+c-i((b*c+120)/240+""),g=2*b-h,d=o(g,h,a+80),e=o(g,h,a),f=o(g,h,a-80)),{a:255,r:d,g:e,b:f}}function o(a,b,c){return f(i((255*m(a,b,c)+120)/240+""),255)}j=function(){function a(a){var b,c,d,e,h=this,j=a.r,k=a.g,l=a.b,m=g(g(j,k),l),n=f(f(j,k),l),o=m+n;h.kc=i((240*o+255)/510+"",10),b=m-n,0===b?(h.mc=0,h.lc=160):(h.kc<=120?h.mc=i((240*b+o/2)/o+"",10):h.mc=i((240*b+(510-o)/2)/(510-o)+"",10),c=(40*(m-j)+b/2)/b,d=(40*(m-k)+b/2)/b,e=(40*(m-l)+b/2)/b,j===m?h.lc=i(e-d+"",10):k===m?h.lc=i(80+c-e+"",10):h.lc=i(160+d-c+"",10),h.lc<0&&(h.lc+=240),h.lc>240&&(h.lc-=240))}return a.prototype.nc=function(a){var b=this,c=b.kc,d=b.oc(b.kc,500,!0);return n(b.lc,c+(d-c)*a,b.mc)},a.prototype.oc=function(a,b,c){return 0===b?a:c?b>0?(a*(1e3-b)+241*b)/1e3:a*(b+1e3)/1e3:(a+=240*b/1e3,a<0&&(a=0),a>240&&(a=240),a)},a}(),k=/rgb[a]?\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(\s*,\s*(\d{0,1}))?\)/;function p(a){var b,c,d,e;return/^#[A-Fa-f0-9]+$/.test(a)?(b=a.replace(/^#/,""),c=b.length,d=b.split(3===c?/(.)/:/(..)/),d=d.filter(Boolean).map(function(a){return 3===c?parseInt(a+a,16):parseInt(a,16)}),d[0]||(d[0]=0),d[1]||(d[1]=0),d[2]||(d[2]=0),[d[0],d[1],d[2],1]):(e=k.exec(a),null!==e?[e[1],e[2],e[3],1]:null)}l=function(){function a(){}return a.bc=function(a){var b=a.a,c=a.r,d=a.g,f=a.b;return 3===arguments.length&&(b=255,c=arguments[0],d=arguments[1],f=arguments[2]),4===arguments.length&&(b=arguments[0],c=arguments[1],d=arguments[2],f=arguments[3]),255===b?"#"+e(c,!0,2)+e(d,!0,2)+e(f,!0,2):"rgba("+c+","+d+","+f+","+b+")"},a.Pka=function(a,b){return a.stops||a.type?JSON.stringify(a)===JSON.stringify(b):a.a===b.a&&a.r===b.r&&a.g===b.g&&a.b===b.b},a.dc=function(a){return(299*a.r+587*a.g+114*a.b)/1e3},a.hc=function(a,b){var c,d=255-h(a.r-b.r),e=255-h(a.g-b.g),f=255-h(a.b-b.b),g=h(a.a-b.a);return d/=255,e/=255,f/=255,c=(d+e+f)/3,!!(c>=.9&&g<=.05)},a.ic=function(b){var c=255^b.r,d=255^b.g,e=255^b.b;return a.bc(b.a,c,d,e)},a.hBb=function(b){var c,d,e;return"object"!=typeof document?p(b):(c=a.Yn,c||(d=document.createElement("canvas"),d&&d.getContext&&(c=a.Yn=d.getContext("2d",{willReadFrequently:!0}))),c?(c.clearRect(1,1,1,1),c.fillStyle=b,c.fillRect(1,1,1,1),e=c.getImageData(1,1,1,1),e?e.data:null):b)},a.ec=function(b){var c,d,e,f,g;return b instanceof a?b:null!==b&&"object"==typeof b?b:(c=0,d=0,e=0,f=0,b&&(g=a.hBb(b),g&&(d=g[0],e=g[1],f=g[2],c=g[3])),{a:c,r:d,g:e,b:f})},a.jc=function(b,c){var d,e;return 0===c?b:(d=new j(b),e=i((c>0?(240-d.kc)*c:d.kc*c)+"",10),a.gc(d.lc,d.kc+e,d.mc))},a.nc=function(b,c){var d=a.ec(b),e=new j(d),f=e.nc(c);return a.bc(f)},a.fc=m,a.gc=n,a}(),b.pc=l},"./src/common/util/common.ts":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/culture/cultureInfo.ts"),e=c("./src/common/util/util.res.en.ts"),f=c("./src/common/util/types.ts"),b.SR={en:e},g=f.j.Ia,h=function(){function a(a,b){this.res=a,this.NLJ=b,this.KLJ=d.CultureManager.KLJ,this.cachedResource=this.iBb(a,!0),this.OLJ(this.cachedResource,b),this.bBb=0}return a.prototype.getResource=function(){var a=this.iBb(this.res,!this.cachedResource);return a&&(this.cachedResource=a),this.OLJ(this.cachedResource,this.NLJ),this.cachedResource},a.prototype.OLJ=function(a,b){var c,e;b&&(c=d.CultureManager.culture(),e=c.toLowerCase(),this.KLJ[e]=this.KLJ[e]||{},this.KLJ[e][b]=a,d.CultureManager.KLJ=this.KLJ)},a.prototype.iBb=function(a,b){var c,e,f,h=d.CultureManager.culture();if(a&&h){if(c=d.CultureManager.bBb,this.bBb===c&&!b)return;return this.bBb=c,d.CultureManager.getLanguage(h)?(e=g(!0,{},a.en),d.CultureManager.eBb(h,e,this.NLJ),e):(f=h.substr(0,2).toLowerCase(),a.hasOwnProperty(f)?a[f]:a.en)}return{}},a}(),b.ResourceManager=h;function i(a,b,c,d){var e,f,g,h,i;if(a&&0<=c&&c<b){for(e=[],f=void 0,g=void 0,g=c;g<b;g++)void 0!==a[g]&&e.push(g);for(f=e.length,g=0;g<f;g++)h=e[f-g-1],i=a[h],a[h]=null,a[Math.floor(h)+d]=i}}b.A=i;function j(a,b,c,d){var e,f,g,h,i,j;if(a&&0<=c&&c<b){for(e=[],f=void 0,g=c+d,h=void 0,h=c;h<b;h++)void 0!==a[h]&&(c<=h&&h<g?a[h]=null:h>=g&&e.push(h));for(f=e.length,h=0;h<f;h++)i=e[h],j=a[i],a[i]=null,a[Math.floor(i)-d]=j}}b.B=j;function k(a,b){return a.hasOwnProperty(b)}b.D=k;function l(a,b){return a instanceof b}b.F=l},"./src/common/util/datetimehelper.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/common.ts"),e=c("./src/common/util/stringhelper.ts"),f=c("./src/common/util/arrayhelper.ts"),g=c("./src/common/culture/cultureInfo.ts"),h=c("./src/common/util/types.ts"),i=h.j.Fa,j=e.u.Sa,k=null,l=parseInt,m=!1,n=!0,o=Math.floor,p=Math.abs,q=new d.ResourceManager(d.SR,"Common"),b.getSR=q.getResource.bind(q),r={};function t(a,b){if(d.HandleExcelSpecialDate)return d.HandleExcelSpecialDate.apply(null,[a,b]);switch(b){case 0:return a.getFullYear();case 1:return a.getMonth();case 2:return a.getDate();default:return}}function u(a,c,d,e){var f,h,i,k,l,m,q,r,s,w,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M=d.DateTimeFormat,N=M.Calendar.convert;if(!c||!c.length)return d&&d.name.length?N?u(a,M.fullDateTimePattern,d):a.toLocaleString():""+a;f=M.eras,h="s"===c,i="",q=/([^d]|^)(d|dd)([^d]|$)/g;function O(){return l||m?l:(l=q.test(c),m=n,l)}r=0,s=x(),!h&&N&&(w=N.fromGregorian(a));function P(a,b){return w?w[b]:t(a,b)}for(y=-2,z=-2,A={Qb:""},B=0;C=s.lastIndex,D=s.exec(c),E=c.slice(C,D?D.index:c.length),A.Qb="",r+=v(E,A),i+=A.Qb,D;B++)if(r%2!==1)switch(F=P(a,0),G=a.getDay(),H=a.getHours(),I=a.getMinutes(),J=a.getSeconds(),K=a.getMilliseconds(),L=a.getTimezoneOffset(),D[0]){case"dddd":i+=M.dayNames[G];break;case"ddd":i+=M.abbreviatedDayNames[G];break;case"dd":l=n,i+=j(P(a,2),2);break;case"d":l=n,i+=P(a,2);break;case"MMMM":i+=M.monthGenitiveNames&&O()?M.monthGenitiveNames[P(a,1)]:M.monthNames[P(a,1)];break;case"MMM":i+=M.abbreviatedMonthGenitiveNames&&O()?M.abbreviatedMonthGenitiveNames[P(a,1)]:M.abbreviatedMonthNames[P(a,1)];break;case"MM":i+=j(P(a,1)+1,2);break;case"M":i+=P(a,1)+1;break;case"yyyy":case"yyy":i+=y>=0?g.aBb.ia("ee",a,e):j(w?w[0]:F,4);break;case"yy":i+=y>=0?g.aBb.ia("ee",a,e):j((w?w[0]:F)%100,2);break;case"y":i+=y>=0?g.aBb.ia("e",a,e):""+(w?w[0]:F)%100;break;case"hh":k=H%12,0===k&&(k=12),i+=j(k,2);break;case"h":k=H%12,0===k&&(k=12),i+=k;break;case"HH":i+=j(H,2);break;case"H":i+=""+H;break;case"mm":i+=j(I,2);break;case"m":i+=""+I;break;case"ss":i+=j(J,2);break;case"s":i+=""+J;break;case"tt":i+=H<12?M.amDesignator:M.pmDesignator;break;case"t":i+=(H<12?M.amDesignator:M.pmDesignator).charAt(0);break;case"f":case"0":i+=j(K,3).charAt(0);break;case"ff":case"00":i+=j(K,3).substr(0,2);break;case"fff":case"000":i+=j(K,3);break;case"z":k=L/60,i+=(k<=0?"+":"-")+o(p(k));break;case"zz":k=L/60,i+=(k<=0?"+":"-")+j(o(p(k)),2);break;case"zzz":k=L/60,i+=(k<=0?"+":"-")+j(o(p(k)),2)+":"+j(p(L%60),2);break;case"g":case"gg":case"ggg":if(!f)break;if(y===B-1){y=B;break}i+=g.aBb.ia(D[0],a,e),y=B;break;case"e":case"ee":if(!f){i+=j(w?w[0]:F,4);break}if(z===B-1){z=B;break}i+=g.aBb.ia(D[0],a,e),z=B;break;case"/":i+=M.dateSeparator;break;
case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[m]":case"[ss]":case"[s]":i+=D[0];break;default:throw Error(b.getSR().Exp_InvalidDateFormat)}else i+=D[0];return""+i}function v(a,b){var c,d,e,f=0,g=m;for(c=0,d=a.length;c<d;c++)switch(e=a.charAt(c)){case'"':g?b.Qb+="'":f++,g=m;break;case"\\":g&&(b.Qb+="\\"),g=!g;break;default:b.Qb+=e,g=m}return f}function w(a,b){var c,d=new Date,e=a.DateTimeFormat.eras;return e&&b<100&&(c=g.aBb.ca(d).ea,b+=c-c%100,b>a.DateTimeFormat.Calendar.TwoDigitYearMax&&(b-=100)),b}function x(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[m\]|\[ss\]|\[s\]/g}function y(a,c,d){var e,g,h,i,j,l,m,n,o,p,q;if(a.Rb){if(a.Rb[c])return a.Rb[c]}else a.Rb={};for(e=c,e=e.replace("%M","M"),e=e.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),g="^",h={Qb:""},i=[],j=0,l=0,m=x();(n=m.exec(e))!==k;)if(h.Qb="",o=e.slice(j,n.index),j=m.lastIndex,l+=v(o,h),g+=h.Qb,l%2!==1){switch(n[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":g+="(\\D+)";break;case"tt":case"t":g+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":g+="(\\d\\d?\\d?)";break;case"eee":case"ee":case"e":g+=d?"(\\u5143|\\d\\d?)":"(\\d\\d?)";break;case"yyy":case"yyyy":g+="(\\d{2}|\\d{4})";break;case"fff":case"000":g+="(\\d{3})";break;case"ff":case"00":g+="(\\d{2})";break;case"f":case"0":g+="(\\d)";break;case"zzz":g+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":g+="([+-]?\\d\\d?)";break;case"/":g+="/"===a.dateSeparator?"(\\/)":"([\\/\\"+a.dateSeparator+"])";break;default:throw Error(b.getSR().Exp_InvalidDateFormat)}f.k.Sb(i,n[0])}else g+=n[0];return h.Qb="",v(e.slice(j),h),g+=h.Qb,g+="$",p=(""+g).replace(/\s+/g,"\\s+"),q={Tb:p,Ub:i,_a:RegExp(p)},a.Rb[c]=q,q}function z(a){var b=a.getTimezoneOffset();return b===-485&&(b=-485-43/60),b===-321&&(b=-321-10/60),b===-507&&(b=-507-52/60),b}s=function(){function a(){}return a.mb=function(a,b,c,d){return c||(c=g.CultureManager.q4()),u(a,b,c,d)},a.Vb=function(a,b,c){return u(a,b,c||g.CultureManager.q4())},a.gBa=function(b,c,d){var e,f,g,h,i,j=m;for(i=d,i.slice(1).forEach(function(a){a&&(j=!0)}),j||(i=i.concat(c.ma())),f=i.length,e=1;e<f;e++)if(h=i[e],h&&(j=n,g=a.Wb(b,h,c)))return g;return k},a.Qa=function(b,c,d){var e,f;return c||d||(f=r[b],void 0===f)?(e=c?[b,c]:[b],f=a.gBa(b,d||g.CultureManager.q4(),e),c||d||(r[b]=f),f?new Date(f):f):f?new Date(f):f},a.lb=function(b,c){return a.gBa(b,g.CultureManager.q4("invariant"),[b,c])},a.Wb=function(a,b,c){var d,f,h,i,j,n,o,p,q,r,s,t,u,v,x,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;if(a=a.trim(),d=c.DateTimeFormat,f=1041===c.id,h=y(d,b,f),i=h._a.exec(a),i===k)return k;for(j=h.Ub,n=k,o=k,p=k,q=k,r=k,s=0,u=0,v=0,x=0,z=k,A=m,B=m,C=0,D=j.length;C<D;C++)if(E=i[C+1])switch(j[C]){case"dd":case"d":if(q=l(E,10),q<1||q>31)return k;break;case"MMMM":if(p=c.oa(E),p<0||p>11)return k;break;case"MMM":if(p=c.ra(E),p<0||p>11)return k;break;case"M":case"MM":case"%M":if(p=l(E,10)-1,p<0||p>11)return k;break;case"e":case"ee":if(o=f&&"\u5143"===E?1:w(c,l(E,10)),o<0||o>9999)return k;break;case"y":case"yy":case"yyy":case"yyyy":if(o=l(E,10),o<0||o>9999)return k;break;case"h":case"hh":case"H":case"HH":if(s=l(E,10),s<0)return k;break;case"m":case"mm":if(u=l(E,10),u<0||u>59)return k;break;case"s":case"ss":if(v=l(E,10),v<0||v>59)return k;break;case"tt":case"t":if(F=E.toUpperCase(),A=F===d.pmDesignator.toUpperCase(),B=F===d.amDesignator.toUpperCase(),!A&&!B)return k;break;case"f":case"0":if(x=100*l(E,10),x<0||x>999)return k;break;case"ff":case"00":if(x=10*l(E,10),x<0||x>999)return k;break;case"fff":case"000":if(x=l(E,10),x<0||x>999)return k;break;case"dddd":if(r=c.ua(E),r<0||r>6)return k;break;case"ddd":if(r=c.wa(E),r<0||r>6)return k;break;case"zzz":if(G=E.split(/:/),2!==G.length)return k;if(t=l(G[0],10),t<-12||t>13)return k;if(H=l(G[1],10),H<0||H>59)return k;z=60*t+(e.u.kb(E,"-")?-H:H);break;case"z":case"zz":if(t=l(E,10),t<-12||t>13)return k;z=60*t;break;case"g":case"gg":case"ggg":if(I=E,!I||!d.eras)return k;if(n=g.aBb.ha(j[C],I),n<0)return k}if(J=/^(\d|\d\d|\d\d\d):/.test(a),K=J?new Date(1899,11,30):new Date,M=d.Calendar.convert,M&&(L=M.fromGregorian(K)),M||(L=[K.getFullYear(),K.getMonth(),K.getDate()]),o===k?o=L[0]:o<100&&(d.eras&&n!==k?o=g.aBb.ga(n||0,o):o+=o>=30?1900:2e3),p===k&&(p=L[1]),q===k&&(q=J?L[2]:1),M){if(K=M.toGregorian(o,p,q),K===k)return k}else{if(K.setFullYear(o,p,q),K.getDate()!==q)return k;if(r!==k&&K.getDay()!==r)return k}return A&&s<12?s+=12:B&&12===s&&(s=0),K.setHours(s,u,v,x),z!==k&&(N=K.getMinutes()-(z+K.getTimezoneOffset()),K.setHours(K.getHours()+N/60,N%60)),K},a.Xb=function(a){var b,c=a-25569,d=new Date(864e5*c),e=c>=0?1:-1,f=z(d),g=(864e5*a*1440+e-3181192704e6+864e5*f)/1440,h=new Date(g),i=f>=0?1:-1,j=new Date(g+36e5*i),k=z(j);if(p(f-k)>=60)if(b=new Date(g+60*(k-f)*1e3),f>k){if(i===-1||k===z(h))return b=999===b.getMilliseconds()?new Date(b.valueOf()+1):b}else if(f<k&&(1===i||k===z(h)))return b=999===b.getMilliseconds()?new Date(b.valueOf()+1):b;return h=999===h.getMilliseconds()?new Date(h.valueOf()+1):h},a.Rka=function(b){if("/OADate("===b.substr(0,8)){var c=parseFloat(b.substr(8,b.length-10));return a.Xb(c)}},a.Daa=function(b){return"/OADate("+a.Ra(b)+")/"},a.Ra=function(a){if(i(a))return 0;"number"==typeof a&&(a=new Date(a));var b=z(a);return(1440*a.getTime()+3181192704e6-864e5*b)/124416e6},a.Yb=function(c){var d,e,f,g=k,h=n;if(i(c)?g=a.Xb(0):c instanceof Date?g=new Date(c.valueOf()):"string"==typeof c?(d=a.Qa(c),d||(isNaN(c)?a.fvb(c)?h=m:(d=new Date(c),isNaN(d.valueOf())&&(h=m),e=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,f=e.exec(c.replace(/ |\n/g,"").trim()),f&&4===f.length&&(f.indexOf(""+d.getFullYear())!==-1&&f.indexOf(""+(d.getMonth()+1))!==-1&&f.indexOf(""+d.getDate())!==-1||(h=m))):(d=a.Xb(parseFloat(c)),d||(h=m))),g=d):"number"==typeof c?g=a.Xb(c):h=m,h)return g;throw b.getSR().Exp_InvalidCast},a.fvb=function(b){var c=g.CultureManager.q4().DateTimeFormat,d=a.r1J,e=function(a,b){var c=0;return b.forEach(function(b){b&&a.indexOf(b)>-1&&c++}),c>1},f=function(a,b){if(a&&a.indexOf(" ")>-1){var c=a.split(" "),d=c.length;return d>=2&&b.indexOf(c[d-2])<=-1&&!isNaN(c[d-1])}return!1},h=function(a){var b=!1;return d.forEach(function(c){a.indexOf(c)>-1&&(b=!0)}),b};return e(b,c.monthNames)||e(b,c.abbreviatedMonthNames)||e(b,c.dayNames)||e(b,c.abbreviatedDayNames)||f(b,c.monthNames.concat(c.abbreviatedMonthNames))||h(b)},a.Ska=function(a){return a&&(a.constructor===Date||a.getUTCDate&&a.setFullYear)},a.r1J=["@","#","!","`","^","$","*","(",")","&"],a}(),b.l=s},"./src/common/util/functionhelper.ts":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=isNaN,e="rowCount",f="colCount";function g(a){return a}function h(a,b,c,g,h,i,j,k,l,m,n){var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=c[e],M=c[f],N=b[e],O=b[f],P=g[e],Q=g[f],R=1===M,S=1===O;if(N===L&&O===M){for(E=0,F=0,G=0,H=0,u=L*M,o=0;o<L;o++)for(p=0;p<M;p++){if(r=i(c[o][p]),s=i(b[o][p]),a&&(d(r)||d(s)))return l;s=m(s),E+=r,F+=r*r,G+=s,H+=r*s}for(I=u*H-E*G,t=h?I/(u*F-E*E):H/F,v=h?(G*F-E*H)/(u*F-E*E):0,w=[],o=0;o<P;o++)for(w[o]=[],p=0;p<Q;p++){if(r=i(g[o][p]),a&&d(r))return l;w[o][p]=0===I?b[0][0]:n(t*r+v)}return j?new j(w):w}if(S&&N===L||1===N&&O===M){for(r=[],s=[],C=M+1,D=M+2,o=0;o<L;o++){if(y=S?b[o][0]:b[0][o],v=i(y),a&&d(v))return l;s[o]=R?m(v):v}for(o=0;o<L;o++)for(r[o]=[],p=0;p<M;p++){if(v=i(c[o][p]),a&&d(v))return l;r[o][p]=v}for(J=[],t=0;t<C;t++)for(J[t]=[],u=0;u<D;u++)J[t][u]=0;for(q=0;q<L;q++)for(J[0][C]+=s[q],o=0;o<M;o++)for(y=o+1,J[0][y]+=r[q][o],J[y][0]=J[0][y],J[y][C]+=r[q][o]*s[q],p=o;p<M;p++)A=p+1,J[A][y]+=r[q][o]*r[q][p],J[y][A]=J[A][y];for(J[0][0]=L,K=h?0:1,x=K;x<C;x++){if(a){if(0===J[x][x]){for(B=!1,p=x+1;!B&&p<C;p++)if(0!==J[p][x]){for(q=0;q<D;q++)A=J[x][q],J[x][q]=J[p][q],J[p][q]=A;B=!0}if(!B)return k}}else{for(o=x;o<C&&0===J[o][x];)o++;if(o>=C)return k;for(z=K;z<D;z++)y=J[x][z],J[x][z]=J[o][z],J[o][z]=y}for(y=1/J[x][x],z=K;z<D;z++)J[x][z]*=y;for(o=K;o<C;o++)if(o!==x)for(y=-J[o][x],z=0;z<D;z++)J[o][z]+=y*J[x][z];h||(J[0][C]=0)}for(w=[],S||(w[0]=[]),o=0;o<P;o++){for(S&&(w[o]=[]),y=J[0][C],p=0;p<M;p++){if(v=i(S?g[o][p]:g[p][o]),a&&d(v))return l;y+=J[p+1][C]*v}S?w[o][0]=n(y):w[0][o]=n(y)}return j?new j(w):w}return k}function i(a,b,c,d,e,f,i,j){return h(!0,a,b,c,d,e,f,j,i,g,g)}b.qc=i;function j(a,b,c,d,i,j,k){var l,m;for(l=0;l<a[e];l++)for(m=0;m<a[f];m++)if(a[l][m]<=0)return j;return h(!1,a,b,c,d,g,i,k,null,Math.log,Math.exp)}b.sc=j},"./src/common/util/numberhelper.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/common.ts"),e=c("./src/common/util/types.ts"),f=c("./src/common/util/regexhelper.ts"),g=c("./src/common/util/stringhelper.ts"),h=c("./src/common/culture/cultureInfo.ts"),i=e.j.Fa,j=g.u.Sa,k=g.u.Ta,l=null,m=void 0,n=parseInt,o=parseFloat,p=!1,q=!0,r=Math.floor,s=Math.abs,t=Math.pow,u=Math.min,v=Number.MAX_VALUE,w="#dot#",x="#group#",y=function(a,b,c){return a.substr(b,c)},z=function(a){return f.q.qb(a)},A=new d.ResourceManager(d.SR),B=A.getResource.bind(A),C="##################0",D="################",E={1:"+",0:"","-1":"-"},F=4294967295,G=["0","#","?"],H={"\xa4":"\xa4",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GH\u20b5":"GH\u20b5","\u1265\u122d":"\u1265\u122d","\u0631.\u0633.\u200f":"\u0631.\u0633.\u200f",XDR:"XDR","\u062f.\u0625.\u200f":"\u062f.\u0625.\u200f","\u062f.\u0628.\u200f":"\u062f.\u0628.\u200f","\u062f.\u062c.\u200f":"\u062f.\u062c.\u200f","\u062c.\u0645.\u200f":"\u062c.\u0645.\u200f","\u20aa":"\u20aa","\u062f.\u0639.\u200f":"\u062f.\u0639.\u200f","\u062f.\u0627.\u200f":"\u062f.\u0627.\u200f","\u0641.\u062c.\u0642.\u200f":"\u0641.\u062c.\u0642.\u200f","\u062f.\u0643.\u200f":"\u062f.\u0643.\u200f","\u0644.\u0644.\u200f":"\u0644.\u0644.\u200f","\u062f.\u0644.\u200f":"\u062f.\u0644.\u200f","\u062f.\u0645.\u200f":"\u062f.\u0645.\u200f","\u0623.\u0645.\u200f":"\u0623.\u0645.\u200f","\u0631.\u0639.\u200f":"\u0631.\u0639.\u200f","\u0631.\u0642.\u200f":"\u0631.\u0642.\u200f","\u062c.\u0633.":"\u062c.\u0633.",S:"S","\xa3":"\xa3","\u0644.\u0633.\u200f":"\u0644.\u0633.\u200f","\u062f.\u062a.\u200f":"\u062f.\u062a.\u200f","\u0631.\u064a.\u200f":"\u0631.\u064a.\u200f","\u20b9":"\u20b9",TSh:"TSh","\u20ac":"\u20ac","\u20bc":"\u20bc","\u20bd":"\u20bd",K:"K","\u043b\u0432.":"\u043b\u0432.","\u20a6":"\u20a6",CFA:"CFA","\u09f3":"\u09f3","\xa5":"\xa5",KM:"KM","\u041a\u041c":"\u041a\u041c",USh:"USh","K\u010d":"K\u010d","kr.":"kr.",Ksh:"Ksh",CHF:"CHF","\u0783.":"\u0783.","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","\u20b1":"\u20b1",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","\u20a1":"\u20a1",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","\u20b2":"\u20b2","Bs.":"Bs.","\u0631\u064a\u0627\u0644":"\u0631\u064a\u0627\u0644",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","\u058f":"\u058f",ISK:"ISK","\u20be":"\u20be","\u200b":"\u200b","\u20b8":"\u20b8","\u17db":"\u17db","\u20a9":"\u20a9","\u0441\u043e\u043c":"\u0441\u043e\u043c",Kz:"Kz","\u20ad":"\u20ad",MTn:"MTn","\u0434\u0435\u043d":"\u0434\u0435\u043d","\u20ae":"\u20ae","\u0930\u0941":"\u0930\u0941","Afl.":"Afl.","\u07d6\u07d5.":"\u07d6\u07d5.","\u0440\u0443\u0431.":"\u0440\u0443\u0431.","z\u0142":"z\u0142","\u060b":"\u060b",R$:"R$",Db:"Db",RON:"RON","\u20b4":"\u20b4",MAD:"MAD","\u0dbb\u0dd4.":"\u0dbb\u0dd4.","Lek\xeb":"Lek\xeb",den:"den",RSD:"RSD","\u0434\u0438\u043d.":"\u0434\u0438\u043d.","\u0720.\u0723.\u200f":"\u0720.\u0723.\u200f","Rs.":"Rs.","\u0441\u043c\u043d":"\u0441\u043c\u043d","\u0e3f":"\u0e3f","m.":"m.","\u20ba":"\u20ba","\u2d37\u2d54":"\u2d37\u2d54","so\u02bbm":"so\u02bbm","\u0441\u045e\u043c":"\u0441\u045e\u043c","\u20ab":"\u20ab",HK$:"HK$",MOP:"MOP",NT$:"NT$"};function I(a,b,c,d){return b&&0!==b.length&&"i"!==b?J(a,b,c.NumberFormat,d):c&&c.name.length>0?a.toLocaleString():""+a}function J(a,b,c,d){var e=M(b);return V(a,e,c,d)}function K(a,b){for(var c,d,e,f,g,h,i,j,k=r(s(a)),l={Xa:1,Ya:0};k>=10;)k/=10,l.Xa++;return c=""+a,d=c.search(/e/gi),e=c.indexOf(b),d!==-1?(g=y(c,0,d),h=y(c,d+1),i=0,e!==-1&&(i=y(g,e+1).length),j=o(h),f=i-j,f<0&&(f=0),l.Ya=f):(f=0,e!==-1&&(f=y(c,e+1).length),l.Ya=f),l}function L(a){var b,c={Za:a.charAt(0),$a:0,_a:0},d="";for(b=1;b<a.length;b++)if(d=a.charAt(b),"+"===d)c.$a=1;else{if("-"!==d){if("0"===d){c._a=a.length-b;break}throw Error(B().Exp_InvalidExponentFormat)}c.$a=-1}return c}function M(a){var b,c,d,e,f,g,h={ab:l,bb:l,cb:p,eb:0,fb:0,Rja:0,hb:l},i="",j=p,k=p,m=p,n=p,o=p,r=p,s=l,t=[];for(c=0;c<a.length;c++){if(b=a.charAt(c),j)i+=b,'"'===b&&(t.push(i),i="",j=p);else if(k){if("E"===s||"e"===s){if(!(["+","-","0"].indexOf(b)>=0)){k=p,c--;continue}i+=b}else if("+"===s||"-"===s){if("0"!==b){k=p,c--;continue}i+=b}else if("0"===s){if("0"!==b){k=p,o||(o=q,h.hb=L(i)),c--;continue}i+=b}}else if("*"!==s&&"_"!==s&&"\\"!==s||""===i)if("*"===b||"_"===b||"\\"===b)r=p,""!==i&&(t.push(i),i=""),i+=b;else if("'"===b)r=p,""!==i&&(t.push(i),i=""),t.push(b);else if('"'===b)r=p,j=q,""!==i&&(t.push(i),i=""),i+=b;else if(G.indexOf(b)>=0)r=q,G.indexOf(s)<0&&""!==i&&(t.push(i),i=""),i+=b;else if("."!==b||m)if("%"===b)r=p,h.fb++,""!==i&&(t.push(i),i=""),t.push(b);else if("\u2030"===b)r=p,h.Rja++,""!==i&&(t.push(i),i=""),t.push(b);else if(","===b)if(r){for(d=void 0,""!==i&&(t.push(i),i=""),e=q,f="",g=c+1;g<a.length;g++)if(d=a.charAt(g),'"'!==f)if("\\"!==f&&"_"!==f){if(G.indexOf(d)>=0){e=p;break}if("."===d||";"===d)break;f=d}else f="";else'"'===d&&(f="");e?h.eb++:m||(d=a.charAt(c+1),d&&G.indexOf(d)>=0&&(n=q))}else i+=b;else"E"===b||"e"===b?(r=p,k=q,""!==i&&(t.push(i),i=""),i+=b):(r=p,G.indexOf(s)>=0&&""!==i&&(t.push(i),i=""),i+=b);else""!==i&&(t.push(i),i=""),h.ab=t,t=[],m=q,r=p;else i+=b,t.push(i),i="";s=b}return""!==i&&(k&&!o&&(h.hb=L(i)),t.push(i)),n&&(h.cb=q),m?h.bb=t:h.ab=t,h}function N(a,b,c,d){var e,f,g,h,i,j=b[0],k=1,l=0,m=p,n=a.length;for(e=0;e<n;e++)if(f=a[e].type,"number"===f){for(g="",h=a[e].value,i=h.length-1;i>=0;){if(!(1<=j&&j<=9||0===j&&k===b.length))throw Error(B().Exp_InvalidNumberGroupSize);/\d/gi.test(h[i])?(m&&(g&&a.push({type:"number",value:g}),a.push({type:"groupSeparator",value:c}),g="",m=p),l++):l=0,g=h[i]+g,l===j&&j>0&&(m=q,l=0,k<b.length&&(j=b[k],k++)),i--}g&&a.push({type:f,value:g})}else"fillingChar"===f&&(d.infillIndex=a.length-n),a.push({type:f,value:a[e].value});return a.splice(0,n)}function O(a,b,c,d,e,f){var g,h,i,l,m=Z(a,-b);return isFinite(m)||(m=a),a=m,g=""+a,l=g.split(/e/i),g=l[0],i=l.length>1?n(l[1],10):0,l=g.split("."),g=l[0],h=l.length>1?l[1]:"",i>0?(h=k(h,i),g+=h.slice(0,i),h=y(h,i)):i<0&&(i=-i,g=a<0?f+j(g.replace(f,""),i+1):j(g,i+1),h=g.slice(-i,g.length)+h,g=g.slice(0,-i)),b>0?(h=h.length>b?h.slice(0,b):k(h,b),h=e+h):h="",g+h}function P(a,b,c,d){var e=a;return b>0&&(e=aa(e*t(100,b),15)),c>0&&(e=aa(e*t(1e3,c),15)),d>0&&(e=aa(e/t(1e3,d),15)),e}function Q(a){var b,c,d=l;if(a)for(d="",b=0;b<a.length;b++)c=a[b],/^(0|#|\?)+/g.test(c)&&(d+=c);return d}function R(a,b,c){var d,e,f={value:a,exponentValue:0},g=K(a,"."),h=g.Xa,i=s(a),j=c?c.length:1;if(i>=1)h>j?(h-=j,f.value=a/t(10,h),f.exponentValue=h):f.exponentValue=0,b.$a===-1&&(b.$a=0);else if(i<1&&i>0){for(b.$a=-1,d=t(10,j);10*i<d;)i*=10,f.exponentValue++;e=t(10,f.exponentValue),f.value*=e>v?0:e}return f}function S(a,b,c,d,e,f,g,h){var i,k,l,m,n,o,p,r,s,t,u,v,w=h.numberGroupSizes,x=h.numberGroupSeparator,z=h.negativeSign,A=h.percentSymbol,B=h.perMilleSymbol,C=d.hb,D=y(b,0,1);for(D===z&&(b=y(b,1)),i=1===b.length&&"0"===b?0:b.length,b=0===i?"":b,k=0,l="",m=a.length-1;m>=0;m--)if(n="",o=a[m],/^(0|#|\?)+/g.test(o)){if(l!==c){for(p=o.length,r=i-k-1;r>=0&&p>0;r--)s=b.charAt(r),n=s+n,p--,k++;for(t=p-1;t>=0;t--)u=o[t],k++,"0"===u?n=u+n:"?"===u&&(""!==n&&(f.push({type:"number",value:n}),n=""),f.push({type:"numberPlaceholder",value:u}));l=o+l,l===c&&k<i&&(n=b.substr(0,i-k)+n),""!==n&&f.push({type:"number",value:n})}}else d.hb&&!g.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(o)?(g.replaceExponent=q,v="",v+=C.Za,v+=E[C.$a],v+=j(""+e,C._a),f.push({type:"exponent",value:v})):"_"===o[0]?f.push({type:"placeholder",value:o[1]}):"*"===o[0]?g.hasInfilling||(f.push({type:"fillingChar",value:o[1]}),g.hasInfilling=!0,g.infillIndex=f.length-1):"\\"===o[0]?2===o.length&&f.push({type:"text",value:o[1]}):'"'===o[0]&&'"'===o[o.length-1]?o.length>2&&f.push({type:"text",value:o.substr(1,o.length-2)}):o===A?f.push({type:"percent",value:o}):o===B?f.push({type:"permille",value:o}):H[o]?f.push({type:"currency",value:o}):f.push({type:"text",value:o});D===z&&c&&f.push({type:"text",value:D}),d.cb===q&&N(f,w,x,g),f.reverse(),g.infillIndex=f.length-1-g.infillIndex}function T(a,b,c,d,e,f,g,h,i){var k,l,m,n,o,p,r,s,t,u,v,w,x=i.numberDecimalSeparator,y=i.percentSymbol,z=i.perMilleSymbol,A=b.indexOf(x),B=e.hb;for((A>0||d!==C||c!==D)&&g.push({type:"decimalSeparator",value:x}),k=A!==-1?b.substring(A+1):"",l=0,m="",n=0;n<a.length;n++)if(o=a[n],/^(0|#|\?)+/g.test(o)){if(p="",m!==c){for(r=o.length,s=0,t=l;r>0&&k.length-l>0;)p+=k.charAt(t),r--,l++,s++,t++;for(u=s;r>0;)v=o[u],u++,l++,r--,"0"===v?p+=v:"?"===v&&(""!==p&&(g.push({type:"number",value:p}),p=""),g.push({type:"numberPlaceholder",value:v}));""!==p&&g.push({type:"number",value:p}),m+=o}}else B&&!h.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(o)?(h.replaceExponent=q,w="",w+=B.Za,w+=E[B.$a],w+=j(""+f,B._a),g.push({type:"exponent",value:w})):"_"===o[0]?g.push({type:"placeholder",value:o[1]}):"*"===o[0]?(g.push({type:"fillingChar",value:o[1]}),h.hasInfilling&&g.splice(h.infillIndex,1),h.hasInfilling=!0,h.infillIndex=g.length-1):"\\"===o[0]?2===o.length&&g.push({type:"text",value:o[1]}):'"'===o[0]&&'"'===o[o.length-1]?o.length>2&&g.push({type:"text",value:o.substr(1,o.length-2)}):o===y?g.push({type:"percent",value:o}):o===z?g.push({type:"permille",value:o}):H[o]?g.push({type:"currency",value:o}):g.push({type:"text",value:o})}function U(a,b){var c=a,d=a.indexOf(b);return d!==-1&&(c=a.replace(/0+$/,"")),c}function V(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,q,r,s,t,v,w=[];return a=P(a,b.fb,b.Rja,b.eb),e=b.ab,f=b.bb,e||f?(g=Q(e),h=Q(f),h||(h=""),b.hb&&(j=R(a,b.hb,g),a=j.value,i=j.exponentValue),k=K(a,"."),k.Xa+k.Ya>15&&(a=aa(a,15)),l=c.numberGroupSizes,m=c.numberGroupSeparator,n=c.numberDecimalSeparator,o=c.negativeSign,q=u(k.Ya,h.length),r=O(a,q,l,m,n,o),d||(r=U(r,n)),""===r?(w.push({type:"text",value:(e?e.join(""):"")+(f?f.join(""):"")}),w):(s={hasInfilling:p,infillIndex:-1,replaceExponent:p},t=r.split(n)[0],"10"!==t||isNaN(i)||(t="1",v=b&&b.hb&&b.hb.$a===-1,i+=v?-1:1),e&&S(e,t,g,b,i,w,s,c),"0"!==t&&""===g&&f&&w.push({type:"number",value:t}),f&&T(f,r,h,g,b,i,w,s,c),w)):w}function W(a,b){var c,d,e,f,h,j,k,m,p,q,r,s,t,u,v,w,x;return a=i(a)?"":g.u.ib(a,""),a.match(/^[+-]?infinity$/i)?o(a):a.match(/^0x[a-f0-9]+$/i)?n(a,10):(c=b.NumberFormat,d=c.numberNegativePattern,e=X(a,c,d),f=e[0],h=e[1],""===f&&1!==d&&(e=X(a,c,1),f=e[0],h=e[1]),""===f&&(f="+"),h[0]===c.currencySymbol&&(h=y(h,1)),m=h.indexOf("e"),m<0&&(m=h.indexOf("E")),m<0?(k=h,j=l):(k=y(h,0,m),j=y(h,m+1)),r=k.indexOf("."),r<0?(p=k,q=l):(p=y(k,0,r),q=y(k,r+1)),p=p.split(",").join(""),s=",".replace(/\u00A0/g," "),","!==s&&(p=p.split(s).join("")),t=f+p,q!==l&&(t+="."+q),u=t[t.length-1],u===c.percentSymbol&&(t=y(t,0,t.length-1),t=g.u.ib(t,""),v=t.indexOf("."),v===-1&&(v=t.length),w="",w+=y(t,0,v-2),w+=".",w+=y(t,v-2,2),w+=y(t,v+1),t=w),j!==l&&(x=X(j,c,1),""===x[0]&&(x[0]="+"),t+="e"+x[0]+x[1]),t.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?o(t):NaN)}function X(a,b,c){var d=b.negativeSign,e=b.positiveSign;if(4!==c&&2!==c||(d=" "+d,e=" "+e),4===c||3===c){if(g.u.jb(a,d))return["-",y(a,0,a.length-d.length)];if(g.u.jb(a,e))return["+",y(a,0,a.length-e.length)]}else if(2===c||1===c){if(g.u.kb(a,d))return["-",y(a,d.length)];if(g.u.kb(a,e))return["+",y(a,e.length)]}else{if(0!==c)throw Error("");if(g.u.kb(a,"(")&&g.u.jb(a,")"))return["-",y(a,1,a.length-2)]}return["",a]}function Y(a,b,c){if(0!==s(r(a)-a))throw Error(B().Exp_BadFormatSpecifier);var d=a>=0?a.toString(16):(F+a+1).toString(16);return d=b?d.toLowerCase():d.toUpperCase(),!i(c)&&d.length<c?j(d,c):d}function Z(a,b){var c,d;return a=+a,b=+b,isNaN(a)||b%1!==0?NaN:(c=a<0,a=c?-a:a,typeof b===m||0===b?(a=Math.round(a),c?-a:a):(d=(""+a).split("e"),a=Math.round(+(d[0]+"e"+(d[1]?+d[1]-b:-b))),a=c?-a:a,d=(""+a).split("e"),+(d[0]+"e"+(d[1]?+d[1]+b:b))))}function $(a){var b=h.CultureManager.q4().NumberFormat;return"string"==typeof a&&(b=h.CultureManager.q4(a).NumberFormat),b}function _(a){var b,c,d,e="";if(Array.isArray(a)&&a.length>0)for(b=0;b<a.length;b++)if(c=a[b].type,d=a[b].value,"placeholder"===c)e+=" ";else{if("fillingChar"===c)continue;e+="numberPlaceholder"===c?" ":d}return e}function aa(a,b){return"number"==typeof a&&(""+a).length>=b&&(a=+a.toPrecision(b)),a}b.o={Qa:function(a){return W(a,h.CultureManager.q4())},lb:function(a){return W(a,h.CultureManager.q4("invariant"))},mb:function(a,b,c,d){return c||(c=h.CultureManager.q4()),I(a,b,c,d)},nb:function(a,b){var c,d,e;return"string"!=typeof a?a:(c=$(b),d=c.numberDecimalSeparator,e=c.numberGroupSeparator,"."!==d&&(a=a.replace(z("[.]"),w)),","!==e&&(a=a.replace(z("[,]"),x)),"."!==d&&(a=a.replace(z(w),d)),","!==e&&(a=a.replace(z(x),e)),a)},Oa:function(a,b){var c,d,e;return"string"!=typeof a?a:(c=$(b),d=c.numberDecimalSeparator,e=c.numberGroupSeparator,"."!==d&&(a=a.replace(z("["+d+"]"),w)),","!==e&&(a=a.replace(z("["+e+"]"),x)),"."!==d&&(a=a.replace(z(w),".")),","!==e&&(a=a.replace(z(x),",")),a)},Xia:function(a,b){var c,d,e;return!("string"==typeof a&&(c=$(b),d=c.numberDecimalSeparator,e=c.numberGroupSeparator,"."!==d&&"."!==e&&a.indexOf(".")>=0||","!==d&&","!==e&&a.indexOf(",")>=0))},ob:function(a,b){return o(this.Oa(a,b))},pb:Y,Hja:M,Ija:V,Y8J:_,eka:C,fka:D,Lma:aa}},"./src/common/util/rbush.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=Math.max,e=Math.min,f=Number.POSITIVE_INFINITY;function g(a,b){this.uIJ=d(4,a||9),this.vIJ=d(2,Math.ceil(.4*this.uIJ)),b&&this.wIJ(b),this.clear()}b.rbush=g,g.prototype={all:function(){return this.zR(this.data,[])},search:function(a){var b,c,d,e,f,g=this.data,h=[],i=this.toBBox;if(!s(a,g))return h;for(b=[];g;){for(c=0,d=g.children.length;c<d;c++)e=g.children[c],f=g.leaf?i(e):e,s(a,f)&&(g.leaf?h.push(e):r(a,f)?this.zR(e,h):b.push(e));g=b.pop()}return h},collides:function(a){var b,c,d,e,f,g=this.data,h=this.toBBox;if(!s(a,g))return!1;for(b=[];g;){for(c=0,d=g.children.length;c<d;c++)if(e=g.children[c],f=g.leaf?h(e):e,s(a,f)){if(g.leaf||r(a,f))return!0;b.push(e)}g=b.pop()}return!1},insert:function(a){return a&&this.Eb(a,this.data.height-1),this},clear:function(){return this.data=t([]),this},remove:function(a,b){if(!a)return this;for(var c=this.data,d=this.toBBox(a),e=[],f=[],g,i,j,k;c||e.length;){if(c||(c=e.pop(),i=e[e.length-1],g=f.pop(),k=!0),c.leaf&&(j=h(a,c.children,b),j!==-1))return c.children.splice(j,1),e.push(c),this.xIJ(e),this;k||c.leaf||!r(c,d)?i?(g++,c=i.children[g],k=!1):c=null:(e.push(c),f.push(g),g=0,i=c,c=c.children[0])}return this},toBBox:function(a){return a},compareMinX:l,compareMinY:m,toJSON:function(){return this.data},fromJSON:function(a){return this.data=a,this},zR:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},yIJ:function(a,b,c,d){for(var e,g,h,i,j,k,l,m;;){if(d.push(b),b.leaf||d.length-1===c)break;for(l=m=f,e=0,g=b.children.length;e<g;e++)h=b.children[e],j=n(h),k=p(a,h)-j,k<m?(m=k,l=j<l?j:l,i=h):k===m&&j<l&&(l=j,i=h);b=i||b.children[0]}return b},Eb:function(a,b,c){var d=this.toBBox,e=c?a:d(a),f=[],g=this.yIJ(e,this.data,b,f);for(g.children.push(a),k(g,e);b>=0&&f[b].children.length>this.uIJ;)this.zIJ(f,b),b--;this.AIJ(e,f,b)},zIJ:function(a,b){var c,d,e=a[b],f=e.children.length,g=this.vIJ;this.BIJ(e,g,f),c=this.CIJ(e,g,f),d=t(e.children.splice(c,e.children.length-c)),d.height=e.height,d.leaf=e.leaf,i(e,this.toBBox),i(d,this.toBBox),b?a[b-1].children.push(d):this.DIJ(e,d)},DIJ:function(a,b){this.data=t([a,b]),this.data.height=a.height+1,this.data.leaf=!1,i(this.data,this.toBBox)},CIJ:function(a,b,c){var d,e,g,h,i,k,l,m;for(k=l=f,d=b;d<=c-b;d++)e=j(a,0,d,this.toBBox),g=j(a,d,c,this.toBBox),h=q(e,g),i=n(e)+n(g),h<k?(k=h,m=d,l=i<l?i:l):h===k&&i<l&&(l=i,m=d);return m},BIJ:function(a,b,c){var d=a.leaf?this.compareMinX:l,e=a.leaf?this.compareMinY:m,f=this.EIJ(a,b,c,d),g=this.EIJ(a,b,c,e);f<g&&a.children.sort(d)},EIJ:function(a,b,c,d){a.children.sort(d);var e=this.toBBox,f=j(a,0,b,e),g=j(a,c-b,c,e),h=o(f)+o(g),i,l;for(i=b;i<c-b;i++)l=a.children[i],k(f,a.leaf?e(l):l),h+=o(f);for(i=c-b-1;i>=b;i--)l=a.children[i],k(g,a.leaf?e(l):l),h+=o(g);return h},AIJ:function(a,b,c){for(var d=c;d>=0;d--)k(b[d],a)},xIJ:function(a){for(var b=a.length-1,c=void 0;b>=0;b--)0===a[b].children.length?b>0?(c=a[b-1].children,c.splice(c.indexOf(a[b]),1)):this.clear():i(a[b],this.toBBox)},wIJ:function(a){var b=["return a"," - b",";"];this.compareMinX=Function("a","b",b.join(a[0])),this.compareMinY=Function("a","b",b.join(a[1])),this.toBBox=Function("a","return {minX: a"+a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};function h(a,b,c){if(!c)return b.indexOf(a);for(var d=0;d<b.length;d++)if(c(a,b[d]))return d;return-1}function i(a,b){j(a,0,a.children.length,b,a)}function j(a,b,c,d,e){e||(e=t(null)),e.minX=f,e.minY=f,e.maxX=-f,e.maxY=-f;for(var g=b,h=void 0;g<c;g++)h=a.children[g],k(e,a.leaf?d(h):h);return e}function k(a,b){return a.minX=e(a.minX,b.minX),a.minY=e(a.minY,b.minY),a.maxX=d(a.maxX,b.maxX),a.maxY=d(a.maxY,b.maxY),a}function l(a,b){return a.minX-b.minX}function m(a,b){return a.minY-b.minY}function n(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function o(a){return a.maxX-a.minX+(a.maxY-a.minY)}function p(a,b){return(d(b.maxX,a.maxX)-e(b.minX,a.minX))*(d(b.maxY,a.maxY)-e(b.minY,a.minY))}function q(a,b){var c=d(a.minX,b.minX),f=d(a.minY,b.minY),g=e(a.maxX,b.maxX),h=e(a.maxY,b.maxY);return d(0,g-c)*d(0,h-f)}function r(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&(b.maxX>=0&&b.maxX<=a.maxX||a.maxX<0)&&(b.maxY>=0&&b.maxY<=a.maxY||a.maxY<0)}function s(a,b){return(a.minY===-1||b.minY===-1||a.minY<=b.maxY&&b.minY<=a.maxY)&&(a.minX===-1||b.minX===-1||a.minX<=b.maxX&&b.minX<=a.maxX)}function t(a){return{children:a,height:1,leaf:!0,minX:f,minY:f,maxX:-f,maxY:-f}}},"./src/common/util/regexhelper.ts":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/stringhelper.ts"),e=!0,f=function(){function a(){}return a.qb=function(b){var c=a.rb[b];return c||(c=a.rb[b]=RegExp(b,"g")),c.lastIndex=0,c},a.sb=function(b){var c=a.tb[b];return c||(c=a.tb[b]=RegExp(b,"gi")),c.lastIndex=0,c},a.ub=function(b,c,d){var f,g,h,i,j,k;if(a.vb[b])return a.wb[b];if(f="[~?*]+",a.qb(f).test(b)){for(g=[],h=b.split(""),i=void 0,j={".":e,"+":e,$:e,"^":e,"[":e,"]":e,"(":e,")":e,"{":e,"}":e,"|":e,"/":e,"\\":e},k=0;k<h.length;k++)i=h[k],"~"===i&&k<h.length-1?(k++,i=h[k],"*"===i||"?"===i?g.push("\\"):c&&g.push("~"),g.push(i)):"?"===i?g.push("."):"*"===i?(g.push("[\\s\\S]"),d?g.push("+"):g.push("*")):j[i]?(g.push("\\"),g.push(i)):g.push(i);return g.join("")}return null},a.zb=function(b,c,d){var e=a.ub(b,c,d);return e&&(e="^"+e+"$"),e},a.xb=function(a,b){for(var c="#"+a+"0#",e=1;b.indexOf(c)>0;)c=d.u.yb(c,"#"+a+(e-1)+"#","#"+a+e+"#"),e++;return c},a.Ab=function(a){return a.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},a.rb={},a.tb={},a.vb={},a.wb={},a}(),b.q=f},"./src/common/util/stringhelper.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./src/common/util/regexhelper.ts");function e(a,b,c){return a.substr(b,c)}function f(a){return null===a||void 0===a}function g(a,b,c,d){var e,g;if(f(b))throw Error();return""===b||!(b.length>a.length)&&(e=a,g=b,c&&(e=e.toLowerCase(),g=g.toLowerCase()),d(e,g))}b.u={Bb:function(a,b,c){return c&&(a=a.toLowerCase(),b=b.toLowerCase()),""===b||a.indexOf(b)>=0},Cb:function(a,b,c){var d,e;return c?(d=a.toLowerCase(),e=b.toLowerCase(),d.indexOf(e)):a.indexOf(b)},Db:function(a,b){if(!b)return a;for(var c=a;e(c,0,b.length)===b;)c=e(c,b.length);return c},ib:function(a,b){if(!b)return a;for(var c=a;e(c,c.length-b.length,b.length)===b;)c=e(c,0,c.length-b.length);return c},Eb:function(a,b,c){var d,g;if(b<0||b>a.length||f(c))throw Error();return d=e(a,0,b),g=e(a,b,a.length-b),d+c+g},Fb:function(a,b,c){var d,g;if(f(c)&&(c=a.length-b),b<0||c<0||b+c>a.length)throw Error();return d=e(a,0,b),g=e(a,b+c,a.length-b-c),d+g},kb:function(a,b,c){return void 0===c&&(c=!1),g(a,b,c,function(a,b){return a.slice(0,b.length)===b})},jb:function(a,b,c){return void 0===c&&(c=!1),g(a,b,c,function(a,b){return a.slice(-b.length)===b})},Gb:function(a,b,c,d){if(!b)throw Error();return c=(""+c).replace(/\$/g,"$$$$"),a.replace(RegExp(b,"g"+(d?"i":"")),c)},Hb:function(a,c,e,f){return c=d.q.Ab(c),b.u.Gb(a,c,e,f)},Ib:function(a,b){var c=a.indexOf(b);return c<0||c>=a.length?a:e(a,0,c)},Jb:function(a,b){for(var c=0,d=a.indexOf(b);d>=0;)c+=1,d=a.indexOf(b,d+1);return c},yb:function(a,b,c){return a.split(b).join(c)},Kb:function(a,b){var c,d,e=a;for(c=0;c<b.length;c++)d=RegExp("\\{"+c+"\\}","g"),e=e.replace(d,b[c]);return e},Lb:function(a,b,c){var d,e=""+a;for(d=e.length;d<b;d++)e=c?"0"+e:e+"0";return e},Sa:function(a,c){return b.u.Lb(a,c,!0)},Ta:function(a,c){return b.u.Lb(a,c,!1)},Mb:function(a,b){return a===b||!a&&!b||a&&b&&a.toLowerCase()===b.toLowerCase()},Nb:function(a){return a.toUpperCase()},Ob:function(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},c=d.q.qb("(?:&|<|>|\"|'|`)");return c.test(a)?a.replace(c,function(a){return b[a]}):a},Pb:function(a){var b={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},c=d.q.qb("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return c.test(a)?a.replace(c,function(a){return b[a]}):a},NIc:function(a){var b=/javascript:/gi;return a.replace(b,"")}}},"./src/common/util/types.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.j={r4:null,H:function(a,c){var d,e,f,g;if(b.j.ya(a))for(e=0,f=a.length;e<f&&(d=c.call(a[e],e,a[e]),d!==!1);e++);else for(g in a)if(a.hasOwnProperty(g)&&(d=c.call(a[g],g,a[g]),d===!1))break;return a},za:function(a){return!a||"object"==typeof a&&0===Object.keys(a).length},Aa:function(a){return"function"===b.j.Ba(a)},Ca:function(a){return Array.isArray?Array.isArray(a):"array"===b.j.Ba(a)},Da:function(a){return b.j.jk(a)&&(a=parseFloat(a)),!isNaN(a)&&isFinite(a)},jk:function(a){return"string"==typeof a},Ba:function(a){var c,d,e,f,g,h;if(null===a)return"null";if(c=b.j.r4,!c)for(c=b.j.r4={},d=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],e=0,f=d.length;e<f;e++)c["[object "+d[e]+"]"]=d[e].toLowerCase();return g=c.toString,h=typeof a,"object"===h||"function"===h?c[g.call(a)]||"object":h},Ea:function(a,c,d){var e,f;if(c){if(f=[].indexOf)return f.call(c,a,d);for(e=c.length,b.j.Fa(d)&&(d=0),d=d<0?Math.max(0,e+d):d;d<e;d++)if(d in c&&c[d]===a)return d}return-1},Ga:function(a,b){var c=b.length,d=a.length,e=0;if("number"==typeof c)for(;e<c;e++)a[d]=b[e],d++;else for(;void 0!==b[e];)a[d]=b[e],d++,e++;return a.length=d,a},Ha:function(a,c,d){var e,f,g,h,i=[];if(b.j.ya(a))for(f=0,g=a.length;f<g;f++)e=c(a[f],f,d),null!==e&&(i[i.length]=e);else{h=void 0;for(h in a)a.hasOwnProperty(h)&&(e=c(a[h],h,d),null!==e&&(i[i.length]=e))}return i.concat([])},Ia:function(){var a,c,d,e,f,g,h,i,j,k,l,m=[];for(a=0;a<arguments.length;a++)m[a]=arguments[a];for(i=m[0]||{},j=1,k=m.length,l=!1,"boolean"==typeof i&&(l=i,i=m[1]||{},j=2),"object"==typeof i||b.j.Aa(i)||(i={}),k===j&&(i=this,--j);j<k;j++)if(g=m[j],!b.j.Fa(g))for(f in g)c=i[f],e=g[f],i!==e&&(d=b.j.Ca(e),l&&e&&(b.j.Ja(e)||d)?(h=d?c&&b.j.Ca(c)?c:[]:c&&b.j.Ja(c)?c:{},i[f]=b.j.Ia(l,h,e)):void 0!==e&&(i[f]=e));return i},G:function(a,b){
for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);function d(){this.constructor=a}d.prototype=b.prototype,a.prototype=new d},Ka:function(a){return null!==a&&a===a.window},Ja:function(a){var c,d;if(!a||"object"!==b.j.Ba(a)||a.nodeType||b.j.Ka(a))return!1;c={}.hasOwnProperty;try{if(a.constructor&&!c.call(a,"constructor")&&!c.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(a){return!1}for(d in a);return void 0===d||c.call(a,d)},ya:function(a){if(b.j.Fa(a))return!1;var c=a.length,d=b.j.Ba(a);return!b.j.Ka(a)&&(!(1!==a.nodeType||!c)||("array"===d||"function"!==d&&(0===c||"number"==typeof c&&c>0&&c-1 in a)))},La:function(a,c){var d=c||[];return null!==a&&(b.j.ya(Object(a))?b.j.Ga(d,"string"==typeof a?[a]:a):[].push.call(d,a)),d},Ma:null,Fa:function(a){return void 0===a||null===a},Na:null,Pa:null,C4:function(a){if(!a)return a;if("number"==typeof a||"string"==typeof a||"boolean"==typeof a||b.j.Fa(a))return a;if(a.clone)return a.clone();if(a instanceof Date)return new Date(a.valueOf());var c,d,e;c=a instanceof Object?new a.constructor:new a.constructor(a.valueOf());for(d in a)a.hasOwnProperty(d)&&(e=a[d],a.hasOwnProperty(d)&&c[d]!==e&&("object"==typeof e?c[d]=b.j.C4(e):c[d]=e));return c.toString=a.toString,c.valueOf=a.valueOf,c}}},"./src/common/util/util.res.en.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_InvalidDateFormat="Invalid date format pattern",b.Exp_InvalidExponentFormat="invalid exponent format",b.Exp_InvalidSemicolons="invalid format : too many semicolons",b.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9, except for the last element, which can be zero.",b.Exp_BadFormatSpecifier="Bad Format Specifier",b.Exp_InvalidNumberFormat="Invalid number format pattern",b.Exp_InvalidCast="InvalidCastException",b.Exp_Separator="numberDecimalSeparator, listSeparator and arrayListSeparator should be different in culture info."},"./src/plugins/commands/commands.entry.ts":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/plugins/commands/commands.ts"),b.Key=d.Key,b.CommandManager=d.CommandManager,e=c("./src/plugins/commands/undomanager.ts"),b.UndoManager=e.UndoManager},"./src/plugins/commands/commands.ts":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.left=37]="left",a[a.right=39]="right",a[a.up=38]="up",a[a.down=40]="down",a[a.tab=9]="tab",a[a.enter=13]="enter",a[a.shift=16]="shift",a[a.ctrl=17]="ctrl",a[a.space=32]="space",a[a.altkey=18]="altkey",a[a.home=36]="home",a[a.end=35]="end",a[a.pup=33]="pup",a[a.pdn=34]="pdn",a[a.backspace=8]="backspace",a[a.del=46]="del",a[a.esc=27]="esc",a[a.a=65]="a",a[a.c=67]="c",a[a.v=86]="v",a[a.x=88]="x",a[a.z=90]="z",a[a.y=89]="y"}(d=b.Key||(b.Key={})),e=function(){function a(a,b,c){var d,e;this.tc=a,this.j4=b,this.Cj=c,d=this,Object.defineProperty(d,"shortcutKey",{get:function(){return d.vc},set:function(a){var b,c,f=d.vc;f!==a&&(e=d.tc.wc,b=e[f],b&&(c=b.indexOf(d),c>=0&&b.splice(c,1)),d.vc=a,a&&(b=e[a],b||(e[a]=b=[]),b.splice(0,0,d)))}})}return a.prototype.canUndo=function(){var a=this.j4;return a.canUndo},a.prototype.execute=function(a,b,c){var d,e,f=this,g=!0;f.j4&&b&&f.j4.canUndo&&f.tc.oNc({command:b,result:d,s4:c,actionType:c});try{e=f.j4.execute||f.j4,d=e(a,b,1===c),g=d!==!1}catch(a){g=!1}return b&&g&&f.tc.g4({command:b,result:d,s4:c,actionType:c}),d},a}(),f=function(){function a(a){this.xc=a,this.Ze={},this.pNc={},this.wc={}}return a.prototype.register=function(a,b,c,d,f,g,h){var i=this,j=new e(i,b,a);i[a]=j,c&&(j.shortcutKey=i.getShortcutKey(c,d,f,g,h))},a.prototype.getCommand=function(a){return this[a]},a.prototype.execute=function(a){var b=this[a.cmd];if(b)return b.execute(this.xc,a,0)},a.prototype.setShortcutKey=function(a,b,c,d,e,f){var g,h,i,j,k=this;if(a)g=k[a],g&&(g.shortcutKey=k.getShortcutKey(b,c,d,e,f));else if(h=k.getShortcutKey(b,c,d,e,f),i=k.getCommands(h))for(j=i.length-1;j>=0;j--)i[j].shortcutKey=void 0},a.prototype.getShortcutKey=function(a,b,c,e,f){if(a){var g="A".charCodeAt(0)<=a&&a<="Z".charCodeAt(0)?String.fromCharCode(a):d[a];return g||(g=a),""+g+(b?"+ctrl":"")+(c?"+shift":"")+(e?"+alt":"")+(f?"+window":"")}},a.prototype.getCommands=function(a){return this.wc[a]},a.prototype.addListener=function(a,b){this.Ze[a]=b},a.prototype.removeListener=function(a){delete this.Ze[a]},a.prototype.g4=function(a){var b,c=this.Ze;for(b in c)c.hasOwnProperty(b)&&c[b](a)},a.prototype.iNc=function(a,b){this.pNc[a]=b},a.prototype.qNc=function(a){delete this.pNc[a]},a.prototype.oNc=function(a){var b,c=this.pNc;for(b in c)c.hasOwnProperty(b)&&c[b](a)},a.prototype.no=function(){this.xc=null},a}(),b.CommandManager=f},"./src/plugins/commands/undomanager.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b,c){var d=this;d.xc=a,b<0&&(b=2147483647),d.yc=b,d.zc=c,d.Ac=[],d.Bc=[],d.i9J=!1}return a.prototype.Cc=function(a,b){var c,d,e,f=this;if(a){if(1===b)f.Bc.push(a);else{if(c=f.yc,d=f.Ac.length,c>0&&d>=c)for(e=0;e<d-c+1;e++)f.Ac.shift();f.Ac.push(a),0===b&&(f.Bc=[])}f.i9J=!0}},a.prototype.canUndo=function(){return this.Ac.length>0},a.prototype.undo=function(){var a,b,c=this,d=c.Ac,e=!0;if(c.zc&&c.canUndo()){a=d[d.length-1];try{b=c.xc.commandManager()[a.cmd],b&&(a.yTa=!0,e=b.execute(c.xc,a,1))}catch(a){e=!1}delete a.yTa,e!==!1&&(d.pop(),c.i9J=!0,c.Bc.push(a))}return e},a.prototype.canRedo=function(){return this.Bc.length>0},a.prototype.redo=function(){var a,b,c=this,d=c.Bc,e=!0;if(c.zc&&c.canRedo()){a=d[d.length-1];try{b=c.xc.commandManager()[a.cmd],b&&(a.yTa=!0,e=b.execute(c.xc,a,2))}catch(a){e=!1}delete a.yTa,e!==!1&&(d.pop(),c.i9J=!0,c.Ac.push(a))}return e},a.prototype.getRedoStack=function(){return this.Bc.slice()},a.prototype.getUndoStack=function(){return this.Ac.slice()},a.prototype.maxSize=function(a){var b=this;return arguments.length<1?b.yc:(a>=0&&(b.yc=a),b)},a.prototype.clear=function(){this.Ac=[],this.Bc=[]},a.prototype.PY=function(a){this.Ac=this.Ac.filter(a),this.Bc=this.Bc.filter(a)},a.prototype.no=function(){this.xc=null},a.prototype.setNewChangeStatus=function(a){this.i9J=a},a.prototype.getNewChangeStatus=function(){return this.i9J},a}();b.UndoManager=d},"./src/plugins/formatter/formatter.entry.ts":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./src/plugins/formatter/formatter.ts"))},"./src/plugins/formatter/formatter.res.en.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_TokenIsNull="token is null",b.Exp_InvalidBackslash="the '\\' cannot be evaluated",b.Exp_FormatIllegal="format is illegal.",b.Exp_ValueIsNull="value is null",b.Exp_DuplicatedDescriptor="The type of descriptor was added.",b.Exp_TokenIllegal="token is illegal.",b.Exp_ValueIllegal="value is illegal.",b.Exp_InvalidCast="InvalidCastException"},"./src/plugins/formatter/formatter.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/stringhelper.ts"),e=c("./src/common/util/datetimehelper.ts"),f=c("./src/common/util/types.ts"),g=c("./src/common/util/numberhelper.ts"),h=c("./src/common/culture/cultureInfo.ts"),i=c("./src/common/util/common.ts"),j=c("./src/plugins/formatter/formatter.res.en.ts"),f.j.Ia(i.SR.en,j),k=new i.ResourceManager(i.SR),l=k.getResource.bind(k),f.j.Ma=function(a,b){if(f.j.Fa(a))return"null"===b;if(!b)return!1;if(b instanceof Function&&a instanceof b)return!0;if(typeof a===b)return!0;if("function"===b&&/^\s*\bfunction\b/.test(""+a))return!0;if(Object.prototype.toString.call(a).slice(8,-1).toLowerCase()===b.toLowerCase())return!0;if("DateTime"===b)return a instanceof Date;if("TimeSpan"===b){if(a instanceof Date){var c=e.l.Ra(a);return c>=0&&c<1}return!1}return"string"==typeof b&&"undefined number boolean string".indexOf(b)>-1,!1},f.j.Na=function(a,b){return!!g.o.Xia(a,b)&&(("string"!=typeof a||a.search(/[\r\n\t]/g)===-1)&&(a=g.o.Oa(a,b),f.j.Ma(a,"number")||f.j.Ma(a,"DateTime")||f.j.Ma(a,"TimeSpan")||a&&!f.j.Ma(a,"boolean")&&!isNaN(a)&&!isNaN(parseFloat(a))&&!(a.length>=2&&"0"===a[0]&&"x"===a[1])))},f.j.Pa=function(a){return f.j.Fa(a)||""===a?0:f.j.Ma(a,"number")?a:f.j.Ma(a,"string")&&!isNaN(a)?g.o.Qa(a):f.j.Ma(a,"boolean")?a?1:0:f.j.Ma(a,"DateTime")?e.l.Ra(a):f.j.Ma(a,"TimeSpan")?Math.floor(e.l.Ra(a)):parseFloat(a)},m=null,n=void 0,o=Math.abs,p={Rc:"yy",vd:"y",Qc:"yyyy",jd:"m",hd:"mm",gd:"mmm",fd:"mmmm",dd:"mmmmm",ud:"d",wd:"dd",kd:"aaa",ld:"aaaa",md:"h",nd:"hh",xd:"m",yd:"mm",td:"s",zd:"ss",ea:"e",rd:"AM/PM",sd:"A/P",ed:"@mmmmm",qd:new Date(1899,11,30,0,0,0,0)},q=[p.vd,p.Rc,p.Qc,p.jd,p.hd,p.gd,p.fd,p.dd,p.ud,p.wd,p.kd,p.ld,p.md,p.nd,p.xd,p.yd,p.td,p.zd,"ggg","gg","g","ee","e"],r="\u4e00\u5341",s="\u5341",t={Hc:0,Va:1,Ua:2,_text:3},u=[{Hc:0,Va:0,Ua:0,_text:0},{Hc:0,Va:1,Ua:0,_text:0},{Hc:0,Va:1,Ua:2,_text:0},{Hc:0,Va:1,Ua:2,_text:3}],v=RegExp("([.+?*$^\\[\\](){}|/])","g"),w=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","H:m:s"],["H:m:s.FFF","h:m:s.FFF tt"],["h:m:s tt","h:mm:ss tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt","M/d/yyyy H:m:s","M-d-yyyy H:m:s","M/d/yyyy h:m:s tt","M-d-yyyy H:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],x=["#000000","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#800000","#008000","#000080","#808000","#800080","#008080","#C0C0C0","#808080","#9999FF","#993366","#FFFFCC","#CCFFFF","#660066","#FF8080","#0066CC","#CCCCFF","#000080","#FF00FF","#FFFF00","#00FFFF","#800080","#800000","#008080","#0000FF","#00CCFF","#CCFFFF","#CCFFCC","#FFFF99","#99CCFF","#FF99CC","#CC99FF","#FFCC99","#3366FF","#33CCCC","#99CC00","#FFCC00","#FF9900","#FF6600","#666699","#969696","#003366","#339966","#003300","#333300","#993300","#993366","#333399","#333333"],y=RegExp("color\\s*(\\d+)","i"),z=f.j.Ma,A=f.j.Ca,B=g.o,C=B.eka+"."+B.fka,D=B.Y8J,E=B.mb,F=B.Lma,G=f.j.Fa,H=isNaN,I=function(a){return h.CultureManager.q4(a)},J=function(a){return I(a).DateTimeFormat},K=function(a){return I(a).NumberFormat},L=function(a){return a&&a.toLowerCase()},M=function(a){return a&&a.toUpperCase()},N=function(){throw Error(l().Exp_FormatIllegal)},O=function(){return h.CultureManager.booleanMapping},P={Dc:"",Kb:function(){var a,b,c,d,e,f,g=[];for(a=0;a<arguments.length;a++)g[a]=arguments[a];for(b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];if(0===arguments.length)return m;for(d=b[0],e=1;e<arguments.length;e++)f=RegExp("\\{"+(e-1)+"\\}","gm"),d=d.replace(f,arguments[e]);return d},Ec:function(a){return!a||a===P.Dc}},Q={Fc:function(a){var b=a.charCodeAt(0);return b>=48&&b<=57},Gc:function(a){var b=a.charCodeAt(0);return b>=9&&b<=13||32===b||133===b||160===b}},R=function(){function a(a,b){var c,e,f,g;if(qa.call(this,b),c=this,c.Uc=a,e=c.Uc,f=la(e[0],"$",!1),g=e.indexOf("-"),!(f&&g>-1))throw Error(l().Exp_TokenIllegal);c.Vc=da(e,1,g-1),e=d.u.Fb(e,0,g+1),e.length>0&&(c.Wc=parseInt(e,16))}return a.prototype.cultureInfo=function(){var a=this;return a.Xc||(a.Xc=I(a.Wc)),a.Xc},a.prototype.currencySymbol=function(){return this.Vc?d.u.Gb(this.Vc,"\\.",'"."'):P.Dc},a.prototype.allowScience=function(){if(this.Xc)return!this.Xc.isJCKCulture},a.prototype.toString=function(){return this.Uc?ga(this.Uc):P.Dc},a.Name="LocaleIDFormatPart",a}(),S=function(){function a(a,b){this.formatCached=a,this.cultureName=b,this.typeName=""}return a.prototype.format=function(a){return m},a.prototype.parse=function(a){return m},a.prototype.formatString=function(a){return this.formatCached},a.prototype.toJSON=function(){var a,b={};for(a in this)this.hasOwnProperty(a)&&(b[a]=this[a]);return b},a.prototype.fromJSON=function(a){if(a)for(var b in a)a[b]!==n&&(this[b]=a[b])},a}(),b.FormatterBase=S,T=function(){function a(a,b){var c,e,f,g,h,i,j,k;for(qa.call(this,b),c=this,h=["<=","<>",">=",">","<","="],i=0,j=h.length;i<j;i++)if(e=h[i],d.u.kb(a,e,!0)){f=d.u.Fb(a,0,e.length),k=parseFloat(f),H(k)||(g=k);break}if(g===m&&g===n)throw Error(l().Exp_TokenIllegal);c.value=g,c.Sc=e,c.isMeetCondition=function(a){var b=c.Sc,d=c.value;switch(b){case"<=":return a<=d;case"<>":return a!==d;case">=":return a>=d;case">":return a>d;case"<":return a<d;case"=":return a===d}}}return a.prototype.toString=function(){return ga(this.Sc+(""+this.value))},a}(),U=function(){function a(a,b){qa.call(this,b);var c=this;if(c.token=a,c.type=parseInt(d.u.Fb(a,0,5),10),c.type<0||c.type>4)throw Error(l().Exp_TokenIllegal)}return a.prototype.Pc=function(b,c,e){var f,g,h,i,j,k,l,m,n,o;if(!b||b===P.Dc)return b;for(f=b,g=b,h=-1,i=-1,j=!1,n=b.length-1;n>=0;n--)o=g[n],!H(o)&&!la(o," ",!1)||la(o,".",!1)&&!j?(la(o,".",!1)&&(j=!0),h===-1&&(h=n),i=n):i>-1&&h>-1&&(k=da(g,i,h-i+1),l=parseFloat(k),H(l)||(m=a.numberString(k,c,e),f=d.u.Fb(f,i,h-i+1),f=d.u.Eb(f,i,m)),h=-1,i=-1,j=!1);return i>-1&&h>-1&&(k=da(g,i,h-i+1),l=parseFloat(k),H(l)||(m=a.numberString(k,c,e),f=d.u.Fb(f,i,h-i+1),f=d.u.Eb(f,i,m))),f},a.prototype.toString=function(){if(this.type>-1)return ga("DBNum"+this.type);throw Error()},a.numberString=function(b,c,d){var e,f,g=a.formatNumberString,h=b.split(".");if(h){if(1===h.length)return g(h[0],c.numbers,d?c.letters:m);if(2===h.length)return e=g(h[0],c.numbers,d?c.letters:m),f=g(h[1],c.numbers),e+"."+f}throw Error(l().Exp_ValueIllegal)},a.formatNumberString=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=b,u=0,v=0;if(2===arguments.length){for(f="",u=0;u<t.length;u++)e=da(t,u,1),v=parseInt(e,10),f+=c[v];return f}if(3===arguments.length){if(!d)return a.formatNumberString(b,c);for(g=0,h="",i=t.length,j=!1,k=[],u=0;u<i;u++)l=d.length-1-u,l>-1?k.push(""+d[l]):k.push(P.Dc);for(m=[],n=k.length-1;n>=0;n--)m[k.length-n-1]=k[n];for(k=m,o=!1,n=0;n<i;n++)e=da(t,n,1),v=parseInt(e,10),p=void 0,q=P.Dc,i-n-16>0?(p=c[v],q="",o=!0):n!==i-1&&n!==i-5&&n!==i-9&&n!==i-13?"0"===e?(p="",q="",g+=1):"0"!==e&&0!==g?(p=c[0]+c[v],q=k[n],g=0):(p=c[v],q=k[n],g=0):"0"!==e&&0!==g?(p=c[0]+c[v],q=k[n],g=0):"0"!==e&&0===g||o?(p=c[v],q=k[n],g=0,o=!1):"0"===e&&g>=3?(p="",q="",g+=1):i>=11?(p="",g+=1):(p="",q=k[n],g+=1),r=p+q===P.Dc,r||(j=!1),n!==i-13||j||(q=k[n],j=!0),n!==i-9||j||(q=k[n],j=!0),n===i-1&&(q=k[n],j=!0),h=h+p+q;return s=parseInt(b,10),0===s?c[0]:h}},a}(),V=function(){function a(a,b,c,d,e,f){pa.call(this,b,c,d,f);var g=this;g.Yc=g.Zc(ma(a)),g.$c=e,g._c=2,g.ad()}return a.prototype.ad=function(){var b,c,d,e,f=this,g={Qb:f.Yc},h=a;if(h.Lc(g.Qb)){if(b=f.bd(g),c=J(this.cultureName).amDesignator&&J(this.cultureName).pmDesignator,f.hasJD=f.Gb(g.Qb,p.dd,'"'+p.ed+'"',!0,!1,g,!1),f.Gb(g.Qb,p.fd,"MMMM",!0,!1,g,!1),f.Gb(g.Qb,p.gd,"MMM",!0,!1,g,!1),f.NUJ(g.Qb,g,"mm","MM"),f.NUJ(g.Qb,g,"m","M"),f.Gb(g.Qb,p.kd,"ddd",!0,!0,g,!0),f.Gb(g.Qb,p.ld,"dddd",!0,!0,g,!0),b&&c||(f.Gb(g.Qb,p.md,"H",!0,!0,g,!1),f.Gb(g.Qb,p.nd,"HH",!0,!0,g,!1)),f.Jc&&(f.Ic||I(f.cultureName).NumberFormat.dbNumber)&&(f.od=f.od||f.Gb(g.Qb,p.Qc,'"@'+p.Qc+'"',!0,!1,g,!0),f.od=f.od||f.Gb(g.Qb,p.Rc,'"@'+p.Rc+'"',!0,!1,g,!0)),f.$c)for(d=0;d<f.$c.length;d++)e=f.$c[d],f.Gb(g.Qb,e.Kc,"@"+e.Kc,!0,!0,g,!0);f.pd=g.Qb}else N()},a.prototype.formatString=function(){return this.Yc},a.prototype.format=function(a){var b,c,f,g,h,i,j=this,k=P.Dc,l=m;try{if(l=e.l.Yb(a),l&&H(l.valueOf())&&(l=m),l?a=l:k=""+a,l&&(k=e.l.mb(l,j.pd,j.Ic&&j.Ic.cultureInfo()||I(j.cultureName),j.wOb),j.hasJD&&(b=I(j.cultureName).DateTimeFormat.monthNames[l.getMonth()],k=d.u.Gb(k,p.ed,da(b,0,1))),j.$c))for(c=24*(e.l.Ra(l)-e.l.Ra(p.qd))*60*60*1e3,f=0;f<j.$c.length;f++)g=j.$c[f],h=g.Tc(c),G(h)||(i=g.Kc.replace("[","\\[").replace("]","\\]"),k=d.u.Gb(k,"@"+i,h))}catch(b){k=ea(a)}return va(k,a,j.Ic,j.Jc,j.cultureName)},a.prototype.parse=function(a){var b,c,d,f,g;if(!a||a===P.Dc)return m;if(b=this,c=a,d=L(c),"true"===d)return!0;if("false"===d)return!1;if(b.pd&&(f=e.l.Wb(c,b.pd,I(b.cultureName))))return f;try{return g=e.l.Yb(c),g&&!H(g)?g:(g=new Date(c),H(g.valueOf())?c:g)}catch(a){return c}},a.prototype.Zc=function(a){var b,c,d,e=a,f="",g=!1;for(b=0;b<e.length;b++)c=e[b],'"'===c?g=!g:g||("Y"===c||"D"===c||"S"===c||"E"===c||"G"===c?c=L(c):"M"===c&&(d=e[b-1],la("A",d,!0)||la("P",d,!0)||(c=L(c)))),f+=c;return f},a.prototype.bd=function(a){var b,c,e,f=J(this.cultureName).amDesignator,g=J(this.cultureName).pmDesignator,h=[p.rd];for(f&&g?h.push(f+"/"+g):h.push(p.rd),h.push(p.sd),b=["tt","tt","t"],c=a.Qb,e=0;e<3;e++){if(d.u.Bb(c,b[e]))return!0;if(d.u.Bb(c,h[e],!0))return a.Qb=d.u.Gb(c,h[e],b[e],!0),!0}return!1},a.prototype.NUJ=function(a,b,c,d){var e,f,g,h="",i=a.length,j=0;for(e=0;e<i;e++)if('"'===a[e]&&(j=(j+1)%2),"m"!==a[e]||j)h+=a[e];else{for(f="m";e+1<i&&"m"===a[e+1];)e++,f+="m";h+=f===c?d:f}g=RegExp(d+"(?=[^yYdDhHmM]*[Ss])|"+d+"(?=.0)","g"),h=h.replace(g,c),h=h.split("").reverse().join(""),g=RegExp(d+"(?=[^mM]*[Hh])","g"),h=h.replace(g,c),h=h.split("").reverse().join(""),b.Qb=h},a.prototype.Gb=function(b,c,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t;if(f||g){for(j=[],k=!0,!a.hasDate(b)&&a.hasTime(b)&&(k=!1),l=!1,m=0;m<b.length;m++){if(n=b[m],a.hasTime(n)&&!l?k=!1:a.hasDate(n)&&!l&&(k=!0),f&&la(n,c[0],i)&&k||g&&la(n,c[0],i)&&!k){for(o=!0,p=0;p<c.length;p++)if(p+m>=b.length||!la(c[p],b[p+m],i)){o=!1;break}if(q=m+c.length-1,o&&q+1<b.length){for(r=b[q],s=-1,s=q+1;s<b.length&&la(r,b[s],i);s++);s>q+1&&(m=s,o=!1)}o&&!l&&j.splice(0,0,m)}'"'===n&&(l=!l)}if(h.Qb=b,j.length>0){for(m=0;m<j.length;m++)t=j[m],h.Qb=d.u.Fb(h.Qb,t,c.length),h.Qb=d.u.Eb(h.Qb,t,e);return!0}return!1}return!1},a.hasTime=function(a){return d.u.Cb(a,p.md[0],!0)>-1||d.u.Cb(a,p.td[0],!0)>-1},a.hasDate=function(a){return d.u.Cb(a,p.Rc[0],!0)>-1||d.u.Cb(a,p.ud[0],!0)>-1},a.Lc=function(a,b){return oa(a,b||q)},a}(),b.lxb=V,W=function(){function a(a,b){var c,d,e;if(qa.call(this,b),c=this,d=L(a)[0],"h"===d)e=3600;else if("m"===d)e=60;else{if("s"!==d)throw Error(l().Exp_TokenIllegal);e=1}c.Tc=function(a){var b=a/1e3/e;return Math.abs(b-Math.round(b))<1e-6?Math.round(b):Math.floor(b)}}return a.Name="ABSTimeFormatPart",a}(),X=function(){function a(a,b){var c,d;qa.call(this,b),c=y.exec(a),null!==c&&(d=+c[1],d-=1,d>=0&&d<x.length&&(a=x[d])),this.foreColor=a}return a.prototype.toString=function(){return ga(this.foreColor)},a.Name="ColorFormatPart",a}(),Y=function(){function a(a,b,c,d){var e,f,g,h,i,j;function k(a,b){var c,d,e,f,g,h=[],i='"';if(a===m||""===a)return h;for(c=!1,d=[],e=!1,f=0;f<a.length;f++)g=a[f],g!==i||c||(e=!e),c||e||g!==b?d.push(g):(h.push(d.join("")),d=[]),c="\\"===g&&!c;return h.push(d.join("")),h}pa.call(this,b,c,d),e=this,e.Ad=!1,e._c=1,e.Bd=ha(a),f=ma(a),b&&(f=ja(f,e.Ic.Kc,e.Ic.currencySymbol())),f=ha(f),g=f.indexOf("/"),g>-1&&(h=k(f,"/"),h&&2===h.length&&(e.Cd=h[1],i=h[0],i&&(j=i.lastIndexOf(" "),j>-1?(e.Dd=da(i,0,j),e.Ed=da(i,j+1,i.length-j-1)):e.Ed=i))),e.Fd=f}return a.prototype.formatString=function(){return this.Bd},a.prototype.format=function(b){var c,d,e,g,h,i,j,k,l,n,o,p,q,r,s,t,u,v,w,x,y,A;return z(b,"boolean")?(""+b).toUpperCase():(c=this,d=f.j.Pa(b),H(d)||!isFinite(d)||H(b)?"string"==typeof b?b:m:(e=I(c.cultureName),c.Ed&&c.Cd?(n={value:0},o={value:0},p={value:0},q=c.bPa(),a.getFraction(d,q,n,o,p)?(r=a.getGCD(o.value,p.value),r>1&&(o.value/=r,p.value/=r),c.Dd?(l="",1===p.value&&(n.value+=o.value,o.value=0,p.value=0),s=D(E(n.value,c.Dd,e)),s&&"0"!==s&&(l+=s,l+=" "),0===n.value&&d<0&&(l+=e.NumberFormat.negativeSign),0===d&&(l+="0"),h=c.Cd,i=parseFloat(h),!H(i)&&i>0&&(0!==o.value&&0!==p.value&&(o.value*=i/p.value),p.value=i,h=h.replace(/^\d+/,a.toNumberPlaceholder(i)),j=Math.ceil(o.value),k=j-o.value,k<=.5&&k>=0?o.value=parseFloat(""+j):o.value=parseFloat(""+(j-1))),t=c.Ed,u=parseFloat(t),H(u)||0!==u||(v=t.length,w=""+o.value,x=w.length,v>x?t=t.substr(0,v-(v-x)):v<x&&(w=w.substr(0,x-(x-v)),o.value=parseInt(w,10))),y=c.Mja(o.value,p.value,t,h,e),0===o.value&&(y=y.replace(/./g," "),""===s)?"0 "+y:(l+=y,""===l?"0":l)):(l="",A=n.value*p.value+o.value,h=c.Cd,i=parseFloat(h),i>0?(A*=i/p.value,p.value=i,j=Math.ceil(A),k=j-A,A=k<=.5&&k>=0?parseFloat(""+j):parseFloat(""+(j-1)),l+=A+"/"+p.value):l+=c.Mja(A,p.value,c.Ed,c.Cd,e),0===A?"0":l)):""+d):(g=E(d,c.Fd,e),g=wa(g,c.Ad,c.Ic,c.Jc,c.cultureName))))},a.prototype.parse=function(a){var b,c,e,f,g,h,i,j,k,l,n=this;return a&&a!==P.Dc?(b=M(a),!!("TRUE"===b||b===O()&&O().boolean_true)||!("FALSE"===b||b===O()&&O().boolean_false)&&(c=n.Ed&&n.Cd,e=n.Jd(n.Fd).Kd,(c||e)&&(f=a.indexOf("/"),0<f&&f<a.length-1&&(g=parseInt(a.substr(0,f),10),h=parseInt(a.substr(f+1),10),!isNaN(g)&&!isNaN(h)&&0!==h))?g/h:(a=n.Hd(a),a=n.Id(a),i=n.Jd(a),j=i.Kd,k=i.Ld,n.jBb(k)&&(k=d.u.Hb(k,K(n.cultureName).numberGroupSeparator,"",!1),l=B.ob(k,n.cultureName),!H(l)&&isFinite(l))?(j&&(l=F(l/100,15)),l):m))):m},a.prototype.bPa=function(){var a,b,c=this,d=c.Cd,e=0;if(d)for(a=d.length,b=0;b<a&&d[b].match(/[#?0\d]/);b++)e++;return e},a.prototype.jBb=function(a){var b,c="",d=0,e=0,f=0,g=m,h=K(this.cultureName);for(b=a.length-1;b>-1;b--){if(a[b]===h.numberDecimalSeparator)d++,f>0&&(g=!1),c="";else if("e"===L(a[b])){if(e++,c="",b===a.length-1)return!1}else if(a[b]===h.numberGroupSeparator)g=3===c.length,f++,c="";else if("-"===a[b]||"+"===a[b]){if(b>0&&"e"!==L(a[b-1]))return!1}else{if(!Q.Fc(a[b]))return!1;if(c+=a[b],0===b&&0===parseInt(c,10)&&g)return!1}if(d>1||e>1||g===!1)return!1}return!0},a.prototype.Hd=function(a){var b,c,e,f,g,h,i,j=a,k=[];for(b=0;b<j.length;b++)Q.Fc(j[b])&&k.push(b);for(c=K(this.cultureName),e=[c.currencyDecimalSeparator,c.currencyGroupSeparator,c.currencySymbol,c.nanSymbol,c.negativeInfinitySymbol,c.negativeSign,c.numberDecimalSeparator,c.numberGroupSeparator,c.percentDecimalSeparator,c.percentGroupSeparator,c.percentSymbol,c.perMilleSymbol,c.positiveInfinitySymbol,c.positiveSign],f=j.length-1;f>-1;f--)if(g=j[f],!Q.Gc(g)||e.indexOf(""+g)>-1){if(("-"===g||"+"===g)&&(h=f>0?""+j[f-1]:m,i=["e","E","(",K(this.cultureName).currencySymbol],i.indexOf(h)<0))break}else(f<k[0]||k[k.length-1]<f)&&(j=d.u.Fb(j,f,1));return j},a.prototype.Id=function(a){var b=K(this.cultureName).currencySymbol,c=d.u.kb(a,b)?d.u.Fb(a,0,b.length):a;return c.indexOf(b)<0?c:a},a.prototype.Jd=function(a){var b=K(this.cultureName).percentSymbol,c=!0,e=a;return d.u.kb(a,b)?e=d.u.Fb(a,0,b.length):d.u.jb(a,b)?e=d.u.Fb(a,a.length-b.length,b.length):c=!1,d.u.Bb(e,b)&&(c=!1),{Ld:e,Kd:c}},a.prototype.Mja=function(a,b,c,d,e){var f=D(E(a,c,e)),g="0."+b,h="#."+d,i=D(E(g,h,e,!0)),j=e&&e.NumberFormat&&e.NumberFormat.numberDecimalSeparator||".",k=f+"/"+i.substr(i.indexOf(j)+1);return""===c&&(k=a+k),""===d&&(k+=b),k},a.getGCD=function(a,b){var c,d,e;if(0===a)return o(b);if(0===b)return o(a);for(c=Math.max(a,b),d=Math.min(a,b),e=c%d;0!==e;)c=d,d=e,e=c%d;return o(d)},a.getFraction=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,p=0,q=0,r=0,s=0,t=Math.ceil;for(a>0?(s=a-t(a)+1,1===s?(s=0,p=a):p=t(a)-1):a<0&&(p=t(a),s=t(a)-a),f=Math.pow(10,b-1),g=Math.pow(10,b)-1,f<2&&(f=2),g<2&&(g=2),h=!1,i=0,j=f;j<=g&&(k=j*s,l=Math.round(k),m=l/j,n=o(m-s),!((!h||n<o(i-s))&&(h=!0,i=m,q=l,r=j,n<1e-6)));j++);return c.value=p,d.value=q,e.value=r,h},a.toNumberPlaceholder=function(a){return(""+a).replace(/\d/g,"?")},a}(),Z=function(){function a(b,c,d,e){pa.call(this,c,d,e),arguments.length>0?(a.kBb(b)||N(),this.Bd=b):this.Bd="General",this._c=0}return a.kBb=function(a){var b,c,d="",e=!1,f=-1,g=a.length;for(b=0;b<g;b++)c=a[b],'"'===c?(e=!e,f=e?b:-1):e||(d+=c);return f>0&&(d+=a.substring(f,g)),!(d.indexOf("0")>=0||d.indexOf("#")>=0||d.indexOf(".")>=0||d.indexOf("@")>=0)},a.prototype.Nd=function(){var a,b=this;return b.Od||(a=b.Bd,a=ja(a,"General",C),b.Od=new Y(a,b.Ic,b.Jc,b.cultureName),b.Od.Ad=!0),b.Od},a.prototype.Pd=function(){var a=this;return a.Qd||(a.Qd=new Y("0.#####E+00",a.Ic,a.Jc,a.cultureName),a.Qd.Ad=!0),a.Qd},a.prototype.formatString=function(){return d.u.Gb(this.Bd,"@NumberFormat","General")},a.prototype.format=function(a){var b,c,e,g=this;if(f.j.Na(a,g.cultureName)){if(b=!g.Ic||g.Ic.allowScience(),c=f.j.Pa(a),c!==n&&c!==m)return o(c)>99999999999&&b||o(c)<1e-11&&0!==c?g.Pd().format(a):g.Nd().format(a)}else{if(z(a,"string"))return e=d.u.Gb(g.formatString(),'"',""),e=ka(e),e?a:a;if(z(a,"boolean"))return(""+a).toUpperCase()}return""},a.prototype.parse=function(a){var b,c,f,g,i,j,k,l,p,q,r,s,t,u;return P.Ec(a)?m:"number"==typeof a?a:(b=!1,c=a.trim(),f=d.u.Cb(c,"-",!1),f>0&&!la(c.charAt(f-1),"E",!0)&&(b=!0),g=I(this.cultureName),i=g.DateTimeFormat,j=i.dateSeparator,k=i.timeSeparator,l=i.monthNames,p=i.abbreviatedMonthNames,q=function(a,b){var c,e,f;if(!b||0===b.length)return!1;for(c=!1,e=0,f=b.length;e<f;e++)if(d.u.Bb(a,b[e],!0)){c=!0;break}return c},(b||d.u.Bb(c,j,!1)||d.u.Bb(c,k,!1)||d.u.Bb(c,"/",!1)||d.u.Bb(c,":",!1)||d.u.Bb(c,"-",!1)||d.u.Bb(c,"\u5e74",!1)||d.u.Bb(c,"\u6708",!1)||d.u.Bb(c,"\u65e5",!1)||q(c,l)||q(c,p)||"ja-JP"===g.name()&&h.aBb.R.indexOf(c[0].toUpperCase())>=0&&d.u.Bb(c,".",!1))&&(r=e.l.Qa(c))?r:(t="-"===c.charAt(0),c=t?d.u.Fb(c,0,1):c,u="("===c.charAt(0)&&")"===c.charAt(c.length-1),u&&(c=c.substring(1,c.length-1)),s=this.Nd().parse(c),s!==m&&s!==n?(u||t)&&z(s,"number")?-1*o(s):s:a))},a}(),$=function(){function a(a,b,c,d){var e,f=this;pa.call(f,b,c,d),e=ma(a,!1),b&&(e=ja(e,f.Ic.Kc,f.Ic.currencySymbol())),e=ha(e),e=ka(e),f.Yc=e,f._c=3}return a.prototype.format=function(a,b){var c,d,f,g=this;try{return c=void 0,d=void 0,d=a instanceof Date?""+e.l.Ra(a):ea(a),f=g.Kja(g.Yc),c=g.Lja(d,f.formatTokens,a,f.hasAtPart,b)}catch(a){return""}},a.prototype.parse=function(a){return a?a:""},a.prototype.formatString=function(){return this.Yc},a.prototype.Kja=function(a){var b,c,d=[],e=!1,f="",g=!1,h=m;for(c=0;c<a.length;c++)b=a.charAt(c),g?('"'!==b?f+=b:(f+=b,d.push(f),f="",g=!1),h=b):"*"!==h&&"_"!==h&&"\\"!==h||""===f?"*"!==b&&"_"!==b&&"\\"!==b?"@"!==b?'"'!==b?(f+=b,h=b):(h=b,""!==f&&d.push(f),f=b,g=!0):(h=b,""!==f&&(d.push(f),f=""),d.push(b),e=!0):(h=b,""!==f&&(d.push(f),f=""),f+=b):(f+=b,d.push(f),f="");return""!==f&&d.push(f),{formatTokens:d,hasAtPart:e}},a.prototype.Lja=function(a,b,c,d,e){var f,g,h=[],i=!1;if("string"!=typeof c||d||e)for(f=b.length-1;f>=0;f--)g=b[f],"*"===g[0]?i||(i=!0,h.push({type:"fillingChar",value:g[1]})):"_"===g[0]?h.push({type:"placeholder",value:g[1]}):'"'===g[0]&&'"'===g[g.length-1]?g.length>=2&&h.push({type:"text",value:g.substr(1,g.length-2)}):"\\@"===g?h.push({type:"text",value:"@"}):"@"===g[0]?h.push({type:"text",value:a}):h.push({type:"text",value:g});else h.push({type:"text",value:c});return h.reverse()},a}();function da(a,b,c){return a.substr(b,c)}function ea(a){return f.j.Fa(a)?"":"boolean"==typeof a?a?"TRUE":"FALSE":"string"==typeof a?a:""+a;
}function fa(a,b){if("\\"===a[b])throw Error(l().Exp_InvalidBackslash);if(b-1>0&&b-1<a.length&&"\\"===a[b-1]){if(b-2<0)return!0;if(b-2>0&&b-2<a.length)return"\\"!==a[b-2]}return!1}function ga(a){if(!a)throw Error(l().Exp_TokenIsNull);return"["+a+"]"}function ha(a){var b,c,d,e,f;if(a===n||a===m||""===a)return a;for(b="",c=0,d=!1,e=0;e<a.length;e++)f=a[e],'"'===f?(d=!d,b+=f):d?b+=f:"["===f?c++:"]"===f?(c--,c<0&&(c=0)):0===c&&(b+=f);return""+b}function ia(a){return a=ja(a,"[",""),ja(a,"]","")}function ja(a,b,c){return!a||a===P.Dc||la(b,c,!0)?a:(b=b.replace(v,"\\$1"),a.replace(RegExp(b,"g"),c))}function ka(a){var b,c,d=a.length,e=!1,f="";for(b=0;b<d;b++)c=a.charAt(b),"\\"===c?(e=!e,e&&"@"!==a.charAt(b+1)||(f+=c)):(e=!1,f+=c);return f}function la(a,b,c){return c?L(a)===L(b):a===b}function ma(a,b){var c,d,e,f;for(1===arguments.length&&(b=!0),c=!1,d="",e=0;e<a.length;e++){if(f=a[e],'"'===f)c=!c;else if(!c&&!b&&"/"===f&&!fa(a,e))continue;d+=f}return d}function na(a){var b,c,d,e="",f=!1;for(b=0,c=a.length;b<c;b++)d=a[b],'"'===d&&(f=!f),"E"===d||f||(e+=L(d));return e}function oa(a,b){var c,d,e,f;if(!a||a===P.Dc)return!1;for(c=ma(a),d=na(c),e=0;e<b.length;e++){if(f=d.indexOf(b[e]),0===f)return!0;if(f>0&&"_"!==d[f-1]&&"*"!==d[f-1])return!0}return!1}_=function(){return{pattern:w,formatter:["d-mmm","mmm-yy",J().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0","h:mm:ss tt",J().shortDatePattern+" h:mm",J().shortDatePattern+" h:mm:ss",J().shortDatePattern+" h:mm:ss.0"]}};function pa(a,b,c,d){this.Ic=a,this.Jc=b,this.cultureName=c,this.wOb=d}function qa(a){this.Kc=a}function ra(a){var b,c,e=ia(a);return e&&e!==P.Dc?(c=e[0],["<",">","="].indexOf(c)>-1?(b=T,b.Name="ConditionalFormatPart"):d.u.kb(e,"DBNum",!0)?(b=U,b.Name="DBNumberFormatPart"):la(e[0],"$",!1)&&e.indexOf("-")>-1?(b=R,b.Name="LocaleIDFormatPart"):ta(e)?(b=W,b.Name="ABSTimeFormatPart"):e.indexOf("$")<0&&e.length>=3&&(b=X,b.Name="ColorFormatPart"),b):b}function sa(a,b){var c,d=!1;return a=a?""+a:P.Dc,oa(a,["general"])?c=Z:V.Lc(a)?c=V:oa(a,["E+","E-","#",".",",","%","0","/","?"])||b?(d=!0,c=Y):(d=!0,c=$),{Mc:d,Nc:c}}function ta(a){var b,c=L(a),d=c[0];if("h"!==d&&"m"!==d&&"s"!==d)return!1;for(b=1;b<c.length;b++)if(d!==c[b])return!1;return!0}function ua(a,b,c){var d,e;return d=a?a.cultureInfo():I(c),(b<4||4===b&&("ko-kr"===c||"ko-kr"===d.name()))&&(e=d.NumberFormat.dbNumber)?e[b]:m}function va(a,b,c,d,f){var g,h=a;if(!G(d)&&b instanceof Date){if(g=ua(c,d.type,f),!g)return a;h=d.Pc(h,g,!0),1===d.type&&(h=h.replace(RegExp(r,"g"),s)),h=h.replace("@"+p.Qc,e.l.Vb(b,p.Qc)),h=h.replace("@"+p.Rc,e.l.Vb(b,p.Rc)),h=d.Pc(h,g,!1)}return h}function wa(a,b,c,d,e){var f,g,h,i,j,k,l;if(!G(d)&&(f=ua(c,d.type,e),!G(f))){for(g=!1,h=void 0,i=I(e),j=void 0,k=0,l=a.length;k<l;k++)"decimalSeparator"===a[k].type&&(g=!0,a[k].value=d.Pc(a[k].value,f,b),h=a[k].value),"number"===a[k].type&&(g?a[k].value=d.Pc(h+a[k].value,f,b).slice(1):a[k].value=d.Pc(a[k].value,f,b),"ja-JP"===i.name()&&a[k].value.length>1&&(j=a[k].value.substr(0,2),"\u4e00\u5343"!==j&&"\u4e00\u767e"!==j&&"\u4e00\u5341"!==j||(a[k].value=a[k].value.substr(1))));return a}return a}aa=function(){function a(a,b){var c=this;0===arguments.length?(c.formatCached="General",c.Rd=new Z):c.ad(a,b)}return a.prototype.ad=function(b,c){var d,e,f,g,i,j,k,l,o,p,q,r,s,t,u,v,w;for(b!==m&&b!==n||N(),d=b,e=this,e.formatCached=b,f="",g="",i=!1,j=!1,k=!1,l=[],o=0;o<b.length;o++)p=b[o],'"'===p?(j=!j,g+=p):j?g+=p:"["===p?(i&&N(),g&&(f||(f=""),f+=g),g=""+p,i=!0):"]"===p?(i||N(),g?(g+=p,q=""+g,r=ra(""+g),r?"ABSTimeFormatPart"===r.Name?(l.push(new r(a.preProcessPart(q),q)),f+=g):q===h.aBb.eraExcelFormatter?(e.addPart(r,h.aBb.eraInternalFormatter),k=!0):e.addPart(r,q):(s=a.partToNormalStr(q),f+=s,d=ja(b,q,s)),g=""):N(),i=!1):g+=p;g?i?N():f+=g:f||(f=e.o$a()),e.localeIDFormatPart&&(c=e.localeIDFormatPart.cultureInfo().name()),t=e.conditionalFormatPart,u=sa(f,t),v=u.Nc,w=u.Mc?d:f,v?e.Rd=new v(w,e.localeIDFormatPart,e.dbNumberFormatPart,c,l.length>0?l:m,k):N()},a.prototype.o$a=function(){var b,c=this,d="";return c.dbNumberFormatPart&&(b=a.proNames.some(function(a){return"dbNumberFormatPart"!==a&&c[a]}),b||(d="General")),d},a.prototype.formatString=function(){var b,c,d,e=this,f="";for(b=0,c=a.proNames.length;b<c;b++)d=a.proNames[b],e[d]&&(f+=""+e[d]);return f+=e.Rd.formatString()},a.prototype.addPart=function(b,c){var d,e,f,g=this,h=a.proNames,i=a.preProcessPart(c);for(d=0,e=h.length;d<e;d++)if(f=h[d],la(f,b.Name,!0)){if(g[f])throw Error(l().Exp_DuplicatedDescriptor);g[f]=new b(i,c)}},a.prototype.format=function(a,b){return this.Rd.format(a,b)},a.prototype.parse=function(a){return this.Rd.parse(a)},a.checkFormatter=function(a){if(!a||a===P.Dc)throw Error(l().Exp_TokenIllegal)},a.preProcessPart=function(b){a.checkFormatter(b);var c=ia(b);return a.checkFormatter(c),c},a.partToNormalStr=function(b){var c=a.preProcessPart(b);return"$"===c[0]&&(c=c.slice(1)),'"'+c+'"'},a.proNames=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"],a}(),ba=function(a){ca(b,a);function b(b,c){var d=a.call(this,b,c)||this,e=d;return e.Sd=!0,e.PropertyChanged=[],P.Ec(b)&&(b="General"),e.formatCached=b,e.cultureName=c,e.init(),d}return b.prototype.toJSON=function(){var a=this,b={formatCached:a.formatCached};return a.cultureName&&(b.customerCultureName=a.cultureName),"general"===L(a.formatCached)&&delete b.formatCached,b},b.prototype.hasFormattedColor=function(){var a,b,c=this;for(a in t)if(t.hasOwnProperty(a)&&(b=c.getFormatter(t[a]),b&&b.colorFormatPart))return!0;return!1},b.prototype.formatString=function(a){var b,c,d,e,f=this;if(0===arguments.length){for(b=P.Dc,c=0,d=f.formatters.length;c<d;c++)e=f.formatters[c],b+=e.formatString(),c!==d-1&&(b+=";");return b}if(!a)throw Error(l().Exp_ValueIsNull);return f.formatters=m,f.formatCached=a,f.init(),f.Td("formatString"),f},b.prototype.getFormatter=function(a){var b=this;return b.formatters&&b.formatters[a]},b.prototype.getPreferredEditingFormatter=function(a){var c,d,e=J(this.cultureName),g=b.defFormatter;return z(a,"TimeSpan")?g(e.longTimePattern):z(a,"DateTime")?(c=0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()?"":" h:mm:ss",g(e.shortDatePattern+c)):f.j.Na(a,this.cultureName)?(d=f.j.Pa(a),g(d>=1e20||d<=1e-17&&d>0||d<=-1e20||d<0&&d>=-1e-17?"0.##E+00":C)):g("General")},b.prototype.getPreferredDisplayFormatter=function(a,c){var g,h,i,j,k,l,n,o,p,q,r,s,t,u,v,w,x,y,A,B,C,D,E,F,G,H=this,J=b.defFormatter;if(c||(c={value:m}),c.value=m,P.Ec(a))return new b;if(g=a,h=c.value=H.parse(g),z(h,"DateTime")||z(h,"TimeSpan")){for(i=_(),j=i.pattern,k=i.formatter,l=I(H.cultureName),n=l.DateTimeFormat,o=n.preselectedFormatters,o.length>0&&(j=j.concat([o]),k=k.concat([o[0]])),"ja-JP"===l.name()&&(j=j.concat([n.eraFormatter]),k=k.concat(["ge.M.d"]),p=l.X8J.filter(function(a){return"ggge"===a.substr(0,4)}),j=j.concat([p]),k=k.concat(['ggge"\u5e74"M"\u6708"d"\u65e5']),q=l.X8J.filter(function(a){return"gge"===a.substr(0,3)}),j=j.concat([q]),k=k.concat(['gge"\u5e74"M"\u6708"d"\u65e5']),r=l.X8J.filter(function(a){return"ge"===a.substr(0,2)}),j=j.concat([r]),k=k.concat(['ge"\u5e74"M"\u6708"d"\u65e5'])),s=0;s<j.length;s++)for(t=j[s],u=0;u<t.length;u++)if(v=t[u],w=e.l.Qa(a,v),w&&w-h===0)return new b(k[s])}else if(f.j.Na(h,H.cultureName)){if(x=K(H.cultureName),y=x.currencySymbol,A=x.numberDecimalSeparator,B=x.percentSymbol,C=x.numberGroupSeparator,D="E",E=d.u.Bb,F=E(g,A),G=F?".00":"",g[0]===y)return J(P.Kb("{0}#,##0{1};[Red]({0}#,##0{1})",y,G));if(E(g,D,!0))return J("0.00E+00");if(""+g[0]===B||""+g[g.length-1]===B)return J(P.Kb("0{0}%",G));if(E(g,C))return J(P.Kb("#,##0{0}",G))}return J("General")},b.prototype.format=function(a,b){var c,d,e,g,h,i,j;if(z(a,"boolean"))return O()&&(a=a?O().boolean_true:O().boolean_false),(""+a).toUpperCase();if(c=this,e=0,g=c.Ud(a)){h=g.colorFormatPart,b&&h&&(b.conditionalForeColor=b.value=h.foreColor),d=f.j.Na(a,c.cultureName),d&&(e=f.j.Pa(a)),i=P.Dc;try{d&&g===c.getFormatter(t.Va)&&0!==this.expressionNumber?(i=g.format(g.considerNegSymbol?e:o(e)),i===m&&z(a,"string")&&(i=a)):(i=g.value,i===n&&(j=!c.Sd&&g===c.getFormatter(t._text),i=g.format(a,d||j))),b&&(b.content=A(i)?i:[{type:"text",value:i}]),A(i)&&(i=B.Y8J(i))}catch(b){z(a,"string")&&(i=""+a)}return i}return d&&e<0?"-":z(a,"string")?""+a:a===n||a===m?P.Dc:""+a},b.prototype.parse=function(a){var b=this;return b.formatters&&b.formatters.length>0?b.formatters[0].parse(a):m},b.prototype.init=function(){var a,b,c,d=this,e=d.formatCached;for(P.Ec(e)&&N(),d.formatters=[],a=xa(e),d.Sd=1===a.length,(!a||a.length<1||a.length>4)&&N(),b=0;b<a.length;b++)a[b].indexOf("@")!==-1&&a[b].indexOf("\\@")===-1&&(b!==a.length-1?N():this.hasAt=!0),c=new aa(a[b],d.cultureName),d.formatters.push(c);d.getFormatter(t.Hc)||N(),this.IPJ()},b.prototype.IPJ=function(){this.expressionNumber=this.formatters.length-(this.hasAt?1:0);var a=(0===this.expressionNumber?1:this.expressionNumber)-1;t=f.j.Ia({},u[a]),this.hasAt&&0!==this.expressionNumber&&(t._text=this.formatters.length-1)},b.prototype.Ud=function(a){var b,c,d,e,g,h,i,j,k,l,n,o=this;if(o.IPJ(),b=o.getFormatter(t.Hc),c=b&&b.conditionalFormatPart,d=o.getFormatter(t._text),c&&(t.Ua=2,this.hasAt||(t._text=3)),"string"==typeof a&&H(a))return d?d:c?a:b;if(f.j.Na(a,o.cultureName)||z(a,"boolean")){if(e=o.getFormatter(t.Va),g=o.getFormatter(t.Ua),h=f.j.Pa(a),i=c&&b.conditionalFormatPart.isMeetCondition(h),j=e&&e.conditionalFormatPart,k=j&&e.conditionalFormatPart.isMeetCondition(h),l=void 0,o.Sd||(c?i:h>0||0===h&&!g))l=b;else if(j?k:h<0)l=e;else if(g)l=g;else if(e){if(c&&j)return n=h+"",{value:n};l=e}return l&&(!c||j||l!==e||g||(l.considerNegSymbol=!0),c&&j&&l===e&&e.conditionalFormatPart&&e.conditionalFormatPart.isMeetCondition(1e-10)&&(l.considerNegSymbol=!0),this.expressionNumber<=1&&(l.considerNegSymbol=!0)),l}return m},b.prototype.Td=function(a){var b,c,d=this;if(d.PropertyChanged)for(b=0;b<d.PropertyChanged.length;b++)c=d.PropertyChanged[b],"function"==typeof c&&c(d,a)},b.defFormatter=function(a){var c=b[a];return c||(c=new b(a),b[a]=c),c},b}(S),b.GeneralFormatter=ba;function xa(a){var b,c=[],d=0,e=0,f=a.length;for(b=0;b<f;b++)"_"===a[b]?d++:(";"!==a[b]||0!==d&&d%2!==0||(c.push(a.substring(e,b)),e=b+1),d=0);return e<=f&&c.push(a.substring(e,f)),c}},"./src/plugins/slicer/slicer.entry.ts":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./src/plugins/slicer/slicer.ts"))},"./src/plugins/slicer/slicer.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/datetimehelper.ts"),e=void 0,f=null,g="number",h="string",i="boolean",j=d.l.Ra,function(a){a[a.all=0]="all",a[a.byCurrentColumn=1]="byCurrentColumn",a[a.byOtherColumns=2]="byOtherColumns"}(k=b.FilteredOutDataType||(b.FilteredOutDataType={})),function(a){a[a.average=1]="average",a[a.count=2]="count",a[a.counta=3]="counta",a[a.max=4]="max",a[a.min=5]="min",a[a.product=6]="product",a[a.stdev=7]="stdev",a[a.stdevp=8]="stdevp",a[a.sum=9]="sum",a[a.vars=10]="vars",a[a.varp=11]="varp"}(l=b.SlicerAggregateType||(b.SlicerAggregateType={}));function o(a){return a&&a.text!==e}m=function(){function a(){}return a.Ra=function(a){return j(a)},a.quickSort=function(b){var c,d=D(b),e=[];for(c=0;c<d;c++)e[c]={index:c,value:b[c]};return a.quickSortImp(e)},a.quickSortImp=function(b){var c,d,e,f,g,h,i,j;if(D(b)<=1)return b;for(c=a,d=Math.floor(D(b)/2),e=b[d],f=[],g=[],h=[],i=0;i<D(b);i++)j=c.sortCompare(b[i].value,e.value),j<0?f.push(b[i]):j>0?g.push(b[i]):h.push(b[i]);return c.quickSortImp(f).concat(h,c.quickSortImp(g))},a.isEquals=function(a,b){return!(!B(a)&&""!==a||!B(b)&&""!==b)||(a instanceof Date&&b instanceof Date?a.valueOf()===b.valueOf():C(a)===h&&C(b)===h?a.toLowerCase()===b.toLowerCase():a===b)},a.isGreaterThan=function(b,c){var d=C(b),e=C(c);return d===i?b=b?1:0:b instanceof Date&&(b=a.Ra(b)),e===i?c=c?1:0:c instanceof Date&&(c=a.Ra(c)),d===e||d!==g&&e!==g?d===h&&e===h?b.toLowerCase()>c.toLowerCase():b>c:C(c)===g},a.sortCompare=function(b,c){var d=a,e=0,f=B(b)||""===b||C(b)===g&&isNaN(b),h=B(c)||""===c||C(c)===g&&isNaN(c);return e=f&&h?0:f?1:h?-1:d.isEquals(b,c)?0:d.isGreaterThan(b,c)?1:-1},a}(),b.jf=m;function p(a,b){var c,d,j;if(a===f||a===e)return!1;if(C(a)===g)b.value=a;else if(C(a)===i)b.value=a?1:0;else if(a instanceof Date)b.value=m.Ra(a);else{if(C(a)!==h)return!1;if(a=a.trim(),0===D(a))return!1;if(c=!1,"%"===a.charAt(D(a)-1)&&(c=!0,a=a.substr(0,D(a)-1)),D(a)>=2&&"0"===a[0]&&"x"===a[1])return!1;if(d=(+a).valueOf(),isNaN(d)||!isFinite(d)){if(j=new Date(a),isNaN(j))return!1;d=m.Ra(j)}c&&(d/=100),b.value=d}return!0}function q(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=a.Ce;for(o||(a.Ee=[],a.Ie=[]),b=o?a.De:a.Ee,c=a.Fe,d=a.Ge,e=o?a.He:a.Ie,f=a.Je,g=a.Ke,h=a.Le,i=D(a.data),k=0;k<i;k++){for(l=!1,m=void 0,n=0;n<D(f)&&(m=f[n],o&&m===a.Me||(d[m]?(j=a.getExclusiveRowIndex(a.columnNames[m],k),l=!d[m][j]):c[m]&&(l=!c[m][k]),!l));n++);!l&&o&&(g?(j=a.getExclusiveRowIndex(a.columnNames[m],k),l=!g[j]):h&&(l=!h[k])),l||(b[k]=!0)}for(n=0;n<D(b);n++)b[n]&&e.push(n)}function r(a){return"string"==typeof a?a.toLowerCase():a instanceof Date?m.Ra(a):a}function s(a){var b,c,d=a.Ne={};for(a.Oe=[],a.Pe=[],a.Qe=[],a.Z8J=[],b=a.columnNames,c=0;c<D(b);c++)d[(b[c]+"").toUpperCase()]=c}function t(a,b){var c,d,e,f,g,h,i,j=a.Oe,k=a.Pe,l=a.Se,m=a.Qe,n=a.Z8J,p=a.data,q=n[b]=[];for(a._e=[],j[b]=[],k[b]=[],l[b]={},m[b]=[],c={},d=0;d<D(p);d++)e=p[d][b],f=o(e)?e.text.trim():e,j[b].push(f),g=c[r(f)],g?(g.list.push(d),q[d]=g.index):(h=[d],k[b].push(f),m[b].push(h),i=D(m[b])-1,l[b][f]=i,q[d]=i,c[r(f)]={list:h,index:i})}function u(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,p,q=a.Te,r=a.getColumnIndex(b),s=[];if(!r)return s;if(d=a.Ce?a.Ue:a.Ve[r],e=a.Ee,!d)return s;for(q[r]||a.We(r),f=[],g=q[r],h=0;h<D(g);h++)i=a.data[h][r],j=o(i)?i.value:i,f[g[h]]=j;for(k=a.af[r],h=0;h<D(d);h++){for(l=d[h],m=!1,n=a.Xe(f,l),p=n.start;p<=n.end;p++)if(e[k[p]]){m=!0;break}m!==c&&s.push(l)}return s}function v(a,b){var c,d,e,f,g=[],h=a.getColumnIndex(b);if(h>=0){for(c=D(a.getData(b)),d=a.Ce?a.De:a.Ee,e=0;e<c;e++)d[e]||(f=a.getExclusiveRowIndex(b,e),g.indexOf(f)===-1&&g.push(f));return g}}function w(a,b){var c,d,e,f,g,h,i,j=[],k={},l=a.getColumnIndex(b);if(l>=0)for(c=a.Ke||a.Le,d=a.Ge[l]||a.Fe[l],e=a.Ce&&l===a.Me?c:d,f=!!a.Fe[l],g=D(f?a.getData(b):a.getExclusiveData(b)),h=0;h<g;h++)e&&!e[h]&&(i=f?a.getExclusiveRowIndex(b,h):h,k[i]||(k[i]=!0,j.push(i)));return j}function x(a,b){var c,d,e,f,g,h,i,j,k,l={},m=a.columnNames,n=D(m);for(c=0;c<n;c++)if(m[c]!==b)for(d=w(a,m[c]),e=0;e<D(d);e++)for(f=a.getRowIndexes(m[c],d[e]),g=0;g<D(f);g++)l[f[g]]||(l[f[g]]=!0);for(h={},n=D(a.data),c=0;c<n;c++)i=a.getExclusiveRowIndex(b,c),l[c]||(h[i]=!0);for(j=D(a.getExclusiveData(b)),k=[],c=0;c<j;c++)h[c]||k.push(c);return k}function y(a,b,c,d){var e,f,g,h,i,j,k,l,m=a.getColumnIndex(b),n=a.Te;for(n[m]||a.We(m),e=[],f=n[m],g=0;g<D(f);g++)h=a.data[g][m],i=o(h)?h.value:h,e[f[g]]=i;for(j=[],g=0;g<D(c);g++)for(k=a.Xe(e,c[g]),l=0;l<D(f);l++)f[l]>=k.start&&f[l]<=k.end&&(j[l]=!0);d?(a.Le=j,a.Ue=c):(a.Ve[m]=c,a.Fe[m]=j,delete a.Ge[m],delete a.Ye[m]),q(a)}function z(a,b,c,d){var e,f=a.getColumnIndex(b),g=[];for(e=0;e<D(c);e++)g[c[e]]=!0;d?a.Ke=g:(a.Ge[f]=g,a.Ye[f]=c,delete a.Ve[f],delete a.Fe[f]),q(a)}function A(a,b){a.Ce=!1,a.Ke=[],a.He=[],a.De=[],a.Le=[],b&&a.onFiltered()}n=function(){function a(a,b){var c,d=this;for(d.Ne={},d.Oe=[],d.Pe=[],d.Se=[],d.Qe=[],d.Z8J=[],d.Ge=[],d.Ye=[],d.Fe=[],d.Ve=[],d.Ee=[],d.Ie=[],d.Je=[],d.He=[],d.De=[],d.Ce=!1,d.Ze=[],d.$e=0,d._e=[],d.af=[],d.Te=[],d.bf(a,b),c=0;c<D(d.data);c++)d.Ee[c]=!0,d.Ie.push(c)}return a.prototype.inPreview=function(){return this.Ce},a.prototype.bf=function(a,b){var c=this;c.data=a,c.columnNames=b,s(c)},a.prototype.onDataChanged=function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=Array(D(l.columnNames)),n=l.Ye,p=l.Pe,r=l.Ge,s=l.Oe;for(b=0;b<D(a);b++)c=a[b],d=c.data,e=c.row,f=l.getColumnIndex(c.columnName),e>=l.data.length&&l.onRowsAdded(e,1,!1),l.data[e][f]=d,g=o(d)?d.text:d,s[f]&&(s[f][e]=g),m[f]=!0;for(h=0;h<D(m);h++)if(m[h]){for(i=n[h],n[h]=i?[]:void 0,r[h]=i?[]:void 0,j=[],b=0;i&&b<D(i);b++)j.push(p[h][i[b]]);for(t(l,h),b=0;b<D(j);b++)k=l.Se[h][j[b]],n[h].push(k),r[h][k]=!0}q(l),l.cf("onDataChanged",a)},a.prototype.cf=function(a){var b,c,d,e,f=[];for(b=1;b<arguments.length;b++)f[b-1]=arguments[b];for(c=this.Ze||[],d=0;d<D(c);d++)e=c[d],e[a]&&e[a].apply(e,f)},a.prototype.onColumnNameChanged=function(a,b){var c=this,d=c.Ne,e=c.getColumnIndex(a);e<0||(c.columnNames[e]=b,delete d[a.toUpperCase()],d[b.toUpperCase()]=e,c.cf("onColumnNameChanged",a,b))},a.prototype.onRowsAdded=function(a,b,c){var d,g,h,i,j,k,l,n,o,p,q,r,s,t=this,u=D(t.columnNames),v=t.data,w=t.Oe,x=t.Pe,y=t.Qe,z=t.Z8J,A=t.Ge,B=t.Ye,C=t.Ee,E=t.Ie,F=t.Je;for(t._e=[],d=0;d<b;d++)v.splice(a,0,Array(u));for(g=0;g<u;g++){for(d=0;d<b;d++)w[g]&&w[g].splice(a,0,e);if(i=x[g],j=void 0,i){for(k=f,l=0;l<D(i);l++){for(n=y[g][l],o=0;o<D(n);o++)n[o]>=a&&(n[o]+=b);m.isEquals(i[l],f)&&(k=n,j=l)}for(k||(k=[],i.push(f),j=D(i)-1,t.Se[g][f]=j,y[g].push(k),A[g]&&F.indexOf(g)===-1&&(A[g][j]=!0,B[g].push(j))),p=a;p<a+b;p++)k.push(p);for(h=a;h<a+b;h++)z[g].splice(h,0,j)}}for(q=!0,d=0;d<D(F);d++)g=F[d],r=z[g][a],A[g][r]!==!0&&(q=!1);for(d=0;d<D(E);d++)E[d]>=a&&(E[d]+=b);for(h=D(v)-1;h>=a+b;h--)C[h]=C[h-b];for(s=D(F)>0,h=a;h<a+b;h++)q&&E.push(h),C[h]=!s;c||t.cf("onRowsChanged",a,b,!0)},a.prototype.onRowsRemoved=function(a,b){this.df(a,b,!0)},a.prototype.df=function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=l.Ye,n=l.Pe,o=l.Ge,p=l.data,r=D(l.columnNames),s=l.Oe;for(p.splice(a,b),e=0;e<r;e++){if(s[e]&&s[e].splice(a,b),f=m[e],g=[],f&&c){for(d=0;d<D(f);d++){for(h=l.getRowIndexes(l.columnNames[e],f[d]),i=!0,j=0;j<D(h);j++)if(h[j]<a||h[j]>=a+b){i=!1;break}i||g.push(n[e][f[d]])}m[e]=[],o[e]=[]}if(t(l,e),f&&c)for(d=0;d<D(g);d++)k=l.Se[e][g[d]],m[e].push(k),o[e][k]=!0}c&&q(l),l.cf("onRowsChanged",a,b,!1)},a.prototype.onColumnsRemoved=function(a,b){var c,d,e,f,g,h,i,j,k=this,l=k.data,m=[],n=k.Je,o=a+b;for(c=a;c<o;c++)d=k.columnNames[c],d&&(e=c,m.push(d),n.indexOf(e)!==-1&&k.doUnfilter(d));for(f=k.Ge||k.Fe,g=k.Ye||k.Ve,h=k.Ne,c=0;c<D(l);c++)l[c].splice(a,b);k._e=[],k.columnNames.splice(a,b),k.Oe.splice(a,b),k.Pe.splice(a,b),k.Se.splice(a,b),k.Qe.splice(a,b),k.Z8J.splice(a,b),f.splice(a,b),g.splice(a,b);for(i in h)h[i]>=a+b&&(h[i]-=b);for(c=0;c<D(m);c++)d=m[c],delete h[d.toUpperCase()],a=k.getColumnIndex(d),j=n.indexOf(a),j!==-1&&n.splice(j,1),k.cf("onColumnRemoved",m[c])},a.prototype.ef=function(){return this._e},a.prototype.ff=function(){return this.af},a.prototype.We=function(a){var b,c,d,e,f,g,h,i,j,k,l,n=this,p=n.data;for(n.Oe[a]||t(n,a),b=D(p),c=[],d=0;d<b;d++)e=p[d][a],f=o(e)?e.value:e,c.push(f);for(g=m.quickSort(c),h=n._e[a]=[],i=n.af[a]=[],j=n.Te[a]=[],k=0;k<D(g);k++)l=g[k],h.push(l.value),i.push(l.index),j[l.index]=k},a.prototype.getColumnIndex=function(a){var b=this.Ne[a.toUpperCase()];return void 0===b?-1:b},a.prototype.getFilteredRowIndexes=function(){var a=this;return a.Ce?a.He:a.Ie},a.prototype.getFilteredOutRowIndexes=function(){var a,b=this,c=D(b.data),d=b.Ce?b.De:b.Ee,e=[];for(a=0;a<c;a++)d[a]||e.push(a);return e},a.prototype.getData=function(a,b){var c,d,e,f,g,h,i,j=this,k=j.Oe,l=j.getColumnIndex(a);if(l>=0){if(b){for(j._e[l]||j.We(l),c=k[l],d=j._e[l],e=j.Xe(d,b),f=e.start,g=e.end,h=[],i=f;i<=g;i++)h.push(c[j.af[l][i]]);return h}return k[l]||t(j,l),k[l]}return[]},a.prototype.aggregateData=function(a,b,c){var d,f,g,h,i,j,k,l,m,n=this,o=n.getColumnIndex(a);return o<0?e:(n._e[o]||n.We(o),g=n._e[o],h=D(g),i=n.Xe(g,c),d=i.start,f=i.end,5===b?d>=h?e:g[d]:4===b?f<0?e:g[f]:3===b?f<d?0:f-d+1:(j=n.Qka(g,b,d,f),k=j.data1,l=j.data2,m=j.data3,1===b?k/=l:7===b||10===b?(k=(m*l-k*k)/(m*(m-1)),k=7===b?Math.sqrt(k):k):8!==b&&11!==b||(k=(m*l-k*k)/(m*m),k=8===b?Math.sqrt(k):k),k))},a.prototype.Qka=function(a,b,c,d){var g,h,i,j=6===b?1:0,k=0,l=0;for(g=c;g<=d;g++)h=a[g],h===f&&h===e||(i={value:f},p(h,i)&&(h=i.value,1===b?(j+=h,k++):2===b?j++:9===b?j+=h:6===b?j*=h:7!==b&&8!==b&&10!==b&&11!==b||(j+=h,k+=h*h,l++)));return{data1:j,data2:k,data3:l}},a.prototype.Xe=function(a,b){var c=D(a),d,f,g,h;if(b){if(b.min===-(1/0))d=0;else for(g=0;g<c;g++)if(h=a[g],m.isEquals(b.min,h)||m.isGreaterThan(h,b.min)){d=g;break}if(d===e&&(d=c),f===1/0)f=c-1;else{for(g=c-1;g>=0;g--)if(h=a[g],m.isEquals(h,b.max)||m.isGreaterThan(b.max,h)){f=g;break}f===e&&(f=-1)}}else d=0,f=c-1;return{start:d,end:f}},a.prototype.getExclusiveData=function(a){var b=this,c=b.Pe,d=b.getColumnIndex(a);return d>=0?(c[d]||t(b,d),c[d]):[]},a.prototype.getRowIndexes=function(a,b){var c=this,d=c.getColumnIndex(a);return d>=0?(c.Z8J[d]||t(c,d),c.Qe[d][b]):[]},a.prototype.getExclusiveRowIndex=function(a,b){var c=this,d=c.Z8J,e=c.getColumnIndex(a);return e>=0?(d[e]||t(c,e),d[e][b]):-1},a.prototype.getFilteredIndexes=function(a){var b=[],c={};return this.gf(a,b,c),b},a.prototype.gf=function(a,b,c){var d,e,f,g=this,h=g.Ce?g.He:g.Ie;for(d=0;d<D(h);d++)e=h[d],f=g.getExclusiveRowIndex(a,e),B(f)||(c[f]?c[f]++:(c[f]=1,b.push(f)))},a.prototype.getFilteredRanges=function(a){return u(this,a,!1)},a.prototype.getFilteredOutRanges=function(a){return u(this,a,!0)},a.prototype.getFilteredOutIndexes=function(a,b){var c=this;return 0===b?v(c,a):1===b?w(c,a):x(c,a)},a.prototype.attachListener=function(a){this.Ze.indexOf(a)===-1&&this.Ze.push(a)},a.prototype.detachListener=function(a){var b,c=this.Ze||[];for(b=0;b<D(c);b++)if(c[b]===a){c.splice(b,1);break}},a.prototype.suspendFilteredEvents=function(){this.$e++},a.prototype.resumeFilteredEvents=function(){var a=this;a.$e--,0===a.$e&&a.onFiltered()},a.prototype.doFilter=function(a,b,c){this.hf(a,b,c),this.onFiltered()},a.prototype.hf=function(a,b,c){var d=this,e=d.Je,f=d.getColumnIndex(a);f<0||(c?(d.Ce=!0,d.Me=f):d.Ce&&A(d,!1),e.indexOf(f)<0&&e.push(f),b.ranges?y(d,a,b.ranges,c):z(d,a,b.exclusiveRowIndexes,c))},a.prototype.clearPreview=function(){A(this,!0)},a.prototype.doUnfilter=function(a){this.if(a),this.onFiltered()},a.prototype.if=function(a){var b,c,d=this;d.Ce&&A(d,!1),b=d.getColumnIndex(a),b<0||(delete d.Ve[b],delete d.Fe[b],delete d.Ge[b],delete d.Ye[b],q(d),c=d.Je.indexOf(b),c>=0&&d.Je.splice(c,1))},a.prototype.onFiltered=function(){var a=this;0===a.$e&&a.cf("onFiltered",{rowIndexes:a.getFilteredRowIndexes(),isPreview:a.Ce})},a.prototype.getListener=function(){return this.Ze},a}(),b.GeneralSlicerData=n;function B(a){return a===f||a===e}function C(a){return typeof a}function D(a){return a?a.length:0}},"./src/plugins/sparkline/sparkline.entry.ts":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./src/plugins/sparkline/sparkline.ts"))},"./src/plugins/sparkline/sparkline.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/common/util/types.ts"),e=c("./src/common/util/colorhelper.ts"),f=c("./src/common/util/arrayhelper.ts"),g=d.j.Fa,h=e.pc.nc,i=e.pc.ec,j=f.k.Cb,b.Vd={},k=null,l=void 0,m=Math.floor,n=Math.PI,o=Math.sin,p=Math.cos,q=Math.min,r=Math.max,s=Math.round,t=Math.pow,u=Math.sqrt,v=Math.abs,w=Math.ceil,x="undefined",y="string",z=isNaN,A=parseFloat,B=Number.MAX_VALUE,C=new Date(""),D="#969696",E="#CB0000",F="#646464",G="#DCDCDC",H="white",I="black",J="blue",K="green",L="grey",M="red",N="lightgrey",O="left",P="right",Q="center",R="top",S="bottom",T="middle",U="start",V="px Arial",W="-",X="+",Y="=",Z=.05,$=.03,_=1.06,aa=.02,ba=4,ca=5,da=5,ea=3,fa=10,ga=8,ha=.8,ia=.25,ja=.9,ka=.7,la=.1,ma=1/45*n,na=function(){function a(a){this.x=a.x,this.y=a.y}return a}(),oa=function(){function a(a){this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height}return a}();function ya(a,b){return{x:a,y:b}}function za(a,b,c,d){return{x:a,y:b,width:c,height:d}}function Aa(a,b){var c,d,e,f=a[0],g=f&&f.value?f.value:f;for(d=1,e=a.length;d<e;d++)f=a[d],c=f&&f.value?f.value:f,(b&&g>c||!b&&g<c)&&(g=c);return g}function Ba(a,b,c,d,e,f,g){f&&(a.strokeStyle=f),g&&(a.lineWidth=g),a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.stroke()}function Ca(a,b,c,d,e,f,g){a.save(),f&&(a.strokeStyle=f),g&&(a.lineWidth=g),a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.closePath(),a.stroke(),a.restore()}function Da(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o;if(a.save(),i=[f,g],a.setLineDash)a.beginPath(),a.strokeStyle=h,a.setLineDash(i),a.stroke(),a.moveTo(b,c),a.lineTo(d,e),a.stroke();else{for(a.beginPath(),a.lineWidth=1,a.strokeStyle=h,j=u(t(d-b,2)+t(e-c,2)),k={x:(d-b)/j,y:(e-c)/j},l=0,m=0;l<j;)n=q(i[m%2],j-l),m++,o=m%2,l+=n,o&&a.moveTo(b,c),b+=n*k.x,c+=n*k.y,o&&a.lineTo(b,c);a.stroke()}a.restore()}function Ea(a,b,c,d,e,f,g,h,i,j,k,l){b?Ba(a,c,d,e,f,k,l):Ba(a,g,h,i,j,k,l)}function Fa(a,b,c,d,e,f,g,h){a.save(),g&&(a.fillStyle=g),a.textBaseline=h||S,a.beginPath(),a.font=e,a.textAlign=f,d="string"==typeof d?d:d+"",a.fillText(d,b,c),a.restore()}function Ga(a){return e.pc.dc(i(a))<127.5?H:I}function Ha(a,b,c,d,e,f,h,i){var j,k,l,m,n=i;return g(i)&&(n=e),h?(j=b+n+f,l=d-2*n,k=a+e,m=c-2*e):(j=a+n,l=c-2*n,k=b+e,m=d-2*e),{left:j,top:k,width:l,height:m}}function Ia(a,b){var c,d,e=0;for(c=0,d=a.length;c<d;c++)e+=b&&!b(a[c])?0:a[c];return e}function Ja(a){return a*n/180}function Ka(a,b,c,d){var e,f,g,h,i=[];for(f=0,g=0,h=a.length;f<h;f++)b?(b(a[f])?i[g]=c?c(a[f]):a[f]:i[g]=0,g++):(e=A(a[f]),!z(e)&&isFinite(e)&&(i[g]=e,g++));return d&&d(i),i}function La(a,b,c,d,e,f){var g=s(b+d),h=s(c+e);b=s(b),c=s(c),d=s(g-b),e=s(h-c),a.beginPath(),a.fillStyle=f,a.fillRect(b,c,d,e),a.fill()}function Ma(a,b,c){return a=q(a,b),a=r(a,c)}function Na(a,b,c,d,e){a.save(),a.rect(b,c,d,e),a.clip()}function Oa(a,b){var c,d,e,f;return!(!a||!b)&&(c=r(a.x+a.width,b.x+b.width),d=r(a.y+a.height,b.y+b.height),e=q(a.x,b.x),f=q(a.y,b.y),c-e<=a.width+b.width&&d-f<=a.height+b.height)}function Pa(a,b,c,d,e,f){var h,i,j,k,l,m,r=c+e/2,s=d+f/2,t=5,u=q(e,f)/2-t,w=-.5*n,x=r+u*p(w),y=s+u*o(w),A=[],B=[];if(!(u<=0)){for(i=Ka(b.values,function(a){return!g(a)&&!z(a)&&isFinite(a)},function(a){return v(a)},function(a){1===a.length&&(a[1]=1-a[0])}),j=i.length,k=Qa(j,b.colors),l=Ia(i),a.save(),m=0;m<j;m++)h=w+i[m]/l*2*n,a.beginPath(),a.moveTo(r,s),a.lineTo(x,y),a.arc(r,s,u,w,h,!1),a.lineTo(r,s),a.fillStyle=k[m],a.fill(),A.push(x),B.push(y),w=h,x=r+u*p(w),y=s+u*o(w);for(m=0;m<j;m++)Ba(a,r,s,A[m],B[m],H);a.restore()}}function Qa(a,b){var c,d,f,g,h,j,k=[],l=b.length;if(a<=l)k=b.slice(0,a);else{for(0===l?(k.push("darkgray"),l=1):k=b.slice(0),c=[],d=void 0,f=a-l+1,g=void 0,g=0;g<l;g++)c[g]=i(k[g]);for(g=l;g<a;g++){d=c[g%l];for(h in d)d.hasOwnProperty(h)&&(j=d[h],d[h]=m(j-j/f*(g/l)));d.a=255,k[g]=e.pc.bc(d)}}return k}pa=function(a){xa(b,a);function b(b){var c=a.call(this,ya(b.x,b.y))||this;return c.value=b.value,c}return b}(na);function Ra(a,b,c){return{x:a,y:b,value:c}}function Sa(a,b,c,d,e,f){var h,i,j,l,m,n,o,p,t,u,v,w,y,A,B,C,D,F,G,H,I,K,L,M,N,O,P,Q,R,S,T,U;for(a.save(),h=b.points,i=b.mini,j=b.maxi,l=b.line1,m=b.line2,n=b.colorPositive,o=b.colorNegative,p=5,h=Ka(h,function(a){return!g(a)&&!z(a)&&isFinite(a)}),n=g(n)?"#787878":n,o=g(o)?E:o,G=Aa(h,!1),j=g(j)?G:j,u=r(j,G),H=Aa(h,!0),i=g(i)?H:i,t=q(i,H),t=t>0?0:t,u=u<0?0:u,v=0,v=v>u?u:v,v=v<t?t-1:v,w=h.length,I=Ha(c,d,e,f,p),y=I.left,A=I.top,B=I.width,C=I.height,D=B/(w-1),F=(u-t)/C,K=[],P=A+(u-v)/F,S=0;S<w;S++)L=h[S],Q=y+D*S,R=A+(u-L)/F,0===S&&K.push(new pa(Ra(Q,P,v))),S>0&&L*h[S-1]<0&&(N=K[K.length-1],N&&(O=Ta(N.x,N.y,Q,R,P),K.push(new pa(Ra(O,P,v))))),K.push(new pa(Ra(Q,R,L))),S===w-1&&K.push(new pa(Ra(Q,P,v)));for(a.beginPath(),T=0,U=K.length;T<U;T++)M=K[T],M&&(0===T?a.moveTo(M.x,M.y):a.lineTo(M.x,M.y),N=K[T-1],M.value===v&&N&&(a.fillStyle=N.value>v?n:o,a.fill(),T!==U-1&&(a.beginPath(),a.moveTo(M.x,M.y))));V(l),V(m),a.restore();function V(b){var c,d,e;b===k&&typeof b!==x||(c=Ma(b,u,t),d=0!==F?(u-c)/F:C/2,e=s(A+d)-.5,Ba(a,y,e,y+B,e,J))}}function Ta(a,b,c,d,e){return((b-e)*c+(e-d)*a)/(b-d)}function Ua(a,b,c,d,e,f){var h,i,j,k,l,m,o,p,t,u,v,w,x,y,z,A,C,F,H,I,J,K,L,M,N,O,P=b.points1,Q=b.points2,R=b.minX,S=b.maxX,T=b.minY,U=b.maxY,V=b.hLine,W=b.vLine,X=b.xMinZone,Y=b.xMaxZone,Z=b.yMinZone,$=b.yMaxZone,_=b.tags,aa=b.drawSymbol,ba=b.drawLines,ca=b.color1,da=b.color2,ea=b.dash,fa=4,ga=Ha(c,d,e,f,5),ha=ga.left,ia=ga.top,ja=ga.width,ka=ga.height;function la(b,c,d,e){p=b[c],u=p.x,v=p.y,p=b[c+1],w=p.x,x=p.y,y=ha+(u-l)*ja/(m-l),A=ha+(w-l)*ja/(m-l),z=ia+(k-v)*ka/(k-j),C=ia+(k-x)*ka/(k-j),ba&&Xa(a,y,z,A,C,d,ea),aa&&(0===c&&e(y,z),e(A,C))}function ma(a,b,c,d,e){var f=Va(a,!0),h=Va(a,!1);j=g(T)?f.y:b,k=g(U)?h.y:c,l=g(R)?f.x:d,m=g(S)?h.x:e,m=l>=m?l+1:m,k=j>=k?j+1:k}function na(b,c,d){a.beginPath(),a.arc(b-fa/2,c-fa/2,fa/2,0,2*n,!1),a.fillStyle=d,a.fill()}function oa(b,c){a.beginPath(),a.strokeStyle=ca,a.arc(b-fa/2,c-fa/2,fa/2,0,2*n,!1),a.stroke()}function pa(b,c){a.beginPath(),a.strokeStyle=da,a.strokeRect(b-fa/2,c-fa/2,fa,fa)}if(P&&!(P.length<=0)&&(h=Ya(P),!(h.length<=0||Q&&Q.length>0&&(i=Ya(Q),i.length<=0)))){for(Na(a,c,d,e,f),a.beginPath(),aa=!!g(aa)||aa,ca=g(ca)?D:ca,da=g(da)?E:da,ma(h,T,U,R,S),!g(X)&&!g(Y)&&!g(Z)&&!g($)&&l<=X&&X<=m&&l<=Y&&Y<=m&&j<=Z&&Z<=k&&j<=$&&$<=k&&(L=r(l,X),M=q(m,Y),N=r(j,Z),O=q(k,$),L>=M&&(M=L+1),N>=O&&(O=N+1),La(a,ha+(L-l)*ja/(m-l),ia+(k-O)*ka/(k-j),(M-L)*ja/(m-l),(O-N)*ka/(k-j),G)),F=-B,H=-B,I=B,J=B,t=h.length,o=0;o<t-1;o++)la(h,o,ca,oa),_&&(0===o&&(z>H&&(F=y,H=z),z<J&&(I=y,J=z)),C>H&&(F=A,H=C),C<J&&(I=A,J=C));if(i&&i.length>0)for(ma(i,j,k,l,m),t=i.length,o=0;o<t-1;o++)la(i,o,da,pa);_&&(na(F,H,E),na(I,J,"#0000FF")),!g(V)&&j<=V&&V<=k&&(K=s(ia+(k-V)*ka/(k-j))-.5,Xa(a,ha,K,ha+ja,K,E)),!g(W)&&l<=W&&W<=m&&(K=s(ha+(W-l)*ja/(m-l))-.5,Xa(a,K,ia,K,ia+ka,E)),a.restore()}}function Va(a,b){var c,d,e=b?1:-1,f=b?q:r,g=new na(ya(e*B,e*B)),h=a.length;for(d=0;d<h;d++)c=a[d],g.x=f(g.x,c.x),g.y=f(g.y,c.y);return g}function Wa(a,b,c,d){return c/d*(b-a)+a}function Xa(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,v,w,x,y,z;if(g){for(h=u(t(d-b,2)+t(e-c,2)),i=0,j=6,k=2,l=4,m=[],n=void 0,o=void 0,p=void 0,q=void 0,b<=d?(n=b,o=d,p=b,q=c):(n=d,o=b,p=d,q=e),r=(e-c)/(d-b),s=c-r*b,m.push(new na(ya(p,q))),v=[j,l,k,l];i<h;)for(w=0,x=v.length;w<x;w++)i+=v[w],i<=h&&(p=Wa(n,o,i,h),q=r*p+s,m.push(new na(ya(p,q))));for(y=0,z=m.length;y<z-1;y+=2)Ba(a,m[y].x,m[y].y,m[y+1].x,m[y+1].y,f)}else Ba(a,b,c,d,e,f)}function Ya(a){var b,c,d,e=[],f=a.length;if(f>0)if(b=a[0].length,f<b){if(f>=2)for(c=0;c<b;c++)e.push(new na(ya(a[0][c],a[1][c])))}else if(b>=2)for(d=0;d<f;d++)e.push(new na(ya(a[d][0],a[d][1])));return e}function Za(a,b,c,d,e,f){var i,j,k,l,n,o,p,q,t,u,v,w,x,y,A,B,C,D=b.measure,G=b.target,H=b.maxi,I=b.good,J=b.bad,K=b.forecast,L=b.tickUnit,M=b.colorScheme,N=b.vertical,O=5,P=b.measureColor,Q=b.targetColor,R=b.maxiColor,S=b.goodColor,T=b.badColor,U=b.forecastColor,V=b.allowMeasureOverMaxi,W=b.barSize;function X(b,g,h,i,j){var m,n,o;a.fillStyle=b,m=k,n=l*(g/h),n>l&&!V&&(n=l),o=new oa(N?za(c+e*i,m-n,e*j,n):za(m,d+f*i,n,f*j)),a.fillRect(o.x,o.y,o.width,o.height)}if(!(g(H)||H<0)&&(g(W)||!(z(W)||W<=0))){if(W>1&&(W=1),D=g(D)||D<0?0:D,I=g(I)||I<0?0:I,J=g(J)||J<0?0:J,G=g(G)?0:G,K=g(K)?0:K,L=g(L)?0:L,M=g(M)?"#A0A0A0":M,i=g(P)?"#252525":P,D>H&&!V&&(D=H,i=E),I>H&&(I=H,i=E),J>H&&(J=H,i=E),G>H&&(G=0,i=E),K>H&&(K=H,i=E),j=Ha(c,d,e,f,O,f-2*O,N),k=j.left,l=j.width,a.save(),n=g(W)?.2:(1-W)/2,o=g(W)?.6:W,p=V?r(H,D):H,X(g(R)?h(M,1.66):R,H,p,n,o),X(g(S)?h(M,1.33):S,I,p,n,o),X(g(T)?M:T,J,p,n,o),q=.25*W/.6,t=g(W)?.375:(1-q)/2,u=g(W)?.25:q,X(i,D,p,t,u),K>0&&(v=k,w=l*(K/p),w>l&&(w=l),x=g(W)?3:3*W/.6,Ea(a,N,c+.5*e,v,c+.5*e,v-w,v,d+.5*f,v+w,d+.5*f,g(U)?"#3690BF":U,x)),G>0&&(y=s(k-(N?1:-1)*l*(G/p))-.5,
Ea(a,N,c+e*n,y,c+e*(1-n),y,y,d+f*n,y,d+f*(1-n),g(Q)?E:Q,1)),L>0)for(A=m(p/L),B=void 0,C=0;C<=A;C++)B=s(k-(N?1:-1)*(l/p*L)*C)-.5,Ea(a,N,c,B,c+.05*e,B,B,d+f,B,d+.95*f,F,1);a.restore()}}function $a(a,b,c,d,e,f){var h,i,j,k,l,m,n,o,p,t,u,v,w,x,y,z,A,B,C,D,G,H,I=b.spreadData,J=b.showAverage,K=b.scaleStart,L=b.scaleEnd,M=b.style,N=b.colorScheme,O=b.vertical,P=5,Q=I.length;if(!(Q<=0)){for(h=I[0].key,i=I[Q-1].key,K=g(K)?h:K,L=g(L)?i:L,M=g(M)?4:M,N=g(N)?F:N,j=Ha(c,d,e,f,P,f-2*P,O),k=j.left,l=j.width,m=j.top,n=j.height,Na(a,c,d,e,f),a.beginPath(),a.strokeStyle=N,a.fillStyle=N,a.lineWidth=2,t=Aa(I,!1),v=0,w=I.length;v<w;v++)if(x=I[v],y=x.key,z=x.value,o=k+(O?-1:1)*l*(y-K)/(L-K),O?(o=q(o,k),o=r(o,k-l)):(o=r(o,k),o=q(o,k+l)),o=s(o),1===M)u=z/2*n/t,u=u<.5?.5:u,A=m+n/2-u,B=m+n/2+u,Ea(a,O,A,o,B,o,o,A,o,B);else if(4===M)u=z*n/t,u=u<1?1:u,Ea(a,O,m,o,m+u,o,o,m+n,o,m+n-u);else if(6===M)Ea(a,O,m,o,m+n,o,o,m,o,m+n);else for(C=2,D=1;D<=z;D++){switch(M){case 2:p=m+n/2-P-(z/2-D)*n/t;break;case 3:G=_a(z,n,C+1,x.randomNumbers),p=m+n-P-G[D-1];break;case 5:default:p=m+n-D*n/t}p=s(p),a.beginPath(),a.fillRect(O?p:o,O?o:p,C,C)}J&&(H=ab(I),o=k-(O?1:-1)*l*(H-K)/(L-K),Ea(a,O,m-P,o,m+n+P,o,o,m-P,o,m+n+P,E)),a.restore()}}function _a(a,b,c,d){for(var e,f=[],g=r(100,10*a),h=0,i=[],j=0;f.length<a;)e=m(d[j]*b),j++,(h>g||bb(e,i))&&(f.push(e),i.push([e-c,e+c])),h++;return f}function ab(a){var b,c,d,e=0,f=0;for(b=0,c=a.length;b<c;b++)d=a[b],f+=d.value,e+=d.key*d.value;return 0===f?0:e/f}function bb(a,b){var c,d,e;for(c=0,d=b.length;c<d;c++)if(e=b[c],e[0]<=a&&a<=e[1])return!1;return!0}function cb(a,b,c,d,e,f,i){var j,m,n,o,p,q,r,t,u,v,w,x,y,A,B,C,D,G,H=b.points,I=H&&H.length,L=b.colorRange,N=b.labelRange,O=b.maximum,P=b.targetRed,R=b.targetGreen,S=b.targetBlue,U=b.targetYellow,W=b.color,X=b.highlightPosition,Y=b.vertical,Z=b.textOrientation,$=b.textSize,_=5;function aa(b,c,d){var e,f;c!==k&&c!==l&&(c=c>O?O:c,d&&!d(c)||(c=c<0?0:c,f=c/O*p,Y?(e=s(o-f)-.5,Ba(a,q,e,q+r,e,b)):(e=s(o+f)-.5,Ba(a,e,q,e,q+r,b))))}if(!(g(H)||I<=0)){if(W=g(W)?F:W,g(L)||L.length!==I||db(L))for(L=[],j=0;j<I;j++)L.push(h(W,1+j/I));for(m=Ia(H,function(a){return a>0}),O=g(O)||O<m?m:O,Z=g(Z)?0:Z,$=g($)||$<=0?10:$,$=z($)?$:$*i.zoomFactor,n=Ha(c,d,e,f,_,f-2*_,Y),o=n.left,p=n.width,q=n.top,r=n.height,a.save(),t=o,B=0,C=I;B<C;B++)A=H[B],A<=0||(u=A/O*p,Y?(v=c+.15*e,x=.7*e,w=t-u,y=u):(v=t,x=u,w=d+.15*f,y=.7*f),D=B+1===X?E:L[B],a.save(),a.fillStyle=D,a.fillRect(v,w,x,y),G=N&&N[B],G&&(a.save(),a.fillStyle=Ga(D),a.textBaseline=T,a.textAlign=Q,a.font=$+V,a.rect(v,w,x,y),a.clip(),1===Z?(a.translate(v+x/2,w),a.rotate(Math.PI/2),a.fillText(G,y/2,0)):a.fillText(G,v+x/2,w+y/2),a.restore()),t+=(Y?-1:1)*u,a.restore());aa(M,P,function(a){return a>0}),aa(K,R),aa(J,S),aa("yellow",U),a.restore()}}function db(a){for(var b=0,c=a.length;b<c;b++)if(g(a[b]))return!0;return!1}function eb(a,b,c,d,e,f){Ba(a,hb(b),hb(c),hb(d),hb(e),g(f)?I:f,1)}function fb(a,b,c,d,e){var f,g,h,i,j,k=.4*d;switch(b=hb(b),c=hb(c),a.beginPath(),a.moveTo(b,c),f=k/2,g=u(3)*k/2,h=k/u(3),e){case 0:i=[-f,0,f],j=[g,h,g];break;case 2:i=[-f,0,f],j=[-g,-h,-g];break;case 3:i=[g,h,g],j=[-f,0,f];break;case 1:i=[-g,-h,-g],j=[-f,0,f];break;default:i=[],j=[]}i.forEach(function(d,e){a.lineTo(hb(b+d),hb(c+j[e]))}),a.lineTo(b,c),a.closePath(),a.fillStyle=H,a.fill()}function gb(a,b,c,d,e,f,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,w,x=c.value,y=c.colorScheme,B=c.axisVisible,C=c.barHeight,D=c.barWidth,E=5,F=5,G=!1,H=A(x);if(!z(H)){if(o=0===a?C:D,g(o))p=.7;else{if(z(o)||o<=0)return;p=Math.min(1,o)}H>1?(H=1,G=!0):H<-1&&(H=-1,G=!0),y=g(y)?"grey":y,B=!!g(B)||B,b.save(),0===a?(q=f-2*E,r=h*p,H>=0?(G&&(i=new na(ya(d+E+q-F,e+h/2))),j=new oa(za(d+E,e+h*(1-p)/2,q*H,r)),k=new na(ya(d+E,e+1)),l=new na(ya(d+E,e+h)),m=1):(s=v(q*H),G&&(i=new na(ya(d+E+F,e+h/2))),j=new oa(za(d+f-E-s,e+h*(1-p)/2,s,r)),k=new na(ya(d+f-E,e+1)),l=new na(ya(d+f-E,e+h)),m=3),n=g(o)?h:h*p):1===a&&(t=h-2*E,u=f*p,H>=0?(w=t*H,j=new oa(za(d+(1-p)/2*f,e+h-E-w,u,w)),G&&(i=new na(ya(d+f/2,e+h-E-w+F)),m=0),k=new na(ya(d+1,e+h-E)),l=new na(ya(d+f,e+h-E))):(H=v(H),j=new oa(za(d+(1-p)/2*f,e+E,u,t*H)),G&&(i=new na(ya(d+f/2,e+E+t-F)),m=2),k=new na(ya(d+1,e+E)),l=new na(ya(d+f,e+E))),n=g(o)?f:f*p),b.beginPath(),j&&(La(b,j.x,j.y,j.width,j.height,y),Na(b,j.x,j.y,j.width,j.height)),i&&fb(b,i.x,i.y,n,m),b.restore(),B&&k&&eb(b,k.x,k.y,l.x,l.y),b.restore()}}function hb(a){return s(a)-.5}function ib(a,b,c,d,e,f){gb(0,a,b,c,d,e,f)}function jb(a,b,c,d,e,f){gb(1,a,b,c,d,e,f)}function kb(a,b,c,d,e,f,h){var i,j,k,l,m,n,o,p,q,r,s,t,w,x,y,B,C,F,G,H,J,L=b.variance,N=b.reference,U=b.mini,W=b.maxi,X=b.mark,Y=b.tickUnit,Z=b.legend,$=b.colorPositive,_=b.colorNegative,aa=b.vertical,ba=.5,ca=.5-ba/2,da=5,ea=E,fa=D,ga=13*h.zoomFactor,ha=A(L);function ia(b,g,h,j,k,l,o,q,r,s,t,v,w,z){var A,B,C,D,E,F;aa?(A=c+ca*e,B=0===g?x-y:x,C=e*ba,D=y,La(a,A,B,C,D,b)):(A=0===g?x:x-y,B=d+ca*f,C=y,D=f*ba,La(a,A,B,C,D,b)),p&&(Na(a,A,B,C,D),aa?fb(a,c+e/2,i+h,n,k):fb(a,i+j,d+f/2,n,l),a.restore()),Z&&(E=void 0,F=0,p&&(F=.4*n*u(3)/2+da+2),a.save(),a.beginPath(),a.font=ga+V,a.fillStyle=I,aa?(a.textAlign=Q,E=ga+y+o,ja(E,z,b,q,r,A,B,C,D,aa),a.fillText(m,c+e/2,x+w*(y-F))):(a.textBaseline=T,E=a.measureText(m).width+y+s,ja(E,z,b,t,v,A,B,C,D,aa),a.fillText(m,x+w*(F-y),d+f/2)),a.restore())}function ja(b,c,d,e,f,g,h,i,j,k){k?a.textBaseline=e:a.textAlign=e,b>0&&c<y&&(a.rect(g,h,i,j),a.clip(),k?a.textBaseline=f:a.textAlign=f,a.fillStyle=Ga(d))}function ka(b,c,d,e,f,g,h,i,j,k){aa?eb(a,b,c,d,e,j):eb(a,f,g,h,i,k)}if(!(z(ha)||(_=g(_)?M:_,$=g($)?K:$,Y=g(Y)?0:Y,W=g(W)?1:W,U=g(U)?-1:U,o=!g(N),o||(N=0),aa?(i=d+f-da,j=f-2*da,k=e-4*da,l=-1):(i=c+da,j=e-2*da,k=f-4*da,l=1),Z&&(q=A(b.variance),z(q)||(r=""+q,s=r.substr(r.indexOf(".")+1).length,m=s>=2?(100*q).toFixed(s-2)+"%":(100*q).toFixed(0)+"%")),ha>W&&(ha=W,p=!0),ha<U&&(ha=U,p=!0),N=Ma(N,W,U),p&&(n=Ma(k,60,15)),t=v(W-U),w=j/t,x=i+l*v(U-N)*w,y=v(ha-N)*w,y>v(t)*w&&(y=v(t+U)*w),B=i+l*j,aa&&x<B||!aa&&x>B))){if(Na(a,c,d,e,f),ha>N?ia($,0,da-j,j-da,0,1,d-x,S,R,x-c-e,O,P,-1,v(W-ha)*w):(y>v(t)*w&&(y=v(t+U)*w,x=i),ia(_,1,-da,da,2,3,x-d-f,R,S,c-x,P,O,1,v(U-ha)*w)),o&&(C=i+l*(Math.abs(U-N)*w),ka(c,C,c+e,C,C,d,C,d+f)),Y>0)for(a.beginPath(),F=t/Y,G=0;G<=F;G++)H=i+j/F*G*l,ka(c,H,c+.1*e,H,H,d+.9*f,H,d+f,fa,fa);!g(X)&&U<=X&&X<=W&&(a.beginPath(),J=i-(aa?1:-1)*v(U-X)*w,ka(c,J,c+.33*e,J,J,d+.66*f,J,d+f,ea,ea),a.fill()),a.restore()}}qa="7ns",ra="5ns",sa="tukey",ta="bowley",ua="sigma3";function lb(a,b,c,d,e,f){var h,i,j,l,m,n,o,p,s,t,u,w,x,B,C,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,va,wa,xa=b.points,ya=b.boxPlotClass,za=b.showAverage,Ba=b.scaleStart,Ca=b.scaleEnd,Da=b.acceptableStart,Fa=b.acceptableEnd,Ga=b.style,Ja=b.colorScheme,Ma=b.vertical,Oa=5,Pa=Aa(xa,!1),Qa=Aa(xa,!0);function Ra(b,c,d,e,f,g,h,i,j){Ma?La(a,c,d,e,f,b):La(a,g,h,i,j,b)}function Sa(b,c,d,e){Ea(a,Ma,T+U*b,d,T+U*c,d,d,T+U*b,d,T+U*c,e)}if(!(g(xa)||(xa=Ka(xa),xa.length<=0))){for(ya=ya===k||typeof ya!==y?ra:ya.toLocaleLowerCase(),ya!==ra&&ya!==qa&&ya!==sa&&ya!==ta&&ya!==ua&&(ya=ra),h=A(Ba),h=z(h)?Qa:h,i=A(Ca),i=z(i)?Pa:i,j=A(Da),l=A(Fa),Ja!==k&&typeof Ja===y||(Ja="#D2D2D2"),(Ga===k||0!==Ga&&1!==Ga)&&(Ga=0),m=E,h>Qa&&(Ja=m,h=Qa),i<Pa&&(Ja=m,i=Pa),Na(a,c,d,e,f),a.lineWidth=2,n=Ha(c,d,e,f,Oa,f-2*Oa,Ma),o=n.left,p=n.width,s=n.top,t=n.height,u=Ma?-1:1,w=b.perc02,x=b.perc09,B=b.perc10,C=b.perc90,G=b.perc91,H=b.perc98,I=b.q1,J=b.q3,K=J-I,L=Qa,M=Pa,N=1.5*K,O=1.5*K,P=b.stDev,Q=Ia(xa)/r(1,xa.length),R=0,S=0,T=s+.1*t,U=.7*t,V=v(i-h),W=0,X=xa.length;W<X;W++)Y=xa[W],Y<I&&Y>=I-1.5*K&&Y-(I-1.5*K)<N&&(N=Y-(I-1.5*K),L=Y),Y>J&&Y<=J+1.5*K&&J+1.5*K-Y<O&&(O=J+1.5*K-Y,M=Y),Z=!1,R=o+u*(p*((Y-h)/V)),ya===sa&&(Y<=I-1.5*K||Y>=J+1.5*K)&&(Z=!0,S=Y<=I-3*K||Y>=J+3*K?0:1),ya===qa&&(Y<=w||Y>=H)&&(Z=!0,S=1),ya===ua&&(Y<=Q-2*P||Y>=Q+2*P)&&(Z=!0,S=Y<=Q-3*P||Y>=Q+3*P?0:1),$=D,Z&&(1===Ga?1===S?Sa(.2,.8,R,$):Sa(.3,.7,R,$):(_=.1*t,_<2&&(_=2),a.beginPath(),a.strokeStyle=$,aa=s+.45*t,ba=R,a.arc(Ma?aa:ba,Ma?ba:aa,_/2,0,2*Math.PI),a.stroke()));switch((h>j||i<l)&&(Ja="#C0FF00"),j=r(h,j),l=q(i,l),j>l?Ja=m:j<l&&(ca=o+u*(p*((j-h)/V)),da=o+u*(p*((l-h)/V)),ea=s+.9*t,Ea(a,Ma,ea,ca,ea,da,ca,ea,da,ea,F)),fa=o+u*(p*((I-h)/V)),ga=v(o+u*(p*((J-h)/V))-fa),ha=b.median,ia=o+u*(p*((ha-h)/V)),ya){case qa:la=w,ma=H;break;case sa:la=L,ma=M;break;case ua:fa=o+u*(p*((Q-P-h)/V)),ga=v(o+u*(p*((Q+P-h)/V))-fa),ia=o+u*(p*((Q-h)/V)),na=Q-2*P,la=na>h?na:Qa,na=Q+2*P,ma=na<i?na:Pa,za=!1;break;case ra:case ta:default:la=Qa,ma=Pa}ja=o+u*(p*((la-h)/V)),ka=o+u*(p*((ma-h)/V)),oa=D,1===Ga?Ra("#F2F2F2",T,ka,U,ja-ka,ja,T,ka-ja,U):(pa=s+.45*t,Ea(a,Ma,pa,ja,pa,ka,ja,pa,ka,pa,oa)),Ra(Ja,T,fa-ga,U,ga,fa,T,ga,U),Ea(a,Ma,T,ia,T+U,ia,ia,T,ia,T+U,oa),0===Ga&&(Ea(a,Ma,T+.3*U,ka,T+.7*U,ka,ka,T+.3*U,ka,T+.7*U,oa),Ea(a,Ma,T+.3*U,ja,T+.7*U,ja,ja,T+.3*U,ja,T+.7*U,oa)),ya!==qa&&ya!==ta||(va=void 0,wa=void 0,ya===qa?(la=x,ma=G):(la=B,ma=C),va=o+u*(p*((la-h)/V)),wa=o+u*(p*((ma-h)/V)),Sa(.3,.7,wa,oa),Sa(.3,.7,va,oa)),za&&(R=o+u*(p*((Q-h)/V)),Sa(.2,.8,R,m)),a.restore()}}function mb(a,b,c,d,e){b=s(b),c=s(c),d=s(d),e=s(e),b===d&&(d-=.5,b=d),c===e&&(e-=.5,c=e),a.moveTo(b,c),a.lineTo(d,e)}function nb(a,b,c,d,e,f,g,h,i,j,k){a.beginPath(),a.strokeStyle=c,b?mb(a,d,e,f,g):mb(a,h,i,j,k),a.stroke()}function ob(a,b,c,d,e){a.rect(b,c,d,e),a.clip()}function pb(a,b,c,d,e,f){var h,i,j,k,l,m,n,o=f.labelText,p=f.fontSize,q=f.startBox,r=f.endBox,s=f.boxColor,t=f.isInRightOrTopOfBox,u=f.fillStyle;a.save(),a.beginPath(),a.font=p+V,k=1,u=g(u)?I:u,f.vertical?(l=Q,t?(h=p+r-(q-c),h>0&&q-r-c<r?(m=R,u=Ga(s),j=q-r+k,ob(a,b,q-r,d,r)):(m=S,j=q-r-k)):(h=p-(c+e-q),h>0&&c+e-q<r?(ob(a,b,q-r,d,r),m=S,u=Ga(s),j=q-k):(m=R,j=q+k)),a.textAlign=l,a.textBaseline=m,a.fillStyle=u,a.fillText(o,b+d/2,j)):(m=T,n=a.measureText(o),t?(h=n.width+r-(b+d-q),h>0&&b+d-(q+r)<r?(ob(a,q,c,r,e),l=P,u=Ga(s),i=q+r-k):(l=O,i=q+r+k)):(h=n.width-(q-b),h>0&&q-b<r?(ob(a,q,c,r,e),i=q+k,l=O,u=Ga(s)):(l=P,i=q-k)),a.textAlign=l,a.textBaseline=m,a.fillStyle=u,a.fillText(o,i,c+e/2)),a.restore()}function qb(a,b,c,d,e,f,i){var j,l,m,n,o,p,s,t,u,w,x,B,C,D,E,F,H,J,K,L,M,N,O,P,Q,R,S,T,U,V,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa=b.points,pa=b.labels,qa=b.pointIndex,ra=b.minimum,sa=b.maximum,ta=b.colorPositive,ua=b.colorNegative,va=b.vertical,wa=b.itemTypeRange,xa=b.colorTotal,ya=5,za=13*i.zoomFactor;if(!(g(oa)||(j=oa.length,j<=0||(l=parseInt(qa,10),z(l)||l<=0||l>j)))){for(pa=g(pa)?[]:pa,ta!==k&&typeof ta===y||(ta="#8CBF64"),ua!==k&&typeof ua===y||(ua="#D6604D"),typeof xa!==y&&(xa=k),m=ta,n=h(ta,1.3),o=ua,p=h(ua,1.3),s=1,t=0,u=0,w=0,x=0,B=[],C=0,D=0,F=0,H=j;F<H;F++)D=oa[F],E=wa[F],J=!1,K=1===s,L=!g(E),L&&(E===X?D=v(D):E===W?D=-v(D):E===Y?(J=!0,K?t=D:D=t):L=!1),B[s]=[],M=B[s],z(D)?(M[0]=0,M[1]=t,M[2]=0):(M[0]=v(D),t=J?t:D+t,M[1]=D>0?u:t,M[2]=D),M[3]=s,w=q(u,w),x=r(u,x),N=s===j,(N&&!L||J)&&(C=w<0?-w:0,M[1]=D>0?0:D),L&&J&&!K||(u=D+u,N&&L&&(w=q(u,w),x=r(u,x))),s++;O=!1,g(E)||(P=[W,X,Y],O=P.indexOf(E)===-1),(g(E)||O)&&(t-=D),S=A(ra),z(S)||S>0||S>w?(Q=w,S=w):(Q=S,C=-S),T=A(sa),z(T)||T<0||T<x?R=x:(R=T,C=-S),U=Ha(c,d,e,f,ya,f-2*ya,va),V=U.left,Z=U.width,$=U.top,_=U.height,aa=va?-1:1,ba=R-Q,ca=Z/ba,Na(a,c,d,e,f),a.beginPath(),a.lineWidth=1,da=B[l],ea=da[2],fa=wa[l-1],ga=V+aa*(da[1]+C)*ca,ha=da[0]*ca,ja=fa===Y,ka=(g(fa)||O)&&l===j||ja,ia=xa&&ka?xa:1===l||ka?ea>=0?m:o:ea>=0?n:p,va?La(a,$,ga-ha,_,ha,ia):La(a,ga,$,ha,_,ia),va?(1!==l&&(l!==j?nb(a,ea>0,G,c,ga,$+_,ga,c,ga-ha,$+_,ga-ha):(la=V-(t+C)*ca,nb(a,!0,G,c,la,$+_,la))),l!==j&&nb(a,ea>0,G,$,ga-ha,c+e,ga-ha,$,ga,c+e,ga)):(1!==l&&(l!==j?nb(a,ea>0,G,ga,d,ga,$+_,ga+ha,d,ga+ha,$+_):(ma=V+(t+C)*ca,nb(a,!0,G,ma,d,ma,$+_))),l!==j&&nb(a,ea>0,G,ga+ha,$,ga+ha,d+f,ga,$,ga,d+f)),na=pa[l-1],pa.length>0&&!g(na)&&""!==na&&pb(a,c,d,e,f,{labelText:na,vertical:va,isInRightOrTopOfBox:ea>0,fontSize:za,startBox:ga,endBox:ha,boxColor:ia}),nb(a,va,I,c,V-C*ca,c+e,V-C*ca,V+C*ca,d,V+C*ca,d+f),a.restore()}}function rb(a,b,c,d,e,f,h){var i,j,k,l,m,n,o,p,q,r,t,u,v,x,B,C,F,G,H,I,J,K,L,M,N,O,P,Q=b.points,R=b.pointIndex,S=b.colorRange,T=b.target,U=b.target2,V=b.highlightPosition,W=b.label,X=b.vertical,Y=13*h.zoomFactor,Z=b.targetColor,$=b.target2Color,_=b.labelColor,aa=b.barSize;function ba(a){var b=A(a);return b=z(b)?0:b,b=b<0?0:b,b=b>1?1:b}if(!g(Q)&&(g(aa)||!(z(aa)||aa<=0))&&(aa>1&&(aa=1),i=Q.length,!(i<=0||(j=parseInt(R,10),z(j)||j<=0||j>i)))){for(S=g(S)?[]:S,k=parseInt(W,10),k=z(k)?0:k,l=1,m=0,n=[],o=0,p=Q.length;o<p;o++)q=Q[o],n[l]=[],r=n[l],q<0||z(q)||g(q)?(r[0]=1===l?0:m,r[1]=0):(m+=q,r[0]=1===l?0:m-q,r[1]=q),l++;u=5,t=g(aa)?u:X?e*(1-aa)/2:f*(1-aa)/2,v=Ha(c,d,e,f,t,f-2*u,X,u),x=v.left,B=v.width,C=v.top,F=v.height,G=X?-1:1,H=B/m,Na(a,c,d,e,f),a.beginPath(),a.lineWidth=1,I=n[j],J=I[1],K=x+G*I[0]*H,L=I[1]*H,M=j===V?E:0===S.length||typeof S[j-1]!==y?D:S[j-1],X?La(a,C,K-L,F,L,M):La(a,K,C,L,F,M),1===k?N=(I[0]+J)/m*1e3:2===k&&(N=J/m*1e3),O=s(N)/10+"%",1!==k&&2!==k||""===O||pb(a,c,d,e,f,{labelText:O,vertical:X,isInRightOrTopOfBox:(I[0]+I[1])*H<B/2,fontSize:Y,startBox:K,endBox:L,boxColor:M,fillStyle:_}),P=[g(Z)?"#8CBF64":Z,g($)?"#EE5D5D":$],[T,U].forEach(function(b,g){var h=ba(b),i=w(x+G*B*h);nb(a,X,P[g],c,i,c+e,i,i,d,i,d+f)}),a.restore()}}function sb(a,b){switch(b){case 2:var c=a%4===0&&a%100!==0||a%400===0;return c?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function tb(a,b,c){var d,e,f,g,h,j;return a<0&&(a=0),a>1&&(a=1),d=i(b),e=i(c),f=d.a*(1-a)+e.a*a,g=d.r*(1-a)+e.r*a+"",h=d.g*(1-a)+e.g*a+"",j=d.b*(1-a)+e.b*a+"","rgba("+parseInt(g,10)+","+parseInt(h,10)+","+parseInt(j,10)+","+A(f/255+"")+")"}function ub(a,b,c){return a===b&&a===c?1:a<=b?0:a>=c?1:(a-b)/(c-b)}function vb(a,b,c,d,e,f){var g=(f+e)/2;return e<=d&&d<=g?tb(ub(d,e,g),a,b):tb(ub(d,g,f),b,c)}function wb(a){var b=B,c=-B;return a.forEach(function(a){a!==k&&a!==l&&(b>a&&(b=a),c<a&&(c=a))}),{min:b,max:c}}function xb(a,b,c,d,e,f,g){var h,i,j;d?a.forEach(function(a,e){0!==a&&a!==k&&a!==l&&(b[c+e]=d[e]||b[c+e])}):(h=wb(a),i=h.min,j=h.max,a.forEach(function(a,d){0!==a&&a!==k&&a!==l&&(b[c+d]=vb(e,f,g,a,i,j))}))}function yb(a,b,c,d,e,f){var g,h,i,j,k=b.year,l=b.month,m=b.values,n=b.emptyColor||"lightgray",o=b.startColor,p=b.middleColor,q=b.endColor,r="white",s=6,t=7,u=2,v=(e-(s+1)*u)/s,w=(f-(t+1)*u)/t,x=[],y=new Date(k,l-1,1).getDay();for(g=0;g<s*t;g++)g<y?x[g]=r:g<y+sb(k,l)?x[g]=n:x[g]=r;for(xb(m,x,y,b.colors,o,p,q),a.save(),a.rect(c,d,e,f),a.clip(),a.beginPath(),h=0,i=0;i<s;i++)for(j=0;j<t;j++)a.fillStyle=x[h],h++,a.fillRect(c+i*v+(i+1)*u,d+j*w+(j+1)*u,v,w);a.restore()}function zb(a){var b,c=a.getFullYear(),d=a.getMonth(),e=a.getDate();for(b=1;b<d+1;b++)e+=sb(c,b);return e}function Ab(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=b.year,G=b.values,H=b.emptyColor||"lightgray",I=b.startColor,J=b.middleColor,K=b.endColor,L="white",M=7,N=parseInt(366/M+"",10)+2,O=[],P=new Date(F,0,1).getDay(),Q=zb(new Date(F,11,31));for(h=0;h<N*M;h++)h<P?O[h]=L:h<P+Q?O[h]=H:O[h]=L;for(xb(G,O,P,b.colors,I,J,K),a.save(),a.rect(c,d,e,f),a.clip(),i=g.zoomFactor,j=15*i,k=c+j,l=d,m=e-j,n=f,a.save(),a.translate(c+j/2,l+n),a.rotate(-Math.PI/2),a.font=13*i+V,a.fillStyle="black",a.textBaseline="middle",a.textAlign="center",a.fillText(F+"",n/2,0),a.restore(),o=2,p=(m-(N+1)*o)/N,q=(n-(M+1)*o)/M,r=0,v=[],t=0;t<N;t++)for(s=0;s<M;s++)u={x:k+t*p+(t+1)*o,y:l+s*q+(s+1)*o,w:p,h:q},v[r]=u,a.fillStyle=O[r],r++,a.fillRect(u.x,u.y,u.w,u.h);for(w=[],x={},y=0;y<12;y++)x[y]=zb(new Date(F,y,1))-1+P;for(z=x[11]+sb(F,12)-1,r=0,t=0;t<N;t++)for(s=0;s<M;s++)P<=r&&r<P+Q&&(A=new Date(F,0,r-P+1),B=A.getMonth(),C=x[B],u=v[r],C<=r&&r<7+C&&w.push({x1:u.x,y1:u.y-o/2,x2:u.x,y2:u.y+u.h+o/2}),r!==C&&0!==A.getDay()||w.push({x1:u.x-o/2,y1:u.y,x2:u.x+u.w+o/2+(r===C?o:0),y2:u.y}),z-7<r&&r<=z&&w.push({x1:u.x+u.w,y1:u.y-o/2,x2:u.x+u.w,y2:u.y+u.h+o/2}),r!==z&&6!==A.getDay()||w.push({x1:u.x-o/2-(r===z?o:0),y1:u.y+u.h,x2:u.x+u.w+o/2,y2:u.y+u.h})),r++;for(a.strokeStyle="black",a.lineWidth=2,D=0;D<w.length;D++)E=w[D],a.beginPath(),a.moveTo(E.x1,E.y1),a.lineTo(E.x2,E.y2),a.stroke();a.restore()}function Bb(a){var b,c,d=Ja(a.minAngle-90),e=Ja(a.maxAngle-90),f=a.minValueOption.value,g=a.maxValueOption.value,h=a.ranges,i=N,j=(e-d)/(g-f),k=[];return h.length>0&&h.forEach(function(a){b=a.start,c=a.end,k.push({start:j*(b-f)+d,end:j*(c-f)+d,color:a.color})}),k.unshift({start:d,end:e,color:i}),{paintRanges:k,fillColor:i,targetValueRadian:j*(a.targetValueOption.value-f)+d,currentValueRadian:j*(a.currentValueOption.value-f)+d,minValueRadian:d,maxValueRadian:e}}function Cb(a,b,c,d,e,f,g){var h,i,j,k,n,o,p,s=f.zoomFactor,t=a.currentValueOption.normalFontHeight*s,u=a.minValueOption.normalFontHeight*s,w=a.maxValueOption.normalFontHeight*s,x=a.minAngle,y=a.maxAngle,z=a.currentValueOption.normalFontWidth*s,A=v(x)>90||v(y)>90,B=v(x)>120||v(y)>120,C=la*q(d,e);return g?(h=m(d/2*ka),i=m(e*ka),j=A?i/2:i,k=q(h,j),o=(e-(A?2*k:k))/2,p=.03*k,n={x:b+d/2,y:c+e/2+(A?0:k/2),outerRadius:k,innerRadius:k*a.radiusRatio,currentValuePoint:l,enoughShowCurrentLabel:!1,enoughShowTargetLabel:!0,enoughShowMinLabel:u<o,enoughShowMaxLabel:w<o,moreThanSemiCircle:A},A?B?2*t/3<o-p-r(w,u)&&z<d-2*C&&(n.currentValuePoint={x:n.x,y:n.y+k+p+t/2+r(w,u)},n.enoughShowCurrentLabel=!0):2*t/3<e/2-p&&z<d-2*C&&(n.currentValuePoint={x:n.x,y:n.y+2*p+t},n.enoughShowCurrentLabel=!0):t<o-p&&z<d-2*C&&(n.currentValuePoint={x:n.x,y:n.y+t},n.enoughShowCurrentLabel=!0)):(h=m(d/2*ja),i=m(e*ja),j=A?i/2:i,k=q(h,j),n={x:b+d/2,y:c+e/2+(A?0:k/2),outerRadius:k,innerRadius:k*a.radiusRatio}),n}function Db(a,b,c,d){return{x:a+p(c)*d,y:b+o(c)*d}}function Eb(a,b){return v(b.x-a.x)<.01?{x:b.x,y:b.y,textAlign:Q}:b.x>a.x?{x:b.x+da,y:b.y,textAlign:O}:b.x<a.x?{x:b.x-da,y:b.y,textAlign:P}:{x:b.x,y:b.y,textAlign:O}}function Fb(a,b,c,d,e,f,h){var i,j,k,l,q,s,t,u,w,x,y,z,A,B,C,D,E,F,G,J,K,M,N,R,S,T,V,W,X,Y,aa,da,ea,fa,ha,ia=h.zoomFactor,ja=!!g(b.showLabel)||b.showLabel,ka=Cb(b,c,d,e,f,h,ja);if(!(ka.outerRadius<=0))return i={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},j=ka.innerRadius,k=ka.outerRadius,l=ka.currentValuePoint,q=ka.moreThanSemiCircle,s={x:ka.x,y:ka.y},t=Bb(b),u=t.paintRanges,w=t.fillColor,a.save(),u.forEach(function(b){a.beginPath(),a.strokeStyle=H,a.moveTo(s.x,s.y),a.fillStyle=b.color||w,a.arc(s.x,s.y,k,b.start,b.end,!1),a.lineTo(s.x,s.y),a.closePath(),a.fill(),a.stroke(),a.beginPath(),a.fillStyle=H,a.strokeStyle=H,a.moveTo(s.x,s.y),a.arc(s.x,s.y,j,b.start-ma,b.end+ma,!1),a.lineTo(s.x,s.y),a.closePath(),a.fill(),a.stroke()}),a.beginPath(),a.moveTo(s.x,s.y),a.fillStyle=I,a.arc(s.x,s.y,k*Z,0,2*n,!1),a.fill(),x=Db(s.x,s.y,t.targetValueRadian,j),y=Db(s.x,s.y,t.targetValueRadian,k*_),Da(a,x.x,x.y,y.x,y.y,ba,ca,L),z=Db(s.x,s.y,t.currentValueRadian,k*_),Ba(a,s.x,s.y,z.x,z.y,I,$*k),ja&&(a.save(),a.beginPath(),a.textAlign=U,a.fillStyle=L,A=b.minValueOption.normalFontHeight*ia,B=b.maxValueOption.normalFontHeight*ia,C=b.minValueOption.normalFontWidth*ia,D=b.maxValueOption.normalFontWidth*ia,E=t.minValueRadian,F=t.maxValueRadian,G=b.currentValueOption.normalFontHeight*ia,J=b.currentValueOption.normalFontWidth*ia,K=void 0,M=void 0,N=void 0,ka.enoughShowCurrentLabel&&(Fa(a,l.x,l.y,b.currentValueOption.label,b.currentValueOption.fontAfterZoom,Q),i.showCurrentLabel=!0,K={x:l.x-J/2,y:l.y-G,width:J,height:G}),ka.enoughShowMinLabel&&v(p(E)*k)+C<e/2-ga&&(R=Db(s.x,s.y,t.minValueRadian,k),S=Eb(s,R),M={x:S.x-C,y:S.y,width:C,height:A},Oa(M,K)||(Fa(a,S.x,S.y+m(A),b.minValueOption.label,b.minValueOption.fontAfterZoom,P),i.showMinLabel=!0)),ka.enoughShowMaxLabel&&v(p(F)*k)+D<e/2-ga&&(T=Db(s.x,s.y,t.maxValueRadian,k),V=Eb(s,T),N={x:V.x,y:V.y,width:D,height:B},Oa(N,K)||(Fa(a,V.x,V.y+m(B),b.maxValueOption.label,b.maxValueOption.fontAfterZoom,O),i.showMaxLabel=!0)),ka.enoughShowTargetLabel&&(W=b.targetValueOption.normalFontWidth*ia,X=b.targetValueOption.normalFontHeight*ia,Y=b.targetValueOption.label,aa=k+3*X/2,y=Db(s.x,s.y,t.targetValueRadian,aa),da=Eb(s,y),ea=t.targetValueRadian,fa=q?(f-2*aa)/2+aa:f-(f-k)/2,v(p(ea)*aa)+W<e/2-ga&&v(o(ea)*aa)+X/2+ga/2<fa&&(ha=r(A,B)/2,Fa(a,da.x,da.y-(ea>n?ha:-ha),Y,b.targetValueOption.fontAfterZoom,da.textAlign),i.showTargetLabel=!0)),a.restore()),a.restore(),i}b.UIc=Fb;function Gb(a,b,c,d,e,f){var g=f.zoomFactor,h=a.showLabel,i=a.minValueOption.normalFontHeight*g,j=a.maxValueOption.normalFontHeight*g,k=a.targetValueOption.normalFontHeight*g,n=a.currentValueOption.normalFontHeight*g,o=a.minValueOption.normalFontWidth*g,p=a.maxValueOption.normalFontWidth*g,q=a.targetValueOption.normalFontWidth*g,s=a.currentValueOption.normalFontWidth*g,t=.05*d,u=m(e*ha),v=m(d*ia),w={x:b+d*(1-ia)/2,y:c+e*(ha+(1-ha)/2),graphWidth:v,graphHeight:u,targetValuePoint:l,currentValuePoint:l,minValuePoint:l,maxValuePoint:l};return h&&(i<(e-u)/2&&o<(d-v)/2-t&&(w.minValuePoint={x:w.x-o,y:w.y+i/3},w.enoughShowMinLabel=!0),j<(e-u)/2&&p<(d-v)/2-t&&(w.maxValuePoint={x:w.x-p,y:w.y-u+j/3},w.enoughShowMaxLabel=!0),(k<(e-u)/2||k/2<u)&&q<(d-v)/2-t-r(o,p)&&(w.targetValuePoint={x:w.x-q-r(o,p),y:l},w.enoughShowTargetLabel=!0),(n<(e-u)/2||n/2<u)&&s<(d-v)/2-t&&(w.currentValuePoint={x:w.x+v+t,y:l},w.enoughShowCurrentLabel=!0)),w}function Hb(a,b){var c,d,e=a.minValueOption.value,f=a.maxValueOption.value,g=a.ranges,h=N,i=b.graphHeight/(f-e),j=[];return g.length>0&&g.forEach(function(a){c=a.start,d=a.end,j.push({start:b.y-i*(c-e),height:i*(d-c),color:a.color})}),j.unshift({start:b.y,height:b.graphHeight,color:h}),{paintRanges:j,fillColor:h,targetValueY:b.y-i*(a.targetValueOption.value-e),currentValueY:b.y-i*(a.currentValueOption.value-e)}}function Ib(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t=g.zoomFactor,u=b.showLabel,v=b.minValueOption,w=b.maxValueOption,x=b.currentValueOption,y=b.targetValueOption,z=Gb(b,c,d,e,f,g),A=z.graphWidth,B=z.graphHeight;if(!(A<=0||B<=0))return h={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},i=z.currentValuePoint,j=z.targetValuePoint,k=z.minValuePoint,l=z.maxValuePoint,m={x:z.x,y:z.y},n=Hb(b,z),o=n.paintRanges,p=x.normalFontHeight*t,q=y.normalFontHeight*t,r=n.targetValueY,s=n.currentValueY,a.save(),o.forEach(function(b){La(a,m.x,b.start,A,-b.height,b.color)}),Da(a,m.x-(_-1)*A,r,m.x+A,r,ba,ca,L),Ba(a,m.x,s,m.x+A*_,s,I,aa*B),u&&(a.save(),a.beginPath(),z.enoughShowMinLabel&&(Fa(a,k.x,k.y,v.label,v.fontAfterZoom,O,L),h.showMinLabel=!0),z.enoughShowMaxLabel&&(Fa(a,l.x,l.y,w.label,w.fontAfterZoom,O,L),h.showMaxLabel=!0),z.enoughShowTargetLabel&&!(r-d+q/2>f||r-d-fa<0)&&(Fa(a,j.x,n.targetValueY+y.normalFontHeight*t/3,y.label,y.fontAfterZoom,O,L),h.showTargetLabel=!0),z.enoughShowCurrentLabel&&!(s-d+p/2>f||s-d-fa<0)&&(Fa(a,i.x,n.currentValueY+x.normalFontHeight*t/3,x.label,x.fontAfterZoom,O,L),h.showCurrentLabel=!0),a.restore()),a.restore(),h}b.VIc=Ib;function Jb(a,b,c,d,e,f){var g=f.zoomFactor,h=a.showLabel,i=a.minValueOption.normalFontHeight*g,j=a.maxValueOption.normalFontHeight*g,k=a.targetValueOption.normalFontHeight*g,n=a.currentValueOption.normalFontHeight*g,o=a.minValueOption.normalFontWidth*g,p=a.maxValueOption.normalFontWidth*g,s=a.currentValueOption.normalFontWidth*g,t=a.targetValueOption.normalFontWidth*g,u=.1*q(d,e),v=m(e*ia),w=m(d*ha),x={x:b+d*(1-ha)/2,y:c+e*(1-ia)/2,graphWidth:w,graphHeight:v,targetValuePoint:l,currentValuePoint:l,minValuePoint:l,maxValuePoint:l};return h&&((s<3*(d-w)/4||s<w)&&n<(e-v)/2-ga&&(x.currentValuePoint={x:l,y:x.y-n/2},x.enoughShowCurrentLabel=!0),(t<3*(d-w)/4||t<w)&&k<(e-v)/2-r(i,j)&&(x.targetValuePoint={x:l,y:x.y+v+r(i,j)+k/4*3},x.enoughShowTargetLabel=!0),o<3*(d-w)/4&&i<(e-v)/2-u&&(x.minValuePoint={x:x.x-o/2,y:x.y+v+i},x.enoughShowMinLabel=!0),p<3*(d-w)/4&&j<(e-v)/2-u&&(x.maxValuePoint={x:x.x+w-p/2,y:x.y+v+j},x.enoughShowMaxLabel=!0)),x}function Kb(a,b){var c,d,e=a.minValueOption.value,f=a.maxValueOption.value,g=a.ranges,h=N,i=b.graphWidth/(f-e),j=[];return g.length>0&&g.forEach(function(a){c=a.start,d=a.end,j.push({start:b.x+i*(c-e),width:i*(d-c),color:a.color||h})}),j.unshift({start:b.x,width:b.graphWidth,color:h}),{paintRanges:j,fillColor:h,targetValueX:b.x+i*(a.targetValueOption.value-e),currentValueX:b.x+i*(a.currentValueOption.value-e)}}function Lb(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t=g.zoomFactor,u=b.showLabel,v=b.minValueOption,w=b.maxValueOption,x=b.currentValueOption,y=b.targetValueOption,z=Jb(b,c,d,e,f,g),A=z.graphWidth,B=z.graphHeight;if(!(A<=0||B<=0))return h={showTargetLabel:!1,showCurrentLabel:!1,showMinLabel:!1,showMaxLabel:!1},i=z.currentValuePoint,j=z.targetValuePoint,k=z.minValuePoint,l=z.maxValuePoint,m={x:z.x,y:z.y},n=Kb(b,z),o=n.paintRanges,p=x.normalFontWidth*t,q=y.normalFontWidth*t,r=n.targetValueX,s=n.currentValueX,a.save(),o.forEach(function(b){La(a,b.start,m.y,b.width,B,b.color)}),Da(a,r,m.y,r,m.y+B*_,ba,ca,L),Ca(a,s,m.y+B-1,s,m.y-B*(_-1)-1,I,A*aa),u&&(a.save(),z.enoughShowMinLabel&&(Fa(a,k.x,k.y,v.label,v.fontAfterZoom,O,L),h.showMinLabel=!0),z.enoughShowMaxLabel&&(Fa(a,l.x,l.y,w.label,w.fontAfterZoom,O,L),h.showMaxLabel=!0),z.enoughShowTargetLabel&&!(r-c+q/2+ea>e||r-c-q/2-ea<0)&&(Fa(a,r-y.normalFontWidth*t/2,j.y,y.label,y.fontAfterZoom,O,L),h.showTargetLabel=!0),z.enoughShowCurrentLabel&&!(s-c+p/2+ea>e||s-c-p/2-ea<0)&&(Fa(a,s-x.normalFontWidth*t/2,i.y,x.label,x.fontAfterZoom,O,L),h.showCurrentLabel=!0),a.restore()),a.restore(),h}b.WIc=Lb;function Mb(a,b,c,d,e,f,g){a.save(),a.rect(c,d,e,f),a.clip(),0===b.gaugeType?Fb(a,b,c,d,e,f,g):1===b.gaugeType?Ib(a,b,c,d,e,f,g):2===b.gaugeType&&Lb(a,b,c,d,e,f,g),a.restore()}function Nb(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o=[],p=a.length,q=0,r=g.fontPixelSize;if(f&&(q=r+3),0===p)return o;for(i=d/p,j=a[0].value,k=1;k<p;k++)j=Math.max(j,a[k].value);for(l=0;l<p;l++)m=c+e-q,n=a[l].value/j*(e-q),n<0&&(n=0),o.push({x:b+l*i+i*(1-h)/2,textX:b+l*i,y:m-n,width:i*h,textWidth:i,height:n,axis:a[l].axis});return o}function Ob(a,b,c,d){a.save(),a.fillStyle=c;for(var e=0;e<b.length;e++)a.fillRect(b[e].x,b[e].y,b[e].width,b[e].height);a.restore()}function Pb(a,b,c,d){var e,f,g,h,i;for(a.save(),e=c.fontPixelSize,f=Tb(c),a.textAlign="center",a.fillStyle=d,g=0;g<b.length;g++)h=void 0,i=void 0,h=b[g].x+b[g].width/2,i=b[g].y+b[g].height+5+e,a.save(),a.font=f,a.beginPath(),a.rect(b[g].textX,b[g].y+b[g].height+1,b[g].textWidth,e+3),a.clip(),a.textBaseline="bottom",a.fillText(b[g].axis,h,i),a.restore();a.restore()}function Qb(a,b,c,d){var e,f,g,h,i,j;if("none"!==d){for(a.save(),a.lineWidth=1,a.strokeStyle=d,a.beginPath(),e=0;e<b.length;e++)f=b[e],g=f.x,h=f.y,i=f.width,j=f.height,0!==j&&0!==i&&(Ba(a,g,h,g+i,h),Ba(a,g,h+j,g+i,h+j),b[e-1]&&b[e-1].height>=j&&1===c||Ba(a,g,h,g,h+j),b[e+1]&&b[e+1].height>j&&1===c||Ba(a,g+i,h,g+i,h+j));a.stroke(),a.closePath(),a.restore()}}function Rb(a,b,c,d,e){var f,g,h=!1;return a.save(),a.font=e,f=b.length,g=(c-6)/f,b.forEach(function(b,c){if(a.measureText(b.axis).width>g)return void(h=!0)}),a.restore(),h}function Sb(a,b,c,d,e,f,h){var i,j,k,l=b.barColor,m=b.values,n=b.paintLabel,o=b.barWidth,p=b.labelFontStyle,q=b.afterZoomFontStyle,r=b.edgeColor,s=b.labelColor;g(p)||(i=q.fontPixelSize,(f<3*i||Rb(a,m,e,f,Tb(q)))&&(n=!1)),n&&g(p)&&(j=Math.floor(f/3>=12?12:Math.floor(f/3)),q.fontPixelSize=j,q.fontSize=j+"px",Rb(a,m,e,f,Tb(q))&&(n=!1)),k=Nb(m,c+3,d+3,e-6,f-6,n,q,o),Ob(a,k,l,r),Qb(a,k,o,r),n&&Pb(a,k,q,s)}function Tb(a){return a.fontStyle+" "+a.fontWeight+" "+a.fontSize+" "+a.fontFamily}function Ub(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p;a.save(),a.rect(c,d,e,f),a.clip(),h=b.clipX,i=b.clipY,j=b.clipWidth,k=b.clipHeight,l=b.paintX,m=b.paintY,n=b.paintWidth,o=b.paintHeight,p=b.img,j>0&&k>0&&n>0&&o>0&&a.drawImage(p,h,i,j,k,l,m,n,o),a.restore()}va=function(){function a(a,b,c,d){this.X=a,this.Y=b,this.Width=c,this.Height=d,this.Left=this.X,this.Right=this.Left+this.Width,this.Top=this.Y,this.Bottom=this.Y+this.Height}return a}(),wa=function(){function a(){this.Wd=2,this.Xd=C,this.Yd=C,this.Zd=B,this.$d=-B}return a.prototype.paint=function(a,b,c,d,e,f){var g,h,i,j=this;j.options=b,j.setting=b.settings,g=b.values,h=b.dateValues,i=b.zoomFactor,a.save(),a.rect(c,d,e,f),a.clip(),a.beginPath(),0===b.sparklineType&&j._d(a,c,d,e,f,g,h,i),j.ae(a,c,d,e,f,g,h,i),j.be(a,c,d,e,f,g,h,i),a.restore()},a.prototype.ce=function(a){return 0===this.options.sparklineType?3+this.de(a)+1:3},a.prototype.ee=function(a,c){var d,e,g,h,i,m,n,o,p,r=this.fe;if(r)return r;if(r=this.fe=[],d=a.length,this.options.displayDateAxis){for(h=c.length,i=q(d,h),m=[],i>0&&(m=c.slice(0,i)),m.sort(function(a,c){return a===c?0:(a===b.Vd&&(a=0),c===b.Vd&&(c=0),a-c)}),n=m.length,o=void 0,p=void 0,e=0;e<n;e++)if(o=m[e],typeof o!==x&&o!==k){for(p=j(c,o);f.k.Bb(r,p);)p=j(c,o,p+1);isNaN(o)||(g=a[p],g!==l&&g!==k&&isNaN(g)&&g!==b.Vd||r.push(p))}}else for(e=0;e<d;e++)g=a[e],typeof g!==x&&g!==k&&isNaN(g)&&g!==b.Vd||r.push(e);return r},a.prototype.ge=function(a,c){var d=c[a];return typeof d===x||d===k?1===this.setting.options.displayEmptyCellsAs&&(d=0):d===b.Vd&&(d=0),d},a.prototype._d=function(a,b,c,d,e,f,g,h){var i,j,l,m,n,o,p,q,r,s,t,u,v,w,y,z=this,A=z.ee(f,g),B=A.length-1;for(B<0&&(B=0),m=z.setting.options,n=z.linePos=[],t=m.displayEmptyCellsAs,i=0;i<B;i++)if(o=z.ge(A[i],f),typeof o!==x&&o!==k){if(q=i+1,p=z.ge(A[q],f),typeof p===x||p===k)if(1===t)p=0;else if(2===t)for(q=i+2;q<=B;q++)if(u=f[A[q]],typeof u!==x&&u!==k){p=u;break}typeof p!==x&&p!==k?(r=z.he(A[i],{Width:d,Height:e},f,g,h),s=z.he(A[q],{Width:d,Height:e},f,g,h),v=r.Width/2,j={X:r.X+v,Y:r.Y+v},l={X:s.X+v,Y:s.Y+v},n[i]={P1:j,P2:l}):i++}if(w=n.length,w>0)for(a.strokeStyle=z.options.getColor(m.seriesColor),a.lineCap="round",a.lineWidth=z.de(h),i=0;i<w;i++)y=n[i],y&&(a.beginPath(),j=y.P1,l=y.P2,a.moveTo(b+j.X,c+j.Y),a.lineTo(b+l.X,c+l.Y),a.stroke(),a.closePath())},a.prototype.ie=function(a,b,c){var d,e,f,g=this,h=g.options,i=g.setting.options,m=k,n=g.ge(a,b),o=g.ee(b,c),p=o.length,q=h.getColor.bind(g);return typeof n!==x&&n!==k&&(g.Zd!==B&&g.$d!==-B||g.je(b),n===g.Zd&&i.showLow&&(m=q(i.lowMarkerColor)),n!==g.$d||!i.showHigh||typeof m!==x&&m!==k||(m=q(i.highMarkerColor)),typeof m!==x&&m!==k||(h.displayDateAxis?(d=j(o,a),0===d&&i.showFirst&&(m=q(i.firstMarkerColor))):0===a&&i.showFirst&&(m=q(i.firstMarkerColor))),typeof m!==x&&m!==k||(h.displayDateAxis?(e=j(o,a),e===p-1&&i.showLast&&(m=q(i.lastMarkerColor))):a===p-1&&i.showLast&&(m=q(i.lastMarkerColor))),n<0&&i.showNegative&&(typeof m===x||m===k)&&(m=q(i.negativeColor)),typeof m!==x&&m!==k||(f=h.sparklineType,0===f?i.showMarkers&&(m=q(i.markersColor)):1===f?m=q(i.seriesColor):2===f&&(m=q(i.seriesColor)))),m===l||m===k?"Transparent":m},a.prototype.ae=function(a,b,c,d,e,f,g,h){var i,j,k,l,o,p,q,r,s,t,u=this,v={Width:d,Height:e},w=u.ee(f,g),x=w.length,y=u.options.sparklineType;for(t=0;t<x;t++)i=w[t],j=u.ie(i,f,g),k=u.he(i,v,f,g,h),a.fillStyle!==j&&(a.fillStyle=j),0===y?(a.save(),l=b+k.X+k.Width/2,o=c+k.Y+k.Height/2,a.translate(l,o),a.rotate(45*n/180),a.fillRect(0-k.Width/2,0-k.Height/2,k.Width,k.Height),a.restore()):(p=b+k.X+k.Width/4,p=m(p),q=c+k.Y,r=k.Width/2,s=k.Height,a.fillRect(p,q,r,s))},a.prototype.be=function(a,b,c,d,e,f,g,h){var i,j,k,l,n,o,p,q=this,r=q.setting&&q.setting.options;r&&r.displayXAxis&&q.ke(f,g)&&(i={Width:d,Height:e},j=q.ce(h),k=i.Width-q.ce(h),l=m(q.le(i,f,h))+.5,n=l,o=q.options.getColor(r.axisColor),p=h,p<1&&(p=1),a.strokeStyle!==o&&(a.strokeStyle=o),a.lineWidth!==p&&(a.lineWidth=p),a.beginPath(),a.moveTo(b+j,c+l),a.lineTo(b+k,c+n),a.stroke())},a.prototype.me=function(a){var b,c=this.ne(a);return c===-B||(b=this.oe(a),b===B)||(c===b||c*b<=0)},a.prototype.ke=function(a,b){var c,d,e,f,g,h=this.me(a);if(2!==this.options.sparklineType)return h;if(c=this.ee(a,b),d=c.length,!h&&d>0)for(g=0;g<d;g++)if(e=c[g],f=a[e],typeof f!==x&&f!==k)return!0;return h},a.prototype.pe=function(a,b){var c=this.Xd;return isNaN(c&&c.valueOf())&&this.$8J(a,b),this.Xd},a.prototype.re=function(a,b){var c=this.Yd;return isNaN(c&&c.valueOf())&&this.$8J(a,b),this.Yd},a.prototype.$8J=function(a,b){var c,d,e,f,g=this,h=new Date(0,0,0),i=B,j=g.ee(a,b),l=j.length;for(f=0;f<l;f++)c=j[f],d=b[c],isNaN(d)||(e=g.ge(c,a),e!==k&&typeof e===x||isNaN(e)||typeof d!==x&&d!==k&&(d>h&&(h=d),d<i&&(i=d)));g.Yd=h,g.Xd=i},a.prototype.se=function(a,b,c,d){var e,f,g,h,i,j,k,l,m=this,n=m.pe(b,c),o=m.re(b,c),p=[],q=m.ee(b,c),r=q.length;for(e=0;e<r;e++)g=q[e],f=c[g],f&&!isNaN(f)&&p.push(f);if(p.sort(function(a,b){return a-b}),h=p.length,h>1&&n!==o){for(i=B,j=0,k=void 0,e=1;e<h;e++)k=p[e],
f=k-p[e-1],f<i&&f>0&&(i=f),j+=f;return l=(a.Width-m.ce(d)-m.ce(d))*i/j/2,l<2&&(l=2),l}return(a.Width-m.ce(d)-m.ce(d))/2},a.prototype.te=function(a,b,c,d){var e,f=this;return f.options.displayDateAxis?f.se(a,b,c,d):(e=f.ee(b,c).length,(a.Width-f.ce(d)-f.ce(d))/e)},a.prototype.ue=function(a,b,c,d,e){var f,g,h,i,k,l,n,o,p=this,q=p.ce(e);return p.options.displayDateAxis?(f=p.te(a,c,d,e),g=p.re(c,d),h=p.pe(c,d),g===h?q+f/2:(i=d[b])?(k=a.Width-q-p.ce(e),k-=f,l=g.valueOf()-h.valueOf(),q+m((i.valueOf()-h.valueOf())/l*k)):0):(f=p.te(a,c,d,e),n=j(p.ee(c,d),b),o=q+f*n,m(o))},a.prototype.ve=function(a,b){var c,d=this,e=a.Width-d.ce(b)-d.ce(b);return e=r(e,0),c=a.Height-d.ce(b)-d.ce(b),c=r(c,0),{Width:e,Height:c}},a.prototype.je=function(a){var b,c,d=this,e=a.length;for(c=0;c<e;c++)b=a[c],typeof b!==x&&b!==k&&("number"!=typeof b&&(b=0),b<d.Zd&&(d.Zd=b),b>d.$d&&(d.$d=b))},a.prototype.ne=function(a){var b,c,d=this;return d.$d!==-B&&d.$d||d.je(a),b=d.setting.options,c=b.maxAxisType,0===c?d.$d:1===c?b.groupMaxValue:2===c?b.manualMax:d.$d},a.prototype.oe=function(a){var b,c,d=this;return d.Zd!==B&&d.Zd||d.je(a),b=d.setting.options,c=b.minAxisType,0===c?d.Zd:1===c?b.groupMinValue:2===c?b.manualMin:void 0},a.prototype.we=function(a,b,c,d){var e=this.ve(a,d),f=this.ne(c),g=this.oe(c),h=f-g,i,j;if(f===g){if(0===f)return 0;h=v(f)}return i=c[b],i||(i=0),j=e.Height/h,i*j},a.prototype.xe=function(a,b,c,d){var e,f,g,h=this,i=h.options.sparklineType;if(0===i)return h.we(a,b,c,d);if(1===i){if(e=c[b],1===h.setting.options.displayEmptyCellsAs&&(typeof e===x||e===k))return 0;if(f=h.we(a,b,c,d),f>-h.Wd&&f<h.Wd){if(e>0)return f+h.Wd;if(e<0)return f-h.Wd}return f}return 2===i?(e=c[b],typeof e===x||e===k||0===e||isNaN(e)?0:(g=h.ve(a,d),e>=0?g.Height/2:-g.Height/2)):void 0},a.prototype.ye=function(a,b,c){var d,e,f=this,g=f.ve(a,c),h=f.ne(b),i=f.oe(b);if(h===-B||i===B)return a.Height/2;if(d=h-i,h===i){if(0===h)return a.Height/2;d=h,h<0&&(h=0)}return e=g.Height/d,f.ce(c)+h*e},a.prototype.le=function(a,b,c){return 2===this.options.sparklineType?a.Height/2:this.ye(a,b,c)},a.prototype.ze=function(a,b,c,d){var e,f,g,h=this,i=h.ve(a,d),j=h.ne(c),l=h.oe(c),m=j-l;if(j===l){if(0===j)return 0;m=j}return e=i.Height/m,f=h.ge(b,c),typeof f!==x&&f!==k||(f=0),j!==l&&j*l>0?(g=0,g=f>=0?(f-l)*e:(f-j)*e):f*e},a.prototype.Ae=function(a,b,c,d){var e,f,g,h=this,i=h.options.sparklineType;return 0===i?h.ze(a,b,c,d):1===i?(e=h.ze(a,b,c,d),f=h.Wd,e>-f&&e<f&&(g=h.ge(b,c),typeof g!==x&&g!==k||(g=0),0!==g)?g>0?e+f:e-f:e):2===i?h.xe(a,b,c,d):void 0},a.prototype.Be=function(a,b,c,d,e){var f,g,h,i,j,k,l,n,o,p=this,q=p.te(b,c,d,e),s=p.ue(b,a,c,d,e);return q<0&&(q=0),q=m(q),q%2===1&&(q+=1),f=p.xe(b,a,c,e),g=p.le(b,c,e),h=p.ne(c),i=p.oe(c),j=0,h<0&&i<0?j=r(p.ce(e),g):(j=g,f>=0&&(j=g-f)),k=p.Ae(b,a,c,e),l=new va(s,j,q,v(k)),0!==f&&(n=p.ce(e),l.Y<n&&l.Bottom<n+1?l.Height=m(l.Height+1):(o=b.Height-p.ce(e),l.Bottom>o&&l.Y>o-1&&(l.Y=o-k,l.Height=k))),l},a.prototype.de=function(a){var b=this.setting.options.lineWeight*a;return b<1&&(b=1),b},a.prototype.he=function(a,b,c,d,e){var f,g,h,i,j,l=this,m=l.de(e);return m++,m<2&&(m=2),f=l.Be(a,b,c,d,e),0===l.options.sparklineType&&(f.X=f.X+(f.Width-m)/2,g=l.ge(a,c),typeof g!==x&&g!==k?(g>=0?f.Y-=m/2:f.Y=f.Bottom-m/2,f.Width=m,f.Height=m):(f.Width=0,f.Height=0)),l.setting.options.rightToLeft&&(h=f.X,i=b.Width-h,j=i-f.Width,f=new va(j,f.Y,f.Width,f.Height)),f},a}(),b.SparklineRender=wa,b.SparklineExRenders={PIESPARKLINE:Pa,AREASPARKLINE:Sa,SCATTERSPARKLINE:Ua,BULLETSPARKLINE:Za,SPREADSPARKLINE:$a,STACKEDSPARKLINE:cb,HBARSPARKLINE:ib,VBARSPARKLINE:jb,VARISPARKLINE:kb,BOXPLOTSPARKLINE:lb,CASCADESPARKLINE:qb,PARETOSPARKLINE:rb,MONTHSPARKLINE:yb,YEARSPARKLINE:Ab,GAUGEKPISPARKLINE:Mb,HISTOGRAMSPARKLINE:Sb,IMAGESPARKLINE:Ub}}}),a.exports=c.Spread},"./node_modules_local/@grapecity/js-sheets-common/index.js":function(a,b,c){a.exports=c("./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js")},"@grapecity/js-calc":function(a,b){a.exports=GC.Spread.CalcEngine},Bindings:function(a,b){a.exports=GC.Spread.Sheets.Bindings},CellTypes:function(a,b){a.exports=GC.Spread.Sheets.CellTypes},Common:function(a,b){a.exports=GC.Spread},ConditionalFormatting:function(a,b){a.exports=GC.Spread.Sheets.ConditionalFormatting},ContextMenu:function(a,b){a.exports=GC.Spread.Sheets.ContextMenu},Core:function(a,b){a.exports=GC.Spread.Sheets},DataManager:function(a,b){a.exports=GC.Data},Filters:function(a,b){a.exports=GC.Spread.Sheets.Filter},SheetsCalc:function(a,b){a.exports=GC.Spread.Sheets.CalcEngine},Sparkline:function(a,b){a.exports=GC.Spread.Sheets.Sparklines},Touch:function(a,b){a.exports=GC.Spread.Sheets.Touch}}),function(a){"object"==typeof module&&"object"==typeof module.exports?module.exports=a:"function"==typeof define&&define.amd?define("@grapecity/spread-sheets",[],function(){return a}):"object"==typeof exports&&(exports.Spread=a.Spread)}(GC||{});