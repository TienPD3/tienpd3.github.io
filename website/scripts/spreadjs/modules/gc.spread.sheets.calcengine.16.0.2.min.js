/*!
 * 
 * SpreadJS Library 16.0.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.CalcEngine=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/sheetsCalc/sheetsCalc.entry.js")}({"./dist/plugins/sheetsCalc/calc-extra-save.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n;Object.defineProperty(b,"__esModule",{value:!0}),d=c("CalcEngine"),e=c("./dist/plugins/sheetsCalc/parser-sheets.js"),f=null,g=void 0,h=1,i=2,j=4,k=8,l=16,m=32,n=64;function o(a){var b,c,d,e;if(Array.from)return Array.from(a.keys());for(b=[],c=0,d=a.keys();c<d.length;c++)e=d[c],b.push(e);return b}function p(a,b,c){var e,f=function(e){var f,g,h,i,j=b[e];if(j.l)for(f=q(j.k),g=a.qg(f[1],f[2],!0),j.v&&a.bg(g),j.b,g.Ze=j.l.map(function(a){return parseInt(a,10)}),h=function(a){var b=j.l[a];g[b]=d.createMap(),j[b].map(function(a){var d,e=q(a),f=e[0];"?"!==f[0]&&"!"!==f[0]||(f=f.slice(1)),d=c[f],g[b].set(a,d.qg(e[1],e[2],!0))})},i=0;i<j.l.length;i++)h(i)};for(e=0;e<b.length;e++)f(e)}b.IiK=p;function q(a){return a.split(",").map(function(a,b){return b>0&&(a=parseInt(a,10)),a})}function r(a,b,c){var d,e,f,g,h,i,j,k,l,m=a.ug(!0);for(d in b.l)if(b.l.hasOwnProperty(d)){e=b[d];for(f in e)if(e.hasOwnProperty(f))for(g=f.split(",").map(function(a,b){return"?"!==a[0]&&"!"!==a[0]||(a=a.slice(1)),parseInt(a,10)}),h=0;h<e[f].length;h++)i=q(e[f][h]),j=i[0],"?"!==j[0]&&"!"!==j[0]||(j=j.slice(1)),k=c[j],l=k.qg(i[1],i[2],!0),m.processListener(parseInt(d,10),g[0],g[1],g[2],g[3],l,!0)}}b.hhK=r;function s(a){var b,c=null;return(a.isVolatile||a.YDc||a.Ze&&a.Ze.length>0)&&(c={},c.k=a.getKey(),a.isVolatile&&(c.v=!0),a.YDc&&(c.b=!0),a.Ze&&a[0]&&(b="0",c[b]=o(a[b]),c.l=a.Ze)),c}function t(a){var b,c,d,e,f,g,h=[],i=a.dataTable;for(d in i)if(i.hasOwnProperty(d)&&(e=i[d]))for(c in e)e.hasOwnProperty(c)&&(b=e[c],b&&(f=s(b.calc),f&&h.push(f)));return g=u(a),g&&h.push(g),h}b.JiK=t;function u(a){var b,c,d,e,f=a.ug();if(f)return b={k:"rangeCalc"},c="0",d=f[c],e={},d&&d.forEach(function(a,b){e[b]=o(a.content)}),b[c]=e,b.l=f.Ze,b}function v(a,b){var c,d,e,f,g,h={};if(b&&b.idMap){c=a.jh,d={};for(e in c)c.hasOwnProperty(e)&&(d[c[e].getSource().getName()]=c[e]);f=b.idMap;for(e in f)f.hasOwnProperty(e)&&(g=f[e],h[e]=d[g])}return h}b.jhK=v;function w(a){var b,c=a.jh,d={};for(b in c)c.hasOwnProperty(b)&&(d[b]=c[b].getSource().getName());return d}b.khK=w;function x(a,b){return y(a,b)}b.exprFromJSON=x;function y(a,b){var c,f,g,o,p,q,r=a.t;if(4===r||2===r||3===r||8===r||100===r)return f=new d.Expression(r),f.value=a.v,f;if(5===r)f=new d.Expression(5),f.value=d.CalcError.riK(a.v);else if(6===r)f=new d.Expression(6),f.value=new d.CalcArray(a.v);else if(9===r)f=d.Kh(a.o,y(a.v,b),a.w&&y(a.w,b));else if(10===r)f=new d.Expression(10),f.value=y(a.v,b);else if(11===r)f=new d.Expression(11);else if(7===r)for(f=new d.Expression(7),a.f&&(f.function=y(a,b)),a.n&&(f.function=b.getFunction(a.n),f.functionName=a.n),g=f.arguments=[],o=0;o<a.p.length;o++)a.p[o]&&(g[o]=y(a.p[o],b));else 1===r?(f=new d.ReferenceExpression(1),p=a.v.split("*"),p[0]&&(f.source=b.getExternalSource("",p[0])),p[1]&&(f.endSource=b.getExternalSource("",p[1])),p[2]&&(f.row=parseInt(p[2],10)),p[3]&&(f.column=parseInt(p[3],10)),p[4]&&(f.endRow=parseInt(p[4],10)),p[5]&&(f.endColumn=parseInt(p[5],10)),q=parseInt(p[6],10),f.rowRelative=!!(q&h),f.columnRelative=!!(q&i),f.endRowRelative=!!(q&j),f.endColumnRelative=!!(q&k),f.isFullRow=!!(q&l),f.isFullColumn=!!(q&m),f.isArrayReference=!!(q&n),f.isFullRow&&(f.column=f.endColumn=d.BAND_INDEX_CONST),f.isFullColumn&&(f.row=f.endRow=d.BAND_INDEX_CONST)):13===r?(f=new e.xzb,c=a.v,f.lj=c[0],f.source=c[1],f.P$J=c[2],f.xj=c[3],f.oj=c[4],f.pj=c[5],f.rj=c[6],f.qj=c[7],f.source=b.getExternalSource("",f.source),f.lj=b.getTableByName(f.lj)):22===f.type;return a.es&&(f.ensureSingle=!0),f}function z(a){return A(a)}b.exprToJSON=z;function A(a){var b,c,e,g;if(!a)return a;if(b={t:a.type},a.ensureSingle&&(b.es=1),4===a.type||2===a.type||3===a.type||8===a.type||100===a.type)b.v=a.value;else if(5===a.type)b.v=a.value._code;else if(6===a.type)b.v=a.value.array;else if(9===a.type)b.o=a.operatorType,b.v=A(a.value),b.w=a.value2&&A(a.value2);else if(10===a.type)b.v=A(a.value);else if(7===a.type)for(d.isExpression(a.function)?b.f=A(a.function):a.functionName&&(b.n=a.functionName),b.p=[],c=0;c<a.arguments.length;c++)b.p[c]=A(a.arguments[c]);else 1===a.type?(e=(a.rowRelative&&h)|(a.columnRelative&&i)|(a.endRowRelative&&j)|(a.endColumnRelative&&k)|(a.isFullRow&&l)|(a.isFullColumn&&m)|(a.isArrayReference&&n),g=[a.source&&a.source.getName(),a.endSource&&a.endSource.getName(),a.row,a.column,a.endRow,a.endColumn,e],a.isFullRow&&(g[3]=g[5]=f),a.isFullColumn&&(g[2]=g[4]=f),b.v=g.join("*")):13===a.type?b.v=[a.lj.name(),a.source.getName(),a.P$J,a.xj,a.oj,a.pj,a.rj,a.qj]:22===a.type;return b}},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Core"),f=c("Common"),g=c("./dist/plugins/sheetsCalc/parser-sheets.js"),h=c("CalcEngine"),i=c("./dist/plugins/sheetsCalc/calc.ns.js"),j=c("./dist/plugins/sheetsCalc/calc-extra-save.js"),k=f.Common.j,l=f.Common.u,m=k.Ia,n=k.za,o=null,p=void 0,q=["v","n","s","b","d","sn"],r=h.Errors.Value,s=f.Formatter&&f.Formatter.GeneralFormatter,t=h.Convert.vf,u=k.Fa,v=d.Ul.JcK,w=d.range_parser.EcK,x=d.Ul.naa,y=d.Util.addXLFNPrefix,z="=",A=function(a){return h.Convert.Na(a,!0)},B=d.Range.prototype.contains,C=l.Nb,D="number";function P(a){var b="_xlfn.";return a&&"string"==typeof a&&a.toLowerCase().indexOf(b)>=0?a.replace(/_xlfn\.|_xlws\./gi,""):a}b.processFunctionPrefix=P;function Q(a){if(a)return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}b.encodeNameFormula=Q,E=h.CalcSource.prototype,E.referenceToArray=function(a,b,c,d,e,f,g,i){var j,k,l,m,n,q,s,t,u,v,w,x,y=this,z=1,A=1,B=[],C=a.getRangeCount();if(0===C)return B.isError=!0,B;for(s=y.getRowCount(),t=y.getColumnCount(),c=c===p||c,u=0;u<C;u++){if(c||(q=[],B.push(q)),z=a.getRowCount(u),0===z)return B.isError=!0,B;if(A=a.getColumnCount(u),0===A)return B.isError=!0,B;if(l=a.getRow(u),m=a.getColumn(u),2!==c){if(l>=s||m>=t)return B=[o],B.rowCount=1,B.colCount=1,B.rangeCount=1,B;m+A>t&&(A=t-m)}for(l+z>s&&(z=s-l),v=void 0,w=0;w<z;w++)for(j=l+w,c||(v=[],q.push(v)),x=0;x<A;x++){if(k=m+x,n=y.getValue(j,k),d&&h.Convert.vf(n))return B=[n],B.isError=!0,B;if(n=h.Convert.wf(n,b,!h.ExcelCompatibleCalcMode,f,i),e&&n===h.Convert.CalcConvertedError)return B=[r],B.isConvertError=!0,B;n===o&&f||(2===c?B[w*A+x]=n:c?B.push(n):v.push(n))}}return c||1!==C||(B=B[0]),B.rowCount=z,B.colCount=A,B.rangeCount=C,B},E.getSheetReference=function(){var a=this;return a.Df=a.Df||new h.CalcReference(a),a.Df},function(a){a[a.a1=0]="a1",a[a.r1c1=1]="r1c1"}(F=b.ReferenceStyle||(b.ReferenceStyle={})),e.ReferenceStyle=F,G=function(){function a(a,b,c,d,e){var f=this;f.Cj=a,f.Uu=c,f.Vu=d,f.Lf=b,u(e)||(f.kT=e)}return a.prototype.getName=function(){return this.Cj},a.prototype.getRow=function(){return this.Uu},a.prototype.getColumn=function(){return this.Vu},a.prototype.getExpression=function(){return this.Lf},a.prototype.getComment=function(){return this.kT},a.prototype.fg=function(a,b){b&&b.push({type:"customName",nameInfo:this,expr:this.Lf}),this.Lf=a},a}(),b.NameInfo=G,e.NameInfo=G,H=function(a){O(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,e,f,g,h)||this,j=i;return j.nBJ=c,j.H4J=d,i}return b.prototype.getFormatter=function(){return this.nBJ},b.prototype.getSheetTabName=function(){return this.H4J},b}(G),b.FormatterNameInfo=H,h.CalcSource.prototype.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},I=function(a){O(b,a);function b(b){var c=a.call(this,o)||this;return c.references=b,c}return b.prototype.toArray=function(a,b,c,d,e){var f,g,h=this.references,i=[];for(f=0;f<h.length;f++){if(g=h[f].xf.referenceToArray(h[f],a,b,c,d,e),g.isError&&c)return g;b?Array.prototype.push.apply(i,g):i.push(g[0]),f||(i.rowCount=g.rowCount,i.colCount=g.colCount)}return i.rangeCount=h.length,i},b}(h.CalcReference),b.SheetRangeReference=I,J=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function R(a){var b,c,d,e,f,g;if(a<0)return"";if(b=J[a])return b;for(c=a,d="",e=d.length,a+=1;a>0;a=Math.floor((a-1)/26))f=d.substring(0,e),g=d.substring(e),d=f+String.fromCharCode(65+(a-1)%26)+g;return b=""+d,J[c]=b,b}K=function(a){O(b,a);function b(c,e,f,h){var i,j,k,l;for(void 0===h&&(h={}),i=a.call(this,c&&c.yj(h.sheetArea),e,f,h)||this,c||(c=b.CUJ=b.CUJ||new d.Worksheet,i.source||(i.source=c.yj(h.sheetArea))),i.kj=c,i.row=f&&f.row||0,i.column=f&&f.col||0,j=c.getCalcService(),k=j.getResolvers(),l=0;l<k.length;l++)if(k[l]instanceof g.SheetReferenceResolver)return i;return j.addResolver(new g.SheetReferenceResolver(c)),j.addResolver(new g.StructureReferenceResolver(c)),i}return b.prototype.getExternalSource=function(a,b){var c,d,e,f=this,g=f.kj.parent,i=f.kj.yj();if(a&&(!g||g.name!==a))return o;if(!g)return l.Mb(f.kj.name(),b)?i:o;if(Z(b))return g.G$J.parseSource(b,i.q$a);if(c=g.sheets,c&&c.length>0)for(d=0;d<c.length;d++)if(e=c[d],l.Mb(e.name(),b))return e.yj();return h.ParserContext.prototype.getExternalSource.call(this,a,b)},b.prototype.getExternalSourceToken=function(a){return a.getName(this)},b.prototype.getTableByName=function(a){var b,c,d=this.kj.tables,e=!0,f=d?d.g9J(a,e):o;if(!f&&(b=this.kj.parent&&this.kj.parent.sheets))for(c=0;c<b.length&&(d=b[c].tables,!d||!(f=d.g9J(a,e)));c++);return f?f:this.kj.parent&&this.kj.parent.getSheetTab(a)},b.prototype.getTableByIndex=function(a,b){var c=this.kj.tables;return c?c.RS(a,b,!0):o},b.prototype.setSource=function(a){this.source=a;var b=a;b&&b.getSheet&&(this.kj=b.getSheet())},b.prototype.no=function(){this.kj&&this.kj!==b.CUJ&&this.kj.no(),this.kj=o},b}(h.ParserContext),b.SheetParserContext=K,L=new f.Common.ResourceManager(d.SR);function S(a){if(a.indexOf("LET(")>-1)return"LET"}M=function(a){O(b,a);function b(c,d){var e=a.call(this,o)||this;return e.getCalcSourceModel=function(){return this.Bf},e.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},e.getRangeKey=function(a,b){return a.id+","+b.row+","+b.col+","+b.rowCount+","+b.colCount},e.getSheetRangeReference=function(a){var c,d,e,f,g,h=this.kj,i=h&&h.parent;if(a.endSource&&i&&i.sheets&&a.endSource instanceof b){for(c=i.sheets,d=!1,e=void 0,f=[],g=0;g<c.length;g++){if(e=c[g].yj(),e===this)d=!0;else if(e===a.endSource){f.push(e.getReference(a));break}d&&f.push(e.getReference(a))}return new I(f)}},e.kj=c,e.Wz=d?d:3,e}return b.prototype.getReferenceSheetNames=function(){return this.BeK||{}},b.prototype.addReferenceSheetName=function(a){var b=this;b.BeK||(b.BeK={}),b.BeK[a]=1},b.prototype.setReferenceSheetNames=function(a){this.BeK=a},b.prototype.startCalculation=function(){this.Hu||(this.QLb(),this.Iu=[])},b.prototype.endCalculation=function(){this.Hu=o,this.GkK=o,this.LIc(),this.Iu=o;var a=this.Bf.ug(!1);a&&a.clearListenersCache(),this.Af.calcOnDemand&&this.kj.repaint()},b.prototype.yBJ=function(){var a=this;a.zBJ?a.Iu&&(a.ABJ=a.ABJ.concat(a.Iu),a.Iu=[]):(a.ABJ=a.Iu||[],a.zBJ=setTimeout(function(){a.LIc(a.ABJ),delete a.ABJ,delete a.zBJ},0))},b.prototype.LIc=function(a){var b,c,e=a||this.Iu;e&&e.length>0&&(b=this.kj,c=b.ITa.XTa(3).Ap,b.Wq(d.Events.RangeChanged,{isUndo:!u(c&&c.JPJ),sheet:b,sheetName:b.name(),row:0,col:0,rowCount:b.getRowCount(),colCount:b.getColumnCount(),changedCells:e,action:6},b.vxb))},b.prototype.clearValueCache=function(){this.QLb()},b.prototype.QLb=function(){var a=this.getRowCount(),b=this.getColumnCount();this.Hu={rowCount:a,colCount:b},this.GkK={arrayInfo:[]}},b.prototype.wcc=function(){this.Hu=o,this.GkK=o,this.Iu=o},b.prototype.getValue=function(a,b){var c,e,f,g,i,j,k,l,m,n,s,t,u,v=[];for(c=2;c<arguments.length;c++)v[c-2]=arguments[c];if(e=this,f=e.kj,typeof a===D)g=arguments[0],i=arguments[1],b=arguments[2];else if(a=a,a.row!==p)g=a.row,i=a.col;else if(a.name)return null;return j=e.Wz,b=b||0,g<0||i<0?r:f.Ju&&f.Ku===g&&f.Lu===i?f.Mu:(k=e.Hu,l=q[b],k?(m=k.rowCount,n=k.colCount,s=void 0,t=void 0,u=void 0,g>=m?o:i>=n?o:(s=k[g],s||(s=k[g]={}),t=s[i],t||(t=s[i]={v:f.getValue(g,i,j)}),u=t[l],u===p&&(u=h.Convert.wf(t.v,b,!h.ExcelCompatibleCalcMode),t[l]=u),u=d.Ul.w0a(u))):g>=e.getRowCount()?o:i>=e.getColumnCount()?o:e.kj.getValue(g,i,j))},b.prototype.getIdentity=function(a,b){var c=this,d=b.row,e=b.rowCount||1,f=b.column,g=b.columnCount||1;return d===-1&&(d=0,e=c.getRowCount()),f===-1&&(f=0,g=c.getColumnCount()),c.getName()+"."+d+"."+e+"."+f+"."+g},b.prototype.getReference=function(a){var b=this,c=a.row,d=a.col;return c===-1&&(a.row=0,a.rowCount=b.getRowCount(),a.rowUndefine=!0),d===-1&&(a.col=0,a.colCount=b.getColumnCount(),a.colUndefine=!0),new h.CalcReference(b,[a])},b.prototype.getSources=function(a){var c,d,e,f,g;if(this.kj&&this.kj.parent&&this.kj.parent.sheets&&a instanceof b){for(c=this.kj.parent.sheets,d=!1,e=void 0,f=[],g=0;g<c.length;g++){if(e=c[g].yj(),e===this&&(d=!0),e===a){f.push(e);break}d&&f.push(e)}return f}},b.prototype.Ppb=function(a,b){var c,d=this,e=d.GkK,f=e&&e.arrayInfo;f&&(c=!1,f.forEach(function(d,g){if(d){var h=d.reference,i=d.key;B.call(h.yf[0],a,b)&&(delete e[i],f[g]=p,c=!0)}}),c&&(e.arrayInfo=[],f.forEach(function(a){a&&e.arrayInfo.push(a)})))},b.prototype.referenceToArray=function(a,b,c,d,e,f,g,i){var j,l,m,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q;if(b=b||0,j=this,t=1,u=1,y=[],B=j.kj,C=j.Hu,D=j.GkK,G=q[b],x=a.getRangeCount(),0===x)return y.isError=!0,y;if(D&&(F=a.getRangeCount()+"_"+a.getRow(0)+"_"+a.getColumn(0)+"_"+a.getRowCount(0)+"_"+a.getColumnCount(0)+"_"+b+"_"+c,z=D[F]))return z;for(H=this.getRowCount(),I=this.getColumnCount(),c=c===p||c,J=0;J<x;J++){if(c||(A=[],y.push(A)),t=a.getRowCount(J),0===t)return y.isError=!0,y;if(u=a.getColumnCount(J),0===u)return y.isError=!0,y;if(v=a.getRow(J),w=a.getColumn(J),2!==c){if(v>=H||w>=I)return y=c?[o]:[[o]],y.rowCount=1,y.colCount=1,y.rangeCount=1,y;w+u>I&&(u=I-w)}for(v+t>H&&(t=H-v),K=void 0,L=void 0,M=B.Ju,N=0;N<t;N++)for(l=v+N,c||(K=[],A.push(K)),C&&(C[l]||(C[l]={}),E=C[l]),O=0;O<u;O++){if(m=w+O,M&&B.Ku===l&&B.Lu===m)z=B.Mu,M=!1;else{if(C?(L=E[m],L?z=L.v:(z=B.getValue(l,m,j.Wz),L=E[m]={v:z})):z=B.getValue(l,m,j.Wz),g&&(P=B.getFormatter(),Q=void 0,Q=P instanceof s?P.formatString():P,"@"===Q?z=B.getText(l,m):z instanceof Date&&(z=k.Pa(z)),n(L)||(L=E[m]={v:z})),d&&h.Convert.vf(z))return y=[z],y.isError=!0,y;if(L&&L[G]!==p)z=L[G];else if(z=h.Convert.wf(z,b,!h.ExcelCompatibleCalcMode,f,i),L&&(L[G]=z),e&&L===z)return y=[r],y.isConvertError=!0,y}h.Convert.j$a(z,f)||(2===c?y[N*u+O]=z:c?y.push(z):K.push(z))}}return c||1!==x||(y=y[0]),y.rowCount=t,y.colCount=u,y.rangeCount=x,D&&(a.HkK&&D.arrayInfo.length<200||!isNaN(x)&&!isNaN(t)&&!isNaN(u)&&x*t*u>100&&x*t*u<1e6&&D.arrayInfo.length<50)&&(D[F]=y,D[F].rowCount=t,D[F].colCount=u,D[F].rangeCount=x,D.arrayInfo.push({reference:a,key:F})),y},b.prototype.getColumnCount=function(){var a=this.kj;return a.Js?0:a.getColumnCount(this.Wz)},b.prototype.getRowCount=function(){var a=this.kj;return a.Js?0:a.getRowCount(this.Wz)},b.prototype.isHiddenRow=function(a,b){var c=this.kj,d=c.Nu&&c.Nu();return!(!d&&b)&&0===c.getRowHeight(a)},b.prototype.getName=function(){var a=this.Wz,b=u(this.WOJ)?this.kj.name():this.WOJ;return a===d.SheetArea.colHeader?b+"CH":a===d.SheetArea.rowHeader?b+"RH":b},b.prototype.RLb=function(){var a=this,b=a.bIb;return b||(b=a.bIb=a.kj.ITa.bIb),b},b.prototype.setArray=function(a,b,c,d,e){return this.RLb().setArray(this,a,b,c,d,e)},b.prototype.updateItem=function(a,b,c){return this.RLb().updateItem(this,a,b,c)},b.prototype.LIb=function(a,b){this.RLb().LIb(a,b)},b.prototype.MIb=function(){this.RLb().MIb()},b.prototype.setValue=function(a){var b,c,e,f,g,h,i,j,k,l,n,o,q,r,s,t,v,w,x,y,z,A,B,C,D,E,F,G,H=[];for(b=1;b<arguments.length;b++)H[b-1]=arguments[b];if(c=this,e=c.kj,h=c.Wz,a=a,a.row!==p)f=a.row,g=a.col,i=1;else{if(a.name)return;f=arguments[0],g=arguments[1],i=2}j=arguments[i],k=arguments[i+1],l=c.Hu,l&&(n=l[f],n&&(o=n[g],o&&(o.v=j,o.b!==p&&(o.b=p),o.d!==p&&(o.d=p),o.n!==p&&(o.n=p),o.s!==p&&(o.s=p),o.sn=p))),q=d.Ul.x0a(j),r=e.ITa,s=!1,t=e.tables,v=t&&t.find(f,g),3===h&&v&&(w=v.showHeader()&&f===v.headerIndex(),x=v.showFooter()&&f===v.footerIndex(),w||x||(s=v.yq(f,g,q))),y=e.wq,3===h&&!s&&y&&y._dataSource&&(z=y.getValue(f,g),A=!1,z.hasBinding&&(B=void 0,l?(C=l.bindingRows=l.bindingRows||{},B=C[f],B||(B=C[f]=m({},e.getDataItem(f)))):B=m({},e.getDataItem(f)),r.Cp(f,g,{Dp:B,Ep:z.value}),A=y.setValue(f,g,q,r.zTa)),s="dataManagerBindingSource"===y.CL?A:z.hasBinding),D=e.pivotTables,3===h&&!s&&D&&(s=D.jmK(f,g,q)),s||(E="__hyperlink__",!u(q)&&q[E]&&(F=q[E],G={url:F},r.setHyperlink&&r.do("setHyperlink",f,g,G),q=""+q),r.do("setValue",f,g,q,h,!0,!0,arguments[i+2],!0,!0)),e.jCJ=!0,this.Iu?this.Iu.push({row:f,col:g,sheetArea:h}):e.Wq(d.Events.CellChanged,{sheet:e,sheetName:e.name(),row:f,col:g,sheetArea:h,propertyName:"value",oldValue:k,newValue:j,klK:!0})},b.prototype.getCustomFunction=function(a){return this.kj?this.kj.Pu(a):o},b.prototype.getCustomName=function(a){var b=this.getCustomNameInfo(a);return b?b.getExpression():o},b.prototype.getCustomNameInfo=function(a){return a=C(a),this.kj?this.kj.getCustomName(a):o},b.prototype.getSheet=function(){return this.kj},b.prototype.setFormula=function(a,b,c,d,e){var f,g,h,i,j=this;if(j.kj.ITa.zTa&&(g=j.kj.ITa.zTa.formulas,g||(g=j.kj.ITa.zTa.formulas={}),a>=-1&&b>=-1))if(h=j.getCalcService(),h.backupR1C1Formula&&(i=j.Bf.Kf(a,b),c=U(j.kj,i,a,b,!0,!1)),!d&&h.allowDynamicArray&&(d=j.Bf.Qf(a,b)),f=g[a],f||(f=g[a]={}),c&&"="===c[0]&&(c=c.substring(1)),e){if(f[b]&&f[b].oldFormula)return;d=m({},d),f[b]=m({},f[b],{oldFormula:c,oldArrayInfo:d}),c||delete f[b].oldArrayInfo}else f[b]=m({},f[b],{formula:c,arrayInfo:d}),c||delete f[b].arrayInfo},b.prototype.setArrayFormula=function(a,b,c,d,e){var f={row:a,col:b,rowCount:c,colCount:d};this.setFormula(a,b,e,f)},b.prototype.setFormulaByName=function(a,b,c){var d,e,f=this;f.kj.ITa.zTa&&(d=f.kj.ITa.zTa.formulas,d||(d=f.kj.ITa.zTa.formulas={}),e=d.names,e||(e=d.names={}),e[a]=m({},e[a],{formula:b,oldFormula:c}))},b.prototype.refresh=function(){this.kj.repaint()},b.prototype.toJSON=function(a,b,c,d,e){var f,g,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=b,D=this.kj,E=a.data||{},F=!0,G=this.Cf(),H=this===D.ft,I=0;for(H&&(l=h.createMap(),m={},D.Q5J=H&&m),o=G.forceR1C1Formula,p=0;p<=c;p++)if(f=E.dataTable||{},g=C[p]){for(j=f[p],F=!j,j=j||{},q=0;q<=d;q++)if(i=g[q],r=i&&i.Lf,i&&(r||i.H$J)){k=j[q]||{};try{s=void 0,t=void 0,H&&r&&!i.Pf&&(u=r.R5J=r.R5J||U(D,r,p,q,!0,!1),u.indexOf("!")<0&&(v=l.get(u),!v||v.baseColumn>q?(t=G.unparse(this,i.Lf,p,q,!1,!0),t.indexOf("[")<0&&(o&&(t=u),l.set(u,{formula:t,baseRow:p,baseColumn:q}))):(s=v.obj,s?(w=m[s.si],w.lastRow=p,w.lastColumn=Math.max(q,w.lastColumn)):(s=v.obj={si:I},m[I]={formula:v.formula,baseRow:v.baseRow,baseColumn:v.baseColumn,lastRow:p,lastColumn:q},f[v.baseRow][v.baseColumn].formula=v.obj,I++)))),t=o&&r?s||r.R5J||U(D,r,p,q,!0,!1):i.H$J||s||t||G.unparse(this,r,p,q,!1,!0),i.Pf?i.Pf.row===p&&i.Pf.col===q&&(k.arrayInfo=i.Pf,k.formula=t):k.formula=t,F=!1,j[q]=k}catch(a){}}if(F){if(f!==E.dataTable)continue}else f[p]=j;E.dataTable=f}if(m&&(m.nextIndex=I),e){for(x=E.columnDataArray||[],y=0;y<e.length;y++)z=e[y],z&&z.Lf&&(A=this.Cf().unparse(this,z.Lf,0,y,!1,!0),B=x[y]||{},B.formula=A,x[y]=B);x.length>0&&(E.columnDataArray=x)}n(E)||(a.data=E)},b.prototype.bdK=function(a,b,c,e,f,g){var i,k,l,m,n,o,p,q,r,s,t,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R=v(a,d.XFileConstants.HbK),S=this.Cf();for(S.uMc=!0,o=this.kj,p=this===o.ft,s=0,p&&(q=h.createMap(),r={},o.Q5J=p&&r),t=a.lossless.exprs=[],z=0;z<=c;z++)if(i=b[z],l=R[z],i)for(l||(l=R[z]={}),A=0;A<=e;A++)if(k=i[A],m=l[A],B=k&&k.Lf,k&&B){n=!0,m||(m={});try{C=void 0,D=void 0,E=void 0,F=-1,G=k.Pf,G||(H=o.ITa.bIb.anchors,H[z]&&H[z][A]&&(I=H[z][A],G={row:z,rowCount:I.rowCount,col:A,colCount:I.colCount,isDynamicArray:!0},I.isValid||(G.isInvalid=!0))),p&&B&&!G&&(J=B.R5J=B.R5J||U(o,B,z,A,!0,!1),K=d.Util.KlK(g),(K||J.indexOf("!")<0)&&(L=q.get(J),!L||L.baseColumn>A?(D=S.unparse(this,k.Lf,z,A,!1,!0),(K||D.indexOf("[")<0)&&q.set(J,{formula:D,baseRow:z,baseColumn:A})):(C=L.obj,C?(M=r[C.si],M.lastRow=z,M.lastColumn=Math.max(A,M.lastColumn)):(C=L.obj={si:s},r[s]={formula:L.formula,baseRow:L.baseRow,baseColumn:L.baseColumn,lastRow:z,lastColumn:A},s++),E=C.si,D=void 0))),u(E)&&(D=k.H$J||D||S.unparse(this,B,z,A,!1,!0),g&&g.includeCalcModelCache&&(N=j.exprToJSON(B),k.Nf||(N.nw=1),t.push(N),F=t.length-1),D=x(y(D))),G?(G.row===z&&G.col===A&&(O=w(G),(G.isInvalid||!G.rowCount)&&O.indexOf(":")>0&&(O=O.substring(0,O.indexOf(":"))),m.f=D,m.r=O),G.isDynamicArray&&(m.a=1)):(m.f=D,m.d="shared",m.g=E,m.c=1),F!==-1&&(m.e=F)}catch(a){}l[A]=m}for(P in r)Object.prototype.hasOwnProperty.call(r,P)&&(Q=r[P],O=w(new d.Range(Q.baseRow,Q.baseColumn,Q.lastRow-Q.baseRow+1,Q.lastColumn-Q.baseColumn+1)),m=R[Q.baseRow][Q.baseColumn],m.r=O,m.g=parseInt(P,10));delete S.uMc},b}(h.CalcSource),b.SheetSource=M,M.prototype.getParserContext=function(a,b,c){return b=b||h.pf(0,0),new K(this.kj,a,b,c)},N=function(a){O(b,a);function b(b){var c=a.call(this,o)||this;return c.createSourceModel=function(a){return new h.CalcSourceModel(a,this)},c.Qu=b,c.RlK={},c}return b.prototype.addUsedCustomName=function(a){this.RlK[a]=1},b.prototype.getUsedCustomNames=function(){return this.RlK||{}},b.prototype.getCustomFunction=function(a){return this.Qu?this.Qu.getCustomFunction(a):o},b.prototype.getCustomName=function(a){var b=this.getCustomNameInfo(a);return b?b.getExpression():o},b.prototype.getCustomNameInfo=function(a){return this.Qu?this.Qu.getCustomName(a)||this.Qu.dJb(a):o},b}(h.CalcSource),b.SpreadSource=N;function T(a,b,c,e,f,g){var i,j=a&&a instanceof d.Worksheet&&a,k=new h.Parser;return c=c===p?0:c,e=e===p?0:e,i=new K(j,(!!f),h.pf(c,e)),g&&(i.culture=!0),k.parse(i,b)}b.formulaToExpression=T;function U(a,b,c,e,f,g){var i,j=a&&a instanceof d.Worksheet&&a,k=new h.Parser;return c=c===p?0:c,e=e===p?0:e,i=new K(j,(!!f),h.pf(c,e)),i.YSa=g,k.unparse(i,b)}b.expressionToFormula=U;function V(a,b,c,d,e){c===p&&(c=0),d===p&&(d=0);var f=T(a,b,c,d,e,!0);return W(a,f,c,d)}b.evaluateFormula=V;function W(a,b,c,d,e){var f,g,i=a.Cf();return c===p&&(c=a.getActiveRowIndex()),d===p&&(d=a.getActiveColumnIndex()),f=!0,e&&e.convertNullToZero!==p&&(f=e.convertNullToZero),g=a.yj(),i.Hg(g,b,h.pf(c,d),!1,f)}b.evaluateExpression=W;function X(a,b,c,d,e){var f,g,i,j=a.Cf();return c===p&&(c=a.getActiveRowIndex()),d===p&&(d=a.getActiveColumnIndex()),f=!0,e&&e.convertNullToZero!==p&&(f=e.convertNullToZero),g=a.yj(),i=h.pf(c,d),i.PhK=Math.random().toString(36).substring(2),j.QhK(g,b,i,f)}b.RhK=X;function Y(a,b,c,d,e){var f,j,k,l=a.row,m=a.col,n=a.row+a.rowCount-1,p=a.col+a.colCount-1,q=!1,r=!1,s=!1,t=!1;return arguments.length>=4&&(q=0!==(1&d),r=0!==(4&d),s=0!==(2&d),t=0!==(8&d),l-=q?b:0,n-=r?b:0,m-=s?c:0,p-=t?c:0),e&&(j=$(a,e,b),k=_(a,e,b),j&&k)?f=g.StructureReferenceResolver.create(e,j,k,a.col-e.dataRange().col,a.col+a.colCount-e.dataRange().col-1):(1===a.rowCount&&1===a.colCount?f=h.rf(o,o,l,m,q,s):(a.row<0&&(l=n=i.BAND_INDEX_CONST),a.col<0&&(m=p=i.BAND_INDEX_CONST),f=h.uf(o,o,l,m,n,p,q,s,r,t,b,c)),f)}b.rangeToExpression=Y;function Z(a){return a.indexOf("[")>=0&&a.indexOf("]")>1}b.isValidExternalReference=Z;function $(a,b,c){if(1===a.rowCount){if(b.hasHeadersRow()&&a.row===b.startRow())return 2;if(b.hasTotalsRow()&&a.row===b.endRow())return 8;if(c===a.row)return 1}else{if(b.hasHeadersRow()&&a.row===b.startRow()){if(a.rowCount===b.dataRange().rowCount+1)return 6;if(b.hasTotalsRow()&&a.rowCount===b.dataRange().rowCount+1+1)return 14}if(a.row===b.dataRange().row){if(a.rowCount===b.dataRange().rowCount)return 3;if(b.hasTotalsRow()&&a.rowCount===b.dataRange().rowCount+1)return 12}}return p}function _(a,b,c){return a.col===b.startColumn()&&a.colCount===b.dataRange().colCount?1:1===a.colCount?2:a.col>=b.startColumn()&&a.col+a.colCount-1<=b.endColumn()?4:p}function aa(a,b,c,d,e){var f=Y(a,b,c,d),g=new K(o,(!!e),h.pf(b,c)),i=new h.Parser,j=i.unparse(g,f);return g.no(),j}b.rangeToFormula=aa;function ba(a,b,c,d,e,f,g){var i=Y(b,c,d,e,g),j=new K(a,(!!f),h.pf(c,d)),k=new h.Parser;return k.unparse(j,i)}b.rangeToFormulaWithStructReference=ba;function ca(a,b,c,e){var f,g,i,j,k,l,m,n,o,p,q;if(!b)return null;if(c=c?c:0,e=e?e:0,f=a.Cf(),g=f.parse(a.yj(),b,c,e,!0,!0),j=!1,g)if(7===g.type&&"ANCHORARRAY"===g.functionName&&(g=g.arguments[0],j=!0),i=g.source,i&&13===g.type);else if(1===g.type&&g.endSource){for(k=g.source,l=g.endSource,m=k.getSources(l),n=!1,o=0;o<m.length;o++)if(m[o]===a.yj()){n=!0;break}g=n&&g}return!g||!g.getRange||i&&i!==a.yj()?null:(p=g.getRange(c,e))?(j&&(q=new h.CalcReference(a.ft,[p]).getSpillRef(),q&&q.yf&&(p=q.yf[0])),new d.Range(p.row,p.col,p.rowCount,p.colCount)):null}b.formulaToRange=ca;function da(a,b,c,e,f,i){var j,k,l,m,o,q,r,s,t,v,w=[],x=[];if(!b)return w;for(j={},c=c||0,e=e||0,k=new h.Parser,l=g.qzb(k,b,a,c,e,p,f,i),m=0;m<l.length;m++)if(o=l[m].sheetRanges,o&&!n(o))for(q=0;q<o.sheets.length;q++)for(r=o.sheets[q],x=j[r],x||(j[r]=x=[],w.push({sheetName:r,ranges:x})),s=o[r],t=0;t<s.length;t++)v=s[t],u(v)||x.push(new d.Range(v.row,v.col,v.rowCount,v.colCount));return w}b.formulaToRanges=da;function ea(a,b,c,d,e){var f=new h.Parser,g=new K(o,(!!e),h.pf(b,c)),i=fa(f,g,a,b,c,d);return g.no(),i}b.rangesToFormula=ea;function fa(a,b,c,d,e,g,h){var i,j,k,l,m="";for(i=0;i<c.length;i++)j=Y(c[i],d,e,g),k=a.unparse(b,j),i>0?(l=h&&f.Common.CultureManager.q4().NumberFormat.listSeparator||",",m+=l+" "+k):m+=k;return m}b.TLb=fa,b.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15};function ga(a,b,c,d,e,g,h){var i,j,k,l,m=d.getValue(b,c),n=!1,o=100,p=.001,q=.01,r=(A(m)?+m:0)-h,s=d.getValue(e,g),u=(A(s)?+s:0)-h;if(A(s)&&Math.abs(u)<p)n=!0;else if(t(s))n=!1;else for(i=r+(0===r?q:q*r),k=0;!n&&k<o;k++)i=f.Common.o.Lma(i,13),a.setValue(b,c,i),s=d.getValue(e,g),j=(A(s)?+s:0)-h,A(s)&&Math.abs(j)<p?n=!0:t(s)?i=(r+i)/2:r-i===0?i=r+(0===r?q:q*r):u-j===0?i=r+2*(i-r):(l=i-j*(r-i)/(u-j),r=i,u=j,i=l);return n||a.setValue(b,c,m),n}b.goalSeek=ga},"./dist/plugins/sheetsCalc/calc.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("Core");b.BAND_INDEX_CONST=-2147483648,b.MAX_ROW_COUNT=d.XmlConstants.M7,b.MAX_COLUMN_COUNT=d.XmlConstants.L7},"./dist/plugins/sheetsCalc/external-reference.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("CalcEngine"),g=e.Common.j,h=d.XFileConstants.abK,i=d.XFileConstants.dbK,j=void 0,k=null,l=e.Common.D,m=g.Fa,n=d.Util.XaK,o=d.Util.YaK,p=/^'?\[\d+\]/;function t(a,b,c,d){var e=a&&a[b];return e&&e[c]&&e[c][d]}function u(a,b,c,d){var e,f=a.sheets[b]&&a.sheets[b].data.dataTable,g=f&&f[c]&&f[c][d]&&f[c][d].value;return g&&g.richText?(e="",g.richText.forEach(function(a){e+=a.text}),e):g}q=function(a){s(b,a);function b(b,c,d){var e,g,h,i=a.call(this,k)||this;return i.getSheetRangeReference=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a];return f.Errors.Name},e=b.split("]"),d&&(g=e[0].substring(1)),c.K$J[g]?i.xf=c.K$J[g]:(h=e[0].indexOf("["),i.xf=c.t9J(e[0].substring(h+1),e[0].substring(0,h),!0)),i.u4=e[1],i.J$J=c,i}return b.prototype.Ig=function(a,b,c){var d,e=a.getKey();this.xf=this.J$J.u9J(this.xf),this.vv(),d=this.J$J.L$J[this.xf.i]=this.J$J.L$J[this.xf.i]||{},b?d[e]?d[e][1].push(c):d[e]=[a,[c]]:d[e]&&delete d[e]},b.prototype.vv=function(){this.xf.data=this.xf.data||{};var a=this.xf.data[this.u4];return a||(this.xf.sheetNames.push(this.u4),a=this.xf.data[this.u4]={},a.isNew=!0),a},b.prototype.getValue=function(a,b){var c,d=this.vv(),e=d[a];return e||(e=d[a]={}),m(e[b])&&(e[b]=j),d.isNew?f.Errors.Reference:(c=e[b],c&&c._code&&(c._error||c._calcError)?new f.CalcError(c._error||c._calcError):c)},b.prototype.getRowCount=function(){return f.MAX_ROW_COUNT},b.prototype.getColumnCount=function(){return f.MAX_COLUMN_COUNT},b.prototype.createSourceModel=function(){return k},b.prototype.getCalcSourceModel=function(){return k},b.prototype.setCalcSourceModel=function(){},b.prototype.getSources=function(a){return[]},b.prototype.referenceToArray=function(a,b,c,d,e,g,h,i){var l,m,n,o,p,q,r,s,t,u,v,w,x,y=this,z=1,A=1,B=[],C=a.getRangeCount();if(0===C)return B.isError=!0,B;for(r=y.getRowCount(),s=y.getColumnCount(),c=c===j||c,t=0;t<C;t++){if(c||(q=[],B.push(q)),n=a.getRow(t),o=a.getColumn(t),z=a.getRowCount(t),0===z)return B.isError=!0,B;if(z===-1&&(n=0,z=r),A=a.getColumnCount(t),0===A)return B.isError=!0,B;if(A===-1&&(o=0,A=s),n>=r||o>=s)return B=c?[k]:[[k]],B.rowCount=1,B.colCount=1,B.rangeCount=1,B;for(n+z>r&&(z=r-n),o+A>s&&(A=s-o),u=void 0,v=!1,w=0;w<z;w++)for(l=n+w,c||(u=[],q.push(u)),x=0;x<A;x++)m=o+x,p=y.getValue(l,m),v||(p=f.Convert.wf(p,b,!f.ExcelCompatibleCalcMode,g,i),d&&f.Convert.vf(p)&&(B=[p],B.isError=!0,v=!0),f.Convert.j$a(p,g)||(c?B.push(p):u.push(p)));if(v)return B}return c||1!==C||(B=B[0]),B.rowCount=z,B.colCount=A,B.rangeCount=C,B},b.prototype.getName=function(a){return this.J$J.L$J[this.xf.i]&&(!this.xf||a&&a.Eh)?"["+this.xf.i+"]"+this.u4:this.xf.option.path+"["+this.xf.option.name+"]"+this.u4},b.prototype.getIdentity=function(a,b){var c=this,d=b.row,e=b.rowCount||1,f=b.column,g=b.columnCount||1;return d===-1&&(d=0,e=c.getRowCount()),f===-1&&(f=0,g=c.getColumnCount()),c.getName(a)+"."+d+"."+e+"."+f+"."+g},b}(f.CalcSource),b.ExternalSource=q;function v(a,b){var c,d,e;if(a)for(c in a)l(a,c)&&(d=a[c],e=d.getExpression(),e&&e.forEachNodes(function(a){(1===a.type||5===a.type)&&a.source instanceof q&&(b[a.source.mi]=!0)}))}function w(a,b){var c=a.getRange(b.row,b.column);return c.sheetName=a.source.u4,c}r=function(){function a(a){this.K$J=a||{},this.L$J={},this.v9J()}return a.prototype.parseSource=function(a,b){return new q(a,this,b)},a.prototype.t9J=function(a,b,c,d){var e,f;for(e in this.K$J)if(l(this.K$J,e)&&(f=this.K$J[e],f&&f.option.name===a&&f.option.path===b))return f;if(!c)for(e in this.K$J)if(l(this.K$J,e)&&(f=this.K$J[e],f.option.name===a&&""===b))return f;return d?j:{option:{name:a,path:b},sheetNames:[],data:{}}},a.prototype.v9J=function(){for(var a in this.K$J)this.K$J[a]&&(this.K$J[a].i=a)},a.prototype.u9J=function(a){var b,c=this.t9J(a.option.name,a.option.path,!0,!0);return c?c:(b=Object.keys(this.K$J).length+1,
this.K$J[b]=a,a.i=b,a)},a.prototype.r9J=function(a){var b,c,e,f={},g={},h=1;for(c in this.K$J)if(l(this.K$J,c)){if((!this.L$J[c]||d.GC$.isEmptyObject(this.L$J[c]))&&(b||(b={},v(a.Tu,b),a.sheets.forEach(function(a){v(a.Tu,b)})),!b[c]))continue;e=this.K$J[c],e.i=h,f[h]=e,g[h]=this.L$J[c],h++}this.K$J=f,this.L$J=g},a.prototype.toJSON=function(){var a,b,c={};for(a in this.K$J)l(this.K$J,a)&&(b=this.K$J[a],c[a]={option:{name:b.option.name,path:b.option.path},sheetNames:b.sheetNames,data:b.data});return c},a.prototype.bdK=function(a){var b,c=this.K$J,e=[],f={n_:"externalReferences",c_:e},g={},k=a.workbook.rels,m=0,p=function(a){var b,f,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;if(l(c,a)){for(m++,b=c[a],f=b.option.id=h+n(k),k.c_.push({n_:i,Id:f,Type:d.RelationshipConstants.A7,Target:o(d.XFileConstants.qbK+"/"+d.XFileConstants.pbK+a)}),e.push({n_:"externalReference","r:id":f}),p=[],q={n_:"sheetNames",c_:p},r={n_:"sheetDataSet",c_:[]},s=b.sheetNames,s&&s.forEach(function(a){p.push({n_:"sheetName",val:a})}),t=b.data,u=0,v=s.length;u<v;u++){if(w=t[s[u]],x={n_:d.XFileConstants.HbK,sheetId:u},w)if(w.isNew)x.refreshError=1;else{y=[];for(z in w)if(w.hasOwnProperty(z)){if(A=parseInt(z,10)+1,isNaN(A))continue;B=w[z],C=[],D={n_:"row",r:A,c_:C};for(E in B)B.hasOwnProperty(E)&&B[E]!==j&&(F=B[E],G={n_:"cell"},G.r=d.IndexHelper.R9(parseInt(E,10))+A,"string"==typeof F?G.t="str":"boolean"==typeof F?(G.t="b",F=F?"1":"0"):F&&F._code&&(G.t="e",F=F._calcError||F._error,"#SPILL!"!==F&&"#CALC!"!==F||(F="#VALUE!")),G.c_=[{n_:"v",c_:[F]}],C.push(G));y.push(D)}x.c_=y}r.c_.push(x)}g[f]={n_:"externalLink",r_:[13,14,1,21],c_:[{n_:"externalBook","r:id":"rId1",r_:[8],c_:[q,r]}],option:b.option}}};for(b in c)p(b);return{externalReferencesNode:f,externalLinks:g,count:m}},a.prototype.ViK=function(a,b,c){var d,e,f,g,h,i=b&&b.sheets&&Object.keys(b.sheets),k=i&&b.sheets[i[0]].data&&b.sheets[i[0]].data.dataTable,n=k?u:t,o=this.t9J(a,c||"",j,!0);if(!m(o)){d=o.i,e=this.K$J[d],e.sheetNames.forEach(function(a){var c,d,f=k?b.sheets[a]:b[a];f&&delete e.data[a].isNew;for(c in e.data[a])if(l(e.data[a],c))for(d in e.data[a][c])l(e.data[a][c],d)&&(e.data[a][c][d]=n(b,a,c,d))}),f=this.L$J[d]||{};for(g in f)l(f,g)&&(h=f[g][0],h.fh())}},a.prototype.VF=function(a,b,c){var d,e=this;"string"==typeof a?e.ViK(a,b,c):a&&(d=e.N$J(!0),d.forEach(function(b){a[b.filePath+b.name]&&e.ViK(b.name,a[b.filePath+b.name],b.filePath)}))},a.prototype.N$J=function(a){var b,c,d,e,f,g,h=[];for(b in this.K$J)if(l(this.K$J,b)){if(c=this.K$J[b],d={name:c.option.name,filePath:c.option.path},a){e=this.L$J[b]||{},d.items=[],f=function(a){var b,c,f,g;l(e,a)&&(b=e[a][0],c={row:b.row,col:b.column,sheetName:b.ah.xf.getName()},f=e[a][1],g=1===f.length?w(f[0],b):f.map(function(a){return w(a,b)}),d.items.push({target:c,source:g}))};for(g in e)f(g)}h.push(d)}return h},a}(),b.ExternalReferenceManager=r},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;Object.defineProperty(b,"__esModule",{value:!0}),d=c("CalcEngine"),e=c("Common"),f=c("./dist/plugins/sheetsCalc/calc.ns.js"),g=c("./dist/plugins/sheetsCalc/parser-sheets.js"),h=c("Core"),i=e.Common.j.Ia,j=e.Common.j.Fa,k=e.Common.u,l=k.Nb,m=Math.min,n=Math.max,o=void 0,p=null,q=d.Convert.vf,r=d.Errors.Reference,s=h.util.l_a;function x(a,b){var c,d,e,f;return b||(b=this),c=n(a.row,b.row),d=n(a.column,b.column),e=m(a.row+a.rowCount,b.row+b.rowCount),f=m(a.column+a.columnCount,b.column+b.columnCount),c>=e||d>=f?p:{row:c,column:d,rowCount:e-c,columnCount:f-d,intersectWith:x}}t=function(){function a(a,b,c,d,e,f,g,h){var i=this;i.Rj=a,i.Vj=b,i.Wj=c,i.Qj=d,i.Tj=e,i.Uj=f,i.Xj=g,i.Yj=h}return a.prototype.Nj=function(a){var b,c,d=this,e=d.Qj.kj;return d.HPJ=e&&e.CMc(),d.HPJ&&a>=0?(b=a-d.Tj+1,c=e.EMc(d.Tj,b,!0),d.Tj-d.Vj+c):d.Tj-d.Vj},a.prototype.Oj=function(a){var b,c,d=this,e=d.Qj.kj;return d.HPJ=e&&e.CMc(),d.HPJ&&a>=0?(b=a-d.Uj+1,c=e.EMc(d.Uj,b),d.Uj-d.Wj+c):d.Uj-d.Wj},a.prototype.Sj=function(a,b,c,d,e){var f=this;return f.Rj===a&&(f.Vj===-1||f.Vj<=b&&b+d<=f.Vj+f.Xj)&&(f.Wj===-1||f.Wj<=c&&c+e<=f.Wj+f.Yj)},a.prototype.Pj=function(a,b,c,d,e){var f=this,g=f.Qj.kj,h=g&&g.CMc(),i=f.Tj,j=f.Uj,k=f.Xj,l=f.Yj;return h&&(k+=g.DMc(i,k,!0),l+=g.DMc(j,l)),f.Qj===a&&(i===-1||i<=b&&b+d<=i+k)&&(j===-1||j<=c&&c+e<=j+l)},a.prototype.intersectWith=function(a,b,c,d,e){var f,g,h=this;return h.Qj!==a?p:(f=h.Zj(a,b,c,d,e),g=h.Zj(a,h.Vj,h.Wj,d,e),g.intersectWith(f))},a.prototype.Zj=function(a,b,c,d,e){var f=b===-1?0:b,g=b===-1||d===-1?a.rowCount:d,h=c===-1?0:c,i=c===-1||e===-1?a.colCount:e;return{row:f,column:h,rowCount:g,columnCount:i,intersectWith:x}},a}(),b.MoveSwapInfo=t;function y(a,b,c,d){return(!d||a<b)&&c}function z(a){return[a.row,a.col,a.rowCount,a.colCount].join(",")}function A(a,b,c,d){var e=a[b];e||(e=a[b]={}),e[c]=d}function B(a,b,c){var d=a[b];return!!d&&d[c]}u=function(){function a(){}return a.zj=function(b,c,e,g,h,i,j,k,l,n,o){var p,q,s,t,u,v,w=e,x=a,y=this.zj;if(!e)return w;if(s=e.type,10===s)w=d.Lh(y.call(x,b,c,e.value,g,h,i,j,k,l,n,o));else if(1===s&&e.sf()){if(p=m((e.source||c).getRowCount(),f.MAX_ROW_COUNT),q=m((e.source||c).getColumnCount(),f.MAX_COLUMN_COUNT),e.rowRelative&&(e.row+g<0||e.row+g>=p)||e.columnRelative&&(e.column+h<0||e.column+h>=q))return d.Hh(r,e.source);w=e.offset(0,0,!1)}else if(1===s){if(p=m((e.source||c).getRowCount(),f.MAX_ROW_COUNT),q=m((e.source||c).getColumnCount(),f.MAX_COLUMN_COUNT),t=e,t.rowRelative&&!e.isFullColumn&&(t.row+g<0||t.row+g>p)||t.columnRelative&&!e.isFullRow&&(t.column+h<0||t.column+h>q)||t.endRowRelative&&!e.isFullColumn&&(t.endRow+g<0||t.endRow+g>p)||t.endColumnRelative&&!e.isFullRow&&(t.endColumn+h<0||t.endColumn+h>q))return d.Hh(r,e.source,e.endSource);w=e.offset(0,0,!1,g,h)}else if(9===e.type)w=d.Kh(e.operatorType,y.call(x,b,c,e.value,g,h,i,j,k,l,n,o),e.value2&&y.call(x,b,c,e.value2,g,h,i,j,k,l,n,o));else if(7===s){if(u=[],e.arguments&&e.arguments.length>0)for(v=0;v<e.arguments.length;v++)u[v]=y.call(x,b,c,e.arguments[v],g,h,i,j,k,l,n,o);w=d.Jh(e,u)}else 13===s&&(w=e.offsetWhenCopy(b,c,g,h,i,j,k,l,n,o));return w},a.copyFormula=function(b,c,e,f,g,h,i,j,k,l){var n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z=b,$=f,_=b.getSource(),aa=f.getSource(),ba=a;if(Z&&$){for(n=aa&&aa.getSheet().ITa.dUa(),p=c,q=e,r=g,s=h,t=i,u=j,c<0&&(p=0,t=m(b.rC(),f.rC())),e<0&&(q=0,u=m(b.cC(),f.cC())),g<0&&(r=0),h<0&&(s=0),v=new d.CalcSourceModel(b.Cf(),_),A=aa.getSheet(),B=!l&&A.CMc(),C=t,D=u,E=A.getRowCount(),F=A.getColumnCount(),w=0;w<t;w++)for(x=0;x<u;x++)Z.Uf(v,w+p,x+q,w,x);for(G={},H=f.Cf(),w=0,y=0;w<t&&w+r<E;w++)if(I=w+r,B&&0===A.getRowHeight(I))t++;else if(k&&aa.isHiddenRow(I,!0))y++;else{for(x=0,z=0,u=D;x<u&&x+s<F;x++)if(J=x+s,B&&0===A.getColumnWidth(J))u++;else{if(K=v.Kf(y,z)){if(K===G)continue;if(L=g+w-c-y,M=h+x-e-z,K=ba.zj(_,aa,K,I,J,L,M,g,h,C,D),N=v.Qf(y,z),aa){if(B&&N)continue;if(N&&!N.isDynamicArray){for(O=N.rowCount,P=N.colCount,Q=p-N.row,Q>0&&(O-=Q),R=t-w,R<O&&(O=R),S=q-N.col,S>0&&(P-=S),T=u-x,T<P&&(P=T),U=0;U<O;U++)for(V=0;V<P;V++)v.Rf(w+U,x+V,G);f.setArrayFormula(I,J,O,P,H.unparse(aa,K,I,J),o,n)}else W=K?H.unparse(aa,K,I,J):o,aa.setFormula(I,J,W,o),X=v.Mf(y,z),X&&(Y=new d.EvaluateContext(aa,d.pf(I,J),(!1)),X=$.Af.allowDynamicArray?d.Mh(Y,K,!1,0,0,!0,!0):d.qJJ(Y,K,!1,0,0,!1,!1),X=X===K?o:X),$.ig(I,J,K,X,N,n)}else $.Rf(I,J,K),$.Xf(I,J,N)}else $&&$.Kf(I,J)&&$.ig(I,J,o,o,o,n);z++}y++}}},a.moveFormula=function(a,b,c,d,e,f,g,i){var j,k,l,n,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=a.Bj(),P=d.Bj(),Q=O.Cf();if(O&&P){for(j=d.getRowCount(),k=d.getColumnCount(),l=O.dUa(),n=P.dUa(),q=Q.ih(),b<0&&(b=0,g=m(a.getRowCount(),j)),e<0&&(e=0),c<0&&(c=0,i=m(a.getColumnCount(),k)),f<0&&(f=0),r=!(a===d&&a.name()===d.name()),s=g,t=i,u=g,w=d.CMc(),w&&(s+=d.DMc(e,g,!0),t+=d.DMc(f,i)),O.Sg(b,c,g,i),qa(O,b,c,g,i),P.Sg(e,f,s,t),qa(P,e,f,s,t),x=[],y=0;y<g;y++)for(z=0;z<i;z++)A=O.Kf(y+b,z+c),B=O.Qf(y+b,z+c),C=O.Mf(y+b,z+c),A?(x.push({Lf:A,Pf:B,Nf:C}),O.Sf(y+b,z+c,l),(!B||B&&y+b===B.row&&z+c===B.col)&&O.xf.setFormula(y+b,z+c,p,o)):x.push(p);for(G=r?{}:null,y=0,D=0;y<u&&y+e<j;y++)if(H=y+e,w&&0===d.getRowHeight(H))u++;else{for(z=0,E=0,v=i;z<v&&f+z<k;z++)if(I=z+f,w&&0===d.getColumnWidth(I))v++;else{if(J=x[D*i+E]){if(A=J.Lf,B=J.Pf,w&&B){E++;continue}Q&&B&&!B.isDynamicArray&&B.row===b+y&&B.col===c+z&&(F=h.kf(H,I,B.rowCount,B.colCount)),K=B&&!B.isDynamicArray?F:o,C=J.Nf,P.FTa(n,H,I),P.Rf(H,I,A),P.Xf(H,I,K),P.Wf(H,I,C),(!K||K&&K.row===H&&K.col===I)&&(L=P.getFormula(H,I),P.xf.setFormula(H,I,L,K)),r&&(G[H+", "+I]=A)}else P.FTa(n,H,I),P.Rf(H,I,o),P.Xf(H,I,o);E++}D++}q.Dj(O,b,c,g,i),q.Dj(P,e,f,s,t),M=O.getSource().getSheet(),N=M.uja&&(M.parent||M).tja(),q.Ej(N,O.getSource(),b,c,P.getSource(),e,f,g,i,!0,G),r===!0&&q.Ej(N,O.getSource(),b,c,P.getSource(),e,f,g,i,!0,G)}},a.prototype.isAdjustCell=function(a){return a.preAdj||this.imb&&a===this.imb[0]},a.prototype.isAdjust=function(a){return a.preAdj||this.imb&&a===this.imb[0]},a.prototype.hh=function(a,b){var c=this,d,e;isNaN(b)||(c.imb||(c.imb={},c.jmb={}),d=c.imb[b],e=c.jmb[b],a&&!a.preAdj&&a!==d&&(d?e.nextAdj=a:c.imb[b]=a,a.preAdj=e,a.nextAdj=p,c.jmb[b]=a))},a.prototype.Fj=function(a,b){var c,d,e,f=this;isNaN(b)||(c=f.imb&&f.imb[b],a&&(a.preAdj||a===c)&&(d=a.preAdj,e=a.nextAdj,d?d.nextAdj=e:f.imb[b]=e,e?e.preAdj=d:f.jmb[b]=d,a.preAdj=p,a.nextAdj=p))},a.prototype.Gj=function(a,b,c,d,e,f,g){this.Hj(a,G,b,c,d,e,f,g);var h=0,i=0,j=0,k=0;0===b&&(d&&e?j=c:d?h=c:e?k=c:i=c),H(a,G,b,c,h,i,j,k,d,e,f),K(a,G,b,c,d,e)},a.prototype.Hj=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,p,q,r,s,t,u,v,w,x,z,C,D,E,F=this,G=F.imb;if(G){for(q={};G[0];)if(m=G[0],i=m.ah,p=i.dUa(),n=i.getSource(),j=m.row,k=m.column,B(q,j,k))F.Fj(m,0);else{if(l=i.Kf(j,k),!l||b===R&&n===a)(i.getRowExpression&&i.getRowExpression(j)||i.getColumnExpression&&i.getColumnExpression(k))&&i.Ag(j,k,1,1);else if(l=b.call(F,n,j,k,l,a,c,d,e,f,o,g,h),r=i.Qf(j,k)){if(n===a&&(s=f?d:-d,e?c<=r.row&&(r.row+=s):c<=r.col&&(r.col+=s)),j===r.row&&k===r.col)if(r.isDynamicArray)i.fg(j,k,l,r,!0,y(e?j:k,c,p,a.id===n.id));else for(t=j;t<j+r.rowCount;t++)for(q[t]||(q[t]={}),u=k;u<k+r.colCount;u++)i.fg(t,u,l,r,t===j&&u===k,y(e?t:u,c,p,a.id===n.id)),A(q,t,u,!0)}else i.fg(j,k,l,r,!0,y(e?j:k,c,p,a.id===n.id));F.Fj(m,0)}for(;G[1];)m=G[1],i=m.ah,p=i.dUa(),j=m.row,i.getRowExpression&&(l=i.getRowExpression(j),l&&i.fg&&(n=i.getSource(),i.fg(j,-1,b.call(F,n,j,-1,l,a,c,d,e,f),o,!0,y(j,c,p,a.id===n.id)))),F.Fj(m,1);for(;G[2];)m=G[2],i=m.ah,p=i.dUa(),k=m.column,i.getColumnExpression&&(l=i.getColumnExpression(k),l&&i.fg&&(n=i.getSource(),i.fg(-1,k,b.call(F,n,-1,k,l,a,c,d,e,f),o,!0,y(k,c,p,a.id===n.id)))),F.Fj(m,2);for(;G[3];)v=G[3],w=v.name,i=v.ah,l=i.DTa(w),x=b.call(F,i.getSource(),0,0,l,a,c,d,e,f,{isNameID:!0}),i.gg(w,x),F.Fj(v,3);for(z in G)if(C=+z,C>3&&G.hasOwnProperty(z))for(;G[z];)D=G[z],E=D.ah,l=b.call(F,E,0,0,D.expression,a,c,d,e,f),E.setExpression(D.id,D.name,l),F.Fj(D,C)}},a.prototype.ph=function(a){var b=this,c=a.getCalcSourceModel(),d=a.getRowCount(),e=a.getColumnCount();qa(c,0,0,d,e),b.Hj(a,R),H(a,R,0,0,0,0,0,0,!0,!1),K(a,R,0,0,!0,!1)},a.prototype.Ej=function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,p,q,r,s,u,v,w,x,y,C,D,E,F,G,H,I,J,K,L,N=this,O=ma,P=new t(b,c,d,e,f,g,h,i),Q={};if(a&&na(a,P,j),M(b,P,j),s=N.imb,v={},s){for(;s[0];)if(m=s[0],l=m.ah,n=m.row,p=m.column,r=l.dUa(),B(Q,n,p))N.Fj(m,0);else{if(q=l.Kf(n,p),u=l.getSource(),q)if(w=o,k&&k[n+", "+p]&&(u=b,w={crossSheetMoved:!0}),q=O.call(N,u,n,p,q,P,j,w),x=l.Qf(n,p),y=void 0,x&&!x.isDynamicArray)if(y=z(x),n===x.row&&p===x.col)for(v[y]=!0,C=n;C<n+x.rowCount;C++)for(Q[C]||(Q[C]={}),D=p;D<p+x.colCount;D++)l.fg(C,D,q,x,C===n&&D===p,r),A(Q,C,D,!0);else v[y]||(l.fg(n,p,q,x,!1,r),A(Q,n,p,!0));else l.fg(n,p,q,x,!0,r);else(l.getRowExpression&&l.getRowExpression(n)||l.getColumnExpression&&l.getColumnExpression(p))&&l.Ag(n,p,1,1);N.Fj(m,0)}for(;s[1];)m=s[1],l=m.ah,n=m.row,r=l.dUa(),l.getRowExpression&&(q=l.getRowExpression(n),q&&l.jg&&l.jg(n,O.call(N,u,n,-1,q,P,j),o,r)),N.Fj(m,1);for(;s[2];)m=s[2],l=m.ah,p=m.column,r=l.dUa(),l.getColumnExpression&&(q=l.getColumnExpression(p),q&&l.kg&&l.kg(p,O.call(N,u,-1,p,q,P,j),o,r)),N.Fj(m,2);for(;s[3];)E=s[3],F=E.name,l=E.ah,q=l.DTa(F),G=O.call(N,u,0,0,q,P,j),l.gg(F,G),N.Fj(E,3);for(H in s)if(I=+H,I>3&&s.hasOwnProperty(H))for(;s[H];)J=s[H],K=J.ah,L=K.getSource(),q=O.call(N,L,0,0,J.expression,P,j),K.setExpression(J.id,J.name,q),N.Fj(J,I)}},a.prototype.Dj=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=b+d,m=c+e;for(h=b;h<l;h++)for(i=c;i<m;i++)f=a.Yf(h,i),g=a.Kf(h,i),(f||g)&&(k.Fj(f,0),a.Q3(h,i,0),j=a.qg(h,i,!0),f&&g&&(f.row!==j.row||f.column!==j.column)&&(j.oldRow=f.row,j.oldColumn=f.column),k.hh(j,0))},a.prototype.Ij=function(a,b,c){var d,e,f=this;for(d=b;d!==-1&&d<b+c;d++)(a.Yf(-1,d)||a.Kf(-1,d))&&(a.Q3(-1,d,2),e=a.sg(d,!0),f.hh(e,2))},a.prototype.Jj=function(a,b,c){var d,e,f=this;for(d=b;d!==-1&&d<b+c;d++)(a.Yf(d,-1)||a.Kf(d,-1))&&(a.Q3(d,-1,1),e=a.rg(d,!0),f.hh(e,1))},a.prototype.Kj=function(a){var b,c,e,f,g,h=this,i=a.Cf().getAllSourceModels();for(e=0;e<i.length;e++)if(f=i[e],f.lmb)for(b=f.lmb(),g=0;g<b.length;g++)c=b[g],c&&c.isVolatile&&c instanceof d.CellCalc&&!h.isAdjustCell(c)&&h.hh(c,0)},a.prototype.onBeforeAddRemoveRows=function(a,b,c){[a,c].forEach(function(a){if(a){var c=a.rC(),d=a.cC();a.Sg(b,0,c-b,d),a.Ug(b,c-b),qa(a,b,-1,c-b,-1,!0)}})},a.prototype.onAfterAddRemoveRows=function(a,b,c,d,e,f){var g=this;[a,f].forEach(function(a){if(a){var e=a.rC(),f=a.cC();d?a.Ag(b,0,c,f):e+=c,g.Dj(a,b,0,e-b,f),g.Jj(a,b,e-b),g.Kj(a)}}),g.Gj(a.getSource(),b,c,!0,d,o,e),a.Cf().autoCalculation&&a.Cf().recalculateAll(!1)},a.prototype.onAfterAddRemoveColumns=function(a,b,c,d,e,f){var g=this;[a,f].forEach(function(a){if(a){var e=a.rC(),f=a.cC();d?a.Ag(0,b,e,c):f+=c,g.Dj(a,0,b,e,f-b),g.Ij(a,b,f-b),g.Kj(a)}}),g.Gj(a.getSource(),b,c,!1,d,o,e),a.Cf().autoCalculation&&a.Cf().recalculateAll(!1)},a.prototype.onBeforeAddRemoveColumns=function(a,b,c){[a,c].forEach(function(a){if(a){var c=a.rC(),d=a.cC();a.Sg(0,b,c,d-b),a.Wg(b,d-b),qa(a,-1,b,-1,d-b,!0)}})},a.prototype.onAfterRemoveName=function(a,b){var c=a.wg(b,!1);c&&(c.updateListening(!0,!1),c.fh(),c.updateListeningOnRemoved())},a.prototype.adjustFormulaOnRemoveName=function(a,b,c){return ra(a,b,c)},a.prototype.invalidName=function(a,b){var c,d;b&&(c=a.getCalcSourceModel(),d=c.wg(b.toUpperCase(),!0),d&&d.Yg())},a.prototype.onAfterRemoveTable=function(b,c){var d,e,f,g,i,j,k,l,m,n,o,p,q=this;for(i=0;i<b.length;i++)j=b[i],qa(j.source().getCalcSourceModel(),j.startRow(),j.startColumn(),j.endRow()-j.startRow()+1,j.endColumn()-j.startColumn()+1);if(k=q.imb)for(l={};k[0];)if(m=k[0],d=m.ah,e=m.row,f=m.column,B(l,e,f))q.Fj(m,0);else{if(g=d.Kf(e,f))if(g=a.adjustExpressionOnRemoveTable(g,b,e,f,c),n=d.Qf(e,f),n&&!n.isDynamicArray)for(n=h.kf(e,f,n.rowCount,n.colCount),o=e;o<e+n.rowCount;o++)for(l[o]||(l[o]={}),p=f;p<f+n.colCount;p++)d.fg(o,p,g,n,o===e&&p===f),A(l,o,p,!0);else d.fg(e,f,g,n,!0);else(d.getRowExpression&&d.getRowExpression(e)||d.getColumnExpression&&d.getColumnExpression(f))&&d.Ag(e,f,1,1);q.Fj(m,0)}},a.adjustExpressionOnRemoveTable=function(b,c,e,f,g){var h,i,j,k,l,m,n,o,q,r,s,t,u,v,w,x,y,z=a.adjustExpressionOnRemoveTable;if(9===b.type){if(h=b.value,i=b.value2,j=z(h,c,e,f,g),k=i&&z(i,c,e,f,g),h!==j||i!==k)return d.Kh(b.operatorType,j,k)}else if(7===b.type){for(l=!1,m=[],n=0;n<b.arguments.length;n++)o=b.arguments[n],q=z(o,c,e,f,g),l=l||o!==q,m.push(q);if(l)return d.Jh(b,m)}else if(10===b.type){if(r=b,s=r.value,t=z(s,c,e,f,g),s!==t)return d.Lh(t)}else if(13===b.type)for(u=b,n=0;n<c.length;n++)if(u.baseTable===c[n])return g?d.Ih:(v=u.getRange(e===-1?0:e,f===-1?0:f,!0),w=e===-1||1===u.referencePortions(),x=1===v.rowCount&&1===v.columnCount,y=u.source,x?d.rf(y,p,v.row,v.col,w,!1):d.uf(y,p,v.row,v.col,v.row+v.rowCount-1,v.col+v.colCount-1,w,!1,w,!1));return b},a}(),b.CalcOperatorAdjustor=u,v=d.CalcService.prototype,v.uzb=function(){return new u};function C(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p;return c>=0||!e?(m=d+(e?c:0),n=f+(g?c:0),o=k&&O(h,a,k),p=!k&&O(h,a,k),(o||p)&&(!l&&i+j<=c||l&&i<=c)&&(m-=e?j:0,n-=g?j:0),o=k&&O(h,b,k),p=!k&&O(h,b,k),(o||p)&&(!l&&i<=m||l&&(e&&c+d>=i||!e&&d>=i)?(m+=j,n+=j):(!l&&i<=n||l&&(g&&c+f>=i||!g&&f>=i))&&(n+=j)),m-=e?c:0,n-=g?c:0,l&&i+j<=c&&(m+=e?j:0,n+=g?j:0),{index:m,endIndex:n}):{index:d,endIndex:f}}function D(a,b,c,e,f,g,h,i,j,k,l,m){if(b&&!m){var n=j?f.row:f.column,o=j?f.rowRelative:f.columnRelative,p=void 0;if(j&&c>=0||!j&&e>=0||!o){if(k)p=C(a,b,j?c:e,n,o,-1,!1,g,h,i,j,l).index;else if(p=N(a,b,j?c:e,n,o,g,h,i,j,l),q(p))return d.Hh(p);p!==n&&(f=f.offset(j?p-n:0,j?0:p-n,!0))}}return f}function E(a,b,c,e,f,g,h,i,j,k,l,m){var n,o,p,r,s,t,u,v;if(b&&!m){if(n=f.tf(),3===n||j&&2===n||!j&&1===n)return f;if(o=j?f.rowRelative:f.columnRelative,p=j?f.endRowRelative:f.endColumnRelative,r=j?f.row:f.column,s=j?f.endRow:f.endColumn,t=void 0,j&&c>=0||!j&&e>=0||!o||!p){if(k)t=C(a,b,j?c:e,r,o,s,p,g,h,i,j,l);else if(t=P(a,b,j?c:e,r,o,s,p,g,h,i,j,l),q(t))return d.Hh(t);u=t.index,v=t.endIndex,u===r&&v===s||(f=f.offset2(j?u-r:0,j?0:u-r,j?v-s:0,j?0:v-s,c,e))}}return f}function F(a,b,c,d,e,f,g,h,i,j){if(b){var k=e;if(k&&f===k.source)return k.offsetWhenInsertRemoveColumn(g,h,i,j)}return e}function G(a,b,c,e,f,g,h,i,j,k,l,m){var n,q,r,s,t,u,v,w,x=G,y=e;if(e){if(1===e.type&&e.sf())y=D(a,e.source||a,b,c,e,f,g,h,i,j,l,m);else if(1===e.type)y=E(a,e.source||a,b,c,e,f,g,h,i,j,l,m);else if(10===e.type)n=x(a,b,c,e.value,f,g,h,i,j,o,l,m),n!==e.value&&(y=d.Lh(n));else if(9===e.type)q=x(a,b,c,e.value,f,g,h,i,j,o,l,m),r=e.value2&&x(a,b,c,e.value2,f,g,h,i,j,o,l,m),q===e.value&&r===e.value2||(y=d.Kh(e.operatorType,q,r));else if(7===e.type){for(s=p,t=void 0,u=void 0,v=e,w=v.arguments.length,u=0;u<w;u++)if(t=v.arguments[u],n=x(a,b,c,t,f,g,h,i,j,o,l,m),n!==t){s=[],s[u]=n;break}if(s){for(u=0;u<w;u++)t=v.arguments[u],s[u]!==o&&s[u]!==p||(s[u]=x(a,b,c,t,f,g,h,i,j,o,l,m));y=d.Jh(v,s)}}else l&&!a.O$J||i||13!==e.type||(y=F(a,a,b,c,e,f,g,h,j,l));return y}}function H(a,b,c,d,e,f,g,h,i,j,k){var l=function(e,f,g,h){return b.call(this,e,g,h,f,a,c,d,i,j,o,k)},m=a.getSheet(),n=m.uja&&(m.parent||m).tja(),p=m.ITa&&m.ITa.dUa();I(n,l,i,p)}function I(a,b,c,d){var e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;if(a)for(k=0;k<a.length;k++){for(l=!0,m=!0,n=g.maxRowCount-1,o=g.maxColumnCount-1,e=a[k].validator,p=e.n5,q=0,r=p.length;q<r&&(s=p[q],t=s.rowCount,u=s.colCount,i=s.row,j=s.col,t!==-1&&(m=!1,n=n>i?i:n),u!==-1&&(l=!1,o=o>j?j:o),l||m);q++);if(!(c&&m||!c&&l)&&(h=a[k].sheet,v=h.yj(),f=e.condition(),w=f.getExpressions(),w&&w.length>0)){for(x=0;x<w.length;x++)y=w[x],w[x]=b(v,y,n,o);f.setExpressions(w,d)}}}function J(a){var b=[],c=a.parent,d=c&&c.sheets||[a];return d.forEach(function(a){var c=a.conditionalFormats,d=c&&c.getRules();d&&d.length&&d.forEach(function(c){c.xyb&&b.push({rule:c,sheet:a})})}),b}function K(a,b,c,d,e,f){var g=function(g,h,i,j){return b.call(this,g,i,j,h,a,c,d,e,f)},h=a.getSheet(),i=J(h),j=h.ITa&&h.ITa.dUa();L(i,g,j,e,f)}function L(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;if(a)for(f=0,g=a.length;f<g;f++){if(h=a[f].rule,i=h.ranges(),j=s(i),k=j.r,l=j.c,m=a[f].sheet,n=m.yj(),o=h.condition(),p=m.tables,p&&i&&1===i.length&&(q=i[0],r=q.row,t=q.col,u=q.rowCount,v=q.colCount,w=void 0,e&&d?w=p.WFc(r,t,u,v):m.mJb&&m.KFc&&(w=[m.KFc]),w&&w.length)){for(x=!1,y=0,z=w.length;y<z;y++)if(A=w[y],B=A.row,C=A.col,D=A.rowCount,E=A.colCount,r===B&&u===D&&t>=C&&t+v<=C+E){x=!0;break}if(x)continue}if(o||(h.initCondition(),o=h.condition()),F=o&&o.getExpressions(),F&&F.length>0){for(G=0;G<F.length;G++)H=F[G],F[G]=b(n,H,k,l);o.setExpressions(F,c)}}}function M(a,b,c){var d=function(a,d,e,f){return ma.call(this,a,e,f,d,b,c)},e=a.getSheet(),f=J(e);L(f,d,e.ITa.dUa())}function N(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o;if(c>=0||!e){if(k=d+(e?c:0),l=i&&O(f,a,i),m=!i&&O(f,a,i),(l||m)&&g<=c&&(k+=e?h:0),l=i&&O(f,b,i),m=!i&&O(f,b,i),l||m)if(n=c+d,o=c+h+d,!j&&g+h<=k||j&&n>=g+h)k-=h;else if(!j&&g<=k||j&&n>=g&&g<=o&&o<=g+h)return r;return k-=e?c:0,j&&g<=c&&(k-=e?h:0),k}return d}function O(a,b,c){var d=c?{2:!0}:{1:!0};return a===b||a.kj===b.kj&&(3===a.Wz&&d[b.Wz]||d[a.Wz]&&3===b.Wz)}function P(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,s,t;if(c>=0||!e){if(m=d+(e?c:0),n=f+(g?c:0),o=i+j-1,p=k&&O(h,a,k),q=!k&&O(h,a,k),(p||q)&&i<=c&&(m+=e?j:0,n+=g?j:0),p=k&&O(h,b,k),q=!k&&O(h,b,k),p||q)if(s=c+d,t=c+f,!l&&o<m||l&&o<s)m-=j,n-=j;else{if(!l&&i<=m&&o>=n||l&&i<=s&&o>=t)return r;!l&&i>n||l&&i>t||(!l&&o<=n||l&&o<=t?(m=!l&&i>=m||l&&i>=s?m:i,n-=j):n=i-1)}return m-=e?c:0,n-=g?c:0,l&&i<=c&&(m-=e?j:0,n-=e?j:0),{index:m,endIndex:n}}return{index:d,endIndex:f}}function Q(a,b,c){var e,f,g,h,i,j,k,m,n,q,r,s,t,u,v,w,x=Q,y=b;if(b)if(b.source)if(h=b.source,i=b.endSource,i&&h!==i){if(j=h.kj&&h.kj.parent,!j)return d.Ih;i===c?(k=c.fEc,y.endSource=j.getSheet(k-1).yj()):h===c&&(m=c.fEc,y.source=j.getSheet(m).yj()),delete c.fEc,y.source===y.endSource&&delete y.endSource}else(a!==c&&h===c||a===c&&h!==c)&&(y=d.Ih);else if(10===b.type)e=x(a,b.value,c),e!==b.value&&(y=d.Lh(e));else if(9===b.type)n=x(a,b.value,c),q=b.value2&&x(a,b.value2,c),n===b.value&&q===b.value2||(y=d.Kh(b.operatorType,n,q));else if(7===b.type){for(r=p,s=b.arguments.length,g=0;g<s;g++)if(f=b.arguments[g],e=x(a,f,c),e!==f){r=[],r[g]=e;break}if(r){for(g=0;g<s;g++)f=b.arguments[g],r[g]!==o&&r[g]!==p||(r[g]=x(a,f,c));y=d.Jh(b,r)}}else 8===b.type&&(t=a||c,u=l(b.value),v=t.getCustomName(u),v&&v.source?h=v.source:(w=t.Af.getGlobalSourceModel()||t.getCalcSourceModel(),v=w.getSource().getCustomName(u),v&&v.source&&(h=v.source)),h&&(a!==c&&h===c||a===c&&h!==c)&&(y=d.Ih));return y}function R(a,b,c,d,e){return Q(a,d,e)}function S(a,b){return a.Qj===a.Rj&&b!==a.Qj}function T(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,q,r,s=!!e.source,t=e.source||a,u=e.rowRelative,v=e.columnRelative,w=b,x=c,y=f.Qj.kj;if(g&&g.isCustomName&&(l=e.row,m=e.column,w=f.Tj+(l-f.Vj)+y.DMc(f.Tj,l-f.Vj+1,!0),x=f.Uj+(m-f.Wj)+y.DMc(f.Uj,m-f.Wj+1)),n=f.Nj(w),o=f.Oj(x),(b>=0||!u)&&(c>=0||!v)){if(h=e.row+(u?b:0),i=e.column+(v?c:0),g&&g.isNameID||a===f.Rj&&(a===f.Qj?k=f.Pj(f.Qj,b,c,1,1):(q=b,r=c,g&&g.crossSheetMoved&&(q-=n,r-=o),k=f.Sj(f.Rj,q,r,1,1))),t===f.Qj&&f.Pj(t,h,i,1,1)&&!f.Sj(t,h,i,1,1)&&(!u&&!v||!k))return d.Ih;if(j=(s&&t===f.Rj||!s&&a===f.Rj)&&(!k&&f.Sj(f.Rj,h,i,1,1)||k&&f.Pj(f.Qj,u?h:h+n,v?i:i+o,1,1)),k&&(h-=u?n:0,i-=v?o:0),j&&(h+=n,i+=o),h-=u?b:0,i-=v?c:0,t=e.source,f.Rj!==f.Qj&&(j&&k?s&&(t=f.Qj):j?t=f.Qj:k&&!s&&(t=f.Rj)),h!==e.row||i!==e.column||t!==e.source)return d.rf(t,p,h,i,u,v)}else if((b>=0||!u)&&c===-1){if(h=e.row+(u?b:0),f.Pj(a,b,c,1,1)&&(h-=u?n:0),f.Sj(t,h,-1,1,-1))h+=n;else if(f.Pj(t,h,-1,1,-1))return d.Ih;if(h-=u?b:0,h!==e.row)return d.rf(e.source,p,h,e.column,u,e.columnRelative)}else if(b===-1&&c>=0&&!v){if(i=e.column+(v?c:0),f.Pj(a,b,c,1,1)&&(i-=v?o:0),f.Sj(t,h,i,1,1))i+=o;else if(f.Pj(t,h,i,1,1))return d.Ih;if(i-=v?c:0,h!==e.row||i!==e.column)return d.rf(e.source,e.endSource,e.row,i,e.rowRelative,v)}return e}function U(a,b){if(b=a.getIntersect(b,0,0),!b)return p;var c=a.row,d=a.col,e=a.rowCount,f=a.colCount;return a.rowCount===b.rowCount&&a.colCount===b.colCount||(a.rowCount===b.rowCount?(a.col===b.col&&(d=a.col+b.colCount),f=a.colCount-b.colCount):a.colCount===b.colCount&&(a.row===b.row&&(c=a.row+b.rowCount),e=a.rowCount-b.rowCount)),h.kf(c,d,e,f)}function V(a,b,c,d,e){var f,g;return!(!b||!a)&&(f=b.getIntersect(a,0,0),!(f||!(g=b.getIntersect(c,0,0)))||(!(!f||f.rowCount!==b.rowCount||0===e)||!(!f||f.colCount!==b.colCount||0===d)))}function W(a,b,c){var d=a.getRange(b,c);return h.kf(d.row,d.col,d.rowCount,d.colCount)}function X(a,b,c,d){var e,f=U(a,b);return f?(e=f.union(c),d?(e.col=a.col,e.colCount=a.colCount):(e.row=a.row,e.rowCount=a.rowCount)):e=c,{startRow:e.row,endRow:e.row+e.rowCount-1,startColumn:e.col,endColumn:e.col+e.colCount-1}}function Y(a,b,c,d,e){var f,g=U(a,b),h=a.getIntersect(b,0,0);return h?(h.row+=d,h.col+=e,f=g?g.union(h):c,{startRow:f.row,endRow:f.row+f.rowCount-1,startColumn:f.col,endColumn:f.col+f.colCount-1}):p}function Z(a,b){var c=a.row,d=a.col,e=a.rowCount,f=a.colCount,g=b.row,h=b.col,i=b.rowCount,j=b.colCount;return 1===e&&1!==f?h<d&&d<=h+j-1||h<=d+f-1&&d+f-1<h+j-1:1!==f||1===e||(g<c&&c<=g+i-1||g<=c+e-1&&c+e-1<g+i-1)}function $(a,b,c,d,e,f){var g,i,j,k,l=W(d,e,f),m=l.row,n=l.row+l.rowCount-1,o=l.col,p=l.col+l.colCount-1,q=a.Vj,r=q+a.Xj-1,s=a.Wj,t=s+a.Yj-1,u=a.Tj,v=a.Uj,w=h.kf(q,s,a.Xj,a.Yj),x=h.kf(u,v,a.Xj,a.Yj),y=l.getIntersect(x,0,0);if(V(w,l,x,b,c))if(i=0!==b,j=void 0,k=void 0,i)if(j=m>=q&&m<=r,k=n>=q&&n<=r,j&&k)m+=b,n+=b;else if(j&&!k)if(b<=0)m+=b;else if(q+b>n);else{if(!(r+b<n))return Y(l,w,x,b,c);if(q===m)return X(l,w,x,i);m+=b}else if(!j&&k)if(b>=0)n+=b;else if(r+b<m);else{if(!(u>m))return Y(l,w,x,b,c);if(r===n)return X(l,w,x,i);n+=b}else y&&!y.equals(x)&&Z(l,x)&&(g=U(l,y),m=g.row,n=g.row+g.rowCount-1,o=g.col,p=g.col+g.colCount-1);else if(j=o>=s&&o<=t,k=p>=s&&p<=t,j&&k)o+=c,p+=c;else if(j&&!k)if(c<0)o+=c;else if(s+c>p);else{if(!(t+c<p))return Y(l,w,x,b,c);if(s===o)return X(l,w,x,i);o+=c}else if(!j&&k)if(c>0)p+=c;else if(t+c<o);else{if(!(v>o))return Y(l,w,x,b,c);if(t===p)return X(l,w,x,i);p+=c}else y&&!y.equals(x)&&Z(l,x)&&(g=U(l,y),m=g.row,n=g.row+g.rowCount-1,o=g.col,p=g.col+g.colCount-1);return{startRow:m,endRow:n,startColumn:o,endColumn:p}}function _(a,b,c,d){return c>b||c+d-1<a}function aa(a,b,c,d){return c<=a&&c+d-1>=b}function ba(a,b,c,d){return c>a&&c+d-1<b}function ca(a,b,c,d){return c===a&&c+d-1<b||c>a&&c+d-1===b}function da(a,b,c,d){return c<a&&c+d-1>=a&&c+d-1<b||c>a&&c<=b&&c+d-1>b}function ea(a,b,c,d,e){return c<=a&&e<=a||c+d-1>=b&&e+d-1>=b}function fa(a,b,c,d,e){var f,g,h=[_,aa,ba,ca,da];for(g=0;g<h.length;g++)if(h[g](a,b,c,d)){f=g+"_";break}if(c===e)f+="9";else for(g=0;g<h.length;g++)if(c!==e&&h[g](a,b,e,d)){f+=g;break}return f}function ga(a,b,c,d,e){return{row:n(a.startRow,b),col:n(a.startColumn,c),endRow:m(a.endRow,d),endCol:m(a.endColumn,e)}}!function(a){a.outToOut="0_0",a.outToCover="0_1",a.outToInside="0_2",a.outToPart="0_3",a.outToCross="0_4",a.outNoMove="0_9",a.coverToOut="1_0",a.coverToCover="1_1",a.coverToCross="1_4",a.coverNoMove="1_9",a.insideToOut="2_0",a.insideToInside="2_2",a.insideToPart="2_3",a.insideToCross="2_4",a.insideNoMove="2_9",a.partToOut="3_0",a.partToInside="3_2",a.partToPart="3_3",a.partToCross="3_4",a.partNoMove="3_9",a.crossToOut="4_0",a.crossToCover="4_1",a.crossToInside="4_2",a.crossToPart="4_3",a.crossToCross="4_4",a.crossNoMove="4_9"}(w||(w={}));function ha(a,b,c,d,e){return a===e.Qj&&e.Tj<=b&&b<=e.Xj+e.Tj-1&&e.Uj<=c&&c<=e.Yj+e.Uj-1&&(b=b+e.Vj-e.Tj,c=c+e.Wj-e.Uj),{startRow:d.row+(d.rowRelative?b:0),endRow:d.endRow+(d.endRowRelative?b:0),startColumn:d.column+(d.columnRelative?c:0),endColumn:d.endColumn+(d.endColumnRelative?c:0)}}function ia(a,b,c,e,f,g,h,i,k){return j(g)&&(g=b.startRow),j(h)&&(h=b.startColumn),j(i)&&(i=b.endRow),j(k)&&(k=b.endColumn),d.uf(f||a.source,p,a.rowRelative?g-c:g,a.columnRelative?h-e:h,a.endRowRelative?i-c:i,a.endColumnRelative?k-e:k,a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,c,e)}function ja(a,b,c,e,f){var g,h,i,j,k,l,o,q,r,s,t=ha(a,b,c,e,f),u=e.source||a;if(f.Rj===u&&f.Qj===u)switch(g=fa(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj),h=fa(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj),i=g+"-"+h,j=f.Tj-f.Vj,k=f.Uj-f.Wj,l=ga(t,f.Vj,f.Wj,f.Vj+f.Xj-1,f.Wj+f.Yj-1),o=void 0,q=void 0,r=void 0,s=void 0,i){case w.outToCover+"-"+w.outToCover:case w.crossToCover+"-"+w.outToCover:case w.outToCover+"-"+w.crossToCover:case w.crossToCover+"-"+w.crossToCover:case w.coverToCover+"-"+w.outToCover:case w.outToCover+"-"+w.coverToCover:case w.coverNoMove+"-"+w.outToCover:case w.outToCover+"-"+w.coverNoMove:return d.Ih;case w.outToCross+"-"+w.outToCover:case w.coverToCross+"-"+w.outToCover:case w.insideToCross+"-"+w.outToCover:case w.partToCross+"-"+w.outToCover:case w.crossToCross+"-"+w.outToCover:case w.crossNoMove+"-"+w.outToCover:case w.outToCross+"-"+w.coverNoMove:case w.outToCross+"-"+w.coverToCover:case w.outToCross+"-"+w.crossToCover:case w.insideToCross+"-"+w.coverNoMove:case w.insideToCross+"-"+w.coverToCover:case w.insideToCross+"-"+w.crossToCover:return f.Tj<=t.startRow?ia(e,t,b,c,p,f.Tj+f.Xj):ia(e,t,b,c,p,p,p,f.Tj-1);case w.outToCover+"-"+w.outToCross:case w.outToCover+"-"+w.coverToCross:case w.outToCover+"-"+w.insideToCross:case w.outToCover+"-"+w.partToCross:case w.outToCover+"-"+w.crossToCross:case w.outToCover+"-"+w.crossNoMove:case w.coverNoMove+"-"+w.outToCross:case w.coverToCover+"-"+w.outToCross:case w.crossToCover+"-"+w.outToCross:case w.coverNoMove+"-"+w.insideToCross:case w.coverToCover+"-"+w.insideToCross:case w.crossToCover+"-"+w.insideToCross:return f.Uj<t.startColumn?ia(e,t,b,c,p,p,f.Uj+f.Yj):ia(e,t,b,c,p,p,p,p,f.Uj-1);case w.partToOut+"-"+w.coverNoMove:case w.crossToOut+"-"+w.coverNoMove:if(!ea(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj))return ia(e,t,b,c);case w.coverNoMove+"-"+w.partToOut:case w.coverNoMove+"-"+w.crossToOut:if(g===w.coverNoMove&&!ea(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj))return ia(e,t,b,c);case w.crossToInside+"-"+w.coverNoMove:case w.coverNoMove+"-"+w.crossToInside:return t.startRow>=f.Vj&&h===w.coverNoMove||t.startColumn>=f.Wj&&g===w.coverNoMove?ia(e,t,b,c,p,l.row+j,l.col+k):ia(e,t,b,c,p,p,p,l.endRow+j,l.endCol+k);case w.partToInside+"-"+w.coverNoMove:return t.startRow>=f.Vj?ia(e,t,b,c,p,m(l.row+j,l.endRow+1)):ia(e,t,b,c,p,p,p,n(l.endRow+j,l.row-1));case w.coverNoMove+"-"+w.partToInside:return t.startColumn>=f.Wj&&g===w.coverNoMove?ia(e,t,b,c,p,p,m(l.col+k,l.endCol+1)):ia(e,t,b,c,p,p,p,p,n(l.endCol+k,l.col-1));case w.partToCross+"-"+w.coverNoMove:case w.crossToPart+"-"+w.coverNoMove:case w.crossToCross+"-"+w.coverNoMove:if(ea(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj))return t.startRow>=f.Vj?ia(e,t,b,c,p,l.row+j):ia(e,t,b,c,p,p,p,l.endRow+j);case w.crossToCover+"-"+w.coverNoMove:case w.partToPart+"-"+w.coverNoMove:return f.Vj<f.Tj?ia(e,t,b,c,p,m(l.row+j,l.endRow+1),p,l.endRow+j):ia(e,t,b,c,p,l.row+j,p,n(l.endRow+j,l.row-1));case w.coverNoMove+"-"+w.partToCross:case w.coverNoMove+"-"+w.crossToPart:case w.coverNoMove+"-"+w.crossToCross:if(ea(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj))return t.startColumn>=f.Wj?ia(e,t,b,c,p,p,l.col+k):ia(e,t,b,c,p,p,p,p,l.endCol+k);case w.coverNoMove+"-"+w.crossToCover:case w.coverNoMove+"-"+w.partToPart:return f.Wj<f.Uj?ia(e,t,b,c,p,p,m(l.col+k,l.endCol+1),p,l.endCol+k):ia(e,t,b,c,p,p,l.col+k,p,n(l.endCol+k,l.col-1));case w.crossToCross+"-"+w.coverToCover:case w.crossToPart+"-"+w.coverToCover:case w.partToCross+"-"+w.coverToCover:if(ea(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj))return ia(e,t,b,c);case w.coverToCover+"-"+w.crossToCross:case w.coverToCover+"-"+w.crossToPart:case w.coverToCover+"-"+w.partToCross:if(g===w.coverToCover&&ea(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj))return ia(e,t,b,c);case w.coverToCover+"-"+w.partToPart:case w.partToPart+"-"+w.coverToCover:case w.coverToCover+"-"+w.crossToCover:case w.crossToCover+"-"+w.coverToCover:return ia(e,t,b,c,p,l.row+j,l.col+k,l.endRow+j,l.endCol+k);case w.partToPart+"-"+w.crossToCover:case w.partToCross+"-"+w.crossToCover:case w.crossToPart+"-"+w.crossToCover:case w.crossToCross+"-"+w.crossToCover:return ea(t.startRow,t.endRow,f.Vj,f.Xj,f.Tj)?ia(e,t,b,c):(l.row===t.startRow?l.col===t.startColumn?(r=t.endColumn,s=l.col+k,o=l.endRow+j,q=l.row+j):(r=t.startColumn,s=l.endCol+k,o=g===w.partToCross||g===w.crossToCross?f.Vj+j-1:t.endRow,q=t.startRow):l.col===t.startColumn?(r=t.endColumn,s=l.col+k,o=t.endRow,q=g===w.partToCross||g===w.crossToCross?f.Vj+f.Xj-1+j+1:t.startRow):(r=t.startColumn,s=l.endCol+k,o=g===w.partToCross||g===w.crossToCross?l.row+j:t.startRow,q=l.endRow+j),ia(e,t,b,c,p,m(o,q),m(r,s),n(o,q),n(r,s)));case w.crossToCover+"-"+w.partToPart:case w.crossToCover+"-"+w.partToCross:case w.crossToCover+"-"+w.crossToPart:case w.crossToCover+"-"+w.crossToCross:return ea(t.startColumn,t.endColumn,f.Wj,f.Yj,f.Uj)?ia(e,t,b,c):(l.row===t.startRow?l.col===t.startColumn?(r=l.endCol+k,s=l.col+k,o=t.endRow,q=l.row+j):(r=t.endColumn,s=h===w.partToCross||h===w.crossToCross?f.Wj+f.Yj-1+k+1:t.startColumn,o=t.endRow,q=l.row+j):l.col===t.startColumn?(r=t.startColumn,s=h===w.partToCross||h===w.crossToCross?f.Wj+k-1:t.endColumn,
o=l.endRow+j,q=t.startRow):(r=h===w.partToCross||h===w.crossToCross?l.col+k:t.startColumn,s=l.endCol+k,o=t.startRow,q=l.endRow+j),ia(e,t,b,c,p,m(o,q),m(r,s),n(o,q),n(r,s)));case w.coverToOut+"-"+w.coverToOut:case w.coverToOut+"-"+w.coverToCross:case w.coverToOut+"-"+w.coverToCover:case w.coverToOut+"-"+w.coverNoMove:case w.coverToCross+"-"+w.coverToOut:case w.coverToCross+"-"+w.coverToCross:case w.coverToCross+"-"+w.coverToCover:case w.coverToCross+"-"+w.coverNoMove:case w.coverToCover+"-"+w.coverToOut:case w.coverToCover+"-"+w.coverToCross:case w.coverToCover+"-"+w.coverToCover:case w.coverToCover+"-"+w.coverNoMove:case w.coverNoMove+"-"+w.coverToOut:case w.coverNoMove+"-"+w.coverToCross:case w.coverNoMove+"-"+w.coverToCover:return ia(e,t,b,c,p,t.startRow+j,t.startColumn+k,t.endRow+j,t.endColumn+k);default:return ia(e,t,b,c)}}function ka(a,b,c,e,f,g,h,i){var j,k,l,m,n,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N=!!e.source,O=N?e.source:a,P=g&&g.isDataValidator,Q=S(f,a),R=!1,T=e.rowRelative,U=e.columnRelative,V=e.endRowRelative,W=e.endColumnRelative;if(b>=0||!T||!V||c>=0||!U||!W){if(j=e.row+(T?b:0),k=e.endRow+(V?b:0),l=e.column+(U?c:0),m=e.endColumn+(W?c:0),n=k-j+1,q=m-l+1,!P&&Q){if(z=f.Sj(O,j,l,n,q))return e.offset(h,i,!0,b,c);if(f.Pj(O,j,l,n,q))return d.Ih;if(O!==f.Rj||O!==f.Qj||0!==h&&0!==i)return e;R=!0}if(g&&g.isNameID||a===f.Rj&&(a===f.Qj?y=f.Pj(f.Qj,b,c,1,1):(A=b,B=c,g&&g.crossSheetMoved&&(A-=h,B-=i),y=f.Sj(f.Rj,A,B,1,1))),(R||a===O&&a===f.Rj&&a===f.Qj)&&(C=b,D=c,y&&(C-=h,D-=i),0===h||0===i)){if(E=$(f,h,i,e,C,D),!E)return d.Ih;if(0===i&&h&&E.endColumn>=m&&E.startColumn<=l||0===h&&i&&E.endRow>=k&&E.startRow<=j)return F=E.startRow,G=E.startColumn,H=E.endRow,I=E.endColumn,F===j&&H===k&&G===l&&I===m?e:(T&&(F-=b),V&&(H-=b),U&&(G-=c),W&&(I-=c),d.uf(e.source,p,F,G,H,I,T,U,V,W,b,c))}if(y&&(J=f.Tj-f.Vj,K=f.Uj-f.Wj,n+=(T?-J:0)+(V?J:0),q+=(U?-K:0)+(W?K:0)),O===f.Qj&&f.Pj(O,j,l,n,q)&&!q&&(!T&&!U&&!V&&!W||!y))return d.Ih;if(x=(N&&O===f.Rj||!N&&a===f.Rj)&&(!y&&f.Sj(f.Rj,j,l,n,q)||y&&f.Pj(f.Qj,T?j:j+h,U?l:l+i,n,q)),y&&(t=T?h:0,u=V?h:0,v=U?i:0,w=W?i:0,j-=t,k-=u,l-=v,m-=w),L=!1,x)r=h,s=i,j+=r,k+=r,l+=s,m+=s;else if(f.Pj(O,j,l,n,q)){if(M=f.intersectWith(O,j,l,n,q),!M||M.rowCount!==n&&M.colCount!==q)return d.Ih;j=M.row+h,l=M.col+i,k=j+M.rowCount,m=l+M.colCount,L=!0}if(j-=T?b:0,k-=V?b:0,l-=U?c:0,m-=W?c:0,f.Rj===f.Qj?O=N?e.source:o:(O=e.source,x&&y&&N?O=f.Qj:x&&y||(x?O=f.Qj:y&&!N&&(O=f.Rj))),j!==e.row||l!==e.column||k!==e.endRow||m!==e.endColumn||L||O!==e.source)return d.uf(O,p,j,l,k,m,T,U,V,W,b,c)}else if(!(b>=0)&&T&&V||c!==-1){if(b===-1&&(c>=0||!U||!W)){if(l=e.column+(U?c:0),m=e.endColumn+(W?c:0),l>m)return d.Ih;if(f.Pj(a,b,c,1,1)&&(v=U?i:0,w=W?i:0,l-=v,m-=w),q=m-l+1,f.Sj(O,-1,l,-1,q))s=i,l+=s,m+=s;else if(f.Pj(O,-1,l,-1,q))return d.Ih;if(l-=U?c:0,m-=W?c:0,l!==e.column||m!==e.endColumn)return d.uf(e.source,p,e.row,l,e.endRow,m,e.rowRelative,U,e.endRowRelative,W,b,c)}}else{if(j=e.row+(T?b:0),k=e.endRow+(V?b:0),j>k)return d.Ih;if(f.Pj(a,b,c,1,1)&&(t=T?h:0,u=V?h:0,j-=t,k-=u),n=k-j+1,f.Sj(O,j,-1,n,-1))r=h,j+=r,k+=r;else if(f.Pj(O,j,-1,n,-1))return d.Ih;if(j-=T?b:0,k-=V?b:0,j!==e.row||k!==e.endRow)return d.uf(e.source,p,j,e.column,k,e.endColumn,T,e.columnRelative,V,e.endColumnRelative,b,c)}}function la(a,b,c,e,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=!!e.source,L=K?e.source:a,M=e.tf(),N=b,O=c,P=g.Qj.kj;if(h&&h.isCustomName&&(r=e.row,s=e.column,N=g.Tj+(r-g.Vj)+P.DMc(g.Tj,r-g.Vj+1,!0),O=g.Uj+(s-g.Wj)+P.DMc(g.Uj,s-g.Wj+1)),t=g.Nj(N),u=g.Oj(O),0===M){if(v=!g.HPJ&&ja(a,b,c,e,g))return v;if(v=ka(a,b,c,e,g,h,t,u))return v}else if(1===M){if(i=e.rowRelative,k=e.endRowRelative,b>=0||!i||!k){if(m=e.row+(i?b:0),n=e.endRow+(k?b:0),m>n)return d.Ih;if(q=a===g.Rj&&a===g.Qj&&g.Pj(g.Qj,b,c,1,1),L===g.Rj&&L===g.Qj&&0===g.Wj&&0===g.Uj&&g.Yj===L.getColumnCount()){if(w=g.Vj,x=g.Tj,y=g.Xj,q&&(m-=t,n-=t),z=w+y,A=m>=w&&z>m,B=n>=w&&z>n,A&&B)return q?e:e.offset(t,u,!0,b,c);if(C=x+y,A&&x<=n?(m+=t,C>n&&n>=x&&(n=C-1,m=z)):B&&C>=m&&(n+=t,x<=m&&o<C&&(m=x,n=w-1)),m-=i?b:0,n-=k?b:0,m!==e.row||n!==e.endRow)return d.uf(e.source,e.endSource,m,f.BAND_INDEX_CONST,n,f.BAND_INDEX_CONST,i,j,k,l,b,c)}if(q)return e.offset(-t,u,!0,b,c)}}else if(2===M){if(j=e.columnRelative,l=e.endColumnRelative,o=e.column+(j?c:0),p=e.endColumn+(l?c:0),o>p)return d.Ih;if(q=a===g.Rj&&a===g.Qj&&g.Pj(g.Qj,b,c,1,1),L===g.Rj&&L===g.Qj&&0===g.Vj&&0===g.Tj&&g.Xj===L.getRowCount()){if(D=g.Wj,E=g.Uj,F=g.Yj,q&&(o-=u,p-=u),G=D+F,H=o>=D&&G>o,I=p>=D&&G>p,H&&I)return q?e:e.offset(t,u,!0,b,c);if(J=E+F,H&&E<=p?(o+=u,J>p&&p>=E&&(p=J-1,o=G)):I&&J>=o&&(p+=u,E<=o&&o<J&&(o=E,p=D-1)),o-=j?c:0,p-=l?c:0,o!==e.column||p!==e.endColumn)return d.uf(e.source,e.endSource,f.BAND_INDEX_CONST,o,f.BAND_INDEX_CONST,p,i,j,k,l,b,c)}if(q)return e.offset(t,-u,!0,b,c)}return e}function ma(a,b,c,e,f,g,h){var i,j,k,l,m,n,q,r=ma,s=e;if(1===e.type&&e.sf())s=g?T(a,b,c,e,f,h):oa(a,b,c,e,f);else if(1===e.type)s=g?la(a,b,c,e,f,h):pa(a,b,c,e,f);else if(10===e.type)i=r(a,b,c,e.value,f,g,h),i!==e.value&&(s=d.Lh(i));else if(9===e.type)j=r(a,b,c,e.value,f,g,h),k=e.value2&&r(a,b,c,e.value2,f,g,h),j===e.value&&k===e.value2||(s=d.Kh(e.operatorType,j,k));else if(7===e.type){for(l=p,m=void 0,n=void 0,q=e.arguments.length,n=0;n<q;n++)if(m=e.arguments[n],i=r(a,b,c,m,f,g,h),i!==m){l=[],l[n]=i;break}if(l){for(n=0;n<q;n++)m=e.arguments[n],l[n]!==o&&l[n]!==p||(l[n]=r(a,b,c,m,f,g,h));s=d.Jh(e,l)}d.isExpression(e.function)&&(s.function=r(a,b,c,e.function,f,g,h))}return s}b.adjustFormulaOnMoveSwap=ma;function na(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=b.Rj.getSheet();if(q.mJb!==!0)for(d=q.ITa.dUa(),e=0;e<a.length;e++)if(f=a[e].validator,g=f.n5,h=s(g),i=h.r,j=h.c,k=a[e].sheet,l=k.yj(),m=f.condition(),n=m.getExpressions(),n&&n.length>0){for(o=0;o<n.length;o++)p=n[o],n[o]=ma(l,i,j,p,b,c,{isDataValidator:!0});m.setExpressions(n,d)}}function oa(a,b,c,e,f){var g,h,i=e.source||a,j=e.rowRelative,k=e.columnRelative,l=f.Nj(b),m=f.Oj(c);if((b>=0||!j)&&(c>=0||!k)){if(g=e.row+(j?b:0),h=e.column+(k?c:0),f.Pj(a,b,c,1,1)?(g-=j?l:0,h-=k?m:0):f.Sj(a,g,h,1,1)&&(g+=j?l:0,h+=k?m:0),f.Sj(i,g,h,1,1)?(g+=l,h+=m):f.Pj(i,g,h,1,1)&&(g-=l,h-=m),g-=j?b:0,h-=k?c:0,g!==e.row||h!==e.column)return d.rf(e.source,p,g,h,j,k)}else if((b>=0||!j)&&c===-1){if(g=e.row+(j?b:0),f.Pj(a,b,-1,1,-1)?g-=j?l:0:f.Sj(a,g,-1,1,-1)&&(g+=j?l:0),f.Sj(i,g,-1,1,-1)?g+=l:f.Pj(i,g,-1,1,-1)&&(g-=l),g-=j?b:0,g!==e.row||h!==e.column)return d.rf(e.source,p,g,e.column,j,e.columnRelative)}else if(b===-1&&c>=0&&!k&&(h=e.column+0,f.Pj(a,-1,c,-1,1)?h-=0:f.Sj(a,-1,h,-1,1)&&(h+=0),f.Sj(i,-1,h,-1,1)?h+=m:f.Pj(i,-1,h,-1,1)&&(h-=m),h-=0,g!==e.row||h!==e.column))return d.rf(e.source,p,e.row,h,e.rowRelative,k);return e}function pa(a,b,c,e,g){var h,i,j,k,l,m,n,o,q,r,s,t,u,v,w,x,y=e.source||a,z=e.tf(),A=g.Nj(b),B=g.Oj(c);if(0===z){if(n=e.rowRelative,o=e.columnRelative,q=e.endRowRelative,r=e.endColumnRelative,!(b>=0)&&n&&q||!(c>=0)&&o&&r)if(!(b>=0)&&n&&q||c!==-1){if(b===-1&&(c>=0||!o||!r)){if(j=e.column+(o?c:0),k=e.endColumn+(r?c:0),j<k)return d.Ih;if(g.Pj(a,-1,c,-1,1)?(v=o?B:0,x=r?B:0,j-=v,k-=x):g.Sj(a,-1,c,-1,1)&&(v=o?B:0,x=r?B:0,j+=v,k+=x),m=k-j,g.Sj(y,-1,j,-1,m)?(t=B,j+=t,k+=t):g.Pj(y,-1,j,-1,m)&&(t=B,j-=t,k-=t),j-=o?c:0,k-=r?c:0,j!==e.column||k!==e.endColumn)return d.uf(e.source,p,j,e.endRow,k,e.rowRelative,o,e.endRowRelative,r,b,c)}}else{if(h=e.row+(n?b:0),i=e.endRow+(q?b:0),h<i)return d.Ih;if(g.Pj(a,b,-1,1,-1)?(u=n?A:0,w=n?A:0,h-=u,i-=w):g.Sj(a,b,-1,1,-1)&&(u=n?A:0,w=n?A:0,h+=u,i+=w),l=i-h,g.Sj(y,h,-1,l,-1)?(s=A,h+=s,i+=s):g.Pj(y,h,-1,l,-1)&&(s=A,h-=s,i-=s),h-=n?b:0,i-=q?b:0,h!==e.row||i!==e.endRow)return d.uf(e.source,p,h,e.column,i,e.endColumn,n,e.columnRelative,q,e.endColumnRelative,b,c)}else if(h=e.row+(n?b:0),i=e.endRow+(q?b:0),j=e.column+(o?c:0),k=e.endColumn+(r?c:0),l=i-h,m=k-j,g.Pj(a,b,c,1,1)?(u=n?A:0,v=o?B:0,w=q?A:0,x=r?B:0,h-=u,i-=w,j-=v,k-=x):g.Sj(a,h,j,l,m)&&(u=n?A:0,v=o?B:0,w=q?A:0,x=r?B:0,h+=u,i+=w,j+=v,k+=x),g.Sj(y,h,j,l,m)?(s=A,t=B,h+=s,i+=s,j+=t,k+=t):g.Pj(y,h,j,l,m)&&(s=A,t=B,h-=s,i-=s,j-=t,k-=t),h-=n?b:0,i-=q?b:0,j-=o?c:0,k-=r?c:0,h!==e.row||j!==e.column||i!==e.endRow||k!==e.endColumn)return d.uf(e.source,p,h,j,i,k,n,o,q,r,b,c)}else if(1===z){if(n=e.rowRelative,q=e.endRowRelative,b>=0||!n||!q){if(h=e.row+(n?b:0),i=e.endRow+(q?b:0),h<i)return d.Ih;if(g.Pj(a,b,-1,1,-1)?(u=n?A:0,w=q?A:0,h-=u,i-=w):g.Sj(a,b,-1,1,-1)&&(u=n?A:0,w=q?A:0,h+=u,i+=w),l=i-h,g.Sj(y,h,-1,l,-1)?(s=A,h+=s,i+=s):g.Pj(y,h,-1,l,-1)&&(s=A,h-=s,i-=s),h-=n?b:0,i-=q?b:0,h!==e.row||i!==e.endRow)return d.uf(e.source,p,h,f.BAND_INDEX_CONST,i,f.BAND_INDEX_CONST,n,!1,q,!1,b,c)}}else if(2===z){if(o=e.columnRelative,r=e.endColumnRelative,j=e.column+(o?c:0),k=e.endColumn+(r?c:0),j>k)return d.Ih;if(g.Pj(a,-1,c,-1,1)?(v=o?B:0,x=r?B:0,j-=v,k-=x):g.Sj(a,-1,c,-1,1)&&(v=o?B:0,x=r?B:0,j+=v,k+=x),m=k-j,g.Sj(y,-1,j,-1,m)?(t=B,j+=t,k+=t):g.Pj(y,-1,j,-1,m)&&(t=B,j-=t,k-=t),j-=o?c:0,k-=r?c:0,j!==e.column||k!==e.endColumn)return d.uf(e.source,p,f.BAND_INDEX_CONST,j,f.BAND_INDEX_CONST,k,!1,o,!1,r,b,c)}return e}function qa(a,b,c,d,e,f){a._g(b,c,d,e,!0,!1,f)}function ra(a,b,c){var e,f,g,h,i,j,k,l=ra,m=b;if(8===b.type){if(b.value===c&&(!b.source||b.source===a.getSource()))return d.Hh(r,b.source)}else if(10===b.type)e=l(a,b.value,c),e!==b.value&&(m=d.Lh(e));else if(9===b.type)h=l(a,b.value,c),i=b.value2&&l(a,b.value2,c),h===b.value&&i===b.value2||(m=d.Kh(b.operatorType,h,i));else if(7===b.type){for(j=p,k=b.arguments.length,g=0;g<k;g++)if(f=b.arguments[g],e=l(a,f,c),e!==f){j=[],j[g]=e;break}if(j){for(g=0;g<k;g++)f=b.arguments[g],j[g]!==o&&j[g]!==p||(j[g]=l(a,f,c));m=d.Jh(b,j)}}return m}},"./dist/plugins/sheetsCalc/parser-sheets.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("CalcEngine"),g=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=c("./dist/plugins/sheetsCalc/calc.ns.js"),i=c("./node_modules/util/util.js"),j=d.util.xq,k=new e.Common.ResourceManager(d.SR),l=k.getResource.bind(k),b.maxRowCount=d.XmlConstants.M7,b.maxColumnCount=d.XmlConstants.L7,m=[1,26,676],n=void 0,o=null,p=["#all","#data","#headers","#totals","#this row"],q={" ":!0,"'":!0,"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"\uff08":!0,"\uff09":!0,".":!0,";":!0,",":!0,"`":!0,"+":!0,"~":!0,"\uff01":!0,"":!0,"\u3001":!0,"\uff5d":!0,"\uff5b":!0,"\u3010":!0,"\u3011":!0,"-":!0,"\uff1b":!0,"\uff1a":!0,"\u2018":!0,"\u201c":!0,"\u201d":!0,"\u2019":!0,"\uff0c":!0,"\u3002":!0,"=":!0},r=/^(R|C|RC)?(0*[1-9]\d*)/,s=/^[A-z]{1,3}0*[1-9]\d{0,6}$/,t=/[\u00A2\u00A3\u00A5\u00A6\u00A9\u00AB\u00AC\u00AE\u09E6-\u09EF\u09F2-\u0A03\u0AE2-\u0AF1\u0BE6-\u0BFA\u0E3F\u17B4-\u17D6\u17D8-\u17DB\u17DD-\u181F\u1878-\u187F\u18A9\u18AB-\u18FF\u191D-\u194F\u196E\u196F\u1975-\u197F\u19AA-\u19C0\u19C8-\u19FF\u2000-\u200F\u2011\u2012\u2017\u201A\u201B\u201E\u201F\u2022-\u2024\u2028-\u202F\u2031\u2034\u2036-\u203A\u203C-\u2070\u2072\u2073\u2075-\u207E\u2080\u2085-\u208F\u2095-\u20CF\u2100\u2101\u2104\u2106\u2108\u2114\u2117\u2118\u211E-\u2120\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F-\u2152\u2155-\u215A\u215F\u2189-\u218F\u219A-\u21D1\u21D3\u21D5-\u21FF\u2201\u2204-\u2206\u2209\u220A\u220C-\u220E\u2210\u2212-\u2214\u2216-\u2219\u221B\u221C\u2221\u2222\u2224\u2226\u222D\u222F-\u2233\u2238-\u223B\u223E-\u2247\u2249-\u224B\u224D-\u2251\u2253-\u225F\u2262\u2263\u2268\u2269\u226C\u226D\u2270-\u2281\u2284\u2285\u2288-\u2294\u2296-\u2298\u229A-\u22A4\u22A6-\u22BE\u22C0-\u2311\u2313-\u245F\u24B6-\u24CF\u24EA-\u24FF\u254C-\u254F\u2575-\u2580\u2590\u2591\u2596-\u259F\u25A2\u25AA-\u25B1\u25B4\u25B5\u25B8-\u25BB\u25BE\u25BF\u25C2-\u25C5\u25C9\u25CA\u25CC\u25CD\u25D2-\u25E1\u25E6-\u25EE\u25F0-\u2604\u2607\u2608\u260A-\u260D\u2610-\u261B\u261D\u261F-\u263F\u2641\u2643-\u265F\u2662\u2666\u266B\u266E\u2670-\u2BFF\u3004\u3018-\u301C\u3020\u302A-\u3030\u3036\u3037\u303F\u321D-\u321F\u322A-\u3230\u3233-\u3238\u323A-\u325F\u327C-\u327E\u3280-\u32A2\u32A9-\u3302\u3304-\u330C\u330E-\u3313\u3315-\u3317\u3319-\u3321\u3324\u3325\u3328-\u332A\u332C-\u3335\u3337-\u333A\u333C-\u3348\u334B\u334C\u334E-\u3350\u3352-\u3356\u3358-\u337A\u337F\u3385-\u3387\u33CB\u33CC\u33D4\u33D7\u33D9\u33DA\u33DE-\u33FF\uD80B-\uD83F\uFDFC-\uFE2F\uFE32\uFE45-\uFE48]/;function D(a){return j(a+1).split("")}function E(a,b){var c=b+1;return a<0?a%c+c:a>b?a%c:a}function F(a){return new f.ErrorSource(a)}function G(a,b,c,d,e,f,g){return 3===g||c>=0&&d>=0||1===g&&c>=0||2===g&&d>=0}function H(a,b,c,d,e){var g,i,j=h.BAND_INDEX_CONST,k={cj:j,dj:j,ej:!0,fj:!0,gj:!1,li:0,Vka:!0},l=b?L(a,c,d,0):K(a,0,e);return l.hj?(k.cj=l.ij,k.ej=l.jj):(k.dj=l.ij,k.fj=l.jj),k.li=l.li,k.gj=l.gj,!l.gj||l.li>=a.length?k:!b&&l.hj||b&&!l.hj?{gj:!1}:(g=a[k.li],!b&&(f.isNumber(g)||"$"===g)||b&&("C"===g||"c"===g)?(i=b?L(a,c,d,k.li):K(a,k.li,e),k.li=i.li,!i.gj||!b&&!i.hj||b&&i.hj?(k.gj=!1,k):(k.li<a.length&&(k.Vka=!1),b?(k.dj=i.ij,k.fj=i.jj):(k.cj=i.ij,k.ej=i.jj),k.gj=!0,k)):{gj:!1})}u=[1,10,100,1e3,1e4,1e5,1e6,1e6];function I(a){return f.ei(a)||95===a.charCodeAt(0)}function J(a,b,c){for(var d=a,e=b[a],f=!1;d<c&&!I(e);)d++,d<c&&(e=b[d]);if(d<c){for(;d<c&&I(e);)d++,d<c&&(e=b[d]);d<c&&(f=!0)}return f}function K(a,c,d){var e,g,h,i,j,k,l,n,o,p={jj:!0,gj:!1},q=a.length;if(c>=q)return p;if("$"===a[c]&&(p.jj=!1,c++),c>=q)return p;if(e=c,g=0,h=a[e],f.isNumber(h)&&"0"!==h){for(p.hj=!0;e<q&&f.isNumber(h);)e++,e<q&&(h=a[e]);if(e-c>7)return p;for(i=e-1,j=0;i>=c;i--,j++)g+=(a[i].charCodeAt(0)-48)*u[j];if(g<=b.maxRowCount)return p.ij=g-1,p.li=e,p.gj=!0,p}else if(f.ei(h)){for(p.hj=!1;e<q&&f.ei(h);)e++,e<q&&(h=a[e]);if(k=e-c,k>3)return p;if(J(e,a,q))return p;for(g=0,l=e-1,n=l;n>=c;n--){if(o=a[n].charCodeAt(0),!(o>=65&&o<=90||o>=97&&o<=122))return p;g+=((32|o)-96)*m[l-n]}if(g<=b.maxColumnCount)return p.ij=g-1,p.li=e,p.gj=!0,p}return p}function L(a,c,d,e){var g,i,j,k,l,m=h.BAND_INDEX_CONST,n={li:e,ij:m,hj:!0,jj:!1,gj:!1},o=a.length;if(e>=o)return n;if(g=e,i=a[g],"R"===i||"r"===i)n.hj=!0,j=c;else{if("C"!==i&&"c"!==i)return n;n.hj=!1,j=d}if(e++,g++,e>=o)return n.li=e,n.ij=j,n.jj=!0,n.gj=!0,n;if(i=a[g],"["===i&&(e++,g++,n.jj=!0),e>=o)return n;if(k=!1,i=a[g],n.jj&&"-"===i&&(e++,g++,k=!0),e>=o)return n;if(i=a[g],!f.isNumber(i))return n.jj?n:(n.li=e,n.ij=j,n.jj=!0,n.gj=!0,n);for(;g<o&&f.isNumber(i);)g++,g<o&&(i=a[g]);if(l=parseInt(a.slice(e,g).join(""),10),n.jj){if(g>=o||"]"!==a[g])return n;g++}return l<(n.hj?b.maxRowCount:b.maxColumnCount)?(n.jj?(l=k?-l:l,n.ij=l+j):n.ij=l-1,n.li=g,n.gj=!0,n):void 0}function M(a,b,c,d){var e,g,h=a.row||0,i=a.column||0;if(c.source===f.BangSource)d.push("!");else if(c.source&&(e=P(a,d,c.source,c.endSource),!e))return void d.push("#","R","E","F","!");g=c.type,8===g||5===g?d.push(""+c.value):c.value&&c._error?d.push(""+c.value):c.sf()?(!c.source&&a.addSheetName&&a.source&&P(a,d,a.source,n),N(a.useR1C1,h,i,c.row,c.column,c.rowRelative,c.columnRelative,d)):(!c.source&&a.addSheetName&&a.source&&P(a,d,a.source,n),O(a.source,a.useR1C1,h,i,c.row,c.column,c.endRow,c.endColumn,c.rowRelative,c.columnRelative,c.endRowRelative,c.endColumnRelative,d,c.tf()))}function N(a,c,d,e,g,h,i,j,k){var l,m;if(k=k||0,l=b.maxRowCount-1,(0===k||1===k)&&e>-l&&e<=2*l&&(e+=h?c:0,e=E(e,l)),m=b.maxColumnCount-1,(0===k||2===k)&&g>-m&&g<=2*m&&(g+=i?d:0,g=E(g,m)),!G(c,d,e,g,h,i,k))return void j.push(""+f.Errors.Reference);if(a){if(2!==k&&(j.push("R"),e>=0&&(c!==e||!h)&&(h?j.push("["+(e-c)+"]"):(e++,j.push(e+""))),g<0))return;1!==k&&(j.push("C"),d===g&&i||(i?j.push("["+(g-d)+"]"):(g++,j.push(g+""))))}else{if(g>=0&&(i||j.push("$"),j.push.apply(j,D(g))),e<0)return;e++,h||j.push("$"),j.push(e+"")}}function O(a,c,d,e,f,g,i,j,k,l,m,n,o,p){p=p||0,3===p&&(f=0,i=b.maxRowCount-1,p=1),N(c,d,e,f,g,k,l,o,p);var q=h.BAND_INDEX_CONST;(!c||f!==i||g!==j||i!==q&&j!==q)&&(i===q&&j===q||(o.push(":"),N(c,d,e,i,j,m,n,o,p)))}function P(a,b,c,d){if(a.getExternalSourceToken){if(c!==f.BangSource){var e=Q(a,a.getExternalSourceToken(c).split(""),d&&a.getExternalSourceToken(d).split(""));if(!(e.length>0))return!1;b.push.apply(b,e)}return b.push("!"),!0}return!1}function Q(a,b,c){if(!b||0===b.length)return[];var d=b,e;if(T(b,!1,a.Eh)||c&&T(c,!1,a.Eh)){for(d=["'"],e=0;e<b.length;e++)"'"===b[e]&&d.push("'"),d.push(b[e]);if(c)for(d.push(":"),e=0;e<c.length;e++)"'"===c[e]&&d.push("'"),d.push(c[e]);d.push("'")}else if(c)for(d.push(":"),e=0;e<c.length;e++)d.push(c[e]);return d}function R(a,b,c){var d,g;if(!a||0===a.length)return!0;if(!b){if(f.isNumber(a[0]))return!1;if(V(a))return!1;if(t.test(a[0]))return!1}for(g=0;g<a.length;g++)if(d=a[g],b){if("*"===d||":"===d||"["===d||"]"===d||"?"===d||"\\"===d||"/"===d)return!1}else if(q[d]||f.operaterTypesMap[d]||"\u3000"===d&&(c||e.Common.CultureManager.q4().isJCKCulture))return!1;return!0}b.jma=R,b.validateSheetName=R,v={"'":1,"[":1,"]":1,"?":1,"%":1," ":1};function S(a){var b,c;if(!a||0===a.length)return!0;for(c=0;c<a.length;c++)if(b=a[c],v[b]||f.operaterTypesMap[b])return!1;return!0}function T(a,b,c){var d,e,g,h;if(f.isDigit(+a[0]))return!0;if(d=a,e=a.lastIndexOf("["),e>0)return!0;if(0===e){if(g=a.lastIndexOf("]"),!(g>0))return!0;if(h=a.slice(1,g),!S(h))return!0;d=a.slice(g+1)}return!R(d,b,c)}function U(a){var c=a.search(/[0-9]/),d=a.substr(0,c),e=parseInt(a.substr(c),10);return(c<=2||3===c&&d<="XFD")&&e<=b.maxRowCount}function V(a){var b=a.join("").toUpperCase();return!!("RC"===b||"C"===b||"R"===b||r.test(b)||s.test(b)&&U(b))}function W(a){var b=new f.Expression(8);return b.value=a,b}function X(a){var b=a;return a&&a.length>=3&&"["===a[0]&&"0"===a[1]&&"]"===a[2]&&(b=3===a.length?"":a.substring(3)),b}function Y(a,b,c){var d,e,f,g,h,i=a.source;return i&&(e=i.q$a,f=i.pDc,g=i.qDc,e&&(h=b>=0&&b<f&&c>=g||b>=f&&c>=0&&c<g,h&&(d=i))),d}w=function(a){C(b,a);function b(b){var c=a.call(this,8e3)||this;return c.kj=b,c}return b.prototype.resolveToken=function(a,b,c,d){var e,g,j,k,l,m,n,p,q,r,s,t,u,v,w,x,y,z=a.useR1C1,A=a.row||0,B=a.column||0,C=c.length,D=c[d],E=D.ni,G=D.Nc,I=D.hi;if(0!==G&&6!==I)return!1;if(0===G&&0===I&&d<C-2&&":"===c[d+1].ni&&12===c[d+2].hi&&c[d+2].ni.indexOf(":")<0||0===G&&12===I){if(l=void 0,m=void 0,E&&(E.indexOf(":")>0&&E.indexOf("[")===-1?(n=E.indexOf(":"),l=E.substring(1,n-1),m=E.substring(n+1,E.length-2)):(l=E,"'"===l.charAt(0)&&(l=l.substring(1,l.length-1)),0===I&&(m=c[d+2].ni,"'"===m.charAt(0)&&(m=m.substring(1,m.length-1))))),d++,k=!!l,l=X(l),l&&(g=E?a.getExternalSource("",l):f.BangSource,g=g||F(l),m=X(m),m&&(j=a.getExternalSource("",m),j=j||F(m),d+=2)),D=c[d],D&&"["===D.Qb[0])return!1;if(!D)return W(E);E=D.ni}if(p=d===C-1?o:c[d+1],Z(c,D,d,z,!0)){if(q=a&&a.source&&a.source.Af&&a.source.Af.allowDynamicArray,r=H(D.Qb,z,A,B,q),!r.gj&&!k)return!1;if(D.hi=7,r.gj&&r.Vka){if(s=r.cj,t=r.dj,u=r.ej,v=r.fj,d<C-2&&5===p.Nc&&":"===p.ni&&(p=c[d+2],Z(c,p,d+2,z,!1)&&(w=H(p.Qb,z,A,B),w.gj&&s===h.BAND_INDEX_CONST==(w.cj===h.BAND_INDEX_CONST)&&t===h.BAND_INDEX_CONST==(w.dj===h.BAND_INDEX_CONST))))return A=s===h.BAND_INDEX_CONST?0:A,B=t===h.BAND_INDEX_CONST?0:B,{index:d+3,expr:f.uf(g,j,s-(u?A:0),t-(v?B:0),w.cj-(w.ej?A:0),w.dj-(w.fj?B:0),u,v,w.ej,w.fj,A,B)};if(s===h.BAND_INDEX_CONST||t===h.BAND_INDEX_CONST){if(z)return s-=s!==h.BAND_INDEX_CONST&&u?A:0,t-=t!==h.BAND_INDEX_CONST&&v?B:0,{index:d+1,expr:f.uf(g,j,s,t,s,t,u,v,u,v,A,B)};if(!g)return!1;e=W(E)}if(!e)return i.isNullOrUndefined(g)&&(g=Y(a,A,B)),x=s-(u?A:0),y=t-(v?B:0),e=f.rf(g,j,x,y,u,v),{index:d+1,expr:e}}else e=W(E)}else if(6===D.hi)e=new f.Expression(5),e.value=f.CalcError.parse(D.ni);else{if(!g)return!1;e=W(E)}return g&&(e.source=g),j&&(e.endSource=j),{index:d+1,expr:e}},b.prototype.unparse=function(a,b,c,d){var e=c&&c.type;return(1===e||8===e||5===e)&&(M(a,b,c,d),!0)},b}(f.TokenResolver),b.SheetReferenceResolver=w;function Z(a,b,c,d,e){return 0===b.Nc&&0===b.hi||!d&&0===b.Nc&&4===b.hi&&(!e||c<a.length-2&&":"===a[c+1].ni&&0===a[c+2].Nc&&4===a[c+2].hi)}!function(a){a[a.ThisRow=1]="ThisRow",a[a.Headers=2]="Headers",a[a.Data=3]="Data",a[a.Totals=8]="Totals",a[a.HeadersAndData=6]="HeadersAndData",a[a.DataAndTotals=12]="DataAndTotals",a[a.All=14]="All",a[a.NotSpecific=16]="NotSpecific"}(x=b.StructReferencePortions||(b.StructReferencePortions={})),function(a){a[a.All=1]="All",a[a.NotSpecific=1]="NotSpecific",a[a.SingleColumn=2]="SingleColumn",a[a.ColumnRange=4]="ColumnRange"}(y=b.StructReferenceColumnSpecifier||(b.StructReferenceColumnSpecifier={}));function $(a,b,c,d,e){return b<=a.startRow()&&c<=a.startColumn()&&b+d>a.endRow()&&c+e>a.endColumn()}z=function(a){C(b,a);function b(){return a.call(this,13)||this}return b.prototype.tableName=function(){return this.lj.tableName()},Object.defineProperty(b.prototype,"baseTable",{get:function(){return this.lj},set:function(a){this.lj=a,this.source=a.source()},enumerable:!0,configurable:!0}),b.prototype.JUa=function(){this.vzb=this.lj.startColumn()},b.prototype.columnReferenceStart=function(){return this.oj+this.lj.startColumn()},b.prototype.columnReferenceEnd=function(){return this.pj+this.lj.startColumn()},b.prototype.referencePortions=function(){return this.qj},b.prototype.referenceColumnSpecifier=function(){return this.rj},b.prototype.getRange=function(a,b,c){var d,e,g,h,i,j,k,l,m,n,p,q=this,r=q.lj;switch(q.JUa(),k=r.startRow(),l=r.endRow(),m=r.hasTotalsRow(),n=r.hasHeadersRow(),q.qj){case 3:case 16:d=n?k+1:k,g=m?l-1:l;break;case 2:if(n)d=k,g=k;else{if(!c)return o;d=k-1,g=k-1}break;case 8:if(m)d=l,g=l;else{if(!c)return o;d=l+1,g=l+1}break;case 1:d=a,g=a;break;case 6:d=k+(c&&!n?-1:0),g=m?l-1:l;break;case 12:d=n?k+1:k,g=l+(c&&!m?1:0);break;case 14:default:d=k+(c&&!n?-1:0),g=l+(c&&!m?1:0)}if(22===q.type){if(e=q.lj.getColumnIndexInTable(q.P$J),h=q.lj.getColumnIndexInTable(q.xj),e===-1||h===-1)return o}else e=q.columnReferenceStart(),h=q.columnReferenceEnd();return p=r.endColumn(),1===q.rj&&(h=p),e>p||h>p?(q._error=!0,o):g<d||!c&&d<k||!c&&g>l?o:(i=g-d+1,j=h-e+1,f.qf(d,e,i,j))},b.prototype.offsetWhenInsertRemoveColumn=function(a,c,d,e){var g,h,j=this,k=j.vzb;return i.isNullOrUndefined(k)&&(j.JUa(),k=j.vzb),i.isNullOrUndefined(k)||a<k||a===k&&d&&!e||a>j.pj+k?j:(c=d?c:-c,g=a-k,h=new b,h.baseTable=j.lj,h.pj=j.pj+c,h.oj=j.oj,a<=k+j.oj&&(h.oj+=c,h.oj<g&&(h.oj=g)),h.rj=j.rj,h.qj=j.qj,h.pj<h.oj?f.Ih:h)},b.prototype.offsetWhenCopy=function(a,b,c,d,e,h,i,j,k,l){var m,n,o,p,q,r,s=this,t=new g.SheetParserContext(b.kj,b.Af.useR1C1,f.pf(c,d)),u=t.getTableByIndex(c,d),v=s.offset();return u&&(m=c-e,n=d-h,o=i-e,p=j-h,q=void 0,a===b?q=t.getTableByIndex(m,n):(r=new g.SheetParserContext(a.kj,a.Af.useR1C1,f.pf(m,n)),q=r.getTableByIndex(m,n)),q!==u&&q===s.lj&&$(q,o,p,k,l)&&$(u,i,j,k,l)&&(v.baseTable=u)),v},b.prototype.Jma=function(a){var c,d=this,e=new b;return e.baseTable=d.lj,e.pj=d.pj,e.oj=d.oj,2===d.rj&&a&&(c=d.lj.endColumn()-d.lj.startColumn()+1,a%=c,e.oj+=a,e.oj<0&&(e.oj+=c),e.pj=e.oj),e.rj=d.rj,e.qj=d.qj,e},b.prototype.offset=function(a,c,d){var e=this,f=new b;return f.baseTable=e.baseTable,f.qj=e.qj,f.oj=e.oj,f.pj=e.pj,f.rj=e.rj,f},b.prototype.Kma=function(a,b){var c=this.lj;return a>=c.startRow()&&b>=c.startColumn()&&a<=c.endRow()&&b<=c.endColumn()},b.prototype.tzb=function(a,b,c){this.lj.wzb(a,b,c)},b}(f.Expression),b.xzb=z;function _(a,b){this.lj.gmb(a,this,b)}A=function(a){C(c,a);function c(b){var c=a.call(this,7900)||this;return c.kj=b,c}return c.prototype.resolveToken=function(a,b,d,e){var g,h,i,j,k,l,m=d[e],n=d[e+1];if(0===m.Nc){if(g=void 0,h=void 0,0===m.hi||7===m.hi)g=m.ni;else{if(12!==m.hi||!n||0!==n.Nc||0!==n.hi||"["!==n.Qb[0])return o;i=m.ni,"'"===i[0]&&(i=i.substr(1,i.length-2)),g=i+n.ni,h=!0}if("]"===g.charAt(g.length-1))try{return j=new z,aa(a,g.split(""),j),j.baseTable?(j.lj.kj.ODJ&&(k=j,k.type=22,k.gmb=_),h?{index:e+2,expr:j}:j):new f.Expression(0)}catch(a){}else if(l=a.getTableByName&&a.getTableByName(g))return c.create(l)}return o},c.prototype.unparse=function(a,c,d,e){var g,h,j,k,l,m,n,p,q,r,s,t,u;if(13!==d.type&&22!==d.type)return!1;if(g=d,h=g.lj.fOJ,j=i.isNullOrUndefined(h)?g.lj.tableName():h,a.YSa)return k=g.getRange(a.row,a.column,!0),l=f.uf(g.source,o,k.row,k.col,k.row+k.rowCount-1,k.col+k.colCount-1,!1,!1,!1,!1),M(a,c,l,e),!0;if(n=e.length,22===g.type&&g.baseTable.kj.Js)m=!0;else if(16===g.qj&&1===g.rj)return e.push(j),void(a.Eh&&e.push("[]"));return p=a.source===g.lj.source()&&g.Kma(a.row,a.column),p&&!a.Eh||(q=i.isNullOrUndefined(h)?g.lj.tableName():h,r=g.lj.kj,r&&r.ODJ&&!b.validateSheetName(q.split(""))&&(q=Q(a,q.split(""),null).join("")+"!"),e.push(q)),e.push("["),16!==g.qj&&(s=oa(g.qj,1!==g.rj,a.Eh),e.push(s)),1!==g.rj&&(1===g.qj&&!a.Eh||16===g.qj||e.push(", "),t=22===d.type?g.P$J:g.lj.getColumnName(g.oj),t?t=ha(t):m=!0,m||(4===g.rj?(u=22===d.type?g.xj:g.lj.getColumnName(g.pj),u?(u=ha(u),e.push("[",t,"]:[",u,"]")):m=!0):1===g.qj&&!a.Eh&&!ia(t)||16===g.qj?e.push(t):e.push("[",t,"]"))),m?(e.length=n,e.push("#REF!")):e.push("]"),!0},c.create=function(a,b,c,d,e){void 0===b&&(b=x.NotSpecific),void 0===c&&(c=y.NotSpecific),void 0===d&&(d=0),void 0===e&&(e=a.endColumn()-a.startColumn());var f=new z;return f.baseTable=a,f.qj=b,f.oj=d,f.pj=e,f.rj=c,f},c}(f.TokenResolver),b.StructureReferenceResolver=A;function aa(a,b,c){var d,e,f,g,h,j,k,l,m,n,o=c,p=0,q=b[p],r=ma(a,b,p,q),s=r.sj;if(!s){if(d=a.keepUnknownFormulas)return;na()}for(o.baseTable=s,p=r.tj,p++,q=b[p],e=p;" "===q;)p++,q=b[p];for("@"!==q&&"["!==q&&(p=e,q=b[p]),f=1,g=!1,h=!1,j=b.length;0!==f&&p<j;)if("["===q&&(f++,p++,q=b[p]),"#"===q)g&&f<=1&&na(),k=la(b,p,q,f),l=k.vj,p=k.tj,q=k.uj,f=k.wj,g?2===o.qj&&3===l||2===l&&3===o.qj?o.qj=6:3===o.qj&&8===l||3===l&&8===o.qj?o.qj=12:na():o.qj=l,g=!0;else if("@"===q){for((f>1||g)&&na(),g=!0,o.qj=1,p++,q=b[p];" "===q;)p++,q=b[p];","===q&&na()}else{for(m=p;!i.isNullOrUndefined(q)&&"]"!==q&&"["!==q;)if("'"===q&&p++,","===q){for(p++,q=b[p],n=p;" "===q;)p++,q=b[p];if("["===q){p=n,q=",";break}}else p++,q=b[p];if(p>m&&((h||"["===q&&f>1)&&na(),k=ca(o,b,p,q,f,m),p=k.tj,q=k.uj,f=k.wj,h=!0),"]"===q){if(f--,0===f)break;p>=b.length&&na(),p++,q=b[p]}","===q&&(p++,q=b[p])}g||(o.qj=a.WLb?1:16),h||(o.oj=0,o.pj=o.lj.endColumn()-o.lj.startColumn(),o.rj=1)}function ba(a,b,c){return a.slice(b,c).join("")}function ca(a,b,c,d,e,f){var g,h,i,j,k,l,m,o=a,p=[],q=!1,r=!1;if(e>1)q=!0,e--,p=b.slice(f,c),c++,d=b[c],":"===d&&(c++,d=b[c],r="["===d,i=ja(b,c,d,e),g=i.xj,c=i.tj,d=i.uj,e=i.wj);else if("["===d){for(r=!0,h=c-1,d=b[h];" "===d;)h--,d=b[h];":"!==d&&na(),p=b.slice(f,h),p=da(p),d=b[c],i=ja(b,c,d,e),g=i.xj,c=i.tj,d=i.uj,e=i.wj}else o.qj!==n&&16!==o.qj||(q=!0),j=b.slice(f,c),h=j.indexOf(":"),h>0?(p=j.slice(0,h),g=j.slice(h+1),"["!==g[0]&&na()):p=j;if(k=fa(o,p,q),o.P$J=p.join(""),o.xj=o.P$J,g?(l=fa(o,g,r),o.rj=4,o.xj=g.join("")):(l=k,o.rj=2),k>l&&(m=k,k=l,l=m),o.oj=k,o.pj=l,c++,c<b.length)for(d=b[c];" "===d;)c++,d=b[c];return{tj:c,uj:d,wj:e}}function da(a){for(var b=a.length-1;b>=0&&" "===a[b];)b--;for(;b>=0&&" "!==a[b];)b--;return b>=0?a.slice(b+1,a.length-b-1):a}function ea(a){for(var b=0,c=a.length,d=0;b<c&&" "===a[b];)b++;for(d=b,b=c-1;b>d&&" "===a[b];)b++;return b>=d?a.slice(d,b+1):a}function fa(a,b,c){var d,e,f,g;if(b&&ga(b,c)){for(d=[],e=0,f=b.length;e<f;e++)"'"===b[e]&&e<f-1&&e++,d.push(b[e]);return b=d,g=a.lj.getColumnIndexInTable(b.join("")),g<0&&na(),g}return-1}function ga(a,b){var c,d,e;if(b)return!0;if(c="",c=a[0],d=c,"#"===c||"@"===c||" "===c||","===c||":"===c||"["===c||"]"===c)return!1;for(e=1;e<a.length;e++){if(c=a[e],","===c||":"===c||"["===c&&"'"!==d||"]"===c&&"'"!==d||"@"===c&&"'"!==d||"#"===c&&"'"!==d)return!1;d=c}return!0}function ha(a){var b,c,d=[];for(c=0;c<a.length;c++)b=a[c],"["!==b&&"]"!==b&&"@"!==b&&"#"!==b&&"'"!==b||d.push("'"),d.push(b);return d.join("")}b.getValidaColumnName=ha;function ia(a){var b,c="";if(c=a[0],"#"===c||" "===c||"@"===c||" "===c||","===c||":"===c||"["===c||"]"===c)return!0;for(b=1;b<a.length;b++)if(c=a[b]," "===c||","===c||":"===c||"["===c||"]"===c||"@"===c||"#"===c)return!0;return!1}function ja(a,b,c,d){var e,f,g=!1;if("["===c)for(g=!0,d++,b++,c=a[b];" "===c;)b++,c=a[b];for(e=b;"]"!==c&&(","!==c||d>1);)"'"===c&&b++,b++,c=a[b];return b<=e&&na(),f=a.slice(e,b),d>1&&d--,g||(f=ea(f)),{xj:f,tj:b,uj:c,wj:d}}B={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1};function ka(a){var b,c=f.getMapping()&&f.getMapping().tableFunctionsMapping;if(!i.isNullOrUndefined(c))for(b in c)if(c[b].toLowerCase()===a)return b.toLowerCase();return a}function la(a,b,c,d){for(var e,f,g,h,i=14,j=b;"]"!==c;)"'"===c&&b++,b++,c=a[b];for(e=ba(a,j,b).toLowerCase().trim(),e=ka(e),f=!1,g=0;g<p.length;g++)if(h=p[g],e===h){i=B[e],f=!0;break}if(f||na(),b++,b>=a.length)d--;else{for(c=a[b];" "===c;)b++,c=a[b];if(","===c){for(d<=1&&na(),b++,c=a[b];" "===c;)b++,c=a[b];"["===c&&(d++,b++,c=a[b])}d>1&&d--}return{vj:i,tj:b,uj:c,wj:d}}function ma(a,b,c,d){for(var e,f,g=0,h=b.length;"["!==d&&c<h;)c++,d=b[c];return g=c,g>0?(f=ba(b,0,g),e=a.getTableByName(f)):e=a.getTableByIndex(a.row,a.column),{sj:e,tj:c,uj:d}}function na(){throw l().Exp_FormulaInvalid}function oa(a,b,c){var d=f.getMapping()&&f.getMapping().tableFunctionsMapping,e=f.sR().B2,g=d?d["#All"]:e.All.name,h=d?d["#This row"]:e.thisRow.name,i=d?d["#Headers"]:e.Headers.name,j=d?d["#Data"]:e.Data.name,k=d?d["#Totals"]:e.Totals.name;switch(a){case 1:return c?"["+h+"]":"@";case 2:return b?"["+i+"]":i;case 3:return b?"["+j+"]":j;case 8:return b?"["+k+"]":k;case 6:return"["+i+"], ["+j+"]";case 12:return"["+j+"], ["+k+"]";case 14:case 16:}return b?"["+g+"]":g}function pa(a,b){var c,d,e,g,h,i,j,k,l,m,n=0;for(a.unshift(new f.FormulaToken("=",1,0,0,0)),g=[],h=0,e=a.length-1;e>0;e--)a[e].mi===a[e-1].mi&&a[e].ni===a[e-1].ni||(g[h]=a[e],h++);for(g[h]=a[e],g.reverse(),i=[],j=0,k=0;k<g.length-1;k++,j++)d=qa(g[k]),i[j]=g[k],n=g[k+1].mi-g[k].mi-d,n>0&&(c=new f.FormulaToken(b.slice(g[k].mi+d,g[k+1].mi),7,g[k].mi+d),++j,i[j]=c);for(i[j]=g[k],d=qa(i[j]),i.length>0&&b.length>i[j].mi+d&&(c=new f.FormulaToken(b.slice(i[j].mi+d,b.length),7,i[j].mi+d),i[j+1]=c),l=0;l<i.length;l++)m=i[l].ni.trim(),3===i[l].hi?i[l].ni='"'+i[l].ni+'"':"("===m||"{"===m?(i[l].Nc=1,i[l].hi=1):")"!==m&&"}"!==m||(i[l].Nc=1,i[l].hi=2);return i}function qa(a){return 1===a.Nc&&"ARRAY"===a.ni?1:0===a.Nc&&3===a.hi?(a.HTa||a.ni).length+2:0===a.Nc&&12===a.hi?a.ni.length+3:a.ni.length}function ra(a,b,c){var d,e;a&&b&&(d=b.getName&&b.getName()||"!",e=a[d],e||(e=a[d]=[],a.sheets||(a.sheets=[]),a.sheets.push(d)),e.push(c))}function sa(a,b,c,d,e,g){var h,i,j,k;if(a){for(;10===a.type;)a=a.value;if(12===a.type&&(i=a,a=i.value),a.type>=2&&a.type<=6);else if(1===a.type)h=a.getRange(e,g),!d.source||a.source&&a.source!==d.source||b.push(h),ra(c,a.source||d.source,h);else if(13===a.type)h=a.getRange(e,g),a.source===d.source&&h&&b.push(h),ra(c,a.source||d.source,h);else if(8===a.type)a.mWJ||(a.mWJ=!0,j=o,a.source?a.source.Cf()&&(j=new f.EvaluateContext(a.source,f.pf(e,g))):j=d,sa(j.getName(a.value),b,c,j,e,g),a.mWJ=n);else if(9===a.type)sa(a.value,b,c,d,e,g),a.value2&&sa(a.value2,b,c,d,e,g);else if(7===a.type)for(k=0;k<a.arguments.length;k++)sa(a.arguments[k],b,c,d,e,g)}}function ta(a,b,c,e,g,h,j,k,l){var m,n,o,p;a.setParserOption(h),m=[],n=b.split(""),i.isNullOrUndefined(l)&&(l=d.SheetArea.viewport);try{o=!!k||c.Cf().useR1C1,p=c.yj(l).getParserContext(!j&&o,f.pf(e,g),{sheetArea:l}),m=a.parseToTokens(p,n,!1)}catch(a){}return m=pa(m,n),ua(a,m,n,c,e,g,j,k,l)}b.qzb=ta;function ua(a,b,c,e,h,i,j,k,l){var m,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;for(void 0===l&&(l=d.SheetArea.viewport),p=n,q=e.yj(l),r=e.Cf(),s=!!k||r.useR1C1,r?(m=new g.SheetParserContext(e,!j&&s,f.pf(h,i),{sheetArea:l}),p=new f.EvaluateContext(q,f.pf(h,i),(!1))):m=new f.ParserContext(o,(!1),f.pf(0,0)),m.ignoreError=!0,t=[],v=0;v<b.length;v++)try{if(u=b[v],"["===u.ni||"#"===u.Qb[0]||3===u.hi){t.push({text:u.HTa||u.ni,type:u.Nc,subType:u.hi,canDrag:!1,ranges:u.ranges,value:u.ni});continue}if(w=[],v=va(a,m,b,v,w),
x=void 0,w.length>0){for(y=0;y<w.length;y++)if(z=w[y],z instanceof f.FormulaToken)t.push({text:c.slice(z.mi,z.li+1).join(""),type:z.Nc,subType:z.hi,canDrag:x,ranges:[],value:z.ni});else if(z.Lf){if(A=z.Lf,B=A.type,C=A.source,D=c.slice(z.mi,z.li+1).join(""),E=[],F={},x=!0,G=A.getRange&&A.getRange(h,i),8===B)x=!1,p&&(H=p,A.source&&(H=new f.EvaluateContext(A.source,f.pf(h,i),(!1))),I=H.getName(A.value),sa(I,E,F,p,h,i));else if(13===B||22===B)x=!1,C&&q&&C.kj===q.kj&&G?E.push(G):E=null,ra(F,C,G);else if(1===B)if(A.endSource)for(J=C,K=A.endSource,L=J.getSources(K),y=0;y<L.length;y++){if(L[y]===q){E.push(G);break}ra(F,L[y],G)}else ra(F,C||q,G),(!C||C&&q&&C.kj===q.kj)&&E.push(G);else E=null;E&&E.length>0?t.push({text:D,type:0,subType:7,canDrag:x,ranges:E,value:D,sheetRanges:F,sheetArea:C&&C.Wz||q.Wz}):t.push({text:D,type:u.Nc,subType:u.hi,canDrag:x,ranges:E,value:D,sheetRanges:F})}}else t.push({text:u.ni,type:u.Nc,subType:u.hi,canDrag:!1,ranges:u.ranges,value:u.ni})}catch(a){t.push({text:u.ni,type:u.Nc,subType:u.hi,canDrag:!1,ranges:u.ranges,value:u.ni})}return t}function va(a,b,c,d,e){var f,g,h,i,j,k,l=c[d];return l&&"function"!=typeof l&&0===l.Nc?(f=[],g=a.resolveToken(b,c,f,d)-1,h=f[0],i=h.type,1===i||13===i||8===i||5===i||22===i&&h.source?(j=c[g],k={mi:l.mi,li:j.li,Lf:h},e.push(k),g):d):d}},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/sheetsCalc/calc.ns.js")),d(c("./dist/plugins/sheetsCalc/parser-sheets.js")),d(c("./dist/plugins/sheetsCalc/calc-spreadjs.js")),d(c("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js")),d(c("./dist/plugins/sheetsCalc/worksheet-formula.js")),c("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("CalcEngine"),g=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),i=c("./dist/plugins/sheetsCalc/external-reference.js"),j=c("./dist/plugins/sheetsCalc/calc-extra-save.js"),k=g.SpreadSource,l=e.Common.u.Nb,m=new e.Common.ResourceManager(d.SR),n=m.getResource.bind(m),o=void 0,p=null,q=e.Common.D,r=e.Common.j.Fa,s=d.Ul.IcK,t=d.Ul.LcK,u=d.Ul.JcK,v=d.Ul.McK,w=d.Util.ZaK,x=d.IndexHelper.Q9,y=d.Util.addXLFNPrefix,z=d.Ul.oaa,A=d.Ul.naa,B=d.Util.Sja,C=d.XFileConstants.tbK,D=d.XFileConstants.bbK,E=d.Workbook.prototype,E.qv=function(a){var b=this,c=b.Wu;b.Wu=new f.CalcService,b.Wu.useR1C1=1===b.options.referenceStyle,b.Wu.allowDynamicArray=b.options.allowDynamicArray,b.Wu.iterativeCalculation=b.options.iterativeCalculation,b.Wu.iterativeCalculationMaximumIterations=b.options.iterativeCalculationMaximumIterations,b.Wu.iterativeCalculationMaximumChange=b.options.iterativeCalculationMaximumChange,a&&c&&b.Wu.cloneFrom(c),b.yv=new k(b),b.zv=b.Wu.getGlobalSourceModel(b.yv)},E.addCustomFunction=function(a){this.Xu(a)},E.Xu=function(a){if(!(a&&a instanceof f.Functions.Function))throw Error(n().Exp_InvalidCustomFunction);a.name=l(a.name),this.Su[a.name]=a},E.getCustomFunction=function(a){return a?this.Su[l(a)]:o},E.removeCustomFunction=function(a){a&&(delete this.Su[l(a)],this.iK())},E.clearCustomFunctions=function(){this.Su={}},E.addCustomName=function(a,b,c,d,e){this.Yu(this.Tu,a,b,c,d,!1,e)},E.H$a=function(a){return!this.Tu[l(a)]},E.isValidCustomName=function(a){return a&&d.Ul.G$a(a)&&this.H$a(a)},E.E4J=function(a,b,c,d,e,f,g,i){var j,k=this;if(!b||!c)throw Error(n().Exp_InvalidCustomName);i&&k.Wu?(j=i.F4J(c,d,e),a[l(b)]=new h.FormatterNameInfo(b,c,i.name(),j,d,e)):k.Yu(a,b,c,d,e,f,g)},E.Yu=function(a,b,c,e,f,g,i){var j,k,m,o,q=this;if(!b||!c||!g&&!q.isValidCustomName(b))throw Error(n().Exp_InvalidCustomName);if(q.Wu){if(j=d.UCJ(this),k=j?j.yj():p,m=void 0,g)try{m=q.Wu.parse(k,c,e,f,!1,!1,!0)}catch(a){}else m=q.Wu.parse(k,c,e,f);a[l(b)]=new h.NameInfo(b,m,e,f,i),g||(o={},o[b]=b,this.Zu(o,!0))}},E.siK=function(a,b,c,d,e,f,g,i){var j,k=this;if(!b||!c||!g&&!k.isValidCustomName(b))throw Error(n().Exp_InvalidCustomName);k.Wu&&(a[l(b)]=new h.NameInfo(b,d,e,f,i),g||(j={},j[b]=b,this.Zu(j,!0)))},E.getCustomName=function(a){return a?this.Tu[l(a)]:o},E.dJb=function(a){return a?this.UHb[l(a)]:o},E.getCustomNames=function(){var a=[];return d.GC$.each(this.Tu,function(b,c){a.push(c)}),a},E.XLb=function(){var a=[];return d.GC$.each(this.UHb,function(b,c){a.push(c)}),a},E.removeCustomName=function(a){if(a){delete this.Tu[l(a)];var b={};b[a]=a,this.Zu(b,!1)}},E.VHb=function(a){if(a){delete this.UHb[l(a)];var b={};b[a]=a,this.Zu(b,!1)}},E.clearCustomNames=function(){var a=this.Tu;this.Tu={},this.Zu(a,!1)},E.YLb=function(){var a=this.UHb;this.UHb={},this.Zu(a,!1)},E.Zu=function(a,b){var c,d;if(a){c=this.zv;for(d in a)c&&c.updateNameCalc(d,b);this.iK()}},E.iK=function(){if(this.Wu&&!this.Wu.IsSuspended()){var a=this.getActiveSheet();a&&(a.suspendPaint(),this.Wu.recalculateAll(),a.resumePaint())}},E.getCalcService=function(){return this.Wu},E.Cf=function(){return this.Wu},E.suspendCalcService=function(a){this.Wu&&this.Wu.suspend(a)},E.resumeCalcService=function(a){this.Wu&&this.Wu.resume(a)},E.getCircularReference=function(){var a,b,c,d=this.ACc();d=this.BCc(d),a=[];for(b in d)q(d,b)&&(c=b.split("\\"),a.push({row:+c[1],col:+c[2],rowCount:1,colCount:1,sheetName:c[0]}));return a},E.updateExternalReference=function(a,b,c){this.suspendPaint(),this.suspendCalcService(),this.G$J.VF(a,b,c),this.resumeCalcService(),this.resumePaint()},E.getExternalReferences=function(a){return this.G$J.N$J(a)},E.ACc=function(){var a={};return this.sheets.forEach(function(b){var c,d,e,f,g,h,i,j=b.Bj(),k=b.getRowCount(),l=b.getColumnCount(),m=b.name();if(j)for(c=0;c<k;c++)for(d=0;d<l;d++)for(e=m+"\\"+c+"\\"+d,f=b.bPJ(c,d),!a[e]&&f.length>0&&(a[e]={from:[],to:[]}),g=0;g<f.length;g++)h=f[g],i=h.sheetName+"\\"+h.row+"\\"+h.col,a[i]||(a[i]={from:[],to:[]}),a[i].from.push(e),a[e].to.push(i)}),a},E.BCc=function(a){var b,c,d;function e(a,b){a.splice(a.indexOf(b),1)}for(b=!0;Object.keys(a).length>0&&b;){b=!1,c=function(c){if(q(a,c)){var d=a[c];0===d.from.length?(d.to.forEach(function(b){e(a[b].from,c)}),delete a[c],b=!0):0===d.to.length&&(d.from.forEach(function(b){e(a[b].to,c)}),delete a[c],b=!0)}};for(d in a)c(d)}return a};function F(a,b){a||b.forEach(function(a){var b=a.yj();b.MIb(),delete b.q$a})}function G(a,b,c,e){d.GC$.each(a,function(a,d){var f,g,h=d.getName(),i=d.getRow(),j=d.getColumn(),k=d.getExpression(),l=d.getComment(),m=d.getFormatter&&d.getFormatter(),n=d.getSheetTabName&&d.getSheetTabName();k&&(f=m||b.unparse(c,k,i,j,!1,!0),g={name:h,formula:f,sheetTabName:n,row:i,col:j},l&&(g.comment=l),e.push(g))})}function H(a,b){var c,d,e=t(a);if("str"===b)c=e;else if("b"===b)c="1"===e;else if("e"===b){switch(d=p,e){case"#DIV/0!":d=7;break;case"#N/A":d=42;break;case"#NAME?":d=29;break;case"#NULL!":d=0;break;case"#NUM!":d=36;break;case"#REF!":d=23;break;case"#VALUE!":d=15}c=d!==p?{_error:e,_code:d}:p}else c=parseFloat(e);return c}d.Workbook.$n("calc",{priority:1e3,init:function(){this.Su={},this.Tu={},this.UHb={},this.G$J=new i.ExternalReferenceManager},toJson:function(a){var b,c,e,f,g,h,i,j,k=this,l=k.Su;d.GC$.isEmptyObject(l)||(a.customFunctions=l),b=k.G$J.toJSON(k),d.GC$.isEmptyObject(b)||(a.externalReference=b),c=[],e=[],f=k.getCustomNames(),g=k.XLb(),h=k.Wu,i=this.getActiveSheet(),j=i?i.yj():p,f&&h&&(d.GC$.each(f,function(a,b){var d,e,f=b.getName(),g=b.getRow(),i=b.getColumn(),k=b.getExpression(),l=b.getComment();k&&(d=h.unparse(j,k,g,i,!1,!0),e={name:f,formula:d,row:g,col:i},l&&(e.comment=l),c.push(e))}),G(g,h,j,e),c.length>0&&(a.names=c),e.length>0&&(a.formatStringNames=e))},bdK:function(a,b,c){var e,f,g,i,k,l,m,n,o,q,r,t,u,v,w,x,z=this,A=z.Su;d.GC$.isEmptyObject(A)||(a.workbook.lossless.customFunctions=A),z.G$J&&(e=z.G$J.bdK(a),f=e.externalReferencesNode,g=e.externalLinks,i=e.count,i>0&&(a.workbook.c_.push(f),a.externalLinks=g)),k=[],l=s(a.workbook,"definedNames"),m=z.getCustomNames(),n=z.Wu,o=this.getActiveSheet(),q=o?o.yj():p,r=z.yv,t=r&&r.getUsedCustomNames()||{},m&&m.length>0&&n&&(l||(l={n_:"definedNames",c_:[]},a.workbook.c_.push(l)),u=l.c_,v=!c||c.includeUnusedNames!==!1,d.GC$.each(m,function(a,b){var d,e,f,g=b.getName(),i=b.getRow(),l=b.getColumn(),m=b.getExpression(),o=b.getComment();m&&(v||t[g])&&(d=y(h.encodeNameFormula(n.unparse(q,m,i,l,!1,!0))),e={n_:"definedName",name:g,comment:o,c_:[d]},c&&c.includeCalcModelCache&&(f=j.exprToJSON(m),k.push(f),e.e=k.length-1),u.push(e))})),k.length>0&&(a.workbook.lossless.exprs=k),w=[],x=z.XLb(),x&&x.length>0&&n&&(G(x,n,q,w),w.length>0&&(a.workbook.lossless.formatStringNames=w)),a.workbook.lossless.idMap=j.khK(n)},preFromSJSFormat:function(a,b,c){var e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,w,y,z,A,B,C,E,F,G,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W=u(a.workbook,"externalReferences"),X=a.externalLinks;if(W&&X&&W.c_&&W.c_.length>0){e={};for(f in X)if(X.hasOwnProperty(f)){if(g=X[f],h={},j=u(g,"externalBook")){if(k=u(j,"sheetNames"),l=[],k&&k.c_&&k.c_.length){for(m=0,n=k.c_.length;m<n;m++)o=k.c_[m],o&&(p=o.val,p&&l.push(p));h.sheetNames=l}if(q=u(j,"sheetDataSet")){if(r={},s=v(q,d.XFileConstants.HbK))for(t=0,w=s.length;t<w;t++)if(y=s[t],z=+y.sheetId,A="1"===y.refreshError,p=l[z],B=r[p]={},A&&(B.isNew=!0),C=v(y,"row"))for(E=0,F=C.length;E<F;E++)if(G=C[E],G&&(I=G.r-1,J=B[I]={},K=v(G,"cell")))for(L=0,M=K.length;L<M;L++)N=K[L],O=void 0,N&&(P=N.r,P&&(O=x(P)),Q=N.t,R=u(N,"v"),S=void 0,R&&(S=H(R,Q)),J[O]=S);h.data=r}}h.option=g.option,e[f]=h}for(T={},U=W.c_,V=U.length,m=0;m<V;m++)T[m+1]=e[U[m][D]];this.G$J=new i.ExternalReferenceManager(T)}},cdK:function(a,b,c){var e,f,g,i,k,l,m,q,s,v,x,y,A,E,G,H,I,J,K=this;function L(){var a,b;return e||(a=d.UCJ(K)||K.sheets[0],b=a?a.yj():p,e=b&&b.getParserContext(!1)),e}if(f=K.Wu,g=c&&!c.fullRecalc,i=d.Util.lkK(c,K.NjK),f&&(f.suspend(),f.Q$J=g),K.clearCustomNames(),k=K.sheets,i||k.forEach(function(a){a.yj().q$a=!0}),l=a.workbook.lossless,c&&(c.lhK=j.jhK(f,l)),m=b.workbookNames,m&&m.length>0&&m.forEach(function(a){var b=a.name,c=t(a),e=a.comment;l&&l.exprs&&l.exprs[a.e]?K.siK(K.Tu,b,""+h.processFunctionPrefix(d.Ul.oaa(c)),j.exprFromJSON(l.exprs[a.e],L()),0,0,!0,e,!0):c&&K.Yu(K.Tu,b,""+h.processFunctionPrefix(d.Ul.oaa(c)),0,0,!0,e,!0)}),K.YLb(),q=l&&l.formatStringNames)for(s=0;s<q.length;s++)v=q[s],r(v.sheetTabName)&&K.E4J(this.UHb,v.name,v.formula,v.row,v.col,!0,v.comment,o,!0);if(K.clearCustomFunctions(),x=l&&l.customFunctions)for(y in x)x.hasOwnProperty(y)&&(A=x[y],E=d.getTypeFromString(A.typeName),E&&(G=new E,G.fromJSON(A),K.Xu(G)));i||(H=[],I=a.workbook.rels&&a.workbook.rels.c_,J=u(a.workbook,C).c_,J.forEach(function(b){var c,d,e=B(z(b.name)),f=K.getSheetFromName(e),g=b[D],h=w(I,g),i=h&&h.Target;i&&(c=K.getSheetRelsName(i),d=void 0,d=i.indexOf("xl/chartsheets")>-1?a.chartsheets[c]:a.sheets[c],H.push({sheet:f,sheetData:d}))}),H.forEach(function(a){a.sheet&&a.sheet.nameFunctionFromSJSFormat(a.sheetData,b,c)}),H.forEach(function(a,d){a.sheet&&a.sheet.formulaFromSJSFormat(a.sheetData,b,c)})),c.incrementLoadTask.addTask(function(a,b,c){f&&(g?f.resumeWithoutCalc():f.resume(!1),delete f.Q$J),F(i,k)},[f,a,c],g?o:n().STEP.startCalc,function(){return g?d.STEP_RATE.end:d.STEP_RATE.loadFileData+d.STEP_RATE.parseFile+d.STEP_RATE.loadSheetDataWithCalc+d.STEP_RATE.loadSheetFormulaWithCalc})},ZdK:function(a,b,c){var e,f,g,h,j,k,l,m,n,p,q,s,v,x,y=this,A=y.Wu,E=c&&!c.fullRecalc,G=d.Util.lkK(c,y.NjK);if(A&&(A.suspend(),A.Q$J=E),y.clearCustomNames(),e=y.sheets,G||e.forEach(function(a){a.yj().q$a=!0}),f=a.workbook.lossless,y.G$J=new i.ExternalReferenceManager(f&&f.externalReference),g=b.workbookNames,g&&g.length>0&&g.forEach(function(a){var b=a.name,c=t(a),e=a.comment;c&&y.Yu(y.Tu,b,""+d.Ul.oaa(c),0,0,!0,e,!0)}),y.YLb(),h=f&&f.formatStringNames)for(j=0;j<h.length;j++)k=h[j],r(k.sheetTabName)&&y.E4J(this.UHb,k.name,k.formula,k.row,k.col,!0,k.comment,o,!0);if(y.clearCustomFunctions(),l=f&&f.customFunctions)for(m in l)l.hasOwnProperty(m)&&(n=l[m],p=d.getTypeFromString(n.typeName),p&&(q=new p,q.fromJSON(n),y.Xu(q)));G||(s=[],v=a.workbook.rels&&a.workbook.rels.c_,x=u(a.workbook,C).c_,x.forEach(function(b){var c,d,e=B(z(b.name)),f=y.getSheetFromName(e),g=b[D],h=w(v,g),i=h&&h.Target;i&&(c=y.getSheetRelsName(i),d=void 0,d=i.indexOf("xl/chartsheets")>-1?a.chartsheets[c]:a.sheets[c],s.push({sheet:f,sheetData:d}))}),s.forEach(function(a){a.sheet&&a.sheet.nameFunctionFromSJSFormat(a.sheetData,b,c)}),s.forEach(function(a){a.sheet&&a.sheet.formulaFromSJSFormat(a.sheetData,b,c)})),c.incrementLoadTask.addTask(function(a,b,c){if(A){if(E)A.resumeWithoutCalc();else{A.resume(!1),delete A.UXJ;var d=y.getActiveSheet();d&&d.$p()}delete A.Q$J}F(G,e)},[A,a,c])},preFromJson:function(a,b,c){this.G$J=new i.ExternalReferenceManager(a.externalReference)},fromJson:function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y=this,z=y.Wu,A=a.noRecalc||c&&c.doNotRecalculateAfterLoad;if(z&&(z.suspend(),z.Q$J=A),y.clearCustomNames(),g=a.sheets,h=[],g)for(j in g)"string"==typeof j&&(k=g[j],f=y.getSheetFromName(k.name||j),f.yj().q$a=!0);if(l=a.names)for(m=0;m<l.length;m++)n=l[m],y.Yu(this.Tu,n.name,n.formula,n.row,n.col,!0,n.comment);if(y.YLb(),o=a.formatStringNames)for(m=0;m<o.length;m++)n=o[m],r(n.sheetTabName)&&y.E4J(this.UHb,n.name,n.formula,n.row,n.col,!0,n.comment);if(y.clearCustomFunctions(),p=a.customFunctions)for(q in p)p.hasOwnProperty(q)&&(s=p[q],t=d.getTypeFromString(s.typeName),t&&(u=new t,u.fromJSON(s,b),y.Xu(u)));if(g){e=0;for(j in g)"string"==typeof j&&(k=g[j],f=y.getSheetFromName(k.name||j),h.push(f),f.nameFunctionsFromJSON(k,b,c),e++);for(i=h.length,e=0;e<i;e++)f=h[e],f.formulaFromJSON(g[f.name()],b,c)}for(z&&(A?z.resumeWithoutCalc():(z.resume(!1),delete z.UXJ),delete z.Q$J),v=0,w=h;v<w.length;v++)f=w[v],x=f.yj(),x.MIb(),delete x.q$a},Wgc:function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,s,t,u,v=this,w=v.Wu,x=a.noRecalc||c&&c.doNotRecalculateAfterLoad;if(w&&(w.suspend(),w.Q$J=x),v.clearCustomNames(),g=a.sheets,h=[],g)for(j in g)"string"==typeof j&&(k=g[j],f=v.getSheetFromName(k.name||j),f.yj().q$a=!0);if(l=a.names)for(m=0;m<l.length;m++)n=l[m],v.Yu(this.Tu,n.name,n.formula,n.row,n.col,!0,n.comment);if(v.YLb(),o=a.formatStringNames)for(m=0;m<o.length;m++)n=o[m],r(n.sheetTabName)&&v.E4J(this.UHb,n.name,n.formula,n.row,n.col,!0,n.comment);if(v.clearCustomFunctions(),p=a.customFunctions)for(q in p)p.hasOwnProperty(q)&&(s=p[q],t=d.getTypeFromString(s.typeName),t&&(u=new t,u.fromJSON(s,b),v.Xu(u)));if(g){e=0;for(j in g)"string"==typeof j&&(k=g[j],f=v.getSheetFromName(k.name||j),h.push(f),f.nameFunctionsFromJSON(k,b,c),e++);for(i=h.length,e=0;e<i;e++)f=h[e],f.formulaFromJSON(g[f.name()],b,c)}c.incrementLoadTask.addTask(function(a,b,c){var d,e,g,i;for(w&&(x?w.resumeWithoutCalc():(w.resume(!1),delete w.UXJ,d=v.getActiveSheet(),d&&d.$p()),delete w.Q$J),e=0,g=h;e<g.length;e++)f=g[e],i=f.yj(),i.MIb(),delete i.q$a},[w,a,c])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("CalcEngine"),g=c("./dist/plugins/sheetsCalc/calc-spreadjs.js"),h=c("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),i=c("./dist/plugins/sheetsCalc/calc-extra-save.js"),j=null,k=void 0,l=d.GC$.each,m=e.Common.u.Nb,n=e.Common.u,o=new e.Common.ResourceManager(d.SR),p=o.getResource.bind(o),q=e.Common.j.Fa,r="_XLNM.PRINT_AREA",s="PRINT_AREA",t="Print_Area",u=d.Ul.JcK,v=d.range_parser.DcK,w=d.IndexHelper.R9,x=d.Ul.Q9,y=d.Ul.oaa,z=d.Util.addXLFNPrefix,A=/(\$?)([A-Z]+)(\$?)(\d+)/,B=/(\$?)(\d+):(\$?)(\d+)/,C=/(\$?)([A-Z]+):(\$?)([A-Z]+)/,D=parseInt,E=d.UsedRangeUtil.updateUsedRangeByData;function G(a){return"="===a.charAt(0)}function H(a){var b=a.indexOf("["),c=a.indexOf("]");return{left:b,right:c}}function I(a){var b=H(a),c=b.left,d=b.right;return c>=0&&c<d}function J(a){var b=H(a),c=b.left,d=b.right,e=a.indexOf("@");return c<e&&e<d}function K(a){return G(a)&&J(a)}function L(a){return G(a)&&I(a)}function M(a,b){var c,d;if(a.ODJ){if(b=b.trim(),L(b))return!0;if(b.indexOf("{{")>=0&&b.indexOf("}}")>=0)for(c=b.split(/{{|}}/),d=0;d<c.length;d++)if(L(c[d].trim()))return!0}return!1}function N(a,b,c,d){return c===k&&(c=a.getActiveRowIndex()),a.ODJ.G4J(b,c,d)}function O(a){return a.columnRelative}function P(a){return a.endColumnRelative}function Q(a){return a.rowRelative}function R(a){return a.endRowRelative}function S(a){return a.Cf()}function T(a){return a.column}function U(a){return a.toUpperCase()===r?t:a}function V(){var a=this;return a.W8J?void(a.W8J=!1):(a.Su={},a.Tu={},a.rDc?a.rDc.clearAll():a.sDc=new g.SheetSource(a,d.SheetArea.colHeader),a.tDc?a.tDc.clearAll():a.uDc=new g.SheetSource(a,d.SheetArea.rowHeader),void(a.et?a.et.clearAll():a.ft=new g.SheetSource(a,d.SheetArea.viewport)))}function W(a,b){var c,d,e,f,g=a.ITa.bIb&&a.ITa.bIb.anchors;if(g){b.spillCells={};for(c in g)if(Object.prototype.hasOwnProperty.call(g,c)){d=g[c];for(e in d)Object.prototype.hasOwnProperty.call(d,e)&&(f=d[e],f.isValid||(b.spillCells[c+","+e]=1))}}}function X(a,b,c,d,e,f){var g=a.Ms(b,c,d,e,f),h=g&&g.formulas;return h&&h.length>0}function Y(a,b,c,d,e,f,g){var h=X(a,b,c,d,e,3);return!h&&f&&(e=a.getColumnCount(2),h=X(a,b,0,d,e,2)),!h&&g&&(d=a.getRowCount(1),h=X(a,0,c,d,e,1)),h}function Z(a){var b,c,d,e=[],f=[];for(b=0;b<a.length;b++)c=a[b],d=""+c.row+c.col+c.rowCount+c.colCount+c.sheetName,e.indexOf(d)<0&&(e.push(d),f.push(c));return f}function $(a,b){var c=a.formulaLoad/a.total;return b?.4*c+.5:.3*c+.4}function _(a,b,c,d,e,f){var g,h,i,j,k,l=d.yj(),m=a&&a.formula;m&&(g=void 0,"object"==typeof m&&(h=d.Bj(f),i=d.Q5J[m.si],i.baseRow===b&&i.baseColumn===c?m=i.formula:(g=h.Kf(i.baseRow,i.baseColumn),g?(g.S5J=m.si,d.Wu.UXJ&&d.Wu.UXJ[l.id+","+i.baseRow+","+i.baseColumn]&&(d.Wu.UXJ[l.id+","+b+","+c]={id:l.id,row:b,col:c})):(m=i.formula,i.baseRow=b,i.baseColumn=c))),j=a.arrayInfo,j&&!j.isDynamicArray?d.bv(b,c,D(j.rowCount,10),D(j.colCount,10),m,!0,f):(j&&(j.isInvalid&&l.LIb(b,c),k=l.getCalcSourceModel(),k.t$J=!0,l.RLb().setArray(l,j.row,j.col,j.rowCount,j.colCount,[],!0),delete k.t$J),d._u(b,c,m,g,!0,f,!0,!j)))}function aa(a,b,c,e,f,g,h){var i,j,k,l,m,n,o,p,q,r=f&&f.incrementLoadTask;if(r&&!r.isTerminated){for(i=r.isBusyFunc,g=g||0,j=g,a.suspendPaint(),k=30,l=new Date;j<c;){if(m=b[j])for(n=0;n<e;n++)_(m[n],j,n,a,!0,h);if(j++,i&&i())break;if(o=new Date,o-l>k)break}a.resumePaint(),f||(f={}),p=f&&f.incrementalLoading,p&&(p.loadStatus.formulaLoad+=j-g,q=$(p.loadStatus,f.doNotRecalculateAfterLoad),a.parent&&a.parent.Wq(d.Events.ProgressChanged,{loadStatus:p.loadStatus,progress:q,sheet:a}),p.loading&&p.loading(q,{sheet:a})),j<c&&f.incrementLoadTask.pushTask(aa,[a,b,c,e,f,j])}}function ba(a,b,c,d,e){var f,g,h;for(f=0;f<c;f++)if(g=b[f])for(h=0;h<d;h++)_(g[h],f,h,a,!0,e)}b.R$J=ba;function ca(a,b,c,d,e,f,h){var l,m,n,o,p,r,s,t=a.yj(),u=a.ITa,w=u.TdK||0,x=u.UdK||0;b!==k&&(l=y(b.f),m=b.g,n=b.r,n!==k&&(o=v(n)),"shared"===b.d&&m>=0&&(l?(r={formula:l},o&&(r.lastRow=o.rowCount+o.row-1,r.lastColumn=o.colCount+o.col-1,r.baseRow=o.row,r.baseColumn=o.col,o=j),f[m]||(f[m]=r,f.nextIndex=Math.max(f.nextIndex,m+1)),l={si:m}):l={si:m},s=a.Q5J[l.si],s.baseRow===c&&s.baseColumn===d?l=s.formula:(p=e.Kf(s.baseRow,s.baseColumn),p?(p.S5J=l.si,a.Wu.UXJ&&a.Wu.UXJ[t.id+","+s.baseRow+","+s.baseColumn]&&(a.Wu.UXJ[t.id+","+c+","+d]={id:t.id,row:c,col:d})):(l=s.formula,s.baseRow=c,s.baseColumn=d))),q(l)||(1===+b.a&&o&&(o.isDynamicArray=!0,h&&h.spillCells&&h.spillCells[c+","+d]&&(o.isInvalid=!0)),l=g.processFunctionPrefix(l),o&&!o.isDynamicArray?c>=w&&d<x?a.bv(c,d,D(o.rowCount,10),D(o.colCount,10),l,!0,2):c<w&&d>=x?a.bv(c,d,D(o.rowCount,10),D(o.colCount,10),l,!0,1):c>=w&&d>=x&&a.bv(c,d,D(o.rowCount,10),D(o.colCount,10),l,!0,3):(o&&(o.isInvalid&&t.LIb(c,d),t.RLb().setArray(t,o.row,o.col,o.rowCount,o.colCount,[],!0)),!p&&h&&h.exprs&&h.exprs[b.e]&&(p=i.exprFromJSON(h.exprs[b.e],t.getParserContext(!1)),h.exprs[b.e].nw&&(p.T5J=!0)),c>=w&&d<x?a._u(c,d,l,p,!0,2,!0,!o):c<w&&d>=x?a._u(c,d,l,p,!0,1,!0,!o):c>=w&&d>=x&&a._u(c,d,l,p,!0,3,!0,!o))))}function da(a,b,c,e,f,g,h,i){var j,k,l,m,o,q,r,s,t,u,v,w=g&&g.incrementLoadTask,x=w.isBusyFunc;for(h=h||0,j=h,a.suspendPaint(),a.suspendCalcService(),k=g.openMode===d.OpenMode.incremental,l=30,k&&(m=new Date),o=a.Q5J=a.Q5J||{nextIndex:0},q=a.Bj(3);j<c;){if(r=b[j])for(s=0;s<e;s++)ca(a,r[s],j,s,q,o,f);if(j++,!i&&x&&x())break;if(k&&(t=new Date,!i&&t-m>l))break}a.resumeCalcService(),a.resumePaint(),g.loadStatus.formulaLoad+=j-h,k&&(u=g.loadStatus.formulaLoad/g.loadStatus.total,v=+(g.fullRecalc?.3*u+.5:.4*u+.6).toFixed(5),g.incrementLoadTask.progress&&g.incrementLoadTask.progress({progress:v,sheetName:a.name(),step:n.Kb(p().STEP.loadSheetFormula,[a.name()])})),j<c&&g.incrementLoadTask.pushTask(da,[a,b,c,e,f,g,j])}function ea(a,b,c,e){var f=d.Worksheet._n;f&&l(f,function(d,f){var g=f.fromJsonAfterFormula;g&&g.call(a,b,c,e)})}function fa(a,b,c,e){var f=d.Worksheet._n;f&&l(f,function(d,f){var g=f.fromJsonAfterSJSFormula;g&&g.call(a,b,c,e)})}function ga(a,b,c,e,f,g){var h,i=d.Worksheet._n,j=!1,k=e.getReferenceSheetNames(),m=a&&a.NjK,n=function(b){if(k.hasOwnProperty(b)){j=!0;var c=a.VCJ(b);m.sheetsState[b]||m.refSheetsState[b]||!c||(m.refSheetsState[b]=1,m.getSheet(b,function(a){c.cdK(a,f,g,!0),i&&l(i,function(b,d){d.refSheetLazyLoaded&&d.refSheetLazyLoaded.call(c,a,f,g)})}))}};for(h in k)n(h);j&&i&&l(i,function(a,d){d.afterRefSheetLazyLoaded&&d.afterRefSheetLazyLoaded.call(b,c,f,g)})}F=d.Worksheet.prototype,F.resetCalc=function(){V.call(this),this.W8J=!0},F.recalcAll=function(a){var b,c,d,e,f,g,h,i,j,l,m,n,o,p,q,r=S(this);if(r){if(this.suspendPaint(),r.suspend(!0),a)for(b=this.parent,c=void 0,c=b&&b.sheets||[this],d=0;d<c.length;d++){if(e=c[d],f=e.Tu,g=e.yj(),f)for(h in f)i=f[h],j=i.Lf,j!==k&&(l=r.unparse(g,j,0,0),i.Lf=r.parse(g,l,0,0));for(m=g.getCalcSourceModel(),n=m.getAllNodes(),o=0;o<n.length;o++)p=n[o],q=p.calc,q&&p.Lf&&na(r,q)}r.resume(a),this.resumePaint()}},F.recalcRange=function(a,b,c,d){var e=S(this);e&&e.recalcRange(this.yj(),a,b,c,d)},F.recalcRows=function(a){var b,c=S(this);if(c&&!c.ignoreDirty()){for(c.suspend(),b=0;b<a.length;b++)c.recalculate(this.ft,a[b],-1);c.resume(!1)}},F.recalcCols=function(a){var b,c=S(this);if(c&&!c.ignoreDirty()){for(c.suspend(),b=0;b<a.length;b++)c.recalculate(this.ft,-1,a[b]);c.resume(!1)}},F.zq=function(a,b,c){var d,e=S(this);e&&!e.ignoreDirty()&&(d=this.ft,1===c?d=this.sDc:2===c&&(d=this.uDc),e.recalculate(d,a,b))},F.getCalcService=function(){return this.Wu||(this.Wu=new f.CalcService,this.yj(d.SheetArea.colHeader).setCalcService(this.Wu),this.yj(d.SheetArea.rowHeader).setCalcService(this.Wu),this.yj().setCalcService(this.Wu),this.Wu.initParserContext(this.yj())),this.Wu},F.Cf=function(){return this.getCalcService()},F.suspendCalcService=function(a){var b=S(this);b&&b.suspend(a)},F.resumeCalcService=function(a){var b=S(this);b&&b.resume(a)},F.yj=function(a){return q(a)||3===a?this.ft:1===a?this.sDc:2===a?this.uDc:j},F.Bj=function(a){var b=this;return 1===a?(!b.rDc&&b.sDc&&(b.rDc=b.Cf().getSourceModel(b.sDc)),b.rDc):2===a?(!b.tDc&&b.uDc&&(b.tDc=b.Cf().getSourceModel(b.uDc)),b.tDc):(!b.et&&b.ft&&(b.et=b.Cf().getSourceModel(b.ft)),b.et)},F.vDc=function(a,b,c,d,e){var f=this.Bj(e);return f&&f.tg(a,b,c,d,!0,!0)},F.Ns=function(a,b,c,d,e,f){var g=this.vDc(a,b,c,d,3);return!g&&e&&(d=this.getColumnCount(2),g=this.vDc(a,0,c,d,2)),!g&&f&&(c=this.getRowCount(1),g=this.vDc(0,b,c,d,1)),g},F.Ms=function(a,b,c,d,e){var f=this.Bj(e);return f&&f.tg(a,b,c,d,!1,!0)},F.Vq=function(a,b,c,d,e,f,g){var h,i;return void 0===e&&(e=!0),h=e&&this.Ns(a,b,c,d,f,g),i=!e&&Y(this,a,b,c,d,f,g),!h&&!i||(this.Os(4,p().Exp_ChangePartOfArray),!1)},F.addCustomFunction=function(a){this.Xu(a),this.recalcAll()},F.Xu=function(a){if(!(a&&a instanceof f.Functions.Function))throw Error(p().Exp_InvalidCustomFunction);a.name=m(a.name),this.Su[a.name]=a},F.getCustomFunction=function(a){return a?this.Su[m(a)]:j},F.removeCustomFunction=function(a){a&&(delete this.Su[m(a)],this.recalcAll())},F.clearCustomFunctions=function(){this.Su={},this.recalcAll()},F.Pu=function(a){var b,c,d;return a?(b=this,c=b.parent,d=b.getCustomFunction(a),!d&&c&&c.getCustomFunction&&(d=c.getCustomFunction(a)),d):j},F.addCustomName=function(a,b,c,d,e){this.Yu(a,b,c,d,!1,e)},F.getCustomName=function(a){return a?this.Tu[m(a)]:k},F.getCustomNames=function(){var a=[];return l(this.Tu,function(b,c){a.push(c)}),a},F.removeCustomName=function(a){var b,c;a&&(b=m(a),delete this.Tu[b],c={},c[b]=b,this.Zu(c,!1))},F.clearCustomNames=function(){var a=this,b=a.Tu;a.Tu={},this.Zu(b,!1)},F.createNameInfo=function(a,b,c,d,e){var f,h=this,i=S(h),k=h.yj();return i&&k?(f=i.parse(k,b,d,e),new g.NameInfo(a,f,d,e,c)):j},F.H$a=function(a){var b,c=this,d=!c.Tu[m(a)];return d&&(b=c.tables,b&&(d=!b.findByName(a))),d},F.isValidCustomName=function(a){return a&&d.Ul.G$a(a)&&this.H$a(a)},F.Yu=function(a,b,c,d,e,f){var h,i,j,k,l=this;if(!a||!b||!e&&!l.isValidCustomName(a))throw Error(p().Exp_InvalidCustomName);if(h=S(l),i=l.yj(),h&&i){if(j=void 0,e)try{j=h.parse(i,b,c,d,!1,!1,!0)}catch(a){}else j=h.parse(i,b,c,d);l.Tu[m(a)]=new g.NameInfo(a,j,c,d,f),e||(k={},k[a]=a,this.Zu(k,!0))}},F.siK=function(a,b,c,d,e,f,h,i){var j,k,l,n=this;if(!a||!b||!f&&!n.isValidCustomName(a))throw Error(p().Exp_InvalidCustomName);j=S(n),k=n.yj(),j&&k&&(n.Tu[m(a)]=new g.NameInfo(a,c,d,e,h),f||(l={},l[a]=a,this.Zu(l,!0)))},F.Zu=function(a,b){var c,d=this.Bj();if(d){for(c in a)d.updateNameCalc(c,b);this.recalcAll()}},F.$u=function(a){var b,c,d;return a?(b=this,c=b.parent,d=b.getCustomName(a),!d&&c&&c.getCustomName&&(d=c.getCustomName(a)),d):j},F.setFormula=function(a,b,c,d){this._u(a,b,c,j,!1,d)},F._u=function(a,b,c,e,f,g,h,i,l){var m,n,o,r,s,t,u,v,w,x,y,z,A,B,C=this;return q(g)&&(g=3),a<0||a>=C.getRowCount(g)||b<0||b>=C.getColumnCount(g)?void C.Os(0,p().Exp_IndexOutOfRange):(m=a>=0?a:0,n=b>=0?b:0,o=C.yj(g),r=C.options.keepUnknownFormulas,s=C.Wu,s.forceR1C1Formula?(t=s.useR1C1,s.useR1C1=!0,e=e||(c&&s?s.parse(o,c,m,n,!1,f,!1,r):j),s.useR1C1=t):e=e||(c&&s?s.parse(o,c,m,n,!1,f,f,r):j),e&&i&&(e.ensureSingle=!0),u=C.tables,void(3===g&&a>=0&&b>=0&&u&&!(v=u.Hma(a,b,1,1,c,e))||(w=r&&c&&!e,x=C.Bj(g),y=C.conditionalFormats,x&&(z=x.getFormula(a,b),A=C.ITa,x.t$J=!0,x.setFormula(a,b,c,e,f,k,A.dUa(),l,r),delete x.t$J,x.usedRange&&E(x.usedRange,a,b,z,c),w&&(B=x.getNode(a,b,!0),B&&(B.H$J=c)),y&&y.Nm(),C.hasFormula(a,b,g)&&A.VkK(a,b,g),h?C.aPJ(C,[{row:a,col:b}],0):(C.Bq("formula",a,b,g,z,c),C.Wq(d.Events.WorksheetDataChanged,{type:"formula"}))),C.t4&&C.t4(a,b,1,1,g),C.$p())))},F.P5J=function(a,b,c,d,e,f,g,h){var i,k,l,m,n,o=this,q=this.Cf();if(a<0||a>=o.getRowCount()||b<0||b>=o.getColumnCount())return void o.Os(0,p().Exp_IndexOutOfRange);if(k=o.Bj(g))for(l=a;l<c+a;l++)for(m=b;m<d+b;m++)l===a&&m===b&&(o._u(a,b,e,j,!1,g),i=k.Kf(a,b),o.Q5J=o.Q5J||{nextIndex:0},n=o.Q5J.nextIndex,o.Q5J[n]={formula:q.unparse(this.ft,i,a,b,!1,!0),baseRow:a,baseColumn:b,lastRow:a+c-1,lastColumn:b+d-1},o.Q5J.nextIndex++,i.S5J=n),o._u(l,m,e,i,!0,g,!0,!0)},F.setArrayFormula=function(a,b,c,d,e,f){this.bv(a,b,c,d,e,!1,f)},F.bv=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,q,r;if(void 0===g&&(g=3),i=this,a<0||a+c>i.getRowCount()||b<0||b+d>i.getColumnCount())return void i.Os(0,p().Exp_IndexOutOfRange);if(i.ITa.MTa(a,b,c,d))return void i.Os(0,p().Exp_ArrayFormulaSpan);if(j=i.tables,!(3===g&&a>=0&&b>=0&&j)||(k=j.Hma(a,b,c,d,e))){if(l=i.Bj(g),m=i.conditionalFormats,l){for(i.suspendEvent(),n=[],o=a;o<a+c;o++)for(n[o]=[],q=b;q<b+d;q++)n[o][q]=l.getFormula(o,q);for(l.setArrayFormula(a,b,c,d,e,f,i.ITa.dUa(),h),o=a;o<a+c;o++)for(q=b;q<b+d;q++)l.usedRange&&E(l.usedRange,o,q,n[o][q],e);if(i.resumeEvent(),m&&m.Nm(),i.jm<1){for(r=[],o=a;o<a+c;o++)for(q=b;q<b+d;q++)r.push({row:o,col:q});i.Bu(a,b,c,d,r,5,g,e)}}i.$p()}},F.getFormula=function(a,b,c,d){var e=this.Bj(c);return e?e.getFormula(a,b,d):j},F.Ima=function(a,b,c){var d=this.Bj(c);return d?d.Kf(a,b):j},F.getFormulaInformation=function(a,b,c,e){var f,g,h,i,j,k={},l=this.Bj(c);return l&&(f=l.Kf(a,b),f?(g=l.Qf(a,b),k.hasFormula=!0,g&&!g.isDynamicArray&&(k.baseRange=new d.Range(g.row,g.col,g.rowCount,g.colCount)),k.isArrayFormula=g&&!g.isDynamicArray,a=g?g.row:a,b=g?g.col:b,e||(k.formula=this.Wu.unparse(this.ft,f,a,b),k.formulaWithCulture=this.Wu.unparse(this.ft,f,a,b,!0)),k.hasFormula=!!k.formula):(h=this.ITa.getDynamicArrayInfo(a,b),h&&h.isValid&&(i=h.row,j=h.col,a===i&&b===j||(f=l.Kf(i,j),e||(k.formulaWithCulture=this.Wu.unparse(this.ft,f,i,j,!0)),k.hasFormula=!0,k.isDynamicArray=!0)))),k},F.zCc=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r;for(c||(c=this,d=a,e=b,f=[]),g=c.bPJ(d,e),h=this.name(),i=0;i<g.length;i++){if(j=g[i],k=j.sheetName+"_"+j.row+"_"+j.col+"_"+j.rowCount+"_"+j.colCount,f[k])return!1;if(f[k]=!0,(j.row<=a&&a<j.row+j.rowCount||j.rowCount===-1)&&(j.col<=b&&b<j.col+j.colCount||j.colCount===-1)&&h===j.sheetName)return!0;for(l=j.sheetName===h?c:c.parent.getSheetFromName(j.sheetName),m=j.rowCount,n=j.row,o=j.colCount,p=j.col,m===-1&&(m=l.getRowCount(),n=0),o===-1&&(o=l.getColumnCount(),p=0),q=n;q<m+n;q++)for(r=p;r<o+p;r++)if(this.zCc(a,b,l,n,p,f))return!0}return!1},F.getPrecedents=function(a,b){var c,d,e,f,g,h=[],i=this.Bj();return i&&(c=i.Mf(a,b)||i.Kf(a,b),d=this.getFormulaInformation(a,b,3,!0),e=d.baseRange,f=e?e.row:a,g=e?e.col:b,this.VGb(c,f,g,h),h=Z(h)),h},F.getDependents=function(a,b){var c=[],d=this.parent&&this.parent.sheets||[this],e=this.name();return d.forEach(function(d){var f,g,h,i,j,k=d.getRowCount(),l=d.getColumnCount(),m=d.name();for(f=0;f<k;f++)for(g=0;g<l;g++)for(h=d.getPrecedents(f,g),i=0;i<h.length;i++)if(j=h[i],j.sheetName===e&&(j.row===-1||j.row<=a&&a+1<=j.row+j.rowCount)&&(j.col===-1||j.col<=b&&b+1<=j.col+j.colCount)){c.push({row:f,col:g,rowCount:1,colCount:1,sheetName:m});break}}),c};function ha(a){return function(b){var c=b.ah.xf,d=c?c.kj.name():this.name(),e=c?c.kj._id:this._id;a[e+" "+b.row+" "+b.column]={row:b.row,col:b.column,rowCount:1,colCount:1,sheetName:d}}}F.bPJ=function(a,b){var c,d,e={},f=this.Bj().qg(a,b),g=this.Bj().ug();return f&&(c=f[0],c&&c.forEach(ha(e))),g&&(d=g[0],d&&d.forEach(function(c){if((c.row===-1||c.row<=a&&a+1<=c.row+c.rowCount)&&(c.col===-1||c.col<=b&&b+1<=c.col+c.colCount)){var d=c.content;d.forEach(ha(e))}})),ia(e)};function ia(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c}F.VGb=function(a,b,c,d){var e,g,h,i,j,k;if(a)switch(e=a.type){case f.ExpressionType.reference:case f.ExpressionType.structReference:g=a.getRange(b,c),d.push({row:g.row,col:g.col,rowCount:g.rowCount,colCount:g.colCount,sheetName:a.source&&a.source.kj?a.source.kj.name():this.name()});break;case f.ExpressionType.operator:this.VGb(a.value,b,c,d),this.VGb(a.value2,b,c,d);break;case f.ExpressionType.expand:case f.ExpressionType.parentheses:this.VGb(a.value,b,c,d);break;case f.ExpressionType.name:h=this.$u(a.value),this.VGb(h.getExpression(),b,c,d);break;case f.ExpressionType.function:for(i=a.arguments,j=0;j<i.length;j++)k=i[j],this.VGb(k,b,c,d)}},F.hasFormula=function(a,b,c){var d=this.Bj(c);return!!d&&d.hasFormula(a,b)},F.dv=function(){var a=this.Bj();a&&a.kVJ(function(a){a.ng(),a.og()})},F.clearFormula=function(a,b,c,d,e){var f,g,h=this;for(a<0&&(a=0,c=h.getRowCount()),b<0&&(b=0,d=h.getColumnCount()),f=0;f<c;f++)if(e(h,f+a))for(g=0;g<d;g++)h.setFormula(f+a,g+b,j)},F.nameFunctionsFromJSON=function(a,b,c,e){var f,g,h,i,j,k,l,m,n;if(a){if(f=this,g=a.customFunctions)for(h in g)g.hasOwnProperty(h)&&(i=g[h],j=d.getTypeFromString(i.typeName),j&&(k=new j,k.fromJSON(i,b),f.Xu(k)));if(l=a.names,l&&l.length>0){for(m=0;m<l.length;m++)n=l[m],f.Yu(U(n.name),n.formula,n.row,n.col,!0,n.comment);f.dv()}e&&e()}},F.formulaFromJSON=function(a,b,c){var d,e,f;a&&(d=this,d.Q5J=a.sharedFormulas,e=c&&c.ignoreFormula,f=c&&c.incrementalLoading,[a.colHeaderData,a.rowHeaderData,a.data].forEach(function(a,b){var g,h,i,j;a&&!e&&a.dataTable&&(g=b+1,h=a.dataTable,i=d.getRowCount(g),j=d.getColumnCount(g),
f?aa(d,h,i,j,c,0,g):ba(d,h,i,j,g))}),f?c.incrementLoadTask.pushTask(ea,[d,a,b,c]):ea(d,a,b,c))};function ja(a,b,c,d,e,f,g){if(f&&a.lossless&&[a.lossless.colHeaderData,a.lossless.rowHeaderData].forEach(function(a,c){var d,f,h,i;a&&a.dataTable&&(d=c+1,f=a.dataTable,h=b.getRowCount(d),i=b.getColumnCount(d),g?aa(b,f,h,i,e,0,d):ba(b,f,h,i,d))}),f&&c.mhK&&a.lossless.tree&&a.lossless.tree.length>0){delete c.mhK;var h=null,j=a.lossless.tree;"rangeCalc"===j[j.length-1].k&&(h=j.pop()),i.IiK(b.Bj(),j,e.lhK),h&&i.hhK(b.Bj(),h,e.lhK)}g?e.incrementLoadTask.pushTask(fa,[b,a,d,e]):fa(b,a,d,e)}F.formulaFromSJSFormat=function(a,b,c,e){var f,g,h,i=this,j=i.yj(),k=!c||c.includeFormulas!==!1,l=d.Util.mkK(c),m=d.Util.lkK(c,i.parent&&i.parent.NjK),o=i.Bj(3);j.q$a=!0,k&&a.lossless&&a.lossless.tree&&c.lhK&&(o.mhK=!0,j.setReferenceSheetNames(a.lossless.referenceSheetNames)),f=u(a,d.XFileConstants.HbK),f?(g=f.rowCount,h=f.colCount,e?(k&&da(i,f,g,h,a.lossless,c,0,e),ja(a,i,o,b,c,k,l)):(k&&c.incrementLoadTask.addTask(da,[i,f,g,h,a.lossless,c,0],n.Kb(p().STEP.loadSheetFormula,[i.name()]),function(){var a=c.loadStatus.formulaLoad/c.loadStatus.total;return c.fullRecalc?m?.5:a*d.STEP_RATE.loadSheetFormulaWithCalc+d.STEP_RATE.loadSheetDataWithCalc+d.STEP_RATE.parseFile+d.STEP_RATE.loadFileData:m?.6:a*d.STEP_RATE.loadSheetFormula+d.STEP_RATE.loadSheetData+d.STEP_RATE.parseFile+d.STEP_RATE.loadFileData},i.name()),c.incrementLoadTask.addTask(ja,[a,i,o,b,c,k,l]))):e?ja(a,i,o,b,c,k,l):c.incrementLoadTask.addTask(ja,[a,i,o,b,c,k,l])},F.nameFunctionFromSJSFormat=function(a,b,c){var e,f,h,k,l,m,n=this,o=n?n.yj():j,p=a.lossless&&a.lossless.customFunctions;if(p)for(e in p)p.hasOwnProperty(e)&&(f=p[e],h=d.getTypeFromString(f.typeName),h&&(k=new h,k.fromJSON(f),n.Xu(k)));l=a.lossless&&a.lossless.definedNames,m=a.lossless&&a.lossless.nExpr,l&&l.length>0&&(l.forEach(function(a){var b=""+a.c_[0];"_xlnm.Print_Titles"===a.name?sa(n,b):m&&m[a.e]?n.siK(U(a.name),g.processFunctionPrefix(d.Ul.oaa(b)),i.exprFromJSON(m[a.e],o.getParserContext(!1)),0,0,!0,a.comment,"_xlnm.Print_Area"!==a.name):n.Yu(U(a.name),g.processFunctionPrefix(d.Ul.oaa(b)),0,0,!0,a.comment,"_xlnm.Print_Area"!==a.name)}),n.dv())},F.ev=function(a){var b=this,c=b.Wu;c&&!a||(b.Wu=a?a:new f.CalcService,b.yj(d.SheetArea.colHeader).setCalcService(b.Wu),b.yj(d.SheetArea.rowHeader).setCalcService(b.Wu),b.yj(d.SheetArea.viewport).setCalcService(b.Wu),b.Wu.initParserContext(b.yj()),c?(a.setSourceModel(b.sDc,c.getSourceModel(b.sDc)),a.setSourceModel(b.uDc,c.getSourceModel(b.uDc)),a.setSourceModel(b.ft,c.getSourceModel(b.ft))):(b.rDc=b.Wu.getSourceModel(b.sDc),b.tDc=b.Wu.getSourceModel(b.uDc),b.et=b.Wu.getSourceModel(b.ft)),b.et.usedRange=new d.BaseUsedRange)},F.setCalc=function(a,b){this.Wu=a,this.ft=b||this.ft,this.et=a.getSourceModel(this.ft),this.parent&&(this.parent.Wu=a)},F.fv=function(){this.gv(!1,1)},F.mUa=function(a,b){var c,e,f,g,h,i,j,k,l=this,m=a.changeType,n=a.row,o=a.rowCount,p=a.col,q=a.colCount,r=l.Bj(),s=r.usedRange;r&&(c=l.ITa,e=c.dUa(),f=S(r),g=r.xf,h=f.ih(),i=f.lh.asyncManager,"addingRows"===m?l.Vq(n,0,0,l.getColumnCount(),void 0,!0,!1)?(j=l.Bj(2),h.onBeforeAddRemoveRows(r,n,j),b||d.clearSpillValuesOnAddRemove(c,n,o,!0,!0),la(l,n,o,!0,!0),[r,j].forEach(function(a){a.addRows(n,o)}),i.addRows(g,n,o)):a.canAdd=!1:"addRows"===m?(f.suspend(),j=l.Bj(2),h.onAfterAddRemoveRows(r,n,o,!0,b,j),f.resume(!1),e&&e.push({type:"addRows",row:n,rowCount:o}),s&&s.addHeadInfo(n,o,!0)):"deletingRows"===m?l.Vq(n,0,o,l.getColumnCount(),void 0,!0,!1)?(j=l.Bj(2),h.onBeforeAddRemoveRows(r,n,j),b||d.clearSpillValuesOnAddRemove(c,n,o,!1,!0),la(l,n,o,!1,!0),[r,j].forEach(function(a){a.deleteRows(n,o)}),i.deleteRows(g,n,o)):a.canDelete=!1:"setRowCount"===m?(f.suspend(),j=l.Bj(2),n<o?(r.Ag(n+1,0,o-n,l.getColumnCount()),j.Ag(n+1,0,o-n,l.getColumnCount())):(r.Ag(o+1,0,n-o,l.getColumnCount()),j.Ag(o+1,0,n-o,l.getColumnCount())),f.S$J(m),f.resume(!1)):"setColumnCount"===m?(f.suspend(),k=l.Bj(1),p<q?(r.Ag(0,p+1,l.getRowCount(),q-p),k.Ag(0,p+1,l.getRowCount(),q-p)):(r.Ag(0,q+1,l.getRowCount(),p-q),k.Ag(0,q+1,l.getRowCount(),p-q)),f.S$J(m),f.resume(!1)):"deleteRows"===m?(f.suspend(),j=l.Bj(2),h.onAfterAddRemoveRows(r,n,o,!1,b,j),f.resume(!1),e&&e.push({type:"deleteRows",row:n,rowCount:o}),s&&s.removeHeadInfo(n,o,!0)):"addingColumns"===m?l.Vq(0,p,l.getRowCount(),0,void 0,!1,!0)?(k=l.Bj(1),h.onBeforeAddRemoveColumns(r,p,k),b||d.clearSpillValuesOnAddRemove(c,p,q,!0,!1),la(l,p,q,!0,!1),[r,k].forEach(function(a){a.addColumns(p,q)}),i.addColumns(g,n,o)):a.canAdd=!1:"addColumns"===m?(f.suspend(),k=l.Bj(1),h.onAfterAddRemoveColumns(r,p,q,!0,b,k),f.resume(!1),e&&e.push({type:"addColumns",col:p,colCount:q}),s&&s.addHeadInfo(p,q,!1)):"deletingColumns"===m?l.Vq(0,p,l.getRowCount(),q,void 0,!1,!0)?(k=l.Bj(1),h.onBeforeAddRemoveColumns(r,p,k),b||d.clearSpillValuesOnAddRemove(c,p,q,!1,!1),la(l,p,q,!1,!1),[r,k].forEach(function(a){a.deleteColumns(p,q)}),i.deleteColumns(g,n,o)):a.canDelete=!1:"deleteColumns"===m&&(f.suspend(),k=l.Bj(1),h.onAfterAddRemoveColumns(r,p,q,!1,b,k),f.resume(!1),e&&e.push({type:"deleteColumns",col:p,colCount:q}),s&&s.removeHeadInfo(p,q,!1)))},F.CeK=function(a,b,c,d){var e,f,g,h=c.type,i=this;if(d){if("addRows"===h)c.changeType="addingRows",i.mUa(c),c.changeType="addRows",i.mUa(c);else if("deleteRows"===h)c.changeType="deletingRows",i.mUa(c),c.changeType="deleteRows",i.mUa(c);else if("addColumns"===h)c.changeType="addingColumns",i.mUa(c),c.changeType="addColumns",i.mUa(c);else if("deleteColumns"===h)c.changeType="deletingColumns",i.mUa(c),c.changeType="deleteColumns",i.mUa(c);else if("customName"===h)e=a.parse(i,c.newFormula,0,0),c.nameInfo.fg(e);else if("condition"===h){for(f=[],g=0;g<c.newFormulas.length;g++)e=a.parse(i,c.newFormulas[g],0,0),f.push(e);c.condition.setExpressions(f)}}else if("addRows"===h)c.changeType="deletingRows",i.mUa(c,!0),c.changeType="deleteRows",i.mUa(c,!0);else if("deleteRows"===h)c.changeType="addingRows",i.mUa(c,!0),c.changeType="addRows",i.mUa(c,!0);else if("addColumns"===h)c.changeType="deletingColumns",i.mUa(c,!0),c.changeType="deleteColumns",i.mUa(c,!0);else if("deleteColumns"===h)c.changeType="addingColumns",i.mUa(c,!0),c.changeType="addColumns",i.mUa(c,!0);else if("customName"===h)e=a.parse(i,c.formula,0,0),c.nameInfo.fg(e);else if("condition"===h){for(f=[],g=0;g<c.formulas.length;g++)e=a.parse(i,c.formulas[g],0,0),f.push(e);c.condition.setExpressions(f)}},F.nUa=function(a,b,c){var d=c.type,e=this;"addRows"===d?(c.changeType="deletingRows",e.mUa(c,!0),c.changeType="deleteRows",e.mUa(c,!0)):"deleteRows"===d?(c.changeType="addingRows",e.mUa(c,!0),c.changeType="addRows",e.mUa(c,!0)):"addColumns"===d?(c.changeType="deletingColumns",e.mUa(c,!0),c.changeType="deleteColumns",e.mUa(c,!0)):"deleteColumns"===d?(c.changeType="addingColumns",e.mUa(c,!0),c.changeType="addColumns",e.mUa(c,!0)):"customName"===d?c.nameInfo.fg(c.expr):"condition"===d&&c.condition.setExpressions(c.expressions)},F.DeK=function(a,b){var c,d,e=this,f=S(e),g=e.Bj();if(f.suspend(),b)for(c=0;c<a.length;c++)d=a[c],d.type?e.CeK(f,g,d,b):d.newValue&&e.setFormula(d[0],d[1],d.formula);else for(c=a.length-1;c>=0;c--)d=a[c],d.type?e.CeK(f,g,d,b):d.newValue||e.setFormula(d[0],d[1],d.formula);f.resume(!1)},F.gUa=function(a){var b,c,d,e,f,g,h,i,j,k=S(this),l=this.Bj();for(k.suspend();a.length;){if(b=a.pop(),c=b[0],d=b[1],e=l.Kf(c,d),f=this.ITa.getDynamicArrayInfo(c,d),g=[],f)for(h=f.row;h<f.row+f.rowCount;h++)for(g[h]=[],i=f.col;i<f.col+f.colCount;i++)g[h][i]=this.getValue(h,i);if(b.type?this.nUa(k,l,b):l.$Va.apply(l,b),j=l&&l.usedRange,j&&(E(j,b[0],b[1],e,b[2]),f))for(h=f.row;h<f.row+f.rowCount;h++)for(i=f.col;i<f.col+f.colCount;i++)h===b[0]&&i===b[1]||E(j,h,i,g[h][i],b[2])}k.resume(!1)},F.getReferenceRange=function(a){var b,c,e,g,h=this.yj(),i=this.getCalcService(),j=i.parse(h,a,0,0),k=j.baseTable;return j&&k&&a===k.name()?(b=k.range(),c=k.kj&&k.kj.name()):(e=i.lh.evaluateExpression(j,h.getEvaluatorContext({row:0,col:0},!1),!1,!0,!0),e instanceof f.CalcReference&&(c=e.getSource().getName(),e.getRangeCount()>0&&(g=0,b=d.kf(e.getRow(g),e.getColumn(g),e.getRowCount(g),e.getColumnCount(g))))),{sheetName:c,range:b}},F.C4J=function(a,b,c){var d,e=this,f="string"==typeof c&&e.parent&&e.parent.dJb(c);return f&&a!==-1&&b!==-1?(d=f.getExpression(),M(e,c)?N(e,d,a,b):g.evaluateExpression(e,d,a,b)):k},F.D4J=function(a,b,c){var d,e,h,i,j,k,l,m,n=this;if(a===-1&&(a=0),b===-1&&(b=0),d=!!n.ODJ,e=n.getCell(a,b,3),h=g.rangeToFormula(e,a,b,3),i=c.trim(),"="===i.charAt(0)&&i.indexOf("@")>=0&&!K(i)&&(i=i.replace(/@/g,h)),i.indexOf("{{")>=0&&i.indexOf("}}")>=0){for(j=i.split(/{{|}}/),""===j[0]&&j.shift(),""===j[j.length-1]&&j.pop(),k=0;k<j.length;k++)j[k].indexOf("=")===-1?j[k]='"'+j[k]+'"':d&&K(j[k])?j[k]=j[k].replace(/=/g,""):(j[k].indexOf("@")>=0&&(j[k]=j[k].replace(/@/g,h)),l=g.evaluateFormula(n,j[k]),l instanceof f.CalcError?j[k]='"'+l+'"':j[k]=j[k].replace(/=/g,""));i="=CONCAT("+j.join(",")+")"}m=n.parent,m.dJb(c)||m.E4J(m.UHb,c,i,a,b,!0,"",n.ODJ)},F.B4J=function(a,b,c,d){var e=this;return M(e,a)?N(e,b,c,d):g.evaluateExpression(e,b,c,d)};function ka(a,b){if(!b)return!0;var c=a.getRow(),e=a.getColumn(),f=a.getExpression(),g=f.getRange(c,e);return!!g&&(g instanceof d.Range||(g=new d.Range(g.row,g.col,g.rowCount,g.colCount)),!g.containsRange(b))}function la(a,b,c,d,e,f){var g,h,i,j,k,m,n,o,p,r=!d&&a.ITa.dUa(),s=!!f;if(!a.parent||!a.parent.sheets)return g=a.getCustomNames(),void(g&&l(g,function(g,j){ka(j,f)&&(h=j.getExpression(),i=ma(a,a,b,c,d,e,h,s),i!==h&&j.fg(i,r))}));for(j=a.parent.sheets,k=a.parent.getCustomNames(),m=a.parent.XLb(),n=!q(a.parent.AO)&&a.parent.fKJ(),k&&l(k,function(g,j){ka(j,f)&&(h=j.getExpression(),i=ma(null,a,b,c,d,e,h,s),i!==h&&j.fg(i,r))}),m&&l(m,function(g,j){ka(j,f)&&(h=j.getExpression(),i=ma(null,a,b,c,d,e,h,s),i!==h&&j.fg(i,r))}),n&&l(n,function(g,j){ka(j,f)&&(h=j.getExpression(),i=ma(null,a,b,c,d,e,h,s),i!==h&&j.fg(i,r))}),o=function(k){g=j[k].getCustomNames(),g&&l(g,function(g,l){ka(l,f)&&(h=l.getExpression(),i=ma(j[k],a,b,c,d,e,h,s),i!==h&&l.fg(i,r))})},p=0;p<j.length;p++)o(p)}b.wDc=la;function ma(a,b,c,d,e,g,h,i){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O;if(h){if(k=b.yj(),l=f.Hh(f.Errors.Reference,k),9===h.type){if(n=h.value,o=h.value2,p=ma(a,b,c,d,e,g,n,i),q=o&&ma(a,b,c,d,e,g,o,i),n!==p||o!==q)return f.Kh(h.operatorType,p,q)}else if(7===h.type){for(r=!1,s=[],t=void 0,u=0;u<h.arguments.length;u++)t=h.arguments[u],v=ma(a,b,c,d,e,g,t,i),r=r||t!==v,s.push(v);if(r)return f.Jh(h,s)}else if(1===h.type&&h.sf()){if(m=h.source||a&&a.yj(),w=h.row,x=h.column,y=w,z=x,m&&m===k&&(g&&!h.rowRelative||!g&&!h.columnRelative)){if(g&&e)w+=w>=c?d:0;else if(!g&&e)x+=x>=c?d:0;else if(g){if(w>=c+d)w-=d;else if(w>=c)return l}else if(x>=c+d)x-=d;else if(x>=c)return l;if(w!==y||x!==z)return f.rf(k,j,w,x,h.rowRelative,h.columnRelative)}}else if(1===h.type){if(m=h.source||a&&a.yj(),A=h.row,B=h.column,C=h.endRow,D=h.endColumn,E=h.rowRelative,F=h.columnRelative,G=h.endRowRelative,H=h.endColumnRelative,I=A,J=B,K=C,L=D,m&&m===k){if(g&&e)A+=!E&&A>=c?d:0,C+=!G&&C>=c?d:0;else if(!g&&e)B+=!F&&B>=c?d:0,D+=!H&&D>=c?d:0;else if(g&&!e){if(!E&&A>=c&&!G&&C<c+d)return l;if(E&&G||C<c)return h;if(!E)if(A>=c+d)A-=d;else if(A<c);else{if(G)return l;A>c&&(A=c)}if(!G)if(C>=c+d)C-=d;else{if(E)return l;C<c+d&&(C=c-1)}}else{if(!F&&B>=c&&!H&&D<c+d)return l;if(F&&H||D<c)return h;if(!F)if(B>=c+d)B-=d;else if(B<c);else{if(H)return l;B>c&&(B=c)}if(!H)if(D>=c+d)D-=d;else{if(F)return l;D<c+d&&(D=c-1)}}if(B!==J||D!==L||A!==I||C!==K)return f.uf(k,j,A,B,C,D,E,F,G,H)}}else if(10===h.type){if(M=h.value,N=ma(a,b,c,d,e,g,M,i),M!==N)return f.Lh(N)}else 13===h.type&&(m=h.source||a&&a.yj(),m&&m===k&&!g&&(O=h,h=O.offsetWhenInsertRemoveColumn(c,d,e,i)));return h}}function na(a,b){var c,d,e,f,g,h,i,j=b.ah,k=j.getSource(),l=-1,m=-1;b.name?(d=b.name,f=b.id,q(f)?c=j.getNodeByName(d):(c={Lf:b.expression},e=!0)):(l=b.row,m=b.column,l=void 0===l?-1:l,m=void 0===m?-1:m,c=j.getNode(l,m)),g=c.Lf,h=c.Pf,i=a.unparse(k,g,l<0?0:l,m<0?0:m),h&&(a.allowDynamicArray!==!0||a.allowDynamicArray===!0&&!h.isDynamicArray)?l===h.row&&m===h.col&&j.setArrayFormula(h.row,h.col,h.rowCount,h.colCount,i):d?e?j.setFormula(f,d,i):j.setFormulaByName(d,i):j.setFormula(l,m,i,null,!0,!0),c.Lf.CCc=g.CCc}function oa(a){var b,c,e,g,h,i,j,k,l,m,n=S(a),o=a.Bj(d.SheetArea.colHeader),p=a.Bj(d.SheetArea.rowHeader),q=a.Bj(d.SheetArea.viewport),r=[o,p,q];for(b=0;b<r.length;b++){if(c=r[b],!c)return;for(e=c.getAllNodes(),g=0;g<e.length;g++)if(h=e[g],i=h.calc)for(j=i.Ze,k=void 0,l=0;l<j.length;l++)m=i[j[l]],m&&m.forEach(function(a){a&&a instanceof f.PathCalc&&na(n,a)})}}function pa(a,b,c,d,e,f,g,i,j,k){h.CalcOperatorAdjustor.copyFormula(a.Bj(),b,c,d.Bj(),e,f,g,i,j,k)}b.vyb=pa;function qa(a,b){var c=a.offset(0,0,!1,0,0);return c.rowRelative=c.endRowRelative=c.columnRelative=c.endColumnRelative=b,c}function ra(a,b,c,d,e,g,i,j,k,l){var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;if(l){if(9===l.type){if(m=l.value,n=l.value2,o=ra(a,b,c,d,e,g,i,j,k,m),p=n&&ra(a,b,c,d,e,g,i,j,k,n),m!==o||n!==p)return f.Kh(l.operatorType,o,p)}else if(7===l.type){for(q=!1,r=[],s=void 0,t=0;t<l.arguments.length;t++)s=l.arguments[t],u=ra(a,b,c,d,e,g,i,j,k,s),q=q||s!==u,r.push(u);if(q)return f.Jh(l,r)}else if(1===l.type){if(v=!Q(l)&&!O(l),w=!R(l)&&!P(l),x=b.yj(),(!l.source||l.source===x)&&v&&w)return y=e.yj(),z=new h.MoveSwapInfo(x,c,d,y,g,i,j,k),A=qa(l,!0),B={isCustomName:!0},C=h.adjustFormulaOnMoveSwap(x,0,0,A,z,!0,B),C===A?l:1===C.type&&qa(C,!1)||C}else if(10===l.type&&(D=l.value,E=ra(a,b,c,d,e,g,i,j,k,D),D!==E))return f.Lh(E);return l}}b.uyb=ra;function sa(a,b){var c,d,e,f,h,i,j,k=a.printInfo&&a.printInfo();if(k)for(c=b.split(","),d=0;d<c.length;d++)for(e=g.formulaToRanges(a,c[d],0,0),f=0;f<e.length;f++)for(h=e[f].ranges,i=0;i<h.length;i++)j=h[i],j.col===-1||j.colCount===-1?(k.repeatRowStart(j.row),k.repeatRowEnd(j.row+j.rowCount-1)):j.row!==-1&&j.rowCount!==-1||(k.repeatColumnStart(j.col),k.repeatColumnEnd(j.col+j.colCount-1))}function ta(a,b,c,d,e){var f=a[b];f&&(d=f.xf,q(e)||(d.WOJ=e),f.toJSON({data:c}),delete d.WOJ)}function ua(a,b,c,d,e,f){a&&(b&&!b.fullRecalc?a.resumeWithoutCalc():a.resume(!1),delete a.Q$J),c.MIb(),delete c.q$a,f.resumePaint()}d.Worksheet.$n("calc",{priority:1e3,init:V,dispose:function(a){var b,c,d,e=this;a.clearCache!==!1&&(e.ft=j,e.uDc=j,e.sDc=j,e.Wu=j,b=e.et,b&&(a.isSheetDestroy===!0?b.eHb():b.rzb(),e.et=j),c=e.tDc,c&&(a.isSheetDestroy===!0?c.eHb():c.rzb(),e.tDc=j),d=e.rDc,d&&(a.isSheetDestroy===!0?d.eHb():d.rzb(),e.rDc=j))},attach:function(a){var b=this;a instanceof d.Workbook?b.ev(a.Wu):b.ev()},onLayoutChanged:function(a){this.Cf().isAdjustSuspended()||this.mUa(a)},toJson:function(a,b){var c,e,f,g,h,i,j,k,m=this,n=m.Su;d.GC$.isEmptyObject(n)||(a.customFunctions=n),c=b&&b.newWorkSheetName,e=[],f=m.getCustomNames(),g=S(m),h=m.Bj(),i=h.xf,f&&g&&(!q(c)&&h&&i&&(i.WOJ=c),l(f,function(a,b){var c,d,f=b.getName(),h=b.getRow(),i=b.getColumn(),j=b.getExpression(),k=b.getComment();j&&(c=g.unparse(m.yj(),j,h,i,!1,!0,!0),d={name:f,formula:c,row:h,col:i},k&&(d.comment=k),e.push(d))}),e.length>0&&(a.names=e),delete i.WOJ),j=b&&b.ignoreFormula,j||(k=[m.et,m.rDc,m.tDc],[a.data,a.colHeaderData,a.rowHeaderData].forEach(function(a,b){ta(k,b,a,i,c)}),m.Q5J&&m.Q5J.nextIndex>0&&(a.sharedFormulas=m.Q5J))},fromJson:function(a,b,c,d){var e=this,f=c&&c.incrementalLoading;f||(e.clearCustomFunctions(),e.clearCustomNames()),d&&(e.nameFunctionsFromJSON(a,b,c),e.formulaFromJSON(a,b,c))},bdK:function(a,b,c){var e,f,h,j,k,m,n,o,p,r,t,u,v,w=this,x=w.Su;d.GC$.isEmptyObject(x)||(a.lossless.customFunctions=x),e=c&&c.newWorkSheetName,f=[],h=[],j=w.getCustomNames(),k=S(w),m=w.Bj(),n=m.xf,o={},w.parent&&(p=w.parent.yv,o=p&&p.getUsedCustomNames()||{}),j&&k&&!w.ODJ&&(!q(e)&&m&&n&&(n.WOJ=e),r=!c||c.includeUnusedNames!==!1,l(j,function(a,b){var d,e,j,l=b.getName(),m=b.getRow(),n=b.getColumn(),p=b.getExpression(),q=b.getComment();l.toUpperCase()!==s&&p&&(r||o[l])&&(d=z(g.encodeNameFormula(k.unparse(w.yj(),p,m,n,!1,!0,!0))),e={name:l,comment:q,formula:d},c&&c.includeCalcModelCache&&(j=i.exprToJSON(p),f.push(j),e.e=f.length-1),h.push(e))}),h.length>0&&(a.lossless.definedNames=h),f.length>0&&(a.lossless.nExpr=f),delete n.WOJ),t=c&&c.includeFormulas===!1,t||(u=w.et,u&&(n=u.xf,q(e)||(n.WOJ=e),u.bdK(a,c),delete n.WOJ),v=[w.rDc,w.tDc],a.lossless&&[a.lossless.colHeaderData,a.lossless.rowHeaderData].forEach(function(a,b){ta(v,b,a,n,e)})),!t&&d.Util.KlK(c)&&(c&&c.includeCalcModelCache&&(a.lossless.tree=i.JiK(w.Bj())),n=w.yj(),a.lossless.referenceSheetNames=n&&n.getReferenceSheetNames(),W(w,a.lossless))},cdK:function(a,b,c,e){var f,g,h=this,i=h.parent,j=d.Util.lkK(c,h.parent&&h.parent.NjK),k=c&&!c.fullRecalc,l=h.yj();h.suspendPaint(),i&&i.Wu&&(f=i.Wu,f.suspend(),f.Q$J=k),g=d.Util.mkK(c),g||(h.clearCustomFunctions(),h.clearCustomNames()),j&&(l.q$a=!0,h.nameFunctionFromSJSFormat(a,b,c),h.formulaFromSJSFormat(a,b,c,e),e?ga(i,h,a,l,b,c):c.incrementLoadTask.addTask(ga,[i,h,a,l,b,c])),e?ua(f,c,l,j,k,h):c.incrementLoadTask.addTask(function(a,b,c,d,e,f){ua(a,b,c,d,e,f)},[f,c,l,j,k,h])},setName:function(a){var b,c,d;oa(this),b=this.Bj(),c=S(b),d=c.lh.asyncManager,d.changeSourceName(a.oldName,a.newName)},beforeSetName:function(){this.uja&&(this.parent||this).tja()}}),d.lUa.$n("calc",{isInvalidFormula:function(a){var b=j,c=k;try{a.allowDynamicArray&&(q(g.SheetParserContext.CUJ)&&(g.SheetParserContext.CUJ=new d.Worksheet),b=g.SheetParserContext.CUJ,b.getCalcService()&&(c=b.getCalcService().allowDynamicArray,b.getCalcService().allowDynamicArray=!0)),g.formulaToExpression(b,a.value)}catch(b){a.isInvalid=!0}finally{q(b)||q(c)||!b.getCalcService()||b.getCalcService().allowDynamicArray===c||(b.getCalcService().allowDynamicArray=c)}}})},"./node_modules/process/browser.js":function(a,b){var c,d,e,f,g,h,i=a.exports={};function j(){throw Error("setTimeout has not been defined")}function k(){throw Error("clearTimeout has not been defined")}!function(){try{c="function"==typeof setTimeout?setTimeout:j}catch(a){c=j}try{d="function"==typeof clearTimeout?clearTimeout:k}catch(a){d=k}}();function l(a){if(c===setTimeout)return setTimeout(a,0);if((c===j||!c)&&setTimeout)return c=setTimeout,setTimeout(a,0);try{return c(a,0)}catch(b){try{return c.call(null,a,0)}catch(b){return c.call(this,a,0)}}}function m(a){if(d===clearTimeout)return clearTimeout(a);if((d===k||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(a);try{return d(a)}catch(b){try{return d.call(null,a)}catch(b){return d.call(this,a)}}}e=[],f=!1,h=-1;function n(){f&&g&&(f=!1,g.length?e=g.concat(e):h=-1,e.length&&o())}function o(){var a,b;if(!f){for(a=l(n),f=!0,b=e.length;b;){for(g=e,e=[];++h<b;)g&&g[h].run();h=-1,b=e.length}g=null,f=!1,m(a)}}i.nextTick=function(a){var b,c=Array(arguments.length-1);if(arguments.length>1)for(b=1;b<arguments.length;b++)c[b-1]=arguments[b];e.push(new p(a,c)),1!==e.length||f||l(o)};function p(a,b){this.fun=a,this.array=b}p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={};function q(){}i.on=q,i.addListener=q,i.once=q,i.off=q,i.removeListener=q,i.removeAllListeners=q,i.emit=q,i.prependListener=q,i.prependOnceListener=q,i.listeners=function(a){return[]},i.binding=function(a){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw Error("process.chdir is not supported")},i.umask=function(){return 0}},"./node_modules/util/node_modules/inherits/inherits_browser.js":function(a,b){"function"==typeof Object.create?a.exports=function a(b,c){b.super_=c,b.prototype=Object.create(c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}})}:a.exports=function a(b,c){b.super_=c;var d=function(){};d.prototype=c.prototype,b.prototype=new d,b.prototype.constructor=b}},"./node_modules/util/support/isBufferBrowser.js":function(a,b){a.exports=function a(b){return b&&"object"==typeof b&&"function"==typeof b.copy&&"function"==typeof b.fill&&"function"==typeof b.readUInt8}},"./node_modules/util/util.js":function(a,b,c){(function(a){var d,e,f,g,h=Object.getOwnPropertyDescriptors||function a(b){var c,d=Object.keys(b),e={};for(c=0;c<d.length;c++)e[d[c]]=Object.getOwnPropertyDescriptor(b,d[c]);return e},i=/%[sdj%]/g;b.format=function(a){var b,c,d,e,f,g;if(!y(a)){for(b=[],c=0;c<arguments.length;c++)b.push(j(arguments[c]));return b.join(" ")}for(c=1,d=arguments,e=d.length,f=(a+"").replace(i,function(a){if("%%"===a)return"%";if(c>=e)return a;switch(a){case"%s":return d[c++]+"";case"%d":return+d[c++];case"%j":try{return JSON.stringify(d[c++])}catch(a){return"[Circular]"}default:return a}}),g=d[c];c<e;g=d[++c])f+=v(g)||!C(g)?" "+g:" "+j(g);return f},b.deprecate=function(c,d){if(void 0!==a&&a.noDeprecation===!0)return c;if(void 0===a)return function(){return b.deprecate(c,d).apply(this,arguments)};var e=!1;function f(){if(!e){if(a.throwDeprecation)throw Error(d);a.traceDeprecation?console.trace(d):console.error(d),e=!0}return c.apply(this,arguments)}return f},d={},b.debuglog=function(c){if(A(e)&&(e=a.env.NODE_DEBUG||""),c=c.toUpperCase(),!d[c])if(RegExp("\\b"+c+"\\b","i").test(e)){var f=a.pid;d[c]=function(){var a=b.format.apply(b,arguments);console.error("%s %d: %s",c,f,a)}}else d[c]=function(){};return d[c]};function j(a,c){var d={seen:[],stylize:l};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),u(c)?d.showHidden=c:c&&b.Ia(d,c),A(d.showHidden)&&(d.showHidden=!1),A(d.depth)&&(d.depth=2),A(d.colors)&&(d.colors=!1),A(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=k),n(d,a,d.depth)}b.inspect=j,j.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},j.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function k(a,b){var c=j.styles[b];return c?"\x1b["+j.colors[c][0]+"m"+a+"\x1b["+j.colors[c][1]+"m":a}function l(a,b){return a}function m(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function n(a,c,d){var e,f,g,h,i,j,k,l,u,v;if(a.customInspect&&c&&F(c.inspect)&&c.inspect!==b.inspect&&(!c.constructor||c.constructor.prototype!==c))return e=c.inspect(d,a),y(e)||(e=n(a,e,d)),e;if(f=o(a,c))return f;if(g=Object.keys(c),h=m(g),a.showHidden&&(g=Object.getOwnPropertyNames(c)),E(c)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return p(c);if(0===g.length){if(F(c))return i=c.name?": "+c.name:"",a.stylize("[Function"+i+"]","special");if(B(c))return a.stylize(RegExp.prototype.toString.call(c),"regexp");if(D(c))return a.stylize(Date.prototype.toString.call(c),"date");if(E(c))return p(c)}return j="",k=!1,l=["{","}"],t(c)&&(k=!0,l=["[","]"]),F(c)&&(u=c.name?": "+c.name:"",j=" [Function"+u+"]"),B(c)&&(j=" "+RegExp.prototype.toString.call(c)),D(c)&&(j=" "+Date.prototype.toUTCString.call(c)),E(c)&&(j=" "+p(c)),0!==g.length||k&&0!=c.length?d<0?B(c)?a.stylize(RegExp.prototype.toString.call(c),"regexp"):a.stylize("[Object]","special"):(a.seen.push(c),v=k?q(a,c,d,h,g):g.map(function(b){return r(a,c,d,h,b,k)}),a.seen.pop(),s(v,j,l)):l[0]+j+l[1]}function o(a,b){if(A(b))return a.stylize("undefined","undefined");if(y(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return x(b)?a.stylize(""+b,"number"):u(b)?a.stylize(""+b,"boolean"):v(b)?a.stylize("null","null"):void 0}function p(a){return"["+Error.prototype.toString.call(a)+"]"}function q(a,b,c,d,e){var f,g,h=[];for(f=0,g=b.length;f<g;++f)K(b,f+"")?h.push(r(a,b,c,d,f+"",!0)):h.push("");return e.forEach(function(e){e.match(/^\d+$/)||h.push(r(a,b,c,d,e,!0))}),h}function r(a,b,c,d,e,f){var g,h,i;if(i=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},i.get?h=i.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):i.set&&(h=a.stylize("[Setter]","special")),K(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(i.value)<0?(h=v(c)?n(a,i.value,null):n(a,i.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),A(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function s(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function t(a){return Array.isArray(a)}b.isArray=t;function u(a){return"boolean"==typeof a}b.isBoolean=u;function v(a){return null===a}b.isNull=v;function w(a){return null==a}b.isNullOrUndefined=w;function x(a){return"number"==typeof a}b.isNumber=x;function y(a){return"string"==typeof a}b.isString=y;function z(a){return"symbol"==typeof a}b.isSymbol=z;function A(a){return void 0===a}b.isUndefined=A;function B(a){return C(a)&&"[object RegExp]"===H(a)}b.isRegExp=B;function C(a){return"object"==typeof a&&null!==a}b.isObject=C;function D(a){return C(a)&&"[object Date]"===H(a)}b.isDate=D;function E(a){return C(a)&&("[object Error]"===H(a)||a instanceof Error)}b.isError=E;function F(a){return"function"==typeof a}b.isFunction=F;function G(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||void 0===a}b.isPrimitive=G,b.isBuffer=c("./node_modules/util/support/isBufferBrowser.js");function H(a){return Object.prototype.toString.call(a)}function I(a){return a<10?"0"+a.toString(10):a.toString(10)}f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function J(){var a=new Date,b=[I(a.getHours()),I(a.getMinutes()),I(a.getSeconds())].join(":");return[a.getDate(),f[a.getMonth()],b].join(" ")}b.log=function(){console.log("%s - %s",J(),b.format.apply(b,arguments))},b.inherits=c("./node_modules/util/node_modules/inherits/inherits_browser.js"),b.Ia=function(a,b){var c,d;if(!b||!C(b))return a;for(c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a};function K(a,b){return Object.prototype.hasOwnProperty.call(a,b)}g="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0,b.promisify=function a(b){if("function"!=typeof b)throw new TypeError('The "original" argument must be of type Function');if(g&&b[g]){var c=b[g];if("function"!=typeof c)throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(c,g,{value:c,enumerable:!1,writable:!1,configurable:!0}),c}function c(){var a,c,d,e=new Promise(function(b,d){a=b,c=d}),f=[];for(d=0;d<arguments.length;d++)f.push(arguments[d]);f.push(function(b,d){b?c(b):a(d)});try{b.apply(this,f)}catch(a){c(a)}return e}return Object.setPrototypeOf(c,Object.getPrototypeOf(b)),g&&Object.defineProperty(c,g,{value:c,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(c,h(b))},b.promisify.custom=g;function L(a,b){if(!a){var c=Error("Promise was rejected with a falsy value");c.reason=a,a=c}return b(a)}function M(b){if("function"!=typeof b)throw new TypeError('The "original" argument must be of type Function');function c(){var c,d,e,f,g=[];for(c=0;c<arguments.length;c++)g.push(arguments[c]);if(d=g.pop(),"function"!=typeof d)throw new TypeError("The last argument must be of type Function");e=this,f=function(){return d.apply(e,arguments)},b.apply(this,g).then(function(b){a.nextTick(f,null,b)},function(b){a.nextTick(L,b,f)})}return Object.setPrototypeOf(c,Object.getPrototypeOf(b)),Object.defineProperties(c,h(b)),c}b.callbackify=M}).call(this,c("./node_modules/process/browser.js"))},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets}});