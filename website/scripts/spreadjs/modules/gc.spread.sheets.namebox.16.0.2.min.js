/*!
 * 
 * SpreadJS Library 16.0.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.NameBox=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/namebox/namebox.entry.js")}({"./dist/plugins/namebox/namebox-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("SheetsCalc"),g=c("./dist/plugins/namebox/namebox.ns.js"),h=e.Commands.ActionBase,i=d.Common.u,j=d.Common.j.Fa,k=new d.Common.ResourceManager(g.SR,"NameBox"),l=k.getResource.bind(k),m="print_area",n=void 0,o="addCustomName",p="navigateToRange",q=function(a){s(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,d,e,g,h,k,o,p,q,r,s=this,t=!1;if(s.canExecute()){a=s.kj,b=a.getParent(),c=s.VQ,d=c.nameBox,e=c.selectorValue;try{if(g=a.getSelections(),j(g)||0===g.length)return;if(e.toLowerCase()===m&&a.printInfo)return h=g[0],k=a.printInfo(),k.rowStart(h.row),k.rowEnd(h.row+h.rowCount-1),k.columnStart(h.col),k.columnEnd(h.col+h.colCount-1),!0;for(o=a.name(),i.kb(o,"'")&&i.jb(o,"'")||(o="'"+o+"'"),p=[],q=void 0,r=0;r<g.length;r++)p.push(o+"!"+f.rangeToFormula(g[r],a.getActiveRowIndex(),a.getActiveColumnIndex(),n,!!b.options.referenceStyle));q=p.join(","),b.addCustomName(e,q,a.getActiveRowIndex(),a.getActiveColumnIndex(),""),t=!0}catch(b){a.Os(15,l().invalidName),d.updateNameRangeSelectorValue()}}return t},b}(h),e.Commands[o]={canUndo:!1,execute:function(a,b){e.Commands.h4(a,q,b)}},r=function(a){s(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,k,l=this,m=!1;if(l.canExecute()){if(a=l.kj,b=a.getParent(),c=l.VQ,d=c.nameBox,e=c.selectorValue,f=c.selections,g=c.sheetName,b.BCJ(b.getSheetIndex(g),1,!1,!0),h=b.getActiveSheet(),h.clearSelection(),i=f[0],j(i))return;for(h.setSelection(i.row,i.col,i.rowCount,i.colCount),k=1;k<f.length;k++)i=f[k],h.addSelection(i.row,i.col,i.rowCount,i.colCount);d.selector.val(e),d.r5J=d.selector.val(),m=!0}return m},b}(h),e.Commands[p]={canUndo:!1,execute:function(a,b){e.Commands.h4(a,r,b)}},e.Commands.s5J=function(a){a.register(o,e.Commands[o]),a.register(p,e.Commands[p])}},"./dist/plugins/namebox/namebox-list.js":function(a,b,c){"use strict";var d,e,f=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("CellTypes"),e=function(a){f(b,a);function b(b,c){var d=a.call(this,b)||this;return c&&d.setNameList(c),d}return b.prototype.setNameList=function(a){var b=this;b.setOptions({items:b.t5J(a),textEllipsis:!0})},b.prototype.t5J=function(a){return a.map(function(a){return{text:a,value:a}})},b.CustomNameChange="CustomNameChange",b}(d.List),b.NameBoxList=e},"./dist/plugins/namebox/namebox.entry.js":function(a,b,c){"use strict";var d,e;function f(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),c("./dist/plugins/namebox/namebox-actions.js"),d=c("Core"),e=c("./dist/plugins/namebox/namebox.js"),b.NameBox=e.NameBox,f(c("./dist/plugins/namebox/namebox.ns.js")),b.findControl=function(a){return"string"==typeof a&&(a=document.getElementById(a)),d.GC$(a).data("name-box")}},"./dist/plugins/namebox/namebox.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;Object.defineProperty(b,"__esModule",{value:!0}),d=c("CalcEngine"),e=c("Core"),f=c("SheetsCalc"),g=c("CellTypes"),h=c("./dist/plugins/namebox/namebox-list.js"),i=c("Common"),j=c("./dist/plugins/namebox/namebox.ns.js"),k=e.GC$,l=null,m=void 0,n="A1",o=".gc-name-box",p="div",q="input",r="name-box",s="_",t="invalid",u="gc-name-box-",v="container",w="selector",x="dropdown",y=i.Common.j.Fa,z=i.Common.u,A=e.util.Nl,B=e.util.Ql,C=new i.Common.ResourceManager(j.SR,"NameBox"),D=C.getResource.bind(C),E=[d.ExpressionType.reference,d.ExpressionType.name,d.ExpressionType.structReference],F={enableAddCustomName:!0,enableNavigateToRange:!0,showCustomNameList:!0,dropDownMaxHeight:500},G=function(){function a(a,b,c){var d,e;this.addCustomNameCommand="addCustomName",this.navigateToRangeCommand="navigateToRange",this.r5J="",this.v5J=!1,a&&b&&(a instanceof HTMLElement?d=a:"string"==typeof a&&(d=document.getElementById(a)),d&&(e=this,e.v5J=!0,e.qo=d,k(d).data(r,e),e.options=B(F,function(a,b,c){e.Op(a,b,c)}),e.T3(c),e.w5J(),e.v5J=!1,e.bind(b)))}return Object.defineProperty(a.prototype,"selector",{get:function(){return k("."+u+w,this.qo)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dropdown",{get:function(){return k("."+u+x,this.qo)},enumerable:!0,configurable:!0}),a.prototype.getHost=function(){return this.qo},a.prototype.getCustomNameList=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;if(void 0===a&&(a=!1),b=this,c=b.Qu,!c)return[];for(d=c.getActiveSheet(),e=[],f=b.PiK(d,a).concat(b.QiK(a)),g=0,h=f;g<h.length;g++)i=h[g],e.push(i.getName());for(j=b.RiK(),k=0,l=j;k<l.length;k++)m=l[k],e.push(m.name);return e},a.prototype.bind=function(a){var b=this;b.unbind(),a&&(b.Qu=a,b._id=a.N7J()),b.rebuild()},a.prototype.unbind=function(){var a=this;a.x5J(),a.FP=l,a.Lva(),a.Qu=l,a._id=l},a.prototype.refresh=function(){this.updateNameRangeSelectorValue()},a.prototype.rebuild=function(){var a=this;a.v5J||(a.Lva(),a.w5J(),a.AJ(),a.y5J(),a.refresh())},a.prototype.executeCommand=function(a,b,c){var d=this,e=d.Qu,f=e.getActiveSheet();e.commandManager().execute({cmd:a,sheetName:c||f.name(),nameBox:d,selectorValue:d.selector.val(),selections:b||f.getSelections()})},a.prototype.dispose=function(){var a=this;a.unbind(),a.FP&&a.FP.dispose(),a.FP=l,a.z5J&&a.z5J.close(),a.z5J=l,k(a.qo).data(r,l),a.qo.innerHTML="",a.qo=l},a.prototype.Op=function(a,b,c){var d=this;if(b!==c){if(d.options[a]=b,d.v5J)return;switch(a){case"dropDownMaxHeight":case"showCustomNameList":d.rebuild();break;case"enableAddCustomName":case"enableNavigateToRange":case"addCustomNameCommand":case"navigateToRangeCommand":d.refresh()}}},a.prototype.T3=function(a){var b=this.options,c=a||{};c=k.extend(!0,{},F,c),k.each(c,function(a,c){b.hasOwnProperty(a)&&(b[a]=c)})},a.prototype.y5J=function(){var a=this;a.FP&&a.FP.setNameList(a.SiK())},a.prototype.SiK=function(){var a=this.getCustomNameList(!0);return a=a.filter(function(b,c){return a.indexOf(b)===c}).sort(function(a,b){return M(a,b)})},a.prototype.x5J=function(){var a=this;a.z5J&&(a.z5J.close(),a.z5J=l,a.FP=l)},a.prototype.A5J=function(){var a,b,c,d,e=this;e.x5J(),a=A(p),b=new h.NameBoxList(a,e.SiK()),c=new g.PopupControl(b.getContainer(),e.qo,{align:g.DropDownAlignment.Near,hostElement:e.Qu.getHost(),direction:g.DropDownDirection.Down}),d=+e.options.dropDownMaxHeight||F.dropDownMaxHeight,k(b.getContainer()).css(["width","maxHeight"],[k(e.qo).width(),d+"px"]).addClass("gc-name-box-list"),c.open(),e.FP=b,e.z5J=c},a.prototype.w5J=function(){var a,b,c,d=this,e=d.qo;e.innerHTML="",a=A(p),a.classList.add(u+v),b=A(q),b.classList.add(u+w),d.options.showCustomNameList&&(c=A(p),c.classList.add(u+x)),a.appendChild(b),c&&a.appendChild(c),e.appendChild(a)},a.prototype.UCJ=function(a){if(a||(a=this.Qu),a){var b=a.getActiveSheet();return b?b:void 0}},a.prototype.O7J=function(){return o+(this._id||"")},a.prototype.AJ=function(){var a=this,b=a.Qu,c=a.qo,d=a.O7J();b.bind(e.Events.SelectionChanging+d,c,function(){var c,d,e,f=a.UCJ();f&&f.getSelections&&(c=f.getSelections(),d=c[c.length-1],null!==d&&d!==m&&(e=H(b,d),a.selector.val(e||""),a.r5J=e||""))}),b.bind(e.Events.InternalSelectionChanging+d,c,function(c,d){var e,f=d.newSelections;null!==f&&f!==m&&(e=H(b,f),a.selector.val(e||""),a.r5J=e||"")}),b.bind(e.Events.SelectionChanged+d,function(b,c){var d=a.B5J();a.updateNameRangeSelectorValue(d,c.shiftKey)}),b.bind(e.Events.DragDropBlockCompleted+d,function(){a.updateNameRangeSelectorValue()}),b.bind(e.Events.ActiveSheetChanged+d,function(){a.updateNameRangeSelectorValue()}),b.bind(e.Events.FormulaTextboxActiveSheetChanged+d,function(){a.updateNameRangeSelectorValue()}),b.bind(e.Events.FormulaTextboxEnterCell+d,function(){a.updateNameRangeSelectorValue()}),b.bind(e.Events.ShapeSelectionChanged+d,function(){a.updateNameRangeSelectorValue()}),b.bind(e.Events.FloatingObjectSelectionChanged+d,function(){a.updateNameRangeSelectorValue()}),a.selector.bind("blur"+d,a.C5J.bind(a)),a.selector.bind("keydown"+d,a.D5J.bind(a)),a.selector.bind("focus",function(){a.selector[0].select()}),a.dropdown.bind("mousedown"+d,a.E5J.bind(a))},a.prototype.Lva=function(){var a=this,b=a.Qu,c=a.O7J();b&&b.unbind(c),a.selector.unbind(c),a.dropdown.unbind(c),k(document).unbind(c)},a.prototype.updateNameRangeSelectorValue=function(a,b){var c,d,e,f,g,h,i,j,k=this;return!y(a)&&k.selector?(k.selector.val(a||""),void(k.r5J=k.selector.val())):(d=k.I5J(),e=d.length,void(e>0?(c=1===e?d[0].name():"",k.selector&&(k.selector.val(c),k.r5J=k.selector.val())):(f=k.B5J(),y(f)?(g=k.Qu,h=g.getActiveSheet(),h?(i=h.getSelections()[h.getSelections().length-1],null!==i&&i!==m&&(j=void 0,j=b?H(g,i):I(g,h.getActiveRowIndex()+1,h.getActiveColumnIndex()+1,i),k.selector&&(k.selector.val(j||""),k.r5J=k.selector.val()))):k.selector.val(n)):(k.selector.val(f),k.r5J=k.selector.val()))))},a.prototype.B5J=function(){var a,b,c=this,d=c.Qu,e=d.getActiveSheet(),f="";if(e)return a=e.getSelections(),b=e.name(),1===a.length?(f=L(K(a[0])),c.TiK(f)||c.UiK(f,b)):void 0},a.prototype.UiK=function(a,b){var c,d,e,g,h,i,j,k;if(a)for(c=this,e=c.PiK().concat(c.QiK()),g=0,h=e;g<h.length;g++)if(i=h[g],d=i.Lf,j=d&&d.source,j&&j instanceof f.SheetSource&&j.getName()===b&&(k=d.getRange(i.Uu||0,i.Vu||0),k&&a===L(k)))return i.getName()},a.prototype.TiK=function(a){var b,c,d,e;if(a)for(b=this.RiK(),c=0,d=b;c<d.length;c++)if(e=d[c],a===L(e.range))return e.name},a.prototype.PiK=function(a,b){var c,d;return void 0===b&&(b=!1),c=this.Qu,d=[],a||(a=c&&c.getActiveSheet()),d=a.getCustomNames(),d.filter(function(a){return J(a,c,b)})},a.prototype.QiK=function(a){var b,c;return void 0===a&&(a=!1),b=this.Qu,c=[],c=b&&b.getCustomNames(),c.filter(function(c){return J(c,b,a)})},a.prototype.RiK=function(){var a,b,c,d,e,f,g=this.Qu,h=g.sheets,i=[],j=[];for(a=0,b=h;a<b.length;a++)c=b[a],j=j.concat(c.tables&&c.tables.all());for(d=0,e=j;d<e.length;d++)f=e[d],i.push({name:f.name(),range:f.dataRange()});return i},a.prototype.I5J=function(){var a=[],b=this,c=b.J5J();return c.forEach(function(b){b.isSelected()&&a.push(b)}),a},a.prototype.J5J=function(a){var b,c,d,e,f=this.Qu,g=a||f.getActiveSheet();return g?(b=g.shapes&&g.shapes.all()||[],c=g.floatingObjects&&g.floatingObjects.all()||[],d=g.charts&&g.charts.all()||[],e=g.pictures&&g.pictures.all()||[],b.concat(d).concat(e).concat(c)):[]},a.prototype.K5J=function(a){var b,c,d=this,e=d.J5J();for(b=0;b<e.length;b++)if(c=e[b],c.name()===a)return c},a.prototype.C5J=function(){var a,b,c,d,e=this,f=e.selector.val();if(!f||e.I5J().length>0)return e.$7J(),void e.updateNameRangeSelectorValue(f);if(b=e.K5J(f))return e.$7J(),void b.isSelected(!0);if(e.r5J.toLocaleUpperCase()!==f.toLocaleUpperCase()){c=e.Qu,d=c.getActiveSheet();try{a=e.L5J()}catch(a){if(a.message===t)return void d.Os(15,D().invalidName)}a&&a.sheetName?e.options.enableNavigateToRange&&a.ranges.length>0&&(e.$7J(a.sheetName),e.executeCommand(e.navigateToRangeCommand,a.ranges,a.sheetName)):e.options.enableAddCustomName&&e.executeCommand(e.addCustomNameCommand)}},a.prototype.D5J=function(a){var b=this,c=b.selector.val();"Enter"===a.key&&(this.I5J().length>0&&c&&this.I5J()[0].name(c),a.currentTarget.blur(),b.Qu&&b.Qu.focus(!0)),a&&a.stopPropagation&&a.stopPropagation()},a.prototype.E5J=function(){var a=this;a.A5J(),a.FP.on("ValueChangedEvent",function(b){var c,d=b.value;y(d)&&!d||(c=a.selector.val(),a.updateNameRangeSelectorValue(d),a.r5J=c,a.C5J()),a.x5J()})},a.prototype.$7J=function(a){var b,c,d,e=this,f=e.Qu,g=f.getSheetFromName(a)||f.getActiveSheet(),h=e.J5J(g);for(b=0,c=h;b<c.length;b++)d=c[b],d.isSelected()&&d.isSelected(!1)},a.prototype.L5J=function(){var a,b,c,d,e,g,h,i=this,j=i.selector.val(),k=i.Qu,l=k.getActiveSheet();if(j=j.replace(/, /g,","),O(j))throw Error(t);for(b=j.split(","),c={ranges:[],sheetName:""},d=0,e=b;d<e.length;d++)if(g=e[d],a=f.formulaToRanges(l,g,l.getActiveRowIndex(),l.getActiveColumnIndex()),y(a)||0===a.length){if(b.length>1)throw Error(t)}else if(1===a.length){if(h=a[0],c.sheetName&&h.sheetName!==c.sheetName)throw Error(t);if(!k.getSheetFromName(h.sheetName))throw Error(t);c.ranges=c.ranges.concat(h.ranges),c.sheetName=h.sheetName}return c},a}(),b.NameBox=G;function H(a,b){var c,d="",e=b.rowCount,f=b.colCount,g=b.row+1,h=b.col+1;return 1===e&&1===f?d=I(a,g,h):e<0&&f>0?d=f+"C":f<0&&e>0?d=e+"R":e<0&&f<0?(c=a.getActiveSheet(),c&&(d=c.getRowCount()+"R x "+c.getColumnCount()+"C")):d=e+"R x "+f+"C",d}function I(a,b,c,e){var f,g,h,i,j,k,l,n,o,p,q;if(b<1||c<1)return null;if(f="",g=a.getActiveSheet(),h=g&&g.name(),e&&g){if(i=!1,j=g.getSpans())for(k=0;k<j.length;k++)j[k].row===e.row&&j[k].col===e.col&&j[k].rowCount===e.rowCount&&j[k].colCount===e.colCount&&(i=!0);if(l=a.getCustomNames(),l!==m)for(n=0;n<l.length;n++)if(o=l[n].getExpression(),o&&o.type===d.ExpressionType.reference&&o.source&&o.source.getName&&h===o.source.getName()&&(p=o.getRange(0,0),null!==p&&p!==m&&(p.row===e.row&&p.column===e.col&&p.row+p.rowCount===e.row+e.rowCount&&p.column+p.columnCount===e.col+e.colCount||p.row===e.row&&p.column===e.col&&i))){f=l[n].getName();break}if(""===f&&l!==m)for(n=0;n<l.length;n++)o=l[n].getExpression(),o&&o.type===d.ExpressionType.reference&&(p=o.getRange(0,0),(p.row===e.row&&p.column===e.col&&p.row+p.rowCount===e.row+e.rowCount&&p.column+p.columnCount===e.col+e.colCount||p.row===e.row&&p.column===e.col&&i)&&(f=l[n].getName()))}if(""===f)switch(a.options.referenceStyle){case 0:for(;c>0;)q=c%26,0===q?(f="Z"+f,c--):f=String.fromCharCode("A".charCodeAt(0)+q-1)+f,c=parseInt(""+c/26,10);f+=""+b;break;case 1:f="R"+b+"C"+c}return f}e.Workbook.$n("nameBox",{init:function(){e.Commands.s5J(this.commandManager()),this.curNameBoxId=0},onCultureChanged:function(){D()}}),k.extend(e.Workbook.prototype,{N7J:function(){var a=this.curNameBoxId+(""+(new Date).getTime());return this.curNameBoxId+=1,a}});function J(a,b,c){void 0===c&&(c=!1);var e=a.getExpression();return!(!e||c&&!N(e,b))&&(E.indexOf(e.type)>-1||e.type===d.ExpressionType.operator&&16===e.operatorType)}function K(a){var b=a.row,c=a.col,d=a.rowCount,f=a.colCount;return b!==-1&&d!==-1||(b=-1,d=-1),c!==-1&&f!==-1||(c=-1,f=-1),new e.Range(b,c,d,f)}function L(a){if(a)return a.row+s+a.col+s+a.rowCount+s+a.colCount}function M(a,b){var c,d;try{d=i.Common.CultureManager.getCultureInfo(),c=d.localeCompare?d.localeCompare(a,b):a.localeCompare(b,"en")}catch(d){c=a.localeCompare(b)}return c}function N(a,b){var c,d,e,g,h,i;try{if(c=b.getActiveSheet(),d=!!b.options.referenceStyle,e=f.formulaToRanges(c,f.expressionToFormula(b,a,c.getActiveRowIndex(),c.getActiveColumnIndex(),d),m,m,m,d),!e||e.length<1)return!1;for(g=0,h=e;g<h.length;g++)if(i=h[g],!b.getSheetFromName(i.sheetName))return!1}catch(a){return!1}return!0}function O(a){return RegExp(/[^A-Za-z0-9_\.\\!\\?\'\"\,\:\u0080-\uFFFF]+/g).test(a)}},"./dist/plugins/namebox/namebox.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/namebox/namebox.res.en.js");b.SR={en:d}},"./dist/plugins/namebox/namebox.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.invalidName="You must enter a valid reference you want to go to, or type a valid name for the selection."},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},CellTypes:function(a,b){a.exports=GC.Spread.Sheets.CellTypes},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets},SheetsCalc:function(a,b){a.exports=GC.Spread.Sheets.CalcEngine}});