/*!
 * 
 * SpreadJS Library 16.0.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.FormulaTextBox=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/formulaTextbox/formulaTextBox.entry.js")}({"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(a,b,c){"use strict";var d,e;function f(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),f(c("./dist/plugins/formulaTextbox/formulatextbox.js")),f(c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js")),c("./dist/plugins/formulaTextbox/formulatextbox-event.js"),c("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),c("./dist/plugins/formulaTextbox/formulatextbox-render.js"),e=c("./dist/plugins/formulaTextbox/formulatextbox.js"),b.findControl=function(a){return"string"==typeof a&&(a=document.getElementById(a)),d.GC$(a).data(e.CONST_FORMULATEXTBOX)}},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/formulaTextbox/formulatextbox.js"),f=null,g=void 0;function j(a){var b=d.Ul.Nl("textarea"),c=d.GC$(b);return c.css({display:"none"}),d.GC$(a).append(b),b}b.W4=j,h=function(){function a(){var a=this;a.nT=-1,a.Mk=-1,a._text="",a.Q2=-1,a.kj=null,a.MH=!1,a.R2=-1,a.I0=null,a.OC=null,a.f1=null}return a.prototype.$b=function(){var a=this;a.S2(),a.nT=-1,a.Mk=-1,a._text="",a.Q2=-1,a.MH=!1,a.R2=-1,a.kj=null,a.OC=null,a.f1=null},a.prototype.S2=function(){var a,b,c=this;c.kj.Js||(a=c.kj.getCellType(c.nT,c.Mk),b={sheet:c.kj,row:c.nT,col:c.Mk,sheetArea:3},c.I0&&c.I0.firstChild&&a.deactivateEditor(c.I0.firstChild.firstChild,b)),d.GC$(c.I0).remove(),c.I0=null},a.prototype.T2=function(a){var b,c=this,e=a.Cw;e&&(b=a._ZJ,c._text=e.text(),c.nT=b?b.row:a.getActiveRowIndex(),c.Mk=b?b.col:a.getActiveColumnIndex(),c.Wz=b?b.sheetArea:d.SheetArea.viewport,c.Q2=e.caret(),c.MH=e.MH,c.R2=e.C1(),c.V4=e.V4,c.C5=e.C5,c.Nfa=e.Nfa,c.kj=a,c.OC=a.parent,c.f1=a.mm.bG())},a.prototype.VF=function(a){var b=this;a.Cw&&(b._text=a.Cw.text(),b.Q2=a.Cw.caret(),b.MH=a.Cw.MH,b.R2=a.Cw.C1())},a.prototype.U2=function(a){var b=this,c=a.Cw;c&&(c.V4=b.V4,c.C5=b.C5,c.Nfa=b.Nfa,c.text(b._text),c.caret(b.Q2),b.MH&&(c.B1(),c.C1(b.R2)))},a.prototype.S8J=function(a){var b,c=a.oldSheet,d=this,e=c&&c.Cw;if(e)if(e.close(),(!d.kj||d.kj.Js)&&e.M0()||d.C5!==e.C5){d.T2(c),b=c.getValue(d.nT,d.Mk,d.Wz),c.suspendEvent();try{if(!c.endEdit(!0))return}finally{c.resumeEvent()}c.setValue(d.nT,d.Mk,b,d.Wz,!0),c.Px=1,a.needTriggerSheetChange=!1}else d._text&&(d.VF(c),e.destroy(),c.Cw=f,a.needTriggerSheetChange=!1)},a.prototype.T8J=function(a){var b,c,g,h,i,k=a.oldSheet,l=a.newSheet,m=this;if(l&&!l.Js){if(m.I0&&""===m._text&&(k&&k.GJ(),m.$b()),m._text&&m.kj===l)l.Px=0,l.zt(),l.suspendEvent(),m.V4?(b=j(l.parent.qo),e.J0(l,b,f,l.Jl,l.Kl,3),l.Px=2,l.yl.uH()):(c=void 0,g=void 0,m.Wz===d.SheetArea.rowHeader?(c=1,g=-1):m.Wz===d.SheetArea.colHeader&&(c=-1,g=1),l.EF(l.Ws(),m.nT,m.Mk,c,g,!1)),l.resumeEvent(),m.U2(l),m.VK(l,m.nT,m.Mk,m.Wz),k&&k.GJ(),m.$b();else if(m._text&&!m.I0){if(l.Px=1,k&&(k.Px=1),m.X2(l),!m.kj||m.kj.Js)return;l.EJ()}else if(m._text&&m.kj!==l){if(l.Px=1,k&&(k.Px=1,k.GJ()),m.X2(l),!m.kj||m.kj.Js)return;l.EJ()}h=m.kj,h&&(i=l.Cw,i&&(i.d$J=h!==l))}},a.prototype.X2=function(a){var b,c,h,i,j,k,l,m,n,o,p,q,r=this,s=r.kj;s&&!s.Js&&(b=r.nT,c=r.Mk,h=r.Wz,i=s.getCellType(b,c,h),j={sheet:s,row:b,col:c,sheetArea:h,canvasOffset:this.f1},k=i.isImeAware(j),(k||h!==d.SheetArea.viewport)&&(a.Px=1,l=i.a5(j),r.I0&&r.S2(),m=void 0,n=void 0,r.Wz===d.SheetArea.rowHeader?(m=1,n=-1):r.Wz===d.SheetArea.colHeader&&(m=-1,n=1),r.I0=l,d.GC$(l).css("position","absolute"),o=s.getCellRect(b,c,m,n),o.width===g&&(o.width=0),o.height===g&&(o.height=0),d.GC$(l).attr("id","across"),p=s.getActualStyle(b,c,h),i.d5(l,p,o,j),q=r.OC&&r.OC.getHost()||document.body,q.insertBefore(l,f),r.V4&&d.GC$(l).css({display:"none"}),e.J0(a,i.getEditingElement(),!0,a.Jl,a.Kl,3),l.firstChild&&!r.V4&&i.focus(l.firstChild.firstChild),r.U2(a),i.g5(l,p,o,j)))},a.prototype.VK=function(a,b,c,e){var f,g,h,i,j,k,l,m,n;e===d.SheetArea.rowHeader?g=-1:e===d.SheetArea.colHeader&&(f=-1),h=a.getCellType(b,c,e),i=a.BF,j=a.am(),k=a.getActualStyle(b,c,e),l=a.getCellRect(b,c,f,g),m=!1,e===d.SheetArea.rowHeader?m=l.x>=j.x&&l.y>=j.y+j.Cr&&l.x+l.width<=j.pt&&l.y+l.height<=j.ot+j.gs:e===d.SheetArea.colHeader?m=l.x>=j.x+j.Br&&l.y>=j.y&&l.x+l.width<=j.lt+j.js&&l.y+l.height<=j.qt:e===d.SheetArea.viewport&&(m=l.x>=j.kt&&l.y>=j.nt&&l.x+l.width<=j.lt+j.js&&l.y+l.height<=j.ot+j.gs),l&&l.width>0&&l.height>0&&m&&(n={sheet:a,row:b,col:c,sheetArea:e},i&&i.parentNode&&h.g5(i.parentNode.parentNode,k,l,n))},a}(),i=function(){function a(){}return a.U8J=function(b,c){a.H0||(a.H0=new h),a.H0.S8J(c)},a.V8J=function(b,c){a.H0||(a.H0=new h),a.H0.T8J(c)},a}(),b.G0=i},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/formulaTextbox/formulatextbox.js"),g=c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),h=void 0,i=e.Common.j.Fa;function k(a){var b,c=a.Cw,d=a.mm;return b=c.MH?d.E2:d.E2={anchorRow:a.Jl,anchorCol:a.Kl,leadingRow:a.Qr,leadingCol:a.Rr}}function l(a,b,c,e,g){var h,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=a.Cw,F=a.parent,G=F&&F.options;if(E&&E.M0()&&G&&G.allowUserEditFormula&&G.enableFormulaTextbox){switch(h=k(a),j=h.anchorRow,l=h.anchorCol,m=h.leadingRow,n=h.leadingCol,i(e)&&(e=j),i(g)&&(g=l),o=a.mm,b){case 3:t=a.iy(e,g,c,m);break;case 4:t=a.hy(e,g,c,m);break;case 1:t=a.HJ(e,g,c,n);break;case 2:t=a.LJ(e,g,c,n);break;case 5:t=a.OJ();break;case 6:t=a.NJ()}t&&(p=t.row,q=t.col,r=t.leadingCellRow?t.leadingCellRow:p,s=t.leadingCellCol?t.leadingCellCol:q,a.IJ(p,q)&&(h.anchorRow=p,h.anchorCol=q,h.leadingRow=r,h.leadingCol=s,u=a.pivotTables&&a.pivotTables.findPivotTable(r,s),v=E.shift,w=E.ctrl,x=u&&u.getPivotInfoImp(r,s,!1,!0),y=x&&x.area,!E.Nfa&&u&&x&&4===y?(E.GNc=new d.Range(r,s,1,1),z=x.valueFieldName,A=x.rowInfos,B=x.colInfos,(A||B)&&(C=a.mm.HNc(y,z,A,B,u.position()),C&&(E.v1(C,v,!w,!0),E.OG=!1))):(delete E.GNc,D=f.C2(o.kj,d.kf(p,q,1,1)),D&&E.v1(D,!1,!0)),p>=0&&q>=0&&a.Yq(p,q)))}}function m(a,b){if(a){if(2===a.Px)return!1;var c=a.Cw;return c&&c.M0()?(l(a,b,!1),!0):(c&&(a=j.O2(a)),a.yx(b,!1),!0)}return!1}function n(a,b,c,d){if(a){if(2===a.Px)return!1;var e=a.Cw;return e&&e.M0()?(l(a,b,!1,c,d),!0):(e&&(a=j.O2(a)),a.yx(b,!1,c,d),!0)}return!1}function o(a,b,c){var e,g,h,i,j,l,m,n,o=a.Cw,p=a.parent,q=p&&p.options;o&&o.M0()&&q&&q.allowUserEditFormula&&q.enableFormulaTextbox&&(e=a.mm,g=k(a),h=g.anchorRow,i=g.anchorCol,o.MH?(l=o.m1(),j=f.L0(a,l.text)):j=d.kf(h,i,1,1),j&&(m=a.UJ(j,b,c,h,i),n=f.C2(e.kj,m),n&&o.v1(n,!0,!1)))}function p(a,b,c){if(a){if(2===a.Px)return!1;var d=a.Cw;return d&&d.M0()?(o(a,b,c),!0):(d&&(a=j.O2(a)),!!a.endEdit()&&(a.Sx(b,c),!0))}return!1}d.Commands.Ox=m,d.Commands.Qx=n,d.Commands.Rx=p,j=function(){function a(){}return a.fv=function(b){return a.O2(b)},a.Xx=function(b){return a.O2(b)},a.Yx=function(b){return a.O2(b)},a.O2=function(b){var c=b,d=g.G0.H0;return d&&d._text&&d.kj&&(c=d.kj,a.G2(c)),c},a.G2=function(a,b){var c,d;void 0===b&&(b=!0),c=a.parent,d=g.G0.H0,d&&d._text&&c.hw(a,b)},a.Zx=function(b,c,e){var g,h,i=!1,j=b.Cw;return j&&j.M0()?(g=k(b),g.anchorRow=c,g.leadingRow=c,h=f.C2(b,d.kf(g.anchorRow,g.anchorCol,1,1)),h&&j.v1(h,!1,!0),b.mq(e),i=!0):j&&(b=a.O2(b)),{sheet:b,r:i}},a._x=function(b,c,e){var g,h,i=!1,j=b.Cw;return j&&j.M0()?(g=k(b),g.anchorRow=c,g.leadingRow=c,h=f.C2(b,d.kf(g.anchorRow,g.anchorCol,1,1)),h&&j.v1(h,!1,!0),b.mq(e),i=!0):j&&(b=a.O2(b)),{sheet:b,r:i}},a.pzb=function(b,c){var d=!1,e=c?5:6,f=b.Cw,g=b.Jl,h=b.Kl;return f&&f.M0()?(f.MH||(b.mm.E2={anchorRow:g,anchorCol:h,leadingRow:b.Qr,leadingCol:b.Rr}),l(b,e,!1,g,h),d=!0):f&&(b=a.O2(b)),{sheet:b,r:d}},a.ay=function(b){return a.pzb(b,!0)},a.by=function(b){return a.pzb(b,!1)},a.ey=function(b){return a.O2(b)},a.gy=function(b){return a.O2(b)},a.jy=function(b){var c,d,e,i=g.G0.H0;if(i&&i._text&&i.kj&&(b=i.kj,c=i.nT,d=i.Mk,a.G2(b,!1),f.K0(b),i.V4||b.Sr(c,d,h,h,1),b.isEditing()))return e=b.getValue(c,d,3),!!b.gv(!0,void 0,void 0,!0)&&(b.setValue(c,d,e,3,!0),!0)},a}(),d.Commands.i8J=j},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("CalcEngine"),f=c("SheetsCalc"),g=c("./dist/plugins/formulaTextbox/formulatextbox.js"),h=c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),i=c("Common"),j=i.Common.j.Fa,k=d.GC$.extend,l=null,m=void 0,n=Math.max,o=Math.min;function p(a,b,c,e){var f,g,h,i,j=a.Cw,k=a.ITa,l=j.F$J(),m=d.SheetArea.viewport;return l===d.SheetArea.colHeader&&e===d.SheetArea.colHeader?(f=k.getFreeAreaRowCount(d.SheetArea.colHeader),g=b,g<f&&(m=d.SheetArea.colHeader)):l===d.SheetArea.rowHeader&&e===d.SheetArea.rowHeader&&(h=k.getFreeAreaColumnCount(d.SheetArea.rowHeader),i=c,i<h&&(m=d.SheetArea.rowHeader)),m}function q(a,b,c,e,f,g,h,i){var j=a.Jx(b,c,b,c,h,i);return j=d.kf(j.row,j.col,1,1),g&&e>=0&&e>=0&&(j=a.Jx(b,c,e,f,h,i)),j}k(d.iI.prototype,{D2:function(a){var b,c,e,f,h,i,j,k,l,n,o,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=this,I=H.kj,J=I.Cw;J&&(H.Kka(),b=I.frozenRowCount(),c=I.frozenColumnCount(),e=J.MH,e&&H.E2||(H.E2={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),f=I.getRowCount(),h=I.getColumnCount(),i=a.hitTestType,j=a.row,k=a.col,l=H.shift,n=H.ctrl,J&&J.qp&&(J.qp===d.SelectionUnit.row?i=2:J.qp===d.SelectionUnit.column&&(i=1)),o=H.E2,r=o.anchorRow,s=o.anchorCol,t=-1,u=-1,w=p(I,j,k,i),0===i?(t=b?I.ar():I.lq,u=c?I.$q():I.qq,v=d.kf(-1,-1,-1,-1),J.v1(g.C2(I,v),l,!n,m,w),H.OG=!0):1===i?(w===d.SheetArea.viewport?(t=b?I.ar():I.lq,u=k,v=I.Jx(0,k,f-1,k,!0),l&&s>=0&&(v=I.Jx(0,k,f-1,s,!0)),v=d.kf(-1,v.col,-1,v.colCount)):w===d.SheetArea.colHeader&&(t=j,u=k,v=q(I,j,k,r,s,l,!0,w)),J.v1(g.C2(I,v,m,w),l,!n,m,w),H.OG=!0):2===i?(t=j,u=c?I.$q():I.qq,v=I.Jx(j,0,j,h-1,!0),l&&r>=0&&(v=I.Jx(j,0,r,h-1,!0)),v=d.kf(v.row,-1,v.rowCount,-1),J.v1(g.C2(I,v),l,!n,m,w),H.OG=!0):3===i&&(t=j,u=k,j!==m&&k!==m&&(x=a.row,y=a.col,z=a.pivotTableInfo,A=z&&z.getPivotInfoImp(x,y,!1,!0),B=A&&A.area,C=a.tableSelectInfo&&a.tableSelectInfo.tableSelection,!J.Nfa&&z&&A&&4===B?(J.GNc=new d.Range(x,y,1,1),D=A.valueFieldName,E=A.rowInfos,F=A.colInfos,(E||F)&&(G=H.HNc(B,D,E,F,z.position()),G&&(J.v1(G,l,!n,!0,w),H.OG=!0,H._BJ=!0))):(delete J.GNc,v=C?C:q(I,j,k,r,s,l,!0,w),J.v1(g.C2(I,v,m,w),l,!n,m,w),H.OG=!0))),H.DG=H.OG,l&&e||(o.anchorRow=t,o.anchorCol=u,o.leadingRow=t,o.leadingCol=u,o.sheetArea=w),H.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},H.qG())},HNc:function(a,b,c,e,f){var h,i,j,k,l,m,n,o,p,q,r,s=this,t=s.kj;if(4===a)return h=void 0,i=void 0,j="",k=f.row,l=f.col,m=d.kf(k,l,1,1),h=g.C2(t,m,!0),n=[],o=[],o=Array.isArray(c)&&Array.isArray(e)?c.concat(e):Array.isArray(c)&&c||Array.isArray(e)&&e,p=/\"/g,q='""',o&&o.forEach(function(a){"number"==typeof a.fieldName?n.push(a.fieldName):n.push('"'+a.fieldName.replace(p,q)+'"'),"number"==typeof a.itemName?n.push(a.itemName):n.push('"'+a.itemName.replace(p,q)+'"')}),j=n.join(","),i=b.replace(p,q),r='GETPIVOTDATA("'+i+'",'+h,""!==j&&(r+=","+j),r+")"},F2:function(a){var b,c,e=!1,f=h.G0.H0;if(f&&f.I0)if(b=f.kj,c=a.Cw,c&&b.setFormula(f.nT,f.Mk,c.text()),b!==a){if(d.Commands.i8J.G2(b),!b.endEdit())return;e=!0}else c&&(c.destroy(),a.Cw=l),f.$b();return e},EG:function(){var a,b,c=this,e=this._oa(),f=c.rG,g=c.E2;f&&c.OG&&(a=f.sG,b=g.sheetArea,e&&e.qp&&(e.qp===d.SelectionUnit.row?a=2:e.qp===d.SelectionUnit.column&&(a=1)),a===d.SheetArea.viewport||b===d.SheetArea.colHeader||b===d.SheetArea.rowHeader?c.H2():2===a?c.I2():1===a&&c.J2())},H2:function(){var a,b,c,d,e=this,f=e.E2,h=f.anchorRow,i=f.anchorCol,j=f.sheetArea,k=e.fH(m,j,!0),l=e.gH(m,j,!0);h>=0&&i>=0&&k>=0&&l>=0&&(a=e.kj,b=a.Jx(k,l,h,i,!0,j),c=g.C2(a,b,m,j),c&&(d=a.Cw,e._BJ?b.equals(d.GNc)||(delete d.GNc,d.v1(c,!0,!0)):d.v1(c,!0,!1))),e.NG()},I2:function(){var a,b,c,e,f=this,h=f.E2.anchorRow,i=f.fH();h>=0&&i>=0&&(a=f.kj,b=a.Jx(i,0,h,a.getColumnCount()-1,!0),b=d.kf(b.row,-1,b.rowCount,-1),c=g.C2(a,b),c&&(e=a.Cw,e.v1(c,!0,!1))),f.NG()},J2:function(){var a,b,c,e,f=this,h=f.E2.anchorCol,i=f.gH();h>=0&&i>=0&&(a=f.kj,b=a.Jx(0,i,a.getRowCount()-1,h,!0),b=d.kf(-1,b.col,-1,b.colCount),c=g.C2(a,b),c&&(e=a.Cw,e.v1(c,!0,!1))),f.NG()},yH:function(){var a=this;a.RG(),a.rG=l,a.OG=!1,a.DG=!1},iG:function(a){var b,c,e,f,h,i,k,l,m,n=this,o=n.kj,p=n._oa(),q=a.formulaRangeHitInfo;q&&q.inBorder&&p&&(p.MH&&p.NH(),p.close(),b=q.paramRange,c=b&&b.text,e=j(b.sheetArea)?d.SheetArea.viewport:b.sheetArea,c&&(f=g.L0(o,c),f&&(n.Kka(),h=o.Tq(f,e),i=a.row,k=a.col,i<h.row&&(i=h.row),i>=h.row+h.rowCount&&(i=h.row+h.rowCount-1),k<h.col&&(k=h.col),k>=h.col+h.colCount&&(k=h.col+h.colCount-1),l=i-h.row,m=k-h.col,n.OG=!0,n.FG=!0,n.K2={paramRange:b,fromRange:f,rowOffset:l,colOffset:m,sheetArea:e},n.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},n.qG())))},GG:function(){var a,b,c,e,f,h,i,j,k,l,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this;E.OG&&E.FG&&(a=E.K2,b=a.sheetArea,c=E.fH(m,b,!0),e=E.gH(m,b,!0),c>=0&&e>=0&&(f=a.fromRange,h=a.rowOffset,i=a.colOffset,j=a.toRow,k=a.toCol,l=c,p=e,l===j&&p===k||(a.toRow=l,a.toCol=p,q=E.kj,r=q.getRowCount(b),s=q.getColumnCount(b),t=f.row,u=f.col,v=f.rowCount,w=f.colCount,x=q.ITa,y=x.getFreeAreaRowCount(b),z=x.getFreeAreaColumnCount(b),r>y&&(r=y),s>z&&(s=z),A=t<0?-1:n(0,o(r-v,c-h)),B=u<0?-1:n(0,o(s-w,e-i)),C=g.C2(q,d.kf(A,B,v,w),m,b),C&&(D=E._oa(),D.D1(a.paramRange.index,C,!0)))),E.NG())},zH:function(){var a,b=this;b.RG(),b.OG=!1,b.FG=!1,b.K2=l,a=b._oa(),a.onRangeMoved&&a.onRangeMoved()},jG:function(a){var b,c,d,e,f,h,i,j,k,l,m,n=this,o=n.kj,p=n._oa(),q=a.formulaRangeHitInfo;if(q&&p&&(p.MH&&p.NH(),b=q.paramRange,c=b&&b.text,b&&c&&(d=g.L0(o,c)))){if(n.Kka(),e=d.row,f=d.row<0?-1:d.row+d.rowCount-1,h=d.col,i=d.col<0?-1:d.col+d.colCount-1,q.inTopLeft)j=f,k=i,l=e,m=h;else if(q.inTopRight)j=f,k=h,l=e,m=i;else if(q.inBottomLeft)j=e,k=i,l=f,m=h;else{if(!q.inBottomRight)return;j=e,k=h,l=f,m=i}n.OG=!0,n.HG=!0,n.L2={paramRange:b,anchorRow:j,anchorCol:k,toRow:l,toCol:m,sheetArea:a.hitTestType},n.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},n.qG()}},n8J:function(a,b){var c=a.Cw;return(!c||!c.wWJ)&&(c&&c.M0()?(this.D2(b),!0):!!this.F2(a))},IG:function(){var a,b,c,e,f,h,i,k,l,p,q,r,s,t,u,v,w,x,y,z,A,B,C=this;C.OG&&C.HG&&(a=C.L2,b=d.SheetArea.viewport,a&&!j(a.sheetArea)&&(b=a.sheetArea),c=C.fH(m,b,!0),e=C.gH(m,b,!0),c>=0&&e>=0&&(f=a.anchorRow,h=a.anchorCol,i=a.toRow,k=a.toCol,l=c,p=e,l===i&&p===k||(a.toRow=l,a.toCol=p,q=C.kj,r=q.getRowCount(b),s=q.getColumnCount(b),t=f<0?r-1:f,u=h<0?s-1:h,v=o(t,l),w=o(u,p),x=n(t,l)-v+1,y=n(u,p)-w+1,z=C._oa(),(0===v&&x===r||z&&z.qp===d.SelectionUnit.column)&&(v=-1,x=-1),(0===w&&y===s||z&&z.qp===d.SelectionUnit.row)&&(w=-1,y=-1),A=a.paramRange,B=g.C2(q,d.kf(v,w,x,y),m,A.sheetArea),B&&z.D1(A.index,B,!0))),C.NG())},AH:function(){var a,b,c=this;c.RG(),c.OG=!1,c.HG=!1,c.L2=l,a=c._oa(),a.V4&&(a.W0=1,b=a.text().lastIndexOf(",",a.caret()),b!==-1&&(a.W0=b+1)),a.onRangeResized&&a.onRangeResized()},vr:function(a,b,c){var e,f,i,k,m,n,o,p,q,r,s,t,u,v,w,x=this.kj,y=this._oa(),z=y&&y.l1();if(!z||0===z.length||!y.UQa)return l;if(e=a.rowViewportIndex,f=a.colViewportIndex,i=a.hitTestType,this.qH(e,f,b,c))return l;for(o=z.length-1;o>=0;o--)if(k=z[o],p=k.sheetArea,k.allowDrag!==!1&&(j(p)||p===i)&&(q=h.G0.H0,!(q&&q._text||(m=g.L0(x,k.text),j(m))))){if(j(p)&&(p=d.SheetArea.viewport),r=x.ITa.findSpan(m.row,m.col,p),r&&r.containsRange(m)&&(m=r),n=x.getRangeRect(e,f,m),s=5,t=n.x-2,u=n.x+n.width+1-s,v=n.y-2,w=n.y+n.height+1-s,t+s<=b&&b<u&&(v+1<=c&&c<=v+3||w+1<=c&&c<=w+3))return{paramRange:k,inBorder:!0};if(v+s<=c&&c<w&&(t+1<=b&&b<=t+3||u+1<=b&&b<=u+3))return{paramRange:k,inBorder:!0};if(u<=b&&b<u+s&&w<=c&&c<w+s)return{paramRange:k,inBottomRight:!0};if(t<=b&&b<t+s&&w<=c&&c<w+s)return{paramRange:k,inBottomLeft:!0};if(u<=b&&b<u+s&&v<=c&&c<v+s)return{paramRange:k,inTopRight:!0};if(t<=b&&b<t+s&&v<=c&&c<v+s)return{paramRange:k,inTopLeft:!0}}return l},_oa:function(){var a=this.kj;return a.Cw||a.Cva},ly:function(){var a,b,c,d,g,h,i,j,k,m,n,o,p,q=this,r=q.kj,s=r.Cw;if(s)if(a=r.Jl,b=r.Kl,c=r.parent,d=c&&1===c.options.referenceStyle,g=new f.SheetParserContext(r,d,e.pf(a,b)),h=new e.Parser,s.MH)for(k=s.u1(),m=0;m<k.length;m++){i=k[m];try{j=h.parse(g,i.text)}catch(a){j=l}j&&1===j.type&&(q.M2(j,a,b,!0,!0),s.D1(i.index,h.unparse(g,j)))}else{if(i=s.m1(),!i)return;try{j=h.parse(g,i.text)}catch(a){j=l}if(!j)return;1!==j.type||j.sf()?1===j.type&&(q.N2(j,a,b),s.D1(i.index,h.unparse(g,j))):(n=i.textOffset+i.text.lastIndexOf(":"),o=s.caret()<=n,o?(q.M2(j,a,b,!0,!1),p=h.unparse(g,j),s.D1(i.index,p),s.caret(i.textOffset+p.lastIndexOf(":"))):(q.M2(j,a,b,!1,!0),s.D1(i.index,h.unparse(g,j))))}},M2:function(a,b,c,d,e){var f,g,h=a.rowRelative,i=a.columnRelative;d&&(h&&i?(a.rowRelative=!1,a.columnRelative=!1,a.row+=b,a.column+=c):h?(a.columnRelative=!0,a.column-=c):i?(a.rowRelative=!0,a.columnRelative=!1,a.row-=b,a.column+=c):(a.columnRelative=!0,a.column-=c)),f=a.endRowRelative,g=a.endColumnRelative,e&&(f&&g?(a.endRowRelative=!1,a.endColumnRelative=!1,a.endRow+=b,a.endColumn+=c):f?(a.endColumnRelative=!0,a.endColumn-=c):g?(a.endRowRelative=!0,a.endColumnRelative=!1,a.endRow-=b,a.endColumn+=c):(a.endColumnRelative=!0,a.endColumn-=c))},N2:function(a,b,c){var d=a.rowRelative,e=a.columnRelative;d&&e?(a.rowRelative=!1,a.columnRelative=!1,a.row+=b,a.column+=c):d?(a.columnRelative=!0,a.column-=c):e?(a.rowRelative=!0,a.columnRelative=!1,a.row-=b,a.column+=c):(a.columnRelative=!0,a.column-=c)},Kka:function(){var a,b=this.kj,c=b.Cw;c&&(a=c.qo,a&&c.Cia(a)&&c.Jka())}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/formulaTextbox/formulatextbox.js"),g=c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),h=d.GC$.extend,i=e.Common.u,h(d.oJ.prototype,{uH:function(){var a,b,c=this,d=c.kj;d.Xq>0||(a=d.am(),b=c.bm(),c.Mx(a.x,a.y,a.width,a.height),c.Pw(b))}}),d.Worksheet.$n("formulatextboxrender",{paintAdornment:function(a){var b,c,d,e=this,f=a.ctx,g=a.clipRect,h=e.yl,i=e.am(),k=e.mm._oa();if(k)for(c=-1;c<=2;c++)for(d=-1;d<=2;d++)c===-1&&d===-1||(b=c===-1?i.gm(d):d===-1?i.fm(c):i.Ft(c,d),b&&0!==b.width&&0!==b.height&&j(h,f,c,d,g,k))}});function j(a,b,c,h,j,k){var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P=a.kj,Q=P.mm,R=P.sr(c,h),S=k&&k.l1(),T=S&&S.length;if(!(T<=0)&&(l=a.VI(c,h,j))){for(b.save(),b.rect(l.x,l.y,l.width,l.height),b.clip(),b.beginPath(),m=[],n=Q.isFormulaRangeHovering,o=Q.o8J,p=Q.FG,q=Q.K2,r=Q.HG,s=Q.L2,z=0;z<T;z++)if(t=S[z],y=t.sheetArea,("number"!=typeof y||y===R)&&(u=t.text,v=t.ranges&&t.ranges.length>0?t.ranges:[f.L0(P,u)])){if(A=g.G0.H0,A&&A.kj&&void 0!==u)if(i.Bb(u,"!")){if(B=i.Ib(u,"!"),P.name()!==B&&"'"+P.name()+"'"!==B)continue}else if(C=i.Ib(u,"["),D=P.tables,E=P.ODJ,F=E&&E.$VJ===d.SheetType.tableSheet&&E.name()===C,!(P.getCustomNames()[C]||D&&D.findByName(C)||F))continue;for(w=a.XI(c,h,v,l),G=0;G<w.length;G++)H=w[G],H&&H.width>0&&H.height>0&&(x=k.o1(z),k.t1(t)||t.isPivotClickCell?(n&&o.paramRange.index===z&&(b.beginPath(),b.lineWidth=2,b.strokeStyle=x,b.rect(H.x+1,H.y+1,H.width-3,H.height-3),b.stroke()),a.fJ(b,H,x)):n&&o.paramRange.index===z||p&&q.paramRange.index===z||r&&s.paramRange.index===z?(b.beginPath(),b.lineWidth=2,b.strokeStyle=x,b.rect(H.x+1,H.y+1,H.width-3,H.height-3),b.stroke()):(b.beginPath(),b.lineWidth=2,b.strokeStyle=x,b.rect(H.x,H.y,H.width-1,H.height-1),b.stroke()),k.n1(t)&&(I=e.Common.pc.ec(x),I.a=.1,b.beginPath(),b.fillStyle=e.Common.pc.bc(I),b.fillRect(H.x+1,H.y+1,H.width-3,H.height-3)),m.push({rect:H,color:x,allowDrag:t.allowDrag}))}if(m.length>0&&k.UQa)for(J=m.length,z=0;z<J;z++)H=m[z].rect,x=m[z].color,K=5,L=H.x-2,M=H.x+H.width+1-K,N=H.y-2,O=H.y+H.height+1-K,m[z].allowDrag!==!1&&(A=g.G0.H0,A&&A._text||(b.beginPath(),b.fillStyle=x,b.fillRect(L,N,K,K),b.fillRect(M,N,K,K),b.fillRect(L,O,K,K),b.fillRect(M,O,K,K)));b.beginPath(),b.restore()}}},"./dist/plugins/formulaTextbox/formulatextbox.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U;Object.defineProperty(b,"__esModule",{value:!0}),d=c("CalcEngine"),e=c("SheetsCalc"),f=c("Common"),g=c("Core"),h=c("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),i=null,j=void 0,k=Math.max,l=Math.min,m=g.GC$.extend,n=g.Ul.Nl,o=window,p=document,q=f.Common.u,r=g.Ul.nl,s=f.Common.j.Fa,t=g.Ul.Ml,u=t.msie&&parseInt(t.version,10)<10,v=q.Nb,b.CONST_FORMULATEXTBOX="formulatextbox",w="gcUIElement",x="input",y="\xa0",z=".gcFormulaTextBoxInternal",A=".gcFormulaTextBox",B=".gcFormulaTextBoxAcrossSheetInternal",C=".gcsj-func-ac-row",D="TextChanged",E="CaretChanged",F="AppendStarted",G="AppendEnded",H={left:37,right:39,up:38,down:40,tab:9,enter:13,pup:33,pdn:34,end:35,home:36,esc:27},I=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],J='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',K='url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+U1BKUyBBbm90aGVyLVNlbGVjdGluZzwvdGl0bGU+CiAgICA8ZyBpZD0iU1BKUy1Bbm90aGVyLVNlbGVjdGluZyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlN3aXRjaC1yb3cvY29sdW1uIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMS4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IlJlY3RhbmdsZS04IiBmaWxsPSIjRDVENUQ1IiB4PSIwIiB5PSIwIiB3aWR0aD0iMTYiIGhlaWdodD0iMTMiPjwvcmVjdD4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMyIgeT0iNSIgd2lkdGg9IjEwIiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPHBhdGggZD0iTTMsNSBMMTMsNSBMMTMsOSBMMyw5IEwzLDUgWiBNNCw2IEw0LDggTDEyLDggTDEyLDYgTDQsNiBaIiBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTAsMCBMMTYsMCBMMTYsMTMgTDAsMTMgTDAsMCBaIE0xLDEgTDEsMTIgTDE1LDEyIEwxNSwxIEwxLDEgWiIgaWQ9IuefqeW9oiIgZmlsbD0iIzY2NjY2NiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOCI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjODFCRUZDIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTQiIGhlaWdodD0iMiI+PC9yZWN0PgogICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2LDAgTDE2LDQgTDAsNCBMMCwwIEwxNiwwIFogTTE1LDEgTDEsMSBMMSwzIEwxNSwzIEwxNSwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMzNjdGQzkiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIGlkPSLnvJbnu4QtOSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi41ODc3NjcsIDYuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJTaGFwZSIgZmlsbD0iI0ZBNzU0MSIgcG9pbnRzPSI1LjQxMjIzMjg1IDcgMi40MTIyMzI4NSAzLjk5NTM1Mjk1IDQuNDEyMjMyODUgMy45OTUzNTI5NSA0LjQxMjIzMjg1IDEgNi40MTIyMzI4NSAxIDYuNDEyMjMyODUgMy45OTUzNTI5NSA4LjQxNDAzOTk4IDMuOTk1MzUyOTUiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMC44MjY2NDAyLDIuOTk1MzUyOTUgTDUuNDEyMDE5ODEsOC40MTUwOTU5NCBMMC4wMDA2NTkxMTExNjIsMi45OTUzNTI5NSBMMy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwzLjQxMjIzMjg1LDAgTDcuNDEyMjMyODUsMCBMNy40MTIyMzI4NSwyLjk5NTM1Mjk1IEwxMC44MjY2NDAyLDIuOTk1MzUyOTUgWiBNNS40MTIyMzI4NSw3IEw4LjQxNDAzOTk4LDMuOTk1MzUyOTUgTDYuNDEyMjMyODUsMy45OTUzNTI5NSBMNi40MTIyMzI4NSwxIEw0LjQxMjIzMjg1LDEgTDQuNDEyMjMyODUsMy45OTUzNTI5NSBMMi40MTIyMzI4NSwzLjk5NTM1Mjk1IEw1LjQxMjIzMjg1LDcgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==")',L="background",M="background-repeat",N="text-before",O="caret-before",P="\u200b",Q="=";function V(a,b){var c,d=0;for(c=0;c<a.length;c++)a[c]===b&&d++;return d}function W(){var a=[];return g.GC$.each(d.sR()._h,function(b,c){d.Functions.bi[b]&&(c.name=b,a.push(c))}),a}function X(a){var b=[],c;return g.GC$.each(a,function(a,d){c=d.description(),c&&(c.name=a,b.push(c))}),b}function Y(a,b){if(!a)return!1;var c=!1,d=!1;if(1===b.rowCount){if(a.hasHeadersRow()&&b.row===a.startRow())return!0;if(a.hasTotalsRow()&&b.row===a.endRow())return!0}else a.hasHeadersRow()&&b.row===a.startRow()&&(b.rowCount===a.dataRange().rowCount+1&&(c=!0),a.hasTotalsRow()&&b.rowCount===a.dataRange().rowCount+1+1&&(c=!0)),b.row===a.dataRange().row&&(b.rowCount===a.dataRange().rowCount&&(c=!0),a.hasTotalsRow()&&b.rowCount===a.dataRange().rowCount+1&&(c=!0));return b.col+b.colCount<=a.startColumn()+a.dataRange().colCount&&(d=!0),c&&d}function Z(a){return a.replace(/'/g,"''")}function $(a){var b=a.name();return e.jma(b.split(""),!1)?b:"'"+Z(b)+"'"}function _(a){var b=d.getMapping()&&d.getMapping().builtInFunctionsMapping,c=b&&b[a]&&b[a].alias||a;return q.Ob(c)}function aa(a,b,c){if(c){var d=RegExp(P,"g");return a.replace(d,"")===b.replace(d,"")}return a===b}function ba(a,b,c,d){var f,j,k,l,m,n,o,p,q,r,s,t,u;return void 0===d&&(d=g.SheetArea.viewport),b?(f=a.Cw,j=h.G0.H0,k=j&&j.kj||a,l=k.Jl,m=k.Kl,n=a.parent,o=n&&1===n.options.referenceStyle,p=15,(a.Cw&&a.Cw.Nfa||c)&&(p=0),b.row<0&&b.col<0&&(b=new g.Range(0,(-1),a.getRowCount(),(-1))),q=a.tables,r=q&&q.find(b.row,b.col),(j&&j.Nfa||c)&&(p=0),f&&!f.V4&&Y(r,b)?(j&&j._text&&j.kj!==a&&(l=m=-1),e.rangeToFormulaWithStructReference(a,b,l,m,p,o,r)):(s=a.ODJ,!r&&d===g.SheetArea.viewport&&s&&s.$VJ===g.SheetType.tableSheet?(r=s,ea(a,b.col,b.colCount,r)):(t=e.rangeToFormula(b,l,m,p,o),(j&&j._text||a.Cw&&a.Cw.V4&&a.Cw.ria)&&(u=$(a),t=u+"!"+t),t))):i}b.C2=ba;function ca(a){for(var b,c,d,e=[],f=0,g="";g!==i;)g=a.getColumnName(f),c=void 0,a.kj.ODJ&&(c=a.lOJ(f),c&&(b=f)),f++,g!==i&&e.push({name:g,description:"",isGroupColumn:c});return d={columns:e},s(b)||(d.groupInfo={rightGroupColumnIndex:b}),d}function da(a){return a&&"["===a[0]&&"]"===a[a.length-1]}function ea(a,b,c,d){var e,f,g,h,i=ca(d),j=i.columns,k=i.groupInfo,l=d.name();if(b===-1&&(b=0),c===-1&&(c=j.length),k){if(e=k.rightGroupColumnIndex,1===c&&b<=e)return"";if(c>1&&b<=e){if(b+c<=e+1)return"";c-=e-b+1,b=e+1}}return 1===c?l+"["+j[b].name+"]":c>1?(f=b+c-1,g=j[b].name,da(g)||(g="["+g+"]"),h=j[f].name,da(h)||(h="["+h+"]"),l+"["+g+":"+h+"]"):""}g.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",g.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",o.Yl.km.push(function(a,b){var c,d=h.G0;!b&&a.endEdit&&d&&(c=d.H0,c&&c.I0&&a.Cw&&(a.Cw&&a.Cw.destroy(),a.Cw=i,c.V4||c.$b()))});function fa(a,b,c,e,f,h){var i,j,k,l,m,n=a.parent,o=n&&n.options;(b&&o&&o.allowUserEditFormula&&o.enableFormulaTextbox||c)&&(a.Cw&&a.Cw.destroy(),a.Cw=new U(b,null,n),i=a.Cw.text(),j=a.getFormulaInformation(e,f,h),i[0]!==Q||j&&j.hasFormula||i===Q||o.allowInvalidFormula||(i="'"+i,a.Cw.text(i)),k=a.Cw,l=a.mm,m=a.yl,k.bind("AppendStarted",function(){k.close();var b=a.Px;1!==b&&(a.Px=1,a.Cu(b,1))}),k.bind("AppendEnded",function(){m.uH()}),k.bind(D,function(b,c){if(!a.Js){if(c&&c.type!==x){l.Qw(c);var d=a.getCellType(e,f,h);a.Wq(g.Events.EditChange,{sheet:a,sheetName:a.name(),row:e,col:f,editingText:d.getEditorValue(a.BF)})}m.uH(),a.Wq(g.Events.FormulaTextBoxTextChanged,{sheet:a,sheetName:a.name(),text:k.text(),sheetArea:h})}}),k.bind("CaretChanged",function(){m.uH(),a.Wq(g.Events.FormulaTextBoxCaretChanged,{sheet:a,sheetName:a.name(),caret:k.caret()})}),k.add(W()),k.add(X(d.Functions.ci)),k.add(X(a.Su).concat(X(n.Su))),m.uH())}b.J0=fa;function ga(a){a.Cw&&(a.Cw.destroy(),a.Cw=i,a.yl.uH());var b=a.parent&&a.parent.CF;p.activeElement===(b&&b.qo)&&a.mm.Qq()}b.K0=ga;function ha(a,b){var c,d,f,g;if(!b)return i;c=h.G0.H0,d=c&&c.kj||a,f=d.Jl,g=d.Kl;try{return e.formulaToRange(a,b,f,g)}catch(a){}return i}b.L0=ha,m(g.DC.prototype,{bE:function(a){return!(a&&a.Cw&&a.Cw.M0())},pWJ:function(a){return!a||!a.Cw||!!a.Cw.qWJ}}),g.Worksheet.$n(b.CONST_FORMULATEXTBOX,{startEdit:function(a){fa(this,a.element,j,a.row,a.col,a.sheetArea)},endEdit:function(){ga(this)},preProcessKeyDown:function(a){var b,c=this.Cw;return c&&c.BH(a.e)?void(a.r=!0):(b=this.parent&&this.parent.CF,void(b&&b.BH(a.e,a.c)&&(a.r=!0)))}}),R=g.DC.prototype,S=R.dE,g.DC.$n(b.CONST_FORMULATEXTBOX,{preProcessMouseDbClick:function(a){var b=g.UCJ(this.OC),c=b?b.Cw:void 0,d=c&&c.M0(),e=h.G0.H0;d?a.r=!1:e&&e.I0&&e.$b()}}),R.dE=function(){var a=g.UCJ(this.OC),b=a&&a.Cw,c=h.G0.H0,d=c&&c._text;return S.call(this)&&!d&&!b},T=1;function ia(a,b){var c,d,e,f,h,i,j,k,l,m,o=g.GC$(a);return o.attr("contenteditable","false"),c=n("table"),g.GC$(c).css("border-spacing","0"),g.GC$(c).css("width","100%"),o.append(c),d=n("tbody"),c.appendChild(d),e=document.createElement("tr"),d.appendChild(e),f=document.createElement("td"),g.GC$(f).css("padding-right","0px"),e.appendChild(f),h=document.createElement("td"),g.GC$(h).css("width","23px"),g.GC$(h).css("padding-right","0px"),e.appendChild(h),i=o.width()-g.GC$(h).width(),j=n("div"),k=n("div"),g.GC$(k).width(i),g.GC$(k).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),k.appendChild(j),f.appendChild(k),l=n("div"),h.appendChild(l),g.GC$(j).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),g.GC$(j).width(i),g.GC$(j).attr("contenteditable","true"),g.GC$(j).attr("spellcheck","false"),m=g.GC$(l),m.css({display:"block",float:"right",width:"23px",height:"23px",background:J,"background-repeat":"no-repeat"}),m.bind("click",function(){b.D5?(b.OC.Wq("RangeSelectEnding",b),b.endSelectMode()):b.startSelectMode()}),{contentDiv:j,button:l}}function ja(a){var b,c=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE","MAP","REDUCE","SCAN","MAKEARRAY","BYROW","BYCOL","TEXTSPLIT","HSTACK","VSTACK","TOROW","TOCOL","WRAPROWS","WRAPCOLS","TAKE","DROP","EXPAND","CHOOSEROWS","CHOOSECOLS"];for(b=0;b<c.length;b++)if(a===c[b])return!0}U=function(){function a(a,c,d){var e,f,i,j,k=this,l=a;if(k.V4=!1,k.Nfa=!1,k.qWJ=!0,k.ria=!0,k.Ac=[],k.Bc=[],k.yLb=[],k.d$J=!1,c&&c.rangeSelectMode&&(c.absoluteReference===!0&&(k.Nfa=!0),c.needSheetName===!1&&(k.ria=!1),c.acrossSheet===!1&&(k.qWJ=!1),k.qp=c.selectionUnit,k.V4=!0,k.D5=!1,k.E5=!1,k.cga=a,e=ia(a,k),l=e.contentDiv,k.sia=e.button,k.tia=a,k.C5=T,T++),k.UQa=!0,k.ad(d&&d.getHost()||p.body),l&&k.N0(l),
d&&(k.O0=!0,k.P0(d),k.OC.Gu(g.Events.FormulaTextboxActiveSheetChanging+B,h.G0.U8J),k.OC.Fu(g.Events.FormulaTextboxActiveSheetChanging+B,h.G0.U8J),k.OC.Gu(g.Events.FormulaTextboxActiveSheetChanged+B,h.G0.V8J),k.OC.Fu(g.Events.FormulaTextboxActiveSheetChanged+B,h.G0.V8J)),f=k.text(),k.S0=k.T0(f),i=k.Cia(l)){k.V0(k.S0);try{j=o.getSelection(),j.selectAllChildren(l),j.rangeCount>0&&j.collapseToEnd()}catch(a){}g.GC$(k.qo).data(N,f)}g.GC$(a).data(b.CONST_FORMULATEXTBOX,k)}return a.prototype.j5=function(a){var b,c,d,e,f,g,i=this;i.O1(),i.UF(),i.E5=!0,b=h.W4(i.OC.qo),c=i.a1(),c&&(c.suspendPaint(),fa(c,b,!0,c.Jl,c.Kl,3),d=c.Cw,d.V4=!0,d.C5=i.C5,d.Nfa=i.Nfa,d.ria=i.ria,d.qp=i.qp,d.qWJ=i.qWJ,a&&(i.text(a),i.caret(a.length)),e=i.text(),f=i.caret(),f<=0&&(f=e.length),i.focus(),i.caret(f),i.MH=!0,i.W0=1,g=e.lastIndexOf(",",f),g!==-1&&(i.W0=g+1),e||(i.text("="),e="=",i.caret(1),f=1),"="!==e[0]&&(e="="+e,f++),d.text(e),d.caret(f),d.MH=i.MH,d.W0=i.W0,c.resumePaint())},a.prototype.startSelectMode=function(a){var b,c=a;c&&0!==c.indexOf("=")&&(c="="+c),b=this,b.V4=!0,b.D5=!0,g.GC$(b.sia).css([L,M],[K,"no-repeat"]),b.j5(c)},a.prototype.endSelectMode=function(){this.D5=!1,this.H5(),g.GC$(this.sia).css([L,M],[J,"no-repeat"])},a.prototype.H5=function(){var a=this.a1();a&&(a.gv(!0,j,!0),a.repaint())},a.prototype.vIb=function(a){this.yLb=[a]},a.prototype.zLb=function(){return this.yLb},a.prototype.destroy=function(){var a=this;a.D5&&a.H5(),a.yLb=i,a.MH=!1,a.W0=-1,a.X0(),a.Y0(),a.cXJ(),g.GC$(a.Z0).remove(),g.GC$(a.$0).remove(),g.GC$(a._0).remove()},a.prototype.bind=function(a,b,c){var d=this.qo;d&&a&&(a=a.split(/\s+/).join(A+" "),g.GC$(d).bind(a+A,b,c))},a.prototype.unbind=function(a,b){var c=this.qo;c&&a&&(a=a.split(/\s+/).join(A+" "),g.GC$(c).unbind(a+A,b))},a.prototype.unbindAll=function(){var a=this.qo;a&&g.GC$(a).unbind(A)},a.prototype.caret=function(a){var b,c,d=this,e=d.qo;if(e)return b=p.activeElement===e,c=g.GC$(e),0===arguments.length?b?d.b1(e).end:c.data(O):void(a!==d.caret()&&(b?(d.c1(e,a),c.data(O,d.b1(e).end)):c.data(O,a),d.Wq(E,{})))},a.prototype.b1=function(a){var b,c,d,e=this,f=-1,g=-1;return e.d1(a)?(f=a.selectionStart,g=a.selectionEnd):e.Cia(a)&&(b=o.getSelection(),b.rangeCount>0&&(c=b.getRangeAt(0),d=c.cloneRange(),d.selectNodeContents(a),d.setEnd(c.endContainer,c.endOffset),g=(""+d).length,d=c.cloneRange(),d.selectNodeContents(a),d.setEnd(c.startContainer,c.startOffset),f=(""+d).length,d.detach())),{start:f,end:g}},a.prototype.c1=function(a,b){var c,d,e,f,g=this;g.d1(a)?a.setSelectionRange(b,b):g.Cia(a)&&(e=this.e1(a,b),e&&(c=o.getSelection(),d=p.createRange(),f=e.node,f&&1===f.childNodes.length?d.setStart(f.firstChild,e.offset):f.lastChild&&f.lastChild.length&&d.setStart(f.lastChild,f.lastChild.length),d.collapse(!0),c.removeAllRanges(),c.addRange(d),this.V4&&(a.parentElement.scrollTop=a.parentElement.scrollHeight)))},a.prototype.text=function(a){var b,c,d,e,f,i,j,k,l=this,m=l.qo,n=l.a1();if(!m)return"";if(!n||n.Js)return m.innerHTML="","";if(b=l.d1(m),c=l.Cia(m),0===arguments.length){if(d="",b)d=m.value;else if(c){if(e=m.getElementsByClassName("gcsj-func-gray-formula"),e.length>0)return"";d=u?g.Ul.Woa(m):m.innerText,d=d.replace(/\r\n?/g,"\n"),d.indexOf(y)>=0&&(d=g.Ul.Ika(d,y," "))}return d}null!==a&&void 0!==a||(a=""),a!==l.text()&&(f=l.ALb(a),f?l.S0=l.T0(f):l.S0=l.T0(a),b?m.value=a:c&&(i=l.BLb(l.S0,a),l.V0(i),l.caret(a.length)),j={},k=h.G0.H0,k&&k._text&&(j={sheet:k.kj,editor:k.I0&&k.I0.firstChild.firstChild,canvasOffset:k.f1}),l.Wq(D,j)),l.CLb&&l.DLb()},a.prototype.kOJ=function(){var a=this;g.GC$(a.qo).data(N,a.text())},a.prototype.autoComplete=function(a){return 0===arguments.length?this.g1:void(this.g1=a)},a.prototype.showHelp=function(a){return 0===arguments.length?this.h1:void(this.h1=a)},a.prototype.add=function(a){var b,c;if(a)if(g.GC$.isArray(a))for(b=a.length,c=0;c<b;c++)this.Sb(a[c]);else this.Sb(a)},a.prototype.Sb=function(a){var b,c,d,e,f=a&&v(_(a.name));if(f){for(b=this.i1,c=b.length,d=0;d<c;d++){if(e=v(b[d].name),e===f)return;if(e>f)break}b.splice(d,0,a)}},a.prototype.remove=function(a){var b,c,d;if(a)for(a=v(a),b=this.i1,c=b.length,d=0;d<c;d++)if(v(b[d].name)===a){b.splice(d,1);break}},a.prototype.workbook=function(a){var b=this;return 0===arguments.length?b.OC:void(a===i?b.V4&&b.H5():(b.P0(a),b.j1()))},a.prototype.P0=function(a){var b,c;a&&(b=this,b.OC&&b.Y0(),c=b.qo,c&&(b.OC=a))},a.prototype.l1=function(){var a,b,c,d,e,f=[],g=this.S0,h=g&&g.length,i=0,j=0;if(h>0)for(c=0;c<h;c++)a=g[c],b=a.text,11===a.type&&(d={textOffset:i,text:b,ranges:a.ranges,index:j,allowDrag:a.allowDrag},"number"==typeof a.sheetArea&&(d.sheetArea=a.sheetArea),f.push(d),j++),i+=b.length;return e=this.GNc,e&&f.push({ranges:[e],index:j,allowDrag:!1,isPivotClickCell:!0}),f},a.prototype.m1=function(){var a,b,c,d,e,f=this.qo,g=this.l1();if(f&&g&&g.length>0)for(a=this.caret(),b=g.length,c=void 0,d=void 0,e=0;e<b;e++){if(c=g[e],d=c.textOffset,d<=a&&a<=d+c.text.length)return c;if(d>=a)break}return i},a.prototype.n1=function(a){var b,c,d;return!!a&&(b=this.caret(),c=a.text,d=a.textOffset,d<=b&&b<=d+c.length)},a.prototype.o1=function(a){var b,c,d,e,f,g,h,i=this.l1(),j=i.length;if(a<0||j<=a)return"";for(b=[],d=0,e=0;e<j;e++){for(c=i[e],f=!1,g=0;g<b.length;g++)if(c.text&&b[g].text.replace(/\s+/g,"").toUpperCase()===c.text.replace(/\s+/g,"").toUpperCase()){f=!0;break}if(f){if(a===e){d=g;break}}else if(b.push(c),a===e){d=b.length-1;break}}return h=I,h[d%h.length]},a.prototype.M0=function(){var a,b,c;return!!this.MH||(!!this.V4||(!!g.AVJ(this.text())||(a=this.s1(this.caret()),!!a&&(b=a.type,c=a.text,1===b||8===b||7===b&&"%"!==c||5===b||9===b||15===b))))},a.prototype.t1=function(a){if(!a||!this.MH)return!1;var b=this.W0,c=this.caret(),d=a.textOffset;return b<=d&&d<c},a.prototype.u1=function(){var a,b,c=[],d=this.l1(),e=d.length;if(e>0)for(b=0;b<e;b++)a=d[b],this.t1(a)&&c.push(a);return c},a.prototype.v1=function(a,b,c,d,e){var i,j,k,l,m,n,o,p,q,r,s,t,u;if(void 0===e&&(e=g.SheetArea.viewport),i=this,j=i.qo,a&&j){if(!i.MH){if(!i.M0())return;b=!1,i.MH=!0,i.W0=i.caret(),i.Wq(F,{})}k=i.W0,l=i.text(),m=i.caret(),l||(l="=",k=i.W0=1,m=1),n=m,c&&(b=!1,l=l.substr(0,k)+(m<0?"":l.substr(m)),i.S0=i.T0(l),m=k,n=m),o=i.s1(m),b?(p=l.substr(0,m),p=p.substr(0,p.length-o.text.length),p.length>=k&&(o.text=a,n=p.length+a.length)):(q=i.S0,r=f.Common.k.Cb(q,o),s=i.V4&&q.length>1&&r===q.length-1&&11===o.type,d?(a=m>k||s?l+this.w1()+a:l.slice(0,m)+a+l.slice(m),i.S0=i.T0(a)):m>k||s?(q.splice(r+1,0,{text:this.w1(),type:8}),q.splice(r+2,0,{text:a,type:11,sheetArea:e}),a=","+a):q.splice(r+1,0,{text:a,type:11,sheetArea:e}),n=m+a.length),i.z1(),t={},u=h.G0.H0,u&&u._text&&(t={sheet:u.kj,editor:u.I0&&u.I0.firstChild.firstChild,canvasOffset:u.f1}),i.Wq(D,t),i.caret(n)}},a.prototype.NH=function(){var a=this;a.MH&&(a.MH=!1,a.W0=-1,a.Wq(G,{}))},a.prototype.B1=function(){this.MH=!0,this.W0=this.caret()},a.prototype.C1=function(a){return void 0!==a&&(this.W0=a),this.W0},a.prototype.D1=function(a,b,c){var d,e,f,g,h,i,j,k=this,l=k.qo;if(l&&!(a<0)&&b){for(d="",e=!1,f=k.S0,g=f&&f.length,i=0,j=0;j<g;j++){if(h=f[j],11===h.type&&i++===a){f[j]={text:b,type:11,sheetArea:h.sheetArea},e=!0;break}d+=h.text}e&&(k.z1(),k.Wq(D,{}),c?k.caret(k.text().length):k.caret(d.length+b.length))}},a.prototype.j1=function(){var a,b,c=this;c.OC&&(a=c.qo,c.OC&&a&&(a.setAttribute(w,"gcAttachedFormulaTextBox"),c.V4||(c.OC.CF=c),c.OC.Fu(g.Events.FormulaTextboxEditStarted+z,c,c.E1),c.OC.Fu(g.Events.FormulaTextboxEnterCell+z,c,c.F1),c.OC.Fu(g.Events.FormulaTextboxEditEnded+z,c,c.G1),c.OC.Fu(g.Events.FormulaTextboxActiveSheetChanged+z,c,c.H1),c.OC.Fu(g.Events.FormulaTextboxRangeChanged+z,c,c.I1),c.OC.Fu(g.Events.FormulaTextBoxTextChanged+z,c,c.J1),c.OC.Fu(g.Events.FormulaTextBoxCaretChanged+z,c,c.K1),c.OC.Fu(g.Events.ValueChanged+z,c,c.ELb),b=g.UCJ(c.OC),b&&!c.V4&&c.text(c.L1(b,b.Jl,b.Kl)),c.Fu(D,c,c.M1),c.Fu(E,c,c.N1)))},a.prototype.refresh=function(a){var b,c=this.OC,d=this;c&&(b=g.UCJ(c),b&&!d.V4&&(d.OG=!!a||d.OG,d.text(d.L1(b,b.Jl,b.Kl)),d.OG=!1))},a.prototype.Y0=function(){var a=this,b=a.OC;!a.O0&&b&&(a.V4||(b.CF=null,b.Gu(g.Events.FormulaTextboxEditStarted+z,a.E1),b.Gu(g.Events.FormulaTextboxEnterCell+z,a.F1),b.Gu(g.Events.FormulaTextboxEditEnded+z,a.G1),b.Gu(g.Events.FormulaTextboxActiveSheetChanged+z,a.H1),b.Gu(g.Events.FormulaTextboxRangeChanged+z,a.I1),b.Gu(g.Events.FormulaTextBoxTextChanged+z,a.J1),b.Gu(g.Events.FormulaTextBoxCaretChanged+z,a.K1),b.Gu(g.Events.ValueChanged+z,a.ELb),a.Gu(D,a.M1),a.Gu(E,a.N1)),a.text("")),a.OC=null},a.prototype.O1=function(){var a,b,c=this;c.OG||(c.OG=!0,a=this.OC,b=a&&g.UCJ(a),b&&!b.isEditing()?(c.V4||b.EF(null,b.Jl,b.Kl,null,null,!1,null),c.Q1=!0):c.Q1=!1,c.OG=!1,c.R1||c.S1())},a.prototype.FLb=function(){var a=this,b=a.qo,c=a.GLb;b.insertBefore(c,b.firstChild),c.innerText=a.CLb},a.prototype.HLb=function(a,b){if(a){var c=this.ILb;c!==b&&(this.ILb=b,a.style.display=b?"":"none")}},a.prototype.DLb=function(){var a,b=this,c=b.qo,d=b.Cia(c);d?(a=b.GLb,a||(a=b.GLb=n("span"),a.className="gcsj-func-gray-formula"),b.HLb(a,!0),b.FLb()):c.placeholder=b.CLb},a.prototype.JLb=function(){var a,b,c=this;c.CLb&&(c.CLb="",a=c.qo,b=c.Cia(a),b?c.HLb(c.GLb,!1):a&&(a.placeholder=""))},a.prototype.UF=function(){var a,b,c,d,e,f,h=this,i=h.OC,j=i&&g.UCJ(i);j&&(a=j.Cw,h.Q1&&a&&(b=a.text(),c=h.text(),aa(c,b,!0)||(d=h.caret(),e=j.getFormulaInformation(j.getActiveRowIndex(),j.getActiveColumnIndex(),3),h.text(b),e.isArrayFormula&&(d>=c.length&&(d-=1),d=k(0,d-1)),h.caret(d))),(h.Q1&&a||h.V4)&&(f=j.Px,2!==f&&(j.Px=2,j.Cu(f,2))))},a.prototype.L1=function(a,b,c){var d,e,f,h,i,j="";if(a){if(d=a.parent,e=d&&d.options,f=a.getFormulaInformation(b,c,3),f&&f.hasFormula){if(j="="+f.formulaWithCulture,f.isDynamicArray)return this.CLb=j,"";this.CLb="",f.isArrayFormula&&(j="{"+j+"}")}else h=a.getActualStyle(b,c),i=a.getValue(b,c),j="string"==typeof i&&(h.quotePrefix||i.length>0&&"="===i[0]&&e&&e.allowUserEditFormula&&!e.allowInvalidFormula)?"'"+i:g.Ul.Il(h,i,a,{sheet:a,row:b,col:c,sheetArea:3})||"";this.JLb()}return j},a.prototype.H1=function(a,b){var c,d,e=a.data;e.OG||(c=b.newSheet,e.V4||(e.OG=!0,e.close(),b&&(d=c,d&&e.text(e.L1(d,d.Jl,d.Kl))),e.OG=!1))},a.prototype.E1=function(a,b){var c,d,e,f=a.data;f.OG||(c=f.OC,d=c&&g.UCJ(c),e=d&&d.Cw,e&&f.V4===e.V4&&f.C5===e.C5&&b.sheetArea!==g.SheetArea.colHeader&&b.sheetArea!==g.SheetArea.rowHeader&&(f.JLb(),f.OG=!0,f.text(e.text()),f.OG=!1))},a.prototype.F1=function(a,b){var c=a.data;c.V4||c.OG||(c.OG=!0,b&&c.text(c.L1(b.sheet,b.row,b.col)),c.OG=!1)},a.prototype.I1=function(a,b){var c,d,e,f,h,i=a.data;i.OG||i.V4||(i.OG=!0,b&&(c=b.sheet,d=b.row,e=b.col,f=b.rowCount,h=b.colCount,new g.Range(d,e,f,h).contains(c.Jl,c.Kl)&&i.text(i.L1(c,c.Jl,c.Kl))),i.OG=!1)},a.prototype.G1=function(a,b){var c,d=a.data;return d.V4&&d.D5&&d.E5?void(b.ignore=!0):void(d.OG||b.sheetArea!==g.SheetArea.colHeader&&b.sheetArea!==g.SheetArea.rowHeader&&(d.OG=!0,d.close(),c=h.G0.H0,c&&c.VF(b.sheet),b&&b.sheet.Cw&&!b.sheet.Cw.V4&&!d.V4&&d.text(d.L1(b.sheet,b.row,b.col)),d.OG=!1))},a.prototype.ELb=function(b,c){var d=c.sheet,e=d&&d.parent&&d.parent.CF;e&&e.e2()===c.row&&e.f2()===c.col&&e.a1()===d&&b.data instanceof a&&(c.text=d.getText(c.row,c.col),b.data.J1(b,c))},a.prototype.J1=function(a,b){var c,d=a.data;d.OG||(!b.sheet.Cw||d.V4===b.sheet.Cw.V4&&d.C5===b.sheet.Cw.C5)&&b.sheetArea!==g.SheetArea.colHeader&&b.sheetArea!==g.SheetArea.rowHeader&&(d.OG=!0,b&&(c=d.caret(),d.text(b.text),d.caret(c)),d.OG=!1)},a.prototype.K1=function(a,b){var c=a.data;c.OG||(!b.sheet.Cw||c.V4===b.sheet.Cw.V4&&c.C5===b.sheet.Cw.C5)&&(c.OG=!0,b&&c.caret(b.caret),c.OG=!1)},a.prototype.M1=function(a){var b,c,d,e,f,h,i,j,k=a.data;if(!k.OG&&(b=k.OC,c=b&&g.UCJ(b))){if(c.isEditing()||(k.O1(),k.focus()),k.OG=!0,d=c.Jl,e=c.Kl,f=c.Cw,h=c.getCellType(d,e),f){if(k.V4!==f.V4||k.C5!==f.C5)return;i=f.caret(),f.text(k.text()),f.caret(i)}else j={sheet:c,row:d,col:e,sheetArea:3},h.setEditorValue(c.BF,k.text(),j);k.OG=!1}},a.prototype.N1=function(a){var b,c,d,e=a.data;e.OG||(b=e.OC,c=b&&g.UCJ(b),c&&c.isEditing()&&(d=c.Cw,(!d||e.V4===d.V4&&e.C5===d.C5)&&(e.OG=!0,d&&(d.caret(e.caret()),e.S1()),e.OG=!1)))},a.prototype.ad=function(a){var b,c,d,e=this;e.T1=!1,e.U1=!1,e.MH=!1,e.W0=-1,e.i1=[],e.g1=!0,e.h1=!0,e.V1=!0,b=n("div"),b.className="gcsj-func-ac-popup",b.style.display="none",b.setAttribute(w,"gcFuncACPopup"),a.insertBefore(b,i),e.Z0=b,e.R1=!1,c=n("div"),c.className="gcsj-func-help-popup",c.style.display="none",c.setAttribute(w,"gcFuncHelpPopup"),a.insertBefore(c,i),e.$0=c,e.W1=!1,g.GC$(b).bind("mouseover",function(){e.V1=!1}).bind("mouseout",function(){e.V1=!0}),g.GC$(c).bind("mouseover",function(){e.V1=!1}).bind("mouseout",function(){e.V1=!0}),g.GC$(b).bind("scroll",function(){e.X1&&clearTimeout(e.X1),e.X1=o.setTimeout(function(){e.qo&&e.qo.focus()},100)}),d=n("div"),d.style.display="none",d.setAttribute(w,"gcFuncHelpDiv"),a.insertBefore(d,i),e._0=d,e.OC=null,e.OG=!1,e.Q1=!1,e.O0=!1},a.prototype.N0=function(a){var b,c,d;a&&(b=this,c=b.Cia(a),(b.d1(a)||c)&&(d=g.GC$(a),b.qo&&b.X0(),b.qo=a,t&&(t.msie||t.chrome)?c||u||t.chrome?(b.Fu("focus",function(){d.data(N,b.text())}),b.Fu("click",function(){d.focus()}),"input keydown keyup cut paste".split(" ").forEach(function(a){b.Fu(a,function(){b.Y1()})})):b.Fu(x,function(){b.Z1()}):b.Fu(x,function(){if(c){var a=b.qo.lastChild;t.chrome&&a&&"BR"===a.tagName&&b.qo.removeChild(a)}b.Z1()}),b.Fu("keydown",function(a){var d,e,f,h,i,j=a.ctrlKey,k=a.shiftKey,l=a.altKey,m=a.metaKey,n=j||k||l||m,o=a.keyCode;!n&&b.R1&&(o===H.down?(b._1(1),r(a)):o===H.up?(b._1(-1),r(a)):o===H.tab&&(b.a2(),r(a))),o===H.esc&&b.close(),b.b2(a),d=g.UCJ(b.OC),e=d&&d.mm.LH(a),b.V4&&e&&(f=d.Cw,f&&f.MH&&f.NH()),c&&(e?(8===o?la(a)&&g.uHb.processBackspaceAndLeftArrowKeyEvent(a,!0):46===o&&la(a)&&g.uHb.processDeleteAndRightArrowKeyEvent(a,!0),b.Jka()):13===o&&(j||l)?(la(a)&&ka(),b.Jka(!0)):37===o?la(a)&&g.uHb.processBackspaceAndLeftArrowKeyEvent(a,!1):39===o&&la(a)&&g.uHb.processDeleteAndRightArrowKeyEvent(a,!1),c&&j&&(90===o||89===o)&&r(a)),h=b.text(),g.Ul.sl()&&c&&m&&(i=void 0,90===o&&(k?(i=b.Bc.pop(),i&&(b.text(i),b.Ac.push(h))):(i=b.Ac.pop()||"",b.text(i),b.Bc.push(h)),a.preventDefault(),a.stopPropagation()))}),b.Fu("keyup",function(a){var d,e,f,g;b.b2(a),d=b.text(),c&&(e=void 0,f=a.keyCode,g=a.ctrlKey,g&&90===f?(e=b.Ac.pop()||"",b.text(e),b.Bc.push(d)):g&&89===f&&(e=b.Bc.pop(),e&&(b.text(e),b.Ac.push(d))))}),b.Fu("focus",function(a){var c=t&&t.mozilla;c&&!b.qo.innerText&&(b.qo.innerText=""),b.b2(a),b.V4&&b.D5&&(b.E5=!0,b.j5())}),b.Fu("blur",function(){b.V1&&b.close(),b.V4&&(b.H5(),b.E5=!1)}),b.Fu("mousedown",function(){b.E5=!0,b.ILb&&(b.JLb(),b.KLb=!0),b.O1()}),b.Fu("mouseup",function(){if(b.KLb){b.KLb=!1;var a=b.qo,c=o.getSelection();a!==c.anchorNode&&c.selectAllChildren(a)}b.UF()}),b.Fu("click",function(a){var c,d,e;b.MH&&b.NH(),c=b.OC,d=c&&g.UCJ(c),e=d&&d.Cw,e&&e.MH&&!e.V4&&e.NH(),b.b2(a)}),b.Fu("compositionstart",function(){b.T1=!0}),b.Fu("compositionend",function(){b.T1=!1,(t.edge||t.chrome||t.msie)&&b.Y1()})))},a.prototype.X0=function(){var a,c=this,d=c.qo;d&&(a=g.GC$(d),a.removeData(N),a.removeData(O),a.removeAttr(w),a.data(b.CONST_FORMULATEXTBOX)&&a.data(b.CONST_FORMULATEXTBOX,i),c.nu(),c.unbindAll(),c.V4&&(g.GC$(c.cga).empty(),c.cga=i),c.qo=i)},a.prototype.Y1=function(){var a=this,b=g.GC$(a.qo),c=a.text();b.data(N)!==c&&(a.T1||b.data(N,c),a.Z1())},a.prototype.b2=function(a){if(t&&t.msie){var b=function(a,b){return function(){a.d2(a,b)}};setTimeout(b(this,a),10)}else this.d2(this,a)},a.prototype.d2=function(a,b){var c,d,e,f,h,i=b.keyCode,j=i===H.left||i===H.right||i===H.home||i===H.end||i===H.pdn||i===H.pup||i===H.tab||i===H.enter;if(a.g1||(j=j||i===H.up||i===H.down),c=void 0!==b.button,j||c){if(d=a.qo,e=g.GC$(d),f=a.b1(d),f.start!==f.end)return;h=f.end,e.data(O)!==h&&(e.data(O,h),a.Wq(E,{}),a.S1())}},a.prototype.e2=function(){var a,b,c=this.a1();return c?(a=c.Jl,b=c._ZJ,b&&(a=b.row),a):j},a.prototype.f2=function(){var a,b,c=this.a1();return c?(a=c.Jl,b=c._ZJ,b&&(a=b.col),a):j},a.prototype.F$J=function(){var a,b,c=this.a1();return c?(a=g.SheetArea.viewport,b=c._ZJ,b&&(a=b.sheetArea),a):j},a.prototype.a1=function(){if(this.OC)return g.UCJ(this.OC)},a.prototype.parseInternal=function(a,b,c,f,h){var i,k,l,m;return void 0===h&&(h=g.SheetArea.viewport),i=this,k=[],g.bW(a)&&V(a,'"')%2!==1?(l=new d.Parser,m=e.qzb(l,a,b,c,f,!0,j,j,h),k=i.i2(m,a)):(k.push({text:a,type:17}),k)},a.prototype.T0=function(a){return this.parseInternal(a,this.a1(),this.e2(),this.f2(),this.F$J())},a.prototype.Z1=function(){var a,b,c,d=this,e=d.text();return"\n"!==e&&e.indexOf("\n")>=0?void d.Wq(D,{type:x}):(a=d.qo,b=g.GC$(a),d.U1=!0,d.S0=d.T0(e),d.Cia(a)?d.T1||("\n"===e?(b.empty(),d.Wq(D,{type:x})):(c=d.caret(),d.V0(d.S0),d.Wq(D,{type:x}),d.caret(c))):d.Wq(D,{type:x}),c=d.caret(),b.data(O)!==c&&(b.data(O,c),d.Wq(E,{})),d.c2(),void(d.R1||d.S1()))},a.prototype.j2=function(){return f.Common.CultureManager.q4().NumberFormat},a.prototype.h2=function(){var a=this.j2();return a&&a.arrayGroupSeperator||";"},a.prototype.l2=function(){var a=this.j2();return a&&a.arrayListSeparator||","},a.prototype.w1=function(){var a=this.j2();return a&&a.listSeparator||","},a.prototype.g2=function(){var a=this.j2();return a&&a.numberDecimalSeparator||"."},a.prototype.i2=function(a,b){var c,e,g,h,i,j,k=[],l=[],m=b&&"="!==b[0],n=this.h2(),o=this.l2(),p=!1;for(c=0;c<a.length;c++)if(!(c>0&&c<a.length-1&&";"===a[c-1].text&&","===a[c].text&&"ARRAYROW"===a[c+1].text))if(e=a[c],g=this.m2(e,l),h=e.text,2===g)k.push({text:h,type:g});else if(p&&8===g&&","===h)k.push({text:o,type:9});else if(p&&8===g&&";"===h)k.push({text:n,type:10});else if(8===g)k.push({text:h,type:g});else if(3===g)"ARRAY"===h&&(p=!0),k.push({text:"{",type:3});else if(4===g)"ARRAY"===h||"}"===h?(p=!1,k.push({text:"}",type:4})):k.push({text:h,type:4});else if(6===g)k.push({text:")",type:g});else if(13===g)k.push({text:f.Common.o.nb(h),type:g,ranges:e.ranges,allowDrag:e.canDrag});else{if(1===g&&m)continue;null!==g&&(11===g&&a[c+1]&&"#"===a[c+1].text&&e.ranges&&e.ranges.length>0&&(i=new d.CalcReference(this.a1().ft,e.ranges).getSpillRef(),i&&i.yf&&(c++,e.ranges=i.yf,h+="#")),j={text:h,type:g,ranges:e.ranges,allowDrag:e.canDrag},11===g&&(j.sheetArea=e.sheetArea),k.push(j))}return k},a.prototype.m2=function(a,b){var c,d=a.type,e=a.subType,f=a.text,g=a.value;if(1===d){if(1===e)return"ARRAY"===f||"ARRAYROW"===f?(b.push(3),3):(b.push(5),"@"===g||"("===g.trim()?5:2);if(2===e){if(")"===g.trim())return 6;if(b.length>0){if(c=b[b.length-1],3===c)return b.pop(),4;if(5===c)return b.pop(),6}}if("="===g.trim())return 1}else if(3===d){if(0===e)return 8}else{if(5===d||6===d||4===d)return 7;if(0===d)return 7===e||0===e||12===e?11:5===e?12:4===e?13:3===e?14:6===e?16:14;if(7===d)return 15;if(8===d)return 17}return 17},a.prototype.z1=function(){var a,b=this,c=b.qo,d=b.S0,e="",f=d&&d.length;for(a=0;a<f;a++)e+=d[a].text;b.d1(c)?c.value=e:b.Cia(c)&&b.V0(d)},a.prototype.d1=function(a){var b=a&&a.tagName;return"TEXTAREA"===b||"INPUT"===b},a.prototype.Cia=function(a){return a&&"DIV"===a.tagName&&"true"===a.contentEditable},a.prototype.Dia=function(a){return"gcEditingInput"===g.GC$(a).attr(w)},a.prototype.Fu=function(a,b,c){var d=this.qo;d&&a&&(a=a.split(/\s+/).join(z+" "),g.GC$(d).bind(a+z,b,c))},a.prototype.Gu=function(a,b){var c=this.qo;c&&a&&(a=a.split(/\s+/).join(z+" "),g.GC$(c).unbind(a+z,b))},a.prototype.nu=function(){var a=this.qo;a&&g.GC$(a).unbind(z)},a.prototype.Wq=function(a,b){var c=this.qo;c&&g.GC$(c).trigger(a,b)},a.prototype.s1=function(a){var b,c,d,e,f;if(a<=0)return i;if(b=this.S0,c=b&&b.length,c>0)for(d=0,e=void 0,f=0;f<c;f++)if(e=b[f],d+=e.text.length,d>=a)return e;return i},a.prototype.n2=function(){var a,b,c,d,e,f=this.OC;if(f&&(a=g.UCJ(f),a&&(b=a.getCalcService().allowDynamicArray,c=a.Cw))){for(d=[].concat(c.i1),e=d.length-1;e>=0;e--)!b&&d[e]&&ja(d[e].name)?d.splice(e,1):d[e].isFunc=!0;return d.concat(this.o2(f,a)).concat(this.q2(f.sheets)).concat(this.jDJ(f))}return this.i1},a.prototype.o2=function(a,b){var c,d=[],e=b.getCustomNames();return e&&g.GC$.each(e,function(a,b){d.push({name:b.Cj,description:b.kT})}),c=a.getCustomNames(),c&&g.GC$.each(c,function(a,b){d.push({name:b.Cj,description:b.kT})}),d},a.prototype.q2=function(a){var b=[];return a.forEach(function(a){var c,e,f=a.tables;if(f&&(c=f.all()))for(e=0;e<c.length;e++)b.push({name:c[e].name(),description:d.sR().Fbx_TableName_Description+c[e].name()})}),b},a.prototype.jDJ=function(a){var b,c=[],e=a.ECJ;for(b=0;b<e.length;b++)c.push({name:e[b].name(),description:d.sR().Fbx_TableSheetName_Description+e[b].name()});return c},a.prototype.s2=function(a,b){var c,d,e,f;for(a=v(a),q.Bb(a,"[")&&(a=a.substr(a.lastIndexOf("[")+1),a=q.Gb(a,"@","")),c=[],d=b&&b.length,f=0;f<d;f++)e=b[f],0===v(_(e.name)).indexOf(a)&&c.push(e);return c},a.prototype.t2=function(){var a,b,c,d,e,f=this.caret();if(f<=0)return"";if(a=this.S0,b=a&&a.length,b>0)for(c=0,d=void 0,e=0;e<b;e++){if(d=a[e],c+d.text.length>=f)return d.text.substring(0,f-c);c+=d.text.length}return""},a.prototype.u2=function(){var a,b,c,d,e,f,g,h,j,k=this.caret(),l=this.S0,m=l&&l.length,n=[],o=0;for(b=0;b<m;b++){if(a=l[b],n.push(a),6===a.type)for(c=0;n.length>0;)if(d=n.pop(),6===d.type&&c++,5===d.type&&c--,0===c){n.length>0&&(d=n[n.length-1],d&&2===d.type&&n.pop());break}if(o+=a.text.length,o>=k)break}if(n.length>0)for(e=0;n.length>0;)if(a=n.pop(),8===a.type)e++;else if(2===a.type){for(f=v(a.text),g=this.n2(),h=g&&g.length,j=void 0,b=0;b<h;b++)if(j=g[b],v(_(j.name))===f)return{func:j,activeParamterIndex:e,isFunc:j.isFunc};break}return i},a.prototype.c2=function(){var a,b,c,d,e,f,h,i,j=this,k=j.v2(),l=j.g1&&g.bW(j.text())&&k&&k.length>0&&!j.MH&&!j.T1;if(l&&!j.V4){for(j.w2(),a=j.Z0,k.length>8?(a.style.height="204px",a.style.overflowY="scroll"):(a.style.height="auto",a.style.overflowY=""),b="",c=k.length,d=void 0,e=0;e<c;e++)d=k[e],b+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+d.isFunc+">"+_(d.name)+"</div><div class='gcsj-func-ac-row-description'>"+(d.description||"")+"</div></div>";f=g.GC$(j.Z0),f.html(b).show(),j.R1=!0,h=f.find(C),h.length>0&&(i="gcsj-ac-row-active",g.GC$(h[0]).addClass(i),h.bind("mouseover",function(){h.removeClass(i),g.GC$(this).addClass(i)}),h.bind("click",function(){j.a2()}),j.YWJ&&h.bind("mousedown",function(a){j.a2(),r(a)})),j.SH()}else j.z2()},a.prototype.cXJ=function(){var a=this,b=g.GC$(a.Z0).find(C);b&&(b.unbind("mouseover"),b.unbind("click"),a.YWJ&&b.unbind("mousedown"))},a.prototype.v2=function(){var a,b,c,e,f,g,h,i,j=this,k=j.s1(j.caret()),l=k&&k.text,m=[],n=j.S0.indexOf(k);if(k&&14===k.type)return m;if(a=this._getTable(n),b=j.A2(n,a),b.length>0){if(c=[],!a.kj.ODJ){e=JSON.parse(JSON.stringify(d.sR().B2)),f=d.getMapping()&&d.getMapping().tableFunctionsMapping;for(g in e)h=f&&f[e[g].name],h&&(e[g].name=h),c.push(e[g])}if(m=m.concat(b).concat(c),q.jb(l,"[")||q.jb(l,"[@"))return m}else m=this.n2();return l=j.t2(),i=[],l&&(i=j.s2(l,m)),i},a.prototype._getTable=function(a){var b,c,d,e,f,h,i=this.S0;return a<0||!i||a>=i.length?null:(b=this.OC,c=b&&g.UCJ(b),s(a)&&(a=i.length),c?(d=i[a],e=q.Ib(d.text,"["),f=c.tables,h=f&&f.findByName(e),s(h)&&(h=b.getSheetTab(e)),h):null)},a.prototype.A2=function(a,b){var c=[];return s(b)||(c=ca(b).columns),c},a.prototype.z2=function(){g.GC$(this.Z0).hide(),this.R1=!1},a.prototype._1=function(a){var b,c,d,e,f,h,i=g.GC$(this.Z0).find(C),j=i.length;if(0!==j){if(b="gcsj-ac-row-active",c=0,a)for(d=0;d<j;d++)if(g.GC$(i[d]).hasClass(b)){c=d+a;break}e=g.GC$(this.Z0).scrollTop(),i.removeClass(b),f=0,j>0&&(f=i[0].offsetHeight),c=k(c,0),c=l(c,j-1),h=i[c],g.GC$(h).addClass(b),h.offsetTop+h.offsetHeight>g.GC$(this.Z0).scrollTop()+g.GC$(this.Z0).height()?g.GC$(this.Z0).scrollTop(g.GC$(this.Z0).scrollTop()+f):h.offsetTop<g.GC$(this.Z0).scrollTop()?g.GC$(this.Z0).scrollTop(h.offsetTop):g.GC$(this.Z0).scrollTop(e)}},a.prototype.a2=function(){var a,b,c,d,e,f,h,j,k,l,m,n,o,p,r,s=this,t=g.GC$(s.Z0).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),u=t.text(),v="true"===t.attr("isFunc");if(u){for(a=s.caret(),b=s.S0,c=b&&b.length,d=0,e=0,f=0,h=i;f<c&&(h=b[f],e=h.text.length,!(d+e>=a));)f++,d+=e;j=a-d,k=h.text,l=0,m=0,q.Bb(k,"[")?(l=k.lastIndexOf("[",j-1),l===-1?(l=k.indexOf("["),l===-1?h.text=u:h.text=u+k.substr(l),l=0):(l++,"@"===k.charAt(l)&&(l+=1),m=k.indexOf("]",j),m===-1&&(m=k.length),h.text=k.substring(0,l)+u+k.substr(m))):(h.text=u,n=k.substr(j),n&&(o=s.T0("="+n),o.length>1&&b.splice(f+1,0,o[1]))),v?h.type=2:h.type=11,p=f+1,r=b[p],!v||r&&5===r.type||b.splice(p,0,{text:"(",type:5}),s.z2(),s.qo.focus(),s.z1(),s.caret(d+u.length+l+(v?1:0)),s.S1(),s.S0=s.T0(s.text()),s.Wq(D,{})}},a.prototype.S1=function(){var a,b,c,e,f,h,j,k,m,n,o,p,q,r,s,t,u,v=this;if(v.R1&&v.z2(),a=v.u2(),a===i||a.isFunc!==!0)return void v.w2();if(b=v.w1(),c=v.h1&&g.bW(v.text())&&a&&!v.MH&&!v.T1,c&&!v.V4){for(e=a.func,f=e.parameters,h=f&&f.length,j=l(h-1,a.activeParamterIndex),k=void 0,m="",n=0;n<h;n++)k=f[n],o=k.name,k.repeatable&&(o+=b+"..."),k.optional&&(o="["+o+"]"),p=n===h-1?"":b+" ",o=n===j?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+o+"</span>"+p:"<span class='gcsj-func-help-paramter'>"+o+"</span>"+p,m+=o;q="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+_(e.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+m+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>",r="<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+d.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(e.description||"")+"</div></div>",s="<div class='gcsj-func-help-section-content'>"+r+"</div>",t="<div class='gcsj-func-help-body'>"+s+"</div>",u=q+t,g.GC$(v.$0).html(u).show(),v.W1=!0,v.SH()}else v.w2()},a.prototype.w2=function(){g.GC$(this.$0).hide(),this.W1=!1},a.prototype.close=function(){this.z2(),this.w2()},a.prototype.BH=function(a,b){var c,d,e,f,g,h;return!this.MH&&(c=a.ctrlKey||a.shiftKey||a.altKey||a.metaKey,d=a.keyCode,e=a.ctrlKey,f=a.altKey,g=a.metaKey,h=a.srcElement||a.target,!this.YWJ&&h&&b&&b.isEditing&&"gcAttachedFormulaTextBox"===h.getAttribute("gcUIElement")?67===d&&(e||g)&&!f||88===d&&(e||g)&&!f:this.R1&&!c&&(d===H.down||d===H.up||d===H.tab))},a.prototype.SH=function(){var a,b,c,d,e,f,j,k,l,m,n,o,q,r,s,t,u,v,w=this,x=i;if(w.R1?x=w.Z0:w.W1&&(x=w.$0),x){if(a=g.GC$(w.qo),b=g.GC$(x),c=h.G0.H0,c&&c.kj)return d=c.kj.getCellRect(c.nT,c.Mk),e=c.f1,void b.css("top",d.y+d.height+e.top).css("left",d.x+e.left);f=a.parent(),j=a.outerHeight(),w.Dia(w.qo)&&(f=f.parent(),j=f.outerHeight()),k=f.css("top"),l=parseFloat(k),isNaN(l)||(k=l),m=f.css("left"),"auto"===k&&(k=a.offset().top,m=a.offset().left),n=k+j,o=g.GC$(p.body).outerHeight(),q=g.GC$(p.body).outerWidth(!0),r=b.outerHeight(),s=b[0].offsetWidth,t=parseFloat(m),u=n+r,u>o&&(v=k-r,v>=0&&(n=v)),t+s+2>q&&(t-=t+s+2-q),b.css("top",n).css("left",t)}},a.prototype.focus=function(){g.GC$(this.qo).focus()},a.prototype.V0=function(a){var b,c,d,e,f=this,g="",h="",i=a&&a.length,j=0;for(c=0;c<i;c++)b=a[c],d="",11===b.type&&(d=" style='color: "+f.o1(j)+"'",j++),f._0.innerText=b.text,g+="<span"+d+" class='gcsj-func-color-text'>"+f._0.innerHTML+"</span>",h+=b.text;if(h||f.text())if(e=f.qo,g)e.innerHTML="<span class='gcsj-func-color-content'>"+g+"</span>";else for(;e.firstChild;)e.removeChild(e.firstChild)},a.prototype.e1=function(a,b){var c,d,e,f=g.GC$(a).find(".gcsj-func-color-content .gcsj-func-color-text"),h=f.length;for(b=k(0,b),e=0;e<h;e++)if(c=f[e],d=c.innerText,b-=d.length,b<=0)return{node:c,offset:d.length+b};return d?{node:c,offset:d.length}:i},a.prototype.nIb=function(a,b){var c=o.getSelection(),d=this.qo.children[0],e=document.createRange();e.setStart(d,a),e.setEnd(d,b),c.removeAllRanges(),c.addRange(e)},a.prototype.Jka=function(a){var b=this,c=b.qo,d=b.Cia(c),e=b.text();d&&e&&(e=a?e.substr(0,e.length-2):e,b.Ac.push(e))},a.prototype.BLb=function(a,b){var c,d,e,f,g,h,i,j;if(b)for(c=0,d=0,e=0,f=b.length,g=0;g<a.length;g++){for(h=a[g].text,d;d<f;d++)if(i=b[d].toUpperCase(),j=h[e]?h[e].toUpperCase():void 0,i===j)e+=1;else{if("\n"!==i)break;d+1<f&&b[d+1]===P&&(d+=1)}a[g].text=b.substring(c,d),c=d,e=0}return a},a.prototype.ALb=function(a){var b,c,d,e,f;if("="===a[0]&&a.indexOf("\n")!==-1){for(b=[],c=a.length,d=!1,e=0;e<c;e++)f=a[e],'"'===f&&(d=!d),d?b.push(f):"\n"!==f?b.push(f):e+1<c&&a[e+1]===P&&(e+=1);return b.join("")}},a}(),b.FormulaTextBox=U;function ka(){var a,b,c,d=o.getSelection();d.rangeCount>0&&(a=d.getRangeAt(0),b=p.createElement("span"),b.innerHTML="<br/>"+P,a.insertNode(b),c=p.createRange(),c.setStartAfter(b),c.setEndAfter(b),c.collapse(!1),d.removeAllRanges(),d.addRange(c))}function la(a){return"gcAttachedFormulaTextBox"===a.target.getAttribute("gcuielement")}},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets},SheetsCalc:function(a,b){a.exports=GC.Spread.Sheets.CalcEngine}});