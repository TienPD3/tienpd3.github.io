/*!
 * 
 * SpreadJS Library 12.0.7
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * https://www.grapecity.com/en/licensing/spreadjs/
 * 
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Views=t():(e.GC=e.GC||{},e.GC.Spread=e.GC.Spread||{},e.GC.Spread.Views=t())}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="/assets/",t(0)}([function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){function t(e){if(ut.isNil(e))return!1;if(!e.hasOwnProperty("keyField"))return console.error("keyField is a must property in hierarchy setting"),!1;if(!e.hasOwnProperty("parentField"))return console.error("parentField is a must property in hierarchy setting"),!1;var t=this;return t.gCBI_(e.keyField)?t.gCBI_(e.parentField)?!0:(console.error("There is not a column whose id is "+e.parentField+" in column collection"),!1):(console.error("There is not a column whose id is "+e.keyField+" in column collection"),!1)}function o(e,t){var n=this,r=n.options;n.data=new zt(t,ut.map(e,function(e){return{name:e.id,field:e.dataField,caption:e.caption,dataType:e.dataType}}));var o=n.data;o.getDefaults=function(){return{group:Me(n).gGID_(),getFormatter:function(e){if(!n.ExcelFormatter_)return null;var t=n.cF_[e.toLowerCase()];if(t&&t instanceof n.ExcelFormatter_){var r=t.format;return r.bind(t)}}}},o.suspendRefresh(),r.filtering&&(o.filterDescriptors=r.filtering),r.sorting&&(o.sortDescriptors=ut.isString(r.sorting)?r.sorting.slice():ut.cloneDeep(r.sorting)),r.grouping&&(o.groupDescriptors=ut.cloneDeep(r.grouping)),r.hierarchy&&(o.hierarchyDescriptor=r.hierarchy),o.resumeRefresh()}function i(e,t,n){var r,o,i=t.querySelectorAll("[data-column]");if(i.length>0){var a=function(e,t){return function(n){return n[e].toLowerCase()===t.toLowerCase()}},u=function(t){if(o=t.getAttribute("data-column"),r=ut.find(e,a("id",o)),!r.headerRow||!r.headerRow.renderer||!ut.isFunction(r.headerRow.renderer)){var i=n.querySelector("[data-column="+o+"]");if(i)for(var u=0,c=t.children.length;c>u;u++)i.replaceChild(t.children[u],i.children[u])}};ut.each(i,u)}else t.children[0]&&n.children[0]&&n.replaceChild(t.children[0],n.children[0])}function a(e){var t=e.parentElement,n=t.querySelector(".waterMark");n?t.removeChild(n):n=ct.createElement('<input style="display: none;" class="waterMark" show-watermark="true" />'),t.appendChild(n)}function u(e){var t,n=this,r=[".gc","grid","container"],o=n.container.querySelector(r.join("-")),i=0,a=n.getLayoutInfo();for(var u in a)a.hasOwnProperty(u)&&(i+=1),n.sSP_(u)&&(t=n.gSPRI_(u),i+=t?t.length:0);var s=["","706f736974696f6e3a206162736f6c7574653b72696768743a203270783b626f74746f6d3a203270783b6f7061636974793a20302e383b666f6e742d73697a653a20313470783b70616464696e673a203570783b6261636b67726f756e643a2077686974653b"];if(o.children.length<=i)o.insertBefore(ct.createElement('<div style="'+c(s)+"z-index:"+Math.floor(4999*Math.random()+5e3)+';">'+l(e)+"</div>"),o.children[Math.floor(Math.random()*(i+1))]);else{var f=n.container.querySelector('.gc-grid-container>div:not([id^="'+n.uid+'"])');if(f){var d=f.style.zIndex;f&&!function(){var e=c(s).split(";"),t={"z-index":d},n=void 0;ut.each(e,function(e){n=e.split(":"),n[0]&&n[1]&&(t[n[0]]=n[1])}),ct.setCss(f,t)}()}}}function c(e){var t,n,r,o=0,i="",a="",u=!0,c=[];if(e){for(t=0,o=e.length;o>t;t++)a=e[t].trim(),c.push(a),u&&a&&(u=!1);u&&(c=null)}for(o=0,t=0;t<c.length;t++)o=Math.max(o,c[t].length);for(t=0;o>t;t++){for(a="",n=0;n<c.length;n++)a+=t>=c[n].length?"00":c[n].charAt(t)+c[n].charAt(t+1);r=parseInt(a,16),i+=String.fromCharCode(r),t++}return i}function l(e){var t="";return ut.each(e,function(e){t+="<div>"+e+"</div>"}),t}function s(){var e=GC&&GC.Spread&&GC.Spread.Views&&GC.Spread.Views.LocaleResource&&GC.Spread.Views.LocaleResource.name;return"ja-JP"===e?{ls1:["30303030303030685f4f7900000000000000000000000000003030303030720000673030303030305275303030303074583030305296303030303030","b0ecfcd7b7c6a32a0f1a3e205370726561642e566965777320c8e9a4a2eb480d0a2cd0fcb8e7f36e29286fedfcabebb0836e7f6b3650558c66447e59"],ls2:["30303030303030685f4f790000000000000000000000000000303030303030303067526795306b30000000000065303030","b0ecfcd7b7c6a32a0f1a3e205370726561642e566965777320c8e9a4a2ebadfc6e09b91f936f8b8a207b307d20e5675902"],ls3:["303030303060583089303030303030303030300000000000303030304e303088543052753030303030303030300030303030303030305f89303030","e9a4bbf3b9c5314c8b644b8a7e5b9367575f020d0a576562b5fcd0fc0a676efdc15429286b6fe9a4bbf3b9adfc2fc8e9a4a2ebadfc4cc581675902"],ls4:["6b30303030303030605830535f303030303030303030","635744e9a4bbf3b9c53192d697674d7e5b9367575f02"],ls5:["30303030303030685f4f790000000000000000000000000000303030303030303067526795307d4e3030303030","b0ecfcd7b7c6a32a0f1a3e205370726561642e566965777320c8e9a4a2ebadfc6e09b91f934c4286577e575f02"],ls6:["30303030303030685f4f790000000000000000000000000000303030303072000067303030303030915e30796b30303030303030","b0ecfcd7b7c6a32a0f1a3e205370726561642e566965777320c8e9a4a2eb480d0a2cd0fcb8e7f36e4d036f8162558c66447e5902"]}:"zh-CN"===e?{ls1:["895b848457000000000000000000000000634f62676563300000678b4f72674e966757907f3000004e65907f8b534e966d8b75903000008b60548b8b5390904e520000000000000000000000000000000000000000000030","7f896104ce5370726561642e5669657773d09b802f2f01020d0a2cc430482cc5502c30e872020d0a34f6e872b8efc5504bd52814020d0ae6c5a8e2f7d101aef63073616c65732e7861406772617065636974792e636f6d02"],ls2:["895b848457000000000000000000000000634f626765633000004e65907f8b53524f0000005930","7f896104ce5370726561642e5669657773d09b802f2f01020d0a34f6e872b8ef69597b307d2902"],ls3:["6762528b538b300000577f7e6752564e8f88000000000000000000000000ff6097899951535f546c8b538b3000004e658b534e968b4f759030595d8d4eff8b578d4e904e4e67628b538b30000059975e52ff8b5390904e520000000000000000000000000000000000000000000030","2a7e30b8efc1020d0a2851dc0da1680ad04c5370726561642e56696577730ca800819648d69708d5b8efc1020d0a34f6b8efc550c43028140282f22d700cf7282d70aef62de57eb8efc1020d0a82002ea90cf7d101aef63073616c65732e7861406772617065636974792e636f6d02"],ls4:["65658b538b30000059975e52ff8b5390904e520000000000000000000000000000000000000000000030","e048b8efc1020d0a82002ea90cf7d101aef63073616c65732e7861406772617065636974792e636f6d02"],ls5:["895b848457000000000000000000000000634f626765633000004e65907f8b535d8f67ff8b5390904e520000000000000000000000000000000000000000000083535e5230","7f896104ce5370726561642e5669657773d09b802f2f01020d0a34f6e872b8eff2c71f0cf7d101aef63073616c65732e7861406772617065636974792e636f6db7d62ea902"],ls6:["895b84845700000000000000000000000000634f626765630000796b515253","7f896104ce5370726561642e566965777320d09b802f2f010d0a81628d06d1"]}:{ls1:["","506f776572656420627920477261706543697479205370726561642e56696577732e0d0a20596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e200d0a54656d706f72617279206465706c6f796d656e74206b6579732061726520617661696c61626c6520666f722074657374696e672e200d0a456d61696c207370726561642e73616c6573406772617065636974792e636f6d2e"],ls2:["","506f776572656420627920477261706543697479205370726561642e56696577732e0d0a596f75722074656d706f72617279206465706c6f796d656e74206b6579206578706972657320696e207b307d20646179732e"],ls3:["","4c6963656e7365204e6f7420466f756e640d0a0d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561642e5669657773206f6e206120776562207365727665722e2054656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a20496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e20456d61696c207370726561642e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],ls4:["","496e76616c6964206c6963656e7365206b65792e20456d61696c207370726561642e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],ls5:["","506f776572656420627920477261706543697479205370726561642e56696577732e200d0a596f75722074656d706f72617279206465706c6f796d656e74206b65792068617320657870697265642e0d0a20456d61696c207370726561642e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],ls6:["","506f776572656420627920477261706543697479205370726561642e5669657773204576616c756174696f6e2056657273696f6e2e0d0a204e6f74204c6963656e73656420666f7220446973747269627574696f6e2e"]}}function f(e,t,n){if(e&&lt.isFunction(e)){var r=document.querySelector(t);r&&e(n,r)}return!!e}function d(e,t){var n=this,r=st.parseID(e);if(r&&t.length){var o,i,a,u,c,l,s=n.options,f=n.getItem(e).item;s.autoRowHeight||(u=n.spContainerCache_=n.spContainerCache_||{}),ut.each(t,function(e){c=e.id,o=q.call(n,r,e),o&&(!r.groupInfo||r.groupInfo.area!==Ft&&r.groupInfo.area!==Dt?a=f[c]:(i=o.getAttribute("data-formula"),i&&(a=n.data.evaluate(i,r.groupInfo.path),o.removeAttribute("data-formula"))),a&&a.paint&&o&&(u&&(l=u[c]=u[c]||ct.gER(o)),a.paint(o,l)),e.asyncRender&&e.asyncRender(f,o))})}}function p(e,t){for(var n,r=0,o=e.length;o>r;r++)if(n=e[r],n.dataField){var i=n.dataField.split(".");if(ut.isEqual(i,t))return n}return null}function h(e,t){var n,r,o,i=this;for(n=0,r=e.length;r>n;n++)o=e[n],o.columns?h.call(i,o,t):t.push(ut.defaults(o,{id:o.dataField,caption:o.dataField,pinned:"none",width:"*",visible:!0}))}function g(){var e=this;it&&it[Xt[0]](e)}function v(e,t,n){ut.each(e,function(e){if(e.hasOwnProperty("dataField")||e.hasOwnProperty("action")||e.hasOwnProperty("asyncRender"))n[e.id]={parent:t,isCol:!0};else if(e.hasOwnProperty("columns")){var r=lt.isNil(e.isCollapsed)?!0:e.isCollapsed;e.collapsedInfo=e.collapsedInfo||{viewport:r,pinnedLeftViewport:r,pinnedRightViewport:r};var o=e.collapsedInfo;n[e.caption]={parent:t,isCol:!1,status:{showIcon:y(e,"none"),isCollapsed:o.viewport},pinnedStatus:{showIcon:y(e,"left"),isCollapsed:o.pinnedLeftViewport},pinnedRightStatus:{showIcon:y(e,"right"),isCollapsed:o.pinnedRightViewport}},v(e.columns,e.caption,n)}})}function m(e){var t=this,n=t.container;n.appendChild(ct.createElement('<div style="'+c($t)+"z-index:"+Math.floor(4999*Math.random()+5e3)+';">'+l(e)+"</div>"))}function _(e,t){var n,r,o,i=!1;for(n=0,r=e.length;r>n&&(o=e[n],o.columns?i=_(o.columns,t):(o.pinned=o.pinned||"none",i=o.pinned===t),!i);n++);return i}function y(e,t){var n,r=e.columns,o=r.length,i=o,a=0,u=0,c=0;for(n=0;i>n;n++)e=r[n],e.columns||(e.pinned=e.pinned||"none"),e.columns&&_(e.columns,t)||e.pinned===t&&"expanded"!==e.headerGroupShow?(a+=1,c+=1):e.pinned===t&&"expanded"===e.headerGroupShow&&(u+=1,c+=1);return a!==c&&u!==c}function C(e,t,n){var o=[];o=o.concat(t);for(var i in e){var a=i;"object"!==r(e[a])?n.push(o.concat([a])):e[a]instanceof Array?C(e[a][0],o.concat([a]),n):C(e[a],o.concat([a]),n)}}function b(e){var t=this,n=lt.isString(e),r=n?e:e.name,o=je.call(t,r);return!n&&o&&e.handler&&(o.handler=e.handler),"edit"===r&&(t.hasEditAction_=!0),"cancel"===r&&(t.hasCancelAction_=!0),"save"===r&&(t.hasSaveAction_=!0),n?{name:e}:e}function S(e,t){return ut.find(e,function(e){return e.key===t})}function w(e,t,n){var r=this;e&&(r.transformProp_=r.transformProp_||I(),Math.abs(t)>16e6||Math.abs(n)>16e6?(e.style.setProperty("left",t+"px"),e.style.setProperty("top",n+"px"),e.style.setProperty(r.transformProp_,null)):(e.style.setProperty("left",null),e.style.setProperty("top",null),e.style.setProperty(r.transformProp_,x(Math.floor(t),Math.floor(n)))))}function I(){return-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0||navigator.userAgent.match(/Firefox/i)?"transform":"-webkit-transform"}function x(e,t){return t+="px",e+="px","translate3d("+e+","+t+", 0px)"}function A(e){var t=e.name,n=e.options,r=n&&n.groupStrategy,o=GC&&GC.Spread&&GC.Spread.Views&&GC.Spread.Views.Plugins;if(r){var i=r.name;lt.isString(i)&&o&&o[i]&&(n.groupStrategy=new GC.Spread.Views.Plugins[i](r.options))}return lt.isString(t)&&o&&o[t]?new GC.Spread.Views.Plugins[t](n):void 0}function E(e,t,n){return n=n||{},e.raise(t,n)}function R(e,t){var n=this,r={data:e,path:t,isBottomLevel:e.isBottomLevel};return e.isBottomLevel||(r.children=[],r.children=ut.map(e.groups,function(e,r){return R.call(n,e,t.concat([r]))})),r}function N(){var e=this,t=e.container;D.call(e),lt.regist(t,"click",e.cFn_),lt.regist(t,"dblclick",e.dcFn_),lt.regist(t,"mousedown",e.mdFn_),lt.regist(t,"mouseup",e.muFn_),lt.regist(t,"mousemove",e.mvFn_),lt.regist(t,"wheel",e.wFn_),lt.regist(t,"wheel",e.dmwFn_),lt.regist(t,"focusin",e.fiFn_),e.oso_.addHandler(e.dsoFn_),e.ods_.addHandler(e.dsFn_),X.call(e),$.call(e)}function D(){var e=this,t=e.container;(!t.tabIndex||t.tabIndex<0)&&(t.tabIndex=1),t.style.outline="none",lt.regist(t,"keydown",e.kdFn_);var n=window;n.addEventListener("keydown",e.dkdFn_,!1)}function F(){var e=ct.detectBrowserType();if(e.isIE){var t=document.activeElement,n=this;if(n.container.contains(t)&&n.container!=t){var r=n.options.groupStrategy,o=r&&r.name.toLowerCase();T(t)||"CalendarGrouping"===o||n.container.focus()}}}function T(e){var t=e.tagName,n=["INPUT","SELECT","TEXTAREA","BUTTON"];try{if("IFRAME"===t)return!0;if("A"===t||"AREA"===t)return!!e.href;if(n.indexOf(t)>-1)return!(e.disabled||e.hidden)}catch(r){return!1}}function M(){var e=this,t=e.container;lt.unRegist(t,"keydown",e.kdFn_);var n=window;lt.unRegist(n,"keydown",e.dkdFn_,!1)}function O(){var e,t=this,n=t.scrollElementId_,r=t.scrollElementArea_;if(n&&r){e=t.lRR_[r];var o=t.gSO_(r),i=Me(t).gRR_({area:r,offsetTop:o.top,offsetLeft:o.left});if(i){var a=i.renderedRows||[];if(-1===ut.map(a,ut.property("key")).indexOf(n)){var u=document.getElementById(n);u&&u.parentNode.removeChild(u);var c=e.indexOf(n);c>=0&&e.splice(c,1)}}}t.scrollElementId_=null,t.scrollElementArea_=null,t.scrolling_=!1}function L(){var e=this,t=e.container;M.call(e),lt.unRegist(t,"click",e.cFn_),lt.unRegist(t,"dblclick",e.dcFn_),lt.unRegist(t,"mousedown",e.mdFn_),lt.unRegist(t,"mouseup",e.muFn_),lt.unRegist(t,"mousemove",e.mvFn_),lt.unRegist(t,"wheel",e.wFn_),lt.unRegist(t,"wheel",e.dmwFn_),lt.unRegist(t,"focusin",e.fiFn_),e.oso_.removeHandler(e.dsoFn_),P.call(e),K.call(e)}function P(){var e,t=this;ut.each(t.scE_,function(n){e=document.getElementById(n),e&&lt.unRegist(e,"scroll",t.sFn_)}),t.scE_.length=0}function G(){var e,t,n,r,o=this,u=o.options,c=o.getLayoutInfo(),l=o.context_.getInstance("containerWrapper"),s=l.contentContainer_,f="";o.scE_.length=0,ut.keys(c).map(function(i){o.saSO_(i);var a=o.gSO_(i);if(t=o.getRenderInfo({area:i,offsetTop:a.top,offsetLeft:a.left}),e=o.lRR_[i]=o.lRR_[i]||[],t){if(f+='<div id="'+o.uid+"-"+i+'"',t.outerDivStyle&&(f+=' style="'+lt.cMFS(t.outerDivStyle)+'"'),t.outerDivCssClass&&(f+=' class="'+t.outerDivCssClass+'"'),f+='><div id="'+o.uid+"-"+i+'-inner"',t.innerDivStyle&&(r=lt.cMFS(t.innerDivStyle)),t.innerDivTranslate){var u=Math.floor(t.innerDivTranslate.left),c=Math.floor(t.innerDivTranslate.top);Math.abs(u)>16e6||Math.abs(c)>16e6?(r+="left:"+u+"px;",r+="top:"+c+"px;"):r+=I()+":"+x(u,c)}r&&(f+=' style="'+r+'"'),t.innerDivCssClass&&(f+=' class="'+t.innerDivCssClass+'"'),f+=">",n=t.renderedRows||[],ut.each(n,function(t){e.push(t.key),f+=o.rR_(t)}),f+="</div></div>"}}),ut.keys(c).map(function(e){o.sSP_(e)&&ut.each(o.gSPRI_(e),function(t){if(t){var n=o.uid+"-"+e+"-scroll"+(t.isVertical?"-vertical":"-horizontal");o.scE_.push(n),f+='<div id="'+n+'" class="'+t.outerDivCssClass+'"',f+=' style="-webkit-overflow-scrolling:touch;',t.outerDivCssClass&&(f+=lt.cMFS(t.outerDivStyle)),f+='"><div',t.innerDivStyle&&(f+=' style="'+lt.cMFS(t.innerDivStyle)+'"'),f+="></div></div>"}})});var d=ct.detectBrowserType();!function(e,t,n){var r=setTimeout(function(){a(s),t=e?a(s)&&"Safari10"===t?"Safari"+n:"IE8"!==t&&g.call(o)?"IE8"+n:"FireFox":"IE"},16);e&&r&&(t="Chrome")}(c,d,"_plus");var p,h,v,m=o.uid;ut.keys(c).map(function(e){e===wt?h="#"+m+"-chRow.gc-header-row":e===bt?p="#"+m+"-plchRow.gc-header-row":e===St&&(v="#"+m+"-prchRow.gc-header-row")});var _,y,C,b,S,w;if(p&&(_=s.querySelector(p)),h&&(y=s.querySelector(h)),v&&(C=s.querySelector(v)),d.isIE)for(;s.firstChild;)s.removeChild(s.firstChild);s.innerHTML=f,p&&(b=s.querySelector(p)),h&&(S=s.querySelector(h)),v&&(w=s.querySelector(v)),_&&b&&i(o.columns,_,b),y&&S&&i(o.columns,y,S),C&&w&&i(o.columns,C,w),u.headerRow&&u.headerRow.visible&&o.refreshHeaderRowDynamicContent_(),Me(o).hGC_&&B.call(o),V.call(o)}function B(){var e=this,t=e.gSO_("gantt"),n=t.left,r=t.top,o=e.getLayoutInfo().gantt;Me(e).gantt_.container_(e.uid+"-gantt-inner").draw({x1:n,y1:r,x2:n+o.width,y2:r+o.height});var i=ct.detectBrowserType();if(i.isSafari){var a=document.querySelector("#"+e.uid+"-gantt-inner");if(a){var u=a.style.transform?"transform":"-webkit-transform",c=a.style[u];c&&(a.style[u]=c.replace(/\d+px(?!.*\d+px)/,"1px"))}}}function k(){var e=this,t=Me(e);t.iFR_&&t.iFR_()}function U(){var e=this,t=e.focusElement_,n=Me(e);setTimeout(function(){var n=document.activeElement;t&&t!=n&&(T(n)||e.container.focus())},200),t&&t.focus&&t.focus(),n.uFRAI_&&n.uFRAI_()}function H(e){var t=this;if(t.aRC_&&t.aRC_.length)return t.aRC_;var n=t.columns,r=ut.filter(n,function(n){return e===At?"left"===n.pinned&&(Y.call(t,n)||n.asyncRender):e===xt?"none"===n.pinned&&(Y.call(t,n)||n.asyncRender):e===Et?"right"===n.pinned&&(Y.call(t,n)||n.asyncRender):lt.isUndefined(e)?Y.call(t,n)||n.asyncRender:void 0});return t.aRC_=r,r}function V(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=this,r=H.call(n);if(r.length&&t){var o=0;n.options.allowAsyncRender?n.asynRenderTimer_=setTimeout(z.bind(n,o,r,e),30):W.call(n,o,r)}}function j(e,t,n){var r=this,o=r.lRR_,i=!1;return ut.each([At,xt,Et],function(a){var u=e,c=o[a];c&&("down"!==n&&"left"!==n||(u=c.length-u-1),e<c.length&&(i=!0,d.call(r,c[u],t)))}),i}function W(e,t){for(var n=this;j.call(n,e,t);)e++}function z(e,t,n){var r=this;j.call(r,e,t,n)&&(e++,r.asynRenderTimer_=setTimeout(z.bind(r,e,t,n),30))}function Y(e){var t,n,r,o=this,i=["=PIESPARKLINE","=LINESPARKLINE","=COLUMNSPARKLINE","=WINLOSSSPARKLINE"],a=o.data,u=a.groups,c=u&&u.length>0,l=e.id,s=e.dataField,f=ut.find(a.groupDescriptors,function(e){return e.field===l});for(n=0,r=i.length;r>n;n++)if(t=i[n],a.isCalculatedColumn(l)&&s&&-1!==s.indexOf(t)||c&&f&&f.header.visible&&e.groupHeader&&-1!==e.groupHeader.indexOf(t)||c&&f&&f.footer.visible&&e.groupFooter&&-1!==e.groupFooter.indexOf(t))return!0;return!1}function q(e,t){if(e){var n="#"+st.createID(e),r=e.row>-1||e.groupInfo&&e.groupInfo.area===Tt||e.nodeInfo&&e.nodeInfo.area===Mt,o=r?" [data-column="+t.id+"].gc-cell":" .gc-group-sparkline";return document.querySelector(n+o)}}function X(){var e=this;ut.each(e.scE_,function(t){lt.regist(document.getElementById(t),"scroll",e.sFn_)})}function $(){var e=this,t=e.container;ft(t).on("touchstart",e.tsFn_),ft(t).on("touchmove",e.tmFn_),ft(t).on("touchend",e.teFn_),lt.regist(t,"inertiamove",ut.throttle(e.imFn_,yt))}function K(){var e=this,t=e.container;ft(t).off("touchstart",e.tsFn_),ft(t).off("touchmove",e.tmFn_),ft(t).off("touchend",e.teFn_),lt.unRegist(t,"inertiamove",e.imFn_)}function J(e){var t=this,n=e.changedTouches[0];oe.call(t,e,n,"start")||(ne.call(t,e,n,"start")&&e.preventDefault(),E(t.otos_,t,e),t.isTouchMode_=!0,fe.call(t),t.tapPoint_=null,rt.touchEventInfo=[{timeStamp:(new Date).getTime(),x:n.pageX,y:n.pageY}],rt.touchStartHitInfo=Me(t).hT_({pageX:n.pageX,pageY:n.pageY}),rt.identifier=n.identifier,rt.touchScrollInfo=t.gSI_(rt.touchStartHitInfo&&rt.touchStartHitInfo.area),t.scrollElementArea_=rt.touchScrollInfo&&rt.touchScrollInfo.area,xe.call(t,ut.pick(n,Vt)))}function Z(e){var t=this,n=ee(e.targetTouches);if(n&&!oe.call(t,e,n,"move"))if(ne.call(t,e,n,"move")&&e.preventDefault(),"scroll"===rt.touchAction||"swipestart"===rt.touchAction||"swipemoving"===rt.touchAction){if(le()){var r=rt.touchEventInfo[0].x-n.pageX;t.options.rightToLeft&&(r=-r);var o=rt.touchEventInfo[0].y-n.pageY,i="horizontal"===rt.moveDirection?r:o;if("scroll"===rt.touchAction){rt.stopInertiaMove=!0,E(t.ots_,t,e);var a=rt.startOffset[rt.touchScrollInfo.area];a&&me.call(t,e,a.left,a.top,i)}else"swipestart"!==rt.touchAction&&"swipemoving"!==rt.touchAction||ae.call(t,e);rt.touchEventInfo.push({timeStamp:(new Date).getTime(),x:n.pageX,y:n.pageY})}}else E(t.otm_,t,e)}function Q(e){var t=this,n=ee(e.changedTouches);if(n){if(oe.call(t,e,n))return void delete rt.identifier;ne.call(t,e,n,"end")&&e.preventDefault(),"tap"===rt.touchAction?t.tapPoint_=n:"swipeend"===rt.touchAction?ae.call(t,e):"scroll"===rt.touchAction?(rt.stopInertiaMove=!1,ot={},ot.v=he("horizontal"===rt.moveDirection?n.pageX:n.pageY),ot.deceleration=6e-4*(ot.v<0?1:-1),ot.v=Math.abs(ot.v)>2?ot.v<0?-2:2:ot.v,ot.element=this.container,ot.moveInterval=setInterval(se,yt),ot.topleftDelta=0,ot.rightbottomDelta=0):E(t.ote_,t,e),delete rt.identifier}}function ee(e){return rt?ut.find(e,function(e){return e.identifier===rt.identifier}):null}function te(e){var t=this;if(!rt.stopInertiaMove){var n=t.options.rowHeight,r=ot.v+yt*ot.deceleration,o=ot.deceleration*r>0,i="horizontal"===rt.moveDirection,a=rt.touchScrollInfo.layoutInfo;if(!a)return void(ot.moveInterval&&clearInterval(ot.moveInterval));var u=t.gSO_(rt.touchScrollInfo.area),c=u.left,l=u.top,s=i?c:l,f=i?a.width:a.height,d=i?c+f:l+f,p=-_t,h=i?a.contentWidth:a.contentHeight,g=h+_t,v=h>f,m=c,_=l;if(o?rt.stopInertiaMove=!0:(p>s||d>g)&&(rt.stopInertiaMove=!0),rt.stopInertiaMove)return 0>s||!v?(m=i?0:c,_=i?l:0):d>h&&(m=i?h-a.width:c,_=i?l:h-a.height),me.call(t,e,m,_,0),void clearInterval(ot.moveInterval);var y=(r+ot.v)/2*yt,C=0>y?-1:1;y=Math.floor(Math.abs(y));var b=n/3*2,S=n/3*4;y>b&&S>y?(y=b*C,ot.v=y/yt):(y*=C,ot.v=r);var w=i&&t.options.rightToLeft;0>s?(ot.topleftDelta+=y,m=i?0:c,_=i?l:0,y=w?-ot.topleftDelta:ot.topleftDelta,me.call(t,e,m,_,y)):d>h&&v?(ot.rightbottomDelta+=y,m=i?h-a.width:c,_=i?l:h-a.height,y=w?-ot.rightbottomDelta:ot.rightbottomDelta,me.call(t,e,m,_,y)):(y=w?-y:y,me.call(t,e,c,l,y))}}function ne(e,t,n){var r,o=this,i=Me(o);return r="start"===n?re()?!0:i.sPTE_(t,n):"move"===n?i.sPTE_(t,n):"scroll"===rt.touchAction,r&&e.cancelable}function re(){var e=ct.detectBrowserType();return e.isIE||e.isEdge?!0:void 0}function oe(e,t,n){var r,o=this;return"start"===n?r=rt&&rt.identifier>=0&&e.touches.length>=2&&rt.identifier!==t.identifier:"move"===n?t?pe(t)?r=!0:(de.call(o,t),r=!ie.call(o,t)):r=!0:t?(de.call(o,t,!0),r=!ie.call(o,t)):r=!0,r}function ie(e){var t=this;if("scroll"===rt.touchAction){var n=t.options.rightToLeft?e.pageX-rt.touchEventInfo[0].x:rt.touchEventInfo[0].x-e.pageX,r=rt.touchEventInfo[0].y-e.pageY,o=ut.pick(e,Vt);return o.deltaX="horizontal"===rt.moveDirection?n:0,o.deltaY="horizontal"===rt.moveDirection?0:r,t.contentScrollable_=Me(t).cCS_(o),t.contentScrollable_}return!0}function ae(e){var t=this,n="horizontal"===rt.moveDirection,r="swipeend"===rt.touchAction,o=n?r?e.changedTouches[0].pageX:e.targetTouches[0].pageX:r?e.changedTouches[0].pageY:e.targetTouches[0].pageY;e.swipeStatus=rt.touchAction,e.moveDistance=n?rt.touchEventInfo[0].x-o:rt.touchEventInfo[0].y-o,e.velocity=he(o),E(t.osp_,t,e)}function ue(){var e=this,t=Me(e)&&Me(e).cTS_;return ut.isFunction(t)?t.call(Me(e),rt):!(!rt.touchScrollInfo||!rt.touchScrollInfo[rt.moveDirection+"ScrollArea"])}function ce(){var e=rt.touchStartHitInfo,t=e&&e.area&&e.area.indexOf("pinned")>-1;return t?!1:e&&"viewport"===e.area&&-1===e.row&&-1===e.column&&e.groupInfo&&(e.groupInfo.area===Dt||e.groupInfo.area===Ft)?!1:e&&"columnHeader"!==e.area}function le(){var e=rt.touchEventInfo[rt.touchEventInfo.length-1];return(new Date).getTime()-e.timeStamp>12.5||1===rt.touchEventInfo.length}function se(){if(!rt.stopInertiaMove){var e=new CustomEvent("inertiamove",{bubbles:!0,cancelable:!0});ot.element.dispatchEvent(e)}}function fe(){var e=this;rt={stopInertiaMove:!0,startOffset:ut.cloneDeep(e.scrollOffset),stopFeedBack:!0,touchScrollInfo:{},touchEventInfo:[]},ot&&clearInterval(ot.moveInterval)}function de(e,t){var n=rt.touchEventInfo,r=this;if(n)if(t)n[0].x===e.pageX&&n[0].y===e.pageY?rt.touchAction="tap":"swipemoving"===rt.touchAction&&(rt.touchAction="swipeend");else if("swipestart"===rt.touchAction||"swipemoving"===rt.touchAction)rt.touchAction="swipemoving";else if("scroll"===rt.touchAction)rt.touchAction="scroll";else{if(!ge(e))return;var o=rt.touchEventInfo[0].x-e.pageX,i=rt.touchEventInfo[0].y-e.pageY;r.options.allowSwipe&&Me(r).cDS_(rt.moveDirection)&&ce()?Me(r).cSS_(o,i)&&(rt.touchAction="swipestart"):ue.call(r)&&(rt.touchAction="scroll")}}function pe(e){var t=rt.touchEventInfo;return t&&t[0].x===e.pageX&&t[0].y===e.pageY?!0:void 0}function he(e){for(var t=rt.touchEventInfo.length-1,n=rt.touchEventInfo[t],r="horizontal"===rt.moveDirection?n.x:n.y,o=(new Date).getTime();r===e&&(t--,t>=0);)n=rt.touchEventInfo[t],r="horizontal"===rt.moveDirection?n.x:n.y;return(r-e)/(o-n.timeStamp)}function ge(e){if(!rt.moveDirection){var t=e.pageX,n=e.pageY,r=rt.touchEventInfo.length-1,o=rt.touchEventInfo[r],i=t-o.x,a=n-o.y;return i===a?!1:(rt.moveDirection=Math.abs(a)>Math.abs(i)?"vertical":"horizontal",!0)}return!0}function ve(e,t){return ct.getElement("#"+this.uid+"-"+e+"-scroll"+(t?"-vertical":"-horizontal"))}function me(e,t,n,r){var o=this;"horizontal"===rt.moveDirection?o.sA_(rt.touchScrollInfo.area,{left:t+r},_e,function(){r&&(o.scrollDirection=r>0?"left":"right"),e.scrollDirection=o.scrollDirection,Fe.call(o,e)}):o.sA_(rt.touchScrollInfo.area,{top:n+r},_e,function(){r&&(o.scrollDirection=r>0?"up":"down"),e.scrollDirection=o.scrollDirection,Fe.call(o,e)})}function _e(e){var t=e;return ye(Math.abs(t),mt)*(t>0?1:-1)}function ye(e,t){return-t/(e/t+1)+t}function Ce(e){var t=this,n=t.tapPoint_;e.deviceType=n?"touch":"mouse",E(t.onMouseClick_,t,e),delete t.tapPoint_}function be(e){e.deviceType="mouse",E(this.omdc_,this,e)}function Se(e){var t=this;t.scrolling_=!1,this.isTouchMode_||E(this.omu_,this,e)}function we(e){this.isTouchMode_||E(this.omd_,this,e)}function Ie(e){var t=this;if(e.deltaX<0){var n=navigator&&navigator.userAgent;if(n&&n.match(/Macintosh/)){var r=t.gSO_("viewport");r.left>0&&e.preventDefault()}}t.isLoadingData?e.preventDefault():Me(t).cCS_(e)&&!e.ctrlKey&&(xe.call(t,e),E(this.omw_,this,e))}function xe(e){var t,n=this,r=n.options.groupStrategy,o=r&&r.name.toLowerCase();if("trellisgrouping"===o)n.scrollElementArea_="viewport",n.scrollElementId_=n.uid+"-gc-group-container";else if("calendargrouping"===o)"Month"!==r.options.viewMode&&(t=Me(n).hT_(e),t&&t.groupInfo&&(n.scrollElementArea_="viewport",n.scrollElementId_=n.uid+"-g"+t.groupInfo.path.join("_")));else if(t=Me(n).hT_(e)){t.uid=n.uid,t.groupInfo&&(t.row=t.groupInfo.row),n.scrollElementArea_=t.area;var i=st.createID(t);document.getElementById(i)&&i!==n.uid&&(n.scrollElementId_=i)}}function Ae(e){var t=this;t.scrolling_||t.tapPoint_||E(t.omm_,t,e)}function Ee(e){var t=this;E(this.okd_,this,e);var n=t.commandManger_.getShortcutKey(e.keyCode,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey),r=t.commandManger_.getCommands(n);r&&ut.each(r,function(n){n.execute(t,e)})}function Re(e){var t=this,n=t.commandManger_.getShortcutKey(e.keyCode,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey),r=t.commandManger_.getCommands(n);r&&"activeDataView"===r[0].name&&ut.each(r,function(t){t.execute(e)})}function Ne(){var e=this,t=ct.detectBrowserType();if(!t.isSafari||!e.isTouchMoving_){var n=Me(e);n.uCW_&&(n.cRC_(),n.uCW_()),this.invalidate()}}function De(e){var t=this;if(t.preventTriggerScrolling_)return t.preventTriggerScrolling_=!1,void e.preventDefault();var n;Me(t).iRC_||(t.scrolling_=!0,e.preventDefault(),lt.isUndefined(t.asynRenderTimer_)||clearTimeout(t.asynRenderTimer_),window&&window.requestAnimationFrame&&window.requestAnimationFrame(function(){var r;if(t.scrollElementArea_)r=t.gSA_(t.scrollElementArea_);else{var o=e.target;o.className.indexOf("gc-grid-viewport-scroll-panel")>-1&&(r=o.id.replace(t.uid+"-","").replace("-scroll",""))}r=r||xt,r=r.replace("-vertical","").replace("-horizontal","");var i=t.gSPO_(r),a=t.gSO_(r);lt.isNil(i.top)||a.top!==i.top&&(n=a.top>i.top?"down":"up",t.sSO_(r,{top:i.top})),n||lt.isNil(i.left)||a.left!==i.left&&(n=a.left>i.left?"right":"left",t.sSO_(r,{left:i.left})),n&&(e.scrollDirection=n,Fe.call(t,e),t.scrolling_=!1)}))}function Fe(e){var t=this;Me(t).sFn2_(e),V.call(t,null,!t.options.allowAsyncRender),g.call(t),Me(t).sSL_(e)&&!function(){ot&&clearInterval(ot.moveInterval);var e=t.context_.getInstance("dataLoader");e.dsIsSimple?(t.scrollToRefresh_=!0,t.iI_(!1,{clearTouchCache:!0}),t.scrollToRefresh_=!1):(t.isLoadingData=!0,e.tryToLoad(!0,function(n){n.success&&n.cacheChanged&&(e.appendDataAndSync_(n.content),t.isLoadingData=!1)}))}()}function Te(e,t){var n=this;t&&(n.dragScrollTimeInterval_?n.dragScrollEvent_&&(n.dragScrollEvent_.area=t.area,n.dragScrollEvent_.moveOffset=t.moveOffset,n.dragScrollEvent_.cancel=t.cancel):(n.dragScrollEvent_=t,n.dragScrollTimeInterval_=setInterval(function(){var e=t.area,r=n.gSI_(e);if(t.cancel&&n.dragScrollTimeInterval_)return clearInterval(n.dragScrollTimeInterval_),n.dragScrollTimeInterval_=null,void(n.dragScrollEvent_=null);var o=n.gSO_(e);t.moveOffset&&!function(){var i=t.moveOffset(o),a=[];i.left&&(a=ut.union(a,r.horizontalScrollArea)),i.top&&(a=ut.union(a,r.verticalScrollArea)),n.sA_(e,i,null,function(){ut.each(a,function(e){n.refresh(e)})})}()},yt)))}function Me(e){return e.layoutEngine}function Oe(e,t){var n=this;V.call(n,t.scrollDirection,n.options.allowAsyncRender)}function Le(e,t){var n,r,o=e.length,i=t.length,a=[],u=[];if(0===o){for(n=0;i>n;n++)a.push({operation:"insert",index:n,item:t[n]});return a}if(0===i){for(n=0;o>n;n++)a.push({operation:"delete",index:o-n-1});return a}for(n=0;o>=n;n++)u[n]=[];for(n=0;o>=n;n++)u[n][0]=n;for(n=0;i>=n;n++)u[0][n]=n;for(n=1;o>=n;n++)for(r=1;i>=r;r++)e[n-1]===t[r-1]?u[n][r]=u[n-1][r-1]:u[n][r]=Math.min(u[n-1][r]+1,u[n][r-1]+1,u[n-1][r-1]+1);for(n=o,r=i;n>=1||r>=1;)n>=1&&r>=1&&e[n-1]===t[r-1]?(n-=1,r-=1,a.push({operation:"update",index:n})):n>=1&&u[n][r]===u[n-1][r]+1?(a.push({operation:"delete",index:n-1}),n-=1):r>=1&&u[n][r]===u[n][r-1]+1?(a.push({operation:"insert",index:n,item:t[r-1]}),r-=1):n>=1&&r>=1&&(a.push({operation:"replace",index:[n-1,r-1]}),n-=1,r-=1);return a}function Pe(e,t){var n=e,r=t,o=n.length,i=r.length,a=0,u=0,c=[],l=r.indexOf(n[0]);if(-1===l)for(l=n.indexOf(r[0]);l>a;a++)c.push({operation:"delete",index:n[a]});else for(;l>u;u++)c.push({operation:"insert",index:r[u]});for(;o>a&&i>u&&n[a]===r[u];)Be(this)&&c.push({operation:"replace",index:[n[a],n[a]]}),a++,u++;for(;o>a;a++)c.push({operation:"delete",index:n[a]});for(;i>u;u++)c.push({operation:"insert",index:r[u]});return c}function Ge(e,t){var n=this,r=lt.compareArray(e,t,!1).map,o={1:"delete",2:"replace",3:"insert"},i=[],a=[];return ut.forEach(r,function(e,t){2!==e?i.push({operation:o[e],index:t}):t.indexOf("gh")>-1?a.push({operation:"delete",index:t},{operation:"insert",index:t}):Be(n)&&i.push({operation:o[2],index:[t,t]})}),i.concat(a)}function Be(e){var t=e.layoutEngine,n=t.options.cellMergingSettings;return n&&n.alwaysShowText&&t.hSC_&&t.hSC_()}function ke(e){var t=e.grid,n=e.options.groupStrategy,r=t.data.groupDescriptors,o=lt.isArray(r)?r:[r];if(r&&o.length>0&&n){var i=n.name;"calendargrouping"!==i.toLowerCase()&&"timelinegrouping"!==i.toLowerCase()||1===o.length&&"date"===t.gCBI_(o[0].field).dataType?e.gS_=n:console&&console.error&&console.error(n.options.localeResource.errorText)}e.gS_&&e.gS_.init_(t)}function Ue(){var e=this,t=e.data;t.groupDescriptors&&t.updateGroupDescriptors_(ut.cloneDeep(e.options.grouping))}function He(){var e=this,t=Me(e);t.uRE_();var n=e.options.groupStrategy;if(t.gS_)if(lt.isNil(n))t.gS_.d_(),delete t.gS_;else if(t.gS_.name.toLowerCase()===n.name.toLowerCase()){var r=n.options,o=t.gS_.options;JSON.stringify(lt.serializeObject(r))!==JSON.stringify(lt.serializeObject(o))&&(t.gS_.options=r,t.gS_.cRC_())}else t.gS_.d_(),delete t.gS_,ke(t);else lt.isNil(e.options.groupStrategy)||ke(t);
t.rE_()}function Ve(){var e=this,t=e.actions||(e.actions={});t.edit={handler:function(t){t.closeActionColumnPanel(),e.startEditing()}},t.save={handler:function(t){t.closeActionColumnPanel(),e.stopEditing()}},t.cancel={handler:function(t){t.closeActionColumnPanel(),e.cancelEditing()}}}function je(e){return this.actions[e]}function We(e){return this.options.rightToLeft?ct.getRTLScrollLeft(e,"reverse"):e.scrollLeft}function ze(e,t){this.options.rightToLeft?ct.setRTLScrollLeft(e,t,"reverse"):e.scrollLeft=t}function Ye(e,t,n){var r=isNaN(t)||lt.isNil(t)?e:Math.max(t,e);return isNaN(n)||lt.isNil(n)?r:Math.min(n,r)}function qe(e){var t=[];return ut.each(e,function(e){e.collapsedInfo&&delete e.collapsedInfo,e.hasOwnProperty("columns")?t=t.concat(qe(e.columns)):t.push(e)}),t}function Xe(e,t){var n=[];return ut.each(e,function(e){e.hasOwnProperty("columns")?(e.columns=Xe(e.columns,t),n.push(e)):-1!==t.indexOf(e.id)&&n.push(e)}),n}function $e(){var e=Me(this);e.uSU_&&e.uSU_(),e.uFR_&&e.uFR_(function(){return!0})}function Ke(e){var t=this,n=Number(e),r=void 0;return ut.isNaN(n)?ut.isString(e)&&(r=Ze.call(t,e)):r=Je.call(t,Math.round(n)),r}function Je(e){var t=this,n=e;if(0>n)return null;var r=Me(t);if(r.aARA_){var o=r.aARA_(kt),i=r.aARA_(Ut);if(o&&0===n||i&&n===st.vi(t,t.uid+"-autorow"))return{isNewRow:!0,item:null,row:-1};o&&n--}var a=t.data,u=a.rootGroup;if(u){var c=Qe.call(t,u,n);if(u=c&&c.group){if(u.rootNode&&c.groupArea===Tt){n=c.relativeIndex;var l=et.call(t,u.rootNode,n),s=l&&l.node;return{groupArea:Tt,group:u,node:s,nodeArea:l&&l.nodeArea,item:s&&s.getItem(),row:n}}n=c.relativeIndex;var f=c.groupArea;return c.groupArea===Tt?{groupArea:f,group:u,item:u.getItem(n),row:n}:{groupArea:f,group:u,row:n}}return null}var d=a.rootNode;if(d){var p=et.call(t,d,n);return d=p&&p.node,p?{node:d,nodeArea:p.nodeArea,item:d.getItem(),row:n}:null}var h=a.getItem(n);return h?{item:h,row:n}:null}function Ze(e){var t=this.data,n=st.parseID(e),r={};if(n){var o=n.groupInfo,i=n.nodeInfo,a=n.row;if(o){var u=t.rootGroup.findChildGroupByPath(o.path);u&&(r.group=u,r.groupArea=o.area),o.area===Tt&&(u.rootNode?(r.nodeArea=i.area,r.node=u.rootNode.findChildNodeByPath(i.path),r.item=r.node.getItem()):r.item=u.getItem(a))}else if(i){var c=t.rootNode.findChildNodeByPath(i.path);r.item=c.getItem(),r.nodeArea=i.area,r.node=c}else r.item=t.getItem(a);n.isNewRow&&(n.isNewRow=!0)}return r}function Qe(e,t){var n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],r=t,o=e,i=void 0,a=void 0,u=void 0,c=void 0,l=this;if(o){if(n){var s=tt(o,r,st.gGRC_(l,o,o.level>-1));if(s!==Tt)return{groupArea:s,group:o,relativeIndex:r};i=o[Lt],i&&i[Pt]&&i[Pt][Gt]&&--r,a=i&&i[Ht],u=a&&a[Gt],c=a&&a[Bt],u&&c===kt&&--r}for(;!o.isBottomLevel;){for(var f=o.groups,d=!1,p=0,h=f&&f.length||0;h>p;++p){var g=f[p],v=st.gGRC_(l,g,!0);if(v>r){d=!0,o=g;var m=tt(o,r,v);if(m!==Tt)return{groupArea:m,group:o,relativeIndex:r};i=o[Lt],i&&i[Pt]&&i[Pt][Gt]&&--r,a=i&&i[Ht],u=a&&a[Gt],c=a&&a[Bt],u&&c===kt&&--r;break}r-=v}if(!o||!d)return null}return{relativeIndex:r,group:o,groupArea:Tt}}}function et(e,t){var n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],r=this,o=e,i=t;if(o){if(n){var a=nt.call(r,o,i,st.gNRC_(r,o,o.level>-1));if(a===Ot)return{nodeArea:a,node:o};--i}for(;o.children.length>0;){for(var u=o.children,c=!1,l=0,s=u.length;s>l;++l){var f=u[l],d=st.gNRC_(r,f,!0);if(d>i){if(c=!0,o=f,0===i)return{nodeArea:Mt,node:o};var p=nt.call(r,o,i,d);if(p===Ot)return{nodeArea:p,node:o};--i;break}i-=d}if(!o||!c)return null}return o}}function tt(e,t,n){var r=ut.property(["groupDescriptor","header","visible"])(e);if(0===t&&r)return Dt;var o=e.collapsed;if(o&&!r&&0===t)return Ft;var i=ut.property([Lt,Ht,Bt])(e),a=ut.property([Lt,Ht,Gt])(e),u=ut.property([Lt,Ht,"collapseWithGroup"])(e);return!a||u&&o||!(i===Ut&&n-1===t||i===kt&&t===(r?1:0))?Tt:Ft}function nt(e,t,n){return!e.collapsed&&st.hHF_(this)&&t===n-1?Ot:Mt}n(2);var rt,ot,it,at=n(7).Event,ut=n(8),ct=n(10),lt=n(11),st=n(12),ft=n(13),dt=n(14),pt=n(15),ht=n(16),gt=n(17),vt=n(19),mt=100,_t=40,yt=16,Ct={},bt="pinnedLeftColumnHeader",St="pinnedRightColumnHeader",wt="columnHeader",It="rowHeader",xt="viewport",At="pinnedLeftViewport",Et="pinnedRightViewport",Rt="groupingPanel",Nt="toolPanel",Dt="groupHeader",Ft="groupFooter",Tt="groupContent",Mt="nodeContent",Ot="nodeFooter",Lt="groupDescriptor",Pt="header",Gt="visible",Bt="location",kt="top",Ut="bottom",Ht="footer",Vt=["pageX","pageY","clientX","clientY","target"],jt=n(20),Wt=n(22),zt=n(24),Yt=n(33);Yt&&Yt.vd&&(it=function(){var e=this;return Yt.vd({lic:function(e){return GC&&GC.Spread&&GC.Spread.Views&&GC.Spread.Views[e]},rs:function(e){return s()[e]}},function(t){var n=t[Xt[1]];t[Xt[2]]?t[Xt[3]]&&u[Xt[0]](e,n):(setTimeout(e[Xt[4]].bind(e),200),setTimeout(m.bind(e,n),200))})}),window&&"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(e,t){var n;return t=t||{bubbles:!1,cancelable:!1,detail:void 0},n=document.createEvent("CustomEvent"),n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n});var qt=function Kt(e,n,r,i){if(!e)throw new Error("GcGrid need a valid DOM container to host");var a=this,u=Math.round(1e6*Math.random());a.uid="gc-"+u,Ct[u]=a,a.dataSource_=n,a.container=e;var c=r&&r.name,l=r;lt.isNil(i)&&c&&lt.isString(c)&&c.length>6&&"layout"===c.slice(-6).toLowerCase()&&(i=r,l=null);var s,f;l&&!lt.isUndefined(l.version)?(s=lt.deserializeObject(l),a.userColumns_=ut.cloneDeep(s.columns),f=a.initColumn_(s.columns,n)):(a.userColumns_=ut.cloneDeep(l),f=a.initColumn_(l,n)),a.uCT_(f,n),a.editing=new at,a.selectionChanged=new at,a.focusChanged=new at,a.grouping=new at,a.rowClick=new at,a.rowDbClick=new at,a.columnReorder=new at,a.columnChanged=new at,a.onMouseClick_=new at,a.omd_=new at,a.omdc_=new at,a.omu_=new at,a.omm_=new at,a.omw_=new at,a.okd_=new at,a.otos_=new at,a.otm_=new at,a.ote_=new at,a.osp_=new at,a.ots_=new at,a.oso_=new at,a.ods_=new at,a.beforeLoadRange=new at,a.or_=new at,s?a.layoutEngine=A(s.layoutEngine):a.layoutEngine=i,a.layoutEngine.grid=a,a.options=Me(a).options;var d=a.options,p=d.rowTemplate;Object.defineProperty(d,"rowTemplate",{get:function(){return p},set:function(e){p!==e&&(p=e,Me(a).tcFn_())},enumerable:!0,configurable:!0});var h=d.pinnedLeftRowTemplate;Object.defineProperty(d,"pinnedLeftRowTemplate",{get:function(){return h},set:function(e){h!==e&&(h=e,Me(a).tcFn_())},enumerable:!0,configurable:!0});var g=d.pinnedRightRowTemplate;Object.defineProperty(d,"pinnedRightRowTemplate",{get:function(){return g},set:function(e){g!==e&&(g=e,Me(a).tcFn_())},enumerable:!0,configurable:!0});var v=d.groupStrategy;Object.defineProperty(d,"groupStrategy",{get:function(){return v},set:function(e){v!==e&&(v=e,He.call(a),Ue.call(a),a.scrollOffset=a.gISO_())},enumerable:!0,configurable:!0}),Object.defineProperty(a,"columns",{get:function(){return f},set:function(e){var t=a.data.sourceCollection,n=Me(a);f=a.initColumn_(e,t),a.data.setSource_(null,null,ut.map(f,function(e){return{name:e.id,field:e.dataField,caption:e.caption,dataType:e.dataType}})),a.uCT_(f,t),n.iC_(),n.uCW_&&n.uCW_()},enumerable:!0,configurable:!0}),a.cF_={},a._cDic={},lt.isNil(Kt)||(a.ExcelFormatter_=GC&&GC.Spread&&GC.Spread.Formatter&&GC.Spread.Formatter.GeneralFormatter),ut.each(a.columns,function(e){if(e&&e.format){var t=e.format,n=e.id.toLowerCase();lt.isString(t)&&a.ExcelFormatter_?a.cF_[n]=new a.ExcelFormatter_(t):lt.isFunction(t)&&(a.cF_[n]=t)}}),o.call(a,f),(a.options.allowGrouping||a.data.groups)&&(a.gI_=[]),a.mC_(a.options);var m=d.filtering,_=d.sorting,y=d.grouping,C=t.call(a,d.hierarchy)?d.hierarchy:null;Object.defineProperties(d,{filtering:{get:function(){return m},set:function(e){a.data.filterDescriptors=m=e},enumerable:!0,configurable:!0},sorting:{get:function(){return _},set:function(e){a.data.sortDescriptors=_=e},enumerable:!0,configurable:!0},grouping:{get:function(){return y},set:function(e){a.data.groupDescriptors=y=e},enumerable:!0,configurable:!0},hierarchy:{get:function(){return C},set:function(e){e=t.call(a,e)?e:null,a.data.hierarchyDescriptor=C=e},enumerable:!0,configurable:!0}}),Ve.call(a),a.init_(),a.cFn_=Ce.bind(a),a.dcFn_=be.bind(a),a.mdFn_=we.bind(a),a.mvFn_=Ae.bind(a),a.muFn_=Se.bind(a),a.kdFn_=Ee.bind(a),a.dkdFn_=Re.bind(a),a.wFn_=Ie.bind(a),a.sFn_=De.bind(a),a.wzFn_=Ne.bind(a),a.tsFn_=J.bind(a),a.tmFn_=Z.bind(a),a.teFn_=Q.bind(a),a.imFn_=te.bind(a),a.czFn_=O.bind(a),a.dmwFn_=ut.debounce(a.czFn_,200),a.soFn_=Oe.bind(a),a.dsoFn_=ut.debounce(a.soFn_,200),a.dsFn_=Te.bind(a),a.fiFn_=F.bind(a),a.isTouchMode=window.PointerEvent||window.MSPointerEvent||"ontouchstart"in document.documentElement,a.scrollOffset=a.gISO_(),a.scE_=[],a.lRR_={},G.call(a),k.call(a),N.call(a)};qt.prototype={init_:function(){var e=this;gt.init(e),e.editingHandler=gt;var t=Me(e);t.init_(e),He.call(e),(e.options.allowGrouping||e.data.groups)&&e.uGI_();var n,r,o;e.columnActions_={};var i=b.bind(e);for(n=0,r=e.columns.length;r>n;n++)o=e.columns[n],o.action&&(e.columnActions_[o.id]=ut.map(lt.isArray(o.action)?o.action:[o.action],i));t.uCW_&&t.uCW_(),t.iGaC_&&t.iGaC_(),GC&&GC.Spread&&GC.Spread.Commands&&GC.Spread.Commands.CommandManager&&(e.commandManger_=new GC.Spread.Commands.CommandManager(e)),t.iCa_&&t.iCa_()},initColumn_:function(e,t){var n=this;ut.isArray(t)||(t=null),e=ut.cloneDeep(e),n.cC_=e;var r;r=e?n.fC_(e):ut.map(ut.keys(t&&t[0]||[]),function(e){return{id:e,caption:lt.caC(e),dataField:e}});var o,i,a,u,c,l,s,f={},d=function(e,t){return function(n){return n[e].toLowerCase()===t.toLowerCase()}};for(o=0,i=r.length;i>o;o++)if(a=r[o].id,u=a.toLowerCase(),f.hasOwnProperty(u)){for(c=a+"_1",s=2;ut.find(r,d("id",c));)c=a+"_"+s,++s;r[o].id=c,f[c.toLowerCase()]=1}else f[u]=1;f=null;var h=[];C(t&&t[0]||[],[],h);var g,m;return ut.each(h,function(e){if(!p(r,e)){for(m=e.join("_"),l=m,s=1;ut.find(r,d("id",l));)l=m+"_"+s,++s;g={id:l,caption:lt.caC(l),dataField:e.join("."),visible:!1,width:80},r.push(g),n.cC_&&n.cC_.push(g)}}),e?(n.colTree_={},v(e,null,n.colTree_)):n.cC_=r,r},mC_:function(e){var t=this;t.data.context_=t.context_=new dt(e,[{Constructor:qt,instance:t},{Constructor:zt,instance:t.data}],[pt,ht,lt.findPlugin("paging")]),E(t.or_,t,{})},formatDataItem:function(e){return this.formatDataItemInternal_(e,!1)},formatDataItemInternal_:function(e,t){for(var n=this,r={},o=function(t,r){if(ut.isNil(t))return r;ut.isString(t)&&(t=t.trim());var o=n.cF_[t.toLowerCase()];if(o){if(n.ExcelFormatter_&&o instanceof n.ExcelFormatter_)return o.format(r);if(lt.isFunction(o))return o({colId:t,value:r,data:e.dataItem})}return r},i=0,a=n.columns.length;a>i;i++){var u=n.columns[i];if(u){var c=u.id,l=u.dataField;if(lt.isString(l)){var s=e[c];if(ut.isArray(s)){for(var f=l.split(","),d=[],p=0,h=s.length;h>p;++p)d[p]=o(f.length>1?f[p]:l,s[p]);r[c]=d}else{if("date"===u.dataType&&ut.isString(s)){var g=new Date(s);isNaN(g.getTime())||(s=g)}r[c]=o(c,s)}t&&ut.isFunction(u.cssClass)&&(r[c+"_cssClass"]=u.cssClass({colId:c,value:s,data:e.dataItem}))}}}return e.node&&(r.node=e.node),r},getItem:function(e){var t=this;if(ut.isNil(e))return null;var n=ut.isArray(e)?e:[e],r=ut.map(n,function(e){return Ke.call(t,e)});return 0===r.length?null:1===r.length?r[0]:r},getLayoutInfo:function(){return Me(this).gLI_()},getRenderInfo:function(e){if(lt.isNilOrWhiteSpace(e.area))return null;var t,n=e.area,r=this;return ut.isNil(e.offsetTop)&&(t=t||r.gSO_(n),e.offsetTop=t.top),ut.isNil(e.offsetLeft)&&(t=t||r.gSO_(n),e.offsetLeft=t.left),Me(r).gRI_(e)},hitTest:function(e){return Me(this).hT_(e)},getCachedBatchActions:function(){var e=this,t=e.context_.getInstance("dataLoader");return t.hasCachedActions()?ut.map(t.getHeldActions_(),function(e){return ut.pick(e,["type","dataItem"])}):null},saveBatchEdit:function(e){var t=this,n=t.context_.getInstance("dataLoader");n.batchEdit(function(){t.invalidate(),e&&e()})},cancelBatchEdit:function(){var e=this.context_.getInstance("dataLoader");e.rollbackBatch(),this.invalidate()},showLoadingOverlay:function(){var e=this.context_.getInstance("containerWrapper");e.showLoadingOverlay()},hideLoadingOverlay:function(){var e=this.context_.getInstance("containerWrapper");e.hideLoadingOverlay()},sSP_:function(e){return Me(this).sSP_(e)},iSA_:function(e){return Me(this).iSA_(e)},gSPRI_:function(e){return Me(this).gSPRI_(e)},gISO_:function(){var e=Me(this);return e.gISO_?e.gISO_():{viewport:{top:0,left:0}}},gSI_:function(e){var t=Me(this);return t.gSI_?t.gSI_(e):{area:xt,verticalScrollArea:[xt,It],horizontalScrollArea:[xt,wt],verticalScrollPanel:[xt],horizontalScrollPanel:[xt],verticalScrollOffset:[xt],horizontalScrollOffset:[xt],layoutInfo:t.gLI_()[xt]}},gSA_:function(e){var t=Me(this);return t.gSA_?t.gSA_(e):e!==Nt?xt:e},gSO_:function(e){var t=this;return t.scrollOffset&&t.scrollOffset[t.gSA_(e)]||{top:0,left:0}},sSO_:function(e,t){var n=this,r=n.gSI_(e),o=!1;if(r){if(t&&lt.isNumber(t.left)){var i=r.horizontalScrollOffset;ut.each(i,function(e){n.scrollOffset[e]&&n.scrollOffset[e]!==t.left&&(o=!0,n.scrollOffset[e].left=t.left)})}if(t&&lt.isNumber(t.top)){var a=r.verticalScrollOffset;ut.each(a,function(e){n.scrollOffset[e]&&n.scrollOffset[e]!==t.top&&(o=!0,n.scrollOffset[e].top=t.top)})}}return o},saSO_:function(e){var t=this,n=t.gSA_(e),r=t.scrollOffset&&t.scrollOffset[n],o=t.gSI_(n);if(o){var i=o.layoutInfo,a=void 0,u=void 0;i&&(a=Math.max(0,i.contentHeight-i.height),u=Math.max(0,i.contentWidth-i.width)),r&&(r.top=Ye(r.top,0,a),r.left=Ye(r.left,0,u))}return r},gSPO_:function(e){var t=this,n=t.gSI_(e);if(n){var r=lt.isArray(n.verticalScrollPanel)?n.verticalScrollPanel[0]:n.verticalScrollPanel,o=lt.isArray(n.horizontalScrollPanel)?n.horizontalScrollPanel[0]:n.horizontalScrollPanel;return r=ve.call(t,r,!0),o=ve.call(t,o,!1),{top:r&&r.scrollTop,left:o&&We.call(t,o)}}},sSPO_:function(e,t,n){var r=this,o=r.gSI_(e),i=!1;return o&&(t&&lt.isNumber(t.left)&&ut.each(o.horizontalScrollPanel,function(e){var n=ve.call(r,e,!1);n&&We.call(r,n)!==t.left&&(i=!0,ze.call(r,n,t.left))}),t&&lt.isNumber(t.top)&&ut.each(o.verticalScrollPanel,function(e){var n=ve.call(r,e,!0);n&&n.scrollTop!==t.top&&(i=!0,n.scrollTop=t.top)})),n&&(r.preventTriggerScrolling_=!!i),i},sA_:function(e,t,n,r){var o=this,i=o.getLayoutInfo()[e];n=ut.isFunction(n)?n:function(){return 0};var a=function(e,t,r){return t>e?n(e-t):e>r?r+n(e-r):e},u={};t&&(ut.isNaN(+t.left)||(u.left=a(t.left,0,Math.max(0,i.contentWidth-i.width))),ut.isNaN(+t.top)||(u.top=a(t.top,0,Math.max(0,i.contentHeight-i.height)))),o.sSO_(e,u),o.sSPO_(e,u,!0),r.call(o,u)},destroy:function(){var e=this,t=e.container,n=Me(e);L.call(this),gt.destroy(e),n&&(n.d_(),n=null);var r=document.getElementById(e.uid);r&&t.removeChild(r),t.removeAttribute("tabIndex"),ct.removeClass(t,"no-focus"),delete Ct[e.uid.slice(3)],e.columnActions_=null},uGI_:function(){var e=this,t=e.data,n=t.groups;if(null===n)e.gI_=null;else{var r,o;e.gI_=e.gI_||[];var i=[];if(n&&n.length>0){for(r=0,o=t.groups.length;o>r;r++)i.push(R.call(this,t.groups[r],[r]));e.gI_=i,Me(e).iGIH_()}}},uT_:function(){Me(this).cRC_()},invalidate:function(e){this.iI_(e)},iI_:function(e,t){var n=this;n._cDic={};var r=n.uid,o=Me(n),i=n.options;if(i.showToolPanel){var a="#"+n.uid+"-toolPanel .column-list",u="#"+n.uid+"-toolPanel .group-list",c=n.container.querySelector(a);if(c)var l=c.scrollTop;var s=n.container.querySelector(u);if(s)var f=s.scrollTop}gt.isEditing_&&gt.unMountEditors(n,!1,!0);var d=n.context_.getInstance("containerWrapper");d&&d.updateContainer(),n.scS_=null,o.cRC_(),n.uGI_(),o.uCW_&&o.uCW_(),n.container.contains(document.activeElement)&&(n.focusElement_=document.activeElement),lt.isNil(e)&&(e=!0),e=!!e;var p=[],h=[];ut.each(n.container.querySelector(".gc-grid-container").children,function(e){h.push(e.id)});var v,m=!1,_=n.getLayoutInfo();ut.each(ut.keys(_),function(e){return v=r+"-"+e,p.push(v),-1===h.indexOf(v)?(m=!0,!1):void(n.sSP_(e)&&(p.push(v+"-scroll-vertical"),p.push(v+"-scroll-hoizontal")))});var y=!1;if(ut.each(h,function(e){return-1===p.indexOf(e)?(y=!0,!1):void 0}),n.spContainerCache_=null,e||!m&&!y||(e=!0),e)n.lRR_={},P.call(n),G.call(n),ut.each(n.scrollOffset,function(e,t){var r=n.gSO_(t);n.sSPO_(t,r,!0)}),X.call(this);else{n.rSB_(!0);var C,b,S,w;ut.keys(_).map(function(e){w=t&&t.keepScrollOffset,w||n.saSO_(e);var o=n.gSO_(e);b=n.getRenderInfo({area:e,offsetTop:o.top,offsetLeft:o.left,includeRows:!1}),b&&(S=r+"-"+e,C=document.getElementById(S),C.style.cssText=lt.cMFS(b.outerDivStyle),S+="-inner",C=document.getElementById(S),C&&(C.style.cssText=lt.cMFS(b.innerDivStyle)),"gantt"===e&&B.call(n))}),ut.keys(_).map(function(e){n.refresh(e)})}i.showToolPanel&&(c=n.container.querySelector(a),c&&l&&(c.scrollTop=l),s=n.container.querySelector(u),s&&f&&(s.scrollTop=f)),g.call(n),U.call(n),$e.call(n),t&&t.clearTouchCache&&fe.call(n)},getRowId:function(e){if(!e)return null;var t=this,n=e.groupInfo,r=n?n.row:e.row;return st.createID(t.uid,e.area,r,n,e.nodeInfo)},getRowInfoFromId:function(e){return e?st.parseID(e):null},refresh:function(e){var t,n,r,o=this,a=o.gSO_(e),u=Me(o),c=document.getElementById(o.uid+"-"+e+"-inner");if(c){if(e===Rt||e===Nt){var l=o.getRenderInfo({area:e,offsetTop:a.top,offsetLeft:a.left}),s="";return ut.each(l.renderedRows||[],function(e){s+=o.rR_(e)}),void(c.innerHTML=s)}var f=u.gRR_({area:e,offsetTop:a.top,offsetLeft:a.left});if(f){w.call(o,c,f.left,f.top),t=f.renderedRows||[];var p=o.lRR_[e],h=ut.map(t,ut.property("key")),g=Le(p,h),v=!1;e!==xt&&e!==At&&e!==Et&&e!==It||(ut.each(c.children,function(e){e.id=e.id+"_old"}),p=ut.map(p,function(e){return e+"_old"}),v=!0);var m,_,y,C,b=document.createElement("div"),I=H.call(o,e);for(n=0,r=g.length;r>n;n++)switch(y=g[n],y.operation){case"insert":_=S(t,y.item),m=u.gRRI_(_,e),b.innerHTML=o.rR_(m),c.appendChild(b.childNodes[0]),d.call(o,_.key,I);break;case"delete":_=p[y.index],c.removeChild(document.getElementById(_));break;case"update":C=p[y.index],_=S(t,v?C.slice(0,-4):C),m=u.gRRI_(_,e),b.innerHTML=o.rR_(m);var x=document.getElementById(C),A=b.childNodes[0];e===wt||e===bt||e===St?ct.hasClass(A,"gc-header-row")?(u.iRC_&&(i(o.columns,x,A),c.replaceChild(A,x)),o.refreshHeaderRowDynamicContent_()):c.replaceChild(A,x):(c.replaceChild(A,x),d.call(o,_.key,I));break;case"replace":var E=p[y.index[0]],R=S(t,h[y.index[1]]);m=u.gRRI_(R,e),b.innerHTML=o.rR_(m),c.replaceChild(b.childNodes[0],document.getElementById(E)),d.call(o,m.key,I)}o.lRR_[e]=h,b=null}"gantt"===e&&B.call(o)}},sRP_:function(e){var t,n,r,o,i=this,a=Me(i),u=i.gSO_(e);if(u&&(o=a.gRR_({area:e,offsetTop:u.top,offsetLeft:u.left})),o){var c=document.getElementById(i.uid+"-"+e+"-inner");w.call(i,c,o.left,o.top),t=o.renderedRows||[];var l,s,f,d,p=i.lRR_[e],h=ut.map(t,ut.property("key")),g=ut.some(i.data.groupDescriptors,ut.property("header.fixed")),v=g?Ge.call(i,p,h):Pe.call(i,p,h),m=document.createElement("div"),_=i.scrollElementArea_,y=i.scrollElementId_;for(n=0,r=v.length;r>n;n++)switch(d=v[n],f=null,d.operation){case"insert":s=S(t,d.index),l=a.gRRI_(s,e),e===_&&y&&d.index===y?(f=document.getElementById(y),f.style.top=l.top+"px",f.style.left=l.left+"px"):(m.innerHTML=i.rR_(l),c.appendChild(m.childNodes[0]));break;case"delete":if(s=d.index,e===_&&y&&s===y){h.indexOf(s)<0&&h.push(s);break}c.removeChild(document.getElementById(s));break;case"replace":var C=d.index[0],b=S(t,d.index[1]);l=a.gRRI_(b,e),e===_&&y&&y===d.index[1]&&!Be(i)?(f=document.getElementById(y),f.style.top=l.top+"px",f.style.left=l.left+"px",c.replaceChild(f,document.getElementById(C))):(m.innerHTML=i.rR_(l),c.replaceChild(m.childNodes[0],document.getElementById(C)))}i.lRR_[e]=h,m=null,$e.call(i)}},reR_:function(e){var t=this,n=e.groupInfo,r=e.nodeInfo,o=n?t.gGI_(n.path):null,i=n?n.row:e.row,a=document.getElementById(t.uid+"-"+e.area+"-inner"),u=st.createID(t.uid,e.area,i,n,r),c=Me(t);if(a){var l=c.gReRI_(u,i,e.area,o&&o.path);if(l){var s=l.layout?l.layout:l,f=s.oldHeight>0?s.height-s.oldHeight:0,p=document.getElementById(u);p&&c.uR_(a,p,l,e.area,f);var h=H.call(t,e.area);d.call(t,u,h),0!==f&&this.rSB_(!1,f)}}},rSB_:function(e,t){var n=this,r=Me(n);if(r.rSB_)return void r.rSB_(e);e&&r.cLC_&&r.cLC_();var o=n.getLayoutInfo();t&&ut.keys(o).map(function(e){if(n.sSP_(e)){var r=o[e];r.hasOwnProperty("contentHeight")&&(r.contentHeight+=t)}});var i,a,u,c,l=[];ut.keys(o).map(function(e){c=n.uid+"-"+e+"-scroll",l.length=0,ut.each(n.scE_,function(e){0===e.indexOf(c)&&l.push(e)}),n.sSP_(e)?(a=n.gSPRI_(e),ut.each(a,function(e){if(e)if(u=c+(e.isVertical?"-vertical":"-horizontal"),i=document.getElementById(u))i.style.cssText=lt.cMFS(e.outerDivStyle),i.childNodes.length>0&&(i.childNodes[0].style.cssText=lt.cMFS(e.innerDivStyle)),l.splice(l.indexOf(u),1);else{var t=u,r='<div id="'+t+'" class="'+e.outerDivCssClass+'"';e.outerDivCssClass&&(r+=' style="'+lt.cMFS(e.outerDivStyle)+'"'),r+="><div",e.innerDivStyle&&(r+=' style="'+lt.cMFS(e.innerDivStyle)+'"'),r+="></div></div>";var o=ct.createElement(r),a=document.querySelector("#"+n.uid+" .gc-grid-container");a.appendChild(o),n.scE_.push(t),lt.regist(document.getElementById(t),"scroll",n.sFn_)}})):(a=n.gSPRI_(e),ut.each(a,function(e){u=c+(e.isVertical?"-vertical":"horizontal"),i=document.getElementById(u),i&&(i.style.cssText=lt.cMFS(e.outerDivStyle),i.childNodes.length>0&&(i.childNodes[0].style.cssText=lt.cMFS(e.innerDivStyle)))})),ut.each(l,function(e){var t=document.getElementById(e);t&&(lt.unRegist(t,"scroll",n.sFn_),t.parentNode.removeChild(t),n.scE_.splice(n.scE_.indexOf(e),1))})})},gRT_:function(){return this.layoutEngine.gRT_()},toJSON:function(){var e=this,t=Me(e),n={};n.version="v"+vt,n.layoutEngine=t.toJSON_();var r=t.gCD_(),o=lt.serializeObject(e.cC_),i=["dataType","format","caption","visibleWidth"],a=o;if(e.userColumns_){e.userColumns_=e.fC_(e.userColumns_);var u=ut.map(e.userColumns_,ut.property("id"));o=Xe(o,u);var c=ut.some(o,"columns");c&&(a=qe(o))}var l;ut.each(a,function(t){l=ut.find(e.userColumns_,function(e){return e.id===t.id}),ut.each(i,function(e){l&&!lt.isUndefined(l[e])||delete t[e]}),ut.each(r,function(e,n){t[n]===e&&delete t[n]})}),n.columns=o;var s=n.layoutEngine.options,f=e.data,d={};return f.filterDescriptors&&f.filterDescriptors.length?d.filtering=f.filterDescriptors:s&&s.filtering&&(d.filtering=null),f.sortDescriptors&&f.sortDescriptors.length?d.sorting=lt.serializeObject(f.sortDescriptors):s&&s.sorting&&(d.sorting=[]),f.groupDescriptors&&f.groupDescriptors.length?d.grouping=lt.serializeObject(f.groupDescriptors):s&&s.grouping&&(d.grouping=[]),ut.isEmpty(d)||(n.layoutEngine.options=ut.assign(n.layoutEngine.options,d)),n},gCI_:function(){var e=this.context_.getInstance("containerWrapper");return e&&e.getContainerSize()},gGI_:function(e){var t,n,r=this.gI_,o=r[e[0]];for(t=1,n=e.length;n>t;t++){if(!o||!o.children)return null;o=o.children[e[t]]}return o},getActionInfo_:function(e,t,n){var r,o=this,i=o.columnActions_[e];if(i){var a,u;for(a=0,u=i.length;u>a;a++){if(r=i[a],r.name===t&&n&&r[n])return r[n];if(r.name===t&&!n)return r}}return r=je.call(o,t),r&&n?r[n]:r},startEditing:function(e,t){var n,r=this;if(lt.isNil(e)){var o=Me(r);n=o&&o.hTI_}else{var i,a;if(lt.isNumber(e)){a=e;var u=st.getRowIDByViewIndex(r,e,[xt]);i=u&&u[0]&&u[0].id}else a=st.vi(r,e),i=e;var c=r.getItem(a),l=c?c.isNewRow?-1:c.row:-1;if(n=st.parseID(i)){var s=n.groupInfo;s?(s.row=l,s.column=t):(n.row=l,n.column=t)}}n&&gt.startEditing(r,n,!0)},stopEditing:function(){gt.stopEditing(this,null,!0)},cancelEditing:function(){gt.unMountEditors(this)},getSelections:function(){var e=this,t=Me(e);return t&&t.gSe_?t.gSe_():[]},clearSelection:function(){var e=Me(this);e&&e.clearSelection_&&e.clearSelection_()},setSelections:function(e,t){var n=Me(this);n&&n.clearSelection_&&n.setSelections_(e,t)},rR_:function(e){var t=e.renderInfo,n="<div"+(e.key?' id="'+e.key+'"':"")+(e.isRowRole?' role="row"':"");return t.style&&(n+=' style="'+lt.cMFS(t.style)+'"'),t.cssClass&&(n+=' class="'+t.cssClass+'"'),n+=">",t.renderedHTML&&(n+=t.renderedHTML),n+="</div>"},gCBI_:function(e,t,n){var r=this,o=r.columns,i=r._cDic,a=i[e];if(null!=a)return a;var u=ut.find(o,lt.mP("id",e,t));return u&&(i[e]=u),n?u||ut.find(o,lt.mP("caption",e,t)):u},iCV_:function(e,t){var n=e.pinned||"none";if(!e.visible||n!==t)return!1;var r,o=this,i=o.colTree_,a=0,u=0;if(i){var c=i[e.id]&&i[e.id].parent,l=i[c];if(l&&(ut.each(i,function(e,l){r=e.isCol?o.gCBI_(l):null,n=r?r.pinned||"none":null,r&&n===t&&e.parent===c?(a++,"expanded"===r.headerGroupShow&&u++):i[l].parent===c&&a++}),a!==u&&u)){var s="left"===t?l.pinnedStatus:"right"===t?l.pinnedRightStatus:l.status;if(s.isCollapsed&&"expanded"===e.headerGroupShow||!s.isCollapsed&&"collapsed"===e.headerGroupShow)return!1}}return!0},fC_:function(e){var t=this,n=[];return ut.each(e,function(e){e.hasOwnProperty("dataField")||e.hasOwnProperty("action")||e.hasOwnProperty("asyncRender")||e.hasOwnProperty("ganttColumn")?n.push(e):e.hasOwnProperty("columns")&&(n=n.concat(t.fC_(e.columns)))}),n},inC_:function(e){var t,n,r,o,i=this,a=Me(i);lt.isArray(e)||(e=[e]);var u={},c={},l=i.data&&i.data.sourceCollection;l&&l.length>=1&&(u=l[0]),l&&l.length>=2&&(c=l[1]);var s=function(e){if(e.visibleWidth=e.width,!e.dataType&&e.dataField&&(e.dataType=lt.getType(u[e.dataField]||c[e.dataField])),e.format&&e.id){var t=e.id.toLowerCase(),n=e.format;lt.isString(n)&&i.ExcelFormatter_?i.cF_[t]=new i.ExcelFormatter_(n):lt.isFunction(n)&&(i.cF_[t]=n)}e.action&&(i.columnActions_[e.id]=ut.map(lt.isArray(e.action)?e.action:[e.action],function(e){return b.call(i,e)})),ut.startsWith(ut.trim(e.dataField),"=")?i.data.addCalculatedColumn(r.id,e.dataField):i.data.addDataColumn(r.id,e.dataField),i.columns.push(e)};for(i.data.suspendRefresh(),t=0,n=e.length;n>t;t++)r=e[t],r.columns?(o=[],h.call(i,r.columns,o)):o=[ut.defaults(r,{id:r.dataField,caption:r.dataField,pinned:"none",width:"*",visible:!0})],ut.each(o,s),i.cC_.push(r);i.data.resumeRefresh(),i.colTree_&&(i.colTree_={},v(i.cC_,null,i.colTree_)),a.uSS_&&a.uSS_(),i.invalidate()},refreshHeaderRowDynamicContent_:function(){var e,t,n=this,r=n.options.headerRow,o=document.querySelectorAll("#"+n.uid+" .gc-header-row-cell .gc-header-row-sparkline");ut.each(o,function(r){e=r.getAttribute("data-formula"),t=n.data.evaluate(e),t&&r&&t.paint(r)});var i=!1;return r.separateColumn?ut.each(n.columns,function(e){i=f(e.headerRow&&e.headerRow.renderer||r&&r.renderer,"#"+n.uid+' .gc-header-row [data-column="'+e.id+'"]',n.data)||i}):i=f(r&&r.renderer,"#"+n.uid+"-columnHeader .gc-header-row .gc-header-row-cell",n.data)||i,i},uCT_:function(e,t){var n,r;if(t.length){var o={},i={};if(t&&t.length>=1&&(o=t[0]),t&&t.length>=2&&(i=t[1]),o){var a,u=e;for(n=0,r=u.length;r>n;n++)a=u[n],!a.dataType&&a.dataField&&(a.dataType=lt.getType(lt.sOP(o,a.dataField)||lt.sOP(i,a.dataField))),"date"!==a.dataType||a.format||(a.format="mm/dd/yyyy")}}}};var Xt=["call","ct","ps","swm","destroy"],$t=["","6261636b67726f756e643a20626c61636b3b636f6c6f723a2077686974653b666f6e742d73697a653a20313470783b70616464696e673a203570783b6865696768743a20313030253b"];qt.getControlByElement=function(e){if(e){var t=e.querySelector('[role="grid"]');if(t){var n=t.id;if("gc-"===n.slice(0,3)&&n.length>3&&!isNaN(n.slice(3)))return Ct[+n.slice(3)]}}return null},ut.extend(qt.prototype,{metaData_:{cid:"dataView",className:"DataView"}}),qt.CalcCommon=jt,qt.DataManager=zt,qt.Functions=Wt,e.exports={DataView:qt}}()},,function(e,t){},,,,,function(e,t){"use strict";!function(){var t=function(){function e(e,t,n){this.handler=e,this.self=t,this.priority=n}return e}(),n=function(){function e(){this._handlers=[]}return e.prototype.addHandler=function(e,n){var r=arguments.length<=2||void 0===arguments[2]?1:arguments[2];this._handlers.push(new t(e,n,r)),this.sortHandlers()},e.prototype.removeHandler=function(e,t){for(var n=0;n<this._handlers.length;n++){var r=this._handlers[n];if(r.handler===e&&r.self===t){this._handlers.splice(n,1);break}}},e.prototype.sortHandlers=function(){this._handlers.sort(function(e,t){var n=e.priority,r=t.priority;return r>n?1:n>r?-1:0})},e.prototype.removeHandlersByPriority=function(e){for(var t=null,n=null,r=0;r<this._handlers.length;r++){var o=this._handlers[r];if(o.priority===e)null==t?t=r:n=r;else if(null!=t)break}null!=t&&null!=n&&this._handlers.splice(t,n-t+1)},e.prototype.removeAllHandlers=function(){this._handlers.length=0},e.prototype.raise=function(e,t){var n=!1,r=function(){n=!0};null==t?t={stopPropagation:r}:t.stopPropagation=r;for(var o=this._handlers.length,i=this._handlers.slice(0,o),a=0;o>a&&!n;a++){var u=i[a];u.handler.call(u.self,e,t)}},Object.defineProperty(e.prototype,"hasHandlers",{get:function(){return this._handlers.length>0},enumerable:!0,configurable:!0}),e}();e.exports={Event:n,EventHandler:t}}()},function(e,t,n){(function(e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};(function(){function o(e,t){return e.set(t[0],t[1]),e}function i(e,t){return e.add(t),e}function a(e,t,n){var r=n.length;switch(r){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function u(e,t){for(var n=-1,r=e?e.length:0;++n<r&&t(e[n],n,e)!==!1;);return e}function c(e,t){for(var n=e?e.length:0;n--&&t(e[n],n,e)!==!1;);return e}function l(e,t){for(var n=-1,r=e?e.length:0;++n<r;)if(!t(e[n],n,e))return!1;return!0}function s(e,t){for(var n=-1,r=e?e.length:0,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i}function f(e,t){var n=e?e.length:0;return!!n&&_(e,t,0)>-1}function d(e,t,n){for(var r=-1,o=e?e.length:0;++r<o;)if(n(t,e[r]))return!0;return!1}function p(e,t){for(var n=-1,r=e?e.length:0,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}function h(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function g(e,t,n,r){var o=-1,i=e?e.length:0;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}function v(e,t){for(var n=-1,r=e?e.length:0;++n<r;)if(t(e[n],n,e))return!0;return!1}function m(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}function _(e,t,n){if(t!==t)return D(e,n);for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}function y(e,t,n,r,o){return o(e,function(e,o,i){n=r?(r=!1,e):t(n,e,o,i)}),n}function C(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function b(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function S(e){return function(t){return e(t)}}function w(e,t){return p(t,function(t){return e[t]})}function I(e,t){return e.has(t)}function x(e,t){for(var n=-1,r=e.length;++n<r&&_(t,e[n],0)>-1;);return n}function A(e,t){for(var n=e.length;n--&&_(t,e[n],0)>-1;);return n}function E(e){return e&&e.Object===Object?e:null}function R(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&r++;return r}function N(e,t){return null==e?Hr:e[t]}function D(e,t,n){for(var r=e.length,o=t+(n?1:-1);n?o--:++o<r;){var i=e[o];if(i!==i)return o}return-1}function F(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}function T(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}function M(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function O(e,t){for(var n=-1,r=e.length,o=0,i=[];++n<r;){var a=e[n];a!==t&&a!==Yr||(e[n]=Yr,i[o++]=n)}return i}function L(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function P(e){return e.match(mi)}function G(){}function B(){}function k(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=fo,this.__views__=[]}function U(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function H(){this.__data__=oa?oa(null):{}}function V(e){return this.has(e)&&delete this.__data__[e]}function j(e){var t=this.__data__;if(oa){var n=t[e];return n===zr?Hr:n}return Mi.call(t,e)?t[e]:Hr}function W(e){var t=this.__data__;return oa?t[e]!==Hr:Mi.call(t,e)}function z(e,t){var n=this.__data__;return n[e]=oa&&t===Hr?zr:t,this}function Y(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){
var r=e[t];this.set(r[0],r[1])}}function q(){this.__data__=[]}function X(e){var t=this.__data__,n=ve(t,e);if(0>n)return!1;var r=t.length-1;return n==r?t.pop():Yi.call(t,n,1),!0}function $(e){var t=this.__data__,n=ve(t,e);return 0>n?Hr:t[n][1]}function K(e){return ve(this.__data__,e)>-1}function J(e,t){var n=this.__data__,r=ve(n,e);return 0>r?n.push([e,t]):n[r][1]=t,this}function Z(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Q(){this.__data__={hash:new U,map:new(ea||Y),string:new U}}function ee(e){return zt(this,e)["delete"](e)}function te(e){return zt(this,e).get(e)}function ne(e){return zt(this,e).has(e)}function re(e,t){return zt(this,e).set(e,t),this}function oe(e){var t=-1,n=e?e.length:0;for(this.__data__=new Z;++t<n;)this.add(e[t])}function ie(e){return this.__data__.set(e,zr),this}function ae(e){return this.__data__.has(e)}function ue(e){this.__data__=new Y(e)}function ce(){this.__data__=new Y}function le(e){return this.__data__["delete"](e)}function se(e){return this.__data__.get(e)}function fe(e){return this.__data__.has(e)}function de(e,t){var n=this.__data__;return n instanceof Y&&n.__data__.length==jr&&(n=this.__data__=new Z(n.__data__)),n.set(e,t),this}function pe(e,t,n,r){return e===Hr||Xn(e,Ni[n])&&!Mi.call(r,n)?t:e}function he(e,t,n){(n===Hr||Xn(e[t],n))&&("number"!=typeof t||n!==Hr||t in e)||(e[t]=n)}function ge(e,t,n){var r=e[t];Mi.call(e,t)&&Xn(r,n)&&(n!==Hr||t in e)||(e[t]=n)}function ve(e,t){for(var n=e.length;n--;)if(Xn(e[n][0],t))return n;return-1}function me(e,t){return e&&It(t,Ir(t),e)}function _e(e,t){for(var n=-1,r=null==e,o=t.length,i=Array(o);++n<o;)i[n]=r?Hr:Sr(e,t[n]);return i}function ye(e,t,n){return e===e&&(n!==Hr&&(e=n>=e?e:n),t!==Hr&&(e=e>=t?e:t)),e}function Ce(e,t,n,r,o,i,a){var c;if(r&&(c=i?r(e,o,i,a):r(e)),c!==Hr)return c;if(!ir(e))return e;var l=Ga(e);if(l){if(c=Zt(e),!t)return wt(e,c)}else{var s=Kt(e),f=s==Co||s==bo;if(Ba(e))return ft(e,t);if(s==Io||s==go||f&&!i){if(F(e))return i?e:{};if(c=Qt(f?{}:e),!t)return xt(e,me(c,e))}else{if(!yi[s])return i?e:{};c=en(e,s,Ce,t)}}a||(a=new ue);var d=a.get(e);if(d)return d;if(a.set(e,c),!l)var p=n?Ht(e):Ir(e);return u(p||e,function(o,i){p&&(i=o,o=e[i]),ge(c,i,Ce(o,t,n,r,i,e,a))}),c}function be(e){return ir(e)?Wi(e):{}}function Se(e,t,n,r){var o=-1,i=f,a=!0,u=e.length,c=[],l=t.length;if(!u)return c;n&&(t=p(t,S(n))),r?(i=d,a=!1):t.length>=jr&&(i=I,a=!1,t=new oe(t));e:for(;++o<u;){var s=e[o],h=n?n(s):s;if(s=r||0!==s?s:0,a&&h===h){for(var g=l;g--;)if(t[g]===h)continue e;c.push(s)}else i(t,h,r)||c.push(s)}return c}function we(e,t){var n=!0;return va(e,function(e,r,o){return n=!!t(e,r,o)}),n}function Ie(e,t,n){for(var r=-1,o=e.length;++r<o;){var i=e[r],a=t(i);if(null!=a&&(u===Hr?a===a&&!pr(a):n(a,u)))var u=a,c=i}return c}function xe(e,t,n,r){var o=e.length;for(n=mr(n),0>n&&(n=-n>o?0:o+n),r=r===Hr||r>o?o:mr(r),0>r&&(r+=o),r=n>r?0:_r(r);r>n;)e[n++]=t;return e}function Ae(e,t){var n=[];return va(e,function(e,r,o){t(e,r,o)&&n.push(e)}),n}function Ee(e,t,n,r,o){var i=-1,a=e.length;for(n||(n=nn),o||(o=[]);++i<a;){var u=e[i];t>0&&n(u)?t>1?Ee(u,t-1,n,r,o):h(o,u):r||(o[o.length]=u)}return o}function Re(e,t){return e&&_a(e,t,Ir)}function Ne(e,t){return e&&ya(e,t,Ir)}function De(e,t){t=un(t,e)?[t]:lt(t);for(var n=0,r=t.length;null!=e&&r>n;)e=e[_n(t[n++])];return n&&n==r?e:Hr}function Fe(e,t,n){var r=t(e);return Ga(e)?r:h(r,n(e))}function Te(e,t){return e>t}function Me(e,t){return null!=e&&(Mi.call(e,t)||"object"==("undefined"==typeof e?"undefined":r(e))&&t in e&&null===Xt(e))}function Oe(e,t){return null!=e&&t in Object(e)}function Le(e,t,n){for(var r=n?d:f,o=e[0].length,i=e.length,a=i,u=Array(i),c=1/0,l=[];a--;){var s=e[a];a&&t&&(s=p(s,S(t))),c=Zi(s.length,c),u[a]=!n&&(t||o>=120&&s.length>=120)?new oe(a&&s):Hr}s=e[0];var h=-1,g=u[0];e:for(;++h<o&&l.length<c;){var v=s[h],m=t?t(v):v;if(v=n||0!==v?v:0,!(g?I(g,m):r(l,m,n))){for(a=i;--a;){var _=u[a];if(!(_?I(_,m):r(e[a],m,n)))continue e}g&&g.push(m),l.push(v)}}return l}function Pe(e,t,n,r,o){return e===t?!0:null==e||null==t||!ir(e)&&!ar(t)?e!==e&&t!==t:Ge(e,t,Pe,n,r,o)}function Ge(e,t,n,r,o,i){var a=Ga(e),u=Ga(t),c=vo,l=vo;a||(c=Kt(e),c=c==go?Io:c),u||(l=Kt(t),l=l==go?Io:l);var s=c==Io&&!F(e),f=l==Io&&!F(t),d=c==l;if(d&&!s)return i||(i=new ue),a||hr(e)?Bt(e,t,n,r,o,i):kt(e,t,c,n,r,o,i);if(!(o&oo)){var p=s&&Mi.call(e,"__wrapped__"),h=f&&Mi.call(t,"__wrapped__");if(p||h){var g=p?e.value():e,v=h?t.value():t;return i||(i=new ue),n(g,v,r,o,i)}}return d?(i||(i=new ue),Ut(e,t,n,r,o,i)):!1}function Be(e,t,n,r){var o=n.length,i=o,a=!r;if(null==e)return!i;for(e=Object(e);o--;){var u=n[o];if(a&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<i;){u=n[o];var c=u[0],l=e[c],s=u[1];if(a&&u[2]){if(l===Hr&&!(c in e))return!1}else{var f=new ue;if(r)var d=r(l,s,c,e,t,f);if(!(d===Hr?Pe(s,l,r,ro|oo,f):d))return!1}}return!0}function ke(e){if(!ir(e)||sn(e))return!1;var t=rr(e)||F(e)?Gi:Jo;return t.test(yn(e))}function Ue(e){return"function"==typeof e?e:null==e?Fr:"object"==("undefined"==typeof e?"undefined":r(e))?Ga(e)?Ye(e[0],e[1]):ze(e):Lr(e)}function He(e){return Ki(Object(e))}function Ve(e){e=null==e?e:Object(e);var t=[];for(var n in e)t.push(n);return t}function je(e,t){return t>e}function We(e,t){var n=-1,r=Kn(e)?Array(e.length):[];return va(e,function(e,o,i){r[++n]=t(e,o,i)}),r}function ze(e){var t=Yt(e);return 1==t.length&&t[0][2]?pn(t[0][0],t[0][1]):function(n){return n===e||Be(n,e,t)}}function Ye(e,t){return un(e)&&dn(t)?pn(_n(e),t):function(n){var r=Sr(n,e);return r===Hr&&r===t?wr(n,e):Pe(t,r,Hr,ro|oo)}}function qe(e,t,n,r,o){if(e!==t){if(!Ga(t)&&!hr(t))var i=xr(t);u(i||t,function(a,u){if(i&&(u=a,a=t[u]),ir(a))o||(o=new ue),Xe(e,t,u,n,qe,r,o);else{var c=r?r(e[u],a,u+"",e,t,o):Hr;c===Hr&&(c=a),he(e,u,c)}})}}function Xe(e,t,n,r,o,i,a){var u=e[n],c=t[n],l=a.get(c);if(l)return void he(e,n,l);var s=i?i(u,c,n+"",e,t,a):Hr,f=s===Hr;f&&(s=c,Ga(c)||hr(c)?Ga(u)?s=u:Jn(u)?s=wt(u):(f=!1,s=Ce(c,!0)):fr(c)||$n(c)?$n(u)?s=Cr(u):!ir(u)||r&&rr(u)?(f=!1,s=Ce(c,!0)):s=u:f=!1),a.set(c,s),f&&o(s,c,r,i,a),a["delete"](c),he(e,n,s)}function $e(e,t,n){var r=-1;t=p(t.length?t:[Fr],S(Wt()));var o=We(e,function(e,n,o){var i=p(t,function(t){return t(e)});return{criteria:i,index:++r,value:e}});return C(o,function(e,t){return Ct(e,t,n)})}function Ke(e,t){return e=Object(e),g(t,function(t,n){return n in e&&(t[n]=e[n]),t},{})}function Je(e){return function(t){return null==t?Hr:t[e]}}function Ze(e){return function(t){return De(t,e)}}function Qe(e,t){for(var n=e?t.length:0,r=n-1;n--;){var o=t[n];if(n==r||o!==i){var i=o;if(on(o))Yi.call(e,o,1);else if(un(o,e))delete e[_n(o)];else{var a=lt(o),u=vn(e,a);null!=u&&delete u[_n(In(a))]}}}return e}function et(e,t,n,r){t=un(t,e)?[t]:lt(t);for(var o=-1,i=t.length,a=i-1,u=e;null!=u&&++o<i;){var c=_n(t[o]);if(ir(u)){var l=n;if(o!=a){var s=u[c];l=r?r(s,c,u):Hr,l===Hr&&(l=null==s?on(t[o+1])?[]:{}:s)}ge(u,c,l)}u=u[c]}return e}function tt(e,t,n){var r=-1,o=e.length;0>t&&(t=-t>o?0:o+t),n=n>o?o:n,0>n&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+t];return i}function nt(e,t){var n;return va(e,function(e,r,o){return n=t(e,r,o),!n}),!!n}function rt(e,t,n){var r=0,o=e?e.length:r;if("number"==typeof t&&t===t&&ho>=o){for(;o>r;){var i=r+o>>>1,a=e[i];null!==a&&!pr(a)&&(n?t>=a:t>a)?r=i+1:o=i}return o}return ot(e,t,Fr,n)}function ot(e,t,n,r){t=n(t);for(var o=0,i=e?e.length:0,a=t!==t,u=null===t,c=pr(t),l=t===Hr;i>o;){var s=qi((o+i)/2),f=n(e[s]),d=f!==Hr,p=null===f,h=f===f,g=pr(f);if(a)var v=r||h;else v=l?h&&(r||d):u?h&&d&&(r||!p):c?h&&d&&!p&&(r||!g):p||g?!1:r?t>=f:t>f;v?o=s+1:i=s}return Zi(i,po)}function it(e){if("string"==typeof e)return e;if(pr(e))return ga?ga.call(e):"";var t=e+"";return"0"==t&&1/e==-uo?"-0":t}function at(e,t,n){var r=-1,o=f,i=e.length,a=!0,u=[],c=u;if(n)a=!1,o=d;else if(i>=jr){var l=t?null:ba(e);if(l)return L(l);a=!1,o=I,c=new oe}else c=t?[]:u;e:for(;++r<i;){var s=e[r],p=t?t(s):s;if(s=n||0!==s?s:0,a&&p===p){for(var h=c.length;h--;)if(c[h]===p)continue e;t&&c.push(p),u.push(s)}else o(c,p,n)||(c!==u&&c.push(p),u.push(s))}return u}function ut(e,t,n){for(var r=-1,o=e.length,i=t.length,a={};++r<o;){var u=i>r?t[r]:Hr;n(a,e[r],u)}return a}function ct(e){return Jn(e)?e:[]}function lt(e){return Ga(e)?e:xa(e)}function st(e,t,n){var r=e.length;return n=n===Hr?r:n,!t&&n>=r?e:tt(e,t,n)}function ft(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}function dt(e){var t=new e.constructor(e.byteLength);return new Hi(t).set(new Hi(e)),t}function pt(e,t){var n=t?dt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function ht(e,t,n){var r=t?n(M(e),!0):M(e);return g(r,o,new e.constructor)}function gt(e){var t=new e.constructor(e.source,Xo.exec(e));return t.lastIndex=e.lastIndex,t}function vt(e,t,n){var r=t?n(L(e),!0):L(e);return g(r,i,new e.constructor)}function mt(e){return ha?Object(ha.call(e)):{}}function _t(e,t){var n=t?dt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function yt(e,t){if(e!==t){var n=e!==Hr,r=null===e,o=e===e,i=pr(e),a=t!==Hr,u=null===t,c=t===t,l=pr(t);if(!u&&!l&&!i&&e>t||i&&a&&c&&!u&&!l||r&&a&&c||!n&&c||!o)return 1;if(!r&&!i&&!l&&t>e||l&&n&&o&&!r&&!i||u&&n&&o||!a&&o||!c)return-1}return 0}function Ct(e,t,n){for(var r=-1,o=e.criteria,i=t.criteria,a=o.length,u=n.length;++r<a;){var c=yt(o[r],i[r]);if(c){if(r>=u)return c;var l=n[r];return c*("desc"==l?-1:1)}}return e.index-t.index}function bt(e,t,n,r){for(var o=-1,i=e.length,a=n.length,u=-1,c=t.length,l=Ji(i-a,0),s=Array(c+l),f=!r;++u<c;)s[u]=t[u];for(;++o<a;)(f||i>o)&&(s[n[o]]=e[o]);for(;l--;)s[u++]=e[o++];return s}function St(e,t,n,r){for(var o=-1,i=e.length,a=-1,u=n.length,c=-1,l=t.length,s=Ji(i-u,0),f=Array(s+l),d=!r;++o<s;)f[o]=e[o];for(var p=o;++c<l;)f[p+c]=t[c];for(;++a<u;)(d||i>o)&&(f[p+n[a]]=e[o++]);return f}function wt(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function It(e,t,n,r){n||(n={});for(var o=-1,i=t.length;++o<i;){var a=t[o],u=r?r(n[a],e[a],a,n,e):e[a];ge(n,a,u)}return n}function xt(e,t){return It(e,$t(e),t)}function At(e){return Wn(function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:Hr,a=o>2?n[2]:Hr;for(i=e.length>3&&"function"==typeof i?(o--,i):Hr,a&&an(n[0],n[1],a)&&(i=3>o?Hr:i,o=1),t=Object(t);++r<o;){var u=n[r];u&&e(t,u,r,i)}return t})}function Et(e,t){return function(n,r){if(null==n)return n;if(!Kn(n))return e(n,r);for(var o=n.length,i=t?o:-1,a=Object(n);(t?i--:++i<o)&&r(a[i],i,a)!==!1;);return n}}function Rt(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),u=a.length;u--;){var c=a[e?u:++o];if(n(i[c],c,i)===!1)break}return t}}function Nt(e,t,n){function r(){var t=this&&this!==Ei&&this instanceof r?i:e;return t.apply(o?n:this,arguments)}var o=t&qr,i=Dt(e);return r}function Dt(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=be(e.prototype),r=e.apply(n,t);return ir(r)?r:n}}function Ft(e,t,n){function r(){for(var i=arguments.length,u=Array(i),c=i,l=jt(r);c--;)u[c]=arguments[c];var s=3>i&&u[0]!==l&&u[i-1]!==l?[]:O(u,l);if(i-=s.length,n>i)return Pt(e,t,Mt,r.placeholder,Hr,u,s,Hr,Hr,n-i);var f=this&&this!==Ei&&this instanceof r?o:e;return a(f,this,u)}var o=Dt(e);return r}function Tt(e){return function(t,n,r){var o=Object(t);if(n=Wt(n,3),!Kn(t))var i=Ir(t);var a=e(i||t,function(e,t){return i&&(t=e,e=o[t]),n(e,t,o)},r);return a>-1?t[i?i[a]:a]:Hr}}function Mt(e,t,n,r,o,i,a,u,c,l){function s(){for(var m=arguments.length,_=Array(m),y=m;y--;)_[y]=arguments[y];if(h)var C=jt(s),b=R(_,C);if(r&&(_=bt(_,r,o,h)),i&&(_=St(_,i,a,h)),m-=b,h&&l>m){var S=O(_,C);return Pt(e,t,Mt,s.placeholder,n,_,S,u,c,l-m)}var w=d?n:this,I=p?w[e]:e;return m=_.length,u?_=mn(_,u):g&&m>1&&_.reverse(),f&&m>c&&(_.length=c),this&&this!==Ei&&this instanceof s&&(I=v||Dt(I)),I.apply(w,_)}var f=t&eo,d=t&qr,p=t&Xr,h=t&(Kr|Jr),g=t&no,v=p?Hr:Dt(e);return s}function Ot(e,t,n,r){function o(){for(var t=-1,c=arguments.length,l=-1,s=r.length,f=Array(s+c),d=this&&this!==Ei&&this instanceof o?u:e;++l<s;)f[l]=r[l];for(;c--;)f[l++]=arguments[++t];return a(d,i?n:this,f)}var i=t&qr,u=Dt(e);return o}function Lt(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=yr(t),n=yr(n)),e(t,n)}}function Pt(e,t,n,r,o,i,a,u,c,l){var s=t&Kr,f=s?a:Hr,d=s?Hr:a,p=s?i:Hr,h=s?Hr:i;t|=s?Zr:Qr,t&=~(s?Qr:Zr),t&$r||(t&=~(qr|Xr));var g=[e,t,o,p,f,h,d,u,c,l],v=n.apply(Hr,g);return ln(e)&&Ia(v,g),v.placeholder=r,v}function Gt(e,t,n,r,o,i,a,u){var c=t&Xr;if(!c&&"function"!=typeof e)throw new TypeError(Wr);var l=r?r.length:0;if(l||(t&=~(Zr|Qr),r=o=Hr),a=a===Hr?a:Ji(mr(a),0),u=u===Hr?u:mr(u),l-=o?o.length:0,t&Qr){var s=r,f=o;r=o=Hr}var d=c?Hr:Sa(e),p=[e,t,n,r,o,s,f,i,a,u];if(d&&hn(p,d),e=p[0],t=p[1],n=p[2],r=p[3],o=p[4],u=p[9]=null==p[9]?c?0:e.length:Ji(p[9]-l,0),!u&&t&(Kr|Jr)&&(t&=~(Kr|Jr)),t&&t!=qr)h=t==Kr||t==Jr?Ft(e,t,u):t!=Zr&&t!=(qr|Zr)||o.length?Mt.apply(Hr,p):Ot(e,t,n,r);else var h=Nt(e,t,n);var g=d?Ca:Ia;return g(h,p)}function Bt(e,t,n,r,o,i){var a=o&oo,u=e.length,c=t.length;if(u!=c&&!(a&&c>u))return!1;var l=i.get(e);if(l)return l==t;var s=-1,f=!0,d=o&ro?new oe:Hr;for(i.set(e,t);++s<u;){var p=e[s],h=t[s];if(r)var g=a?r(h,p,s,t,e,i):r(p,h,s,e,t,i);if(g!==Hr){if(g)continue;f=!1;break}if(d){if(!v(t,function(e,t){return d.has(t)||p!==e&&!n(p,e,r,o,i)?void 0:d.add(t)})){f=!1;break}}else if(p!==h&&!n(p,h,r,o,i)){f=!1;break}}return i["delete"](e),f}function kt(e,t,n,r,o,i,a){switch(n){case To:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Fo:return!(e.byteLength!=t.byteLength||!r(new Hi(e),new Hi(t)));case mo:case _o:return+e==+t;case yo:return e.name==t.name&&e.message==t.message;case wo:return e!=+e?t!=+t:e==+t;case Ao:case Ro:return e==t+"";case So:var u=M;case Eo:var c=i&oo;if(u||(u=L),e.size!=t.size&&!c)return!1;var l=a.get(e);return l?l==t:(i|=ro,a.set(e,t),Bt(u(e),u(t),r,o,i,a));case No:if(ha)return ha.call(e)==ha.call(t)}return!1}function Ut(e,t,n,r,o,i){var a=o&oo,u=Ir(e),c=u.length,l=Ir(t),s=l.length;if(c!=s&&!a)return!1;for(var f=c;f--;){var d=u[f];if(!(a?d in t:Me(t,d)))return!1}var p=i.get(e);if(p)return p==t;var h=!0;i.set(e,t);for(var g=a;++f<c;){d=u[f];var v=e[d],m=t[d];if(r)var _=a?r(m,v,d,t,e,i):r(v,m,d,e,t,i);if(!(_===Hr?v===m||n(v,m,r,o,i):_)){h=!1;break}g||(g="constructor"==d)}if(h&&!g){var y=e.constructor,C=t.constructor;y!=C&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof C&&C instanceof C)&&(h=!1)}return i["delete"](e),h}function Ht(e){return Fe(e,Ir,$t)}function Vt(e){for(var t=e.name+"",n=ua[t],r=Mi.call(ua,t)?n.length:0;r--;){var o=n[r],i=o.func;if(null==i||i==e)return o.name}return t}function jt(e){var t=Mi.call(G,"placeholder")?G:e;return t.placeholder}function Wt(){var e=G.iteratee||Tr;return e=e===Tr?Ue:e,arguments.length?e(arguments[0],arguments[1]):e}function zt(e,t){var n=e.__data__;return cn(t)?n["string"==typeof t?"string":"hash"]:n.map}function Yt(e){for(var t=Ir(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,dn(o)]}return t}function qt(e,t){var n=N(e,t);return ke(n)?n:Hr}function Xt(e){return Xi(Object(e))}function $t(e){return ji(Object(e))}function Kt(e){return Pi.call(e)}function Jt(e,t,n){t=un(t,e)?[t]:lt(t);for(var r,o=-1,i=t.length;++o<i;){var a=_n(t[o]);if(!(r=null!=e&&n(e,a)))break;e=e[a]}if(r)return r;var i=e?e.length:0;return!!i&&or(i)&&on(a,i)&&(Ga(e)||dr(e)||$n(e))}function Zt(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&Mi.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Qt(e){return"function"!=typeof e.constructor||fn(e)?{}:be(Xt(e))}function en(e,t,n,r){var o=e.constructor;switch(t){case Fo:return dt(e);case mo:case _o:return new o(+e);case To:return pt(e,r);case Mo:case Oo:case Lo:case Po:case Go:case Bo:case ko:case Uo:case Ho:return _t(e,r);case So:return ht(e,r,n);case wo:case Ro:return new o(e);case Ao:return gt(e);case Eo:return vt(e,r,n);case No:return mt(e)}}function tn(e){var t=e?e.length:Hr;return or(t)&&(Ga(e)||dr(e)||$n(e))?b(t,String):null}function nn(e){return Ga(e)||$n(e)}function rn(e){return Ga(e)&&!(2==e.length&&!rr(e[0]))}function on(e,t){return t=null==t?co:t,!!t&&("number"==typeof e||Qo.test(e))&&e>-1&&e%1==0&&t>e}function an(e,t,n){if(!ir(n))return!1;var o="undefined"==typeof t?"undefined":r(t);return("number"==o?Kn(n)&&on(t,n.length):"string"==o&&t in n)?Xn(n[t],e):!1}function un(e,t){if(Ga(e))return!1;var n="undefined"==typeof e?"undefined":r(e);return"number"==n||"symbol"==n||"boolean"==n||null==e||pr(e)?!0:jo.test(e)||!Vo.test(e)||null!=t&&e in Object(t)}function cn(e){var t="undefined"==typeof e?"undefined":r(e);return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function ln(e){var t=Vt(e),n=G[t];if("function"!=typeof n||!(t in k.prototype))return!1;if(e===n)return!0;var r=Sa(n);return!!r&&e===r[0]}function sn(e){return!!Fi&&Fi in e}function fn(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||Ni;return e===n}function dn(e){return e===e&&!ir(e)}function pn(e,t){return function(n){return null==n?!1:n[e]===t&&(t!==Hr||e in Object(n))}}function hn(e,t){var n=e[1],r=t[1],o=n|r,i=(qr|Xr|eo)>o,a=r==eo&&n==Kr||r==eo&&n==to&&e[7].length<=t[8]||r==(eo|to)&&t[7].length<=t[8]&&n==Kr;if(!i&&!a)return e;r&qr&&(e[2]=t[2],o|=n&qr?0:$r);var u=t[3];if(u){var c=e[3];e[3]=c?bt(c,u,t[4]):u,e[4]=c?O(e[3],Yr):t[4]}return u=t[5],u&&(c=e[5],e[5]=c?St(c,u,t[6]):u,e[6]=c?O(e[5],Yr):t[6]),u=t[7],u&&(e[7]=u),r&eo&&(e[8]=null==e[8]?t[8]:Zi(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o,e}function gn(e,t,n,r,o,i){return ir(e)&&ir(t)&&qe(e,t,Hr,gn,i.set(t,e)),e}function vn(e,t){return 1==t.length?e:De(e,tt(t,0,-1))}function mn(e,t){for(var n=e.length,r=Zi(t.length,n),o=wt(e);r--;){var i=t[r];e[r]=on(i,n)?o[i]:Hr}return e}function _n(e){if("string"==typeof e||pr(e))return e;var t=e+"";return"0"==t&&1/e==-uo?"-0":t}function yn(e){if(null!=e){try{return Ti.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function Cn(e){for(var t=-1,n=e?e.length:0,r=0,o=[];++t<n;){var i=e[t];i&&(o[r++]=i)}return o}function bn(e,t,n,r){var o=e?e.length:0;return o?(n&&"number"!=typeof n&&an(e,t,n)&&(n=0,r=o),xe(e,t,n,r)):[]}function Sn(e,t,n){var r=e?e.length:0;if(!r)return-1;var o=null==n?0:mr(n);return 0>o&&(o=Ji(r+o,0)),m(e,Wt(t,3),o)}function wn(e,t,n){var r=e?e.length:0;if(!r)return-1;var o=null==n?0:mr(n);return 0>o&&(o=Ji(r+o,0)),_(e,t,o)}function In(e){var t=e?e.length:0;return t?e[t-1]:Hr}function xn(e,t){var n=[];if(!e||!e.length)return n;var r=-1,o=[],i=e.length;for(t=Wt(t,3);++r<i;){var a=e[r];t(a,r,e)&&(n.push(a),o.push(r))}return Qe(e,o),n}function An(e,t){return rt(e,t)}function En(e,t,n){return ot(e,t,Wt(n))}function Rn(e,t,n){return e&&e.length?(t=n||t===Hr?1:mr(t),tt(e,0,0>t?0:t)):[]}function Nn(e){return e&&e.length?at(e):[]}function Dn(e,t){return ut(e||[],t||[],ge)}function Fn(e,t,n){var r=Ga(e)?l:we;return n&&an(e,t,n)&&(t=Hr),r(e,Wt(t,3))}function Tn(e,t){var n=Ga(e)?s:Ae;return n(e,Wt(t,3))}function Mn(e,t){var n=Ga(e)?u:va;return n(e,Wt(t,3))}function On(e,t){var n=Ga(e)?c:ma;return n(e,Wt(t,3))}function Ln(e,t,n,r){e=Kn(e)?e:Rr(e),n=n&&!r?mr(n):0;var o=e.length;return 0>n&&(n=Ji(o+n,0)),dr(e)?o>=n&&e.indexOf(t,n)>-1:!!o&&_(e,t,n)>-1}function Pn(e,t){var n=Ga(e)?p:We;return n(e,Wt(t,3))}function Gn(e,t,n){var r=Ga(e)?g:y,o=arguments.length<3;return r(e,Wt(t,4),n,o,va)}function Bn(e,t,n){var r=Ga(e)?v:nt;return n&&an(e,t,n)&&(t=Hr),r(e,Wt(t,3))}function kn(){return Date.now()}function Un(e,t,n){t=n?Hr:t;var r=Gt(e,Kr,Hr,Hr,Hr,Hr,Hr,t);return r.placeholder=Un.placeholder,r}function Hn(e,t,n){t=n?Hr:t;var r=Gt(e,Jr,Hr,Hr,Hr,Hr,Hr,t);return r.placeholder=Hn.placeholder,r}function Vn(e,t,n){function r(t){var n=d,r=p;return d=p=Hr,_=t,g=e.apply(r,n)}function o(e){return _=e,v=setTimeout(u,t),y?r(e):g}function i(e){var n=e-m,r=e-_,o=t-n;return C?Zi(o,h-r):o}function a(e){var n=e-m,r=e-_;return m===Hr||n>=t||0>n||C&&r>=h}function u(){var e=kn();return a(e)?c(e):void(v=setTimeout(u,i(e)))}function c(e){return v=Hr,b&&d?r(e):(d=p=Hr,g)}function l(){_=0,d=m=p=v=Hr}function s(){return v===Hr?g:c(kn())}function f(){var e=kn(),n=a(e);if(d=arguments,p=this,m=e,n){if(v===Hr)return o(m);if(C)return v=setTimeout(u,t),r(m)}return v===Hr&&(v=setTimeout(u,t)),g}var d,p,h,g,v,m,_=0,y=!1,C=!1,b=!0;if("function"!=typeof e)throw new TypeError(Wr);return t=yr(t)||0,ir(n)&&(y=!!n.leading,C="maxWait"in n,h=C?Ji(yr(n.maxWait)||0,t):h,b="trailing"in n?!!n.trailing:b),f.cancel=l,f.flush=s,f}function jn(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(Wr);var n=function r(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a),a};return n.cache=new(jn.Cache||Z),n}function Wn(e,t){if("function"!=typeof e)throw new TypeError(Wr);return t=Ji(t===Hr?e.length-1:mr(t),0),function(){for(var n=arguments,r=-1,o=Ji(n.length-t,0),i=Array(o);++r<o;)i[r]=n[t+r];switch(t){case 0:return e.call(this,i);case 1:return e.call(this,n[0],i);case 2:return e.call(this,n[0],n[1],i)}var u=Array(t+1);for(r=-1;++r<t;)u[r]=n[r];return u[t]=i,a(e,this,u)}}function zn(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new TypeError(Wr);return ir(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Vn(e,t,{leading:r,maxWait:t,trailing:o})}function Yn(e){return Ce(e,!1,!0)}function qn(e){return Ce(e,!0,!0)}function Xn(e,t){return e===t||e!==e&&t!==t}function $n(e){return Jn(e)&&Mi.call(e,"callee")&&(!zi.call(e,"callee")||Pi.call(e)==go)}function Kn(e){return null!=e&&or(wa(e))&&!rr(e)}function Jn(e){return ar(e)&&Kn(e)}function Zn(e){return e===!0||e===!1||ar(e)&&Pi.call(e)==mo}function Qn(e){return ar(e)&&Pi.call(e)==_o}function er(e){if(Kn(e)&&(Ga(e)||dr(e)||rr(e.splice)||$n(e)||Ba(e)))return!e.length;if(ar(e)){var t=Kt(e);if(t==So||t==Eo)return!e.size}for(var n in e)if(Mi.call(e,n))return!1;return!(aa&&Ir(e).length)}function tr(e,t){return Pe(e,t)}function nr(e){return"number"==typeof e&&$i(e)}function rr(e){var t=ir(e)?Pi.call(e):"";return t==Co||t==bo}function or(e){return"number"==typeof e&&e>-1&&e%1==0&&co>=e}function ir(e){var t="undefined"==typeof e?"undefined":r(e);return!!e&&("object"==t||"function"==t)}function ar(e){return!!e&&"object"==("undefined"==typeof e?"undefined":r(e))}function ur(e){return sr(e)&&e!=+e}function cr(e){return null===e}function lr(e){return null==e}function sr(e){return"number"==typeof e||ar(e)&&Pi.call(e)==wo}function fr(e){if(!ar(e)||Pi.call(e)!=Io||F(e))return!1;var t=Xt(e);if(null===t)return!0;var n=Mi.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ti.call(n)==Li}function dr(e){return"string"==typeof e||!Ga(e)&&ar(e)&&Pi.call(e)==Ro}function pr(e){return"symbol"==("undefined"==typeof e?"undefined":r(e))||ar(e)&&Pi.call(e)==No}function hr(e){return ar(e)&&or(e.length)&&!!_i[Pi.call(e)]}function gr(e){return e===Hr}function vr(e){if(!e)return 0===e?e:0;if(e=yr(e),e===uo||e===-uo){var t=0>e?-1:1;return t*lo}return e===e?e:0}function mr(e){var t=vr(e),n=t%1;return t===t?n?t-n:t:0}function _r(e){return e?ye(mr(e),0,fo):0}function yr(e){if("number"==typeof e)return e;if(pr(e))return so;if(ir(e)){var t=rr(e.valueOf)?e.valueOf():e;e=ir(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Yo,"");var n=Ko.test(e);return n||Zo.test(e)?Ci(e.slice(2),n?2:8):$o.test(e)?so:+e}function Cr(e){return It(e,xr(e))}function br(e){return null==e?"":it(e)}function Sr(e,t,n){var r=null==e?Hr:De(e,t);return r===Hr?n:r}function wr(e,t){return null!=e&&Jt(e,t,Oe)}function Ir(e){var t=fn(e);if(!t&&!Kn(e))return He(e);var n=tn(e),r=!!n,o=n||[],i=o.length;for(var a in e)!Me(e,a)||r&&("length"==a||on(a,i))||t&&"constructor"==a||o.push(a);return o}function xr(e){for(var t=-1,n=fn(e),r=Ve(e),o=r.length,i=tn(e),a=!!i,u=i||[],c=u.length;++t<o;){var l=r[t];a&&("length"==l||on(l,c))||"constructor"==l&&(n||!Mi.call(e,l))||u.push(l)}return u}function Ar(e,t){var n={};return t=Wt(t,3),Re(e,function(e,r,o){n[r]=t(e,r,o)}),n}function Er(e,t,n){return null==e?e:et(e,t,n)}function Rr(e){return e?w(e,Ir(e)):[]}function Nr(e,t,n){return e=br(e),n=ye(mr(n),0,e.length),e.lastIndexOf(it(t),n)==n}function Dr(e,t,n){if(e=br(e),e&&(n||t===Hr))return e.replace(Yo,"");if(!e||!(t=it(t)))return e;var r=P(e),o=P(t),i=x(r,o),a=A(r,o)+1;return st(r,i,a).join("")}function Fr(e){return e}function Tr(e){return Ue("function"==typeof e?e:Ce(e,!0))}function Mr(e,t){return Ye(e,Ce(t,!0))}function Or(){}function Lr(e){return un(e)?Je(_n(e)):Ze(e)}function Pr(){return[]}function Gr(){return!1}function Br(e){var t=++Oi;return br(e)+t}function kr(e){return e&&e.length?Ie(e,Fr,Te):Hr}function Ur(e){return e&&e.length?Ie(e,Fr,je):Hr}var Hr,Vr="4.13.1",jr=200,Wr="Expected a function",zr="__lodash_hash_undefined__",Yr="__lodash_placeholder__",qr=1,Xr=2,$r=4,Kr=8,Jr=16,Zr=32,Qr=64,eo=128,to=256,no=512,ro=1,oo=2,io=150,ao=16,uo=1/0,co=9007199254740991,lo=1.7976931348623157e308,so=NaN,fo=4294967295,po=fo-1,ho=fo>>>1,go="[object Arguments]",vo="[object Array]",mo="[object Boolean]",_o="[object Date]",yo="[object Error]",Co="[object Function]",bo="[object GeneratorFunction]",So="[object Map]",wo="[object Number]",Io="[object Object]",xo="[object Promise]",Ao="[object RegExp]",Eo="[object Set]",Ro="[object String]",No="[object Symbol]",Do="[object WeakMap]",Fo="[object ArrayBuffer]",To="[object DataView]",Mo="[object Float32Array]",Oo="[object Float64Array]",Lo="[object Int8Array]",Po="[object Int16Array]",Go="[object Int32Array]",Bo="[object Uint8Array]",ko="[object Uint8ClampedArray]",Uo="[object Uint16Array]",Ho="[object Uint32Array]",Vo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,jo=/^\w*$/,Wo=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(\.|\[\])(?:\4|$))/g,zo=/[\\^$.*+?()[\]{}|]/g,Yo=/^\s+|\s+$/g,qo=/\\(\\)?/g,Xo=/\w*$/,$o=/^[-+]0x[0-9a-f]+$/i,Ko=/^0b[01]+$/i,Jo=/^\[object .+?Constructor\]$/,Zo=/^0o[0-7]+$/i,Qo=/^(?:0|[1-9]\d*)$/,ei="\\ud800-\\udfff",ti="\\u0300-\\u036f\\ufe20-\\ufe23",ni="\\u20d0-\\u20f0",ri="\\ufe0e\\ufe0f",oi="["+ei+"]",ii="["+ti+ni+"]",ai="\\ud83c[\\udffb-\\udfff]",ui="(?:"+ii+"|"+ai+")",ci="[^"+ei+"]",li="(?:\\ud83c[\\udde6-\\uddff]){2}",si="[\\ud800-\\udbff][\\udc00-\\udfff]",fi="\\u200d",di=ui+"?",pi="["+ri+"]?",hi="(?:"+fi+"(?:"+[ci,li,si].join("|")+")"+pi+di+")*",gi=pi+di+hi,vi="(?:"+[ci+ii+"?",ii,li,si,oi].join("|")+")",mi=RegExp(ai+"(?="+ai+")|"+vi+gi,"g"),_i={};_i[Mo]=_i[Oo]=_i[Lo]=_i[Po]=_i[Go]=_i[Bo]=_i[ko]=_i[Uo]=_i[Ho]=!0,_i[go]=_i[vo]=_i[Fo]=_i[mo]=_i[To]=_i[_o]=_i[yo]=_i[Co]=_i[So]=_i[wo]=_i[Io]=_i[Ao]=_i[Eo]=_i[Ro]=_i[Do]=!1;var yi={};yi[go]=yi[vo]=yi[Fo]=yi[To]=yi[mo]=yi[_o]=yi[Mo]=yi[Oo]=yi[Lo]=yi[Po]=yi[Go]=yi[So]=yi[wo]=yi[Io]=yi[Ao]=yi[Eo]=yi[Ro]=yi[No]=yi[Bo]=yi[ko]=yi[Uo]=yi[Ho]=!0,yi[yo]=yi[Co]=yi[Do]=!1;var Ci=parseInt,bi="object"==r(t)&&t,Si=bi&&"object"==r(e)&&e,wi=Si&&Si.exports===bi,Ii=E("object"==("undefined"==typeof n?"undefined":r(n))&&n),xi=E("object"==("undefined"==typeof self?"undefined":r(self))&&self),Ai=E("object"==r(this)&&this),Ei=Ii||xi||Ai||Function("return this")(),Ri=Array.prototype,Ni=Object.prototype,Di=Ei["__core-js_shared__"],Fi=function(){var e=/[^.]+$/.exec(Di&&Di.keys&&Di.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ti=Function.prototype.toString,Mi=Ni.hasOwnProperty,Oi=0,Li=Ti.call(Object),Pi=Ni.toString,Gi=RegExp("^"+Ti.call(Mi).replace(zo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bi=wi?Ei.Buffer:Hr,ki=Ei.Reflect,Ui=Ei.Symbol,Hi=Ei.Uint8Array,Vi=ki?ki.enumerate:Hr,ji=Object.getOwnPropertySymbols,Wi=Object.create,zi=Ni.propertyIsEnumerable,Yi=Ri.splice,qi=Math.floor,Xi=Object.getPrototypeOf,$i=Ei.isFinite,Ki=Object.keys,Ji=Math.max,Zi=Math.min,Qi=qt(Ei,"DataView"),ea=qt(Ei,"Map"),ta=qt(Ei,"Promise"),na=qt(Ei,"Set"),ra=qt(Ei,"WeakMap"),oa=qt(Object,"create"),ia=ra&&new ra,aa=!zi.call({valueOf:1},"valueOf"),ua={},ca=yn(Qi),la=yn(ea),sa=yn(ta),fa=yn(na),da=yn(ra),pa=Ui?Ui.prototype:Hr,ha=pa?pa.valueOf:Hr,ga=pa?pa.toString:Hr;k.prototype=be(B.prototype),k.prototype.constructor=k,U.prototype.clear=H,U.prototype["delete"]=V,U.prototype.get=j,U.prototype.has=W,U.prototype.set=z,Y.prototype.clear=q,Y.prototype["delete"]=X,Y.prototype.get=$,Y.prototype.has=K,Y.prototype.set=J,Z.prototype.clear=Q,Z.prototype["delete"]=ee,Z.prototype.get=te,Z.prototype.has=ne,Z.prototype.set=re,oe.prototype.add=oe.prototype.push=ie,oe.prototype.has=ae,ue.prototype.clear=ce,ue.prototype["delete"]=le,ue.prototype.get=se,ue.prototype.has=fe,ue.prototype.set=de;var va=Et(Re),ma=Et(Ne,!0),_a=Rt(),ya=Rt(!0);Vi&&!zi.call({valueOf:1},"valueOf")&&(Ve=function(e){return T(Vi(e))});var Ca=ia?function(e,t){return ia.set(e,t),e}:Fr,ba=na&&1/L(new na([,-0]))[1]==uo?function(e){return new na(e)}:Or,Sa=ia?function(e){return ia.get(e)}:Or,wa=Je("length");ji||($t=Pr),(Qi&&Kt(new Qi(new ArrayBuffer(1)))!=To||ea&&Kt(new ea)!=So||ta&&Kt(ta.resolve())!=xo||na&&Kt(new na)!=Eo||ra&&Kt(new ra)!=Do)&&(Kt=function(e){var t=Pi.call(e),n=t==Io?e.constructor:Hr,r=n?yn(n):Hr;if(r)switch(r){case ca:return To;case la:return So;case sa:return xo;case fa:return Eo;case da:return Do}return t});var Ia=function(){var e=0,t=0;return function(n,r){var o=kn(),i=ao-(o-t);if(t=o,i>0){if(++e>=io)return n}else e=0;return Ca(n,r)}}(),xa=jn(function(e){var t=[];return br(e).replace(Wo,function(e,n,r,o){t.push(r?o.replace(qo,"$1"):n||e)}),t}),Aa=Wn(function(e,t){return Jn(e)?Se(e,Ee(t,1,Jn,!0)):[]}),Ea=Wn(function(e){var t=p(e,ct);return t.length&&t[0]===e[0]?Le(t):[]}),Ra=Wn(function(e,t){t=Ee(t,1);var n=e?e.length:0,r=_e(e,t);return Qe(e,p(t,function(e){return on(e,n)?+e:e}).sort(yt)),r}),Na=Wn(function(e){return at(Ee(e,1,Jn,!0))}),Da=Tt(Sn),Fa=Wn(function(e,t){if(null==e)return[];var n=t.length;return n>1&&an(e,t[0],t[1])?t=[]:n>2&&an(t[0],t[1],t[2])&&(t=[t[0]]),t=1==t.length&&Ga(t[0])?t[0]:Ee(t,1,rn),$e(e,t,[])}),Ta=Wn(function(e,t,n){var r=qr;if(n.length){var o=O(n,jt(Ta));r|=Zr}return Gt(e,r,t,n,o)}),Ma=Wn(function(e,t,n){var r=qr|Xr;if(n.length){var o=O(n,jt(Ma));r|=Zr}return Gt(t,r,e,n,o)});jn.Cache=Z;var Oa=Wn(function(e,t){var n=O(t,jt(Oa));return Gt(e,Zr,Hr,t,n)}),La=Wn(function(e,t){var n=O(t,jt(La));return Gt(e,Qr,Hr,t,n)}),Pa=Lt(Te),Ga=Array.isArray,Ba=Bi?function(e){return e instanceof Bi}:Gr,ka=Lt(je),Ua=At(function(e,t){if(aa||fn(t)||Kn(t))return void It(t,Ir(t),e);for(var n in t)Mi.call(t,n)&&ge(e,n,t[n])}),Ha=At(function(e,t){if(aa||fn(t)||Kn(t))return void It(t,xr(t),e);for(var n in t)ge(e,n,t[n])}),Va=At(function(e,t,n,r){It(t,xr(t),e,r)}),ja=Wn(function(e){return e.push(Hr,pe),a(Va,Hr,e)}),Wa=Wn(function(e){return e.push(Hr,gn),a(Ya,Hr,e)}),za=At(function(e,t,n){qe(e,t,n)}),Ya=At(function(e,t,n,r){qe(e,t,n,r)}),qa=Wn(function(e,t){return null==e?{}:Ke(e,p(Ee(t,1),_n))});G.assign=Ua,G.assignIn=Ha,G.assignInWith=Va,G.bind=Ta,G.bindKey=Ma,G.compact=Cn,G.curry=Un,G.curryRight=Hn,G.debounce=Vn,G.defaults=ja,G.defaultsDeep=Wa,G.difference=Aa,G.fill=bn,G.filter=Tn,G.intersection=Ea,G.iteratee=Tr,G.keys=Ir,G.keysIn=xr,G.map=Pn,G.mapValues=Ar,G.mP=Mr,G.memoize=jn,G.merge=za,G.mergeWith=Ya,G.partial=Oa,G.partialRight=La,G.pick=qa,G.property=Lr,G.pullAt=Ra,G.remove=xn,G.rest=Wn,G.set=Er,G.sortBy=Fa,G.take=Rn,G.throttle=zn,G.toPlainObject=Cr,G.union=Na,G.uniq=Nn,G.values=Rr,G.zipObject=Dn,G.extend=Ha,G.extendWith=Va,G.clone=Yn,G.cloneDeep=qn,G.eq=Xn,G.every=Fn,G.find=Da,G.findIndex=Sn,G.forEach=Mn,G.forEachRight=On,G.get=Sr,G.gt=Pa,G.hasIn=wr,G.identity=Fr,G.includes=Ln,G.indexOf=wn,G.isArguments=$n,G.isArray=Ga,G.isArrayLike=Kn,G.isArrayLikeObject=Jn,G.isBoolean=Zn,G.isBuffer=Ba,G.isDate=Qn,G.isEmpty=er,G.isEqual=tr,G.isFinite=nr,G.isFunction=rr,G.isLength=or,G.isNaN=ur,G.isNil=lr,G.isNull=cr,G.isNumber=sr,G.isObject=ir,G.isObjectLike=ar,G.isPlainObject=fr,G.isString=dr,G.isSymbol=pr,G.isTypedArray=hr,
G.isUndefined=gr,G.last=In,G.lt=ka,G.max=kr,G.min=Ur,G.stubArray=Pr,G.stubFalse=Gr,G.noop=Or,G.now=kn,G.reduce=Gn,G.some=Bn,G.sortedIndex=An,G.sortedIndexBy=En,G.startsWith=Nr,G.toFinite=vr,G.toInteger=mr,G.toLength=_r,G.toNumber=yr,G.toString=br,G.trim=Dr,G.uniqueId=Br,G.each=Mn,G.eachRight=On,G.VERSION=Vr,u(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){G[e].placeholder=G}),e.exports=G}).call(void 0)}).call(t,n(9)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}!function(){function t(e){if(e&&e.childNodes)for(var n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];8===r.nodeType||3===r.nodeType&&!/\S/.test(r.nodeValue)?(e.removeChild(r),n--):1===r.nodeType&&t(r)}}function o(e,t,n){t=t||f.getStyle(e);var r;return c.isString(n)?r=i(t[n]):(n=n||p,r={},n.forEach(function(e){r[e]=i(t[e])})),r}function i(e){var t=parseFloat(e);return isNaN(t)?0:t}function a(){var e=document.body,t=e.style;if(t&&t.position&&"static"!==t.position){var n=f.gCSV(e,null,p);return{left:n.paddingLeft+n.marginLeft+n.borderLeftWidth,top:n.paddingTop+n.marginTop+n.borderTopWidth,right:n.paddingRight+n.marginRight+n.borderRightWidth}}return{left:0,top:0,right:0}}var u=n(8),c=n(11),l="left",s="right",f={},d={left:0,top:0,width:0,height:0};f.isDomElement=function(e){return e instanceof HTMLElement},f.isVisible=function(e){return f.isDomElement(e)&&null!==e.offsetParent},f.createElement=function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.children[0];return t=null,n},f.createTemplateElement=function(e){var n=document.createElement("div");return n.innerHTML=e,t(n),n},f.getElementInnerText=function(e){return e.innerHTML.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},f.getElementOuterText=function(e){return e.outerHTML.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},f.hasClass=function(e,t){if(e&&e.getAttribute){var n=e.getAttribute("class");if(n)return n=n.replace(/[\t\r\n\f]/g," ").split(" "),n.indexOf(t)>=0}return!1},f.removeClass=function(e,t){if(e&&e.setAttribute&&f.hasClass(e,t)){var n=e.getAttribute("class").split(" "),r=[];u.each(n,function(e){e.toLowerCase()!==t.toLowerCase()&&r.push(e)}),e.setAttribute("class",r.join(" "))}},f.addClass=function(e,t){if(e&&e.setAttribute&&!f.hasClass(e,t)){var n=e.getAttribute("class");e.setAttribute("class",n?n+" "+t:t)}},f.toggleClass=function(e,t,n){n===!0?f.addClass(e,t):f.removeClass(e,t)},f.getElement=function(e){return e instanceof HTMLElement?e:c.isString(e)?document.querySelector(e):null},f.contains=function(e,t){for(var n=t;n;n=n.parentElement)if(n===e)return!0;return!1},f.offset=function(e){var t=e?e.getBoundingClientRect():d;return{top:t.top+window.pageYOffset,left:t.left+window.pageXOffset}},f.gER=function(e){var t=e?e.getBoundingClientRect():d;return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:t.width,height:t.height}},f.gCoR=function(e){var t=e?e.getBoundingClientRect():d,n=o(e),r=n.paddingLeft+n.paddingRight,i=n.paddingTop+n.paddingBottom,a=n.borderLeftWidth+n.borderRightWidth,u=n.borderTopWidth+n.borderBottomWidth;return{left:t.left+window.pageXOffset+n.borderLeftWidth+n.paddingLeft,top:t.top+window.pageYOffset+n.borderTopWidth+n.paddingTop,width:Math.max(0,Math.floor(t.width-r-a)),height:Math.max(0,Math.floor(t.height-i-u))}},f.gCoRFn=function(e){var t=o(e),n=t.paddingLeft+t.paddingRight,r=t.paddingTop+t.paddingBottom,i=t.borderLeftWidth+t.borderRightWidth,a=t.borderTopWidth+t.borderBottomWidth;return function(){var o=e.getBoundingClientRect();return{left:o.left+window.pageXOffset+t.borderLeftWidth+t.paddingLeft,top:o.top+window.pageYOffset+t.borderTopWidth+t.paddingTop,width:Math.max(0,Math.floor(o.width-n-i)),height:Math.max(0,Math.floor(o.height-r-a))}}},f.getStyle=function(e){var t=getComputedStyle||window.getComputedStyle;return e&&t?t(e,null):null};var p=["paddingLeft","paddingRight","paddingTop","paddingBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","marginLeft","marginRight","marginTop","marginBottom"];f.gCSV=o,f.getBodyStyle=a,f.setCss=function(e,t){var n=e.style;for(var r in t){var o=t[r];c.isNumber(o)&&r.match(/width|height|left|top|right|bottom|size|padding|margin'/i)&&(o+="px"),n[r]=o.toString()}},f.gSS=function(e){if(e.scS_)return e.scS_;var t=f.createElement('<div style="position:absolute; top:-10000px; left:-10000px; width:100px; height:100px; overflow:scroll;"></div>');return document.body.appendChild(t),e.scS_={width:t.offsetWidth-t.clientWidth,height:t.offsetHeight-t.clientHeight},t.parentNode.removeChild(t),e.scS_},f.gSCH=function(){if(f.mSCH)return f.mSCH;var e,t=1e6,n=6e9,r=f.createElement('<div style="display:none"/>');for(document.body.appendChild(r);;){if(e=t+5e5,r.style.height=e+"px",e>n||r.offsetHeight!==e)break;t=e}return r.parentNode.removeChild(r),f.mSCH=t,f.mSCH},f.closest=function(e,t){for(;e;){if(e.matches?e.matches(t):e.msMatchesSelector(t))return e;if(e.parentNode===document)return null;e=e.parentNode}return null};var h=void 0;f.detectRTLMode=function(){if(h)return h;var e=f.createElement('<div class="gc-test-container" style="overflow:auto;height:500px;width:500px;direction:rtl"><div class="gc-test-content" style="height:400px;width:1000px;"></div></div>');document.body.appendChild(e);var t="normal";return 0===e.scrollLeft&&(e.scrollLeft=1e4,t=e.scrollLeft>0?"reverse":"negative"),document.body.removeChild(e),e=null,h=t,t},f.getRTLScrollLeft=function(e){var t=arguments.length<=1||void 0===arguments[1]?"normal":arguments[1];return f.isDomElement(e)?f.tRTLSL(e.scrollLeft,e.scrollWidth-e.clientWidth,f.detectRTLMode(),t):void 0},f.setRTLScrollLeft=function(e,t){var n=arguments.length<=2||void 0===arguments[2]?"normal":arguments[2];if(f.isDomElement(e)){var r=f.detectRTLMode();e.scrollLeft=n===r?t:f.tRTLSL(t,e.scrollWidth-e.clientWidth,n,r)}};var g={normal:0,reverse:1,negative:2};f.tRTLSL=function(e,t,n,o){if(n===o)return e;if(n=g[n],o=g[o],0>=t)return 0;var i=[[[1],[-1,t],[1,-t]],[[-1,t],[1],[-1]],[[1,t],[-1],[1]]];return function(e,t){var n=arguments.length<=2||void 0===arguments[2]?0:arguments[2];return(t>0?e:-e)+n}.apply(void 0,[e].concat(r(i[n][o])))},f.inverseToRTL=function(e){if(!f.isDomElement(e))return e;var t,n="[style]";t="TEMPLATE"===e.tagName?e.content.querySelectorAll(n):e.querySelectorAll(n);var r=function(e,t,n){var r=e.style[t];c.isNilOrWhiteSpace(r)||(e.style[t]="",e.style[n]=r)};return u.forEach(t,function(e){c.isNilOrWhiteSpace(e.style.right)?c.isNilOrWhiteSpace(e.style.left)||r(e,l,s):r(e,s,l),e.style["float"]===s?e.style["float"]=l:e.style["float"]===l&&(e.style["float"]=s)}),e},f.detectBrowserType=function(){if(f.duckTypingBrowserType)return f.duckTypingBrowserType;var e=navigator&&navigator.userAgent,t=!!window.opr&&!!window.opr.addons||!!window.opera||e.indexOf(" OPR/")>=0,n="undefined"!=typeof InstallTrigger,r=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,o=!!document.documentMode,i=!o&&!!window.StyleMedia,a=!!window.chrome&&!!window.chrome.webstore,u=(a||t)&&!!window.CSS,c=!!e.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i);return f.duckTypingBrowserType={isOpera:t,isFirefox:n,isSafari:r,isIE:o,isEdge:i,isChrome:a,isBlink:u,isMobileDevice:c}},e.exports=f}()},function(e,t,n){"use strict";!function(){function t(e){return N.isNil(e)?!0:N.isString(e)?e.replace(/\s/g,"").length<1:!1}function r(e,t,n){e&&e.removeEventListener(t,n)}function o(e,t,n){e&&e.addEventListener(t,n)}function i(e){}function a(e){return R.isNumber(e)?"number":R.isBoolean(e)?"boolean":R.isDate(e)?"date":R.isString(e)?"string":R.isArray(e)?"array":R.isObject(e)?"object":""}function u(e,t){var n=N.isNil(t)||"boolean"==typeof t||""===t;if(n)return"";var r=isNaN(t);return r||0===t||M.hasOwnProperty(e)&&M[e]?""+t:("string"==typeof t&&(t=t.trim()),t+"px")}function c(e){var t={};return function(n){return t.hasOwnProperty(n)?t[n]:(t[n]=e.call(this,n),t[n])}}function l(e){return e.replace(O,"-$1").toLowerCase()}function s(e){return l(e).replace(L,"-ms-")}function f(e){var t="";for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];N.isNil(r)||(t+=P(n)+":",t+=u(n,r)+";")}return t||null}function d(e,t){var n=function(e){return"[object Object]"===Object.prototype.toString.call(e)};if(!n(e)||!n(t))return e;for(var r,o=[{level:-1,value:e,key:null}],i=[],a={};o.length>0;)if(r=o.pop(),R.isNil(r.key)||(i=N.take(i,r.level),i.push(r.key)),R.isObject(r.value)&&!R.isFunction(r.value))for(var u in r.value)o.push({level:r.level+1,value:r.value[u],key:u});else{var c=i.join("."),l=N.get(e,c);l!==N.get(t,c)&&N.set(a,c,l)}return N.isEmpty(a)?null:a}function p(e){var t=N.cloneDeep(e),n=[];t&&n.push(t);for(var r;n.length>0;)if(r=n.pop(),R.isObject(r))for(var o in r)n.push(r[o]),R.isFunction(r[o])&&(r[o]=g(r[o]));return t}function h(e){var t=N.clone(e),n=[];t&&n.push(t);for(var r,o;n.length>0;)if(r=n.pop(),R.isObject(r))for(var i in r)n.push(r[i]),R.isString(r[i])&&(o=v(r[i]),o&&(r[i]=o));return t}function g(e){return e.toString()}function v(e){if(R.isString(e)&&"function"===e.substr(0,8)&&(/\s/.test(e[8])||"("===e[8])){var t=e.indexOf("(")+1,n=e.indexOf(")"),r=e.substr(t,n-t).split(",").map(function(e){return e.replace(/\s+/,"")}),o=e.indexOf("{")+1,i=e.lastIndexOf("}");return new Function(r,e.substr(o,i-o))}return null}function m(e){var t;try{t=GC.Spread.Views.Plugins[e]}catch(n){}return t}function _(e){var t={},n=GC&&GC.Spread&&GC.Spread.Views&&GC.Spread.Views.LocaleResource&&GC.Spread.Views.LocaleResource.content;for(var r in e)t[r]=n&&n[r];return t}function y(e){var t=R.toDate(e);if(isNaN(t.getTime()))return e;var n=t.getFullYear().toString(),r=(t.getMonth()+1).toString(),o=t.getDate().toString();return C(n,4)+"-"+C(r,2)+"-"+C(o,2)}function C(e,t){var n=t-e.length+1;return n>=0?new Array(n).join("0")+e:e}function b(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n}function S(e){return e?e.charAt(0).toUpperCase()+e.slice(1):""}function w(e,t,n){var r=function(e){return N.isUndefined(e)?e:n?(e+"").trim().toLowerCase():(e+"").trim().toString()},o=r(t);return function(t){if(null==t)return!1;var r=I(t,e);return r=N.isUndefined(r)?r:n?(r+"").toLowerCase():(r+"").toString(),r===o?void 0!==o||e in t:N.isEqual(r,o)}}function I(){var e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1];if(!N.isNil(e)&&!N.isNil(t)){t=N.isArray(t)?t:N.isString(t)?t.split("."):[t];for(var n=0,r=t.length,o=arguments.length>2;e&&r>n;){if(o&&n===r-1)return void(e[t[n]]=arguments.length<=2?void 0:arguments[2]);e=e[t[n++]]}return e}}function x(e,t,n,r){N.isArray(e)||(e=[e]),N.isArray(t)||(t=[t]);var o=r?[]:{};N.forEach(e,function(e){o[e]||(o[e]=1)});var i=[],a=[],u=[],c=0,l=0,s=0;return N.forEach(t,function(e){o[e]?(o[e]=2,n&&(a[s++]=e)):(o[e]=3,n&&(i[c++]=e))}),n&&N.forEach(o,function(e,t){1===e&&(u[l++]=+t)}),n?{add:i,remove:u,keep:a}:{map:o}}function A(e){return R.isNumber(e)?E(e):new Date(e)}function E(e){var t=new Date(1899,11,30),n=864e5,r=e-Math.floor(e);return 0>e&&r&&(e=Math.floor(e)-r),new Date(e*n+ +t)}var R={},N=n(8);R.isString=N.isString,R.regist=o,R.unRegist=r,R.isNilOrWhiteSpace=t,R.isNumber=N.isNumber,R.isInt=N.isInteger,R.isBoolean=N.isBoolean,R.isFunction=N.isFunction,R.isUndefined=N.isUndefined,R.isDate=N.isDate,R.isArray=N.isArray,R.isObject=N.isObject,R.debugLog=i,R.getType=a,R.isNull=N.isNull,R.isNil=N.isNil;var D={Back:8,Tab:9,Enter:13,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Delete:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123};R.Key=D;var F=function(e){var t=e.keyCode,n=t>47&&58>t||t>64&&91>t||t>95&&112>t||t>185&&193>t||t>218&&223>t;return n};R.isPrintableKey=F;var T={Text:"text",CheckBox:"checkbox",Date:"date",Color:"color",Number:"number"};R.EditorType=T;var M={columnCount:!0,flex:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,strokeOpacity:!0},O=/([A-Z])/g,L=/^-ms-/,P=c(function(e){return s(e)});R.cMFS=f,R.extractObject=d,R.serializeObject=p,R.deserializeObject=h,R.serializeFunction=g,R.deserializeFunction=v,R.findPlugin=m,R.getResource=_,R.normalizeDate=y,R.extends_=b,R.caC=S,R.mP=w,R.sOP=function(e,t){return I(e,t)},R.gOP=function(e,t,n){return I(e,t,n)},R.compareArray=x,R.toDate=A,e.exports=R}()},function(e,t,n){"use strict";!function(){function t(e){var n,r,o,i=0;for(n=0,r=e.length;r>n;n++)o=e[n],i=o.hasOwnProperty("columns")?Math.max(i,1+t(o.columns)):Math.max(i,1);return i}function r(e,t,n,r,o){var i=o&&e.isTouchMode?10:0;return t>=r.left-i&&t<=r.right+i&&n>=r.top-i&&n<=r.bottom+i}function o(e,t,n,r,o,i){var a=L.offset(r),u=L.offset(o),c=a.left-u.left,l=a.top-u.top,s=L.gER(r),f=i&&e.isTouchMode?10:0;c-=f,l-=f;var d=c+s.width+2*f,p=l+s.height+2*f;return t>=c&&d>=t&&n>=l&&p>=n}function i(e){return e&&e.action&&e.swipeDirection}function a(e){return e.data.groups&&e.data.groups.length>0}function u(e,t){t=O.defaults(t,{control:null,action:null,mode:"depthFirst",direction:"ltr",traverseCollapsed:!1,parentFirst:!0,getChildren:function(e){return e.children}});var n=O.isFunction(t.control)?t.control:null,r=O.isFunction(t.action)?t.action:null,o="widthFirst"===t.mode,i="rtl"===t.direction,a=o?"unshift":"push",u=o!==i===t.parentFirst?O.forEach:O.forEachRight,c=function(e,t){if(e.length>20){var n=e.slice();return o?i?n.concat(t):n.reverse().concat(t):i?t.concat(n):t.reverse().concat(n)}return u(e,function(e){t[a](e)}),t},l=[e];if(t.parentFirst)for(;l.length>0;){var s=l.pop();if(n){var f=n(s);if("break"===f)break;if("continue"===f)continue}r&&r(s),!t.traverseCollapsed&&s.collapsed||(l=c(t.getChildren(s),l))}else{for(var d=[],p=0;l.length>0;){var h=l.pop();if(n){var g=n(h);if("break"===g)break;if("continue"===g)continue}d[p++]=h,!t.traverseCollapsed&&h.collapsed||(l=c(t.getChildren(h),l))}r&&O.forEachRight(d,function(e){r(e)}),d.length=0}l.length=0}function c(e,t,n,r){if(e){r||(r={index:-1});var o;if(-1!==e.level&&(r.index++,o=t(e,r.index,!1)))return o;if(!e.collapsed){for(var i=r.index,a=e.children.length,u=0;a>u;u++)if(o=c(e.children[u],t,n,r))return o;if(n&&a>0&&-1!==e.level&&(o=t(e,i,!0)))return o}return o}}function l(e){return e.options.hierarchy&&e.options.hierarchy.footer&&e.options.hierarchy.footer.visible}function s(e,t){if(e.area!==t.area)return!1;if(e.area===U){if(e.itemIndex!==t.itemIndex)return!1;if(e.isHierarchyFooter!==t.isHierarchyFooter)return!1}var n=e.path,r=t.path;if(n.length!==r.length)return!1;for(var o=0,i=n.length;i>o;o++)if(n[o]!==r[o])return!1;return!0}function f(e){var t,n,r,o=!1;for(t=0,n=e.length;n>t&&(r=e[t],!(o=r.columns?f(r.columns):"left"===r.pinned||"right"===r.pinned));t++);return o}function d(e,t,n){var r,o,i=[];for(r=0,o=t.length;o>r;r++)t[r].columns&&i.push(t[r]);for(var a;i.length>0;){if(a=i.shift(),a.caption===n)return a;for(r=0,o=a.columns.length;o>r;r++)a.columns[r].columns&&i.push(a.columns[r])}}function p(e,t,n){if(!t)return 0;t=P.isArray(t)?t:[t];var r,o,i,a=0;for(r=0,o=t.length;o>r;r++)i=t[r],i.columns?a+=this.gGCHW_(e,i.columns,n):e.iCV_(i,n)&&i.pinned===n&&(a+=P.isNumber(i.visibleWidth)?i.visibleWidth:0);return a}function h(e,t){var n,r=t.groupDescriptor,o=r.footer,i=r.header,a=e.data,u=t.path;if(t.collapsed)return{path:u,itemIndex:-1,area:o.visible&&!o.collapseWithGroup||!i.visible?k:B};if(o.location===te&&o.visible)return{path:u,itemIndex:-1,area:k};if(t.isBottomLevel){var c=t.expandedItemCount,l={path:u,itemIndex:c-1,area:o&&o.visible&&0===c?k:U},s=a.hierarchyDescriptor;if(s){var f=s.footer;if(f&&f.visible)l.nodeInfo={path:[0],area:H};else{var d=t.rootNode;if(d){for(;d&&d.children&&d.children.length>0;)d=d.children[d.children.length-1];l.nodeInfo={path:d.path,area:V}}}}return l}return n=t.groups,h(e,n[n.length-1])}function g(e,t,n){if(t){var r;r="left"===e?n?t.pinnedLeftColHeaderTemplate:t.pinnedLeftRowTemplate:"right"===e?n?t.pinnedRightColHeaderTemplate:t.pinnedRightRowTemplate:n?t.colHeaderTemplate:t.rowTemplate;var o=ce.gUT_(r);if(o){var i=L.createElement("<div>"+o+"</div>");return t.rightToLeft?L.inverseToRTL(i).innerHTML:i.innerHTML}}return null}function v(e){if(e){var t;return t=P.isString(e)&&e.length>1&&"#"===e[0]?document.getElementById(e.slice(1)).cloneNode(!0):L.createElement("<div>"+e+"</div>"),t.innerHTML}return null}function m(e,t,n,r,o){O.isObject(e)&&(t=e.area,n=e.row,r=e.groupInfo,o=e.nodeInfo,e=e.uid);var i=e;i+=le[t]?"-"+le[t]:"";var a=_(r),u=_(o);return i+=a+u,""===u&&O.isNumber(n)&&(-1!==n||r?n>=0&&(!r||r&&r.area===U)&&(i+="-r"+n):i+="-autorow"),i}function _(e){return e&&e.path&&le[e.area]?"-"+le[e.area]+e.path.join("_"):""}function y(e){var t={uid:/gc-\d+/.exec(e)[0],row:-1},n=e.split("-").slice(2);if(0===n.length)return t;var r=["pl","pr","rh","ch","plch","prch","corner","gt","gth","chRow","plchRow","prchRow"];if(O.indexOf(r,n[0])>-1?(t.area=le[n[0]],n.shift()):t.area=j,0===n.length)return t;var o=n[0].match(/g[hrf]/);if(o&&(t.groupInfo={area:le[o[0]],path:n[0].replace(/g[hrf]/,"").split("_")},n.shift()),0===n.length)return t;var i=n[0].match(/n[rf]/);return i&&(t.nodeInfo={area:le[i[0]],path:n[0].replace(/n[rf]/,"").split("_")}),"autorow"===n[0]?t.isNewRow=!0:t.row=+n[0].replace("r",""),n.length=0,t}function C(e,t){for(var n,r=e.columns,o=0,i=r.length;i>o;o++)if(n=r[o],n.id===t)return o;return-1}function b(e,t){if(e.area===j||e.area===W||e.area===z){var n=e.groupInfo,r=n&&(n.area===k||n.area===B),o=e.nodeInfo,i=o&&o.area===H;if(!i&&!r){var a=n?n.column:e.column;return t&&a>=0||!t}}return!1}function S(e,t,n,r,o){var i=m(e,t,n,r,o);return i?document.getElementById(i):null}function w(e,t){var n=[j],r=e.layoutEngine;r.sPV_&&(r.sPV_("left")&&n.push(W),r.sPV_("right")&&n.push(z));var o=[],i=t.groupInfo,a=t.nodeInfo;return n.forEach(function(n){var r=ce.createID(e.uid,n,i?i.row:t.row,i,a);r&&o.push(r)}),o}function I(e){var t='<div class="gc-grid" style="position:absolute;top:-10000px;left:-10000px;width:5000px;height:5000px;">'+(P.isString(e)?e:e.innerHTML)+"</div>",n=L.createElement(t);document.body.appendChild(n);var r=n.firstChild,o=null;return r&&(o=L.gCoR(r)),document.body.removeChild(n),o}function x(e){var t=e.gLI_(),n=t[j],r=t[W],o=t[z];return n?n.contentHeight>n.height:r?r.contentHeight>r.height:o?o.contentHeight>o.height:!1}function A(e){var t=e.gLI_(),n=t[j];return n?n.contentWidth>n.width:!1}function E(e,t){var n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];if(!t)return 0;var r=n?1:0;return t.collapsed||(O.each(t.children,function(t){r+=E(e,t,!0)}),n&&t.children.length>0&&ce.hHF_(e)&&++r),r}function R(e,t){var n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],r=e;if(!t)return 0;var o=0,i=t.collapsed;if(i||(t.rootNode?o+=E(r,t.rootNode):t.isBottomLevel?o+=t.itemCount:O.each(t.groups,function(e){o+=R(r,e,!0)})),n){var a=t[ne],u=a&&a[re]&&a[re][oe],c=a&&a[ie],l=c&&c[oe],s=c&&c.collapseWithGroup;u&&++o,(l&&(!s||!i)||!u&&i)&&++o}return o}function N(){var e=-1,t=void 0,n=arguments,r=n[0];if(P.isString(n[1])?t=ce.parseID(n[1]):n.length>2&&(t={row:n[1],groupInfo:n[2],nodeInfo:n[3],isNewRow:n[4]}),t){var o=r.layoutEngine.aARA_(ue),i=r.data;if(t.isNewRow)e=o?0:a(r)?R(r,i.rootGroup,!0):r.data&&r.data.hierarchyDescriptor?E(r,i.rootNode,!0):i.itemCount;else{if(t.groupInfo)e=D(r,i.rootGroup,t).index;else if(t.nodeInfo)e=F(r,i.rootNode,t).index;else{var u=ce.createID(r.uid,j,t.row),c=r.getItem(u).item;e=c?i.mVI_(c.sourceIndex):-1}o&&(e+=1)}}return e}function D(e,t,n){for(var r,o,i,a,u,c,l,s,f={finish:!1,index:0},d=n.groupInfo,p=t?t.groups:[],h=0,g=p.length;g>h;h++){if(r=p[h],s=r[ne],o=s&&s[re]&&s[re][oe],l=s&&s[ie],i=l&&l[oe],a=l&&l[ae],u=o?1:0,c=i&&a===ue?1:0,r.path.toString()===d.path.toString())d.area===k?f.index+=a===ue?u:R(e,r,!0)-1:d.area===U&&(n.nodeInfo?f.index+=F(e,r.rootNode,n).index+u+c:f.index+=n.row+u+c),f.finish=!0;else if(r.path[r.level].toString()===d.path[r.level].toString()){var v=D(e,r,n);f.index+=v.index+u+c,f.finish=v.finish}else f.index+=R(e,r,!0);if(f.finish)break}return f}function F(e,t,n){for(var r={finish:!1,index:0},o=n.nodeInfo,i=t?t.children:[],a=0,u=i.length;u>a;a++){var c=i[a];if(c.path.toString()===o.path.toString())o.area===H&&(r.index+=E(e,c,!0)-1),r.finish=!0;else if(c.path[c.level].toString()===o.path[c.level].toString()){var l=F(e,c,n);r.index+=l.index+1,r.finish=l.finish}else r.index+=E(e,c,!0);if(r.finish)break}return r}function T(e,t,n){var r=e.getItem(t);if(!r)return null;var o=void 0,i=void 0;r.group&&(o={path:r.group.path,area:r.groupArea}),r.node&&(i={path:r.node.path,area:r.nodeArea});var a=e.uid,u=r.row,c=[];return r.isNewRow&&(u=-1,o=null,i=null),O.each(n,function(e){c.push({area:e,id:ce.createID(a,e,u,o,i)})}),c}function M(e){var t=e.dataField;return t&&!O.startsWith(O.trim(t),"=")&&1!==t.split(",").length}var O=n(8),L=n(10),P=n(11),G=n(13),B="groupHeader",k="groupFooter",U="groupContent",H="nodeFooter",V="nodeContent",j="viewport",W="pinnedLeftViewport",z="pinnedRightViewport",Y=["pageX","pageY","clientX","clientY","target"],q="mouseup",X="mousemove",$="mousedown",K="mousewheel",J="click",Z="dblclick",Q=P.regist,ee=P.unRegist,te="bottom",ne="groupDescriptor",re="header",oe="visible",ie="footer",ae="location",ue="top",ce={},le={viewport:"",pinnedLeftViewport:"pl",pinnedRightViewport:"pr",rowHeader:"rh",columnHeader:"ch",pinnedLeftColumnHeader:"plch",pinnedRightColumnHeader:"prch",columnHeaderRow:"chRow",pinnedLeftColumnHeaderRow:"plchRow",pinnedRightColumnHeaderRow:"prchRow",gantt:"gt",ganttHeader:"gth",groupHeader:"gh",groupFooter:"gf",groupContent:"gr",nodeFooter:"nf",nodeContent:"nr",pl:W,pr:z,rh:"rowHeader",ch:"columnHeader",plch:"pinnedLeftColumnHeader",prch:"pinnedRightColumnHeader",chRow:"columnHeaderRow",plchRow:"pinnedLeftColumnHeaderRow",prchRow:"pinnedRightColumnHeaderRow",gt:"gantt",gth:"ganttHeader",gh:"groupHeader",gf:"groupFooter",gr:"groupContent",nf:"nodeFooter",nr:"nodeContent",corner:"corner"};ce.gCHL_=t,ce.poIP_=r,ce.poI_=o,ce.iTAC_=i,ce.hG_=a;var se=function(){function e(e,n){i=(new Date).getTime(),o=!1,a=1e3*e,u=n,c&&l?l(t):setTimeout(t,16.6)}function t(){var e=(new Date).getTime(),r=e-i,s=function(e){u(e||n(r,0,1,a))};return r>=a||o?void s(1):(s(),void(c&&l?l(t):setTimeout(t,16.6)))}function n(e,t,n,r){return e/=r/2,1>e?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)}function r(){o=!0}var o,i=0,a=0,u=null,c=0,l=window.requestAnimationFrame||window.webkitRequestAnimationFrame;return{play:e,stop:r}}();ce.ani=se,ce.tT=u,ce.tN_=c,ce.hHF_=l,ce.gIAS_=s,ce.hPC_=f,ce.gGCBC_=d,ce.gGCHW_=p,ce.gLGIP_=h,ce.gUERT_=g,ce.gUT_=v,ce.createID=m,ce.parseID=y,ce.ci_=C,ce.iEOSA_=b;var fe=function(){function e(e){var t=this;t.options=O.defaultsDeep(e||{},{headerTemplate:null,footerTemplate:null,contentTemplate:null,draggable:!1,showOverlay:!0,parent:null}),t.init_()}function t(){var e=this;e.handleClick_=o.bind(e),e.handleMouseDown_=i.bind(e),e.handleMouseWheel_=a.bind(e),e.handleMouseUp_=c.bind(e),e.handleMouseMove_=l.bind(e),e.handleKeyDown_=p.bind(e),e.handleKeyUp_=h.bind(e),e.handleDoubleClick_=r.bind(e),e.tsFn_=u.bind(e),e.teFn_=f.bind(e),e.tmFn_=s.bind(e);var t=e.container;Q(t,J,e.handleClick_),Q(t,Z,e.handleDoubleClick_),Q(t,$,e.handleMouseDown_),Q(t,K,e.handleMouseWheel_),Q(t,q,e.handleMouseUp_),Q(t,X,e.handleMouseMove_),Q(t,"keydown",e.handleKeyDown_),Q(t,"keyup",e.handleKeyUp_),G(t).on("touchstart",e.tsFn_),G(t).on("touchend",e.teFn_),G(t).on("touchmove",e.tmFn_)}function n(){var e=this,t=e.container;ee(t,J,e.handleClick_),ee(t,Z,e.handleDoubleClick_),ee(t,$,e.handleMouseDown_),ee(t,K,e.handleMouseWheel_),ee(t,q,e.handleMouseUp_),ee(t,"keydown",e.handleKeyDown_),ee(t,"keyup",e.handleKeyUp_),ee(t,X,e.handleMouseMove_),G(t).off("touchstart",e.tsFn_),G(t).off("touchend",e.teFn_),G(t).off("touchmove",e.tmFn_),ee(t.querySelector(".gc-popup-first-tab"),"focus",e.fFE_),ee(t.querySelector(".gc-popup-last-tab"),"focus",e.fLE_)}function r(e){g.call(this,e,"doubleclick")}function o(e){g.call(this,e,J)}function i(e){g.call(this,e,$)}function a(e){g.call(this,e,K)}function u(e){g.call(this,d(e),$)}function c(e){g.call(this,e,q)}function l(e){g.call(this,e,X)}function s(e){g.call(this,e,"touchmove")}function f(e){g.call(this,d(e),q)}function d(e){var t=O.pick(e.changedTouches[0],Y);return t.stopPropagation=function(){e.stopPropagation()},t.preventDefault=function(){e.preventDefault()},t.deviceType="touch",t}function p(e){g.call(this,e,"keydown")}function h(e){g.call(this,e,"keyup")}function g(e,t){var n=this;if(e.target){n.options.parent&&e.stopPropagation();for(var r=O.keys(n.eventCache_),o=e.target,i=o.tagName.toLowerCase(),a=o.className?o.className.split(" "):[],u=[];"body"!==i;)u=u.concat(O.intersection(r,a)),o=o.parentNode,i=o.tagName.toLowerCase(),a=o.className?o.className.split(" "):[];var c,l,s;O.each(u,function(r){for(c=n.eventCache_[r][t],s=c?c.length:0,l=0;s>l;l++)c[l](e)})}}function v(e){var t=this;"touch"===e.deviceType?(t.docTouchMoveHandler_=_.bind(t),t.docTouchEndHandler_=b.bind(t),G(document).on("touchmove",t.docTouchMoveHandler_),G(document).on("touchend",t.docTouchEndHandler_)):(t.docMouseMoveHandler_=m.bind(t),t.docMouseUpHandler_=C.bind(t),window.PointerEvent?(Q(document,"pointermove",t.docMouseMoveHandler_),Q(document,"pointerup",t.docMouseUpHandler_),document.body.setPointerCapture(e.pointerId)):(Q(document,X,t.docMouseMoveHandler_),Q(document,q,t.docMouseUpHandler_)));var n=t.container,r=L.gER(n),o=L.gCSV(n),i=o.marginTop,a=o.marginLeft,u=L.getBodyStyle();t.startMoveInfo_={mouseOffset:{left:e.pageX,top:e.pageY},containerCSSOffset:{left:r.left-a-u.left,top:r.top-i-u.top},containerRect:r,viewportRect:{left:0,top:0,width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}}}function m(e){y.call(this,e)}function _(e){y.call(this,d(e))}function y(e){var t=this;e.preventDefault();var n=t.startMoveInfo_;if(n){var r=n.mouseOffset,o=n.viewportRect,i=n.containerRect,a=e.pageX-r.left,u=e.pageY-r.top,c=i.left,l=o.left,s=i.width,f=o.width,d=i.top,p=o.top,h=i.height,g=o.height;c+s+a>l+f&&(a=l+f-c-s),l>c+a&&(a=l-c),d+h+u>p+g&&(u=p+g-d-h),p>d+u&&(u=p-d),L.setCss(t.container,{left:n.containerCSSOffset.left+a,top:n.containerCSSOffset.top+u})}}function C(e){S.call(this,e)}function b(e){S.call(this,d(e))}function S(e){var t=this;t.startMoveInfo_=null,"touch"===e.deviceType?(G(document).off("touchmove",t.docTouchMoveHandler_),G(document).off("touchend",t.docTouchEndHandler_),t.docTouchMoveHandler_=null,t.docTouchEndHandler_=null):(window.PointerEvent?(document.body.releasePointerCapture(e.pointerId),ee(document,"pointermove",t.docMouseMoveHandler_),ee(document,"pointerup",t.docMouseUpHandler_)):(ee(document,X,t.docMouseMoveHandler_),ee(document,q,t.docMouseUpHandler_)),t.docMouseMoveHandler_=null,t.docMouseUpHandler_=null)}function w(){var e=this,t=e.tabbableElements=e.container.querySelectorAll("a[href]:not([disabled]), area[href]:not([disabled]), button:not([disabled]), input:not([disabled]), select:not([disabled]),textarea:not([disabled]),[tabindex]:not([disabled])"),n=e.options.setTabOrder,r=0;if(n)r=n(t,2)+1;else{for(var o=0,i=t.length;i>o;o++)t[o].setAttribute("tabindex",o+2);r=t.length+2}var a=e.container,u=L.createElement('<div class="gc-popup-first-tab" tabindex="1"></div>'),c=L.createElement('<div class="gc-popup-last-tab" tabindex="'+r+'"></div>');a.insertBefore(u,a.childNodes[0]),a.appendChild(c),e.fFE_=I.bind(e),e.fLE_=x.bind(e),Q(u,"focus",e.fFE_),Q(c,"focus",e.fLE_)}function I(){this.tabbableElements[this.tabbableElements.length-1].focus()}function x(){this.tabbableElements[0].focus()}return e.prototype={init_:function(){var e=this,n=e.options;e.container=L.createElement('<div class="gc-popup-dialog" tabindex="1"></div>');var r,o=e.container,i=L.createElement,a=L.addClass;if(n.headerTemplate&&(r=i(n.headerTemplate),a(r,"gc-popup-header"),o.appendChild(r)),n.contentTemplate){var u=i(n.contentTemplate);a(u,"gc-popup-content"),o.appendChild(u)}if(n.footerTemplate){var c=i(n.footerTemplate);a(c,"gc-popup-footer"),o.appendChild(c)}n.draggable&&r&&(window.PointerEvent?r.addEventListener("pointerdown",v.bind(e)):r.addEventListener($,v.bind(e))),t.call(e)},open:function(){var e=this,t=e.options,n=t.parent||document.body;t.showOverlay&&(e.overlay_=L.createElement('<div class="gc-popup-overlay"></div>'),n.appendChild(e.overlay_)),n.appendChild(e.container),w.call(e)},close:function(){var e=this;n.call(e);var t=e.overlay_;e.options.showOverlay&&t.parentNode.removeChild(t);var r=e.container,o=e.container.parentNode;o&&o.removeChild(r)},mount:function(e,t,n){var r=this;r.eventCache_=r.eventCache_||{};var o=r.eventCache_;o[e]=o[e]||{},o[e][t]=o[e][t]||[];var i=o[e][t];-1===i.indexOf(n)&&i.push(n)}},e}();ce.popup=fe,ce.gRE_=S,ce.getIdList=w,ce.gUER_=I,ce.hVS=x,ce.hHS=A,ce.gNRC_=E,ce.gGRC_=R,ce.vi=N,ce.getRowIDByViewIndex=T,ce.isMultiFieldColumn=M,e.exports=ce}()},function(e,t){"use strict";!function(t){function n(e){return new r(e)}function r(e){this.element=e}function o(){function e(e,t,n,r,o,i,a,u){var c=this;c.identifier=e,c.target=t,c.screenX=n,c.screenY=r,c.clientX=o,c.clientY=i,c.pageX=a,c.pageY=u}function t(e){var t,n;for(t=0,n=a.length;n>t;t+=1)if(a[t].identifier===e)return a[t]}function n(e){var t,n;for(t=0,n=a.length;n>t;t+=1)if(a[t].identifier===e.identifier)return void(a[t]=e);a.push(e)}function r(e){var t,n;for(t=0,n=a.length;n>t;t+=1)a[t].identifier===e&&(a.splice(t,1),n=a.length)}function o(){for(;a.length>0;)a.pop()}function i(e,t){var n;for(n=0;n<a.length;n+=1)if(a[n].screenX===e&&a[n].screenY===t)return!0;return!1}var a=[],u=this;u.touchList=a,u.Touch=e,u.getTouch=t,u.addUpdateTouch=n,u.removeTouch=r,u.clearTouches=o,u.containsTouchAt=i}function i(e,n,r,o,i){if(i)e.addEventListener(n,r,!1),t.cachedEvents||(t.cachedEvents=[]),t.cachedEvents.push({element:e,event:n,handler:r,uid:o});else{if(!t.cachedEvents)return;for(var a=0,u=t.cachedEvents.length;u>a;a++){var c=t.cachedEvents[a];if(c.uid===r.uid){c.element.removeEventListener(c.event,c.handler);break}}t.cachedEvents.splice(a,1),0===t.cachedEvents.length&&delete t.cachedEvents}}function a(e,t){function n(e,t){var n,r;for(v.clearTouches(),n=0;n<t.length;n++)r=t[n],r.target.isSameNode(e)&&v.addUpdateTouch(r)}function r(e){var t,r,o;t=a(e)?"touchstart":"touchmove",r=new h.Touch(e.pointerId,a(e)?e.target:p,e.screenX,e.screenY,e.clientX,e.clientY,e.pageX,e.pageY),e.hwTimestamp>_&&!function(){var e,t,n,r,o;for(t=g.touchList,e=0;e<t.length;e+=1)n=t[e],o=n.identifier,r=h.getTouch(o),r&&!s(r,n)||g.removeTouch(o)}();var u=e.pointerId;return a(e)?("input"!==r.target.tagName.toLowerCase()&&"textarea"!==r.target.tagName.toLowerCase()&&("MSPointerDown"===e.type?r.target.msSetPointerCapture(u):r.target.setPointerCapture(u)),h.clearTouches(),i("pointerDown timstap:"+e.hwTimestamp+" pointerId: "+e.pointerId)):i("pointerMove timstap:"+e.hwTimestamp+" pointerId: "+e.pointerId),h.addUpdateTouch(r),g.addUpdateTouch(r),n(r.target,h.touchList),o=new CustomEvent(t,{bubbles:!0,cancelable:!0}),o.touches=h.touchList,o.changedTouches=g.touchList,o.targetTouches=v.touchList,o}function o(e){var t,r,o;return e.changedTouches=[],e.changedTouches.length=1,e.changedTouches[0]=e,e.changedTouches[0].identifier=e.pointerId,r=new h.Touch(e.pointerId,p,e.screenX,e.screenY,e.clientX,e.clientY,e.pageX,e.pageY),c(e)&&(t="touchend","MSPointerUp"===e.type?r.target.msReleasePointerCapture(e.pointerId):r.target.releasePointerCapture(e.pointerId)),e.hwTimestamp>_&&g.clearTouches(),h.removeTouch(r.identifier),g.addUpdateTouch(r),n(r.target,h.touchList),o=new CustomEvent(t,{bubbles:!0,cancelable:!0}),o.touches=h.touchList,o.changedTouches=g.touchList,o.targetTouches=v.touchList,
o}function i(e){m&&console.log(e)}function a(e){return"MSPointerDown"===e.type||"pointerdown"===e.type}function u(e){return"MSPointerMove"===e.type||"pointermove"===e.type}function c(e){return"MSPointerUp"===e.type||"pointerup"===e.type}var f,d,p,m=!1;l(e)||(a(e)||(d=h.getTouch(e.pointerId),p=d?d.target:e.target),f=a(e)||u(e)?r(e):o(e),f.preventDefault=function(){e.preventDefault&&e.preventDefault()},f.stopPropagation=function(){e.stopPropagation&&e.stopPropagation()},t.call(e.target,f),_=e.hwTimestamp)}function u(e){return y[e][C]}function c(e,t){var n="on"+t.toLowerCase();return n in e||e.hasOwnProperty(n)}function l(e){return"mouse"===e.pointerType||4===e.pointerType?!0:"pointerdown"===e.type&&0===e.x&&0===e.y?!0:"pen"===e.pointerType&&0===e.pressure&&"pointermove"===e.type}function s(e,t){return e.screenX===t.screenX&&e.screenY===t.screenY}function f(e){e&&e.style&&(t.MSPointerEvent?e.style.setAttribute("-ms-touch-action","none;"):e.style.touchAction="none")}function d(e){e&&e.style&&(t.MSPointerEvent?e.style.removeAttribute("-ms-touch-action"):e.style.touchAction=null)}function p(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}var h,g,v,m=["touchstart","touchmove","touchend"],_=0,y={touchstart:["pointerdown","MSPointerDown","touchstart"],touchmove:["pointermove","MSPointerMove","touchmove"],touchend:["pointerup","MSPointerUp","touchend"]},C=t.PointerEvent?0:t.MSPointerEvent?1:2;r.prototype={on:function(e,t){var n=this.element;if(-1===m.indexOf(e))return void n.addEventListener(e,t);if(c(n,e))return void n.addEventListener(e,t);var r=u(e);if(c(n,r)){var o=function(n){a(n,t,e)},l=p();t.uid=l,i(n,r,o,l,!0),f(n)}},off:function(e,t){var n=this.element;return-1===m.indexOf(e)?void n.removeEventListener(e,t):c(n,e)?void n.removeEventListener(e,t):(i(n,e,t,!1),void d(n))}},h=new o,g=new o,v=new o,e.exports=n}(window)},function(e,t,n){"use strict";!function(){var t=n(8),r=function(e,t,n){if(!n)return console.error("no components applied to dataView"),!1;var r=this;r.options=e,r.components={},r.classes={},r.registerBases(t),r.registerComponents(n)};r.prototype={getOptions:function(e){return this.options[e]},getComponent:function(e){return this.components[e]},getInstance:function(e){var t=this.getComponent(e);return t&&t.instance},getComponentName:function(e){var n=t.property(["prototype","metaData_","className"])(e);if(n)return n;var r=e.toString();return r.substring(9,r.indexOf("("))},registerBases:function(e){var n=this,r=function(e){var t=e.Constructor.prototype.metaData_;if(t){var r=n.getComponentName(e.Constructor);n.classes[r]={Constructor:e.Constructor,components:[t.cid]},n.components[t.cid]={Constructor:e.Constructor,cid:t.cid,instance:e.instance,dependencies:t.dependencies,lackDependencies:!1}}};t.each(e,r)},registerComponents:function(e){var n=this,r=function(e){e&&e.prototype&&e.prototype.metaData_&&n.createOrExtendComponent(e)};t.each(e,r),t.each(n.components,n.checkDependence.bind(n)),n.availableComponents=t.filter(n.components,function(e){return!e.lackDependencies}),t.each(n.availableComponents,n.initializeComponent.bind(n))},extendComponent:function(e,n){t.extend(e.prototype,n.prototype)},createOrExtendComponent:function(e){var t=this,n=t.getComponentName(e),r=e.prototype.metaData_;t.classes[n]?t.extendComponent(t.classes[n],e):(t.classes[n]={Constructor:e,components:[r.cid]},t.components[r.cid]={Constructor:e,cid:r.cid,instance:null,dependencies:r.dependencies,lackDependencies:!0})},checkDependence:function(e){var n=this;return t.isString(e)&&(e=n.getComponent(e)),e?e.lackDependencies===!1?!0:(e.lackDependencies=!(!e.dependencies||0===e.dependencies.length||t.every(e.dependencies,n.checkDependence.bind(n))),!0):!1},initializeComponent:function(e){var n=this;if(t.isString(e)&&(e=n.getComponent(e)),!e)return!1;if(e.instance)return e.instance;e.dependencies&&e.dependencies.length>0&&t.each(e.dependencies,n.initializeComponent.bind(n));var r=e.instance=new e.Constructor(n);return n.attachContext(e),r.init&&r.init(),r},attachContext:function(e){var n=this,r=e.instance;r.context_=n,r.dependencies=t.map(e.dependencies,n.getComponent.bind(n))}},e.exports=r}()},function(e,t,n){"use strict";!function(){function t(e){var t=this;t.options=e.options;var n=e.getInstance("dataView");t.uid=n.uid,t.overLayShown_=!1,t.loadIconShown_=!1,t.layoutName_=n.layoutEngine.className,t.groupStrategyName_=t.options.groupStrategy?t.options.groupStrategy.className:"",t.className_=t.options.className?t.options.className:"gc-grid"}var r=n(10),o=n(8);t.prototype={init:function(){var e=this;e.buildContainer(),e.registerReadyListener()},buildContainer:function(){var e=this,t=e.context_.getInstance("dataView"),n=e.options,r=" "+t.layoutEngine.className+" "+(n.groupStrategy?n.groupStrategy.className:""),o='<div role="grid" id="'+e.uid+'" class="'+(n.className?n.className:"gc-grid")+r+'"><div class="gc-grid-container"></div>',i=e.getContainerSize().contentRect,a=(i.height-240)/2,u=(i.width-240)/2;o+='<div id="'+e.uid+'-loadIcon" style="top:'+a+"px;left:"+u+"px;width:240px;height:240px;position:absolute;"+(e.loadIconShown_?"":"display:none")+'"><div class="loader"></div></div>',o+="</div>",t.container.innerHTML=o,e.container_=t.container.querySelector("#"+e.uid),e.contentContainer_=e.container_.querySelector(".gc-grid-container"),e.loadIcon_=e.container_.querySelector("#"+e.uid+"-loadIcon")},updateContainer:function(){var e=this,t=e.context_.getInstance("dataView");e.clearContainerCache();var n=r.gCoR(t.container),i=t.layoutEngine.className,a=e.options.groupStrategy?e.options.groupStrategy.className:"",u=e.options.className?e.options.className:"gc-grid",c=n.height,l=n.width,s=t.options.rightToLeft,f=!o.isEqual([e.layoutName_,e.groupStrategyName_,e.className_],[i,a,u]),d=!o.isEqual([e.contentHeight_,e.contentWidth_,e.contentRtl_],[c,l,s]);f&&(e.layoutName_=i,e.groupStrategyName_=a,e.className_=u,e.container_.className=[i,a,u].join(" ")),d&&(e.contentHeight_=c,e.contentWidth_=l,e.contentRtl_=s,e.container_.style.height=c+"px",e.container_.style.width=l+"px",e.container_.style.direction=t.options.rightToLeft?"rtl":"ltr")},getContainerSize:function(){var e=this,t=e.context_.getInstance("dataView");if(e.containerRect_)return{contentRect:e.containerRect_()};var n=r.gCoRFn(t.container),o=t.layoutEngine,i=r.createElement('<div class="gc-grid '+o.className+(o.gS_?" "+o.gS_.className:"")+'"></div>');document.body.appendChild(i);var a=r.gCSV(i);return document.body.removeChild(i),e.containerRect_=function(){var e=n();return{left:e.left+(a.paddingLeft+a.borderLeftWidth+a.marginLeft),top:e.top+(a.paddingTop+a.borderTopWidth+a.marginTop),width:e.width-Math.ceil(a.paddingLeft+a.paddingRight+a.borderLeftWidth+a.borderRightWidth+a.marginLeft+a.marginRight),height:e.height-Math.ceil(a.paddingTop+a.paddingBottom+a.borderTopWidth+a.borderBottomWidth+a.marginTop+a.marginBottom)}},{contentRect:e.containerRect_()}},clearContainer:function(){var e=this;e.clearContainerCache();var t=e.context_.getInstance("dataView");t.container.innerHTML=""},clearContainerCache:function(){this.containerRects_=null},showLoadingOverlay:function(){var e=this;e.loadIcon_.style.display="",e.loadIconShown_=!0},hideLoadingOverlay:function(){var e=this;e.loadIcon_.style.display="none",e.loadIconShown_=!1},showLoadIcon:function(){var e=this;if(!e.loadIconShown_){var t=e.context_.getInstance("dataView"),n=t.options.updateOverlayStatusCallback;n?(e.loadIconShown_=!0,n({newStatus:"show"})):e.showLoadingOverlay()}},hideLoadIcon:function(){var e=this;if(e.loadIconShown_){var t=e.context_.getInstance("dataView"),n=t.options.updateOverlayStatusCallback;n?(e.loadIconShown_=!1,n({newStatus:"hide"})):e.hideLoadingOverlay()}},registerReadyListener:function(){var e=this,t=e.context_.getInstance("dataView");e.readyHandler_=e.updateContainer.bind(e),t.or_.addHandler(e.readyHandler_,e)},unregisterReadyListener:function(){var e=this,t=e.context_.getInstance("dataView");t.or_.removeHandler(e.readyHandler_,e),e.readyHandler_=null},destroy:function(){var e=this;e.unregisterReadyListener(),e.clearContainer()}},o.extend(t.prototype,{metaData_:{cid:"containerWrapper",className:"ContainerWrapper",dependencies:["dataView"]}}),e.exports=t}()},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){function t(e,t){var n=this;n.clearMemo(),"all"===t.changes?n.tryToLoad(!1):n.context_.getInstance("dataView").invalidate()}function i(){var e=this;e.dataCollectionChanged_.raise(e,{})}function a(e,t,n,r){fetch&&fetch(e,t)["catch"](function(e){r&&r(e)}).then(function(e){return e.json&&e.json()})["catch"](function(e){r&&r(e)}).then(n)}var u=n(8),c=n(7).Event,l=["dataSourceParser","dataSourceLength","maxRequestLength"],s={updateMultiple:"update"},f={batch:null,create:"iDIARLI_",update:"uII_","delete":"removeItemInternal_",updateMultiple:"sII_"},d={batch:"POST",create:"POST",update:"PUT","delete":"DELETE",updateMultiple:"PUT"},p={batch:["actions","successFlags"],create:["dataItems","insertAt","rollback"],update:["sourceIndex","newItem","rollback"],"delete":["removeAt","count","rollback"],updateMultiple:["sourceIndex","newItem","rollback"]},h=function(e,t,n,r,o,i,a){var u=this;u.name=e,u.HTTPName=d[e],u.transport_=t,u.success_=n,u.failed_=r,u.baseMethod_=o,u.detectChange_=i,u.dl_=a};h.prototype={execute:function(e,t,n,r){var o=this,i=o.transport_,c=o.dl_;return e=u.assign({action:o.name,toServer:!0,success:!0,params:t,needReload:!1},e),i||(e.toServer=!1),e.toServer?(n=n||{},u.assign(n,{success:function(){c.countFinish_(),u.assign(t,o.success_&&o.success_.apply(o,arguments)),o.handleResponse_(e,r)},failed:function(t){c.countFinish_(t),e.success=!1,o.handleResponse_(e,r)}}),void(u.isFunction(i)?(c.countLoad_(),i(n)):u.isString(i)?(c.countLoad_(),a(i,{method:o.HTTPName},function(e){n.success(e)},function(e){n.failed(e)})):(e.toServer=!1,o.handleResponse_(e,r)))):void o.handleResponse_(e,r)},parseArgs_:function(e){return u.map(p[this.name],function(t){return e[t]})},handleResponse_:function(e,t){var n=this;if(e.success){n.baseMethod_&&n.baseMethod_.apply(n,r(n.parseArgs_(e.params)))}t&&t(e)}};var g=function(e){var t=this;t.options=u.assign({maxRequestLength:1},u.pick(e.options,l))};g.prototype={init:function(){var e=this;e.dataChanged=new c,e.dataCollectionChanged_=new c,e.preferParser_=null,e.requestCount_=0,e.registerParsers();var t=e.context_.getInstance("dataView");e.setDataSource(t.dataSource_),e.registerEvents()},setDataSource:function(e){var t=this;t.dataSource=e,t.dsIsSimple=t.regularizeDataSource(),t.dataLength_=u.isFinite(t.options.dataSourceLength)?t.options.dataSourceLength:null,t.initActions(),t.getMemo()},initActions:function(){var e=this;e.actions_={};var t={create:function(e,t){var n={userDefinded:!(!e&&!t)};return e&&(n.dataItems=e),t&&(n.insertAt=t),n},update:function(e){var t={userDefinded:!!e};return e&&(t.newItem=e),t},"delete":function(e){var t={userDefinded:e>0};return e&&(t.count=e),t},batch:function(e){var t=!!e,n={userDefinded:t};return n.successFlags=t?u.map(e,function(e){return e.status!==!1}):!0,n.userData=t?u.map(e,function(e){return e.object}):null,n}},n=e.context_.getInstance("dataManager"),r=function(t){return"batch"===t?function(e,t){return{actions:e,successFlags:t}}:"delete"===t?e.removeItemInternal_.bind(e):(t=f[t],n[t]&&n[t].bind(n))};u.forEach(f,function(n,o){e.actions_[o]=new h(o,e.dataSource[s[o]||o],t[o],null,r(o),null,e)})},regularizeDataSource:function(){var e=this.dataSource;return!u.isNil(e.data)||u.isArray(e)||u.isString(e)},foundDataLength:function(){return u.isFinite(this.dataLength_)},getDataLength:function(){return this.dataLength_},getRowStatus_:function(e){var t=this;if(t.rowStatus_){var n=function(){var n=t.context_,r=(n.getInstance("dataManager"),e.start-t.startIndex_),o=r+e.size,i=t.deleteFlags_||[],a=u.filter(t.rowStatus_,function(e,t){return!i[t]});return{v:a.slice(r,o)}}();if("object"===("undefined"==typeof n?"undefined":o(n)))return n.v}return null},loadRange:function(e,t,n){var r=this,a=this;if(!a.dataSource||a.requestCount_>=a.options.maxRequestLength)return!1;var c=a.dataSource.loadRange,l={params:e,success:!1,cacheChanged:!1};if(c){var s=function(){var o=e&&e.forceRefresh?null:a.searchCache(e);if(o)return l.content=o,l.success=!0,l.cachedRowStatus=a.getRowStatus_(e),u.isFunction(n)&&n(l),{v:void 0};var s=r.context_.getInstance("dataView"),f=u.assign({cancel:!1},u.cloneDeep(e));if(s.beforeLoadRange.raise(s,f),f.cancel)return l.success=!1,u.isFunction(n)&&n(l),{v:void 0};a.clearMemo(),a.countLoad_();var d={};return c(u.assign(d,t,{sort:a.gSSFA_(!0),filter:a.gSSFA_(!1),success:function(t,r,o){a.countFinish_(),t&&u.isNil(r)&&!s.options.loadOnDemand&&(r=t.length),u.isFinite(r)&&a.dataLength_!==r&&(a.dataLength_=r,l.dataLengthChanged=!0,i.call(a)),l.params=u.assign({},e,u.pick(d,["start","size"])),u.isUndefined(l.params.start)&&u.isUndefined(l.params.size)&&u.isFinite(r)&&(l.params.start=0,l.params.size=r);var c=0;u.isFinite(o)&&(c=(l.params.pageIndex-o)*l.params.pageSize,c=Math.max(0,c));var f=a.parseData(t.slice(c,c+(l.params.size||0)));l.content=f,l.success=!!f,l.cacheChanged=a.addCache(t,l.params.start-c),u.isFunction(n)&&n(l)},failed:function(){a.countFinish_(),u.isFunction(n)&&n(l)}})),{v:!0}}();if("object"===("undefined"==typeof s?"undefined":o(s)))return s.v}if(a.dsIsSimple){var f=e.start,d=e.size,p=a.getMemo();return l.content=-1===d?p:p.slice(f,f+d),l.success=!!p,u.isFunction(n)&&n(l),!0}return u.isFunction(n)&&n(l),!1},loadAll:function(e){var t=this,n=t.dataLength_||t.dataMemory_&&t.dataMemory_.length,r=u.isFinite(n)?{start:0,size:n}:null;t.loadRange(r,r,e)},parseData:function(e){var t=this,n=t.options.dataSourceParser;return u.isString(n)&&t.parsers[n.toUpperCase()]?t.parsers[n.toUpperCase()](e):u.isFunction(n)?n(e):t.testParse(e,t.preferParser_)},testParse:function(e,t){var n=this;t=u.isNil?u.keys(n.parsers):u.isArray?t:[t];var r=null;return u.forEach(t,function(t){if(n.parsers.hasOwnProperty(t)){var o=null;try{o=n.parsers[t](e)}catch(i){return!0}if(u.isArray(o))return n.preferParser_=t,r=o,!1}}),!r&&n.preferParser_&&(n.preferParser_=null),r},registerParsers:function(){this.parsers={JSON:function(e){return window.JSON.parse(e)},CSV:function(e){for(var t,n,r,o=['"',"'"],i=",",a=e.split(""),c=0,l=a.length,s=[];l>c;){for(s.push(r=[]);l>c&&"\r"!==a[c]&&"\n"!==a[c];){if(t=n=c,u.indexOf(o,a[c])>-1){for(t=n=++c;l>c;){if(u.indexOf(o,a[c])>-1){if(-1===u.indexOf(o,a[c+1]))break;a[++c]=""}n=++c}for(u.indexOf(o,a[c])>-1&&++c;l>c&&"\r"!==a[c]&&"\n"!==a[c]&&i!==a[c];)++c}else for(;l>c&&"\r"!==a[c]&&"\n"!==a[c]&&i!==a[c];)n=++c;r.push(a.slice(t,n).join("")),i===a[c]&&++c}"\r"===a[c]&&++c,"\n"===a[c]&&++c}var f=s.shift();return u.map(s,function(e){return u.zipObject(f,e)})},ARRAY:function(e){return u.isArray(e)?e:null}}},searchCache:function(e){var t=this,n=t.startIndex_,r=t.dataMemory_;if(!e||!r||0===r.length)return null;var o=e.start-n;if(0>o)return null;var i=t.deleteFlags_=t.deleteFlags_||[],a=[],u=e.size||r.length,c=void 0,l=void 0,s=0,f=-1;for(l=r.length,c=0;l>c;c++)if(i[c]!==!0&&(s+=1),s===o+1){f=c;break}for(-1!==f?c=f:f=o,c=f;l>c&&(i[c]!==!0&&(a.push(r[c]),u-=1),0!==u);c++);return 0===u||c+n===t.dataLength_?a:null},addCache:function(e,t){var n=this;return n.dataMemory_=e,n.originalDataMemory_=[],n.deleteFlags_=[],n.startIndex_=t,!0},removeItemInternal_:function(e,t){var n=this,r=n.dataMemory_,o=n.originalDataMemory_||[],a=n.context_,u=a.getInstance("dataManager"),c=u.pageController,l=c?c.getStatus():{pageSize:n.dataLength_,pageIndex:0},s=e+l.pageSize*l.pageIndex-n.startIndex_,f=l.pageSize*(l.pageIndex+1)-n.startIndex_;n.deleteFlags_=n.deleteFlags_||[];var d=n.deleteFlags_,p=2*t,h=[],g=[],v=n.rowStatus_||[],m=0,_=[],y=0,C=void 0,b=void 0;for(C=0,b=d.length;b>=C;C++)if(d[C])m+=1;else{if(y===s)break;y+=1}for(s+=m,C=s,b=r.length;b>C&&(d[C]!==!0?h.length<t?(h.push(r[C]),_.push(C),d[C]=!0,p-=1):C>=f+m&&(h.push(r[C]),v&&g.push(v[C]),p-=1):h.length<=t&&(m+=1),0!==p);C++);for(var S=_.length-1;S>=0;S--){var w=_[S];o.splice(w,1),v[w]&&v[w][0]&&(d.splice(w,1),v.splice(w,1),r.splice(w,1))}var I=h.length>=t?t:h.length;n.dataLength_-=I,n.dataLength_=Math.max(n.dataLength_,0),i.call(n);var x=a.getInstance("dataManager");x.rDIAILI_(e,t,h.slice(t),g)},updateMemo_:function(e){var t=this,n=t.dataMemory_,r=t.originalDataMemory_=t.originalDataMemory_||[],o=t.deleteFlags_=t.deleteFlags_||[],a=e.action,c=t.context_,l=c.getInstance("dataManager"),s=l.pageController,f=s?s.getStatus():{pageSize:t.dataLength_,pageIndex:0},d=e.index,p=e.index+f.pageSize*f.pageIndex-t.startIndex_,h=0,g=-1,v=void 0,m=n.length,_=void 0,y=void 0,C=void 0,b=void 0;for(v=0;m>v;v++)if(o[v]!==!0&&(h+=1),h===p+1){g=v;break}-1!==g&&(p=g),t.rowStatus_=t.rowStatus_||[];var S=t.rowStatus_;if("insert"===a){for(C=u.isArray(e.item)?e.item:[e.item],_=0,y=C.length;y>_;_++)b=p+_,n.splice(b,0,C[_]),r.length>=b?r.splice(b,0,void 0):r[b]=void 0,o.length>=b?o.splice(b,0,void 0):o[b]=void 0,S.length>=b?S.splice(b,0,[!0]):S[b]=[!0],t.dataLength_+=1;i.call(t)}else"update"===a&&(r[p]||(r[p]=n[p]),n[p]=e.item,t.rowStatus_[p]=[l.isNewAddedRow(d),l.isModifiedRow(d)])},hasSortOrFilter:function(){var e=this.context_.getInstance("dataManager");return{sort:e.sortDescriptors.length>0,filter:e.filterDescriptors.length>0}},gSSFA_:function(e){var t=this.context_.getInstance("dataManager"),n=u.cloneDeep(e?t.sortDescriptors:t.filterDescriptors);return u.map(n,function(e){var n=t.calcSource_.findDataColumn(e.field);return n?u.assign(e,{field:n.field}):e})},getMemo:function(){var e=this;if(!e.dataMemory_){var t=e.dataSource.url;if(t)return void a(t,null,function(t){e.addCache(t,0),e.sync_(e.dataMemory_)});e.dataMemory_=e.dsIsSimple?e.parseData(e.dataSource):null,e.startIndex_=0}return!e.foundDataLength()&&e.dsIsSimple&&e.dataMemory_&&e.dataLength_!==e.dataMemory_.length&&(e.dataLength_=e.dataMemory_.length,i.call(e)),e.dataMemory_?e.dataMemory_.slice():null},clearMemo:function(){var e=this;e.clearBatchCache_(),e.dataMemory_&&(e.dataMemory_.length=0,e.dataMemory_=null),delete e.startIndex_},appendDataAndSync_:function(e){if(!u.isNil(e)&&u.isArray(e)){var t=this.context_.getInstance("dataManager");t.appendSource_(e)}},sync_:function(e,t,n){if(!u.isNil(e)&&u.isArray(e)){var r=this.context_.getInstance("dataView"),o=this.context_.getInstance("dataManager"),i=e.length>0?e[0]:{},a=Object.getOwnPropertyNames(i),c=!1;r.columns&&0!==r.columns.length||(c=!0),!r.columns||r.columns.length<a.length?!function(){var i=r.columns;u.each(a,function(e){-1===u.findIndex(i,function(t){return t.dataField===e})&&i.push({id:e,caption:e,dataField:e,visible:c})}),o.suspendRefresh(),o.setSource_(e,t,u.map(i,function(e){return{name:e.id,field:e.dataField,caption:e.caption,dataType:e.dataType}}),!1),r.columns=i,o.resumeRefresh(),!n&&r.invalidate()}():(r.uCT_(r.columns,e),o.setSource_(e,t,null,n))}},tryToLoad:function(e,t){var n=this;if(n.foundDataLength()&&n.dataMemory_&&n.dataMemory_.length>=n.dataLength_)return!e&&n.sync_(n.getMemo(),n.rowStatus_,!0),void(u.isFunction(t)&&t({success:!0,isLoadFinished:!0,cacheChanged:!1,content:n.getMemo()}));var r=n.dataMemory_&&n.dataMemory_.length;n.loadRange(null,{start:r||void 0,size:void 0},function(r){!e&&r.success&&n.sync_(n.getMemo()),u.isFunction(t)&&t({success:r.success,isLoadFinished:n.dataMemory_.length>=n.dataLength_,cacheChanged:r.cacheChanged,content:n.getMemo()})})},executeAction:function(e,t,n,r){var o=this,i=o.actions_[e];i&&(o.isBatchEdit()?o.cacheAction(e,t,n,r):i.execute(null,t,n,r))},isBatchEdit:function(){return this.dataSource.batchEdit},hasCachedActions:function(){var e=this,t=e.rowStatus_,n=e.deleteFlags_;if(!t&&!n)return!1;var r=void 0,o=void 0;if(n)for(r=0,o=n.length;o>r;r++)if(n[r])return!0;var i=void 0;if(t)for(r=0,o=t.length;o>r;r++)if(i=t[r],i&&(i[0]===!0||i[1]===!0))return!0;return!1},cacheAction:function(e,t,n,r){var o=this;"create"===e&&(t.insertAt=0);var i=o.actions_[e];i&&i.execute({toServer:!1},t,n,r)},rollbackBatch:function(e){var t=this,n=t.getHeldActions_();if(n&&0!==n.length){for(var r=t.originalDataMemory_,o=t.dataMemory_,a=t.deleteFlags_||[],u=t.rowStatus_||[],c=void 0,l=void 0,s=[],f=!1,d=0,p=n.length;p>d;d++)c=n[d],l=c.sourceIndex,"update"===c.type?o[l]=r[l]:"delete"===c.type?(a[l]=void 0,u[l]&&u[l][0]?s.push(l):u[l]&&u[l][1]&&(o[l]=r[l]),t.dataLength_+=1,f=!0):"create"===c.type&&(s.push(l),f=!0);for(var h=s.length-1;h>=0;h--)o.splice(s[h],1),t.dataLength_-=1;f&&i.call(t),t.clearBatchCache_();var g=t.context_.getInstance("dataView");g.data.pageController?g.data.pageController.reload(!1):t.tryToLoad(!1)}},batchEdit:function(e){var t=this;if(t.hasCachedActions()){var n=t.originalDataMemory_,r=t.dataMemory_,o=t.deleteFlags_||[],i=t.rowStatus_||[],a=t.getHeldActions_(),u=t.actions_.batch,c=void 0,l=[];u.execute(null,{actions:a},{actions:a},function(u){var s=u.success?u.params.successFlags:null;if(s){s.length!==a.length;for(var f=0,d=a.length;d>f;f++)c=a[f],s[f]&&("update"===c.type?(n[c.sourceIndex]=null,i[c.sourceIndex][1]=void 0):"create"===c.type?(i[c.sourceIndex][0]=void 0,u.params.userData&&u.params.userData[f]&&(r[c.sourceIndex]=u.params.userData[f])):"delete"===c.type&&l.push(c.sourceIndex));for(var p=void 0,h=l.length-1;h>=0;h--)p=l[h],o.splice(p,1),r.splice(p,1),n.splice(p,1),i.splice(p,1);var g=t.context_.getInstance("dataView");g.data.pageController?g.data.pageController.reload(!1):t.tryToLoad(!1)}e&&e(u)})}},getHeldActions_:function(){var e=this;if(!e.hasCachedActions())return null;var t,n=[],r=e.dataMemory_,o=e.rowStatus_||[],i=e.deleteFlags_||[],a=e.originalDataMemory_,u=void 0,c=void 0;for(u=0,c=r.length;c>u;u++)t=o[u],i[u]===!0?n.push({type:"delete",dataItem:r[u],sourceIndex:u}):t&&t[0]?n.push({type:"create",dataItem:r[u],sourceIndex:u}):t&&t[1]&&n.push({type:"update",dataItem:r[u],oldDataItem:a[u],sourceIndex:u});return n},clearBatchCache_:function(){var e=this;e.rowStatus_&&(e.rowStatus_.length=0),e.deleteFlags_&&(e.deleteFlags_.length=0),e.originalDataMemory_&&(e.originalDataMemory_.length=0)},countLoad_:function(){var e=this;e.requestCount_++,e.context_.getInstance("containerWrapper").showLoadIcon()},countFinish_:function(){var e=this;--e.requestCount_<=0&&(e.context_.getInstance("containerWrapper").hideLoadIcon(),e.requestCount_=0)},registerEvents:function(){var e=this,n=e.context_.getInstance("dataView");e.readyHandler_=function(){e.tryToLoad(!1)},e.dataChanged.addHandler(t,e),n.or_.addHandler(e.readyHandler_,e)},unregisterEvents:function(){var e=this,n=e.context_.getInstance("dataView");e.dataChanged.removeHandler(t,e),n.or_.removeHandler(e.readyHandler_,e),e.dataChangedHandler_=null,e.readyHandler_=null},destroy:function(){var e=this;e.unregisterEvents(),e.clearMemo(),e.preferParser_=null}},u.extend(g.prototype,{metaData_:{cid:"dataLoader",className:"DataLoader",dependencies:["dataView","dataManager"]}}),e.exports=g}()},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){function t(e,t){return e.data.isCalculatedColumn(t.id)?t.id:t.dataField}function o(e){var t=e,n=t.options.cellRect.height;if(t.type_===q.Date){var r=10,o=j.getStyle(t.$input),i=parseFloat(o.getPropertyValue("border-top-width")),a=parseFloat(o.getPropertyValue("border-bottom-width"));if(!isNaN(i)&&!isNaN(a)){var u=(n-i-a)/2-r;t.$input.style.padding=u+"px 0px"}}}function i(e,t){if(!W.isNil(e)){if(t=t.toLowerCase(),W.isString(e))switch(t){case"number":var n=parseFloat(e);return isNaN(n)?e:n;case"date":var r=e.split("-");return new Date(parseInt(r[0]),parseInt(r[1])-1,parseInt(r[2]));case"boolean":return"true"===e.toLowerCase()}if("string"===t)return e.toString()}return e}function a(e,t){var n,r=this,o=e.options.editMode,a=r.editors_[t],c=a.options,l=e.columns[t];if(a.serialize)return a.serialize();if(o===$.Inline){var s=e.data.isCalculatedColumn(c.col.id);n=u(c.container.querySelector("input"),X.getEditorType(s?null:c.col.dataType))}else n=u(a,a.type);var f=l.dataType,d=r.middleItem;return f||(f=W.getType(V.get(d,l.dataField))),f?i(n,f):n}function u(e,t){var n=e.value,r=e.tagName.toLowerCase();if("input"===r){if(t===q.CheckBox)return e.checked;if(t===q.Date){var o=W.toDate(n);if(isNaN(o.getTime()))return}}return""!==n?n:void 0}function c(e,t,n){for(var r,o,i,a,u=0,c=n.length;c>u;u++)r=n[u],a=r.id,i=r.dataField,o=t[a],i!==o&&(r.dataField=o,e.data.editCalculatedColumn(a,o))}function l(e,t,n){for(var r,o,i=V.cloneDeep(t),a=W.isArray(t),u=0,c=n.length;c>u;u++)r=n[u],o=r.id,a?V.each(i,function(e){delete e[o]}):delete i[o];return i}function s(e,t){var n,r,o,i,a=this,u=t.querySelectorAll("[data-column]"),c=e.columns,l=a.editors_;for(n=0,o=u.length;o>n;n++)i=e.gCBI_(u[n].getAttribute("data-column")),r=c.indexOf(i),r>=0&&!l[r]&&(l[r]=u[n])}function f(e,t,n){var r=this,o=e.columns,i=e.options;if(!i.allowEditing||!t)return!1;var a="row"!==i.editUnit;if(!Y.iEOSA_(t,a))return!1;var u=t.groupInfo,c=u?u.action:t.action;if(e.hasEditAction_&&!n&&(!c||"edit"!==c.name||r.isEditing_))return!1;if(a){var l=u?u.column:t.column;return B(e,o[l])}var s=V.filter(o,function(e){return e.allowEditing===!1});return s.length!==o.length}function d(e,t,n){var r=this;if(!t)return!0;if(m.call(r,e)&&r.isEditing_){var o=t.groupInfo,i=o?o.action:t.action;return e.hasEditAction_&&!n?i&&"save"===i.name:!0}}function p(e,n,r){var o=this;if(!n)return null;var i=C(e),a=document.createElement("textarea");n=V.cloneDeep(n,g);var u=function(t){return o.isColumnEditable(e,t)&&!e.data.isCalculatedColumn(t.id)},c=function(n,r){var o=V.get(n,t(e,r));return u(r)&&(W.isString(o)?(a.textContent=o,o=a.innerHTML):W.isNil(o)&&(o="")),o};return r?c(n,r):(V.each(i,function(r){var o=t(e,r);o&&V.set(n,o,c(n,r))}),n)}function h(e,n,r){var o=this;if(!n)return null;var i=C(e),a=document.createElement("textarea"),u=function(t){return o.isColumnEditable(e,t)&&!e.data.isCalculatedColumn(t.id)},c=function(n,r){var o=V.get(n,t(e,r));return u(r)&&W.isString(o)&&(a.innerHTML=o,o=a.textContent),o};return r?c(n,r):(V.each(i,function(r){var o=t(e,r);o&&V.set(n,o,c(n,r))}),n)}function g(e,t){var n=["node","dataItem","calcItem"];return-1!==n.indexOf(t)?e:void 0}function v(e){var t=this;return t.activeGridUID||(t.activeGridUID=e.uid),t.activeGridUID===e.uid}function m(e){return this.activeGridUID&&this.activeGridUID===e.uid}function _(e){var t=this;t.activeGridUID&&t.activeGridUID===e.uid&&(t.activeGridUID="")}function y(e,n,r,o,i){var a=this,u=e.layoutEngine,c=u.options,l=c.editMode,s=c.cellMergingSettings.onlyShowFirstRow,f=e.columns,d={newItems:n,oldItems:r},p=u.spanRelations_;return l!==$.Inline||!p||s||o.isNewRow||!function(){var u=[];V.each(f,function(o){n&&r&&V.get(r,t(e,o))===h.call(a,e,n,o)||u.push(o)});var c=o.groupInfo,l=Y.vi(e,c?c.row:o.row,c,o.nodeInfo),s=p[l],g=void 0,v=void 0,m={},_=[l,l],y=void 0;V.each(u,function(n){var r=[l,l];if(y=V.find(s,function(e){return e.field===n.id}))for(v=g=y.anchorRow,r[0]=Math.min(r[0],g),_[0]=Math.min(_[0],g);y&&g===y.anchorRow;)r[1]=Math.max(r[1],v),_[1]=Math.max(_[1],v),v++,y=V.find(p[v],function(e){return e.field===n.id});m[t(e,n)]=r});for(var C=void 0,b=void 0,S=[],w=[],I=[],x=[],A=[],E=[],R=e.data.sourceCollection,N=void 0,D=function(t){C=e.getItem(t),C.item&&(N=C.item.sourceIndex,x.push(N),b=R[N],S.push(V.cloneDeep(b)),b=V.cloneDeep(b),V.each(m,function(e,r){t>=e[0]&&t<=e[1]&&V.set(b,r,V.get(n,r))}),w.push(b),!W.isNil(C.row)&&I.push(C.row),C.group&&A.push({area:"groupContent",path:C.group.path}),C.node&&E.push({area:"nodeContent",path:C.node.path}))},F=_[0];F<=_[1];F++)D(F);var T=void 0,M=void 0,O=void 0;V.each(i,function(e){O=e.id,T=V.get(n,O),M=V.get(r,O),T&&V.each(w,function(e){V.set(e,O,T)}),M&&V.each(S,function(e){V.set(e,O,M)})}),S.length&&(d.oldItems=S),w.length&&(d.newItems=w),I.length&&(d.rows=I),x.length&&(d.sourceIndies=x),A.length&&(d.groupInfo=A),E.length&&(d.nodeInfo=E)}(),d}function C(e){var t=e.columns;return V.filter(t,function(t){return B(e,t)})}function b(e,t,n,r){var o=e.uid,i={},a=[K,J,Z],u=void 0,c=void 0,l=void 0;return V.each(a,function(e){u=Y.createID(o,e,t,n,r),c=document.getElementById(u),l=e===J?"left":e===Z?"right":"none",i[l]={key:u,rect:c&&j.gER(c)}}),i}function S(e){var t,n,r,o,i,a,u,c,l,s,f,d=this,p=e.layoutEngine,h=w.call(d,e)||p.gDET_(),g=j.createTemplateElement(h),v=j.getElementInnerText(g),m=g.querySelectorAll("[data-column]");for(a=0,l=m.length;l>a;a++){t=m[a],r=j.getElementOuterText(t),n=t.tagName.toLowerCase();var _=t.getAttribute("data-column");if("textarea"===n)t.innerHTML="{{=it."+_+"}}",o=j.getElementOuterText(t);else if("input"===n&&"checkbox"===t.type)o="<input {{? it."+_+"}}checked{{?}}"+r.substr(r.indexOf("<input")+6);else if("select"===n)for(i=t.options,o=r,u=0,c=i.length;c>u;u++)s=j.getElementOuterText(i[u]),f='<option value="'+i[u].value+'"{{? it.'+_+' === "'+i[u].value+'"}}selected{{?}}'+s.substr(s.indexOf("<option")+7),o=o.replace(s,f);else t.setAttribute("value","{{=it."+_+"}}"),o=j.getElementOuterText(t);o&&(o=o.replace(/"/g,"'"),v=v.replace(r,o))}return z.template(v,null,null,!0)}function w(e){var t=e.options,n=t&&t.editRowTemplate;if(n){var r=n;if(W.isString(r)&&r.length>1&&"#"===r[0]){var o=document.getElementById(r.slice(1));return o.innerHTML}return r}return null}function I(e,t){var n,r;return t&&V.each(e.columns,function(e){r=e.dataType,n=e.dataField,r&&"date"===r.toLowerCase()&&V.set(t,n,W.normalizeDate(V.get(t,n)))}),t}function x(e,t,n){var r,o=this,i=e.data,a=e.columns;if(n){var u=e.gGI_(n.path);r=u.data.getSourceRowIndex(t)}else r=i.getSourceRowIndex_(t);o.editingInfo_.sourceIndex=r;var c=V.cloneDeep(i.sourceCollection[r]);return c&&V.each(a,function(e){i.isCalculatedColumn(e.id)&&(c[e.id]=e.dataField)}),c}function A(e,n,r){var o=this,i=S.call(this,e),a=n.groupInfo,u=e.columns;o.originalItem=x.call(o,e,r,a);var c={status:"beforeStartEditing",groupInfo:a,row:r,oldItem:V.cloneDeep(o.originalItem),newItem:null,useDecodedItem:!0,cancel:!1,isNewRow:n.isNewRow};if(e.editing.raise(e,c),!c.cancel){o.middleItem=c.oldItem,c.useDecodedItem&&h.call(o,e,o.middleItem);var l,f=I.call(o,e,V.cloneDeep(o.middleItem)),d={};V.each(u,function(e){l=e.dataField,d[e.id]=V.get(f,l)});var p=i(d);e.layoutEngine.sE_(n,r,p);var g,v=e.uid,m=e.options,_=m.editMode;if(_===$.PopUp?g=document.getElementById(v+"-popup-editing-area"):_===$.EditForm&&(g=document.getElementById(v+"-form-editing-area")),!m.editRowTemplate){var y,C,w,A,E=b(e,r,a,n.nodeInfo);V.each(u,function(n,r){n.editor&&(y=g.querySelector('[data-column="'+n.id+'"]'),w=y&&j.closest(y,".gc-editing-template-field"),w&&(A=j.getElement("#"+E[n.pinned].key+' [data-column="'+n.id+'"]'),w.innerHTML="",C=new n.editor({container:w,dataview:e,col:n,cellRect:A&&j.gER(A),value:f&&V.get(f,t(e,n))}),C.init(),o.editors_[r]=C))})}return s.call(o,e,g),!0}}function E(e,n,r){var o=this,i=e.columns,a=(e.data,e.options),u=a.editUnit,c=o.editors_,l=n.groupInfo,s=n.nodeInfo,f=l?l.column:n.column,d=n.isNewRow,p=(e.uid,b(e,r,l,s));if(p[te].rect){var g=p[te].rect,v=p[Q].rect,m=p[ee].rect,_=document.querySelector("#"+e.uid+"-viewport"),y=_&&j.gER(_);o.inlineFragment=document.createDocumentFragment(),o.originalItem=x.call(o,e,r,l);var C={status:"beforeStartEditing",nodeInfo:s,groupInfo:l,row:r,oldItem:o.originalItem,useDecodedItem:!0,newItem:null,cancel:!1,isNewRow:d};if(e.editing.raise(e,C),!C.cancel){o.middleItem=V.cloneDeep(C.oldItem),C.useDecodedItem&&h.call(o,e,o.middleItem);var S,w,A,E,R,N,D,F,T,M,O,L,P=I.call(o,e,V.cloneDeep(o.middleItem)),G=[];for(F=0,T=i.length;T>F;F++)if(A=i[F],M=A.id,O=A.dataField,R=j.getElement("#"+p[A.pinned].key+' [data-column="'+M+'"]'))if(L=Y.isMultiFieldColumn(A),N=j.gER(R),
S=j.createElement('<div class="gc-inline-editor-container" style="box-sizing: border-box;" data-column="'+M+'"></div>'),j.setCss(S,{top:N.top-(v?v.top:g.top),left:N.left-(a.rightToLeft?m?m.left:g.left:v?v.left:g.left),width:N.width,zIndex:"none"===A.pinned?1:2}),e.iCV_(A,A.pinned)&&o.inlineFragment.appendChild(S),(u===ne&&f===F||u===re||d)&&o.isColumnEditable(e,A)){if(S.dataset.editing=!0,L){E={};var B,k=O.split(",");V.each(k,function(n){B=e.gCBI_(n),E[n]=P&&V.get(P,t(e,B))})}else E=P&&V.get(P,t(e,A));if(E=W.isNil(E)?"":E,D={container:S,dataview:e,col:A,cellRect:N,value:E},A.editor)w=new A.editor(D);else{w=new oe(D),S.style.height=Math.min(N.height,y.height)+"px";var U='<div style="position:absolute;left:-5000px;top:-5000px;" class="gc-grid">'+S.outerHTML+"</div>",H=j.createElement(U);document.body.appendChild(H);var z=j.gCoR(H.children[0]);document.body.removeChild(H),S.style.lineHeight=z.height+"px"}w&&(w.init(),c[F]=w,w=null)}else G.push({rowID:p[A.pinned].key,col:A,columnIndex:F,container:S,cellRect:N});return e.layoutEngine.sE_(n,r),V.each(G,function(e){S=e.container,A=e.col;var t={height:e.cellRect.height+"px",border:"none"};if("none"!==A.pinned||A.action){R=j.getElement("#"+e.rowID+' [data-column="'+A.id+'"]');var n=R.cloneNode(!0);j.setCss(n,{position:"absolute",left:0,top:0,right:0,borderRight:"1px solid rgb(204,204,204)",borderBottom:"1px solid rgb(204,204,204)"}),S.appendChild(n)}else t.background="transparent";j.setCss(S,t)}),!0}}}function R(e){var t=this;e.omdc_.addHandler(D,t),e.onMouseClick_.addHandler(T,t)}function N(e){var t=this;e.omdc_.removeHandler(D,t),e.onMouseClick_.removeHandler(T,t),t.tapHandler_=null}function D(e,t){var n=this,r=e,o=r.layoutEngine,i=o&&o.hT_(t);if(i){var a=i.area,u=i.groupInfo?i.groupInfo.row:i.row;a!==K&&a!==J&&a!==Z||!W.isNumber(u)||F(r,t,i),n.startEditing(r,i)}}function F(e,t,n){var r=void 0,o=n.groupInfo;r=o&&"groupContent"===o.area?e.gGI_(o.path).data.getItem(o.row,!0):e.data.getItem(n.row,!0),e.rowDbClick.raise(e,{event:t,hitInfo:n,item:r,idList:Y.getIdList(e,n)})}function T(e,t){var n=this,r=e,o=r.layoutEngine,i=o.hT_(t);i&&n.editingInfo_&&n.stopEditing(r,i)}function M(e){R.call(this,e)}function O(e,t,n){var r=this;if(f.call(r,e,t,n)&&(m.call(r,e)&&r.isEditing_&&r.unMountEditors(e,!0,!0),v.call(r,e))){var o=e.options;r.editingInfo_=t,r.editors_=[];var i=t.groupInfo,a=i?i.row:t.row,u=i?i.column:t.column;r.dataManageGroup_=i?e.data.getNode(i.path):null;var c=o.editMode||$.Inline;if(c===$.PopUp||c===$.EditForm){if(!A.call(r,e,t,a))return}else if(!E.call(r,e,t,a))return;var l=r.editors_;if(u>=0&&l[u]&&l[u].focus)l[u].focus();else{var s,d;if(c===$.Inline)s=e.uid+"-inline-editing-area",d=document.getElementById(s),d.focus();else if(s=c===$.PopUp?e.uid+"-popup-editing-area":c===$.EditForm?e.uid+"-form-editing-area":"",d=document.getElementById(s)){var p=d.querySelector(".gc-editing-cancel");p&&p.focus()}}if(!o.allowHeaderSelect){var h=Y.createID(e.uid,"rowHeader",a,i,t.nodeInfo),g=document.querySelector("#"+h+" .gc-row-header-cell");j.addClass(g,"gc-icon gc-editing")}var _={status:"startEditing",groupInfo:i,row:a,oldItem:r.middleItem,newItem:null,isNewRow:t.isNewRow};e.editing.raise(e,_),r.middleItem=_.oldItem,r.isEditing_=!0}}function L(e,n,o){var i=this,u=i.editingInfo_;if(u&&d.call(i,e,n,o)){var s,f=u.isNewRow,h=u.groupInfo?u.groupInfo.row:u.row,g=e.columns,v=i.editors_,m=i.middleItem||{},_=[];V.each(g,function(n,r){v[r]?(s=a.call(i,e,r),V.set(m,t(e,n),s)):f&&V.set(m,t(e,n),null),e.data.isCalculatedColumn(n.id)&&_.push(n)});var C=u.groupInfo,b=y.call(i,e,m,i.originalItem,u,_),S=b.oldItems;m=b.newItems;var w={status:"beforeEndEditing",groupInfo:C,row:h,oldItem:S,newItem:m,useEncodedItem:!0,cancel:!1,isNewRow:f};if(e.editing.raise(e,w),!w.cancel)if(w.useEncodedItem&&(m=W.isArray(w.newItem)?V.map(w.newItem,function(t){return p.call(i,e,t)}):p.call(i,e,w.newItem)),V.isEqual(m,S))i.unMountEditors(e,!0,!0),e.editing.raise(e,{status:"endEditing",groupInfo:C,row:h,newItem:m,oldItem:S,isNewRow:f});else{var I,x=function(){var t=void 0,n=void 0,r=e.context_.getInstance("dataLoader"),o=l(e,S,_),i=l(e,m,_);if(f)return I="top"===e.options.autoAddRowPosition?0:e.data.sourceCollection.length,r.executeAction("create",{dataItems:i,insertAt:I},{dataItem:i},function(t){t.success&&(n=t.params.dataItems,e.editing.raise(e,{status:"endEditing",newItem:n,isNewRow:f}),r.updateMemo_({item:n,index:I,action:"insert"}))}),{v:void 0};var a=W.isArray(m),s=a?"updateMultiple":"update";a?(h=b.rows,C=b.groupInfo,t=b.sourceIndies,c(e,m[0],_)):(t=u.sourceIndex,c(e,m,_)),r.executeAction(s,{sourceIndex:t,newItem:i},{sourceIndex:t,viewIndex:h,dataItem:i,oldDataItem:o},function(o){o.success&&(n=o.params.newItem,e.editing.raise(e,{status:"endEditing",groupInfo:C,row:h,newItem:n,oldItem:S,isNewRow:f}),r.updateMemo_({item:n,index:t,action:"update"}))})}();if("object"===("undefined"==typeof x?"undefined":r(x)))return x.v}}}function P(e,t,n){var r=this,o=r.editingInfo_;if(m.call(r,e)){var i=r.editors_;if(!n){var a={status:"cancelEditing",cancel:!1,groupInfo:o.groupInfo,row:o.groupInfo?o.groupInfo.row:o.row,isNewRow:o.isNewRow};if(e.editing.raise(e,a),a.cancel)return}V.each(i,function(e){e&&e.destroy&&e.destroy()});var u=e.layoutEngine,c=u.options.editMode;(W.isNil(t)||c===$.EditForm)&&(t=!0),u.stE_(t),_.call(r,e)}}function G(e){var t=this;m.call(t,e)&&(t.isEditing_=!1,t.editingInfo_=null,t.editors_=null,t.innerContainer=null)}function B(e,t){var n=e.options;return t.action?!1:t.visible===!1?!1:Y.isMultiFieldColumn(t)&&!t.editor?!1:n.allowEditing&&t.hasOwnProperty("allowEditing")?t.allowEditing:!0}function k(e){var t=this;m.call(t,e)&&(N.call(t,e),t.isEditing_&&t.unMountEditors(e,!0,!0))}function U(e){var t=W.EditorType;if(!e)return t.Text;switch(e=e.toLowerCase()){case"boolean":return t.CheckBox;case"date":return t.Date;case"number":return t.Number;default:return t.Text}}function H(e,t){var n=e.columns,r=e.options,o=void 0,i=void 0,a=void 0,u=t.groupInfo,c=u?u.row:t.row,l=b(e,c,u,t.nodeInfo);if(l[te])for(var s=l[te].rect,f=l[Q].rect,d=l[ee].rect,p=0,h=n.length;h>p;p++)if(o=n[p],i=o.id,a=j.getElement("#"+l[o.pinned].key+' [data-column="'+i+'"]')){var g=document.querySelector("#"+e.uid+"-inline-editing-area .gc-inline-editor-container[data-column="+i+"]"),v=j.gER(a);g&&j.setCss(g,{top:v.top-(f?f.top:s.top),left:v.left-(r.rightToLeft?d?d.left:s.left:f?f.left:s.left)})}}var V=n(8),j=n(10),W=n(11),z=n(18),Y=n(12),q=W.EditorType,X={},$={Inline:"inline",PopUp:"popup",EditForm:"editForm"},K="viewport",J="pinnedLeftViewport",Z="pinnedRightViewport",Q="left",ee="right",te="none",ne="cell",re="row",oe=function(){function e(e){this.options=e}return e.prototype={init:function(){var e=this,t=e.options,n=t.dataview.data.isCalculatedColumn(t.col.id),r=X.getEditorType(n?null:t.col.dataType);r||(r=W.getType(t.value)),e.type_=r,e.container=t.container;var i,a=e.container;r===q.CheckBox?(i='<input type="checkbox" class="gc-inline-editor checkbox" />',a.style.textAlign="center"):i='<input spellcheck="false" type="'+r+'" class="gc-inline-editor '+(r===q.Date?"date":"")+'" />',e.$input=j.createElement(i);var u,c=e.$input,l=t.value;r===q.CheckBox?(u=!!l,c.checked=u):r===q.Date?(u=W.normalizeDate(l),c.value=u):(u=l,c.value=u),e.defaultValue=u,a.appendChild(c),o(e)},destroy:function(){},focus:function(){var e=this.$input;e.focus(),e.select()},serialize:function(){var e=this,t=e.type_,n=u(e.$input,t);return t?i(n,t):n}},e}();X.init=M,X.startEditing=O,X.stopEditing=L,X.unMountEditors=P,X.clearEditCache=G,X.isColumnEditable=B,X.destroy=k,X.getEditorType=U,X.updateInlineNodePos_=H,e.exports=X}()},function(e,t){"use strict";!function(){function t(e,n,r){return("string"==typeof n?n:n.toString()).replace(e.define||a,function(t,n,o,i){return 0===n.indexOf("def.")&&(n=n.substring(4)),n in r||(":"===o?(e.defineParams&&i.replace(e.defineParams,function(e,t,o){r[n]={arg:t,text:o}}),n in r||(r[n]=i)):new Function("def","def['"+n+"']="+i)(r)),""}).replace(e.use||a,function(n,o){e.useParams&&(o=o.replace(e.useParams,function(e,t,n,o){if(r[n]&&r[n].arg&&o){var i=(n+":"+o).replace(/'|\\/g,"_");return r.__exp=r.__exp||{},r.__exp[i]=r[n].text.replace(new RegExp("(^|[^\\w$])"+r[n].arg+"([^\\w$])","g"),"$1"+o+"$2"),t+"def.__exp['"+i+"']"}}));var i=new Function("def","return "+o)(r);return i?t(e,i,r):i})}function n(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}var r,o={version:"1.0.3",templateSettings:{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,useParams:/(^|[^\w$])def(?:\.|\[[\'\"])([\w$\.]+)(?:[\'\"]\])?\s*\:\s*([\w$\.]+|\"[^\"]+\"|\'[^\']+\'|\{[^\}]+\})/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,defineParams:/^\s*([\w$]+):([\s\S]+)/,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,varname:"it",strip:!0,append:!0,selfcontained:!1,doNotSkipEncoded:!1},template:void 0,compile:void 0};o.encodeHTMLSource=function(e){var t={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},n=e?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(e){return e?e.toString().replace(n,function(e){return t[e]||e}):""}},r=function(){return this||(0,eval)("this")}(),e.exports=o;var i={append:{start:"'+(",end:")+'",startencode:"'+encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},a=/$^/;o.template=function(e,u,c,l){u=u||o.templateSettings;var s,f,d,p=u.append?i.append:i.split,h=0,g=u.use||u.define?t(u,e,c||{}):e;g=("var out='"+(u.strip?g.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):g).replace(/'|\\/g,"\\$&").replace(u.interpolate||a,function(e,t){return l?(d=n(t),t.indexOf("||")>=0?p.start+d+p.end:p.start+"(typeof "+d+' !== "undefined" && '+d+"!== null)?"+d+': ""'+p.end):p.start+n(t)+p.end}).replace(u.encode||a,function(e,t){return s=!0,p.startencode+n(t)+p.end}).replace(u.conditional||a,function(e,t,r){return t?r?"';}else if("+n(r)+"){out+='":"';}else{out+='":r?"';if("+n(r)+"){out+='":"';}out+='"}).replace(u.iterate||a,function(e,t,r,o){return t?(h+=1,f=o||"i"+h,t=n(t),"';var arr"+h+"="+t+";if(arr"+h+"){var "+r+","+f+"=-1,l"+h+"=arr"+h+".length-1;while("+f+"<l"+h+"){"+r+"=arr"+h+"["+f+"+=1];out+='"):"';} } out+='"}).replace(u.evaluate||a,function(e,t){return"';"+n(t)+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/(\s|;|\}|^|\{)out\+='';/g,"$1").replace(/\+''/g,""),s&&(u.selfcontained||!r||r._encodeHTML||(r._encodeHTML=o.encodeHTMLSource(u.doNotSkipEncoded)),g="var encodeHTML = typeof _encodeHTML !== 'undefined' ? _encodeHTML : ("+o.encodeHTMLSource.toString()+"("+(u.doNotSkipEncoded||"")+"));"+g);try{return new Function(u.varname,g)}catch(v){throw"undefined"!=typeof console&&console.log("Could not create a template function: "+g),v}},o.compile=function(e,t){return o.template(e,null,t)}}()},function(e,t){e.exports="12.0.7"},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){var t={};e.exports=t;var o="undefined",i="number",a="string",u="boolean",c="TRUE",l="FALSE",s="#NULL!",f="#DIV/0!",d="#VALUE!",p="#REF!",h="#NAME?",g="#N/A",v="#NUM!",m=[s,f,d,p,h,g,v],_=[0,7,15,23,29,42,36],y=null,C=void 0,b=Math.abs,S=n(21);t.sr=S,t.parseOption=null;var w=function(){function e(){}return e.throwSR=function(e){},e.sr=function(e){},e.cr=function(e){},e}();t.SRHelper=w;var I=t.SRHelper.throwSR,x=(t.SRHelper.sr,t.SRHelper.cr,"Exp_InvalidCast");t.missingArgument={};var A=function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);n.prototype=t.prototype,e.prototype=new n};t.__extends=A,function(e){e[e.anyType=0]="anyType",e[e.numberType=1]="numberType",e[e.stringType=2]="stringType",e[e.booleanType=3]="booleanType",e[e.dateType=4]="dateType"}(t.CalcValueType||(t.CalcValueType={}));var E=function(){function e(){}return e.num=function(e){return("undefined"==typeof e?"undefined":r(e))===i||("undefined"==typeof e?"undefined":r(e))===u||!isNaN(e)&&!isNaN(parseFloat(e))||e instanceof Date},e.err=function(e){return e instanceof F},e.arr=function(e){return e instanceof Array},e.ref=function(e){return e instanceof Reference},e.toResult=function(e){return isNaN(e)||!isFinite(e)?t.CalcErrorsNumber:e},e.toArr=function(e,t,n,r,o,i){return y},e.convertValue=function(t,n,c,l){if(e.err(t))return t;var s={value:y},f=e.CalcConvertedError;if(l&&0!==n&&(t===y||t===C))return f;switch(n){case 1:c?t=e.rD(t,s)?s.value:f:("undefined"==typeof t?"undefined":r(t))===i||t instanceof Date||(t=f);break;case 4:if(("undefined"==typeof t?"undefined":r(t))===a){var d=e._parseLocale(t);t=("undefined"==typeof d?"undefined":r(d))!==o&&d!==y?e._toOADate(d):f}else c?t=e.rD(t,s)?s.value:f:("undefined"==typeof t?"undefined":r(t))===i||t instanceof Date||(t=f);break;case 3:c?t=e.rB(t,s)?s.value:!1:("undefined"==typeof t?"undefined":r(t))!==u&&(t=f);break;case 2:t=t===y||t===C?"":t.toString()}return t},e._isNaNOrInfinite=function(e){return isNaN(e)||!isFinite(e)},e.I=function(t){var n=e.D(t);return b(n)<1e21?parseInt(n,10):void I("Exp_InvalidCast")},e.D=function(t){var n={value:0};return e.rD(t,n)?n.value:void I(x)},e.rD=function(t,n){var c=y;if(("undefined"==typeof t?"undefined":r(t))===o||t===y)return n.value=0,!0;var l="undefined"==typeof t?"undefined":r(t);try{if(l===i){if(c=new Number(t).valueOf(),e._isNaNOrInfinite(c))return!1}else if(l===a){if(t=t.trim(),0===t.length)return n.value=0,!0;var s=!1;if("%"===t.charAt(t.length-1)&&(s=!0,t=t.substr(0,t.length-1)),c=new Number(t).valueOf(),e._isNaNOrInfinite(c))return!1;s&&(c/=100)}else if(l===u)c=t?1:0;else{if(!(t instanceof Date))return!1;c=e._toOADate(t)}}catch(f){return!1}return n.value=c,!0},e.rB=function(t,n){try{if(("undefined"==typeof t?"undefined":r(t))===o||t===y)return!1;("undefined"==typeof t?"undefined":r(t))===u||(t instanceof Date?t=0!==e._toOADate(t):e.num(t)?t=0!==t:I(x))}catch(i){}return n.value=t,!0},e.B=function(t){return("undefined"==typeof t?"undefined":r(t))===o||t===y?!1:("undefined"==typeof t?"undefined":r(t))===u?t:t instanceof Date?0!==e._toOADate(t):e.num(t)?0!==t:e.err(t)?!1:void I(x)},e.S=function(t){try{if(("undefined"==typeof t?"undefined":r(t))===o||t===y)return"";if(("undefined"==typeof t?"undefined":r(t))===u)return t?c:l;if(("undefined"==typeof t?"undefined":r(t))===a)return t;if(t instanceof Date);else{if(!e.arr(t))return t.toString();I(x)}}catch(n){I(x)}},e.DT=function(t){var n={value:y};return e.rDT(t,n)?n.value:void I(x)},e.rDT=function(t,n){if(("undefined"==typeof t?"undefined":r(t))===o||t===y)n.value=e._fromOADate(0);else if(t instanceof Date)n.value=new Date(t);else if(("undefined"==typeof t?"undefined":r(t))===a){var u=e._parseLocale(t);if(("undefined"==typeof u?"undefined":r(u))!==o&&u!==y||isNaN(t)||(u=e._fromOADate(parseFloat(t))),u===C||u===y)return!1;n.value=u}else{if(("undefined"==typeof t?"undefined":r(t))!==i)return!1;n.value=e._fromOADate(t)}return!0},e._toOADate=function(e){return e===C||e===y?0:"number"==typeof e?e:(1440*e.getTime()+3181192704e6-864e5*e.getTimezoneOffset())/124416e6},e._fromOADate=function(e){var t=e-25569,n=new Date(864e5*t),r=t>=0?1:-1;return new Date((864e5*e*1440+r-3181192704e6+864e5*n.getTimezoneOffset())/1440)},e._parseLocale=function(e){return new Date(e)},e.CalcConvertedError={},e}();t.Convert=E;var R=function(){function e(){}return e._argumentExists=function(e,n){return e&&n<e.length&&e[n]!==t.missingArgument},e._argumentValid=function(e,n){if(!e)return!1;var r=e[n];return r!==t.missingArgument&&r!==y&&r!==C&&!r._error},e}();t._Helper=R;var N=function(){function e(){}return e.replace=function(e,t,n){return e.split(t).join(n)},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){var n=e.length-t.length;return n>=0&&e.indexOf(t,n)===n},e.leftBefore=function(e,t){var n=e.indexOf(t);return 0>n||n>=e.length?e:e.substr(0,n)},e.contains=function(e,t){return e.indexOf(t)>=0},e.count=function(e,t){for(var n=0,r=e.indexOf(t);r>=0;)n+=1,r=e.indexOf(t,r+1);return n},e}();t.StringUtil=N;var D=function(){function e(){}return e.getReg=function(t){var n=e.regDict[t];return n||(n=e.regDict[t]=new RegExp(t,"g")),n.lastIndex=0,n},e.getRegIgnoreCase=function(t){var n=e.regDictIgnoreCase[t];return n||(n=e.regDictIgnoreCase[t]=new RegExp(t,"gi")),n.lastIndex=0,n},e.getWildcardCriteria=function(t){if(e.wildcardParseRecord[t])return e.wildcardParseResultBuffer[t];if(e.getReg("[~?*]+").test(t)){var n=t,r=e.getReplaceSymbol("asterisk",n),o=e.getReplaceSymbol("question",n),i=e.getReplaceSymbol("tilde",n);return n=N.replace(n,"~~",i),n=N.replace(n,"~*",r),n=N.replace(n,"~?",o),n=n.replace(e.getReg("([.+$^\\[\\](){}|/])"),"\\$1"),n=N.replace(n,"*",".*"),n=N.replace(n,"?","."),n=N.replace(n,r,"\\*"),n=N.replace(n,o,"\\?"),n=N.replace(n,i,"~"),e.wildcardParseResultBuffer[t]=n,e.wildcardParseRecord[t]=!0,n}return y},e.getWildcardCriteriaFullMatch=function(t){var n=e.getWildcardCriteria(t);return n&&(n="^"+n+"$"),n},e.getReplaceSymbol=function(e,t){for(var n="#"+e+"0#",r=1;1e4>r;r++){if(!(t.indexOf(n)>0))return n;n=N.replace(n,"#"+e+(r-1)+"#","#"+e+r+"#")}},e.regDict={},e.regDictIgnoreCase={},e.wildcardParseRecord={},e.wildcardParseResultBuffer={},e}();t.RegUtil=D;var F=function(){function e(e,t){this._error=e,this._code=t}return e.prototype.toString=function(){return this._error},e.parse=function(t){var n=e._parseCore(t);if(n===C)throw"Incorrect error!";return n},e._parseCore=function(t){if(("undefined"==typeof t?"undefined":r(t))!==o&&t!==y&&""!==t)for(var n=0;n<m.length;n++){var i=m[n];if(i===t||i===t.toUpperCase())return new e(i,_[n])}return C},e}();t.CalcError=F,t.CalcErrorsNull=new F(s,0),t.CalcErrorsDivideByZero=new F(f,7),t.CalcErrorsValue=new F(d,15),t.CalcErrorsReference=new F(p,23),t.CalcErrorsName=new F(h,29),t.CalcErrorsNotAvailable=new F(g,42),t.CalcErrorsNumber=new F(v,36);var T=function(){function e(){}return e.Null=t.CalcErrorsNull,e.DivideByZero=t.CalcErrorsDivideByZero,e.Value=t.CalcErrorsValue,e.Reference=t.CalcErrorsReference,e.Name=t.CalcErrorsName,e.NotAvailable=t.CalcErrorsNotAvailable,e.Number=t.CalcErrorsNumber,e}();t.Errors=T;var M=function(){function e(){}return e.BAND_INDEX_CONST=-2147483648,e.maxRowCount=1048576,e.maxColumnCount=16384,e}();t.ParserConstants=M;var O=function(){function e(e,t){var n=this;n.calcSource=e,n.column=t,n.dataType=e.getDataType_(t)}return e.prototype.getValue=function(e,t,n,r){var o=this,i=o.calcSource;return-1==e?i.getValues(o.column,t,n,r):i.getValueBySourceIndex_(o.column,e,r)},e}();t.CalcColumnReference=O;var L=function(){function e(e){var t=this;t.calcSource=e,t.name=e.getName()}return e.prototype.toArray=function(){return this.calcSource.toArray()},e}();t.CalcTableReference=L;var P=function(){function e(e,t){var n=this;n.calcSource=e,n.name=t}return e.prototype.getValue=function(){var e=this;return e.calcSource.getFieldValue(e.name)},e}();t.CalcFieldReference=P}()},function(e,t){"use strict";!function(){var t={};e.exports=t;var n=function(){function e(){}return e.Exp_InvalidArgument="Invalid argument",e.Exp_InvalidCast="InvalidCastException",e.Exp_NotSupport="NotSupportException",e.Exp_FormulaInvalid="The formula you typed contains an invalid char: ",e.Exp_InvalidTokenAt="invalid token at ",e.Exp_InvalidArrayAt="Invalid array at ",e.Exp_InvalidCellReference="Invalid cell reference or name at ",e.Exp_InvalidFunctionName="Invalid function name",e.Exp_InvalidOverrideFunction="Cannot override built-in function",e.Exp_OverrideNotAllowed="Attempt to override function while override is not allowed",e.Exp_NoSyntax='no syntax "',e.Exp_MatchSyntax='"to match the syntax "',e.SingleQuotesFullStop='".',e.SingleQuote="",e.Exp_IsValid='" is invalid.',e.Exp_InvalidArray="Invalid array",e.AtIndexOn='" at index on ',e.FullStop=".",e.SingleQuoteAt='" at ',e}();t._ENStringResource=n,t.SR=n}()},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){function t(e,t,n){void 0!==e&&null!==e||Gr(kr);var r;if(e=e.toUpperCase(),Co.hasOwnProperty(e)&&Gr(kr),bo.hasOwnProperty(e)?(r=bo[e],r?n&&n.override||Gr(Ur):(bo[e]=new Pr.Function(e,0,255),r=Pr[e.toUpperCase()])):(r=new _o(e,0,255),bo[e]=r),t&&"function"==typeof t&&(r.evaluate=t),n)for(var o in n)n.hasOwnProperty(o)&&"override"!==o&&(r[o]=n[o]);return r}function o(e){return e===Vr||e===Hr?Hr:(e=e.toUpperCase(),Co&&Co.hasOwnProperty(e)?Co[e]:bo.hasOwnProperty(e)?bo[e]:Hr)}function i(e,t,n){e!==Vr&&e!==Hr||Gr(kr);var r;if(e=e.toUpperCase(),Co.hasOwnProperty(e)?(r=Co[e],r?n&&n.override||Gr(Ur):(Co[e]=new _o(e,0,255),r=Pr[e.toUpperCase()])):(r=new Pr.Function(e,0,255),Co[e]=r),t&&"function"==typeof t&&(r.evaluate=t),n)for(var o in n)n.hasOwnProperty(o)&&"override"!==o&&(r[o]=n[o]);return r}function a(e){return!0}function u(e){return 1===e}function c(e){return 2===e}function l(e){return 3===e}function s(){return!0}function f(e){return 1===e||2===e}function d(){return!0}function p(){return!0}function h(){return!0}function g(){return!0}function v(e,t){return function(n,r){var o=[];if(Or.isNumber(e)){for(var i=n.getGroupBySourceRow_(r);0>e&&i;)i=i.parent,e++;o.push(i?i.path&&i.path.join("."):"")}if(Or.isNumber(t)){for(var a=n.getNodeBySourceRow_(r);0>t&&a;)a=a.parent,t++;o.push(a?a.path&&a.path.join("."):"")}return o.length>0?o.join(",")+"/":""}}function m(){return 0}function _(){return 1}function y(){return!0}function C(){return!0}function b(){return!0}function S(){return!0}function w(e){return 0===e}function I(){return 0}function x(e){if(fo.err(e))return-1;var t=!1;try{t=fo.B(e)}catch(n){}return t?1:2}function A(e){return 1===e}function E(e){return 2===e}function R(e){return 0===e||1===e}function N(e){return 0===e}function D(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,F)}function F(e){var t=parseFloat(e);return Or.isFinite(t)?fo.toResult(jr(t)):go}function T(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,M)}function M(e){var t=parseFloat(e);return t===Vr||t===Hr?go:Pr._MathHelper.approxFloor(t)}function O(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,L)}function L(e){var t=fo.D(e[0]),n=fo.D(e[1]);return isNaN(t)||isNaN(n)?go:0===t||0===n?0:t>0&&0>n?mo:0>t&&n>0?(n=-n,Pr._MathHelper.approxFloor(t/n)*n):Pr._MathHelper.approxCeiling(t/n)*n}function P(e,t){var n=Fr(e[0],t,!1),r=Or.isUndefined(e[1])?1:Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,G)}function G(e){var t=fo.D(e[0]),n=fo.D(e[1]);return n=fo.D(n),isNaN(t)||isNaN(n)?go:0===t||0===n?0:(0>n&&(n=-n),Pr._MathHelper.approxCeiling(t/n)*n)}function B(e){return e}function k(e){var t;return isNaN(t=parseFloat(e[0]))?go:180*t/io}function U(e){var t=parseFloat(e[0]);return 0>t?(t=qr(t),t%2!==0&&(t-=1)):(t=Xr(t),t%2!==0&&(t+=1)),t}function H(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,V)}function V(e){var t=parseInt(e,10),n=1;if(isNaN(t))return go;if(0>t||t>170)return mo;for(var r=1;t>=r;r++)n*=r;return n}function j(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,W)}function W(e){var t=parseFloat(e);return t===Vr||t===Hr?go:0>=t?mo:fo.toResult(oo(t))}function z(e){var t=parseFloat(e[0]),n=parseFloat(e[1]);return 0===n?"#DIV/0!":t-n*qr(t/n)}function Y(e){var t=parseFloat(e[0]);return 0>t?(t=qr(t),t%2===0&&(t-=1)):(t=Xr(t),t%2===0&&(t+=1)),t}function q(){return io}function X(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,$)}function $(e){var t=parseFloat(e[0]),n=parseFloat(e[1]);return Or.isFinite(t)&&Or.isFinite(n)?uo(t,n):mo}function K(e,t){var n=Fr(e[0],t,!0);if(yo.tabRef(n)||yo.err(n))return vo;Or.isArray(n)||(n=[n]);for(var r=!1,o=0,i=n.length,a=0;i>o;o++)if(Or.isNumber(n[o]))a+=n[o];else if(Or.isDate(n[o]))a+=fo._toOADate(n[o]),r=!0;else if(!nr(n[o]))return go;return r?fo._fromOADate(a):a}function J(e,t){return 2===e.length?K([e[1]],t):vo}function Z(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,Q)}function Q(e){var t=parseFloat(e);return Or.isFinite(t)?t>0?1:0>t?-1:0:go}function ee(e,t){for(;0!==t;){var n=e%t;e=t,t=n}return e}function te(e){for(var t=0,n=0;n<e.length;n++)for(var r=fo.toArr(e[n],1,!0,!0,!1),o=0;o<r.length;o++){var i=r[n];if(i!==fo.CalcConvertedError){if(0>i)return mo;t=ee(t,fo.I(i))}}return t}function ne(e){for(var t=1,n=[],r=0;r<e.length;r++){for(var o=fo.toArr(e[r],1,!0,!0,!1),i=0;i<o.length;i++){var a=o[i];if(a!==fo.CalcConvertedError){if(0>a)return mo;if(0===a)return 0;n.push(fo.I(a))}}for(var u=0;u<n.length;u++){var c=n[u];t/=ee(t,c),t*=c}}return t}function re(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,oe)}function oe(e){var t=parseFloat(e);return t>=0?Wr(t):mo}function ie(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,ae)}function ae(e){if(fo.err(e[0]))return e[0];if(fo.err(e[1]))return e[1];var t=fo.D(e[0]),n=fo.D(e[1]);return isNaN(t)||isNaN(n)?go:0===n?ho:parseInt((t/n).toString(),10)}function ue(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,ce)}function ce(e){var t=fo.D(e[0]),n=fo.D(e[1]);if(isNaN(t)||isNaN(n))return go;if(0===t||0===n)return 0;if(t>0&&0>n)return mo;var r=Pr._MathHelper;return 0>t&&n>0?(n=-n,r.approxCeiling(t/n)*n):r.approxFloor(t/n)*n}function le(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,se)}function se(e){var t=fo.D(e[0]),n=fo.D(e[1]);return isNaN(t)||isNaN(n)?go:0===t||0===n?0:0>t&&n>0||0>n&&t>0?mo:Pr._MathHelper.approxFloor(t/n+.5)*n}function fe(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,de)}function de(e){var t=fo.D(e[0]);if(isNaN(t))return go;var n=fo.I(e[1]),r=Pr._MathHelper,o=r.pow10(jr(n));return 0>n?t/=o:t*=o,t=0>t?r.approxCeiling(t-.5):r.approxFloor(t+.5),0>n?t*=o:t/=o,fo.toResult(t)}function pe(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,he)}function he(e){var t=fo.D(e[0]);if(isNaN(t))return go;var n=fo.I(e[1]),r=Pr._MathHelper,o=r.pow10(jr(n));return 0>n?t/=o:t*=o,t=0>t?r.approxCeiling(t):r.approxFloor(t),0>n?t*=o:t/=o,fo.toResult(t)}function ge(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,ve)}function ve(e){var t=fo.D(e[0]);if(isNaN(t))return go;var n=fo.I(e[1]),r=Pr._MathHelper,o=r.pow10(jr(n));return 0>n?t/=o:t*=o,t=0>t?r.approxFloor(t):r.approxCeiling(t),0>n?t*=o:t/=o,fo.toResult(t)}function me(e,t){var n=Fr(e[0],t,!1),r=Mr._Helper._argumentExists(e,1)?fo.I(e[1]):0;return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,_e)}function _e(e){var t=fo.D(e[0]),n=e[1];if(isNaN(t))return go;var r=Pr._MathHelper,o=r.pow10(jr(n));return 0>n?t/=o:t*=o,t=0>t?r.approxCeiling(t):r.approxFloor(t),0>n?t*=o:t/=o,fo.toResult(t)}function ye(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,Ce)}function Ce(e){var t;return isNaN(t=fo.D(e))?go:fo.toResult(ro(t))}function be(e,t){var n=Fr(e[0],t,!1),r=2===e.length?Fr(e[1],t,!1):10;return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,Se)}function Se(e){var t=parseFloat(e[0]),n=parseFloat(e[1]);return Or.isFinite(t)&&Or.isFinite(n)?0>=t||0>=n?mo:fo.toResult(xo.log(t,n)):go}function we(e,t){return 1===e.length?be(e,t):vo}function Ie(e){var t;return isNaN(t=fo.D(e[0]))?go:0>t?mo:fo.toResult(Wr(t*io))}function xe(e){var t;return isNaN(t=fo.D(e[0]))?go:io*t/180}function Ae(e){var t;return isNaN(t=fo.D(e[0]))?go:fo.toResult(Zr(t))}function Ee(e){var t;return isNaN(t=fo.D(e[0]))?go:-1>t||t>1?mo:fo.toResult(Qr(t))}function Re(e){var t;return isNaN(t=fo.D(e[0]))?go:fo.toResult((ro(t)+ro(-t))/2)}function Ne(e){var t;return isNaN(t=fo.D(e[0]))?go:1>t?mo:fo.toResult(oo(t+Wr(t*t-1)))}function De(e){var t;return isNaN(t=fo.D(e[0]))?go:fo.toResult(Kr(t))}function Fe(e){var t;return isNaN(t=fo.D(e[0]))?go:-1>t||t>1?mo:fo.toResult(Jr(t))}function Te(e){var t;return isNaN(t=fo.D(e[0]))?go:fo.toResult((ro(t)-ro(-t))/2)}function Me(e){var t;return isNaN(t=fo.D(e[0]))?go:fo.toResult(oo(t+Wr(t*t+1)))}function Oe(e){var t;return isNaN(t=fo.D(e[0]))?go:fo.toResult(eo(t))}function Le(e){var t;return isNaN(t=fo.D(e[0]))?go:fo.toResult(to(t))}function Pe(e){var t,n;return isNaN(t=fo.D(e[0]))||isNaN(n=fo.D(e[1]))?go:0===t&&0===n?ho:fo.toResult(no(n,t))}function Ge(e){var t;if(isNaN(t=fo.D(e[0])))return go;var n=ro(t),r=ro(-t);return fo.toResult(n-r)/(n+r)}function Be(e){var t;return isNaN(t=fo.D(e[0]))?go:-1>=t||t>=1?mo:fo.toResult(oo((1+t)/(1-t))/2)}function ke(){return ao()}function Ue(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,He)}function He(e){if(fo.err(e[1]))return e[1];if(fo.err(e[0]))return e[0];var t,n,r;if(isNaN(t=fo.I(e[0]))||isNaN(n=fo.I(e[1])))return go;t>n&&(r=t,t=n,n=r);var o=ao();return fo.I(t+o*(n-t+1))}function Ve(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,je)}function je(e){return!!e[0]&&!!e[1]}function We(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,ze)}function ze(e){return!!e[0]||!!e[1]}function Ye(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,qe)}function qe(e){try{var t=fo.B(e);return!t}catch(n){return go}}function Xe(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1),o=Fr(e[2],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.tabRef(o)?vo:Tr([n,r,o],t,$e)}function $e(e){return Or.isUndefined(e[0])||Or.isNull(e[0])?go:e[0]?e[1]||Vr:Or.isUndefined(e[2])||Or.isNull(e[2])?Vr:e[2]}function Ke(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,Je)}function Je(e){var t=fo.err(e[0]);return t?e[1]!==Vr&&e[1]!==Hr?e[1]:0:e[0]!==Vr&&e[0]!==Hr?e[0]:0}function Ze(){return!0}function Qe(){return!1}function et(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1),o=Fr(e[2],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)||yo.tabRef(o)||yo.err(o)?vo:Tr([n,r,o],t,tt)}function tt(e){try{var t,n,r;if(isNaN(t=fo.I(e[0]))||isNaN(n=fo.I(e[1]))||isNaN(r=fo.I(e[2])))return go;if(0>t||t>9999)return mo;1899>=t&&(t+=1900);var o=new Date(t,n-1,r);return o<new Date(1899,11,30)?mo:o}catch(i){return mo}}function nt(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1),o=Fr(e[2],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)||yo.tabRef(o)||yo.err(o)?vo:Tr([n,r,o],t,rt)}function rt(e){var t,n,r;try{if(isNaN(t=fo.I(e[0]))||isNaN(n=fo.I(e[1]))||isNaN(r=fo.I(e[2])))return go;var o=fo._fromOADate(0);return o.setHours(t),o.setMinutes(n),o.setSeconds(r),o.setMilliseconds(0),o.getHours()<0&&o.getMinutes()<0&&o.getSeconds()<0?mo:o}catch(i){return mo}}function ot(e){return e%400===0||e%4===0&&e%100!==0||1900===e}function it(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,at)}function at(e){if(e instanceof Date)return e;try{var t=new Date(e);return isNaN(t.getDate())?go:t}catch(n){return go}}function ut(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,ct)}function ct(e){var t=fo.S(e);if(t===Vr||t===Hr||""===t)return go;try{var n=t.split(":"),r=n[0],o=n[1],i=n[2];return new Date(1899,11,30,r,o,i)}catch(a){return go}}function lt(e){return new Date}function st(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}function ft(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,dt)}function dt(e){try{var t=fo.DT(e);return t.getHours();
}catch(n){return go}}function pt(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,ht)}function ht(e){try{var t=fo.DT(e);return t.getMinutes()}catch(n){return go}}function gt(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,vt)}function vt(e){try{var t=fo.DT(e);return t.getSeconds()}catch(n){return go}}function mt(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,_t)}function _t(e){try{var t=fo.DT(e);return t.getDate()}catch(n){return go}}function yt(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,Ct)}function Ct(e){try{var t=fo.DT(e);return t.getMonth()+1}catch(n){return go}}function bt(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,St)}function St(e){try{var t=fo.DT(e);return t.getFullYear()}catch(n){return go}}function wt(e){for(var t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),o=0,i=0;n>i;i++)switch(i){case 0:case 2:case 4:case 6:case 7:case 9:case 11:o+=31;break;case 1:o+=ot(t)?29:28;break;case 3:case 5:case 8:case 10:o+=30}return o+=r}function It(e,t){var n=wt(e),r=new Date(e.getFullYear(),0,1).getDay();2===t&&(r-=1,0>r&&(r=6));var o=n-1-(6-r);return 0>o&&(o=0),1+fo.I(o/7)+(o%7!==0?1:0)}function xt(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,At)}function At(e){var t;try{t=fo.DT(e[0])}catch(n){return go}var r;if(isNaN(r=fo.I(e[1]?e[1]:1)))return go;switch(r){case 1:case 2:return It(t,r);default:return mo}}function Et(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,Rt)}function Rt(e){var t;try{t=fo.DT(e[0])}catch(n){return go}var r;if(isNaN(r=fo.I(e[1]?e[1]:1)))return go;var o;switch(r){case 1:o=t.getDay()+1;break;case 2:o=0===t.getDay()?7:t.getDay();break;case 3:o=0===t.getDay()?6:t.getDay()-1;break;default:return mo}return o}function Nt(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,Dt)}function Dt(e){var t,n;try{t=fo.DT(e[0])}catch(r){return go}if(isNaN(n=fo.I(e[1])))return go;var o=t.getFullYear(),i=t.getMonth(),a=t.getDate(),u=i+n,c=qr(u/12)+o;u%=12;var l=Yr(Ft(c,u),a);return t.setFullYear(c,u,l),t}function Ft(e,t){switch(t){case 0:case 2:case 4:case 6:case 7:case 9:case 11:return 31;case 1:return ot(e)?29:28;case 3:case 5:case 8:case 10:return 30}}function Tt(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,Mt)}function Mt(e){var t,n;try{t=fo.DT(e[0])}catch(r){return go}if(isNaN(n=parseFloat(e[1])))return go;var o=t.getFullYear(),i=t.getMonth(),a=i+$r(n),u=qr(a/12)+o;a%=12;var c=Ft(u,a);return t.setFullYear(u,a,c),t}function Ot(e,t){return e-t}function Lt(e){var t=Mr._Helper,n=fo.DT(e[0]),r=fo.DT(e[1]),o=t._argumentExists(e,2)?fo.B(e[2]):!1,i=n.getDate(),a=r.getDate(),u=n.getMonth(),c=r.getMonth(),l=n.getFullYear(),s=r.getFullYear();return o?(a=31===a?30:a,i=31===i?30:i):(i=31===i?30:i,31===a&&(30>i?(a=1,c++,c>12&&(c=1,s++)):a=30)),30*(12*(s-l)+(c-u))+(a-i)}function Pt(e,t,n){var r,o=So.__days_between_basis(e,t,n);if(0>o){var i;o=-o,i=e,e=t,t=i}if(1===n){var a,u,c,l,s=e.getFullYear(),f=t.getFullYear();a=e,a.setFullYear(a.getFullYear()+1),Ot(t,a)>0?(l=f+1-s,a=new Date(s,0,1),u=new Date(f+1,0,1),c=fo.I(fo._toOADate(u)-fo._toOADate(a))-365*(f+1-s)):(l=1,c=ot(s)&&e.getMonth()<3||ot(f)&&256*t.getMonth()+t.getDate()>=541?1:0);var d=fo.D(c)/fo.D(l);r=365+d}else r=So.__annual_year_basis(new Date,n);return o/r}function Gt(e){var t=Mr._Helper,n=fo.DT(e[0]),r=fo.DT(e[1]),o=t._argumentExists(e,2)?fo.I(e[2]):0;return 0>o||o>4?mo:Pt(n,r,o)}function Bt(){return Vr}function kt(e){return" "===e||"	"===e||"\n"===e}function Ut(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,Ht)}function Ht(e){for(var t=fo.S(e).trim(),n=[],r=!0,o=0;o<t.length;o++){var i=t.charAt(o);kt(i)&&!r||n.push(i),r=!kt(i)}return n.join("")}function Vt(e){var t=e.toString(),n="";0>e&&(t=t.substr(1),n="-");var r=t.split(".");if(r.length<1||r.length>2)return go;var o=[];2===r.length&&(o.push(r[1]),o.push(".")),t=r[0];for(var i=t.length-1-2;i>=0;i-=3)o.push(t.substr(i,3)),i>0&&o.push(",");return o.push(t.substring(0,i+3)),o.reverse(),n+o.join("")}function jt(e){var t,n=Mr._Helper;if(isNaN(t=fo.D(e[0])))return go;var r=n._argumentExists(e,1)?fo.I(e[1]):2,o=n._argumentExists(e,2)?fo.B(e[2]):!1,i=[],a=0;return 0>r?(a=fo.I(uo(10,jr(r))),t/=a,i[0]=t,i[1]=0):(i[0]=t,i[1]=r),t=fo.D(fe(i)),0>r&&(t*=a),o?t.toString():Vt(t)}function Wt(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,zt)}function zt(e){var t=fo,n=fo.S(e),r=1;n.length>2&&"("===n.charAt(0)&&")"===n.charAt(n.length-1)&&(n=n.slice(1,n.length-1),r=-1);var o,i;if(!isNaN(o=parseFloat(n)))return o*r;if(i=t._parseLocale(n),i!==Vr&&i!==Hr){var a=t._toOADate(i);return t.err(a)?ut([i]):a}return go}function Yt(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,qt)}function qt(e){var t=fo.S(e);return t.toLowerCase()}function Xt(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,$t)}function $t(e){var t=fo.S(e);return t.toUpperCase()}function Kt(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1),o=Fr(e[2],t,!1),i=Fr(e[3],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)||yo.tabRef(o)||yo.err(o)||yo.tabRef(i)||yo.err(i)?vo:Tr([n,r,o,i],t,Jt)}function Jt(e){var t=fo.S(e[0]),n=fo.I(e[1]),r=fo.I(e[2]),o=fo.S(e[3]);if(1>n||0>r)return go;n=Yr(n,t.length+1),r=Yr(r,t.length-n+1);var i=t.substring(0,n-1),a=t.substr(n-1+r);return i.concat(o).concat(a)}function Zt(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1),o=Fr(e[2],t,!1),i=Fr(e[3],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)||yo.tabRef(o)||yo.err(o)||yo.err(i)?vo:Tr([n,r,o,i],t,Qt)}function Qt(e){var t,n=fo.S(e[0]),r=fo.S(e[1]),o=fo.S(e[2]),i=e[3];if(""===r||r===Vr||r===Hr)return n;if(Or.isNil(i))t=Mr.StringUtil.replace(n,r,o);else{i=fo.I(i);var a=0;if(1>i)return go;for(var u=0;i>u;u++){if(a=n.indexOf(r,a),-1===a)return n;a+=r.length}a-=r.length;var c=n.substring(0,a),l=n.substr(a+r.length);t=c.concat(o).concat(l)}return t}function en(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,tn)}function tn(e){var t=e[0],n=e[1],r=Or.isUndefined(t)||Or.isNull(t)?"":t.toString(),o=Or.isUndefined(n)||Or.isNull(n)?"":n.toString();return r+o}function nn(e,t){var n=Fr(e[0],t,!1),r=e[1];return r=1===e.length&&Or.isNil(r)?1:Fr(e[1],t,!1),yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,rn)}function rn(e){var t=e[0],n=e[1];if(Or.isNil(n))return Vr;var r=fo.S(t),o=fo.I(n);return Or.isNaN(o)||Or.isUndefined(o)?go:0>o?go:o>=r.length?r:r.substr(0,o)}function on(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1),o=Fr(e[2],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)||yo.tabRef(o)||yo.err(o)?vo:Tr([n,r,o],t,an)}function an(e){var t=fo.S(e[0]),n=fo.I(e[1])-1,r=fo.I(e[2]);return 0>n||0>r?go:n>=t.length?"":t.length<n+r?t.substr(n):t.substr(n,r)}function un(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return r=1===e.length&&Or.isNil(r)?1:Fr(e[1],t,!1),yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,cn)}function cn(e){var t=e[0],n=e[1];if(Or.isNil(n))return Vr;var r=fo.S(t),o=fo.I(n);return Or.isNaN(o)||Or.isUndefined(o)?go:0>o?go:r.length<o?r:r.substr(r.length-o,o)}function ln(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,sn)}function sn(e){var t=fo.S(e[0]),n=fo.I(e[1]);if(0>n||32767<n*t.length)return go;for(var r=[],o=0;n>o;o++)r.push(t);return r.join("")}function fn(e,t){var n=Fr(e[0],t,!1);return yo.tabRef(n)||yo.err(n)?vo:Tr([n],t,dn)}function dn(e){return fo.S(e).length}function pn(e){var t,n=Mr._Helper,r=fo.S(e[0]),o=fo.S(e[1]),i=n._argumentExists(e,2)?fo.I(e[2]):1;return 1>i||o.length<i?go:(t=o.indexOf(r,i-1),-1===t?Or.isUndefined(e[3])?go:e[3]:t+1)}function hn(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1),o=Fr(e[2],t,!1),i=Fr(e[3],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)||yo.tabRef(o)||yo.err(o)?vo:Tr([n,r,o,i],t,gn)}function gn(e){var t=fo.S(e[0]),n=fo.S(e[1]),r=Or.isUndefined(e[2])?0:fo.I(e[2])-1;if(0>r)return go;var o=-1;try{var i=Mr.RegUtil.getWildcardCriteria(t);if(i){var a=Mr.RegUtil.getRegIgnoreCase(i),u=a.exec(n);o=u!==Vr&&u!==Hr?u.index:-1}else o=n.toLowerCase().indexOf(t.toLowerCase(),r)}catch(c){}return-1===o?Or.isUndefined(e[3])?go:e[3]:o+1}function vn(e,t){var n=Fr(e[0],t,!1),r=Fr(e[1],t,!1);return yo.tabRef(n)||yo.err(n)||yo.tabRef(r)||yo.err(r)?vo:Tr([n,r],t,mn)}function mn(e){var t=fo.S(e[0]),n=fo.S(e[1]);return t===n}function _n(e){var t=e[0];return"string"==typeof t?t:""}function yn(e){e===Vr||e===Hr?Gr(Br):(e.length<1||e.length>1)&&Gr(Br)}function Cn(e,t){var n,r=e&&e.length,o=0,i=Fr(e[o],t,!1),a=!0;if(yo.tabRef(i)){if(i.name!==t.calcSource.name)return vo;o=1}for(;r>o;++o){if(o+1===r)return vo;if(!yo.columnRef(e[o]))return vo;if(i=Fr(e[o],t,!1),n=Fr(e[o+1],t,!1),yo.err(i)||yo.err(n)||yo.tabRef(n))return vo;a=a&&Or.includes(i,n),++o}return a}function bn(e,t){yn(e);var n=Fr(e[0],t,!1);return yo.tabRef(n)||n===vo?vo:Tr([n],t,Sn)}function Sn(e){if(fo.err(e))return!0;if(("undefined"==typeof e?"undefined":r(e))===co){var t=Mr.CalcError._parseCore(e);return t!==Vr&&t!==Hr}return!1}function wn(e,t){yn(e);var n=Fr(e[0],t,!1,!1);return yo.tabRef(n)||n===vo?vo:Tr([n],t,In)}function In(e){return Or.isNumber(e)||e===mo||e===ho}function xn(e){yn(e);var t;return isNaN(t=fo.D(e[0]))?go:Pr._MathHelper.approxFloor(jr(t))%2===0}function An(e){yn(e);var t;return isNaN(t=fo.D(e[0]))?go:Pr._MathHelper.approxFloor(jr(t))%2!==0}function En(e){yn(e);var t=e[0];return fo.num(t)?fo.D(t):("undefined"==typeof t?"undefined":r(t))===lo?t?1:0:fo.err(t)?t:0}function Rn(e,t){yn(e);var n=Fr(e[0],t,!1,!1);return yo.tabRef(n)||n===vo?vo:Tr([n],t,Nn)}function Nn(e){return e===Vr||e===Hr||e===so}function Dn(e,t){yn(e);var n=Fr(e[0],t,!1);return yo.tabRef(n)||n===vo?vo:Tr([n],t,Fn)}function Fn(e){return("undefined"==typeof e?"undefined":r(e))===lo}function Tn(e,t){yn(e);var n=Fr(e[0],t,!1);return yo.tabRef(n)||n===vo?vo:Tr([n],t,Mn)}function Mn(e){return("undefined"==typeof e?"undefined":r(e))===co}function On(e,t){yn(e);var n=Fr(e[0],t,!1);return yo.tabRef(n)||n===vo?vo:Tr([n],t,Gn)}function Ln(e,t){var n=t.calcSource,r=nr(t.currentRow)?t.currentRowInternal_:t.currentRow,o=n.getNodeBySourceRow_(r);return o?o.level:t.hierarchyPath?t.hierarchyPath.length:-1}function Pn(e,t){var n=t.calcSource,r=nr(t.currentRow)?t.currentRowInternal_:t.currentRow,o=n.getGroupBySourceRow_(r);return o?o.level:t.groupPath?t.groupPath.length:-1}function Gn(e){return("undefined"==typeof e?"undefined":r(e))!==co}function Bn(e,t){var n=1===e.length?e[0]:e[1],r=yo.columnRef(n)?n.getValue(-1,t.groupPath,t.hierarchyPath):vo;return yo.err(n)?vo:r[0]}function kn(e,t){var n=1===e.length?e[0]:e[1],r=yo.columnRef(n)?n.getValue(-1,t.groupPath,t.hierarchyPath):vo;return yo.err(n)?vo:r[r.length-1]}function Un(e,t){var n,r,o=[],i=e.length,a=0;if(0===e.length)return n=t.calcSource.reproduce_(),new Mr.CalcTableReference(n);if(r=e[0],1===e.length)return yo.tabRef(r)&&r.name===t.calcSource.name?new Mr.CalcTableReference(t.calcSource.reproduce_()):yo.columnRef(r)?new Mr.CalcTableReference(t.calcSource.reproduce_([r.column])):vo;if(yo.tabRef(r=e[0])){if(r.name!==t.calcSource.name)return vo;++a}for(;i>a;++a){if(!yo.columnRef(r=e[a]))return vo;o.push(r.column)}return n=t.calcSource.reproduce_(o),new Mr.CalcTableReference(n)}function Hn(){}function Vn(){}function jn(e,t){var n,r,o,i,a=t.calcSource,u=[],c=e[0],l=0;if(!yo.columnRef(c))return vo;if(n=c.getValue(-1,t.groupPath,t.hierarchyPath),r=n?n.length:0,0===r)return vo;for(var s=new Set;r>l;l++)s.has(o=n[l])?u[l]=!1:(s.add(o),u[l]=!0);return s.clear(),a&&!Or.isNil(u)?(i=a.reproduce_([c.column],{keepGroup:!0}),i.overlapFilterStates_(u,t.groupPath,t.hierarchyPath),t.groupPath&&i.bindGroup_(t.groupPath),new Mr.CalcTableReference(i)):vo}function Wn(e,t){var n,r,o,i=t.getCurrentRow();if(1==e.length?(n=t.calcSource,o=e[0]):2==e.length&&(n=e[0].calcSource,o=e[1]),r=yo.columnRef(o)?o.getValue(i,t.groupPath,t.hierarchyPath):o,n&&!Or.isUndefined(r)&&!Or.isNull(r)){var a=n.clone(),u=t.calcSource.calcTable_;return a.bindGroup_(t.groupPath),a.bindHierarchy_(t.hierarchyPath,u.recursive_,u.includeSelf_),0>i?a.overlapFilterStates_(r,t.groupPath,t.hierarchyPath):a.overlapFilterSingleState_(r,i),new Mr.CalcTableReference(a)}}function zn(e,t){var n,r=t.calcSource,o=t.groupPath;if(!o){var i=nr(t.currentRow)?t.currentRowInternal_:t.currentRow;if(-1!==i){var a=t.calcSource.getGroupBySourceRow_(i);a&&(o=a.path)}}if(n=!o||o.length<2?[]:o.slice(0,o.length-1),r){var u=r.clone();return u.bindGroup_(n),new Mr.CalcTableReference(u)}}function Yn(e,t){var n=t.calcSource,r=t.groupPath;if(!r){var o=nr(t.currentRow)?t.currentRowInternal_:t.currentRow;if(-1!==o){var i=t.calcSource.getGroupBySourceRow_(o);i&&(r=i.path)}}if(r&&n){var a=n.clone();return a.bindGroup_(r),new Mr.CalcTableReference(a)}}function qn(e,t){var n=e&&e.length?!!e[0]:!1,r=t.calcSource,o=r.clone(),i=nr(t.currentRow)?t.currentRowInternal_:t.currentRow;if(-1!==i){var a=r.getNodeBySourceRow_(i);if(a){var u=a.getParentGroup();u&&o.bindGroup_(u.path),a.parent&&o.bindHierarchy_(a.parent.path,n,!1)}}else o.bindGroup_(t.groupPath),o.bindHierarchy_(t.hierarchyPath,n,!1);return new Mr.CalcTableReference(o)}function Xn(e,t){var n=e&&e.length?!!e[0]:!1,r=e&&e.length?!!e[1]:!1,o=t.calcSource,i=o.clone(),a=nr(t.currentRow)?t.currentRowInternal_:t.currentRow;if(-1!==a){var u=t.calcSource.getNodeBySourceRow_(a);if(u){var c=u.getParentGroup();c&&i.bindGroup_(c.path),i.bindHierarchy_(u.path,n,r)}}else i.bindGroup_(t.groupPath),i.bindHierarchy_(t.hierarchyPath,n,r);return new Mr.CalcTableReference(i)}function $n(e,t){var n,r,o,i,a,u,c,l,s,f=[],d=[],p=[],h=[],g=e.length,v=t.calcSource.calcTable_.getRowCountInternal(t.groupPath,t.hierarchyPath),m=Fr(e[0],t,!0);if(!Or.isNumber(m))return vo;if(m>=v)return e[1];if(0>=m)return new Mr.CalcTableReference;if(a=e[1],!yo.tabRef(a))return vo;for(c=a.calcSource,n=2;g>n;++n){if(a=u?u:Fr(e[n],t,!0),yo.tabRef(a))return vo;f.push(a),g>n+1?(a=Fr(e[n+1],t,!0),1===a||a===!0?(h.push(-1),++n,u=Vr):0===a||a===!1?(h.push(1),++n,u=Vr):(h.push(1),u=a)):h.push(1)}for(n=0,o=0;v>n;)Or.isNil(f[0][n])||(d[o]=n,++o),++n;for(v=d.length,n=0;m>n;){for(l=[n],r=n,o=n+1;v>o;o++)(s=Kn(f,h,d,r,o))<0?(l=[o],r=o):0===s&&l.push(o);Jn(d,n,l),n+=l.length}for(i=n,n=0;v>n;)p[d[n]]=i>n,++n;if(c&&!Or.isUndefined(p)&&!Or.isNull(p)){var _=c.clone(),y=t.calcSource.calcTable_;return _.bindGroup_(t.groupPath),_.bindHierarchy_(t.hierarchyPath,y.recursive_,y.includeSelf_),_.overlapFilterStates_(p,t.groupPath,t.hierarchyPath),new Mr.CalcTableReference(_)}}function Kn(e,t,n,r,o){var i,a,u,c=e.length;for(i=0;c>i;++i)if(a=e[i],Or.isArray(a)){if(u=a[n[o]],a=a[n[r]],a>u)return t[i];if(u>a)return-t[i]}return 0}function Jn(e,t,n){for(var r,o,i,a=0,u=n.length;u>a;++a)(o=n[a])!==(i=a+t)&&(r=e[i],e[i]=e[o],e[o]=r)}function Zn(e,t){var n=Fr(e[0],t,!0,!1);if(!Or.isArray(n))return vo;for(var r,o=0,i=n.length,a=0,u=0;i>o;o++)if(r=n[o],Or.isNumber(r)&&isFinite(r))a+=r,u++;else if(Or.isDate(r))a+=fo._toOADate(r),u++;else if(null==r||""===r||Or.isBoolean(r));else if(!nr(r))return go;return 0===u?0:a/u}function Qn(e,t){var n=Fr(e[0],t,!0,!1);if(!Or.isArray(n))return vo;for(var r,o=0,i=n.length,a=0,u=0;i>o;o++)if(r=n[o],Or.isNumber(r)&&isFinite(r))a+=r,u++;else if(Or.isDate(r))a+=fo._toOADate(r),u++;else if(Or.isString(r))Or.isNumber(+r)&&isFinite(+r)&&(a+=+r),u++;else if(Or.isBoolean(r))a+=~~n[o],u++;else if(null==r)u++;else if(!nr(r))return go;return 0===u?0:a/u}function er(e,t){return 2===e.length?Zn([e[1]],t):vo}function tr(e){var t;if(isNaN(t=fo.D(e[1])))return go;for(var n=fo.toArr(e[0],1,!0,!0,!1),r=[],o=0;o<n.length;o++){var i=n[o];i!==fo.CalcConvertedError&&r.push(i)}if(r.sort(function(e,t){return e-t}),0===r.length)return mo;if(0>t||t>1)return mo;var a=t*(r.length-1),u=a%1;return a=parseInt(a.toString(),10),0===u?r[a]:fo.D(r[a])+u*(fo.D(r[a+1])-fo.D(r[a]))}function nr(e){return Or.isUndefined(e)||Or.isNull(e)}function rr(e,t){var n=Fr(e[0],t,!0,!1);if(!Or.isArray(n))return vo;for(var r,o,i,a=!1,u=0,c=n.length;c>u;u++)o=n[u],Or.isNumber(o)&&isFinite(o)?(nr(i)||o>i)&&(i=o):Or.isString(o)&&""!==o&&(r=+o,Or.isNumber(r)&&isFinite(r)&&(nr(i)||r>i)&&(i=r));return a?fo._fromOADate(i):void 0===i?go:i}function or(e,t){var n=Fr(e[0],t,!0,!1);if(!Or.isArray(n))return vo;for(var r,o,i=!1,a=0,u=n.length;u>a;a++){var c=n[a];Or.isNumber(c)&&isFinite(c)?(nr(o)||c>o)&&(o=c):Or.isDate(c)?(i=!0,r=fo._toOADate(c),(nr(o)||r>o)&&(o=r)):Or.isString(c)&&""!==c?(r=+c,Or.isNumber(r)&&isFinite(r)&&(nr(o)||r>o)&&(o=r)):Or.isBoolean(c)?(nr(o)||~~c>o)&&(o=~~c):!nr(c)}return i?fo._fromOADate(o):void 0===o?go:o}function ir(e,t){return 2===e.length?rr([e[1]],t):vo}function ar(e,t){var n=Fr(e[0],t,!0,!1);if(!Or.isArray(n))return vo;for(var r,o,i,a=!1,u=0,c=n.length;c>u;u++)o=n[u],Or.isNumber(o)&&isFinite(o)?(nr(i)||i>o)&&(i=n[u]):Or.isString(o)&&""!==o&&(r=+o,Or.isNumber(r)&&isFinite(r)&&(nr(i)||i>r)&&(i=r));return a?fo._fromOADate(i):void 0===i?go:i}function ur(e,t){var n=Fr(e[0],t,!0,!1);if(!Or.isArray(n))return vo;for(var r,o,i=!1,a=0,u=n.length;u>a;a++){var c=n[a];Or.isNumber(c)&&isFinite(c)?(nr(o)||o>c)&&(o=c):Or.isDate(c)?(i=!0,r=fo._toOADate(c),(nr(o)||o>r)&&(o=r)):Or.isString(c)&&""!==c?(r=+c,Or.isNumber(r)&&isFinite(r)&&(nr(o)||o>r)&&(o=r)):Or.isBoolean(c)?(nr(o)||o>~~c)&&(o=~~c):!nr(c)}return i?fo._fromOADate(o):void 0===o?go:o}function cr(e,t){return 2===e.length?ar([e[1]],t):vo}function lr(e){if(fo.err(e[0]))return e[0];if(fo.err(e[1]))return e[1];var t;if(isNaN(t=fo.I(e[1])))return go;for(var n=fo.toArr(e[0],1,!0,!0,!1),r=[],o=0;o<n.length;o++){var i=n[o];i!==fo.CalcConvertedError&&r.push(i)}return r.sort(function(e,t){return e-t}),0>=t||r.length<t?mo:r[r.length-t]}function sr(e){if(fo.err(e[0]))return e[0];if(fo.err(e[1]))return e[1];var t;if(isNaN(t=fo.I(e[1])))return go;for(var n=fo.toArr(e[0],1,!0,!0,!1),r=[],o=0;o<n.length;o++){var i=n[o];i!==fo.CalcConvertedError&&r.push(i)}return r.sort(function(e,t){return e-t}),0>=t||r.length<t?mo:r[t-1]}function fr(e){}function dr(e,t){var n=Fr(e[0],t,!0,!1);if(!Or.isArray(n))return vo;for(var r,o=0,i=0,a=n.length;a>o;o++)r=n[o],Or.isNumber(r)&&isFinite(r)||Or.isDate(r)?i++:Or.isString(r)&&Or.isNumber(+r)&&""!==r&&isFinite(+r)&&i++;return i}function pr(e,t){return 2===e.length?dr([e[1]],t):vo}function hr(e,t){var n=Fr(e[0],t,!0,!1);if(!Or.isArray(n))return vo;for(var r,o=0,i=0,a=n.length;a>o;o++)r=n[o],(Or.isNumber(r)&&isFinite(r)||Or.isDate(r)||Or.isBoolean(r)||Or.isString(r)&&""!==r)&&i++;return i}function gr(e,t){return 2===e.length?hr([e[1]],t):vo}function vr(e,t){if(1!==e.length)return vo;var n=e[0];return yo.tabRef(n)?n.calcSource.calcTable_.getRowCountInternal(t.groupPath,t.hierarchyPath):vo}function mr(e,t){var n=Fr(e[0],t,!0,!1);if(!Or.isArray(n))return vo;for(var r=0,o=0,i=n.length;i>r;r++)(Or.isUndefined(n[r])||Or.isNull(n[r])||""===n[r])&&o++;return o}function _r(e,t){var n=Fr(e[0],t,!0);return Or.isArray(n)?Or.uniq(n).length:vo}function yr(e,t){var n=Fr(e[0],t,!0);if(!Or.isArray(n))return vo;var r=Er(n,!0);return yo.err(r)?r:Or.isNaN(r)?mo:Wr(r)}function Cr(e,t){var n=Fr(e[0],t,!0);if(!Or.isArray(n))return vo;var r=Er(n,!1);return yo.err(r)?r:Or.isNaN(r)?mo:Wr(r)}function br(e,t){return 2===e.length?yr([e[1]],t):vo}function Sr(e,t){return 2===e.length?Cr([e[1]],t):vo}function wr(e,t){var n=Fr(e[0],t,!0);if(!Or.isArray(n))return vo;var r=Er(n,!0);return yo.err(r)?r:Or.isNaN(r)?mo:r}function Ir(e,t){var n=Fr(e[0],t,!0);if(!Or.isArray(n))return vo;var r=Er(n,!1);return yo.err(r)?r:Or.isNaN(r)?mo:r}function xr(e,t){return 2===e.length?wr([e[1]],t):vo}function Ar(e,t){return 2===e.length?Ir([e[1]],t):vo}function Er(e,t){var n,r=0,o=0,i=0;return Or.isArray(e)&&e.forEach(function(e){Or.isUndefined(e)||Or.isNull(e)||Or.isNumber(n=fo.D(e))&&(++r,o+=n,i+=n*n)}),r>1?t?zr(i-o*o/r,0)/(r-1):zr(i-o*o/r,0)/r:go}function Rr(e,t){var n=Fr(e[1],t,!0),r=Fr(e[2],t,!0),o=Fr(e[3],t,!0);if(!Or.isArray(n))return go;if(0===n.length)return[];var i=Or.isNumber(r)?r:1;if(0===i){var a=Or.isNumber(o)&&o>0?o:1;return Nr(n,a)}return Dr(n)}function Nr(e,t){function n(e,t){if(!Or.isNumber(t)||Or.isNaN(t))return!1;var n=0,r=e.length;if(0===r)return 0;var o=r,i=qr(r/2),a=i;do if(a=i,e[i]>t){if(0===i)return 0;r=i,i=qr((i+n)/2)}else{if(!(e[i+1]<=t))return i+1;if(i===o)return o+1;n=i,i=qr((i+r)/2)}while(a!==i)}var r,o,i=[];r=0,e.forEach(function(e){(Or.isFinite(e)||Or.isDate(e))&&(i[r++]=+e)});var a,u,c;if(u=c=i[0],i.forEach(function(e){Or.isNumber(e)&&(u=Yr(e,u),c=zr(e,c))}),u=qr(u/t)*t,c=Xr(c/t)*t,!Or.isNumber(u)||Or.isNaN(u)||!Or.isNumber(c)||Or.isNaN(c))return go;for(a=[],r=0,o=Math.round((c-u)/t),a.length=o;o>=r;++r)a[r]=r*t+u;var l=[];for(l.length=a.length+1,r=0,o=l.length;o>r;++r)l[r]=0;return i.forEach(function(e){var t=n(a,e);t!==!1&&++l[t]}),l}function Dr(e){for(var t={},n=0,r=e.length;r>n;++n){var o=e[n];Or.isUndefined(t[o])?t[o]=1:++t[o]}var i=Or.keys(t);return i.sort(),i.map(function(e){return t[e]})}function Fr(e,t,n,r){var o,i=e;return Or.isArray(i)?(o=t.getCurrentRow(n),o>=0?i[o]:i):yo.columnRef(i)?i.getValue(t.getCurrentRow(n),t.groupPath,t.hierarchyPath,r):yo.fieldRef(i)?i.getValue():i}function Tr(e,t,n){var r,o,i;if(!e||0===e.length)return vo;var a=e.length;if(1===a)return i=e[0],Or.isArray(i)?Or.map(i,function(e){return n(e)}):n(i);i=e;var u,c=[];if(Or.some(i,function(e){return Or.isArray(e)})){var l=t.calcSource.getDimension();for(r=0;l>r;r++){for(u=[],o=0;a>o;o++)u[o]=Or.isArray(i[o])?i[o][r]:i[o];c[r]=n(u)}return c}return n(i)}var Mr,Or=n(8),Lr=n(23);if(!Lr)throw"not found the calc module!";Mr=Lr.Common;var Pr=Lr.Functions;e.exports=Pr;var Gr=function(){},Br="Exp_InvalidArgument",kr="Exp_InvalidFunctionName",Ur="Exp_OverrideNotAllowed",Hr=null,Vr=void 0,jr=Math.abs,Wr=Math.sqrt,zr=Math.max,Yr=Math.min,qr=Math.floor,Xr=Math.ceil,$r=Math.round,Kr=Math.sin,Jr=Math.asin,Zr=Math.cos,Qr=Math.acos,eo=Math.tan,to=Math.atan,no=Math.atan2,ro=Math.exp,oo=Math.log,io=Math.PI,ao=Math.random,uo=Math.pow,co="string",lo="boolean",so="",fo=Mr.Convert,po=Mr.Errors,ho=(po.Null,po.DivideByZero),go=po.Value,vo=po.Reference,mo=(po.Name,po.NotAvailable,po.Number),_o=function(){function e(e,t,n){var r=arguments.length;this._init(e,2>r?0:t,3>r?0:n),this.typeName=""}return e.prototype._init=function(e,t,n){var r=this;r.name=e,r.minArgs=t,r.maxArgs=n},e.prototype.acceptsArray=function(e){return!1},e.prototype.acceptsReference=function(e){return!1},e.prototype.acceptsError=function(e){return!1},e.prototype.acceptsMissingArgument=function(e){return!1},e.prototype.isVolatile=function(){return!1},e.prototype.isBranch=function(){return!1},e.prototype.isFilter=function(){return!1},e.prototype.isTableResult=function(){return!1},e.prototype.tableArgIndex=function(){return-1},e.prototype.isCalculate=function(){return!1},e.prototype.isSummarize=function(){return!1},e.prototype.isAggregator=function(){return!1},e.prototype.isGroupSensitive=function(){return!1},e.prototype.isHierarchySensitive=function(){return!1},e.prototype.findTestArgument=function(){return-1},e.prototype.findBranchArgument=function(e){return-1},e.prototype.evaluate=function(e,t){},e.prototype.toString=function(){return this.name},e.prototype.toJSON=function(){var e={};for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},e.prototype.fromJSON=function(e){if(e)for(var t in e)e[t]!==Vr&&(this[t]=e[t])},e}();Pr.Function=_o;var yo=function(){function e(){}return e.fieldRef=function(e){return e instanceof Mr.CalcFieldReference},e.columnRef=function(e){return e instanceof Mr.CalcColumnReference},e.tabRef=function(e){return e instanceof Mr.CalcTableReference},e.err=function(e){return e instanceof Mr.CalcError},e}(),Co={},bo={};Pr.defineCustomFunction=t,Pr.findGlobalFunction=o;var So=function(){function e(){}return e.__isLeapYear=function(e){return e%400===0||e%4===0&&e%100!==0||1900===e},e.__compareDateTime=function(e,t){return e-t},e.__toOADate=function(e){return fo._toOADate(e)},e.__annual_year_basis=function(t,n){var r;switch(n){case 0:return 360;case 1:return r=e.__isLeapYear(t.getFullYear()),r?366:365;case 2:return 360;case 3:return 365;case 4:return 360;default:return-1}},e.__getDaysInMonth=function(t,n){switch(n){case 0:case 2:case 4:case 6:case 7:case 9:case 11:return 31;case 1:return e.__isLeapYear(t)?29:28;case 3:case 5:case 8:case 10:return 30}},e.__Days_Between_BASIS_30E_360=function(e,t){var n,r,o,i,a,u;return n=e.getFullYear(),r=e.getMonth(),o=e.getDate(),i=t.getFullYear(),a=t.getMonth(),u=t.getDate(),31===o&&(o=30),31===u&&(u=30),360*(i-n)+30*(a-r)+(u-o)},e.__Days_Between_BASIS_30Ep_360=function(e,t){var n,r,o,i,a,u;return n=e.getFullYear(),r=e.getMonth(),o=e.getDate(),i=t.getFullYear(),a=t.getMonth(),u=t.getDate(),31===o&&(o=30),31===u&&(u=1,a++),360*(i-n)+30*(a-r)+(u-o)},e.__Days_Between_BASIS_MSRB_30_360_SYM=function(t,n){var r,o,i,a,u,c;return r=t.getFullYear(),o=t.getMonth(),i=t.getDate(),a=n.getFullYear(),u=n.getMonth(),c=n.getDate(),2===o&&e.__getDaysInMonth(r,o)===i&&(i=30),2===u&&e.__getDaysInMonth(a,u)===c&&(c=30),31===c&&i>=30&&(c=30),31===i&&(i=30),360*(a-r)+30*(u-o)+(c-i)},e.__Days_Between_BASIS_MSRB_30_360=function(t,n){var r,o,i,a,u,c;return r=t.getFullYear(),o=t.getMonth(),i=t.getDate(),a=n.getFullYear(),u=n.getMonth(),c=n.getDate(),2===o&&e.__getDaysInMonth(r,o)===i&&2===u&&e.__getDaysInMonth(a,u)===c&&(i=30,c=30),31===c&&i>=30&&(c=30),31===i&&(i=30),360*(a-r)+30*(u-o)+(c-i)},e.__days_between_basis=function(t,n,r){var o=1;if(e.__compareDateTime(t,n)>0){var i=t;t=n,n=i,o=-1}switch(r){case 1:case 2:case 3:return o*fo.I(e.__toOADate(n)-e.__toOADate(t));case 4:return o*e.__Days_Between_BASIS_30E_360(t,n);case 5:return o*e.__Days_Between_BASIS_30Ep_360(t,n);case 6:return o*e.__Days_Between_BASIS_MSRB_30_360_SYM(t,n);default:return o*e.__Days_Between_BASIS_MSRB_30_360(t,n)}},e}();Pr._FinancialHelper=So;var wo=function(){function e(){}return e.st_normsdist=function(e){var t;if(isNaN(t=fo.D(e[0])))return go;var n,r,o,i=6;return 0===t?r=0:(n=.5*jr(t),n>=.5*i?r=1:1>n?(o=n*n,r=((((((((.000124818987*o-.001075204047)*o+.005198775019)*o-.019198292004)*o+.059054035642)*o-.151968751364)*o+.319152932694)*o-.5319230073)*o+.797884560593)*n*2):(n-=2,r=(((((((((((((-45255659e-12*n+.00015252929)*n-19538132e-12)*n-.000676904986)*n+.001390604284)*n-.00079462082)*n-.002034254874)*n+.006549791214)*n-.010557625006)*n+.011630447319)*n-.009279453341)*n+.005353579108)*n-.002141268741)*n+.000535310849)*n+.999936657524)),t>0?.5*(r+1):.5*(1-r)},e.__averageIncludeSubtotals=function(e,t,n){},e.__countIncludeSubtotals=function(e,t,n){},e.__countaIncludeSubtotals=function(e,t,n){},e.__maxIncludeSubtotals=function(e,t,n){},e.__minIncludeSubtotals=function(e,t,n){},e.st_percentile=tr,e}();Pr._StatHelper=wo,Pr.defineBuildInFunction=i;var Io=function(){function e(){}return e.days360=Lt,e.yearfrac=Gt,e}();Pr._DateHelper=Io,Pr.acceptsAny=a,Pr.acceptsOne=u,Pr.acceptsTwo=c,Pr.acceptsThree=l,Pr.isVolatile=s,Pr.acceptsOneTwo=f,Pr.isBranch=d,Pr.isFilter=p,Pr.isGroupSensitive=h,Pr.isHierarchySensitive=g,Pr.generatePathFn=v,Pr.firstTableArgIndex=m,Pr.secondTableArgIndex=_,Pr.tableResult=y,Pr.isAggregator=C,Pr.isCalculate=b,Pr.isSummarize=S,Pr.acceptsZero=w,Pr.findTestArgument=I,Pr.acceptsSecond=A,Pr.acceptsThird=E,Pr.acceptsFirstOrOne=R,Pr.acceptsFirst=N;var xo=function(){function e(){}return e.log=function(e,t){return isNaN(e)?e:isNaN(t)?t:1!==t&&1===e||0!==t&&t!==Number.POSITIVE_INFINITY?oo(e)/oo(t):NaN},e.log10=function(t){return e.log(t,10)},e}(),Ao=function(){function e(e){var t=qr(e);return n(e,t+1)?t+1:t}function t(e){var t=Xr(e);return n(e,t-1)?t-1:t}function n(e,t){return e===t?!0:jr(e-t)<jr(e)/281474976710656}function r(){var e=[];return e[0]=1,e[1]=10,e[2]=100,e[3]=1e3,e[4]=1e4,e[5]=1e5,e[6]=1e6,e[7]=1e7,e[8]=1e8,e[9]=1e9,e[10]=1e10,e[11]=1e11,e[12]=1e12,e[13]=1e13,e[14]=1e14,e[15]=1e15,e[16]=1e16,e}function o(e){var t=r(),n=t[e];return n!==Vr&&n!==Hr?n:uo(10,parseFloat(e))}function i(e,t){var n,r,o,i,a;switch(e){case 0:n=function(e,t){return t>=e},o=function(e,t){return t>=e};break;case 1:n=function(e,t){return e>=t},o=function(e,t){return e>=t};break;case 2:n=function(e,t){return e!==t},o=function(e,t){return e!==t};break;case 3:n=function(e,t){return t>e},o=function(e,t){return t>e};break;case 4:n=function(e,t){return e===t},o=function(e,t){return e===t},i=Mr.RegUtil.getWildcardCriteriaFullMatch(t),i&&(a=Mr.RegUtil.getRegIgnoreCase(i),r=function(e){return a.lastIndex=0,a.test(e)});break;case 5:n=function(e,t){return e>t},o=function(e,t){return e>t};break;default:return function(e){return!1}}var u=-1,c=!0;try{var l={value:0};t===Vr||t===Hr?u=0:fo.rD(t.toString(),l)?u=l.value:c=!1}catch(s){c=!1}return function(e){if(e!==Vr&&e!==Hr||(e=""),c){try{var a={value:0};if(fo.rD(e,a))return o(a.value,u)}catch(l){}}return i&&r?r(e.toString()):n(e.toString().toUpperCase(),t!==Vr&&t!==Hr?t.toString().toUpperCase():"")}}function a(e){if(fo.num(e))return i(4,e);for(var t="=><",n=e!==Vr&&e!==Hr?e.toString().toUpperCase():"",r="\x00",o=0;2>o&&o<n.length;o++){var a=n[o];if(-1!==t.indexOf(a))if("="===a)switch(r){case"<":return i(0,n.substring(2));case">":return i(1,n.substring(2));default:return i(4,"\x00"===r?n.substring(1):e)}else{if("\x00"===r){r=a;continue}if("<"===r)return">"===a?i(2,n.substring(2)):i(3,n.substring(1));if(">"===r)return i(5,n.substring(1))}else switch(r){case"<":return i(3,n.substring(1));case">":return i(5,n.substring(1))}}return i(4,e)}function u(n,r){if(isNaN(n))return go;var i=o(jr(r));return 0>r?n/=i:n*=i,n=0>n?t(n-.5):e(n+.5),0>r?n*=i:n/=i,fo.toResult(n)}function c(e,t){if(isNaN(e)||isNaN(t))return go;if(0>e||0>t||t>e)return mo;var n=1;t=Yr(e-t,t);for(var r=1;t>=r;r++)n*=e-r+1,n/=r;return fo.toResult(n)}function l(e){return oo(1+e)-(1+e-1-e)/(1+e)}function s(e,t){var n;return n=jr(e)>.5?uo(1+e,t):ro(t*l(e)),isFinite(n)?isNaN(n)&&(n=5e-324):n===Number.POSITIVE_INFINITY?n=1.79769e308:n===Number.NEGATIVE_INFINITY&&(n=-1.79769e308),n}function f(e){return(ro(e)+ro(-e))/2}function d(e){return(ro(e)-ro(-e))/2}return{approxFloor:e,approxCeiling:t,approxEqual:n,pow10:o,parseCriteria:a,round:u,combin:c,log10:xo.log10,log:xo.log,pow1p:s,log1p:l,cosh:f,sinh:d}}();Pr._MathHelper=Ao,i("ABS",D,{minArgs:1,maxArgs:1}),i("ACOS",Ee,{minArgs:1,maxArgs:1}),i("ASIN",Fe,{minArgs:1,maxArgs:1}),i("ATAN",Le,{minArgs:1,maxArgs:1}),i("ATAN2",Pe,{minArgs:2,maxArgs:2}),i("COS",Ae,{minArgs:1,maxArgs:1}),i("CEILING",O,{minArgs:2,maxArgs:2}),i("CURRENCY",B,{minArgs:1,maxArgs:1}),i("ODD",Y,{minArgs:1,maxArgs:1}),i("EVEN",U,{minArgs:1,maxArgs:1}),i("FLOOR",ue,{minArgs:2,maxArgs:2}),i("ISO.CEILING",P,{minArgs:1,maxArgs:2}),i("LN",j,{minArgs:1,maxArgs:1}),i("SQRT",re,{minArgs:1,maxArgs:1}),i("SIN",De,{minArgs:1,maxArgs:1}),i("TAN",Oe,{minArgs:1,maxArgs:1}),i("SIGN",Z,{minArgs:1,maxArgs:1}),i("GCD",te,{minArgs:1}),i("LCM",ne,{minArgs:1}),i("POWER",X,{minArgs:2,maxArgs:2}),i("MOD",z,{minArgs:2,maxArgs:2}),i("QUOTIENT",ie,{minArgs:2,maxArgs:2}),i("INT",T,{minArgs:1,maxArgs:1}),i("MROUND",le,{minArgs:2,maxArgs:2}),i("ROUND",fe,{minArgs:2,maxArgs:2}),i("ROUNDDOWN",pe,{minArgs:2,maxArgs:2}),i("ROUNDUP",ge,{minArgs:2,maxArgs:2}),i("TRUNC",me,{minArgs:1,maxArgs:2}),i("EXP",ye,{minArgs:1,maxArgs:1}),i("LOG",be,{minArgs:1,maxArgs:2}),i("LOG10",we,{minArgs:1,maxArgs:1}),i("SUM",K,{minArgs:1,isAggregator:Pr.isAggregator}),i("SUMX",J,{minArgs:1,maxArgs:2,tableArgIndex:Pr.firstTableArgIndex,isAggregator:Pr.isAggregator}),i("PI",q,{minArgs:0,maxArgs:0}),i("SQRTPI",Ie,{minArgs:1,maxArgs:1}),i("DEGREES",k,{minArgs:1,maxArgs:1}),i("RADIANS",xe,{minArgs:1,maxArgs:1}),i("COSH",Re,{minArgs:1,maxArgs:1}),i("ACOSH",Ne,{minArgs:1,maxArgs:1}),i("SINH",Te,{minArgs:1,maxArgs:1}),i("ASINH",Me,{minArgs:1,maxArgs:1}),i("TANH",Ge,{minArgs:1,maxArgs:1}),i("ATANH",Be,{minArgs:1,maxArgs:1}),i("FACT",H,{minArgs:1,maxArgs:1}),i("RAND",ke,{minArgs:0,maxArgs:0,isVolatile:s}),i("RANDBETWEEN",Ue,{
minArgs:2,maxArgs:2,isVolatile:s}),i("AND",Ve,{minArgs:1}),i("OR",We,{minArgs:1}),i("NOT",Ye,{minArgs:1,maxArgs:1}),i("IF",Xe,{minArgs:2,maxArgs:3,isBranch:d,acceptsError:Pr.acceptsOneTwo,findTestArgument:I,findBranchArgument:x}),i("IFERROR",Ke,{minArgs:2,maxArgs:2,acceptsError:Pr.acceptsZero}),i("TRUE",Ze,{minArgs:0,maxArgs:0}),i("FALSE",Qe,{minArgs:0,maxArgs:0}),i("DATE",et,{minArgs:3,maxArgs:3}),i("TIME",nt,{minArgs:3,maxArgs:3}),i("DATEVALUE",it,{minArgs:1,maxArgs:1}),i("TIMEVALUE",ut,{minArgs:1,maxArgs:1}),i("NOW",lt,{minArgs:0,maxArgs:0,isVolatile:s}),i("TODAY",st,{minArgs:0,maxArgs:0,isVolatile:s}),i("HOUR",ft,{minArgs:1,maxArgs:1}),i("MINUTE",pt,{minArgs:1,maxArgs:1}),i("SECOND",gt,{minArgs:1,maxArgs:1}),i("DAY",mt,{minArgs:1,maxArgs:1}),i("MONTH",yt,{minArgs:1,maxArgs:1}),i("YEAR",bt,{minArgs:1,maxArgs:1}),i("WEEKNUM",xt,{minArgs:1,maxArgs:2}),i("WEEKDAY",Et,{minArgs:1,maxArgs:2}),i("EDATE",Nt,{minArgs:2,maxArgs:2}),i("EOMONTH",Tt,{minArgs:2,maxArgs:2}),i("YEARFRAC",Gt,{minArgs:2,maxArgs:3}),i("BLANK",Bt,{minArgs:0,maxArgs:0}),i("TRIM",Ut,{minArgs:1,maxArgs:1}),i("FIXED",jt,{minArgs:1,maxArgs:3}),i("VALUE",Wt,{minArgs:1,maxArgs:1}),i("LOWER",Yt,{minArgs:1,maxArgs:1}),i("UPPER",Xt,{minArgs:1,maxArgs:1}),i("REPLACE",Kt,{minArgs:4,maxArgs:4}),i("SUBSTITUTE",Zt,{minArgs:3,maxArgs:4}),i("CONCATENATE",en,{minArgs:2,maxArgs:2}),i("LEFT",nn,{minArgs:1,maxArgs:2}),i("MID",on,{minArgs:3,maxArgs:3}),i("RIGHT",un,{minArgs:1,maxArgs:2}),i("REPT",ln,{minArgs:2,maxArgs:2}),i("LEN",fn,{minArgs:1,maxArgs:1}),i("FIND",pn,{minArgs:2,maxArgs:4}),i("SEARCH",hn,{minArgs:2,maxArgs:4}),i("EXACT",vn,{minArgs:2,maxArgs:2}),i("T",_n,{minArgs:1,maxArgs:1}),i("FIRST",Bn,{minArgs:1,maxArgs:2,tableArgIndex:Pr.firstTableArgIndex}),i("LAST",kn,{minArgs:1,maxArgs:2,tableArgIndex:Pr.firstTableArgIndex}),i("CONTAINS",Cn,{minArgs:2}),i("ISERROR",bn,{minArgs:1,maxArgs:1,acceptsError:Pr.acceptsZero}),i("ISNUMBER",wn,{minArgs:1,maxArgs:1,acceptsError:Pr.acceptsZero}),i("ISEVEN",xn,{minArgs:1,maxArgs:1}),i("ISODD",An,{minArgs:1,maxArgs:1}),i("N",En,{minArgs:1,maxArgs:1}),i("ISBLANK",Rn,{minArgs:1,maxArgs:1,acceptsError:Pr.acceptsZero}),i("ISLOGICAL",Dn,{minArgs:1,maxArgs:1,acceptsError:Pr.acceptsZero}),i("ISTEXT",Tn,{minArgs:1,maxArgs:1,acceptsError:Pr.acceptsZero}),i("ISNONTEXT",On,{minArgs:1,maxArgs:1,acceptsError:Pr.acceptsZero}),i("HIERARCHY.LEVEL",Ln,{minArgs:0,maxArgs:0,acceptsError:Pr.acceptsZero,isHierarchySensitive:Pr.isHierarchySensitive,aggregatorCacheAnchor:Pr.generatePathFn(0,-1)}),i("GROUP.LEVEL",Pn,{minArgs:0,maxArgs:0,acceptsError:Pr.acceptsZero,isGroupSensitive:Pr.isGroupSensitive,aggregatorCacheAnchor:Pr.generatePathFn(0)}),i("AVERAGE",Zn,{minArgs:1,maxArgs:1,isAggregator:Pr.isAggregator}),i("AVERAGEA",Qn,{minArgs:1,maxArgs:1,isAggregator:Pr.isAggregator}),i("AVERAGEX",er,{minArgs:1,maxArgs:2,tableArgIndex:Pr.firstTableArgIndex,isAggregator:Pr.isAggregator}),i("MAX",rr,{minArgs:1,isAggregator:Pr.isAggregator}),i("MAXA",or,{minArgs:1,isAggregator:Pr.isAggregator}),i("MAXX",ir,{minArgs:1,maxArgs:2,isAggregator:Pr.isAggregator,tableArgIndex:Pr.firstTableArgIndex}),i("MIN",ar,{minArgs:1,isAggregator:Pr.isAggregator}),i("MINA",ur,{minArgs:1,isAggregator:Pr.isAggregator}),i("MINX",cr,{minArgs:1,maxArgs:2,isAggregator:Pr.isAggregator,tableArgIndex:Pr.firstTableArgIndex}),i("LARGE",lr,{minArgs:2,maxArgs:2}),i("SMALL",sr,{minArgs:2,maxArgs:2}),i("RANK.EQ",fr,{minArgs:2,maxArgs:3}),i("COUNT",dr,{minArgs:1,maxArgs:1,isAggregator:Pr.isAggregator}),i("COUNTX",pr,{minArgs:1,maxArgs:2,tableArgIndex:Pr.firstTableArgIndex,isAggregator:Pr.isAggregator}),i("COUNTA",hr,{minArgs:1,maxArgs:1,isAggregator:Pr.isAggregator}),i("COUNTAX",gr,{minArgs:1,maxArgs:2,tableArgIndex:Pr.firstTableArgIndex,isAggregator:Pr.isAggregator}),i("COUNTROWS",vr,{minArgs:0,maxArgs:1,tableArgIndex:Pr.firstTableArgIndex,isAggregator:Pr.isAggregator}),i("COUNTBLANK",mr,{minArgs:1,maxArgs:1,isAggregator:Pr.isAggregator}),i("DISTINCTCOUNT",_r,{minArgs:1,maxArgs:1,isAggregator:Pr.isAggregator}),i("STDEV.S",yr,{minArgs:1,maxArgs:1,isAggregator:Pr.isAggregator}),i("STDEV.P",Cr,{minArgs:1,maxArgs:1,isAggregator:Pr.isAggregator}),i("STDEVX.S",br,{minArgs:1,maxArgs:2,tableArgIndex:Pr.firstTableArgIndex,isAggregator:Pr.isAggregator}),i("STDEVX.P",Sr,{minArgs:1,maxArgs:2,tableArgIndex:Pr.firstTableArgIndex,isAggregator:Pr.isAggregator}),i("VAR.S",wr,{minArgs:1,maxArgs:1,isAggregator:Pr.isAggregator}),i("VAR.P",Ir,{minArgs:1,maxArgs:1,isAggregator:Pr.isAggregator}),i("VARX.S",xr,{minArgs:1,maxArgs:2,tableArgIndex:Pr.firstTableArgIndex,isAggregator:Pr.isAggregator}),i("VARX.P",Ar,{minArgs:1,maxArgs:2,tableArgIndex:Pr.firstTableArgIndex,isAggregator:Pr.isAggregator}),i("HISTOGRAM",Rr,{minArgs:1,maxArgs:3,tableArgIndex:Pr.firstTableArgIndex}),i("TOPN",$n,{minArgs:2,isFilter:Pr.isFilter,tableArgIndex:Pr.secondTableArgIndex,isTableResult:Pr.tableResult}),i("ALL",Un,{minArgs:0,isFilter:Pr.isFilter,isTableResult:Pr.tableResult}),i("CALCULATE",Hn,{minArgs:1,isCalculate:Pr.isCalculate}),i("DISTINCT",jn,{minArgs:1,maxArgs:1,isFilter:Pr.isFilter,isTableResult:Pr.tableResult}),i("FILTER",Wn,{minArgs:1,maxArgs:2,isFilter:Pr.isFilter,tableArgIndex:Pr.firstTableArgIndex,isTableResult:Pr.tableResult}),i("GROUP.PARENT",zn,{minArgs:0,isFilter:Pr.isFilter,isTableResult:Pr.tableResult,isGroupSensitive:Pr.isGroupSensitive,aggregatorCacheAnchor:Pr.generatePathFn(0)}),i("GROUP.CURRENT",Yn,{minArgs:0,isFilter:Pr.isFilter,isTableResult:Pr.tableResult,isGroupSensitive:Pr.isGroupSensitive,aggregatorCacheAnchor:Pr.generatePathFn(0)}),i("HIERARCHY.CURRENT",qn,{minArgs:0,isFilter:Pr.isFilter,isTableResult:Pr.tableResult,isHierarchySensitive:Pr.isHierarchySensitive,aggregatorCacheAnchor:Pr.generatePathFn(0,-1)}),i("HIERARCHY.CHILDREN",Xn,{minArgs:0,isFilter:Pr.isFilter,isTableResult:Pr.tableResult,isHierarchySensitive:Pr.isHierarchySensitive,aggregatorCacheAnchor:Pr.generatePathFn(0,0)}),i("SUMMARIZE",Vn,{minArgs:1,isSummarize:Pr.isSummarize,isFilter:Pr.isFilter,tableArgIndex:Pr.firstTableArgIndex,isTableResult:Pr.tableResult})}()},function(e,t,n){"use strict";!function(){var t=n(20),r=n(24),o=n(29);e.exports={Common:t,DataManager:r,Functions:o}}()},function(e,t,n){"use strict";!function(){var t=n(8),r=n(25),o=n(7).Event,i=Object.defineProperty,a=function(){function e(e,n,r,o){var i=this;i.dataManager_=e,i.gd_=n,i.calcGroup_=r,i.parent_=o,i.collapsed_=t.isBoolean(r.collapsed)?r.collapsed:n?!!n.collapsed:!1,i.groups_=[];var a=e.hierarchyDescriptor;r.isBottomLevel&&r.rootNode&&a&&(i.rootNode_=l.createCVTree_.call(e,r.rootNode),i.rootNode_.group=i)}function n(){var e=this;r(e,function(t){var n=t.calcGroup_;n.rootNode&&(t.rootNode_=l.createCVTree_.call(e.dataManager_,n.rootNode),t.rootNode_.group=t)})}function r(e,n){e.isBottomLevel?n(e):t.forEach(e.groups,function(e){r(e,n)})}e.prototype={getItem:function(e,t,n){return this.calcGroup_.getItem(e,t,n)},getItems:function(){return this.calcGroup_.getItems()},getSourceRowIndex:function(e){return this.calcGroup_.toSourceIndex(e)},toGlobalIndex_:function(e){return this.calcGroup_.toGlobalIndex(e)},findChildGroupByPath:function(e){var n=this;if(!e)return n;for(var r=t.isArray(e)?e:[e],o=0,i=r.length;i>o;++o){if(n.isBottomLevel||!n)return n;n=n.groups[r[o]]}return n},findChildGroupByName_:function(e){var t=this;if(!t.isBottomLevel){var n=t.calcGroup_.groupHashMapping&&t.calcGroup_.groupHashMapping[e];if(n){var r=n.path[n.path.length-1];return t.groups&&t.groups[r]}}},getIndexMapping_:function(e,n,r){return t.clone(this.calcGroup_.getIndexMappingIndexes_(e,n,r))},getCalculatedColumnValues:function(e){return this.dataManager_.calcSource_.getValues(e,this.path)},evaluate:function(e){var t=this,n=t.dataManager_.calcSource_,r=n.getEvaluatorContext(-1,t.path);return n.evaluate(e,r)},updateTree_:function(){n.call(this)}};var o=e.prototype;return i(o,"name",{get:function(){return this.calcGroup_.name},enumerable:!0,configurable:!0}),i(o,"collapsed",{get:function(){return this.collapsed_},set:function(e){var t=this;t.collapsed_=!!e,t.calcGroup_.collapsed=t.collapsed_},enumerable:!0,configurable:!0}),i(o,"parent",{get:function(){return this.parent_},enumerable:!0,configurable:!0}),i(o,"level",{get:function(){return this.calcGroup_.level},enumerable:!0,configurable:!0}),i(o,"isBottomLevel",{get:function(){return this.calcGroup_.isBottomLevel},enumerable:!0,configurable:!0}),i(o,"itemCount",{get:function(){return this.calcGroup_.itemCount},enumerable:!0,configurable:!0}),i(o,"expandedItemCount",{get:function(){return this.calcGroup_.displayItemCount},enumerable:!0,configurable:!0}),i(o,"groups",{get:function(){return this.groups_},enumerable:!0,configurable:!0}),i(o,"groupDescriptor",{get:function(){return this.gd_},enumerable:!0,configurable:!0}),i(o,"nodes",{get:function(){return this.rootNode_&&this.rootNode_.children.length>0?this.rootNode_.children:null},enumerable:!0,configurable:!0}),i(o,"rootNode",{get:function(){return this.rootNode_},enumerable:!0,configurable:!0}),i(o,"isHierarchical",{get:function(){var e=this,t=!1;return r(e,function(e){return e.rootNode?(t=!0,!0):void 0}),t},enumerable:!0,configurable:!0}),i(o,"path",{get:function(){return this.calcGroup_.path},enumerable:!0,configurable:!0}),e}(),u=function(){function e(e,t,n){var r=this;r.dataManager_=e,r.calcNode_=t,r.parent_=n,r.children_=[]}function n(){for(var e=this;e.parent;)e=e.parent;return e&&e.group?e.group.path:void 0}e.prototype={getItem:function(){var e=this,t=e.calcNode_.getItem();return t.node=e,t},getSourceRowIndex:function(){return this.calcNode_.getSourceIndex()},getCalculatedColumnValues:function(e){var t=this;return t.dataManager_.calcSource_.getValues(e,n.call(t),t.path,!0)},findChildNodeByPath:function(e){var n=this;if(t.isNil(e))return n;var r=t.isArray(e)?e:[e],o=n;return t.forEach(r,function(e){if(o&&e>=0&&e<o.children.length){var t=o.children.slice();t.sort(function(e,t){var n=e.calcNode_.itemIndex,r=t.calcNode_.itemIndex;return n>r?1:r>n?-1:0}),o=t[e]}else o=null}),o},getIndexMapping_:function(e,n,r){return t.clone(this.calcNode_.getIndexMappingIndexes_(n,r))},evaluate:function(e){var t=this,r=t.dataManager_.calcSource_,o=r.getEvaluatorContext(-1,n.call(t),t.path);return r.evaluate(e,o)}};var r=e.prototype;return i(r,"collapsed",{get:function(){return this.calcNode_.collapsed},set:function(e){this.calcNode_.collapsed=!!e},enumerable:!0,configurable:!0}),i(r,"parent",{get:function(){return this.parent_},enumerable:!0,configurable:!0}),i(r,"level",{get:function(){return this.calcNode_.level},enumerable:!0,configurable:!0}),i(r,"children",{get:function(){return this.children_},enumerable:!0,configurable:!0}),i(r,"offset",{get:function(){var e=this,n=e.dataManager_.nodeOffset_;return isFinite(+n)?n:t.isFunction(n)?n(e,!1):e.level*e.dataManager_.nodeOffsetUnit_},enumerable:!0,configurable:!0}),i(r,"offsetUnit",{get:function(){return this.dataManager_.nodeOffsetUnit_},enumerable:!0,configurable:!0}),i(r,"path",{get:function(){return this.calcNode_.path},enumerable:!0,configurable:!0}),e}(),c=function(){var e=function(e,t){var n=this;n.expr_=t,n.dataManager_=e};return e.prototype={and:function(e){var t=this;return t.expr_=t.expr_?"(("+t.expr_+")&&("+e+"))":e,t},or:function(e){var t=this;return t.expr_=t.expr_?"(("+t.expr_+")||("+e+"))":e,t},"do":function(){var e=this;e.dataManager_.filterExpression=e.expr_},clear:function(){return this.expr_=null,this}},e}(),l=function(){function e(e,n){var i=this;i.sourceCollection_=e,i.columnDefs_=t.isArray(n)&&0===n.length?null:n,i.calcSource_=new r.CalcSource("__default",e,n),i.filterds_=[],i.serverFilterds_=[],i.sortds_=[],i.serverSortds_=[],i.gds_=[],i.hds_=null,i.rootGroup_=null,i.rootNode_=null,i.filterObj_=null,i.filterCallback_=null,i.sortCallback_=null,i.isSortStable_=!1,i.getDefaults=null,i.collectionChanged_=new o,i.suspend_=!1,i.nodeOffsetUnit_=20}function n(e,t,n,r){var o=e.getInstance("dataLoader"),i=void 0,a=void 0,u=void 0;o.executeAction(t,n,r,function(e){e.success&&("create"!==t&&"update"!==t||("create"===t?(i="insert",u=n.insertAt,a=n.dataItems):"update"===t&&(i="update",u=n.sourceIndex,a=n.newItem),o.updateMemo_({item:a,index:u,action:i})))})}function l(e){var t=this;t.isRefreshSuspended()||(t.calcSource_.filter(e),t.gds_&&h.call(t),t.hds_&&p.call(t))}function s(e,t,n){var r=this;if(!r.isRefreshSuspended()){var o=g.call(r,e);r.calcSource_.sort(o,t,n),r.gds_&&h.call(r),r.hds_&&p.call(r)}}function f(e){var t=this;if(!t.isRefreshSuspended()){var n=v.call(t,e);t.rootCalcGroup_=t.calcSource_.group(n),h.call(t),t.hds_&&p.call(t)}}function d(e){var t=this;if(!t.isRefreshSuspended()){if(e){var n=Number(e.offsetUnit);isFinite(n)&&n>0&&(t.nodeOffsetUnit_=n),t.nodeOffset_=e.offset}t.rootCalcNode_=t.calcSource_.hierarchy(e,t.rootCalcNode_),p.call(t)}}function p(){var e=this;e.rootGroup_?(e.rootNode_=null,e.rootGroup_.updateTree_()):(e.rootCalcNode_=e.calcSource_.getRootNode_(),e.rootNode_=e.rootCalcNode_&&S.call(e,e.rootCalcNode_))}function h(){var e=this;e.rootCalcGroup_=e.calcSource_.getRootGroup_(),e.rootCalcGroup_?e.rootGroup_=m.call(e,e.rootCalcGroup_):e.rootGroup_=null}function g(e){return e?t.map(e,function(e){var n=e.converter,r=t.assign({ascending:!0},e);return n&&(r.converter=n),r}):void 0}function v(e){var n=this;if(e){var r=n.getDefaults,o=r&&t.isFunction(r)?r():null,i=o&&o.getFormatter;return t.map(e,function(e){var n=e.converter,r=e.preDefinedGroups,o={field:e.field};return!n&&t.isFunction(i)&&(n=i(e.field)),t.isFunction(n)&&(o.converter=n),r&&(o.preDefinedGroups=r),o.collapsed=!!e.collapsed,o})}}function m(e,n){var r,o=this,i=e.level;i>=0&&(r=o.gds_[i]);var u=new a(o,r,e,n);if(!e.isBottomLevel)for(var c=t.map(e.groups,function(e){var t=m.call(o,e,u);return t}),l=0,s=c.length;s>l;l++)u.groups.push(c[l]);return u}function _(e){var t=this;t.collectionChanged_.raise(t,e)}function y(e){var n=this,r=t.every(e,function(e){return t.isString(e)}),o=t.every(e,function(e){return t.isObject(e)});if(!o){if(!r)return console&&console.error&&console.error("Can not mixing use the string of column ID and group setting object");e=t.map(e,function(e){return{field:e}})}var i=n.getDefaults,a=i&&t.isFunction(i)?i():null;if(a&&a.group){for(var u=a.group,c=[],l=0,s=e.length;s>l;l++){var f=e[l];f.header=t.defaults(f.header||{},u.header),f.footer=t.defaults(f.footer||{},u.footer),f=t.defaults(f,u),c.push(f)}return c}return e}function C(e){return t.every(e,function(e){return t.isObject(e)})?e:console&&console.error&&console.error("Can not mixing use the string of column ID and sort setting object")}function b(e){var n=t.every(e,function(e){return t.isString(e)}),r=t.every(e,function(e){return t.isObject(e)});if(!r){if(!n)return console&&console.error&&console.error("Can not mixing use the string of column ID and sort setting object");e=t.map(e,function(e){return{field:e}})}return e}function S(e,n){for(var r=this,o=new u(r,e,n),i=t.map(e.children,function(e){var t=S.call(r,e,o);return t}),a=0,c=i.length;c>a;a++)o.children_.push(i[a]);return o}e.prototype={getItem:function(e,n,r){var o=this;return t.isUndefined(e)||0>e?null:o.calcSource_.getRowItem(e,n,r)},getItems:function(){return this.calcSource_.toArray()},getNode:function(e,n){var r=this;if(r.rootNode_)return r.rootNode_.findChildNodeByPath(n);if(r.rootGroup_){var o=r.rootGroup_.findChildGroupByPath(e);return o?o.rootNode_&&!t.isUndefined(n)?o.rootNode_.findChildNodeByPath(n):o:null}},getGroup:function(e){var t=this;if(t.rootGroup_){var n=t.rootGroup_.findChildGroupByPath(e);return n}return null},updateItem:function(e,r){var o=this;if(t.isUndefined(e)||0>e)return null;var i=o.getItemBySourceIndex_(e);o.context_?n(o.context_,"update",{sourceIndex:e,newItem:r},{dataItem:r,oldDataItem:i}):o.uII_(e,r)},uII_:function(e,n,r){var o=this;if(t.isUndefined(e)||0>e)return null;var i=o.calcSource_.setRowItem(e,n,r);if(!i)return null;(o.filterds_&&o.filterds_.length||o.filterCallback_||o.filterExpr_)&&l.call(o,o.filterds_&&o.filterds_.length?o.filterds_:o.filterCallback_||o.filterExpr_),o.sortds_&&o.sortds_.length&&s.call(o,o.sortds_,o.sortCallback_,this.isSortStable_),(i.groupChanged||i.nodeChanged)&&o.calcSource_.getRowCount(!0),o.gds_&&h.call(o),o.hds_&&p.call(o),t.assign(i,{sourceIndex:e,action:"setItem"});var a=t.cloneDeep(i);return _.call(o,a),i},sII_:function(e,n,r){var o=this,i=o.calcSource_.setRowItems(e,n,r);if(0===i.length)return null;o.refresh(),o.calcSource_.getRowCount(!0);var a={data:t.cloneDeep(i),action:"setItems"};return _.call(o,a),i},insertDataItems:function(e,r){var o=this;t.isArray(e)||(e=[e]),o.context_?n(o.context_,"create",{dataItems:e,insertAt:r},{dataItem:e}):o.iDII_(e,r)},iDII_:function(e,n){var r=this;t.isArray(e)||(e=[e]),r.calcSource_.insertDataItems(e,n),r.refresh(),r.calcSource_.getRowCount(!0),_.call(r,{action:"insertDataItems",dataItems:e,insertAt:n})},iDIARLI_:function(e,n,r){var o=this;t.isArray(e)||(e=[e]);var i=o.pageController;if(i){var a=i.getStatus().pageSize,u=o.itemCount+e.length-a;u>0&&o.calcSource_.removeDataItems_(o.itemCount-u,u,!1)}o.calcSource_.insertDataItems(e,n,r),o.refresh(),o.calcSource_.getRowCount(!0),_.call(o,{action:"insertDataItems",dataItems:e,insertAt:n})},rDIAILI_:function(e,t,n,r){var o=this,i=o.calcSource_.removeDataItems(e,t);if(n&&n.length>0){var a=o.itemCount-t;o.calcSource_.insertDataItems(n,a,!0),o.updateRowStatus_(a,r)}o.refresh(),o.calcSource_.getRowCount(!0),_.call(o,{action:"removeDataItems",removeAt:i,count:t})},updateRowStatus_:function(e,t){if(t)for(var n=this,r=n.calcSource_.rowStatus,o=0,i=t.length;i>o;o++)r[e+o]=t[o]},removeDataItems:function(e,r){var o=this;(!t.isFinite(r)||0>r)&&(r=1);for(var i=Array(r),a=0;r>a;++a)i[a]=o.getItemBySourceIndex_(e+a).dataItem;if(o.context_){var u=i.length>1?i:i[0];n(o.context_,"delete",{removeAt:e,count:r,dataItem:u},{dataItem:u})}else o.rDII_(e,r)},rDII_:function(e,t){var n=this,r=n.calcSource_.removeDataItems(e,t);n.refresh(),n.calcSource_.getRowCount(!0),_.call(n,{action:"removeDataItems",removeAt:r,count:t})},filter:function(e){var n=this;return n.filterObj_||(n.filterObj_=new c(n,e)),t.isUndefined(e)||(n.filterObj_.expr_=e),n.filterObj_},refresh:function(){var e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0],t=this;t.calcSource_.clearAllStates_(),(e||t.filterds_&&t.filterds_.length||t.filterCallback_||t.filterExpr_)&&l.call(t,t.filterds_&&t.filterds_.length?t.filterds_:t.filterCallback_||t.filterExpr_),(e||t.sortds_&&t.sortds_.length)&&s.call(t,t.sortds_,t.sortCallback_,this.isSortStable_),(e||t.gds_&&t.gds_.length)&&f.call(t,t.gds_),(e||t.hds_)&&d.call(t,t.hds_)},addDataColumn:function(e,t){var n=this;n.calcSource_.addDataColumn(e,t),_.call(n,{action:"addDataColumn",column:e})},addCalculatedColumn:function(e,t){var n=this;n.calcSource_.addCalculatedColumn(e,t),_.call(n,{action:"addCalculatedColumn",column:e})},removeCalculatedColumn:function(e){var t=this;t.calcSource_.removeCalculatedColumn(e),_.call(t,{action:"removeCalculatedColumn",column:e})},getCalculatedColumns:function(){return this.calcSource_.getCalculatedColumns()},getCalculatedColumnValues:function(e){return this.calcSource_.getValues(e)},addCalculatedField:function(e,t){var n=this;n.calcSource_.addCalculatedField(e,t),_.call(n,{action:"addCalculatedField",field:e})},removeCalculatedField:function(e){var t=this;t.calcSource_.removeCalculatedField(e),_.call(t,{action:"removeCalcField",field:e})},getCalculatedFields:function(){return this.calcSource_.getCalculatedFields()},getCalculatedFieldValue:function(e){return this.calcSource_.getCalculatedFieldValue(e)},evaluate:function(e,t,n){var r=this.calcSource_,o=r.getEvaluatorContext(-1,t,n);return r.evaluate(e,o)},isCalculatedColumn:function(e){return!!this.calcSource_.findCalcColumn(e)},dirtyDataColumn:function(e,t){return this.calcSource_.dirtyColumn(e,t)},reCalculate:function(){this.calcSource_.dirtyAll(),this.refresh()},editCalculatedColumn:function(e,t){this.calcSource_.dirtyColumn(e,-1,t)},editCalculatedField:function(e,t){return this.calcSource_.dirtyField(e,t)},suspendRefresh:function(){this.suspend_=!0},resumeRefresh:function(){var e=this;e.suspend_=!1,e.refresh(!0)},isRefreshSuspended:function(){return this.suspend_},resetRowStatus_:function(e){this.calcSource_.resetRowStatus_(e)},isNewAddedRow:function(e){var t=this.calcSource_.rowStatus[e];return!!t&&!!t[0]},isModifiedRow:function(e){var t=this.calcSource_.rowStatus[e];return!!t&&!!t[1]},getSourceRowIndex_:function(e,t,n){return this.calcSource_.mapToSourceRow(e,t,n)},getCalcTableIndexMappings_:function(){return this.calcSource_&&this.calcSource_.calcTable_&&this.calcSource_.calcTable_.indexMappings_},appendSource_:function(e){var t=this;if(!e)return!1;var n=t.sourceCollection_.length;return t.iDII_(e,n),!0},setSource_:function(e,t,n,o){var i=this,a=e||i.sourceCollection_,u=n||i.columnDefs_;return a&&u?(i.sourceCollection_=a,i.columnDefs_=u,i.calcSource_=new r.CalcSource("__default",a,u),t&&(i.calcSource_.rowStatus=t),i.refresh(),!o&&e&&_.call(i,{action:"sourceChanged"}),!0):!1},getItemBySourceIndex_:function(e){return isFinite(e)?this.calcSource_.getRowItemBySourceIndex(e):null},gBSI_:function(e){return isFinite(e)?this.calcSource_.gBSI_(e):null},getIndexMapping_:function(){var e=this,n=e.calcSource_.getIndexMapping();if(!t.isArray(n)){n=[];var r=e.itemCount;n.length=r;for(var o=0;r>o;++o)n[o]=o;return n}return t.clone(n)},mVI_:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];return this.calcSource_.mapToViewRow(e,t,n)},mapToGlobalIndex_:function(e){return this.calcSource_.mapToGlobalRow(e)},updateGroupDescriptors_:function(e){var n,r,o=this,i=o.gds_;if(e){var a=t.isArray(e)?e:[e],u=y.call(o,a);for(n=0,r=i.length;r>n;n++)t.assign(i[n],u[n])}},isServerSideSort_:function(){var e=this.context_&&this.context_.getInstance("dataLoader");return!!t.property("dataSource.serverSideSort")(e)},isServerSideFilter_:function(){var e=this.context_&&this.context_.getInstance("dataLoader");return!!t.property("dataSource.serverSideFilter")(e)},removeEmptyGroup:function(){this.calcSource_.clearGroupCache(),this.refresh()}};var w=e.prototype;return i(w,"filterDescriptors",{get:function(){return this[this.isServerSideFilter_()?"serverFilterds_":"filterds_"]},set:function(e){var n=this,r=[];e=e||[],r=C(t.isArray(e)?e:[e]);var o=n.isServerSideFilter_();if(o){n.serverFilterds_=r;var i=n.context_.getInstance("dataLoader");i.dataChanged.raise(null,{changes:"all"})}else n.filterds_=r,l.call(n,n.filterds_),_.call(n,{action:"filter"})},enumerable:!0,configurable:!0}),i(w,"filterExpression",{get:function(){return this.filterExpr_},set:function(e){var n=this;t.isFunction(e)?n.filterCallback_=e:n.filterExpr_=e,l.call(n,e),_.call(n,{action:"filter"})},enumerable:!0,configurable:!0}),i(w,"sortDescriptors",{get:function(){return this[this.isServerSideSort_()?"serverSortds_":"sortds_"]},set:function(e){var n=this,r=[],o=n.isServerSideSort_();if(e){var i=t.isArray(e)?e:[e];r=b(i)}if(o){n.serverSortds_=r;var a=n.context_.getInstance("dataLoader");a.dataChanged.raise(null,{changes:"all"})}else n.sortds_=r,s.call(n,r,n.sortCallback_,n.isSortStable_),_.call(n,{action:"sort"})},enumerable:!0,configurable:!0}),i(w,"groupDescriptors",{get:function(){return this.gds_},set:function(e){var n=this,r=[];if(e){var o=t.isArray(e)?e:[e];r=y.call(n,o)}n.gds_=r,f.call(n,r),_.call(n,{action:"group"})},enumerable:!0,configurable:!0}),i(w,"hierarchyDescriptor",{get:function(){return this.hds_},set:function(e){var n=this;n.hds_=t.clone(e),e&&!e.hasOwnProperty("collapsed")&&(n.hds_.collapsed=!0),d.call(n,e),_.call(n,{action:"hierarchy"})},enumerable:!0,configurable:!0}),i(w,"itemCount",{get:function(){return this.calcSource_.getRowCount()},enumerable:!0,configurable:!0}),i(w,"expandedItemCount",{get:function(){var e=this;return e.rootNode_?e.rootNode_.calcNode_.getNodeCount(!1,!1):e.rootGroup_?e.rootGroup_.calcGroup_.displayItemCount:e.calcSource_.getRowCount()},enumerable:!0,configurable:!0}),i(w,"sourceCollection",{get:function(){return this.sourceCollection_},enumerable:!0,configurable:!0}),i(w,"groups",{get:function(){return this.rootGroup_?this.rootGroup_.groups:null},enumerable:!0,configurable:!0}),i(w,"rootGroup",{get:function(){return this.rootGroup_},enumerable:!0,configurable:!0}),i(w,"nodes",{get:function(){return this.rootNode_?this.rootNode_.children:null},enumerable:!0,configurable:!0}),i(w,"rootNode",{get:function(){return this.rootNode_},enumerable:!0,configurable:!0}),i(w,"isHierarchical",{get:function(){var e=this;return!!(e.rootNode_||e.rootGroup_&&e.rootGroup_.isHierarchical)},enumerable:!0,configurable:!0}),i(w,"isSortStable",{get:function(){return this.isSortStable_},set:function(e){var t=this;t.isSortStable_!==e&&(t.isSortStable_=e,s.call(t,t.sortds_,t.sortCallback_,t.isSortStable_),_.call(t,{action:"sort"}))},enumerable:!0,configurable:!0}),e.createCVTree_=S,e}();l.DataManagerGroup=a,l.DataManagerNode=u,t.extend(l.prototype,{metaData_:{cid:"dataManager",className:"DataManager"}}),e.exports=l}()},function(e,t,n){"use strict";!function(){var t=n(8),r=n(20),o=n(26),i=n(27),a=n(31),u=n(32).Parser,c=n(30),l=function(){function e(e,n,r){if(e){var i=this;i.name=e,i.dataSource=t.isNil(n)?[]:n;var a=[],u=[];i.rowStatus=[],r&&t.forEach(r,function(e){var n=e.field;n&&(t.startsWith(t.trim(n),"=")?u.push(e):a.push(e))}),i.dataColumns_=new o.DataColumnsModel(i.dataSource,a),i.calcColumns_=new o.CalcColumnsModel(i),i.calcTable_=new o.CalcTableModel(i,i.dataColumns_,i.calcColumns_),i.calcFields_=new o.CalcFieldsModel(i),i.calcGroupFields_=new o.CalcGroupFieldsModel(i),u&&u.length&&t.forEach(u,function(e){i.calcColumns_.addColumn(e.name,e.field,e.caption)})}}function n(e,n,r){var o=arguments.length<=3||void 0===arguments[3]?1:arguments[3],a=this,u=a.dataColumns_.sourceCollection;u&&(u.removeItems&&t.isFunction(u.removeItems)?u.removeItems(n,o):t.isArray(u)&&u.splice(n,o),r&&a.rowStatus.splice(n,o)),t.forEachRight(e,function(e){e.prototype===i.CALC_COLUMN&&e.values.splice(n,o),e.dirtyStates.splice(n,o)})}function l(e){var t=this,n=t.calcColumns_.findColumn(e);if(n){t.calcColumns_.removeColumn(e);var r=h.call(t,{calc:n});b.call(t,r)}}function s(e){var t=this,n=t.findCalcField(e);if(n){t.calcFields_.removeField(e);var r=h.call(t,{calc:n});b.call(t,r)}}function f(e,n,r){var o=this,i=[],a=o.dataColumns_.columns;o.findDataColumn(e.name)?t.forEach(a,function(t){t.field===e.field&&i.push(t)}):i.push(e);var u=[];return t.forEach(i,function(e){u.push(d.call(o,e,n,r))}),t.some(u,function(e){return e})}function d(e,n,r){var o=this;e.type===i.DATA_COLUMN?o.dataColumns_.dirty(e,n):e.type===i.CALC_COLUMN&&o.calcColumns_.dirty(e,-1,r);var a=h.call(o,{calc:e,index:n});return C.call(o,a),t.some(a,function(e){return e.calc.type===i.CALC_COLUMN&&-1===e.index})}function p(){var e=this;t.forEach(e.calcColumns_.getColumns(),function(t){t&&t.exprInfo&&t.exprInfo.hasAggFn&&f.call(e,t)})}function h(e){var n=this,r=g.call(n,e);return r.length>0&&t.forEach(r,function(e){var t=h.call(n,e);r=r.concat(t)}),r}function g(e){var n=this,r=[],o=n.calcColumns_.getColumns();t.forEach(o,function(t){v.call(n,e.calc,t)&&(y(e.calc,t.expression)?r.push({calc:t,index:-1}):r.push({calc:t,index:e.index}))});var i=n.calcFields_.getFields();t.forEach(i,function(t){v.call(n,e.calc,t)&&r.push({calc:t,index:-1})});var a=n.calcGroupFields_.getFields();return t.forEach(a,function(t){v.call(n,e.calc,t)&&r.push({calc:t,index:-1})}),r}function v(e,t){var n=this,r=t.depends;if(r&&r.length)for(var o=0,i=r.length;i>o;o++)if(m.call(n,e,r[o]))return!0}function m(e,t){if(t.type===e.type){var n=t.type;switch(n){case i.CALC_COLUMN:return _(t.column,e.name);case i.DATA_COLUMN:return _(t.column,e.name);case i.CALC_FIELD:return _(t.name,e.name);default:return!1}}}function _(e,t){return e===t||e&&e.toLowerCase&&t&&t.toLowerCase&&e.toLowerCase()===t.toLowerCase()}function y(e,n){if(i.aggFn(n))return!0;if(i.binaryExpr(n)){var r=y(e,n.left);return r?!0:y(e,n.right)}if(i.fnExpr(n)){if(i.aggFn(n))return!0;var o=n.args;if(o&&o.length>0)return t.some(o,function(t){return y(e,t)})}return!1}function C(e){var n=this;t.forEach(e,function(e){var t=e.calc,r=e.index,o=t.type;switch(o){case i.DATA_COLUMN:void 0!==e.index&&n.dataColumns_.dirty(t,r);break;case i.CALC_COLUMN:void 0!==e.index&&n.calcColumns_.dirty(t,r);break;case i.CALC_FIELD:n.calcFields_.dirty(t);break;case i.CALC_G_FIELD:n.calcGroupFields_.dirty(t)}})}function b(e){var n=this;t.forEach(e,function(e){var t=e.calc,r=t.type;switch(r){case i.CALC_COLUMN:n.calcColumns_.updateColumnFormula(t.name);break;case i.CALC_FIELD:n.calcFields_.updateFieldFormula(t.name);break;case i.CALC_G_FIELD:}})}function S(){var e=this,n=[],r=e.calcColumns_.getColumns();return r&&t.forEach(r,function(t){var r=w.call(e,t.expression);r&&n.push(t.name)}),n}function w(e){if(!e)return!1;if(i.unknowExpr(e))return!0;if(i.binaryExpr(e))return!(!w(e.left)&&!w(e.right));if(i.fnExpr(e)){var t=e.args;if(t&&t.length>0)for(var n=0,r=t.length;r>n;n++)if(w(t[n]))return!0;return!1}return!1}function I(){var e=this;t.forEach(e.calcColumns_.getColumns(),function(t){t&&t.exprInfo&&t.exprInfo.hierarchySensitive&&f.call(e,t)})}function x(){var e=this;t.forEach(e.calcColumns_.getColumns(),function(t){t&&t.exprInfo&&t.exprInfo.groupSensitive&&f.call(e,t)})}return e.prototype={getName:function(){return this.name},setRowItem:function(e,t,n){var r=this,o=r.calcTable_.setRowItem(e,t);if(o){var i=r.rowStatus[e]||[];i[0]!==!0&&(i[1]=!n,r.rowStatus[e]=i)}return o},setRowItems:function(e,n,r){var o=this,i=o.calcTable_.setRowItems(e,n);return i&&t.each(e,function(t){var n=o.rowStatus[t]||[];n[0]!==!0&&(n[1]=!r,o.rowStatus[e]=n)}),i},spliceInsert_:function(e,t,n,r){e.length>=t?e.splice(t,n,r):e[t]=r},resetRowStatus_:function(e){delete this.rowStatus[e]},getRowItem:function(e,t,n){return this.calcTable_.getRowItem(e,t,n)},getRowItemBySourceIndex:function(e){return this.calcTable_.getRowItemBySrcIndex_(e)},gBSI_:function(e){return this.calcTable_.gBSI_(e)},getIndexMapping:function(){return this.calcTable_.getIndexMappingIndexes_()},hasColumn:function(e){var t=this;return!!t.calcTable_.findColumn(e)},hasField:function(e){var t=this;return!!t.calcFields_.findField(e)},addDataColumn:function(e,t,n){this.dataColumns_.addColumn(e,t,n)},addCalculatedColumn:function(e,t,n){this.calcColumns_.addColumn(e,t,n)},removeCalculatedColumn:function(e){l.call(this,e)},getCalculatedColumns:function(){var e=this,n=e.calcColumns_.getColumns();return t.map(n,function(e){return{name:e.name,formula:e.formula}})},addCalculatedField:function(e,n){var r=this;r.calcFields_.addField(e,n);var o=S.call(r);o.length>0&&t.forEach(o,function(e){r.calcColumns_.updateColumnFormula(e)})},removeCalculatedField:function(e){s.call(this,e)},getCalculatedFields:function(){var e=this,n=e.calcFields_.getFields();return t.map(n,function(e){return{name:e.name,formula:e.formula}})},getCalculatedFieldValue:function(e){return this.calcFields_.getValue(e)},insertDataItems:function(e,n,r){var o,a,u=this,c=t.isUndefined(n)?u.getDimension():n,l=u.dataColumns_.sourceCollection;if(l)for(o=0,a=e.length;a>o;o++)l.addItem&&t.isFunction(l.addItem)?l.addItem(e[o],c+o):t.isArray(l)&&u.spliceInsert_(l,c+o,0,e[o]),u.spliceInsert_(u.rowStatus,c+o,0,[!r]);var s=u.dataColumns_.columns.concat(u.calcColumns_.columns_);t.forEach(s,function(t){for(o=0,a=e.length;a>o;o++)t.prototype===i.CALC_COLUMN&&u.spliceInsert_(t.values,c+1,0,void 0),u.spliceInsert_(t.dirtyStates,c+1,0,!0),f.call(u,t,n+o)})},removeDataItems:function(e,t){return this.removeDataItems_(e,t,!0)},removeDataItems_:function(e,r,o){var i=this,a=i.dataColumns_.columns.concat(i.calcColumns_.columns_);if(t.isArray(e)){var u=e.slice();u.sort(function(e,t){return t>e?1:e>t?-1:0}),t.forEach(u,function(e){n.call(i,a,e,o,1)})}else n.call(i,a,e,o,r);return t.forEachRight(a,function(e){f.call(i,e)}),e},filter:function(e){var t=this;t.calcTable_.filter(e),p.call(t),x.call(t),I.call(t),t.calcFields_.calcFields_.forEach(function(e){t.dirtyField(e.name)}),t.calcGroupFields_.updateGroups();
},sort:function(e,t,n){var r=this;r.calcTable_.sort(e,t,n),r.calcGroupFields_.updateGroups()},group:function(e){var t=this,n=t.calcTable_.group(e);return x.call(t),t.calcGroupFields_.updateGroups(),n},clearGroupCache:function(){this.calcTable_.clearGroupCache_()},hierarchy:function(e,t){var n=this,r=n.calcTable_.hierarchy(e,t);return I.call(n),r},getValues:function(e,t,n,r){var o=this,i=o.findColumn(e);return i?this.calcTable_.getValues(i,t,n,void 0,void 0,r):null},getValue:function(e,t){var n=this,r=n.findColumn(e);return r?this.calcTable_.getValue(r,t,!1):null},getRowCount:function(e){return this.calcTable_.getRowCount(e)},getDimension:function(){return this.calcTable_.getDimension()},findColumn:function(e){var t=this;return t.findDataColumn(e)||t.findCalcColumn(e)},findDataColumn:function(e){return this.dataColumns_.findColumn(e)},findCalcColumn:function(e){return this.calcColumns_.findColumn(e)},findCalcField:function(e){return this.calcFields_.findField(e)},getFieldValue:function(e){return this.calcFields_?this.calcFields_.getValue(e):void 0},getParser:function(){return new u(r.parseOption)},getEvaluator:function(){return new a},getParserContext:function(){return new c.ParserContext(this)},getEvaluatorContext:function(e,t,n){return new c.EvaluateContext(this,e,t,n)},evaluate:function(e,t){var n=this,o=n.getEvaluator().evaluateFormula(e,new c.ParserContext(n),t?t:new c.EvaluateContext(n));return o instanceof r.CalcTableReference?o.toArray():o instanceof r.CalcColumnReference?o.getValue(-1,t.groupPath,t.hierarchyPath):o instanceof r.CalcFieldReference?o.getValue():o},clone:function(){var t=this,n=new e;return n.name=t.name,n.dataSource=t.dataSource,n.dataColumns_=t.dataColumns_,n.calcColumns_=t.calcColumns_,n.calcTable_=t.calcTable_.clone(),n.calcFields_=t.calcFields_,n.calcGroupFields_=t.calcGroupFields_,n},dirtyColumn:function(e,n,r){var o=this,i=o.findColumn(e);if(i){t.isUndefined(n)&&(n=-1);var a=o.calcTable_.mapToSourceRow(n),u=f.call(o,i,a,r);return-1===n||u}},dirtyColumns:function(){var e=this,n=e.calcColumns_.getColumns();t.forEach(n,function(t){f.call(e,t,-1)})},dirtyField:function(e,n){var r=this,o=r.findCalcField(e);if(o){r.calcFields_.dirty(e,n);var a=h.call(r,{calc:o,index:-1});return C.call(r,a),t.some(a,function(e){return e.calc.type===i.CALC_COLUMN&&-1===e.index})}},dirtyFields:function(){var e=this,n=e.calcFields_.getFields(),r=[];return t.forEach(n,function(t){e.calcFields_.dirty(t);var n=h.call(e,{calc:t,index:-1});C.call(e,n),r.concat(n)}),t.some(r,function(e){return e.calc.type===i.CALC_COLUMN&&-1===e.index})},dirtyAll:function(){this.dirtyColumns(),this.dirtyFields()},toArray:function(e,t){return this.calcTable_.toArray(e,t)},mapToSourceRow:function(e,t,n){return this.calcTable_.mapToSourceRow(e,t,n)},mapToViewRow:function(e,t,n){return this.calcTable_.mapToViewRow(e,t,n)},mapToGlobalRow:function(e){return this.calcTable_.mapToGlobalRow(e)},isFilterOut:function(e){return this.calcTable_.isFilterOut(e)},findCalcGroupField_:function(e){return this.calcGroupFields_.findField(e)},getDataType_:function(e){var t=this.calcTable_.findColumn(e);return t?t.dataType:void 0},getRootGroup_:function(){return this.calcTable_.getRootGroup()},getRootNode_:function(){return this.calcTable_.getRootNode()},create_:function(t,n){return new e(t,n)},reproduce_:function(t,n){var r=this,o=new e;return o.name=r.name,o.dataSource=r.dataSource,o.dataColumns_=r.dataColumns_,o.calcColumns_=r.calcColumns_,o.calcTable_=r.calcTable_.reproduce_(t,n),o.calcFields_=r.calcFields_,o.calcGroupFields_=r.calcGroupFields_,o},bindGroup_:function(e){this.calcTable_.bindGroup(e)},bindHierarchy_:function(e,t,n){this.calcTable_.bindHierarchy(e,t,n)},getModel_:function(e){var t=this;switch(e){case i.DATA_COLUMN:return t.dataColumns_;case i.CALC_COLUMN:return t.calcColumns_;case i.CALC_TABLE:return t.calcTable_;case i.CALC_FIELD:return t.calcFields_;case i.CALC_G_FIELD:return t.calcGroupFields_}},getGroupBySourceRow_:function(e){return this.calcTable_.getGroupBySourceRow(e)},getNodeBySourceRow_:function(e){return this.calcTable_.getNodeBySourceRow(e)},overlapFilterStates_:function(e,t,n){var r=this;r.calcTable_.overlapFilterStates(e,t,n),r.calcGroupFields_.updateGroups()},overlapFilterSingleState_:function(e,t){var n=this;n.calcTable_.overlapFilterSingleState(e,t)},clearAllStates_:function(){this.calcTable_.clearAllStates_()},getValueBySourceIndex_:function(e,t,n){var r=this,o=r.findColumn(e);if(e){if(o.type===i.DATA_COLUMN)return r.dataColumns_.getValue(t,o,n);if(o.type===i.CALC_COLUMN)return r.calcColumns_.getValue(o,t)}}},e}();e.exports={CalcSource:l}}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(){var t=n(8),i=n(11),a=n(27),u=n(30),c={},l=Object.defineProperty,s=function(){function e(e,t,n,r,o){var i=this;i.level=n,i.table_=e,i.isBottomLevel=r,i.name=t,i.collapsed=o,i.itemCount_=0,r?i.items=[]:(i.groups=[],i.groupHashMapping={})}function n(e,r,o){if(e&&r){r(e);var i=o||function(){return null};return i(e.isBottomLevel?e.items:t.map(e.groups,function(e){return n(e,r,o)}))}}function r(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=[],o=!t&&e.collapsed;if(e.isBottomLevel)return o?[]:[e];if(!o)for(var i=0,a=e.groups.length;a>i;i++){var u=r(e.groups[i],t);n=n.concat(u)}return n}function o(e,t){var n=this;if(e){var r=c.call(n,e,t,!1);if(null===r||void 0===r||""===r)return;return r}}function u(e,t){e.groups||(e.groups=[]);for(var n=e.groups,r=0;r<n.length;r++)if(n[r].name===t)return n[r];var o={name:t,itemCount:0,items:[]};return n.push(o),o}function c(e,t){var n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2],r=this,o=r.table_,i=o.indexMappings_,u=r.items[t],c=u;i&&u>=0&&u<i.length&&(c=i[u]);var l;return l=e.type===a.DATA_COLUMN?o.dataColumns_.getValue(c,e,n):o.calcColumns_.getValue(e,c)}e.prototype={setItem:function(e,t,n,r){var o=this,a=o.searchChildGroup(e,n,r);if(a){var u=a.group,c=a.relativeIndex;return u.rootNode_||(o.table_.indexMappings_?(c=o.table_.indexMappings_[u.items[c]],i.isNil(c)&&(c=u.items[c])):c=u.items[c]),u.rootNode_?u.rootNode_.setItem(c,t,r):o.table_.setItemInternal(u,null,c,t)}return!1},getItem:function(e,t,n){var r=this,o=r.searchChildGroup(e,t,n);if(o){var i=o.group,a=o.relativeIndex;return i.rootNode_?i.rootNode_.getItem(a,n):r.table_.getRowItemByViewIndex_(o.group.items[a])}return null},getIndexMappingIndexes_:function(e,t,n){var r=this,o=[];if(r.rootNode_){var i=r.rootNode_.findNodeByPath(e,!0);i&&(o=i.getItemsIndexes_(t,n))}else{var a=r.getBottomGroups();if(a)for(var u=0,c=a.length;c>u;u++){var l=a[u];if(l.rootNode_)o=o.concat(l.rootNode_.getIndexMappingIndexes_(t,n));else for(var s=0,f=l.items.length;f>s;s++)o.push(l.items[s])}}return o},getItems:function(){var e=this,t=[],n=e.getBottomGroups();if(n)for(var r=0,o=n.length;o>r;r++){var i=n[r];if(i.rootNode_){var a=i.rootNode_.getItems({collapsed:!0});t=t.concat(a)}else for(var u=0,c=i.items.length;c>u;u++)t.push(e.table_.getRowItemByViewIndex_(i.items[u]))}return t},getItemCount:function(e){var n=this;if(e)if(n.rootNode_&&(n.itemCount_=n.rootNode_.getItemCount(e)),n.isBottomLevel)n.itemCount_=n.items.length;else{var r=n.groups,o=0;t.forEach(r,function(t){t.getItemCount(e),o+=t.itemCount}),n.itemCount_=o}return n.itemCount_},toSourceIndex:function(e){var t=this,n=t.searchChildGroup(e);if(!n)return-1;var r,o=n.group;if(o.rootNode_){var i=o.rootNode_.findNode(n.relativeIndex);i&&(r=i.itemIndex)}else r=n&&o.items[n.relativeIndex];var a=t.table_.indexMappings_;return a&&r>=0&&r<a.length?a[r]:r},hierarchy:function(e){var n=this,r=n.table_,o=n.hierarchyInfo_;n.hierarchyInfo_=e;var a=n.rootNode_,u={};if(a&&o&&o.keyField===e.keyField&&f.operateNodes_(a,function(e){u[e.value]=e.collapsed}),delete n.rootNode_,!e||!e.hasOwnProperty("parentField")||!e.hasOwnProperty("keyField"))return null;var c=n.createGroupsForTree_({field:e.parentField});if(c&&c.groups&&c.groups.length>0){var l=c.groups,s=n.table_.findColumn(e.keyField),p=t.find(l,i.mP("name",void 0));if(!p)return n.rootNode_=null,null;var h=new f(r,-1,null,-1,!1);return h.parentGroup=n,d.createTree_.call(r,p,h,l,s),h.getItemCount(!0),n.rootNode_=h,r.sortInfos_&&d.sortNode_.call(r,n.rootNode_,r.sortInfos_),a&&n.rootNode_&&f.operateNodes_(n.rootNode_,function(e){u.hasOwnProperty(e.value)&&(e.collapsed=u[e.value])}),n.rootNode_}},findNode:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],n=this;return n.rootNode_?n.rootNode_.findNode(e,t):void 0},toGlobalIndex:function(e){var t=this;if(e>=t.itemCount||0>e)return null;if(-1===t.level)return e;for(var n,r=e,o=t,i=[],a=o.parent;a;){i=a.groups;for(var u=0,c=i.length;c>u&&(n=i[u],n.name!==o.name);++u)r+=n.itemCount;o=a,a=o.parent}return r},mapToViewRow:function(e,t,n){if(t&&n)return e;var r=this.searchChildGroup(e,!0,!0,t,n);return r&&r.group.rootNode_?r.startIndex+r.group.rootNode_.mapToViewRow(r.relativeIndex,n):r.startIndex+r.relativeIndex},searchChildGroup:function(e){var n=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],r=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],o=arguments.length<=3||void 0===arguments[3]?!1:arguments[3],i=arguments.length<=4||void 0===arguments[4]?!1:arguments[4],a=this,u=e;if(0>u||u>=a.getGroupItemCount(n,r)||!t.isNumber(u)||t.isNaN(u))return null;var c=a,l=0;if(!c.isBottomLevel)for(var s,f,d=!0,p=0;d;){if(s=c.groups[p],!s)return null;n||!s.collapsed?(f=s.getGroupItemCount(n,r))>u?(c=s,d=!c.isBottomLevel,p=0):(!o&&s.collapsed||(l+=s.getGroupItemCount(o,i)),u-=f,++p):++p}return{startIndex:l,group:c,relativeIndex:u}},sortTree:function(){var e=this,n=e.getBottomGroups();n&&t.forEach(n,function(e){e.rootNode&&e.rootNode.sort()})},getBottomGroups:function(){return r(this)},getGroupItemCount:function(){var e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0],n=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],o=this,i=r(o,e),a=0;return t.forEach(i,function(e){e.hasOwnProperty("rootNode_")?e.rootNode&&(a+=e.rootNode.getNodeCount(!1,n)):a+=e.items.length}),a},findGroupByPath:function(e){for(var n=this,r=t.isArray(e)?e:[e],o=0,i=r.length;i>o;++o){if(n.isBottomLevel||!n)return n;n=n.groups[r[o]]}return n},pruneChildGroups:function(e){var t=this;e?t.items=[]:!function(){var e=[];n(t,function(t){t.isBottomLevel&&(e=[].concat.call(e,t.items))}),t.items=e}(),t.isBottomLevel=!0,t.groupHashMapping=null,t.groups=null},adoptChildGroups:function(){var e=this;e.items=null,e.isBottomLevel=!1,e.groups||(e.groups=[],e.groupHashMapping={})},clearContent:function(e){var t=this;n(t,function(t){t.isBottomLevel?t.items.length=0:e<=t.level&&t.pruneChildGroups(!0)})},createGroupsForTree_:function(e){var t=this;if(!t.isBottomLevel)return null;var n={},r=t.items.length;n.itemCount=r;var i,a,c,l,s=t.table_.findColumn(e.field);for(a=0;r>a;++a)i=n,c=o.call(t,s,a),l=u.call(t,i,c),++l.itemCount,l.parent=i,i=l,l.items.push(t.items[a]);return n}};var s=e.prototype;return l(s,"displayItemCount",{get:function(){return this.getGroupItemCount()},enumerable:!0,configurable:!0}),l(s,"itemCount",{get:function(){return this.itemCount_},enumerable:!0,configurable:!0}),l(s,"rootNode",{get:function(){return this.rootNode_},enumerable:!0,configurable:!0}),e}();c.CalcGroup_=s;var f=function(){function e(e,t,n,r,o){var i=this;i.itemIndex=t,i.children=[],i.parent=n,i.itemCount_=0,i.level=n&&n.hasOwnProperty("level")?n.level+1:-1,n&&n.children.push(i),void 0===o?i.collapsed=!0:i.collapsed=o,i.path=n?n.path?n.path.concat(r):[r]:null,i.table_=e}function n(e,r,o,i){if(t.isUndefined(o)||t.isNull(o)?o=-1:o++,t.isUndefined(r)&&(r=-1),o===r)return e;try{if(!e.collapsed||i)for(var a=0;a<e.children.length;a++){var u=n(e.children[a],r,o,i);if(!t.isNumber(u))return u;o=u}}catch(c){console.log(c)}return o}function r(e,n,r){var o=[];n.hasOwnProperty("currentIndex")?n.currentIndex++:n.currentIndex=-1===e.level?-1:0;var i=n.currentIndex;if(i>n.end)return o;for(var a=[e];a.length>0;){var u=a.pop();if(i>=n.start&&-1!==u.level&&(o.push(u),r&&r(u)))break;if(++i,i>n.end)break;if(n.collapsed||!u.collapsed){var c=u.children;if(c.length>20)a=a.concat(t.clone(c).reverse());else if(c.length>0)for(var l=0,s=a.length,f=c.length;f>l;++l)a[s+l]=c[f-l-1]}}return a.length=0,o}function o(e,t){r(e,{collapsed:!1,start:0,end:Number.MAX_VALUE},t)}return e.prototype={setItem:function(e,r){var o=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],i=this;if(t.isUndefined(e)||0>e)return i.table_.setItemInternal(i.getParentGroup(),i,i.getSourceIndex(),r);var a=n.call(i,i,e,null,o);return a?i.table_.setItemInternal(a.getParentGroup(),a,a.getSourceIndex(),r):!1},getItem:function(e){var r=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],o=this;if(t.isUndefined(e)||0>e)return o.table_.getRowItemByViewIndex_(o.itemIndex);var i=n.call(o,o,e,null,r);if(i){var a=o.table_.getRowItemByViewIndex_(i.itemIndex);return a?(a.node=i,a):null}},getItems:function(e){var n=this,o=r(n,{collapsed:e?!!e.collapsed:!1,start:e&&e.start?e.start:0,end:e&&e.end?e.end:Number.MAX_VALUE});return t.map(o,function(e){return e.getItem()})},findNode:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return n(this,e,null,t)},findNodeByPath:function(e){var n=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],r=this;if(e&&e.length){var o=r;return t.forEach(e,function(e){if(o&&e>=0&&e<o.children.length)if(n){var t=o.children.slice();t.sort(function(e,t){var n=e.itemIndex,r=t.itemIndex;return n>r?1:r>n?-1:0}),o=t[e]}else o=o.children[e];else o=null}),o}return r},vi:function(){var e=this,t=e.getParentGroup();t=t?t.rootNode_:e.table_.rootNode_;for(var n=0,r=e.path,o=0,i=r.length;i>o;){if(t.collapsed)return;for(var a=r[o],u=0;a>u;++u)n+=t.children[u].getNodeCount(!0,!1);++o,i>o&&(t=t.children[a],++n)}return n},mapToViewRow:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],r=this;if(t)return isNaN(Number(e))||0>e||r.getNodeCount(n,!0)<e?null:e;if(isNaN(Number(e))||0>e||r.getNodeCount(n,!0)<e)return null;var o=0,i=r.children;if(n){if(0===e)return 0}else++e,--o;for(;r.children.length>0&&!(0>=e);){++o,--e;for(var a=0,u=!1,c=0,l=i.length;l>c;++c){var s=i[c];if(a=s.getNodeCount(!0,!0),a>e){if(e>0&&s.collapsed)return null;u=!0,r=s,i=r.children;break}o+=s.getNodeCount(!0,!1),e-=a}if(!u)return null}return o},getSourceIndex:function(){var e=this,t=e.table_.indexMappings_;return t?t[e.itemIndex]:e.itemIndex},sort:function(){var e=this.table_;d.sortNode_.call(e,this,e.sortInfos_)},getParentGroup:function(){var e=this;if(e.parentGroup)return e.parentGroup;for(;e.parent;)e=e.parent;return e.parentGroup},getIndexMappingIndexes_:function(e,t){return this.getItemsIndexes_(e,t)},getItemsIndexes_:function(){var e=arguments.length<=0||void 0===arguments[0]?!0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],o=this;if(e){var i=r(o,{collapsed:!0,start:n||-1===o.level?0:1,end:Number.MAX_VALUE});return t.map(i,function(e){return e.itemIndex})}var a=t.map(o.children,function(e){return e.itemIndex});return n&&a.unshift(o.itemIndex),a},getItemCount:function(e){var n=this;if(e){var r=n.children,o=1;t.forEach(r,function(t){o+=t.getItemCount(e)}),n.itemCount_=o}return n.itemCount_},getNodeCount:function(e,n){var r=this,o=e?1:0;return!n&&r.collapsed||t.each(r.children,function(e){o+=e.getNodeCount(!0,n)}),o},appendChild:function(e){var t=this;t.children.push(e),t.children.sort(function(e,t){var n=e.itemIndex,r=t.itemIndex;return n>r?1:r>n?-1:0}),e.parent=t,t.readjustChildren()},removeChild:function(e){var n=this;if(!t.isNumber(e)){if(e.parent!==n)return!1;e=e.path[e.path.length-1]}return 0>e||e>n.children.length-1?!1:(n.children.splice(e,1),void n.readjustChildren())},readjustChildren:function(){var e=this,t=new Map;r(e,{collapsed:!0,start:0,end:Number.MAX_VALUE},function(n){if(n!==e){var r=n.parent;if(r){n.level=r.level+1;var o=t.has(r)?t.get(r):0;r.path?(n.path=r.path.slice(),n.path.push(o)):n.path=[o],t.set(r,o+1)}else n.level=-1,n.path=null}}),t.clear()}},e.findNode_=n,e.operateNodes_=o,e}();c.CalcNode_=f;var d=function(){function e(e,n,r){var o=this;n&&(o.calcSource_=e,o.dataColumns_=n,o.calcColumns_=r,o.columns_=t.map(n.columns,function(e){return{name:e.name,field:e.field,type:a.DATA_COLUMN,dataType:e.dataType}}),T.call(o),o.indexMappings_=null,o.sortSensitive_=!1,o.groupSensitive_=!1,o.getRowCount(!0))}function n(e){var t=e.field,n=e.operator,r=e.value,o=this.calcSource_.findColumn(t);if(!o||!n)return null;var i=o.name,a=o.dataType,l="date"===a?"datevalue(["+i+"])":"["+i+"]",s=null;switch(n){case"":case"memberOf":return u(l,o,r);case"":case"notMemberOf":return u(l,o,r,!0);case"=":case"equal":s="=";break;case"!=":case"":case"<>":case"notEqual":s="<>";break;case">":case"greaterThan":s=">";break;case">=":case"greaterThanAndEqual":s=">=";break;case"<":case"lessThan":s="<";break;case"<=":case"lessThanAndEqual":s="<=";break;default:s=n}return"("+l+s+c(a,r)+")"}function u(e,n,r,o){var i=null,a=n.dataType;if(t.isString(r)){var u=o?k:B,l=u[r[0]],s=u[t.last(r)];if(!l||!s)return null;var f=r.length,d=t.map(r.slice(1,f-1).split(","),function(e){if("number"===a){var n=parseFloat(e);return t.isNumber(n)&&!isNaN(n)?n:null}return"date"===a?'datevalue("'+e+'")':e}),p=null==d[0],h=null==d[1];i=p&&h?null:(p?"":e+l+d[0])+(p||h?"":o?"||":"&&")+(h?"":e+s+d[1])}return t.isArray(r)&&(i=t.map(r,function(t){return e+"="+c(a,t)}).join("||")),i?"("+i+")":null}function c(e,t){switch(e){case"date":return t?'datevalue("'+t+'")':"";case"number":return i.isNumber(t)?t:parseFloat(t);default:return'"'+t+'"'}}function d(e,n){var r=[];return t.each(e,function(e,t){n&&e===n[t]||r.push(t)}),r}function p(e,t,n,r){for(var o=this,i=o.indexMappings_,a=[],u=0,c=t.length;c>u;u++){var l=t[u];if(!i||l>=0&&l<i.length){var s=i?i[l]:l;if(o.rowStates_[s]!==!1){var f=x.call(o,e,s,n,r);a.push(f)}}}return a}function h(e){var n=this,r={},o=n.calcColumns_.getColumns();return 0===o.length?null:(t.forEach(o,function(t){r[t.name]=n.calcColumns_.getValue(t,e)}),r)}function g(e,n,r){var o=this;if(!t.isArray(e))return null;var i,a,u,c,l,f,d,p=e.length,h={};for(u=0;p>u;++u)c=e[u],h[c.field]=o.findColumn(c.field);var g=0;if(r)for(;e[g]&&r[g]&&e[g].field===r[g].field;)++g;var v=n||new s(o,null,-1,!1);v.clearContent(g-1);var C=o.indexMappings_?o.indexMappings_.length:o.dataColumns_.getDimension();v.path=[];var b=[v],S=[];for(u=0;p>u&&(c=e[u],c.preDefinedGroups);++u){for(a=0;a<b.length;++a)i=b[a],i.adoptChildGroups(),m.call(o,c,i),i.groups&&(S=S.concat(i.groups));b=S}for(S.length=0,a=0;C>a;++a){for(i=v,u=0;p>u;++u)c=e[u],l=_.call(o,h[c.field],c,a),f=u===p-1,i.isBottomLevel&&(i.adoptChildGroups(),c.preDefinedGroups&&m.call(o,c,i)),d=y.call(o,i,l,u,c.collapsed,f&&g>u),i=d;d.items.push(a)}return v.getItemCount(!0),v}function v(e,n,r){for(var o=this,i=e,a=o.cachedGroupInfo_,u=0,c=a.length;c>u;++u){var l=a[u],s=l.field,f=o.findColumn(s),d=t.isFunction(l.converter)?l.converter(n[f.field]):n[f.field];i.isBottomLevel&&(i.adoptChildGroups(),l.preDefinedGroups&&m.call(o,l,i)),i=y.call(o,i,d,u,l.collapsed,!1)}return-1===i.items.indexOf(r)&&i.items.push(r),i}function m(e,n){var r=this,o=void 0,i=n.level+1,a=e.preDefinedGroups;return o=t.isFunction(a)?a(n.name,i):a,t.each(t.isArray(o)?o:o?[o]:[],function(t){y.call(r,n,t,i,e.collapsed)})}function _(e,n,r){var o=this;if(e){var i=o.getValue(e,r,!1,!1);if(t.isFunction(n.converter))return n.converter(i);if(null===i||void 0===i||""===i)return;return i}return null}function y(e,t,n,r,o){var i=e.groups,a=t;""!==a&&null!==a&&void 0!==a||(a=void 0);var u=e.groupHashMapping&&e.groupHashMapping[a];return u?(o&&!u.isBottomLevel&&u.pruneChildGroups(),u):(u=new s(this,a,n,!0,r),u.path=e.path.concat(i.length),u.parent=e,i.push(u),e.groupHashMapping[a]=u,u)}function C(e,n,r,o){var a=this;if(a.dataItem=e,a.calcItem=n,a.sourceIndex=r,e&&o){var u=t.map(o,function(e){return{name:e.name,field:e.field,isMultiCol:e.isMultiCol,isDeepProp:e.isDeepProp}});t.each(u,function(e){var n=e.isDeepProp;e.isMultiCol?l(a,e.name,{get:function(){return t.map(e.field.split(","),function(e){return n?i.sOP(a.dataItem,e.trim()):a.dataItem[e.trim()]})},set:function(n){t.isArray(n)||(n=[n]);for(var r=t.map(e.field.split(","),function(e){return e.trim()}),o=0,u=Math.min(r.length,n.length);u>o;++o)i.gOP(a.dataItem,r[o],n[o])},enumerable:!0,configurable:!0}):l(a,e.name,{get:function(){return n?i.sOP(a.dataItem,e.field):a.dataItem[e.field]},set:function(t){i.gOP(a.dataItem,e.field,t)},enumerable:!0,configurable:!0})})}if(n){var c=t.keys(n);t.forEach(c,function(e){l(a,e,{get:function(){return a.calcItem[e]},enumerable:!0,configurable:!0})})}}function b(e,n){var r=this,o=r.indexMappings_;if(e.isBottomLevel){var a=t.map(e.items,function(e){return o&&!i.isNil(o[e])?o[e]:e});return-1!==a.indexOf(n)?e:!1}if(e.groups)for(var u=0,c=e.groups.length;c>u;u++){var l=b.call(r,e.groups[u],n);if(l)return l}}function S(e,t){var n=this,r=n.indexMappings_,o=e.itemIndex,i=!1;if(r){if(-1>o||o>=r.length)return-1;i=r[e.itemIndex]===t?e:!1}else i=o===t?e:!1;if(i)return i;for(var a=0,u=e.children.length;u>a;a++)if(i=S.call(n,e.children[a],t))return i}function w(){var e=this,t=e.getDimension();e.indexMappings_=[];for(var n=0;t>n;n++)I.call(e,n),e.rowStates_[n]&&e.indexMappings_.push(n)}function I(e){var t=this;t.rowStates_[e]=null===t.filterStates_||t.filterStates_[e]!==!1}function x(e,t,n,r){var o,i=this;return o=e.type===a.DATA_COLUMN?i.dataColumns_.getValue(t,e,r):n?e.values[t]:i.calcColumns_.getValue(e,t,r)}function A(e,t){var n=e;if(t&&t.length)for(var r=0,o=t.length;o>r;r++){var i=t[r],a=n.groups;if(!(a&&i<a.length))return null;n=a[i]}return n}function E(){var e=this,n=e.calcColumns_.getColumns();t.forEach(n,function(t){e.calcColumns_.dirty(t,-1)})}function R(e,t,n){var r,o=this,i=e;if(o.rootGroup_){var a=o.rootGroup_.searchChildGroup(e,t,n);if(a){var u=a.group,c=a.relativeIndex;u.rootNode_?(r=u.rootNode_.findNode(c,n),i=r?r.itemIndex:-1):i=u.items[c]}else i=-1}else o.rootNode_&&(r=o.rootNode_.findNode(e,n),i=r?r.itemIndex:-1);return o.indexMappings_&&i>=0&&i<o.indexMappings_.length?o.indexMappings_[i]:i}function N(e,t,n){var r=this;return e=D.call(r,e),r.rootGroup_?r.rootGroup_.mapToViewRow(e,t,n):r.rootNode_?r.rootNode_.mapToViewRow(e,n):e}function D(e){var t=this,n=e;if(t.indexMappings_&&(n=t.indexMappings_.indexOf(e)),-1!==n){var r;if(t.rootGroup_)return r=t.rootGroup_.getIndexMappingIndexes_(),r.indexOf(n);if(t.rootNode_)return r=t.rootNode_.getIndexMappingIndexes_(),r.indexOf(n)}return n}function F(){var e=this;T.call(e),O.call(e),M.call(e),L.call(e)}function T(){var e=this,t=e.dataColumns_.getDimension();e.filterObj_=null,e.rowStates_=[],e.rowStates_.length=t,e.filterStates_=null,e.indexMappings_=null}function M(){var e=this;e.rootGroup_=null,e.gI_=null}function O(){var e=this;e.sortInfos_=null}function L(){var e=this;e.rootNode_=null,e.hierachyInfo_=null}function P(e,n,r,o){for(var a=this,u=0;u<e.itemCount;u++)new f(a,e.items[u],n,u,a.hierarchyInfo_.collapsed);var c=n.children;if(c.length>0)for(var l=0;l<c.length;l++){var s=c[l],d=s.itemIndex,p=d,h=a.indexMappings_;h&&d>=0&&d<h.length&&(p=h[d]);var g=x.call(a,o,p);s.value=g;var v=t.find(r,i.mP("name",g))||t.find(r,i.mP("caption",g));v&&P.call(a,v,s,r,o)}}function G(e,n,r,o,i){var a=this;r||(r={},t.forEach(n,function(e){e.hasOwnProperty("ascending")?e.ascending=!!e.ascending:e.ascending=!0,r[e.field]=a.dataColumns_.findColumn(e.field)||a.calcColumns_.findColumn(e.field)}));var u=t.isFunction(o),c=function(e,t){for(var c=0,l=n.length;l>c;c++){var s,f,d,p=n[c],h=r[p.field],g=a.indexMappings_?a.indexMappings_[e.itemIndex]:e.itemIndex,v=a.indexMappings_?a.indexMappings_[t.itemIndex]:t.itemIndex;if(u){if(d=o(new U(a,g),new U(a,v),p.ascending,h.field),0!==d)return p.ascending?+d:-d}else{if(s=x.call(a,h,g),f=x.call(a,h,v),p.converter&&(s=p.converter(s),f=p.converter(f)),d=f>s?-1:s>f?1:0,0!==d)return p.ascending?+d:-d;if(i)return e.itemIndex-t.itemIndex}}return 0};e.children.sort(c),e.children.length>0&&t.forEach(e.children,function(e){G.call(a,e,n,r)})}e.prototype={getRowCount:function(e){var t=this;if(e){var n=0;if(t.rootGroup_)n=t.rootGroup_.getItemCount(e);else if(t.rootNode_)n=t.rootNode_.getItemCount(e);else{var r=t.getIndexMappingIndexes_();if(r)for(var o=0,i=r.length;i>o;++o)rowStates[r[o]]!==!1&&++n;else for(var a=t.rowStates_,u=0,c=a.length;c>u;++u)a[u]!==!1&&++n}t.rowCount_=n}return t.rowCount_},getRowCountInternal:function(e,n){var r=this,o=r.rowStates_,i=0,a=e||r.boundGroup_,u=n||r.boundHierarchy_,c=t.isUndefined(r.recursive_)?!0:r.recursive_,l=t.isUndefined(r.includeSelf_)?!1:r.includeSelf_,s=r.getIndexMappingIndexes_(a,u,c,l);if(s)for(var f=0,d=s.length;d>f;++f)o[s[f]]!==!1&&++i;else for(var p=0,h=o.length;h>p;++p)o[p]!==!1&&++i;return i},filter:function(e){var r=this;t.isArray(e)&&(e=e.length>0?"="+t.map(e,n.bind(r)).join("&&"):null),r.filterObj_=e;var o=r.gI_,i=r.sortInfos_,a=r.hierarchyInfo_;if(F.call(r),e){var u=r.calcSource_;if(t.isFunction(e)){var c=r.getDimension();r.filterStates_=[],r.filterStates_.length=c;for(var l=0;c>l;l++)r.filterStates_[l]=e(new U(r,l))}else{var s=u.getParser(),f=u.getParserContext(),d=u.getEvaluator(),p=u.getEvaluatorContext(),h=s.parse(e,f);r.filterStates_=d.evaluateExpression(h,p)}}w.call(this),a?o?(r.hierarchyInfo_=a,r.group(o)):r.hierarchy(a):(i&&r.sort(i),o&&r.group(o)),r.getRowCount(!0)},sort:function(e,n,r){var o=this;o.sortInfos_=e;var i;if(e&&0!==e.length)if(o.hierarchyInfo_)o.rootGroup_?o.rootGroup_.sortTree():G.call(o,o.rootNode_,e);else{i=o.gI_,M.call(o);var a=[],u=0,c=0;if(o.indexMappings_)if(a.length=c=o.indexMappings_.length,r)for(u=0;c>u;u++)a[u]={index:u,srcIndex:o.indexMappings_[u]};else for(u=0;c>u;u++)a[u]=o.indexMappings_[u];else if(a.length=c=o.getDimension(),r)for(u=0;c>u;u++)a[u]={index:u,srcIndex:u};else for(u=0;c>u;u++)a[u]=u;var l={};t.forEach(e,function(e){e.hasOwnProperty("ascending")?e.ascending=!!e.ascending:e.ascending=!0,l[e.field]=o.dataColumns_.findColumn(e.field)||o.calcColumns_.findColumn(e.field)});var s=t.isFunction(n),d=function(t,i){var a,u;r?(a=t.srcIndex,u=i.srcIndex):(a=t,u=i);for(var c=0,f=e.length;f>c;c++){var d=e[c],p=l[d.field],h=0;if(s){if(h=n(new U(o,a),new U(o,u),d.ascending,p.field),0!==h)return d.ascending?+h:-h}else{var g,v;if(p&&(g=x.call(o,p,a),v=x.call(o,p,u),d.converter&&(g=d.converter(g),v=d.converter(v))),h=v>g?-1:g>v?1:0,0!==h)return d.ascending?+h:-h;if(r)return t.index-i.index}}return 0};if(a.sort(d),r){c=a.length,o.indexMappings_=[],o.indexMappings_.length=c;for(var p=0;c>p;p++)o.indexMappings_[p]=a[p].srcIndex}else o.indexMappings_=a;i&&o.group(i)}else if(o.sortInfos_=null,w.call(this),o.hierarchyInfo_){var h={};if(o.rootGroup_){var g=o.rootGroup_.getBottomGroups();g&&t.forEach(g,function(e){e.rootNode&&f.operateNodes_(e.rootNode,function(e){h[e.value]=e.collapsed}),f.operateNodes_(e.rootNode,function(e){h.hasOwnProperty(e.value)&&(e.collapsed=h[e.value])})}),i=o.gI_,M.call(o),o.group(i),g=o.rootGroup_.getBottomGroups(),g&&t.forEach(g,function(e){e.rootNode&&f.operateNodes_(e.rootNode,function(e){h.hasOwnProperty(e.value)&&(e.collapsed=h[e.value])})})}else o.rootNode_&&f.operateNodes_(o.rootNode_,function(e){h[e.value]=e.collapsed}),o.hierarchy(o.hierarchyInfo_),f.operateNodes_(o.rootNode_,function(e){h.hasOwnProperty(e.value)&&(e.collapsed=h[e.value])})}else i=o.gI_,M.call(o),i&&o.group(i)},group:function(e){var n=this;n.gI_=e,n.rootGroup_=null;var r=n.hierarchyInfo_;if(L.call(n),!e||0===e.length)return n.rootGroup_=null,n.clearGroupCache_(),r&&n.hierarchy(r),null;if(n.rootGroup_=g.call(n,e,n.cachedRootGroup_,n.cachedGroupInfo_),n.cachedGroupInfo_=e,n.cachedRootGroup_=n.rootGroup_,r){var o=n.rootGroup_.getBottomGroups();o&&o.length>0&&t.forEach(o,function(e){e.hierarchy(r)})}return E.call(n),n.rootGroup_},hierarchy:function(e,n){var r=this,o=r.hierarchyInfo_;if(r.hierarchyInfo_=e,r.rootNode_=null,!e||!e.hasOwnProperty("parentField")||!e.hasOwnProperty("keyField"))return r.rootNode_=null,null;if(r.rootGroup_){var a=r.rootGroup_.getBottomGroups();a&&a.length>0&&t.forEach(a,function(e){e.hierarchy(r.hierarchyInfo_)})}else{var u={};n&&o&&o.keyField===e.keyField&&f.operateNodes_(n,function(e){u[e.value]=e.collapsed});var c=g.call(r,[{field:e.parentField}]);if(c&&c.groups&&c.groups.length>0){var l=c.groups,s=r.findColumn(e.keyField),d=t.find(l,i.mP("name",void 0));if(!d)return r.rootNode_=null,null;var p=new f(r,-1,null,-1,!1);return P.call(r,d,p,l,s),p.getItemCount(!0),r.rootNode_=p,r.sortInfos_&&G.call(r,r.rootNode_,r.sortInfos_),n&&r.rootNode_&&f.operateNodes_(r.rootNode_,function(e){u.hasOwnProperty(e.value)&&(e.collapsed=u[e.value])}),r.rootNode_}}return null},overlapFilterStates:function(e,n,r){var o=this;if(t.isArray(e)){var i,a=o.getDimension(),u=0,c=e.length;i=o.getIndexMappingIndexes_(n,r,o.recursive_,o.includeSelf_);for(var l=0;a>l;l++){var s=i?i[l]:l,f=o.indexMappings_?o.indexMappings_[s]:s;if(o.rowStates_[f]!==!1){if(u>=c)break;o.rowStates_[f]=e[u],u++}}}},overlapFilterSingleState:function(e,n){var r=this;if(!t.isArray(e)&&n>-1){var o=r.indexMappings_?r.indexMappings_[n]:n;r.rowStates_[o]!==!1&&(r.rowStates_[o]=e)}},setItemInternal:function(n,r,o,a){var u=this,c=u.dataColumns_.getDimension();if(t.isNil(o)||0>o||o>c-1)return!1;var l=d(u.dataColumns_.getRowItem(o),a),s=t.intersection(l,t.map(u.filterObj_,function(e){return e.field})).length>0,p=t.intersection(l,t.map(u.sortInfos_,function(e){return e.field})).length>0,g=!1,m=!1,_=u.hierarchyInfo_,y=n,b=void 0,S=!1;if(n){if(y=v.call(u,u.rootGroup_,a,o),n.name!==y.name&&(g=!0,n.items=n.items.filter(function(e){return e!==o}),r)){for(var w=r.parent;w.parent;)w=w.parent;if(w){w.noRootNode_=w.noRootNode_||[];for(var I=0,x=r.children.length;x>I;I++)w.noRootNode_.push(r.children[I]),r.children[I].parent=null}if(r.children.length=0,r&&!y.rootNode_){var A=y.createGroupsForTree_({field:_.parentField}),E=t.find(A.groups,i.mP("name",void 0)),R=void 0;if(E){var R=new f(u,-1,null,-1,!1);e.createTree_.call(u,E,R,A.groups,u.findColumn(_.keyField))}else R=new f(u,-1,null,-1,!1);y.rootNode_=R,y.rootNode_.parentGroup=y,S=!0}}b=y.rootNode_}r&&!function(){var e=!1,t=r.getItem(),n=_.keyField,o=_.parentField;if(!g&&t[o]===a[o]&&i.isNilOrWhiteSpace(t[o])&&i.isNilOrWhiteSpace(a[o])||(e=!0,r.parent&&(r.parent.removeChild(r),r.parent=null)),e&&!S){b||(b=u.rootNode_),f.operateNodes_(b,function(e){var t=e.getItem();t[n]&&a[o]===t[n]&&(m=!0,e.appendChild(r))}),!m&&i.isNilOrWhiteSpace(a[o])&&b.appendChild(r);var c=b.noRootNode_;if(g&&c){for(var l=[],s=0,d=c.length;d>s;s++){var p=c[s],h=p.getItem();h[o]===t[n]&&(r.appendChild(p),l.push(s))}for(var v=l.length-1;v>=0;v--)c.splice(l[v],1)}}}();var N=h.call(u,o),D=u.dataColumns_.setRowItem(o,a);t.each(u.calcColumns_.columns_,function(e){u.dataColumns_.dirty(e,o)}),u.calcSource_.dirtyFields();var F=h.call(u,o);return D.oldItem=new C(D.oldItem,N,o,u.dataColumns_.columns),D.newItem=new C(D.newItem,F,o,u.dataColumns_.columns),D.oldItem.node=r,D.newItem.node=r,t.assign(D,{filterChanged:s,sortChanged:p,groupChanged:g,nodeChanged:m})},setRowItem:function(e,t){var n=this,r=n.mapToViewRow(e,!0,!0);return n.rootGroup_?n.rootGroup_.setItem(r,t,!0,!0):n.rootNode_?n.rootNode_.setItem(r,t,!0):n.setItemInternal(null,null,e,t)},setRowItems:function(e,n){var r=this,o=[],i=void 0,a=void 0,u=void 0,c=r.dataColumns_;return t.each(e,function(e,l){i=h.call(r,e),u=c.setRowItem(e,n[l]),t.each(r.calcColumns_.columns_,function(t){r.dataColumns_.dirty(t,e)}),a=h.call(r,e),u.oldItem=new C(u.oldItem,i,e,c.columns),u.newItem=new C(u.newItem,a,e,c.columns),o.push(u)}),o},getRowItem:function(e,t,n){var r=this;return r.rootGroup_?r.rootGroup_.getItem(e,t,n):r.rootNode_?r.rootNode_.getItem(e,n):r.getRowItemByViewIndex_(e)},getDataRowItem:function(e){
var t=this,n=R.call(t,e);return t.dataColumns_.getRowItem(n)},getCalcRowItem:function(e){var t=this,n=R.call(t,e);return h.call(t,n)},getValues:function(e,n,r,o,i,a){var u,c,l,s,f=this,d=e,h=[],g=t.isUndefined(f.boundGroup_)?n:f.boundGroup_,v=t.isUndefined(f.boundHierarchy_)?r:f.boundHierarchy_,m=t.isUndefined(f.recursive_)?o:f.recursive_,_=t.isUndefined(f.includeSelf_)?i:f.includeSelf_,y=f.indexMappings_;if(f.rootGroup_)s=f.getIndexMappingIndexes_(g,v,m,_),h=p.call(f,d,s,void 0,a);else if(f.rootNode_){if(f.rootNode_){var C=f.rootNode_.findNodeByPath(v,!0);C&&(s=C.getItemsIndexes_(m,_),h=p.call(f,d,s,void 0,a))}}else if(y)for(var b=0,S=y.length;S>b;b++){var w=y[b];f.rowStates_[w]!==!1&&(c=x.call(this,d,w,!1,a),h.push(c))}else for(u=0,l=f.getDimension();l>u;u++)f.rowStates_[u]!==!1&&(c=x.call(this,d,u,!1,a),h.push(c));return h},getValue:function(e,t,n){var r=arguments.length<=3||void 0===arguments[3]?!0:arguments[3],o=this,i=e,a=R.call(o,t);return x.call(this,i,a,n,r)},getDimension:function(){return this.dataColumns_.getDimension()},bindGroup:function(e){this.boundGroup_=e},bindHierarchy:function(e,t,n){this.boundHierarchy_=e,this.recursive_=t,this.includeSelf_=n},clone:function(){var n=this,r=new e(null);return r.dataColumns_=n.dataColumns_,r.calcColumns_=n.calcColumns_,r.columns_=t.cloneDeep(n.columns_),r.rowStates_=t.clone(n.rowStates_),r.filterStates_=t.clone(n.filterStates_),r.rootGroup_=n.rootGroup_,r.indexMappings_=t.cloneDeep(n.indexMappings_),r.rootNode_=n.rootNode_,r},reproduce_:function(n){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=this,i=new e(null);if(i.dataColumns_=o.dataColumns_,i.calcColumns_=o.calcColumns_,n){var a,u=o.columns_,c=[];u=t.map(u,function(e){return e.name}),t.forEach(n,function(e){(a=t.indexOf(u,e))>-1&&c.push(o.columns_[a])}),i.columns_=c}return r.keepFilter||(i.rowStates_=[],i.rowStates_.length=o.getDimension(),i.filter=null,i.filterStates_=null),r.keepGroup&&(i.rootGroup_=o.rootGroup_,i.rootNode_=o.rootNode_),i.indexMappings_=t.cloneDeep(o.indexMappings_),i},beginUseGroup:function(){var e=this,t={groups:e.rootGroup_,groupInfos:e.gI_};e.backupGroups_?e.backupGroups_.push(t):e.backupGroups_=[t]},endUseGroup:function(){var e=this;if(e.backupGroups_&&e.backupGroups_.length>0){var t=e.backupGroups_.pop();e.rootGroup_=t.groups,e.gI_=t.groupInfos}},getRootGroup:function(){return this.rootGroup_},getRootNode:function(){return this.rootNode_},updateGroups:function(){var e=this;e.group(e.gI_),E.call(e)},findColumn:function(e){var t=this;return t.dataColumns_.findColumn(e)||t.calcColumns_.findColumn(e)},toArray:function(e,t){var n=this;n.boundGroup_&&(e=n.boundGroup_),n.boundHierarchy_&&(t=n.boundHierarchy_);var r,o,i,a,u,c=[],l=n.indexMappings_;if(n.rootGroup_)for(i=n.getIndexMappingIndexes_(e,t,!0,!0),a=0,u=i.length;u>a;a++)r=i[a],o=l?l[r]:r,c.push(n.getRowItemBySrcIndex_(o));else if(n.rootNode_){var s=n.rootNode_.findNodeByPath(t);for(s&&(i=s.getItemsIndexes_(!0,!0)),a=0,u=i.length;u>a;a++)r=i[a],o=l?l[r]:r,c.push(n.getRowItemByViewIndex_(o))}else if(l)for(var f=0,d=l.length;d>f;f++)o=l[f],n.rowStates_[o]!==!1&&c.push(n.getRowItemBySrcIndex_(o));else for(var p=0,h=n.getDimension();h>p;p++)n.rowStates_[p]!==!1&&c.push(n.getRowItemBySrcIndex_(p));return c},mapToSourceRow:function(e,t,n){return R.call(this,e,t,n)},mapToViewRow:function(e,t,n){return N.call(this,e,t,n)},mapToGlobalRow:function(e){return D.call(this,e)},isFilterOut:function(e){return this.rowStates_[e]===!1},gBSI_:function(e){var n=this,r=n.rootGroup_,o=n.rootNode_,i=-1,a=n.indexMappings_;if(r){r=b.call(n,r,e),r.rootNode&&(o=r.rootNode);var u=t.map(r.items,function(e){return a?a[e]:e});i=t.indexOf(u,e)}o&&(o=S.call(n,o,e)),r||o||(i=a?t.indexOf(a,e):e);var c={item:n.getRowItemBySrcIndex_(e),row:i};return r&&(c.groupInfo=r),o&&(c.nodeInfo=o),c},getGroupBySourceRow:function(e){var t=this;if(t.rootGroup_){var n=b.call(t,t.rootGroup_,e);return n?n:void 0}},getNodeBySourceRow:function(e){var t=this,n=t.rootNode_;if(!n){var r=t.getGroupBySourceRow(e);r&&(n=r.rootNode)}return n?S.call(t,n,e):null},getRowItemByViewIndex_:function(e){var t=this,n=e;return t.indexMappings_&&e>=0&&e<t.indexMappings_.length&&(n=t.indexMappings_[e]),t.getRowItemBySrcIndex_(n)},getRowItemBySrcIndex_:function(e){if(t.isNil(e))return null;var n=this,r=n.dataColumns_.getRowItem(e),o=h.call(n,e);return r||o?new C(r,o,e,n.dataColumns_.columns):null},getIndexMappingIndexes_:function(e,t,n,r){var o=this,i=A(o.rootGroup_,e),a=o.rootNode_&&o.rootNode_.findNodeByPath(t);if(i){var u;try{return u=i.getIndexMappingIndexes_(t,n,r)}catch(c){console.log(c)}return u}return a?a.getIndexMappingIndexes_(n,r):null},clearGroupCache_:function(){this.cachedRootGroup_=null,this.cachedGroupInfo_=null},clearAllStates_:function(){F.call(this)}};var B={"[":">=","(":">","]":"<=",")":"<"},k={"[":"<","(":"<=","]":">",")":">="};e.createTree_=P,e.sortNode_=G;var U=function(){function e(t,n){r(this,e),this.table_=t,this.srcRow_=n}return o(e,[{key:"dataItem",get:function(){return this.table_.dataColumns_.getRowItem(this.srcRow_)}},{key:"calculatedItem",get:function(){return h.call(this.table_,this.srcRow_)}}]),e}();return e}();c.CalcTableModel=d;var p=function(){function e(e,n){var o=this;o.dataSource=e;var u,c;t.isArray(e)?u=e:t.isFunction(e.getSourceArray)&&(u=e.getSourceArray()),u?(o.sourceCollection=u,c=u.length):e.getDimension&&(c=e.getDimension());var l=r.call(o);if(e.getColumns||n&&n.length){var s=e.getColumns&&e.getColumns()||n;o.columns=t.map(s,function(e){var n=[];return n.length=c,e.name&&e.field?{name:e.name,field:e.field,caption:e.caption,type:a.DATA_COLUMN,dirtyStates:n,dirty:!1,dataType:e.dataType,isMultiCol:t.indexOf(e.field,",")>-1,isDeepProp:t.indexOf(e.field,".")>-1}:void 0}),l&&t.forEach(l,function(e){t.find(o.columns,i.mP("field",e.field,!0))||t.find(o.columns,i.mP("name",e.field,!0))||o.columns.push(e)})}o.columns&&0!==o.columns.length||(o.columns=l)}function n(e,n,r){var o=this,i=e;if(t.isString(e)&&(i=o.findColumn(e)),i)if(n>=0&&n<o.getDimension())i.exprInfo&&i.exprInfo.hasAggFn?(t.fill(i.dirtyStates,r),i.caches=null):i.dirtyStates[n]=r;else if(-1===n){if(r)t.fill(i.dirtyStates,!0);else{var a=[];a.length=o.getDimension(),i.dirtyStates=a}i.exprInfo&&i.exprInfo.hasAggFn&&(i.caches=null)}}function r(){var e,n=this,r=n.sourceCollection;if(r&&r.length>0?e=r[0]:r&&r.getDataItem&&(e=r.getDataItem(0)),e){var o=n.getDimension();return t.map(t.keys(e),function(e){var t=[];return t.length=o,{name:e,field:e,caption:e,type:a.DATA_COLUMN,dirtyStates:t,dirty:!1,dataType:void 0}})}return null}return e.prototype={addColumn:function(e,t,n){var r=this,o=[];o.length=r.getDimension(),e&&t&&this.columns.push({name:e,caption:n,field:t,type:a.DATA_COLUMN,dirtyStates:o,dirty:!1,dataType:void 0})},setRowItem:function(e,t){var n,r=this;return r.sourceCollection?(n=r.sourceCollection[e],r.sourceCollection[e]=t):r.setDataItem&&(n=r.getDataItem(e),r.setDataItem(e,t)),{oldItem:n,newItem:t,sourceIndex:e}},getRowItem:function(e){var t=this;return t.sourceCollection?t.sourceCollection[e]:t.getDataItem?t.getDataItem(e):void 0},getDimension:function(){var e=this;return e.sourceCollection?e.sourceCollection.length:e.dataSource.getDimension?e.dataSource.getDimension():0},getValue:function(e,n){var r,o=arguments.length<=2||void 0===arguments[2]?!0:arguments[2],a=this,u=n,c=u.field;if(a.sourceCollection?r=a.sourceCollection[e]:a.dataSource.getDataItem&&(r=a.dataSource.getDataItem(e)),r){var l;if(l=t.isFunction(c)?c(r,u.name):u.isMultiCol?t.map(c.split(","),function(e){return u.isDeepProp?i.sOP(r,e.trim()):r[e.trim()]}):u.isDeepProp?i.sOP(r,c):r[c],o||!o&&!t.isNil(l)&&""!==l)switch(n.dataType){case"number":l=o?+l:t.isString(l)&&isNaN(+l)?l:t.isBoolean(l)?l:+l;break;case"date":l=i.toDate(l)}var s=u.converter;return s&&t.isFunction(s)?s(l):l}},findColumn:function(e){return t.find(this.columns,i.mP("name",e,!0))||t.find(this.columns,i.mP("caption",e,!0))},hasDirty:function(e){var t=this,n=t.findColumn(e);if(!n)return!1;for(var r=n.dirtyStates,o=0,i=r.length;i>o;o++)if(r[o]===!0)return!0;return!1},dirty:function(e,t){n.call(this,e,t,!0)},unDirty:function(e,t){n.call(this,e,t,!1)}},e}();c.DataColumnsModel=p;var h=function(){function e(e){var t=this;t.calcSource_=e,t.name=e.name,t.columns_=[],t.parser_=e.getParser(),t.evaluator_=e.getEvaluator()}function n(e,t,n){var r=this,o=r.calcSource_,i=r.calcSource_.getDimension(),c=[],s=[];c.length=i,s.length=i;var f=new u.ParserContext(o),d=r.parser_.parse(t,f);if(!d)return null;var p=a.resolveDepends(d,o),h=l(d),g={name:e,caption:n,type:a.CALC_COLUMN,formula:t,expression:d,values:c,dirtyStates:s,depends:p,exprInfo:h,isCalculating:!1,dirty:!1};return r.columns_.push(g),g}function r(e,t,n){var r=this,i=e;e=i.name;var u,c,l,s,f=!1,d=r.calcSource_.getModel_(a.CALC_FIELD),p=r.calcSource_.getModel_(a.DATA_COLUMN);i.isCalculating=!0;try{var h=[];for(h.push({type:a.CALC_COLUMN,table:r.name,column:e});0!==h.length;){var g=h[h.length-1],v=a.getCalcObj(g,r.calcSource_);if(null!==v){var m=!1;if(s=v.depends,s&&s.length)for(c=0,l=s.length;l>c;c++){var _=a.getCalcObj(s[c],r.calcSource_);if(_){var y=s[c].aggContext?-1:t;f=!1,-1===y?(_.type===a.CALC_FIELD&&_.dirty||_.type===a.DATA_COLUMN&&p.hasDirty(_)||_.type===a.CALC_COLUMN&&r.hasDirty(_))&&(f=!0):_.type===a.DATA_COLUMN?(u=_.dirtyStates,u[y]===!0&&(f=!0)):_.type===a.CALC_COLUMN?(u=_.dirtyStates,u[y]!==!1&&(f=!0)):_.type===a.CALC_FIELD&&_.dirty!==!1&&(f=!0)}f&&(h.push(s[c]),m=!0)}m||(g.type===a.CALC_COLUMN?(o.call(this,v,g.aggContext?-1:t,n),h.pop()):g.type===a.CALC_FIELD&&d?(d.calculateField(v.name),h.pop()):g.type===a.DATA_COLUMN&&(p.unDirty(v.name,t),h.pop()))}else h.pop()}}catch(C){C&&(console.log("calculate exception thrown!"),console.log(C.message),console.log(C.stack))}finally{i.isCalculating=!1}}function o(e,t,n){var r=this;if(-1===t)if(e.dirty)s.call(this,e);else for(var o=r.calcSource_.getDimension(),i=0;o>i;i++)(n||e.dirtyStates[i]!==!1)&&c.call(r,e,i);else(n||e.dirtyStates[t]!==!1)&&c.call(r,e,t)}function c(e,t){var n=this;if(e.type===a.CALC_COLUMN){var r=n.calcSource_,o=new u.EvaluateContext(r);o.currentRowInternal_=t;var i=e.caches,c=e.exprInfo;c.hasAggFn&&o.beginCache(c,i);try{var l=n.evaluator_.evaluateExpression(e.expression,o);a.columnRef(l)&&-1!==t?l=l.getValue(t):a.fieldRef(l)&&(l=l.getValue()),e.values[t]=l,e.dirtyStates[t]=!1}finally{o.isCaching()&&(e.caches=o.endCache())}}}function l(e){var n=a.resolveExpressions(e),r={cacheAnchorGenerators:[]};return t.forEach(n,function(e){r.hasAggFn=r.hasAggFn||a.aggFn(e);var t=a.aggregatorCacheAnchorFn(e);t&&r.cacheAnchorGenerators.push(t),r.groupSensitive=r.groupSensitive||a.groupSensitiveFn(e),r.hierarchySensitive=r.hierarchySensitive||a.hierarchySensitiveFn(e),r.hierarchySensitive&&(r.groupSensitive=!0)}),r}function s(e){var t=this;if(e.type===a.CALC_COLUMN){var n=new u.EvaluateContext(t.calcSource_);n.currentRowInternal_=-1;for(var r=t.evaluator_.evaluateExpression(e.expression,n),o=0,i=r.length;i>o;o++){var c=t.calcSource_.mapToSourceRow(o);e.values[c]=r[o],e.dirtyStates[c]=!1}}}function f(e,t){var n=this;e.formula=t;var r=new u.ParserContext(n.calcSource_),o=n.parser_.parse(t,r);if(e.expression=o,o){var i=a.resolveDepends(o,n.calcSource_);e.depends=i,e.exprInfo=l(o)}else e.depends=null;var c=[];c.length=n.calcSource_.getDimension(),e.dirtyStates=c,e.caches=[]}return e.prototype={addColumn:function(e,t,r){var o=this;if(o.findColumn(e))throw"the column '"+e+"' has already exists!";return n.call(this,e,t,r)},removeColumn:function(e){0===t.remove(this.columns_,i.mP("name",e,!0)).length&&t.remove(this.columns_,i.mP("caption",e,!0))},getValues:function(e){var t=this,n=e;return t.hasDirty(n)&&t.calculateColumn(n),n.values},getValue:function(e,t){var n=this;return e.dirtyStates[t]!==!1&&n.calculateValue(e,t),e.values[t]},calculateValue:function(e,n){var o=this,i=e;return t.isString(e)&&(i=o.findColumn(e)),i?void r.call(this,i,n,!1):null},calculateColumn:function(e,n){var o=this,i=e;return t.isString(e)&&(i=o.findColumn(e)),i?void r.call(this,i,-1,n):null},findColumn:function(e){return t.find(this.columns_,i.mP("name",e,!0))||t.find(this.columns_,i.mP("caption",e,!0))},getColumns:function(){return this.columns_},hasDirty:function(e){for(var t=e.dirtyStates,n=0,r=t.length;r>n;n++)if(t[n]!==!1)return!0;return!1},dirty:function(e,t,n){var r=this;if(n&&e.formula!==n)f.call(r,e,n);else{var o=r.calcSource_.getDimension();if(t>=0&&o>t)e.dirtyStates[t]=!0;else if(-1===t){var i=[];i.length=o,e.dirtyStates=i}e.caches=[]}},updateColumnFormula:function(e,t){var n=this,r=n.findColumn(e);r&&(t||(t=r.formula),f.call(n,r,t))}},e}();c.CalcColumnsModel=h;var g=function(){function e(e){var t=this;t.calcSource_=e,t.parser_=e.getParser(),t.evaluator_=e.getEvaluator(),t.calcFields_=[]}function n(e,t){var n=this,r=new u.ParserContext(n.calcSource_),o=n.parser_.parse(t,r);if(!o)return null;var i=a.resolveDepends(o,n.calcSource_),c={name:e,type:a.CALC_FIELD,formula:t,expression:o,value:void 0,dirty:!0,depends:i,isCalculating:!1};return n.calcFields_.push(c),c}function r(e,t){var n=this;if(e.dirty){var r=new u.EvaluateContext(n.calcSource_,void 0,t);r.currentRowInternal_=-1;var o=n.evaluator_.evaluateExpression(e.expression,r);a.fieldRef(o)&&(o=o.getValue()),e.value=o,e.dirty=!1}}function o(e,t){var n=this;e.formula=t;var r=new u.ParserContext(n.calcSource_),o=n.parser_.parse(t,r);if(e.expression=o,o){var i=a.resolveDepends(o,n.calcSource_);e.depends=i}else e.depends=null;e.dirty=!0}return e.prototype={addField:function(e,t){var r=this;if(r.findField(e))throw"the field '"+e+"' has already exists!";return n.call(this,e,t)},removeField:function(e){return t.remove(this.calcFields_,i.mP("name",e,!0))},calculateField:function(e,t){var n=this,o=n.findField(e);if(!o.isCalculating){var i,u,c,l=n.calcSource_.getModel_(a.CALC_COLUMN),s=n.calcSource_.getModel_(a.DATA_COLUMN);o.isCalculating=!0;try{var f=[];for(f.push({type:a.CALC_FIELD,name:e});0!==f.length;){var d=f[f.length-1],p=a.getCalcObj(d,n.calcSource_);if(null!==p){var h=!1;if(c=p.depends,c&&c.length)for(i=0,u=c.length;u>i;i++){var g=a.getCalcObj(c[i],n.calcSource_),v=!1;g&&((g.type===a.CALC_FIELD&&g.dirty||g.type===a.DATA_COLUMN&&s.hasDirty(g)||g.type===a.CALC_COLUMN&&l.hasDirty(g))&&(v=!0),v&&(f.push(c[i]),h=!0))}h||(d.type===a.CALC_COLUMN&&l?(l.calculateColumn(p.name),f.pop()):d.type===a.DATA_COLUMN&&s?(s.unDirty(p.name,-1),f.pop()):d.type===a.CALC_FIELD&&(r.call(this,p,t),f.pop()))}else f.pop()}}catch(m){m&&(console.log("calculate exception thrown!"),console.log(m.message),console.log(m.stack))}finally{o.isCalculating=!1}}},findField:function(e){return t.find(this.calcFields_,i.mP("name",e,!0))},getValue:function(e,t){var n=this,r=n.findField(e);return r?(r.dirty&&n.calculateField(e,t),r.value):void 0},getFields:function(){return this.calcFields_},dirty:function(e,n){var r=this,i=e;t.isString(e)&&(i=r.findField(e)),i&&(n&&i.formula!==n?o.call(r,i,n):i.dirty=!0)},updateFieldFormula:function(e,t){var n=this,r=n.findField(e);r&&(t||(t=r.formula),o.call(n,r,t))}},e}();c.CalcFieldsModel=g;var v=function(){function e(e){var t=this;t.calcSource_=e,t.parser_=e.getParser(),t.evaluator_=e.getEvaluator(),t.calcFields_=[],n.call(t)}function n(){var e=this,t=e.calcSource_.getRootGroup_();t&&(e.rootGroupField_={value:void 0},r.call(e,t,e.rootGroupField_))}function r(e,n){e.groups&&(n.fields||(n.fields=[]),t.forEach(e.groups,function(e){var t={value:void 0,dirty:!0};n.fields.push(t),r(e,t)}))}function o(e,t){var n=e;if(n){if(t&&t.length)for(var r=0,o=t.length;o>r;r++){var i=t[r],a=n.fields;if(!(a&&i<a.length))return null;n=a[i]}return n}}function c(e,t){var n=this,r=o.call(n,e,t);if(r&&r.dirty){var i=new u.EvaluateContext(n.calcSource_,void 0,t);i.currentRowInternal_=-1,r.value=n.evaluator_.evaluateExpression(e.expression,i),r.dirty=!1}}function l(e){var t=this;e.dirty=!0;var n=e.fields;if(n)for(var r=0,o=n.length;o>r;r++)l.call(t,n[r])}return e.prototype={addField:function(e,n){var r=this,o=new u.ParserContext(r.calcSource_),i=r.parser_.parse(n,o);if(!i)return null;var c=a.resolveDepends(i,r.calcSource_),l={name:e,type:a.CALC_G_FIELD,formula:n,expression:i,value:void 0,dirty:!0,depends:c,isCalculating:!1},s={};return t.merge(s,r.rootGroupField_,l),r.calcFields_.push(s),s},calculateField:function(e,t){var n=this,r=n.findField(e);if(!r.isCalculating){var o,i,u,l=n.calcSource_.getModel_(a.CALC_FIELD),s=n.calcSource_.getModel_(a.CALC_COLUMN),f=n.calcSource_.getModel_(a.DATA_COLUMN);r.isCalculating=!0;try{var d=[];for(d.push({type:a.CALC_G_FIELD,name:e});0!==d.length;){var p=d[d.length-1],h=a.getCalcObj(p,n.calcSource_);if(null!==h){var g=!1;if(u=h.depends,u&&u.length)for(o=0,i=u.length;i>o;o++){var v=a.getCalcObj(u[o],n.calcSource_),m=!1;v&&((v.type===a.CALC_FIELD&&v.dirty||v.type===a.DATA_COLUMN&&f.hasDirty(v)||v.type===a.CALC_COLUMN&&s.hasDirty(v))&&(m=!0),m&&(d.push(u[o]),g=!0))}g||(p.type===a.CALC_COLUMN&&s?(s.calculateColumn(h.name),d.pop()):p.type===a.CALC_FIELD&&l?(l.calculateField(h.name),d.pop()):p.type===a.DATA_COLUMN&&f?(f.unDirty(h.name,-1),d.pop()):p.type===a.CALC_G_FIELD&&(c.call(n,h,t),d.pop()))}else d.pop()}}catch(_){_&&(console.log("calculate exception thrown!"),console.log(_.message),console.log(_.stack))}finally{r.isCalculating=!1}}},findField:function(e){return t.find(this.calcFields_,i.mP("name",e,!0))},getValue:function(e,t){var n=this,r=n.findField(e),i=o.call(n,r,t);return i?(i.dirty&&n.calculateField(e,t),i.value):void 0},getFields:function(){return this.calcFields_},updateGroups:function(){var e=this;n.call(e),e.calcFields_&&e.rootGroupField_&&t.forEach(e.calcFields_,function(n){n.fields=t.cloneDeep(e.rootGroupField_.fields),n.dirty=!0})},dirty:function(e){var n=this,r=e;t.isString(e)&&(r=n.findField(e)),r&&l.call(n,r)}},e}();c.CalcGroupFieldsModel=v,e.exports=c}()},function(e,t,n){"use strict";!function(){var t=n(8),r=n(20),o=n(28),i=n(29),a=function(){function e(){}function n(r,o,i){var a=[];if(e.structExpr(r))a.push({expr:r,aggContext:e.aggFn(o)});else if(e.fieldExpr(r))a.push({expr:r});else if(e.binaryExpr(r))i||a.push(r),a=a.concat(n(r.left,r,i)),a=a.concat(n(r.right,r,i));else if(e.fnExpr(r)){i||a.push(r);var u=r.args;u&&u.length>0&&t.forEach(u,function(e){a=a.concat(n(e,r,i))})}return a}return e.DATA_COLUMN="DataCol",e.CALC_COLUMN="CalcCol",e.EXTERNAL_COLUMN="ExternalCol",e.CALC_FIELD="CalcField",e.CALC_G_FIELD="CalcGField",e.CALC_TABLE="CalcTable",e.resolveDepends=function(r,o){var i=n(r,null,!0);return 0===i.length?null:t.map(i,function(t){var n=t.expr,r=t.aggContext;if(e.structExpr(n)){var i=n.column;if(i){var a=null,u=o.findColumn(i);return a=u?u.type:e.EXTERNAL_COLUMN,{type:a,table:n.table,column:i,aggContext:r}}return{type:"table",table:n.table}}if(e.fieldExpr(n)){var c=n.name;return c?{type:e.CALC_FIELD,name:c}:null}})},e.resolveExpressions=function(e){return n(e,null)},e.structExpr=function(e){return e instanceof o.StructReferenceExpression},e.fnExpr=function(e){return e instanceof o.FunctionExpression},e.fieldExpr=function(e){return e instanceof o.FieldReferenceExpression},e.binaryExpr=function(e){return e instanceof o.BinaryOperatorExpression},e.tableContextFn=function(e){return-1!==e.tableArgIndex()},e.filterFn=function(e){return e instanceof o.FunctionExpression&&e.fn instanceof i.Function&&e.fn.isFilter()},e.aggFn=function(e){return e instanceof o.FunctionExpression&&e.fn instanceof i.Function&&e.fn.isAggregator()},e.groupSensitiveFn=function(e){return e instanceof o.FunctionExpression&&e.fn instanceof i.Function&&e.fn.isGroupSensitive()},e.hierarchySensitiveFn=function(e){return e instanceof o.FunctionExpression&&e.fn instanceof i.Function&&e.fn.isHierarchySensitive()},e.aggregatorCacheAnchorFn=function(e){return e instanceof o.FunctionExpression&&e.fn instanceof i.Function&&e.fn.aggregatorCacheAnchor},e.fieldRef=function(e){return e instanceof r.CalcFieldReference},e.columnRef=function(e){return e instanceof r.CalcColumnReference},e.tabRef=function(e){return e instanceof r.CalcTableReference},e.err=function(e){return e instanceof r.CalcError},e.strExpr=function(e){return e instanceof o.StringExpression},e.unknowExpr=function(e){return e instanceof o.UnknownReferenceExpression},e.getCalcObj=function(t,n){var r,o=t.column;return r=t.type===e.CALC_COLUMN?n.findCalcColumn(o):t.type===e.DATA_COLUMN?n.findDataColumn(o):t.type===e.CALC_FIELD?n.findCalcField(t.name):t.type===e.CALC_G_FIELD?n.findCalcGroupField_(t.name):null},e}();e.exports=a}()},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){var t=n(20),o={};e.exports=o;var i="string",a=null;Math.min,Math.max,Math.abs,Math.pow;!function(e){e[e.Double=0]="Double",e[e.String=1]="String",e[e.Boolean=2]="Boolean",e[e.Function=3]="Function",e[e.BinaryOperator=4]="BinaryOperator",e[e.UnaryOperator=5]="UnaryOperator",e[e.Error=6]="Error",e[e.ExternalError=7]="ExternalError",e[e.Parentheses=8]="Parentheses",e[e.Array=9]="Array",e[e.StructReference=10]="StructReference",e[e.SheetRangeError=11]="SheetRangeError",e[e.MissingArgument=12]="MissingArgument"}(o.ExpressionType||(o.ExpressionType={}));o.ExpressionType;!function(e){var n=function(){function e(){}return e}();e.Expression=n;var o=function(e){function n(t){e.call(this),this.argument=t,this.t=8}return t.__extends(n,e),n}(n);e.ParenthesesExpression=o;var u=function(e){function n(t,n){e.call(this),this.fn=t,this.args=n,this.t=3}return t.__extends(n,e),n.prototype.argCount=function(){return this.args?this.args.length:0},n.prototype.getArg=function(e){return this.args?this.args[e]:a},n.prototype.getFunctionName=function(){var e=this;return r(e.fn)===i?e.fn:e.fn.name},n}(n);e.FunctionExpression=u;var c=function(e){function n(t){e.call(this),this.value=t}return t.__extends(n,e),n}(n);e.ConstantExpression=c;var l=function(e){function n(t){e.call(this,t),this.t=2}return t.__extends(n,e),n}(c);e.BooleanExpression=l;var s=function(e){function n(t,n){e.call(this,t),this.originalValue=n,this.t=0}return t.__extends(n,e),n}(c);e.DoubleExpression=s;var f=function(e){function n(t){e.call(this,t),this.t=1}return t.__extends(n,e),n}(c);e.StringExpression=f;var d=function(e){function n(t){e.call(this,t),this.t=6}return t.__extends(n,e),n}(c);e.ErrorExpression=d;var p=function(e){function n(t,n){e.call(this,n),this.source=t,this.t=7}return t.__extends(n,e),n}(d);e.ExternalErrorExpression=p;var h=function(e){function n(){e.call(this,t.missingArgument),this.t=12}return t.__extends(n,e),n}(c);e.MissingArgumentExpression=h;var g=function(e){function n(t){e.call(this),this.operator=t}return t.__extends(n,e),n}(n);e.OperatorExpression=g;var v=function(e){function n(t,n){e.call(this,t),this.operand=n,this.t=5}return t.__extends(n,e),n}(g);e.UnaryOperatorExpression=v;var m=function(e){function n(t,n,r){e.call(this,t),this.left=n,this.right=r,this.t=4}return t.__extends(n,e),n}(g);e.BinaryOperatorExpression=m;var _=function(e){function n(e,t){var n=this;n.table=e,n.column=t}return t.__extends(n,e),n}(n);e.StructReferenceExpression=_;var y=function(e){function n(e){var t=this;t.name=e}return t.__extends(n,e),n}(n);e.FieldReferenceExpression=y;var C=function(e){function n(e){var t=this;t.name=e}return t.__extends(n,e),n}(n);e.UnknownReferenceExpression=C}(o||(o={}))}()},function(e,t){"use strict";!function(){e.exports={Functions:{}}}()},function(e,t,n){"use strict";!function(){var t=n(8),r=n(27),o=void 0,i=function(){function e(e,t,n,r){var i=this;i.calcSource=e,i.currentRow=t,i.groupPath=n,i.hierarchyPath=r,i.expandArrayToMultiCallCount_=0,i.aggregatingCount_=0,i.filteringCount_=0,i.currentRowInternal_=o,i.caches_=[]}return e.prototype={getCurrentRow:function(){var e=this;return e.currentRow!==o?e.currentRow:e.isAggregating_()||e.isFiltering_()?-1:e.currentRowInternal_!==o?e.currentRowInternal_:-1},isAggregating_:function(){return this.aggregatingCount_>0},beginAggregating_:function(){this.aggregatingCount_++},endAggregating_:function(){this.aggregatingCount_--},isFiltering_:function(){return this.filteringCount_>0},beginFilter_:function(){this.filteringCount_++},endFilter_:function(){this.filteringCount_--},shouldCache:function(e){return r.aggFn(e)},beginCache:function(e,t){var n=this;n.isCaching_=!0,n.groupSensitive_=e.groupSensitive,n.hierarchySensitive_=e.hierarchySensitive,n.cacheAnchorGenerators_=e.cacheAnchorGenerators,n.caches_=t||[]},isCaching:function(){return this.isCaching_},addCache:function(e,t){var n=this;n.caches_.push({expr:e,cacheAnchor:n.makeAnchor_(),value:t})},endCache:function(){var e=this;e.isCaching_=!1;var t=e.caches_;return e.caches_=[],t},findCache:function(e){var t=this,n=t.caches_;if(n&&n.length)for(var r=0,o=n.length;o>r;r++){var i=n[r];if(i.expr===e.expr&&i.cacheAnchor===e.cacheAnchor)return n[r]}},makeAnchor_:function(){var e=this,n=function(n){return t.isUndefined(e.currentRowInternal_)?"":n(e.calcSource,e.currentRowInternal_)};return t.map(e.cacheAnchorGenerators_,n).join(",")}},e}(),a=function(){function e(e,t){var n=this;n.calcSource=e,n.option=t}return e}();e.exports={EvaluateContext:i,ParserContext:a}}()},function(e,t,n){"use strict";!function(){var t=n(8),r=null,o=(Math.min,Math.max,Math.abs,Math.pow,n(20)),i=n(28),a=n(32),u=n(27),c=n(29),l=o.SRHelper.throwSR,s=new a.Parser,f=function(){function e(){}function n(e,t,n){var r,i=this,a=e[t],c=n.calcSource,l=!1;if(u.structExpr(a)&&!a.column){if(a.table!==c.name)return o.CalcErrorsReference;r=i._evaluate(a,n)}else u.fnExpr(a)&&a.fn.isTableResult()&&(r=i._evaluate(a,n));return r||(r=new o.CalcTableReference(c),e.splice(t,0,null),l=!0),u.err(r)?o.CalcErrorsReference:(u.tabRef(r)&&(n.calcSource=r.calcSource),{filterOmitted:l,tableContextArg:r})}function a(e,t){var n,r,o=e.groups[t[0]];for(n=1,r=t.length;r>n;n++)o=o.groups[t[n]];return o}return e.prototype.evaluateFormula=function(e,t,n){var r=s.parse(e,t);return this.evaluateExpression(r,n)},e.prototype.evaluateExpression=function(e,t){return this._evaluate(e,t)},e.prototype._evaluate=function(e,t){var n=this;e||l("Exp_ExprIsNull");var r=t.isCaching();if(r&&t.shouldCache(e)){var a=t.findCache({expr:e,cacheAnchor:t.makeAnchor_()});if(a)return a.value}for(;8===e.t;)e=e.argument;var u;if(e instanceof i.ConstantExpression)u=n._evaluateConst(e,t);else if(e instanceof i.UnaryOperatorExpression)u=n._evaluateUnaryOperation(e,t);else if(e instanceof i.BinaryOperatorExpression)u=n._evaluateBinaryOperation(e,t);else if(e instanceof i.FunctionExpression){if(!(e.fn instanceof c.Function))return o.CalcErrorsName;u=e.fn.isCalculate()?n._evaluateCalculateFunction(e,t):e.fn.isSummarize()?n._evaluateSummarizeFunction(e,t):n._evaluateFunction(e,t)}else e instanceof i.StructReferenceExpression?u=n._evaluateStructExpression(e,t):e instanceof i.FieldReferenceExpression?u=n._evaluateFieldExpression(e,t):e instanceof i.UnknownReferenceExpression&&(u=n._evaluateUnknownExpression(e,t));return r&&t.shouldCache(e)&&t.addCache(e,u),u},e.prototype._evaluateConst=function(e,t){return e.value},e.prototype._evaluateUnaryOperation=function(e,t){var n=this._evaluate(e.operand,t);return o.Convert.err(n)?n:n===o.missingArgument?o.CalcErrorsNotAvailable:e.operator.evaluate(n,t)},e.prototype._evaluateBinaryOperation=function(e,t){for(var n=[e.left,e.right],r=[],i=0;2>i;i++){var a=this._evaluate(n[i],t);if(o.Convert.err(a))return a;if(a===o.missingArgument)return o.CalcErrorsNotAvailable;r[i]=a}return e.operator.evaluate(r[0],r[1],t)},e.prototype._evaluateFunction=function(e,t){if(!e||!e.fn||"string"==typeof e.fn)return o.CalcErrorsName;var i,a,u,c=this,l=e.argCount(),s=e.fn,f=[],d=[];for(a=0;l>a;a++)f.push(e.getArg(a));var p=s.tableArgIndex();if(-1!==p){u=t.calcSource;var h=n.call(c,f,p,t);h.filterOmitted&&++l,d[p]=h.tableContextArg}var g=s.isAggregator();g&&t.beginAggregating_();var v=s.isFilter();if(v&&t.beginFilter_(),0!==l)for(a=0;l>a;a++)if(a!==p){var m=f[a];if(i=c._evaluate(m,t),o.Convert.err(i)&&!s.acceptsError(a))return i;i===o.missingArgument&&(s.acceptsMissingArgument(a)||(i=r)),d[a]=i}var _=e.fn.evaluate(d,t);return-1!==p&&u&&(t.calcSource=u),g&&t.endAggregating_(),v&&t.endFilter_(),_},e.prototype._evaluateCalculateFunction=function(e,n){if(!e||!e.fn||"string"==typeof e.fn)return o.CalcErrorsName;var r,a,l,s,f,d,p,h=this,g=e.getArg(0),v=e.argCount(),m=[],_=n.calcSource;if(1===v)return l=h._evaluate(g,n),u.columnRef(l)?l=l.getValue(n.getCurrentRow(),n.groupPath):u.fieldRef(l)&&(l=l.getValue()),l;for(a=1;v>a;a++)r=e.getArg(a),m.push(r);if(t.forEach(m,function(e){u.fnExpr(e)&&e.fn.isTableResult()?u.err(f=h._evaluate(e,n))||(n.calcSource=f.calcSource):(s=c.findGlobalFunction("filter"),s=new i.FunctionExpression(s,[e]),u.err(f=h._evaluate(s,n))||(n.calcSource=f.calcSource))}),l=h._evaluate(g,n),u.columnRef(l)){if(p=l.calcSource.findColumn(l.column),!p)return o.CalcErrorsReference;var y=n.getCurrentRow(!1);if(n.calcSource.isFilterOut(y))return;l=p.type===u.DATA_COLUMN?l.getValue(y,n.groupPath):h._evaluate(p.expression,n)}else if(u.fieldRef(l)){if(d=l.calcSource.findCalcField(l.name),r=d&&d.expression,!r)return o.CalcErrorsReference;l=h._evaluate(r,n)}return n.calcSource=_,l},e.prototype._evaluateSummarizeFunction=function(e,r){if(!e||!e.fn||"string"==typeof e.fn)return o.CalcErrorsName;var i,c=this,l=e.argCount(),s=e.fn,f=[],d=[],p=r.calcSource;for(i=0;l>i;i++)f.push(e.getArg(i));var h=s.tableArgIndex(),g=n.call(c,f,h,r);g.filterOmitted&&++l,d[h]=g.tableContextArg,r.beginFilter_();var v=[],m=[],_=[],y=f.length;i=1;for(var C;u.structExpr(C=f[i])&&C.column&&y>i;)v.push(C.column),++i;for(;u.strExpr(C=f[i])&&y>i;){if(!(t.indexOf(v,C.value)<0))return o.CalcErrorsReference;m.push(C.value),++i,_.push(f[i++]||o.CalcErrorsReference)}var b=r.calcSource,S=b.getModel_(u.CALC_TABLE),w=t.map(v,function(e){return{field:e}});S.beginUseGroup();var I=b.group(w),x=r.groupPath,A=[];for(i=I.groups.length-1;i>=0;--i)A.push([i]);for(var E,R,N,D,F,T=[];A.length>0;)if(E=A.pop(),R=a(I,E),r.groupPath=E,F=R.getItem(0),N=R.isBottomLevel,N===!0){for(D={},i=0,y=m.length;y>i;++i)C=_[i],u.err(C)?D[m[i]]=C:D[m[i]]=c._evaluate(C,r);for(i=0,y=v.length;y>i;++i)D[v[i]]=F[v[i]];T.push(D)}else if(R.isBottomLevel===!1)for(i=R.groups.length-1;i>=0;--i)A.push(E.concat([i]));return r.groupPath=x,S.endUseGroup(),-1!==h&&p&&(r.calcSource=p),r.endFilter_(),new o.CalcTableReference(r.calcSource.create_("summarizedTable",T))},e.prototype._evaluateStructExpression=function(e,n){return e.table&&e.column?new o.CalcColumnReference(n.calcSource,e.column):e.table?t.isUndefined(e.table)||e.table===n.calcSource.name?new o.CalcTableReference(n.calcSource,e.table):o.CalcErrorsReference:void 0},e.prototype._evaluateFieldExpression=function(e,t){return new o.CalcFieldReference(t.calcSource,e.name)},e.prototype._evaluateUnknownExpression=function(e,t){return t.calcSource.findColumn(e.name)?new o.CalcColumnReference(t.calcSource,e.name):t.calcSource.findCalcField(e.name)?new o.CalcFieldReference(t.calcSource,e.name):o.CalcErrorsReference},e.prototype._evaluateWithArgs=function(e,t,n,r){return t(r,n)},e}();e.exports=f}()},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){function t(e){return 255>=e}function o(e){return 127>=e}function i(e){var t=e.charCodeAt(0);return t>=48&&57>=t}function a(e){var n=e.charCodeAt(0);return t(n)?o(n)?(n|=32,n>=96&&122>=n):ae[n]===ie.UppercaseLetter||ae[n]===ie.LowercaseLetter:!0}function u(e){var n=e.charCodeAt(0);return t(n)?o(n)?57>=n?n>=48:(n|=32,n>=96&&122>=n):ae[n]===ie.UppercaseLetter||ae[n]===ie.LowercaseLetter:!0}function c(e){var n=e.charCodeAt(0);return t(n)?ae[n]===ie.MathSymbol||ae[n]===ie.currencySymbol||ae[n]===ie.ModifierSymbol||ae[n]===ie.OtherSymbol:!1}function l(e,t,n){for(var r=e.length,o=oe.None,a=t;r>a;a++){var u=e.charAt(a);if(i(u))o===oe.None?o=oe.Int:o===oe.Dot?o=oe.Decimal:o===oe.Sign?o=oe.Int:o!==oe.Exponent&&o!==oe.SignExponent||(o=oe.ScientificNotation);else if(u===n)if(o===oe.Int)o=oe.Decimal;else{
if(o!==oe.None&&o!==oe.Sign)return{result:!1};o=oe.Dot}else if("+"===u||"-"===u)if(o===oe.None)o=oe.Sign;else{if(o!==oe.Exponent)return{result:!0,endIndex:a-1};o=oe.SignExponent}else if("E"===u||"e"===u){if(o!==oe.Int&&o!==oe.Decimal)return{result:!1};o=oe.Exponent}else if(o===oe.Int||o===oe.Decimal||o===oe.ScientificNotation)return{result:!0,endIndex:a-1}}return o===oe.Int||o===oe.Decimal||o===oe.ScientificNotation?{result:!0,endIndex:r-1}:{result:!1}}function s(e,t,n,r,o){for(var i=e.length,a=n===r?0:1,u="",c=t+1;i>c;c++){var l=e.charAt(c);if(l===n&&a++,l===r)if(a--,n===r&&i>c+2&&e.charAt(c+1)===n)u+=n,c++;else{if(0===a)return{result:u,endIndex:c};u+=l}else u+=l}if(o)throw I(M)+r+I(O)+n+I(L)}function f(e,t,n,r,o,i){for(var a=e.length,u=0,c="",l=t;a>l;l++){var s=e.charAt(l);if(s===o&&(c+=s,l++,s=e.charAt(l)),s===n)c+=s,u++;else if(s===r){if(u--,0===u)return{result:c,endIndex:l};c+=s}else c+=s}if(i)throw I(M)+r+I(O)+n+I(L)}function d(e,t,n){for(var r=e.length,o=r-t,i=0;i<Q.length;i++){var a=Q[i],u=a.length;if(!(t+u>r)){var c=e.slice(t,t+u);if(o>=u&&(a===c||a===c.toUpperCase()))return{result:a,endIndex:t+u-1}}}if(n)throw I(R)}function p(e){return"^"===e||":"===e?1:"*"===e||"/"===e||" "===e?2:"+"===e||"-"===e||","===e?3:"&"===e?4:"||"===e||"&&"===e?6:5}function h(e){var t=e.value,n=G.Operators;return"^"===t?n.exponent:"*"===t?n.multiply:"/"===t?n.divide:"+"===t?n.add:"-"===t?n.subtract:"&"===t?n.concatenate:"<"===t?n.lessThan:"="===t?n.equal:">"===t?n.greaterThan:">="===t?n.greaterThanOrEqual:"<="===t?n.lessThanOrEqual:"<>"===t?n.notEqual:"&&"===t?n.and:"||"===t?n.or:n.add}function g(e,t,n){return e&&e.hasOwnProperty(t)?e[t]:n}function v(e,t){return e!==te&&e!==ee||t!==te&&t!==ee?(e===te||e===ee)&&t!==te&&t!==ee||e!==te&&e!==ee&&(t===te||t===ee)?!1:e.toLowerCase()===t.toLowerCase():!0}var m=n(8),_=n(20),y=n(28),C=n(30),b=n(29),S=_.SRHelper,w=S.throwSR,I=S.sr,x=(S.cr,"Exp_NotSupport"),A="Exp_InvalidArray",E="AtIndexOn",R="SingleQuote",N="FullStop",D="Exp_FormulaInvalid",F="Exp_InvalidTokenAt",T="Exp_InvalidParameters",M="Exp_NoSyntax",O="Exp_MatchSyntax",L="SingleQuotesFullStop",P="Exp_InvalidArrayAt",G={};e.exports=G;var B="undefined",k="number",U="string",H="boolean",V="TRUE",j="FALSE",W="ARRAY",z="ARRAYROW",Y="#NULL!",q="#DIV/0!",X="#VALUE!",$="#REF!",K="#NAME?",J="#N/A",Z="#NUM!",Q=[Y,q,X,$,K,J,Z],ee=null,te=void 0,ne=(Math.min,Math.max,Math.abs),re=Math.pow,oe={None:0,Sign:1,Int:2,Dot:3,Decimal:4,Exponent:5,SignExponent:6,ScientificNotation:7,Number:8},ie={UppercaseLetter:0,LowercaseLetter:1,DecimalDigitNumber:8,OtherNumber:10,SpaceSeparator:11,Control:14,ConnectorPunctuation:18,DashPunctuation:19,OpenPunctuation:20,ClosePunctuation:21,InitialQuotePunctuation:22,FinalQuotePunctuation:23,OtherPunctuation:24,MathSymbol:25,currencySymbol:26,ModifierSymbol:27,OtherSymbol:28},ae=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1],ue=function(){function e(t){("undefined"==typeof t?"undefined":r(t))!==B&&t!==ee&&e.setParserOption(t)}return e.setParserOption=function(t){e.listSeparator=g(t,"listSeparator",","),e.numberDecimalSeparator=g(t,"numberDecimalSeparator","."),e.arrayGroupSeparator=g(t,"arrayGroupSeparator",";"),e._arrayArgumentSepatator=e.listSeparator===e.arrayGroupSeparator?"\\":e.listSeparator,e._operatorInfix="\\+-*/^&=><: "+e.listSeparator},e.getParserOption=function(){var t={numberDecimalSeparator:e.numberDecimalSeparator,listSeparator:e.listSeparator,arrayGroupSeparator:e.arrayGroupSeparator};return t},e.prototype.parse=function(t,n){var r=this;if(!n)return ee;n.option&&e.setParserOption(n.option);var o=r._parseToToken(t);return r._buildExpressionTree(n,o)},e.prototype.unparse=function(t,n){if(e.unparseWithoutCulture=!1,!t)return"";n||(n=new C.ParserContext(ee)),n.option&&e.setParserOption(n.option);var r={content:""};return this._unparseExpression(t,n,r),r.content},e.prototype.unparseWithoutCulture=function(t,n){if(e.unparseWithoutCulture=!0,!t)return"";n||(n=new C.ParserContext(ee)),n.option&&e.setParserOption(n.option);var r={content:""};return this._unparseExpression(t,n,r),e.unparseWithoutCulture=!1,r.content},e.prototype._unparseExpression=function(t,n,r){var o=this;if(t instanceof _.Expressions.ConstantExpression)o._unparseConstantExpression(t,n,r);else if(t instanceof _.Expressions.OperatorExpression)o._unParseOperatorExpressions(t,n,r);else if(t instanceof _.Expressions.StructReferenceExpression)o._unParseStructExpression(t,n,r);else if(8===t.t)r.content+="(",o._unparseExpression(t.argument,n,r),r.content+=")";else if(3===t.t){r.content+=t.getFunctionName(),r.content+="(";for(var i=0;i<t.argCount();i++)0!==i&&e.unparseWithoutCulture&&(r.content+=","),o._unparseExpression(t.getArg(i),n,r);r.content+=")"}else w(x)},e.prototype._unparseSource=function(e,t,n){return""},e.prototype._removeApostrophe=function(e){var t=e.content,n=t.length;return"'"===t.charAt(n-1)?(e.content=t.substr(1,n-2),!0):!1},e.prototype._removeWorkbook=function(e){if("["!==e.content.charAt(0))return{success:!1,workBookName:""};var t=e.content.indexOf("]"),n=e.content.substr(0,t+1);return e.content=e.content.substr(t),{success:!0,workBookName:n}},e.prototype._unParseOperatorExpressions=function(t,n,r){var o=this;if(5===t.t){var i=t.operator;i===Operators.percent?(o._unparseExpression(t.operand,n,r),r.content+=i.name):(r.content+=i.name,o._unparseExpression(t.operand,n,r))}else if(4===t.t){var a={content:""},u={content:""};o._unparseExpression(t.right,n,u);var c=4===t.left.t,l=4===t.right.t,s=p(t.operator.name);c&&p(t.left.operator.name)>s?(a.content+="(",o._unparseExpression(t.left,n,a),a.content+=")"):o._unparseExpression(t.left,n,a),l&&p(t.right.operator.name)>s&&(u.content+="(",o._unparseExpression(t.right,n,u),u.content+="("),r.content+=a.content,r.content+=5===t.operator.t?e.listSeparator:t.operator.name,r.content+=u.content}else w(x)},e.prototype._unparseConstantExpression=function(t,n,o){var i=this,a=I(A);if(1===t.t)o.content+='"',o.content+=t.value,o.content+='"';else if(0===t.t){var u=t.originalValue;!e.unparseWithoutCulture,o.content+=u}else if(2===t.t)o.content+=t.value?V:j;else if(9===t.t){o.content+="{";var c=t.value;if(c.getRowCount()<=0)throw a;for(var l=_.ParserConstants.BAND_INDEX_CONST,s=l,f=0;f<c.getRowCount();f++){f>=1&&(e.unparseWithoutCulture?o.content+=";":o.content+=e.arrayGroupSeparator);for(var d=0;d<c.getColumnCount();d++){if(s!==l&&(s!==c.getColumnCount()||0===c.getColumnCount()))throw a;if(0!==d){var p;p=e.unparseWithoutCulture?",":e.listSeparator===e.arrayGroupSeparator?"\\":e.listSeparator,o.content+=p}var h=c.getValue(f,d,n.groupPath,n.hierarchyPath);if(h===te||h===ee)throw a;h instanceof y.Expression?i._unparseExpression(h,n,o):("undefined"==typeof h?"undefined":r(h))===U?(o.content+='"',o.content+=h,o.content+='"'):("undefined"==typeof h?"undefined":r(h))===H?o.content+=h?V:j:(e.unparseWithoutCulture||("undefined"==typeof h?"undefined":r(h))!==k)&&(o.content+=h.toString())}}o.content+="}"}else 7===t.t?(i._unparseSource(t.source,n,o),o.content+="!",o.content+=t.value.toString()):6===t.t?o.content+=t.value.toString():12===t.t||w(x)},e.prototype._unParseStructExpressions=function(e,t,n){n.content+=e.table,e.column&&(n.content+="[",n.content+=e.column,n.content+="]")},e.prototype._parseToToken=function(t,n){"undefined"==typeof n&&(n=!0);for(var r,o,a=this,c=t.length,p=[],h=[],g=-1,v="",m=I(E),_=0,y=0;c>y&&" "===t.charAt(y);)y++;"="===t.charAt(y)&&y++,_=y;for(var C=y;c>C;C++){var b,S,w,x=t.charAt(C);if('"'===x)b=s(t,C,'"','"',n),b?(p.push(new se(b.result,0,C+1,3)),C=b.endIndex,_=C+1):(v+=t.substring(C,c),C=c-1);else if("'"===x)b=s(t,C,"'","'",n),b?(v+="'",v+=b.result,v+="'",C=b.endIndex):(v+="'",C+=1);else if("["===x)if(b=f(t,C,"[","]","'",n))v+=b.result,v+="]",C=b.endIndex;else{if("R"===v||"r"===v||"C"===v||"c"===v)continue;v+=t.substring(C,c),C=c-1}else{if("\r"===x||"\n"===x)continue;if("#"===x){var A=d(t,C);if(A){var F=c>C?t.charAt(C+1):"\x00";C>0&&"!"===t.charAt(C-1)?v+=A.result:$===A.result.toUpperCase()&&c>C&&(u(F)||"$"===F)?v+=A.result:(p.push(new se(A.result,0,C,6)),_=C+1),C=A.endIndex}else v+=x}else if("+"===x||"-"===x)S=0===p.length?null:p[p.length-1],0!==v.length?(p.push(new se(v,0,_)),p.push(new se(x,5,C)),v="",_=C+1):(S&&7===S.type&&(p.pop(),S=p[p.length-1]),S&&(1===S.type&&2===S.subType||2===S.type&&2===S.subType||6===S.type||0===S.type)?(p.push(new se(x,5,C)),_=C+1):(p.push(new se(x,4,C)),_=C+1));else if(x===e.numberDecimalSeparator||i(x)){var T;if(v.length>0)v+=x;else if((T=l(t,C,e.numberDecimalSeparator)).result){w=T.endIndex;var M=t.slice(C,w+1);for("."!==e.numberDecimalSeparator;c-2>=w&&" "===t.charAt(w+1);)w++;c-2>=w&&":"===t.charAt(w+1)?(v+=M,v+=":",w++,_=C):(p.push(new se(M,0,C,4)),_=C+1),C=w}else v+=x}else if("{"===x){if(v.length>0&&n)throw I(D)+I(R)+"{"+m+C+I(N);r=new se(W,1,C,1),p.push(r),h[++g]=r,r=new se(z,1,C,1),p.push(r),h[++g]=r,_=C+1}else if(x===e.arrayGroupSeparator&&g>=0&&(h[g].value===W||h[g].value===z)){if(v.length>0&&(p.push(new se(v,0,_)),v=""),0>g&&n)throw I(D)+I(R)+x+m+C+I(N);o=h[g--],o=new se(x,o.type,C,2),p.push(o),p.push(new se(e.listSeparator,3,C)),r=new se(z,1,C+1,1),p.push(r),h[++g]=r,_=C+1}else if("}"===x){if(v.length>0&&(p.push(new se(v,0,_)),v=""),0>w&&n)throw I(D)+I(R);o=h[g--],o=new se(x,o.type,C,2),p.push(o),o=h[g--],o=new se(x,o.type,C,2),p.push(o),_=C+1}else if(" "===x){var O=C;for(C++;c>C&&" "===v.charAt(v.length-1);)C++;v.length>0&&":"!==v.charAt(v.length-1)&&c>C&&":"!==t.charAt(C)&&(p.push(new se(v,0,_)),v="",p.push(new se("",7,O))),_=C,C--}else if(c>=C+2&&"<"===x&&"="===t.charAt(C+1)||">"===x&&"="===t.charAt(C+1)||"<"===x&&">"===t.charAt(C+1))v.length>0&&(p.push(new se(v,0,_)),v=""),p.push(new se(t.slice(C,C+2),5,C,5)),C++,_=C+1;else if("%"===x)v.length>0&&(p.push(new se(v,0,_)),v=""),p.push(new se(t.charAt(C),6,C)),_=C+1;else if("+"===x||"-"===x||"*"===x||"/"===x||"="===x||">"===x||"<"===x||"&"===x||"^"===x||"|"===x){if(v.length>0&&(p.push(new se(v,0,_)),v=""),"&"===x){if("&"===t.charAt(C+1)){p.push(new se("&&",5,C)),_=C+1,C+=1;continue}}else if("|"===x){"|"===t.charAt(C+1)?(p.push(new se("||",5,C)),_=C+1,C+=1):v+=x;continue}p.push(new se(x,5,C)),_=C+1}else if("("===x){if(v.length>0){var L=v.charAt(v.length-1);if(":"===L||L===e.listSeparator||" "===L)v=v.slice(0,v.length-1),p.push(new se(v,0,_,7)),p.push(new se(L,5,C-1,0)),r=new se("",2,C,1),p.push(r),h[++g]=r;else{var P=v.indexOf(":"),G=":";-1===P&&(P=v.indexOf(e.listSeparator),G=e.listSeparator),-1===P&&(P=v.indexOf(" "),G=" "),-1!==P&&P>0?(p.push(new se(v.substr(0,P),0,_,7)),p.push(new se(G,5,_+P,0)),v=v.slice(P+1),r=new se(v.toUpperCase(),1,_+P+1,1),p.push(r),h[++g]=r):(r=new se(v.toUpperCase(),1,C-v.length,1),p.push(r),h[++g]=r)}v=""}else r=new se("",2,C,1),p.push(r),h[++g]=r;_=C+1}else if(x===e.listSeparator||x===e._arrayArgumentSepatator||x===e.arrayGroupSeparator)v.length>0&&(p.push(new se(v,0,_)),v=""),0>g||1!==h[g].type?p.push(new se(e.listSeparator,5,C,10)):p.push(new se(e._arrayArgumentSepatator,3,C)),_=C+1;else if(")"===x){if(v.length>0&&(p.push(new se(v,0,_)),v=""),0>g&&n)throw I(D)+I(R);o=h[g--],o=new se(x,o.type,C,2),p.push(o),_=C+1}else":"===x?0===v.length&&2===p[p.length-1].subType?(p.push(new se(":",5,C,11)),_=C+1):v+=":":v+=x}}return v.length>0&&p.push(new se(v,0,_)),a._processTokens(p,n)},e.prototype._processTokens=function(e,t){var n=this._removeWhiteSpace(e),r=[],o=new se("",8,0,1);r.push(o);for(var i,a=n.length,u=0;a>u;u++){var c=n[u];if(c){var l=0===u?ee:n[u-1],s=u===a-1?ee:n[u+1];if(0===c.type&&0===c.subType){var f=c.value.toUpperCase();f===V||f===j?(c.subType=5,c.value=f):c.subType=7}else 1===c.type&&c.value.length>0&&"@"===c.value.charAt(0)&&(c.value=c.value.substr(1));if(0===r.length&&t)throw I(F)+c.index+I(N);if(i=r[r.length-1],i.value===z&&t&&3!==c.type&&6!==c.subType&&2!==c.subType&&5!==c.subType&&4!==c.subType&&3!==c.subType&&4!==c.type)throw I(P)+c.index+I(N);switch(c.type){case 0:if(t&&l&&(0===l.type||6===l.type||1===l.type&&2===l.subType||2===l.type&&2===l.subType))throw I(F)+c.index+I(N);break;case 1:case 2:if(c.value===W&&1===c.type&&1===c.subType&&!l)break;if(t&&(2===c.subType&&(!l||4===l.type||5===l.type)||1===c.subType&&l&&(!s||6===l.type||2===l.subType)))throw I(F)+c.index+I(N);if(t&&2===c.subType&&2===c.type&&1===l.subType)throw I(F)+c.index+I(N);if(t&&2===c.subType&&1===c.type&&2===l.type&&1===l.subType)throw I(F)+c.index+I(N);if(t&&1===c.subType&&l&&(1===l.type&&2===l.subType||0===l.type||6===l.type))throw I(F)+c.index+I(N);break;case 3:if(t&&(!s||!l||5===l.type||4===l.type))throw I(F)+c.index+I(N);break;case 4:if(t&&(!s||l&&6===l.type))throw I(F)+c.index+I(N);break;case 5:if(t&&(!s||!l||5===l.type||4===l.type||3===l.type||1===l.type&&1===l.subType||2===l.type&&1===l.subType))throw I(F)+c.index+I(N);break;case 6:if(t&&(!l||4===l.type||5===l.type||1===l.type&&1===l.subType||2===l.type&&1===l.subType))throw I(F)+c.index+I(N);break;default:if(t)throw I(F)+c.index+I(N)}if(t)if(1===c.subType)r.push(c),i.children.push(c);else if(2===c.subType){if(0===r.length&&t)throw I(D)+I(R);r.pop()}else i.children.push(c)}}return t?o.children:n},e.prototype._removeWhiteSpace=function(e){for(var t=[],n=e.length,r=0;n>r;r++){var o=e[r];if(o)if(7===o.type){var i=0===r?ee:e[r-1],a=r===n-1?ee:e[r+1];i&&a&&(1===i.type&&2===i.subType||2===i.type&&2===i.subType||0===i.type)&&(1===a.type&&1===a.subType||2===a.type&&1===a.subType||0===a.type)&&t.push(new se(" ",5,o.index,9))}else t.push(o)}return t},e.prototype._buildExpressionNode=function(e,t){var n,r=this;return 1===t.type?n=t.value===W?r._buildArraryExpression(e,t):r._buildFunctionExpression(e,t):2===t.type?n=r._buildSubExpression(e,t):0===t.type&&(4===t.subType?n=new y.DoubleExpression(parseFloat(t.value),t.value):6===t.subType?n=new y.ErrorExpression(_.CalcError.parse(t.value)):5===t.subType?v(t.value,V)?n=new y.BooleanExpression(!0):v(t.value,j)&&(n=new y.BooleanExpression(!1)):n=7===t.subType?r._buildStructOrFieldExpression(e,t.value,t.index):new y.StringExpression(t.value)),n},e.prototype._buildExpressionTree=function(e,t){var n,r,o,i,a=this._parseToBinaryOperatorList(e,t);for(i=3;i<a.length;){var u=a[i],c=a[i-2];if(u&&5===u.type){for(;i>=3&&p(u.value)>=p(c.value);)r=a[i-3],o=a[i-1],n=new y.BinaryOperatorExpression(h(c),r,o),a.splice(i-3,3),a.splice(i-3,0,n),i-=2,i>=3&&(c=a[i-2]);i+=2}else i++}if(1===a.length)return a[0];for(i=a.length-2;i>0;i-=2)r=a[i-1],o=a[i+1],n=new y.BinaryOperatorExpression(h(a[i]),r,o),a.splice(i-1,3),a.push(n);return n},e.prototype._parseToBinaryOperatorList=function(e,t){for(var n,r=[],o=G.Operators,i=0;i<t.length;i++){var a=t[i];if(4===a.type){for(var u=[];4===a.type;)u.push("+"===a.value?o.plus:o.negate),i++,a=t[i];var c=t[i];for(n=new y.UnaryOperatorExpression(u.pop(),this._buildExpressionNode(e,c));u.length>0;)n=new y.UnaryOperatorExpression(u.pop(),n);r.push(n)}else if(6===a.type){var l=r[r.length-1];n=new y.UnaryOperatorExpression(o.percent,l),r.pop(),r.push(n)}else 5===a.type?r.push(a):(n=this._buildExpressionNode(e,a),r.push(n))}return r},e.prototype._buildFunctionExpression=function(e,t){for(var n=[],r=[],o=0;o<t.children.length;o++){var i=t.children[o];3!==i.type?r.push(i):0===r.length?n.push(new y.MissingArgumentExpression):(n.push(this._buildExpressionTree(e,r)),r=[])}0!==r.length?n.push(this._buildExpressionTree(e,r)):0!==t.children.length&&n.push(new y.MissingArgumentExpression);var a=b.findGlobalFunction(t.value);if(a){var u=n.length;if(u<a.minArgs||u>a.maxArgs)throw I(T)+t.index+I(N);return new y.FunctionExpression(a,n)}return new y.FunctionExpression(t.value,n)},e.prototype._buildSubExpression=function(e,t){return new y.ParenthesesExpression(this._buildExpressionTree(e,t.children))},e.prototype._buildStructOrFieldExpression=function(e,t){if(t===te||t===ee||""===t)return{endIndex:0,expression:ee};var n=t.length,r=/^([^\[\]]*)[\[]{1}([^\[\]]+)[\]]{1}$/g,o=r.exec(t);if(!o)return new y.StructReferenceExpression(t);if(3!==o.length)return{endIndex:n,expression:ee};var i=o[1],a=o[2];return a?e.calcSource.hasColumn(a)?(i||(i=e.calcSource.getName()),new y.StructReferenceExpression(i,a)):e.calcSource.hasField(a)?new y.FieldReferenceExpression(a):new y.UnknownReferenceExpression(a):void 0},e.prototype._validateName=function(e){if(e===te||e===ee||""===e)return!1;var t=e.length;if(1===t&&("R"===e||"r"===e||"C"===e||"c"===e))return!1;var n=e.charAt(0);if("_"!==n&&"\\"!==n&&!a(n)&&!c(n))return!1;for(var r=1;t>r;r++)if(n=e.charAt(r),"_"!==n&&"\\"!==n&&"?"!==n&&"."!==n&&!u(n)&&!c(n))return!1;return!0},e._isLetter=a,e._isLetterOrDigit=u,e.listSeparator=",",e.numberDecimalSeparator=".",e.arrayGroupSeparator=";",e._arrayArgumentSepatator=e.listSeparator,e._operatorInfix="\\+-*/^&=><: "+e.listSeparator,e.unparseWithoutCulture=!1,e}();G.Parser=ue;var ce;!function(e){e[e.Operand=0]="Operand",e[e.Function=1]="Function",e[e.Subexpression=2]="Subexpression",e[e.Argument=3]="Argument",e[e.OperatorPrefix=4]="OperatorPrefix",e[e.OperatorInfix=5]="OperatorInfix",e[e.OperatorPostfix=6]="OperatorPostfix",e[e.Whitespace=7]="Whitespace",e[e.Unknown=8]="Unknown"}(ce||(ce={}));var le;!function(e){e[e.Nothing=0]="Nothing",e[e.Start=1]="Start",e[e.Stop=2]="Stop",e[e.Text=3]="Text",e[e.Number=4]="Number",e[e.Logical=5]="Logical",e[e.Error=6]="Error",e[e.RangeOrName=7]="RangeOrName",e[e.Concatenation=8]="Concatenation",e[e.Intersection=9]="Intersection",e[e.Union=10]="Union",e[e.RangeOp=11]="RangeOp"}(le||(le={}));var se=function(){function e(e,t,n,r){r!==te&&r!==ee||(r=0);var o=this;o.value=e,o.type=t,o.index=n,o.subType=r,o.children=[]}return e}();!function(e){function t(e,t){return e===t?!0:ne(e-t)<ne(e)/281474976710656}var n=function(){function e(e){this.name=e}return e.prototype.getName=function(){return this.name},e.prototype.compareTo=function(e){return v(this.name,e.name)},e.prototype.toString=function(){return this.getName()},e}();e.Operator=n;var o=function(e){function t(t){e.call(this,t)}return _.__extends(t,e),t.prototype._evaluateSingle=function(e,t){},t.prototype.evaluate=function(e,t){var n=this,r=e;return(r instanceof _.CalcColumnReference||r instanceof _.CalcFieldReference)&&(r=r.getValue(t.getCurrentRow(),t.groupPath,t.hierarchyPath)),m.isArray(r)?m.map(r,function(e){return n._evaluateSingle(e,t)}):n._evaluateSingle(r,t)},t}(n);e.UnaryOperator=o,e.plus=new o("+"),e.plus._evaluateSingle=function(e,t){if(e===te||e===ee)return 0;var n={value:0};return _.Convert.rD(e,n)?_.Convert.D(n.value):"string"==typeof e?e:_.CalcErrorsValue},e.negate=new o("-"),e.negate._evaluateSingle=function(e,t){if(e===te||e===ee)return 0;var n={value:0};return _.Convert.rD(e,n)?-n.value:_.CalcErrorsValue},e.percent=new o("%"),e.percent._evaluateSingle=function(e,t){if(e===te||e===ee)return 0;var n={value:0};return _.Convert.rD(e,n)?n.value/100:_.CalcErrorsValue};var i=function(e){function t(t,n){e.call(this,t),this.acceptsReference=n}return _.__extends(t,e),t.prototype._evaluateSingle=function(e,t,n){},t.prototype.evaluate=function(e,t,n){var r,o=this;r=e instanceof _.CalcColumnReference||e instanceof _.CalcFieldReference?e.getValue(n.getCurrentRow(),n.groupPath,n.hierarchyPath):e;var i;i=t instanceof _.CalcColumnReference||t instanceof _.CalcFieldReference?t.getValue(n.getCurrentRow(),n.groupPath,n.hierarchyPath):t;var a=m.isArray(r),u=m.isArray(i);return a&&u&&r.length===i.length?m.map(r,function(e,t){return o._evaluateSingle(e,i[t],n)}):a||u?a?m.map(r,function(e){return o._evaluateSingle(e,i,n)}):u?m.map(i,function(e){return o._evaluateSingle(r,e,n)}):void 0:o._evaluateSingle(r,i,n)},t}(n);e.BinaryOperator=i,e.add=new i("+",!1),e.add._evaluateSingle=function(e,t,n){if(_.Convert.err(e))return e;if(_.Convert.err(t))return t;e!==te&&e!==ee||(e=0),t!==te&&t!==ee||(t=0);var r={value:0};if(!_.Convert.rD(e,r))return _.CalcErrorsValue;var o={value:0};return _.Convert.rD(t,o)?r.value+o.value:_.CalcErrorsValue},e.subtract=new i("-",!1),e.subtract._evaluateSingle=function(e,t,n){if(_.Convert.err(e))return e;if(_.Convert.err(t))return t;e!==te&&e!==ee||(e=0),t!==te&&t!==ee||(t=0);var r={value:0};if(!_.Convert.rD(e,r))return _.CalcErrorsValue;var o={value:0};return _.Convert.rD(t,o)?r.value-o.value:_.CalcErrorsValue},e.multiply=new i("*",!1),e.multiply._evaluateSingle=function(e,t,n){if(_.Convert.err(e))return e;if(_.Convert.err(t))return t;e!==te&&e!==ee||(e=0),t!==te&&t!==ee||(t=0);var r={value:0};if(!_.Convert.rD(e,r))return _.CalcErrorsValue;var o={value:0};return _.Convert.rD(t,o)?r.value*o.value:_.CalcErrorsValue},e.divide=new i("/",!1),e.divide._evaluateSingle=function(e,t,n){if(t===te||t===ee||""===t||0===t)return _.CalcErrorsDivideByZero;if(_.Convert.err(e))return e;if(_.Convert.err(t))return t;e!==te&&e!==ee||(e=0);var r={value:0};if(!_.Convert.rD(e,r))return _.CalcErrorsValue;var o={value:0};return _.Convert.rD(t,o)?0===o.value?_.CalcErrorsDivideByZero:r.value/o.value:_.CalcErrorsValue},e.exponent=new i("^",!1),e.exponent._evaluateSingle=function(e,t,n){if(_.Convert.err(e))return e;if(_.Convert.err(t))return t;e!==te&&e!==ee||(e=0),t!==te&&t!==ee||(t=0);var r={value:0};if(!_.Convert.rD(e,r))return _.CalcErrorsValue;e=r.value;var o={value:0};return _.Convert.rD(t,o)?(t=o.value,0===e&&0>t?_.CalcErrorsDivideByZero:re(e,t)):_.CalcErrorsValue},e.concatenate=new i("&",!1),e.concatenate._evaluateSingle=function(e,t,n){return _.Convert.err(e)?e:_.Convert.err(t)?t:(e!==te&&e!==ee||(e=""),t!==te&&t!==ee||(t=""),e.toString()+t.toString())},e.and=new i("&&",!1),e.and._evaluateSingle=function(e,t,n){return _.Convert.err(e)?e:_.Convert.err(t)?t:!!e&&!!t},e.or=new i("||",!1),e.or._evaluateSingle=function(e,t,n){return _.Convert.err(e)?e:_.Convert.err(t)?t:!!e||!!t},e.equal=new i("=",!1),e.equal._evaluateSingle=function(e,n,o){if(_.Convert.err(e))return e;if(_.Convert.err(n))return n;if(e!==te&&e!==ee||(e=("undefined"==typeof n?"undefined":r(n))===U?"":0),n!==te&&n!==ee||(n=("undefined"==typeof e?"undefined":r(e))===U?"":0),("undefined"==typeof e?"undefined":r(e))===U||("undefined"==typeof n?"undefined":r(n))===U)return e.toString().toUpperCase()===n.toString().toUpperCase();var i={value:0};if(!_.Convert.rD(e,i))return _.CalcErrorsValue;e=i.value;var a={value:0};if(!_.Convert.rD(n,a))return _.CalcErrorsValue;n=a.value;var u=e,c=n;return t(u,c)},e.notEqual=new i("<>",!1),e.notEqual._evaluateSingle=function(t,n,o){var i=e.equal._evaluateSingle.call(this,t,n,o);return("undefined"==typeof i?"undefined":r(i))===H?!i:i},e.lessThan=new i("<",!1),e.lessThan._evaluateSingle=function(e,n,o){if(_.Convert.err(e))return e;if(_.Convert.err(n))return n;if(e!==te&&e!==ee||(e=0),n!==te&&n!==ee||(n=0),("undefined"==typeof e?"undefined":r(e))===U||("undefined"==typeof n?"undefined":r(n))===U)return e.toString().toUpperCase()<n.toString().toUpperCase();var i={value:0};if(!_.Convert.rD(e,i))return _.CalcErrorsValue;e=i.value;var a={value:0};if(!_.Convert.rD(n,a))return _.CalcErrorsValue;n=a.value;var u=e,c=n;return c>u&&!t(u,c)},e.greaterThan=new i(">",!1),e.greaterThan._evaluateSingle=function(e,n,o){if(_.Convert.err(e))return e;if(_.Convert.err(n))return n;if(e!==te&&e!==ee||(e=0),n!==te&&n!==ee||(n=0),("undefined"==typeof e?"undefined":r(e))===U||("undefined"==typeof n?"undefined":r(n))===U)return e.toString().toUpperCase()>n.toString().toUpperCase();var i={value:0};if(!_.Convert.rD(e,i))return _.CalcErrorsValue;e=i.value;var a={value:0};if(!_.Convert.rD(n,a))return _.CalcErrorsValue;n=a.value;var u=e,c=n;return u>c&&!t(u,c)},e.lessThanOrEqual=new i("<=",!1),e.lessThanOrEqual._evaluateSingle=function(e,n,o){if(_.Convert.err(e))return e;if(_.Convert.err(n))return n;if(e!==te&&e!==ee||(e=0),n!==te&&n!==ee||(n=0),("undefined"==typeof e?"undefined":r(e))===U||("undefined"==typeof n?"undefined":r(n))===U)return e.toString().toUpperCase()<=n.toString().toUpperCase();var i={value:0};if(!_.Convert.rD(e,i))return _.CalcErrorsValue;e=i.value;var a={value:0};if(!_.Convert.rD(n,a))return _.CalcErrorsValue;n=a.value;var u=e,c=n;return c>u||t(u,c)},e.greaterThanOrEqual=new i(">=",!1),e.greaterThanOrEqual._evaluateSingle=function(e,n,o){if(_.Convert.err(e))return e;if(_.Convert.err(n))return n;if(e!==te&&e!==ee||(e=0),n!==te&&n!==ee||(n=0),("undefined"==typeof e?"undefined":r(e))===U||("undefined"==typeof n?"undefined":r(n))===U)return e.toString().toUpperCase()>=n.toString().toUpperCase();var i={value:0};if(!_.Convert.rD(e,i))return _.CalcErrorsValue;e=i.value;var a={value:0};if(!_.Convert.rD(n,a))return _.CalcErrorsValue;n=a.value;var u=e,c=n;return u>c||t(u,c)}}(G.Operators||(G.Operators={}))}()},function(e,t,n){"use strict";!function(){var t;t=n(34).vd,e.exports={vd:t}}()},function(e,t,n){(function(t){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(){function o(e,t){var n,r,o,i="",a=0;for(n=0;n<e.length;n++)a=Math.max(a,e[n].length);for(n=0;a>n;n++){t&&(r="");for(var u=0;u<e.length;u++)t?r+=n>=e[u].length?"00":e[u].charAt(n)+e[u].charAt(n+1):n<e[u].length&&(i+=e[u].charAt(n));t&&(o=parseInt(r,16),i+=String.fromCharCode(o),n++)}return i}function i(e,t){var n,r,o,i,u={isVd:function(e){return !0}},c=h(),l=function(){if(!e)return!1;var u,l,s;if(!(u=e[G])||!u.length)return!1;for(var f=0,h=u.length;h>f;f++)if(l=u[f],s=s||l&&l[k]===t){n=l[B];break}if(!s)return!1;if(e[j]&&(i=e[j]),e[V]){var g=new Date,v=a(e[V]);if(o=Math.ceil((v-g)/864e5),r=0>=o)return!1}else o=void 0;return!!(c||!e[U]&&!e[H]||d(e[U],e[H])||p(e[U],e[H]))};return u[F]=c,u.s=l(e),u[N]=e?e[P]?-1:1:0,u[D]=n,u[M]=r,r||(u[T]=o),u[O]=i,u}function a(e){return new Date(u(e.substr(0,4))||0,u(e.substr(4,2))-1||0,u(e.substr(6,2))||0)}function u(e){return parseInt(e,10)}function c(e,t){var n=C(e);return{ps:n,ct:b(n,e,t),swm:1!==e.m}}function l(e,t){if(!e||0!=e.indexOf("//"))return!1;var n=e.slice(2).split("/");if(n.length<1)return!1;for(var r=n[0],o=0,i=t.length;i>o;o++){var a=t[o];if(a===r)return!0}return!1}function s(e,t){for(var n=0,r=t.length;r>n;n++){var o=t[n],i=!1;if(o&&0===o.lastIndexOf("*.",0)&&(i=!0),o=i?o.slice(2):o,o===e)return!0;if(i){var a=e.indexOf("."+o);if(a>0&&a===e.length-o.length-1)return!0}}return!1}function f(e,t){if(e&&4===e.split(".").length)for(var n=0,r=t.length;r>n;n++){var o=t[n];if(o){var i=o.length-2;if(i>0&&(o===e||".*"===o.substr(i)&&e.substr(0,i)===o.substr(0,i)&&R.test(e)))return!0}}return!1}function d(e,t){if(!_())return!1;var n=L("JYx3Gb#8Pb5R"),r=L("1agFGc#UHbw5"),o=x[n]&&x[n][r];if(o){o=o.toLowerCase();var i=e.split(",");return!(!e||!l(o,i))}return!1}function p(e,t){var n=L("JYx3Gb#8Pb5R"),r=L("Zdg3Ga#UHbw5"),o=x[n]&&x[n][r];if(o){o=o.toLowerCase();var i=e.split(",");return e&&s(o,i)?!0:!(!e||!f(o,i))}return!0}function h(){var e=L("JYx3Gb#8Pb5R");return g(x[e])}function g(e){var t=L("VdgJHc#wJb59"),n=L("Zdg3Ga#UHbw5");return e&&(v(e[t])||m(e[t])||y(e[n]))}function v(e){var t=L("MlSZto#Z");return e&&e===t}function m(e){var t=L("yXbog&w");return e&&e===t}function _(){var e=L("JYx3Gb#8Pb5R"),t=L("VdgJHc#wJb59"),n=L("Udg36Y#oUddV"),r=x[e];return r&&r[t]===n}function y(e){var t=L("4LJITMx8UMcA"),n=L("jOxo"),r=L("JYw3Gb4NOb6x"),o=L("g1Jbww#Y"),i=new RegExp("^[\\w\\-]+\\."+o+"$","i");return e&&(e===t||e===n||e===r||E.test(e)||i.test(e))}function C(e){return e&&(e.isVd(!1)||e.b&&!e.hl)}function b(e,t,n){var r,o,i;return i=S(r,o,t,n)}function S(e,t,n,r){var i,a=!0,u="",c=r([o([e,"s"])]);if(c)if("string"==typeof c)c=c.trim(),c&&(i=[c]);else if(Array.isArray(c)){var l=!0;i=[];for(var s=0;s<c.length;s++)u=c[s].trim(),i.push(u),l&&u&&(l=!1);l&&(i=null)}i||(a=!1,i=t);var f=o(i,a);f=f.replace("{0}",n.d);var d=[],p=0;for(s=0;s<f.length;s++)"\r"!==f[s]&&"\n"!==f[s]||(d.push(f.substring(p,s)),"\r"===f[s]&&s<f.length-1&&"\n"===f[s+1]&&s++,p=s+1);return p<f.length&&d.push(f.substring(p,f.length)),d}var w="object"==("undefined"==typeof t?"undefined":r(t))&&t&&t.Object===Object&&t,I="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,x=w||I||Function("return this")(),A=n(35).cl,E=/^[\w\-]+$/i,R=/^[0-9.]+$/,N="m",D="n",F="b",T="d",M="e",O="adr",L=A.iDe,P=L("XRsZ"),G=L("HUkJ"),B=L("T&g"),k=L("Q&w"),U=L("GRz1"),H=L("XSzB"),V=L("XRwh"),j=L("WQs5"),W=function(e,t){var n,r=o(["Lcnee","iesKy"]),a=e.lic(r),u="B9FI";A.attorn(a,{pK:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w==",aC:"B0"},function(r){n=i(r,u),n.hl=!!a,t(c(n,e.rs))},function(){n=i(),n.hl=!!a,t(c(n,e.rs))})};e.exports={vd:W}}()}).call(t,function(){return this}())},function(e,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},r=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="dist",t(0)}([function(e,t){(function(e){function r(e){var t;if("number"==typeof e){t=new Array(e);for(var n=0;e>n;++n)t[n]=0}else t=e.slice(0);return t.buffer=t,t.byteLength=t.length,"object"===("undefined"==typeof e?"undefined":S(e))&&e.buffer&&(t.buffer=e.buffer),t}function o(e,t,n,r){return 1==e.length?e:(e.splice(n,1,r(e.splice(t,1,r(e[n]))[0])),e)}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.charCodeAt(0);return n>=65&&90>=n?e.toLowerCase():n>=97&&122>=n?e.toUpperCase():n>=48&&57>=n?I(48+(n-48+10+t)%10):e}function a(e){for(var t=e.split(""),n=function(e){return i(e,-1)},r=t.length-5;r>=0;r--)o(t,r+1,r+3,n),o(t,r,r+2,n);return t.join("")}function u(e){return e.split("").reverse().join("")}function c(e){var t,n,r,o,i,a,u,c,l,s,f,d=[],p="",h=A;if(s=e,l=s.length%3,l>0)for(;l++<3;)p+="=",s+="\x00";for(l=0;l<s.length;l+=3)t=s.charCodeAt(l),n=s.charCodeAt(l+1),r=s.charCodeAt(l+2),o=t<<16|n<<8|r,i=o>>18&63,a=o>>12&63,u=o>>6&63,c=63&o,d[l/3]=h.charAt(i)+h.charAt(a)+h.charAt(u)+h.charAt(c);return f=d.join(""),f=f.slice(0,f.length-p.length)+p}function l(e){var t,n,r,o,i,a,u,c,l,s,f=[],d=A;s=e;for(var p=0;p<s.length;p+=4)o=d.indexOf(s.charAt(p)),i=d.indexOf(s.charAt(p+1)),a=d.indexOf(s.charAt(p+2)),u=d.indexOf(s.charAt(p+3)),c=o<<18|i<<12|a<<6|u,t=c>>>16&255,n=c>>>8&255,r=255&c,f[p/4]=I(t,n,r),64==u&&(f[p/4]=I(t,n)),64==a&&(f[p/4]=I(t));return l=f.join("")}function s(e){return(w&&window.atob||l)(e)}function f(e){return(w&&window.btoa||c)(e)}function d(e){return decodeURIComponent(Array.prototype.map.call(s(e),function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function p(e){return f(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return I(parseInt(t,16))}))}function h(e){if(!e)return"";var t=a(e);t=u(t);var n=Math.ceil(t.length/2);return t=t.substr(n)+t.substr(0,n),t=t.replace("#","="),t=t.replace("&","=="),
d(t)}function g(e){for(var t=s(e),n=t.length,r=new x(n),o=0;n>o;o++)r[o]=t.charCodeAt(o);return r.buffer}function v(e){for(var t=new ArrayBuffer(e.length),n=new x(t),r=0,o=e.length;o>r;r++)n[r]=e.charCodeAt(r);return t}function m(e){return I.apply(null,new x(e))}function _(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")}function y(e){for(var t=0,n=5381,r=0,o=e.length-1;o>=0;o--){var i=e.charCodeAt(o);t=i+(t<<6)+(t<<16)-t,n=i+((n<<5)+n),r=i+((r<<5)-r),r&=r}var a=t^n^r;return 0>a&&(a=~a),a.toString(16).toUpperCase()}function C(e,t){try{t="#"+t;var n=e.indexOf(t);if(n>-1)return{prefix:e.substring(0,n),licData:JSON.parse(h(e.substr(n+t.length)))}}catch(r){}return!1}function b(e){return"oncomplete"in e&&(e.then=function(t,n){e.resolve=t,e.reject=n},e.oncomplete=function(t){e.resolve(e.result)},e.onerror=function(){e.reject()}),e}Object.defineProperty(t,"__esModule",{value:!0});var S="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":n(e)},w="undefined"!=typeof window,I=String.fromCharCode,x=w&&window.Uint8Array||r,A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",E="object"==("undefined"==typeof e?"undefined":S(e))&&e&&e.Object===Object&&e,R="object"==("undefined"==typeof self?"undefined":S(self))&&self&&self.Object===Object&&self,N=E||R||Function("return this")();t.iDe=h,t.attorn=function(e,t,n,r){function o(){return y(c+JSON.stringify(u.D))===u.H?n(u.D):r()}var i=w?window.msCrypto?window.msCrypto:window.crypto:void 0,a=C(e,t.aC);if(!a)return r();var u=a.licData,c=a.prefix+"#"+t.aC,l=c+m(g(p(JSON.stringify(u.D)))),s=h("JYx3Gb#8Pb5R"),f=h("VdgJHc#wJb59");if(N[s]&&N[s][f]&&!location.protocol.match(/^https/i))return o();if(!i||!i.subtle)return o();var d={alg:"RS256",e:"AQAB",kty:"RSA",n:_(t.pK)};d=window.msCrypto?v(JSON.stringify(d)):d;var S={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};b(i.subtle.importKey("jwk",d,S,!1,["verify"])).then(function(e){b(i.subtle.verify(S,e,g(u.S),v(l))).then(function(e){return e?n(u.D):r()})},function(){return o()})}}).call(t,function(){return this}())}]);e.exports={cl:r}}])});