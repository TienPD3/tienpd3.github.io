/*!
 * 
 * SpreadJS Library 16.0.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Outlines=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/group/group.entry.js")}({"./dist/plugins/group/group-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),b.Commands=e.Commands,f=c("./dist/plugins/group/group.js"),g=e.Commands.ActionBase,h=e.GC$,i="outlineColumn",j="removeColumnOutline",k="expandColumnOutline",l="expandColumnOutlineForLevel",m="outlineRow",n="removeRowOutline",o="expandRowOutline",p="expandRowOutlineForLevel",q=d.Common.j.Fa;function F(a){var b=a.kj;return a.ML?b.rowOutlines:b.columnOutlines}function G(a){var b,c,d,e,f,g=this,h=!1;return(a?g.canExecute():g.canUndo())&&(b=g.kj,c=g.VQ.index,d=g.VQ.count,e=F(g),b&&e&&!q(c)&&!q(d)&&(f=a?e.group:e.ungroupRange,g.Lz(b,!0),f.call(e,c,d),g.Mz(b,!0),h=!0)),h}r=function(a){E(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.ML=d,e}return b.prototype.execute=function(){var a,b,c=this,d=c.kj,f=c.VQ,g=d.ITa;return g.startTransaction(),a=G.call(c,!0),b=e.Commands.bWa(d.name()),f[b]=g.endTransaction(),a},b.prototype.undo=function(){return G.call(this,!1)},b}(g),s=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!1)||this}return b}(r),t=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!0)||this}return b}(r),u=function(a){E(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.ML=d,e}return b.prototype.execute=function(){var a,b,c,d,f,g=this,h=g.kj,i=h.ITa,j=!1;return g.canExecute()&&(a=g.VQ,b=a.index,c=a.count,d=F(g),h&&d&&!q(b)&&!q(c)&&(i.startTransaction(),g.Lz(h,!0),d.ungroupRange(b,c),g.Mz(h,!0),f=e.Commands.bWa(h.name()),a[f]=i.endTransaction(),j=!0)),j},b.prototype.undo=function(){var a,b,c=this,d=!1,f=c.kj;return c.canUndo()&&(a=e.Commands.bWa(f.name()),b=c.VQ[a],f&&b&&(c.Lz(f,!0),f.ITa.undo(b),c.Mz(f,!0),d=!0)),d},b}(g),v=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!1)||this}return b}(u),w=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!0)||this}return b}(u);function H(a,b,c,d,e){var f=0,g;for(g=b;g<=c&&g<d;g++)f+=e.call(a,g)*a.zoom();return f}function I(a,b,c,d,e){var f=0,g;for(g=b;g<d&&f<c;g++)b++,f+=e.call(a,g)*a.zoom();return b>=d?d-1:b}function J(a,b,c,d,e){if(b<d)return d;if(b>e)return e;for(var f=b;f<=e;f++)if(c.call(a,f))return f;return-1}function K(a,b,c){var d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this,w=v.kj,x=c.index,y=b?w.getRowCount():w.getColumnCount(),z=void 0,A=F(v),B=A.u2J;x<0||x>=y||B||(d=1===A.direction(),e=d?x-1:x+1,f.isIndexValid(A,e)&&(g=w.am(),h=b?w.frozenRowCount():w.frozenColumnCount(),i=b?w.frozenTrailingRowCount():w.frozenTrailingColumnCount(),j=b?g.uNc:g.xNc,k=b?w.BBJ:w.CBJ,l=b?w.getRowHeight:w.getColumnWidth,m=b?w.getViewportTopRow:w.getViewportLeftColumn,n=b?w.getViewportHeight:w.getViewportWidth,o=m.call(w,1),s=A.find(e,c.level),s&&(t=d?s.start:x,u=d?x:s.end,d?(a?t=x:t<h&&(t=h),t<o&&(o=t),u>=y-i&&(u=y-i-1),p=n.call(w,1),p+=k?0:j,q=H(w,o,u,y,l),q>p&&(o=I(w,o,q-p,y,l)),r=J(w,o,l,h,y-1)):(a?u=x:u>=y&&(u=y-1),u>=y-i&&(u=y-i-1),t<o?r=J(w,t,l,h,y-1):(p=n.call(w,1),p+=k?0:j,q=H(w,o,u,y,l),q>p&&(r=J(w,t,l,h,y-1)))),b&&r!==z?(w.lq=r,w.os()):b||r===z||(w.qq=r,w.qs()))))}function L(a){var b,c,d,e,g,h,i,j=this,k=!1;return(a?j.canExecute():j.canUndo())&&(b=j.kj,c=j.VQ,d=F(j),e=c.collapsed,g=c.index,h=c.level,!b||!d||q(e)||q(g)||q(h)||(j.Lz(b,!0),a||(e=!e),i=1===d.direction()?d.find(g-1,h):d.find(g+1,h),i&&d.setCollapsed(g,e),q(c.index)&&(c.index=f.getExtendIndex(b,j.ML,h)),K.call(j,e,j.ML,c),j.Mz(b,!0),k=!0)),k}x=function(a){E(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.ML=d,e}return b.prototype.canExecute=function(){var a,b,c=this,d=c.kj,e=d.ODJ;return!e||(a=c.VQ.level,b=F(c),e.detailColumnsVisible()||a<b.getMaxLevel())},b.prototype.execute=function(){var a,b,c=this,d=c.kj,f=c.VQ,g=d.ITa;return g.startTransaction(),a=L.call(c,!0),b=e.Commands.bWa(d.name()),f[b]=g.endTransaction(),a},b.prototype.undo=function(){return L.call(this,!1)},b}(g),y=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!1)||this}return b}(x),z=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!0)||this}return b}(x),A=function(a){E(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.ML=d,e}return b.prototype.canExecute=function(){var a,b,c=this,d=c.kj,e=d.ODJ;return!e||(a=c.VQ.level,b=F(c),e.detailColumnsVisible()||a<=b.getMaxLevel())},b.prototype.execute=function(){var a,b,c,d,g,h,i=this,j=i.kj,k=!1;if(i.canExecute()&&(a=void 0,b=i.VQ.level,c=F(i),j&&c&&!q(b))){for(j.ITa.startTransaction(),i.Lz(j,!0),j.suspendCalcService(),j.ITa.vUa(i.ML),c.Lia(),a=0;a<b;a++)c.expand(a,!0,!0);c.expand(b,!1,!0),c.Mia(),j.ITa.vUa(i.ML,!0),d=i.VQ.index,q(d)&&(d=f.getExtendIndex(j,i.ML,b)),K.call(i,!1,i.ML,{level:b-1,index:d}),g=j.getCalcService(),g.H9J="filter",j.recalcRange(0,0,j.getRowCount(),j.getColumnCount()),delete g.H9J,j.resumeCalcService(!1),g.F9J(),i.Mz(j,!0),h=e.Commands.bWa(j.name()),i.VQ[h]=j.ITa.endTransaction(),k=!0}return k},b.prototype.undo=function(){var a,b,c,d=this,f=!1;return d.canUndo()&&(a=d.kj,b=e.Commands.bWa(a.name()),c=d.VQ[b],a&&c&&(d.Lz(a,!0),a.ITa.undo(c),f=!0,d.Mz(a,!0))),f},b}(g),B=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!1)||this}return b}(A),C=function(a){E(b,a);function b(b,c){return a.call(this,b,c,!0)||this}return b}(A),D=e.Commands.h4,e.Commands[i]={canUndo:!0,execute:function(a,b,c){return D(a,s,b,c)}},e.Commands[m]={canUndo:!0,execute:function(a,b,c){return D(a,t,b,c)}},e.Commands[j]={canUndo:!0,execute:function(a,b,c){return D(a,v,b,c)}},e.Commands[n]={canUndo:!0,execute:function(a,b,c){return D(a,w,b,c)}},e.Commands[k]={canUndo:!0,execute:function(a,b,c){return D(a,y,b,c)}},e.Commands[o]={canUndo:!0,execute:function(a,b,c){return D(a,z,b,c)}},e.Commands[l]={canUndo:!0,execute:function(a,b,c){return D(a,B,b,c)}},e.Commands[p]={canUndo:!0,execute:function(a,b,c){return D(a,C,b,c)}},e.Commands.SL=function(a){a.register(i,e.Commands[i]),a.register(m,e.Commands[m]),a.register(j,e.Commands[j]),a.register(n,e.Commands[n]),a.register(k,e.Commands[k]),a.register(o,e.Commands[o]),a.register(l,e.Commands[l]),a.register(p,e.Commands[p])}},"./dist/plugins/group/group.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/group/group-actions.js")),d(c("./dist/plugins/group/group.js")),d(c("./dist/plugins/group/group.ns.js"))},"./dist/plugins/group/group.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("./dist/plugins/group/group-actions.js"),g=c("./dist/plugins/group/group.ns.js"),h={},i=null,j=void 0,k=Math.max,l=Math.min,m=Math.round,n=Math.ceil,o=e.GC$,p=o.each,q=e.Im.Lm,r=d.Common.k,s=r._b,t=r.$b,u=r.ac,v=8.25,w=17,x=4,y=e.Ul.Ol,z=d.Common.j.Fa,A=e.Ul.Pl,B=e.Ul.fp,C=e.Ul.IcK,D=e.Ul.JcK,E=e.Ul.McK,F="rangegroup",G="gc-group",H=G+"-box",I=H+"-expand",J=H+"-collapsed",K=G+"-line",L=G+"-dot",M="rgh",N="cgh",O="rg",P="cg",Q=e.XFileConstants.AbK,R=e.XFileConstants.HbK,S="1",T="0",U=new d.Common.ResourceManager(g.SR,"Outlines"),b.getSR=U.getResource.bind(U),V=e.NodeHelper.oca,W={Gt:function(){var a,b,c,d,e,f,g,h=this,i=h.TL;return i?i:(a=h.options,b=a.sheetAreaOffset,c={x:b.left,y:b.top,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},d=h.rowOutlines,e=h.columnOutlines,f=w*h.zoom(),h.showRowOutline()&&d&&!d.iT()&&(g=d.getMaxLevel(),g>=0&&(c.width=f*(g+2)+x,c.rowMaxLevel=g)),h.showColumnOutline()&&e&&!e.iT()&&(g=e.getMaxLevel(),g>=0&&(c.height=f*(g+2)+x,c.colMaxLevel=g)),h.TL=c,c)},showRowOutline:A("showRowOutline",!0,function(){this.$p()}),showColumnOutline:A("showColumnOutline",!0,function(){this.$p()})},o.extend(e.Worksheet.prototype,W);function ea(a,b){a.Wq(e.Events.RangeGroupStateChanging,b)}function fa(a,b){a.Wq(e.Events.RangeGroupStateChanged,b)}function ga(a,b){var c,d=a.options,e=d.isProtected;return!e||(c=d.protectionOptions,b?c.allowOutlineRows:c.allowOutlineColumns)}function ha(a,c){var d,f,g,h,i=c.what===M,j=ga(a,i);a.isEditing&&a.isEditing()||!j?j||a.Os(e.InvalidOperationType.groupProtected,b.getSR().Exp_GROUP_PROTECTED):(d=c.info.index,f=i?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",g=ja(a,i,-1,d,!0),ea(a,g),h=ka(a,i,d-1),g&&g.cancel===!1&&(a.wu().execute({cmd:f,sheetName:a.name(),level:d,index:h}),fa(a,ja(a,i,-1,d,!1))))}function ia(a,c){var d,f,g,h,i,j,k=c.what===O,l=ga(a,k);a.isEditing&&a.isEditing()||!l?l||a.Os(e.InvalidOperationType.groupProtected,b.getSR().Exp_GROUP_PROTECTED):pa(k,a)&&(d=c.info,f=d.index,g=f,h=d.level,i=void 0,j=k?"expandRowOutline":"expandColumnOutline",1===d.lineDirection?f--:f++,i=ja(a,k,f,h,!0),ea(a,i),i&&i.cancel===!1&&(a.wu().execute({cmd:j,sheetName:a.name(),index:g,level:h,collapsed:d.isExpanded}),fa(a,ja(a,k,f,h,!1))))}function ja(a,b,c,d,e){var f={sheet:a,sheetName:a.name(),isRowGroup:b,index:c,level:d};return e&&(f.cancel=!1),f}function ka(a,b,c){var d,e,f,g=b?a.rowOutlines:a.columnOutlines;if(g)for(d=g.items,e=!1,f=0;f<d.length;f++)if(d[f])if(d[f].level===c)e=!0;else if(e)return f;return b?a.getActiveRowIndex():a.getActiveColumnIndex()}b.getExtendIndex=ka;function la(a,b){var c,d,f,g,h=this,j=h.Gt(),k=j.width,l=j.height;return k||l?(c=h.am(),d=new e.Rect(j.x,j.y,k,c.height),f=new e.Rect(j.x,j.y,c.width,l),d.contains(a,b)||f.contains(a,b)?(g=ma(h,a,b,j.rowMaxLevel,!0),g||(g=ma(h,a,b,j.colMaxLevel,!1)),g||{what:"empty",info:i}):i):i}X=function(){function a(a,b,c){var d=this;d.PADDING=2,d.kj=a,d.ML=b,d.ZL=y(c)?c:pa(b,a).getMaxLevel()}return a.prototype._L=function(a){var b,c,d,e,f,g,h,i,j,l,n,o,p,r,s,t,u,w,x,y,z,A,C,D,E,F,I,J=this,K=J.kj,L=J.ZL;if(!(L<0)&&(b=J.ML,c=K.Gt(),d=oa.call(J,c,b),d)){if(e=L+2,f=J.PADDING,g=K.options,h=c.width,i=c.height,j=c.x,l=c.y,n=K.am(),o=n.width,p=n.height,r=n.Cr,s=n.Br,t=n.zr,u=n.Ar,a.save(),a.fillStyle=q(G).backgroundColor,a.strokeStyle=q(G).borderTopColor,a.lineWidth=1,a.fillRect(j,l,b?h:o,b?p:i),a.strokeRect(j-.5,l-.5,b?h:o+1,b?p+1:i),b?a.strokeRect(j-.5,u-.5,h,r):a.strokeRect(t-.5,l-.5,s,i),w=(b?r:s)-d,y=k(0,(b?u-g.sheetAreaOffset.top:t-g.sheetAreaOffset.left)+w/2),z=f,b&&(C=y,y=z,z=C),a.restore(),x=b?g.colHeaderVisible:g.rowHeaderVisible,a.save(),x&&w>=0)for(A=0;A<e;A++)D=d-1,E=void 0,F=j+y,I=l+z,b?F=m(F)+.5:I+=.5,a.fillStyle=q(H).backgroundColor,a.fillRect(F,I,D,D),a.font=v*K.zoom()+"pt Arial",a.strokeStyle=q(H).borderTopColor,a.strokeRect(F,I,D,D),a.fillStyle=q(H).color,E=B(a.font),J.pM(a,F,I,D,d,A+1,E),b?y+=d:z+=d;a.restore()}},a.prototype.pM=function(a,b,c,d,e,f,g){var h=""+f,i=a.measureText(h).width;i<=d&&g<=e&&(a.textBaseline="middle",a.fillText(h,b+(d-i)/2,c+d/2))},a.prototype.WL=function(a,b,c){var d,e,f,g,h=this,j=h.kj,k=h.ZL;return k<0?i:(d=k+2,e=j.am(),f=j.options,g=f.sheetAreaOffset,c?h.qM(j,a,b,c,f.colHeaderVisible,e.Cr,e.Ar-g.top,d):h.qM(j,a,b,c,f.rowHeaderVisible,e.Br,e.zr-g.left,d))},a.prototype.qM=function(a,b,c,d,f,g,h,j){var l,m,n,o,p,q=this,r=a.Gt(),s=oa.call(q,r,d),t=g-s;if(s&&f&&t>=0)for(l=k(0,h+t/2),m=q.PADDING,d&&(p=l,l=m,m=p),o=0;o<j;o++){if(n=new e.Rect(r.x+l,r.y+m,s,s),n.contains(b,c))return{index:o};d?l+=s:m+=s}return i},a}(),Y=function(){function a(a,b,c,d){var e=this;e.PADDING=2,e.LINE_SIZE=2,e.START_LINE_SIZE=6,e.bM=[],e.cM=[],e.dM=[],e.kj=a,e.ML=b,e.eM=c,e.ZL=y(d)?d:pa(b,a).getMaxLevel()}return a.prototype.YL=function(){var a,b=this;b.ZL!==-1&&(a=b.fM(0,b.ML),p(a,function(a,c){b.gM(c)}))},a.prototype.gM=function(a){var b,c,d,e,f,g,h,j,m,n,o,q,r,s,t,v,w,x,y=this,z=y.kj,A=y.ML,B=pa(A,z).direction(),C=1===B,D=0===B,E=y.hM(!0,A),F=y.hM(!1,A),G=a.start,H=a.end,I=a.level;if(C?b=H+1:D&&(b=G-1),0===a.state()){if(c=!0,d=a.parent,d&&(D&&G===d.start||C&&H===d.end)&&(c=!1),c&&y.iM(!0,I,b,E,F,B),G<=F&&H>=E){for(e=k(E,G),f=l(F,H),g=void 0,h=void 0,c&&(g={start:e,end:f,level:I,startLine:i},(C&&e===G||D&&f===H)&&(g.startLine=!0),y.bM.push(g)),m=[],n=a.children,h=e;h<=f;h++)m.push(!1);for(p(n,function(a,b){var c=b.start,d=b.end,f;if(1===b.state())for(j=c;j<=d;j++)m[j-e]=!0;f=C?d+1:d-1,m[f-e]=!0,y.gM(b)}),o=!0,h=0;h<u(n);h++){if(q=n[h],r=q.start,s=q.end,t=r===G,v=s===H,t&&v){o=!1;break}if(C&&v||D&&t)for(j=r;j<=s;j++)m[j-e]=!0}if(o)for(w=e;w<=f;w++)m[w-e]||(x={index:w,level:I+1},y.cM.push(x))}}else 1===a.state()&&y.iM(!1,I,b,E,F,B)},a.prototype.iM=function(a,b,c,d,e,f){var g={isExpanded:a,level:b};a&&(g.paintLine=!0),c>=d&&c<=e&&(g.index=c,g.lineDirection=f,this.dM.push(g))},a.prototype.jM=function(a){var b=this,c=b.kj,d=b.eM;return b.ML?c.Gr(d).findRow(a):c.Hr(d).findCol(a)},a.prototype.aM=function(a){var b,c,d,e,f,g,h,i,j,k,l,n,o,p=this;p.ZL!==-1&&(b=p.kj,c=b.Gt(),d=p.ML,e=oa.call(p,c,d),e&&(f=parseInt(q(K).borderTopWidth,10),f=isNaN(f)?2:f,g=m(e/3),h=p.PADDING,i=(e-f)/2+h,a.save(),a.fillStyle=q(G).color,j=b.am(),k=0,l=0,n=c.width,o=c.height,d?(l+=j.y+j.Cr,o=j.height-j.Cr):(k+=j.x+j.Br,n=j.width-j.Br),a.rect(k,l,n,o),a.clip(),p.kM(a,p.cM,d,c,e,i,f),d?p.D_a(a,p.bM,d,c,e,i,f,g):p.E_a(a,p.bM,d,c,e,i,f,g),p.mM(a,p.dM,d,c,e,i,f,h),a.beginPath(),a.restore()))},a.prototype.kM=function(a,b,c,d,e,f,g){var h,i,j,l=this,m=2,n=l.kj,o=n.options,r=o.sheetAreaOffset,s=r.left,t=r.top;a.save(),a.fillStyle=q(L).color,j=l.bM,p(b,function(b,n){var o,p,q,r,u,v=n.index,w=n.level,x=l.jM(v);x&&(l.C0a(j,v,w)||(o=c?x.y:x.x,p=(c?x.height:x.width)-g,p>=0&&(h=o+k(0,p/2),i=n.level*e+f,c?(q=h,h=i+.5,i=q,i-=t):(i+=.5,h-=s),a.strokeStyle="transparent",a.lineWidth=0,r=d.x+h,u=d.y+i,r%1!==0&&(r+=.5),u%1!==0&&(u+=.5),a.strokeRect(r,u,m,m),a.fillRect(r,u,m,m))))}),a.restore()},a.prototype.C0a=function(a,b,c){var d,e=!1,f=u(a);for(d=0;d<f;d++)if(a[d].level===c&&a[d].start<=b&&a[d].end>=b){e=!0;break}return e},a.prototype.D_a=function(a,b,c,d,e,f,g,h){var i,j,l,m,o,p,r,s,t,v,w,x,y,z,A,B,C;for(a.save(),a.strokeStyle=q(K).borderTopColor,a.fillStyle=q(K).borderTopColor,a.lineWidth=g,i=this,j=i.kj,l=pa(c,j).direction(),o=j.options,p=o.sheetAreaOffset,r=p.top,m=0;m<u(b);m++){s=b[m],t=s.start,v=s.end,w=void 0,x=void 0;do w=i.jM(t),t++;while(!w&&t<=v);do x=i.jM(v),v--;while(!x&&v>=t);(w||x)&&(w?x||(x=w):w=x,y=w.y,z=s.level*e+f,A=g,B=k(0,x.y+x.height-w.y),1===l?y+=1:y-=1,y-=r,a.beginPath(),C=d.x+z+A/2,C=n(C),a.moveTo(C,d.y+y),a.lineTo(C,d.y+y+B),a.stroke(),s.startLine&&e/2-2*g>0&&(0===l&&(y=y+B-g-r),y>=w.y-r&&y<x.y+x.height-r&&a.fillRect(n(d.x+z),d.y+y,h,g)))}a.restore()},a.prototype.E_a=function(a,b,c,d,e,f,g,h){var i,j,l,m,o,p,r,s,t,v,w,x,y,z,A,B;for(a.save(),a.strokeStyle=q(K).borderTopColor,a.fillStyle=q(K).borderTopColor,a.lineWidth=g,i=this,j=i.kj,l=pa(c,j).direction(),o=j.options,p=o.sheetAreaOffset,r=p.left,m=0;m<u(b);m++){s=b[m],t=s.start,v=s.end,w=void 0,x=void 0;do w=i.jM(t),t++;while(!w&&t<=v);do x=i.jM(v),v--;while(!x&&v>=t);(w||x)&&(w?x||(x=w):w=x,y=w.x,z=s.level*e+f,A=k(0,x.x+x.width-w.x),1===l&&(y+=1),y-=r,B=d.y+z+g/2,B=n(B),a.beginPath(),a.moveTo(d.x+y,B),a.lineTo(d.x+y+A,B),a.stroke(),s.startLine&&e/2-2*g>0&&(0===l&&(y=y+A-g-r),y>=w.x-r&&y<x.x+x.width-r&&a.fillRect(d.x+y,n(d.y+z),g,h)))}a.restore()},a.prototype.r0a=function(a){var b=q(a).backgroundImage;return"none"===b&&(b=""),b&&(b=b.split(",")[0],b=b.replace(/url\(['"]?([^'"\)]+)['"]?\)/,"$1"),b=b.trim()),b},a.prototype.mM=function(a,b,c,d,e,f,g,h){var i,j,m,o,p,r,s,t,v,w,x,y,z,A,B,C,D,E,F,G,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z=this,$=Z.kj,_=$.options,aa=_.sheetAreaOffset.left,ba=_.sheetAreaOffset.top,ca=q(H).borderTopColor,da=q(H).backgroundColor,ea=q(H).color,fa=q(K).borderTopColor,ga=1,ha=$.vu(),ia=Z.r0a(I),ja=Z.r0a(J);for(ia&&!ha.ko(ia)&&ha.fo(ia),ja&&!ha.ko(ja)&&ha.fo(ja),j=ja&&ha.lo(ja),m=ia&&ha.lo(ia),o=q(I),p=q(J),r=m?o.backgroundColor:"",s=j?p.backgroundColor:"",t=m?o.borderTopColor:"",v=j?p.borderTopColor:"",i=0;i<u(b);i++)a.save(),A=b[i],B=Z.jM(A.index),B?(C=c?B.height:B.width,C<=0?a.restore():(D=k(0,(C-e)/2),E=void 0,F=void 0,G=(c?B.y-ba:B.x-aa)+D,L=A.level*e+h,M=l(e,C),N=e,O=void 0,P=void 0,Q=C-M,c?(R=G,G=L,L=R,S=M,M=N,N=S,O=.5,P=0):(O=0,P=.5),y=A.isExpanded?t:v,a.strokeStyle=y?y:ca,a.lineWidth=ga,x=A.isExpanded?r:s,x?a.fillStyle=x:a.fillStyle=da,a.fillRect(d.x+G,d.y+L,M,N),E=d.x+G+O,F=d.y+L+P,a.strokeRect(E,F,M,N),a.fillStyle=ea,w=A.isExpanded?ia:ja,Z.nM(a,A.isExpanded,w,E,F,M,N),a.restore(),A.paintLine&&Q>0&&(a.save(),a.strokeStyle=fa,G=c?B.y-ba:B.x-aa,L=A.level*e+f,T=0===A.lineDirection,U=c?g:D,V=c?D:g,c?(W=G,G=L,L=W,T&&(L+=D+N,V=Q-D)):T&&(G+=D+M,U=Q-D),a.beginPath(),a.lineWidth=g,X=n(d.x+G+g/2),Y=n(d.y+L+g/2),c?(a.moveTo(X,d.y+L),a.lineTo(X,d.y+L+V-ga)):(z=0,j&&!A.isExpanded&&(z=1),a.moveTo(d.x+G,Y),a.lineTo(d.x+G+O+U+z,Y)),a.stroke(),a.restore()))):a.restore()},a.prototype.nM=function(a,b,c,d,e,f,g){var h,i,j,k=this,l=this.kj,n=l.vu();if(c&&n.ko(c)){h=n.lo(c),i=h.width,j=h.height;try{a.drawImage(h,0,0,i,j,m(d),m(e),f-1,g-1)}catch(a){}}else k.u0a(a,b,d,e,f,g)},a.prototype.u0a=function(a,b,c,d,e,f){var g,h,i=m(e/4),j=m(e/2);b||(g=m(f/4),h=m(f/2),a.fillRect(c+e/2-1,d+g,2,f-h)),a.fillRect(c+i,d+f/2-1,j,2)},a.prototype.fM=function(a,b){var c,d,e,f=this,g=f.kj,h=[],i=-1,j=-1,m=pa(b,g),n=b?g.Gr:g.Hr,o=n.call(g,f.eM),p=u(o);for(p&&(d=o[0],e=o[p-1],i=k(0,(b?d.row:d.col)-1),j=b?l(g.getRowCount(),e.row+2):l(g.getColumnCount(),e.col+2));i<j;)c=m.find(i,a),c?(i=c.end+1,h.push(c)):i++;return h},a.prototype.hM=function(a,b){var c=-1,d=this,e=d.kj,f=d.eM,g=e.frozenRowCount(),h=e.frozenColumnCount(),i=e.frozenTrailingRowCount(),j=e.frozenTrailingColumnCount(),k=e.getRowCount(),l=e.getColumnCount();return 0===f?c=a?0:(b?g:h)-1:1===f?c=a?b?g:h:(b?k-i:l-j)-1:2===f&&(c=a?b?k-i:l-j:(b?k:l)-1),c},a.prototype.oM=function(a){a&&this.kj.CH&&(a.x-=2,a.y-=2,a.width+=4,a.height+=4)},a.prototype.XL=function(a,b,c){var d,f,g,h,j,m,n,o,p,q,r,s,t,v,w,x,y=this,z=y.ZL,A=y.kj,B=A.options,C=B.sheetAreaOffset.left,D=B.sheetAreaOffset.top;if(z<0)return i;if(d=A.Gt(),f=oa.call(y,d,c),!f)return i;for(g=y.dM,m=0;m<u(g);m++)if(n=g[m],o=n.index,p=n.level*f+y.PADDING,q=y.jM(o),q&&(h=c?q.height:q.width,!(h<=0)&&(r=l(f,h),s=f,t=(c?q.y-D:q.x-C)+k(0,(h-f)/2),v=p,c&&(w=r,r=s,s=w,x=t,t=v,v=x),j=new e.Rect(d.x+t+.5,d.y+v+.5,r,s),y.oM(j),j.contains(a,b))))return n;return i},a}();function ma(a,b,c,d,e){var f,g,h=new X(a,e,d),j=h.WL(b,c,e);if(j)return{what:e?M:N,info:j};for(f=na(a,e,d),g=0;g<=2;g++)if(j=f[g].XL(b,c,e))return{what:e?O:P,info:j};return i}function na(a,b,c){var d=[new Y(a,b,0,c),new Y(a,b,1,c),new Y(a,b,2,c)],e;for(e=0;e<=2;e++)d[e].YL();return d}function oa(a,b){var c=b?a.width:a.height;return k(0,(c-2*this.PADDING)/(this.ZL+2))}function pa(a,b){return a?b.rowOutlines:b.columnOutlines}!function(a){a[a.backward=0]="backward",a[a.forward=1]="forward"}(Z=b.OutlineDirection||(b.OutlineDirection={})),h.OutlineDirection=Z,function(a){a[a.expanded=0]="expanded",a[a.collapsed=1]="collapsed"}($=b.OutlineState||(b.OutlineState={})),h.OutlineState=$,_=function(){function a(a,b,c,d){var e=this;e.children=[],e.parent=i,e.model=a,e.start=b,e.end=c,e.level=d}return a.prototype.state=function(a){var b=this,c=b.model;return arguments.length?void(c&&c.expandGroup(b,0===a)):c?c.getState(b):0},a.prototype.contains=function(a){return this.start<=a&&a<=this.end},a.prototype.addChild=function(a){a&&(this.children.push(a),a.parent=this)},a}(),b.OutlineInfo=_,h.OutlineInfo=_,aa=function(){function a(a){this.level=a?a.level:0,this.collapsed=!!a&&a.collapsed,this.viewCollapsed=!!a&&a.viewCollapsed}return a}();function qa(a,b,c){var d,e,f,g;if(c>0){for(d=a.items,e=void 0,f=void 0,g=[],e=0;e<c;e++)g.push(i);if(a.items=d=d.slice(0,b).concat(g,d.slice(b)),a.V3<=0&&b>0&&(f=d[b-1]))for(e=0;e<c;e++)d[b+e]=new aa(f);wa(a)}}function ra(a,b,c){c>0&&(a.items.splice(b,c),wa(a))}function sa(a,b,c){for(var d,e,f,g,h=i,j=a.items,k=b,l=u(j);k<l&&(d=j[k],!d||d.level<c||(h||(h=new _(a,k,k,c)),d.level>c&&(e=sa(a,k,c+1),k=e.index,h.addChild(e.g)),k>h.end&&(h.end=k),!a.isGroupEnd(k,c)));k++);if(h)for(f=h.end+1,g=h.start;g<f;g++)j[g].groupInfo||(j[g].groupInfo=h);return{g:h,index:k}}function ta(a,b){return b>=-1&&b<u(a.items)}b.isIndexValid=ta;function ua(a,b,c){var d,e,f=a&&a.items;if(f)for(d=f[b]&&f[b].groupInfo;d;){if(e=d.level,e===c)return d;if(!(e>c))break;d=d.parent}return i}function va(a,b){switch(a){case"head":case"tail":return b===i;case"direction":return 1===b;case"itemsData":return 0===u(b);default:return!1}}function wa(a){a.Zka=i,a.refresh()}function xa(a,b){!b&&a.Wka||(a.Zka=a.createRangeGroup(),za(a))}function ya(a){a.Wka&&!a.Zka&&(a.Zka=a.createRangeGroup())}function za(a,b){!a.Wka&&a.groupChangeHandler&&a.groupChangeHandler(b)}function Aa(a,c,d){if(Ba(a,c),!ta(a,c+d-1))throw Error(b.getSR().Exp_InvalidCount)}function Ba(a,c){if(!ta(a,c))throw Error(b.getSR().Exp_InvalidIndex)}function Ca(a,b){for(var c,d=a.parent;d&&(c=b?a.end===d.end:a.start===d.start);)a=d,d=d.parent;return a}ba=function(){function a(a,b,c){var d=this;d.head=i,d.tail=i,d.Zka=i,d.items=Array(a),d.V3=0,d.wz=!0,d.kj=b,d.ML=c}return a.prototype.no=function(){this.kj=i},a.prototype.getUsedRange=function(a){var b,c,d,f,g,h,i,j,k,l,m,n,o;if(a&e.UsedRangeType.axis)return b=this,c=b.items,d=b.ML,f=Object.keys(c),g=f.length,h=b.kj,g>0&&h?(i=0,j=g,k=c[+f[0]],l=g-1,m=c[+f[l]],k&&k.level===-1&&(i=1),m&&m.level===-1&&(j=l),d?(n=h.getColumnCount()-1,{minRow:+f[i],minCol:0,maxRow:+f[j-1],maxCol:n}):(o=h.getRowCount()-1,{minRow:0,minCol:+f[i],maxRow:o,maxCol:+f[j-1]})):void 0},a.prototype.group=function(a,b){var c=this,d,e;for(Aa(c,a,b),c.kj.ITa.vUa(c.ML),d=0;d<b;d++)e=a+d,c.items[e]?c.items[e].level++:c.items[e]=new aa;c.Wka&&c.Zka&&(c.Zka=i),c.kj.ITa.vUa(c.ML,!0),xa(c),c.wz=!1},a.prototype.Lia=function(){this.Wka=!0,this.Zka=i},a.prototype.Mia=function(){var a=this;a.Wka=!1,a.refresh()},a.prototype.ungroupRange=function(a,b){var c=this,d,e;for(Aa(c,a,b),c.kj.ITa.vUa(c.ML),d=0;d<b;d++)e=c.items[a+d],e&&e.level>-1&&e.level--;c.kj.ITa.vUa(c.ML,!0),xa(c)},a.prototype.ungroup=function(){var a=this,b=u(a.items);a.kj.ITa.vUa(a.ML),a.items=Array(b),xa(a),a.wz=!0},a.prototype.expand=function(a,c,d){var e,f,g,h,i,j,k;if(a<-1)throw Error(b.getSR().Exp_InvalidLevel);for(e=this,f=e.items,h=e.kj,h.ITa.vUa(e.ML),ya(e),i=h.Cf(),h.suspendPaint(),i.suspend(),j=0,k=f.length;j<k;j++)f[j]&&(g=e.find(j,a),g&&(e.expandGroup(g,c,!0),j=g.end));d||e.kj.ITa.vUa(e.ML,!0),i.resume(!1),h.resumePaint()},a.prototype.expandGroup=function(a,c,d){if(!a)throw Error(b.getSR().Exp_GroupInfoIsNull);var e=this,f=e.direction(),g=-1;d||e.kj.ITa.vUa(e.ML),0===f?g=a.start-1:1===f&&(g=a.end+1),e.setCollapsed(g,!c,a.level,d),d||e.kj.ITa.vUa(e.ML,!0),e.kj.$p()},a.prototype.Xr=function(a){return!(!this.wz&&ta(this,a))||!this.isCollapsed(a)},a.prototype.isCollapsed=function(a){var b=this.items[a];return!!(b&&b.viewCollapsed&&b.level>-1)},a.prototype.find=function(a,b){var c=this,d;return ya(c),b===-1?d=c.Zka:(c.kj.ODJ||Ba(c,a),d=ua(c,a,b)),d},a.prototype.getLevel=function(a){var b=this.items[a];return b?b.level:-1},a.prototype.getCollapsed=function(a){var b=this.items[a];return!!b&&!!b.collapsed},a.prototype.B4=function(a,b,c,d){var e,f;for(e=b;e<=c;e++)f=a[e],f||(f=a[e]=new aa,f.level=-1),f.viewCollapsed=d},a.prototype.setCollapsed=function(a,b,c,d){var e,f,g,h,i,k,l=this,m=!1,n=l.items,o=l.kj.ITa,p=[];if(d||o.vUa(l.ML),ya(l),a<0?(e=l.head,e||(e=l.head=new aa)):a<u(n)?(e=n[a],e||(e=n[a]=new aa,e.level=-1)):(e=l.tail,e||(e=l.tail=new aa)),f=1===l.direction(),g=c!==j,g||e.collapsed===b?g&&(e.level===c-1&&(e.collapsed=b),m=!0,l.E4(a,b,c)):(e.collapsed=b,m=!0,l.E4(a,b,c)),m&&(a+=f?-1:1,i=l.find(a,l.getLevel(a)))){for(k=i.start;k<=i.end;k++)p.push(k);h={indexes:p}}za(l,h),d||l.kj.ITa.vUa(l.ML,!0)},a.prototype.dPa=function(a,b){var c,d=this.items;d[a]?d[a].collapsed!==b&&(d[a].collapsed=b):(c=d[a]=new aa,c.level=-1,c.collapsed=b)},a.prototype.E4=function(a,b,c){var d,e,f,g,h,i,k,l,m,n,o=this,p=o.items,q=1===o.direction(),r=q?-1:1,s=c!==j,t=a+r,u=s?c:o.getLevel(t),v=ua(o,t,u);if(v&&(d=q?v.end+1:v.start-1,d!==a&&(v=null)),z(v)&&(u=s?c:o.getLevel(a),v=ua(o,a,u)),v)if(e=void 0,f=v.parent,b)s||(e=q?v.end+1:v.start-1,o.dPa(e,!0),v=Ca(v,q)),o.B4(p,v.start,v.end,!0);else{for(g=!1,h=void 0;f;){if(h=q?f.end+1:f.start-1,p[h]&&p[h].collapsed&&p[h].level>-1){g=!0;break}f=f.parent}if(!g)for(s||(e=q?v.end+1:v.start-1,o.dPa(e,!1),v=Ca(v,q)),o.B4(p,v.start,v.end,!1),i=[v],k=0;k>=0;)if(l=i[k],k--,h=q?l.end+1:l.start-1,p[h]&&p[h].collapsed&&p[h].level!==-1)o.B4(p,l.start,l.end,!0);else for(m=l.children,n=0;m&&n<m.length;n++)++k,i[k]=m[n]}},a.prototype.getMaxLevel=function(){var a=-1,b=this.items,c;return p(b,function(b,d){d&&(c=d.level,c>a&&(a=c))}),a},a.prototype.cB=function(a,b,c,d){var e,f,g,h,i;if(!(c<=0||a===b)){for(e=this,e.kj.ITa.vUa(e.ML),a<0&&(a=0),b<0&&(b=0),f=[],g=e.items,h=s(g,a-1);h>=0&&h<a+c;)i=new aa(g[h]),f.push({index:h-a,value:i}),h=s(g,h);d&&t(g,a,c),t(g,b,c),p(f,function(a,c){g[b+c.index]=c.value}),wa(e),e.kj.ITa.vUa(e.ML,!0)}},a.prototype.bB=function(a,b,c,d,e){var f,g,h=this;if(h.kj.ITa.vUa(h.ML),b<0&&(b=0),c<0&&(c=0),f=[],a)for(g=s(a.items,b-1);g>=0&&g<b+d;)f[g-b]=new aa(a.items[g]),g=s(a.items,g);t(h.items,c,d),f.length>0&&f.forEach(function(a,b){h.items[c+b]=a}),e&&t(a.items,b,d),h.kj.ITa.vUa(h.ML,!0)},a.prototype.refresh=function(){this.wz||xa(this)},a.prototype.VL=function(a){var b=this,c=b.items,d=u(c),e=a-d;e<0?c.splice(a,-e):b.items=c.concat(Array(e)),wa(b)},a.prototype.getState=function(a){var b=this,c=b.items,d,e=b.direction(),f=-1;return 0===e?f=a.start-1:1===e&&(f=a.end+1),d=f<0?b.head:f<u(c)?c[f]:b.tail,d&&d.collapsed?1:0},a.prototype.Ez=function(a,b){var c=this,d=c.items;a<0?(c.head||(c.head=new aa),c.head.level=b):a<u(d)?(d[a]||(d[a]=new aa),d[a].level=b):(c.tail||(c.tail=new aa),c.tail.level=b),wa(c)},a.prototype.suspendAdding=function(){this.V3++},a.prototype.resumeAdding=function(){this.V3--},a.prototype.createRangeGroup=function(){for(var a,b,c=this,d=c.items,e=u(c.items),f=new _(c,0,e-1,(-1)),g=0;g<e;)d[g]&&(d[g].groupInfo=i),g++;for(g=0;g<e;)d[g]?(a=sa(c,g,0),b=a.g,g=a.index+1,b&&b.level>-1&&f.addChild(b)):g++;return f},a.prototype.LLb=function(a,b){return 1===this.direction()?b===a.end+1:b===a.start-1},a.prototype.MLb=function(a,b,c,d){var e=this,f=-1,g=0;if(1===e.direction()&&(f=0,g=1),a===b)return e.LLb(a,c)||e.LLb(a,d)?{start:a.start,end:a.end,level:a.level}:{start:c,end:d,level:a.level};for(;a.level>b.level;){if(b===a.parent)return e.LLb(b,d)?{start:b.start,end:b.end,level:b.level}:{start:a.start+f,end:d,level:a.level-1};a=a.parent}for(;a.level<b.level;){if(a===b.parent)return e.LLb(a,c)?{start:a.start,end:a.end,level:a.level}:{start:c,end:b.end+g,level:b.level-1};b=b.parent}for(;a.level>=0;){if(a.parent===b.parent)return{start:a.start+f,end:b.end+g,level:b.level-1};a=a.parent,b=b.parent}return{start:a.start+f,end:b.end+g,level:b.level-1}},a.prototype.NLb=function(a){var b,c,d,e=this,f=e.items,g=f[a];return b=1===e.direction()?f[a-1]:f[a+1],c=g?g.level:-1,d=b?b.level:-1,c<d?b&&b.groupInfo:g&&g.groupInfo},a.prototype.gJb=function(a,b){var c,d,e=this,f=e.NLb(a),g=e.NLb(a+b-1);if(z(f)&&z(g))return{start:a,end:a+b-1,count:b,level:-1};if(!f||!g){for(c=f||g;c&&c.level!==-1;)c=c.parent;f||(f=c),g||(g=c)}return d=e.MLb(f,g,a,a+b-1),d.count=d.end-d.start+1,d},a.prototype.lJb=function(a,b){var c,d,e,f,g=this,h=g.items;for(c=a;c<a+b;c++)if(d=h[c]&&h[c].groupInfo&&h[c].groupInfo.level,!z(d)&&d>=0)return!0;return e=1===g.direction()?a-1:a+b,f=h[e]&&h[e].groupInfo&&h[e].groupInfo.level,!z(f)&&f>=0},a.prototype.OLb=function(a){var b=this,c=b.items,d=c[a]&&c[a].groupInfo&&c[a].groupInfo.level;return z(d)?-1:d},a.prototype.PLb=function(a,b,c){var d,e,f=this,g=[],h=[];for(d=a;d<a+b;d++)e=f.OLb(d),e===c&&h.push(d),f.OLb(d+1)<c&&h.length>0&&(g.push(h),h=[]);return h.length>0&&g.push(h),g},a.prototype.hJb=function(a,b){var c,d,e,f,g=this;if(1===b)return g.PLb(a.start,a.count,a.level);for(c=[],d=g.getMaxLevel(),e=2===b?a.level+1:a.level,f=d;f>=e&&f>=-1;f--)c=c.concat(g.PLb(a.start,a.count,f));return c},a.prototype.jJb=function(a,b,c){var d,e,f,g=this;for(d=a.length-1;d>=0;d--)e=a[d],e.collapse&&g.setCollapsed(e.head,!1),g.ungroupRange(e.start,e.count);for(d=a.length-1;d>=0;d--)e=a[d],f=r.Cb(b,e.head)+c,1===g.direction()?g.group(f-e.count,e.count):g.group(f+1,e.count),e.collapse&&g.setCollapsed(f,e.collapse)},a.prototype.iJb=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,o=n.items;if(1===c)for(d=n.getMaxLevel(),e=b.level+1;e<=d;e++)a.splice.apply(a,[0,0].concat(n.PLb(b.start,b.count,e)));else 2===c&&a.push.apply(a,n.PLb(b.start,b.count,b.level));for(f=a.length,g=a[f-1].concat([]),h=[],e=f-2;e>=0;e--)i=o[a[e][0]],j=i.groupInfo,1===n.direction()?(k=j.end+1,l=r.Cb(g,k),g.splice.apply(g,[l,0].concat(a[e])),h.push({head:k,start:j.start,count:k-j.start,collapse:i.viewCollapsed})):(k=j.start-1,l=r.Cb(g,k),g.splice.apply(g,[l+1,0].concat(a[e])),h.push({head:k,start:j.start,count:j.end-k,collapse:i.viewCollapsed}));for(m=!1,e=0;e<b.count;e++)if(g[e]!==e+b.start){m=!0;break}return{array:g,isChanged:m,groupSwap:h}},a.prototype.isGroupEnd=function(a,b){var c,d,e,f,g,h,i=this,j=i.items,k=a+1;return!ta(i,k)||(!(c=j[k])||(d=c.level,e=j[a].level,f=!1,d<e&&(g=e-d,h=e-b,h>=0&&h<g&&(f=!0)),f))},a.prototype.hitTest=function(a,b,c){return la.call(a,b,c)},a.prototype.jp=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;if(!this.iT()&&(e=a.Gt(),f=a.am(),g=a.ss,h=e.width,i=e.height,h||i)){if(j=d?h:f.width,k=d?f.height:i,l=d?e.rowMaxLevel:e.colMaxLevel,m=d?g.bn:g.dn,b.save(),b.beginPath(),!c||c.intersect(e.x,e.y,j,k))for(n=new X(a,d,l),o=void 0,p=void 0,n._L(b),o=m.call(a.ss,function(){return na(a,d,l)}),p=0;p<=2;p++)o[p].aM(b);b.beginPath(),b.restore()}},a.prototype.UL=function(a,b){if(b){var c=b.what;c===M||c===N?ha(a,b):c!==O&&c!==P||ia(a,b)}},a.prototype.iT=function(){return this.wz},a.prototype.s0a=function(){var a=parseInt(q(K).borderTopWidth,10);return isNaN(a)?2:a},a.prototype.fromJSON=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,q,r=b&&b.ignoreStyle;if(a&&!r){if(c=this,d=c.items,e=a.items,f=a.itemsData,g=a.direction,h=a.head,i=a.tail,m=[],z(g)||c.direction(g),h&&(c.head=h),i&&(c.tail=i),n=!1,e&&e.length>0)for(q=0;q<e.length;q++)z(e[q])||(o=new aa(e[q]),c.direction()===Z.forward&&(o.viewCollapsed?n=!0:n&&(o.collapsed=!0,n=!1)),d[q]=o,c.wz=!1);else p(f,function(a,b){if(j=b.index,k=b.info,j>=0&&k){for(l=0;l<b.count&&!(j+l>=u(d));l++)b.info.collapsed&&m.push(b),d[j+l]=new aa(k);c.wz=!1}});for(xa(c,!0),q=0;q<m.length;q++)c.E4(m[q].index,!0)}},a.prototype.toJSON=function(a){var b,c,d,e,f,g,h,i,k,l,m=a&&a.ignoreStyle;if(!m){for(b=this,c=[],d=b.items,f=-1,g=[],e=0;e<u(d);e++)h=c[f],i=d[e],i&&(g[e]={level:i.level,collapsed:i.collapsed,viewCollapsed:i.viewCollapsed},f>=0&&e===h.count+h.index&&i.level===h.info.level&&i.collapsed===h.info.collapsed?c[f].count++:(f++,c[f]={index:e,count:1,info:{level:i.level,collapsed:i.collapsed
}}));return k={items:g,itemsData:c,direction:b.direction(),head:b.head,tail:b.tail},l={},p(k,function(a,b){va(a,b)||(l[a]=b)}),o.isEmptyObject(l)?j:l}},a}(),b.Outline=ba,ba.prototype.direction=A("direction",1),h.Outline=ba;function Da(a){return a&&new aa(a)}function Ea(a){return{items:a.items.map(Da),head:Da(a.head),tail:Da(a.tail),wz:a.wz,direction:a.direction()}}function Fa(a,b){a.items=b.items.map(Da),a.head=Da(b.head),a.tail=Da(b.tail),a.wz=b.wz,a.direction(b.direction),xa(a,!0)}o.extend(e.lUa.prototype,{vUa:function(a,b){var c=this,d=c.zTa;d&&(d.originalOutlines||(d.originalOutlines=[]),!a||!b&&d.originalOutlines[0]?a||!b&&d.originalOutlines[1]||(d.originalOutlines[b?3:1]=Ea(c.yUa)):d.originalOutlines[b?2:0]=Ea(c.xUa))},zUa:function(a,b,c){var d,e=this;void 0!==b&&(this.kj.outlineColumn.YQa=b),a&&(d=a[c?2:0],d&&Fa(e.xUa,d),d=a[c?3:1],d&&Fa(e.yUa,d))}}),e.lUa.$n(F,{init:function(){var a=this,b=a.kj;a.yUa=new ba(a.getColumnCount(),b,(!1)),a.xUa=new ba(a.getRowCount(),b,(!0))},applyChanges:function(a){var b=this,c=a.changes,d=a.isUndo,e=c&&c.originalOutlines;(e||c.oldOptions)&&b.zUa(e,c.oldOptions,!d)},undo:function(a){var b=a.originalOutlines;(b||a.oldOptions)&&(this.zUa(b,a.oldOptions),this.kj.$p())},dispose:function(a){var b=this,c=a&&a.clearCache;c!==!1&&(b.yUa&&(b.yUa.no(),b.yUa=i),b.xUa&&(b.xUa.no(),b.xUa=i))}}),ca={init:function(){var a=this;a.rowOutlines=a.ITa.xUa,a.columnOutlines=a.ITa.yUa,a.rowOutlines.groupChangeHandler=function(b){var c,d,f,g,h,i=b&&b.indexes;i&&a.recalcRows&&(c=a.getCalcService(),c&&!c.IsSuspended()&&a.recalcRows(i)),d=a.parent,d&&a!==d.getActiveSheet()||a.au(),i?(f=i[0],g=i[i.length-1],h=!0):(f=0,g=a.getRowCount()-1,h=!1),e.Worksheet.ao(a,"onGroupChanged",{start:f,end:g,isRow:!0,fromSetCollapsed:h})},a.columnOutlines.groupChangeHandler=function(b){var c,d,f,g,h=a.parent;h&&a!==h.getActiveSheet()||a.bu(),c=b&&b.indexes,c?(d=c[0],f=c[c.length-1],g=!0):(d=0,f=a.getColumnCount()-1,g=!1),e.Worksheet.ao(a,"onGroupChanged",{start:d,end:f,isRow:!1,fromSetCollapsed:g})},a.Wr.push(a.rowOutlines),a.Zr.push(a.columnOutlines)},dispose:function(a){var b=this;a.clearCache!==!1&&(b.rowOutlines&&(b.rowOutlines.groupChangeHandler=i),b.columnOutlines&&(b.columnOutlines.groupChangeHandler=i)),o(b.Ws()).unbind("mousedown.group")},setHost:function(a){if(a){var b=this;a.bind("mousedown.group",function(a){var c,d=b.Vs(),e=la.call(b,a.pageX-d.left,a.pageY-d.top);e&&(c=e.what,c===O||c===M?b.rowOutlines.UL(b,e):c!==P&&c!==N||b.columnOutlines.UL(b,e))})}},preProcessMouseDbClick:function(a){var b=this;z(b.yt)||z(b.yt.outlineHitInfo)||(a.r=!0)},onPaintSuspend:function(a){var b=this;a.suspend?(b.rowOutlines.Lia(),b.columnOutlines.Lia()):(b.rowOutlines.Mia(),b.columnOutlines.Mia())},beforeLayoutChanged:function(a){var b=this,c=a.changeType;"invalidateLayout"===c&&(b.TL=i)},onLayoutChanged:function(a){var b=this,c=a.changeType,d=a.row,e=a.rowCount,f=a.col,g=a.colCount,h=a.sheetArea,j=b.rowOutlines,k=b.columnOutlines,l=this.ITa;"addRows"===c?(l.vUa(!0),qa(j,d,e),l.vUa(!0,!0)):"deleteRows"===c?(l.vUa(!0),ra(j,d,e),l.vUa(!0,!0)):"addColumns"===c?(l.vUa(!1),qa(k,f,g),l.vUa(!1,!0)):"deleteColumns"===c?(l.vUa(!1),ra(k,f,g),l.vUa(!1,!0)):"invalidateLayout"===c?b.TL=i:"setColumnCount"===c?(l.vUa(!1),3!==h&&1!==h||k.VL(g),l.vUa(!1,!0)):"setRowCount"!==c||3!==h&&2!==h||(l.vUa(!0),j.VL(e),l.vUa(!0,!0))},paint:function(a){var b=a.ctx,c=a.clipRect,d=this,e=d.rowOutlines,f=d.columnOutlines;e&&e.jp(d,b,c,!0),f&&f.jp(d,b,c,!1)},fromJson:function(a,b,c){if(a){var d=this,e=void 0,f=a.showRowRangeGroup,g=a.showColumnRangeGroup,h=y(f)?f:a.showRowOutline,i=y(g)?g:a.showColumnOutline;z(h)||d.showRowOutline(h),z(i)||d.showColumnOutline(i),e=a.rowRangeGroup||a.rowOutlines,e&&d.rowOutlines.fromJSON(e,c),e=a.colRangeGroup||a.columnOutlines,e&&d.columnOutlines.fromJSON(e,c)}},toJson:function(a,b){var c,d=this,e=d.rowOutlines,f=d.columnOutlines,g=d.showRowOutline();g!==!0&&(a.showRowOutline=g),c=d.showColumnOutline(),c!==!0&&(a.showColumnOutline=c),a.rowOutlines=e?e.toJSON(b):j,a.columnOutlines=f?f.toJSON(b):j},bdK:function(a,b,c){var d,f,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=c&&c.includeStyles===!1;if(!C){for(d=this,f=d.rowOutlines,g=d.columnOutlines,h=d.showRowOutline(),h!==!0&&(a.lossless.showRowOutline=h),i=d.showColumnOutline(),i!==!0&&(a.lossless.showColumnOutline=i),0!==f.direction()&&0!==g.direction()||(k=D(a,Q),k||(k={n_:Q,c_:[]},a.c_.push(k)),l={n_:"outlinePr"},k.c_.push(l),0===f.direction()&&(l.summaryBelow="0"),0===g.direction()&&(l.summaryRight="0")),m=D(a,e.XFileConstants.FbK),n=f.getMaxLevel(),o=g.getMaxLevel(),p=n!==-1?n+1:j,q=o!==-1?o+1:j,m.outlineLevelRow=p,m.outlineLevelCol=q,r=a.tempCols,s=g.items,t=m.defaultColWidth,u=0;u<s.length;u++)v=s[u],v&&(w=v.viewCollapsed,x=r[u]?r[u]:{width:t,hidden:j,collapsed:j,outlineLevel:j},(x.hidden===S||w)&&(x.hidden=S),v.collapsed===!0&&(x.collapsed=S),v.level!==-1&&(x.outlineLevel=v.level+1),r[u]=x);for(y=D(a,R),z=f.items,u=0;u<z.length;u++)A=z[u],A&&(w=A.viewCollapsed,B=y[u]?y[u]:{},B.v===j&&w===!1&&(B.v=0),B.f=A.collapsed===!0?1:0,B.l=A.level+1,y[u]=B)}},cdK:function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,q,r,s,t,v,w,x,y,A,B,E,F,G,H,I,J,K,L,M,N,O,P=c&&c.includeStyles===!1;if(!P&&(a.lossless&&(d=a.lossless.showRowOutline,f=a.lossless.showColumnOutline,z(d)||this.showRowOutline(d),z(f)||this.showColumnOutline(f)),g=this,h=g.rowOutlines,i=g.columnOutlines,j=C(a,Q+"&outlinePr"),j&&("0"===j.summaryBelow&&h.direction(0),"0"===j.summaryRight&&i.direction(0)),k=D(a,e.XFileConstants.GbK),l=k&&k.c_,l&&l.length>0&&(m=i.items,n=g.getColumnCount(),l.forEach(function(a){var b,c,d,f,g,h;if((a.outlineLevel>0||!z(a.collapsed))&&(i.wz=!1,b=a.min-1,c=a.max-1,d=+a.outlineLevel||0,f=V(a.hidden,!1),g=V(a.collapsed,!1),b>=0&&c>=0))for(c===e.MAX_COLUMN_COUNT-1&&(c=Math.max(n,b)),h=b;h<=c;h++)m[h]=new aa({level:d-1,collapsed:g,viewCollapsed:f}),h+2>n&&!(d<=0&&(!m[h-1]||m[h-1]&&m[h-1].level<0))&&(n=h+2)}),n>g.getColumnCount()&&g.setColumnCount(n)),o=D(a,R))){for(q=g.ITa.YTa(!0),r={rowItems:[],itemsData:[]},s=[],t=h.items,v=r.rowItems,w=r.itemsData,x=o.rowCount,y=0===h.direction(),A=g.getRowCount(),B=0;B<x;B++)E=o[B],E?(F=!!E.f,G=+E.l||0,(G>0||F)&&(v[B]={level:G-1,collapsed:F},H=w[w.length-1],H&&B===H.index+H.count&&H.info.level===G-1&&H.info.collapsed===F?H.count++:w.push({index:B,count:1,info:{level:G-1,collapsed:F}})),I=!!E.v,J=s[B-1]&&s[B-1].hidden,w&&Ha(r,B,G,y,I,J),K={},K.hidden=I,I&&0===G&&(K.visible=!1),s.push(K),+B+2>A&&(G>0||F)&&(A=+B+2)):s.push({});if(Ga(r,o,s,h.direction(),q),L=!1,M=void 0,N=[],v&&v.length>0)for(O=0;O<v.length;O++)z(v[O])||(M=new aa(v[O]),h.direction()===Z.forward&&(M.viewCollapsed?L=!0:L&&(M.collapsed=!0,L=!1)),t[O]=M,h.wz=!1);else p(w,function(a,b){var c,d=b.index,e=b.info;if(d>=0&&e){for(c=0;c<b.count&&!(d+c>=u(w));c++)b.info.collapsed&&N.push(b),h[d+c]=new aa(e);h.wz=!1}});for(xa(h,!0),O=0;O<N.length;O++)h.E4(N[O].index,!0);for(A>g.getRowCount()&&g.setRowCount(A),O=0;O<s.length;O++)s[O].visible===!1&&q.KkK.push(O)}}},e.Worksheet.$n(F,ca);function Ga(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(a)for(f=0===d,g=a.rowItems,h=function(){return f?0:b.rowCount-1},i=function(a){return f?a<b.rowCount:a>=0},j=function(a){return f?a+1:a-1},k=function(a){return f?a-1:a+1},l=h();i(l);l=j(l))m=g[l],m&&(n=k(l),o=g[n],p=!o&&"number"==typeof m.level||o&&o.level<m.level,q=o&&o.level>m.level,r=void 0,s=void 0,p?(r=n,s=!!o&&(o.collapsed||o.viewCollapsed)):q?m.level===-1?s=!1:(t=g[o.parentIndex],t&&(r=t.parentIndex,s=t.viewCollapsed)):(r=o.parentIndex,s=o.viewCollapsed),m.parentIndex=r,m.viewCollapsed=s,!s&&c[l].hidden&&(c[l].visible=!1,z(e.infos[l])&&(e.infos[l]={}),e.infos[l].visible=!1))}function Ha(a,b,c,d,e,f){var g,h,i,j,k=a.itemsData;k&&(g=k[k.length-1],h=k[k.length-2],i=g&&g.info,j=h&&h.info,i&&(d&&e&&1===g.count?j&&h.index===g.index-1&&j.level===i.level-1?j.collapsed=!0:b>0?k.splice(k.length-2,0,{index:g.index-1,count:1,info:{level:i.level-1,collapsed:!0}}):a.head={collapsed:!0,level:c-1}:!d&&f&&(j&&g.index===h.index+1&&i.level===j.level-1?g.collapsed=!0:b>=g.index+g.count&&k.push({index:g.index+g.count,count:1,info:{level:i.level-1,collapsed:!0}}))))}da={init:function(){f.Commands.SL(this.commandManager())},onCultureChanged:function(){b.getSR()}},e.Workbook.$n(F,da)},"./dist/plugins/group/group.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/group/group.res.en.js");b.SR={en:d}},"./dist/plugins/group/group.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_InvalidIndex="Invalid index",b.Exp_InvalidCount="Invalid count",b.Exp_InvalidLevel="Invalid level",b.Exp_GroupInfoIsNull="groupInfo is null",b.Exp_GROUP_PROTECTED="You can not use this command on a protected sheet. To use this command, you must first unprotect sheet."},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets}});