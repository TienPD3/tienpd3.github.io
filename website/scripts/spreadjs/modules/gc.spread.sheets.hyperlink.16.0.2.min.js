/*!
 * 
 * SpreadJS Library 16.0.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Hyperlink=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/hyperlink/hyperlink.js")}({"./dist/plugins/hyperlink/hyperlink.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("SheetsCalc"),g=d.Ul.fp,h=d.Ul.Nl,i=d.Ul.ol,j=d.GC$,k=d.Commands.ActionBase,l=d.CellTypes.Base,m=e.Common.j.Fa,n=e.Common.j.C4,o=e.Common.u.NIc,p=e.Common.pc,q=void 0,r=null,s=Math.max,t=Math.min,u=Math.floor,v=window.open,w=e.Common.u.kb,x="position",y="absolute",z="margin",A="font",B="left",C="top",D="padding",E="border",F="box-sizing",G="pointer",H="background-color",I="content-box",J="default",K="white",L="div",M="gc-spread-hyperlink-tooltip",N="hyperlink",O="followedHyperlink",P="hyperlink",Q="openUrl",R="generateHyperlink",S=/^sjs:\/\/\w+[\!]\w+([\:]\w+)?/,T=/^(mailto:\/\/)?([A-Za-z0-9_\-\.\!\#$%&'*\+/=?^`{|}~])+\@([A-Za-z0-9\-])+\.([A-Za-z0-9\-]){2,63}(\?subject=.+)?$/gi,U=/(((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi,function(a){a[a.blank=0]="blank",a[a.self=1]="self",a[a.parent=2]="parent",a[a.top=3]="top"}(V=b.HyperlinkTargetType||(b.HyperlinkTargetType={})),d.GC$.extend(d.lUa.prototype,{getHyperlink:function(a,b,c){var d,e;return m(c)&&(c=3),d=this,e=d.XTa(c).RTa(a,b),e&&!m(e.hyperlink)?e.hyperlink:r},setHyperlink:function(a,b,c,d){var e,f,g,h,i,j,k,l=this;if(m(d)&&(d=3),e=c&&c.url,e&&e.match(U)&&e.match(U).length>0?(f="www.",w(e,f)&&(c.url="http://"+e)):e&&e.match(T)&&e.match(T).length>0&&(g="mailto:",w(e,g)||(c.url=g+e)),h=l.WTa>0?[["sheetModels",d],q]:q,i=l.XTa(d).RTa(a,b,!0,h?h[0]:q),m(i))h&&(h.length=0);else{if(j=i.hyperlink,m(c))i.hyperlink=null,delete i.hyperlink;else{i.hyperlink={url:"",linkColor:q,visitedLinkColor:q,tooltip:"",target:0,drawUnderline:!0,isVisited:!1,command:""};for(k in i.hyperlink)c[k]!==q&&(i.hyperlink[k]=c[k])}h&&(h[0].push("hyperlink"),h[1]=j,h[2]=i.hyperlink)}h&&h.length>0&&l.zTa.push(h)}}),d.GC$.extend(d.Worksheet.prototype,{getHyperlink:function(a,b,c){var d,e;return 0===c?r:(m(c)&&(c=3),d=this,e=d.ITa,n(e.getHyperlink(a,b,c)))},setHyperlink:function(a,b,c,d){var e,f,g,h;0!==d&&(m(d)&&(d=3),e=this,f=e.ITa,g=f.getRowCount(d),h=f.getColumnCount(d),a<0||a>=g||b<0||b>=h||(f.do("setHyperlink",a,b,c,d),this.$p()))}}),W=function(a){aa(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,g,h,i,j,k,l,n,p,q,r,s=this,t=s.kj,u=!1,x=t.parent,y=t,z=s.VQ.url;if(m(z))return u;if(a=s.VQ.target||0,b="sjs://",0===z.indexOf(b)||"#"===z[0]){if(c=b.length,g="#"===z[0]?z.substr(1):z.substr(c),h=void 0,h=f.formulaToRanges(t,g,0,0,!0),h&&0===h.length&&(h=f.formulaToRanges(t,g,0,0,!1,!0)),h&&h.length>0){if(i=h[0].sheetName,j=h[0].ranges[0],i!==t.name()&&x.getSheetFromName(i).visible()===d.SheetTabVisible.visible){if(k=x.getSheetFromName(i),l={oldSheet:y,newSheet:k,cancel:!1},x.Wq(d.Events.ActiveSheetChanging,l),l.cancel)return;x.setActiveSheet(i),n=x.getActiveSheetIndex(),x.MJc.DLc(n),t=x.getActiveSheet(),y!==t&&x.Wq(d.Events.ActiveSheetChanged,{oldSheet:y,newSheet:t})}x.getSheetFromName(i).visible()===d.SheetTabVisible.visible&&(t.Yq(j.row+j.rowCount,j.col+j.colCount),t.setSelection(j.row,j.col,j.rowCount,j.colCount))}}else m(z)||(p="mailto:",z.match(U)&&z.match(U).length>0?(q="www.",w(z,q)&&(z="http://"+z)):z.match(T)&&z.match(T).length>0&&(w(z,p)||(z=p+z)),w(z,p)&&e.Common.u.Jb(z,"?")>1&&(r=z.split("?"),z=r[0]+"?"+r.slice(1).join("%3F")),v(o(z),["_blank","_self","_parent","_top"][a]));return u},b}(k),d.Commands[Q]={canUndo:!1,execute:function(a,b,c){return d.Commands.h4(a,W,b,c)}},X=function(a){aa(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e=this,f=e.kj,g=e.VQ,h=g.url,i=g.row,j=g.col,k=g.sheetArea;if(null===h)a=null;else{if("string"!=typeof h)return!1;if(b=h.match(U),(!b||b.length<1)&&(b=h.match(T),(!b||b.length<1)&&(b=h.match(S))),!(b&&b.length>0&&0===h.indexOf(b[0])&&h.length===b[0].length))return!1;a={url:h,linkColor:N,visitedLinkColor:O}}return f.ITa.startTransaction(),f.suspendPaint(),f.suspendEvent(),f.setHyperlink(i,j,a,k),f.resumeEvent(),f.resumePaint(),c=d.Commands.bWa(f.name()),e.VQ[c]=f.ITa.endTransaction(),!0},b.prototype.undo=function(){var a,b=this,c=b.kj;return c.suspendPaint(),c.suspendEvent(),a=d.Commands.bWa(c.name()),c.ITa.undo(this.VQ[a]),c.resumeEvent(),c.resumePaint(),!0},b}(k),d.Commands[R]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,X,b,c)}},Y={init:function(){this.commandManager().register(Q,d.Commands[Q]),this.commandManager().register(R,d.Commands[R])}},d.Workbook.$n(P,Y),Z={setHyperlinkWhenEditing:function(a){var b=a.url,c=a.row,d=a.col,e=a.sheetArea,f=this,g=f.getParent();g.options.allowAutoCreateHyperlink&&g.commandManager().execute({cmd:R,sheetName:f.name(),url:b,row:c,col:d,sheetArea:e})}},d.Worksheet.$n(P,Z),$={applyHyperlinkStyle:function(a){var b,c,d=a.sheet,e=a.row,f=a.col;d._Cc&&d._Cc(e,f)||(b=a.style,c=d.getHyperlink(e,f,a.sheetArea),!ga(b)&&fa(b,c))},getCellTextHitInfo:function(a){var b,c,d,e,f,g,h=a.context.sheetArea,i=a.cellStyle,j=a.context,k=j.sheet,l=j.row,n=j.col;ba(k,l,n,h)&&!ga(i)&&(b=a.cellRect,b&&(c=k.Er(l),d=k.Fr(n),e=k.am(),f=void 0,m(h)||3===h?f=e.Ft(c,d):2===h?f=e.fm(c):1===h&&(f=e.gm(d)),f&&(b=b.getIntersectRect(f))),m(h)&&3!==h||!i||!b||(g=k.getText(l,n,h),a.paddingHitInfo={row:l,col:n,x:a.x,y:a.y,sheetArea:h,sheet:k,isFocusAware:!0,isReservedLocation:la(a.x,a.y,i,b,j,g)}))},processMouseUpOnCellPadding:function(a){var b,c,e,f,g,h=a.sheet,i=a.cellStyle,j=a.row,k=a.col,l=a.sheetArea;!h||h.isEditing()||!ba(h,j,k,l)||ga(i)||a.isPivotTable||a.isReservedLocation&&(b=h.Ws(),ea(h),b&&(b.style.cursor=J),c=h.ITa.getHyperlink(j,k,l),c.isVisited=!0,e=c.command,m(e)||""===e||e===Q?h.getParent().commandManager().execute({cmd:Q,sheetName:h.name(),url:c.url,target:c.target}):"string"==typeof e?h.getParent().commandManager().execute({cmd:e,row:j,col:k,sheetName:h.name(),sheetArea:l}):"function"==typeof e&&e.call(r,h,j,k,l),f=h.getColumnCount(),g=new d.Range(j,(-1),1,f),h.repaint(h.getRangeRect(1,1,g)))},processMouseMoveOnCellPadding:function(a){var b,c,d=a.row,e=a.col,f=a.sheet,g=a.cellStyle,h=a.sheetArea;ba(f,d,e,h)&&!ga(g)&&(!f||f.isEditing()&&f.getActiveRowIndex()===d&&f.getActiveColumnIndex()===e||(b=f.Ws(),c=f.getHyperlink(d,e,h),a.isReservedLocation?b&&(da(f,a,c.tooltip),b.style.cursor=G):(ea(f),b&&(b.style.cursor=J))))},processMouseLeaveOnCellPadding:function(a){var b,c=a.sheet,d=a.row,e=a.col,f=a.sheetArea;ea(c),ba(c,d,e,f)&&c&&(b=c.Ws(),b&&(b.style.cursor=J))},onUpdateContainer:function(a){var b=a.cellStyle,c=a.context.row,d=a.context.col,e=a.context.sheet.getHyperlink(c,d);!ga(b)&&fa(b,e)}},l.$n(P,$);function ba(a,b,c,d){return m(d)&&(d=3),!m(a.getHyperlink(b,c,d))}function ca(){var a=h(L);return j(a).css(x,y).css(z,0).css(D,2).css(E,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(F,I).css(H,K).css(A,"9pt Arial"),a}function da(a,b,c){var d,e,f,g,h,i,k;c&&(d=a&&a.zo(),e=d.getElementsByClassName(M)[0],f=!1,m(e)&&(e=ca(),e.className=M,d.insertBefore(e,r),f=!0),g=j(e),!f&&g.isVisible()||(g.text(c),h=a.mm.bG(),i=h.left+b.x,k=h.top+b.y+20,g.css(C,k).css(B,i),g.show()))}function ea(a){var b=a&&a.zo(),c=b.getElementsByClassName(M)[0];m(c)||j(c).hide()}function fa(a,b){m(b)||(b.drawUnderline&&(m(a.textDecoration)?a.textDecoration=1:0!==a.textDecoration&&1!==(1&a.textDecoration)&&(a.textDecoration+=1)),b.isVisited?b.visitedLinkColor===r?a.foreColor="rgba(0,0,0,0)":b.visitedLinkColor===q?a.foreColor=O:a.foreColor=b.visitedLinkColor:m(b.linkColor)?b.linkColor===q&&a.foreColor||(a.foreColor=N):a.foreColor=b.linkColor)}_={0:!0,1:!0,2:!0,3:!0,4:!0};function ga(a){if(a&&a.cellType){var b=a.cellType.typeName;if(!_[b])return!0}return!1}function ha(a,b,c,d,e,f,g){var h=0,i=0,j=a.width,k=a.height,l=ia(g);return l&&(j-=l),h=f=f||0,1===d?h=(j-b)/2:2===d&&(h=j-b-f),1===e?i=(k-c)/2:2===e&&(i=k-c),l&&(h+=l),{x:h,y:i}}function ia(a){var b={context:a,value:0};return l.ao(a.sheet,"getOutlineColumnOffset",b),b.value}function ja(a,b){var c=g(b),e=s(0,d.Vn.Xn(a,b,!0)),f=a.split(/\r\n|\r|\n/).length*c;return{x:0,y:0,width:e,height:f}}function ka(a,b,c,d,e,f,g){var h=ja(a,d),i=ha(e,h.width,h.height,b,c,f,g);return h.x=i.x,h.y=i.y,h}function la(a,b,c,e,f,g){var h,j,k,l,n,o,p,q,r,s,u,v,w,x=f.sheet,y=x.yl;if(m(c))return!1;if(c.textOrientation)return!0;if(h=x.getValue(f.row,f.col,f.sheetArea),g||(g=x.getText(f.row,f.col,f.sheetArea)),!g)return!1;for(g=g.replace(/\s+/g," "),j=c&&c.font?c.font:y.Bl(),j=y.Cl(j),k=[g],l=ma(c),c.wordWrap&&(k=d.Vn.Wn(g,e.width-3-l,j),g=k.join("\r\n")),n=c.hAlign,o=c.vAlign,3===n&&(n=i(n,h,c.formatter)),p=ka(g,n,o,j,e,l,f),q=e.y+p.y,r=0;r<k.length;r++)if(s=ka(k[r],n,o,j,e,l,f),u=e.x+s.x,v=t(u+s.width,e.x+e.width),w=q,q=t(w+s.height,e.y+e.height),u<=a&&a<v&&w<=b&&b<q)return!0;return!1}function ma(a){return 8*(a.textIndent||0)}},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets},SheetsCalc:function(a,b){a.exports=GC.Spread.Sheets.CalcEngine}});