/*!
 * 
 * SpreadJS Library 16.0.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
!function(a){"object"==typeof module&&"object"==typeof module.exports?module.exports=a(require("@grapecity/spread-sheets")):"function"==typeof define&&define.amd?define(["@grapecity/spread-sheets"],a):"object"==typeof exports?exports.Spread=a(require("@grapecity/spread-sheets")):a(GC)}(function(a){a="object"==typeof a?a:{},a.Spread=a.Spread||{},a.Spread.Pivot=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/pivot/pivot-all-entry.js")}({"./dist/plugins/pivot/pivot-all-entry.js":function(b,c,d){a=a||{},a.Pivot=d("./node_modules_local/@grapecity/js-pivot/dist/gc.pivot.js"),a.Spread=a.Spread||{},a.Spread.Pivot=d("./dist/plugins/pivot/pivot-table-entry.js"),b.exports=a.Spread.Pivot},"./dist/plugins/pivot/pivot-core/pivot-core-entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-view.js"))},"./dist/plugins/pivot/pivot-core/pivot-core-interface.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.filterField=0]="filterField",a[a.rowField=1]="rowField",a[a.columnField=2]="columnField",a[a.valueField=3]="valueField"}(d=b.PivotTableFieldType||(b.PivotTableFieldType={})),function(a){a[a.filterField=0]="filterField",a[a.axisField=1]="axisField",a[a.legendField=2]="legendField",a[a.valueField=3]="valueField"}(e=b.PivotChartFieldType||(b.PivotChartFieldType={})),function(a){a[a.fieldAndAreaStacked=0]="fieldAndAreaStacked",a[a.fieldAndAreaBySide=1]="fieldAndAreaBySide",a[a.fieldOnly=2]="fieldOnly",a[a.areaOnlyGrid=3]="areaOnlyGrid",a[a.areaOnlyTable=4]="areaOnlyTable"}(f=b.PivotPanelDirectionEnum||(b.PivotPanelDirectionEnum={})),function(a){a[a.compact=0]="compact",a[a.outline=1]="outline",a[a.tabular=2]="tabular"}(g=b.PivotTableLayoutType||(b.PivotTableLayoutType={})),function(a){a[a.all=0]="all",a[a.button=1]="button",a[a.data=2]="data",a[a.none=3]="none",a[a.normal=4]="normal",a[a.corner=5]="corner",a[a.topEnd=6]="topEnd",a[a.topRight=7]="topRight"}(h=b.PivotAreaType||(b.PivotAreaType={})),function(a){a[a.row=0]="row",a[a.col=1]="col"}(i=b.PivotAreaAxisType||(b.PivotAreaAxisType={})),function(a){a[a.none=0]="none",a[a.row=1]="row",a[a.col=2]="col",a[a.both=3]="both"}(j=b.GrandTotalPosition||(b.GrandTotalPosition={})),function(a){a[a.none=0]="none",a[a.top=1]="top",a[a.bottom=2]="bottom"}(k=b.SubtotalsPosition||(b.SubtotalsPosition={})),function(a){a[a.include=0]="include",a[a.exclude=1]="exclude"}(l=b.CalcItemAggregation||(b.CalcItemAggregation={})),function(a){a[a.downThenOver=0]="downThenOver",a[a.overThenDown=1]="overThenDown"}(m=b.DisplayFields||(b.DisplayFields={})),function(a){a[a.fields=1]="fields",a[a.options=2]="options",a[a.filter=4]="filter",a[a.sort=8]="sort",a[a.layout=16]="layout",a[a.showValueAs=32]="showValueAs",a[a.group=64]="group",a[a.styles=128]="styles",a[a.collapse=256]="collapse",a[a.theme=512]="theme",a[a.position=1024]="position"}(n=b.SerializeIndex||(b.SerializeIndex={})),function(a){a[a.fields=1]="fields",a[a.area=2]="area",a[a.viewList=4]="viewList"}(o=b.PivotPanelSection||(b.PivotPanelSection={})),function(a){a[a.stack=0]="stack",a[a.flow=1]="flow"}(p=b.PivotPanelLayoutType||(b.PivotPanelLayoutType={})),function(a){a[a.pt=1]="pt",a[a.value=2]="value",a[a.table=4]="table"}(q=b.overlapCheck||(b.overlapCheck={})),b.captionCompareTypeExcel={captionEqual:0,captionNotEqual:1,captionBeginsWith:2,captionNotBeginsWith:3,captionEndsWith:4,captionNotEndsWith:5,captionContains:6,captionNotContains:7,captionGreaterThan:8,captionGreaterThanOrEqual:9,captionLessThan:10,captionLessThanOrEqual:11,captionBetween:12,captionNotBetween:13},b.valueCompareTypeExcel={valueEqual:0,valueNotEqual:1,valueGreaterThan:2,valueGreaterThanOrEqual:3,valueLessThan:4,valueLessThanOrEqual:5,valueBetween:6,valueNotBetween:7},b.dateCompareTypeExcel={dateEqual:0,dateNotEqual:1,dateOlderThan:2,dateOlderThanOrEqual:3,dateNewerThan:4,dateNewerThanOrEqual:5,dateBetween:6,dateNotBetween:7,tomorrow:10,today:8,yesterday:9,nextWeek:17,thisWeek:15,lastWeek:16,nextMonth:14,thisMonth:12,lastMonth:13,nextQuarter:18,thisQuarter:19,lastQuarter:20,nextYear:21,thisYear:22,lastYear:23,yearToDate:40,Q1:24,Q2:25,Q3:26,Q4:27,M1:28,M2:29,M3:30,M4:31,M5:32,M6:33,M7:34,M8:35,M9:36,M10:37,M11:38,M12:39},b.top10CompareTypeExcel={count:0,percent:1,sum:2}},"./dist/plugins/pivot/pivot-core/pivot-fields-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q=this&&this.__assign||function(){return Q=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},Q.apply(this,arguments)},R=this&&this.__rest||function(a,b){var c,d,e={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.indexOf(c)<0&&(e[c]=a[c]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(d=0,c=Object.getOwnPropertySymbols(a);d<c.length;d++)b.indexOf(c[d])<0&&(e[c[d]]=a[c[d]]);return e};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("Core"),g=c("@grapecity/js-sheets-common"),h=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=c("./dist/plugins/pivot/pivot-util.js"),k=g.Common.D,l=g.Common.l,m=null,n=f.GC$.isEmptyObject,o=new g.Common.ResourceManager(i.SR,"PivotTables"),p=o.getResource.bind(o),q=g.Common.l,r=q.Ra,s=q.Xb,t=null,u=g.Common.j.Fa,v=Math.min,w=Math.max,x=void 0,y=f.NodeHelper.oca,z=f.NodeHelper.pca,A=f.NodeHelper.qca,B=f.Ul.oaa,C=f.Ul.naa,D=f.Ul.JcK,E=f.Ul.kjK,F=f.Ul.JcK,G=f.Ul.McK,b.throwError=function(a){throw Error(a)},H={null:-1,aboveAverage:100,belowAverage:101,tomorrow:2,today:0,yesterday:1,nextWeek:9,thisWeek:7,lastWeek:8,nextMonth:6,thisMonth:4,lastMonth:5,nextQuarter:10,thisQuarter:11,lastQuarter:12,nextYear:13,thisYear:14,lastYear:15,yearToDate:16,Q1:17,Q2:18,Q3:19,Q4:20,M1:21,M2:22,M3:23,M4:24,M5:25,M6:26,M7:27,M8:28,M9:29,M10:30,M11:31,M12:32},I=function(a){var b,c,e,f,g,h=t,i=a.autoFilter&&a.autoFilter.filterItemMap&&a.autoFilter.filterItemMap[0]&&a.autoFilter.filterItemMap[0].conditions&&a.autoFilter.filterItemMap[0].conditions[0];if(i){switch(i.conType){case 0:i.item1||i.item2?(b=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],f=b[0],g=b[1]):f=i.expected,h={conType:d.PivotConditionType.caption,operator:i.compareType,val:[f,g]};break;case 1:c=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],f=c[0],g=c[1],!f||f instanceof Date||(f=s(f)),!g||g instanceof Date||(g=s(g)),h={conType:d.PivotConditionType.date,val:[f,g],operator:i.compareType,isWholeDay:i.isWholeDay},i.compareType===d.PivotDateFilterOperator.dateToDate&&(h.isParallel=i.isParallel,h.isDynamicEndDate=i.isDynamicEndDate,h.by=i.by);break;case 3:h={conType:d.PivotConditionType.top10,val:i.expected,type:i.compareType,operator:i.type};break;case 2:e=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],f=e[0],g=e[1],h={conType:d.PivotConditionType.value,val:i.expected?[i.expected]:[f,g],operator:i.compareType}}return h}},J=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q=D(a,"autoFilter");if(q){switch(g=G(q,"filterColumn"),h=g[0],i=void 0,h&&(j=F(h,"filters"),k=F(h,"customFilters"),l=F(h,"dynamicFilter"),m=F(h,"top10"),j?i=ja(j,b):k?i=ka(k,b):l?i=la(l,b):m&&(i=ma(m,b))),n=t,o=void 0,p=void 0,b.conType){case 0:i.item1||i.item2?(c=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],o=c[0],p=c[1]):o=i.expected,n={conType:d.PivotConditionType.caption,operator:i.compareType,val:[o,p]};break;case 1:e=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],o=e[0],p=e[1],!o||o instanceof Date||(o=s(o)),!p||p instanceof Date||(p=s(p)),n={conType:d.PivotConditionType.date,val:[o,p],operator:i.compareType,isWholeDay:i.isWholeDay},i.compareType===d.PivotDateFilterOperator.dateToDate&&(n.isParallel=i.isParallel,n.isDynamicEndDate=i.isDynamicEndDate,n.by=i.by);break;case 3:n={conType:d.PivotConditionType.top10,val:i.expected,type:i.compareType,operator:i.type};break;case 2:f=[i.item1&&i.item1.expected,i.item2&&i.item2.expected],o=f[0],p=f[1],n={conType:d.PivotConditionType.value,val:i.expected?[i.expected]:[o,p],operator:i.compareType}}return n}},K=function(a){var b,c,e,f,g,h,i,j,k,l=t;switch(a.conType){case d.PivotConditionType.caption:b=a.val,c=b[0],e=b[1],l=new d.PivotFilterCaptionCondition(a.operator,c,e);break;case d.PivotConditionType.date:f=a.val,g=f[0],h=f[1],l=a.operator===d.PivotDateFilterOperator.dateToDate?new d.PivotFilterDateCondition(a.operator,a.isWholeDay,g,h,a.isDynamicEndDate,a.isParallel,a.by):new d.PivotFilterDateCondition(a.operator,a.isWholeDay,g,h);break;case d.PivotConditionType.top10:l=new d.PivotFilterTop10Condition(a.operator,a.type,a.val);break;case d.PivotConditionType.value:i=a.val,j=i[0],k=i[1],l=new d.PivotFilterValueCondition(a.operator,j,k)}return l},L=["difference","index","normal","percent","percentDiff","percentOfCol","percentOfRow","percentOfTotal","runTotal"],b.Caption_Compare_Type_Excel=[["captionEqual","captionNotEqual","captionBeginsWith","captionNotBeginsWith","captionEndsWith","captionNotEndsWith","captionContains","captionNotContains","captionGreaterThan","captionGreaterThanOrEqual","captionLessThan","captionLessThanOrEqual","captionBetween","captionNotBetween"],["dateEqual","dateNotEqual","dateOlderThan","dateOlderThanOrEqual","dateNewerThan","dateNewerThanOrEqual","dateBetween","dateNotBetween","today","yesterday","tomorrow",,"thisMonth","lastMonth","nextMonth","thisWeek","lastWeek","nextWeek","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","yearToDate"],["valueEqual","valueNotEqual","valueGreaterThan","valueGreaterThanOrEqual","valueLessThan","valueLessThanOrEqual","valueBetween","valueNotBetwee"],["count","percent","sum"]];function S(a,b,c){var e=-1,f=a.slice();return c&&f.splice(c.valuePositionIndex,0,c),d.Yxc(f,function(a,c){if(e===-1&&a.Cj===b)return e=c,!0}),e}b.oHJ=S;function T(a,b){var c;return d.Yxc(a,function(a,d){if(a.Cj===b)return c=a,!0}),c}function U(a,b){var c;return d.Yxc(a,function(a,d){if(a.Zxc===b)return c=a,!0}),c}M=function(){function a(){this.HL={}}return a.prototype.add=function(a,b){!this.get(a)&&b&&(this.HL[a]=b)},a.prototype.get=function(a){return this.HL[a]},a.prototype.set=function(a,b,c){var d=this.get(a);!u(c)&&u(b)?(u(d)&&(d={}),1===c?d.labelFilter=t:2===c?d.valueFilter=t:this.remove(a)):d=b,d&&u(d.labelFilter)&&u(d.valueFilter)&&this.remove(a)},a.prototype.isFilter=function(a){var b=this.get(a);return!!b&&(b.cyc()||b.dyc())},a.prototype.remove=function(a){this.get(a)&&delete this.HL[a]},a.prototype.dispose=function(){var a,b,c,d;for(a=0,b=Object.keys(this.HL);a<b.length;a++)c=b[a],d=this.HL[c],d.no()},a}(),b.PivotViewFilterManager=M,N=function(){function a(a,b,c){var d=this;a&&a.textItem&&this.updateLabelTextItem(a.textItem,c.allowMultipleFiltersPerField),a&&a.condition&&this.updateLabelCondition(a.condition,c.allowMultipleFiltersPerField),b&&this.updateValueCondition(b),d.selectMultipleItems=c||{allowMultipleFiltersPerField:!0},d.iOa=!1}return a.prototype.cyc=function(a){var b=this,c=b.labelFilter;if(c){if(c.textItem&&!c.textItem.isAll)return!0;if(!a&&c.condition)return!0}return!1},a.prototype.getSlicerItemInfo=function(){var a,b=this.selectMultipleItems,c=this.labelFilter,d=!1,e="";return c&&c.textItem&&c.textItem.list&&(a=c.textItem.list.length,1===a?e=c.textItem.list[0]:a>1&&(d=!0)),{selectMultipleItems:b.allowMultipleFiltersPerField,hasMoreThanOneSelect:d,text:e}},a.prototype.dyc=function(){return!!this.valueFilter},a.prototype.evaluateLabelCondition=function(a){var b,c,e=this;return!e.labelFilter||!e.labelFilter.condition||(b=e.labelFilter.condition,c=a,b.uBc===d.PivotConditionType.date&&(c=d.parseStringToDate(a)||a),e.labelFilter.condition.evaluate(c))},a.prototype.isInLabelFilterItem=function(a){var b=this;return!b.labelFilter||!b.labelFilter.textItem||b.labelFilter.textItem.list.indexOf(a)>-1},a.prototype.updateLabelCondition=function(a,b){var c=this;u(c.labelFilter)&&(c.labelFilter={}),u(a)?c.labelFilter.condition=t:c.labelFilter.condition=K(a),b||(c.labelFilter.textItem=t),c.iOa=!0},a.prototype.updateLabelTextItem=function(a,b){var c=this;u(c.labelFilter)&&(c.labelFilter={}),u(a)||(c.labelFilter.textItem=a),b||(c.labelFilter.condition=t),c.iOa=!0},a.prototype.updateValueCondition=function(a){var b=this;u(b.valueFilter)&&(b.valueFilter={}),b.valueFilter.condition=K(a.condition),b.valueFilter.conditionByName=a.conditionByName},a.prototype.isMatchedLabelItem=function(a,b){return b?this.isInLabelFilterItem(a):this.evaluateLabelCondition(a+"")&&this.isInLabelFilterItem(a)},a.prototype.no=function(){var a=this;a.labelFilter=t,a.valueFilter=t,a.selectMultipleItems=t},a}(),b.PivotViewFilter=N,O=function(){function a(a,b,c,d){var e=this;e.Zxc=b,u(c)?e.Cj=b:e.Cj=c,e.$Fc=a.kOc(b),e.nBJ=d,e.s1J(a)}return a.prototype.qLc=function(a){this.s1J(a)},a.prototype.s1J=function(a){var b,c=this,d=c.Zxc,e=a.uHJ(d);c.bGb=e.startValue,c.vHJ=e.endValue,c.mi=a.$xc(d),c.ayc=a.byc(d),b=a.wSJ(d),c.ny=a.lBJ(d),c._items=c.ODc(a._xc(d),b)},a.prototype.ODc=function(a,b){var c,d,e,f=this,g=[],h=f.ayc;for(d=0;d<a.length;d++)e=d,c=!1,h&&h.length>0&&(e=h[a[d]]),b&&b[a[d]]&&(c=!0),g.push({indexValue:e,value:a[d],calculatedMember:c});return g},a.prototype.getSubTotalType=function(){return this.fyc},a.prototype.setSubTotalType=function(a){this.fyc!==a&&(this.fyc=a)},a.prototype.getSortInfo=function(){return this.zZ},a.prototype.setSortInfo=function(a){this.zZ=a,this.zDc=a&&a.sortType},a.prototype.toPivotViewSubTotalFields=function(){var a,b,c=t;return this.xFJ&&(a=this.Zxc,b=R(this.xFJ,[]),c=Q({subtotalType:this.fyc,cacheName:a,fieldName:this.Cj},b)),{subTotalType:this.fyc,cacheName:this.Zxc,valueFieldName:this.Cj,index:this.mi,showDataAs:c}},a.prototype.toPivotViewQueryField=function(a,b,c,d,e){return V(this.Cj,this.Zxc,this.mi,a,this.zZ,b,c,d,e)},a.prototype.gyc=function(a){},a.prototype.xDc=function(a){switch(a){case e.PivotTableFieldType.rowField:return"axisRow";case e.PivotTableFieldType.columnField:return"axisCol";case e.PivotTableFieldType.filterField:return"axisPage";case e.PivotTableFieldType.valueField:return"axisValues"}},a.prototype.QDc=function(a){var b,c,d=this,e=d._items;for(b=0;b<e.length;b++)if(c=e[b],c&&c.indexValue===a)return c},a.prototype.mBJ=function(a){var b,c,d=this,e=d._items;for(b=0;b<e.length;b++)if(c=e[b],c&&c.value===a)return c},a.prototype.KJJ=function(a,b){var c,d,e=this,f=b||e._items;for(c=0;c<f.length;c++)if(d=f[c],d&&d.value===a)return c},a.prototype.gEc=function(a,b,c,d){var e,f,g,h,i,j,k=this,l=[],m=!1,n=a.length,o=[];for(e=0;e<n;e++)if(f=a[e],g=f.indexValue,!u(g)){if(h=k.QDc(g),u(h))continue;u(f.childItems)||(h.childItems=f.childItems),u(f.expanded)||(h.expanded=f.expanded),u(f.drillAcross)||(h.drillAcross=f.drillAcross),u(f.calculatedMember)||(h.calculatedMember=f.calculatedMember),f.hidden===!0?m=!0:l.push(h.value),u(f.missing)||(h.missing=f.missing),u(f.caption)||(h.caption=f.caption),u(f.character)||(h.character=f.character),f.collapse===!0&&c.setCollapse(b,h.value,!0),u(f.type)||(h.type=f.type),o.push(h)}k._items=o,m&&(i=c.getFilterInfo(k.Zxc),u(i)&&(i=new N(t,t,c.WIJ),c.IUJ.add(k.Zxc,i)),j={isAll:!1,list:l},i.updateLabelTextItem(j,c.WIJ.allowMultipleFiltersPerField),c.IUJ.set(k.Zxc,i))},a.prototype.ojK=function(a,b,c,d){var e,f,g,h,i,j,k=this,l=[],m=!1,n=+a.count,o=[];for(e=0;e<n;e++)if(f=a.c_[e],g=z(f.x),!u(g)){if(h=k.QDc(g),u(h))continue;u(f.c)||(h.childItems=y(f.c)),u(f.d)||(h.expanded=y(f.d)),u(f.e)||(h.drillAcross=y(f.e)),u(f.f)||(h.calculatedMember=y(f.f)),y(f.h)===!0?m=!0:l.push(h.value),u(f.m)||(h.missing=y(f.m)),u(f.n)||(h.caption=f.n),u(f.s)||(h.character=y(f.s)),y(f.sd)===!1&&c.setCollapse(b,h.value,!0),u(f.t)||(h.type=f.t),o.push(h)}k._items=o,m&&(i=c.getFilterInfo(k.Zxc),u(i)&&(i=new N(t,t,c.WIJ),c.IUJ.add(k.Zxc,i)),j={isAll:!1,list:l},i.updateLabelTextItem(j,c.WIJ.allowMultipleFiltersPerField),c.IUJ.set(k.Zxc,i))},a.prototype.fromJson=function(a,b){var c,e,f,g,h,i=this;i.Lqa=a,u(a.name)||(i.Cj=a.name),c=b.qo.getPivotCacheByName(b.iyc),e=c.getField(i.Zxc),u(a.items)||(f=e&&2===e.ny&&!u(e.dCc),i.gEc(a.items,i.Cj,b,f)),u(a.sortType)||(g=a.sortType,h={},"ascending"===g?h.sortType=d.SortType.asc:"descending"===g&&(h.sortType=d.SortType.desc),i.zZ=h,i.zDc=h.sortType),u(a.fld)||(i.mi=a.fld),u(a.baseField)||(i.baseField=a.baseField),u(a.measureFilter)||(i.yDc=a.measureFilter),u(a.numberFormat)||(i.nBJ=a.numberFormat),u(a.showAll)||(i.ZBJ=a.showAll,b.vYJ[e.Cj]=i.ZBJ)},a.prototype.cdK=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o=this;o.pjK=b,u(b.name)||(o.Cj=B(b.name)),e=F(b,"items")||[],f=c.qo.getPivotCacheByName(c.iyc),g=f.getField(o.Zxc),h=g&&2===g.ny&&!u(g.dCc),o.ojK(e,o.Cj,c,h),u(b.sortType)||(i=b.sortType,j={},"ascending"===i?j.sortType=d.SortType.asc:"descending"===i&&(j.sortType=d.SortType.desc),o.zZ=j,o.zDc=j.sortType),u(b.fld)||(o.mi=+b.fld),u(b.baseField)||(o.baseField=z(b.baseField)),u(b.measureFilter)||(o.yDc=y(b.measureFilter)),k=y(b.showAll,!0),o.ZBJ=c.vYJ[g.Cj]=k,l=F(b,"extLst"),m=l&&F(l,"ext"),n=m&&F(m,"pivotField"),n&&n.fillDownLabels&&(a.options.fillDownLabels=y(n.fillDownLabels))},a.prototype.hEc=function(a,b,c,d,e,f,g){var h,i,k,l=this,m=g||l._items,n=[],o=0;for(d&&e&&m&&m[0]&&m[0].value!=="<"+j.formatDateToString(e)&&(n.push({indexValue:0}),o=1),h=0;h<m.length;h++)i=m[h],k={},u(i)||(u(i.childItems)||(k.childItems=i.childItems),u(i.expanded)||(k.expanded=i.expanded),u(i.drillAcross)||(k.drillAcross=i.drillAcross),u(i.calculatedMember)||(k.calculatedMember=i.calculatedMember),c[i.value]===!0&&(k.hidden=!0),u(i.missing)||(k.missing=i.missing),u(i.caption)||(k.caption=i.caption),u(i.character)||(k.character=i.character),b&&b[i.value]===!0&&(k.collapse=!0),u(i.type)||(k.type=i.type),u(i.indexValue)||(k.indexValue=d?i.indexValue+o:i.indexValue),n.push(k));return d&&f&&m&&m[m.length-1]&&m[m.length-1].value!==">"+j.formatDateToString(f)&&n.push({indexValue:n.length}),a&&n.push({type:"default"}),n},a.prototype.qjK=function(a,b,c,d,e,f,g){var h,i,k,l=this,m=g||l._items,n=[],o=0;for(d&&e&&m&&m[0]&&m[0].value!=="<"+j.formatDateToString(e)&&(n.push({n_:"item",x:0}),o=1),h=0;h<m.length;h++)i=m[h],k={n_:"item"},u(i)||(i.childItems&&(k.c="1"),i.expanded===!1&&(k.d="0"),i.drillAcross===!1&&(k.e="0"),i.calculatedMember&&(k.f="1"),c[i.value]===!0&&(k.h="1"),i.missing&&(k.m="1"),u(i.caption)||(k.n=i.caption),i.character&&(k.s="1"),b&&b[i.value]===!0&&(k.sd="0"),u(i.type)||(k.t=i.type),u(i.indexValue)||(k.x=d?i.indexValue+o:i.indexValue),n.push(k));return d&&f&&m&&m[m.length-1]&&m[m.length-1].value!==">"+j.formatDateToString(f)&&n.push({n_:"item",x:n.length}),a&&n.push({n_:"item",t:"default"}),n},a.prototype.LJJ=function(a){var b,c,d,e,f,g,h=this,i=a.oIJ(h.Zxc),j=i&&i.jGJ();if(j){b=[],c=i.xSJ,d=i.getFieldsItemList(),e=0;for(f in j)j.hasOwnProperty(f)&&(g=j[f],b[g]={indexValue:e,value:d[f],calculatedMember:!!c[d[f]]},e+=1)}return b},a.prototype.toJson=function(a){var b,c,f,g,h,i,j,k,l,m,n=this,o=n.Lqa?n.Lqa:{},p=a.layoutType(),q=a.Vyc;switch(p){case e.PivotTableLayoutType.outline:o.compact=!1,delete o.outline;break;case e.PivotTableLayoutType.tabular:o.compact=!1,o.outline=!1;break;case e.PivotTableLayoutType.compact:delete o.outline,delete o.compact}if(b=a.Vyc,o.axis=n.xDc(b.oyc[n.Cj]),u(a.options.subTotalsPosition)||(o.defaultSubtotal=a.options.subTotalsPosition!==e.SubtotalsPosition.none&&x),o.insertBlankRow=a.options.insertBlankLineAfterEachItem,u(n.yDc)||(o.measureFilter=n.yDc),u(n.Zxc)||(o.name=n.Zxc),u(n.zDc)||(c=void 0,n.zDc===d.SortType.asc?c="ascending":n.zDc===d.SortType.desc&&(c="descending"),o.sortType=c),o.subtotalTop=a.options.subTotalsPosition!==e.SubtotalsPosition.bottom&&x,u(n.mi)||(o.fld=n.mi),u(n.nBJ)||(o.numberFormat=n.nBJ),o.showAll=a.showNoData(n.Zxc),f=q.getLabelFilterInfo(n.Zxc),g=f&&f.textItem&&f.textItem.list,!u(n._items)&&(ia(n.Cj,q)||g)&&n._items.length>0){if(h=q.wyc&&q.wyc[n.Cj],i={},g&&g.length>0){for(j=0;j<n._items.length;j++)i[n._items[j].value]=!0;for(j=0;j<g.length;j++)i[g[j]]=!1}k=q.oIJ(n.Zxc),k&&(l=2===k.ny&&!u(k.dCc),m=n.LJJ(q),o.items=n.hEc(a.options.subTotalsPosition!==e.SubtotalsPosition.none,h,i,l,k.bCc,k.cCc,m))}return o},a.prototype.bdK=function(a){var b,c,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this,v=t.pjK?t.pjK:{n_:"pivotField"},w=a.layoutType(),y=a.Vyc;switch(w){case e.PivotTableLayoutType.outline:v.compact="0",delete v.outline;break;case e.PivotTableLayoutType.tabular:v.compact="0",v.outline="0";break;case e.PivotTableLayoutType.compact:delete v.outline,delete v.compact}if(v.name=C(t.Cj),b=a.Vyc,v.axis=t.xDc(b.oyc[t.Cj]),u(a.options.subTotalsPosition)||(v.defaultSubtotal=a.options.subTotalsPosition===e.SubtotalsPosition.none?"0":x),a.options.insertBlankLineAfterEachItem&&(v.insertBlankRow="1"),t.yDc&&(v.measureFilter="1"),u(t.zDc)||(c=void 0,t.zDc===d.SortType.asc?c="ascending":t.zDc===d.SortType.desc&&(c="descending"),v.sortType=c),a.options.subTotalsPosition===e.SubtotalsPosition.bottom&&(v.subtotalTop="0"),u(t.nBJ)||(g=f.ExtendedNumberFormatHelper.getFormatId(t.nBJ),h=g.id,i=g.isBuiltIn,i?v.numFmtId=h:(j={},j.numberFormat=new f.ExcelNumerFormat(h,t.nBJ),v.numFmtId=j.numberFormat.numberFormatId)),a.showNoData(t.Zxc)===!1&&(v.showAll="0"),k=y.getLabelFilterInfo(t.Zxc),l=k&&k.textItem&&k.textItem.list,!u(t._items)&&(ia(t.Cj,y)||l)&&t._items.length>0){if(m=y.wyc&&y.wyc[t.Cj],n={},l&&l.length>0){for(o=0;o<t._items.length;o++)n[t._items[o].value]=!0;for(o=0;o<l.length;o++)n[l[o]]=!1}p=y.oIJ(t.Zxc),p&&(q=2===p.ny&&!u(p.dCc),r=t.LJJ(y),s=t.qjK(a.options.subTotalsPosition!==e.SubtotalsPosition.none,m,n,q,p.bCc,p.cCc,r),v.c_=[{n_:"items",count:s.length+"",c_:s}])}return a.options.fillDownLabels===!0&&(v.c_=v.c_||[],v.c_.push({n_:"extLst",c_:[{n_:"ext",r_:[63,1],c_:[{n_:"pivotField",fillDownLabels:"1"}]}]})),v},a.prototype.hyc=function(){var a=this;a.zZ=t,a._items=t,a.ayc=t,a.nBJ=t,a.xFJ=t,a.Lqa=t,a.pjK=t,a.ZBJ=t},a}(),b.PivotViewField=O;function V(a,b,c,d,e,f,g,h,i){var j,k,l,m,o,p,q;return void 0===i&&(i=!1),d&&d.valueFilter&&(j=d.valueFilter),k=1===f||2===f,l=2===f,d&&d.cyc(i)?(o=void 0,p=!1,q=!1,n(g.DBc)||u(h)||!u(g.tnb)||(p=!0,q=g.bCc instanceof Date),o=p?q?Y(d,g,h,i):X(d,g,h,i):W(d,g,i),{isDim:k,isHeader:l,sourceName:b,displayName:a,items:o.rs,filterItems:o.ds,index:c,isALL:!1,valueFilter:j,sortInfo:e}):{isDim:k,isHeader:l,sourceName:b,displayName:a,items:m,filterItems:null,index:c,isALL:!0,valueFilter:j,sortInfo:e}}b.toPivotViewQueryField=V;function W(a,b,c){var e=[],f=[],g=b.getFieldsItemList(),h=b.dGc();return d.Yxc(g,function(b){var d=n(h)?b:h[b];a.isMatchedLabelItem(b,c)?e.push(d):f.push(d)}),{rs:e,ds:f}}function X(a,b,c,e){var f,g=[],h=[],i=c.vzc,j=b.getFieldsItemList(),k={};d.Yxc(i,function(c){var d=b.lBc(c);e||a.evaluateLabelCondition(c+"")?k[d]=!0:k[d]!==!0&&(k[d]=!1)}),d.Yxc(j,function(b){a.isInLabelFilterItem(b+"")&&k[b]||(k[b]=!1)});for(f in k)k.hasOwnProperty(f)&&k[f]?g.push(f):h.push(f);return{rs:g,ds:h}}function Y(a,b,c,e){var f,g=[],h=[],i=c.vzc,j=b.getFieldsItemList(),k=c.vBc,l=c.Eyc,m={};d.Yxc(j,function(a){m[a]=[]}),d.Yxc(i,function(c){var f=b.lBc(c);(e||a.evaluateLabelCondition(c+""))&&(m[f]=d.GIc(m[f],k[l[c]]))}),d.Yxc(j,function(b){a.isInLabelFilterItem(b+"")||(m[b].length=0)});for(f in m)m.hasOwnProperty(f)&&(m[f].length>0?g.push(m[f]):h.push(m[f]));return{rs:g,ds:h}}function Z(a){var b,c={filterType:1};return c.isBottom=a.type===-1?1:0,c.percent=1===a.compareType?1:0,b=a.expected?1:0,u(b)||(c.value=b,c.filterValue=b),c}function $(a){var b,c,d,e;if(!u(a.compareType))return b={filterType:4},b.filter1={},c=a.compareType,d=void 0,e=void 0,6===c?(d=5,e=3,b.and=!0):(d=c,e=c),b.filter1.operator=d,a.item1&&!u(a.item1.expected)&&(b.filter1.value=a.item1.expected),a.item2&&!u(a.item2.expected)&&(b.filter2={},b.filter2.operator=e,b.filter2.value=a.item2.expected),b}function _(a){var b,c,d;if(u(a.value1)?u(a.item1)||(b=a.item1.expected):b=a.value1,u(a.value2)?u(a.item2)||(c=a.item2.expected):c=a.value2,!c){switch(d=-1,a.compareType){case 0:return{filterType:3,filter:[b]};case 1:d=1;break;case 2:b+="*";break;case 3:d=1,b+="*";break;case 4:b="*"+b;break;case 5:d=1,b="*"+b;break;case 6:b="*"+b+"*";break;case 7:d=1,b="*"+b+"*"}return{filterType:4,filter1:{operator:d,value:b}}}return 12===a.compareType?{filterType:4,filter1:{operator:3,value:b},filter2:{operator:5,value:c}}:13===a.compareType?{filterType:4,filter1:{operator:4,value:b},filter2:{operator:2,value:c}}:void 0}function aa(a){var b,c,d,e,f,g,h=new Date,i=h.getDay(),j=h.getDate(),k=new Date(h),m=new Date(h);switch(a){case 11:k.setDate(j-6);break;case 9:k.setDate(j-1);break;case 8:break;case 10:k.setDate(j+1);break;case 16:k.setDate(j-i-7),m.setDate(j-i-1);break;case 15:k.setDate(j-i),m.setDate(j-i+6);break;case 17:k.setDate(j-i+7),m.setDate(j-i+13);break;case 13:k.setDate(1),k.setMonth(k.getMonth()-1),m.setDate(0);break;case 12:k.setDate(1),m.setMonth(m.getMonth()+1),m.setDate(0);break;case 14:k.setDate(1),k.setMonth(k.getMonth()+1),m.setMonth(m.getMonth()+2),m.setDate(0);break;case 18:b=k.getMonth()-k.getMonth()%3+1+3,c=b+3+3,k.setDate(1),k.setMonth(b),m.setMonth(c),m.setDate(0);break;case 19:d=k.getMonth()-k.getMonth()%3+1,e=d+3,k.setDate(1),k.setMonth(d),m.setMonth(e),m.setDate(0);break;case 20:f=k.getMonth()-k.getMonth()%3+1-3,g=d+3-3,k.setDate(1),k.setMonth(f),m.setMonth(g),m.setDate(0);break;case 21:k.setDate(1),k.setMonth(1),k.setFullYear(k.getFullYear()+1),m.setFullYear(m.getFullYear()+2),m.setMonth(0),m.setDate(0);break;case 22:k.setDate(1),k.setMonth(1),m.setFullYear(m.getFullYear()+1),m.setMonth(0),m.setDate(0);break;case 23:k.setDate(1),k.setMonth(1),k.setMonth(k.getFullYear()-1),m.setMonth(0),m.setDate(0);break;case 40:k.setMonth(0,1),k.setHours(0,0,0,0),m.setHours(23,59,59,999)}return k.setHours(0),k.setMinutes(0),k.setSeconds(0),m.setHours(23),m.setMinutes(59),m.setSeconds(59),{from:l.Ra(k),to:l.Ra(m)}}function ba(a,b){var c,d,e=u(a.compareType)?a.operator:a.compareType;if(e>=8&&e<=23||40===e)c={filterType:2,type:b},d=aa(e),d.from&&d.to&&(c.value=d.from,c.maxValue=d.to);else if(e>=24&&e<=39)c={filterType:2,type:b};else if(e>=0&&e<=7)return $(a);return c}function ca(a,b){var c=a.conType;return 3===c?Z(a):2===c?$(a):0===c?_(a):1===c?ba(a,b):void 0}function da(a,b){var c,d,e={n_:"autoFilter",ref:"A1"},g=[];return a&&(a.forEach(function(a){var c,d,e,f,h;a&&(c=a.conditions,d=c[0],e={},f=ca(d,b),u(f)||(h=f.filterType,1===h?e.top10=f:2===h?e.dynamicFilter=f:4===h?e.customFilters=f:3===h&&(e.filters=f)),g.push(e))}),d=[],g.forEach(function(a){var b,c,e,g,h,i,k,l,m,n,o={n_:"filterColumn",colId:0};u(a.hiddenButton)||(o.hiddenButton=a.hiddenButton?1:0),(a.colorFilter||a.top10||a.filters||a.dynamicFilter||a.customFilters)&&(o.c_=[],b=void 0,u(a.top10)?u(a.dynamicFilter)?u(a.customFilters)?u(a.filters)||(m=a.filters,b={n_:"filters"},m.blank&&(b.blank=1),u(m.dateGroupItem)&&u(m.filter)||(n=b.c_=[]),m.filter&&m.filter.forEach(function(a){f.StringEx.M9(a)||n.push({n_:"filter",val:C(a)})}),m.dateGroupItem&&m.dateGroupItem.forEach(function(a){var b={n_:"dateGroupItem"};a.year>0&&(b.year=a.year),a.month>=0&&a.month<12&&(b.month=a.month),a.day>0&&a.day<32&&(b.day=a.day),a.hour<24&&(b.hour=a.hour),a.minute<60&&(b.minute=a.minute),a.second<60&&(b.second=a.second),b.dateTimeGrouping=a.day,n.push(b)}),o.c_.push(b)):(h=a.customFilters,u(h.filter1)&&u(h.filter2)||(b={n_:"customFilters"},h.and&&(b.and=1),i=void 0,u(h.filter1)&&u(h.filter2)||(i=b.c_=[]),u(h.filter1)||(k={n_:"customFilter"},l=j.PivotComparisonOperators[h.filter1.operator],"none"!==l&&(k.operator=l),k.val=h.filter1.value+"",i.push(k)),u(h.filter2)||(k={n_:"customFilter"},l=j.PivotComparisonOperators[h.filter2.operator],"none"!==l&&(k.operator=l),k.val=h.filter2.value+"",i.push(k)),o.c_.push(b))):(e=a.dynamicFilter,u(e.type)||(b={n_:"dynamicFilter"},g=e.type,g&&(b.type=g),u(e.value)||(b.val=e.value),u(e.maxValue)||(b.maxVal=e.maxValue),o.c_.push(b))):(c=a.top10,b={n_:"top10"},c.isBottom&&(b.top="0"),c.percent&&(b.percent="1"),isNaN(c.value)||(b.val=c.value+""),isNaN(c.filterVal)||(b.filterVal=c.filterVal+""),o.c_.push(b))),d.push(o)}),e.c_=d),e}P=function(){function a(b,c,d,e){var f,g=this;g.Cj=b,g.iyc=c,g.qo=d,g.wu=e,g.jyc=[],g.kyc=[],g.lyc=[],g.myc=[],g.nyc=[],g.oyc={},g.zZ={},g.LFc=[],g.WIJ={allowMultipleFiltersPerField:!0},g.IUJ=new M,g.JUJ={},f=g.qo&&g.qo.getPivotCacheByName(c),g.KUJ=f&&f.getAllFieldsNames(),a.ao(g,"init")}return a.prototype.wYJ=function(a,b){var c,d,e=this,f=e.vYJ;return u(f)&&(e.vYJ={},f=e.vYJ),c=e.oIJ(a),d=c&&(c.SDc||c.Cj),u(b)?f[d]||!1:!b!=!f[d]?(f[d]=!!b,!0):void 0},a.prototype.ySJ=function(a,c,d,e){var f=this,g=f.iyc,h=this.qo,i;try{i=h.getPivotCacheByName(g).updateCalcItem(a,c,d,e,f.MUJ())}catch(a){b.throwError(p().PivotTableErrorFormula)}return i&&(f.zyc=!0),i},a.prototype.zSJ=function(a){var b=this,c=b.iyc,d=this.qo;return d.getPivotCacheByName(c).getCalcItems(a)},a.prototype.ASJ=function(a,b){var c=this,d=c.iyc,e=this.qo,f=e.getPivotCacheByName(d).removeCalcItem(a,b),g=c.BSJ(a)[0];return g&&f&&(c.ESJ(a,!0),g.qLc(c),c.zyc=!0),f},a.prototype.CSJ=function(a,c,d){var f,g,h,i,j,k,l,m,n=this,o=n.BSJ(a);for(g=0,h=o;g<h.length;g++)if(i=h[g],n.oyc[i.Cj]!==e.PivotTableFieldType.valueField){f=i;break}if(u(f)||!n.EUJ(f.Cj,c))return!1;j=n.iyc,k=this.qo,l=k.getPivotCacheByName(j);try{m=l.addCalcItem(a,c,d,n.MUJ())}catch(a){b.throwError(p().PivotTableErrorFormula)}return m!==!1&&(n.zyc=!0,n.ESJ(a),f&&f.qLc(n)),m},a.prototype.MUJ=function(){var a,b,c,d=this,f=d.ryc(e.PivotTableFieldType.rowField).concat(d.ryc(e.PivotTableFieldType.columnField)),g=[];for(a=0,b=f;a<b.length;a++)c=b[a],g.push(c.Zxc);return g},a.prototype.FSJ=function(a){var b=this,c=b.iyc,d=this.qo,f=d.getPivotCacheByName(c);if(!u(f))return u(a)?f.aggregateCalcItem():f.aggregateCalcItem(a===e.CalcItemAggregation.include)},a.prototype.wSJ=function(a){var b,c,d,e=this,f=e.iyc,g=this.qo,h=g.getPivotCacheByName(f).getField(a),i=h.GSJ,j={};for(b=0,c=i;b<c.length;b++)d=c[b],j[d]=!0;return j},a.prototype.ESJ=function(a,b){var c,d=this,e=d.ZIJ(a);e&&(c=e.textGroup&&e.textGroup.fieldName,d.gGc(c,null,!0),b&&d.modifyGroupInfoByCalcItem(e),d.UCc(e))},a.prototype.modifyGroupInfoByCalcItem=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=a.originFieldName,q=o.iyc,r=this.qo,s=r.getPivotCacheByName(q),t=s.getField(p);if(t&&(b=t.dGc()||{},c=a.textGroup&&a.textGroup.groupItems,d=c&&Object.keys(c),!(u(d)||d.length<1))){for(f=0,g=d;f<g.length;f++){for(h=g[f],e=c[h],i=0;i<e.length;)u(b[e[i]])?e.splice(i,1):i++;0===e.length&&delete c[h]}if(0===Object.keys(c).length){for(j={},k=Object.keys(b),l=0,m=k;l<m.length;l++)n=m[l],j[n]=n;a.textGroup.groupItems=j}}},a.prototype.EUJ=function(a,b){var c=this;return c.checkGroup(a)&&c.checkSubTotal()&&c.checkField(a)&&c.checkFieldItem(a,b)},a.prototype.checkField=function(a){var c,d,f,g,h,i,j,k=this,l=k.oyc[a];if(l===e.PivotTableFieldType.filterField)return!1;if(c=k.ryc(e.PivotTableFieldType.valueField),
d={},c&&c.length>1)for(f=0,g=c;f<g.length;f++)h=g[f],d[h.Zxc]?b.throwError(p().PivotTableCalcItemHasMultipleDataField):d[h.Zxc]=!0;for(i=0,j=c;i<j.length;i++)h=j[i],k.BSJ(h.Zxc).length>1&&b.throwError(p().PivotTableCalcItemHasTowCacheField);return!0},a.prototype.checkSubTotal=function(a){var c,f,g=this,h=g.ryc(e.PivotTableFieldType.valueField);if(h&&h.length)switch(c=h[0],f=a,u(a)&&(f=g.KBJ(c.Cj)),f){case d.SubtotalType.average:case d.SubtotalType.stdDev:case d.SubtotalType.stdDevp:case d.SubtotalType.varr:case d.SubtotalType.varp:b.throwError(p().PivotTableSubtotalType)}return!0},a.prototype.checkFieldItem=function(a,c){var d,e,f,g,h,i,j=this,k=j.getFieldInfoByName(a);return!u(k)&&(d=j.iyc,e=this.qo,f=e.getPivotCacheByName(d).getField(k.Zxc),g=f.getFieldsItemList(),h=g.indexOf(c),i=f.zSJ(),h>=0&&i.indexOf(c)<0&&b.throwError(p().PivotTableHasSameItemName),!0)},a.prototype.checkGroup=function(a){var c,d,e,f,g,h=this,i=h.wHJ();for(d=0,e=i;d<e.length;d++)f=e[d],c=h.xHJ(f.name),u(c)||u(c.dateGroups)&&u(c.numberGroup)||b.throwError(p().PivotTableHasNumberOrDateGroup);return g=h.HLc(a),g.HSJ()&&b.throwError(p().PivotTableHasNumberOrDateGroup),!0},a.prototype.HSJ=function(a){var b=this,c=b.oIJ(a);if(c)return!!c.SDc},a.prototype.ISJ=function(a){var b=this,c=b.iyc,d=this.qo,e=d.getPivotCacheByName(c).getField(a);return e.hasCalcItem()},a.prototype.JSJ=function(){var a,b,c,d=this,e=d.iyc,f=this.qo,g=f.getPivotCacheByName(e).getHeaderList();if(g&&g.length)for(a=0,b=g;a<b.length;a++)if(c=b[a],d.ISJ(c.name))return!0;return!1},a.prototype.BSJ=function(a){var b,c,d,e=this,f=[],g=e.ryc();for(b=0,c=g;b<c.length;b++)d=c[b],d.Zxc===a&&f.push(d);return f},a.prototype.DHJ=function(){var a=this,b=a.qo.getPivotCacheByName(a.iyc);return b.getDataRefer()},a.prototype.wHJ=function(){var a=this,b=a.qo.getPivotCacheByName(a.iyc),c=[];return b&&(c=b.getHeaderList()),c},a.prototype.bCJ=function(a,b,c){var d=this,e=d.LFc,f=e.indexOf(a);f>-1&&e.splice(f,1),b&&(u(c)?e.push(a):e.splice(c,0,a))},a.prototype.setSigmaValuePosition=function(a,b){var c=this,e=c.getSigmaValuePosition(),f=e.positionType,g=e.positionIndex;u(a)||a!==d.DataPosition.row&&a!==d.DataPosition.col||(c.pyc=a),!u(b)&&b>=0&&(c.qyc=b),c.RVa({position:f,valuesIndex:g,type:"updateValuePosition"})},a.prototype.getSigmaValuePosition=function(){var a=this,b=a.myc.length>1,c=a.qyc;return{positionType:a.pyc,positionIndex:c,display:b}},a.prototype.KBJ=function(a,b){var c,d=this,e=d.getFieldInfoByName(a);if(e){if(c=e.getSubTotalType(),1===arguments.length)return c;if(c===b)return;d.JSJ()&&!u(b)&&d.checkSubTotal(b),e.setSubTotalType(b),d.zyc=!0,this.RVa({fieldName:a,subtotalType:c,type:"subTotalType"})}},a.prototype.tBJ=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=this;if(!u(a)){for(b=a.fieldsInfo,c=0;c<=3;c++)n.JDc(c);for(n.setSigmaValuePosition(a.valueInfo.positionType,a.valueInfo.positionIndex),d=0;d<4;d++)for(e=b[d],f=0;f<e.length;f++)g=e[f],h=g.sourceName,i=g.displayName,j=g.subtotal,n.addFieldByName(h,i,d,j);for(c=0;c<4;c++)for(e=b[c],f=0;f<e.length;f++)g=e[f],h=g.sourceName,k=g.valueFilter,l=g.labelFilter,m=g.sortInfo,!l||u(l.condition)&&u(l.textItem)||n.setLabelFilterInfo(h,l),k&&!u(k.condition)&&n.setValueFilterInfo(h,k),u(m)||n.setSortInfo(h,m)}},a.prototype.vBJ=function(){var a,b,c,d,e,f,g=this,h=[],i=g.getSigmaValuePosition();for(a=0;a<4;a++){for(b=g.ryc(a),c=[],d=0;d<b.length;d++)e=b[d],f={sourceName:e.Zxc,displayName:e.Cj},f.subtotal=e.fyc,f.labelFilter=g.getLabelFilterInfo(e.Cj),f.valueFilter=g.getValueFilterInfo(e.Cj),f.sortInfo=e.zZ,c.push(f);h[a]=c}return{fieldsInfo:h,valueInfo:i}},a.prototype.GLc=function(a){var b,c,e,f,g,h,i,j=this,l=j.Iyc,m=l.lGc,n={},o=[],p=!0,q={},r={},s=j.qo.getPivotCacheByName(j.iyc);if(!u(l)){if(d.Yxc(a,function(a){b=j.HLc(a.fieldName),u(b)||(r[a.fieldName]=b.ny,q[a.fieldName]=u(b.SDc)?b.vzc:b.kBc,n[a.fieldName]=a.fieldItem)}),u(n))c=!0;else{for(f=0,g=l.Iyc;f<g.length;f++){h=g[f],p=!0,e=h.path;for(i in n)if(k(n,i)&&q[i][e[m[i]]]!==n[i]){p=!1;break}p&&(o=o.concat(h.indexes))}c=!1}return s.XLc(o,c)}},a.prototype.HLc=function(a){var b=this,c=b.getFieldInfoByName(a);if(!u(c))return b.oIJ(c.Zxc)},a.prototype.kLc=function(b){var c=this,d=c.iyc,e=c.qo.getPivotCacheByName(d),f=c.Cj,g={cmd:"updatePivotCache",sheetName:b.name(),cmdOption:{pivotCacheName:d,pivotCache:e,ptName:f}};c.wu.execute(g),c.HL=x,a.ao(c,"updatePivotCache")},a.prototype.lLc=function(){var a=this;a.mLc(),a.zyc=!0,a.syc()},a.prototype.mLc=function(){var a,b=this,c=b.ryc(),d=c.length,e=b.iyc,f=b.qo.getPivotCacheByName(e);for(a=0;a<d;a++)f.LSb(c[a].Zxc)?c[a].qLc(b):(b.IDc(c[a].Cj),b.XJJ(c[a].Cj))},a.prototype.XJJ=function(a){var b,c=this,d=c.HL;if(d&&d.length>0)for(b=d.length-1;b>=0;b--)d[b].Cj===a&&d.splice(b,1)},a.prototype.getName=function(){return this.Cj},a.prototype.getAllFieldNameList=function(){var a=this.qo.getPivotCacheByName(this.iyc);return a?a.getAllFieldsNames():[]},a.prototype.getAllFieldNameListWithoutCalcField=function(a){var b,c,d,e=this.qo.getPivotCacheByName(this.iyc),f=[];if(e){b=e.HL;for(c in b)b.hasOwnProperty(c)&&(d=b[c],!u(d.Yw)||a&&(2!==d.ny||!u(d.SDc)&&d.SDc!==d.Cj)||f.push(c))}return f},a.prototype.clone=function(){var b=this,c=new a(b.Cj,b.iyc,b.qo,b.wu),d=j._AJ(b.jyc),e=j._AJ(b.kyc),f=j._AJ(b.lyc),g=j._AJ(b.myc),h=j._AJ(b.oyc);return c.jyc=d?d:[],c.kyc=e?e:[],c.lyc=f?f:[],c.myc=g?g:[],c.oyc=h?h:[],c.nyc=[].concat(b.nyc),c.pyc=b.pyc,c.qyc=b.qyc,c},a.prototype.getAllFieldInfo=function(){var a=this,b=a.getAllFieldNameList(),c=[];return d.Yxc(b,function(b){var d=a.ADc(b);d?c.push({fieldName:d.Cj,sourceName:b,isFilter:a.IUJ.isFilter(d.Zxc),isDims:!0}):c.push({fieldName:b,sourceName:b,isFilter:a.IUJ.isFilter(b),isDims:!1})}),c},a.prototype.getFieldInfoByName=function(a){var b=this,c=b.oyc[a],d=b.ryc(c);return d?T(d,a):t},a.prototype.oBJ=function(a){var b,c,d=this,e=d.HL;if(e)for(b=e.length,c=0;c<b;c++)if(a===e[c].Cj)return e[c]},a.prototype.ADc=function(a){var b=this,c=b.ryc();return c?U(c,a):t},a.prototype.addPivotView=function(a){this.nyc.push(a),this.syc()},a.prototype.removePivotView=function(a){var b,c;for(b=0;b<this.nyc.length;b++)if(c=this.nyc[b],c===a)return void this.nyc.splice(b,1);0===this.nyc.length&&this.dispose()},a.prototype.syc=function(a,b){var c,d,e;for(c=0;c<this.nyc.length;c++)d=this.nyc[c],e=d instanceof h.PivotTable,a&&e||e&&d.Lia>0||d.paint(a,b)},a.prototype.tyc=function(){var a,b;for(a=0;a<this.nyc.length;a++)b=this.nyc[a],b instanceof h.PivotTable&&b.adjustRange()},a.prototype.cJJ=function(a,b){var c=this.qo.getPivotCacheByName(this.iyc),d=c.LSb(a);return u(d)||(b=d.Cj),b},a.prototype.OIJ=function(a,b,c){var e=this.qo.getPivotCacheByName(this.iyc),f=e.LSb(a);return u(c)&&(c=f.ny===d.PivotDataType.number?d.SubtotalType.sum:d.SubtotalType.count),u(f)||(b=f.Cj),p()["SubtotalType_Prefix_"+c]+b},a.prototype.vyc=function(a){var b=this.qo.getPivotCacheByName(this.iyc),c=b.LSb(a);return c.ny===d.PivotDataType.number?d.SubtotalType.sum:d.SubtotalType.count},a.prototype.getSortInfo=function(a){return this.zZ[a]},a.prototype.setSortInfo=function(a,b){var c,e,f=this,g=j._AJ(f.zZ[a]),h=f.getFieldInfoByName(a);b&&b.sortValueFieldName&&(c=f.getFieldInfoByName(b.sortValueFieldName),u(c)||(b.cacheName=c&&c.Zxc,b.sortValueSubtotalText=d.SubtotalType[c.fyc])),u(h)||(f.zZ[a]=b,h.setSortInfo(b),e=this.qo.getPivotCacheByName(this.iyc),e.setSortInfo(h.Zxc,!0),this.zyc=!0,f.RVa({type:"setSortInfo",fieldName:a,sortInfo:g}))},a.prototype.clearSortInfo=function(a){var b,c,d=this,e=d.getFieldInfoByName(a);u(e)||(b=j._AJ(d.zZ[a]),delete d.zZ[a],e.setSortInfo(t),c=this.qo.getPivotCacheByName(this.iyc),c.setSortInfo(e.Zxc,!1),this.zyc=!0,d.RVa({type:"setSortInfo",fieldName:a,sortInfo:b}))},a.prototype.setCollapse=function(a,b,c){var d,e=this.wyc;e||(e=this.wyc={}),e[a]||(e[a]={}),d=e[a][b],e[a][b]=c,this.RVa({fieldName:a,item:b,isCollapse:d,type:"setCollapse"})},a.prototype.getCollapse=function(a,b){var c=this.wyc;return c&&c[a]?c[a][b]:t},a.prototype.addField=function(a,c,f){var g,h,i,j;(c>3||c<0)&&b.throwError("wrong area code"),g=this,h=g.ryc(c),g.PJJ(a.Cj)&&c!==e.PivotTableFieldType.valueField||(u(f)?f=h.length:(i=this.getSigmaValuePosition(),j={1:d.DataPosition.row,2:d.DataPosition.col},i.display&&j[c]===i.positionType&&(f<=i.positionIndex?g.setSigmaValuePosition(i.positionType,i.positionIndex+1):f--)),g.yyc(h,a,c,f),g.oyc[a.Cj]=c,g.JUJ[a.Cj]=a.Zxc,0!==c&&(g.zyc=!0))},a.prototype.PIJ=function(a){var b,c,d,e=2,f=this;if(!u(a)){for(b=a.substr(a.length-1,1),c="_",isNaN(+b)&&(c=""),d=a;f.oyc[a]&&!(e>100);)a=d+c+e,e++;return a}},a.prototype.getFilterInfo=function(a){return this.IUJ.get(a)},a.prototype.isFilter=function(a){return this.IUJ.isFilter(a)},a.prototype.changeFieldName=function(a,b){var c,d=a.Cj,f=this.oyc[a.Cj];return!(u(b)||""===b||!b)&&(this.oyc[d]===e.PivotTableFieldType.valueField&&this.changeValueFilterName(d,b),this.changeValueArray(d,b),d&&b&&b.length>0&&(a.Cj=b,delete this.oyc[d],this.oyc[a.Cj]=f,c=this.JUJ[d],delete this.JUJ[d],this.JUJ[b]=c),this.RVa({fieldName:b,oldFieldName:d,type:"changeFieldName"}),!0)},a.prototype.changeValueArray=function(a,b){var c=this,e=c.LFc;d.Yxc(e,function(c,d){c===a&&(e[d]=b)})},a.prototype.changeValueFilterName=function(a,b){var c,d,e=this;for(d=0;d<4;d++)c=e.ryc(d),c.forEach(function(c){c.eyc&&c.eyc.valueFilter&&c.eyc.valueFilter.conditionByName===a&&(c.eyc.valueFilter.conditionByName=b)})},a.prototype.isFieldExist=function(a){return!u(this.oyc[a])},a.prototype.isFieldActualExist=function(a){var b=this,c=b.getAllFieldNameList();return b.KUJ||(b.KUJ=c),b.KUJ.indexOf(a)>-1||c.indexOf(a)>-1&&(b.KUJ=c,!0)},a.prototype.bGc=function(a){var b=this.getFieldInfoByName(a);return this.lBJ(b?b.Zxc:a)},a.prototype.lBJ=function(a){var b=this.oIJ(a);return b&&b.ny},a.prototype.cGc=function(a){var b=this.getFieldInfoByName(a),c=this.oIJ(b.Zxc);return c.BBc()},a.prototype.refreshShowDataAs=function(a,b,c){var d,e,f,g=this,i=g.nyc;for(d=0,e=i;d<e.length;d++)f=e[d],f instanceof h.PivotTable&&f.MJJ(a,b,c)},a.prototype.changeFieldArea=function(a,c,d){var f,g,h,i,j,k,l,m,n,o,q,r,s,x,y=this,z=y.oyc[a],A=y.getFieldInfoByName(a);if(u(A))return!1;if(f=y.HLc(a),(!f||u(f.Yw)||c===e.PivotTableFieldType.valueField)&&!(z<0||u(z)||y.PJJ(a)&&c!==e.PivotTableFieldType.valueField)){if(f.hasCalcItem()&&c===e.PivotTableFieldType.filterField&&b.throwError(p().PivotTableMoveCalcItemFieldToReport),g=c!==z,c in e.PivotTableFieldType&&g&&(h=[e.PivotTableFieldType.rowField,e.PivotTableFieldType.columnField],i=h.indexOf(c)!==-1,j=h.indexOf(z)!==-1,i&&j&&(g=!1)),k=y.ryc(z),l=S(k,a),m=y.getSigmaValuePosition(),m.display&&m.positionType===c-1&&m.positionIndex===l&&l===d&&z===c)return void y.setSigmaValuePosition(m.positionType,m.positionIndex+1);A=y.getFieldInfoByName(a),A&&y.refreshShowDataAs(a,!1,c),c===e.PivotTableFieldType.valueField&&z!==e.PivotTableFieldType.valueField&&(n=y.PIJ(y.OIJ(A.Zxc,a)),y.changeFieldName(A,n),y.KBJ(A.Cj,y.vyc(A.Zxc))),c!==e.PivotTableFieldType.valueField&&z===e.PivotTableFieldType.valueField&&(y.clearValueFilterOfValueField(A.Cj),y.KBJ(A.Cj,t)),A=y.IDc(A.Cj),m=y.getSigmaValuePosition(),o=m.display,q=m.positionType,r=m.positionIndex,c===z&&l<d&&(s=v(l,d),x=w(l,d),o&&q===c-1&&r<=s&&r>x&&d--),c!==e.PivotTableFieldType.valueField&&z===e.PivotTableFieldType.valueField&&(A.Cj=A.Zxc),y.addField(A,c,d),y.zyc=g,c===e.PivotTableFieldType.filterField&&y.tyc()}},a.prototype.removeFieldOrSigmaByName=function(a){var b=this,c;return a===p().sigmaValue?(b.JDc(e.PivotTableFieldType.valueField),p().sigmaValue):(c=b.getFieldInfoByName(a),c&&b.refreshShowDataAs(a,!0),c=b.IDc(a))},a.prototype.IDc=function(a){var b,c,e=this,f=e.oyc[a],g=e.ryc(f),h=S(g,a);if(!(u(f)||h<0))return b=e.getSigmaValuePosition(),c={1:d.DataPosition.row,2:d.DataPosition.col},b.display&&b.positionType===c[f]&&b.positionIndex>h&&e.setSigmaValuePosition(b.positionType,b.positionIndex-1),e.cCJ(a)},a.prototype.cCJ=function(a){var b=this,c=b.oyc[a],d=b.ryc(c),e=S(d,a);return delete b.oyc[a],b.zyc=!0,b.dCJ(c,e)},a.prototype.EJJ=function(a){var b=this,c=b.ryc(e.PivotTableFieldType.valueField);d.Yxc(c,function(c){c.xFJ&&c.xFJ.baseFieldName===a&&(d.Yxc(b.nyc,function(a){0===a.FJJ&&j.GJJ(a,c.Cj,c.xFJ.showDataAs)}),delete c.xFJ)})},a.prototype.clearValueFilterOfValueField=function(a){var b,c,d,f=this;for(c=e.PivotTableFieldType.rowField;c<=e.PivotTableFieldType.columnField;c++)for(b=f.ryc(c),d=b.length-1;d>=0;d--)u(b[d].eyc)||u(b[d].eyc.valueFilter)||b[d].eyc.valueFilter.conditionByName!==a||f.clearFilterInfo(b[d].Cj,2);f.zyc=!0},a.prototype.JDc=function(a){var b,c=this,d=c.ryc(a);if(!u(d)&&d.length>0){for(b=d.length-1;b>=0;b--)c.refreshShowDataAs(d[b].Cj,!0),c.IDc(d[b].Cj);c.zyc=!0}},a.prototype.yyc=function(a,b,c,f){var g,h=this;u(f)?a.push(b):(g=a.length,f=v(g,f),f=w(0,f),a.splice(f,0,b)),c===e.PivotTableFieldType.valueField&&(u(h.pyc)&&(h.pyc=d.DataPosition.col),u(h.qyc)&&(h.qyc=0)),h.RVa({fieldName:b.Cj,area:c,index:f,type:"removeField"})},a.prototype.dCJ=function(a,b){var c,d,e,f,g=this,h=g.ryc(a);return u(b)||b<0||b>=h.length?void 0:(c=h.splice(b,1)[0],u(c)||(d=void 0,e=void 0,f=c.eyc,f&&(f.labelFilter&&(d=f.labelFilter.condition?f.labelFilter.condition.toJSON():{textItem:Q({},f.labelFilter.textItem)}),e=f.valueFilter?{conditionByName:f.valueFilter.conditionByName,condition:f.valueFilter.condition.toJSON()}:t),g.RVa({fieldName:c.Cj,sourceName:c.Zxc,labelFilter:d,valueFilter:e,sortInfo:j._AJ(c.zZ),subtotalType:c.fyc,valueFilterIndex:this.LFc.indexOf(c.Cj),area:a,index:b,type:"addField"})),c)},a.prototype.fNc=function(a){var b=this,c=b.qo.getPivotCacheByName(b.iyc);c.removeCalcField(a),b.zyc=!0},a.prototype.ryc=function(a){var b=this;switch(a){case 0:return b.lyc;case 1:return b.jyc;case 2:return b.kyc;case 3:return b.myc;default:return[].concat(this.jyc,this.kyc,this.lyc,this.myc)}},a.prototype.getLabelQueryField=function(){var a=this,b=a.Dyc(),c=a.getAllFieldNameList(),e=[],f=a.qo.getPivotCacheByName(a.iyc);return d.Yxc(b,function(b){var d,g=f.LSb(b.Zxc),h=u(g.SDc)?void 0:f.LSb(g.SDc),i=a.getFilterInfo(b.Zxc);i&&i.iOa&&(a.zyc=!0,i.iOa=!1),d=c.indexOf(b.Zxc),d!==-1&&c.splice(d,1),e.push(b.toPivotViewQueryField(i,a.oyc[b.Cj],g,h))}),d.Yxc(c,function(b){var c,d,g=a.getFilterInfo(b);g&&g.labelFilter&&(c=f.LSb(b),d=u(c.SDc)?void 0:f.LSb(c.SDc),e.push(V(b,b,-1,g,x,-1,c,d)))}),e},a.prototype.Fyc=function(){var a={};return d.Yxc(this.jyc,function(b){var c=b.Cj;a[c]=1}),d.Yxc(this.kyc,function(b){var c=b.Cj;a[c]=2}),a},a.prototype.getSubtotalQueryField=function(){var a=this.Gyc(),b=[],c={};return d.Yxc(a,function(a){b.push(a.toPivotViewSubTotalFields()),c[a.Cj]=a.getSubTotalType()}),{valueFieldsSubtotalMap:c,queryFields:b}},a.prototype.getSortMap=function(a){var b=this,c={},e={};return d.Yxc(a,function(a){var f,g,h,i,j,k,l,m=a.sourceName,n=a.sortInfo,o={};if(!u(n))if(n.customSortInfo){if(f=b.oIJ(m),g=f.ny,h=f.BBc(),i=f.dGc(),j=n.customSortInfo(h.concat(),{sortType:d.SortType.custom,isDate:g===d.PivotDataType.date}),j&&j.length>0){for(k=0,l=j.length;k<l;k++)o[i[j[k]]]=k;c[m]=o}}else e[m]=n.sortType}),{customSortMap:c,normalSortMap:e}},a.prototype.Dyc=function(){return[].concat(this.jyc,this.kyc,this.lyc)},a.prototype.Gyc=function(){return this.myc},a.prototype.$xc=function(a){return this.qo.getPivotCacheByName(this.iyc).LSb(a).mi},a.prototype.kOc=function(a){var b=this.qo.getPivotCacheByName(this.iyc).LSb(a);return b.$Fc?b.$Fc:b.mi},a.prototype.uHJ=function(a){var b=this.qo.getPivotCacheByName(this.iyc).LSb(a);return u(b)?{}:{startValue:b.bCc,endValue:b.cCc}},a.prototype._xc=function(a){return this.qo.getPivotCacheByName(this.iyc).LSb(a).getFieldsItemList()},a.prototype.byc=function(a){var b=this.oIJ(a),c=b.Eyc;return(u(c)||0===Object.keys(c).length)&&this.qo.getPivotCacheByName(this.iyc).IGJ([a]),b.Eyc},a.prototype.oIJ=function(a){var b=this.qo.getPivotCacheByName(this.iyc);return b&&b.LSb(a)},a.prototype.xYJ=function(a){var b,c,d,e,f,g,h,i=this,j=i.vYJ,k={};if(u(a)||0===a.length||u(j))return k;for(b=i.qo.getPivotCacheByName(this.iyc),c=0,d=a;c<d.length;c++)e=d[c],f=e.sourceName,j[f]?k[e.displayName]=!0:(g=b.getField(f),h=g.SDc,!u(h)&&j[h]&&(k[e.displayName]=!0));return k},a.prototype.queryItem=function(){var b,c,d,e,f,g=this,h=g.getLabelQueryField(),i=g.getSubtotalQueryField(),j=i.valueFieldsSubtotalMap,k=i.queryFields,l=g.xYJ(h),m=g.getSortMap(h),n=m.customSortMap,o=m.normalSortMap,p=g.iyc,q=g.qo,r=g.getSigmaValuePosition();return(g.zyc||u(g.Iyc))&&(g.Iyc=q.queryItem(p,h,k,r),g.zyc=!1,a.ao(g,"rebuild",{})),b=g.Jyc(h),c=b.list,d=b.header,e=b.rowHeader,f={valuePositionInfo:r,valueFieldLength:k.length},g.Iyc&&g.Iyc.MFc(g.qo.ZBc[p],c,d,e,h,f,g.jEc(),j,g.LFc,this.toShowDataAsContextList(k),n,o,l)},a.prototype.toShowDataAsContextList=function(a){var b=this,c=[],e=this.qo.getPivotCacheByName(this.iyc);return d.Yxc(a,function(a){var d,f,g,h,i,j,k,l,m,n,o,p;if(a.showDataAs){if(d=a.showDataAs,f=d.showDataAs,g=d.cacheName,h=d.baseFieldItemType,i=d.baseFieldName,j=d.baseFieldItem,k=d.fieldName,l=d.subtotalType,m=void 0,i&&j){if(n=b.getFieldInfoByName(i),u(n))return;o=e.LSb(n.Zxc),p=o.dGc(),m=p?p[j]:j}c.push({showDataAs:f,cacheName:g,fieldName:k,baseFieldName:i,baseFieldItemType:h,baseFieldItem:j,subtotalType:l,baseFieldItemShared:m})}}),c},a.prototype.jEc=function(){var a,b,c,d,e,f,g,h,i=this,j={};for(a in i.wyc)if(i.wyc.hasOwnProperty(a)){if(b=i.qo.getPivotCacheByName(i.iyc),u(b))continue;if(c=i.getFieldInfoByName(a),u(c))continue;if(d=b.LSb(c.Zxc),u(d))continue;if(e=d.dGc(),f=i.wyc[a],g=void 0,u(e))j[a]=Q({},f);else{for(h in f)f.hasOwnProperty(h)&&(g||(g={}),g[e[h]]=f[h]);j[a]=g}}return j},a.prototype.Jyc=function(a){var b=[],c=[],e=[];return d.Yxc(a,function(a){var d=a.displayName,f=a.isDim,g=a.isHeader;f&&(b.push(d),g||e.push(d)),g&&c.push(d)}),{list:b,header:c,rowHeader:e}},a.prototype.Kyc=function(a,b){var c=this,e=this.qo,f=e.getPivotCacheByName(c.iyc);return b?d.Lyc([f.Myc(a),f.Nyc(b)]).length>0:f.Myc(a).length>0},a.prototype.Oyc=function(a){var b=a.cmdOption.pivotName,c=this.Pyc(b);return!u(c)&&!u(c.qo)&&(a.sheetName=c.qo.name(),void this.wu.execute(a))},a.prototype.Pyc=function(a){var b,c,d,e=this.nyc;for(b=0,c=e;b<c.length;b++)if(d=c[b],d.Cj===a&&d instanceof h.PivotTable)return d;return t},a.prototype.LAJ=function(){var a,b=this.nyc;for(a=0;a<b.length;a++)if(b[a]instanceof h.PivotTable)return{sheet:b[a].qo,ptName:b[a].Cj}},a.prototype.Qyc=function(){var a=this,b=a.getAllFieldInfo().slice(0),c=a.ryc(0).slice(0),d=a.ryc(1).slice(0),e=a.ryc(2).slice(0),f=a.ryc(3).slice(0),g=a.getSigmaValuePosition();return{allField:b,rowField:d,colField:e,valueField:f,filterField:c,valuePosition:g}},a.prototype.adjustHasCalcItem=function(a,c,d){var f,g,h,i,j=this,k=j.iyc,l=this.qo,m=l.getPivotCacheByName(k).getField(a);if(j.JSJ()){if(c===e.PivotTableFieldType.filterField)m.hasCalcItem()&&b.throwError(p().PivotTableMoveCalcItemFieldToReport);else for(f=j.ryc(),g=0,h=f;g<h.length;g++)i=h[g],i.Zxc===a&&(j.oyc[i.Cj]===e.PivotTableFieldType.valueField&&b.throwError(p().PivotTableCalcItemHasMultipleDataField),b.throwError(p().PivotTableCalcItemHasTowCacheField));if(c===e.PivotTableFieldType.valueField)return j.checkSubTotal(d)}return!0},a.prototype.addFieldByName=function(a,c,d,f,g,h){var i,j,k,l,m,n,o,q=this;for((d>3||d<0)&&b.throwError("wrong area code"),j=q.oIJ(a),k=e.PivotTableFieldType.columnField;k>=e.PivotTableFieldType.filterField;k--)if(i=q.ryc(k),l=U(i,a),!u(l)&&d!==e.PivotTableFieldType.valueField)return void q.changeFieldArea(l.Cj,d,g);if(q.adjustHasCalcItem(a,d,f),!u(j)&&c!==p().sigmaValue)return m=new O(q,a,c,h),d===e.PivotTableFieldType.valueField&&(!u(c)&&u(q.oyc[c])||(n=q.OIJ(a,c,f),o=q.PIJ(n),q.changeFieldName(m,o)),u(f)?m.setSubTotalType(q.vyc(a)):m.setSubTotalType(f)),q.addField(m,d,g),d===e.PivotTableFieldType.filterField&&q.tyc(),m},a.prototype.OJJ=function(a,b,c,d,e,f){var g,h,i,j=this,k=j.oIJ(a);u(k)||b===p().sigmaValue||(g=new O(j,a,b,f),!u(b)&&u(j.oyc[b])||(h=j.OIJ(a,b,d),i=j.PIJ(h),j.changeFieldName(g,i)),u(d)?g.setSubTotalType(j.vyc(a)):g.setSubTotalType(d),j.addField(g,c,e))},a.prototype.RUa=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;switch(u(this.copyFieldsModel)||(this.copyFieldsModel=this.clone()),b=a.type){case"updateValuePosition":c=a.position,d=a.valuesIndex,this.setSigmaValuePosition(c,d);break;case"subTotalType":this.KBJ(a.fieldName,a.subtotalType);break;case"setSortInfo":u(a.sortInfo)?this.clearSortInfo(a.fieldName):this.setSortInfo(a.fieldName,a.sortInfo);break;case"setCollapse":this.setCollapse(a.fieldName,a.item,a.isCollapse);break;case"changeFieldName":e=this.getFieldInfoByName(a.fieldName),e&&(this.changeFieldName(e,a.oldFieldName),this.zyc=!0);break;case"removeField":f=this.dCJ(a.area,a.index),f&&(delete this.oyc[a.fieldName],this.zyc=!0);break;case"addField":g=a.fieldName,h=a.sourceName,i=a.labelFilter,j=a.valueFilter,k=a.sortInfo,l=a.subtotalType,m=a.area,n=a.index,o=a.valueFilterIndex,p=new O(this,h,g),q=this.ryc(m),this.yyc(q,p,m,n),this.oyc[g]=m,this.KBJ(g,l),this.oyc[p.Cj]=m,u(i)||this.setLabelFilterInfo(g,i),u(j)||this.setValueFilterInfo(g,j,o),u(k)||this.setSortInfo(a.fieldName,a.sortInfo),0!==m&&(this.zyc=!0);break;case"setLabelFilter":u(a.filterInfo)?this.clearFilterInfo(a.sourceName,1):this.setLabelFilterInfo(a.sourceName,a.filterInfo);break;case"setValueFilter":u(a.filterInfo)?this.clearFilterInfo(a.sourceName,2):this.setValueFilterInfo(a.sourceName,a.filterInfo,a.index);break;case"group":r=a.oldGroupInfo,s=a.groupSourceFieldName,r?this.UCc(r):this.gGc(s);break;case"ungroup":this.UCc(a.groupInfo);break;case"addValueFilter":u(a.filter)?this.clearFilterInfo(a.fieldName,2):this.setValueFilterInfo(a.fieldName,a.filter,a.index)}},a.prototype.RVa=function(a){var b,c,e,f=this.LAJ(),g=f&&f.sheet;g&&(b=g.getParent(),d.Yxc(this.nyc,function(a){if(a instanceof h.PivotTable)return c=a,!0}),u(b.fBJ)&&c&&c.getRange&&(b.fBJ={range:c&&c.getRange()}),e=g.ITa,e.RAJ(this,a))},a.prototype.getLabelFilterInfo=function(a){var b,c,d,e=this.IUJ.get(a);if(!u(e)&&(b=e.labelFilter,!u(b)))return b&&b.condition&&(c=b.condition.toJSON()),b&&b.textItem&&(d=b.textItem),{condition:c,textItem:d}},a.prototype.setLabelFilterInfo=function(b,c){var d,e,f=this,g=f.IUJ;!u(c)&&Object.keys(c).length<1||(d=f.getFilterInfo(b),d&&d.labelFilter&&(e={},d.labelFilter.condition&&(e.condition=d.labelFilter.condition.toJSON()),d.labelFilter.textItem&&(e.textItem=Q({},d.labelFilter.textItem))),u(c)?(d&&d.labelFilter&&d.labelFilter.condition&&1===d.labelFilter.condition.uBc&&f.mGc(b,t),g.set(b,t,1)):(d||(d=new N(c,t,f.WIJ),f.IUJ.add(b,d)),c.condition?(1===c.condition.conType&&f.mGc(b,c),d.updateLabelCondition(c.condition,f.WIJ.allowMultipleFiltersPerField)):d.labelFilter&&(d.labelFilter.condition&&1===d.labelFilter.condition.uBc&&f.mGc(b,t),delete d.labelFilter.condition),c.textItem?d.updateLabelTextItem(c.textItem,f.WIJ.allowMultipleFiltersPerField):d.labelFilter&&delete d.labelFilter.textItem,f.IUJ.get(b).dyc()&&!f.WIJ.allowMultipleFiltersPerField&&g.set(b,t,2)),f.zyc=!0,this.RVa({type:"setLabelFilter",sourceName:b,filterInfo:e}),a.ao(f,"setSlicerFilter",{sourceName:b,textItem:c&&c.textItem,condition:c&&c.condition,oldTextItem:e&&e.textItem,oldCondition:e&&e.condition}))},a.prototype.mGc=function(a,b){var c,d,e,f,g,h=this,i=h.qo.getPivotCacheByName(h.iyc);if(!u(i)&&(c=i.nGc(a),!u(c)&&c.length>0))for(d=0,e=c.length;d<e;d++)f=h.getFieldInfoByName(c[d].Cj),u(f)||(g=h.IUJ.get(f.Zxc),g||(g=new N(b,t,h.WIJ),h.IUJ.add(f.Zxc,g)),g.updateLabelCondition(b&&b.condition,h.WIJ.allowMultipleFiltersPerField))},a.prototype.getValueFilterInfo=function(a){var b,c,d=this.IUJ.get(a);return d&&d.valueFilter&&d.valueFilter.condition?(b=d.valueFilter.condition.toJSON(),c=d.valueFilter.conditionByName,{condition:b,conditionByName:c}):void 0},a.prototype.getSourceNameByFieldName=function(a){if(a)return this.JUJ[a]},a.prototype.getFieldNameBySourceName=function(a){if(a){var b=this.ADc(a);return b&&b.Cj}},a.prototype.setValueFilterInfo=function(a,b,c){var d,e,f=this,g=f.IUJ,h=g.get(a);!u(b)&&Object.keys(b).length<1||(u(c)&&(c=this.LFc.indexOf(a)===-1?t:this.LFc.indexOf(a)),h&&h.valueFilter&&(d={conditionByName:h.valueFilter.conditionByName,condition:h.valueFilter.condition.toJSON()}),u(b)?(g.set(a,t,2),f.bCJ(a,!1)):(h?h.updateValueCondition(b):(h=new N(t,b,f.WIJ),g.add(a,h)),h.valueFilter.conditionBySourceName=this.getFieldInfoByName(b.conditionByName).Zxc,f.bCJ(a,!0,c),h.cyc()&&!f.WIJ.allowMultipleFiltersPerField&&g.set(a,t,1)),e=T(this.HL||this.ryc(),a),e&&(e.yDc=!0),this.zyc=!0,this.RVa({type:"setValueFilter",sourceName:a,index:c,filterInfo:d}))},a.prototype.clearFilterInfo=function(a,b){var c=this,d=c.ADc(a);c.getFilterInfo(a)&&(1===b?c.setLabelFilterInfo(a,t):2===b?c.setValueFilterInfo(a,t,t):(c.setValueFilterInfo(a,t,t),c.setLabelFilterInfo(a,t)),d&&(d.yDc=!1),c.zyc=!0)},a.prototype.XIJ=function(a){this.WIJ.allowMultipleFiltersPerField=a},a.prototype.refresh=function(a){this.syc(a)},a.prototype.fromJson=function(a,b){var c,d,e,f,g,h,i=this,j=i.qo;for(i.Lqa=a,c=a.fields,i.HL=[],d=null,e=j.getPivotCacheByCacheId(+a.cacheId),e&&(i.iyc=e.Cj,d=e.getAllFieldsNames()),d||(d=[],c.forEach(function(a){d.push(a.name)})),i.vYJ={},(a.multipleFieldFilters||a.multipleFieldFilters===x)&&(i.WIJ.allowMultipleFiltersPerField=!0),i.oyc={},i.JUJ={},i.jyc=[],i.kyc=[],i.lyc=[],i.myc=[],f=0;f<d.length;f++)c[f]&&(u(d[f])||(g=new O(i,d[f],c[f]&&c[f].name),g.fromJson(c[f],i),c[f].name=g.Cj,i.JUJ[g.Cj]=g.Zxc,i.HL.push(g),h=g.getSortInfo(),h&&(i.zZ[c[f].name]=h)));i.Syc(a,b),u(a.pivotFilters)||i.XFc(a.pivotFilters)},a.prototype.cdK=function(a,b){var c,d,e,f,g,h,i,j,k,l=this,m=l.qo;for(l.pjK=a,l.vYJ={},c=F(a,"pivotFields"),d=c&&c.c_,l.HL=[],e=m.getPivotCacheByCacheId(+a.cacheId),l.iyc=e.Cj,f=e.getAllFieldsNames(),y(a.multipleFieldFilters,!0)&&(l.WIJ.allowMultipleFiltersPerField=!0),g=0;g<f.length;g++)h=new O(l,f[g],d[g]&&d[g].name),h.cdK(b,d[g],l),d[g].name=h.Cj,l.JUJ[h.Cj]=h.Zxc,l.HL.push(h),i=h.getSortInfo(),i&&(l.zZ[d[g].name]=i);l.rjK(a,b),j=a.lossless&&a.lossless.losslessPivotFilters,j&&l.XFc(j),k=F(a,"filters"),u(k)||l.sjK(k)},a.prototype.XFc=function(a){var b,c,d,e,f,g,h,i,j,k=this;for(b=0;b<a.length;b++)if(c=a[b],d=k.HL&&k.HL[c.fld]){if(e=c.iMeasureFld||0,f=k.myc&&k.myc[e],g=c.conType,h=I(c),i=f&&f.Cj,u(h)&&u(i))continue;j={condition:h,conditionByName:f&&f.Cj},0===g||1===g?k.setLabelFilterInfo(d.Cj,j):2!==g&&3!==g||k.setValueFilterInfo(d.Cj,j)}},a.prototype.sjK=function(a){var b,c,d,e,f,g,h,i,j,k,l,m=this;if(!u(a))for(b=a.c_,c=0;c<b.length;c++)if(d=b[c],e=m.HL&&m.HL[z(d.fld)]){if(f=z(d.iMeasureFld)||0,g=m.myc&&m.myc[f],h=void 0,u(d.type)||(h=ga(d.type)),i=J(d,h),j=g&&g.Cj,u(i)&&u(j))continue;k={condition:i,conditionByName:g&&g.Cj},l=h.conType,0===l||1===l?m.setLabelFilterInfo(e.Cj,k):2!==l&&3!==l||m.setValueFilterInfo(e.Cj,k)}},a.prototype.Syc=function(a,b){var c,f,g,h,i,k,l,m,n,o,p,q,r,s=this,t={columnFields:e.PivotTableFieldType.columnField,rowFields:e.PivotTableFieldType.rowField};for(c in t)if(t.hasOwnProperty(c))for(f=a[c],g=0;g<f.length;g++)f[g]!==-2?(h=s.HL[f[g]],h&&s.addField(h,t[c])):(s.pyc="columnFields"===c?d.DataPosition.col:d.DataPosition.row,s.qyc=g);for(i=a.pageFields,g=0;g<i.length;g++)k=i[g],l=s.HL[k.fld],s.addField(l,e.PivotTableFieldType.filterField);for(m=a.dataFields,n=s.qo.getPivotCacheByName(s.iyc).getAllFieldsNames(),g=0;g<m.length;g++)o=m[g],s.OJJ(n[o.fld],o.name,e.PivotTableFieldType.valueField,ea(o.subtotal),x,o.numberFormat),o.showDataAs&&(p=void 0,q=d.PivotShowDataAs[o.showDataAs],r={showDataAs:q},j.applyShowDataAsStyle(b,o.name,q),u(o.baseField)||(p=s.ADc(n[o.baseField]),u(p)||(r.baseFieldName=p.Cj)),u(o.baseItem)||(1048828===o.baseItem?r.baseFieldItemType=d.PivotShowDataAsBaseItemType.previous:1048829===o.baseItem?r.baseFieldItemType=d.PivotShowDataAsBaseItemType.next:!u(o.baseItem)&&p&&p._items&&(r.baseFieldItemType=d.PivotShowDataAsBaseItemType.item,r.baseFieldItem=p._items[o.baseItem]&&p._items[o.baseItem].value)),s.getFieldInfoByName(o.name).xFJ=r)},a.prototype.rjK=function(a,b){var c,f,g,h,i,k,l,m,n,o,p,q,r,s,t=this,v={colFields:e.PivotTableFieldType.columnField,rowFields:e.PivotTableFieldType.rowField};for(c in v)if(v.hasOwnProperty(c)&&(f=F(a,c)))for(g=f.c_,h=0;h<g.length;h++)i=z(g[h].x),i!==-2?(k=t.HL[i],t.addField(k,v[c])):(t.pyc="colFields"===c?d.DataPosition.col:d.DataPosition.row,t.qyc=h);if(l=F(a,"pageFields"))for(m=l.c_,h=0;h<m.length;h++)n=m[h],o=t.HL[z(n.fld)],t.addField(o,e.PivotTableFieldType.filterField);if(p=F(a,"dataFields"))for(q=t.qo.getPivotCacheByName(t.iyc).getAllFieldsNames(),r=p.c_,s=function(a){var c,f,g,h,i,k,l,m=r[a],n=B(m.name);t.OJJ(q[z(m.fld)],n,e.PivotTableFieldType.valueField,ea(m.subtotal),x,m.numberFormat),c=m.showDataAs,f=F(m,"extLst"),f&&(g=f.c_,g.forEach(function(a){var b=F(a,"dataField");b&&(c=b.pivotShowAs)})),u(c)||(h=void 0,i=d.PivotShowDataAs[c],k={showDataAs:i},j.applyShowDataAsStyle(b,n,i),h=z(m.baseField),u(h)||(h=t.ADc(q[h]),u(h)||(k.baseFieldName=h.Cj)),l=z(m.baseItem),u(l)||(1048828===l?k.baseFieldItemType=d.PivotShowDataAsBaseItemType.previous:1048829===l?k.baseFieldItemType=d.PivotShowDataAsBaseItemType.next:!u(l)&&h&&h._items&&(k.baseFieldItemType=d.PivotShowDataAsBaseItemType.item,k.baseFieldItem=h._items[l]&&h._items[l].value)),t.getFieldInfoByName(n).xFJ=k)},h=0;h<r.length;h++)s(h)},a.prototype.GDc=function(){var a,b=this,c=b.HL,e=b.getAllFieldNameList();u(c)&&(c=b.HL=[]),a={},d.Yxc(c,function(b){a[b.Cj]=b}),d.Yxc(e,function(d){var e=b.ADc(d);u(e)&&(e=new O(b,d,d,a[d]&&a[d].nBJ)),c[e.mi]=e})},a.prototype.toJson=function(a,b){var c,d,e,f=this;if(u(f.iyc)||(c=f.qo.getPivotCacheByName(f.iyc),c&&(b.cacheId=c.yEc+"")),d=f.HL,b.fields=[],d)for(e=0;e<d.length;e++)b.fields.push(d[e].toJson(a));f.toPivotFiltersOOModel(a,b),f.Tyc(a,b)},a.prototype.toPivotLabelFiltersOOModel=function(a,b,c,e){var f,g,h,i,j,k,l,m=[],n={};n.fld=c,e++,n.id=e,n.evalOrder=-1,g=b.condition,u(g)||(h=g.QBc,i=g.getConditionType(),n.operator=h,n.conType=i,j=g._Qa,k=g.aRa,1===i&&(j=j&&r(j),k=k&&r(k),g.QBc===d.PivotDateFilterOperator.dateToDate&&(n.isParallel=g.OMJ,n.isDynamicEndDate=g.NMJ,n.by=g.dCc)),n.stringValue1=j,n.stringValue2=k,n.iMeasureFld=0,l={compareType:h,conType:i,item1:{expected:j},item2:{expected:k},ignoreCase:!0},g.QBc===d.PivotDateFilterOperator.dateToDate&&(l.isParallel=g.OMJ,l.isDynamicEndDate=g.NMJ,l.by=g.dCc),f={conditions:[l]}),u(f)||(m.push(f),n.autoFilter={filterItemMap:m},a.push(n))},a.prototype.toPivotValueFiltersOOModel=function(a,b,c,d){var e,f,g,h,i,j=this,k=[],l={};l.fld=c,d++,l.id=d,l.evalOrder=-1,f=b.condition,g=b.conditionByName,l.iMeasureFld=j.Uyc(g)||0,h=f.getConditionType(),i=f.QBc,l.operator=i,l.conType=h,3===h?(l.operator=f.Nc,e={conditions:[{conType:h,expected:f.RBc,type:f.QBc,compareType:f.Nc}]}):e={conditions:[{compareType:i,conType:h,item1:{expected:f._Qa},item2:{expected:f.aRa}}]},u(e)||(k.push(e),l.autoFilter={filterItemMap:k},a.push(l))},a.prototype.toPivotFiltersOOModel=function(a,b){var c,d,e,f,g,h=this,i=h.HL,j=[],k=1;if(i)for(c=0;c<i.length;c++)d=i[c],e=h.IUJ.get(d.Zxc),f=e&&e.labelFilter,g=e&&e.valueFilter,u(f)&&u(g)||(u(f)||h.toPivotLabelFiltersOOModel(j,f,c,k),u(g)||h.toPivotValueFiltersOOModel(j,g,c,k));j.length>0?b.pivotFilters=j:delete b.pivotFilters},a.prototype.Tyc=function(a,b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this,v={kyc:"columnFields",jyc:"rowFields"};for(c in v)if(v.hasOwnProperty(c))for(e=t[c],b[v[c]]=[],f=0;f<e.length;f++)b[v[c]].push(e[f].mi);for(t.myc&&t.myc.length>1&&(t.pyc===d.DataPosition.row?b.rowFields.splice(t.qyc,0,-2):t.pyc===d.DataPosition.col&&b.columnFields.splice(t.qyc,0,-2)),g=t.lyc,h=b.pageFields=[],f=0;f<g.length;f++)i=g[f].toJson(a),h.push(i);for(j=t.myc,k=b.dataFields=[],f=0;f<j.length;f++)if(l=j[f],m={},m.name=l.Cj,m.subtotal=fa(l.fyc),m.numberFormat=l.nBJ,k.push(m),n=j[f].mi,b.fields&&b.fields[n]&&(m.fld=n,b.fields[n].dataField=!0),o=l.xFJ,o&&(o.showDataAs&&(m.showDataAs=d.PivotShowDataAs[o.showDataAs]),o.baseFieldName&&(p=t.getFieldInfoByName(o.baseFieldName),m.baseField=p.mi,q=o.baseFieldItemType,!u(q))))if(q===d.PivotShowDataAsBaseItemType.previous)m.baseItem=1048828;else if(q===d.PivotShowDataAsBaseItemType.next)m.baseItem=1048829;else if(q===d.PivotShowDataAsBaseItemType.item)for(r=p.LJJ(t)||p._items,
s=0;s<r.length;s++)if(o.baseFieldItem===r[s].value){m.baseItem=s;break}},a.prototype.bdK=function(a,b){var c,d,e,f,g=this;if(u(g.iyc)||(c=g.qo.getPivotCacheByName(g.iyc),c&&(b.cacheId=c.yEc+"")),d=g.HL,e=[],d)for(f=0;f<d.length;f++)e.push(d[f].bdK(a));b.c_.push({n_:"pivotFields",count:e.length+"",c_:e}),g.tjK(a,b),g.ujK(a,b)},a.prototype.tjK=function(a,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,s,t,v,w=this,y=w.HL,z=[],A=[],B=1;if(y)for(e=0;e<y.length;e++)f=y[e],g=w.IUJ.get(f.Zxc),h=g&&g.labelFilter,i=g&&g.valueFilter,j=void 0,k=void 0,l=void 0,u(h)&&u(i)||(u(h)||(m={n_:"filter",fld:e+"",evalOrder:"-1"},n=void 0,B++,m.id=""+B,o=h.condition,u(o)||(p=o.getConditionType(),j=o.QBc,j===d.PivotDateFilterOperator.dateToDate?w.toPivotLabelFiltersOOModel(A,h,e,B):(l=b.Caption_Compare_Type_Excel[p]&&b.Caption_Compare_Type_Excel[p][j],l!==x&&(m.type=l),q=o._Qa,s=o.aRa,1===p&&(q=q&&r(q),s=s&&r(s)),m.stringValue1=q,m.stringValue2=s,m.iMeasureFld="0",t={compareType:j,conType:p,item1:{expected:q},item2:{expected:s},ignoreCase:!0},n={conditions:[t]})),u(n)||(m.c_=[da([n],l)],z.push(m))),u(i)||(m={n_:"filter",fld:e+"",evalOrder:"-1"},n=void 0,B++,m.id=""+B,o=i.condition,v=i.conditionByName,m.iMeasureFld=""+(w.Uyc(v)||0),p=o.getConditionType(),j=o.QBc,3===p?(j=o.Nc,n={conditions:[{conType:p,expected:o.RBc,type:o.QBc,compareType:o.Nc}]}):n={conditions:[{compareType:j,conType:p,item1:{expected:o._Qa},item2:{expected:o.aRa}}]},l=b.Caption_Compare_Type_Excel[p]&&b.Caption_Compare_Type_Excel[p][j],l!==x&&(m.type=l),u(n)||41===j||42===j||(m.c_||(m.c_=[]),m.c_.push(da([n],l)),z.push(m))));z.length>0?c.c_.push({n_:"filters",count:z.length+"",c_:z}):E(c.c_,{},"filters"),A.length>0&&(c.lossless||(c.lossless={}),c.lossless.losslessPivotFilters=A)},a.prototype.ujK=function(a,b){var c,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,v,w,x,y,z,A,B,C,E,F,G,H=this,I={kyc:"columnFields",jyc:"rowFields"},J={};for(c in I)if(I.hasOwnProperty(c))for(e=H[c],J[I[c]]=[],g=0;g<e.length;g++)J[I[c]].push(e[g].mi);for(h=J.rowFields,i=J.columnFields,H.myc&&H.myc.length>1&&(H.pyc===d.DataPosition.row?h.splice(H.qyc,0,-2):H.pyc===d.DataPosition.col&&i.splice(H.qyc,0,-2)),h.length>0&&(j=[],h.forEach(function(a){j.push({n_:"field",x:a})}),b.c_.push({n_:"rowFields",count:j.length+"",c_:j})),i.length>0&&(k=[],i.forEach(function(a){k.push({n_:"field",x:a})}),b.c_.push({n_:"colFields",count:k.length+"",c_:k})),l=H.lyc,m=[],g=0;g<l.length;g++)m.push({n_:"pageField",fld:l[g].mi});for(m.length>0&&b.c_.push({n_:"pageFields",count:m.length+"",c_:m}),n=H.myc,o=[],p=D(b,"pivotFields"),q=p&&p.c_,g=0;g<n.length;g++)if(r=n[g],s={n_:"dataField"},s.name=r.Cj,s.subtotal=fa(r.fyc),u(r.nBJ)||(t=f.ExtendedNumberFormatHelper.getFormatId(r.nBJ),v=t.id,w=t.isBuiltIn,w?s.numFmtId=v:(x={},x.numberFormat=new f.ExcelNumerFormat(v,r.nBJ),s.numFmtId=x.numberFormat.numberFormatId)),o.push(s),y=n[g].mi,q&&q[y]&&(s.fld=""+y,q[y].dataField="1"),z=r.xFJ,z&&(A=void 0,z.showDataAs&&(A=d.PivotShowDataAs[z.showDataAs]),B=L.indexOf(A)===-1,B?s.c_=[{n_:"extLst",c_:[{n_:"ext",r_:[28,1],c_:[{n_:"dataField",pivotShowAs:A}]}]}]:s.showDataAs=A,z.baseFieldName&&(C=H.getFieldInfoByName(z.baseFieldName),s.baseField=C.mi,E=z.baseFieldItemType,!u(E))))if(E===d.PivotShowDataAsBaseItemType.previous)s.baseItem="1048828";else if(E===d.PivotShowDataAsBaseItemType.next)s.baseItem="1048829";else if(E===d.PivotShowDataAsBaseItemType.item)for(F=C.LJJ(H)||C._items,G=0;G<F.length;G++)if(z.baseFieldItem===F[G].value){s.baseItem=""+G;break}o.length>0&&b.c_.push({n_:"dataFields",count:o.length+"",c_:o})},a.prototype.Uyc=function(a){var b,c=this.myc;for(b=0;b<c.length;b++)if(a===c[b].Cj)return b},a.prototype.UCc=function(a){var c,e,f,g=this,h=g.iyc,i=this.qo,j=i.ZBc[g.iyc].HL;return g.JSJ()&&(a.dateGroups||a.numberGroup)&&b.throwError(p().PivotTableHasNumberOrDateGroup),a.textGroup?(e=a.textGroup.fieldName,d.Yxc(Object.keys(j),function(a){if(a===e)return p().PivotTableErrorMessage_DuplicatedFieldName}),c=e):c=a.originFieldName,f=this.ZIJ(a.originFieldName),f&&this.gGc(a.originFieldName,!0),i.addGroup(h,a)?(this.RVa({oldGroupInfo:f,groupSourceFieldName:c,type:"group"}),this.zyc=!0,!0):p().PivotTableErrorMessage_InvalidGroup},a.prototype.gNc=function(a,b){var c=this,d=c.iyc,e=this.qo;e.getPivotCacheByName(d).addCalcField(a,b)},a.prototype.hNc=function(){var a,b,c=this,d=c.iyc,e=this.qo,f=e.getCalcFields(d),g=[];for(a=0;a<f.length;a++)b=c.ADc(f[a].Cj),b?g.push({fieldName:b.Cj,formula:f[a].Yw}):g.push({fieldName:f[a].Cj,formula:f[a].Yw});return g},a.prototype.PJJ=function(a){var b,c=this,d=c.iyc,e=this.qo,f=c.getFieldInfoByName(a)&&c.getFieldInfoByName(a).Zxc||a,g=e.getCalcFields(d);if(!u(f))for(b=0;b<g.length;b++)if(g[b].Cj===f)return!0;return!1},a.prototype.AJJ=function(a,b,c){var d,e,f,g,h=this;return!u(c)&&(d=c.textGroup,e=c.numberGroup,f=c.dateGroups,!(!d||d.fieldName!==a)||(!(!e||c.originFieldName!==a)||!(!f||(g=h.qo.getPivotCacheByName(h.iyc).LSb(a),!g||g.SDc!==b))))},a.prototype.gGc=function(b,c,d){var e,f,g,h,i,l,m,n=this,o=n.qo.getPivotCacheByName(n.iyc),p=o.getField(b),q=o.rLc;for(f in q)if(k(q,f)&&(g=q[f],n.AJJ(b,f,g))){e=j._AJ(g);break}if(!u(p)&&(h=n.getFilterInfo(b),i=h&&h.labelFilter,i&&i.textItem&&(u(i.condition)&&u(i.conditionByName)?i=x:i.textItem=x,n.setLabelFilterInfo(b,i)),l=o.hGc(p.Cj),!d&&l&&l.length>0))for(m=0;m<l.length;m++)n.BDc(l[m]);n.zyc=!0,d||a.ao(n,"updatePivotCache"),c||this.RVa({groupInfo:e,type:"ungroup",pivotTable:n})},a.prototype.ZJJ=function(){var a,b,c,d=this,e=d.ryc(),f=d.qo.getPivotCacheByName(d.iyc);for(a=0,b=e;a<b.length;a++)c=b[a],u(f.getField(c.Zxc))&&d.removeFieldOrSigmaByName(c.Cj);d.zyc=!0},a.prototype.xHJ=function(a){var b,c,d,e=this,f=e.qo.getPivotCacheByName(e.iyc),g=f.rLc;for(c in g)if(k(g,c)&&(d=g[c],e.AJJ(a,c,d))){b=j._AJ(d);break}return b},a.prototype.BDc=function(a){var b,c,d,f=this;for(c=e.PivotTableFieldType.valueField;c>=e.PivotTableFieldType.filterField;c--)for(b=f.ryc(c),d=b.length-1;d>=0;d--)b[d].Zxc===a&&(c===e.PivotTableFieldType.valueField&&f.clearValueFilterOfValueField(b[d].Cj),f.removeFieldOrSigmaByName(b[d].Cj))},a.prototype.CDc=function(a){var b,c,f=this,g=this.qo.getPivotCacheByName(this.iyc).HL,h=g[a].ny;return h===d.PivotDataType.number?(c=f.OIJ(a),b=this.addFieldByName(a,c,e.PivotTableFieldType.valueField,d.SubtotalType.sum)):b=this.addFieldByName(a,a,e.PivotTableFieldType.rowField,t),b},a.prototype.NDc=function(a){var b,c,d=this,f=this;if(f.oyc[a]===e.PivotTableFieldType.valueField)for(c=0;c<4;c++)b=f.ryc(c),b.forEach(function(b){if(b.eyc&&b.eyc.valueFilter&&b.eyc.valueFilter.conditionByName===a){var c=b.eyc.valueFilter.toJSON();b.eyc.valueFilter=t,d.RVa({fieldName:b.Cj,filter:c,type:"addValueFilter"})}})},a.prototype.ZIJ=function(a){var b,c,d,e=this,f=e.qo.getPivotCacheByName(e.iyc),g=f.rLc;for(c in g)if(k(g,c)&&(d=g[c],d.textGroup&&d.originFieldName===a||u(d.textGroup)&&d.originFieldName===a)){b=j._AJ(d);break}return b},a.prototype.t1J=function(a,b){var c=this,d=c.qo.getPivotCacheByName(c.iyc);return d.u1J(a,b)},a.prototype.Q1J=function(a){var b=this,c=b.qo.getPivotCacheByName(b.iyc);return c.Q1J(a)},a.prototype.v1J=function(a){var b=this,c=b.qo.getPivotCacheByName(b.iyc);return c.w1J(a)},a.prototype.x1J=function(){var a=this,b=a.qo.getPivotCacheByName(a.iyc);return b.x1J()},a.prototype.y1J=function(){var a=this,b=a.qo.getPivotCacheByName(a.iyc);return b.y1J()},a.prototype.dispose=function(){var a,b,c,d,e=this;if(e.zZ=t,e.wyc=t,e.HL=t,e.Lqa=t,e.pjK=t,e.LFc=t,e.WIJ=t,e.oyc=t,e.qo=t,e.wu=t,!u(e.nyc)){for(a=0,b=e.nyc;a<b.length;a++)c=b[a],c&&c.dispose();e.nyc=t}for(u(e.Iyc)||e.Iyc.no(),u(e.copyFieldsModel)||e.copyFieldsModel.dispose(),d=0;d<e.jyc.length;d++)e.jyc[d].hyc();for(d=0;d<e.kyc.length;d++)e.kyc[d].hyc();for(d=0;d<e.lyc.length;d++)e.lyc[d].hyc();for(d=0;d<e.myc.length;d++)e.myc[d].hyc();e.IUJ.dispose(),e.IUJ=t,e.WIJ=t,e.vYJ=t},a}(),b.PivotFieldsModel=P;function ea(a){switch(a){case"average":return d.SubtotalType.average;case"count":return d.SubtotalType.count;case"countNums":return d.SubtotalType.countNums;case"max":return d.SubtotalType.max;case"min":return d.SubtotalType.min;case"product":return d.SubtotalType.product;case"stdDev":return d.SubtotalType.stdDev;case"stdDevp":return d.SubtotalType.stdDevp;case"var":return d.SubtotalType.varr;case"varp":return d.SubtotalType.varp;default:return d.SubtotalType.sum}}function fa(a){switch(a){case d.SubtotalType.average:return"average";case d.SubtotalType.count:return"count";case d.SubtotalType.countNums:return"countNums";case d.SubtotalType.max:return"max";case d.SubtotalType.min:return"min";case d.SubtotalType.product:return"product";case d.SubtotalType.stdDev:return"stdDev";case d.SubtotalType.stdDevp:return"stdDevp";case d.SubtotalType.varr:return"var";case d.SubtotalType.varp:return"varp";default:return"sum"}}function ga(a){return a.indexOf("caption")>-1&&!u(e.captionCompareTypeExcel[a])?{conType:0,compareType:e.captionCompareTypeExcel[a]}:a.indexOf("value")>-1&&!u(e.valueCompareTypeExcel[a])?{conType:2,compareType:e.valueCompareTypeExcel[a]}:u(e.dateCompareTypeExcel[a])?u(e.top10CompareTypeExcel[a])?void 0:{conType:3,compareType:e.top10CompareTypeExcel[a]}:{conType:1,compareType:e.dateCompareTypeExcel[a]}}function ha(a){return!a||" "===a}function ia(a,b){return!u(b.oyc[a])&&3!==b.oyc[a]}function ja(a,b){var c,d,e,f,g,h,i={};return i.filter=[],i.blank=a.blank,c=a.c_,c[0]?(d=B(c[0].val),na(b.conType,0,d,i.blank)):(i.dateGroupItem=[],e=[].concat(a.dateGroupItem),e[0]?(f={},g=e[0],f.day=z(g.day,1),f.hour=z(g.hour,0),f.minute=z(g.minute,0),f.month=z(g.month,0),f.second=z(g.second,0),f.year=z(g.year,0),h=new Date(f.year,f.month>0?f.month-1:f.month,f.day,f.hour,f.minute,f.second),na(b.conType,0,h,!i.blank)):void 0)}function ka(a,b){var c,d,e,f={},g=a.and;return ha(g)||(f.and="1"===g),c=a.c_,c.length>0&&(d=f.filter1={},d.operator=c[0].operator,d.value=c[0].val),c.length>1&&(e=f.filter2={},e.operator=c[1].operator,e.value=c[1].val),oa(f,b)}function la(a,b){var c,d,e={};return e.type=H[a.type],c=a.val,d=a.maxVal,ha(c)||(e.value=c),ha(d)||(e.maxValue=d),pa(e,b)}function ma(a,b){var c={};return c.value=A(a.val,NaN),c.percent=y(a.percent,!1),c.top=y(a.top,!0),qa(c,b)}function na(a,b,c,d,e,f,g,h,i,j){var k={};return k.conType=a,u(b)||(k.compareType=b),u(c)||(k.expected=c),u(d)||(k.ignoreBlank=d),u(e)||(k.type=e),u(f)||(k.isPercent=f),u(g)||(k.item1=g),u(h)||(k.item2=h),u(i)||(k.ranges=i),u(j)||(k.expectTypeId=j),2===a&&(k.ignoreCase=!0),k}function oa(a,b){function c(a){var c,d=a.value,e=d.indexOf("*"),f=d.lastIndexOf("*");return e!==-1?e===d.length-1&&0!==e?c=na(b.conType,b.compareType,d.substring(0,d.length-1)):0===e&&e===f?c=na(b.conType,b.compareType,d.substring(1)):(e!==-1&&f!==-1&&(d=d.substr(1,d.length-2)),c=na(b.conType,b.compareType,d)):u(b)||(c=na(b.conType,b.compareType,d)),c}var d;return a.filter1&&(d=c(a.filter1)),d=a.filter2?na(b.conType,b.compareType,m,m,m,m,d,c(a.filter2)):na(b.conType,b.compareType,m,m,m,m,d,m)}function pa(a,b){var c,d=b.conType;return 1===d&&(c=na(1,b.compareType,m)),c}function qa(a,b){var c=a.top?1:-1;return na(3,b.compareType,a.value,m,c,a.percent)}f.Zn(P)},"./dist/plugins/pivot/pivot-core/pivot-view.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(b,c,d){var e=this;e.Cj=b,c instanceof a?e.Vyc=c.Vyc:e.Vyc=c,e.qo=d}return a.prototype.getName=function(){return this.Cj},a.prototype.paint=function(){this._R.render()},a.prototype.dispose=function(){var a=this;a.Vyc=null,a._R&&a._R.dispose()},a}();b.PivotView=d},"./dist/plugins/pivot/pivot-definition.js":function(a,b){},"./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-caches.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Slicers"),g=c("Pivot"),h=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),i=c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),j=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js"),k=c("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js"),l=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js"),m=c("./dist/plugins/pivot/pivot-util.js"),n=new e.Common.ResourceManager(g.SR,"PivotEngine"),o=n.getResource.bind(n),p="Slicer_",q="NativeTimeline_",r=d.Util.XaK,s=d.Util.YaK,t=d.Util.xiK,u=d.Util.$kK,v=d.Ul.naa,w=d.Ul.oaa;function G(a,b){var c,d,e;if(g.Fa(a.Eyc))for(a.vBc={},a.Eyc={},a.vzc=[],c=b.nBc,d=a.mi,e=0;e<c.length;e++)c[e][d]=a.zBc(c[e][d],e,!1);a.$GJ||a.YGJ()}function H(a,b){var c,d,e;for(c=0,d=Object.keys(b);c<d.length;c++)if(e=d[c],b[e]===a)return e;return i.keyword_null}function I(a){return a.replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+$/g,"").replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+/g,"_")}function J(a,b){return void 0===b&&(b=!1),b?+a.state.pivotCacheId:+a.data.tabular.pivotCacheId}function K(a,b){var c=[];return d.GC$.each(a,function(a,e){var f,g=e.slicerCacheDefinition||e.timelineCacheDefinition;g&&g.pivotTables&&b.indexOf(g.name)!==-1&&(f=g.pivotTables.pivotTable,d.GC$.each(f,function(a,b){var d=+b.tabId;c.indexOf(d)===-1&&c.push(d)}))}),c}function L(a,b){var c=[];return d.GC$.each(b,function(b,d){a.indexOf(+d.sheetId)!==-1&&c.push(d.name)}),c}function M(a,b,c){var e=[];return a&&a.length>0&&d.GC$.each(a,function(a,f){var g,h;if(f.Type===c){if(g=d.Util.LhK(f.Target),h=b[g],!h)return;d.GC$.each(h.c_,function(a,b){e.indexOf(b.cache)===-1&&e.push(b.cache)})}}),e}function N(a,b,c,e){var f,g,h,i=b.slicers,j=b.slicerCaches,k=b.timelines,l=b.timelineCaches;if(i&&0!==i.length)return f=a&&a[c],g=M(f,i,d.RelationshipConstants.I7).concat(M(f,k,d.RelationshipConstants.XgK)),h=K(j,g).concat(K(l,g)),L(h,e)}f&&(x=f.SlicerCacheBase,y=f.SlicerCacheType,z=f.TimelineLevel,A=function(a){F(b,a);function b(b,c,d,e){var f=this;if(c)return f=a.call(this,e,d)||this,f.qo=b,f.pivotCache=c,f.pivotTables=[],f}return b.prototype.YXJ=function(a){var b,c=-1;for(b=0;b<this.pivotTables.length;b++)this.pivotTables[b].name()===a.name()&&(c=b);return c},b.prototype._XJ=function(){return this.qo._XJ()},b.prototype.afterSetFilter=function(){var b=this;a.prototype.afterSetFilter.call(this),0===b.pivotTables.length&&b.refreshSlicers()},b.prototype.ZXJ=function(a,b){var c,e;return void 0===a&&(a=!1),void 0===b&&(b=!0),c=this,c.$XJ&&Object.keys(c.$XJ).length>0&&(e=c.qo._XJ(),d.GC$.each(c.$XJ,function(b){var d=e._Cc(b);return!!d&&(a=!0,void c.pivotTables.push(d))})),b&&(c.$XJ=i.keyword_null),a&&c.updateCache(),!0},b.prototype.isConnectedPivotTable=function(a){for(var b=0;b<this.pivotTables.length;b++)if(this.pivotTables[b].name()===a)return!0;return!1},b.prototype.connect=function(a,b){var c,d=this,e=a.Vyc.qo.getPivotCacheByName(a.Vyc.iyc);e.cTJ===d.pivotCache.cTJ&&d.YXJ(a)===-1&&(c=d.qo.getExistedSlicerCache(a,d.sourceName,d.slicerCacheType),c?d.qo.aYJ(d,c):d.pivotTables.push(a),b||d.setSingleFilter(a))},b.prototype.disconnect=function(a){var b,c=a.Vyc.qo.getPivotCacheByName(a.Vyc.iyc);c.cTJ===this.pivotCache.cTJ&&(b=this.YXJ(a),b!==-1&&this.pivotTables.splice(b,1))},b.prototype.onWorkSheetDisposing=function(b){var c,d,e=this;for(a.prototype.onWorkSheetDisposing.call(this,b),c=e.pivotTables.length-1;c>-1;c--)d=e.pivotTables[c],d.qo&&d.qo.name()!==b||e.pivotTables.splice(c,1)},b.prototype.clearSelfFilter=function(){},b.prototype.clearFilter=function(){var a,b,c,d=this;if(d.canUpdate()&&!d.filterCleared()){for(d.clearSelfFilter(),d.beforeSetFilter(),a=0;a<this.pivotTables.length;a++)b=this.pivotTables[a],c=b.Vyc,c.Oyc({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:d.sourceName,pivotName:b.name(),commandName:"ClearFilter",clearType:1}});d.afterSetFilter()}},b.prototype.setFilter=function(){},b.prototype.setSingleFilter=function(a){},b.prototype.toJSON=function(){var a=this,b=a.qo._XJ(),c=a.pivotTables.map(function(a){var c=a.qo;return{tabId:b.getSheetIndex(c.name())+1,name:a.Cj}});return{name:a.name,sourceName:a.sourceName,pivotCacheId:a.pivotCache.cTJ,pivotTables:c}},b.prototype.bdK=function(a,b,c){var d,e,f,g,h,i,j=this,k={r_:j.slicerCacheType===y.pivotSlicer?[42,14,30,43]:[60,32,14],name:v(j.name),sourceName:v(j.sourceName)};for(k.pivotTables={pivotTable:[]},d=j.qo._XJ(),e=k.pivotTables.pivotTable,f=j.pivotTables,g=0;g<f.length;g++)h=f[g],i=h.qo,e.push({tabId:d.getSheetIndex(i.name())+1+"",name:v(h.Cj)});return k},b.prototype.fromJSON=function(b){var c,d=this;a.prototype.fromJSON.call(this,b),d.pivotTables=[],c=d.qo._XJ(),g.Yxc(b.pivotTables,function(a){var b=c._Cc(a.name);b?d.pivotTables.push(b):(d.$XJ||(d.$XJ={}),d.$XJ[a.name]=!0)})},b.prototype.preFromSJSFormat=function(a){var b,c,e,f=this;f.disposeAllSlicers(),f.eTJ=[],f.pivotTables=[],f.name=w(a.name),f.sourceName=w(a.sourceName),b=f.qo._XJ(),c=a.pivotTables&&a.pivotTables.pivotTable,e=Array.isArray(c)?c:[c],d.GC$.each(e,function(a,c){var d=w(c.name),e=b._Cc(d);e?f.pivotTables.push(e):(f.$XJ||(f.$XJ={}),f.$XJ[d]=!0)})},b.prototype.cdK=function(a,b,c){},b.prototype.dispose=function(){var b=this;a.prototype.dispose.call(this),b.qo=i.keyword_null,b.pivotCache=i.keyword_null,b.pivotTables=i.keyword_null},b}(x),B=function(a){F(b,a);function b(b,c,e,f){var g=a.call(this,b,c,e,f)||this;return g.slicerCacheType=y.pivotSlicer,g.bYJ=d.SortState.ascending,g.L4J=!0,g.M4J=!0,g.N4J=!0,g.bYJ=d.SortState.ascending,g.items=g.initItems(),g}return b.prototype.filterCleared=function(){var a,b=this;for(a=0;a<b.items.length;a++)if(b.items[a].selected===!1)return!1;return!0},b.prototype.add=function(a,b){var c=this,d=new k.PivotTableItemSlicer(b,a,c);return c.eTJ.push(d),d},b.prototype.sortState=function(a){var b=this;return 0===arguments.length?b.bYJ:void(g.Fa(a)||a===b.bYJ||(b.bYJ=a,b.refreshSlicers()))},b.prototype.showNoDataItems=function(a){var b=this;return 0===arguments.length?b.L4J:(a=!!a,void(a!==b.L4J&&(b.L4J=a,b.refreshSlicers())))},b.prototype.showNoDataItemsInLast=function(a){var b=this;return 0===arguments.length?b.M4J:(a=!!a,void(a!==b.M4J&&(b.M4J=a,b.refreshSlicers())))},b.prototype.visuallyNoDataItems=function(a){var b=this;return 0===arguments.length?b.N4J:(a=!!a,void(a!==b.N4J&&(b.N4J=a,b.refreshSlicers())))},b.prototype.initItems=function(){var a,b,c,d,e,f=this.pivotCache.getField(this.sourceName);G(f,this.pivotCache),a=[];for(b in f.$GJ)f.$GJ.hasOwnProperty(b)&&(c=f.$GJ[b],d=parseInt(b,10),e=H(d,f.aGc?f.aGc:f.Eyc),0!==f.ny||isNaN(+e)||(e=+e),a[c]={text:e,selected:!0,noData:!0});return a},b.prototype.buildItems=function(){var a,b,c,d,e,f,g,h,j,k,l,m,n,p,q,r=this;if(0===r.pivotTables.length)return this.items||this.initItems();a=r.pivotTables[0].Vyc,b=r.sourceName,c=r.pivotCache,d=c.getField(b),e=o().blank,f=d.jGJ(),G(d,c),g=r.oTJ(r.cYJ()).nTJ,h=a.getFilterInfo(b),j=h&&h.labelFilter&&h.labelFilter.textItem,k=j||{isAll:!0,list:i.keyword_undefined},l=[];for(m in f)f.hasOwnProperty(m)&&(n=f[m],p=parseInt(m,10),q=H(p,d.aGc?d.aGc:d.Eyc),0!==d.ny||isNaN(+q)||(q=+q),l[n]={text:q,selected:k.isAll||!!k.list&&k.list.indexOf(q)!==-1,noData:g[p]===i.keyword_undefined||q===e});return l},b.prototype.oTJ=function(a){var b=this,c=b.qo._XJ().AO;return c.oTJ(b.pivotCache.getName(),a,b.sourceName)},b.prototype.cYJ=function(){var a=this,b=a.pivotTables[0].Vyc,c=b.Dyc(),d=b.getAllFieldNameList(),e=[],f=b.qo.getPivotCacheByName(b.iyc);return d.splice(d.indexOf(a.sourceName),1),g.Yxc(c,function(c){var h,i,j,k,l,m,n=f.LSb(c.Zxc),o=!g.Fa(n.SDc),p=o?f.LSb(n.SDc):void 0;n.Cj!==a.sourceName&&(h=b.getFilterInfo(c.Zxc),h&&h.iOa&&(b.zyc=!0,h.iOa=!1),i=d.indexOf(c.Zxc),i!==-1&&d.splice(i,1),j=c.toPivotViewQueryField(h,b.oyc[c.Cj],n,p,!0),k=j.items,l=j.sourceName,m=j.isALL,e.push({items:k,sourceName:l,isALL:m}))}),g.Yxc(d,function(a){var c,d,j,k,l,m=b.getFilterInfo(a);m&&m.labelFilter&&m.labelFilter.textItem&&m.labelFilter.textItem.isAll===!1&&(c=f.LSb(a),d=g.Fa(c.SDc)?void 0:f.LSb(c.SDc),j=h.toPivotViewQueryField(a,a,-1,m,i.keyword_undefined,-1,c,d),k=j.items,l=j.isALL,e.push({items:k,sourceName:a,isALL:l}))}),e},b.prototype.updateItems=function(){this.items=this.buildItems()},b.prototype.updateCache=function(){this.canUpdate()&&(this.updateItems(),this.refreshSlicers())},b.prototype.clearSelfFilter=function(){var a=this,b=a.items;g.Yxc(b,function(a){a.selected=!0})},b.prototype.setSingleFilter=function(a){var b,c,d,e=this;e.canUpdate()&&(b=e.items,c=[],g.Yxc(b,function(a){c.push({status:a.selected,value:a.text})}),d=a.Vyc,d.Oyc({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:e.sourceName,pivotName:a.name(),slicerCacheName:e.name,dataOfListBox:c}}))},b.prototype.setFilter=function(a){var b,c,d,e,f=this;if(f.canUpdate()&&(a||!f.filterCleared())){for(a=a||f.items,b=[],g.Yxc(a,function(a){b.push({status:a.selected,value:a.text})}),f.beforeSetFilter(),c=0;c<f.pivotTables.length;c++)d=f.pivotTables[c],e=d.Vyc,e.Oyc({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:f.sourceName,pivotName:d.name(),slicerCacheName:f.name,dataOfListBox:b}});f.afterSetFilter()}},b.prototype.toJSON=function(){var b,c,e=this,f=a.prototype.toJSON.call(this),g=e.pivotCache.getField(e.sourceName);return g&&(c=g.getFieldsItemList(),b=e.items.map(function(a){return{x:c.indexOf(a.text),s:a.selected,nd:a.noData}})),{name:f.name,sourceName:f.sourceName,pivotCacheId:f.pivotCacheId,pivotTables:f.pivotTables,items:b,sortOrder:e.bYJ===d.SortState.descending?d.SortState.descending:d.SortState.ascending,showNoDataItems:e.L4J,showNoDataItemsInLast:e.M4J,visuallyNoDataItems:e.N4J}},b.prototype.bdK=function(b,c,e){var f,g,h,i,j,k,l=this,m=l.items,n=a.prototype.bdK.call(this,b,c,e);if(n.data={tabular:{pivotCacheId:l.pivotCache.cTJ+"",items:{count:m.length,i:[]}}},l.bYJ===d.SortState.descending&&(n.data.tabular.sortOrder="descending"),l.N4J===!1?n.data.tabular.crossFilter="none":l.M4J===!1&&(n.data.tabular.crossFilter="showItemsWithNoData"),l.L4J===!1&&(n.extLst={ext:[{r_:[33,44],slicerCacheHideItemsWithNoData:{}}]}),f=l.pivotCache.getField(l.sourceName))for(g=f.getFieldsItemList(),h=n.data.tabular.items.i,i=0;i<m.length;i++)j=m[i],k={x:g.indexOf(j.text)},j.selected&&(k.s="1"),j.noData&&(k.nd="1"),h.push(k);return n},b.prototype.fromJSON=function(b){var c,d=this;a.prototype.fromJSON.call(this,b),c=this.pivotCache.getField(this.sourceName),G(c,d.pivotCache),b.items?d.items=b.items.map(function(a){var b=H(+a.x,c.aGc?c.aGc:c.Eyc);return{text:b,selected:!!a.s,noData:!!a.nd}}):d.items=d.buildItems(),g.Fa(b.sortOrder)||(d.bYJ=b.sortOrder),g.Fa(b.showNoDataItems)||(d.L4J=b.showNoDataItems),g.Fa(b.showNoDataItemsInLast)||(d.M4J=b.showNoDataItemsInLast),g.Fa(b.visuallyNoDataItems)||(d.N4J=b.visuallyNoDataItems)},b.prototype.preFromSJSFormat=function(b){var c,e,f,h,i=this;a.prototype.preFromSJSFormat.call(this,b),c=b.extLst&&b.extLst.ext,g.Fa(c)||(e=!1,Array.isArray(c)?e=c.filter(function(a){return a.slicerCacheHideItemsWithNoData}).length>0:c.slicerCacheHideItemsWithNoData&&(e=!0),e&&(i.L4J=!1)),f=b.data.tabular,g.Fa(f.sortOrder)||(i.bYJ="descending"===f.sortOrder?d.SortState.descending:d.SortState.ascending),h=f.crossFilter,"none"===h?i.N4J=!1:"showItemsWithNoData"===h&&(i.M4J=!1)},b.prototype.cdK=function(a,b,c){},b.prototype.dispose=function(){var b=this;a.prototype.dispose.call(this),b.items=i.keyword_null},b}(A),C=[g.PivotDateFilterOperator.equalsTo,g.PivotDateFilterOperator.Between,g.PivotDateFilterOperator.tomorrow,g.PivotDateFilterOperator.today,g.PivotDateFilterOperator.yesterday,g.PivotDateFilterOperator.nextWeek,g.PivotDateFilterOperator.thisWeek,g.PivotDateFilterOperator.lastWeek,g.PivotDateFilterOperator.nextMonth,g.PivotDateFilterOperator.thisMonth,g.PivotDateFilterOperator.lastMonth,g.PivotDateFilterOperator.nextQuarter,g.PivotDateFilterOperator.thisQuarter,g.PivotDateFilterOperator.lastQuarter,g.PivotDateFilterOperator.nextYear,g.PivotDateFilterOperator.thisYear,g.PivotDateFilterOperator.lastYear,g.PivotDateFilterOperator.yearToDate,g.PivotDateFilterOperator.dateToDate],D=function(a){F(b,a);function b(b,c,d,e){var f,g=a.call(this,b,c,d,e)||this;return g.slicerCacheType=y.pivotTimeline,g.selectionLevel=z.months,g.level=z.months,f=g,f.bounds=f.buildBounds(),f.selection=i.keyword_undefined,g}return Object.defineProperty(b.prototype,"canShowRange",{get:function(){return g.Fa(this.filterType)||this.isValidFilterType},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isValidFilterType",{get:function(){var a=this.filterType,b=this.filterCondition;return C.indexOf(a)!==-1&&(a!==g.PivotDateFilterOperator.dateToDate||!b.OMJ)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"filterType",{get:function(){var a,b=this;return 0===b.pivotTables.length&&b.selection?g.PivotDateFilterOperator.Between:(a=b.filterCondition,a&&a.QBc)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"filterCondition",{get:function(){var a,b,c=this;return 0===c.pivotTables.length?i.keyword_undefined:(a=c.pivotTables[0].Vyc.getFilterInfo(c.sourceName),b=a&&a.labelFilter&&a.labelFilter.condition&&a.labelFilter.condition,b&&b.uBc===g.PivotConditionType.date?b:i.keyword_undefined)},enumerable:!0,configurable:!0}),b.prototype.filterCleared=function(){var a=this;return!(!g.Fa(a.filterType)&&!a.isValidFilterType)&&(!a.selection||a.selection.startDate===a.bounds.startDate&&a.selection.endDate===a.bounds.endDate)},b.prototype.buildBounds=function(){var a=this.pivotCache.getField(this.sourceName);return{startDate:a.bCc,endDate:a.cCc}},b.prototype.buildSelections=function(){var a,b,c,d,e,f,h,k=this;if(!k.isValidFilterType)return i.keyword_undefined;if(0===k.pivotTables.length)return this.selection||this.bounds||this.buildBounds();if(a=k.filterCondition,!a)return i.keyword_undefined;switch(b=a.WBc,c=new Date,d=g.VBc(c),e=g.VBc(c),f=g.BZJ(b,a._Qa),h=j.getQuarter(d),a.QBc){case g.PivotDateFilterOperator.equalsTo:d=new Date(f),e=new Date(f);break;case g.PivotDateFilterOperator.dateToDate:case g.PivotDateFilterOperator.Between:d=new Date(f),e=new Date(g.BZJ(b,a.aRa));break;case g.PivotDateFilterOperator.tomorrow:d.setDate(d.getDate()+1),e.setDate(e.getDate()+1);break;case g.PivotDateFilterOperator.today:break;case g.PivotDateFilterOperator.yesterday:d.setDate(d.getDate()-1),e.setDate(e.getDate()-1);break;case g.PivotDateFilterOperator.nextWeek:d.setDate(d.getDate()-d.getDay()+7),e.setDate(e.getDate()-e.getDay()+14);break;case g.PivotDateFilterOperator.thisWeek:d.setDate(d.getDate()-d.getDay()),e.setDate(e.getDate()-e.getDay()+6);break;case g.PivotDateFilterOperator.lastWeek:d.setDate(d.getDate()-d.getDay()-7),e.setDate(e.getDate()-e.getDay());break;case g.PivotDateFilterOperator.nextMonth:d.setDate(1),d.setMonth(d.getMonth()+1),e.setMonth(e.getMonth()+1),e.setDate(j.getLastDateOfMonth(e));break;case g.PivotDateFilterOperator.thisMonth:d.setDate(1),e.setDate(j.getLastDateOfMonth(e));break;case g.PivotDateFilterOperator.lastMonth:d.setDate(1),d.setMonth(d.getMonth()-1),e.setMonth(e.getMonth()-1),e.setDate(j.getLastDateOfMonth(e));break;case g.PivotDateFilterOperator.nextQuarter:d.setDate(1),d.setMonth(3*h),e.setMonth(3*(h+1)-1),e.setDate(j.getLastDateOfMonth(e));break;case g.PivotDateFilterOperator.thisQuarter:d.setDate(1),d.setMonth(3*(h-1)),e.setMonth(3*h-1),e.setDate(j.getLastDateOfMonth(e));break;case g.PivotDateFilterOperator.lastQuarter:d.setDate(1),d.setMonth(3*(h-2)),e.setMonth(3*(h-1)-1),e.setDate(j.getLastDateOfMonth(e));break;case g.PivotDateFilterOperator.nextYear:d.setDate(1),d.setMonth(0),d.setFullYear(d.getFullYear()+1),e.setFullYear(e.getFullYear()+1),e.setMonth(11),e.setDate(31);break;case g.PivotDateFilterOperator.thisYear:d.setDate(1),d.setMonth(0),e.setMonth(11),e.setDate(31);break;case g.PivotDateFilterOperator.lastYear:d.setDate(1),d.setMonth(0),d.setFullYear(d.getFullYear()-1),e.setFullYear(e.getFullYear()-1),e.setMonth(11),e.setDate(31);break;case g.PivotDateFilterOperator.yearToDate:d.setDate(1),d.setMonth(0)}return{startDate:d,endDate:e}},b.prototype.updateCache=function(){var a=this;0!==a.pivotTables.length&&(a.bounds=a.buildBounds(),a.selection=a.buildSelections(),a.refreshSlicers())},b.prototype.clearSelfFilter=function(){this.selection=i.keyword_null},b.prototype.setSingleFilter=function(a){var b,c,d,e,f=this;f.canUpdate()&&!f.filterCleared()&&(b=f.selection,c=b.startDate,d=b.endDate,e=a.Vyc,e.Oyc({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:f.sourceName,pivotName:a.name(),slicerCacheName:f.name,command:"6",isWholeDay:!0,value1:c,value2:d}}))},b.prototype.setFilter=function(a){var b,c,d,e,f,g,h=this;if(h.canUpdate()&&(a||!h.filterCleared())){for(a&&(h.selection=a),b=h.selection,c=b.startDate,d=b.endDate,h.beforeSetFilter(),e=0;e<h.pivotTables.length;e++)f=h.pivotTables[e],g=f.Vyc,g.Oyc({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:h.sourceName,pivotName:f.name(),slicerCacheName:h.name,command:"6",isWholeDay:!0,value1:c,value2:d}});h.afterSetFilter()}},b.prototype.add=function(a,b){var c=this,d=new l.PivotTableTimelineSlicer(b,a,c);return c.eTJ.push(d),d},b.prototype.toJSON=function(){var b=this,c=a.prototype.toJSON.call(this);return{name:c.name,sourceName:c.sourceName,pivotCacheId:c.pivotCacheId,pivotTables:c.pivotTables,selectionStartDate:b.selection&&""+b.selection.startDate,selectionEndDate:b.selection&&""+b.selection.endDate,boundsStartDate:""+b.bounds.startDate,boundsEndDate:""+b.bounds.endDate,filterType:b.filterType,filterCondition:b.filterCondition&&b.filterCondition.toJSON()}},b.prototype.bdK=function(b,c,d){var e,f,i,j=this,k=a.prototype.bdK.call(this,b,c,d),l=j.selection,n=j.bounds,o=j.filterType,p=g.Fa(o),q=h.Caption_Compare_Type_Excel[1][o],r=j.isValidFilterType,s=k.state={minimalRefreshVersion:"6",lastRefreshVersion:"6",pivotCacheId:j.pivotCache.cTJ+""};return p||r||(s.singleRangeFilterState="0"),p||!q?s.filterType="unknown":s.filterType=q,r&&l&&(s.selection={startDate:g.AIc(l.startDate),endDate:g.AIc(l.endDate)}),n&&(e=new Date("1900/01/01"),f=new Date("1900/01/01"),e.setFullYear(n.startDate.getFullYear()),f.setFullYear(n.endDate.getFullYear()+1),s.bounds={startDate:g.AIc(e),endDate:g.AIc(f)}),j.filterCondition&&(i=m.getPivotDateFilter(j.filterCondition,q),r&&i&&(k.timelinePivotFilter={useWholeDay:i.isWholeDay?"1":"0",fld:"1",id:"1",autoFilter:{ref:"A1",filterColumn:{r_:[43],colId:"0"}}},2===i.filterType?k.timelinePivotFilter.autoFilter.filterColumn.dynamicFilter=m.writePivotDynamicFilter(i):k.timelinePivotFilter.autoFilter.filterColumn.customFilters=m.writeCustomFilters(i,m.PivotComparisonOperators))),k},b.prototype.fromJSON=function(b){var c=this;a.prototype.fromJSON.call(this,b),b.selectionStartDate&&b.selectionEndDate&&(c.selection={startDate:new Date(b.selectionStartDate),endDate:new Date(b.selectionEndDate)}),c.bounds={startDate:new Date(b.boundsStartDate),endDate:new Date(b.boundsEndDate)}},b.prototype.preFromSJSFormat=function(b){var c,d,e,f=this;a.prototype.preFromSJSFormat.call(this,b),c=b.state,c&&(d=c.selection,e=c.bounds,d&&d.startDate&&d.endDate&&(f.selection={startDate:new Date(d.startDate),endDate:new Date(d.endDate)}),e&&e.startDate&&e.endDate&&(f.bounds={startDate:new Date(e.startDate),endDate:new Date(e.endDate)}))},b.prototype.cdK=function(a,b,c){},b.prototype.dispose=function(){a.prototype.dispose.call(this)},b}(A),E=function(){function a(a){this.Qu=a,this.WXJ=[],this.a8J=[]}return a.prototype.p7J=function(a){var b,c,d,e=this,f=e.Qu;if(e.get(a)||f.getCustomName(a))return!1;for(b=f.sheets,c=0;c<b.length;c++)if(d=b[c],d.getCustomName(a))return!1;return!0},a.prototype.dYJ=function(a,b){var c,d=this,e=a+I(b);if(d.p7J(e))return e;for(c=1;!d.p7J(e+c);)c+=1;return e+c},a.prototype._XJ=function(){return this.Qu},a.prototype.eYJ=function(a,b,c){var d=[];return g.Yxc(this.WXJ,function(e){
e.pivotCache.getName()!==a||b&&e.slicerCacheType!==b||c&&e.sourceName!==c||d.push(e)}),d},a.prototype.getPTConnectedSlicers=function(a){var b=[];return g.Yxc(this.WXJ,function(c){for(var d=0;d<c.pivotTables.length;d++)c.pivotTables[d]===a&&(b=b.concat(c.eTJ))}),b},a.prototype.getExistedSlicerCache=function(a,b,c){var d=i.keyword_null;return g.Yxc(this.WXJ,function(e){if(e.sourceName===b&&e.slicerCacheType===c)for(var f=0;f<e.pivotTables.length;f++)if(e.pivotTables[f]===a)return d=e,!0}),d},a.prototype.aYJ=function(a,b){var c=this;a.pivotTables=a.pivotTables.concat(b.pivotTables),g.Yxc(b.eTJ,function(b){a.eTJ.push(b),b.XXJ=a}),b.pivotTables=[],b.eTJ=[],c.remove(b.name),a.setFilter()},a.prototype.get=function(a){var b,c,d=this;for(b=0;b<d.WXJ.length;b++)if(c=d.WXJ[b],c.name===a)return c;return i.keyword_undefined},a.prototype.add=function(a,b,c){var d,e,f,g;return void 0===c&&(c=y.pivotSlicer),d=this,e=a.Vyc.iyc,(f=a.Vyc.qo.getPivotCacheByName(e))&&(g=d.getExistedSlicerCache(a,b,c)||d.Lla(f.cTJ,b,c))?(g.connect(a,!0),1===g.pivotTables.length&&g.updateCache(),g):i.keyword_undefined},a.prototype.Lla=function(a,b,c){var d,e,f;return void 0===c&&(c=y.pivotSlicer),d=this,e=d._XJ().AO.getPivotCacheByPivotCacheId(+a),e&&e.getField(b)?(f=c===y.pivotSlicer?new B(d,e,b,d.dYJ(p,b)):new D(d,e,b,d.dYJ(q,b)),d.WXJ.push(f),f):i.keyword_undefined},a.prototype.remove=function(a){var b,c,d=this;for(b=0;b<d.WXJ.length;b++)if(c=d.WXJ[b],c.name===a){c.dispose(),d.WXJ.splice(b,1);break}},a.prototype.getSlicer=function(a){var b,c=this;return g.Yxc(c.WXJ,function(c){var d=c.get(a);if(d)return b=d,!0}),b},a.prototype.getAllSlicers=function(a){var b=this,c=[];return g.Yxc(b.WXJ,function(b){g.Yxc(b.eTJ,function(b){(g.Fa(a)||b.sheet().name()===a)&&c.push(b)})}),c},a.prototype.removeSlicer=function(a){var b,c=this;return g.Yxc(c.WXJ,function(d){var e=d.get(a);if(e)return b={},b.slicerJSON=e.toJSON(),d.remove(a),0===d.eTJ.length&&(b.cacheJSON=d.toJSON(),c.remove(d.name)),!0}),b},a.prototype.undoAddingPivotTable=function(a){var b,c,d,e=this,f=e.WXJ;for(b=0;b<f.length;b++)c=f[b],d=c.pivotTables.indexOf(a),d!==-1&&(e.a8J.push({cacheName:c.name,ptName:a.name()}),c.pivotTables.splice(d,1))},a.prototype.undoRemovingPivotTable=function(a){var b,c,d,e=this,f=e.a8J,g=a.name();for(b=f.length-1;b>-1;b--)c=f[b],c.ptName===g&&(d=e.get(c.cacheName),d.pivotTables.indexOf(a)===-1&&d.pivotTables.push(a),f.splice(b,1))},a.prototype.onWorksheetDisposing=function(a){var b,c,d=this,e=d.WXJ;for(b=e.length-1;b>-1;b--)c=e[b],c.onWorkSheetDisposing(a),0===c.eTJ.length&&d.remove(c.name)},a.prototype.updateSlicerCaches=function(a){var b,c,d=this,e=d.WXJ;for(b=0;b<e.length;b++)c=e[b],c.pivotCache.getAllFieldsNames().indexOf(c.sourceName)===-1?d.remove(c.name):a&&!c.isConnectedPivotTable(a.name())||c.updateCache()},a.prototype.fYJ=function(a,b){var c,d;void 0===a&&(a=!1),void 0===b&&(b=!0),c=this,d=[],g.Yxc(c.WXJ,function(c){c.ZXJ(a,b)||d.push(c.name)}),d.forEach(function(a){c.remove(a)})},a.prototype.toJSON=function(){var a=this,b=[];return g.Yxc(a.WXJ,function(a){b.push(a.toJSON())}),b},a.prototype.fromJSON=function(a){var b=this;a.length>0&&(g.Yxc(this.WXJ,function(a){a.dispose()}),b.WXJ=[],b.a8J=[],g.Yxc(a,function(a){var c=g.Fa(a.boundsStartDate)?y.pivotSlicer:y.pivotTimeline,d=b.Lla(a.pivotCacheId,a.sourceName,c);d&&d.fromJSON(a)}))},a.prototype.preFromSJSFormat=function(a,b,c){var e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this;if(x.WXJ.forEach(function(a){a.dispose()}),x.WXJ=[],e=a.slicerCaches,d.GC$.each(e,function(a,b){var c,d,e=b.slicerCacheDefinition;e.pivotTables&&(c=J(e),d=x.Lla(c,e.sourceName,y.pivotSlicer),d&&d.preFromSJSFormat(e))}),g=a.timelineCaches,d.GC$.each(g,function(a,b){var c=b.timelineCacheDefinition,d=J(c,!0),e=x.Lla(d,c.sourceName,y.pivotTimeline);e&&e.preFromSJSFormat(c)}),h=c&&c.includeStyles===!1,!h&&(i=a.styles,j=i.extLst,k=d.NodeHelper.rca(i.tableStyles&&i.tableStyles.c_),j)){if(l=j.x15dxfsRecords,m=j.timelineStylesNode,n=j.timelineStyleNodes,o=j.timelineSharedColors,p=j.timelineCommonSharedStrings,!m&&!n)return;for(q=void 0,r=void 0,s=void 0,m?(q=!0,r=d.NodeHelper.rca(m.timelineStyle),s=m.N9&&m.N9.defaultTimelineStyle||"TimeSlicerStyleLight1"):(q=!1,r=n,s="TimeSlicerStyleLight1",o=new d.SimpleSharedStrings(o),p=new d.SimpleSharedStrings(p)),t=b.styleManager,u=new d.SharedDxfs(o,p),u.vlK(l),t.addDefaultStyleName("defaultTimelineStyle",s),v=function(a){var b,c,e,g,h,i=r[a];return i?(b=q?i.N9&&i.N9.name:i.name,c=q?d.NodeHelper.sca(i,"timelineStyleElements.timelineStyleElement"):i.styleElements,e=void 0,k&&(g=k.filter(function(a){return a.name===b})[0],e=g&&d.NodeHelper.sca(g,"c_")),h=new f.TimelineStyle,void h.cdK(b,t,u,c,e)):"continue"},w=0;w<r.length;w++)v(w)}},a.prototype.cdK=function(a,b,c,e,f,g){var h=this,j=!!f||!!g,k=f||a.slicers,l=g||a.timelines,m=a.drawings,n=a.styleManager,o=h._XJ(),p=d.GC$.extend({},k,l);d.GC$.each(p,function(f,g){var k,l,p,q=g.c_||g.slicers&&g.slicers.slicer||g.timelines&&g.timelines.timeline;e||(k=c&&c.sheets,l=d.Util.ciK(k,f),p=l&&d.Util.diK(l,c.workbook),e=p&&o.getSheetFromName(p)),e&&(d.GC$.each(q,function(c,d){var f,g=d.cache,i=h.get(g);i&&(f=i.get(d.name),f||(f=i.add(e,d.name)),f.init(),f.cdK(d,m,n,b,a),e.slicers.Cz(f))}),j||(e=i.keyword_null))})},a.prototype.dispose=function(){g.Yxc(this.WXJ,function(a){a.dispose()}),this.a8J=i.keyword_null,this.WXJ=i.keyword_null,this.Qu=i.keyword_null},a}(),d.Workbook.$n("SlicerCaches",{init:function(){var a=this;this.O4J=new E(a)},dispose:function(){var a=this;a.O4J&&(a.O4J.dispose(),a.O4J=i.keyword_undefined)},preFromJson:function(a,b,c){var d=this;d.O4J.dispose(),d.O4J=new E(d),a.slicerCaches&&0!==a.slicerCaches.length&&d.O4J.fromJSON(a.slicerCaches)},fromJson:function(a,b,c){var d=this;a.slicerCaches&&0!==a.slicerCaches.length&&(d.O4J.fYJ(!1),d.O4J.updateSlicerCaches())},preFromSJSFormat:function(a,c,d){var e=this;e.O4J.dispose(),e.O4J=new b.PivotSlicerCacheManager(e),(a.slicerCaches&&Object.keys(a.slicerCaches).length>0||a.timelineCaches&&Object.keys(a.timelineCaches).length>0)&&e.O4J.preFromSJSFormat(a,c,d)},cdK:function(a,b,c){var e,f,g,h,i,j,k,l=this;(a.slicerCaches&&Object.keys(a.slicerCaches).length>0||a.timelineCaches&&Object.keys(a.timelineCaches).length>0)&&(d.Util.lkK(c,l.NjK)?(e=l.getActiveSheet(),f=e.name(),g=e.yj(),h=b.sheetRelsMap,i=d.Ul.JcK(a.workbook,"sheets").c_,j=N(h,b,f,i),d.GC$.each(j,function(a,b){g.addReferenceSheetName(b)})):(k=l.O4J,k.fYJ(!1),k.cdK(b,c,a),k.updateSlicerCaches()))},toJson:function(a,b){var c=this,d=c.O4J.toJSON();d&&d.length>0&&(a.slicerCaches=d)},bdK:function(a,b,c){var d,e,g,h,i=this,j=b.styleManager,k=i.O4J;if(k&&(d=!1,e=!1,g=k.WXJ,g&&g.length>0)){for(h=0;h<g.length&&(g[h].slicerCacheType===y.pivotSlicer&&(d=!0),g[h].slicerCacheType===y.pivotTimeline&&(e=!0),!d||!e);h++);d&&f.KjK(a,g,O),e&&R(a,g),d&&(a.slicers||(a.slicers={}),f.MjK(a,g,i.sheets,j,"pivot",y.pivotSlicer)),e&&(a.timelines||(a.timelines={}),S(a,g,i.sheets,j)),(d||e)&&Q(a)}}}),d.Worksheet.$n("SlicerCaches",{cdK:function(a,b,c){var e,f,g,h,j,k,l,m=this.parent;c&&d.Util.lkK(c,m.NjK)&&(e=b.slicers,e&&(g=b.sheetRelsMap&&b.sheetRelsMap[this.name()]&&b.sheetRelsMap[this.name()].filter(function(a){return a.Type===d.RelationshipConstants.I7}).map(function(a){return d.Util.LhK(a.Target)}),f={},d.GC$.each(g,function(a,b){f[b]=e[b]})),h=b.timelines,h&&(k=b.sheetRelsMap&&b.sheetRelsMap[this.name()]&&b.sheetRelsMap[this.name()].filter(function(a){return a.Type===d.RelationshipConstants.XgK}).map(function(a){return d.Util.LhK(a.Target)}),j={},d.GC$.each(k,function(a,b){j[b]=h[b]})),(f||j)&&(l=m.O4J,l.fYJ(!1,!1),l.cdK(b,c,i.keyword_null,this,f,j),l.updateSlicerCaches()))},refSheetLazyLoaded:function(a){if(this.pivotTables.all().length>0||this.slicers.all().length>0){var b=this.parent.O4J;b.fYJ(!1),b.updateSlicerCaches()}},dispose:function(a){a.clearCache!==!1&&this.parent&&this.parent.O4J.onWorksheetDisposing(this.name())}}),d.GC$.extend(d.Workbook.prototype,{getSameSourcePivotTablesBySlicer:function(a){var b,c,d,e,f=this,h=a.XXJ,j=f.O4J.eYJ(h.pivotCache.getName(),h.slicerCacheType,h.sourceName),k={},l=[],m="__NO__CACHE__";for(g.Yxc(j,function(a){a.pivotTables.length>0&&(k[a.name]=a.pivotTables.map(function(a){return{ptName:a.name(),sheetName:a.getHost().name()}}),l=l.concat(a.pivotTables.map(function(a){return a.Vyc.getName()})))}),b=0,c=Object.keys(f.uAc);b<c.length;b++)d=c[b],l.indexOf(d)===-1&&(k[m]||(k[m]=[]),e=i.getPivotTableByFieldsModel(f.uAc[d]),k[m].push({ptName:e.name(),sheetName:e.getHost().name()}));return k},getSameSourceSlicersByPivotTable:function(a){var b=this,c=a.Vyc.qo.getPivotCacheByName(a.Vyc.iyc),d=b.O4J.eYJ(c.getName()),e={};return g.Yxc(d,function(a){a.eTJ.length>0&&(e[a.name]=a.eTJ.slice())}),e}}),b.PivotItemSlicerCache=B,b.PivotTimelineSlicerCache=D,b.PivotSlicerCacheManager=E);function O(a,b){var c,e,f,h,i,j=d.util.JcK(a.workbook,d.XFileConstants.Xkb);for(g.Fa(j)&&(j={n_:d.XFileConstants.Xkb,c_:[]},a.workbook.c_.push(j)),c=[],e=0,f=b;e<f.length;e++)h=f[e],c.push({n_:"x14:slicerCache","r:id":h});i=j.c_,i.unshift({n_:"ext",r_:[54,55],c_:[{n_:"x14:slicerCaches",c_:c}]})}function P(a,b){var c,e,f,h,i,j=d.util.JcK(a.workbook,d.XFileConstants.Xkb);for(g.Fa(j)&&(j={n_:d.XFileConstants.Xkb,c_:[]},a.workbook.c_.push(j)),c=[],e=0,f=b;e<f.length;e++)h=f[e],c.push({n_:"x15:timelineCacheRef","r:id":h});i=j.c_,i.push({n_:"ext",r_:[56,32],c_:[{n_:"x15:timelineCacheRefs",c_:c}]})}function Q(a){var b=d.util.JcK(a.workbook,d.XFileConstants.Xkb),c=b.c_;c.push({n_:"ext",r_:[57,58],c_:[{n_:"x14:workbookPr",c_:[{}]}]},{n_:"ext",r_:[59,32],c_:[{n_:"x15:workbookPr",chartTrackingRefBase:"1"}]})}function R(a,b){var c,e,g,h,i,j,k,l,m=a.timelineCaches,n=0;for(m?n=Object.keys(m).length:m=a.timelineCaches={},c=[],e=a.workbook.rels,g=0,h=b;g<h.length;g++)i=h[g],i.slicerCacheType===f.SlicerCacheType.pivotTimeline&&(n+=1,j=n,k=r(e),l="rId"+k,e.c_.push({n_:"Relationship",Id:l,Type:d.RelationshipConstants.YgK,Target:s("timelineCaches/timelineCache"+j)}),m[d.XFileConstants.ijK+j]={timelineCacheDefinition:i.bdK()},c.push(l));P(a,c)}function S(a,b,c,e){var g,h,i,j,k,l,m,n,o,p,q=a.timelines,r=Object.keys(q).length;for(g=0,h=c;g<h.length;g++)if(i=h[g],j=i.slicers.all().filter(function(a){return"timeline"===a.l8}),j.length>0)for(r+=1,k=q[d.XFileConstants.hjK+r]={timelines:{r_:[60,14,30,43],timeline:[]}},a.drawings||(a.drawings={}),l=0,m=j;l<m.length;l++)n=m[l],o=u(a,t(a,i.name())),p=o.c_,n.bdK(k.timelines.timeline,p,e),n.style().bdK(!0,!1,e);f.LjK(a,b,f.SlicerCacheType.pivotTimeline),T(c,a)}function T(a,b){var c,e,f,g,h,j,k,l=b.styles,m=new d.SimpleSharedStrings,n=new d.SimpleSharedStrings,o=new d.SharedDxfs(m,n),p=[];for(c=0,e=a;c<e.length;c++)for(f=e[c],g=f.slicers.all().filter(function(a){return"timeline"===a.l8}),h=0,j=g;h<j.length;h++)k=j[h],k.style().bdK(!1,!0,i.keyword_undefined,{x15dxfsRecords:o,timelineStyleNodes:p});l.extLst||(l.extLst={}),d.GC$.extend(l.extLst,{x15dxfsRecords:o.ulK(),timelineSharedColors:m.bdK(),timelineCommonSharedStrings:n.bdK(),timelineStyleNodes:p})}},"./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Pivot"),f=c("Shapes"),g=c("Shapes"),h=c("Slicers"),i=c("Slicers"),j=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),k=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),b.keyword_null=null,b.keyword_undefined=void 0,b.NAME="name";function n(a,c){var d,e,f,g,h=a.sheets;for(d=0;d<h.length;d++)if(e=h[d].slicers&&h[d].slicers.all())for(f=0;f<e.length;f++)if(g=e[f],r(g)&&g.SSJ.nSa===c)return{sheetIndex:d,slicer:g};return b.keyword_null}function o(a,b){return a.O4J.getSlicer(b)}function p(a){var c,d;for(c=0;c<a.nyc.length;c++)if(d=a.nyc[c],d instanceof k.PivotTable)return d;return b.keyword_null}b.getPivotTableByFieldsModel=p;function q(a){var b,c=p(a);c&&c.qo&&c.qo.parent&&(b=c.qo.parent,b.O4J.updateSlicerCaches(c))}function r(a){return a&&(a.l8===i.SlicerType.pivotTable||a.l8===i.SlicerType.pivotTimeline)}function s(a,c){var d=c.uAc[a];return d?p(d):b.keyword_null}b.getPivotTableByPTName=s,h&&g&&(f.ShapeBase.$n("PivotSlicer",{fireEvents:function(a){var b=a.sheet,c=a.sheetName,d=a.propertyName,f=a.shape,g=b.slicers.all();e.Yxc(g,function(e){if(r(e)){var g=e.SSJ;if(g&&g.nSa===f&&g.nSa[d])return a.stopThisFire=!0,e.Wq({sheet:b,sheetName:c,slicer:e,propertyName:d}),!0}})},ShapeCopingOrCutting:function(a){var c,d,e=a.sheet,f=a.shape,g=e&&e.parent,h=n(g,f);h&&(c=h.slicer,d={slicerJSON:c.toJSON(),slicerName:c.name(),sourceName:c.sourceName(),slicerCacheName:c.XXJ.name,shapeName:f.name(),cacheJSON:b.keyword_null},a.isCutting&&(d.cacheJSON=c.XXJ.toJSON()),a.drawingData=d)},FormControlShapePasting:function(a){var c,d,e,f,g,h,j,k,l,m,n=a.sheet,o=a.fromSheetName,p=a.toSheetName,q=a.name,s=a.drawingData,t=a.isCutting,u=n.parent.getSheetFromName(o);if(s&&u&&u.slicers){if(c=s.slicerJSON,d=s.slicerName,e=s.slicerCacheName,f=s.cacheJSON,c.type!==i.SlicerType.pivotTable&&c.type!==i.SlicerType.pivotTimeline)return;t||(d=u.slicers.HS(q)),g=n.parent.O4J,h=g.get(e),!h&&f&&(j=c.type===i.SlicerType.pivotTable?i.SlicerCacheType.pivotSlicer:i.SlicerCacheType.pivotTimeline,h=g.Lla(f.pivotCacheId,f.sourceName,j),h.fromJSON(f)),k=h.add(n,d),n.slicers.Cz(k),i.SlicerBaseProperties.forEach(function(a){var d=a[0];"name"!==d&&c[d]!==b.keyword_undefined&&k[d](c[d])}),r(k)&&i.ItemSlicerProperties.forEach(function(a){var d=a[0];c[d]!==b.keyword_undefined&&k[d](c[d])}),k.style().fromJSON(c.style),k.init(),l=k.SSJ.nSa,o!==p&&(l.kj=n,m=l.name(),n.oob(m)||l.name(m&&n.oob(m)||n.oob("FormControl ",!0))),a.shape=l}},ShapeRemoving:function(a){var b,c,d,e,f,g=a.sheet,h=a.shape,i=a.isGroup,j=a.ignoreModel;i||(b=g.parent,c=n(b,h),c&&(d=c.slicer,e=c.sheetIndex,f=b.sheets[e],d.SSJ.YSJ=!0,f.slicers.vV(d.name(),j),a.cancelEvent=!0))}}),d.Worksheet.$n("PivotSlicer",{slicerAdding:function(a){var b,c,d,e,f,g,h,j,k,l,m,n,o=this;if((a.type===i.SlicerType.pivotTable||a.type===i.SlicerType.pivotTimeline)&&(b=o.parent&&o.parent.O4J)){if(c=a.type===i.SlicerType.pivotTable?i.SlicerCacheType.pivotSlicer:i.SlicerCacheType.pivotTimeline,d=a.slicerName,e=a.targetName,f=a.itemName,g=a.sheet,h=a.slicerCacheName,h)j=b.get(h);else{if(l=o.parent._Cc(e),!l)return;if(m=l.Vyc,k=m.getSourceNameByFieldName(f),!k){if(m.getAllFieldNameList().indexOf(f)===-1)return;k=f}j=b.add(l,k,c)}n=j.add(g,d),n.init(),a.slicer=n}},slicerRemoved:function(a){var b,c=this.parent,d=a.slicer.name(),e=o(c,d);if(e){if(e.isSelected(!1),b=c.O4J.removeSlicer(d),e.SSJ){if(e.SSJ.YSJ)return;e.SSJ.YSJ=!0}this.ITa.xVa(self,"undoRemove",b)}},slicerRenamed:function(a){var b=a.newName,c=a.slicer;r(c)&&c.name(b)},getAllSlicers:function(a){var b=this,c=a.slicers,e=a.targetName,f=a.itemName;d.GC$.each(b.slicers.WX,function(a,b){var d,g,h;if(r(b))if(e){if(d=b.getAllConnectedPivotTables(),d&&d.length>0)for(g=0;g<d.length;g++)if(h=d[g],h.name()===e&&(!f||h.getField(b.sourceName()).fieldName===f)){c.push(b);break}}else c.push(b)})},slicerFromJson:function(a){var b,c,d,f,g,h,j,k,l,m,n,o,p=a.slicerJSON,q=a.cacheJSON;if((p.type===i.SlicerType.pivotTable||p.type===i.SlicerType.pivotTimeline)&&this.parent&&(b=p.pivotName,c=p.sourceName,d=p.slicerCacheName,f=a.sheetName,g=this.parent,g&&(h=g.getSheetFromName(f)))){if(e.Fa(b)){if(!d)return;q&&(k=g.O4J,l=p.type===i.SlicerType.pivotTable?i.SlicerCacheType.pivotSlicer:i.SlicerCacheType.pivotTimeline,j=k.Lla(q.pivotCacheId,q.sourceName,l),j.fromJSON(q)),j=g.O4J.get(d)}else{if(m=this.parent._Cc(b),!m)return;if(n=m.Vyc,n.getAllFieldNameList().indexOf(c)===-1)return;j=g.O4J.add(m,c),i.ItemSlicerCacheProperties.forEach(function(a){e.Fa(p[a])||(j["_"+a]=p[a])})}j&&(o=j.get(p.name),o||(o=j.add(h,p.name)),o.init(),o.fromJSON(p),this.slicers.Cz(o))}}}),j.PivotFieldsModel.$n("PivotSlicer",{setSlicerFilter:function(a){var b=a.textItem,c=a.oldTextItem,d=a.condition,e=a.oldCondition;(b||c)&&(b&&!c||!b&&c||b.list&&b.list.filter(function(a){return c.list.indexOf(a)===-1}).length>0||c.list&&c.list.filter(function(a){return b.list.indexOf(a)===-1}).length>0)&&q(this),(d||e)&&q(this)},updatePivotCache:function(a){q(this)},rebuild:function(){q(this)}}),d.GC$.extend(k.PivotTable.prototype,{getAllSlicers:function(){return this.qo.parent.O4J.getPTConnectedSlicers(this)},connectSlicer:function(a){var b=o(this.qo.parent,a);b&&b.connectPivotTable(this.name())},disconnectSlicer:function(a){var b=o(this.qo.parent,a);b&&b.disconnectPivotTable(this.name())},isConnectedSlicer:function(a){var b=o(this.qo.parent,a);if(b)return b.getConnectedPivotTableNameList().indexOf(this.name())!==-1}}),l=function(a){m(b,a);function b(b,c,d){var e=a.call(this,b,c,d)||this;return e.captionName(e.sourceName()),e}return b.prototype.sheet=function(){return this.kj},b.prototype.connectPivotTable=function(a){var b,c,d,f,g;if(!e.Fa(a)&&(b=this,c=b.kj&&b.kj.parent&&b.kj.parent.sheets,c&&c.length>0))for(d=0;d<c.length;d++)if(f=c[d],g=f.pivotTables.get(a))return void b.XXJ.connect(g)},b.prototype.disconnectPivotTable=function(a){var b,c=this;c.isConnectedPivotTable(a)&&(b=s(a,c.kj.parent),b&&c.XXJ.disconnect(b))},b.prototype.isConnectedPivotTable=function(a){if(a)return this.XXJ.isConnectedPivotTable(a)},b.prototype.getAllPivotTables=function(){var a=this;return a.XXJ.pivotTables},b.prototype.getAllConnectedPivotTables=function(){var a=this;return a.XXJ.pivotTables},b.prototype.getConnectedPivotTableNameList=function(){return this.getAllConnectedPivotTables().map(function(a){return a.name()})},b}(i.SlicerBase),b.P4J=l)},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Slicers"),f=c("Shapes"),g=c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),h=c("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-slicer-view-model.js"),i=d.Ul.naa,j=d.Util.Sha,e&&f&&(k=e.SlicerStyles,l=e.SlicerType,m=e.defSlicerProperty,n=e.ItemSlicerProperties,o=e.SlicerChangeType,p=e.afterPropertyChanged,q=function(a){r(b,a);function b(b,c,d){var e,f=a.call(this,b,c,d)||this;return f.l8=l.pivotTable,e=f,e.Wqa=k.light1(),f}return b.prototype.getItems=function(){return this.XXJ.items},b.prototype.getOptionsSet=function(){var a=this;return{nameInFormula:a.nameInFormula(),sourceName:a.sourceName(),name:a.name(),captionName:a.captionName(),showNoDataItems:a.showNoDataItems(),showNoDataItemsInLast:a.showNoDataItemsInLast(),visuallyNoDataItems:a.visuallyNoDataItems(),showHeader:a.showHeader(),sortState:a.sortState(),columnCount:a.columnCount(),multiSelect:a.multiSelect(),itemHeight:a.itemHeight(),filterCleared:a.filterCleared(),isLocked:a.isLocked()}},b.prototype._SJ=function(){var a=this;a.XXJ.updateItems()},b.prototype.setFilterWithItems=function(a){var b=this;b.XXJ.setFilter(a)},b.prototype.sortState=function(a){var b,c=this;return 0===arguments.length?c.XXJ.sortState():(b=c.XXJ.sortState(),void(a!==b&&(c.XXJ.sortState(a),p.call(c,"sortState",b))))},b.prototype.showNoDataItems=function(a){var b,c=this;return 0===arguments.length?c.XXJ.showNoDataItems():(a=!!a,b=c.XXJ.showNoDataItems(),void(a!==b&&(c.XXJ.showNoDataItems(a),p.call(c,"showNoDataItems",b))))},b.prototype.showNoDataItemsInLast=function(a){var b,c=this;return 0===arguments.length?c.XXJ.showNoDataItemsInLast():(a=!!a,b=c.XXJ.showNoDataItemsInLast(),void(a!==b&&(c.XXJ.showNoDataItemsInLast(a),p.call(c,"showNoDataItemsInLast",b))))},b.prototype.visuallyNoDataItems=function(a){var b,c=this;return 0===arguments.length?c.XXJ.visuallyNoDataItems():(a=!!a,b=c.XXJ.visuallyNoDataItems(),void(a!==b&&(c.XXJ.visuallyNoDataItems(a),p.call(c,"visuallyNoDataItems",b))))},b.prototype.initSlicerUI=function(){var a=this;a.SSJ=new h.PivotTableItemSlicerViewModel(a.kj,a.getOptionsSet.bind(a),a.getItems.bind(a)),a.SSJ.setStyle(a.Wqa),a.SSJ.bind("valueChanged",function(b){a.setFilterWithItems(b)}),a.SSJ.bind("clearFilter",function(){a.clearFilter()}),a.SSJ.bind("propertyChanged",function(b){var c=b.propName,d=b.value;a[c]&&a[c](d)})},b.prototype.fromJSON=function(b){if(b){a.prototype.fromJSON.call(this,b);var c=this;n.forEach(function(a){var d=a[0];b[d]!==g.keyword_undefined&&c[d](b[d])})}},b.prototype.cdK=function(b,c,e,f){if(b){a.prototype.cdK.call(this,b,c,e,f);var h=this;b.rowHeight!==g.keyword_undefined&&h.itemHeight(d.ExcelHelper.emuToPixles(+b.rowHeight)-4),b.lossless&&b.lossless.multiSelect!==g.keyword_undefined&&h.multiSelect(b.lossless.multiSelect),b.columnCount!==g.keyword_undefined&&h.columnCount(+b.columnCount)}},b.prototype.toJSON=function(b){var c=this,d=a.prototype.toJSON.call(this,b);return n.forEach(function(a){var b=a[0];d[b]=c[b]()}),d},b.prototype.bdK=function(a,b,c){var g,h=this,k={name:i(j(h.name(),"\n","_x000a_")),cache:i(h.XXJ.name),caption:i(h.captionName()),columnCount:h.columnCount(),style:i(h.Wqa.name()),rowHeight:d.ExcelHelper.pixelToEMU(h.itemHeight()+4),lossless:{multiSelect:h.multiSelect()}};h.showHeader()||(k.showCaption=f.SJS_False),h.disableResizingAndMoving()&&(k.lockedPosition=f.SJS_True),a.push(k),g={twoCellAnchor:e.getSlicerDrawing(h)},b.push(g)},b}(g.P4J),n.forEach(function(a){q.prototype[a[0]]=m(a[0],a[1],a[2],a[3])}),b.PivotTableItemSlicer=q)},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-slicer-view-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Shapes"),e=c("Slicers"),d&&e&&e.SlicerViewModelBase&&(f=e.getSlicerSizePosInfo,g=e.ItemSlicerFormControl,h=e.SlicerChangeType,i=e.SlicerViewModelBase,j=function(a){k(b,a);function b(b,c,d){return a.call(this,b,c,d)||this}return b.prototype.ZSJ=function(){var a,b,c,d,e,h,i,j=this,k=this,l=k.kj;l.shapes&&(a=k.updateOptionsCallback(),b=f(l,!0),c=b.left,d=b.top,e=b.width,h=b.height,i=l.shapes.addFormControl(a.name,g,c,d,e,h),i.allowResize(!0),i.allowMove(!0),i.dynamicSize(!1),i.dynamicMove(!0),i.drawingType="Slicer",k.jxa=i.$SJ,k.nSa=i,k.refreshFormControl(),k.jxa.addEventListener("valueChanged",function(a,b){var c=j.updateValuesCallback();c.forEach(function(a){return a.selected=b.indexOf(a.text)!==-1}),j.Wq("valueChanged",c)}),k.jxa.addEventListener("clearFilter",function(a,b){j.Wq("clearFilter",{})}),k.jxa.addEventListener("propertyChanged",function(a,b){j.Wq("propertyChanged",b)}))},b.prototype.refreshFormControl=function(){var b,c;a.prototype.refreshFormControl.call(this),b=this,c=b.jxa,c.setItems(b.updateValuesCallback())},b}(i),b.PivotTableItemSlicerViewModel=j)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-dropdown.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("Slicers"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new d.Common.ResourceManager(g.SR,"PivotTables"),i=h.getResource.bind(h),j="gc-timeline-level-dropdown",k="gc-timeline-level-block",l="gc-timeline-level-text",m="gc-timeline-selected-level",f&&(n=function(a){o(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.onChange=d,e}return b.prototype.init=function(b,c,d){a.prototype.ad.call(this);var e=this.initHTMLStr(b);this.open(c,d,e)},b.prototype.initHTMLStr=function(a){var b,c="",d=["",i().TIME_LEVEL_YEARS,i().TIME_LEVEL_QUARTERS,i().TIME_LEVEL_MONTHS,i().TIME_LEVEL_DAYS];for(b=1;b<=4;b++)c+=this.EZJ(d[b],a===b,b);return c},b.prototype.EZJ=function(a,b,c){var d="";return b&&(d="\u221a"),' <div class="'+k+'" level="'+c+'">\n                        <div class="'+m+'">\n                            '+d+'\n                        </div>\n                        <div class="'+l+'">\n                            '+a+"\n                        </div>\n                    </div>"},b.prototype.Sla=function(a,b){var c=this.yo(),d=e.GC$("."+j);return 0===d.length&&(d=e.GC$(e.Ul.Nl("div"))),d.css(["left","top"],[a,b]),d.addClass(j),d.appendTo(c),d},b.prototype.open=function(a,b,c){var d=this.Sla(a,b);d.html(c),this.Ao()},b.prototype.QQ=function(){var a=this;e.GC$("."+k).bind("click",function(b){var c,d=b.target;d.className!==m&&d.className!==l||(d=d.parentElement),c=parseInt(d.getAttribute("level"),10),c&&(a.onChange(c),a.close())})},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.QQ()},b.prototype.Tla=function(){e.GC$("."+k).unbind("click")},b.prototype.close=function(){this.Tla(),a.prototype.close.call(this)},b}(e.Go),b.PivotTimelineDropdown=n)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("Slicers"),h=c("Shapes"),i=c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),j=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js"),k=c("./dist/plugins/pivot/pivot.ns.js"),l=e.Common.pc,m=e.Common.CultureManager,n=new e.Common.ResourceManager(k.SR,"PivotTables"),o=n.getResource.bind(n);function L(){var a=m.q4(m.culture()).DateTimeFormat;return a&&a.abbreviatedMonthNames||[]}b.getMonthMap=L,p=d.Ul.hZa,q="M",r="rgba(0, 0, 0, 0.15)",s="rgb(243, 243, 243)",t=1,u=18,v=19,w=75,x=6,y="#9c9c9c",z="#dddddd",A=5,function(a){a[a.item=0]="item",a[a.scrollBar=1]="scrollBar",a[a.leftScrollButton=2]="leftScrollButton",a[a.rightScrollButton=3]="rightScrollButton",a[a.leftDragButton=4]="leftDragButton",a[a.rightDragButton=5]="rightDragButton"}(B||(B={})),g&&h&&(C=h.drawRoundedRect,D=g.TimelineLevel,E=g.appendBackColorStyle,F=g.Border_Names,G=g.fillText,H=g.getEllipsisText,I=g.paintBorder,J=g.SlicerScrollBar,K=function(){function a(){this.aZJ=10.25,this.B1J=30.75,this.lZJ=0,this.zTJ=!1,this.ATJ=-1,this.li=-1,this.g_=-1,this.BTJ=!1,this.CTJ=!1,this.needDrawDragRect=!1,this.qTJ={containerSize:{w:300,h:100},selection:i.keyword_null,bounds:i.keyword_null,scrollPosition:i.keyword_null,offset:{top:0,left:0},level:i.keyword_null,selectionLevel:i.keyword_null,canShowRange:!0,filterCleared:!0,showScrollbar:!0,showHeader:!0,showSelectionLabel:!0,showLevel:!0,onSelectionChanged:function(){},onItemClick:function(){},getStyle:function(a){return i.keyword_null},getThemeColor:function(){return""},refresh:function(){},setCursor:function(){},onScrollPositionChanged:function(){},getPointerRelativeControl:function(a){return{x:0,y:0}}},this.initScrollbar()}return Object.defineProperty(a.prototype,"props",{get:function(){return this.qTJ},set:function(a){this.qTJ=a},enumerable:!0,configurable:!0}),a.prototype.initScrollbar=function(){var a=this,b=new J,c=b.props;c.direction="horizontal",c.showButton=!1,c.sliderColor=j.WHITE,c.renderTrack=!1,c.syncSliderHeightWithPageStep=!0,c.refresh=this.refresh.bind(this),c.getPointerRelativeControl=function(b){var c=a.getPointerRelativeControl(b),d=c.x,e=c.y;return{x:d-v,y:e-w}},c.setCursor=this.setCursor.bind(this),c.onScroll=this.onScrollBarChange.bind(this),c.finishScroll=this.onScrollBarChanged.bind(this),this.ETJ=b},a.prototype.onScrollBarChange=function(){var a=this,b=this.ETJ.props.value;a.lZJ=b},a.prototype.onScrollBarChanged=function(){var a,b=this,c=this._items[0],d=this.ETJ.props.value;if(0===d)a=i.keyword_null;else switch(a=new Date(""+c),b.level){case D.years:a.setFullYear(a.getFullYear()+d);break;case D.quarters:a.setMonth(a.getMonth()+3*d);break;case D.months:a.setMonth(a.getMonth()+d);break;case D.days:a.setDate(a.getDate()+d)}b.qTJ.onScrollPositionChanged(a),b.setCursor("default")},a.prototype.update=function(){var a=this;try{a.buildItems()}catch(a){return}a.setStartPosition()},a.prototype.setStartPosition=function(){var a,b,c=this.scrollPosition;if(c){if(!this._items)try{this.buildItems()}catch(a){return}for(a=this._items,b=0;a[b]<c&&b<a.length;)b++;this.lZJ=Math.min(b,this.maxScrollCount)}else this.lZJ=0;this.refresh()},a.prototype.onLevelChanged=function(){var a,b,c,d,e=this,g=e.selection;if(!f.Fa(g)){for(a=g.startDate,b=this._items,c=0;b[c]<a&&c<b.length;)c++;d=Math.round(c-e.onePageCanDisplayItemsCount/2),e.qTJ.onScrollPositionChanged(b[d]||b[0])}},a.prototype.render=function(a){var b=this;a.save(),b.C1J=i.keyword_null,b.D1J=i.keyword_null,b.renderItems(a),b.renderLeftScrollButton(a),b.renderRightScrollButton(a),b.updateScrollbarProps(),b.renderScrollbar(a),b.needDrawDragRect&&(P(a,b.C1J,!0),P(a,b.D1J,!1)),a.restore()},a.prototype.updateScrollbarProps=function(){var a=this.width-2*(v+1),b=this.ETJ.props;b.containerSize={w:a,h:v},b.max=this.maxScrollCount,b.value=this.lZJ,b.pageStep=this.onePageCanDisplayItemsCount,this.ETJ.props=b},a.prototype.renderScrollbar=function(a){var b=this,c=v+1;a.save(),a.translate(c,w+(b.showScrollBar?0:15)+(b.showHeader?0:15)),b.showScrollBar&&b.qTJ.canShowRange&&b.renderScrollbarTrack(a,b.width-2*(v+1)),b.needShowScrollbar&&b.ETJ.render(a),a.restore()},a.prototype.renderLeftScrollButton=function(a){this.renderScrollBtn(a,this.nZJ===B.leftScrollButton,!0)},a.prototype.renderRightScrollButton=function(a){this.renderScrollBtn(a,this.nZJ===B.rightScrollButton,!1)},a.prototype.renderScrollBtn=function(a,b,c){var d=this,e=c?d.leftBtnRect:d.rightBtnRect,f=b?s:j.WHITE,g=b?"rgb(135, 135, 135)":"rgb(196, 196, 196)",h="rgb(120, 119, 117)",i=3,k=function(){a.save(),a.translate(e.x,e.y),a.translate((e.w-2*i)/2,(e.h-i)/2),a.beginPath();var b=c?-90:90;b&&(a.translate(i,i/2),a.rotate(b/180*Math.PI),a.translate(-i,-i/2)),a.moveTo(0,i),a.lineTo(i,0),a.lineTo(2*i,i),a.strokeStyle=h,a.lineWidth=2,a.stroke(),a.restore()};a.save(),a.beginPath(),a.rect(e.x,e.y,e.w,e.h),a.fillStyle=f,a.fill(),a.strokeStyle=g,a.stroke(),k(),a.restore()},a.prototype.renderScrollbarTrack=function(a,b){var c,d,e,f,g=this,h=v-10,i="E6E6E6",j=g.getStyle("selectedTimeBlockStyle"),k=R(g.bounds.startDate,!0,!0),m=R(g.bounds.endDate,!0,!1),n=m-k,o=j&&j.backColor();o&&!Q(o)&&("string"==typeof o?i=l.nc(g.getThemeColor(o),.5):"object"==typeof o&&o.stops&&o.stops.length>0&&o.stops[0].color&&(i=l.nc(g.getThemeColor(o.stops[0].color),.5))),g.selection?(e=R(g.selection.startDate),f=R(g.selection.endDate),c=b*((e-k)/n),d=b*((f-e)/n)):(c=0,d=b),a.save(),a.fillStyle=i,a.fillRect(c,5,d,h),a.restore()},a.prototype.renderItems=function(a){var b,c,d,e,f,g,h,i,j,k,l,m=this;for(m.level!==m.DZJ&&(m.buildItems(),m.lZJ=0,m.ETJ.value=0),m.buildItemWidth(a),b=m.lZJ,c=m._items,d=!1,e=!1,f=!1,g=0;g+b<c.length&&(h=c[g+b],a.beginPath(),i=m.isSelectedItem(h,e,f),j=i.selected,k=i.isLeft,l=i.isRight,e=!(!k||e)||e,f=!(!l||f)||f,!m.renderItem(a,h,g,m.cZJ(h,0===g),j,d&&j,k,l));g++)d=j},a.prototype.buildItemWidth=function(a){var b,c,d,e=this,f=new Date("2000-11-11"),g=e.E1J(f),h=e.getWholeStyle(),i=e.getStyle("periodLabel1Style");
a.save(),b=i&&i.font()||h&&h.font()||j.TIMELINE_DEFAULT_FONT,a.font=p(b),e.aZJ=a.measureText(q).width,c=e.getStyle("periodLabel2Style"),d=c&&c.font()||h&&h.font()||j.TIMELINE_DEFAULT_FONT,a.font=p(d),e.B1J=a.measureText(g).width,a.restore()},a.prototype.buildItems=function(){var a=this,b=a.bounds,c=b.startDate,d=b.endDate,e=a.level,f=c.getFullYear(),g=d.getFullYear();switch(e){case D.years:a.buildYearsItems(f,g);break;case D.quarters:a.buildQuartersItems(f,g);break;case D.months:a.buildMonthsItems(f,g);break;case D.days:a.buildDaysItems(f,g)}a.DZJ=a.level},a.prototype.buildYearsItems=function(a,b){var c,d=[];for(c=a;c<=b;c++)d.push(new Date(c,0));this._items=d},a.prototype.buildQuartersItems=function(a,b){var c,d,e=[];for(c=a;c<=b;c++)for(d=0;d<4;d++)e.push(new Date(c,3*d));this._items=e},a.prototype.buildMonthsItems=function(a,b){var c,d,e=[];for(c=a;c<=b;c++)for(d=0;d<12;d++)e.push(new Date(c,d));this._items=e},a.prototype.buildDaysItems=function(a,b){var c,d,e,f,g=[];for(c=a;c<=b;c++)for(d=0;d<12;d++)for(e=O(c,d),f=1;f<=e;f++)g.push(new Date(c,d,f));this._items=g},a.prototype.cZJ=function(a,b){var c=this,d=c.level;switch(d){case D.years:return i.keyword_null;case D.quarters:case D.months:return 0===a.getMonth()||b?a.getFullYear()+"":i.keyword_null;case D.days:return 1===a.getDate()||b?L()[a.getMonth()].toUpperCase()+" "+a.getFullYear():i.keyword_null;default:return i.keyword_null}},a.prototype.E1J=function(a){var b=this,c="";switch(b.level){case D.years:c=a.getFullYear()+"";break;case D.quarters:c=o().QUARTER_MAP[M(a)];break;case D.months:c=L()[a.getMonth()].toUpperCase();break;case D.days:c=a.getDate()+""}return c},a.prototype.isSelectedItem=function(a,b,c){var d,e,g,h=this,i=h.selection,j=!1,k=!1,l=!1;return h.qTJ.canShowRange&&(f.Fa(i)?j=!0:(d=i.startDate,e=i.endDate,g=h.F1J(a),h.selectionLevel<=h.level?a<=e&&a>=d&&(j=!0,k=!b&&a<=d,l=!c&&g>=e):g<d||e<a||(j=!0,k=!b&&a<=d,l=!c&&g>=e))),{selected:j,isLeft:k,isRight:l}},a.prototype.isHoveredItem=function(a){return this.ATJ===a},a.prototype.renderItem=function(a,b,c,e,f,g,h,j){var k,l,m,n,o,p,q,s,u,w,y,z,A,B,D,G,H,J=this,K=J.itemWidth-t,L=J.itemHeight,M=J.showScrollBar,N=J.showHeader,O=c*(K+t)+(M?0:v+3),P=50+(N?0:15);if(O>J.width+v)return!0;if(!M){if(k=J.width+v-3,O>k)return!0;O+K>k&&(K=k-O)}for(l=J.getStyle("selectedTimeBlockStyle"),m=J.getStyle("unselectedTimeBlockStyle"),n=f?l:m,o=J.getWholeStyle(),p=new d.Rect(O,P,K,L),q=0,s=K,J.selectionLevel&&J.selectionLevel>J.level&&(h||j)?(u=J.G1J(b,h,j),w=u.leftPoint,y=u.rightPoint,q=K*w,s=K*(y-w)||2,z=new d.Rect(O+q,P,s,L),E(a,O,P,K,L,m,o,J.getThemeColor.bind(J)),C(p,0,a),E(a,z.x,z.y,z.width,z.height,l,o,J.getThemeColor.bind(J)),C(z,0,a)):(E(a,O,P,K,L,n,o,J.getThemeColor.bind(J)),C(p,0,a)),h&&(J.C1J=new d.Rect(O+q-x,P,x,L)),j&&(J.D1J=new d.Rect(O+q+s,P,x,L)),J.isHoveredItem(c+J.lZJ)&&(a.save(),a.fillStyle=r,C(p,0,a),a.restore()),A=J.getStyle("selectedTimeBlockSpaceStyle"),g&&A&&A.backColor()&&(B=new d.Rect(O-t,P,t,L),a.save(),E(a,B.x,B.y,B.width,B.height,A,i.keyword_null,J.getThemeColor.bind(J)),C(B,0,a),a.restore()),e&&J.paintLabelText1(a,e,O,P-35),J.paintLabelText2(a,b,O,P-20,K,L),0===p.x&&(p.x+=.5,p.width-=.1),0===p.y&&(p.y+=.5,p.height-=.1),D=0;D<4;D++)G=F[D],H=n&&n[G](),H&&I(a,D,p,H,J.getThemeColor.bind(J),0)},a.prototype.F1J=function(a){var b=new Date(""+a),c=864e5;switch(this.level){case D.years:b.setFullYear(b.getFullYear()+1);break;case D.quarters:b.setMonth(b.getMonth()+3);break;case D.months:b.setMonth(b.getMonth()+1);break;case D.days:b.setDate(b.getDate()+1)}return new Date(b.getTime()-c)},a.prototype.G1J=function(a,b,c){var d,e,f,g=this,h=g.selection,i=0,j=1;return h&&(d=g.F1J(a),e=h.startDate,f=h.endDate,i=b?+((e.getTime()-a.getTime())/(d.getTime()-a.getTime())).toPrecision(3):0,j=c?+((f.getTime()-a.getTime())/(d.getTime()-a.getTime())).toPrecision(3):1),{leftPoint:i,rightPoint:j}},a.prototype.paintLabelText1=function(a,b,c,d){var e,f,g,h,i=this,k=i.itemWidth-t;a.save(),e=i.getStyle("periodLabel1Style"),f=i.getWholeStyle(),g=i.getThemeColor(e&&e.foreColor()||f&&f.foreColor()||j.BLACK),h=e&&e.font()||f&&f.font()||j.TIMELINE_DEFAULT_FONT,a.font=p(h),G(a,H(a,b,2*k),c,d,g,i.aZJ,k),a.restore()},a.prototype.paintLabelText2=function(a,b,c,d,e,f){var g,h=this,i=h.getStyle("periodLabel2Style"),k=h.getWholeStyle(),l=i&&i.foreColor()||k&&k.foreColor()||j.BLACK,m=p(i&&i.font()||k&&k.font()||j.TIMELINE_DEFAULT_FONT);a.save(),a.font=p(m),g=h.E1J(b),G(a,H(a,g,e),c,d,h.getThemeColor(l),f,e),a.restore()},a.prototype.hitTest=function(a,b){var c,d,e=this,f=this.width,g=e.showScrollBar,h=e.showHeader,i=e.leftBtnRect,j=e.rightBtnRect,k=g?a:a+v+3,l=h?b:b+15,m=function(){return a>=0&&a<=f-(g?0:7)&&b>=50&&b<50+e.itemHeight},n=function(){return k>=i.x&&k<=i.x+i.w&&l>=i.y&&l<=i.y+i.h},o=function(){return k>=j.x&&k<=j.x+j.w&&l>=j.y&&l<=j.y+j.h},p=function(){return e.needShowScrollbar&&a>=e.scrollButtonSize&&a<=e.width-e.scrollButtonSize&&l>=i.y&&l<=i.y+i.h},q=function(){var a=e.C1J;return a&&k>=a.x&&k<=a.x+a.width&&l>=a.y&&l<=a.y+a.height},r=function(){var a=e.D1J;return a&&k>=a.x&&k<=a.x+a.width&&l>=a.y&&l<=a.y+a.height},s=e.getClickItemIndex(a,b);return q()?(c=B.leftDragButton,d=s):r()?(c=B.rightDragButton,d=s):m()?s!==-1&&(c=B.item,d=s):p()?c=B.scrollBar:n()?c=B.leftScrollButton:o()&&(c=B.rightScrollButton),{target:c,data:d}},a.prototype.onMouseDown=function(a){var b,c=this,d=c.getPointerRelativeControl(a),e=c.hitTest(d.x,d.y),f=e.target,g=e.data;return f===B.leftDragButton||f===B.rightDragButton?(c.H1J=f,c.zTJ=!0,!0):f===B.item?(c.g_=g,c.li=g,c.CTJ=!0,c.zTJ=!0,c.changeSelection(),!0):f===B.scrollBar?(c.ETJ.onMouseDown(a),c.zTJ=!0,!0):f===B.leftScrollButton||f===B.rightScrollButton?(c.nZJ=f,b=f===B.leftScrollButton?-1:1,c.scroll(b),c.startScrollInterval(b),!0):void 0},a.prototype.isInBounding=function(a,b){var c=this.width,d=this.height;return a>=0&&a<=c&&b>=0&&b<=d},a.prototype.onMouseMove=function(a){var b,c,d,e,f,g=this;return g.ETJ.onMouseMove(a),b=g.getPointerRelativeControl(a),c=g.hitTest(b.x,b.y),d=c.target,e=c.data,f=g.H1J,f?g.onDragButtonChanging(f,e,b.x):d===B.item?(g.CTJ?g.li!==e&&(g.BTJ=!0,g.li=e,g.changeSelection()):g.ATJ=e,g.setCursor("default")):(d===B.leftScrollButton||d===B.rightScrollButton?g.setCursor("default"):d!==B.leftDragButton&&d!==B.rightDragButton||g.setCursor("ew-resize"),g.ATJ=-1),g.refresh(),!0},a.prototype.onDragButtonChanging=function(a,b,c){var d,e,g,h,i,j,k,l;f.Fa(b)||b===-1||(d=this,e=d.I1J(b),g=(e.from+e.to)/2,a===B.leftDragButton?(h=g+d.itemWidth,i=b+1,c<=g?i=b:c>=h&&(i=b+2),d._items[i]&&d._items[i].toLocaleDateString()!==d.selection.startDate.toLocaleDateString()&&d._items[i]<=d.selection.endDate&&(j=new Date(""+d._items[i]),k=d.selection.endDate,d.selection={startDate:j,endDate:k})):(h=g-d.itemWidth,l=b-1,c>=g?l=b:c<=h&&(l=b-2),d._items[l]&&d._items[l]>=d.selection.startDate&&(j=d.selection.startDate,k=new Date(""+d._items[l]),d.selection=d.oZJ(j,k))))},a.prototype.I1J=function(a){var b=this;return a-=b.lZJ,{from:a*b.itemWidth,to:(a+1)*b.itemWidth}},a.prototype.onWindowMouseMove=function(a){var b,c=this,d=c.getPointerRelativeControl(a),e=c.itemsAreaWidth-1+c.props.offset.left,f=c.hitTest(e,d.y).target;if(c.mouseDownItemIndexIsValid){if(f===B.item)c.stopScrollInterval();else{if(void 0!==c.FTJ)return;d.y<0?c.startScrollInterval(-1):d.y>c.height&&c.startScrollInterval(1)}c.refresh()}b=c.isInBounding(d.x,d.y),c.needDrawDragRect!==b&&(c.needDrawDragRect=b,c.mouseDownItemIndexIsValid||c.refresh())},a.prototype.startScrollInterval=function(a){var b=this,c=100,d=function(){b.scroll(a),b.refresh(),b.FTJ=window.setTimeout(d,c)};this.FTJ=window.setTimeout(d,600)},a.prototype.stopScrollInterval=function(){return void 0!==this.FTJ&&(window.clearTimeout(this.FTJ),this.FTJ=void 0,!0)},a.prototype.scroll=function(a){this.scrollTo(this.lZJ+a)},a.prototype.scrollTo=function(a){var b=0,c=this.maxScrollCount;a=Math.min(a,c),a=Math.max(a,b),this.lZJ=a},a.prototype.onMouseUp=function(a){var b,c,d=this;return d.ETJ.onMouseUp(a),b=d.getPointerRelativeControl(a),c=d.hitTest(b.x,b.y).target,c!==B.item&&(this.ATJ=-1,this.refresh()),!!d.zTJ&&(d.zTJ=!1,!0)},a.prototype.onWindowMouseUp=function(a){var b,c,d,e,f,g,h,i=this;i.ETJ.onWindowMouseUp(a),b=i.getPointerRelativeControl(a),c=i.hitTest(b.x,b.y),d=c.target,e=c.data,i.H1J?(f=i.selection,g=f.startDate,h=f.endDate,i.props.onSelectionChanged({startDate:g,endDate:h})):i.mouseDownItemIndexIsValid&&(d===B.item&&i.BTJ&&(i.BTJ=!1,i.li=e),i.endSelectOperation()),this.stopScrollInterval()&&this.onScrollBarChanged(),this.clearState()},a.prototype.oZJ=function(a,b){var c,d=this;if(a&&b){switch(a>b&&(c=[b,a],a=c[0],b=c[1]),d.level){case g.TimelineLevel.years:b.setMonth(11);break;case g.TimelineLevel.quarters:b.setMonth(b.getMonth()+2)}d.level!==g.TimelineLevel.days&&b.setDate(N(b))}return{startDate:a,endDate:b}},a.prototype.changeSelection=function(){var a=this,b=new Date(""+a._items[a.g_]),c=new Date(""+a._items[a.li]);a.selection=a.oZJ(b,c)},a.prototype.endSelectOperation=function(){var a=this,b=new Date(""+a._items[a.g_]),c=new Date(""+a._items[a.li]);a.props.onSelectionChanged(a.oZJ(b,c))},a.prototype.onWindowKeyUp=function(a){},a.prototype.onWindowMouseWheel=function(a){this.ETJ.onWindowMouseWheel(a)},a.prototype.clearState=function(){var a=this,b=!1;a.zTJ&&(a.zTJ=!1,b=!0),a.mouseDownItemIndexIsValid&&(a.ATJ=-1,a.CTJ=!1,a.li=-1,b=!0),a.H1J=i.keyword_null,a.nZJ=i.keyword_null,a.stopScrollInterval(),b&&a.refresh()},Object.defineProperty(a.prototype,"width",{get:function(){return this.qTJ.containerSize.w-(this.showScrollBar?0:2*(v+3))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.qTJ.containerSize.h},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollPosition",{get:function(){return this.qTJ.scrollPosition},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showScrollBar",{get:function(){return this.qTJ.showScrollbar},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showHeader",{get:function(){return this.qTJ.showHeader},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"level",{get:function(){return this.qTJ.level},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bounds",{get:function(){return this.qTJ.bounds},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selection",{get:function(){return this.qTJ.selection},set:function(a){this.qTJ.selection=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selectionLevel",{get:function(){return this.qTJ.selectionLevel},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemWidth",{get:function(){return Math.max(2*this.B1J,40)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemHeight",{get:function(){return u},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"needShowScrollbar",{get:function(){return this.showScrollBar&&this.itemLength>this.onePageCanEntirelyDisplayItemsCount},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollButtonSize",{get:function(){return 25},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"canShowItemsLength",{get:function(){return 10},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemsAreaWidth",{get:function(){return Math.min(this.itemLength,this.canShowItemsLength)*this.itemWidth},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemLength",{get:function(){if(this._items)return this._items.length;try{return this.buildItems(),this._items.length}catch(a){return 0}},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"mouseDownItemIndexIsValid",{get:function(){return this.li!==-1},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"maxScrollCount",{get:function(){return Math.max(0,this.itemLength-this.onePageCanEntirelyDisplayItemsCount)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onePageCanDisplayItemsCount",{get:function(){return Math.ceil(this.width/this.itemWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onePageCanEntirelyDisplayItemsCount",{get:function(){return Math.floor(this.width/this.itemWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"leftBtnRect",{get:function(){return{x:0,y:w+1-(this.showScrollBar?0:25)+(this.showHeader?0:15),w:v,h:v-2}},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rightBtnRect",{get:function(){return{x:this.width-v+(this.showScrollBar?0:2*v),y:w+1-(this.showScrollBar?0:25)+(this.showHeader?0:15),w:v,h:v-2}},enumerable:!0,configurable:!0}),a.prototype.setCursor=function(a){this.props.setCursor(a)},a.prototype.getStyle=function(a){return this.props.getStyle(a)},a.prototype.getWholeStyle=function(){return this.props.getStyle("wholeSlicerStyle")},a.prototype.getThemeColor=function(a){return this.props.getThemeColor(a)},a.prototype.getPointerRelativeControl=function(a){var b=this.props.getPointerRelativeControl(a);return b.x+=this.props.offset.left,b.y+=this.props.offset.top,b},a.prototype.getClickItemIndex=function(a,b){var c=this.itemWidth,d=Math.floor(a/c)+this.lZJ;return d>=this.itemLength?-1:d},a.prototype.refresh=function(){this.props.refresh()},a.prototype.dispose=function(){this.ETJ.dispose(),this._items=i.keyword_null,this.qTJ=i.keyword_null},a}(),b.PivotTimelineList=K);function M(a){return Math.floor((a.getMonth()+3)/3)}b.getQuarter=M;function N(a){return O(a.getFullYear(),a.getMonth())}b.getLastDateOfMonth=N;function O(a,b){var c=new Date(a,b);return c.setMonth(c.getMonth()+1),c.setDate(1),c.setDate(c.getDate()-1),c.getDate()}b.getMonthLength=O;function P(a,b,c){if(b){a.save(),a.fillStyle=y;var d=b.x,e=b.y,f=b.width,g=b.height;a.beginPath(),a.moveTo(d+A,e),a.lineTo(d+f-(c?0:A),e),a.quadraticCurveTo(d+f,e,d+f,e+(c?0:A)),a.lineTo(d+f,e+g-(c?0:A)),a.quadraticCurveTo(d+f,e+g,d+f-(c?0:A),e+g),a.lineTo(d+(c?A:0),e+g),a.quadraticCurveTo(d,e+g,d,e+g-(c?A:0)),a.lineTo(d,e+(c?A:0)),a.quadraticCurveTo(d,e,d+(c?A:0),e),a.closePath(),a.fill(),a.fillStyle=z,a.fillRect(b.x+2,b.y+4.5,2,2),a.fillRect(b.x+2,b.y+8,2,2),a.fillRect(b.x+2,b.y+11.5,2,2),a.restore()}}function Q(a){if(a&&"string"==typeof a){var b=a.toUpperCase();if(b===j.WHITE||"#FFF"===b||"#FFFFFF"===b||"RGB(255, 255, 255)"===b)return!0}return!1}function R(a,b,c){var d=new Date(a.toDateString());return b&&(c?(d.setMonth(0),d.setDate(1)):(d.setMonth(11),d.setDate(31))),d.getTime()}},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("Slicers"),f=c("Shapes"),g=c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),h=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view-model.js"),i=c("Core"),j=i.Ul.naa,k=i.Util.Sha;function t(a){return a>=1&&a<=4}function u(a){return a instanceof Date&&!isNaN(a.getTime())}function v(a,b,c){var e,f,g=this;if(g[a]){if(e=void 0,u(b)?e=b:"string"==typeof b&&u(new Date(b))&&(e=new Date(b)),d.Fa(e))return;g[a](e),g.refresh()}f=g.sheet(),f&&(f.ITa.xVa(g,a,c),g.Wq({sheet:f,sheetName:f.name(),slicer:g,propertyName:a}))}e&&f&&(l=e.SlicerType,m=e.TimelineStyles,n=e.defSlicerProperty,o=e.onPropertyChanged,p=e.SlicerChangeType,q=[["level",e.TimelineLevel.months,o,t],["showHorizontalScrollbar",!0,o],["showSelectionLabel",!0,o],["showTimeLevel",!0,o],["scrollPosition",g.keyword_undefined,v]],r=function(a){s(b,a);function b(b,c,d){var e,f=a.call(this,b,c,d)||this;return f.l8=l.pivotTimeline,e=f,e.Wqa=m.light1(),f}return b.prototype.filterType=function(){return this.XXJ.filterType},b.prototype.condition=function(){return this.XXJ.filterCondition},b.prototype.canShowRange=function(){return this.XXJ.canShowRange},b.prototype.selection=function(){return this.XXJ.selection},b.prototype.bounds=function(){var a=this.XXJ.bounds;return{startDate:new Date(""+a.startDate),endDate:new Date(""+a.endDate)}},b.prototype.selectionLevel=function(){return this.XXJ.selectionLevel},b.prototype.getOptionsSet=function(){var a=this;return{nameInFormula:a.nameInFormula(),sourceName:a.sourceName(),name:a.name(),captionName:a.captionName(),showHeader:a.showHeader(),showHorizontalScrollbar:a.showHorizontalScrollbar(),showTimeLevel:a.showTimeLevel(),showSelectionLabel:a.showSelectionLabel(),isLocked:a.isLocked()}},b.prototype.getValuesSet=function(){var a=this;return{filterCleared:a.filterCleared(),canShowRange:a.canShowRange(),selection:a.selection(),bounds:a.bounds(),level:a.level(),selectionLevel:a.selectionLevel(),scrollPosition:a.scrollPosition(),filterType:a.filterType(),condition:a.condition()}},b.prototype.initSlicerUI=function(){var a=this;a.SSJ=new h.PivotTableTimelineSlicerViewModel(a.kj,a.getOptionsSet.bind(a),a.getValuesSet.bind(a)),a.SSJ.setStyle(a.Wqa),a.SSJ.bind("valueChanged",function(b){a.XXJ.selectionLevel=a.level(),a.setFilterWithSelection(b)}),a.SSJ.bind("clearFilter",function(){a.clearFilter()}),a.SSJ.bind("propertyChanged",function(b){var c=b.propName,d=b.value;a[c]&&a[c](d)})},b.prototype.setFilterWithSelection=function(a){var b=this;b.XXJ.setFilter(a)},b.prototype.fromJSON=function(b){if(b){a.prototype.fromJSON.call(this,b);var c=this;q.forEach(function(a){var d=a[0];b[d]!==g.keyword_undefined&&("scrollPosition"===d?c.scrollPosition(new Date(b[d])):c[d](b[d]))})}},b.prototype.cdK=function(b,c,d,f){var h,i,j;b&&(a.prototype.cdK.call(this,b,c,d,f),h=this,b.showHeader!==g.keyword_undefined&&h.showHeader("1"===b.showCaption),b.level!==g.keyword_undefined&&h.level(+b.level+1),b.showHorizontalScrollbar!==g.keyword_undefined&&h.showHorizontalScrollbar("1"===b.showHorizontalScrollbar),b.showSelectionLabel!==g.keyword_undefined&&h.showSelectionLabel("1"===b.showSelectionLabel),b.showTimeLevel!==g.keyword_undefined&&h.showTimeLevel("1"===b.showTimeLevel),b.scrollPosition!==g.keyword_undefined&&h.scrollPosition(new Date(b.scrollPosition)),i=b.style||d.getDefaultStyleName("defaultTimelineStyle"),i&&(e.isBuildInTimelineStyle(i)?h.style(m[i.substring(15).toLowerCase()]()):(j=d.getTimelineStyle(i),j&&h.style(j))))},b.prototype.toJSON=function(b){var c=this,d=a.prototype.toJSON.call(this,b);return q.forEach(function(a){var b=a[0];d[b]=c[b]()}),d.selectionLevel=c.selectionLevel(),d},b.prototype.bdK=function(a,b,c){var g,h=this,i={name:j(k(h.name(),"\n","_x000a_")),cache:j(h.XXJ.name),caption:j(h.captionName()),style:j(h.Wqa.name()),level:h.level()-1,selectionLevel:h.selectionLevel()-1,scrollPosition:d.AIc(h.scrollPosition())};h.showHeader()||(i.showHeader=f.SJS_False),h.disableResizingAndMoving()&&(i.lockedPosition=f.SJS_True),h.showSelectionLabel()||(i.showSelectionLabel=f.SJS_False),h.showTimeLevel()||(i.showTimeLevel=f.SJS_False),h.showHorizontalScrollbar()||(i.showHorizontalScrollbar=f.SJS_False),a.push(i),g={twoCellAnchor:e.getSlicerDrawing(h)},b.push(g)},b}(g.P4J),q.forEach(function(a){r.prototype[a[0]]=n(a[0],a[1],a[2],a[3])}),b.PivotTableTimelineSlicer=r)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Shapes"),f=c("Slicers"),g=c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),h=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js"),i="pivotTimeline",e&&f&&(e.registerCustomFormControl(i,h.PivotTableTimelineView),j=f.getSlicerSizePosInfo,k=f.SlicerChangeType,l=f.SlicerViewModelBase,m=function(a){n(b,a);function b(b,c,d){return a.call(this,b,c,d)||this}return b.prototype.scrollPosition=function(a){return g.keyword_null},b.prototype.ZSJ=function(){var a,b,c,d,e,f,g,k=this,l=this,m=l.kj;m.shapes&&(this.jxa=new h.PivotTableTimelineView,a=l.updateOptionsCallback(),b=j(m,!1),c=b.left,d=b.top,e=b.width,f=b.height,g=m.shapes.addFormControl(a.name,i,c,d,e,f),g.allowResize(!0),g.allowMove(!0),g.dynamicSize(!1),g.dynamicMove(!0),g.drawingType="Timeline",l.jxa=g.$SJ,l.nSa=g,l.refreshFormControl(),l.jxa.addEventListener("valueChanged",function(a,b){k.Wq("valueChanged",b)}),l.jxa.addEventListener("clearFilter",function(a,b){k.Wq("clearFilter",{})}),l.jxa.addEventListener("propertyChanged",function(a,b){k.Wq("propertyChanged",b)}))},b.prototype.refreshFormControl=function(){var b,c;a.prototype.refreshFormControl.call(this),b=this,c=b.jxa,c.setValue(b.updateValuesCallback()),c.update()},b.prototype.cdK=function(a,b,c,e){var f,h,i=this,j=d.Util.eiK(a,"twoCellAnchor.AlternateContent.Choice.graphicFrame.graphic.graphicData.timeslicer.name",b);j&&(f=j.AlternateContent.Choice.graphicFrame.nvGraphicFramePr.cNvPr,d.Util.alK(c)&&d.Util.clK(i.kj,j,g.keyword_undefined,e),h={nvSpPr:{cNvPr:f},spPr:{prstGeom:{prst:"rect"}}},j.sp=h,j.anchorType=0,i.jxa.cdK(h,j),delete j.sp)},b}(l),b.PivotTableTimelineSlicerViewModel=m)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Shapes"),g=c("Slicers"),h=c("Pivot"),i=c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),j=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-dropdown.js"),k=c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js"),l=c("./dist/plugins/pivot/pivot.ns.js"),m=new e.Common.ResourceManager(l.SR,"PivotTables"),n=e.Common.CultureManager,o=m.getResource.bind(m),b.SELECTION_LABEL_FONT="normal 10pt calibri",b.TIMELINE_DEFAULT_FONT="normal 9pt calibri",b.BLACK="black",b.WHITE="white",g&&f&&(p=g.SlicerViewBase,q=g.SlicerChangeType,r=g.paintBorder,s=g.fillText,t=g.getEllipsisText,u=function(a){x(c,a);function c(){return null!==a&&a.apply(this,arguments)||this}return c.prototype.init=function(b){a.prototype.init.call(this,b),this.Qb={canShowRange:i.keyword_null,selection:i.keyword_null,bounds:i.keyword_null,level:i.keyword_null,selectionLevel:i.keyword_null,filterCleared:i.keyword_null,scrollPosition:i.keyword_null,filterType:i.keyword_null,condition:i.keyword_null},this.i6={},this.initList(),this.initClearFilterButton()},c.prototype.initList=function(){var a=this,b=new k.PivotTimelineList,c=b.props;c.offset={top:-45,left:-10},c.bounds=a.Qb.bounds,b.props=c,b.props.onSelectionChanged=a.onSelectionChanged.bind(a),b.props.getPointerRelativeControl=a.getPointerRelativeControl.bind(a),b.props.refresh=a.refresh.bind(a),b.props.getStyle=a.getStyle.bind(a),b.props.getThemeColor=a.getThemeColor.bind(a),b.props.setCursor=a.setCursor.bind(a),b.props.onScrollPositionChanged=a.onScrollPositionChanged.bind(a),a.FP=b,this.onWindowMouseMove=this.onWindowMouseMove.bind(this),this.onWindowMouseUp=this.onWindowMouseUp.bind(this),this.onWindowKeyUp=this.onWindowKeyUp.bind(this),this.onWindowMouseWheel=this.onWindowMouseWheel.bind(this),window.addEventListener("mousemove",this.onWindowMouseMove),window.addEventListener("mouseup",this.onWindowMouseUp),window.addEventListener("keyup",this.onWindowKeyUp),window.addEventListener("mousewheel",this.onWindowMouseWheel)},c.prototype.initDropDown=function(){var a=this,b=a.sheet,c=a.onLevelChanged.bind(a),e=new j.PivotTimelineDropdown(b.parent&&b.parent.pZJ(),d.Ul.vl(b.parent.qo),c),f=a.FZJ,g=a.shape,h=g.startRow(),i=g.startColumn(),k=g.startRowOffset(),l=g.startColumnOffset(),m=b.getCellRect(h,i),n=b.zoom();e.init(a.Qb.level,m.x+(l+f.x)*n,m.y+(k+f.y+20)*n)},c.prototype.filterCleared=function(){return this.Qb.filterCleared},c.prototype.triggerEvent=function(a,b){this.fireEvent(a,b)},c.prototype.onSelectionChanged=function(a){this.triggerEvent("valueChanged",a)},c.prototype.onLevelChanged=function(a){this.triggerEvent("propertyChanged",{propName:"level",value:a}),this.FP.onLevelChanged()},c.prototype.onScrollPositionChanged=function(a){this.triggerEvent("propertyChanged",{propName:"scrollPosition",value:a})},c.prototype.setStyle=function(a){this.Wqa=a},c.prototype.getStyle=function(a){return this.Wqa[a]()},c.prototype.update=function(){var a=this,b=a.FP.props,c=a.Qb,d=c.bounds,e=c.selection,f=c.selectionLevel,g=c.level,h=c.scrollPosition,i=c.canShowRange,j=c.filterCleared,k=a.options,l=k.showHeader,m=k.showHorizontalScrollbar;b.bounds=d,b.selection=e,b.level=g,b.selectionLevel=f,b.showHeader=l,b.showScrollbar=m,b.scrollPosition=h,b.canShowRange=i,b.filterCleared=j,a.FP.update()},c.prototype.render=function(b,c){var d,e,f,g,h,i,j=a.prototype.render.call(this,b,c);if(j&&(d=j.left,e=j.top,f=j.w,g=j.h,!(f<0)))return h=this,i=h.i6.showHeader,b.save(),b.rect(d+8,e+(i?37:5),f+4,g),b.clip(),h.i6.showSelectionLabel&&h.paintSelectionLabel(b,d+10,e+(i?30:5),f-70,30),h.i6.showTimeLevel&&h.paintLevel(b,d,e-(i?0:25),f,g),h.paintList(b,d,e,f,g),b.restore(),{left:d,top:e,w:f,h:g}},c.prototype.paintHeader=function(b,c,e,f,g){var h,i,j,k=this;a.prototype.paintHeader.call(this,b,c,e,f,g),k.width<=20||(h=k.getWholeStyle(),i=h&&h.borderTop(),j=new d.Rect(c+10,e,k.width-20,Math.min(k.height,25)),r(b,2,j,i,this.getThemeColor.bind(this)))},c.prototype.paintSelectionLabel=function(a,c,d,e,f){var g=this,h=g.Qb,i=h.filterType,j=h.selection,k=h.condition,l=z(j,i,k),m=g.getWholeStyle(),n=g.getStyle("selectionLabelStyle"),o=n&&n.font()||m&&m.font()||b.SELECTION_LABEL_FONT,p=g.getThemeColor(n&&n.foreColor()||m&&m.foreColor()||b.BLACK);a.save(),a.font=o,a.fillStyle=p,s(a,t(a,l,e),c,d,p,f,e),a.restore()},c.prototype.paintList=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=this;a.save(),f=-d/2,g=-e/2,h=p.i6,i=h.showHeader,j=h.showSelectionLabel,k=h.showTimeLevel,l=h.showHorizontalScrollbar,m=j||k,n=-10,o=-45,i?g+=25:o+=25,l||(n-=23),m||(g-=20,c+=20,o+=20),p.FP.props.offset.left=n,p.FP.props.offset.top=o,a.rect(f,g,d,e),a.clip(),a.beginPath(),a.translate(f,g),p.xTJ(d,e),p.FP.render(a),a.restore()},c.prototype.paintLevel=function(a,c,e,f,h){var i,j,k,l,m,n,p,q,r,u,v,w,x,y=this,z=y.Qb.level;if(z){switch(i=c+(f<70?10:f-60),j=e+30,k=60,l=30,m=y.getWholeStyle(),n=y.getStyle("timeLevelStyle"),p=n&&n.font()||m&&m.font()||b.TIMELINE_DEFAULT_FONT,q=y.getThemeColor(n&&n.foreColor()||m&&m.foreColor()||b.BLACK),r="",z){case g.TimelineLevel.years:r=o().TIME_LEVEL_YEARS;break;case g.TimelineLevel.quarters:r=o().TIME_LEVEL_QUARTERS;break;case g.TimelineLevel.months:r=o().TIME_LEVEL_MONTHS;break;case g.TimelineLevel.days:r=o().TIME_LEVEL_DAYS}a.save(),a.font=d.Ul.hZa(p),a.fillStyle=q,u=t(a,r,k),v=Math.ceil(a.measureText(u).width)+5,i+=k-v,s(a,u,i-5,j,q,l,v),a.restore(),a.save(),w=i+v,x=j+10,a.beginPath(),a.fillStyle="#b2b2b2",a.moveTo(w,x),a.lineTo(w+10,x),a.lineTo(w+5,x+10),a.lineTo(w,x),a.closePath(),a.fill(),a.restore(),y.FZJ=new d.Rect(i-c,y.i6.showHeader?30:5,v+10,l)}},c.prototype.xTJ=function(a,b){var c=this,d=c.FP.props;d.containerSize={w:a,h:b}},c.prototype.setValue=function(a){this.Qb=a,this.refresh()},c.prototype.onWindowMouseMove=function(b){a.prototype.onWindowMouseMove.call(this,b),this.FP.onWindowMouseMove(b)},c.prototype.onWindowMouseUp=function(a){this.FP.onWindowMouseUp(a)},c.prototype.onWindowKeyUp=function(a){this.FP.onWindowKeyUp(a)},c.prototype.onLevelDropDownClicked=function(a,b){var c=this;return!!c.J1J(a,b)&&(c.initDropDown(),!0)},c.prototype.doMouseDown=function(a){var b=this,c=b.getPointerRelativeControl(a);return!(!b.i6.showTimeLevel||!b.onLevelDropDownClicked(c.x,c.y))||this.FP.onMouseDown(a)},c.prototype.doMouseMove=function(b){var c,d=this;d.FP.onMouseMove(b),a.prototype.doMouseMove.call(this,b),c=d.getPointerRelativeControl(b),d.J1J(c.x,c.y)&&d.setCursor("default")},c.prototype.doMouseUp=function(b){this.FP.onMouseUp(b),a.prototype.doMouseUp.call(this,b)},c.prototype.onWindowMouseWheel=function(a){this.FP.onWindowMouseWheel(a)},c.prototype.J1J=function(a,b){var c=this.FZJ;return!!c&&(a>=c.x&&a<=c.x+c.width&&b>=c.y&&b<=c.y+c.height-10)},c.prototype.LZJ=function(){var a=this;return{top:-5,left:-a.width+31}},c.prototype.W4J=function(b,c){var d=a.prototype.W4J.call(this,b,c);if(d.rect)return d.rect},c.prototype.dispose=function(){this.FP.dispose(),this.FP=i.keyword_null,this.IZJ=i.keyword_null,this.Wqa=i.keyword_null,this.FZJ=i.keyword_null,window.removeEventListener("mousemove",this.onWindowMouseMove),window.removeEventListener("mouseup",this.onWindowMouseUp),window.removeEventListener("keyup",this.onWindowKeyUp),window.removeEventListener("mousewheel",this.onWindowMouseWheel),a.prototype.dispose.call(this)},c}(p),b.PivotTableTimelineView=u),v=[0,3,6,9],w=[2,5,8,11];function y(a,b){var c,d,e,f,g,i,j,l,m,p,q,r,s,t,u,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M;if(!h.Fa(a))return c=k.getMonthMap(),h.Fa(b)?c[a.getMonth()]+" "+a.getDate()+", "+a.getFullYear():(d=n.q4(n.culture()),e=d.TimelineDateOrder,f=d.TimelineDateSuffix,g=e.indexOf(1),i=e.indexOf(2),j=e.indexOf(3),l=a.getFullYear(),m=b.getFullYear(),p=a.getMonth(),q=b.getMonth(),r=c[p],s=c[q],t=k.getQuarter(a),u=k.getQuarter(b),x=o().QUARTER_MAP[t],y=o().QUARTER_MAP[u],z=a.getDate(),A=b.getDate(),B=1===a.getDate()&&b.getDate()===k.getLastDateOfMonth(b),C=g<i,D=i<j,E=l+f.year,F=m+f.year,G=r+f.month,H=s+f.month,I=z+f.date,J=A+f.date,l===m?B?0===p&&11===q?l:v.indexOf(p)!==-1&&w.indexOf(q)!==-1?q-p===2?C?E+" "+x:x+" "+E:C?E+" "+x+" - "+y:x+" - "+y+" "+E:p===q?C?E+" "+H:H+" "+E:C?E+" "+G+" - "+H:G+" - "+H+" "+F:p===q?(K=void 0,K=z===A?D?G+" "+I:I+" "+G+" ":D?G+" "+I+" - "+J:I+" - "+J+" "+G+" ",C?E+" "+K:K+" "+E):(L=D?G+" "+I:I+" "+G+" ",M=D?H+" "+J:J+" "+H+" ",C?E+" "+L+" - "+M:L+" - "+M+", "+F):B?0===p&&11===q?E+" - "+F:v.indexOf(p)!==-1&&w.indexOf(q)!==-1?C?E+" "+x+" - "+F+" "+y:x+" "+E+" - "+y+" "+F:C?E+" "+G+" - "+F+" "+H:G+" "+E+" - "+H+" "+F:(L=D?G+" "+I:I+" "+G+" ",M=D?H+" "+J:J+" "+H+" ",C?E+" "+L+" - "+F+" "+M:L+", "+E+" - "+M+", "+F))}function z(a,b,c){if(h.Fa(a)&&b===h.PivotDateFilterOperator.Between||h.Fa(b))return o().ALL_PERIODS;if(a&&a.startDate&&a.endDate&&a.endDate<a.startDate)return o().INVALID_DATE_SELECTION;switch(b){case h.PivotDateFilterOperator.equalsTo:case h.PivotDateFilterOperator.today:case h.PivotDateFilterOperator.yesterday:case h.PivotDateFilterOperator.tomorrow:return y(a.startDate);case h.PivotDateFilterOperator.Between:case h.PivotDateFilterOperator.nextWeek:case h.PivotDateFilterOperator.thisWeek:case h.PivotDateFilterOperator.lastWeek:case h.PivotDateFilterOperator.nextMonth:case h.PivotDateFilterOperator.thisMonth:case h.PivotDateFilterOperator.lastMonth:case h.PivotDateFilterOperator.nextQuarter:case h.PivotDateFilterOperator.thisQuarter:case h.PivotDateFilterOperator.lastQuarter:case h.PivotDateFilterOperator.nextYear:case h.PivotDateFilterOperator.thisYear:case h.PivotDateFilterOperator.lastYear:case h.PivotDateFilterOperator.yearToDate:return y(a.startDate,a.endDate)}var d=o().TIMELINE_PLACE_HOLDER;switch(b){case h.PivotDateFilterOperator.notEqualsTo:return o().DateNotEqual.replace(d,y(c._Qa));case h.PivotDateFilterOperator.before:return o().DateOlderThan.replace(d,y(c._Qa));case h.PivotDateFilterOperator.beforeEqualsTo:
return o().DateOlderThanOrEqual.replace(d,y(c._Qa));case h.PivotDateFilterOperator.after:return o().DateNewerThan.replace(d,y(c._Qa));case h.PivotDateFilterOperator.afterEqualsTo:return o().DateNewerThanOrEqual.replace(d,y(c._Qa));case h.PivotDateFilterOperator.notBetween:return o().DateNotEqual.replace(d,y(c._Qa,c.value2));case h.PivotDateFilterOperator.Q1:return o().AllDatesIn_Quarter1;case h.PivotDateFilterOperator.Q2:return o().AllDatesIn_Quarter2;case h.PivotDateFilterOperator.Q3:return o().AllDatesIn_Quarter3;case h.PivotDateFilterOperator.Q4:return o().AllDatesIn_Quarter4;case h.PivotDateFilterOperator.M1:return o().AllDatesIn_January;case h.PivotDateFilterOperator.M2:return o().AllDatesIn_February;case h.PivotDateFilterOperator.M3:return o().AllDatesIn_March;case h.PivotDateFilterOperator.M4:return o().AllDatesIn_April;case h.PivotDateFilterOperator.M5:return o().AllDatesIn_May;case h.PivotDateFilterOperator.M6:return o().AllDatesIn_June;case h.PivotDateFilterOperator.M7:return o().AllDatesIn_July;case h.PivotDateFilterOperator.M8:return o().AllDatesIn_August;case h.PivotDateFilterOperator.M9:return o().AllDatesIn_September;case h.PivotDateFilterOperator.M10:return o().AllDatesIn_October;case h.PivotDateFilterOperator.M11:return o().AllDatesIn_November;case h.PivotDateFilterOperator.M12:return o().AllDatesIn_December;case h.PivotDateFilterOperator.dateToDate:if(!c.OMJ)return y(a.startDate,a.endDate);if(c.dCc===h.PivotAdvancedDateFilterBy.year)return o().PivotPanel_ValueFilterOrLabel_ParallelYearToDate;if(c.dCc===h.PivotAdvancedDateFilterBy.quarter)return o().PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate;if(c.dCc===h.PivotAdvancedDateFilterBy.month)return o().PivotPanel_ValueFilterOrLabel_ParallelMonthToDate}return i.keyword_null}},"./dist/plugins/pivot/pivot-panel/pivot-panel.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Z=this&&this.__assign||function(){return Z=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},Z.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),e=c("./dist/plugins/pivot/pivot-core/pivot-view.js"),f=c("Pivot"),g=c("@grapecity/js-sheets-common"),h=c("./dist/plugins/pivot/pivot.ns.js"),i=c("Core"),j=c("./dist/plugins/pivot/pivot-ui/dropdown-list.js"),k=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),l=c("./dist/plugins/pivot/pivot-util.js"),m=g.Common.u.Ob,n=window,o=document,p=n.jQuery,q="pivotPanel",r="string",s=null,t=void 0,u=g.Common.j.Fa,v=new g.Common.ResourceManager(h.SR,"PivotTables"),w=v.getResource.bind(v),x=".pivot-panel",y="gc-panel-area-item",z="gc-panel-all-field-item",A="gc-panel-all-field-item-filtered",B=y+"-content",C="gc-panel-defer-layout-right-button",D="gc-panel-bottomBorderStyle",E="gc-panel-topBorderStyle",F="gc-panel-defer-layout-input",G="gc-panel-area-item-icon",H="data-index",I="gc-panel-all-field-filter",J="Pivot-Field-Filter",K="gc-panel-all-field-checkbox",L="gc-panel-all-field",M="gc-panel-collapse",N="gc-panel-selected-view",O="gc-panel-add",P="gc-panel-apply",Q="gc-panel-withoutViewList",R="containViewList",S="containFields",T="containArea",U="gc-panel-views",function(a){a[a.addField=0]="addField",a[a.removeField=1]="removeField",a[a.updateFieldArea=2]="updateFieldArea",a[a.updateValuePosition=3]="updateValuePosition"}(V=b.panelOperation||(b.panelOperation={})),W=function(){function a(a,b,c){void 0===c&&(c=d.PivotPanelLayoutType.stack);var e=this;e.ILJ=b.Cj,e.qo=a,e.Nc=0,e.Wyc=c,e.wu=b.wu,e.Xyc=b,e.Yyc=!1,e.Zyc=[],e.j9J=0,e.ad()}return a.prototype.ad=function(){this.LXa()},a.prototype.dispose=function(){var a=this;a.Xyc=s,a.wu=s,a.Zyc=s,a.wBJ=s,a.qo.innerHTML="",a.qo=t,a.$yc()},a.prototype.LXa=function(){var a,b,c,e=this,f="."+e.ILJ,g=e.qo;this.Xyc.Vyc&&(i.GC$(e.qo,g).bind("dragover"+x+f,function(a){a.preventDefault()}).bind("dragleave"+x+f,function(){a&&(b=a)}),i.GC$("."+y,g).bind("dragstart"+x+f,function(){a||(a=i.GC$(this)),i.GC$(document).bind("dragover"+x+f,function(a){a.preventDefault()}).bind("drop"+x+f,function(c){var d,g,h,j;c.preventDefault(),d=c.clientX,g=c.clientY,!a||d>e.qo.offsetLeft&&d<e.qo.offsetLeft+e.qo.offsetWidth&&g>e.qo.offsetTop&&g<e.qo.offsetTop+e.qo.offsetHeight||u(b)||(h=e.Xyc.nyc.Cj,j=e.Yyc?e.Xyc.Vyc.copyFieldsModel:e.Xyc.Vyc,j.Oyc({cmd:"removeField",sheetName:"",cmdOption:{fieldName:b.attr("data-name"),pivotName:h,isSusPaint:e.Yyc}})),i.GC$(document).unbind("dragover"+x+f),i.GC$(document).unbind("drop"+x+f),a=null})}),i.GC$("."+B,g).bind("dragover"+x+f,function(a){var b,c,d=a.target;d.classList.contains(y)?(b=a.offsetY,c=d.parentElement,i.GC$(c.children).removeClass(D),i.GC$(c.children).removeClass(E),b<d.offsetHeight&&d.classList.add(E)):d.classList.contains(B)&&d.lastElementChild&&d.lastElementChild.classList.add(D)}).bind("dragleave"+x+f,function(){i.GC$("."+y).removeClass(D).removeClass(E)}).bind("drop"+x+f,function(d){var f,g,h,j,k,l,m,n;d.stopPropagation(),k=d.toElement||d.relatedTarget||d.target,k.classList.contains("gc-panel-area-item-label")&&(k=k.parentElement),a&&(h=a.attr("data-sourceName")||a.attr("data-name"),j=i.GC$(a).attr("data-area"),g=k&&parseInt(i.GC$(k).attr("data-area"),10),f=parseInt(i.GC$(k).attr(H),10),0===k.childElementCount?f=0:k.classList.contains("gc-panel-area-item-content")&&(k=k.lastElementChild,f=parseInt(i.GC$(k).attr(H),10),f++),u(j)?(e.Yyc&&(l=V.addField,e.Zyc.push({name:h,toArea:g,index:f,type:l})),c=e.Yyc?e.Xyc.Vyc.copyFieldsModel:e.Xyc.Vyc,m=e.Xyc.nyc.Cj,c.Oyc({cmd:"AddField",sheetName:"",cmdOption:{fieldName:h,targetArea:g,targetIndex:f,pivotName:m,isSusPaint:e.Yyc}})):u(g)||(n=e.Yyc?e.Xyc.Vyc.copyFieldsModel:e.Xyc.Vyc,m=e.Xyc.nyc.Cj,n.Oyc({cmd:"moveField",sheetName:"",cmdOption:{fieldName:h,targetArea:g,targetIndex:f,pivotName:m,isSusPaint:e.Yyc}})),a=null,b=null)}),i.GC$("."+z,g).bind("dragstart"+x+f,function(){a||(a=i.GC$(this))}),i.GC$("."+L,g).bind("dragenter"+x+f,function(c){c.stopPropagation(),a&&(b=a)}).bind("drop"+x+f,function(){if(!u(b)){e.Yyc&&e.Zyc.push({name:b.attr("data-name"),type:V.removeField});var c=e.Xyc.nyc.Cj,d=e.Yyc?e.Xyc.Vyc.copyFieldsModel:e.Xyc.Vyc;d.Oyc({cmd:"removeField",sheetName:"",cmdOption:{fieldName:b.attr("data-name"),pivotName:c,fieldsModel:d,isSusPaint:e.Yyc}})}a=null,b=null}),i.GC$("."+F,g).bind("click"+x+f,function(a){e.Yyc=a.target.checked;var b=i.GC$("."+C);e.Yyc?e.Xyc.Vyc&&(e.Xyc.Vyc.copyFieldsModel=e.Xyc.Vyc.clone()):(e.Xyc.Vyc.copyFieldsModel=void 0,e.Xyc.refresh(e.Yyc)),b&&b.prop("disabled",!e.Yyc)}),i.GC$("."+C,g).bind("click"+x+f,function(){var a,b,c;e.Yyc&&(a=e.Xyc.Vyc.copyFieldsModel.vBJ(),b=e.Xyc.nyc.Cj,c=e.Xyc.Vyc,c.Oyc({cmd:"updatePivotDefer",sheetName:"",cmdOption:{pivotName:b,fieldsInfo:a}})),e.Xyc.refresh(!1)}),i.GC$("."+G,g).bind("click"+f,function(a){var b,c,d,f,g,h,k,l,m;i.GC$(this).hasClass(J)||(b=i.GC$(a.target).parent(),c=b.attr("data-name"),d=+b.attr("data-area"),f=+b.attr(H),g=e.updateOptionForDropDown(c,d,f),h={x:a.clientX,y:a.clientY},k=e.Xyc.nyc.Cj,l=e.Yyc?e.Xyc.Vyc.copyFieldsModel:e.Xyc.Vyc,m=new j.PivotDropDown(document.body,l,k,c,d,f,e.Yyc),m.OT(h,g))}),i.GC$("."+z,g).bind("contextmenu"+f,function(a){var b=i.GC$(this),c=b.attr("data-name"),d={x:a.clientX,y:a.clientY},f=e.Xyc.nyc.Cj,g=e.Yyc?e.Xyc.Vyc.copyFieldsModel:e.Xyc.Vyc,h=new j.PivotCacheFieldsDropdownDialog(document.body,g,f,c,null,null,e.Yyc);return h.OT(d),!1}),i.GC$("."+K,g).bind("click"+f,function(a){var b=i.GC$(a.target).parent(),c=b.attr("data-sourceName"),d=this.checked,f=e.Yyc?e.Xyc.Vyc.copyFieldsModel:e.Xyc.Vyc,g=e.Xyc.nyc.Cj,h={fieldName:c,checked:d,pivotName:g,isSusPaint:e.Yyc};f.Oyc({cmd:"changePanelFieldStatus",sheetName:e.Xyc.Cj,cmdOption:h})}),i.GC$("."+J,g).bind("click"+f,function(a){var b,c,f=i.GC$(a.target).parent(),g=f.attr("data-name"),h={x:a.pageX,y:a.pageY},j=e.Yyc?e.Xyc.Vyc.copyFieldsModel:e.Xyc.Vyc,l=e.Xyc.nyc.Cj,m=e.Xyc.nyc;m instanceof k.PivotTable&&(b=m.layoutType()===d.PivotTableLayoutType.compact,c={position:h,fieldName:g,fieldsModel:j,isCompact:b,pivotName:l},j.Oyc({cmd:"CreatePivotFilterDialog",sheetName:e.Xyc.Cj,cmdOption:c}))}),i.GC$("."+M,g).bind("click"+f,function(a){var b,c=e.Xyc.Vyc,d={x:a.pageX,y:a.pageY},f=e.Xyc.nyc,g=e.Xyc.nyc.Cj,h=100,j=i.GC$("."+U);j&&j.length>0&&j.width()>200&&(h=j.width()-100,h>300&&(h=300)),f&&(b={position:d,pivotName:g,views:f.views,width:h},c.Oyc({cmd:"CreatePivotViewsListDialog",cmdOption:b}))}),i.GC$("."+O,g).bind("click"+f,function(a){var b,c,d,f,g=i.GC$("#"+N).val();l.bJc(g)&&(g=w().DefaultPivotTableViewName),b=e.Xyc.nyc,c=e.Xyc.Vyc,d=e.Xyc.nyc.Cj,b&&(f={name:g,pivotName:d,views:b.views},c.Oyc({cmd:"AddPivotView",cmdOption:f}),i.GC$("#"+N).val(""))}),i.GC$("."+P,g).bind("click"+f,function(a){var b,c=i.GC$("#"+N).val(),d=e.Xyc.Vyc,f=e.Xyc.nyc,g=e.Xyc.nyc.Cj;f&&(b={name:c,pivotName:g,views:f.views},d.Oyc({cmd:"ApplyPivotView",cmdOption:b}))}),i.GC$("."+L,g).bind("scroll.pivotPanel"+x+f,function(){e.j9J=this.scrollTop}))},a.prototype.updateOptionForDropDown=function(a,b,c){var d,e=this.Yyc?this.Xyc.Vyc.copyFieldsModel:this.Xyc.Vyc,g={1:f.DataPosition.row,2:f.DataPosition.col},h={isSigma:!1,isAlone:!1,location:1,area:b},i=e.getSigmaValuePosition(),j=e.ryc(b),k=0;return i.display&&i.positionType===g[b]&&(k=1),a===w().sigmaValue&&(h.isSigma=!0),d=j.length+k,1===d&&(h.isAlone=!0),0===c?h.location=1:c<d-1?h.location=2:c===d-1&&(h.location=3),h},a.prototype.$yc=function(){var a="."+this.ILJ,b=this.qo;i.GC$(document).unbind("dragover"+x+a),i.GC$(document).unbind("drop"+x+a),i.GC$("."+y,b).unbind("dragstart"+x+a),i.GC$("."+z,b).unbind("dragstart"+x+a),i.GC$(this.qo,b).unbind("dragover"+x+a),i.GC$(this.qo,b).unbind("dragleave"+x+a),i.GC$("."+B,b).unbind("dragleave"+x+a),i.GC$("."+B,b).unbind("dragover"+x+a),i.GC$("."+B,b).unbind("drop"+x+a),i.GC$("."+z,b).unbind("dragstart"+x+a),i.GC$("."+L,b).unbind("drop"+x+a),i.GC$("."+L,b).unbind("dragenter"+x+a),i.GC$("."+F,b).unbind("click"+x+a),i.GC$("."+C,b).unbind("click"+x+a),i.GC$("."+G,b).unbind("click."+a),i.GC$("."+z,b).unbind("contextmenu."+a),i.GC$("."+K,b).unbind("click."+a),i.GC$("."+J,b).unbind("click."+a),i.GC$("."+M,b).unbind("click."+a),i.GC$("."+O,b).unbind("click."+a),i.GC$("."+P,b).unbind("click."+a),i.GC$("."+L,b).unbind("scroll"+x+a)},a.prototype.Fva=function(a){var b,c,e,g,h,j,k,l,m,n,o=a.allField,p=a.rowField,q=a.colField,r=a.valueField,s=a.filterField,t=a.valuePosition;r&&r.length>1&&t.positionType===f.DataPosition.row&&p.splice(t.positionIndex,0,{Cj:w().sigmaValue,mi:t.positionIndex}),r&&r.length>1&&t.positionType===f.DataPosition.col&&q.splice(t.positionIndex,0,{Cj:w().sigmaValue,mi:t.positionIndex}),b=this,c=d.PivotPanelLayoutType[b.Wyc].toLocaleLowerCase(),e=b.azc(),g=b.bzc(o),h=b.czc([s,p,q,r]),j=b.dzc(),k=b.Xyc.lOc.showViewList?b.mOc():"",l=b.Xyc.lOc.showFields?'\n                <div class="gc-panel-fields-section" '+T+'="'+b.Xyc.lOc.showArea+'">\n                    '+e+"\n                    "+g+"\n                </div>":"",m=b.Xyc.lOc.showArea?'\n                <div class="gc-panel-areas-section" '+S+'="'+b.Xyc.lOc.showFields+'">\n                    <span>'+w().PivotPanel_FieldAreaText+'</span>\n                    <div class = "gc-panel-field-area">\n                        '+h+"\n                    </div>\n                    "+j+"\n                </div>\n                ":"",b.qo.innerHTML='\n                <div class="gc-panel gc-panel-'+c+' gc-no-user-select">\n                    <div class='+Q+" "+R+'="'+b.Xyc.lOc.showViewList+'">\n                        <div class="gc-panel-header">\n                            <h2>'+w().PivotPanel_Title+"</h2>\n                        </div>\n                        "+l+"\n                        "+m+"\n                    </div>\n                    "+k+"\n                </div>\n                ",n=i.GC$("#"+L)[0],n&&n.scrollTo({top:b.j9J})},a.prototype.mOc=function(){return'\n            <div class="'+U+'">\n                <span style="width: 45px;display: inline-block;text-align: center; font-size: 14px">'+w().Views+'</span>\n                <div style="width: calc(100% - 50px); display: inline-block; border: 1px solid #CBCBCB; white-space: nowrap">\n                    <span class="'+M+'"></span>\n                    <input style="border: none; width: calc(100% - 91px); outline:none; vertical-align: text-bottom;" id="'+N+'"/>\n                    <input type="button" class="gc-panel-button '+O+'" value="\u271a"/>\n                    <input type="button" class="gc-panel-button '+P+'" value="\u2714"/>\n                </div>\n            </div>\n            '},a.prototype.azc=function(){return"\n                <span>"+w().PivotPanel_ReportText+"</span>\n                "},a.prototype.bzc=function(a){var b,c,d,e,f,g,h,i="";if(a)for(b=0,c=a;b<c.length;b++)d=c[b],e=d.fieldName,f=d.sourceName,g=d.isFilter,h=d.isDims,i+=this.ezc(e,f,g,h);return'\n                <div class="'+L+'" id="'+L+'">\n                    <ul>\n                        '+i+"\n                    </ul>\n                </div>\n                "},a.prototype.ezc=function(a,b,c,d){return b=m(b),a=m(a),'\n        <li class="'+(z+(c?" "+A:""))+'" title="'+a+'" data-name="'+a+'" data-sourceName="'+b+'" draggable="true">\n            <input type="checkbox" '+(d?"checked":"")+' class = "'+K+' gc-panel-checkbox"/>\n            <span class="'+(d?"gc-panel-all-field-checked":"gc-panel-all-field-unchecked")+'">'+b+'</span>\n            <span class="'+(G+" "+J)+'"></span>\n            <span class="'+(c?I:"")+'"></span>\n        </li>'},a.prototype.render=function(a){this.$yc(),this.Fva(a),this.LXa()},a.prototype.$b=function(){this.$yc(),this.qo.innerHTML=""},a.prototype.czc=function(a){var b,c,e,f,g="";for(b=this.Wyc===d.PivotPanelLayoutType.stack?[0,2,1,3]:[0,1,2,3],c=0,e=b;c<e.length;c++)f=e[c],g+=this.fzc(f,a?a[f]:null);return g},a.prototype.gzc=function(a){var b=["Filters","Rows","Columns","Values"],c=b[a];return{title:w()["PivotPanel_"+c+"ItemsTitle"],rowItemClass:c}},a.prototype.fzc=function(a,b){var c=this.gzc(a),d=c.title,e=c.rowItemClass,f="";return b&&(f=this.hzc(b,a)),'\n        <section class="gc-panel-area-section gc-panel-area-section-'+e+'">\n            <div class="gc-panel-area-item-title">\n                <label class="'+G+" gc-panel-area-item-"+e+'"></label>\n                <span>'+d+'</span>\n            </div>\n            <ul class="gc-panel-area-item-content" data-area="'+a+'">\n                '+f+"\n            </ul>\n        </section>"},a.prototype.hzc=function(a,b){var c=this,d="";return a.forEach(function(a,e){d+=c.izc(a.Cj,b,e)}),d},a.prototype.izc=function(a,b,c){return'\n        <li class="'+y+'" data-name="'+m(a)+'" data-area="'+b+'" data-index="'+c+'" draggable="true">\n            <span class="gc-panel-area-item-label">'+m(a)+'</span>\n            <span class="'+G+'"></span>\n        </li>\n        '},a.prototype.dzc=function(){var a=this;return'<div class = "gc-panel-defer-layout-update">\n                     <div class = "gc-panel-defer-layout-left-div">\n                       <input type="checkbox" class = "gc-panel-checkbox gc-panel-defer-layout-input" '+(a.Yyc?"checked":"")+">\n                       <label>"+w().PivotPanel_DeferUpdateText+'</label >\n                 </div>\n                 <button class="gc-panel-defer-layout-right-button" '+(a.Yyc?"":"disabled")+">"+w().PivotPanel_Update+"</button>\n                </div>\n             "},a.prototype.nOc=function(a){return u(a)?this.Wyc:void(this.Wyc=a)},a}(),X=function(a){Y(b,a);function b(b,c,d){var e=a.call(this,b,c)||this;return e.Nc=0,e.FJJ=1,e.mJc(d),e._R=new W(d,e),e.lOc={showFields:!0,showArea:!0,showViewList:!0},e.Vyc&&(e.wu=e.Vyc.wu,e.nyc=c,e.Vyc.addPivotView(e)),e.paint(),e}return b.prototype.mJc=function(a){var b=this;a&&(p&&p(a).data(q,b),i.GC$(a).data(q,b))},b.prototype.CMJ=function(){var a=this,b=a._R&&a._R.qo;b&&(p&&p(b).data(q,s),i.GC$(b).data(q,s))},b.prototype.isPivotViewAttached=function(a){return this.nyc&&this.nyc===a},b.prototype.attach=function(a){this.detach(),a&&(this.Vyc=a.Vyc,this.wu=this.Vyc.wu,this.Vyc.addPivotView(this),this.nyc=a)},b.prototype.detach=function(){this.Vyc&&(this.Vyc.removePivotView(this),this.Vyc=null,this.nyc=null,this.paint())},b.prototype.sectionVisibility=function(a){var b,c;return u(a)?(b=0,this.lOc.showFields&&(b+=d.PivotPanelSection.fields),this.lOc.showArea&&(b+=d.PivotPanelSection.area),this.lOc.showViewList&&(b+=d.PivotPanelSection.viewList),b):(c={showFields:!1,showArea:!1,showViewList:!1},a&d.PivotPanelSection.fields&&(c.showFields=!0),a&d.PivotPanelSection.area&&(c.showArea=!0),a&d.PivotPanelSection.viewList?(i.GC$("."+Q).attr("containViewList","true"),c.showViewList=!0):i.GC$("."+Q).attr("containViewList","false"),this.lOc=c,void this.refresh(!1))},b.prototype.panelLayout=function(a){var b=this._R.nOc();return u(a)?b:void(a===d.PivotPanelLayoutType.stack&&b===d.PivotPanelLayoutType.flow?(this._R.nOc(d.PivotPanelLayoutType.stack),this.refresh(!1)):a===d.PivotPanelLayoutType.flow&&b===d.PivotPanelLayoutType.stack&&(this._R.nOc(d.PivotPanelLayoutType.flow),this.refresh(!1)))},b.prototype.type=function(a){return 0===arguments.length?this.Nc:void(this.Nc=a)},b.prototype.paint=function(a){var b=this,c=a?this.Vyc.copyFieldsModel:this.Vyc,d=b.nyc&&b.nyc.views.all();b._R.render(c?Z({},c.Qyc(),{views:d}):{allField:null,rowField:null,colField:null,valueField:null,filterField:null,valuePosition:null,views:d})},b.prototype.refresh=function(a){var b=a?this.Vyc.copyFieldsModel:this.Vyc;b&&b.syc(a)},b.prototype.destroy=function(){var a=this;a.wu=s,a.Vyc&&(a.Vyc.removePivotView(a),a.Vyc=s),a.CMJ(),a.qo=s,a._R&&(a._R.dispose(),a._R=s)},b.prototype.dispose=function(){var a=this;a.destroy(),a.nyc=s},b.findControl=function(a){return typeof a===r&&(a=o.getElementById(a)),i.GC$(a).data(q)},b}(e.PivotView),b.PivotPanel=X},"./dist/plugins/pivot/pivot-panel/pivot-widget.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8c";function g(a){return 0===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDE8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQxIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iNSA3IDEzIDcgOSAxMSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":1===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDQ8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTEuNTAwMDAwLCA3LjUwMDAwMCkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTExLjUwMDAwMCwgLTcuNTAwMDAwKSAiPjwvcGF0aD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":2===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDM8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiI+PC9wYXRoPgogICAgICAgIDxwb2x5Z29uIGlkPSLot6/lvoQtNCIgZmlsbD0iIzY2NjY2NiIgcG9pbnRzPSIzIDEwIDggMTAgNS41IDEzIj48L3BvbHlnb24+CiAgICA8L2c+Cjwvc3ZnPg==":3===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDI8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQyIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":4===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDU8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ1IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSByb3RhdGUoLTE4MC4wMDAwMDApIHRyYW5zbGF0ZSgtNC41MDAwMDAsIC05LjUwMDAwMCkgIj48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTE0LjM1OTQ4NzUsNCBDMTQuNTI1MTcyOSw0IDE0LjY1OTQ4NzUsNC4xMzQzMTQ1OCAxNC42NTk0ODc1LDQuMyBDMTQuNjU5NDg3NSw0LjM3MDE4MDk1IDE0LjYzNDg4MjcsNC40MzgxNDA4MiAxNC41ODk5NTM5LDQuNDkyMDU1MzIgTDExLjM5OTUwNSw4LjMyIEwxMS40LDExLjYzMjI1ODEgTDkuNiwxMi42IEw5LjU5OTUwNDk2LDguMzIgTDYuNDEwMDQ2MSw0LjQ5MjA1NTMyIEM2LjMwMzk3Njg4LDQuMzY0NzcyMjUgNi4zMjExNzQwOSw0LjE3NTYwMjg0IDYuNDQ4NDU3MTYsNC4wNjk1MzM2MiBDNi41MDIzNzE2Niw0LjAyNDYwNDg3IDYuNTcwMzMxNTMsNCA2LjY0MDUxMjQ4LDQgTDE0LjM1OTQ4NzUsNCBaIiBpZD0iQ29tYmluZWQtU2hhcGUiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":5===a?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDY8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ2IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSBzY2FsZSgxLCAtMSkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTQuNTAwMDAwLCAtOS41MDAwMDApICI+PC9wYXRoPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":6===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAeBJREFUOBGtkj1oU1EUx8+5fSC00VZoCwpOtUOcBMHFdhA0g5ODg0HSDg0EuoibOrTRodBdhWIMlCAFFTMphCqVakgGcS2InSoiQQ22SUxe373H+7+ax2uJkz3w7rnn6/fOvecSHaQsfqjNLLyvCXQvbrValUqlItGYihrNts50ds0b6Ki/uw+CgLTWXdPpEHC7/Pl0xzenuE8lfd/EYe/JtAaK/wlotnSm7QdPs2dHv/7yg2ew9wN6dcBIml2rxYLG9hdi3mShLWE6QSJjXuzI8QfnRxtdUKlUEmamRCLh6uD3sLTq9aSQqnl96jr+4nkeBYHO+9Zvww+RAzHGWO6eO/wL8E1GickvJ8fX/6QSXV3ZyBsmHCMEAP5fUiwWBV8U4o7QWb0Q175+7gK2RVE8SEaOseKJ/ktr5W7B/gnA7wCHLr7asPs4HPJycqTR0utM6snAlXdhMWIA9LwDBCHyeOLozvf2KrF6G7tWvkEUXraL9wKEGfLo3OGfuvnajvDjUPryFHPWuCq7FAqFeTuBLGyMEV0opbKpVOqOe4mydKa/3vjxQrc6W0OD49PRYhQhEQB0gElgD58DYvm2ePKWpS64h2Ro13WOu2a6N3zz033kQHK53Bx0Op2+C30g8htq3/HPc2QfaQAAAABJRU5ErkJggg==":7===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAdVJREFUOBFjYKAQMIL0/9ztovn31991YLP+/2f4z8TIz/DvvyQjE6MNl9f+ozA7Tpw48R8IGCwtLcH6QOIsIILddc91IKUJYv/fZiv65dvfQ4wMTKu4Q47ANYPk/vz5A6JQANgAmMj/pTaCn9/+2M3AyHSYJ/poIQMD3CKwkr9//8KUwmm4Af/nWvN+/Ppl539GhisCKQEZjIyM/+GqoAyQC4DiKMJgA/7PNOZ6/+XdVqD3HgtJ6cQzMjb8Q1FFyIC3Hz7mAwPHFmj83bd3z19506ECDAygLkaGKSIVd6bCDPv37x8DKBCRAdgFIuV32oGCIIwXYAtEJmQdnedeJbedefUfRCOLw9ggA9ANQTHg64+/6T9//zsAomGakGlQLKDHBNyAqqNPDH7++qfFyMwU+evXP00QH1kziA3SjNMFX7/9Tf/x68/qBjOxF99//VkD4mMzAN0F4EjN2v+K58+XT89AsQCM/cfAtCALDG5lFh4+qWmOYl8WL15cD4yBBpCBoHQAigkmJqaG2NjYRrAXvr1/H/nz9/9Xf/8y5v/49bcHRAO98wokDtIEUggyAOYFEBskBpIDg7AV189ELL9eBeODaBAfJI4sNmfOnDoQRhajmA0AtPr0ppdKGGIAAAAASUVORK5CYII=":8===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":9===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPlJREFUOBHtULkNg0AQPJBBogVyKICE1CSkxIgCqMkFUAApiQlISCiAAlwABIjfM2dZOnwteKXTfjNzuyvE34zfE7Rt65/n+bBtOwuC4MV+13XuPM+FaZp5GIa9yrmpCeNpmh5wdxCeTdNErI3jWEPUgwB7ssY6TRNYliUzDOMJgk9PEMmIe/iMuWraCmxWVeWu6ypFmJNsWVYUx7FcibWvaROwgTXEvu8Sg18FRhfbtn05F69NUJalC4EaKA9PHgwiXKd3HCdKkuQyhTbBMAwFCJLMsfkd14HzcZ8C/nJEkwDVjuPIAaxBitI0ffExZg3CuYr9x58LvAEtbX2YkfGdBQAAAABJRU5ErkJggg==":11===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":12===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAgRJREFUOBFjYKAQMIL0nzx5cs6/f/+SCZnFyMh4kpeX105bW/sXTC0TiCEmJpbz58+fc0DMgAe/YWJiCkXWDNILNkBRUfEHUGPw379/3/3+/RtsCIhGwv+A8pFmZmaPQZqQAdgAkICjo+MDoAExQPwPpBFIgzHIRUDv1QLl9yBrhLHBYQDjgOjt27fXAzU0AP0LFgbSmzw8PAKA9H9kdTA2hgH///9n2gIEQEO+mpzfvp2FmfWgeO3kuzAN6DTcCzAJoE0g/zZoXj+8h+Pti7lMLx5deJHpmwKTB9H/09JY74XamoHYGAaABIFh8PemhAb//3//1wBN4/r769fsRwmu0x8luUrdjXRov/v++sM/f/5a4DOA4RMrZ+dOq7C1QC8Z/P/7/8K/P38z/nz/+fjfn98+QDf4qq0/NgmvAaCYAHrlpziDzI0/f//e+AuMjb9//jH9+8dQrrL6yFmQZhDA6gWQBDAaG+Pu79/+8OudjX9//4kAeqcLKLbm7+9fHf8bGuD64AyQJhj4+fPnpaTHj5se3Xm08d/fv57AGJmgsupwubqIbtSP778enNm/IhymFqsB6enpvx/fO+IL9ILbn39/L6oIaJaBNDDOmvVb8Ldg2I9vv2yAYQNOAlgNACn+zfD/+r+//+4x/mMoAGkEiYGA4oEDP1iZmCp3a4mpQEQoJAFYGTPePuR04gAAAABJRU5ErkJggg==":13===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjlBNDZFRkFFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjlBNDZFRkJFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2OUE0NkVGOEUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2OUE0NkVGOUUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Poa+1GoAAAE5SURBVHjapJO/SgNBEIdzS6x9CR8gEIjNYSkISWNI1BCw0MLCQCqDhWC0SGIltpo3SIrY2NgI1ygoJo1WIZBW0gn+Qc9vYC8sS+5OyMB3c7v3m7mZnTvH9/3EPJaUi+d5V7idf+jvYcV13a9gQ2m/D08xwW9QMIOnCdj8wOVhEhL8C1voxvaDoAJJMsKVtdi2I57fzsqszAWiG9yJpbmGRuQhWnYKy/AOkvCOxKGjUvYGYmnhGKTkNjwzpV1Tw3oBMmEViP3AInRgHS4JSOvqKrANTXhQEWNrQRdSUgXsgUwhCzkqvZjZgmWf8KoJ9DWCH0PPwLC6PsQebMKZbqlJOyouwUCPU4LX4Jy31vAlkO9lIzIB4m/pE1ahDwfGflFuqcKJa+EFhlDVgQnjsz+EJVk78/7OfwIMAP6mWr/ROcXGAAAAAElFTkSuQmCC":14===a?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAGBJREFUGBljYCAHzJo1a8L///+ZsOlFEQQqygcqXr1q1SpOdMUoCqGSQe/fv987c+ZMEWTF2BSC5C0ZGRkXEaPwONAZccgKWZA5UPY6QUHBmLCwsO9Y5CBC+HyNUxPZEgCPEyCkHm49GwAAAABJRU5ErkJggg==":"";
}b.getFilterButtonImageSrc=g,function(a){a[a.noSortFilter=0]="noSortFilter",a[a.ascending=1]="ascending",a[a.descending=2]="descending",a[a.filter=3]="filter",a[a.filterAscend=4]="filterAscend",a[a.filterDescend=5]="filterDescend",a[a.sortAscending=6]="sortAscending",a[a.sortDescending=7]="sortDescending",a[a.checkAll=8]="checkAll",a[a.unCheckAll=9]="unCheckAll",a[a.isChecked=11]="isChecked",a[a.clearAble=12]="clearAble",a[a.clearUnable=13]="clearUnable",a[a.disableRightArrow=14]="disableRightArrow"}(f||(f={}));function h(a,b){return{position:d.ButtonPosition.right,imageSize:{width:18,height:18},options:{configurationNumber:b},imageType:d.ButtonImageType.custom,visibility:d.ButtonVisibility.always,useButtonStyle:!1,enable:!0,buttonBackColor:"transparent",imageSrc:g(a),command:"OpenPivotFilterDialogCmd",hasOverLay:!0}}b.getFilterCellButtonInfo=h},"./dist/plugins/pivot/pivot-table-entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/pivot/pivot.ns.js")),d(c("./dist/plugins/pivot/pivot-table/pivot-table-spread.js")),c("./dist/plugins/pivot/pivot-table/pivot-table-command.js"),d(c("./dist/plugins/pivot/pivot-table/pivot-table-theme.js")),d(c("./dist/plugins/pivot/pivot-table/pivot-table.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-view.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js")),d(c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js")),d(c("./dist/plugins/pivot/pivot-panel/pivot-panel.js")),d(c("./dist/plugins/pivot/pivot-ui/dropdown-list.js")),d(c("./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js")),d(c("./dist/plugins/pivot/pivot-ui/filter-dialog.js")),d(c("./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js")),d(c("./dist/plugins/pivot/sheet-range-to-pivot-area.js")),d(c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-caches.js")),d(c("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js")),d(c("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js")),d(c("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js"));var e=c("Pivot");b.SortType=e.SortType,c("./dist/plugins/pivot/pivot-definition.js")},"./dist/plugins/pivot/pivot-table/pivot-data-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("Pivot"),g=d.Common.j.Fa,h=function(){function a(a){this.dataTable=[],this.ILa=a,this.mzc=[],this.lzc=[],this.kzc=[],this.INc={}}return a.prototype.ozc=function(a,b){this.kzc[a]=b},a.prototype.setStartInfo=function(a,b){this.nU=a,this.hF=b},a.prototype.yq=function(a,b,c){var d=this.RTa(a,b,!0);d.value=c},a.prototype.setColCount=function(a){this.OZ=a},a.prototype.setRowCount=function(a){this.Xj=a},a.prototype.getColInfoMap=function(){var a,b,c={},d=this.mzc,e=d.length;for(a=0;a<e;a++)d[a]&&(b=d[a].path,d[a].valueFieldName&&(""===b?b=d[a].valueFieldName||"":b+=f.Separator+d[a].valueFieldName||""),c[b]=a);return c},a.prototype.getRange=function(){return new e.Range(this.nU,this.hF,this.Xj,this.OZ)},a.prototype.ge=function(a,b){var c=this.RTa(a,b);return c&&c.value},a.prototype.zn=function(a,b,c){var d=this.RTa(a,b,!0);d.style=c},a.prototype.Gq=function(a,b){var c=this.RTa(a,b);return c&&c.style},a.prototype.pzc=function(a,b,c){var d=this.RTa(a,b,!0);d.fieldName=c},a.prototype.jzc=function(a,b){var c=this.RTa(a,b);return c&&c.fieldName||c&&c.value},a.prototype.qzc=function(a,b){var c=this.RTa(a,b);return c&&c.nodeRefer},a.prototype.RTa=function(a,b,c){var d,e=this.dataTable,f=e[a];if(!f){if(!c)return null;f=this.dataTable[a]=[]}if(d=f[b],!d){if(!c)return null;d=f[b]={}}return d},a.prototype.hZ=function(){this.dataTable=[],this.mzc=[],this.lzc=[],this.kzc=[],this.INc={},delete this.Xj,delete this.OZ},a.prototype.$xc=function(a){var b,c=this,d=c.kzc;for(b=0;b<d.length;b++)if(c.kzc[b]&&c.kzc[b].fieldName===a)return b},a.prototype.JNc=function(a,b,c,d){var e=this.INc;g(e[b])&&(e[b]={}),g(e[b][c])&&(e[b][c]={},e[b][c].ranges=[]),e[b][c].level=d,e[b][c].ranges.push(a)},a}(),i=function(){function a(){this.szc=[new h(0),new h(1),new h(2),new h(3),new h(4)]}return a.prototype.getAllModel=function(){var a=this.szc,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4];return{pageModel:b,cornerModel:c,columnModel:d,rowModel:e,contentModel:f}},a.prototype.getModel=function(a){return this.szc[a]},a.prototype.hZ=function(){var a=this.szc,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4];b.hZ(),c.hZ(),d.hZ(),e.hZ(),f.hZ()},a.prototype.getWholeRange=function(){},a.prototype.tzc=function(){},a}(),b.PivotDataModel=i},"./dist/plugins/pivot/pivot-table/pivot-table-command.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table-entry.js"),g=c("Pivot"),h=c("./dist/plugins/pivot/pivot-ui/filter-dialog.js"),i=c("./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js"),j=c("./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js"),k=c("./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js"),l=c("./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js"),m=c("@grapecity/js-sheets-common"),n=c("SheetsCalc"),o=c("./dist/plugins/pivot/pivot.ns.js"),p=c("./dist/plugins/pivot/pivot-core/pivot-core-entry.js"),q=c("./dist/plugins/pivot/pivot-util.js"),r=c("@grapecity/js-calc"),s=m.Formatter.GeneralFormatter,t=new m.Common.ResourceManager(o.SR,"PivotTables"),u=t.getResource.bind(t),v=d.Commands.ActionBase,w="PivotOutlineButtonToggle",x=d.Commands.h4,y=m.Common.l,z=m.Common.CultureManager,A="moveField",B="removeField",C="AddField",D="fieldSet",E="CreatePivotFilterDialog",F="updateListBox",G="changePanelFieldStatus",H="filterFieldLabelValue",I="pivotSort",J="ClearCommand",K="updatePivotCache",L="createFilterSecondaryMenu",M="createDialogForLabelFilter",N="OpenPivotFilterDialogCmd",O="updateCondition",P="createDialogForValueFilter",Q="updateValueCondition",R="TopTenCondition",S="dialogForDateFilter",T="openValueFieldSettingDialogCmd",U="UpdatePivotValueFieldCmd",V="UpdatePivotFieldCmd",W="CreatePivotViewsListDialog",X="OpenPivotGroupDialog",Y="OpenPivotShowValueAsDialog",Z="ApplyPivotView",$="AddPivotView",_="pivotRefresh",aa="pivotTableGroup",ba="pivotTableUnGroup",ca="pivotShowDetails",da="pivotExpand",ea="pivotCollapse",fa="pivotExpandEntireField",ga="pivotCollapseEntireField",ha="removePivotGrandTotal",ia="updatePivotDefer",ja="selectWholePivotTable",ka=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],la=null,ma=void 0,na=function(a,b,c){var d=a.pivotTables.findPivotTable(b,c),e=la;return d&&(e=d.getPivotInfoImp(b,c,!1,!1,!0)),{pivotInfo:e,pt:d}};function Na(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=!1;return b?(i=b.Zxc,g=a.getFilterInfo(i),h=b.zZ):(g=a.getFilterInfo(c),i=c),j=!1,k=!1,g&&g.labelFilter&&(g.labelFilter.condition&&(j=!0),g.labelFilter.textItem&&!g.labelFilter.textItem.isAll&&(k=!0)),l=!!g&&g.dyc(),m=h?h.sortType:la,0===a.bGc(c)&&(v=!0),n=la,o=!1,g&&g.labelFilter&&g.labelFilter.textItem&&(n=g.labelFilter.textItem.list,o=g.labelFilter.textItem.isAll),p=a.oIJ(i).BBc(),q=a.lBJ(i),r=a.oIJ(i),s=r.jGJ(),t=(a.nyc||[]).filter(function(a){return a.Cj===e})[0],u=Oa(r,p,n,o,s,m,q,t,c,f),{fieldIsNumber:v,sortInfo:m,hasLabelCondition:j,hasValueCondition:l,fields:u,isColOrRow:d,hasLabelManual:k}}function Oa(a,b,c,d,e,f,h,i,j,k){var l,n,o,p,q=[],r=[];if(e){for(n=0;n<b.length;n++)r[e[n]]=b[n];f===g.SortType.desc&&r.reverse()}return o=0===r.length?b:r,p=function(b){var c,d,e,f;if(a.jGc&&a.jGc.length>0||!g.Fa(a.SDc))return b+"";if(c=3===k?{dataOnly:!0,references:[{fieldName:u().Values,items:[j]}]}:{labelOnly:!0,references:[{fieldName:j}]},d=i.getStyle(c),e=d&&d.formatter,h===g.PivotDataType.date&&(b=g.parseStringToDate(b),f=z.q4().DateTimeFormat,e=e||f.shortDatePattern),e){if("string"==typeof e)return new s(e).format(b);if(e instanceof m.Formatter.FormatterBase)return e.format(b)}return b+""},!c||0===c.length||d?o.forEach(function(a){l={status:!0,value:a,text:p(a)},q.push(l)}):o.forEach(function(a){l={status:!0,value:a,text:p(a)},c.indexOf(a)<0&&(l.status=!1),q.push(l)}),q}oa=function(a,b,c,e,f){var g,h,i,j,k=[];for(g=0;g<e.length;g++)h=e[g],i=void 0,3===f?i=new d.Range(h.row,h.col,h.rowCount,1):2===f&&(i=new d.Range(h.row,h.col,1,h.colCount)),j=i&&a.pivotTables.getRangePivotAreas(i),j&&j[b].map(function(a){if(a.labelOnly){var b=a.references;b.forEach(function(a){if(a.fieldName===c)for(var b=0;b<a.items.length;b++)k.indexOf(a.items[b])===-1&&k.push(a.items[b])})}});return k};function Pa(a,b){var c=0;return a.forEach(function(a,d){if(a.Cj===b)return void(c=d)}),c}function Qa(a,b){var c,d,e=a.colHeadFieldInfo,f=a.cornerFieldInfo,h=a.pageFieldInfo,i=a.rowInfos,j=a.colInfos,k=a.activeRowFieldInfo,l=a.activeColFieldInfo,m=a.area,n=a.value,o=a.menuArea,p=a.valueFieldName;switch(m){case 0:c=h&&h.fieldName;break;case 1:1===o?c=n:2===o&&f&&(c=f.fieldName,c===u().sigmaValueTemp&&(c=u().sigmaValue));break;case 2:if(2===o&&e)c=e.fieldName,c===u().sigmaValueTemp&&(c=u().sigmaValue);else if(5===o)c=p||b&&b.myc[0].Cj;else if(c=l&&l.name||n,g.Fa(c)){for(d=l;d>=0&&j[d]&&g.Fa(j[d].itemName);)d-=1;c=j[d].fieldName}break;case 3:if(5===o)c=p||b&&b.myc[0].Cj;else if(c=k&&k.name||n,g.Fa(c)){for(d=k.index;d>=0&&i[d]&&g.Fa(i[d].itemName);)d-=1;c=i[d].fieldName}break;case 4:c=p}return c}function Ra(a,b){if(b){var c=b.numberGroup;return{isStartActive:g.Fa(c.start),start:g.Fa(c.start)?a.start:c.start,isEndActive:g.Fa(c.end),end:g.Fa(c.end)?a.end:c.end,by:g.Fa(c.by)?10:c.by}}return{start:a.start,isStartActive:!0,end:a.end,isEndActive:!0,by:10}}function Sa(a,b){var c,d,e,f,h;if(b){for(c=b.dateGroups,d=[],e=0,f=c;e<f.length;e++)h=f[e],d.push(h.by);return{start:a.start,isStartActive:!0,end:a.end,isEndActive:!0,by:d}}return{start:a.start,isStartActive:!0,end:a.end,isEndActive:!0,by:[g.DateGroupType.months,g.DateGroupType.quarters,g.DateGroupType.years]}}pa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()&&(a=p.kj,b=p.VQ,c=na(a,b.row,b.col),e=c.pivotInfo,f=c.pt,e)){g=e.activeRowFieldInfo,h=e.activeColFieldInfo,i=e.area,j=void 0,k=a.ITa,k.startTransaction(),p.Lz(a,!0);try{switch(i){case 2:j=e.colInfos[h&&h.index];break;case 3:j=e.rowInfos[g&&g.index]}l=j.fieldName,m=j.itemName,n=f.collapse(l,m),f.collapse(l,m,!n),a.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:l,item:m,newValue:!n,oldValue:n,pivotTableName:f.Cj}),q=!0}finally{p.Mz(a,!0),o=d.Commands.bWa(a.name()),p.VQ[o]=k.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e,f=this,g=f.kj,h=!1;if(f.canUndo()){f.Lz(g,!0);try{a=d.Commands.bWa(g.name()),b=f.VQ[a],g.ITa.undo(b),c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,e=na(g,f.VQ.row,f.VQ.col).pt,g.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:c.fieldName,newValue:c.isCollapse,oldValue:!c.isCollapse,pivotTableName:e.Cj,item:c.item}),h=!0}finally{f.Mz(g,!0)}}return h},b}(v),d.Commands[w]={canUndo:!0,execute:function(a,b,c){return d.Commands.h4(a,pa,b,c)}},qa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p,q,r,s,t,v,w,x,y,z,A=this,B=!1;if(A.canExecute())if(a=A.kj,b=a.ITa,c=A.VQ.cmdOption,f=c.fieldName,h=c.targetArea,i=c.targetIndex,j=c.isSusPaint,k=c.pivotName,l=a.pivotTables&&a.pivotTables.get(k),m=j?l.Vyc.copyFieldsModel:l.Vyc,j)f===u().sigmaValue?(n=m.ryc(h),i=i>-1?i:0,i=i<=n.length?i:n.length,m.setSigmaValuePosition(h-1,i)):m.changeFieldArea(f,h,i),m.syc(j);else if(b.startTransaction(),A.Lz(a,!0),!g.Fa(f))try{if(f===u().sigmaValue)n=m.ryc(h),i=i>-1?i:0,i=i<=n.length?i:n.length,o=l.dataPosition(),m.setSigmaValuePosition(h-1,i),p=h-1,q=i,r=o.positionType,s=o.positionIndex,p===r&&q===s||a.Wq(d.Events.PivotTableChanged,{type:"dataPositionChanged",newArea:p,newIndex:q,oldArea:r,oldIndex:s,pivotTableName:k});else{if(t=void 0,n=void 0,t=m.getFieldInfoByName(f),g.Fa(t))return!1;for(v=e.PivotTableFieldType.columnField;v>=e.PivotTableFieldType.filterField;v--){for(n=m.ryc(v),w=!1,x=n.length-1;x>=0;x--)if(n[x].Zxc===t.Zxc){f=n[x].Cj,w=!0;break}if(w)break}y=l.getField(f),n=m.ryc(h),p=h,r=y.pivotArea,s=y.pivotIndex,q=i>-1?i:0,q=q<=n.length?q:n.length,p===r&&s===q||(l.updateField(f,h,i),a.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f,newArea:p,newIndex:q,oldArea:r,oldIndex:s,pivotTableName:k}))}m.syc(j),Ta(l,a),B=!0}catch(b){a.Os(10,b.message)}finally{A.Mz(a,!0),z=d.Commands.bWa(a.name()),A.VQ[z]=b.endTransaction()}return B},b.prototype.undo=function(){var a,b,c,e,f,g,h,i,j=this,k=j.kj,l=!1;if(j.canUndo()){j.Lz(k,!0);try{for(a=d.Commands.bWa(k.name()),b=j.VQ[a],c=k.pivotTables&&k.pivotTables.get(j.VQ.cmdOption.pivotName),e=b.pivotTableChanges,f=void 0,k.ITa.undo(b),g=0;g<e.length&&(f=e[g].value,"addField"!==f.type&&"updateValuePosition"!==f.type);g++);h=c.getField(f.fieldName),"updateValuePosition"===f.type?(i=c.dataPosition(),k.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",newArea:f.position,newIndex:f.valuesIndex,oldArea:i.positionType,oldIndex:i.positionIndex,pivotTableName:j.VQ.cmdOption.pivotName})):k.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,newArea:f.area,newIndex:f.index,oldArea:h.pivotArea,oldIndex:h.pivotIndex,pivotTableName:j.VQ.cmdOption.pivotName}),l=!0}finally{j.Mz(k,!0)}}return l},b}(v),d.Commands[A]={canUndo:!0,execute:function(a,b,c){return x(a,qa,b,c)}};function Ta(a,b){var c=a.getRange(),d=c.page,e=c.content,f=b.getActiveRowIndex(),g=b.getActiveColumnIndex();0!==e.colCount?e.contains(f,g)||b.setActiveCell(e.row,e.col):d&&(d.contains(f,g)||b.setActiveCell(d.row,d.col))}ra=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,q,r,s,t,v,w=this,x=!1;if(w.canExecute())if(a=w.VQ,b=w.kj,c=b.ITa,f=a.cmdOption,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,g.Fa(f)?(m=a.commandOptions,n=m.pivotTableCellInfo,k=b.pivotTables&&b.pivotTables.get(m.pivotTableName),h=k.Vyc,i=Qa(n)):(i=f.fieldName,j=f.isSusPaint,k=b.pivotTables&&b.pivotTables.get(f.pivotName),h=j?k.Vyc.copyFieldsModel:k.Vyc),j){if(i===u().sigmaValue)for(o=h.ryc(e.PivotTableFieldType.valueField),q=o.length-1;q>=0;q--)h.clearValueFilterOfValueField(o[q].Cj);r=h.oyc[i],l=h.removeFieldOrSigmaByName(i),l instanceof p.PivotViewField&&(r===e.PivotTableFieldType.valueField?h.clearValueFilterOfValueField(i):h.bCJ(i,!1)),h.syc(j)}else{c.startTransaction(),w.Lz(b,!0);try{if(s=[],i===u().sigmaValue){for(o=h.ryc(e.PivotTableFieldType.valueField),q=o.length-1;q>=0;q--)h.clearValueFilterOfValueField(o[q].Cj);if(t=h.ryc(e.PivotTableFieldType.valueField),t&&t.length>0)for(q=0;q<t.length;q++)s.push(k.getField(t[q].Cj))}else s.push(k.getField(i));for(l=h.getFieldInfoByName(i),r=h.oyc[i],l instanceof p.PivotViewField&&(r===e.PivotTableFieldType.valueField?h.clearValueFilterOfValueField(i):h.bCJ(i,!1)),l=h.removeFieldOrSigmaByName(i),q=0;q<s.length;q++)b.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:i,oldArea:s[q].pivotArea,oldIndex:s[q].pivotIndex,newArea:la,newIndex:la,pivotTableName:k.Cj});h.syc(j),Ta(k,b),x=!0}finally{w.Mz(b,!0),v=d.Commands.bWa(b.name()),w.VQ[v]=c.endTransaction()}}return x},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.pivotTableChanges,e=0;e<c.length;e++)f=c[e],h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,newArea:f.area,newIndex:f.index,oldIndex:la,oldArea:la,pivotTableName:g.VQ.cmdOption?g.VQ.cmdOption.pivotName:g.VQ.commandOptions.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(v),d.Commands[B]={canUndo:!0,execute:function(a,b,c){return x(a,ra,b,c)}},sa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j,k,l=this,m=!1;if(l.canExecute()){a=l.VQ,b=a.commandOptions,c=l.kj,e=c.ITa,e.startTransaction(),l.Lz(c,!0);try{f=b.pivotTableCellInfo,g=c.pivotTables.get(b.pivotTableName),h=f.area,i=f.menuArea,j=g.options.grandTotalPosition,1===j||2===j?g.options.grandTotalPosition=0:3===j&&(3===h&&5===i?g.options.grandTotalPosition=1:2===h&&5===i&&(g.options.grandTotalPosition=2)),m=!0}finally{l.Mz(c,!0),k=d.Commands.bWa(c.name()),l.VQ[k]=e.endTransaction()}}return m},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[ha]={canUndo:!0,execute:function(a,b,c){return x(a,sa,b,c)}},ta=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p,r,s,t,v,w,x,y,z,A,B,C=this,D=!1;if(C.canExecute()){a=C.VQ,b=a.cmdOption,c=a.commandOptions,e=C.kj,f=e.ITa,f.startTransaction(),C.Lz(e,!0),h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,g.Fa(b)?(m=c.pivotTableCellInfo,l=e.pivotTables.get(c.pivotTableName),h=l.Vyc,i=c.subTotalType,k=Qa(m,h)):(i=b.subtotalType,k=b.oldFieldName,l=e.pivotTables.get(b.pivotName),h=l.Vyc),n=h.getFieldInfoByName(k),o=h.KBJ(k),j=b&&b.fieldName||!g.Fa(i)&&o!==i&&h.PIJ(h.OIJ(n.Zxc,n.Cj,i))||k;try{g.Fa(n)||g.Fa(i)||(p=!0,r=!1,o!==i&&(h.KBJ(k,i),r=!0),g.Fa(k)||k===j||(s=h.getFieldInfoByName(k),p=h.changeFieldName(s,j)),p||(j=k,e.Os(10,u().PivotTableErrorMessage_EmptyFieldName)),r&&e.Wq(d.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:j,oldValue:o,newValue:i,pivotTableName:l.Cj})),t=void 0,v=void 0,w=void 0,b?(t=b.showValueAsType,v=b.baseField,w=b.baseItem):c&&(t=c.showValueAsType),x=void 0,w?x=0===w.index?{showDataAs:t,baseFieldName:v,baseFieldItemType:2}:1===w.index?{showDataAs:t,baseFieldName:v,baseFieldItemType:1}:{showDataAs:t,baseFieldName:v,baseFieldItemType:0,baseFieldItem:w.value}:v?x={showDataAs:t,baseFieldName:v}:g.Fa(t)||(x={showDataAs:t}),y=h.getFieldInfoByName(j).xFJ||{showDataAs:0},z=x&&!this.$JJ(x,y),z&&(l.showDataAs(j,x),e.Wq(d.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:j,oldValue:q._AJ(y),newValue:q._AJ(x),pivotTableName:l.Cj})),A=a.formatter,7!==i||A||(A="0.0000000"),g.Fa(l.showDataAs(j))||(t=l.showDataAs(j).showDataAs),q.applyShowDataAsStyle(l,j,t,A),h.syc(),D=!0}catch(a){e.Os(10,a.message)}finally{C.Mz(e,!0),B=d.Commands.bWa(e.name()),C.VQ[B]=f.endTransaction()}}return D},b.prototype.$JJ=function(a,b){var c=b.showDataAs,d=b.baseFieldName,e=b.baseFieldItem,f=b.baseFieldItemType;return a.showDataAs===c&&a.baseFieldName===d&&a.baseFieldItem===e&&a.baseFieldItemType===f},b.prototype.LIJ=function(a){var b,c,d;for(b=0,c=ka;b<c.length;b++)if(d=c[b],!g.Fa(a[d]))return!1;return!0},b.prototype.undo=function(){var a,b,c,e,f,g,h,i,j,k,l,m,n,o=this,p=o.kj,r=!1;if(o.canUndo()){o.Lz(p,!0);try{for(a=d.Commands.bWa(p.name()),b=o.VQ[a],c=b.pivotTableChanges,e=o.VQ.cmdOption||o.VQ.commandOptions,f=e.pivotTableName||e.pivotName,g=p.pivotTables&&p.pivotTables.get(f),h=g.Vyc,i=void 0,j=void 0,k=0;k<c.length;k++)l=c[k].value,"showDataAs"===l.type?i=l:"subTotalType"===l.type&&(j=l);p.ITa.undo(b),i&&(m=h.getFieldInfoByName(i.fieldName),m&&(n=m.xFJ,p.Wq(d.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:i.fieldName,oldValue:q._AJ(n),newValue:q._AJ(i.oldShowDataAs),pivotTableName:g.Cj}))),j&&p.Wq(d.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:j.fieldName,oldValue:h.KBJ(j.fieldName),newValue:j.subtotalType,pivotTableName:g.Cj}),r=!0}finally{o.Mz(p,!0)}}return r},b}(v),d.Commands[U]={canUndo:!0,execute:function(a,b,c){return x(a,ta,b,c)}},ua=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,o,p,q,s=this,t=!1;if(s.canExecute()){a=s.VQ,b=a.cmdOption,c=a.commandOptions,e=s.kj,f=e.ITa,h=void 0,f.startTransaction(),s.Lz(e,!0),i=void 0,j=void 0,k=void 0,l=void 0,g.Fa(b)?(m=c.pivotTableCellInfo,l=e.pivotTables.get(c.pivotTableName),i=l.Vyc,k=Qa(m,i),h=c.showNoData):(k=b.oldFieldName,l=e.pivotTables.get(b.pivotName),i=l.Vyc,h=b.showNoData),o=i.getFieldInfoByName(k),j=b&&b.fieldName||i.PIJ(i.cJJ(o.Zxc,o.Cj))||k;try{if(l&&l.suspendLayout(),p=a.formatter,l&&(l.showNoData(o.Zxc,h),k!==j&&l.updateFieldName(k,j)),d.Ul.lHb(p))try{n.evaluateFormula(e,p)}catch(a){if(!(a instanceof r.CalcError))return}this.GHa(l,j,null,p),l&&l.resumeLayout(),t=!0}finally{s.Mz(e,!0),q=d.Commands.bWa(e.name()),s.VQ[q]=f.endTransaction()}}return t},b.prototype.gHJ=function(a){return[g.PivotShowDataAs.percentOfTotal,g.PivotShowDataAs.percentOfRow,g.PivotShowDataAs.percentOfCol,g.PivotShowDataAs.percent,g.PivotShowDataAs.percentOfParentRow,g.PivotShowDataAs.percentOfParentCol,g.PivotShowDataAs.percentOfParent,g.PivotShowDataAs.percentDiff,g.PivotShowDataAs.percentOfRunningTotal].indexOf(a)>-1},b.prototype.GHa=function(a,b,c,e){var f,g={labelOnly:!0,references:[{fieldName:b}]};f=q._AJ(a.getStyle(g)),f||(f=new d.Style),e?f.formatter=e:(delete f.formatter,q.dJJ(f)&&(f=null)),a.setStyle(g,f)},b.prototype.undo=function(){var a,b,c,e,f=this,g=f.kj,h=!1;if(f.canUndo()){f.Lz(g,!0);try{a=d.Commands.bWa(g.name()),b=f.VQ[a],c=f.VQ.cmdOption||f.VQ.commandOptions,e=c.pivotTableName||c.pivotName,g.ITa.undo(b),h=!0}finally{f.Mz(g,!0)}}return h},b}(v),d.Commands[V]={canUndo:!0,execute:function(a,b,c){return x(a,ua,b,c)}},va=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p=this,q=!1,r=p.VQ.cmdOption;if(p.canExecute())if(a=r.targetArea,b=r.fieldName,c=r.targetIndex,f=r.pivotName,h=r.isSusPaint,i=p.kj,j=i.ITa,k=i.pivotTables.get(f),l=h?k.Vyc.copyFieldsModel:k.Vyc,g.Fa(c)&&(c=l.ryc(a).length,m=l.getSigmaValuePosition(),m.display&&m.positionType===a-1&&c++),n=b,a===e.PivotTableFieldType.valueField&&(n=l.PIJ(l.OIJ(b))),h)l.addFieldByName(b,n,a,la,c),l.syc(h);else{j.startTransaction(),p.Lz(i,!0);try{l.addFieldByName(b,n,a,la,c),i.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:b,newArea:a,newIndex:c,oldIndex:la,oldArea:la,pivotTableName:f}),l.syc(h),Ta(i.pivotTables.get(f),i),q=!0}catch(a){i.Os(10,a.message)}finally{p.Mz(i,!0),o=d.Commands.bWa(i.name()),p.VQ[o]=j.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.pivotTableChanges,e=0;e<c.length;e++)f=c[e].value,"removeField"===f.type&&h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,oldArea:f.area,oldIndex:f.index,newArea:la,newIndex:la,pivotTableName:g.VQ.cmdOption.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(v),d.Commands[C]={canUndo:!0,execute:function(a,b,c){return x(a,va,b,c)}},wa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.getAllItemsList=function(a){var b=[],c=a._items;return c.forEach(function(a){b.push(a.value)}),b},b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this,F=!1;if(E.canExecute()){a=E.VQ,b=a.cmdOption,c=void 0,e=void 0,f=void 0,h=void 0,i=void 0,j=E.kj,k=j.ITa,k.startTransaction(),E.Lz(j,!0);try{if(g.Fa(b)){if(p=E.VQ.commandOptions,q=E.VQ.selections,r=p.subType,h=j.pivotTables.get(p.pivotTableName),s=p.pivotTableCellInfo,c=h.Vyc,t=s.area,u=s.rowInfos,v=s.colInfos,w=s.activeRowFieldInfo,x=s.activeColFieldInfo,e=Qa(s),y=void 0,i=h.options.allowMultipleFiltersPerField?h.labelFilter(e)||{}:{},y=g.Fa(i.textItem)?{isAll:!1}:i.textItem,z=oa(j,p.pivotTableName,e,q,t),1===r)y.list=z.slice();else if(2===r){for(A=(c.getLabelFilterInfo(e)&&c.getLabelFilterInfo(e).textItem&&c.getLabelFilterInfo(e).textItem.list||c.cGc(e)).slice(0),B=[],C=0;C<A.length;C++)z.indexOf(A[C])===-1&&B.push(A[C]);y.list=B}i.textItem=y}else e=b.fieldName,f=b.pivotName,h=j.pivotTables.get(f),c=h.Vyc,l=b.dataOfListBox,i=h.options.allowMultipleFiltersPerField?h.labelFilter(e)||{}:{},m={list:[],isAll:!1},n=[],o=!0,l.forEach(function(a){!a.status&&o&&(o=a.status),a.status&&n.push(a.value)}),m.isAll=o,m.list=n,i.textItem=m;h.labelFilter(e,i),j.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:e,filterInfo:h.labelFilter(e),pivotTableName:f}),F=!0}finally{E.Mz(j,!0),D=d.Commands.bWa(j.name()),E.VQ[D]=k.endTransaction()}}return F},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],f.ITa.undo(b),c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,f.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:c.fieldName,filterInfo:q._AJ(c.filterInfo),pivotTableName:e.VQ.cmdOption&&e.VQ.cmdOption.pivotName||e.VQ.commandOptions.pivotTableName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(v),d.Commands[H]={canUndo:!0,execute:function(a,b,c){return x(a,wa,b,c)}},xa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()){a=p.VQ,b=a.cmdOption,c=void 0,e=void 0,f=void 0,h=void 0,i=void 0,j=p.kj,k=j.ITa,k.startTransaction(),p.Lz(j,!0);try{if(g.Fa(b))m=p.VQ.commandOptions,f=m.pivotTableName,h=j.pivotTables.get(m.pivotTableName),n=m.pivotTableCellInfo,c=h.Vyc,e=Qa(n),i=m.subType;else switch(e=b.fieldName,f=b.pivotName,l=b.commandName,h=j.pivotTables.get(f),c=h.Vyc,l){case"asc":i=g.SortType.asc;break;case"desc":i=g.SortType.desc;break;case"custom":i=g.SortType.custom;break;default:return}h.sort(e,{sortType:i}),j.Wq(d.Events.PivotTableChanged,{type:"sort",fieldName:e,sortType:i,pivotTableName:f}),q=!0}finally{p.Mz(j,!0),o=d.Commands.bWa(j.name()),p.VQ[o]=k.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,f.ITa.undo(b),f.Wq(d.Events.PivotTableChanged,{type:"sort",fieldName:c.fieldName,sortType:c.sortInfo?c.sortInfo.sortType:la,pivotTableName:e.VQ.cmdOption?e.VQ.cmdOption.pivotName:e.VQ.commandOptions.pivotTableName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(v),d.Commands[I]={canUndo:!0,execute:function(a,b,c){return x(a,xa,b,c)}},ya=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o=this,p=!1;if(o.canExecute()){a=o.VQ,b=a.cmdOption,c=void 0,e=void 0,f=void 0,h=void 0,i=void 0,j=o.kj,k=j.ITa,k.startTransaction(),o.Lz(j,!0);try{g.Fa(b)?(l=o.VQ.commandOptions,c=j.pivotTables.get(l.pivotTableName),m=l.pivotTableCellInfo,e=c.Vyc,f=Qa(m),h=l.clearType):(f=b.fieldName,h=b.clearType,i=b.pivotName,c=j.pivotTables.get(i),e=c.Vyc),1===h?c.labelFilter(f,la):2===h?c.valueFilter(f,la):0===h&&(c.labelFilter(f,la),c.valueFilter(f,la)),j.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:f,pivotTableName:i,clearType:h}),p=!0}finally{o.Mz(j,!0),n=d.Commands.bWa(j.name()),o.VQ[n]=k.endTransaction()}}return p},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.pivotTableChanges,e=0;e<c.length;e++)f=c[e].value,"setLabelFilter"!==f.type&&"setValueFilter"!==f.type||h.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:f.fieldName,filterInfo:q._AJ(f.filterInfo),pivotTableName:g.VQ.cmdOption?g.VQ.cmdOption.pivotName:g.VQ.commandOptions.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(v),d.Commands[J]={canUndo:!0,execute:function(a,b,c){return x(a,ya,b,c)}},za=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()){a=p.VQ.cmdOption,b=a.fieldName,c=a.selectValue,e=a.inputValue,f=a.inputValueEnd,h=a.pivotName,i=p.kj,j=i.ITa,j.startTransaction(),p.Lz(i,!0);try{k=i.pivotTables.get(h),l=k.Vyc.bGc(b),m=k.options.allowMultipleFiltersPerField?k.labelFilter(b)||{}:{},l===g.PivotDataType.number&&(e=g.Fa(e)?e:parseInt(e,10),f=g.Fa(f)?f:parseInt(f,10)),n={conType:g.PivotConditionType.caption,val:[e,f],operator:c},m.condition=n,k.labelFilter(b,m),i.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:b,filterInfo:k.labelFilter(b),pivotTableName:h}),q=!0}finally{p.Mz(i,!0),o=d.Commands.bWa(i.name()),p.VQ[o]=j.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],f.ITa.undo(b),c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,f.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:c.fieldName,filterInfo:q._AJ(c.filterInfo),pivotTableName:e.VQ.cmdOption.pivotName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(v),d.Commands[O]={canUndo:!0,execute:function(a,b,c){return x(a,za,b,c)}},Aa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p=this,q=!1;if(p.canExecute()){a=p.VQ.cmdOption,b=p.kj,c=b.ITa,c.startTransaction(),p.Lz(b,!0);try{e=a.valueOfField,f=a.valueOfFieldValue,h=a.inputValue,i=a.inputValueEnd,j=a.fieldName,k=a.pivotName,l=b.pivotTables.get(k),m={},n=void 0,n={conType:g.PivotConditionType.value,val:[h,i],operator:+f},m.condition=n,m.conditionByName=e,l.valueFilter(j,m),b.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:j,filterInfo:l.valueFilter(j),pivotTableName:k}),q=!0}finally{p.Mz(b,!0),o=d.Commands.bWa(b.name()),p.VQ[o]=c.endTransaction()}}return q},b.prototype.undo=function(){var a,b,c,e=this,f=e.kj,g=!1;if(e.canUndo()){e.Lz(f,!0);try{a=d.Commands.bWa(f.name()),b=e.VQ[a],f.ITa.undo(b),c=b.pivotTableChanges[b.pivotTableChanges.length-1].value,f.Wq(d.Events.PivotTableChanged,{type:"filter",fieldName:c.fieldName,filterInfo:q._AJ(c.filterInfo),pivotTableName:e.VQ.cmdOption.pivotName}),g=!0}finally{e.Mz(f,!0)}}return g},b}(v),d.Commands[Q]={canUndo:!0,execute:function(a,b,c){return x(a,Aa,b,c)}},Ba=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i,j,k,l,m,n,o,p,q,r,s=this,t=!1;if(s.canExecute()){a=s.VQ.cmdOption,b=s.kj,c=b.ITa,c.startTransaction(),s.Lz(b,!0);try{e=a.fieldName,f=a.TopOrBottomValue,h=a.inputValue,i=a.pivotName,j=a.selectTypeValue,k=a.valueFieldName,l=b.pivotTables.get(i),m={},n=void 0,o=1,p=0,q=10,"Bottom"===f&&(o=-1),"Percent"===j?p=1:"Sum"===j&&(p=2),isNaN(+h)||(q=+h),n={conType:g.PivotConditionType.top10,val:q,type:p,operator:o},m.condition=n,m.conditionByName=k,l.valueFilter(e,m),t=!0}finally{s.Mz(b,!0),r=d.Commands.bWa(b.name()),s.VQ[r]=c.endTransaction()}}return t},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[R]={canUndo:!0,execute:function(a,b,c){return x(a,Ba,b,c)}};function Ua(a){return g.Fa(a)?la:a instanceof Date?a:y.Qa(a)}Ca=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){var a,b,c=this,d=c.VQ.cmdOption,e=c.kj,g=e.pivotTables.get(d.pivotName),h=g.Vyc;
for(b=0;b<h.nyc.length;b++)h.nyc[b]instanceof f.PivotPanel&&(a=h.nyc[b]);return!(a&&a._R&&a._R.Yyc)},b.prototype.execute=function(){var a,b,c,e,f,i,j,k,l,m,n,o,p,q,r,s,t,v,w,x=this,y=!1;if(x.canExecute()){if(a=x.VQ.cmdOption,b=x.kj,c=b.ITa,e=a.fieldName,f=a.pivotName,i=a.host,j=a.command,k=a.isWholeDay,l=a.dateLabel,m=a.value1,n=a.value2,o=b.pivotTables.get(f),p=o.Vyc,q=o.options.allowMultipleFiltersPerField?o.labelFilter(e)||{}:{},r=void 0,s=+j.split("-")[0],isNaN(s))return;if(s<=g.PivotDateFilterOperator.notBetween&&l)new h.DateFilterDialog(i,l,p,e,f,s),y=!0;else try{if(c.startTransaction(),x.Lz(b,!0),t=Ua(m),v=Ua(n),!g.Fa(m)&&g.Fa(t)||!g.Fa(n)&&g.Fa(v))throw Error(u().DateFormatError);r=41===s?x.createParallelDateFilterCondition(j):{conType:g.PivotConditionType.date,val:[t,v],isWholeDay:k,operator:s},q.condition=r,o.labelFilter(e,q),y=!0}finally{x.Mz(b,!0),w=d.Commands.bWa(b.name()),x.VQ[w]=c.endTransaction()}}return y},b.prototype.createParallelDateFilterCondition=function(a){var b,c,d,e,f,h=+a.split("-")[1];switch(h){case 1:c=new Date,d=new Date,e=c.getMonth(),f=e%3,c.setDate(1),c.setHours(0,0,0,0),c.setMonth(e-f),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!1,by:g.PivotAdvancedDateFilterBy.quarter};break;case 2:c=new Date,d=new Date,c.setDate(1),c.setHours(0,0,0,0),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!1,by:g.PivotAdvancedDateFilterBy.month};break;case 3:c=new Date,d=new Date,c.setMonth(0,1),c.setHours(0,0,0,0),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!0,by:g.PivotAdvancedDateFilterBy.year};break;case 4:c=new Date,d=new Date,e=c.getMonth(),f=e%3,c.setDate(1),c.setHours(0,0,0,0),c.setMonth(e-f),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!0,by:g.PivotAdvancedDateFilterBy.quarter};break;case 5:c=new Date,d=new Date,c.setDate(1),c.setHours(0,0,0,0),d.setHours(23,59,59),b={conType:g.PivotConditionType.date,val:[c,d],isWholeDay:!0,operator:g.PivotDateFilterOperator.dateToDate,isParallel:!0,by:g.PivotAdvancedDateFilterBy.month}}return b},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[S]={canUndo:!0,execute:function(a,b,c){return x(a,Ca,b,c)}},Da=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p,q,r,s,t,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=this,L=!1;if(K.canExecute()){a=K.kj,b=a.ITa,b.startTransaction(),K.Lz(a,!0),c=K.VQ,f=c.commandOptions,h=c.cmdOption;try{if(i=void 0,j=void 0,k=void 0,l=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,r=void 0,g.Fa(h)?(l=a.pivotTables.get(f.pivotTableName),i=l.Vyc,s=f.pivotTableCellInfo,t=s.activeRowFieldInfo,v=s.activeColFieldInfo,o=s.area,j=t&&t.name||v&&v.name,p=c.selections):(j=h.fieldName,k=h.pivotName,m=h.dataType,l=a.pivotTables.get(k),p=h.selections),q=l.getField(j),j=q.sourceName,r=q.fieldName,m===g.PivotDataType.number)n={originFieldName:j,numberGroup:{start:h.startingAtValue,end:h.endingAtValue,by:h.groupByValue}},l.group(n);else if(m===g.PivotDataType.date){if(n={originFieldName:j},w=h.groupByValueArray,w.length>0)for(n.dateGroups=[],x=0;x<w.length;x++)y=w[x],n.dateGroups.push({start:new Date(h.startingAtValue),end:new Date(h.endingAtValue),by:y});l.group(n)}else if(z=j,A=void 0,B=void 0,C={},D=!!i.ZIJ(j),E=void 0,F=void 0,F=oa(a,l.name(),r,p,o),G=l.getGroupInfo(j),H=G&&G.textGroup&&G.textGroup.groupItems,g.Fa(H))F.length>1&&(A=j,z=j+2,E=u().Group+1,C[E]=F,B={originFieldName:A,textGroup:{fieldName:z,groupItems:C}},l.group(B),D||(3===o?l.add(z,z,e.PivotTableFieldType.rowField,void 0,Pa(i.jyc,j)):2===o&&l.add(z,z,e.PivotTableFieldType.columnField,void 0,Pa(i.kyc,j))));else{for(x=0;x<F.length;x++)if(I=F[x],I.indexOf("Group")>-1&&H[I]&&H[I].length>1)return!1;E=u().Group+(Object.keys(H).length+1),H[E]=F,l.group(G)}L=!0}catch(b){a.Os(10,b.message)}finally{K.Mz(a,!0),J=d.Commands.bWa(a.name()),K.VQ[J]=b.endTransaction()}}return L},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[aa]={canUndo:!0,execute:function(a,b,c){return x(a,Da,b,c)}},Ea=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j,k=this,l=!1;if(k.canExecute()){a=k.kj,b=a.ITa,b.startTransaction(),k.Lz(a,!0);try{c=k.VQ,e=c.commandOptions,f=a.pivotTables.get(e.pivotTableName),g=e.pivotTableCellInfo,h=Qa(g),i=f.getField(h),i&&i.sourceName&&(f.ungroup(i.sourceName),l=!0)}finally{k.Mz(a,!0),j=d.Commands.bWa(a.name()),k.VQ[j]=b.endTransaction()}}return l},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[ba]={canUndo:!0,execute:function(a,b,c){return x(a,Ea,b,c)}},Fa=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h=this,i=!1;if(h.canExecute()){a=h.kj,b=a.ITa,b.startTransaction(),h.Lz(a,!0);try{c=h.kj.pivotTables.get(h.VQ.commandOptions.pivotTableName),c.suspendLayout(),e=Va(!1,this,!1),g.Yxc(e,function(b){var e=c.collapse(b.fieldName,b.itemName);c.collapse(b.fieldName,b.itemName,b.collapse),a.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:b.fieldName,item:b.itemName,newValue:b.collapse,oldValue:e,pivotTableName:c.Cj})}),c.resumeLayout(),i=!0}finally{h.Mz(a,!0),f=d.Commands.bWa(a.name()),h.VQ[f]=b.endTransaction()}}return i},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.pivotTableChanges,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(v),d.Commands[da]={canUndo:!0,execute:function(a,b,c){return x(a,Fa,b,c)}};function Va(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s=b.VQ,t=s.commandOptions.pivotTableCellInfo,u=b.kj,v=s.selections[0],w=u.pivotTables.get(s.commandOptions.pivotTableName),x=w.rAc,y=!1,z=w.ys.szc[3],A=w.ys.szc[2],B=[],C=w.Vyc,D=z.lzc,E=A.mzc,F=[];switch(C.myc.length>1&&(g=C.pyc,h=C.qyc),w.suspendLayout(),t.area){case 3:if(i=C.jyc.length,0===g&&t.activeRowFieldInfo&&h<t.activeRowFieldInfo.index&&(i+=1),y=t.activeRowFieldInfo&&t.activeRowFieldInfo.index===i-1,d=c?{row:z.nU+x.row,col:v.col,rowCount:z.Xj,colCount:1}:v,d.row<z.nU+x.row||d.row+d.rowCount>z.nU+x.row+z.Xj||d.col<x.col||d.col+d.colCount>x.col+z.OZ)return;for(j=d.row;j<d.row+d.rowCount;j++)for(k=d.col;k<d.col+d.colCount&&(l=w.getPivotInfoImp(j,k,!1,!1,!0),m=l.rowInfos[t.activeRowFieldInfo.index-(y?1:0)],m)&&(n=D[j-z.nU-x.row],n.collapseIndex!==ma||!(m.isSubtotal&&w.options.subtotalsPosition!==e.SubtotalsPosition.top||m.isGrandTotal||m.isBlankRow))&&(m=l.rowInfos[t.activeRowFieldInfo.index-(y?1:0)],m.itemName);k++)if(o=w.collapse(m.fieldName,m.itemName),o&&!a||!o&&a){p=m.fieldName+m.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:m.fieldName,itemName:m.itemName,collapse:a}));break}break;case 2:if(t.colHeadFieldInfo){for(i=C.kyc.length,1===g&&(0===t.relativeRow&&h<t.relativeColumn||t.activeColFieldInfo&&h<t.activeColFieldInfo.index)&&(i+=1),y=t.relativeColumn===i-1,f={row:t.relativeColumn+x.row+1,col:A.hF+x.col,rowCount:1,colCount:A.OZ},k=f.col;k<f.col+f.colCount;k++)for(j=f.row;j<f.row+f.rowCount&&(q=w.getPivotInfoImp(j,k,!1,!1,!0),n=E[k-A.hF-x.col],r=q.colInfos[q.relativeRow-1-(y?1:0)],r)&&(n.collapseIndex!==ma||!r.isSubtotal&&!r.isGrandTotal)&&(r=q.colInfos[q.relativeRow-1-(y?1:0)],r.itemName);j++)if(o=w.collapse(r.fieldName,r.itemName),o&&!a||!o&&a){p=r.fieldName+r.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:r.fieldName,itemName:r.itemName,collapse:a}));break}}else{if(i=C.kyc.length,1===g&&t.activeColFieldInfo&&h<t.activeColFieldInfo.index&&(i+=1),y=t.activeColFieldInfo&&t.activeColFieldInfo.index===i-1,f=c?{row:v.row,col:A.hF+x.col,rowCount:1,colCount:A.OZ}:v,f.col<A.hF+x.col||f.col+f.colCount>A.hF+x.col+A.OZ||f.row<=x.row||f.row+f.rowCount>x.row+A.Xj)return;for(k=f.col;k<f.col+f.colCount;k++)for(j=f.row;j<f.row+f.rowCount&&(q=w.getPivotInfoImp(j,k,!1,!1,!0),n=E[k-A.hF-x.col],r=q.colInfos[t.activeColFieldInfo&&t.activeColFieldInfo.index-(y?1:0)],r)&&(n.collapseIndex!==ma||!r.isSubtotal&&!r.isGrandTotal)&&(r=q.colInfos[t.activeColFieldInfo.index-(y?1:0)],r.itemName);j++)if(o=w.collapse(r.fieldName,r.itemName),o&&!a||!o&&a){p=r.fieldName+r.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:r.fieldName,itemName:r.itemName,collapse:a}));break}}break;case 1:if(v.colCount*v.rowCount>1)return;if(t.cornerFieldInfo)for(i=z.OZ,2===g&&h<t.relativeColumn&&(i+=1),y=t.relativeColumn===i-1,d={row:z.nU+x.row,col:v.col,rowCount:z.Xj,colCount:1},j=d.row;j<d.row+d.rowCount;j++)for(k=d.col;k<d.col+d.colCount&&(l=w.getPivotInfoImp(j,k,!1,!1,!0),n=D[j-z.nU-x.row],m=l.rowInfos[t.relativeColumn-(y?1:0)],m)&&(n.collapseIndex!==ma||!(m.isSubtotal&&w.options.subtotalsPosition!==e.SubtotalsPosition.top||m.isGrandTotal||m.isBlankRow))&&(m=l.rowInfos[t.relativeColumn-(y?1:0)],m.itemName);k++)if(o=w.collapse(m.fieldName,m.itemName),o&&!a||!o&&a){p=m.fieldName+m.itemName,F.indexOf(p)<0&&(F.push(p),B.push({fieldName:m.fieldName,itemName:m.itemName,collapse:a}));break}}return w.resumeLayout(),B}Ga=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h=this,i=!1;if(h.canExecute()){a=h.kj,b=a.ITa,b.startTransaction(),h.Lz(a,!0);try{c=h.kj.pivotTables.get(h.VQ.commandOptions.pivotTableName),c.suspendLayout(),e=Va(!0,this,!1),g.Yxc(e,function(b){var e=c.collapse(b.fieldName,b.itemName);c.collapse(b.fieldName,b.itemName,b.collapse),a.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:b.fieldName,item:b.itemName,newValue:b.collapse,oldValue:e,pivotTableName:c.Cj})}),c.resumeLayout(),i=!0}finally{h.Mz(a,!0),f=d.Commands.bWa(a.name()),h.VQ[f]=b.endTransaction()}}return i},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.pivotTableChanges,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(v),d.Commands[ea]={canUndo:!0,execute:function(a,b,c){return x(a,Ga,b,c)}},Ha=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i=this,j=!1;if(i.canExecute()){a=i.VQ,b=i.kj,c=b.ITa,c.startTransaction(),i.Lz(b,!0);try{e=b.pivotTables.get(a.commandOptions.pivotTableName),e.suspendLayout(),f=Va(!1,this,!0),g.Yxc(f,function(a){var c=e.collapse(a.fieldName,a.itemName);e.collapse(a.fieldName,a.itemName,a.collapse),b.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:a.fieldName,item:a.itemName,newValue:a.collapse,oldValue:c,pivotTableName:e.Cj})}),e.resumeLayout(),j=!0}finally{i.Mz(b,!0),h=d.Commands.bWa(b.name()),i.VQ[h]=c.endTransaction()}}return j},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.pivotTableChanges,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(v),d.Commands[fa]={canUndo:!0,execute:function(a,b,c){return x(a,Ha,b,c)}},Ia=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,h,i=this,j=!1;if(i.canExecute()){a=i.VQ,b=i.kj,c=b.ITa,c.startTransaction(),i.Lz(b,!0);try{e=b.pivotTables.get(a.commandOptions.pivotTableName),e.suspendLayout(),f=Va(!0,this,!0),g.Yxc(f,function(a){var c=e.collapse(a.fieldName,a.itemName);e.collapse(a.fieldName,a.itemName,a.collapse),b.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:a.fieldName,item:a.itemName,newValue:a.collapse,oldValue:c,pivotTableName:e.Cj})}),e.resumeLayout(),j=!0}finally{i.Mz(b,!0),h=d.Commands.bWa(b.name()),i.VQ[h]=c.endTransaction()}}return j},b.prototype.undo=function(){var a,b,c,e,f,g,h,i=this,j=i.kj,k=!1;if(i.canUndo()){i.Lz(j,!0);try{for(a=d.Commands.bWa(j.name()),b=i.VQ[a],j.ITa.undo(b),c=b.pivotTableChanges,e=i.kj.pivotTables.get(i.VQ.commandOptions.pivotTableName),f=0;f<c.length;f++)g=c[f].value,"setCollapse"===g.type&&(h=e.collapse(g.fieldName,g.item),j.Wq(d.Events.PivotTableChanged,{type:"collapse",fieldName:g.fieldName,item:g.item,newValue:h,oldValue:g.isCollapse,pivotTableName:e.Cj}));k=!0}finally{i.Mz(j,!0)}}return k},b}(v),d.Commands[ga]={canUndo:!0,execute:function(a,b,c){return x(a,Ia,b,c)}},Ja=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this,y=!1;if(x.canExecute())if(a=x.VQ,b=x.kj,c=b.ITa,f=a.cmdOption,h=f.isSusPaint,i=f.fieldName,j=f.checked,k=f.pivotName,l=b.pivotTables&&b.pivotTables.get(k),m=void 0,n=h?l.Vyc.copyFieldsModel:l.Vyc,o=void 0,h)j?o=n.CDc(i):n.BDc(i),n.syc(h);else{c.startTransaction(),x.Lz(b,!0);try{if(j)o=n.CDc(i),p=n.qo.getPivotCacheByName(n.iyc).HL,q=p[i].ny,m=q===g.PivotDataType.number?{pivotArea:e.PivotTableFieldType.valueField,pivotIndex:n.ryc(e.PivotTableFieldType.valueField).length-1}:l.getField(i),b.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:o&&o.Cj,oldArea:la,oldIndex:la,newArea:m.pivotArea,newIndex:m.pivotIndex,pivotTableName:l.Cj});else{for(r=void 0,s=[],t=e.PivotTableFieldType.valueField;t>=e.PivotTableFieldType.filterField;t--)for(r=n.ryc(t),u=r.length-1;u>=0;u--)r[u].Zxc===i&&s.unshift(l.getField(r[u].Cj));for(n.BDc(i),v=0;v<s.length;v++)m=s[v],b.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:m.fieldName,sourceName:i,oldArea:m.pivotArea,oldIndex:m.pivotIndex,newArea:la,newIndex:la,pivotTableName:l.Cj})}n.syc(h),y=!0}finally{x.Mz(b,!0),w=d.Commands.bWa(b.name()),x.VQ[w]=c.endTransaction()}}return y},b.prototype.undo=function(){var a,b,c,e,f,g=this,h=g.kj,i=!1;if(g.canUndo()){g.Lz(h,!0);try{for(a=d.Commands.bWa(h.name()),b=g.VQ[a],h.ITa.undo(b),c=b.pivotTableChanges,e=0;e<c.length;e++)f=c[e].value,"removeField"===f.type?h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,oldArea:f.area,oldIndex:f.index,newArea:la,newIndex:la,pivotTableName:g.VQ.cmdOption.pivotName}):h.Wq(d.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f.fieldName,oldArea:la,oldIndex:la,newArea:f.area,newIndex:f.index,pivotTableName:g.VQ.cmdOption.pivotName});i=!0}finally{g.Mz(h,!0)}}return i},b}(v),d.Commands[G]={canUndo:!0,execute:function(a,b,c){return x(a,Ja,b,c)}},Ka=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i,j=this,k=!1;if(j.canExecute()){a=j.VQ,b=j.kj,c=b.ITa,c.startTransaction(),j.Lz(b,!0);try{e=a.cmdOption,f=e.fieldsInfo,g=b.pivotTables&&b.pivotTables.get(e.pivotName),h=g.Vyc,h.tBJ(f),k=!0}finally{j.Mz(b,!0),i=d.Commands.bWa(b.name()),j.VQ[i]=c.endTransaction()}}return k},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[ia]={canUndo:!0,execute:function(a,b,c){return x(a,Ka,b,c)}};function Wa(a){return!isNaN(parseFloat(a))&&isFinite(a)}function Xa(a){var b,c,d,e,f,g=0;for(b=0;b<a.sheets.length;b++)for(c=a.sheets[b].tables.all(),d=0;d<c.length;d++)e=c[d].name(),e&&e.length>5&&"table"===e.substring(0,5).toLowerCase()&&(f=e.substring(5,e.length),Wa(f)&&+f>=g&&(g=+f));return"Table"+(g+1)}La=function(a){Ma(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,e,f,g,h,i=this,j=!1;if(i.canExecute()){a=i.VQ,b=i.kj,c=b.ITa,c.startTransaction(),i.Lz(b,!0);try{e=a.cmdOption,f=e.name,g=e.views,g.apply(f),b.Wq(d.Events.PivotTableChanged,{type:"viewChanged",viewName:f,pivotTableName:e.pivotName}),j=!0}finally{i.Mz(b,!0),h=d.Commands.bWa(b.name()),i.VQ[h]=c.endTransaction()}}return j},b.prototype.undo=function(){var a,b,c=this,e=c.kj,f=!1;if(c.canUndo()){c.Lz(e,!0);try{a=d.Commands.bWa(e.name()),b=c.VQ[a],e.ITa.undo(b),e.Wq(d.Events.PivotTableChanged,{type:"viewChanged",pivotTableName:c.VQ.cmdOption.pivotName}),f=!0}finally{c.Mz(e,!0)}}return f},b}(v),d.Commands[Z]={canUndo:!0,execute:function(a,b,c){return x(a,La,b,c)}},d.Commands[ca]={canUndo:!1,execute:function(a,b,c){var e,f,h,i,j,k,l,m=d.Commands.bT(a,b),n=b.commandOptions,o=m.pivotTables.get(n.pivotTableName),p=n.pivotTableCellInfo,q=p.rowInfos,r=p.colInfos;e=q&&r?q.concat(r):q?q:r?r:[],f=[],h=0,g.Yxc(e,function(a){a.fieldName!==u().sigmaValue&&(f[h]={fieldName:a.fieldName,fieldItem:a.itemName},h++)}),i=o.getPivotDetails(f),j=m.getParent(),j&&(k=new d.Worksheet,k.setRowCount(i.length>200?i.length:200),k.setColumnCount(i[0].length>20?i[0].length:20),k.setArray(0,0,i),l=Xa(j),k.tables.add(l,0,0,i.length,i[0].length),j.addSheet(j.getActiveSheetIndex(),k))}},d.Commands[L]={canUndo:!1,execute:function(a,b){var c,e,g=d.Commands.bT(a,b),h=b.cmdOption,i=h.fieldName,j=h.pivotName,k=h.commandName,l=h.host,m=h.position,n=h.filterDialog,o=[],p=g.pivotTables&&g.pivotTables.get(j),q=p.Vyc,r=q.IUJ.get(i);if("ValueFilter"===k)c=new f.PivotValuesDialog(l,q,j,i,la,la,n),r&&r.valueFilter&&(3===r.valueFilter.condition.uBc?o.push(8):o.push(r.valueFilter.condition.QBc));else{switch(q.bGc(i)){case 0:c=new f.PivotNumberFilter(l,q,j,i,la,la,n);break;case 2:c=new f.PivotDateFilterDialog(l,q,j,i,la,la,n);break;default:c=new f.PivotStringFilterDialog(l,q,j,i,la,la,n)}r&&r.labelFilter&&r.labelFilter.condition&&(e=2===r.labelFilter.condition.uBc?r.labelFilter.condition.QBc+6:r.labelFilter.condition.QBc,o.push(e))}c.OT(m,{existed:o,dataType:1})}},d.Commands[M]={canUndo:!1,execute:function(a,b,c){var e,i,j,k,l,m,n,o,p,q,r,s=b.cmdOption,t=d.Commands.bT(a,b);g.Fa(s)?(n=b.commandOptions,m=t.pivotTables.get(n.pivotTableName),o=n.pivotTableCellInfo,e=m.Vyc,i=Qa(o),j=m.name(),p=m.labelFilter(i),q=p&&p.conditionInfo&&p.conditionInfo.QBc,l=q||0):(i=s.fieldName,j=s.pivotName,l=s.command,m=t.pivotTables.get(j),e=m.Vyc),r=e.bGc(i),r===g.PivotDataType.date?(k=u().getDateLabelFilterItemText(),new h.DateFilterDialog(document.body,k,e,i,j,(+l))):(k=u().getStringLabelFilterItemText(),new f.LabelFilter(document.body,k,e,i,j,(+l)))}},d.Commands[E]={canUndo:!1,execute:function(a,b,c){var g,h,i,j=d.Commands.bT(a,b),k=b.cmdOption,l=k.position,m=k.fieldName,n=k.pivotName,o=j.pivotTables.get(n),p=o.Vyc,q=p.getFieldInfoByName(m),r=p.oyc[m],s=Na(p,q,m,h,n,r);return r===e.PivotTableFieldType.filterField?(g=24,h=!1):(g=30,r!==e.PivotTableFieldType.valueField&&(h=!0)),s.isColOrRow=h,i=new f.PivotFilterDialog(document.body,p,n),i.init(g,m,l,s),!0}},d.Commands[D]={canUndo:!1,execute:function(a,b){var c,e,f,h,j,k,l,m,n,o=b.cmdOption,p=d.Commands.bT(a,b);return g.Fa(o)?(k=b.commandOptions,l=k.pivotTableCellInfo,j=p.pivotTables.get(k.pivotTableName),c=j&&j.Vyc,e=Qa(l,c),f=k.pivotTableName,h=j&&j.SNc):(j=p.pivotTables.get(o.pivotName),e=o.fieldName,f=o.pivotName,c=j&&j.Vyc,h=j&&j.SNc),m=c.getFieldInfoByName(e),n=c.wYJ(m.Zxc),new i.PivotDimFieldSettingDialog(c,e,f,h,n).Ao(),!0}},d.Commands[N]={canUndo:!1,execute:function(a,b,c){var e,g,h,i,j,k,l,m,n,o,p=d.Commands.bT(a,b),q=na(p,b.row,b.col),r=q.pivotInfo,s=q.pt;if(r){switch(e=r.area,g=void 0,e){case 0:g=r.pageFieldInfo;break;case 1:g=r.cornerFieldInfo;break;case 2:g=r.colHeadFieldInfo}if(!g)return!1;h=g.fieldName,i=g.isCompactRoot,j=p.getCellRect(b.row,b.col),k=s.Vyc,j.y+=j.height,l=Na(k,k.getFieldInfoByName(h),h,!0,s.Cj,k.oyc[h]),m=0,0===r.area?m=24:(m=30,i&&(n=void 0,1===r.area&&(n=k.jyc.length),2===r.area&&(n=k.kyc.length),n>1&&(m+=1),l.areaFieldName=k.ryc(r.area).map(function(a){return a.Cj}))),o=new f.PivotFilterDialog(p.parent&&p.parent.pZJ(),s.Vyc,s.getName()),o.init(m,h,j,l)}return!0}},d.Commands[F]={canUndo:!1,execute:function(a,b){var c,e=d.Commands.bT(a,b),f=b.cmdOption,g=f.fieldName,h=f.configurationNumber,i=f.position,j=f.filterDialog,k=f.pivotName,l=e.pivotTables.get(k),m=l.Vyc,n=m.getFieldInfoByName(g),o=[],p=m.oyc[g],q=m.ryc(p);return q.forEach(function(a){o.push(a.Cj)}),o.splice(o.indexOf(g),1),o.unshift(g),c=Na(m,n,g,!0,null,p),c.areaFieldName=o,j.init(h,g,i,c),!0}},d.Commands[P]={canUndo:!1,execute:function(a,b,c){var e,f,i,j,k,l,m,n,o,p,q,r,s,t=b.cmdOption,v=d.Commands.bT(a,b);if(g.Fa(t)){if(n=b.commandOptions,m=v.pivotTables&&v.pivotTables.get(n.pivotTableName),o=n.pivotTableCellInfo,l=n.isTop10,e=m.Vyc,0===e.ryc(3).length)return v.Os(10,u().EmptyValueFieldError),!1;f=Qa(o),i=m.name(),j=u().getValueFilterItemText(),l||(p=m.valueFilter(f),q=p&&p.conditionInfo&&p.conditionInfo.QBc,k=q||0)}else{if(f=t.fieldName,i=t.pivotName,j=t.content,k=t.command,m=v.pivotTables.get(i),e=m.Vyc,0===e.ryc(3).length)return v.Os(10,u().EmptyValueFieldError),!1;"Top10"===k&&(l=!0)}r=e.ryc(3),s=[],r.forEach(function(a){s.push(a.Cj)}),new h.ValueFilter(document.body,j,s,e,f,i,(+k),l)}},d.Commands[T]={canUndo:!1,execute:function(a,b){var c,e,f,h,j,k,l,m=b.cmdOption,n=d.Commands.bT(a,b);return g.Fa(m)?(k=b.commandOptions,l=k.pivotTableCellInfo,j=n.pivotTables.get(k.pivotTableName),c=j&&j.Vyc,e=Qa(l,c),f=k.pivotTableName,h=j.SNc):(f=m.pivotName,j=n.pivotTables.get(f),c=j.Vyc,e=m.fieldName,h=j.SNc),new i.PivotValuesFieldSettingDialog(c,e,f,h).Ao(),!0}},d.Commands[X]={canUndo:!1,execute:function(a,b){var c,e,f,h,i,j,m,n,o,p,q,r,s,t,u,v,w=d.Commands.bT(a,b),x=b.commandOptions,y=w.pivotTables.get(x.pivotTableName);if(y)if(c=x.pivotTableCellInfo,e=c.activeRowFieldInfo,f=c.activeColFieldInfo,h=e&&e.name||f&&f.name,i=y.getGroupInfo(h),j=y.getField(h),m=y.Vyc,n=x.selections||w.getSelections(),o=1===n.length&&1===n[0].rowCount&&1===n[0].colCount,j.dataType===g.PivotDataType.number&&o){if(p=Ra(j,i),!g.Fa(p))return q=new k.PivotNumberGroupDialog(document.body,x.pivotTableName,h,m,j.start,p.start,j.end,p.end,p.by),q.Ao(),!0}else if(j.dataType===g.PivotDataType.date&&o){if(r=Sa(j,i),!g.Fa(r))return s=b.activeRow||w.getActiveRowIndex(),t=b.activeCol||w.getActiveColumnIndex(),u=w.getActualStyle(s,t)&&w.getActualStyle(s,t).formatter,v=new l.PivotDateGroupDialog(document.body,x.pivotTableName,h,m,j.start,r.start,j.end,r.end,r.by,n,u),v.Ao(),!0}else w.wu().execute({cmd:"pivotTableGroup",sheetName:w.name(),commandOptions:x,selections:n})}},d.Commands[Y]={canUndo:!1,execute:function(a,b){var c=d.Commands.bT(a,b),e=b.commandOptions,f=c.pivotTables.get(e.pivotTableName),g=e.pivotTableCellInfo,h=f&&f.Vyc,i=Qa(g,h),k=e.pivotTableName,l=e.showValueAsType;return new j.PivotShowValueAsDialog(document.body,h,i,k,g,l),!0}},d.Commands[K]={canUndo:!1,execute:function(a,b){var c=b.cmdOption,e=d.Commands.bT(a,b),f=e.parent;try{f.kLc(c.pivotCacheName,c.pivotCache,c.gBJ)}catch(a){p.throwError(u().NoHaveSpread)}}},d.Commands[_]={canUndo:!1,execute:function(a,b){var c=d.Commands.bT(a,b),e=b.commandOptions,f=c.pivotTables.get(e.pivotTableName);g.Fa(f)||f.updateSource()}},d.Commands[W]={canUndo:!1,execute:function(a,b){var c=b.cmdOption,d=c.position,e=c.views,g=c.width,h=new f.PivotViewListDialog(document.body,e,g);h.init(d)}},d.Commands[$]={canUndo:!1,execute:function(a,b){var c=b.cmdOption,d=c.name,e=c.views;return!e.save(d)&&(Ya(d,e),!0)}};function Ya(a,b){var c,d=a.split(q.nameSeparator);isNaN(parseInt(d[d.length-1],10))?a+=q.nameSeparator+"1":(c=d[d.length-1],d.splice(d.length-1,1,q.nameSeparator+(parseInt(c,10)+1)),a=d.join("")),b.save(a)||Ya(a,b)}function Za(a,b){return a.sheets?d.VCJ(a,b.sheetName):a}d.Commands[ja]={canUndo:!1,execute:function(a,b,c){var d,e,f,g,h,i,j,k,l=Za(a,b),m=l.getSelections();if(1===m.length&&!l.isEditing())for(d=m[0],e=l.pivotTables.all(),f=0;f<e.length;f++)if(g=e[f],h=g.getRange(),i=h.page,j=h.content,k=i?i.union(j):j,i&&i.containsRange(d)||j&&j.containsRange(d)){l.setSelection(k.row,k.col,k.rowCount,k.colCount);break}}},d.Commands.VCc=function(a){var b=d.Ul.sl(),c=!b,e=b;a.register(w,d.Commands[w]),a.register(A,d.Commands[A]),a.register(B,d.Commands[B]),a.register(D,d.Commands[D]),a.register(C,d.Commands[C]),a.register(E,d.Commands[E]),a.register(Z,d.Commands[Z]),a.register($,d.Commands[$]),a.register(W,d.Commands[W]),a.register(F,d.Commands[F]),a.register(H,d.Commands[H]),a.register(I,d.Commands[I]),a.register(J,d.Commands[J]),a.register(L,d.Commands[L]),a.register(M,d.Commands[M]),a.register(O,d.Commands[O]),a.register(P,d.Commands[P]),a.register(Q,d.Commands[Q]),a.register(R,d.Commands[R]),a.register(S,d.Commands[S]),a.register(N,d.Commands[N]),a.register(X,d.Commands[X]),a.register(T,d.Commands[T]),a.register(V,d.Commands[V]),a.register(U,d.Commands[U]),a.register(G,d.Commands[G]),a.register(_,d.Commands[_]),a.register(K,d.Commands[K]),a.register(ia,d.Commands[ia]),a.register(ha,d.Commands[ha]),a.register(aa,d.Commands[aa]),a.register(ba,d.Commands[ba]),a.register(da,d.Commands[da]),a.register(ea,d.Commands[ea]),a.register(fa,d.Commands[fa]),a.register(ga,d.Commands[ga]),a.register(ca,d.Commands[ca]),a.register(Y,d.Commands[Y]),a.register(ja,d.Commands[ja],65,c,!1,!1,e)}},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("Core"),g=c("./dist/plugins/pivot/pivot-panel/pivot-widget.js"),h=c("@grapecity/js-sheets-common"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=c("./dist/plugins/pivot/pivot-util.js"),k=h.Common.j.Fa,l=null,m=Math.max,n=new h.Common.ResourceManager(i.SR,"PivotTables"),o=n.getResource.bind(n),p=f.GC$,q="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bWludXMxNjwvdGl0bGU+CiAgICA8ZyBpZD0ibWludXMxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMCIgeT0iMCIgd2lkdGg9IjExIiBoZWlnaHQ9IjExIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAgTDExLDAgTDExLDExIEwwLDExIEwwLDAgWiBNMSwxIEwxLDEwIEwxMCwxMCBMMTAsMSBMMSwxIFoiIGlkPSLnn6nlvaIiIGZpbGw9IiNBQkFCQUIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiB4PSIzIiB5PSI1IiB3aWR0aD0iNSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cGx1czE2PC90aXRsZT4KICAgIDxnIGlkPSJwbHVzMTYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLnvJbnu4TlpIfku70tMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMy4wMDAwMDAsIDMuMDAwMDAwKSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNGRkZGRkYiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSI+PC9yZWN0PgogICAgICAgICAgICA8cGF0aCBkPSJNMCwwIEwxMSwwIEwxMSwxMSBMMCwxMSBMMCwwIFogTTEsMSBMMSwxMCBMMTAsMTAgTDEwLDEgTDEsMSBaIiBpZD0i55+p5b2iIiBmaWxsPSIjQUJBQkFCIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTYsMyBMNiw1IEw4LDUgTDgsNiBMNS45OTksNiBMNiw4IEw1LDggTDQuOTk5LDYgTDMsNiBMMyw1IEw1LDUgTDUsMyBMNiwzIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",b.zzc=function(a,b,c,d,e,f,g){var h;return e&&(h=e[g]),a.yFJ(b,c,d,h,f,g)},s=function(){function a(){}return a.Azc=function(a,b){var c,f,g,h,i,j,k,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=!0,P=a.pivotTables.get(b);if(P){for(g=P.Bzc(),c=P.ys,f=P.Fyc(),i=c.szc,j=i[0],k=i[1],m=i[2],n=i[3],p=i[4],q=P.Czc(),r=q.length,s=P.Dzc(),t=P.Vyc.zZ,u=s.length,v=q.length,w=P.options,x=w.subTotalsPosition,y=x===e.SubtotalsPosition.top||x===e.SubtotalsPosition.bottom,z=P.Ezc(),A=P.Vyc.getSigmaValuePosition(),E=P.YBc(),B=E.al,C=E.KW,D=E,F=[],G={},d.Yxc(g,function(a){var b=P.Vyc.oIJ(a.Zxc),c=b&&b.Yw?d.SubtotalType.sum:a.fyc,e={name:a.Cj,subtotalText:d.SubtotalType[c],subtotalType:c,cacheName:a.Zxc,hasShowDataAs:!(!D.zFJ[a.Cj]||D.zFJ[a.Cj].showDataAs===d.PivotShowDataAs.normal)};F.push(e),G[a.Cj]=e}),H=0,I=-1,J=-1,F.length>1&&(A.positionType===d.DataPosition.col?I=A.positionIndex:J=A.positionIndex),K=[],q.forEach(function(a){K.push(a.Cj)}),I>=0&&K.splice(I,l,o().Values),L={},M=0;M<K.length;M++)L[K[M]]=M;return N={},[].concat(z,q,s).forEach(function(a){var b=P.Vyc.oIJ(a.Zxc);d.isEmptyObject(b.Eyc)&&d.isEmptyObject(b.aGc)||(N[a.Cj]=b.getFieldsItemList()||[])}),P.qMc=N,P.pCJ=u+(J>-1?1:0),P.qCJ=v+(I>-1?1:0),P.options.showHeaders?O=!1:1===g.length?0===s.length&&0!==q.length||(O=!1):g.length>1&&0===q.length&&I>-1&&(O=!1),m.isHideFirstRow=O,h=P.options.showHeaders,{sharedMap:N,repeatValueFiledChildLength:H,rowDeep:u,rowFields:s,colFields:q,hasColumnSubTotal:y,fieldMap:f,pageModel:j,cornerModel:k,columnModel:m,rowModel:n,contentModel:p,options:w,pageFields:z,valuePositionInfo:A,valueFieldsInfo:F,columnValuePosition:I,rowValuePosition:J,columnDeep:r,rootNode:B,headerNode:C,subtotalCollection:D,valueFieldsMap:G,pt:P,sortInfo:t,columnFieldsIndexes:K,colFieldsMap:L,isHideFirstRow:O,showHeaders:h}}},a.render=function(a){var b=this.Azc(a.qo,a.Cj);b&&(this.Fzc(b),this.Gzc(b),this.Hzc(b),this.JLc(a,b.rowModel),this.KLc(b),this.Jzc(b),a.EZ(),this.AFJ(b),b=null)},a.AFJ=function(a){delete a.rootNode,delete a.headerNode,a.subtotalCollection.no(),delete a.subtotalCollection},a.Lzc=function(a,b,c){k(c.rowHeaderLevel)?c.aN=c.grandTotalLevel:c.aN=c.rowHeaderLevel,a.lzc[b]=c},a.recalcFormula=function(a){var b=a.qo;b&&(b.suspendPaint(),b.getCalcService().recalculateAll(!1,!1),b.resumePaint())},a.hHJ=function(a){var b,c,e,f,g,h,i,l,m=a.sharedMap,n=a.rowFieldsIndexes,p=a.rowModel,q=p.lzc,r=q.length,s=a.rowValuePosition,t=a.rowFieldsIndexes.length;for(p.INc={},b=0;b<r;b++)if(c=q[b],c&&(e=c.path,!k(e)&&""!==e&&!c.isBlankRow&&!c.isSubtotal))for(f=e.split(d.Separator),a.valuePositionInfo.display&&a.valuePositionInfo.positionType===d.DataPosition.row&&!k(c.valueFieldName)&&f.splice(s,null,c.valueFieldName),g=0,h=f.length;g<h;g++)i=n[g],l=f[g],p.JNc(b,i,i!==o().Values?j.Kzc(m,i,l):l,t-g)},a.sNc=function(a,b,c,d){a.push({path:b,isBlankRow:!0}),c.push([]),d.push([])},a.JLc=function(a,b){var c,f,g,h,i,j,k,l,m,n,o,p,q,r;if(a.options.mergeItem&&a.layoutType()===e.PivotTableLayoutType.tabular){c=a.MLc.LLc,f=b.OZ,g=b.dataTable,h=b.lzc,i=b.INc,d.Yxc(g,function(a,b){var d,e=h[b];(e.isBlankRow||e.isSubtotal||e.isGrandTotal)&&(d=e.isBlankRow?g[b-1].length-1:a.length-1,c.push({row:b,col:d,rowCount:1,colCount:f-d}))});for(j in i)if(i.hasOwnProperty(j)){k=i[j];for(l in k)if(k.hasOwnProperty(l)&&(m=k[l],n=m.ranges,o=m.level,o>1&&f-o>-1&&n.length>1)){for(p=n[0],q=p,r=1;r<n.length;r++)n[r]-n[r-1]===1?q+=1:(q-p>0&&c.push({
row:p,col:f-o,rowCount:q-p+1,colCount:1}),p=n[r],q=p);q-p>0&&c.push({row:p,col:f-o,rowCount:q-p+1,colCount:1})}}}},a.KLc=function(a){var b,c,e,f,g,h,i,j,l,m,n,o,p,q,r,s,t=a.pt,u=a.columnModel,v=a.isHideFirstRow;if(t.options.mergeItem){b=t.MLc.NLc,c=u.Xj-1,e=v?c+1:c,f=this.twoDimensionalArraySpin(u.dataTable),g=u.mzc,h=u.INc,i=v?0:1,d.Yxc(f,function(a,d){var e,f=g[d];k(f)||f.isBlankColumn||(f.isSubtotal||f.isGrandTotal)&&(e=a.length-1,b.push({row:e,col:d,rowCount:c-e+1,colCount:1}))});for(j in h)if(h.hasOwnProperty(j)){l=h[j];for(m in l)if(l.hasOwnProperty(m)&&(n=l[m],o=n.ranges,p=n.level,p>1&&e-p>-1&&o.length>1)){for(q=o[0],r=q,s=1;s<o.length;s++)o[s]-o[s-1]===1?r+=1:(r-q>0&&b.push({row:e-p+i,col:q,rowCount:1,colCount:r-q+1}),q=o[s],r=q);r-q>0&&b.push({row:e-p+i,col:q,rowCount:1,colCount:r-q+1})}}}},a.twoDimensionalArraySpin=function(a){var b,c,d,e,f;if(a&&0!==a.length){for(b=0,c=a.length,d=0;d<a.length;d++)a[d]&&b<a[d].length&&(b=a[d].length);if(0!==b){for(e=Array(b),d=0;d<b;d++)e[d]=[];for(d=0;d<b;d++)for(f=0;f<c;f++)a[f]&&a[f][d]&&(e[d][f]=a[f][d]);return e}}},a.Fzc=function(a){var b=this,c=a.pageFields,f=a.pageModel,g=a.pt,h=0,i=0,j=0,k=g.Vyc,m=a.options,n=m.displayFieldsInPageFilterArea,p=m.reportFilterFieldsPerColumn;n===e.DisplayFields.overThenDown?0===p?f.setRowCount(1):f.setRowCount(Math.ceil(c.length/p)):0===p?f.setRowCount(c.length):f.setRowCount(c.length>=p?p:c.length),d.Yxc(c,function(c,d){var g,m,q,r=c.Cj,s=c.Zxc,t=k.isFilter(s);n===e.DisplayFields.overThenDown?0===p?(i=0,h=3*d):(i=Math.floor(d/p),g=d%p,h=3*g):0===p?(i=d,h=0):(h=3*Math.floor(d/p),i=d%p),f.yq(i,h,r),t?(m=k.getFilterInfo(s),q=m&&m.getSlicerItemInfo(),f.yq(i,h+1,q.hasMoreThanOneSelect?o().MultipleItems:q.text)):f.yq(i,h+1,o().All),f.zn(i,h+1,b.Mzc(t,l,8,a.options.showFilter)),f.pzc(i,h+1,r),j=j<h+1?h+1:j}),f.setColCount(j+1)},a.Rzc=function(a,c,e,f,g,h,i,k){var l=this,m=a.columnModel,n=a.contentModel,p=a.columnValuePosition,q=a.rowValuePosition,r=a.valueFieldsMap,s=a.subtotalCollection,t=a.rowModel,u=a.rowDeep,v=p!==-1;v?d.Yxc(m.mzc,function(a,d){if(a){var g=a.rowPathMap,h=r[a.valueFieldName];g&&g.indexList&&g.indexList[f]&&h&&(l.BFJ(s,s.zFJ[a.valueFieldName],c,a.valueFieldName,g,a)?n.yq(e,d,j.GC_EMPTY_VALUE):n.yq(e,d,b.zzc(s,g.indexList[f],h.cacheName,h.subtotalText,c.CFJ,c.aN,a.valueFieldName)))}}):(t.JNc(e,o().Values,k,u+1-q),d.Yxc(m.mzc,function(a,d){var h=a&&a.rowPathMap;h&&h.indexList&&h.indexList[f]&&(l.BFJ(s,s.zFJ[k],c,k,h,a)?n.yq(e,d,j.GC_EMPTY_VALUE):n.yq(e,d,b.zzc(s,h.indexList[f],g,i,c.CFJ,c.aN,k)))}))},a.BFJ=function(a,b,c,e,f,g){var h,i,j,l=c.CFJ;if(l&&l[e]){if(h=l[e],k(h.minorPath)||(h.minorPath=g.path),k(h.colTotalIndex)||(h.colTotalIndex=f.indexList[""]),8===b.showDataAs||9===b.showDataAs){if(b.baseRootLevel>-1&&(b.showDataAsIndex&c.TJJ)>0)return!0;if(b.baseHeaderLevel>-1&&(b.showDataAsIndex&g.showDataAsIndex)>0)return!0}if(b.isDifferenceOrPercent)if(b.isHeaderOfPercentOrDiff){if(f.level<b.baseHeaderLevel+1)return!0;h.indexInfo.baseMinorPath=g.rowPathMap.baseSubtotalInfo[e].baseMajorPath}else{if(b.baseRootLevel+1>c.aN||c.nodeName===b.baseFieldItemShared&&b.baseRootLevel+1===c.aN)return!0;h.indexInfo.baseMinorPath=g.path}if(b.needBuildRunningTotalOrRankPath){if(c.Yzc&&b.baseRootLevel>-1)return!0;if(b.baseHeaderLevel>-1&&f.level<b.baseHeaderLevel+1)return!0;h.indexInfo.minorPath=g.path,h.indexInfo.baseMinorPath=g.rowPathMap.baseSubtotalInfo[e].baseMajorPath}if(b.showDataAs===d.PivotShowDataAs.percentOfRow&&(h.indexInfo.baseIndex=a.DFJ("").indexList[c.EFJ]),b.showDataAs===d.PivotShowDataAs.percentOfCol&&(h.indexInfo.baseIndex=f.indexList[""]),b.showDataAs===d.PivotShowDataAs.percentOfParent){if(b.baseRootLevel>-1&&c.aN<b.baseRootLevel+1)return!0;if(b.baseHeaderLevel>-1){if(b.baseHeaderLevel+1>f.level)return!0;f.level===b.baseHeaderLevel+1&&(h.indexInfo.baseIndex=f.indexList[c.EFJ]),f.level>b.baseHeaderLevel+1&&(i=g.rowPathMap.baseSubtotalInfo[e].percentOfBasePath,k(i)||(h.indexInfo.baseIndex=a.DFJ(i).indexList[c.EFJ]))}}if(b.showDataAs===d.PivotShowDataAs.index&&(h.indexInfo.rowTotalIndex=a.DFJ("").indexList[c.EFJ],h.indexInfo.colTotalIndex=f.indexList[""]),b.showDataAs===d.PivotShowDataAs.percentOfParentRow&&(h.indexInfo.minorPath=g.path),b.showDataAs===d.PivotShowDataAs.percentOfParentCol&&(h.indexInfo.baseIndex=a.DFJ(g.rowPathMap.parentPath).indexList[c.EFJ]),j=""===g.path&&b.needBuildPercentOfPath&&b.baseRootLevel===-1)return!0}},a.Szc=function(a,c,f,g,h){var i,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;if(void 0===h&&(h=""),i=a.colMap,l=a.contentModel,m=a.columnValuePosition,n=a.rowValuePosition,o=a.rowDeep,p=n!==-1,q=m!==-1,!(f.Yzc&&o>0&&a.options.grandTotalPosition!==e.GrandTotalPosition.both&&a.options.grandTotalPosition!==e.GrandTotalPosition.row||""===h&&f.aN<o)){if(r=h,q)for(""!==h&&(h+=d.Separator),s=0,t=g;s<t.length;s++)u=t[s],v=u.name,w=u.cacheName,x=u.subtotalText,y=u.hasShowDataAs,z=h+v,A=i[z],B=!1,y&&(B=this.FFJ(a.subtotalCollection,a.subtotalCollection.zFJ[v],h,f,v,r,o)),B?l.yq(c,A,j.GC_EMPTY_VALUE):l.yq(c,A,b.zzc(a.subtotalCollection,f.GFJ,w,x,f.CFJ,f.aN,v));if(p&&(A=i[h],!k(A)))for(C=c,D=0,E=g;D<E.length;D++)F=E[D],G=F.name,w=F.cacheName,x=F.subtotalText,y=F.hasShowDataAs,H=!1,y&&(H=this.FFJ(a.subtotalCollection,a.subtotalCollection.zFJ[G],h,f,G,r,o)),H?l.yq(C,A,j.GC_EMPTY_VALUE):l.yq(C,A,b.zzc(a.subtotalCollection,f.GFJ,w,x,f.CFJ,f.aN,G)),C++;if(!p&&!q&&1===g.length){if(I=g[0],J=I.name,w=I.cacheName,x=I.subtotalText,y=I.hasShowDataAs,""!==h&&(h+=d.Separator),A=i[h+J],k(A))return;K=!1,y&&(K=this.FFJ(a.subtotalCollection,a.subtotalCollection.zFJ[J],h,f,J,r,o)),K?l.yq(c,A,j.GC_EMPTY_VALUE):l.yq(c,A,b.zzc(a.subtotalCollection,f.GFJ,w,x,f.CFJ,f.aN,J))}}},a.FFJ=function(a,b,c,e,f,g,h){return b.needBuildRunningTotalOrRankPath&&b.baseHeaderLevel>-1&&(e.CFJ[f].indexInfo.minorPath=g),(8===b.showDataAs||9===b.showDataAs)&&(b.showDataAsIndex&e.TJJ)>0||(b.showDataAs===d.PivotShowDataAs.percentOfRow&&e.aN<=h&&(e.CFJ[f].indexInfo.baseIndex=a.HFJ(e.EFJ,!1)),b.showDataAs===d.PivotShowDataAs.index&&e.aN<=h&&(e.CFJ[f].indexInfo.rowTotalIndex=a.HFJ(e.EFJ,!1)),!!(b.isDifferenceOrPercent&&b.baseHeaderLevel>-1&&e.aN<b.actualBaseLevel)||(""===c&&b.showDataAs===d.PivotShowDataAs.percentOfParent&&b.baseRootLevel===-1||(b.baseHeaderLevel>-1&&e.aN<b.actualBaseLevel||(!!(e.Yzc&&b.needBuildRunningTotalOrRankPath&&b.baseRootLevel>-1)||!!(""===c&&b.needBuildRunningTotalOrRankPath&&b.baseHeaderLevel>-1&&b.actualBaseLevel===e.aN)))))},a.Gzc=function(a){var b,c,f,g,h,i,j=a.columnModel,k=a.valueFieldsInfo,l=a.headerNode,n=a.hasColumnSubTotal,p=a.colFields,q=a.columnValuePosition,r=a.columnDeep,s=a.isHideFirstRow,t=a.showHeaders,u=a.pt,v=l.Tzc+(s?0:1),w=n?l.Uzc+l.kEc+l.iOc:l.Uzc+l.iOc,x=a.options.grandTotalPosition;if(x!==e.GrandTotalPosition.both&&x!==e.GrandTotalPosition.row?n&&(w-=a.columnValuePosition===-1?1:a.valueFieldsInfo.length,w=m(w,0)):n||(w+=a.columnValuePosition===-1?1:a.valueFieldsInfo.length),0===p.length&&(w=l.Uzc+l.iOc),b=k.length,0===r&&0===b&&(w=0),c=a.columnFieldsIndexes.length,w<c){for(f=w;f<c;f++)j.mzc[f]={path:"",isBlankColumn:!0};w=c}q!==-1&&r>0&&(v+=1),j.setColCount(w),a.contentModel.setColCount(w),j.setRowCount(v),g={},h=[],i=r?1:0,r>0&&(t&&this.Wzc(j,p,q,a),d.Yxc(p,function(a){h.push({name:a.Cj,isFilter:u.Vyc.isFilter(a.Zxc),isDim:!0,sortInfo:a.zZ})})),q!==-1&&h.splice(q,0,{name:o().Values,isFilter:!1,isDim:!1}),d.Yxc(h,function(a,b){var c=a.name;g[c]=b+i}),a.columnHeaderRowMap=g,this.Xzc(a,l,r>0?1:0,0,k),s&&j.dataTable.splice(0,1),a.colMap=j.getColInfoMap()},a.NFc=function(a,b){var c,d,f=a.options,g=f.subTotalsPosition,h=f.grandTotalPosition,i=g!==e.SubtotalsPosition.none?b.Uzc+b.kEc+b.iOc:b.Uzc+b.iOc;return b.Yzc&&(0===a.colFields.length&&(i=b.Uzc+b.iOc),c=g!==e.SubtotalsPosition.none,d=h!==e.GrandTotalPosition.none&&h!==e.GrandTotalPosition.col,a.columnDeep>0&&(c&&!d?i-=a.columnValuePosition===-1?1:a.valueFieldsInfo.length:d&&!c&&(i+=a.columnValuePosition===-1?1:a.valueFieldsInfo.length))),i},a.Xzc=function(a,b,c,d,g){var h,i,l,m,n,p,q,r,s,t,u=a.columnModel,v=a.columnDeep,w=a.columnValuePosition,x=a.sharedMap,y=a.columnHeaderRowMap,z=a.colFields,A=b.nodeName,B=b.aN,C=b.Yzc,D=b.Zzc,E=b.xzc,F=b.Pzc,G=1,H=a.options.subTotalsPosition!==e.SubtotalsPosition.none,I=a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.col;if(w!==-1&&w>=B&&(G=g.length),h=j.Kzc(x,E,A),i=a.pt.collapse(E,h)&&B!==v,u.yq(c,d,h),l=d,D){for(m=y[o().Values],C||0===w||(u.yq(m-1,d,h),F&&F.length>0&&B<v&&a.options.showDrill&&u.zn(m-1,d,this.aAc(i,f.ButtonPosition.leftOfText))),n=0,p=g;n<p.length;n++)q=p[n],u.yq(m,l,q.name),C&&0===v&&u.JNc(l,o().Values,q.name,z.length-w+1),l+=i?1:this.OFc(a,b,m+1,l,[q]);if(i)return this.PFc(a,b,m,l-G,g,m),B===v&&0!==v&&this.QFc(a,u,l,b,w,v,g),G}else{if(r=y[E],k(r))r=0;else if(u.yq(r,l,h),F&&F.length>0&&B<v&&a.options.showDrill&&u.zn(r,l,this.aAc(i,f.ButtonPosition.leftOfText)),i)return this.PFc(a,b,r,l,g,r),B===v&&0!==v&&this.QFc(a,u,l,b,w,v,g),G;this.OFc(a,b,r+1,l,g)}return s=this.NFc(a,b)||G,t=d+s-G,B===v&&0!==v&&this.QFc(a,u,t,b,w,v,g),(H||C&&I||!v&&g.length)&&this.PFc(a,b,y[E]||1,t,g),s},a.QFc=function(a,b,c,d,e,f,g){var h,i,j,k=a.columnFieldsIndexes,l=a.colFieldsMap,m=e!==-1;if(m)for(h=0,i=g.length;h<i;h++)j=g[h],b.mzc[c+h]={path:d.$zc,valueFieldName:j.name,grandTotalLevel:d.aN,showDataAsIndex:d.TJJ,rowPathMap:a.subtotalCollection.DFJ(d.EFJ)},this.JNc(b,c+h,a.sharedMap,d.$zc,d.aN,e,k,l,j.name,!1);else b.mzc[c]={path:d.$zc,grandTotalLevel:d.aN,showDataAsIndex:d.TJJ,rowPathMap:a.subtotalCollection.DFJ(d.EFJ)},this.JNc(b,c,a.sharedMap,d.$zc,d.aN,e,k,l,g&&g[0]&&g[0].name,!1)},a.JNc=function(a,b,c,e,f,g,h,i,k,m){var n,p,q,r,s=e.split(d.Separator);for(g>=0&&g<=f&&(n=i[o().Values],s.splice(n,l,k)),p=h.length,q=0,r=m?s.length-1:s.length;q<r;q++)a.JNc(b,h[q],j.Kzc(c,h[q],s[q]),p-q)},a.PFc=function(a,b,c,f,g,h){var i,l,m,n,p,q,r,s,t,u,v=a.columnModel,w=a.columnDeep,x=a.columnValuePosition,y=a.sharedMap,z=a.columnHeaderRowMap,A=a.columnFieldsIndexes,B=a.colFieldsMap,C=g.length,D=b.Yzc,E=b.aN,F=b.nodeName,G=b.$zc,H=b.xzc,I=a.options.grandTotalPosition;if(!(D&&w>0&&I!==e.GrandTotalPosition.both&&I!==e.GrandTotalPosition.row||E>w-1&&0!==w))if(l=j.Kzc(y,H,F),m=a.pt.collapse(H,l),n=z[o().Values],E<=x)for(D?(c=1,0===w&&(c=0)):c=z[H],p=f,q=0;q<C;q++)r=g[q].name,i=0===w?m?l:D?r:l+" "+r:m?l:D?o().Total+" "+r:l+" "+r,m&&0===q?v.yq(c,p+q,i):m||v.yq(c,p+q,i),m&&v.yq(n,p+q,r),s={path:G,valueFieldName:r,grandTotalLevel:E,showDataAsIndex:b.TJJ,rowPathMap:a.subtotalCollection.DFJ(b.EFJ)},G&&E<w&&v.JNc(p+q,o().Values,r,w+1-E),k(h)||(s.collapseIndex=h-1),D?0===x&&0===w||(s.isGrandTotal=!0):s.isSubtotal=!0,v.mzc[p+q]=s;else t=f,0===w&&x===-1?(i=g[0]&&g[0].name||"",c=0):i=m?l:D?o().GrandTotal:l+o().Total,a.valuePositionInfo.display&&a.valuePositionInfo.positionType===d.DataPosition.row&&0===w&&(i=""),v.yq(c,t,i),u=void 0,1===g.length&&(u=g[0].name),s={path:G,valueFieldName:u,grandTotalLevel:E,showDataAsIndex:b.TJJ,rowPathMap:a.subtotalCollection.DFJ(b.EFJ)},G&&this.JNc(v,t,a.sharedMap,b.$zc,b.aN,x,A,B,g&&g[0]&&g[0].name,!0),k(h)||(s.collapseIndex=h-1),D?s.isGrandTotal=!0:s.isSubtotal=!0,v.mzc[t]=s},a.nDc=function(a,b,c){return a<b&&c<=1||a+1<b&&c>1?void 0:b},a.Wzc=function(a,b,c,e){var f=this,g=[],h=e.pt.Vyc;d.Yxc(b,function(a){g.push({name:a.Cj,isFilter:h.isFilter(a.Zxc),isDim:!0,sortInfo:a.zZ})}),c!==-1&&g.splice(c,0,{name:o().Values,isFilter:!1,isDim:!1}),d.Yxc(g,function(b,c){var d=b.name,g=b.isDim,h=b.isFilter,i=b.sortInfo;a.yq(0,c,d),g&&a.zn(0,c,f.Mzc(h,i,24,e.options.showFilter)),a.ozc(c,{isCompactRoot:!1,fieldName:d})})},a.OFc=function(a,b,c,d,f){var g,h,i,j,k,l,m,n,o=a.columnDeep,p=a.options,q=a.columnModel,r=d,s=b.Pzc,t=0;if(s.length>0&&b.aN<o)for(g=p.fillDownLabels,h=void 0,i=p.subTotalsPosition===e.SubtotalsPosition.none?0:1,j=void 0,k=void 0,l=void 0,m=void 0,m=0;m<s.length;m++){if(h=1,j=s[m],k=this.Xzc(a,j,c,r,f),l=k-i,g)for(n=q.ge(c,r),h;h<l;h++)q.yq(c,h+r,n);r+=k,t+=k}return b.aN>=o&&(t=1),t},a._zc=function(a,b,c,d,e){var f,g,h,i,k,l,m,n,p,q=a.valueFieldsInfo,r=a.columnModel,s=a.columnDeep,t=a.columnValuePosition,u=a.sharedMap,v=q.length,w=d.Yzc,x=d.aN,y=d.nodeName,z=d.$zc,A=d.xzc;if(!(x>s-1&&0!==s))if(g=j.Kzc(u,A,y),h=a.pt.collapse(A,g),e&&x<=t)for(i=h?c:c+(d.Uzc+d.Vzc-1)*v,k=0;k<v;k++)l=q[k].name,f=0===s?h?g:w?l:g+" "+l:h?g:w?o().Total+" "+l:g+" "+l,r.yq(b,i+k,f),m={path:z,valueFieldName:l,grandTotalLevel:x,showDataAsIndex:d.TJJ,rowPathMap:a.subtotalCollection.DFJ(d.EFJ)},w?m.isGrandTotal=!0:m.isSubtotal=!0,r.mzc[i+k]=m;else n=h?c:c+d.Uzc+d.kEc-1,f=0===s?q[0]&&q[0].name||"":h?g:w?o().GrandTotal:g+o().Total,r.yq(b,n,f),p=void 0,1===q.length&&(p=q[0].name),m={path:z,valueFieldName:p,grandTotalLevel:x,showDataAsIndex:d.TJJ,rowPathMap:a.subtotalCollection.DFJ(d.EFJ)},w?m.isGrandTotal=!0:m.isSubtotal=!0,r.mzc[n]=m},a.eAc=function(a,b,c,d){var e=new f.Style;return e.textIndent=b,e.hAlign=0,e.cellButtons=[{position:void 0===c?f.ButtonPosition.left:c,imageType:f.ButtonImageType.custom,command:"PivotOutlineButtonToggle",visibility:f.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:a?r:q,imageSize:{width:18,height:18}}],e},a.fAc=function(a){var b=new f.Style;return b.textIndent=a,b},a.S_a=function(a,b,c){var d=a.rowDeep,e=a.rowValuePosition,f=a.options,g=f.rowLabelIndent,h=f.showDrill,i=g*b*2;return c&&h&&(d>1||1===d&&e!==-1)&&(i+=3),i},a.aAc=function(a,b){var c=new f.Style;return c.cellButtons=[{position:void 0===b?f.ButtonPosition.left:b,command:"PivotOutlineButtonToggle",imageType:f.ButtonImageType.custom,visibility:f.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:a?r:q,imageSize:{width:18,height:18}}],c},a.Mzc=function(a,b,c,e){var h,i,j;return e?(h=0,b&&(b.sortType===d.SortType.asc&&(h=1),b.sortType===d.SortType.desc&&(h=2)),i=a?[3,4,5][h]:h,j=new f.Style,j.cellButtons=[g.getFilterCellButtonInfo(i,c)],j):{}},a.lJc=function(a){var b,c=void 0;return a&&(c="0px 0px 0px 25px"),b=new f.Style,b.cellPadding=c,b},a}(),b.PivotTableLayoutBase=s},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),g=c("./dist/plugins/pivot/pivot-util.js"),h=c("@grapecity/js-sheets-common"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=c("Core"),k=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),l=h.Common.j.Fa,m=new h.Common.ResourceManager(i.SR,"PivotTables"),n=m.getResource.bind(m),o=function(a){p(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.Jzc=function(a){var b,c,e,f=a.cornerModel,g=a.columnModel,h=a.rowModel,i=a.valueFieldsInfo,j=a.rowFields,k=a.options,m=a.showHeaders,o=a.colFields,p=a.rowValuePosition,q=a.pt,r=g.Xj,s=q.Vyc;f.setRowCount(r),f.setColCount(h.OZ),j.length>0?(1!==i.length||o.length<1&&!m||f.yq(0,0,i[0].name),m&&(l(k.rowHeaderCaption)?f.yq(r-1,0,n().RowLabels):f.yq(r-1,0,k.rowHeaderCaption),b=!1,c=null,e=[],d.Yxc(j,function(a){!b&&(b=s.isFilter(a.Zxc)),!c&&(c=a.zZ),e.push(a.Cj)}),f.zn(r-1,0,this.Mzc(b,c,24,a.options.showFilter)),f.ozc(0,{isCompactRoot:!0,fieldName:j[0]&&j[0].Cj||""}),h.ozc(0,{isCompactRoot:!0,compactFieldList:e}))):p>=0&&m&&f.yq(f.Xj-1,0,n().Values)},b.Wzc=function(a,b,c,e){var f,g=this;l(e.options.colHeaderCaption)?a.yq(0,0,b.length>0?n().ColumnLabels:n().Values):a.yq(0,0,e.options.colHeaderCaption),f=e.pt.Vyc,a.ozc(0,{isCompactRoot:!0,fieldName:b[0]&&b[0].Cj}),d.Yxc(b,function(b,c){var d=b.Cj,h=f.isFilter(b.Zxc),i=b.zZ;a.lzc[c+1]={path:d},0===c&&a.zn(0,c,g.Mzc(h,i,30,e.options.showFilter))})},b.Hzc=function(a){var b,c,d,f,g,h,i,j,k,l,m=a.rootNode,o=a.options,p=a.valueFieldsInfo,q=a.rowFields,r=a.colFields,s=a.rowValuePosition,t=q.length>0?1:0;for(0===t&&1===p.length&&r.length>0&&(t=1),0===q.length&&a.rowValuePosition>-1&&(t+=1),a.rowModel.setColCount(t),b=[],c={},d=[],f=0,g=q;f<g.length;f++)h=g[f],d.push(h.Cj);for(s!==-1&&d.splice(s,0,n().Values),i=0,j=d.length;i<j;i++)c[d[i]]=i,b.push(d[i]);a.rowFieldsIndexes=b,a.rowFieldsMap=c,k=o.subTotalsPosition===e.SubtotalsPosition.bottom,l=this.gAc(a,m,k,0,p),a.rowModel.setRowCount(l),a.contentModel.setRowCount(l)},b.hAc=function(a,b){var c,d,f=b.Uzc+b.iAc,g=a.options,h=g.subTotalsPosition,i=g.grandTotalPosition;return h===e.SubtotalsPosition.top?f+=b.jAc:h===e.SubtotalsPosition.bottom&&(f+=b.Vzc),b.Yzc&&(c=h!==e.SubtotalsPosition.none,d=i!==e.GrandTotalPosition.none&&i!==e.GrandTotalPosition.row,c&&!d?f-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:!c&&d?f+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:d&&0===b.Vzc&&(f+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length),0===a.rowFields.length&&(f=b.Uzc+b.iAc)),f},b.pKJ=function(a,b){return 0!==a.rowValuePosition&&b.aN<=a.rowValuePosition?a.options.subTotalsPosition===e.SubtotalsPosition.none?b.lKJ:b.mKJ:a.options.subTotalsPosition===e.SubtotalsPosition.bottom?b.mKJ:b.lKJ},b.gAc=function(b,c,f,h,i){var l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=b.rowModel,K=b.rowValuePosition,L=b.rowDeep,M=b.options,N=b.sharedMap,O=b.rowFieldsIndexes,P=b.rowFieldsMap,Q=c.Zzc,R=c.nodeName,S=c.aN,T=c.Yzc,U=c.$zc,V=c.xzc,W=1,X=0;if(K!==-1&&(K>=S?W=i.length:X=1),l=g.Kzc(N,V,R),m=h,o=b.pt.collapse(c.xzc,l)&&S!==L,q=L>S,Q){if(T||b.repeatValueFiledChildLength++,!T&&0!==K){for(p={path:U,isValueFieldDim:!1},b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?p.compactLevel=k.oHJ(b.rowFields,V,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:i[0].name}):p.compactLevel=c.aN-1,q&&(p.rowHeaderLevel=this.nDc(L,S+X,W)),this.Lzc(J,m,p),r=c.$zc.split(d.Separator),s=0,t=r.length;s<t;s++)J.JNc(m,O[s],g.Kzc(b.sharedMap,O[s],r[s]),O.length-s);J.yq(m,0,l),c.Pzc&&c.Pzc.length>0&&c.aN<b.rowDeep&&b.options.showDrill?J.zn(m,0,this.aAc(o,j.ButtonPosition.leftOfText)):J.zn(m,0,this.fAc(a.S_a.call(this,b,c.aN-1,!0))),m++}for(u=void 0,v=0,w=!1,x=0,y=i;x<y.length;x++){if(z=y[x],J.yq(m,0,z.name),J.zn(m,0,this.fAc(a.S_a.call(this,b,K,0!==K))),u={path:U,grandTotalLevel:S,valueFieldName:z.name,isValueFieldDim:!(c.Pzc&&c.Pzc.length>0&&c.aN<b.rowDeep),rowHeaderLevel:this.nDc(L,S,W),isSigmaValue:!0},b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?u.compactLevel=k.oHJ(b.rowFields,z.name,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:z.name}):p.compactLevel=c.aN-1,this.Lzc(J,m,u),c.aN<L)for(r=c.$zc.split(d.Separator),K>=0&&K<=S&&r.splice(K,null,z.name),s=0,t=r.length;s<t;s++)r[s]&&J.JNc(m,O[s],O[s]!==n().Values?g.Kzc(b.sharedMap,O[s],r[s]):r[s],O.length-s);m++,o?c.aN<=K&&K<L&&!T&&M.insertBlankLineAfterEachItem&&(this.nKJ(b,c,J.lzc.length),m++,v++,w=!0):(c.Yzc&&0===L&&0===K&&(this.mAc(b,c,m-1,"",i),h=i.length),m+=this.kAc(b,c,f,m,[z]),!c.Yzc&&S<L&&M.insertBlankLineAfterEachItem&&c.Pzc&&0===c.Pzc[0].mKJ&&(m++,this.nKJ(b,c,J.lzc.length)))}if(S===L&&M.insertBlankLineAfterEachItem&&(m++,this.nKJ(b,c,J.lzc.length)),o)return W=this.lAc(b,c,m-i.length-v,i,W,void 0,0,!0,w),W+1}else{if(!T){if(J.yq(m,0,l),p={path:U,grandTotalLevel:S,valueFieldName:i[0]&&i[0].name},q&&(p.rowHeaderLevel=this.nDc(L,S+X,W)),A=b.rowValuePosition!==-1&&c.aN>b.rowValuePosition?c.aN:c.aN-1,c.Pzc&&c.Pzc.length>0&&c.aN<b.rowDeep?(p.isValueFieldDim=!1,b.options.showDrill?J.zn(m,0,this.eAc(b.pt.collapse(c.xzc,l),a.S_a.call(this,b,A),j.ButtonPosition.leftOfText)):J.zn(m,0,this.fAc(a.S_a.call(this,b,A)))):(p.isValueFieldDim=!0,J.zn(m,0,this.fAc(a.S_a.call(this,b,A,!0)))),b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?p.compactLevel=k.oHJ(b.rowFields,V,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:i[0].name}):p.compactLevel=c.aN-1,this.Lzc(J,m,p),c.aN<L)for(r=c.$zc.split(d.Separator),K>=0&&K<S&&(B=P[n().Values],r.splice(B,null,i[0].name)),s=0,t=r.length;s<t;s++)J.JNc(m,O[s],O[s]!==n().Values?g.Kzc(b.sharedMap,O[s],r[s]):r[s],O.length-s);if(o)return i.length>1&&b.rowValuePosition>S?(m++,W=this.lAc(b,c,m,i,W,void 0,0,!0),W+1):W=this.lAc(b,c,m,i,W,void 0,0);m++}this.kAc(b,c,f,m,i)}return C=0,D=this.hAc(b,c),M.insertBlankLineAfterEachItem&&(C=this.pKJ(b,c),D+=C),E=h+D-W,G=!0,H=L||!i.length?M.subTotalsPosition:e.SubtotalsPosition.bottom,H===e.SubtotalsPosition.bottom||H===e.SubtotalsPosition.top&&S<K||M.subTotalsPosition===e.SubtotalsPosition.top&&T?E=h+D-W:H===e.SubtotalsPosition.top&&S>=K?(E=h,F=!0,S===K&&(E=h+D-W,F=!1)):H!==e.SubtotalsPosition.none||!T||M.grandTotalPosition!==e.GrandTotalPosition.both&&M.grandTotalPosition!==e.GrandTotalPosition.col?G=!1:E=h+D-W,G?(!F&&M.insertBlankLineAfterEachItem&&c.mKJ&&!T&&E--,0===L&&T?(I=i[0]&&i[0].name||"",J.yq(E,0,I),K===-1&&(u={path:U,rowHeaderLevel:this.nDc(L,S,W)},this.Lzc(J,E,u)),this.Szc(b,E,c,i,"")):this.lAc(b,c,E,i,void 0,F)):H===e.SubtotalsPosition.none&&b.options.insertBlankLineAfterEachItem&&C>0&&this.nKJ(b,c,E),D},b.lAc=function(b,c,f,h,i,j,m,o,p){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=b.rowDeep,L=b.rowModel,M=b.rowValuePosition,N=b.sharedMap,O=b.options,P=b.rowFieldsMap,Q=b.rowFieldsIndexes,R=c.aN,S=c.nodeName,T=c.Yzc,U=c.$zc,V=c.xzc;if(!T||b.options.grandTotalPosition!==e.GrandTotalPosition.none&&b.options.grandTotalPosition!==e.GrandTotalPosition.row){if(R<K||0===K){if(q=1,M!==-1&&M>=R&&(q=h.length),r=f,s=r,t=g.Kzc(N,V,S),r>=L.Xj)return;if(u=void 0,u=T?h.length>1&&M>=0?n().Total:n().GrandTotal:h.length>1&&M>=0||O.subtotalsPosition!==e.SubtotalsPosition.bottom?t:t+n().Total,0===K&&(u=h[0]&&h[0].name||""),v=b.pt.collapse(c.xzc,t)?M<=0?t:"":u,w=b.columnValuePosition!==-1,x={path:U,rowHeaderLevel:this.nDc(K,R,q),grandTotalLevel:R},d.Fa(m)||(x.collapseIndex=m),T?x.isGrandTotal=!0:x.isSubtotal=!0,b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?x.compactLevel=k.oHJ(b.rowFields,V,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:h[0].name}):x.compactLevel=c.aN-1,w){for(L.yq(r,0,v),y=c.$zc.split(d.Separator),z=0,A=y.length;z<A-1;z++)L.JNc(r,Q[z],Q[z]!==n().Values?g.Kzc(b.sharedMap,Q[z],y[z]):y[z],Q.length-z);this.sCJ(L,r,a.S_a.call(this,b,x.rowHeaderLevel-1)),this.Lzc(L,r,x),this.Rzc(b,c,r,U)}else{if(0===b.valueFieldsInfo.length){if(!j){for(L.yq(r,0,v),y=c.$zc.split(d.Separator),z=0,A=y.length;z<A-1;z++)L.JNc(r,Q[z],Q[z]!==n().Values?g.Kzc(b.sharedMap,Q[z],y[z]):y[z],Q.length-z);this.sCJ(L,r,a.S_a.call(this,b,x.rowHeaderLevel-1))}this.Lzc(L,r,x)}for(B=0,C=h;B<C.length;B++){for(D=C[B],E=D.name,F=D.cacheName,G=D.subtotalType,H=D.subtotalText,x={path:U,rowHeaderLevel:this.nDc(K,R,q),grandTotalLevel:R,valueFieldName:E},d.Fa(m)||(x.collapseIndex=m),o&&(x.collapse=!0),p||(q>1?L.yq(r,0,v+" "+E):L.yq(r,0,v)),y=c.$zc.split(d.Separator),M>=0&&M<R&&(I=P[n().Values],y.splice(I,null,E)),z=0,A=y.length;z<A-1;z++)L.JNc(r,Q[z],Q[z]!==n().Values?g.Kzc(b.sharedMap,Q[z],y[z]):y[z],Q.length-z);J=b.rowValuePosition!==-1&&c.aN>b.rowValuePosition?c.aN:c.aN-1,this.sCJ(L,r,a.S_a.call(this,b,J)),T?x.isGrandTotal=!0:x.isSubtotal=!0,b.valuePositionInfo&&0===b.valuePositionInfo.positionType&&b.valuePositionInfo.display?x.compactLevel=k.oHJ(b.rowFields,c.Zzc?E:V,{valuePositionIndex:b.valuePositionInfo.positionIndex,Cj:E}):x.compactLevel=c.aN-1,this.Lzc(L,r,x),this.Rzc(b,c,r,U,F,G,H,E),r++,p&&(r++,i++)}}this.Szc(b,s,c,h)}return T||!O.insertBlankLineAfterEachItem||p||(this.nKJ(b,c,L.lzc.length),l(i)||i++),i}},b.nKJ=function(a,b,c){var d=a.rowDeep,e=a.rowModel,f=b.aN,g=b.$zc;(f<=d||0===d)&&this.Lzc(e,c,{path:g,isBlankRow:!0})},b.sCJ=function(a,b,c){var d=a.Gq(b,0)||new j.Style;d.Yo(this.fAc(c)),a.zn(b,0,d)},b.kAc=function(a,b,c,e,f){var h,i,j,k,m,o,p,q,r,s,t,u,v=a.rowDeep,w=a.rowValuePosition,x=a.rowFieldsIndexes,y=a.rowModel,z=b.Pzc,A=b.aN,B=z.length;if(A>=v)for(h=b.$zc.split(d.Separator),w>=0&&!l(f)&&h.splice(w,null,f[0].name),i=0,j=h.length;i<j;i++)h[i]&&y.JNc(e-1,x[i],x[i]!==n().Values?g.Kzc(a.sharedMap,x[i],h[i]):h[i],x.length-i);if(k=0,B>0)for(m=e,o=0,p=z;o<p.length;o++)q=p[o],r=0,s=q.aN,s>v?(t=m-1,b.Yzc&&0===v&&a.columnDeep>0&&w===-1&&(t=m),this.mAc(a,q,t,"",f)):(s===v&&(u=q.Zzc?m+1:m,this.Szc(a,u,q,f)),r=this.gAc(a,q,c,m,f),k+=r,m+=r);return k},b.mAc=function(a,b,c,e,g){var h,i,j,k,m,n,o,p,q,r,s,t,u,v,w=a.columnValuePosition,x=a.contentModel,y=a.colMap,z=b.Pzc,A=b.nodeName,B=b.GFJ;if(""!==e&&(e+=d.Separator),h=w!==-1,0===z.length)for(i=0,j=g;i<j.length;i++)k=j[i],m=k.name,n=k.cacheName,o=k.subtotalText,p=e,0!==a.columnDeep&&(p+=A),h&&(""!==p?p+=d.Separator+m:p=m),q=y[p],l(q)||(r=!1,s=a.subtotalCollection.zFJ[m],s&&(s.needBuildRunningTotalOrRankPath&&(b.CFJ[m].indexInfo.minorPath=b.IFJ),(8===s.showDataAs||9===s.showDataAs)&&(s.showDataAsIndex&b.TJJ)>0&&(r=!0)),!r&&x.yq(c,q,f.zzc(a.subtotalCollection,B,n,o,b.CFJ,b.aN,m)));else for(t=0,u=z;t<u.length;t++)v=u[t],this.mAc(a,v,c,e+A,g);b.K0b||this.Szc(a,c,b,g,e+A)},b.Nc=e.PivotTableLayoutType.outline,b}(f.PivotTableLayoutBase),b.PivotTableCompactLayout=o},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d={frameColor:"rgba(100,100,100,1)",nameColor:"rgba(50,50,50,1)",panelTitleColor:"rgba(50,50,50)",tableHeadColor:"rgba(77,130,184,1)",tableHeadLine:"rgba(255,255,255,1)",tableContent:"rgba(128,128,128,1)",tableContentRim:"rgba(193,211,230,1)",recordBookFrameColor:"rgba(153,183,214,1)",recordColor:"rgba(179,179,179,1)",MagnifierFrameColor:"rgba(196,213,231,1)",tickColor:"rgba(216,99,68,1)",font:"12px Regular",textAlign:"center",nameBaseline:"hanging",frameLineWidth:2,inputLineWidth:2};function g(a,b,c,d,e,f,g,k){var m,n,o,p,q,r,s,t,u,v,w,x;f<3||e<3||(m=.125,n=.08,o=.75,p=20,q=11,r=194,s=362,t=f/r,u=e/s,v=e-2,w=0,a.save(),a.rect(g.x,g.y,g.width,g.height),a.clip(),v>1&&(a.translate(c,d),h(a,f,e),v-=2),v>0&&(a.translate((f-2)*m,(e-2)*n),i(a,f*o,p,b),v-=(e-2)*n+p),v>0&&(a.translate((f-2)*o/2,(e-2)*n),w=j(a,f,k),v-=(e-2)*n+w),v>0&&(x=.7*v,a.translate(0,.9*x),l(a,f-q*t,x,Math.min(t,u))),a.restore())}b.nAc=g;function h(a,b,c){a.save(),a.strokeStyle=d.frameColor,a.lineWidth=d.frameLineWidth,a.strokeRect(0,0,b,c),a.fillStyle=d.tableHeadLine,a.fillRect(0,0,b,c),a.restore()}function i(a,b,c,e){var f=.5;a.save(),a.strokeStyle=d.frameColor,a.lineWidth=d.inputLineWidth,a.strokeRect(0,0,b,c),a.rect(1,0,b-2,c),a.clip(),a.translate(b*f,0),k(a,e),a.restore()}function j(a,b,c){var e,f=10,g=20,h=t(c,b-f,d.font);for(e=0;e<h.length;e++)a.translate(0,g),k(a,h[e]);return h.length*g}function k(a,b){a.save(),a.textBaseline=d.nameBaseline,a.textAlign=d.textAlign,a.font=d.font,a.fillStyle=d.nameColor,a.fillText(b,0,4),a.restore()}function l(a,b,c,d){q(a,b,c),m(a,d)}function m(a,b){var c=180,d=152,e=63,f=54,g=70,h=152,i=32;a.save(),a.translate(-c*b*.5,-d*b*.5),n(a,e,f,b),a.translate((c-g)*b,0),o(a,g,h,b),a.translate(-2*b,64*b),p(a,i,b),a.restore()}function n(a,b,c,e){var f,g,h,i,j=8,k=13,l=7,m=2,n=4,o=5,p=49,q=45;for(a.save(),a.scale(e,e),r(a,0,0,k,j,d.tableHeadColor,!0),r(a,n-1,n-1,l,m,d.tableHeadLine,!0),r(a,k+1,0,p,j,d.tableHeadColor,!0),f=0,g=0,h=0,h=0;h<4;h++)f=(l+o)*h+(k+o-1),r(a,f,n-1,l,m,d.tableHeadLine,!0);for(r(a,0,j+1,k,q,d.tableHeadColor,!0),h=0;h<7;h++)g=(m+n)*h+12,r(a,n-1,g,l,m,d.tableHeadLine,!0);for(r(a,k+1,j+1,p,q,d.tableContentRim,!0),h=0;h<7;h++)for(g=(n+m)*h+j+n,i=0;i<4;i++)f=(l+o)*i+(k+o-1),r(a,f,g,l,m,d.tableContent,!0);a.restore()}function o(a,b,c,e){var f,g,h,i,j=57,k=55,l=7,m=41,n=3;for(a.save(),a.scale(e,e),r(a,0,0,b,c,d.tableContentRim,!0),r(a,l+1,8,m,n,d.tableHeadColor,!0),r(a,l,19,j,k,d.recordBookFrameColor,!1),r(a,l+1,20,j-2,k-2,d.tableHeadLine,!0),f=0,g=0;g<9;g++)f=26+5*g,r(a,11,f,2,2,d.recordColor,!0),r(a,14,f,42,2,d.recordColor,!0);for(r(a,8,82,m,n,d.tableHeadColor,!0),h=0,g=0;g<2;g++)for(h=92+30*g,i=0;i<2;i++)f=7+31*i,r(a,f,h,26,24,d.recordBookFrameColor,!1),r(a,f+1,h+1,24,22,d.tableHeadLine,!0);a.restore()}function p(a,b,c){a.save(),a.scale(c,c),a.beginPath(),a.save(),a.arc(0,0,b,0,2*Math.PI,!0),a.clip(),a.arc(0,0,b,0,2*Math.PI,!0),a.strokeStyle=d.MagnifierFrameColor,a.stroke(),a.arc(0,0,b-1,0,2*Math.PI,!0),a.clip(),a.arc(0,0,b-1,0,2*Math.PI,!0),a.fillStyle=d.tableHeadLine,a.fill();var e=0,f=0;for(f=0;f<3;f++)e=24-18*f,r(a,-16,-e,13,13,d.tableContent,!1),r(a,1,-e+4,35,5,d.recordColor,!0);s(a,-15,-6,11),a.restore(),a.restore()}function q(a,b,c){a.save(),a.fillStyle=d.tableHeadLine,a.fillRect(.5*-b,.5*-c,b,c),a.restore()}function r(a,b,c,d,e,f,g){a.save(),a.translate(b,c),g?(a.fillStyle=f,a.fillRect(0,0,d,e)):(a.strokeStyle=f,a.strokeRect(0,0,d,e)),a.restore()}function s(a,b,c,e){a.save();var f=e;a.translate(Math.round(b+f/2),Math.round(c+f/2)),a.strokeStyle="red",a.rotate(Math.PI*-.25),a.beginPath(),a.fillStyle=d.tickColor,a.fillRect(.375*-f,.25*-f,.2*f,.5*f),a.closePath(),a.fill(),a.beginPath(),a.fillStyle=d.tickColor,a.fillRect(.375*-f,.05*f,.75*f,.2*f),a.closePath(),a.fill(),a.stroke(),a.restore()}function t(a,b,c){var d,e,f,g,h,i=[];if(a&&a.length>0){for(d=a.split(/\r\n|\r|\n/),e=w(),e.save(),c&&(e.font=c),f=0,g=d.length;f<g;f++)h=u(e,d[f],b),h&&(0===h.length?i.push(""):h.forEach(function(a){i.push(a)}));e.restore()}return i}function u(a,b,c){var d,e,f,g,h,i,j=b.split(" "),k=[],l="",m=0,n=a.measureText(" ").width;if(1===b.length)return j;for(d=0,e=j.length;d<e;d++)f=j[d],g=a.measureText(f).width,g>c?(l.length>0&&k.push(l),h=v(a,j[d],c,g),h.forEach(function(a){k.push(a)}),l="",m=0):(i=l+f,m+=g+n,m>c?m-n<=c?(k.push(i),m=0,l=""):(k.push(l),m=g+n,m>c?(k.push(f),m=0,l=""):l=f+" "):l=i+" ");return l.length>0&&k.push(l),k}function v(a,b,c,d){var e,f,g,h,i=Math.ceil(d/c),j=b.length/i,k=[];for(i=0;c>0&&i<b.length;){for(e=b.substring(i,i+j),f=a.measureText(e).width,g=f<=c?1:-1,h=0;(f<c&&g>0||f>c&&g<0)&&(h+=g,!(i+j+h>=b.length||i+j+h===0));)e=b.substring(i,i+j+h),f=a.measureText(e).width;if(h-=g,!(i+j+h>i))break;k.push(b.substring(i,i+j+h)),i=i+j+h}return k}function w(){var a,b=f;return b||(a=document.createElement("canvas"),a.hidden=!0,a.width=1,a.height=1,document.body.appendChild(a),e=a,f=b=a.getContext("2d")),b}},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),g=c("./dist/plugins/pivot/pivot-util.js"),h=c("@grapecity/js-sheets-common"),i=c("./dist/plugins/pivot/pivot.ns.js"),j=h.Common.j.Fa,k=new h.Common.ResourceManager(i.SR,"PivotTables"),l=k.getResource.bind(k),m=function(a){n(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.Jzc=function(a){var b,c=this,e=a.cornerModel,f=a.columnModel,g=a.rowModel,h=a.valueFieldsInfo,i=a.rowFieldsMap,j=a.pt,k=a.rowFields,m=a.showHeaders,n=a.colFields,o=a.rowValuePosition,p=f.Xj,q=j.Vyc;e.setRowCount(p),e.setColCount(g.OZ),k.length>0?(1!==h.length||n.length<1&&!m||e.yq(0,0,h[0].name),m&&(b=p-1,d.Yxc(Object.keys(i),function(d){var f,h,k,m,n=i[d];e.yq(b,n,d),f=d!==l().Values,f&&(h=j.LSb(d),k=q.isFilter(h.Zxc),m=h.zZ,e.zn(b,n,c.Mzc(k,m,30,a.options.showFilter))),e.ozc(n,{isCompactRoot:!1,fieldName:d,isDim:f}),g.mzc[n]={
path:d}}))):o>=0&&m&&e.yq(e.Xj-1,0,l().Values)},b.Wzc=function(a,b,c,e){var f=this,g=[];d.Yxc(b,function(a){g.push({name:a.Cj,isFilter:e.pt.Vyc.isFilter(a.Zxc),isDim:!0,sortInfo:a.zZ})}),c!==-1&&g.splice(c,0,{name:l().Values,isFilter:!1,isDim:!1}),d.Yxc(g,function(b,c){var d=b.name,g=b.isDim,h=b.isFilter,i=b.sortInfo;a.yq(0,c,d),a.lzc[c+1]={path:d},g&&a.zn(0,c,f.Mzc(h,i,30,e.options.showFilter)),a.ozc(c,{isCompactRoot:!1,fieldName:d})})},b.pKJ=function(a,b){return 0!==a.rowValuePosition&&b.aN<=a.rowValuePosition?a.options.subTotalsPosition===e.SubtotalsPosition.none?b.lKJ:b.mKJ:a.options.subTotalsPosition===e.SubtotalsPosition.bottom?b.mKJ:b.lKJ},b.hAc=function(a,b,c){var d,f,g=b.Uzc+b.iAc,h=a.options,i=h.subTotalsPosition,j=h.grandTotalPosition;return i===e.SubtotalsPosition.top?g+=b.jAc:i===e.SubtotalsPosition.bottom&&(g+=b.Vzc),b.Yzc&&(d=i!==e.SubtotalsPosition.none,f=j!==e.GrandTotalPosition.none&&j!==e.GrandTotalPosition.row,d&&!f?g-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:!d&&f?g+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:f&&0===b.Vzc&&(g+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length),0===a.rowFields.length&&(g=b.Uzc+b.iAc)),g},b.Hzc=function(a){var b,c,d,f,g;this.oAc(a),b=a.rootNode,c=a.options,d=a.valueFieldsInfo,f=c.subTotalsPosition===e.SubtotalsPosition.bottom,g=this.gAc(a,b,f,0,d),a.rowModel.setRowCount(g),a.contentModel.setRowCount(g)},b.gAc=function(a,b,c,f,h){var i,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=a.rowFieldsMap,F=a.rowModel,G=a.rowValuePosition,H=a.options,I=a.sharedMap,J=a.rowDeep,K=a.rowFieldsIndexes,L=b.Zzc,M=b.xzc,N=b.nodeName,O=b.aN,P=b.Yzc,Q=b.$zc,R=E[M],S=1;if(G!==-1&&G>=O&&(S=h.length),i=g.Kzc(I,M,N),k=f,m=a.pt.collapse(b.xzc,i)&&O!==J,L){if(P||a.repeatValueFiledChildLength++,n=E[l().Values],!P&&0!==G){for(F.yq(k,R,i),this.Lzc(F,k,{path:Q,isValueFieldDim:!1,rowHeaderLevel:this.nDc(J,O,S)}),o=b.$zc.split(d.Separator),p=0,q=o.length;p<q;p++)F.JNc(k,K[p],g.Kzc(a.sharedMap,K[p],o[p]),K.length-p);b.Pzc&&b.Pzc.length>0&&b.aN<a.rowDeep&&a.options.showDrill&&F.zn(k,R,this.aAc(m)),k++}for(r=void 0,s=0,t=!1,u=0,v=h;u<v.length;u++){if(w=v[u],F.yq(k,n,w.name),r={path:Q,rowHeaderLevel:this.nDc(J,O,S),isValueFieldDim:!(b.Pzc&&b.Pzc.length>0&&b.aN<a.rowDeep),valueFieldName:w.name},this.Lzc(F,k,r),b.aN<J)for(o=b.$zc.split(d.Separator),o.splice(n,null,w.name),p=0,q=o.length;p<q;p++)o[p]&&F.JNc(k,K[p],K[p]!==l().Values?g.Kzc(a.sharedMap,K[p],o[p]):o[p],K.length-p);k++,m?b.aN<=G&&G<J&&!P&&H.insertBlankLineAfterEachItem&&(this.nKJ(a,b,F.lzc.length),k++,s++,t=!0):(b.Yzc&&0===J&&0===G&&(this.mAc(a,b,k-1,"",h),f=h.length),k+=this.kAc(a,b,c,k,[w]),!b.Yzc&&O<J&&H.insertBlankLineAfterEachItem&&b.Pzc&&0===b.Pzc[0].mKJ&&(k++,this.nKJ(a,b,F.lzc.length)))}if(O===J&&H.insertBlankLineAfterEachItem&&(k++,this.nKJ(a,b,F.lzc.length)),m)return S=this.lAc(a,b,k-h.length-s,h,S,void 0,R,!0,t),S+1}else{if(!j(R)){if(F.yq(k,R,i),r={path:Q,rowHeaderLevel:this.nDc(J,O,S),valueFieldName:h[0]&&h[0].name},b.Pzc&&b.Pzc.length>0&&b.aN<a.rowDeep?(r.isValueFieldDim=!1,a.options.showDrill&&F.zn(k,R,this.aAc(a.pt.collapse(b.xzc,i)))):r.isValueFieldDim=!0,this.Lzc(F,k,r),b.aN<J)for(o=b.$zc.split(d.Separator),G>=0&&G<O&&(n=E[l().Values],o.splice(n,null,h[0].name)),p=0,q=o.length;p<q;p++)F.JNc(k,K[p],K[p]!==l().Values?g.Kzc(a.sharedMap,K[p],o[p]):o[p],K.length-p);if(m)return G>O?(k++,S=this.lAc(a,b,k,h,S,!1,R,!0),S+1):S=this.lAc(a,b,k,h,S,void 0,R);k++}this.kAc(a,b,c,k,h)}return x=0,y=this.hAc(a,b,c),H.insertBlankLineAfterEachItem&&(x=this.pKJ(a,b),y+=x),z=f+y-S,B=!0,C=J||!h.length?H.subTotalsPosition:e.SubtotalsPosition.bottom,C===e.SubtotalsPosition.bottom||C===e.SubtotalsPosition.top&&O<G||C===e.SubtotalsPosition.top&&P?z=f+y-S:C===e.SubtotalsPosition.top&&O>=G?(z=f,A=!0,O===G&&(z=f+y-S,A=!1)):C!==e.SubtotalsPosition.none||!P||H.grandTotalPosition!==e.GrandTotalPosition.both&&H.grandTotalPosition!==e.GrandTotalPosition.col?B=!1:z=f+y-S,B?(!A&&H.insertBlankLineAfterEachItem&&b.mKJ&&!P&&z--,0===J&&P?(D=h[0]&&h[0].name||"",F.yq(z,0,D),G===-1&&(r={path:Q,rowHeaderLevel:this.nDc(J,O,S)},this.Lzc(F,z,r)),this.Szc(a,z,b,h,"")):this.lAc(a,b,z,h,void 0,A)):C===e.SubtotalsPosition.none&&a.options.insertBlankLineAfterEachItem&&x>0&&this.nKJ(a,b,z),y},b.lAc=function(a,b,c,f,h,i,k,m,n){var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=a.rowDeep,K=a.rowModel,L=a.rowFieldsMap,M=a.rowValuePosition,N=a.sharedMap,O=a.options,P=a.rowFieldsIndexes,Q=b.aN,R=b.nodeName,S=b.Yzc,T=b.$zc,U=b.xzc;if(!b.Yzc||a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.row){if(Q<J||0===J){if(o=S?0:L[b.xzc],p=1,M!==-1&&M>=Q&&(p=f.length),q=c,r=q,q>=K.Xj)return;if(s=void 0,0===J?s=f[0]&&f[0].name||"":(t=g.Kzc(N,U,R),s=a.pt.collapse(b.xzc,t)?t:S?f.length>1&&M>=0?l().Total:l().GrandTotal:f.length>1&&M>=0||f.length<2&&O.subtotalsPosition===e.SubtotalsPosition.top?t:t+l().Total),u=a.columnValuePosition!==-1,v={path:T,rowHeaderLevel:this.nDc(J,Q,p),grandTotalLevel:Q},d.Fa(k)||(v.collapseIndex=k),S?v.isGrandTotal=!0:v.isSubtotal=!0,u){if(!i)for(K.yq(q,o,s),w=b.$zc.split(d.Separator),x=0,y=w.length;x<y-1;x++)K.JNc(q,P[x],P[x]!==l().Values?g.Kzc(a.sharedMap,P[x],w[x]):w[x],P.length-x);this.Lzc(K,q,v),this.Rzc(a,b,q,T)}else{if(0===a.valueFieldsInfo.length){if(!i)for(K.yq(q,o,s),w=b.$zc.split(d.Separator),x=0,y=w.length;x<y-1;x++)K.JNc(q,P[x],P[x]!==l().Values?g.Kzc(a.sharedMap,P[x],w[x]):w[x],P.length-x);this.Lzc(K,q,v)}for(z=0,A=f;z<A.length;z++){for(B=A[z],C=B.name,D=B.subtotalType,E=B.cacheName,F=B.subtotalText,v={path:T,rowHeaderLevel:this.nDc(J,Q,p),grandTotalLevel:Q,valueFieldName:C},d.Fa(k)||(v.collapseIndex=k),m&&(v.collapse=!0),G=void 0,H=void 0,void 0===i||p>1?(G=M>=v.grandTotalLevel?s+" "+C:s,H=o):i?(G=s,m||(H=o)):(G=C,H=a.valuePositionInfo.positionIndex),n||K.yq(q,H,G),w=b.$zc.split(d.Separator),M>=0&&M<Q&&(I=L[l().Values],w.splice(I,null,f[0].name)),x=0,y=w.length;x<y-1;x++)K.JNc(q,P[x],P[x]!==l().Values?g.Kzc(a.sharedMap,P[x],w[x]):w[x],P.length-x);S?v.isGrandTotal=!0:v.isSubtotal=!0,this.Lzc(K,q,v),this.Rzc(a,b,q,T,E,D,F,C),q++,n&&(q++,h++)}}this.Szc(a,r,b,f)}return S||!O.insertBlankLineAfterEachItem||n||(this.nKJ(a,b,K.lzc.length),j(h)||h++),h}},b.nKJ=function(a,b,c){var d=a.rowDeep,e=a.rowModel,f=b.aN,g=b.$zc;(f<=d||0===d)&&this.Lzc(e,c,{path:g,isBlankRow:!0})},b.kAc=function(a,b,c,f,h){var i,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=a.rowDeep,E=a.options,F=a.rowFieldsMap,G=a.rowModel,H=a.rowValuePosition,I=a.rowFieldsIndexes,J=1,K=b.Pzc,L=b.aN,M=K.length;if(L>=D)for(i=b.$zc.split(d.Separator),H>=0&&!j(h)&&i.splice(H,null,h[0].name),k=0,m=i.length;k<m;k++)i[k]&&G.JNc(f-1,I[k],I[k]!==l().Values?g.Kzc(a.sharedMap,I[k],i[k]):i[k],I.length-k);if(n=0,M>0)for(o=f,p=E.fillDownLabels,q=void 0,r=void 0,s=void 0,t=E.subTotalsPosition===e.SubtotalsPosition.bottom?1:0,u=this.lJc(E.showDrill),v=0,w=K;v<w.length;v++)if(x=w[v],y=0,L>=D)z=o-1,b.Yzc&&0===D&&a.columnDeep>0&&H===-1&&(z=o),this.mAc(a,x,z,"",h);else{if(y=this.gAc(a,x,c,o,h),p)for(q=F[x.xzc],s=y+o-t,r=G.ge(o,q),A=void 0,B=o+1;B<s;B++)A=G.lzc[B],A&&!A.isBlankRow&&(!A.isSubtotal||L<A.grandTotalLevel-1)&&(G.yq(B,q,r),G.zn(B,q,u));n+=y,L+1===D&&(C=x.Zzc?o+1:o,this.Szc(a,C,x,h)),o+=y}return n},b.mAc=function(a,b,c,e,g){var h,i,k,l,m,n,o,p,q,r,s,t,u,v,w=a.columnValuePosition,x=a.contentModel,y=a.colMap,z=b.Pzc,A=b.nodeName,B=b.GFJ;if(""!==e&&(e+=d.Separator),h=w!==-1,0===z.length)for(i=0,k=g;i<k.length;i++)l=k[i],m=l.name,n=l.cacheName,o=l.subtotalText,p=e,0!==a.columnDeep&&(p+=A),h&&(""!==p?p+=d.Separator+m:p=m),q=y[p],r=a.subtotalCollection.zFJ[m],j(q)||(s=!1,r&&(r.needBuildRunningTotalOrRankPath&&(b.CFJ[m].indexInfo.minorPath=b.IFJ),(8===r.showDataAs||9===r.showDataAs)&&(r.showDataAsIndex&b.TJJ)>0&&(s=!0)),!s&&x.yq(c,q,f.zzc(a.subtotalCollection,B,n,o,b.CFJ,b.aN,m)));else for(t=0,u=z;t<u.length;t++)v=u[t],this.mAc(a,v,c,e+A,g);b.K0b||this.Szc(a,c,b,g,e+A)},b.oAc=function(a){var b,c,d,e,f,g,h,i,j=a.rowModel,k=a.rowFields,m=a.rowValuePosition,n=a.valueFieldsInfo,o=a.colFields,p=k.length;for(0===p&&1===n.length&&o.length>0&&(p=1),b=[],c=0,d=k;c<d.length;c++)e=d[c],b.push(e.Cj);for(m!==-1&&(p+=1,b.splice(m,0,l().Values)),j.setColCount(p),f={},g=[],h=0,i=b.length;h<i;h++)f[b[h]]=h,g.push(b[h]);a.rowFieldsMap=f,a.rowFieldsIndexes=g},b.Nc=e.PivotTableLayoutType.outline,b}(f.PivotTableLayoutBase),b.PivotTableOutlineLayout=m},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Pivot"),e=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),f=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),g=c("@grapecity/js-sheets-common"),h=c("./dist/plugins/pivot/pivot.ns.js"),i=c("./dist/plugins/pivot/pivot-util.js"),j=g.Common.j.Fa,k=new g.Common.ResourceManager(h.SR,"PivotTables"),l=k.getResource.bind(k),m=function(a){n(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.Jzc=function(a){var b,c=this,e=a.cornerModel,f=a.columnModel,g=a.rowModel,h=a.valueFieldsInfo,i=a.rowFieldsMap,j=a.pt,k=a.rowFields,m=a.showHeaders,n=a.colFields,o=a.rowValuePosition,p=f.Xj;e.setRowCount(p),e.setColCount(g.OZ),k.length?(1!==h.length||n.length<1&&!m||e.yq(0,0,h[0].name),m&&(b=p-1,d.Yxc(Object.keys(i),function(d,f){var h,i,k,m;e.yq(b,f,d),h=d!==l().Values,h&&(i=j.LSb(d),k=j.Vyc.isFilter(i.Zxc),m=i.zZ,e.zn(b,f,c.Mzc(k,m,30,a.options.showFilter))),e.ozc(f,{isCompactRoot:!1,fieldName:d,isDim:h}),g.mzc[f]={path:d}}))):o>=0&&m&&e.yq(e.Xj-1,0,l().Values)},b.Wzc=function(a,b,c,e){var f=this,g=[];d.Yxc(b,function(a){g.push({name:a.Cj,isFilter:e.pt.Vyc.isFilter(a.Zxc),isDim:!0,sortInfo:a.zZ})}),c!==-1&&g.splice(c,0,{name:l().Values,isFilter:!1,isDim:!1}),d.Yxc(g,function(b,c){var d=b.name,g=b.isDim,h=b.isFilter,i=b.sortInfo;a.yq(0,c,d),a.lzc[c+1]={path:d},g&&a.zn(0,c,f.Mzc(h,i,30,e.options.showFilter)),a.ozc(c,{isCompactRoot:!1,fieldName:d})})},b.Hzc=function(a){var b,c,d,f,g,h;this.oAc(a),b=a.rootNode,c=a.options,d=a.valueFieldsInfo,f=a.rowModel,g=a.contentModel,h=c.subTotalsPosition!==e.SubtotalsPosition.none,this.gAc(a,b,h,0,d),f.setRowCount(f.lzc.length),g.setRowCount(f.lzc.length)},b.gAc=function(a,b,c,d,f){var g,h,k,m,n,o,p,q,r,s,t,u,v,w,x,y=a.rowFieldsMap,z=a.rowModel,A=a.rowValuePosition,B=a.rowDeep,C=a.sharedMap,D=b.Zzc,E=b.xzc,F=b.nodeName,G=b.aN,H=b.Yzc,I=b.$zc,J=y[E],K=1,L=a.options.subTotalsPosition!==e.SubtotalsPosition.none,M=a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.row;if(A!==-1&&A>=G&&(K=f.length),g=i.Kzc(C,E,F),h=d,k=a.pt.collapse(b.xzc,g)&&G!==B,D){for(m=y[l().Values],H||0===A||(z.yq(h,J,g),b.Pzc&&b.Pzc.length>0&&b.aN<a.rowDeep&&a.options.showDrill&&z.zn(h,J,this.aAc(k))),n=void 0,o=0,p=!1,q=0,r=f;q<r.length;q++)s=r[q],z.yq(h,m,s.name),n={path:I,rowHeaderLevel:this.nDc(B,G,K)},K>1&&(n.valueFieldName=s.name,n.isValueFieldDim=!0),this.Lzc(z,h,n),k?b.aN<=A&&A<B&&!H&&a.options.insertBlankLineAfterEachItem?(this.nKJ(a,b,z.lzc.length),h++,h++,o++,p=!0):h++:(b.Yzc&&0===B&&0===A&&(this.mAc(a,b,h,"",f),d=f.length),h+=this.kAc(a,b,c,h,[s],!0),!b.Yzc&&G<B&&a.options.insertBlankLineAfterEachItem&&b.Pzc&&0===b.Pzc[0].mKJ&&(h++,this.nKJ(a,b,z.lzc.length)));if(G===B&&a.options.insertBlankLineAfterEachItem&&(h++,this.nKJ(a,b,z.lzc.length)),k)return K=this.lAc(a,b,c,h-K-o,f,K,!0,J,!0,p),c||(K+=o),K}else{if(!j(J)&&(z.yq(h,J,g),this.Lzc(z,h,{path:I,rowHeaderLevel:this.nDc(B,G,K),valueFieldName:f[0]&&f[0].name}),b.Pzc&&b.Pzc.length>0&&b.aN<a.rowDeep&&a.options.showDrill&&z.zn(h,J,this.aAc(k)),k))return t=!0,0!==a.valuePositionInfo.positionIndex&&(t=!1),K=this.lAc(a,b,!0,h,f,K,t,J,!0);this.kAc(a,b,c,h,f)}return u=this.hAc(a,b)||K,v=0,a.options.insertBlankLineAfterEachItem&&(v=this.pKJ(a,b),u+=v),w=d+u-K,L||H&&M||!B&&f.length?(a.options.insertBlankLineAfterEachItem&&b.mKJ&&!H&&w--,0===B&&H?(x=f[0]&&f[0].name||"",z.yq(w,0,x),A===-1&&(n={path:I,rowHeaderLevel:this.nDc(B,G,K)},this.Lzc(z,w,n)),this.Szc(a,w,b,f,"")):A<=0?this.lAc(a,b,c,w,f,void 0,!0):this.lAc(a,b,c,w,f)):a.options.subTotalsPosition===e.SubtotalsPosition.none&&a.options.insertBlankLineAfterEachItem&&v>0&&this.nKJ(a,b,w),u},b.pKJ=function(a,b){return a.options.subTotalsPosition===e.SubtotalsPosition.none?b.lKJ:b.mKJ},b.hAc=function(a,b){var c,d,f,g=a.options,h=g.subTotalsPosition,i=g.grandTotalPosition;return c=h!==e.SubtotalsPosition.none?b.Uzc+b.kEc+b.iOc:b.Uzc+b.iOc,b.Yzc&&(0===a.rowFields.length&&(c=b.Uzc+b.iOc),d=h!==e.SubtotalsPosition.none,f=i!==e.GrandTotalPosition.none&&i!==e.GrandTotalPosition.row,d&&!f?c-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:f&&!d?c+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length:f&&0===b.Vzc&&0!==a.rowFields.length&&(c+=a.rowValuePosition===-1?1:a.valueFieldsInfo.length)),c},b.lAc=function(a,b,c,f,g,h,k,m,n,o){var p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=a.rowDeep,L=a.rowModel,M=a.rowFieldsMap,N=a.sharedMap,O=a.options,P=a.rowValuePosition,Q=a.rowFieldsIndexes,R=b.aN,S=b.nodeName,T=b.Yzc,U=b.$zc,V=b.xzc,W=!1;if(T){if(a.options.grandTotalPosition===e.GrandTotalPosition.none||a.options.grandTotalPosition===e.GrandTotalPosition.row)return;W=!0}if(c&&R<K||0===K||W){if(p=1,P!==-1&&P>=R&&(p=g.length),q=T?0:M[b.xzc],r=f,s=r,r>=L.Xj)return;if(t=void 0,0===K?t=g[0]&&g[0].name||"":(u=i.Kzc(N,V,S),t=a.pt.collapse(b.xzc,u)?u:T?g.length>1&&P>=0?l().Total:l().GrandTotal:g.length>1&&P>0||g.length<2&&O.subtotalsPosition===e.SubtotalsPosition.none?u:u+l().Total),v=a.columnValuePosition!==-1){for(w={path:U,grandTotalLevel:R},T?w.isGrandTotal=!0:w.isSubtotal=!0,d.Fa(m)||(w.collapseIndex=m),L.yq(r,q,t),x=b.$zc.split(d.Separator),y=0,z=x.length;y<z-1;y++)L.JNc(r,Q[y],Q[y]!==l().Values?i.Kzc(a.sharedMap,Q[y],x[y]):x[y],Q.length-y);this.Lzc(L,r,w),this.Rzc(a,b,r,U)}else{if(w=void 0,0===a.valueFieldsInfo.length){for(L.yq(r,q,t),x=b.$zc.split(d.Separator),y=0,z=x.length;y<z-1;y++)L.JNc(r,Q[y],Q[y]!==l().Values?i.Kzc(a.sharedMap,Q[y],x[y]):x[y],Q.length-y);w={path:U,grandTotalLevel:R},T?w.isGrandTotal=!0:w.isSubtotal=!0,d.Fa(m)||(w.collapseIndex=m),this.Lzc(L,r,w)}for(A=0,B=g;A<B.length;A++){for(C=B[A],D=C.cacheName,E=C.subtotalType,F=C.subtotalText,G=C.name,w={path:U,grandTotalLevel:R,valueFieldName:G},T?w.isGrandTotal=!0:w.isSubtotal=!0,H=void 0,I=void 0,n&&(w.collapse=!0),void 0===k||p>1?(H=t+" "+G,I=q):k?(H=t,n||(I=q)):(H=G,I=a.valuePositionInfo.positionIndex),w.valueFieldName=G,o||L.yq(r,I,H),x=b.$zc.split(d.Separator),P>=0&&P<R&&(J=M[l().Values],x.splice(J,null,H)),y=0,z=x.length;y<z-1;y++)L.JNc(r,Q[y],Q[y]!==l().Values?i.Kzc(a.sharedMap,Q[y],x[y]):x[y],Q.length-y);d.Fa(m)||(w.collapseIndex=m),this.Lzc(L,r,w),this.Rzc(a,b,r,U,D,E,F,G),r++,o&&(r++,h++)}}this.Szc(a,s,b,g)}return T||!O.insertBlankLineAfterEachItem||o||(this.nKJ(a,b,L.lzc.length),j(h)||h++),h},b.nKJ=function(a,b,c){var d=a.rowDeep,e=a.rowModel,f=b.aN,g=b.$zc;(f<=d||0===d)&&this.Lzc(e,c,{path:g,isBlankRow:!0})},b.kAc=function(a,b,c,f,g,h){var k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=a.rowDeep,C=a.rowModel,D=a.options,E=a.rowFieldsMap,F=a.rowValuePosition,G=a.rowFieldsIndexes,H=1,I=b.Pzc,J=b.aN,K=I.length;if(J>=B)for(k=b.$zc.split(d.Separator),F>=0&&!j(g)&&k.splice(F,null,g[0].name),m=0,n=k.length;m<n;m++)k[m]&&C.JNc(f,G[m],G[m]!==l().Values?i.Kzc(a.sharedMap,G[m],k[m]):k[m],G.length-m);if(o=0,K>0)for(p=f,q=D.fillDownLabels,r=void 0,s=void 0,t=void 0,u=D.subTotalsPosition===e.SubtotalsPosition.bottom?1:0,v=this.lJc(D.showDrill),w=0,x=I;w<x.length;w++)if(y=x[w],J>=B)this.mAc(a,y,p,"",g);else{if(J+1===B&&this.Szc(a,p,y,g),z=this.gAc(a,y,c,p,g),q)for(r=E[y.xzc],t=z+p-u,s=C.ge(p,r),A=p+1;A<t;A++)C.lzc[A]&&!C.lzc[A].isBlankRow&&(C.yq(A,r,s),C.zn(A,r,v));p+=z,o+=z}return J>=B&&(o=1),o},b.mAc=function(a,b,c,e,g){var h,i,k,l,m,n,o,p,q,r,s,t,u,v,w=a.columnValuePosition,x=a.contentModel,y=a.colMap,z=b.Pzc,A=b.nodeName,B=b.GFJ;if(""!==e&&(e+=d.Separator),h=w!==-1,0===z.length)for(i=0,k=g;i<k.length;i++)l=k[i],m=l.name,n=l.cacheName,o=l.subtotalText,p=e,0!==a.columnDeep&&(p+=A),h&&(""!==p?p+=d.Separator+m:p=m),q=y[p],j(q)||(r=!1,s=a.subtotalCollection.zFJ[m],s&&(s.needBuildRunningTotalOrRankPath&&(b.CFJ[m].indexInfo.minorPath=b.IFJ),(8===s.showDataAs||9===s.showDataAs)&&(s.showDataAsIndex&b.TJJ)>0&&(r=!0)),!r&&x.yq(c,q,f.zzc(a.subtotalCollection,B,n,o,b.CFJ,b.aN,m)));else for(t=0,u=z;t<u.length;t++)v=u[t],this.mAc(a,v,c,e+A,g);b.K0b||this.Szc(a,c,b,g,e+A)},b.oAc=function(a){var b,c,d,f,g,h,i,j,k,m=a.rowModel,n=a.rowFields,o=a.rowValuePosition,p=a.rootNode,q=a.valueFieldsInfo,r=a.colFields,s=n.length;for(0===s&&1===q.length&&r.length>0&&(s=1),b=p.Uzc+p.iOc+(a.options.subTotalsPosition===e.SubtotalsPosition.none?p.lKJ:p.mKJ),0!==n.length&&(b+=a.options.subTotalsPosition!==e.SubtotalsPosition.none?p.kEc:a.rowValuePosition===-1?1:a.valueFieldsInfo.length,a.options.grandTotalPosition!==e.GrandTotalPosition.none&&a.options.grandTotalPosition!==e.GrandTotalPosition.row||(b-=a.rowValuePosition===-1?1:a.valueFieldsInfo.length)),c=[],d=0,f=n;d<f.length;d++)g=f[d],c.push(g.Cj);for(o!==-1&&(s+=1,c.splice(o,0,l().Values)),m.setColCount(s),h={},i=[],j=0,k=c.length;j<k;j++)h[c[j]]=j,i.push(c[j]);a.rowFieldsMap=h,a.rowFieldsIndexes=i},b.Nc=e.PivotTableLayoutType.outline,b}(f.PivotTableLayoutBase),b.PivotTableTabularLayout=m},"./dist/plugins/pivot/pivot-table/pivot-table-spread.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),h=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),i=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),j=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js"),k=c("./dist/plugins/pivot/pivot.ns.js"),l=c("SheetsCalc"),m=c("./dist/plugins/pivot/pivot-panel/pivot-panel.js"),n=c("ConditionalFormatting"),o=c("./dist/plugins/pivot/pivot-util.js"),p=c("./dist/plugins/pivot/sheet-range-to-pivot-area.js"),q=c("Tables"),r=c("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),s=e.Common.D,t=d.Ul.JcK,u=d.Ul.McK,v=d.Util.ZaK,w=d.Util.XaK,x=d.NodeHelper.oca,y=d.NodeHelper.pca,z=d.Util.NhK,A=null,B=e.Common.j.Ca,C=new e.Common.ResourceManager(k.SR,"PivotTables"),D=C.getResource.bind(C),E="pivot",F=d.GC$,G=F.isEmptyObject,H=d.UsedRangeUtil.RZJ,I=d.UsedRangeUtil.SZJ,J=e.Common.j.Fa,K=function(){function a(a){this.WCc=[],this.kj=a,this.qIJ={},this.rIJ={}}return a.prototype.all=function(){return this.WCc.concat([])},a.prototype.add=function(a,b,c,e,f,g,j){var k,l,m,n,o=this.kj.parent,p={};return o&&(k=!o.bDc(a))?(h.hBJ(new d.Range(0,0,0,0),new d.Range(c,e,18,3),this.kj,a,!1,null,null,i.overlapCheck.value),l=o.XCc(b),l||(l=o.YCc(a,b),p.pivotCacheName=l.Cj),m=o.ZCc(l.getName(),a),n=new h.PivotTable(a,this.kj,c,e,f,g,j,m),J(p.pivotCache)||(p.fieldsModelName=m.getName()),this.Lla(n,void 0,p),this.kj.cDJ()&&this.kj.repaint(),n):null},a.prototype.Lla=function(a,b,c){a&&(this.RVa(a,"add",void 0,b,c),this.WCc.push(a),a.Vyc.addPivotView(a),this.kj.parent&&this.kj.parent.$Cc(a.name(),!0),a.iT()||a.Vyc.syc())},a.prototype.getUsedRange=function(){var a,b,c,d,e=this,f=e.all(),g={};if(f)for(a=void 0,b=0,c=f;b<c.length;b++)d=c[b],a=d.getRange(),I(g,H(a.page)),I(g,H(a.content));return g},a.prototype.RVa=function(a,b,c,d,e){var f,g,h=this,i=h.kj;i&&(g=i.ITa,g.zTa&&("add"===b?f={type:b,value:a.Cj,isMove:d,pivotType:0}:"remove"===b&&(f={type:b,value:a,index:c,isMove:d,pivotType:0,pivotCacheInfo:e}),g.SAJ(a,f)))},a.prototype.RUa=function(a){if(a){var b=this,c,d,e;a.type?(c=a.type,d=a.value,e=a.isMove):(c=a.value.type,d=a.value.value,e=a.value.isMove),"add"===c?b.TAJ(d,e):"remove"===c&&b.UAJ(a.value)}},a.prototype.TAJ=function(a,b){this.Ola(a,b)},a.prototype.UAJ=function(a){var b,c=this.WCc,d=a.value,e=a.index,g=this.kj,h=g.parent;this.WCc=c.slice(0,e).concat(d).concat(c.slice(e)),b=d.Vyc,f.Yxc(b.nyc,function(a){a instanceof m.PivotPanel&&a.attach(d)}),b.syc(),h&&(h.$Cc(d.Cj,!1),h.O4J&&h.O4J.undoRemovingPivotTable(d),a.pivotCacheInfo&&h.RUJ(a.pivotCacheInfo,!0)),g.repaint()},a.prototype.adrs=function(){var a,b=this;b.aDc={},b.WCc=[],a=this.kj&&this.kj.parent,a&&a.AO&&a.AO.reset(),this.kj&&this.kj.repaint()},a.prototype.iBJ=function(a,b,c,d){var e,f,g,h,i,j=this.all();for(e=0;e<j.length;e++)if(f=j[e],g=f.getRange(),h=g.page,i=g.content,h&&h.intersect(a,b,c,d)||i.intersect(a,b,c,d))return this.kj.Os(10,D().PivotTableErrorMessage_MakeChange),!1;return!0},a.prototype.remove=function(a){var b=this.WCc,c=b.length;c>0&&(this.Ola(a,!1),this.kj.repaint())},a.prototype.Ola=function(a,b){var c,d,e,g,h=this.WCc,i=h.length,j=this.kj&&this.kj.parent;for(c=i-1;c>=0;c--)if(h[c].Cj===a){d=h[c].Vyc,e=this.WCc.splice(c,1)[0],g=void 0,b||(g=j&&j.SUJ(d.getName())),this.RVa(e,"remove",c,b,g),b||f.Yxc(d.nyc,function(a){a instanceof m.PivotPanel&&a.detach()}),j&&j.$Cc(a,!1),j&&j.O4J&&j.O4J.undoAddingPivotTable(e);break}this.kj.repaint()},a.prototype.get=function(a){var b,c,d;for(b=0,c=this.WCc;b<c.length;b++)if(d=c[b],d.Cj===a)return d;return null},a.prototype.hyc=function(){var a,b,c,d=this.WCc;for(a=0,b=d;a<b.length;a++)c=b[a],this.remove(c.name());this.WCc=[]},a.prototype.findPivotTable=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(this.qIJ[a]&&this.rIJ[b]){for(c=0,d=this.WCc;c<d.length;c++)if(e=d[c],f=e.getRange().content,g=f.row,h=f.col,i=f.rowCount,j=f.colCount,k=e.sAc,l=!1,k&&(m=k.row,n=k.col,o=k.rowCount,p=k.colCount,l=a>=m&&a<o+m&&b>=n&&b<n+p),a>=g&&a<i+g&&b>=h&&b<h+j||l)return e;return A}},a.prototype.sIJ=function(){var a=this;a.qIJ={},a.rIJ={},f.Yxc(a.WCc,function(b){b.sIJ(a.qIJ,a.rIJ)})},a.prototype.vCJ=function(a,b,c,d){return!J(a)&&(this.pIJ(a)&&h.hBJ(a,b,c,d,!1))},a.prototype.pIJ=function(a){var b,c,d,e,f,g=this;if(0===g.WCc.length)return!1;for(b=0;b<g.WCc.length;b++){if(c=g.WCc[b],d=c.getRange(),e=d.content,f=d.page,f&&(f.containsRange(a)||f.intersect(a.row,a.col,a.rowCount,a.colCount)&&f.union(e).containsRange(a)))return!0;if(e.containsRange(a))return!0}return!1},a.prototype.dB=function(a,b){var c=this,d=o.uCJ(this.kj,a);return b&&f.Yxc(d,function(a){var b,d,e=c.WCc;for(b=0;b<e.length;b++)d=e[b],d.Cj===a.name&&(a.pt=d,c.Ola(d.Cj,!0))}),d},a.prototype.eB=function(a,b,c,d,e,g,h,i,j,k){function l(a,b){var c=a.getRange().page;return c&&(b+=c.rowCount+1),b}f.Yxc(a,function(a){var c,d,f,i,j,m=b.pivotTables.get(a.name),n=g+a.startPoint[0],o=h+a.startPoint[1];if(k){if(c=a.pt,n=l(c,n),c.suspendLayout(),c.position(n,o,e.name()),e.name()===b.name()){for(d=a.pt.Vyc.nyc,f=0;f<d.length;f++)if(d[f].Cj===a.pt.Cj){d.splice(f,1);break}e.pivotTables.Lla(a.pt,!0)}c.resumeLayout()}else i=m.serialize(),n=l(m,n),j=m.clone(m.name(),e,n,o),e.pivotTables.Lla(j),j.pOc(i,1023)})},a.prototype.getRangePivotAreas=function(a){var b,c,d,e,g,h=this,i=[];for(i=o.rHJ(h.kj,a),b={},c=function(a){var c=h.get(a),d=i[a],e=[];f.Yxc(d,function(a){e=e.concat.apply(e,p.rangeToAreas(c,a))}),b[c.Cj]=e},d=0,e=Object.keys(i);d<e.length;d++)g=e[d],c(g);return b},a.prototype.Os=function(a,b){var c=this,e=c.kj;e&&(a?(c.yJJ&&e.Wq(d.Events.InvalidOperation,{sheet:e,sheetName:e.name(),invalidType:c.yJJ.type,message:c.yJJ.args},!0),c.yJJ=A):!b||!b.args.force&&c.yJJ||(c.yJJ=b))},a.prototype.jmK=function(a,b,c){var d,e,f,g=this;return"number"==typeof c&&(d=g.findPivotTable(a,b),!!(d&&d.options.enableDataValueEditing&&d.L1J(a,b))&&(e=d.getNodeInfo(a,b),f=d.getNodeValue(e),f!==c&&(d.kmK(e,c,!0),!0)))},a}(),b.PivotTableManager=K;function L(a,b,c){var d,e,f,g,h=b.sAc,i=b.rAc;if(!J(h))for(d=0;d<h.rowCount;d++)for(e=h.row+d,J(a[e])&&(a[e]={}),f=0;f<h.colCount;f++)g=h.col+f,J(a[e][g])&&(a[e][g]={}),c(a[e][g],b.getValue(e,g));if(!J(i))for(d=0;d<i.rowCount;d++)for(e=i.row+d,J(a[e])&&(a[e]={}),f=0;f<i.colCount;f++)g=i.col+f,J(a[e][g])&&(a[e][g]={}),c(a[e][g],b.getValue(e,g))}function M(a,b,c){var e=a.row,f=void 0===e?-1:e,g=a.col,h=void 0===g?-1:g,i=a.rowCount,j=void 0===i?c.getRowCount():i,k=a.colCount,l=void 0===k?c.getColumnCount():k,m=new d.Range(f,h,j,l),n=b.getRange(),o=n.page,p=n.content,q=p;return o&&(q=p.union(o)),m.containsRange(q)}function N(a,b,c){var d=a.row,e=void 0===d?-1:d,f=a.col,g=void 0===f?-1:f,h=a.rowCount,i=void 0===h?c.getRowCount():h,j=a.colCount,k=void 0===j?c.getColumnCount():j,l=b.getRange(),m=l.page,n=l.content;return m?m.intersect(e,g,i,k)||n.intersect(e,g,i,k):n.intersect(e,g,i,k)}function O(a,b,c,d){var e,f,g,h,i;return"deletingRows"===d||"deletingColumns"===d||"clear"===d?!N(a,b,c)||M(a,b,c):"addingRows"===d?(e=b.getRange(),f=e.page,g=e.content,h=g,f&&(h=g.union(f)),!N(a,b,c)||a.row<=h.row):"addingColumns"===d?(i=b.getRange(),f=i.page,g=i.content,h=g,f&&(h=g.union(f)),!N(a,b,c)||a.col<=h.col):void 0}F.extend(d.Worksheet.prototype,{ptWm:function(a,b,c){return c?D().wmk1:a===-1?c?D().wmk1:D().wmk2:void 0},qAc:function(a,b){var c,d,e,f,g=this,h=g.pivotTables.findPivotTable(a,b);return h&&(e=g.getParent(),e&&e.options.enableAccessibility&&(f=h.jOc(a,b,!0),f&&setTimeout(function(){e.EHb(f)},0)),c=h.getValue(a,b),d=!0),{value:c,inPivot:d}},tAc:function(a,b){var c,e,f,g,h,i,k,l,m,n,o=b.ctx,p=b.clipRect,q=a.position(),r=q.row,s=q.col,t=18,u=3,v=0,w=0,x=0,y=0,z=this.getActiveColumnIndex(),A=this.getActiveRowIndex(),B=new d.Range(r,s,t,u),C=a.getName(),E=D().EmptyPivotTable_PromptMessage1;for(z>=s&&z<s+u&&A>=r&&A<r+t&&!this.options.isProtected&&(E=D().EmptyPivotTable_PromptMessage2),c=0;c<t;c++)w+=this.Sl(r+c);for(e=0;e<u;e++)v+=this.Tl(s+e);for(f=0;f<=2;f++)for(g=0;g<=2;g++)h=this.getRangeRect(f,g,B),i=h.x,k=h.y,l=h.width,m=h.height,n=new d.Rect(i,k,l,m),p=this.am().Ft(f,g),p&&0!==p.width&&0!==p.height&&p.intersectRect(n)&&(x=0===g?n.x:n.x-(v-n.width),y=0===f?n.y:n.y-(w-n.height),j.nAc(o,C,x,y,w,v,p,E))},_Cc:function(a,b){var c=this.pivotTables;return c.findPivotTable(a,b)}}),d.Worksheet.$n("pivotTable",{init:function(){var a,b,c,d,e=this,f=e.pivotTables,g=e.parent;if(!J(f)&&!J(g)&&(a=f.all(),a&&a.length>0))for(b=0,c=a;b<c.length;b++)d=c[b],g.$Cc(d.name(),!1);this.pivotTables=new K(this)},getUsedRange:function(a){var b,c,e;a.type&d.UsedRangeType.pivottable&&(b=this,c=b.pivotTables,e=c.getUsedRange(),I(a.range,e))},dispose:function(a){a.clearCache!==!1&&(this.pivotTables&&this.pivotTables.hyc(),this.pivotTables=null)},paintAdornment:function(a){var b,c,d;for(b=0,c=this.pivotTables.all();b<c.length;b++)d=c[b],d.iT()&&this.tAc(d,a)},onLayoutChanged:function(a){var b,c,e,f,g,h,i=this,j=a.changeType,k=a.row,l=a.col,m=a.rowCount,n=a.colCount,o=new d.Range(k,l,m,n),p=i.pivotTables.all();if("deletingRows"===j||"deletingColumns"===j)for(b=0;b<p.length;b++){if(c=p[b],!O(o,c,i,j)){a.canDelete=!1,i.Os(10,D().PivotTableErrorMessage_MakeChange);break}M(o,c,i)?i.pivotTables.remove(c.name()):(e=c.position(),f=e.row,g=e.col,"deletingRows"===j?o.row<f&&c.position(f-o.rowCount,g):o.col<g&&c.position(f,g-o.colCount))}else if("addingRows"===j||"addingColumns"===j)for(b=0;b<p.length;b++){if(c=p[b],!O(o,c,this,j)){i.Os(10,D().PivotTableErrorMessage_MakeChange),a.canAdd=!1;break}h=c.position(),f=h.row,g=h.col,"addingRows"===j?o.row<=f&&c.position(f+o.rowCount,g):o.col<=g&&c.position(f,g+o.colCount)}else if("clear"===j&&!a.ignorePivotTable)for(b=0;b<p.length;b++){if(c=p[b],!O(o,c,i,j)){a.canClear=!1,i.Wq(d.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:10,message:D().PivotTableErrorMessage_MakeChange},i.vxb);break}M(o,c,i)&&i.pivotTables.remove(c.name())}},allowStartEdit:function(a){var b,c,d,e,f,g,h=this,i=a.row,j=a.col;if(h.pivotTables)for(b=h.pivotTables.all(),c=0;c<b.length;c++)if(d=b[c],e=d.getRange(),f=e.page,g=e.content,(f&&f.contains(i,j)||g&&g.contains(i,j))&&(!d.options.enableDataValueEditing||!d.L1J(i,j)))return void(a.isAllow=!1)},fromJson:function(a,b,c){var e,f,j,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=this,D=C.parent;if(!(J(D)||c&&c.ignoreStyle)&&(e=D.AO,f=a.pivotTables,e&&f&&f.length>0))for(j=0;j<f.length;j++)k=f[j],m=e.getPivotCacheByCacheId(+k.cacheId),m&&!G(m.HL)&&(n=new g.PivotFieldsModel(k.name,k.cacheId,e,this.parent.wu),D.uAc[k.name]=n,o=l.formulaToRanges(C,k.ref,0,0,!0)[0].ranges,p=k.pageFields,q=k.rowPageCount,r=k.colPageCount,p&&p.length>0&&o[0].row>1&&(s=new d.Range(o[0].row-q-1,o[0].col,q,3*r-1),C.clear(s.row,s.col,s.rowCount,s.colCount,3,d.StorageType.data|d.StorageType.style)),C.clear(o[0].row,o[0].col,o[0].rowCount,o[0].colCount,3,d.StorageType.data|d.StorageType.style),t=new h.PivotTable(k.name,C,o[0].row,o[0].col,null,null,null,n),t.suspendLayout(),u=k.outline,v=k.compact,w=k.outlineData,x=k.compactData,k.fields&&k.fields.length>0&&(y=k.fields[0],t.options.insertBlankLineAfterEachItem=y.insertBlankRow,t.options.subTotalsPosition=y.defaultSubtotal===!1?i.SubtotalsPosition.none:y.subtotalTop===!1?i.SubtotalsPosition.bottom:i.SubtotalsPosition.top,z=y.outline,A=y.compact,u===!0&&w===!0&&v===!1&&x===!1&&A===!1?t.layoutType(i.PivotTableLayoutType.outline):z===!1?t.layoutType(i.PivotTableLayoutType.tabular):u===!0&&w===!0&&t.layoutType(i.PivotTableLayoutType.compact)),n.fromJson(k,t),t.fromJson(k,a),C.pivotTables.Lla(t),t.resumeLayout(),n.syc(),B=t.rAc,J(B)||(C.getColumnCount()<B.col+B.colCount&&C.setColumnCount(B.col+B.colCount),C.getRowCount()<B.row+B.rowCount&&C.setRowCount(B.row+B.rowCount)))},toJson:function(a,b){var c,d,e,f,g=this,h=g.pivotTables.all();if(h&&h.length>0)if(c=void 0,J(a.data.dataTable)&&(a.data.dataTable={}),c=a.data.dataTable,b&&b.ignoreStyle)for(d=0;d<h.length;d++)e=h[d],e.toJson(a,b);else for(f=a.pivotTables=[],d=0;d<h.length;d++)e=h[d],f.push(e.toJson(a,b)),L(c,e,function(a,b){a.value=b})},setName:function(a){var b,c,d=this.getParent(),e=d&&d.AO,f=e&&e.ZBc;if(!J(f))for(b in f)f.hasOwnProperty(b)&&(c=f[b],!J(c.sheet)&&a&&c.sheet===a.oldName&&(c.sheet=a.newName,J(c.sourceName)&&"string"==typeof c.XDc&&(c.XDc=a.newName+"!"+c.XDc.split("!")[1])))},lastNonNullRowAndCol:function(){var a,b,c,d,e,f,g=this,h=g.pivotTables,i=0,j=0,k=h.all();if(k)for(d=0,e=k;d<e.length;d++)f=e[d],a=f.getRange(),b=Math.max(a.page?a.page.row+a.page.rowCount:-1,a.content.row+a.content.rowCount)-1,c=Math.max(a.page?a.page.col+a.page.colCount:-1,a.content.row+a.content.colCount)-1,i=Math.max(i,b),j=Math.max(j,c);return{lastNonNullRow:i,lastNonNullCol:j}},cdK:function(a,b,c){var e,f,j,k,m,n,o,p,q,r,s,u,v,w,y,z,A,B,C,D,E,F,H,I,K,L,M,N,O,P,Q,R=this,T=R.parent,U=T&&T.NjK&&T.NjK.sheetsState,V=T&&T.NjK&&T.NjK.refSheetsState;if(c&&c.includeStyles===!1){if(e=!1,!U)return;if(Object.keys(U).forEach(function(a){2!==U[a]&&1!==U[a]||(e=!0)}),!e||T.getActiveSheet()===R)return}if(T){if(f=T.AO,j=R,k=a,m=k.rels&&k.rels.c_,U&&2===U[j.name()]||V&&2===V[j.name()])return;for(n=0;n<m.length;n++)if(o=m[n],p=o.Type,p===d.RelationshipConstants.ucK&&(q=o.Target,r=q.split("/").pop().slice(0,-4),s=b.pivotTables,s&&(u=s[r],f))){if(v=f.getPivotCacheByCacheId(+u.cacheId),T.uAc[u.name]&&(u.name=S(u.name,Object.keys(T.uAc))),!v||G(v.HL)||T.uAc[u.name])continue;w=new g.PivotFieldsModel(u.name,u.cacheId,f,R.parent.wu),T.uAc[u.name]=w,y=t(u,"location"),z=l.formulaToRanges(j,y.ref,0,0,!0)[0].ranges,A=t(u,"pageFields"),B=+y.rowPageCount,C=+y.colPageCount,A&&z[0].row>1&&(D=new d.Range(z[0].row-B-1,z[0].col,B,3*C-1),j.clear(D.row,D.col,D.rowCount,D.colCount,3,d.StorageType.data|d.StorageType.style)),j.clear(z[0].row,z[0].col,z[0].rowCount,z[0].colCount,3,d.StorageType.data|d.StorageType.style),E=new h.PivotTable(u.name,j,z[0].row,z[0].col,null,null,null,w),E.suspendLayout(),F=x(u.outline),H=x(u.compact),I=x(u.outlineData),K=x(u.compactData),L=t(u,"pivotFields"),M=L&&L.c_,M&&(N=M[0],E.options.insertBlankLineAfterEachItem=x(N.insertBlankRow),E.options.subTotalsPosition=x(N.defaultSubtotal)===!1?i.SubtotalsPosition.none:x(N.subtotalTop)===!1?i.SubtotalsPosition.bottom:i.SubtotalsPosition.top,
O=x(N.outline),P=x(N.compact),F===!0&&I===!0&&H===!1&&K===!1&&P===!1?E.layoutType(i.PivotTableLayoutType.outline):O===!1?E.layoutType(i.PivotTableLayoutType.tabular):F===!0&&I===!0&&E.layoutType(i.PivotTableLayoutType.compact)),w.cdK(u,E),E.cdK(u,b,k),j.pivotTables.Lla(E),E.resumeLayout(),w.syc(),Q=E.rAc,J(Q)||(j.getColumnCount()<Q.col+Q.colCount&&j.setColumnCount(Q.col+Q.colCount),j.getRowCount()<Q.row+Q.rowCount&&j.setRowCount(Q.row+Q.rowCount))}}},bdK:function(a,b,c){var e,f,g,i,j,k,l,m,n,o,p,q,r,s,u,v=this,x=v.pivotTables.all();if(x&&x.length>0)if(e=t(a,"sheetData"),J(e)&&(e={n_:"sheetData"}),a.rels||(a.rels={}),f=b.sharedStrings,g=a.rels,c&&c.includeStyles===!1)for(i=0;i<x.length;i++)j=x[i],k=j.ys.szc,l=k[0],m=k[1],n=k[2],o=k[3],p=k[4],q=j.sAc,r=j.getRange().content,h.synchronizeDataTable(q.row+l.nU,q.col+l.hF,e,l.dataTable,function(a,b){h.setDataForSJSPivotTable(a,b,f)}),h.synchronizeDataTable(r.row+m.nU,r.col+m.hF,e,m.dataTable,function(a,b){h.setDataForSJSPivotTable(a,b,f)}),h.synchronizeDataTable(r.row+n.nU,r.col+n.hF,e,n.dataTable,function(a,b){h.setDataForSJSPivotTable(a,b,f)}),h.synchronizeDataTable(r.row+o.nU,r.col+o.hF,e,o.dataTable,function(a,b){h.setDataForSJSPivotTable(a,b,f)}),h.synchronizeDataTable(r.row+p.nU,r.col+p.hF,e,p.dataTable,function(a,b){h.setDataForSJSPivotTable(a,b,f)});else for(i=0;i<x.length;i++)j=x[i],L(e,j,function(a,b){h.setDataForSJSPivotTable(a,b,f)}),s=w(g),u=d.XFileConstants.abK+s,g.c_.push({n_:d.XFileConstants.dbK,Id:u,Type:d.RelationshipConstants.ucK,Target:"../"+d.XFileConstants.ybK+"s/"+d.XFileConstants.ybK+j.mjK+"."+d.XFileConstants.r8})}}),d.Workbook.$n("pivotTable",{adlc:function(a){var b,c,d=a.flg,e=a.checkRs,f=a.m,g=a.d,h=a.nl,i=a.fn,j="p",k=["able","ivotT"],l=this.ptWm||this.parent&&this.parent.ptWm;d&&d.indexOf(j.toUpperCase()+k[1]+k[0])===-1?(e.wm=e.wm||[],b=l&&l(f,g,!0),b&&e.wm.push(b),e.nwm=!0,1!==h&&K&&(c=K.prototype.Lla,K.prototype.Lla=function(){c.apply(this,arguments),this.WCc=[]}),e.state=[j+"te",0],e.dis="7069766f745461626c6573",this.parent&&i&&i(this,e.dis,"ad")):f===-1&&(e.wm=e.wm||[],b=l&&l(f,g,!1),b&&e.wm.push(b),e.nwm=!0)},setHost:function(){},init:function(){this.K1J(),d.Commands.VCc(this.commandManager())},dispose:function(){if(this.AO){this.AO.dispose(),this.AO=null;for(var a in this.uAc)this.uAc.hasOwnProperty(a)&&this.uAc[a].dispose();this.uAc=null,this.aDc=null,this.cKJ=null}},preFromJson:function(a,b,c){var d,e,f;if(this.K1J(),d=this.AO,e=a.pivotCaches,!J(d)){if(d.dispose(),c&&c.ignoreStyle)return;d.fromJson(e)}for(f in this.uAc)this.uAc.hasOwnProperty(f)&&this.uAc[f]&&this.uAc[f].dispose();this.uAc={}},preFromSJSFormat:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,s,w,z,A,B,C,D,E,F,G,H,I,K,L;if(this.K1J(),d=this.AO,!J(d)){if(d.dispose(),c&&c.includeStyles===!1)return;if(e=b.styleManager,f=a.styles,g=f.tableStyles,g&&(e.addDefaultStyleName("defaultPivotStyle",g.defaultPivotStyle||"PivotStyleLight16"),h=y(g.count,0),h>0&&(i=u(g,"tableStyle"))))for(j=0,k=[].concat(i);j<k.length;j++)l=k[j],x(l.table)||(m=new r.PivotTableTheme,m.cdK(l,e));if(n=t(a.workbook,"pivotCaches"),o=!1,n)for(p=n.c_,q=a.pivotCache,s=0;s<p.length;s++)if(w=p[s],z=w["r:id"],A=w.cacheId,B=v(a.workbook.rels.c_,z)){if(C=B.Target,D=C.split("/").pop().slice(0,-4),E=q&&q[D],!E)return;F=E["r:id"],G=void 0,J(F)||(H=v(E.rels.c_,F),I=H&&H.Target,K=I.split("/").pop().slice(0,-4),G=q[K]),d.cdK(E,A,G),o=!0}o||d.resetDataAnalyzer()}for(L in this.uAc)this.uAc.hasOwnProperty(L)&&this.uAc[L]&&this.uAc[L].dispose();this.uAc={}},initCustomName:function(){var a,b,c,d,e,g,h=this;if(h.AO&&(a=h.AO.ZBc))for(b in a)a.hasOwnProperty(b)&&(c=a[b],f.Fa(c)||(d="pivot"+c.Cj,e=c.XDc,e.indexOf("!")>0&&(g=e.split("!"),e=o.getSheetNameForFormula(g[0])+"!"+g[1]),f.Fa(e)||""===e||(h.Yu(h.cKJ,d,e,null,null,!0,null),(J(c.nBc)||c.nBc.length<1)&&h.kLc(c.Cj,c))))},toJson:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(!b||!b.ignoreStyle){for(c=this,d=c.AO,e=c.sheets,f={},g=0;g<e.length;g++)for(h=e[g],i=h.pivotTables.all(),j=0;j<i.length;j++)if(k=i[j],k&&(l=k.Vyc.iyc,J(f[l])&&(f[l]={}),m=k.Vyc.oyc))for(n in m)m.hasOwnProperty(n)&&3!==m[n]&&(f[l][n]=!0);for(o={},p=0,q=e;p<q.length;p++)if(h=q[p],h.pivotTables&&h.pivotTables.WCc)for(r=0,s=h.pivotTables.WCc;r<s.length;r++)k=s[r],o[k.Vyc.iyc]=1;a.pivotCaches=d&&d.toJson(f,Object.keys(o)),t=P(a.pivotCaches,c),Object.keys(t).forEach(function(b){var c=t[b],d=a.pivotCaches[b];c&&d&&Object.keys(c).forEach(function(a){d[a]=c[a]})})}},onCultureChanged:function(){D(),f.getSR()},bdK:function(a,b,c){var e,g,h,i,j,k,l,m,n,o,p,q,r,s,u,v,w,x,y,A,B,C,D,E,F,G,H;if(!c||c.includeStyles!==!1){for(e=this,g=e.AO,h=e.sheets,i={},j=0;j<h.length;j++)for(k=h[j],l=k.pivotTables.all(),m=0;m<l.length;m++)if(n=l[m],n&&(o=n.Vyc.iyc,J(i[o])&&(i[o]={}),p=n.Vyc.oyc))for(q in p)p.hasOwnProperty(q)&&3!==p[q]&&(i[o][q]=!0);for(r={},s=0,u=h;s<u.length;s++)if(k=u[s],k.pivotTables&&k.pivotTables.WCc)for(v=0,w=k.pivotTables.WCc;v<w.length;v++)n=w[v],r[n.Vyc.iyc]=1;x=g.bdK(i,Object.keys(r)),y=P(g.ZBc,e),Object.keys(y).forEach(function(a){var b,c=y[a],d=x[a],e=t(d.pivotCacheDefinition,"cacheSource");c&&e&&(c.sourceType&&(e.type=c.sourceType),"worksheet"===c.sourceType&&(b={n_:"worksheetSource"},f.Fa(c.sourceName)||(b.name=c.sourceName),f.Fa(c.ref)||(b.ref=c.ref),f.Fa(c.sheet)||(b.sheet=c.sheet),e.c_=[b]))}),A=Object.keys(x),B={},A.length>0&&(C=a.workbook.rels,D=C.c_,E=D.length,F=a.pivotCache={},G={n_:"pivotCaches",c_:[]},H=G.c_,A.forEach(function(a,b){var c,e=x[a],f=e.pivotCacheDefinition,g=e.pivotCacheRecords,h=e.cacheId,i=b+1,j=d.XFileConstants.jjK+"/"+d.XFileConstants.wbK+i+"."+d.XFileConstants.r8;B[a]=j,c=d.XFileConstants.abK+(E+1+b),D.push({n_:d.XFileConstants.dbK,Id:c,Type:d.RelationshipConstants.scK,Target:j}),H.push({n_:"pivotCache",cacheId:h,"r:id":c}),F["pivotCacheDefinition"+i]=f,F["pivotCacheRecords"+i]=g,f.rels={n_:d.XFileConstants.cbK,xmlns:d.RelationshipConstants.k9,c_:[{n_:d.XFileConstants.dbK,Id:"rId1",Type:d.RelationshipConstants.tcK,Target:d.XFileConstants.xbK+i+"."+d.XFileConstants.r8}]}}),a.workbook.c_||(a.workbook.c_=[]),a.workbook.c_.push(G)),h.forEach(function(e){var f,g,h,i,j,k,l,m=e.pivotTables.all(),n=z(a,e.name());if(m&&m.length>0)for(a.pivotTables||(a.pivotTables={}),f=a.pivotTables,g=0;g<m.length;g++)h=m[g],i=h.bdK(n,b,c),j=d.XFileConstants.ybK+h.mjK,f[j]=i,k=h.Vyc.iyc,l=B[k],i.rels={n_:d.XFileConstants.cbK,xmlns:d.RelationshipConstants.k9,c_:[{n_:d.XFileConstants.dbK,Id:"rId1",Type:d.RelationshipConstants.scK,Target:"../"+l}]}})}}});function P(a,b){var c,e,f,g,h,i,j,k,m,n={};for(c in a)if(a.hasOwnProperty(c)&&(n[c]={},e=a[c],f=e.XDc,"string"==typeof f&&f.indexOf("!")>0&&(g=f.split("!"),f=o.getSheetNameForFormula(g[0])+"!"+g[1]),!J(f)&&"string"==typeof f)){h=void 0;try{if(h=l.formulaToExpression(d.UCJ(b),f,0,0,!0),h.lj){i=h.lj,n[c].sourceType="worksheet",n[c].sourceName=i.name();continue}}catch(a){}j=void 0;try{if(k=void 0,m=void 0,j=l.formulaToRanges(d.UCJ(b),f,0,0),j[0]&&j[0].ranges){if(n[c].sourceType="worksheet",h&&8===h.type&&h.value){n[c].sourceName=h.value;continue}k=j[0].sheetName,m=j[0].ranges[0],n[c].sheet=k,n[c].ref=l.rangeToFormula(m,0,0,15);continue}}catch(a){}f.indexOf("!")>0?(g=f.split("!"),n[c].sourceType="worksheet",n[c].sheet=g[0],n[c].ref=g[1]):(n[c].sourceType="worksheet",n[c].sourceName=f)}return n}F.extend(d.Workbook.prototype,{ZCc:function(a,b){var c,d=this.AO;return this.bDc(b)&&g.throwError(D().RepeatName),d.hasPivotCache(a)||g.throwError("pivot cache not exist"),c=new g.PivotFieldsModel(b,a,d,this.wu),this.uAc[b]=c,c},ptWm:function(a,b,c){return c?D().wmk1:a===-1?c?D().wmk1:D().wmk2:void 0},addPivotLayoutModelWithExistCache:function(a,b){var c=this.AO;c.hasPivotCache(b)||g.throwError(D().NotExist),this.uAc[a]=new g.PivotFieldsModel(a,b,c)},bDc:function(a){return!!this.aDc[a]},$Cc:function(a,b,c){b?this.aDc[a]=1:delete this.aDc[a],J(c)||delete this.aDc[c]},RUJ:function(a,b){b?J(a.fieldsModel)||(this.uAc[a.fieldsModel.getName()]=a.fieldsModel,this.AO.ZBc[a.fieldsModel.iyc]=a.pivotCache):(delete this.uAc[a.fieldsModelName],delete this.AO.ZBc[a.pivotCacheName])},iua:function(a){var b=this.AO;return b.hasPivotCache(a)?(a+="1",this.iua(a)):a},lTJ:function(a){var b,c,d,e,g=this,i=[];for(b=0,c=Object.keys(g.uAc);b<c.length;b++)d=c[b],e=g.uAc[d],e.iyc===a&&f.Yxc(e.nyc,function(a){if(a instanceof h.PivotTable)return i.push(a.getName()),!0});return i},SUJ:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q=this,r=q.uAc,s=r[a];if(!J(s)){for(b=s.iyc,c=q.sheets,d=0,e=c;d<e.length;d++)if(f=e[d],g=f.pivotTables&&f.pivotTables.WCc,!J(g)&&g.length>0)for(h=0,i=g;h<i.length;h++)if(j=i[h],j.wzc&&j.wzc.Cj===a)return;for(k=Object.keys(r),l=0,m=k;l<m.length;l++)if(n=m[l],n!==a&&r[n].iyc===b)return;return o=r[a],p=q.AO.ZBc[b],delete r[a],delete q.AO.ZBc[b],{fieldsModel:o,pivotCache:p}}},YCc:function(a,b){var c,e,h,i,j,k,m,n,p,q,r,s,t,u,v,w,x,y,z,A,C;if(a=this.iua(a),c=null,e="",h=E+a,"string"==typeof b)try{i=l.formulaToExpression(d.UCJ(this),b,0,0,!0),i.lj?(n=i.lj,j=n.range&&n.range()||n.dataRange&&n.dataRange(),k=n.kj.name(),e=n.name(),m=e,J(this.dKJ(h))||this.eKJ(h),this.Yu(this.cKJ,h,"="+b,null,null,!0,null)):(i=l.formulaToRanges(d.UCJ(this),b,0,0,!1),i[0]&&i[0].ranges&&(k=i[0].sheetName,j=i[0].ranges[0],e=b.indexOf("!")!==-1?b:k+"!"+b,J(this.dKJ(h))||this.eKJ(h),this.Yu(this.cKJ,h,e,null,null,!0,null))),p=d.VCJ(this,k),q=new d.Range(j.row===-1?0:j.row,j.col===-1?0:j.col,j.rowCount===-1?p.getRowCount():j.rowCount,j.colCount===-1?p.getColumnCount():j.colCount),r=p.ODJ,J(r)||(c=R(r,q)),s=p.getArray(q.row,q.col,q.rowCount,q.colCount),c=J(c)?s:c.concat(s),c||g.throwError(D().SourceError)}catch(a){g.throwError(D().SourceNotIsTableNameOrFormula)}else B(b)&&B(b[0])?c=b:g.throwError(D().SourceNotIsTableNameOrFormula);for(c.length<2&&g.throwError(D().SourceDataOnlyOne),t=[],u=c[0],v=c.slice(1),w={},y=0,z=u.length;y<z;y++)A=this.DMJ(v,y),x=o.PIJ(w,u[y]),w[x]=!0,t.push({name:x,dataType:A,index:y});return C=new f.PivotCache(a,t,v,b),C.XDc=e,J(k)||(C.sheet=k),J(m)||(C.sourceName=m),this.AO.addPivotCache(C),C},DMJ:function(a,b){for(var c,d,e=!1,f=0;!e&&f<a.length;){if(c=a[f],d=typeof c[b],"number"===d)return 0;if("object"===d&&c[b]instanceof Date)return 2;if("string"===d)return 1;f+=1}return 5},kLc:function(a,b,c){var d,e,f,h,i,j,k,l,m,n,p,q,r,s,t=null,u=this,v=E+a;if("string"==typeof a){d=void 0;try{if(!u.jBJ(a,c))return;d=u.dKJ(v),d=d?d.getExpression():null,e={},f=void 0,d&&(f=d.source&&d.source.kj,d.lj?(h=d.lj,e=h.range&&h.range()||h.dataRange&&h.dataRange()):(e.row=d.row,e.col=d.column,e.rowCount=d.endRow-d.row+1,e.colCount=d.endColumn-d.column+1,e.row<0&&(e.row=0,e.rowCount=f?f.getRowCount():e.rowCount),e.colCount<0&&(e.col=0,e.colCount=f?f.getColumnCount():e.colCount)),i=f.ODJ,J(i)||(t=R(i,e)),j=f.getArray(e.row,e.col,e.rowCount,e.colCount),t=J(t)?j:t.concat(j)),(!t||t.length<2)&&g.throwError(D().SourceDataOnlyOne)}catch(a){g.throwError(D().SourceNotIsTableNameOrFormula)}}else g.throwError(D().SourceNotIsTableNameOrFormula);for(k=[],l=t[0],m=t.slice(1),n={},q=0,r=l.length;q<r;q++)s=u.DMJ(m,q),p=o.PIJ(n,l[q]),n[p]=!0,k.push({name:p,dataType:s,index:q});b.qLc(k,m),u.oLc(b.Cj)},oLc:function(a){var b,c=this,d=c.uAc;for(b in d)s(d,b)&&d[b].iyc===a&&d[b].lLc()},XCc:function(a){return this.AO.cDc(a)},jBJ:function(a,b){var c=this,d=this.uAc,e=Object.keys(d).map(function(a){return d[a]}),g=!0;return f.Yxc(e,function(d){g&&d.Cj!==b&&d.iyc===a&&f.Yxc(c.sheets,function(a){g&&a.options.isProtected&&a.pivotTables.get(d.Cj)&&(a.Os(10,D().PivotTableErrorMessage_Protect),g=!1)})}),g},dKJ:function(a){return a?this.cKJ[e.Common.u.Nb(a)]:void 0},fKJ:function(){var a=[];return F.each(this.UHb,function(b,c){a.push(c)}),a},eKJ:function(a){if(a){delete this.cKJ[e.Common.u.Nb(a)];var b={};b[a]=a,this.Zu(b,!1)}},mLc:function(){var a,b,c=this,d=c.uAc;for(b in d)s(d,b)&&(a=d[b],a&&a.ZJJ())},_Cc:function(a){var b,c,d,e=this.sheets;if(e)for(d=0;d<e.length;d++)if(c=e[d].pivotTables,c&&(b=c.get(a)))return b;return A},getPivotCaches:function(){var a=d.Workbook._n.find(function(a){return"pivotTable"===a.name}),b={};return a.toJson.call(this,b),b},K1J:function(){var a=this;a.AO=new f.PivotEngine,a.uAc={},a.aDc={},a.cKJ={}}});function Q(a,b){var c,d;return"Object"===b.constructor.name&&(c=l.formulaToRange(a,b.ref),d=a.pivotTables.add(b.name,b.dataRef,c.row,c.col),d&&d.fromJson(b),b=d),b}F.extend(d.lUa.prototype,{qBJ:function(a){var b=this.VAJ;return!b||!b[a]},SAJ:function(a,b){var c,d=this,e=d.zTa;e&&d.qBJ(a.Cj)&&(c=e.pivotTableChanges,c||(c=e.pivotTableChanges=[]),c.push({pivotObj:a,value:b}))},RAJ:function(a,b){var c,d=this,e=d.zTa;e&&(c=e.pivotTableChanges,c||(c=e.pivotTableChanges=[]),c.push({pivotObj:a,value:b}))},BJJ:function(a){var b,c,d,e,f={};for(b=a.length-1;b>=0;b--)c=a[b],c.pivotObj instanceof h.PivotTable&&!f[c.pivotObj.name()]&&(f[c.pivotObj.name()]=c.pivotObj);for(d in f)f.hasOwnProperty(d)&&(e=f[d],e.suspendLayout());return f},CJJ:function(a){var b,c;for(b in a)a.hasOwnProperty(b)&&(c=a[b],c.resumeLayout())},XAJ:function(a){var b,c,d=this.kj.pivotTables;for(b=a.length-1;b>=0;b--)c=a[b],d.RUa(c)},applyPivotTableChange:function(a,b){var c=a.value.type,d=this.kj.pivotTables;b?"add"===c?d.get(a.pivotObj.name)||Q(this.kj,a.pivotObj):"remove"===c&&d.get(a.pivotObj.name)&&d.Ola(a.pivotObj.name):"add"===c?d.get(a.pivotObj.name)&&d.Ola(a.pivotObj.name):"remove"===c&&(d.get(a.pivotObj.name)||Q(this.kj,a.pivotObj)),this.applyPivotTableFieldChange(a,b)},applyPivotTableFieldChange:function(a,b){var c=this.kj.pivotTables,d=c.get(a.pivotObj.name);d&&d.Vyc.fromJson(a.pivotObj,d)},YAJ:function(a,b){var c=a,d=c.value.type,e=this.kj.pivotTables;return"add"!==d&&"remove"!==d||(e.RUa(c),c.value.isMove)?void c.pivotObj.RUa(c.value):void("add"===d&&b[c.pivotObj.name()]&&delete b[c.pivotObj.name()])},$AJ:function(a){a.pivotObj.RUa(a.value),J(a.pivotObj.copyFieldsModel)&&(a.pivotObj.copyFieldsModel=a.pivotObj.clone())}}),d.lUa.$n("PivotTable",{priority:8e3,getValue:function(a){var b,c,d,e=a.row,f=a.col,g=a.sheetArea,h=this.kj,i=h.pivotTables.WCc;3===g&&i&&i.length>0&&(b=h.qAc(e,f),c=b.inPivot,d=b.value,c&&(a.isValueGet=!0,a.value=d))},setValue:function(a){var b,c,d,e,f,g,h,i=a.row,j=a.col,k=a.sheetArea,l=a.value,m=this.kj,n=m.parent&&m.parent.GBb;if(3===k){if(b=m.pivotTables.findPivotTable(i,j),!b)return;if(c=b.getRange(),d=c.page,e=c.content,d&&d.contains(i,j)||e&&e.contains(i,j))return f=!0,n?b.yq(i,j,l):b.options.enableDataValueEditing&&b.L1J(i,j)&&(g=b.getNodeInfo(i,j),h=b.setNodeValue(g,l),f=!!h),void(a.isValueSet=f)}},applyChanges:function(a){var b,c,d,e,f=this,g=a.changes,h=a.isUndo;if(g&&(b=g.pivotTableChanges)){if(c={},h)for(d=b.length-1;d>=0;d--)c[b[d].pivotObj.name]=1,0===b[d].value.pivotType?f.applyPivotTableChange(b[d],!1):f.applyPivotTableFieldChange(b[d],!1);else for(d=0;d<b.length;d++)c[b[d].pivotObj.name]=1,0===b[d].value.pivotType?f.applyPivotTableChange(b[d],!0):f.applyPivotTableFieldChange(b[d],!0);e=Object.keys(c),e.forEach(function(a){var b=f.kj.pivotTables,c=b.get(a);c&&c.refresh()})}},undo:function(a){var b,c,d,e,f,g,h,i,j,k=this;if(k.VAJ={},b=a.pivotTableChanges,k.kj.pivotTables.xJJ=!0,c={},b){for(d=k.BJJ(b),e=b.length-1;e>=0;e--)0===b[e].value.pivotType?k.YAJ(b[e],d):(k.$AJ(b[e]),c[b[e].pivotObj.Cj]=1);if(k.CJJ(d),f=Object.keys(c),g=k.kj.parent&&k.kj.parent.uAc,!J(g))for(h=0,i=f;h<i.length;h++)j=i[h],g[j]&&g[j].syc()}k.kj.pivotTables.xJJ=!1,delete k.VAJ}}),d.Worksheet.$n("PivotTable",{priority:8e3,applyEditingSetFormula:function(a){var b,c,d,e,f=a.row,g=a.col,h=a.sheetArea,i=this;if((3===h||h===A)&&(b=i.pivotTables.findPivotTable(f,g),b&&(c=b.getRange(),d=c.page,e=c.content,d&&d.contains(f,g)||e&&e.contains(f,g)&&!b.options.enableDataValueEditing)))return void(a.isAllow=!1)}}),n.ConditionalFormats&&n.ConditionalFormats.$n("pivotTable",{onRuleRemoved:function(a){var b,c,d=this,e=d.pivotTables.all(),f=a.priority;if(f)for(b=0;b<e.length;b++)c=e[b],c.oCJ(f)}}),q.Table&&q.Table.$n("pivotTable",{tableNameChanged:function(a){var b,c=this,d=c.getParent();d&&(b=d.XCc(a.oldName),b&&(b.XDc=a.newName))}});function R(a,b){var c,d,e,f,g,h,i,j,k,l=b.colCount;for(d=0;d<l;d++){c=a.rPJ(d);{if(!J(c)&&!c.isGroup)break;b.col++,b.colCount--}}for(e=[[]],g=0,h=b.colCount;g<h;g++)f=a.rPJ(b.col+g),i=void 0,f&&(j=f.caption,k=f.value,i=k,"string"==typeof j?i=j:Array.isArray(j)&&(i=j[j.length-1])),e[0][g]=i;return e}function S(a,b){var c,d="_",e=a.split(d);return isNaN(parseInt(e[e.length-1],10))?a+=d+"1":(c=e[e.length-1],e.splice(e.length-1,1,d+(parseInt(c,10)+1)),a=e.join("")),b.indexOf(a)!==-1&&(a=S(a,b)),a}},"./dist/plugins/pivot/pivot-table/pivot-table-theme.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),g=c("./dist/plugins/pivot/pivot-table/pivot-table.js"),h=e.GC$.each,i=e.GC$.isEmptyObject,j=e.Ul.Ol,k=JSON.stringify,l=JSON.parse,m=e.Ul.Pl,n=d.Common.j.Fa,o=Math.floor,p=void 0,q=null,r=e.util.McK,s=e.NodeHelper.pca,t={WHOLE_TABLE_STYLE:"wholeTableStyle",REPORT_FILTER_LABELS_STYLE:"reportFilterLabelsStyle",REPORT_FILTER_VALUES_STYLE:"reportFilterValuesStyle",FIRST_COLUMN_STRIPE_STYLE:"firstColumnStripeStyle",SECOND_COLUMN_STRIPE_STYLE:"secondColumnStripeStyle",FIRST_ROW_STRIPE_STYLE:"firstRowStripeStyle",SECOND_ROW_STRIPE_STYLE:"secondRowStripeStyle",FIRST_COLUMN_STYLE:"firstColumnStyle",HEADER_ROW_STYLE:"headerRowStyle",FIRST_HEADER_CELL_STYLE:"firstHeaderCellStyle",SUBTOTAL_COLUMN1_STYLE:"subtotalColumn1Style",SUBTOTAL_COLUMN2_STYLE:"subtotalColumn2Style",SUBTOTAL_COLUMN3_STYLE:"subtotalColumn3Style",BLANK_ROW_STYLE:"blankRowStyle",SUBTOTAL_ROW1_STYLE:"subtotalRow1Style",SUBTOTAL_ROW2_STYLE:"subtotalRow2Style",SUBTOTAL_ROW3_STYLE:"subtotalRow3Style",COLUMN_SUBHEADING1_STYLE:"columnSubheading1Style",COLUMN_SUBHEADING2_STYLE:"columnSubheading2Style",COLUMN_SUBHEADING3_STYLE:"columnSubheading3Style",ROW_SUBHEADING1_STYLE:"rowSubheading1Style",ROW_SUBHEADING2_STYLE:"rowSubheading2Style",ROW_SUBHEADING3_STYLE:"rowSubheading3Style",GRANDTOTAL_COLUMN_STYLE:"grandTotalColumnStyle",GRANDTOTAL_ROW_STYLE:"grandTotalRowStyle"},u={wholeTable:"wholeTableStyle",pageFieldLabels:"reportFilterLabelsStyle",pageFieldValues:"reportFilterValuesStyle",firstRowStripe:"firstRowStripeStyle",secondRowStripe:"secondRowStripeStyle",firstColumnStripe:"firstColumnStripeStyle",secondColumnStripe:"secondColumnStripeStyle",firstColumn:"firstColumnStyle",headerRow:"headerRowStyle",firstHeaderCell:"firstHeaderCellStyle",firstSubtotalColumn:"subtotalColumn1Style",secondSubtotalColumn:"subtotalColumn2Style",thirdSubtotalColumn:"subtotalColumn3Style",blankRow:"blankRowStyle",firstSubtotalRow:"subtotalRow1Style",secondSubtotalRow:"subtotalRow2Style",thirdSubtotalRow:"subtotalRow3Style",firstColumnSubheading:"columnSubheading1Style",secondColumnSubheading:"columnSubheading2Style",thirdColumnSubheading:"columnSubheading3Style",firstRowSubheading:"rowSubheading1Style",secondRowSubheading:"rowSubheading2Style",thirdRowSubheading:"rowSubheading3Style",lastColumn:"grandTotalColumnStyle",totalRow:"grandTotalRowStyle"},v=[t.WHOLE_TABLE_STYLE,t.REPORT_FILTER_LABELS_STYLE,t.REPORT_FILTER_VALUES_STYLE,t.FIRST_COLUMN_STRIPE_STYLE,t.SECOND_COLUMN_STRIPE_STYLE,t.FIRST_ROW_STRIPE_STYLE,t.SECOND_ROW_STRIPE_STYLE,t.FIRST_COLUMN_STYLE,t.HEADER_ROW_STYLE,t.FIRST_HEADER_CELL_STYLE,t.SUBTOTAL_COLUMN1_STYLE,t.SUBTOTAL_COLUMN2_STYLE,t.SUBTOTAL_COLUMN3_STYLE,t.BLANK_ROW_STYLE,t.SUBTOTAL_ROW1_STYLE,t.SUBTOTAL_ROW2_STYLE,t.SUBTOTAL_ROW3_STYLE,t.COLUMN_SUBHEADING1_STYLE,t.COLUMN_SUBHEADING2_STYLE,t.COLUMN_SUBHEADING3_STYLE,t.ROW_SUBHEADING1_STYLE,t.ROW_SUBHEADING2_STYLE,t.ROW_SUBHEADING3_STYLE,t.GRANDTOTAL_COLUMN_STYLE,t.GRANDTOTAL_ROW_STYLE],w=!0,x=!1,y={FIRST_ROW_STRIP_SIZE:"firstRowStripSize",SECOND_ROW_STRIP_SIZE:"secondRowStripSize",FIRST_COLUMN_STRIP_SIZE:"firstColumnStripSize",SECOND_COLUMN_STRIP_SIZE:"secondColumnStripSize"},z=[y.FIRST_ROW_STRIP_SIZE,y.SECOND_ROW_STRIP_SIZE,y.FIRST_COLUMN_STRIP_SIZE,y.SECOND_COLUMN_STRIP_SIZE],A={firstColumnStripeStyle:y.FIRST_COLUMN_STRIP_SIZE,firstRowStripeStyle:y.FIRST_ROW_STRIP_SIZE,secondColumnStripeStyle:y.SECOND_COLUMN_STRIP_SIZE,secondRowStripeStyle:y.SECOND_ROW_STRIP_SIZE},B="name",C="bold 11pt calibri",D={CONST_BORDER_LEFT:"borderLeft",CONST_BORDER_TOP:"borderTop",CONST_BORDER_RIGHT:"borderRight",CONST_BORDER_BOTTOM:"borderBottom",CONST_BORDER_HORIZONTAL:"borderHorizontal",CONST_BORDER_VERTICAL:"borderVertical"},E=["backColor","foreColor","font",D.CONST_BORDER_LEFT,D.CONST_BORDER_TOP,D.CONST_BORDER_RIGHT,D.CONST_BORDER_BOTTOM,D.CONST_BORDER_HORIZONTAL,D.CONST_BORDER_VERTICAL,"textDecoration"],F={TEXT1:"Text 1",BLACK:"rgb(0,0,0)",COLUMN_STRIPE:"rgb(140,140,140)",WHITE:"rgb(255,255,255)",BACKGROUND_COLOR:"Background 1 -15"},G=e.LineStyle.thin,H=e.LineStyle.medium,I=e.LineStyle.empty,J=e.LineStyle.double,K=function(){function a(a,b,c,d,e,f,g,i,j,k){var l=this,m=arguments;h(E,function(a,b){l[b]=m[a]})}return a.prototype.Yo=function(a,b,c,d,e){var f=this;h(E,function(g,h){h.indexOf("border")>=0?(c&&j(f[D.CONST_BORDER_LEFT])&&(a[D.CONST_BORDER_LEFT]=f[D.CONST_BORDER_LEFT]),b&&j(f[D.CONST_BORDER_TOP])&&(a[D.CONST_BORDER_TOP]=f[D.CONST_BORDER_TOP]),!d&&j(f[D.CONST_BORDER_HORIZONTAL])&&(a[D.CONST_BORDER_BOTTOM]=f[D.CONST_BORDER_HORIZONTAL]),!e&&j(f[D.CONST_BORDER_VERTICAL])&&(a[D.CONST_BORDER_RIGHT]=f[D.CONST_BORDER_VERTICAL]),e&&j(f[D.CONST_BORDER_RIGHT])&&(a[D.CONST_BORDER_RIGHT]=f[D.CONST_BORDER_RIGHT]),d&&j(f[D.CONST_BORDER_BOTTOM])&&(a[D.CONST_BORDER_BOTTOM]=f[D.CONST_BORDER_BOTTOM])):j(f[h])&&(a[h]=f[h])})},a.prototype.Uo=function(){var b=new a,c=k(this.toJSON());return b.fromJSON(l(c)),b},a.prototype.toJSON=function(){var a=this,b={};return h(E,function(c,d){var e=a[d],f=e&&e.toJSON?e.toJSON():e;b[d]=i(f)?p:f}),b},a.prototype.fromJSON=function(a,b){if(a){var c=this;h(E,function(d,f){var g,h=a[f];j(h)&&(f.indexOf("border")>=0?(g=new e.LineBorder,g.fromJSON(h,b),c[f]=g):c[f]=h)})}},a}(),b.PivotTableStyle=K,L=function(){function a(){}return a.prototype.Yo=function(a,b,c,d){var g,h,i,j,k,l,m,n,q,r,s,u,v,x,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb=this;if(!d.iT||!d.iT()){if(g=d.qo,h=gb[t.WHOLE_TABLE_STYLE](),i=gb[t.REPORT_FILTER_LABELS_STYLE](),j=gb[t.REPORT_FILTER_VALUES_STYLE](),k=gb[t.FIRST_COLUMN_STRIPE_STYLE](),l=gb[t.SECOND_COLUMN_STRIPE_STYLE](),m=gb[t.FIRST_ROW_STRIPE_STYLE](),n=gb[t.SECOND_ROW_STRIPE_STYLE](),q=gb[t.FIRST_COLUMN_STYLE](),r=gb[t.HEADER_ROW_STYLE](),s=gb[t.FIRST_HEADER_CELL_STYLE](),u=gb[t.SUBTOTAL_COLUMN1_STYLE](),v=gb[t.SUBTOTAL_COLUMN2_STYLE](),x=gb[t.SUBTOTAL_COLUMN3_STYLE](),z=gb[t.BLANK_ROW_STYLE](),A=gb[t.SUBTOTAL_ROW1_STYLE](),B=gb[t.SUBTOTAL_ROW2_STYLE](),C=gb[t.SUBTOTAL_ROW3_STYLE](),D=gb[t.COLUMN_SUBHEADING1_STYLE](),E=gb[t.COLUMN_SUBHEADING2_STYLE](),F=gb[t.COLUMN_SUBHEADING3_STYLE](),G=gb[t.ROW_SUBHEADING1_STYLE](),H=gb[t.ROW_SUBHEADING2_STYLE](),I=gb[t.ROW_SUBHEADING3_STYLE](),J=gb[t.GRANDTOTAL_COLUMN_STYLE](),K=gb[t.GRANDTOTAL_ROW_STYLE](),L=gb[y.FIRST_COLUMN_STRIP_SIZE](),M=gb[y.SECOND_COLUMN_STRIP_SIZE](),N=gb[y.FIRST_ROW_STRIP_SIZE](),O=gb[y.SECOND_ROW_STRIP_SIZE](),P=d.options.showRowHeader,Q=d.options.showColumnHeader,R=d.options.insertBlankLineAfterEachItem,S=d.getRange().content,T=d.layoutType(),U=a-S.row,V=b-S.col,W=a-d.sAc.row,X=b-d.sAc.col,Y=d.ys.szc,Z=Y[0],$=Y[1],_=Y[2],aa=Y[3],ba=Y[4],ca=U===ba.nU+ba.Xj-1,da=V===S.colCount-1,ea=U===_.nU,fa=U===_.nU+_.Xj-1,ga=U===ba.nU,ha=0===V,ia=V===aa.hF,ja=V===aa.hF+aa.OZ-1,ka=aa.lzc,la=aa.nU,ma=_.mzc,na=_.nU,oa=_.hF,pa=U-la,qa=V-oa,ra=new e.Style,ta=new e.Range(d.sAc.row,d.sAc.col,d.sAc.rowCount,d.sAc.colCount),ua=ta.contains(a,b),va=S.contains(a,b),h&&(wa=a===S.row&&va||a===ta.row&&ua,xa=a===S.row+S.rowCount-1&&va||a===ta.row+ta.rowCount-1&&ua,ya=b===S.col&&va||b===ta.col&&ua,za=b===ta.col+S.colCount-1&&va||b===ta.col+ta.colCount-1&&ua,ua&&(X-Z.hF)%3!==2&&(Aa=Z.dataTable,xa||ya||Aa[W+1]&&Aa[W+1][X]===p&&(xa=w),za||wa||Aa[W]&&Aa[W][X+1]===p&&(za=w)),h.Yo(ra,wa,ya,xa,za)),Z.getRange().contains(W,X)&&(wa=0===W,ya=0===X,xa=W===Z.Xj-1,Ba=d.Vyc.ryc(0).length,Ca=d.options.reportFilterFieldsPerColumn,Da=d.options.displayFieldsInPageFilterArea,Ea=void 0,Fa=void 0,0===Ca?0===Da?(Ea=Ba,Fa=0):(Ea=0,Fa=3*Ba):(Ea=o(Ba/Ca),Fa=3*(Ba%d.options.reportFilterFieldsPerColumn-1)),Ga=d.getRange().page,Ha=a-Ga.row,Ia=b-Ga.col,ua&&(X-Z.hF)%3!==2&&(Aa=Z.dataTable,xa||ya||Aa[W+1][X]===p&&(xa=w)),(X-Z.hF)%3===0?i&&(Ea===Ha&&Ia>Fa?ra=new e.Style:i.Yo(ra,wa,w,xa,w)):(X-Z.hF)%3===1?j&&(Ea===Ha&&Ia-1>Fa?ra=new e.Style:j.Yo(ra,wa,w,xa,w)):ra=new e.Style,sa=Z.Gq(W,X)),Ja=new e.Range(ba.nU,ba.hF,aa.Xj,_.OZ),_.getRange().contains(U,V)||Ja.contains(U,V)){if(_.getRange().contains(U,V))Q&&(r&&r.Yo(ra,ea,ia,fa,da),ma[qa]&&0!==ma[qa].grandTotalLevel&&D&&(Ka=na+1,La=Ka<U,U===Ka&&D.Yo(ra,w,ha,w,da),La&&2===ma[qa].grandTotalLevel&&D.Yo(ra,w,w,w,w)),ma[qa]&&0!==ma[qa].grandTotalLevel&&E&&(Ma=na+2,La=Ma<U,U===Ma&&E.Yo(ra,w,ha,w,da),La&&3===ma[qa].grandTotalLevel&&E.Yo(ra,w,w,w,w)),ma[qa]&&0!==ma[qa].grandTotalLevel&&F&&(Na=na+3,La=Na<U,U===Na&&F.Yo(ra,w,ha,w,da),La&&4===ma[qa].grandTotalLevel&&F.Yo(ra,w,w,w,w))),sa=_.Gq(U-_.nU,V-_.hF);else if(Oa=U-ba.nU,Pa=void 0,Qa=void 0,Ra=void 0,Sa=void 0,d.options.bandColumns&&ka[Oa]&&0!==ka[Oa].grandTotalLevel&&(Pa=L+M,Pa>0)){if(Qa=d.vNb[b],Qa===p){if(Ta=0,g)for(Ua=ba.hF;Ua<V;Ua++)g.getColumnWidth(Ua)>0&&Ta++;Qa=d.vNb[b]=Ta%Pa}Qa<L&&k?(Ra=0===Qa,Sa=da||Qa===L-1,k.Yo(ra,ga,Ra,ca,Sa)):Qa>=L&&l&&(Ra=Qa===L,Sa=da||Qa===Pa-1,l.Yo(ra,ga,Ra,ca,Sa))}Va=ma[qa],Wa=Va&&Va.grandTotalLevel%3,Xa=d.qCJ,u&&(Ka=na+1,Va&&Va.isSubtotal&&Va.collapseIndex===p&&1===Wa&&U>=Ka&&Xa>1&&(Ya=U===Ka,u.Yo(ra,Ya,w,ca,w))),v&&(Ma=na+2,Va&&Va.isSubtotal&&Va.collapseIndex===p&&2===Wa&&U>=Ma&&Xa>2&&(Ya=U===Ma,v.Yo(ra,Ya,w,ca,w))),x&&(Na=na+3,Va&&Va.isSubtotal&&Va.collapseIndex===p&&0===Wa&&U>=Na&&Xa>3&&(Ya=U===Na,x.Yo(ra,Ya,w,ca,w)))}if(Za=aa.getRange().contains(U,V),Za||Ja.contains(U,V)){if(Za&&(q&&P&&(Ya=U===$.nU,$a=V===aa.hF,_a=U===$.Xj+aa.Xj-1,ab=V===aa.OZ-1,q.Yo(ra,Ya,$a,_a,ab)),sa=aa.Gq(U-aa.nU,V-aa.hF)),Pa=void 0,Qa=void 0,Ra=void 0,Sa=void 0,bb=ka[pa],Va=ma[qa],Wa=bb&&bb.grandTotalLevel%3,cb=bb&&bb.rowHeaderLevel%3,db=d.pCJ,d.options&&d.options.bandRows&&bb&&0!==Wa&&(!Va||!Va.isSubtotal&&!Va.isGrandTotal)&&(Pa=N+O,Pa>0)){if(Qa=d.uNb[a],Qa===p){if(eb=0,g)for(fb=ba.nU;fb<U;fb++)g.getRowHeight(fb)>0&&eb++;Qa=d.uNb[a]=eb%Pa}Qa<N&&m?(Ra=0===Qa,Sa=ca||Qa===N-1,m.Yo(ra,Ra,ia,Sa,da)):Qa>=N&&n&&(Ra=Qa===N,Sa=ca||Qa===Pa-1,n.Yo(ra,Ra,ia,Sa,da))}A&&bb&&1===Wa&&bb.isSubtotal&&bb.collapseIndex===p&&(V>-1||T===f.PivotTableLayoutType.compact)&&db>1&&A.Yo(ra,w,ia,w,da),B&&bb&&2===Wa&&bb.isSubtotal&&bb.collapseIndex===p&&(V>0||T===f.PivotTableLayoutType.compact)&&db>2&&B.Yo(ra,w,ia,w,da),C&&bb&&0===Wa&&bb.isSubtotal&&bb.collapseIndex===p&&(V>1||T===f.PivotTableLayoutType.compact)&&db>3&&C.Yo(ra,w,ia,w,da),bb&&G&&P&&db>1&&!(bb.isSubtotal&&(Wa<2||cb<2)&&bb.collapseIndex===p||bb.isGrandTotal||bb.isBlankRow)&&(T!==f.PivotTableLayoutType.tabular&&bb&&1===bb.rowHeaderLevel&&!bb.isValueFieldDim||T===f.PivotTableLayoutType.tabular&&0===V)&&(T===f.PivotTableLayoutType.outline&&V<0||G.Yo(ra,ga,ia,ca,ja)),bb&&H&&P&&db>2&&!(bb.isSubtotal&&(Wa<3||cb<3)&&bb.collapseIndex===p||bb.isGrandTotal||bb.isBlankRow)&&(T!==f.PivotTableLayoutType.tabular&&bb&&2===bb.rowHeaderLevel&&!bb.isValueFieldDim||T===f.PivotTableLayoutType.tabular&&1===V)&&(T===f.PivotTableLayoutType.outline&&V<1||H.Yo(ra,ga,ia,ca,ja)),bb&&I&&P&&db>3&&!(bb.isSubtotal&&(Wa<1||cb<1)&&bb.collapseIndex===p||bb.isGrandTotal||bb.isBlankRow)&&(T!==f.PivotTableLayoutType.tabular&&bb&&3===bb.rowHeaderLevel&&!bb.isValueFieldDim||T===f.PivotTableLayoutType.tabular&&2===V)&&(T===f.PivotTableLayoutType.outline&&V<2||I.Yo(ra,ga,ia,ca,ja)),R&&z&&bb&&bb.isBlankRow&&z.Yo(ra,w,ia,w,da)}J&&(Ka=na+1,ma[qa]&&0===ma[qa].grandTotalLevel&&J.Yo(ra,U===Ka,w,ca,w)),K&&ka[pa]&&0===ka[pa].grandTotalLevel&&K.Yo(ra,w,ia,w,da),$.getRange().contains(U,V)&&(q&&P&&q.Yo(ra,ea,ia,ca,ja),r&&Q&&r.Yo(ra,ea,ia,fa,da),s&&Q&&P&&(_a=U===$.getRange().rowCount-1,s.Yo(ra,ea,ia,_a,ja)),sa=$.Gq(U,V)),gb.Oka(c,ra,sa)}},a.prototype.Oka=function(a,b,c){n(a)&&(a={});var d=a,e=20,f,g,h,i;n(d.backColor)&&(d.backColor=b.backColor),d.foreColor===p&&(d.foreColor=b.foreColor),n(d.themeFont)&&n(d.font)?(d.themeFont=b.themeFont,d.font=b.font):n(d.themeFont)||n(b.font)||(d.font=b.font),n(d.borderLeft)&&(f=b.borderLeft,d.borderLeft=f&&f.Uo()||f,d.borderLeft&&(d.borderLeft.level=e)),n(d.borderTop)&&(g=b.borderTop,d.borderTop=g&&g.Uo()||g,d.borderTop&&(d.borderTop.level=e)),n(d.borderRight)&&(h=b.borderRight,d.borderRight=h&&h.Uo()||h,d.borderRight&&(d.borderRight.level=e)),n(d.borderBottom)&&(i=b.borderBottom,d.borderBottom=i&&i.Uo()||i,d.borderBottom&&(d.borderBottom.level=e)),n(d.textDecoration)&&(d.textDecoration=b.textDecoration),n(d.cellType)&&(d.cellType=b.cellType),n(d.formatter)&&(d.formatter=b.formatter),n(c)||(n(d.cellButtons)&&!n(c.cellButtons)&&(d.cellButtons=c.cellButtons),n(d.textIndent)&&!n(c.textIndent)&&(d.textIndent=c.textIndent),n(d.cellPadding)&&!n(c.cellPadding)&&(d.cellPadding=c.cellPadding))},a.prototype.toJSON=function(){var a,b,c=this,d=c.builtInName();return d?{buildInName:d}:(a={name:c.name()},h(v,function(d,e){b=c[e](),b&&(a[e]=b.toJSON())}),h(z,function(d,e){b=c[e](),1!==b&&(a[e]=b)}),i(a)?p:a)},a.prototype.bdK=function(a){var b=this,c,d=[];if(h(v,function(f,g){if(c=b[g](),c||A[g]){var h={n_:"tableStyleElement",type:e.SJSStylePropsToStyleProps[g]};c&&(h.dxfId=a.getDxfIndex(c)),A[g]&&1!==A[g]&&(h.size=b[A[g]]()),d.push(h)}}),d.length>0)return d},a.prototype.fromJSON=function(a,b){var c,d,e;if(a){if(c=this,d=a.buildInName)return void ha(c,O[d.toLowerCase()]);e=a.name,j(e)&&c.name(e,x),h(z,function(b,d){var e=a[d]!==p?a[d]:a["_"+d];e&&c[d](e,x)}),h(v,function(d,e){var f,g=a[e]!==p?a[e]:a["_"+e];g&&(f=new K,f.fromJSON(g,b),c[e](f,x))})}},a.prototype.cdK=function(a,b){var c,d,f,g,i,j=this;if(j.name(a.name),c=r(a,"tableStyleElement")){for(d=function(a){var c=s(a.dxfId,0),d=a.type,f=s(a.size,1),g=new K,i=u[d||"wholeTable"];"function"==typeof j[i]&&(b.getDxf(c,g,!0),h(E,function(a,b){b.indexOf("border")>=0&&g[b]===q&&(g[b]=new e.LineBorder)}),j[i](g,!1)),"firstRowStripe"!==d&&"secondRowStripe"!==d&&"firstColumnStripe"!==d&&"secondColumnStripe"!==d||j[d.substr(0,d.length-1)+"Size"](f,!1)},f=0,g=c;f<g.length;f++)i=g[f],d(i);b.addPivotTableTheme(j)}},a}(),b.PivotTableTheme=L,h(v,function(a,b){L.prototype[b]=m(b)}),h(z,function(a,b){L.prototype[b]=m(b,1)}),L.prototype.name=m(B),L.prototype.builtInName=m("builtInName"),M="white",N="black";function P(a,b){return isNaN(b)?b:new e.LineBorder(a,b)}function Q(a,b,c,d,e,f,g,h,i,j){var k=new K;return b&&(k.backColor=b),c&&(k.foreColor=c),d&&(k.font=C),e&&(k.borderLeft=P(a,e)),f&&(k.borderTop=P(a,f)),g&&(k.borderRight=P(a,g)),h&&(k.borderBottom=P(a,h)),i&&(k.borderHorizontal=P(a,i)),j&&(k.borderVertical=P(a,j)),k}function R(a){var b;return b=0===a?"Background 1":"Accent "+a}function S(a){var b,c,d,e=a-1,f=o(e/7);return f>=0&&f<=3?(b=[U,V,W,X][f](e%7),b[y.FIRST_ROW_STRIP_SIZE](1),b[y.FIRST_COLUMN_STRIP_SIZE](1),b[y.SECOND_COLUMN_STRIP_SIZE](1),b[y.SECOND_ROW_STRIP_SIZE](1),c="Light"+a,b.name(c),b.builtInName(c)):(b=T(),d="Light0",b.name(d),b.builtInName(d)),b}function T(){return new L}function U(a){var b,c,d,e,f=R(a);return 0===a?(b=" -15",c=" -35",d=F.TEXT1+" 50"):(b=" 80",c=" 60",d=f),b=f+b,c=f+c,e=new L,e[t.WHOLE_TABLE_STYLE](Q(b,0,0,0,I,I,I,I,G)),e[t.REPORT_FILTER_LABELS_STYLE](Q(d,0,0,0,I,G,I,G)),e[t.REPORT_FILTER_VALUES_STYLE](Q(d,0,0,0,I,G,I,G)),e[t.FIRST_COLUMN_STRIPE_STYLE](Q(c,b,0,0,G,G,G,G,G,G)),e[t.FIRST_ROW_STRIPE_STYLE](Q(c,b,0,0,I,G,I,G)),e[t.HEADER_ROW_STYLE](Q(d,0,0,1,I,G,I,G)),e[t.SUBTOTAL_ROW1_STYLE](Q(b,0,0,1)),e[t.SUBTOTAL_ROW2_STYLE](Q(F.BLACK,0,0,1)),e[t.ROW_SUBHEADING1_STYLE](Q(F.BLACK,0,0,1)),
e[t.ROW_SUBHEADING2_STYLE](Q(F.BLACK,0,0,1)),e[t.GRANDTOTAL_ROW_STYLE](Q(d,0,0,1,I,G,I,G)),e}function V(a){var b,c,d,e,f,g,h=R(a);return 0===a?(b=" -15",c=" -35",e=F.TEXT1,d=F.TEXT1+" 50",f=F.COLUMN_STRIPE):(b=" 80",c=" 60",e=h+" -25",f=h,d=h),b=h+b,c=h+c,g=new L,g[t.WHOLE_TABLE_STYLE](Q(b,0,e,0,I,I,I,I,G)),g[t.FIRST_COLUMN_STRIPE_STYLE](Q(f,0,0,0,G,G,G,G)),g[t.FIRST_ROW_STRIPE_STYLE](Q(c,0,0,0,G,G,G,G)),g[t.FIRST_COLUMN_STYLE](Q(d,0,F.TEXT1,1,I,I,G)),g[t.HEADER_ROW_STYLE](Q(d,0,F.TEXT1,1,H,H,H,H)),g[t.SUBTOTAL_ROW1_STYLE](Q(c,b,F.TEXT1,1,I,I,I,G)),g[t.SUBTOTAL_ROW2_STYLE](Q(F.BLACK,0,F.TEXT1,1)),g[t.COLUMN_SUBHEADING2_STYLE](Q(c,0,0,0,I,G)),g[t.ROW_SUBHEADING1_STYLE](Q(h,b,0,1,I,I,I,G)),g[t.ROW_SUBHEADING2_STYLE](Q(F.BLACK,0,0,1)),g[t.GRANDTOTAL_ROW_STYLE](Q(d,0,F.TEXT1,1,H,H,H,H)),g}function W(a){var b,c,d,e,f=R(a),g="Background 1 -25";return 0===a?(b=" -15",c=" -35",d=F.TEXT1+" 50"):(b=" 80",c=" 40",d=f),b=f+b,c=f+c,e=new L,e[t.REPORT_FILTER_LABELS_STYLE](Q(c,b,0,0,I,I,I,G)),e[t.REPORT_FILTER_VALUES_STYLE](Q(c,b,0,0,I,I,I,G)),e[t.FIRST_COLUMN_STRIPE_STYLE](Q(g,F.BACKGROUND_COLOR,0,0,G,I,G,I)),e[t.FIRST_ROW_STRIPE_STYLE](Q(F.BLACK,F.BACKGROUND_COLOR)),e[t.HEADER_ROW_STYLE](Q(c,b,F.TEXT1,1,I,I,I,G)),e[t.SUBTOTAL_COLUMN1_STYLE](Q(F.BLACK,g,F.TEXT1)),e[t.SUBTOTAL_ROW1_STYLE](Q(d,0,0,1,I,G,I,G)),e[t.SUBTOTAL_ROW2_STYLE](Q(F.BLACK,0,0,1)),e[t.ROW_SUBHEADING1_STYLE](Q(c,0,F.TEXT1,1,I,I,I,G)),e[t.ROW_SUBHEADING2_STYLE](Q(F.BLACK,0,F.TEXT1,1)),e[t.GRANDTOTAL_ROW_STYLE](Q(c,b,F.TEXT1,1,I,G)),e}function X(a){var b,c,d,e,f,g=R(a);return 0===a?(b=" -15",c=" -35",e=F.TEXT1,d=F.TEXT1+" 50"):(b=" 80",c=" 60",e=g,d=g+" -25"),b=g+b,c=g+c,f=new L,f[t.WHOLE_TABLE_STYLE](Q(d,0,e,0,G,G,G,G,0,G)),f[t.REPORT_FILTER_LABELS_STYLE](Q(F.BLACK,0,e,1)),f[t.FIRST_COLUMN_STRIPE_STYLE](Q(F.BLACK,b)),f[t.FIRST_ROW_STRIPE_STYLE](Q(d,b,0,0,I,G,I,G)),f[t.FIRST_COLUMN_STYLE](Q(F.BLACK,0,e,1)),f[t.HEADER_ROW_STYLE](Q(d,0,e,1,I,I,I,G)),f[t.SUBTOTAL_COLUMN1_STYLE](Q(c,0,e,1,G,I,G)),f[t.SUBTOTAL_ROW1_STYLE](Q(F.BLACK,0,e,1)),f[t.SUBTOTAL_ROW2_STYLE](Q(F.BLACK,0,e,1)),f[t.GRANDTOTAL_ROW_STYLE](Q(d,0,e,1,I,G)),f}function Y(a){var b,c=a-1,d=q,e=o(c/7);return e>=0&&e<4&&(d=[Z,$,_,aa][e](c%7),d[y.FIRST_ROW_STRIP_SIZE](1),d[y.FIRST_COLUMN_STRIP_SIZE](1),d[y.SECOND_COLUMN_STRIP_SIZE](1),d[y.SECOND_ROW_STRIP_SIZE](1),b="Medium"+a,d.name(b),d.builtInName(b)),d}function Z(a){var b,c,d,e,f=R(a);return 0===a?(b=" -15",c=" -35",d=F.TEXT1+" 50"):(b=" 80",c=" 60",d=f+" -25"),b=f+b,c=f+c,e=new L,e[t.WHOLE_TABLE_STYLE](Q(b,0,F.TEXT1,0,I,I,I,I,G)),e[t.REPORT_FILTER_LABELS_STYLE](Q(b,0,0,0,I,G,I,G)),e[t.REPORT_FILTER_VALUES_STYLE](Q(b,0,0,0,I,G,I,G)),e[t.FIRST_COLUMN_STRIPE_STYLE](Q(d,0,0,0,G,I,G)),e[t.FIRST_ROW_STRIPE_STYLE](Q(d,0,0,0,I,G,I,G,G)),e[t.HEADER_ROW_STYLE](Q(d,d,F.WHITE,0,I,I,I,I,G)),e[t.FIRST_HEADER_CELL_STYLE](Q(F.BLACK,0,F.WHITE,1)),e[t.SUBTOTAL_ROW1_STYLE](Q(F.BLACK,c,F.WHITE,1)),e[t.SUBTOTAL_ROW2_STYLE](Q(F.BLACK,F.BACKGROUND_COLOR,F.TEXT1,1)),e[t.COLUMN_SUBHEADING1_STYLE](Q(b,0,0,0,I,I,I,G)),e[t.ROW_SUBHEADING1_STYLE](Q(b,c,F.WHITE,0,I,I,I,G,G)),e[t.ROW_SUBHEADING2_STYLE](Q(b,b,0,0,I,I,I,G)),e[t.GRANDTOTAL_ROW_STYLE](Q(d,0,F.TEXT1,1,I,J)),e}function $(a){var b,c,d,e,f,g,h,i=R(a);return 0===a?(b=" -15",c=F.TEXT1+" 50",d=i+" -25",e=H,f=F.TEXT1,g=F.TEXT1+" 50"):(b=" 80",c=i+" -25",d=i+" 60",e=G,f=c,g=i),b=i+b,h=new L,h[t.WHOLE_TABLE_STYLE](Q(F.BLACK,0,F.TEXT1)),h[t.REPORT_FILTER_LABELS_STYLE](Q(F.BLACK,b)),h[t.REPORT_FILTER_VALUES_STYLE](Q(F.BLACK,b)),h[t.FIRST_COLUMN_STRIPE_STYLE](Q(b,0,0,0,e,I,e)),h[t.FIRST_ROW_STRIPE_STYLE](Q(d,0,0,0,I,G,I,G,G)),h[t.HEADER_ROW_STYLE](Q(c,g,F.WHITE,1,I,e)),h[t.SUBTOTAL_COLUMN1_STYLE](Q(d,0,F.TEXT1,1,e,e,e,e)),h[t.SUBTOTAL_ROW1_STYLE](Q(F.BLACK,d,F.TEXT1,1)),h[t.SUBTOTAL_ROW2_STYLE](Q(F.BLACK,0,F.TEXT1,1)),h[t.ROW_SUBHEADING1_STYLE](Q(F.BLACK,b,F.TEXT1,1)),h[t.ROW_SUBHEADING2_STYLE](Q(F.BLACK,0,F.TEXT1,1)),h[t.GRANDTOTAL_ROW_STYLE](Q(f,0,F.TEXT1,1,I,G,I,H)),h}function _(a){var b,c,d,e,f,g,h=R(a);return 0===a?(b=" -15",c=" -35",d=F.TEXT1+" 50",e=h+" -5",f=h+" -25"):(b=" 80",c=" 60",e=h+b,f=h+c),b=h+b,c=h+c,g=new L,g[t.WHOLE_TABLE_STYLE](Q(b,e,F.TEXT1,0,G,I,G,I,I,G)),g[t.REPORT_FILTER_LABELS_STYLE](Q(F.TEXT1,0,0,0,I,G,I,G)),g[t.REPORT_FILTER_VALUES_STYLE](Q(F.TEXT1,0,F.BLACK,0,I,G,I,G)),g[t.FIRST_COLUMN_STRIPE_STYLE](Q(f,b,0,0,G,I,G)),g[t.FIRST_ROW_STRIPE_STYLE](Q(f,b,0,0,I,G,I,G)),g[t.HEADER_ROW_STYLE](Q(F.BLACK,F.TEXT1,F.WHITE)),g[t.SUBTOTAL_COLUMN1_STYLE](Q(c,f,F.TEXT1,0,G,G,G)),g[t.SUBTOTAL_ROW1_STYLE](Q(f,0,F.TEXT1,1,I,I,I,G)),g[t.SUBTOTAL_ROW2_STYLE](Q(F.BLACK,0,d,1)),g[t.ROW_SUBHEADING1_STYLE](Q(F.BLACK,0,F.TEXT1,1)),g[t.ROW_SUBHEADING2_STYLE](Q(F.BLACK,0,d,1)),g[t.ROW_SUBHEADING3_STYLE](Q(F.BLACK,0,F.TEXT1,1)),g[t.GRANDTOTAL_ROW_STYLE](Q(F.BLACK,F.TEXT1,F.WHITE)),g}function aa(a){var b,c,d,e,f=R(a);return 0===a?(b=" -15",c=F.TEXT1+" 50",d=f+" -25"):(b=" 80",c=f+" -25",d=f+" 60"),b=f+b,e=new L,e[t.WHOLE_TABLE_STYLE](Q(F.WHITE,b,c,0,I,I,I,I,G)),e[t.REPORT_FILTER_LABELS_STYLE](Q(F.BLACK,d,c,1)),e[t.REPORT_FILTER_VALUES_STYLE](Q(F.BLACK,b,c,1)),e[t.SECOND_COLUMN_STRIPE_STYLE](Q(F.BLACK,d,0)),e[t.SECOND_ROW_STRIPE_STYLE](Q(F.BLACK,d)),e[t.FIRST_COLUMN_STYLE](Q(F.BLACK,d,c,1)),e[t.HEADER_ROW_STYLE](Q(F.WHITE,0,c,1,I,I,I,G)),e[t.SUBTOTAL_ROW1_STYLE](Q(F.BLACK,0,F.TEXT1,1)),e[t.SUBTOTAL_ROW2_STYLE](Q(F.BLACK,0,F.TEXT1,1)),e[t.ROW_SUBHEADING1_STYLE](Q(F.BLACK,0,F.TEXT1,1)),e[t.GRANDTOTAL_ROW_STYLE](Q(F.BLACK,0,c,1)),e}function ba(a){var b,c=a-1,d=q,e=o(c/7);return e>=0&&e<4&&(d=[ca,da,ea,fa][e](c%7),d[y.FIRST_ROW_STRIP_SIZE](1),d[y.FIRST_COLUMN_STRIP_SIZE](1),d[y.SECOND_COLUMN_STRIP_SIZE](1),d[y.SECOND_ROW_STRIP_SIZE](1),b="Dark"+a,d.name(b),d.builtInName(b)),d}function ca(a){var b,c,d,e,f,g=R(a);return 0===a?(b=" -15",c=" -35",d=F.TEXT1+" 50",e=g+" -25"):(b=" 80",c=" 40",d=g+" -50",e=g+" 60"),b=g+b,c=g+c,f=new L,f[t.WHOLE_TABLE_STYLE](Q(b,e,F.TEXT1,0,I,I,I,I,G)),f[t.REPORT_FILTER_LABELS_STYLE](Q(d,d,F.WHITE,1,I,I,I,I,G)),f[t.REPORT_FILTER_VALUES_STYLE](Q(d,d,F.WHITE,0,I,I,I,I,G)),f[t.SECOND_COLUMN_STRIPE_STYLE](Q(b,0,0,0,G,I,G)),f[t.SECOND_ROW_STRIPE_STYLE](Q(F.BLACK,c)),f[t.HEADER_ROW_STYLE](Q(F.WHITE,d,F.WHITE,1,I,I,I,G,G)),f[t.SUBTOTAL_ROW1_STYLE](Q(c,0,F.TEXT1,1,I,I,I,G)),f[t.ROW_SUBHEADING1_STYLE](Q(c,b,F.TEXT1,1,I,G,I,G)),f[t.ROW_SUBHEADING2_STYLE](Q(F.BLACK,0,F.TEXT1,1)),f[t.GRANDTOTAL_ROW_STYLE](Q(F.BLACK,d,F.WHITE,1)),f}function da(a){var b,c,d,e,f=R(a),g=F.TEXT1+" -25";return 0===a?(b=" -15",c=F.TEXT1+" 50",d=f+" -25"):(b=" 80",d=f+" 60"),b=f+b,e=new L,e[t.WHOLE_TABLE_STYLE](Q(c,b,F.TEXT1,0,H,H,H,H)),e[t.REPORT_FILTER_LABELS_STYLE](Q(c,0,0,0,G,G,I,G)),e[t.REPORT_FILTER_VALUES_STYLE](Q(c,0,0,0,I,G,G,G)),e[t.FIRST_COLUMN_STRIPE_STYLE](Q(F.COLUMN_STRIPE,0,0,0,G,I,G)),e[t.SECOND_COLUMN_STRIPE_STYLE](Q(F.COLUMN_STRIPE,0,0,0,G,I,G)),e[t.SECOND_ROW_STRIPE_STYLE](Q(d,0,0,0,I,G,I,G)),e[t.HEADER_ROW_STYLE](Q(F.BLACK,g,F.WHITE,1)),e[t.SUBTOTAL_ROW1_STYLE](Q(F.BLACK,d,F.TEXT1,1)),e[t.COLUMN_SUBHEADING2_STYLE](Q(d,0,0,0,I,G)),e[t.COLUMN_SUBHEADING3_STYLE](Q(d,0,0,0,I,G)),e[t.ROW_SUBHEADING1_STYLE](Q(b,d,F.TEXT1,1,I,I,I,G)),e[t.ROW_SUBHEADING2_STYLE](Q(F.BLACK,0,F.TEXT1,1)),e[t.GRANDTOTAL_ROW_STYLE](Q(F.BLACK,g,F.WHITE,1)),e}function ea(a){var b,c,d,e,f,g=R(a),h=g+" -25";return 0===a?(b=" -15",c=" -35",d=F.TEXT1+" 50",e=F.COLUMN_STRIPE):(b=" 80",c=" 60",d=g+" -25",e=g),b=g+b,c=g+c,f=new L,f[t.WHOLE_TABLE_STYLE](Q(F.BLACK,e,b)),f[t.REPORT_FILTER_LABELS_STYLE](Q(F.BLACK,0,F.WHITE,1)),f[t.FIRST_COLUMN_STRIPE_STYLE](Q(h,0,0,G,I,G)),f[t.FIRST_ROW_STRIPE_STYLE](Q(c,0,0,0,I,G,I,G)),f[t.HEADER_ROW_STYLE](Q(F.BLACK,F.TEXT1,F.WHITE,1)),f[t.SUBTOTAL_COLUMN1_STYLE](Q(c,d,0,0,G,G,G,G)),f[t.SUBTOTAL_ROW1_STYLE](Q(F.BLACK,0,F.WHITE,1)),f[t.COLUMN_SUBHEADING1_STYLE](Q(c,0,0,0,I,I,I,G)),f[t.ROW_SUBHEADING1_STYLE](Q(d,d,F.WHITE,1,I,I,I,G)),f[t.ROW_SUBHEADING2_STYLE](Q(F.BLACK,0,F.WHITE,1)),f[t.GRANDTOTAL_ROW_STYLE](Q(F.BLACK,F.TEXT1,F.WHITE,1)),f}function fa(a){var b,c,d,e,f,g=R(a);return 0===a?(b=" -15",c=F.TEXT1+" 50",d=g+" -50",e=F.COLUMN_STRIPE):(b=" 80",c=g+" -25",e=g+" 40",d=g),b=g+b,f=new L,f[t.WHOLE_TABLE_STYLE](Q(F.WHITE,d,b,0,I,I,I,I,I,G)),f[t.REPORT_FILTER_LABELS_STYLE](Q(F.BLACK,c,0,0)),f[t.SECOND_COLUMN_STRIPE_STYLE](Q(F.BLACK,e,0)),f[t.SECOND_ROW_STRIPE_STYLE](Q(F.BLACK,e)),f[t.FIRST_COLUMN_STYLE](Q(F.BLACK,c)),f[t.HEADER_ROW_STYLE](Q(F.WHITE,c,0,0,I,I,I,H)),f[t.FIRST_HEADER_CELL_STYLE](Q(F.BLACK,0,F.WHITE,1)),f[t.SUBTOTAL_ROW1_STYLE](Q(F.BLACK,0,b,1)),f[t.SUBTOTAL_ROW2_STYLE](Q(F.BLACK,0,0===a?F.TEXT1:F.WHITE,1)),f[t.ROW_SUBHEADING1_STYLE](Q(F.BLACK,0,F.WHITE,1)),f[t.ROW_SUBHEADING1_STYLE](Q(F.BLACK,0,F.WHITE,1)),f[t.GRANDTOTAL_ROW_STYLE](Q(F.WHITE,0,F.WHITE,1,I,H)),f}O=function(){function a(){}return a}(),b.PivotTableThemes=O;function ga(){O.light0=S(0);for(var a=1;a<=28;a++)O["light"+a]=S(a),O["medium"+a]=Y(a),O["dark"+a]=ba(a)}ga(),e.GC$.extend(e.StyleManager.prototype,{addPivotTableTheme:function(a){var b=this,c=b.vjK;c||(c=b.vjK={}),c[a.name()]=a},getPivotTableTheme:function(a){var b,c,d=this,e=d.vjK;return e||(e=d.vjK={}),g.BuiltInPivotTableThemeNames[a.toUpperCase()]?(b=a.replace("PivotStyle","").toLowerCase(),e[b]?e[b]:(c=new L,ha(c,e[b]),d.addPivotTableTheme(c),c)):e[a]}});function ha(a,b){a.name(b.name()),h(z,function(c,d){a[d](b[d]())}),h(v,function(c,d){var e=b[d]();a[d](e?e.Uo():q)}),a.builtInName(b.builtInName(),!1)}},"./dist/plugins/pivot/pivot-table/pivot-table.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),X=this&&this.__assign||function(){return X=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},X.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("./dist/plugins/pivot/pivot-util.js"),g=c("Pivot"),h=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),i=c("./dist/plugins/pivot/pivot-core/pivot-view.js"),j=c("./dist/plugins/pivot/pivot-table/pivot-data-model.js"),k=c("SheetsCalc"),l=c("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),m=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js"),n=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js"),o=c("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js"),p=c("./dist/plugins/pivot/pivot.ns.js"),q=c("@grapecity/js-calc"),r=c("./dist/plugins/pivot/pivot-table-entry.js"),s=d.Ul.JcK,t=d.Ul.naa,u=d.NodeHelper.cjK,v=d.Ul.NcK,w=d.Ul.IcK,x=d.Ul.McK,y=d.NodeHelper.oca,z=d.NodeHelper.pca,A=d.NodeHelper.qca,B=d.Ul.lHb,C=e.Common.j,D=C.Fa,E=C.za,F=e.Common.u,G=e.Common.k,H=G.ac,I=G.Fb,J=e.Common.D,K=void 0,L=null,M=e.Common.j.C4,N=new e.Common.ResourceManager(p.SR,"PivotTables"),O=N.getResource.bind(N),P="grandTotal",Q="subtotal",R={allowMultipleFiltersPerField:!1,fillDownLabels:!1,insertBlankLineAfterEachItem:!1,grandTotalPosition:h.GrandTotalPosition.both,subTotalsPosition:h.SubtotalsPosition.bottom,subtotalsPosition:h.SubtotalsPosition.bottom,displayFieldsInPageFilterArea:h.DisplayFields.downThenOver,reportFilterFieldsPerColumn:0,bandRows:!1,bandColumns:!1,showRowHeader:!0,showColumnHeader:!0,showDrill:!0,showMissing:!0,missingCaption:L,rowLabelIndent:1,printDrill:L,itemPrintTitles:L,fieldPrintTitles:L,showFilter:!0,showToolTip:!0,mergeItem:!1,isShowErrorValue:!1,errorValueInfo:L,rowHeaderCaption:null,colHeaderCaption:null,showHeaders:!0,calcItemAggregation:h.CalcItemAggregation.include,enableDataValueEditing:!1},S="4294967294";function Y(){var a,b={};for(a=1;a<=28;a++)b["PIVOTSTYLELIGHT"+a]=!0,b["PIVOTSTYLEMEDIUM"+a]=!0,b["PIVOTSTYLEDARK"+a]=!0;return b}b.BuiltInPivotTableThemeNames=Y(),T=function(){function a(a,b){this.lHJ=a,this.mHJ=b,this.views=[]}return a.prototype.save=function(a){var b,c=this;return!D(a)&&c.RS(a)===L&&(b=c.mHJ(),c.views.push({name:a,config:b}),!0)},a.prototype.add=function(a){var b=this;return!D(a.name)&&b.RS(a.name)===L&&(b.views.push(a),!0)},a.prototype.remove=function(a){var b=this,c=b.RS(a);c!==L&&b.views.splice(c,1)},a.prototype.get=function(a){var b=this,c=b.RS(a);if(c!==L)return b.views[c]},a.prototype.all=function(){return this.views},a.prototype.apply=function(a){var b=this,c=b.RS(a);null!==c&&b.lHJ(b.views[c].config)},a.prototype.RS=function(a){var b,c,d=this;for(b=0;b<d.views.length;b++)if(c=d.views[b],c.name===a)return b;return null},a.prototype.toJson=function(){return f._AJ(this.views)},a.prototype.fromJson=function(a){this.views=a},a.prototype.no=function(){this.views=L},a}();function Z(a,b,c,d,e,h,i,j,k,l,m){var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,E,F,G,H,I,J=[],K=c.lzc,L=c.dataTable,M=K[a];if(M){if(o=M.path,p=M.isSubtotal,q=M.isGrandTotal,r=M.isBlankRow,s=M.valueFieldName,t=M.collapseIndex,u=M.isValueFieldDim,v=M.compactLevel,g.Fa(s)||(n=s),q&&i&&(l||m))return{LDc:n,Bs:J};if(k&&!m&&(p&&D(t)||q)){for(w="",x=0;x<L[a].length;x++)L[a]&&L[a][x]&&(w+=L[a][x].value);return y=[{fieldName:q?P:Q,itemName:w}],{Bs:y,LDc:n}}for(z=o.split(g.Separator),A=[].concat(d),B=void 0,C=k?O().sigmaValueTemp:O().sigmaValue,D(h)||l||(A.splice(h,0,{Cj:C}),z.splice(h,0,C)),E=i||l||p&&D(t)?z.length-1:j?Math.max(v,0):b,F=0;F<=E;F++)y={},G=A[F],D(G)||(H=G.Cj,I="",I=H===C?n:f.Kzc(e,G.Cj,z[F]),y={fieldName:H,itemName:I},F===E&&(B={name:H===C?I:H,index:F}),F===z.length-1&&(r&&(y.isBlankRow=!0),p&&(y.isSubtotal=!0),D(t)||(y.collapseIndex=t)),q&&(y.isGrandTotal=!0),J.push(y));return{isBlankRow:r,isValueFieldDim:u,LDc:n,activeRowFieldInfo:B,Bs:J}}}function $(a,b,c,d,e,h,i,j,k,l,m){var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,E,F,G,H,I=[],J=c.mzc,K=c.dataTable,L=J[b];if(L){if(o=L.path,p=L.isSubtotal,q=L.isGrandTotal,r=L.valueFieldName,s=L.isBlankColumn,t=L.collapseIndex,u=L.grandTotalLevel,g.Fa(r)||(n=r),s)return{isBlankColumn:s};if(q&&i&&(l||m))return{LDc:n,Cs:I};if(k&&!m&&(p&&D(t)&&0===u||q)){for(v="",w=0;w<K.length;w++)K[w]&&K[w][b]&&(v+=K[w][b].value);return x=[{fieldName:q?P:Q,itemName:v}],{Cs:x,LDc:n}}for(y=o.split(g.Separator),z=[].concat(d),A=void 0,B=k?O().sigmaValueTemp:O().sigmaValue,D(h)||l||(z.splice(h,0,{Cj:B}),y.splice(h,0,B)),C=i||l||p&&D(t)?y.length-1:a-1,E=0;E<=C;E++)x=void 0,F=z[E],D(F)||(G=F.Cj,H="",H=G===B?r:f.Kzc(e,F.Cj,y[E]),x={fieldName:G,itemName:H},E===C&&(A={name:G===B?H:G,index:E}),E===y.length-1&&p&&(x.isSubtotal=!0),D(t)||(x.collapseIndex=t),q&&(x.isGrandTotal=!0),I.push(x));return{activeColFieldInfo:A,LDc:n,Cs:I}}}function _(a){var b=[];return a&&a.forEach(function(a){D(a.itemName)||b.push(a.itemName)}),b.join(" - ")}function aa(a,b){return a===b}function ba(a,b){if(!a||!b)return!1;if(a.fieldName===b.fieldName&&a.subtotal===b.subtotal){if(!a.items&&!b.items)return!0;if(!a.items||!b.items)return!1;if(a.items.length===b.items.length){a.items.sort(),b.items.sort();for(var c=0;c<a.items.length;c++)if(a.items[c]!==b.items[c])return!1;return!0}}return!1}function ca(a,b){for(var c=0,d=b.length;c<d;c++)if(b[c]&&b[c].fieldName===a)return b[c]}function da(a){return a.dataOnly===!1&&D(a.labelOnly)||a.dataOnly===!0&&a.labelOnly===!0?"all":a.dataOnly===!1&&a.labelOnly===!1||D(a.dataOnly)&&D(a.labelOnly)?"dataOnly":a.labelOnly!==!0||a.dataOnly?a.labelOnly||a.dataOnly?void 0:"none":"labelOnly"}function ea(a,b){return da(a)===da(b)}function fa(a,b){var c,d,e,f,g,h,i;if(D(a)||D(b))return!1;if(a.type!==b.type||a.fieldName!==b.fieldName||!aa(a.offset,b.offset)||!ea(a,b)||a.grandRow!==b.grandRow||a.grandCol!==b.grandCol||a.axis!==b.axis)return!1;if(a.references===K&&b.references!==K||a.references!==K&&b.references===K)return!1;if(a.references!==K&&b.references!==K){if(a.references.length!==b.references.length)return!1;for(ga(a),c=b.references,d=a.references,e=0,f=d.length;e<f;e++)if(g=d[e],h=g.fieldName,i=ca(h,c),!ba(g,i))return!1}return!0}function ga(a){a.references&&a.references.length>1&&a.references.sort(function(a,b){return a.fieldName>b.fieldName?-1:a.fieldName<b.fieldName?1:void 0})}function ha(a){switch(a){case"origin":return h.PivotAreaType.corner;case"button":return h.PivotAreaType.button;case"topRight":case"topEnd":return h.PivotAreaType.topRight;default:return}}function ia(a){switch(a){case h.PivotAreaType.corner:return"origin";case h.PivotAreaType.button:return"button";case h.PivotAreaType.topRight:return"topRight";default:return}}function ja(a){var b,c,d=[],e={start:a[0],end:a[0]};for(b=1,c=a.length;b<c;b++)a[b]-1===a[b-1]?e.end=a[b]:(d.push(e),e={start:a[b],end:a[b]});return d.push(e),d}function ka(a){var b,c,d,e,f,g,h,i={},j=a.pivotArea;if(j){i.pivotArea={};for(b in j)if(j.hasOwnProperty(b))if("references"===b&&j.references)for(c=i.pivotArea.references=[],d=0;d<j.references.length;d++){e=j.references[d],f={};for(g in e)if(e.hasOwnProperty(g))if("items"===g&&e.items){if(e.items)for(f.items=[],h=0;h<e.items.length;h++)f.items.push(e.items[h])}else f[g]=e[g];c.push(f)}else i.pivotArea[b]=j[b]}return a.style&&(i.style=la(a.style)),i}function la(a){if(a instanceof d.Style)return a.clone();var b=new d.Style;if("string"==typeof a)b.fromJSON(JSON.parse(a),!1,void 0);else{if("object"!=typeof a)return null;b.fromJSON(a,!1,void 0)}return b}function ma(a,b,c,d,e,f,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;if(void 0===j&&(j=7),k=c.pivotTables.all(),l=!1,e=!!e,m=i?i.union(b):b,j&h.overlapCheck.pt&&g.Yxc(k,function(a){var b,f,g,h,i,j,k;if((a.name()!==d||!d)&&(b=a.getRange(),f=b.page,g=b.content,h=!1,i=!1,f&&(h=null!==f.getIntersect(m,0,0)),i=null!==g.getIntersect(m,0,0),i||h))return j=O().PivotTableErrorMessage_Overlap,k={message:j,cancel:!1,force:!0},e?c.pivotTables.Os(!1,{type:11,args:k}):c.Os(11,k),l=!0,!0}),l)return!0;function A(a,b,d){var f,g,h,i;if(!b||!d)return!1;for(f=d.row;f<d.row+d.rowCount;f++)for(g=d.col;g<d.col+d.colCount;g++)if(a[f]&&b&&!b.contains(f,g)&&a[f][g]&&a[f][g].value)return h=O().PivotTableErrorMessage_ExistData.replace("{}",c.name()),i={message:h,cancel:!1,force:!1},e?c.pivotTables.Os(!1,{type:11,args:i}):c.Os(11,i),!0;return!1}if(j&h.overlapCheck.value)for(n=c.ITa.XTa(3).dataTable,o=0,p=[f,a];o<p.length;o++)for(q=p[o],r=0,s=[i,b];r<s.length;r++)if(t=s[r],A(n,q,t))return!0;if(j&h.overlapCheck.table&&(u=c.tables&&c.tables.all(),u&&u.length>0))for(v=0,w=u;v<w.length;v++)if(x=w[v],wa(x.range(),i,b))return y=O().PivotTableErrorMessage_ExistTable,z={message:y,cancel:!1,force:!0},c.pivotTables.Os(!1,{type:11,args:z}),!0;return!1}b.hBJ=ma,U=function(){function a(a){this.AW=[],this.KNc={fieldLevel:{},itemLevel:{}},this.LNc=a}return a.prototype.no=function(){this.LNc=L,this.AW=L,this.KNc=L},a.prototype.NNc=function(a){var b,c,d=this,e=d.AW,f=[],g=D(a);for(b=0;b<e.length;b++)if(e[b].pivotAreas)for(c=0;c<e[b].pivotAreas.length;c++)(g||fa(a,e[b].pivotAreas[c]))&&f.push(e[b].conditionalRule);return f},a.prototype.ONc=function(a,b,c){var d=this;d.PNc(a,b,c)},a.prototype.PNc=function(a,b,c){var d,e,f,g,h,i,j,k;if(!(D(a)||a.length<=0)&&b&&(d=this,e=d.AW,f=d.LNc,g=f.qo,!D(g.conditionalFormats)&&(h={conditionalRule:b,pivotAreas:a},b.pivotTableAreas=a,b.pivotTableName=f.name(),e.push(h),!c))){for(i=[],k=0;k<a.length;k++)j=f.getPivotAreaRanges(a[k]),j&&j.length>0&&(i=i.concat(j));i.length>0&&(b.ranges(i),g.conditionalFormats.addRule(b))}},a.prototype.RNc=function(){var a,b,c,d=this,e=d.AW,f=d.LNc,g=f.qo,h=g.conditionalFormats;if(!D(h)){for(d.AW=[],a=0,b=e.length;a<b;a++)c=e[a],h.removeRule(c.conditionalRule);for(a=0,b=e.length;a<b;a++)c=e[a],d.ONc(c.pivotAreas,c.conditionalRule)}},a.prototype.zR=function(){return this.AW},a.prototype.oCJ=function(a){var b,c=this.AW;for(b=0;b<c.length;b++)c[b].conditionalRule&&c[b].conditionalRule.priority()===a&&c.splice(b,1)},a.prototype.iIJ=function(a,b){var c,d,e,f=this,g=f.AW,h=f.LNc;for(c=0;c<g.length;c++){if(a===g[c].conditionalRule){for(d=[],e=0;e<b.length;e++)d=d.concat(h.getPivotAreaRanges(b[e]));a.ranges(d)}g[c].pivotAreas=b}},a.prototype.jIJ=function(a){var b,c=this,d=c.AW,e=c.LNc,f=e.qo;for(b=0;b<d.length;b++)a===d[b].conditionalRule&&f.conditionalFormats.removeRule(a)},a.prototype.GIJ=function(a){var b,c,d,e,f=this,g=f.AW,h=f.LNc,i=h.qo;for(b=0;b<g.length;b++)if(c=g[b],c.pivotAreas){if(a.length!==c.pivotAreas.length)continue;for(d=!0,e=0;e<a.length;e++)if(!fa(a[e],c.pivotAreas[e])){d=!1;break}d&&(i.conditionalFormats.removeRule(c.conditionalRule),g.splice(b,1))}},a.prototype.kIJ=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=k.LNc,m=l.qo,n=m.conditionalFormats,o=[],p=n.UV(a.ranges()),q=l.Cj;for(f=0,g=H(p);f<g;f++)h=n.IW(p[f],b,c,d,e),h&&(o=o.concat(h));if(H(o)>0){for(i=[],j=function(a){var b=m.pivotTables.getRangePivotAreas(o[a]);b&&Object.keys(b).forEach(function(a){a===q&&b[q]&&(i=i.concat(b[q]))})},f=0;f<o.length;f++)j(f);k.iIJ(a,i)}else k.jIJ(a)},a.prototype.$IJ=function(){this.AW.length=0,this.KNc={fieldLevel:{},itemLevel:{}}},a.prototype.count=function(){return H(this.AW)},a}(),b.PivotTableConditionalFormats=U;function na(a,b){return b.priority=a.priority&&a.priority(),b.scope=a.scope&&a.scope(),b.type=a.type&&a.type(),b}function oa(a){var b,c;if(!a)return!0;if(E(a))return!0;b=!0;for(c in a)if(a.hasOwnProperty(c)&&"_id"!==c){b=!1;break}return b}function pa(a,b,c){var d,e,f=b.row,g=b.col,h=b.rowCount,i=b.colCount;if(c.borderLeft)for(d=0;d<h;d++)a[f+d]||(a[f+d]={}),D(a[f+d][g])&&(a[f+d][g]={}),a[f+d][g].borderLeft=!0;if(c.borderRight)for(d=0;d<h;d++)a[f+d]||(a[f+d]={}),D(a[f+d][g+i-1])&&(a[f+d][g+i-1]={}),a[f+d][g+i-1].borderRight=!0;if(c.borderTop)for(a[f]||(a[f]={}),e=0;e<i;e++)D(a[f][g+e])&&(a[f][g+e]={}),a[f][g+e].borderTop=!0;if(c.borderBottom)for(a[f+h-1]||(a[f+h-1]={}),e=0;e<i;e++)D(a[f+h-1][g+e])&&(a[f+h-1][g+e]={}),a[f+h-1][g+e].borderBottom=!0}function qa(a,b){a.sort(function(a,c){return b?a.row-c.row:a.col-c.col})}function ra(a){var b,c,d,e;if(!a)return[];for(b=[],c=0;c<a.length;c++)a[c]&&b.push(a[c]);if(b.length<=1)return b;if(d=[],b[0].row===b[1].row&&b[0].rowCount===b[1].rowCount)for(qa(b,!1),c=0;c<b.length-1;c++)for(e=c+1;e<b.length;e++){if(b[c].col+b[c].colCount!==b[e].col||b[c].row!==b[e].row||b[c].rowCount!==b[e].rowCount){d.push(b[c]),c=e-1,e===b.length-1&&d.push(b[e]);break}if(b[c].colCount=b[c].colCount+b[e].colCount,e===b.length-1){d.push(b[c]),c=e-1;break}}else if(b[0].col===b[1].col&&b[0].colCount===b[1].colCount)for(qa(b,!0),c=0;c<b.length-1;c++)for(e=c+1;e<b.length;e++){if(b[c].row+b[c].rowCount!==b[e].row||b[c].col!==b[e].col||b[c].colCount!==b[e].colCount){d.push(b[c]),c=e-1,e===b.length-1&&d.push(b[e]);break}if(b[c].rowCount=b[c].rowCount+b[e].rowCount,e===b.length-1){d.push(b[c]),c=e-1;break}}else d=b;return d}function sa(a,b,c){if(!D(b)){var d=typeof b;switch(d){case"boolean":a.b=b?1:0;break;case"string":a.v=c.getTextIndex(b);break;case"object":b instanceof Date?a.v=c.getTextIndex(g.AIc(b)):a.v=b;break;default:a.n=b}}}b.setDataForSJSPivotTable=sa;function ta(a,b){a.value=b}function ua(a,b){var c=new d.Style,e=z(b.numFmtId),f=a.zdK&&a.zdK.GlK(e);return c.formatter=f,c}function va(a,b,c,d,e){var f,g,h,i,j;for(f in d)if(d.hasOwnProperty(f)&&(g=d[f],!D(g))){D(c[+f+a])&&(c[+f+a]={}),h=c[+f+a];for(i in g)g.hasOwnProperty(i)&&(D(g[i])||(j=g[i],D(j)||D(j.value)||(D(h[+i+b])&&(h[+i+b]={}),e(h[+i+b],j.value))))}}b.synchronizeDataTable=va,V=function(a){W(c,a);function c(b,c,d,e,i,k,m,n){var o,p,q=a.call(this,b,n)||this;return q.FJJ=0,o=q,o.Lia=0,o.rAc={row:D(d)?0:d,col:D(e)?3:e},o.suspendLayout(),o.ys=new j.PivotDataModel,o.qo=c,o.rAc={row:D(d)?0:d,col:D(e)?3:e},p=o.refresh.bind(o),o.options=f.Ql(R,q,p),o.eJc(m),o.Zaa=k||l.PivotTableThemes.light16,o.uNb=[],o.vNb=[],D(i)?o.Wyc=h.PivotTableLayoutType.outline:o.Wyc=i,o.Vyc.setSigmaValuePosition(g.DataPosition.col,0),o.MLc={LLc:[],NLc:[],OLc:[],PLc:[]},o.QLc=[],o.SNc=[],o.TNc={},o.LBJ={},o.NJJ={},U&&(o.U5=new U(o)),o.views=new T(o.deserialize.bind(o),o.serialize.bind(o)),o.DBJ="",o.EBJ="",o.resumeLayout(),q}return c.prototype.showNoData=function(a,b){var c,d=this,e=d.Vyc;return e&&!D(a)&&""!==a&&(c=e.wYJ(a,b)),!c||D(b)?c:(d.refresh(),void d.RVa({pivotTable:d,type:"showNoData",cacheFieldName:a,isShow:b}))},c.prototype.updateCalcItem=function(a,b,c,d){var e,f=this,g=f.Vyc,h=f.qo,i=g.zSJ(a)[0];try{e=g.ySJ(a,b,c,d),f.refresh()}catch(a){return h.Os(10,a.message),!1}return e&&f.RVa({pivotTable:f,type:"updateCalcItem",calcItemInfo:i}),e},c.prototype.getCalcItems=function(a){var b=this,c=b.Vyc;return c.zSJ(a)||[]},c.prototype.removeCalcItem=function(a,b){var c=this,d=c.Vyc,e=d.ASJ(a,b);e&&e.length>0&&c.RVa({pivotTable:c,type:"removeCalcItem",sourceName:a,formulaInfos:e}),c.refresh()},c.prototype.addCalcItem=function(a,b,c){var d=this,e=d.Vyc,f=d.qo,g;if(!D(a)&&!D(c)&&""!==c&&""!==b){try{g=e.CSJ(a,b,c),d.refresh()}catch(a){return f.Os(10,a.message),!1}return g&&d.RVa({pivotTable:d,type:"addCalcItem",sourceName:a,calcItemName:b}),g}},c.prototype.getPivotDetails=function(a){if(D(a))throw Error(O().param_error);var b=this;return b.Vyc?b.Vyc.GLc(a):void 0},c.prototype.getSource=function(){var a,b=this.Vyc;if(b&&(a=b.DHJ(),"string"==typeof a))return a},c.prototype.getSourceFields=function(){var a,b,c,d,e,f=this.Vyc,h=[];if(f&&(a=f.wHJ(),!D(a)))for(c=0,d=a;c<d.length;c++)e=d[c],b={name:e.name},g.Fa(e.fieldType)||(b.fieldType=e.fieldType),h.push(b);return h},c.prototype.updateSource=function(){var a=this,b=a.Vyc;b&&b.kLc(a.qo)},c.prototype.serialize=function(){return this.oOc(2047)},c.prototype.oOc=function(a){var b,c,d,e,i,j,k,m=this,n=m.layoutType(),o={},p=[],q=m.options,r=m.Vyc,s=m.rAc,t=m.Vyc.getSigmaValuePosition(),u={};if(a&h.SerializeIndex.options){for(b in q)q.hasOwnProperty(b)&&"object"!=typeof q[b]&&(o[b]=q[b]);u.options=o}if(a&h.SerializeIndex.layout&&(u.layoutType=n),a&h.SerializeIndex.position&&(u.pivotTablePosition=[s.row,s.col]),a&h.SerializeIndex.theme&&(c=m.theme().name(),D(l.PivotTableThemes[c.toLowerCase()])?m.theme()&&(u.theme=m.theme().toJSON()):u.theme=c),a&h.SerializeIndex.styles)for(d=u.styles=[],e=m.SNc,i=0;i<e.length;i++)d.push(ka(e[i]));if(!(a&h.SerializeIndex.fields))return u;for(j=function(b){var c,d,e,f,i,j,k,l,n,o=[];if(4===b&&a&h.SerializeIndex.filter)return c=m.getFieldsByArea().map(function(a){return a.sourceName}),d=r.getAllFieldNameList(),g.Yxc(d,function(a){var b,d,e;c.indexOf(a)>-1||!r.isFilter(a)||(b={sourceName:a},d=m.labelFilter(a),e=m.valueFilter(a),d&&(b.labelFilter=d),e&&e.conditionByName&&(b.valueFilter=e),(b.labelFilter||b.valueFilter)&&o.push(b))}),o.length>0&&(p[b]=o),"break";for(e=r.ryc(b),f=0;f<e.length;f++)i=e[f],j={sourceName:i.Zxc,displayName:i.Cj},g.Fa(i.fyc)||(j.subtotal=i.fyc),a&h.SerializeIndex.filter&&(k=m.labelFilter(i.Cj),l=m.valueFilter(i.Cj),k&&(j.labelFilter=k),l&&l.conditionByName&&(j.valueFilter=l)),a&h.SerializeIndex.sort&&i.zZ&&(j.sortInfo=i.zZ),3===b&&a&h.SerializeIndex.showValueAs&&m.JFJ&&(n=m.showDataAs(i.Cj),n&&(u.showDataAsList||(u.showDataAsList=[]),u.showDataAsList.push({valueFieldName:i.Cj,showDataAsInfo:n}))),o.push(j);p[b]=o},i=0;i<5&&(k=j(i),"break"!==k);i++);return t&&(u.valuePosition=t),a&h.SerializeIndex.collapse&&(u.collapseItems=f._AJ(r.wyc)||{}),u.fieldsInfo=p,u},c.prototype.deserialize=function(a){this.pOc(a,2047)},c.prototype.pOc=function(a,b){var c,d,e,f,i,j,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this;D.qo.suspendPaint(),D.suspendLayout();try{for(c=D.Vyc,d=0;d<4;d++)c.JDc(d);if(e=c.getAllFieldNameList(),g.Yxc(e,function(a){c.clearFilterInfo(a,0)}),b&h.SerializeIndex.position&&D.position(a.pivotTablePosition[0],a.pivotTablePosition[1]),b&h.SerializeIndex.layout&&D.layoutType(a.layoutType),b&h.SerializeIndex.options)for(f=Object.keys(a.options),d=0;d<f.length;d++)D.options[f[d]]!==a.options[f[d]]&&(D.options[f[d]]=a.options[f[d]]);if(b&h.SerializeIndex.theme&&a.theme&&(i=a.theme,"object"==typeof i&&(i=new l.PivotTableTheme,i.fromJSON(a.theme)),D.theme(i)),b&h.SerializeIndex.styles)for(D.aIJ(),j=a.styles||[],d=0;d<j.length;d++)D.setStyle(j[d].pivotArea,j[d].style);if(b&h.SerializeIndex.fields){for(d=0;d<4;d++)for(k=a.fieldsInfo[d],m=0;m<k.length;m++)n=k[m],n&&(o=n.sourceName,p=n.displayName,q=n.subtotal,c.isFieldActualExist(o)&&c.addFieldByName(o,p,d,q,void 0));a.valuePosition&&c.setSigmaValuePosition(a.valuePosition.positionType,a.valuePosition.positionIndex)}for(d=0;d<5;d++)if(k=a.fieldsInfo[d])for(m=0;m<k.length;m++)n=k[m],n&&(o=n.sourceName,r=n.valueFilter,s=n.labelFilter,t=n.sortInfo,b&h.SerializeIndex.filter&&(s&&c.isFieldActualExist(o)&&c.setLabelFilterInfo(o,s),r&&c.isFieldActualExist(o)&&c.setValueFilterInfo(o,r)),b&h.SerializeIndex.sort&&t&&c.isFieldActualExist(o)&&c.setSortInfo(o,t));if(b&h.SerializeIndex.collapse&&(u=a.collapseItems))for(v=0,w=Object.keys(u);v<w.length;v++)for(x=w[v],y=u[x],z=0,A=Object.keys(y);z<A.length;z++)B=A[z],D.collapse(x,B,y[B]);b&h.SerializeIndex.showValueAs&&(C=a.showDataAsList,C&&g.Yxc(C,function(a){D.showDataAs(a.valueFieldName,a.showDataAsInfo)}))}catch(a){throw Error(a)}finally{D.resumeLayout(),D.qo.resumePaint()}},c.prototype.eJc=function(a){var b,c=this,d=c.options,e=R;if(!D(a))for(b in a)J(a,b)&&J(e,b)&&(d[b]=a[b])},c.prototype.altText=function(a,b){return D(a)&&D(b)?{altText:this.DBJ,altTextSummary:this.EBJ}:(D(a)||(this.DBJ=a),void(D(b)||(this.EBJ=b)))},c.prototype.name=function(a){var b,c;if(0===arguments.length)return this.Cj;if(this.qo&&this.qo.parent&&(b=this.qo.parent.bDc(a)))throw Error(O().RepeatName);c=this.Cj,this.Cj=a,this.qo.parent.$Cc(a,!0,c),this.RVa({pivotTable:this,name:a,oldName:c,type:"name",pivotType:0})},c.prototype.position=function(a,b,c){var e,f,g,h,i,j,k,l,m,n=this;if(0===arguments.length)return{row:n.rAc.row,col:n.rAc.col,sheetName:n.qo.name()};if(e=n.qo,g=e&&e.parent,!D(n.qo)&&"number"==typeof a&&"number"==typeof b){if(i=n.rAc.row,j=n.rAc.col,n.rAc.row=a,n.rAc.col=b,!D(c)&&c!==e.name()){if(f=g&&d.VCJ(g,c),D(f))return;for(h=e.pivotTables,k=h&&h.WCc,l=k.length,m=0;m<l;m++)if(k[m].name()===n.Cj){k.splice(m,1);break}f.pivotTables.WCc.push(n)}n.RVa({pivotTable:n,row:a,col:b,oldCol:j,oldRow:i,sheetName:e.name(),type:"position",pivotType:0}),n.refresh(),f&&(n.qo=f,n.sIJ(f.pivotTables.qIJ,f.pivotTables.rIJ))}},c.prototype.sort=function(a,b){return 1===arguments.length?this.Vyc.getSortInfo(a):(arguments.length>1&&this.Vyc.setSortInfo(a,b),void this.refresh())},c.prototype.group=function(a){var b=this,c,d=b.qo;try{c=this.Vyc.UCc(a)}catch(a){return void d.Os(10,a.message)}"boolean"==typeof c?(b.Vyc.zyc=!0,b.refresh()):b.qo.Os(10,c)},c.prototype.getGroupInfo=function(a){var b,c,d;if(!D(a)&&""!==a)return b=this,c=b.Vyc,d=c.xHJ(a),D(d)?void 0:X({},d)},c.prototype.ungroup=function(a){var b,c;this.Vyc.gGc(a),this.Vyc.zyc=!0,b=this.qo,b&&(c=b.getParent(),c.mLc()),this.refresh()},c.prototype.add=function(a,b,c,d,e){var f,i=this,j=i.Vyc,k=i.qo;if(!D(a)&&!D(b)&&D(j.oyc[b])&&(f=i.Vyc.oIJ(a))){if(!D(f.Yw)){if(c!==h.PivotTableFieldType.valueField)return void r.throwError(O().FieldAreaLimited);d=g.SubtotalType.sum}try{j.addFieldByName(a,b,c,d,e),i.refresh()}catch(a){return void k.Os(10,a.message)}}},c.prototype.remove=function(a){var b=this.Vyc,c=b.oyc[a],d=b.removeFieldOrSigmaByName(a);d instanceof r.PivotViewField&&(c===h.PivotTableFieldType.valueField?b.clearValueFilterOfValueField(a):b.bCJ(a,!1)),this.refresh()},c.prototype.theme=function(a){if(0===arguments.length)return this.Zaa;var b=this.Zaa&&this.Zaa.name();b=l.PivotTableThemes[b]?b:this.Zaa,"string"==typeof a&&(a=l.PivotTableThemes[a.toLowerCase()]||l.PivotTableThemes.light0),this.RVa({pivotTable:this,type:"changeTheme",oldTheme:b,pivotType:0}),this.Zaa=a,this.refresh()},c.prototype.RVa=function(a){var b,c,d=this.qo;d&&(b=d.getParent(),g.Fa(b.fBJ)&&this.getRange&&(b.fBJ={range:this.getRange()}),c=d.ITa,c.SAJ(this,a))},c.prototype.RUa=function(a){var b,c,d,e,f,h,i,j,k,l=this,m=a.type;switch(m){case"changeTheme":l.theme(a.oldTheme);break;case"layoutType":l.layoutType(a.oldLayoutType);break;case"name":l.name(a.oldName);break;case"position":
l.position(a.oldRow,a.oldCol,a.sheetName);break;case"setStyle":l.setStyle(a.pivotArea,a.oldStyle);break;case"options":l.options[a.pn]=a.old;break;case"addCalcField":l.removeCalcField(a.fieldName);break;case"removeCalcField":l.addCalcField(a.fieldName,a.formula);break;case"showDataAs":D(a.oldShowDataAs)?l.showDataAs(a.fieldName,{showDataAs:g.PivotShowDataAs.normal}):l.showDataAs(a.fieldName,a.oldShowDataAs);break;case"resetPivotStyle":l.aIJ(a.areaModel,a.rangeModel);break;case"adjustRange":l.rAc.row=a.oldRow;break;case"conditionalRulesChange":l.U5.AW=a.originalConditionalRules,l.U5.RNc();break;case"addCalcItem":l.removeCalcItem(a.sourceName,a.calcItemName);break;case"removeCalcItem":for(b=a.formulaInfos,c=0,d=b;c<d.length;c++)e=d[c],l.addCalcItem(a.sourceName,e.calcItemName,e.formula);break;case"updateCalcItem":f=a.calcItemInfo,h=f.sourceName,i=f.calcItemName,j=f.formula,k=f.priority,l.updateCalcItem(h,i,j,k);break;case"showNoData":l.showNoData(a.cacheFieldName,!a.isShow);break;case"setNodeValue":l.setNodeValue(a.nodeInfo,a.oldValue)}},c.prototype.updateField=function(a,b,c){var d=this,e=d.Vyc,f=d.qo;if(a===O().sigmaValue)e.setSigmaValuePosition(b-1,c);else if(!D(a))try{e.changeFieldArea(a,b,c),d.refresh()}catch(a){return f.Os(10,a.message),!1}},c.prototype.MJJ=function(a,b,c){var d,e,i,j,k,l,m=this,n=m.Vyc,o=n.getFieldInfoByName(a),p=n.oyc;if(b&&o){if(p[a]===h.PivotTableFieldType.valueField)f.GJJ(m,a,o.xFJ&&o.xFJ.showDataAs),m.showDataAs(a,{showDataAs:g.PivotShowDataAs.normal});else if(p[a]!==h.PivotTableFieldType.filterField)for(d=n.ryc(h.PivotTableFieldType.valueField),e=0,i=d;e<i.length;e++)j=i[e],j.xFJ&&j.xFJ.baseFieldName===a&&f.GJJ(m,j.Cj,j.xFJ&&j.xFJ.showDataAs)}else if(o&&!b)if(p[a]===h.PivotTableFieldType.valueField&&c!==h.PivotTableFieldType.valueField)f.GJJ(m,a,o.xFJ&&o.xFJ.showDataAs),m.showDataAs(a,{showDataAs:g.PivotShowDataAs.normal});else if(!(p[a]!==h.PivotTableFieldType.rowField&&p[a]!==h.PivotTableFieldType.columnField||c!==h.PivotTableFieldType.filterField&&c!==h.PivotTableFieldType.valueField))for(d=n.ryc(h.PivotTableFieldType.valueField),k=0,l=d;k<l.length;k++)j=l[k],j.xFJ&&j.xFJ.baseFieldName===a&&(f.GJJ(m,a,j.xFJ&&j.xFJ.showDataAs),m.showDataAs(j.Cj,{showDataAs:g.PivotShowDataAs.normal}))},c.prototype.updateFieldName=function(a,b){var c=this.Vyc.getFieldInfoByName(a);"string"==typeof b&&(c&&this.Vyc.changeFieldName(c,b)?(this.Vyc.zyc=!0,this.refresh()):this.qo.Os(10,O().PivotTableErrorMessage_EmptyFieldName))},c.prototype.autoFitColumn=function(){var a=this.UBJ(),b=this.qo;b.suspendPaint(),g.Yxc(a,function(a){g.Yxc(a,function(a){b.setColumnWidth(a.col,a.width)})}),b.resumePaint()},c.prototype.UBJ=function(){var a,b,c,e,f,h,i,j,k,l=this.rAc.col,m=this.ys.szc[2],n=m.hF,o=m.mzc,p=m.OZ,q=this.Czc(),r=q.length,s=[],t=[],u=this.Vyc.getSigmaValuePosition(),v=!1,w=!1;for(u.display&&1===u.positionType&&(r+=1,u.positionIndex===r-2?v=!0:u.positionIndex===r-1||(w=!0)),a=this.rAc.row+this.rAc.rowCount,b=this.rAc.col;b<this.rAc.col+n;b++)c=d.Ul.xl(b,this.qo,3,1,a),s.push([{col:b,width:c}]);for(e=L,f=w?3:2,b=0;b<p;b++)h=o[b].path,i=o[b].isSubtotal,j=h.split(g.Separator),k=j[r-f],v&&(k=o[b].valueFieldName),c=d.Ul.xl(l+n+b,this.qo,3,1,a),null!==e&&e!==k?(this.VBJ(t,s),t=[],t.push({col:l+n+b,width:c}),b===o.length-1&&s.push(t.slice())):(i&&(this.VBJ(t,s),t=[]),t.push({col:l+n+b,width:c}),b===o.length-1&&this.VBJ(t,s)),e=j[r-f],v&&(e=o[b].valueFieldName);return s},c.prototype.VBJ=function(a,b){var c,d,e=[];a.forEach(function(a){e.push(a.width)}),c=Math.max.apply(Math,e),d=[],a.forEach(function(a){d.push({col:a.col,width:c})}),b.push(d.slice())},c.prototype.collapse=function(a,b,c){return 2===arguments.length?this.Vyc.getCollapse(a,b):void(arguments.length>2&&(this.Vyc.setCollapse(a,b,c),this.refresh()))},c.prototype.labelFilter=function(a,b){var c=this.Vyc,d=c.getSourceNameByFieldName(a)||a;return 1===arguments.length?c.getLabelFilterInfo(a)||d&&c.getLabelFilterInfo(d):(c.setLabelFilterInfo(d,b),void this.refresh())},c.prototype.valueFilter=function(a,b){var c=this.Vyc,d=c.getSourceNameByFieldName(a);return 1===arguments.length?c.getValueFilterInfo(a)||d&&c.getValueFilterInfo(d):(c.setValueFilterInfo(d,b),void this.refresh())},c.prototype.subtotalType=function(a,b){return this.subTotalType.apply(this,arguments)},c.prototype.subTotalType=function(a,b){var c=this,d=c.qo;if(!D(c.Vyc)){if(1===arguments.length)return c.Vyc.KBJ(a);try{c.Vyc.KBJ(a,b)}catch(a){d.Os(10,a.message)}c.refresh()}},c.prototype.layoutType=function(a){var b,c=this;if(0===arguments.length)return c.Wyc;if(c.Wyc!==a){switch(b=c.Wyc,c.Wyc=a,a){case h.PivotTableLayoutType.compact:c.outline=!0,c.outlineData=!0,c.compact=void 0,c.compactData=void 0;break;case h.PivotTableLayoutType.outline:c.outline=!0,c.outlineData=!0,c.compact=!1,c.compactData=!1;break;case h.PivotTableLayoutType.tabular:c.compact=!1,c.compactData=!1,c.outline=void 0,c.outlineData=void 0}this.refresh(),this.RVa({pivotTable:this,layoutType:a,oldLayoutType:b,type:"layoutType",pivotType:0})}},c.prototype.dataPosition=function(a,b){var c,d=this;return 0===arguments.length?d.Vyc.getSigmaValuePosition():(c=d.getFieldsByArea(a+1).length,b<0?b=0:b>c&&(b=c),d.Vyc.setSigmaValuePosition(a,b),void d.refresh())},c.prototype.getItemsByField=function(a){return this.Vyc.cGc(a)},c.prototype.showDataAs=function(a,b){if(1===arguments.length)return this.Vyc.getFieldInfoByName(a).xFJ;var c=this.Vyc.getFieldInfoByName(a).xFJ;b.showDataAs===g.PivotShowDataAs.normal?this.JFJ=!1:this.JFJ=!0,this.Vyc.getFieldInfoByName(a).xFJ=b,c&&(c=X({},c)),this.RVa({pivotTable:this,fieldName:a,oldShowDataAs:c,type:"showDataAs",pivotType:0}),this.refresh()},c.prototype.getFieldsByArea=function(a){var b,c,d,e,f=this.Vyc,h=this.Vyc.ryc(a)||[];return h.map(function(h){return d=h.Cj,a=f.oyc[d],c=f.ryc(a),b=r.oHJ(c,d),e={fieldName:d,sourceName:h.Zxc,dataType:h.ny,pivotArea:a,pivotIndex:b},h.ny!==g.PivotDataType.string&&(e.start=h.bGb,e.end=h.vHJ),e})},c.prototype.getField=function(a){var b,c,d,e,f=this,h=f.Vyc,i=h.getFieldInfoByName(a);return i?(c=h.oyc[a],d=h.ryc(c),e=r.oHJ(d,a),b={fieldName:a,sourceName:i.Zxc,dataType:i.ny,pivotArea:c,pivotIndex:e},i.ny!==g.PivotDataType.string&&(b.start=i.bGb,b.end=i.vHJ),b):null},c.prototype.addCalcField=function(a,b){this.Vyc.gNc(a,b),this.Vyc.zyc=!0,this.refresh(),this.RVa({pivotTable:this,fieldName:a,formula:b,type:"addCalcField",pivotType:0})},c.prototype.getCalcFields=function(){return this.Vyc.hNc()},c.prototype.removeCalcField=function(a){var b,c,d,e,f,g,h,i=this,j=a,k=i.Vyc.getFieldInfoByName(a);for(k&&(j=k.Zxc),b=this.Vyc.iyc,c=this.Vyc.qo,d=c.getCalcFields(b),i.Vyc.BDc(a),i.Vyc.fNc(j),i.Vyc.zyc=!0,e=this.qo,e&&(f=e.getParent(),f.mLc()),this.refresh(),g=0;g<d.length;g++)h=d[g],h.Cj===a&&this.RVa({pivotTable:this,fieldName:a,formula:h.Yw,type:"removeCalcField",pivotType:0})},c.prototype.adjustRange=function(){var a=this.ys.szc[0],b=a.Xj,c=this.rAc.row,d=c,e=this.rAc.col;b>0&&c-(b+1)<0&&(this.rAc.row=b+1,this.RVa({pivotTable:this,oldRow:d,oldCol:e,type:"adjustRange",pivotType:0}))},c.prototype.EZ=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=o.qo;p.suspendPaint(),o.adjustRange(),a=this.ys.szc,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],b.setStartInfo(0,0),o.sAc={row:this.rAc.row-(b.Xj+1),col:this.rAc.col,rowCount:b.Xj,colCount:b.OZ},o.rAc.rowCount=c.Xj+e.Xj,o.rAc.colCount=c.OZ+d.OZ,c.setStartInfo(0,0),d.setStartInfo(0,c.OZ),e.setStartInfo(d.Xj,0),f.setStartInfo(d.Xj,e.OZ),o.RLc(),o.UNc(),o.U5.RNc(),g=o.qo&&o.qo.getParent(),g&&g.fBJ&&(h=g.fBJ.range,i=o.getRange(),h&&(j=h.page,k=h.content,l=h.page?h.page.union(h.content):h.content,m=i.page,n=i.content,l.rowCount&&l.colCount&&ma(k,n,o.qo,o.Cj,!0,j,m)&&o.qo.pivotTables.Os(!0)),g.fBJ=L),p.pivotTables.sIJ(),p.resumePaint()},c.prototype.getValue=function(a,b){var c,d,e,i,j,k,l,m,n,o,p=this,q=p.Vyc,r=a-this.rAc.row,s=b-this.rAc.col,t=p.ys.szc,u=t[0],v=t[1],w=t[2],x=t[3],y=t[4],z=u.Xj>0&&u.OZ>0,A=a,B=b;return z&&(A=a-this.sAc.row,B=b-this.sAc.col),z&&u.Xj>A?u.ge(A,B):v.Xj>r?v.OZ>s?v.ge(r,s):(c=w.ge(r,s-v.OZ),i=q.ryc(2)[r-1],k=i&&i.ny,j=i&&q.HSJ(i.Zxc),2===k&&!j&&(l=g.parseStringToDate(c))?l:c):x.OZ>s?(m=x.ge(r-v.Xj,s),i=q.ryc(1)[s],k=i&&i.ny,j=i&&q.HSJ(i.Zxc),g.Fa(m)?m:2===k&&!j&&(n=g.parseStringToDate(m))?n:this.Wyc===h.PivotTableLayoutType.compact?m+"":m):0===q.ryc(3).length?L:(c=y.ge(r-v.Xj,s-v.OZ),c===f.GC_EMPTY_VALUE?L:this.kJc(x,a)&&(!this.isTitleRow(x,a)&&!this.isBlankRow(x,a)||this.isSubtotalRow(x,a))?(o=this.mIJ(c),g.Fa(o)?c:o):c)},c.prototype.yq=function(a,b,c){var d,e=a-this.rAc.row,f=b-this.rAc.col,g=this.ys.szc,i=g[0],j=g[1],k=g[2],l=g[3],m=i.Xj>0&&i.OZ>0,n=a,o=b;m&&(n=a-this.sAc.row,o=b-this.sAc.col),m&&i.Xj>n&&i.yq(n,o,c),j.Xj>e&&(j.OZ>f?j.yq(e,f,c):k.yq(e,f-j.OZ,c)),l.OZ>f&&(d=this.Wyc===h.PivotTableLayoutType.compact?c+"":c,l.yq(e-j.Xj,f,d))},c.prototype.mIJ=function(a){var b,c=this;if(D(a)){if(c.JFJ)return;if(c.options.showMissing){if(b=c.options.missingCaption,f.bJc(a)&&!g.Fa(b))return b}else if(f.bJc(a))return 0}else if(a instanceof q.CalcError||a===1/0){if(c.options.isShowErrorValue&&!D(c.options.errorValueInfo))return c.options.errorValueInfo;if(a===1/0)return q.Errors.Number}},c.prototype.sIJ=function(a,b){var c=this.getRange(),d=c.content,e=c.page;e&&this.tIJ(a,b,e),this.tIJ(a,b,d)},c.prototype.tIJ=function(a,b,c){var d;for(d=c.row;d<c.row+c.rowCount;d++)a[d]=!0;for(d=c.col;d<c.col+c.colCount;d++)b[d]=!0},c.prototype.kJc=function(a,b){return 3===a.ILa&&this.rAc.rowCount+this.rAc.row>b},c.prototype.isSubtotalRow=function(a,b){var c=a.lzc[b-a.nU-this.rAc.row];return c&&c.isSubtotal},c.prototype.isBlankRow=function(a,b){var c=a.lzc[b-a.nU-this.rAc.row];return c&&c.isBlankRow},c.prototype.isTitleRow=function(a,b){if(this.Wyc===h.PivotTableLayoutType.tabular)return!1;var c=a.lzc[b-a.nU-this.rAc.row];return!!c&&(void 0===c.isValueFieldDim||!c.isValueFieldDim)},c.prototype.jOc=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this.getPivotInfoImp(a,b,!0);if(x){if(e=K,f=void 0,g=void 0,h=void 0,i=x.value,j=x.area,k=x.menuArea,l=x.valueFieldName,m=x.rowInfos,n=x.colInfos,o=x.colHeadFieldInfo,p=x.activeRowFieldInfo,q=x.activeColFieldInfo,r=this.WNc(a,b)&&this.WNc(a,b).formatter,D(r)||(i=d.mn.un(i,r)),3===k)return e;switch(this.options.showMissing&&(h=this.options.missingCaption),j){case 3:if(!D(m)){if(5===k||1===m.length&&m[0].fieldName===Q){i=i||m[0].itemName||h,D(i)||(e=[i]);break}if(p){for(;p.index>=0&&m[p.index]&&D(m[p.index].itemName);)p.index=p.index-1;s=m[p.index],s&&(f=s.itemName+" ("+s.fieldName+")")}g=O().toolTipContent_Row+_(m),e=[f,g]}break;case 2:if(!D(o))break;if(!D(n)){if(5===k||1===n.length&&n[0].fieldName===Q){i=i||n[0].itemName||h,D(i)||(e=[i]);break}if(q){for(;q.index>=0&&n[q.index]&&D(n[q.index].itemName);)q.index=q.index-1;t=n[q.index],t&&(f=t.itemName+" ("+t.fieldName+")")}g=O().toolTipContent_Column+_(n),e=[f,g]}break;case 4:D(l)||(i=i||h,D(i)&&(i=O().toolTipContent_NoValue),f=O().toolTipContent_Value+i,e=[l,f],D(m)||(u=O().toolTipContent_Row+_(m),e.push(u)),D(n)||(v=O().toolTipContent_Column+_(n),e.push(v)))}if(!D(e)){for(w=0;w<e.length;w++)e[w]=F.Ob(e[w]);c?e.unshift(O().PivotTableForAccessibility+this.Cj):e[0]="<b>"+e[0]+"</b>",e=e.join("\r\n")}return e}},c.prototype.getPivotInfo=function(a,b){var c,d=this,e=d.getRange();if((e.content.contains(a,b)||e.page&&e.page.contains(a,b))&&(c=d.getPivotInfoImp(a,b),!D(c)))return c.row=a,c.col=b,c},c.prototype.getPivotInfoImp=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=this,v=a-u.rAc.row,w=b-u.rAc.col;return u.iT()?{menuArea:3}:(f=a-u.sAc.row,g=b-u.sAc.col,h=u.ys.szc,i=h[0],j=h[1],k=h[2],l=h[3],m=h[4],n=u.Vyc,o=n.jyc,p=n.kyc,q=n.myc,i.Xj>f?(r=u.rMc(f,g,i),r.row=a,r.col=b,s=i.jzc(f,g),s&&(r.pageFieldInfo={fieldName:s}),r.menuArea=0,r):j.Xj>v?j.OZ>w?(r=u.rMc(v,w,j),r.row=a,r.col=b,t=j.kzc[w],r.menuArea=3,v===j.Xj-1&&t?(r.cornerFieldInfo={fieldName:t.fieldName,isDim:t.isDim,isCompactRoot:t.isCompactRoot},t.isCompactRoot||(r.menuArea=2)):0===v&&0===w&&1===u.Gyc().length&&r.value&&(r.menuArea=1),r):u.sMc(v,w-j.OZ,k,p,!1,c,d,e):l.OZ>w?u.sMc(v-j.Xj,w,l,o,!0,c,d,e):u.tMc(v-j.Xj,w-j.OZ,[l,k,m],[o,p,q],c,d,e))},c.prototype.rMc=function(a,b,c){return{relativeRow:a,relativeColumn:b,value:c.ge(a,b),area:c.ILa}},c.prototype.tMc=function(a,b,c,d,e,f,g){var i,j,k,l,m,n,o,p=this,q=c[0],r=c[1],s=c[2],t=d[0],u=d[1],v=d[2],w=p.qMc,x={};return p.Vyc.myc.length>1&&(x=p.Vyc.getSigmaValuePosition()),j=x.positionType,k=x.positionIndex,l=p.Wyc===h.PivotTableLayoutType.compact,m=Z(a,b,q,t,w,0===j?k:K,!0,l,e,f,g),n=$(a,b,r,u,w,1===j?k:K,!0,l,e,f,g),o=p.rMc(a,b,s),o.menuArea=4,m&&m.isValueFieldDim===!1&&(D(j)&&!g||(o.menuArea=3)),m&&m.isBlankRow&&(o.menuArea=3),m&&(o.rowInfos=m.Bs),n&&!n.isBlankColumn&&(o.colInfos=n.Cs),i=0===j?m&&m.LDc:n&&n.LDc,D(i)&&1===p.Vyc.myc.length&&(i=v[0].Cj),f&&1===p.Vyc.myc.length&&(i=this.Vyc.getFieldInfoByName(i).Zxc),o.area=s.ILa,o.valueFieldName=i,o},c.prototype.sMc=function(a,b,c,d,e,f,g,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,w=this,x=w.qMc,y=w.Wyc===h.PivotTableLayoutType.compact,z=w.rMc(a,b,c),A=w.Vyc.myc.length>1,B={};return A&&(B=w.Vyc.getSigmaValuePosition()),k=B.positionType,l=B.positionIndex,e?(m=c.lzc,n=m[a],n&&(z.menuArea=2,n.isBlankRow&&(z.menuArea=3),n.isGrandTotal&&(z.menuArea=5),o=0===k?l:K,(!y&&!D(o)&&b===o&&n.valueFieldName||y&&n.isSigmaValue)&&(z.menuArea=4),g||(j=Z(a,b,c,d,x,o,!1,y,f,g,i),j&&(z.activeRowFieldInfo=j.activeRowFieldInfo,z.rowInfos=j.Bs,j.LDc&&(z.valueFieldName=j.LDc))))):0===a?(p="",q=c.kzc[b],q?(p=q.fieldName,r=q.isCompactRoot,p&&(z.colHeadFieldInfo={fieldName:p,itemName:"",isRootCell:!0,isCompactRoot:r},y?z.menuArea=3:z.menuArea=2)):0===d.length&&z.value&&w.Vyc.myc.length>=1?z.menuArea=4:z.menuArea=3):(s=c.mzc,t=s[b],t&&(z.menuArea=2,u=t.isGrandTotal,v=t.isBlankColumn,v||(u&&(z.menuArea=5),o=1===k?l:K,D(o)||a-1!==o||(z.menuArea=4),g||(j=$(a,b,c,d,x,o,!1,y,f,g,i),j&&(z.activeColFieldInfo=j.activeColFieldInfo,z.colInfos=j.Cs,j.LDc&&(z.valueFieldName=j.LDc)))))),z},c.prototype.iT=function(){var a=this.Vyc,b=a.lyc,c=a.jyc,d=a.kyc,e=a.myc;return!(b.length>0||c.length>0||d.length>0||e.length>0)},c.prototype.YBc=function(){return this.Vyc.queryItem()},c.prototype.Fyc=function(){return this.Vyc.Fyc()},c.prototype.Dzc=function(){return this.Vyc.jyc},c.prototype.Czc=function(){return this.Vyc.kyc},c.prototype.Ezc=function(){return this.Vyc.lyc},c.prototype.Bzc=function(){return this.Vyc.myc},c.prototype.wAc=function(){return this.Vyc.getSigmaValuePosition().positionType},c.prototype.Dyc=function(){var a=this.Vyc;return[].concat(a.lyc,a.jyc,a.kyc)},c.prototype.Gyc=function(){var a=this.Vyc;return[].concat(a.myc)},c.prototype.getRange=function(){var a,b,c,e,f,g,h,i,j,k,l,m,n=this;return n.iT()?{page:L,content:new d.Range(n.rAc.row,n.rAc.col,18,3)}:(a=n.rAc,b=a.row,c=a.col,e=a.rowCount,f=a.colCount,g=new d.Range(b,c,e,f),n.sAc&&(h=n.sAc,i=h.row,j=h.col,k=h.rowCount,l=h.colCount,m=new d.Range(i,j,k,l),m.colCount*m.rowCount)?{page:m,content:g}:{page:L,content:g})},c.prototype.clone=function(a,b,d,e){var g,h,i,j=this,k=j.qo,l=k.parent;if(!D(a)&&0!==a.trim().length&&l&&(g=l.AO.getPivotCacheByName(j.Vyc.iyc)))return h=f.iua(a,l),i=l.ZCc(g.getName(),h),new c(h,b,d,e,(void 0),(void 0),(void 0),i)},c.prototype.suspendLayout=function(){this.Lia<=0&&(this.kBJ=this.getRange()),this.Lia++},c.prototype.resumeLayout=function(){this.Lia--,this.refresh()},c.prototype.refresh=function(){this.v8a(!1)},c.prototype.v8a=function(a){if(this.Lia<=0){this.Lia=0,this.Vyc.syc(K,a),this.kBJ=L;var b=this.qo;b&&b.cDJ()&&b.repaint()}},c.prototype.paint=function(a,b){this.ys.hZ(),this.qo.suspendPaint();var c=this.qo,e=this.sAc,f=this.rAc,g=c.pivotTables.xJJ;switch(b||(c.suspendCalcService(),g||(e&&e.rowCount*e.colCount&&c.cg(e.row,e.col,e.rowCount,e.colCount,3,d.StorageType.data|d.StorageType.style,!1,!1,!0),f&&c.cg(f.row,f.col,f.rowCount,f.colCount,3,d.StorageType.data|d.StorageType.style,!1,!1,!0,!!this.options.enableDataValueEditing))),this.Wyc){case h.PivotTableLayoutType.outline:n.PivotTableOutlineLayout.render(this);break;case h.PivotTableLayoutType.tabular:o.PivotTableTabularLayout.render(this);break;case h.PivotTableLayoutType.compact:m.PivotTableCompactLayout.render(this)}b||c.resumeCalcService(!1),this.qo.resumePaint()},c.prototype.WBJ=function(a,b){var c=this,d=a-c.rAc.row,e=b-c.rAc.col,f=c.ys.szc,g=f[0],h=f[1],i=f[2],j=f[3],k=f[4],l=g.Xj>0&&g.OZ>0,m=a,n=b;return l&&(m=a-c.sAc.row,n=b-c.sAc.col),l&&g.Xj>m?g.Gq(m,n):h.Xj>d?h.OZ>e?h.Gq(d,e):i.Gq(d,e-h.OZ):j.OZ>e?j.Gq(d-h.Xj,e):k.Gq(d-h.Xj,e-h.OZ)},c.prototype.VNc=function(a,b,c){var d=this,e=d.Zaa;e&&0!==Object.keys(e).length||(e=new l.PivotTableTheme),e.Yo(a,b,c,d)},c.prototype.WNc=function(a,b){var c,e=this,f=e.TNc,g=e.LBJ,h=e.NJJ,i=f[a]&&f[a][b],j=h[a]&&h[a][b],k=g[i],l=e.WBJ(a,b);if(k||j||l)return c=new d.Style,D(k)||c.Yo(k),D(j)||c.Yo(j),D(l)||c.Yo(l),c},c.prototype.getStyle=function(a){var b,c,d=this,e=d.SNc;for(b=0,c=e.length;b<c;b++)if(fa(a,e[b].pivotArea))return e[b].style},c.prototype.setStyle=function(a,b){var c,d=this;D(a)||(a.references&&a.references.length>0&&ga(a),c=this.getStyle(a),c&&(c=c.clone()),d.XNc(a,b),this.RVa({pivotTable:this,pivotArea:a,style:b,type:"setStyle",oldStyle:c,pivotType:0}),d.refresh())},c.prototype.XNc=function(a,b,c,e){var f,g,h,i,j,k,l,m,n;if(!D(a)){for(f=this,g=f.SNc,b&&(b.clone?h=b.clone():(h=new d.Style,h.fromJSON(b,!1,K))),i=0,j=g.length;i<j;i++)if(fa(a,g[i].pivotArea)){if(k=g[i].style,c){D(b)||D(k)||(h.Yo(k),g[i].style=h);continue}return D(b)?g.splice(i,1):g[i].style=h,void f.UNc()}l={style:h,pivotArea:a,isFakeStyle:e},m=f.SNc.push(l)-1,c||(n=f.getPivotAreaRanges(l.pivotArea),f.YNc(n,m,h))}},c.prototype.getHost=function(){return this.qo},c.prototype.aIJ=function(a,b){var c=this,e=[],f={};d.GC$.extend(e,c.SNc),d.GC$.extend(f,c.TNc),c.SNc=a||[],c.TNc=b||{},c.RVa({type:"resetPivotStyle",areaModel:e,rangeModel:f,pivotTable:c,pivotType:0})},c.prototype.clearAll=function(){var a,b,c,d,e,f=this;for(f.suspendLayout(),a=f.getFieldsByArea(),b=a.length,c=b-1;c>=0;c--)f.remove(a[c].fieldName);for(f.aIJ(),d=f.U5.zR(),e=d.length-1;e>-1;e--)f.U5.jIJ(d[e].conditionalRule);f.resumeLayout()},c.prototype.getConditionalRules=function(a){return this.U5.NNc(a)},c.prototype.addConditionalRule=function(a,b){this.RVa({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.U5.AW.slice(),pivotType:0}),this.U5.ONc(a,b)},c.prototype.removeConditionalRule=function(a){this.RVa({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.U5.AW.slice(),pivotType:0}),this.U5.jIJ(a)},c.prototype.kIJ=function(a,b,c,d,e){this.U5.kIJ(a,b,c,d,e)},c.prototype.$IJ=function(){this.U5.$IJ()},c.prototype.oCJ=function(a){this.U5.oCJ(a)},c.prototype.YNc=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,C,E,F;if(a&&a.length>0&&c){for(e=this,f=e.TNc,g=e.LBJ,h=e.NJJ,i=0,j=a.length;i<j;i++)for(k=a[i],l=la(c),m=k.row,n=k.col,o=k.rowCount,p=k.colCount,q=void 0,(l.borderLeft||l.borderRight||l.borderTop||l.borderBottom)&&(q={},pa(q,k,l)),r=l.borderLeft,s=l.borderRight,t=l.borderTop,u=l.borderBottom,l.borderLeft=K,l.borderRight=K,l.borderTop=K,l.borderBottom=K,v=0;v<o;v++)for(f[m+v]||(f[m+v]={}),q&&q[m+v]&&!h[m+v]&&(h[m+v]={}),w=0;w<p;w++)D(f[m+v][n+w])?(g[b]||(g[b]=la(l)),f[m+v][n+w]=b,q&&q[m+v]&&q[m+v][n+w]&&(x=new d.Style,y=q[m+v][n+w],x.borderLeft=y.borderLeft?r:K,x.borderRight=y.borderRight?s:K,x.borderTop=y.borderTop?t:K,x.borderBottom=y.borderBottom?u:K,h[m+v][n+w]=x)):(z=f[m+v][n+w]+"-"+b,g[z]||(A=la(g[f[m+v][n+w]]),l.Yo(A),g[z]=l,q&&q[m+v]&&q[m+v][n+w]&&h[m+v]&&h[m+v][n+w]&&(x=new d.Style,y=q[m+v][n+w],x.borderLeft=y.borderLeft?r:K,x.borderRight=y.borderRight?s:K,x.borderTop=y.borderTop?t:K,x.borderBottom=y.borderBottom?u:K,h[m+v][n+w].Yo(x))),f[m+v][n+w]=z);if(C=c&&c.formatter,C&&"string"==typeof C&&B(C))for(E=0;E<a.length;E++)F=a[E],e.qo.oJb(F.row||0,F.col||0,C)}},c.prototype.JAJ=function(a){return!(a.labelOnly===!0&&a.dataOnly===!0||a.labelOnly===!0&&!a.references&&D(a.type)&&!a.grandRow&&!a.grandCol)},c.prototype.L1J=function(a,b){var c,e,f,g=this,h=g.rAc,i=g.ys.szc[4];return!g.iT()&&0!==i.Xj&&0!==i.OZ&&(c=i.Xj,e=i.OZ,f=new d.Range(h.row+h.rowCount-c,h.col+h.colCount-e,c,e),!!f.contains(a,b))},c.prototype.setNodeValue=function(a,b){return this.kmK(a,b,!1)},c.prototype.kmK=function(a,b,c){var d,e,f=this,h=f.Vyc;if(!D(a))return"number"==typeof b?(a=f.$3J(a),g.Fa(a)||(e=h.Q1J(a),d=h.t1J(a,b),f.RVa({type:"setNodeValue",pivotTable:f,nodeInfo:a,oldValue:e}))):g.Fa(b)&&(a=f.$3J(a),g.Fa(a)||(e=h.Q1J(a),d=h.v1J(a),f.RVa({type:"setNodeValue",pivotTable:f,nodeInfo:a,oldValue:e}))),f.v8a(c),d},c.prototype.$3J=function(a,b){var c,d,e=this.Vyc,h=e.getAllFieldNameList(),i=e.JUJ;if(a=f._AJ(a),a&&a.fieldInfos&&a.fieldInfos.length>0&&g.Yxc(a.fieldInfos,function(a){var c=a.fieldName,d;if(b){if(d=i[c],!d)return}else if(d=e.getSourceNameByFieldName(c),!d){if(h.indexOf(c)===-1)return;d=c}a.fieldName=d}),a.valueInfo){if(c=a.valueInfo.sourceName,d=void 0,b){if(d=i[c],!d)return}else if(d=e.getSourceNameByFieldName(c),!d){if(h.indexOf(c)===-1)return;d=c}a.valueInfo.sourceName=d}return a},c.prototype.getNodeValue=function(a){var b=this,c=b.Vyc;if(!D(a))return a=b.$3J(a,!0),g.Fa(a)?L:c.Q1J(a)},c.prototype.getNodeInfo=function(a,b){var c,d,e,f,h,i,j,k=this,l=k.Vyc;if(k.L1J(a,b)&&(c=k.getPivotInfoImp(a,b),d=c.valueFieldName,e=c.rowInfos,f=c.colInfos,h=l.getFieldInfoByName(d),!D(h.Zxc)&&!D(h.fyc)))return i={fieldInfos:[],valueInfo:{sourceName:d,subtotalType:h.fyc}},j=function(a){var b=a.fieldName,c=a.itemName;g.Fa(c)||b===O().sigmaValue||i.fieldInfos.push({fieldName:b,fieldItem:c})},e&&e.length>0&&g.Yxc(e,j),f&&f.length>0&&g.Yxc(f,j),i},c.prototype.getOverwriteList=function(){var a=this.Vyc,b=a.x1J();return b&&b.length>0&&g.Yxc(b,function(b){var c=b.fieldInfos;c&&c.length>0&&g.Yxc(c,function(b){var c=a.getFieldNameBySourceName(b.fieldName);c&&(b.fieldName=c)})}),b},c.prototype.clearOverwriteList=function(){this.Vyc.y1J(),this.refresh()},c.prototype.getPivotAreaRanges=function(a){var b,c,e;return D(a)||!this.JAJ(a)?[]:(b=this,a.grandRow||a.grandCol?b.KAJ(a):D(a.references)?D(a.type)?a.labelOnly!==!0?(c=b.ys.szc,e=b.rAc,[new d.Range(c[4].nU+e.row,c[4].hF+e.col,c[3].Xj,c[2].OZ)]):[]:b.ZNc(a):b.$Nc(a))},c.prototype.KAJ=function(a){var b,c,e,f,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=this,G=F.options.grandTotalPosition,H=G===h.GrandTotalPosition.both||G===h.GrandTotalPosition.row,I=G===h.GrandTotalPosition.both||G===h.GrandTotalPosition.col;if(!H&&!I)return[];if(c=F.ys.szc,e=c[4],f=c[3],i=c[2],j=a.references,k=a.references&&a.references.length>0,l=F.rAc,m=l.row,n=l.col,o=new d.Range(e.nU+m,e.hF+n,f.Xj,i.OZ),p=new d.Range(f.nU+m,f.hF+n,f.Xj,f.OZ),q=new d.Range(i.nU+m+1,i.hF+n,i.Xj-1,i.OZ),r=F.Vyc.myc.length,s=F.Vyc.getSigmaValuePosition(),t=s.positionType===g.DataPosition.row,u=s.display,v=new d.Range(o.row+o.rowCount-(u&&t?r:1),p.col,u&&t?r:1,p.colCount+o.colCount),w=new d.Range(q.row,o.col+o.colCount-(u&&!t?r:1),q.rowCount+o.rowCount,u&&!t?r:1),y=a.grandRow===!0&&H,z=a.grandCol===!0&&I,y)x=v;else{if(!z)return[];x=w}if(k&&(A={dataOnly:a.dataOnly,labelOnly:a.labelOnly,references:j},B=F.$Nc(A),B&&B.length>0)){for(C=[],D=0;D<B.length;D++)y&&(B[D]=v.getIntersect(B[D],0,0)),z&&B[D]&&(B[D]=w.getIntersect(B[D],0,0)),B[D]&&C.push(B[D]);return C}if(a.grandRow===!0&&a.grandCol===!0)return H&&I?(b=v.getIntersect(w,0,0),b?[b]:[]):[];if(!k)return b=x.getIntersect(a.labelOnly&&!a.dataOnly?a.grandRow?p:q:o,0,0),b?[b]:[];if(A=M(a),A.dataOnly=!0,A.labelOnly=!1,B=F.$Nc(A),B&&B.length>0){for(C=[],E=0;E<B.length;E++)b=x.getIntersect(B[E],0,0),b&&C.push(b);return C=ra(C)}return[]},c.prototype.ZNc=function(a){var b,c,e,f,g,i,j,l,m,n,o,p,q,r,s,t=this,u=t.rAc,v=u.row,w=u.col,x=t.ys.szc[2],y=x.nU,z=x.hF,A=x.OZ,B=t.ys.szc[3],C=B.nU;if(a.type===h.PivotAreaType.corner){if(D(a.offset))return[new d.Range(v,w,1,1)];if(b=k.formulaToRanges(t.qo,a.offset,v,w,!0)[0].ranges,c=new d.Range(v,w,C-v,z-w),e=new d.Range(v+b.row,w+b.col,b.rowCount?b.rowCount:1,b.colCount?b.colCount:1),f=c.getIntersect(e,0,0),!D(f))return[f]}else if(a.type===h.PivotAreaType.topRight){if(g=x.kzc.length,D(a.offset))return[new d.Range(v+y,w+z+g,1,1)];if(b=k.formulaToRanges(t.qo,a.offset,v+y,w+z+g,!0)[0].ranges,i=new d.Range(v+y,w+z+g,1,A-g),e=new d.Range(v+y+b.row,w+z+g+b.col,b.rowCount?b.rowCount:1,b.colCount?b.colCount:1),f=i.getIntersect(e,0,0),!D(f))return[f]}else if(a.type===h.PivotAreaType.button&&!D(a.fieldName)){for(j=t.Vyc.oyc[a.fieldName],l=void 0,m=void 0,0===j?m=t.sAc:1===j?(l=t.ys.szc[3],m={row:v+l.nU,col:w+l.hF}):2===j&&(l=t.ys.szc[2],m={row:v+l.nU,col:w+l.hF}),n=void 0,o=[],1===j?o=t.ys.szc[3].mzc:2===j&&(o=t.ys.szc[2].lzc),p=0;p<o.length;p++)o[p]&&o[p].path===a.fieldName&&(n=p);if(D(n)){if(0===j)for(q=t.Vyc.lyc,p=0;p<q.length;p++)if(q[p]&&q[p].Cj===a.fieldName)return r=t.options.displayFieldsInPageFilterArea,s=t.options.reportFilterFieldsPerColumn,r===h.DisplayFields.downThenOver?0===s?[new d.Range(m.row+p,m.col,1,1)]:[new d.Range(m.row+p%s,m.col+Math.floor(p/s),1,1)]:0===s?[new d.Range(m.row,m.col+3*p,1,1)]:[new d.Range(m.row+Math.floor(p/s),m.col+p%s,1,1)];return[]}if(1===j)return[new d.Range(m.row-1,m.col+ +n,1,1)];if(2===j)return[new d.Range(m.row,m.col+ +n-1,1,1)]}return[]},c.prototype.$Nc=function(a){var b,c,e,f,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,E,F,G,H,I,J,L,M,N=this,P=N.ys.szc[4],Q=N.rAc.row,R=N.rAc.col,S=P.nU,T=P.hF,U=N.ys.szc[3].Xj,V=N.ys.szc[2].OZ,W=N.Vyc.oyc,X=N.options.subTotalsPosition,Y=N.Vyc.myc.length,Z=[],$=1===a.references.length,_={};for(c=0,e=a.references.length;c<e;c++)f=a.references[c],i=f.fieldName,_[i]=f;for(j=!1,k=N.Vyc.jyc,l=N.Vyc.kyc,c=k.length-1;c>=0;c--)_[k[c].Cj]&&(j===!1?j=!0:_[k[c].Cj].TIJ=!0);for(j=!1,c=l.length-1;c>=0;c--)_[l[c].Cj]&&(j===!1?j=!0:_[l[c].Cj].TIJ=!0);for(c=0,e=a.references.length;c<e;c++){if(f=a.references[c],i=f.fieldName,m=f.items,n=a.labelOnly,o=a.dataOnly,p=f.subtotal,q=[],i===O().Values&&Y>1)b=N.Vyc.getSigmaValuePosition().positionType===g.DataPosition.row?1:2;else{if(i===O().Values&&1===Y&&(D(m)||1===m.length&&m[0]===N.Vyc.myc[0].Cj)){q=[new d.Range(Q+S,R+T,U,V)],Z.push(q);continue}b=W[i]}if(r=void 0,s=void 0,1===b)s=N.ys.szc[3];else if(2===b)s=N.ys.szc[2];else{if(0!==b){Z.push([]);continue}if(s=N.ys.szc[0],D(m)&&a.labelOnly){for(t=N.Vyc.lyc,u=0;u<t.length;u++)if(t[u]&&t[u].Cj===i){if(v=N.options.displayFieldsInPageFilterArea,w=N.options.reportFilterFieldsPerColumn,v===h.DisplayFields.downThenOver){if(0===w){q=[new d.Range(N.sAc.row+u,N.sAc.col,1,1)];break}q=[new d.Range(N.sAc.row+u%w,N.sAc.col+Math.floor(u/w)+1,1,1)];break}if(0===w){q=[new d.Range(N.sAc.row,N.sAc.col+3*u,1,1)];break}q=[new d.Range(N.sAc.row+Math.floor(u/w),N.sAc.col+u%w+1,1,1)];break}Z.push(q);continue}}if(r=s&&s.INc){if(o===!1&&D(n)?(o=!0,n=!0):(o===!1&&n===!1||o===K&&n===K)&&(o=!0),D(m))if(C=N.Vyc.getFieldInfoByName(i),E=C&&C._items,E&&E.length>0){for(x=N.Vyc.myc,y={},u=0;u<Y;u++)y[x[u].Cj]=u;for(u=0;u<E.length;u++)E[u]&&!D(E[u].value)&&(A=E[u].value,B=r[i]&&r[i][A],D(B)||(q=q.concat(N._Nc(B,b,Q,R,S,T,U,V,n,o,p,X,$,i===O().Values,A,y[A],f.TIJ))))}else{F=r[i],G=0;for(H in F)F.hasOwnProperty(H)&&(B=r[i]&&r[i][H],D(B)||(q=q.concat(N._Nc(B,b,Q,R,S,T,U,V,n,o,p,X,$,i===O().Values,H,G,f.TIJ))))}else{for(x=N.Vyc.myc,y={},u=0;u<Y;u++)y[x[u].Cj]=u;for(u=0,z=m.length;u<z;u++)A=m[u],B=r[i]&&r[i][A],D(B)||(q=q.concat(N._Nc(B,b,Q,R,S,T,U,V,n,o,p,X,$,i===O().Values,m[u],y[m[u]],f.TIJ)))}Z.push(q)}}if($)return Z[0];for(I=Z[0],c=1;c<Z.length;c++){for(J=[],u=0;u<I.length;u++)for(L=0;L<Z[c].length;L++)M=I[u]&&Z[c][L]&&I[u].getIntersect(Z[c][L]),M&&J.push(M);I=J}return I=ra(I)},c.prototype._Nc=function(a,b,c,d,e,f,i,j,k,l,m,n,o,p,q,r,s){var t,u,v,w,x,y,z=this,A=[],B=a.ranges,C=a.level,D=n===h.SubtotalsPosition.top||n===h.SubtotalsPosition.bottom;return B&&(t=ja(B),u=void 0,v=void 0,w=z.Vyc.getSigmaValuePosition(),1===b?(x=z.Vyc.jyc.length,u=C>1&&D&&!(2===C&&w.display&&w.positionType===g.DataPosition.row&&x+1-w.positionIndex===1),v=w.display&&w.positionType===g.DataPosition.row&&x-w.positionIndex<C?z.Vyc.myc.length:1,z.cOc(A,t,C,c+e,d+f,i,j,k,l,m,n,o,u,v,p,q,r,s)):2===b&&(y=z.Vyc.kyc.length,u=C>1&&D&&!(2===C&&w.display&&w.positionType===g.DataPosition.col&&y+1-w.positionIndex===1),v=w.display&&w.positionType===g.DataPosition.col&&y-w.positionIndex<C?z.Vyc.myc.length:1,z.dOc(A,t,C,c+e,d+f,i,j,k,l,m,n,o,u,v,p,q,r))),A},c.prototype.cOc=function(a,b,c,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t){var u,v,w,x,y,z,A,B=this,C=B.layoutType();for(u=0,v=b.length;u<v;u++)D(b[u])||(!j||l&&!q||(w=new d.Range(0,0,0,0),w.row=e+b[u].start,w.col=C===h.PivotTableLayoutType.compact?f-1:f-c,w.rowCount=C===h.PivotTableLayoutType.tabular||t?b[u].end-b[u].start+1:1,w.colCount=C===h.PivotTableLayoutType.outline?c:n?1:c,a.push(w)),!k||l&&!q||(x=new d.Range(0,0,0,0),x.row=e+b[u].start,x.col=f,x.rowCount=q||t?b[u].end-b[u].start+1:1,x.colCount=i,a.push(x)),o&&l&&!q&&(y=m===h.SubtotalsPosition.top&&this.layoutType()!==h.PivotTableLayoutType.tabular?e+b[u].end-1:e+b[u].end+1,j?(w=new d.Range(0,0,0,0),w.row=y,w.col=f-c,w.rowCount=p,w.colCount=n?1:c,a.push(w)):(x=new d.Range(0,0,0,0),x.row=y,x.col=f,x.rowCount=p,x.colCount=i,a.push(x))));k&&q&&(z=this.Vyc.myc.length,A=new d.Range(0,0,0,0),A.row=e+g-(z-s),A.col=f,A.rowCount=1,A.colCount=i,a.push(A))},c.prototype.dOc=function(a,b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s,t,u,v,w,x;for(s=0,t=b.length;s<t;s++)D(b[s])||(!i||k&&!p||(u=new d.Range(0,0,0,0),u.row=e-c,u.col=f+b[s].start,u.rowCount=m?1:c,u.colCount=b[s].end-b[s].start+1,a.push(u)),!j||k&&!p||(v=new d.Range(0,0,0,0),v.row=e,v.col=f+b[s].start,v.rowCount=g,v.colCount=b[s].end-b[s].start+1,a.push(v)),n&&k&&!p&&(i?(u=new d.Range(0,0,0,0),u.row=e-c,u.col=f+b[s].end+1,u.rowCount=m?1:c,u.colCount=o,a.push(u)):(v=new d.Range(0,0,0,0),v.row=e,v.col=f+b[s].end+1,v.rowCount=g,v.colCount=o,a.push(v))));j&&p&&(w=this.Vyc.myc.length,x=new d.Range(0,0,0,0),x.row=e,x.col=f+h-(w-r),x.rowCount=g,x.colCount=1,a.push(x))},c.prototype.RLc=function(){var a=this,b=a.MLc,c=a.qo;c.suspendPaint(),a.SLc(),a.options.mergeItem&&(a.TLc(),a.ULc()),c.resumePaint(),b.LLc=[],b.NLc=[]},c.prototype.SLc=function(){var a=this,b=a.MLc,c=a.qo,d=b.PLc,e=b.OLc;0===e.length&&0===d.length||(g.Yxc(e,function(a){c.removeSpan(a.row,a.col)}),g.Yxc(d,function(a){c.removeSpan(a.row,a.col)}),g.Yxc(a.QLc,function(a){c.getRange(a.row,a.col,a.rowCount,a.colCount).vAlign(a.vAlign).hAlign(a.hAlign)}),b.PLc=[],b.OLc=[],a.QLc=[])},c.prototype.ULc=function(){var a,b,c,d,e,f,h,i,j,k,l,m=this,n=m.qo,o=m.ys.szc[3],p=m.ys.szc[2],q=m.MLc,r=p.isHideFirstRow?2:3;(!o||o.OZ<2)&&(!p||p.Xj<r)||(a=m.rAc,b=a.row,c=a.col,d=o.nU,e=o.hF,f=p.nU,h=p.hF,i=q.NLc,j=q.LLc,k=q.PLc,l=q.OLc,g.Yxc(j,function(a){var f=a.row,g=a.col,h=a.rowCount,i=a.colCount;f+=d+b,g+=e+c,n.Sq(f,g,h,i),k.push({row:f,col:g,rowCount:h,colCount:i})}),g.Yxc(i,function(a){var d=a.row,e=a.col,g=a.rowCount,i=a.colCount;d+=f+b,e+=h+c,n.Sq(d,e,g,i),l.push({row:d,col:e,rowCount:g,colCount:i})}))},c.prototype.TLc=function(){var a=this,b=a.qo,c=a.QLc,d=a.ys.szc[3].getRange(),e=a.ys.szc[2].getRange(),f=a.ys.szc[1].getRange(),g=a.rAc,i=g.row,j=g.col;a.layoutType()!==h.PivotTableLayoutType.compact&&c.push(a.VLc(b.getRange(d.row+i,d.col+j,d.rowCount,d.colCount))),c.push(a.VLc(b.getRange(e.row+i,e.col+j,e.rowCount,e.colCount))),c.push(a.VLc(b.getRange(f.row+i,f.col+j,f.rowCount,f.colCount)))},c.prototype.VLc=function(a){var b={row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount,vAlign:a.vAlign(),hAlign:a.hAlign()};return a.hAlign(1).vAlign(1),b},c.prototype.LSb=function(a){var b=this.Vyc;return b.getFieldInfoByName(a)},c.prototype.fromJson=function(a,c){var e,f,g,i,j,k,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this;if(A.pBJ(a),D(a.multipleFieldFilters)?A.options.allowMultipleFiltersPerField=!0:A.options.allowMultipleFiltersPerField=a.multipleFieldFilters,D(a.styleName)?A.theme("light0"):(e=b.BuiltInPivotTableThemeNames[a.styleName.toUpperCase()],e?(f=a.styleName.replace("PivotStyle","").toLowerCase(),A.theme(f)):(g=a.style,i=new l.PivotTableTheme,i.fromJSON(g),A.theme(i))),a.rowGrandTotals===!1&&a.colGrandTotals===!1?A.options.grandTotalPosition=h.GrandTotalPosition.none:a.rowGrandTotals===!1?A.options.grandTotalPosition=h.GrandTotalPosition.row:a.colGrandTotals===!1?A.options.grandTotalPosition=h.GrandTotalPosition.col:A.options.grandTotalPosition=h.GrandTotalPosition.both,
D(a.showRowHeaders)||(A.options.showRowHeader=a.showRowHeaders),D(a.showColHeaders)||(A.options.showColumnHeader=a.showColHeaders),D(a.showRowStripes)||(A.options.bandRows=a.showRowStripes),D(a.showColStripes)||(A.options.bandColumns=a.showColStripes),D(a.pageOverThenDown)||(A.options.displayFieldsInPageFilterArea=a.pageOverThenDown?h.DisplayFields.overThenDown:h.DisplayFields.downThenOver),D(a.pageWrap)||(A.options.reportFilterFieldsPerColumn=a.pageWrap),D(a.showFilter)||(A.options.showFilter=a.showFilter),D(a.showDrill)||(A.options.showDrill=a.showDrill),D(a.showToolTip)||(A.options.showToolTip=a.showToolTip),D(a.showMissing)||(A.options.showMissing=a.showMissing),D(a.missingCaption)||(A.options.missingCaption=a.missingCaption),D(a.indent)?A.options.rowLabelIndent=2:A.options.rowLabelIndent=a.indent+1,D(a.errorCaption)||(A.options.errorValueInfo=a.errorCaption),D(a.showError)||(A.options.isShowErrorValue=a.showError),D(a.showDataTips)||(A.options.showToolTip=a.showDataTips),D(a.showHeaders)||(A.options.showHeaders=a.showHeaders),D(a.mergeItem)||(A.options.mergeItem=a.mergeItem),D(a.dataCaption)||(A.dataCaption=a.dataCaption),D(a.fillDownLabels)||(A.options.fillDownLabels=a.fillDownLabels),D(a.printDrill)||(A.options.printDrill=a.printDrill),D(a.itemPrintTitles)||(A.options.itemPrintTitles=a.itemPrintTitles),D(a.fieldPrintTitles)||(A.options.fieldPrintTitles=a.fieldPrintTitles),D(a.rowHeaderCaption)||(A.options.rowHeaderCaption=a.rowHeaderCaption),D(a.colHeaderCaption)||(A.options.colHeaderCaption=a.colHeaderCaption),D(a.enableDataValueEditing)||(A.options.enableDataValueEditing=a.enableDataValueEditing),!D(a.formats))for(j=0;j<a.formats.length;j++)k=a.formats[j],D(k.style)||E(k.style)||(m=A.excelPivotAreaToSheetPivotArea(k.pivotArea),n=new d.Style,n.fromJSON(k.style,!1,K),A.XNc(m,n,!0));if(o=A.qo,p=o.conditionalFormats,!D(a.pivotTableConditionFormats)&&p){for(q=[],r=[],j=0;j<a.pivotTableConditionFormats.length;j++)a.pivotTableConditionFormats[j]&&a.pivotTableConditionFormats[j].rule&&(q[a.pivotTableConditionFormats[j].rule.priority-1]=a.pivotTableConditionFormats[j]);for(j=q.length-1;j>=0;j--)q[j]&&r.push(q[j]);for(a.pivotTableConditionFormats=r,j=0;j<a.pivotTableConditionFormats.length;j++){for(s=a.pivotTableConditionFormats[j],t=[],u=0;u<s.pivotAreas.length;u++)t.push(A.excelPivotAreaToSheetPivotArea(s.pivotAreas[u]));s.rule&&(v=void 0,s.rule.ruleType?v=p.iga(s.rule,o,!1):s.rule.priority&&c.conditionalFormats&&c.conditionalFormats.rules&&(v=p.iga(c.conditionalFormats.rules[s.rule.priority-1],o,!1)),A.U5.ONc(t,v,!0))}}if(D(a.views)||A.views.fromJson(a.views),D(a.altText)||(A.DBJ=a.altText),D(a.altTextSummary)||(A.EBJ=a.altTextSummary),a.dataFields&&a.dataFields.length>0)for(w=a.dataFields,x=0,y=w;x<y.length;x++)z=y[x],D(z.showDataAs)||(A.JFJ=!0)},c.prototype.cdK=function(a,c,e){var f,i,j,k,l,m,n,o,p,q,r,t,u,v,A,B,C,E,F,G,H,I,J,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa=this,ba=c.styleManager;if(aa.wjK(a,ba),D(a.multipleFieldFilters)?aa.options.allowMultipleFiltersPerField=!0:aa.options.allowMultipleFiltersPerField=y(a.multipleFieldFilters),f=s(a,"pivotTableStyleInfo"),i=f&&f.name,D(i)&&(i="PivotStyleLight0"),j=i||ba.getDefaultStyleName("defaultPivotStyle"),k=b.BuiltInPivotTableThemeNames[j.toUpperCase()],k?(l=j.replace("PivotStyle","").toLowerCase(),aa.theme(l)):(m=ba.getPivotTableTheme(j),aa.theme(m)),D(f)||(aa.options.showRowHeader=y(f.showRowHeaders,!1),aa.options.showColumnHeader=y(f.showColHeaders,!1),D(f.showRowStripes)||(aa.options.bandRows=y(f.showRowStripes)),D(f.showColStripes)||(aa.options.bandColumns=y(f.showColStripes))),n=y(a.rowGrandTotals),o=y(a.colGrandTotals),n===!1&&o===!1?aa.options.grandTotalPosition=h.GrandTotalPosition.none:n===!1?aa.options.grandTotalPosition=h.GrandTotalPosition.row:o===!1?aa.options.grandTotalPosition=h.GrandTotalPosition.col:aa.options.grandTotalPosition=h.GrandTotalPosition.both,D(a.pageOverThenDown)||(aa.options.displayFieldsInPageFilterArea=y(a.pageOverThenDown)?h.DisplayFields.overThenDown:h.DisplayFields.downThenOver),D(a.pageWrap)||(aa.options.reportFilterFieldsPerColumn=z(a.pageWrap)),p=a.lossless,p&&(D(p.showFilter)||(aa.options.showFilter=p.showFilter),D(p.showToolTip)||(aa.options.showToolTip=p.showToolTip),D(p.enableDataValueEditing)||(aa.options.enableDataValueEditing=p.enableDataValueEditing),D(p.views)||aa.views.fromJson(p.views)),D(a.showDrill)||(aa.options.showDrill=y(a.showDrill)),D(a.showMissing)||(aa.options.showMissing=y(a.showMissing)),D(a.missingCaption)||(aa.options.missingCaption=a.missingCaption),D(a.indent)?aa.options.rowLabelIndent=2:aa.options.rowLabelIndent=z(a.indent)+1,D(a.errorCaption)||(aa.options.errorValueInfo=a.errorCaption),D(a.showError)||(aa.options.isShowErrorValue=y(a.showError)),D(a.showDataTips)||(aa.options.showToolTip=y(a.showDataTips)),D(a.showHeaders)||(aa.options.showHeaders=y(a.showHeaders)),D(a.mergeItem)||(aa.options.mergeItem=y(a.mergeItem)),D(a.dataCaption)||(aa.dataCaption=a.dataCaption),D(a.printDrill)||(aa.options.printDrill=y(a.printDrill)),D(a.itemPrintTitles)||(aa.options.itemPrintTitles=y(a.itemPrintTitles)),D(a.fieldPrintTitles)||(aa.options.fieldPrintTitles=y(a.fieldPrintTitles)),D(a.rowHeaderCaption)||(aa.options.rowHeaderCaption=a.rowHeaderCaption),D(a.colHeaderCaption)||(aa.options.colHeaderCaption=a.colHeaderCaption),q=s(a,"formats"),!D(q))for(q=q.c_||[],r=0;r<q.length;r++)t=q[r],u=z(t.dxfId),v=aa.excelPivotAreaSJSToSheetPivotArea(s(t,"pivotArea")),A=new d.Style,ba.getDxf(u,A),A.fromJSON(A,!1,K),aa.XNc(v,A,!0);if(B=aa.qo,C=B.conditionalFormats,E=s(a,"conditionalFormats"),!D(E)&&E.c_&&E.c_.length>0){for(F=[],G=[],H=E.c_,I=x(e,"conditionalFormatting").filter(function(a){return d.NodeHelper.oca(a.pivot)===!0}),J=[],L=function(a){var b,c=z(H[a].priority);I&&(g.Yxc(I,function(d){var e=d.c_;if(g.Yxc(e,function(e){if(+e.priority===c)return H[a].rule=e,b=d,!0}),b)return!0}),H[a].rule&&(F[H[a].rule.priority-1]={pivotCf:H[a],sheetCf:b}))},r=0;r<H.length;r++)L(r);for(r=F.length-1;r>=0;r--)F[r]&&G.push(F[r]);for(r=0;r<G.length;r++){for(M=G[r].pivotCf,N=G[r].sheetCf,O=[],P=s(M,"pivotAreas").c_,Q=0;Q<P.length;Q++)O.push(aa.excelPivotAreaSJSToSheetPivotArea(P[Q]));M.rule&&(R=d.range_parser.CcK(N.sqref,K,!0),S=void 0,M.rule.type?S=C.IlK(M.rule,R,ba,B):M.rule.priority&&N&&N.c_&&(S=C.IlK(N.c_[M.rule.priority-1],R,ba,B)),S&&(aa.U5.ONc(O,S,!0),J.push(S)))}J.length>0&&(T=s(e,"extLst"),U=w(T,"ext&conditionalFormattings"),C.JlK(U,c,B,J,T,!1,!0))}if(V=s(a,"extLst"),D(V)||(W=V.c_,W.forEach(function(a){var b=s(a,"pivotTableDefinition");D(b)||(D(b.altText)||(aa.DBJ=b.altText),D(b.fillDownLabelsDefault)||(aa.options.fillDownLabels=y(b.fillDownLabelsDefault)),D(b.altTextSummary)||(aa.EBJ=b.altTextSummary))})),X=s(a,"dataFields"))for(Y=X.c_,Z=0,$=Y;Z<$.length;Z++)_=$[Z],D(_.showDataAs)||(aa.JFJ=!0)},c.prototype.pBJ=function(a){var b,c,e,f,g,h,i,j=this,k=a.fields;for(b=0,c=k.length;b<c;b++)e=k[b],D(e.numberFormat)||(f={labelOnly:!0,references:[{fieldName:e.name}]},g=new d.Style,g.formatter=e.numberFormat,j.XNc(f,g,!0,!0));if(h=a.dataFields,h&&h.length>0)if(i=h.length,1!==i||D(h[0].numberFormat))for(b=0;b<i;b++)e=h[b],D(e.numberFormat)||(f={dataOnly:!0,references:[{fieldName:O().Values,items:[e.name]}]},g=new d.Style,g.formatter=e.numberFormat,j.XNc(f,g,!0,!0));else f={dataOnly:!0},g=new d.Style,g.formatter=h[0].numberFormat,j.XNc(f,g,!0,!0)},c.prototype.wjK=function(a,b){var c,d,e,f,g,h,i,j=this,k=s(a,"pivotFields");if(k)for(c=0,d=k.c_.length;c<d;c++)e=k.c_[c],D(e.numFmtId)||(f={labelOnly:!0,references:[{fieldName:e.name}]},g=ua(b,e),j.XNc(f,g,!0,!0));if(h=s(a,"dataFields"),i=h&&h.c_.length,h&&i>0)if(1!==i||D(h.c_[0].numFmtId))for(c=0;c<i;c++)e=h.c_[c],D(e.numFmtId)||(f={dataOnly:!0,references:[{fieldName:O().Values,items:[e.name]}]},g=ua(b,e),j.XNc(f,g,!0,!0));else f={dataOnly:!0},g=ua(b,h.c_[0]),j.XNc(f,g,!0,!0)},c.prototype.excelPivotAreaToSheetPivotArea=function(a){var b,c,d,e,f,g,i,j,k,l=this,m=l.Vyc.HL,n={};if(D(a.labelOnly)||(n.labelOnly=a.labelOnly),D(a.dataOnly)||(n.dataOnly=a.dataOnly),D(a.grandCol)||(n.grandCol=a.grandCol),D(a.grandRow)||(n.grandRow=a.grandRow),"axisRow"===a.axis?n.axis=h.PivotAreaAxisType.row:"axisCol"===a.axis&&(n.axis=h.PivotAreaAxisType.col),!D(a.references)&&a.references.length>0){for(n.references=[],b=0;b<a.references.length;b++)if(c=a.references[b],d={},e=c.field===S||c.field===+S?{Cj:O().Values,_items:[]}:m[c.field],e){if(f=e.Cj,c.indexes){for(g=[],i=0,j=c.indexes.length;i<j;i++)k=c.indexes[i],D(k)||g.push(f===O().Values?l.Vyc.myc[k].Cj:e._items[k]&&e._items[k].value);g.length>0&&(d.items=g)}d.fieldName=f,D(c.defaultSubtotal)||(d.subtotal=c.defaultSubtotal),n.references.push(d)}}else D(a.type)||(n.type=ha(a.type),n.fieldName=m&&m[a.field]&&m[a.field].Cj,n.offset=a.offset);return n},c.prototype.excelPivotAreaSJSToSheetPivotArea=function(a){var b,c,d,e,f,g,i,j,k,l,m,n,o=this,p=o.Vyc.HL,q={};if(D(a.labelOnly)||(q.labelOnly=y(a.labelOnly)),D(a.dataOnly)||(q.dataOnly=y(a.dataOnly)),D(a.grandCol)||(q.grandCol=y(a.grandCol)),D(a.grandRow)||(q.grandRow=y(a.grandRow)),"axisRow"===a.axis?q.axis=h.PivotAreaAxisType.row:"axisCol"===a.axis&&(q.axis=h.PivotAreaAxisType.col),b=s(a,"references"),D(b))D(a.type)||(q.type=ha(a.type),e=z(a.field),q.fieldName=p&&p[e]&&p[e].Cj,q.offset=a.offset);else for(b=b.c_,q.references=[],c=0;c<b.length;c++)if(d=b[c],e=A(d.field),f={},g=e===S||e===+S?{Cj:O().Values,_items:[]}:p[e],g){if(i=g.Cj,j=d.c_,!D(j)){for(k=[],l=0,m=j.length;l<m;l++)n=z(j[l].v),D(n)||k.push(i===O().Values?o.Vyc.myc[n].Cj:g._items[n]&&g._items[n].value);k.length>0&&(f.items=k)}f.fieldName=i,D(d.defaultSubtotal)||(f.subtotal=y(d.defaultSubtotal)),q.references.push(f)}return q},c.prototype.toJson=function(a,b){var c,d,e,f,i,j,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,E,F,G,H,I,J,K,L,M,N,P,Q,R,S,T,U,V,W,X,Y,Z,$=this,_=$.getRange().content;if(b&&b.ignoreStyle)return a||(a={data:$.qo.ITa.sheetModels[3].toJSON(3,b)}),c=$.ys.szc,d=c[0],e=c[1],f=c[2],i=c[3],j=c[4],m=$.sAc,n=a.data.dataTable,va(m.row+d.nU,m.col+d.hF,n,d.dataTable,ta),va(_.row+e.nU,_.col+e.hF,n,e.dataTable,ta),va(_.row+f.nU,_.col+f.hF,n,f.dataTable,ta),va(_.row+i.nU,_.col+i.hF,n,i.dataTable,ta),void va(_.row+j.nU,_.col+j.hF,n,j.dataTable,ta);switch(o=$.Vyc,p=o&&o.Lqa?o.Lqa:{},q=$.layoutType(),q){case h.PivotTableLayoutType.outline:p.compact=!1,p.compactData=!1,p.outline=!0,p.outlineData=!0;break;case h.PivotTableLayoutType.tabular:p.compact=!1,p.compactData=!1,p.outline=!1,p.outlineData=!1;break;default:p.outline=!0,p.outlineData=!0}if(D($.Cj)||(b&&b.newWorkSheetName&&$.qo&&$.qo.parent?(r=$.qo.parent,p.name=$.IVJ=r.iua($.Cj)):p.name=$.Cj),D($.options.allowMultipleFiltersPerField)||(p.multipleFieldFilters=$.options.allowMultipleFiltersPerField),s=o.getSigmaValuePosition(),s.display&&s.positionType===g.DataPosition.row&&(p.dataOnRows=!0),t=$.theme(),u=t&&t.name(),D(u)||(v=l.PivotTableThemes[u.toLowerCase()],v?(u=u.replace(/^[a-z]{1}/g,function(a){return a.toUpperCase()}),p.styleName="PivotStyle"+u):(p.styleName=u,p.style=t.toJSON())),D($.options.showRowHeader)||(p.showRowHeaders=$.options.showRowHeader),D($.options.showColumnHeader)||(p.showColHeaders=$.options.showColumnHeader),D($.options.bandRows)||(p.showRowStripes=$.options.bandRows),D($.options.bandColumns)||(p.showColStripes=$.options.bandColumns),D($.options.displayFieldsInPageFilterArea)||(p.pageOverThenDown=$.options.displayFieldsInPageFilterArea===h.DisplayFields.overThenDown),D($.options.reportFilterFieldsPerColumn)||(p.pageWrap=$.options.reportFilterFieldsPerColumn),D($.options.showFilter)||(p.showFilter=$.options.showFilter),D($.options.showDrill)||(p.showDrill=$.options.showDrill),D($.options.showMissing)||(p.showMissing=$.options.showMissing),D($.options.showToolTip)||(p.showToolTip=$.options.showToolTip),D($.options.missingCaption)||(p.missingCaption=$.options.missingCaption),D($.options.fillDownLabels)||(p.fillDownLabels=$.options.fillDownLabels),D($.options.rowLabelIndent)||2===$.options.rowLabelIndent||(p.indent=$.options.rowLabelIndent-1),D($.options.printDrill)||(p.printDrill=$.options.printDrill),D($.options.itemPrintTitles)||(p.itemPrintTitles=$.options.itemPrintTitles),D($.options.fieldPrintTitles)||(p.fieldPrintTitles=$.options.fieldPrintTitles),D($.options.mergeItem)||(p.mergeItem=$.options.mergeItem),D($.options.grandTotalPosition)||(w=$.options.grandTotalPosition,w!==h.GrandTotalPosition.none&&w!==h.GrandTotalPosition.col||(p.colGrandTotals=!1),w!==h.GrandTotalPosition.none&&w!==h.GrandTotalPosition.row||(p.rowGrandTotals=!1)),D($.dataCaption)?p.dataCaption="Values":p.dataCaption=$.dataCaption,D($.options.errorValueInfo)||(p.errorCaption=$.options.errorValueInfo),D($.options.isShowErrorValue)||(p.showError=$.options.isShowErrorValue),D($.options.showToolTip)||(p.showDataTips=$.options.showToolTip),D($.options.showHeaders)||(p.showHeaders=$.options.showHeaders),D($.options.rowHeaderCaption)||(p.rowHeaderCaption=$.options.rowHeaderCaption),D($.options.colHeaderCaption)||(p.colHeaderCaption=$.options.colHeaderCaption),D($.options.enableDataValueEditing)||(p.enableDataValueEditing=$.options.enableDataValueEditing),D($.views)||(p.views=$.views.toJson()),D($.DBJ)||(p.altText=$.DBJ),D($.EBJ)||(p.altTextSummary=$.EBJ),D(p.createdVersion)&&(p.createdVersion=6),x=$.ys&&$.ys.szc&&$.ys.szc&&$.ys.szc[4]&&$.ys.szc[4].nU||0,y=$.ys&&$.ys.szc&&$.ys.szc&&$.ys.szc[4]&&$.ys.szc[4].hF||0,$.Bzc()&&$.Bzc().length>0||$.Dzc()&&$.Dzc().length>0||$.Czc()&&$.Czc().length>0?p.firstHeaderRow=1:p.firstHeaderRow=0,p.firstDataRow=x,p.firstDataCol=y,z=$.Vyc.lyc&&$.Vyc.lyc.length,A=!D($.options.reportFilterFieldsPerColumn),$.options.displayFieldsInPageFilterArea===h.DisplayFields.overThenDown?0===$.options.reportFilterFieldsPerColumn?(p.rowPageCount=1,p.colPageCount=z):(p.rowPageCount=A?Math.ceil(z/$.options.reportFilterFieldsPerColumn):1,p.colPageCount=A?Math.min($.options.reportFilterFieldsPerColumn,z):z):0===$.options.reportFilterFieldsPerColumn?(p.rowPageCount=z,p.colPageCount=1):(p.rowPageCount=z?Math.min($.options.reportFilterFieldsPerColumn,z):z,p.colPageCount=z?Math.ceil(z/$.options.reportFilterFieldsPerColumn):1),p.ref=k.rangesToFormula([_],0,0,15,!1),o.GDc(),$.SNc&&$.SNc.length>0){for(p.formats=[],B=0;B<$.SNc.length;B++)if(C=$.SNc[B],E=C.pivotArea,F=C.style,!oa(F)&&!C.isFakeStyle&&(p.formats.push({style:F,pivotArea:$.sheetPivotAreaToExcelPivotArea(E)}),E.references&&1===E.references.length&&C.style&&!D(C.style.formatter)))if(G=$.Vyc,E.references[0].fieldName===O().Values){for(H=G.myc,I=H.length,J={},K=0;K<I;K++)J[H[K].Cj]=K;if(L=E.references[0].items,!L)for(L=[],M=0;M<I;M++)L.push(H[M].Cj);for(M=0;M<L.length;M++)D(J[L[M]])||(H[J[L[M]]].nBJ=C.style.formatter)}else!E.labelOnly||E.dataOnly||E.references[0].items&&0!==E.references[0].items.length||(N=G.oBJ(E.fieldName),N&&(N.nBJ=C.style.formatter));a||(a={data:$.qo.ITa.sheetModels[3].toJSON(3,b)}),n=a.data.dataTable,P=$.TNc,Q=$.NJJ;for(R in P)if(P.hasOwnProperty(R)){S=P[R];for(T in S)S.hasOwnProperty(T)&&(D(n[R])&&(n[R]={}),D(n[R][T])&&(n[R][T]={}),F=la($.LBJ[S[T]]),U=Q[R]&&Q[R][T],U&&F.Yo(U),n[R][T].style&&F.Yo(n[R][T].style),n[R][T].style=F)}}if($.U5.AW&&$.U5.AW.length>0)for(p.pivotTableConditionFormats=[],B=0;B<$.U5.AW.length;B++){for(V=$.U5.AW[B],W=V.pivotAreas,X=[],M=0;M<W.length;M++)X.push($.sheetPivotAreaToExcelPivotArea(W[M]));Y=na(V.conditionalRule,V.conditionalRule.toJSON($.qo)),Z={rule:Y,pivotAreas:X},p.pivotTableConditionFormats.push(Z)}return o.toJson($,p),p.rowItems=$.xAc(!0),p.columnItems=$.xAc(!1),p},c.prototype.bdK=function(a,b,c){var d,e,f,i,j,m,n,o,p,q,r,w,x,y,z,A,B,C,E,F,G,H,I,J,L,M,N,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,ma=this,pa=ma.getRange().content;switch(D(a)&&(a={n_:"sheetData"}),d=ma.Vyc,e=d.pjK?d.pjK:{n_:"pivotTableDefinition"},f=ma.layoutType(),e.xmlns=K,e["xmlns:mc"]=K,e["mc:Ignorable"]=K,e["xmlns:xr"]=K,e.r_=[13,14,15,16],f){case h.PivotTableLayoutType.outline:e.compact="0",e.compactData="0",e.outline="1",e.outlineData="1";break;case h.PivotTableLayoutType.tabular:e.compact="0",e.compactData="0",e.outline="0",e.outlineData="0";break;default:e.outline="1",e.outlineData="1"}if(D(ma.Cj)||(c&&c.newWorkSheetName&&ma.qo&&ma.qo.parent?(i=ma.qo.parent,e.name=t(ma.IVJ=i.iua(ma.Cj))):e.name=t(ma.Cj)),ma.options.allowMultipleFiltersPerField===!1&&(e.multipleFieldFilters=u(ma.options.allowMultipleFiltersPerField)),j=d.getSigmaValuePosition(),j.display&&j.positionType===g.DataPosition.row&&(e.dataOnRows="1"),m=e.c_=[],n=b.styleManager,o=ma.theme(),o?(p=s(e,"pivotTableStyleInfo")||{n_:"pivotTableStyleInfo"},q=o.name(),D(q)||(r=l.PivotTableThemes[q.toLowerCase()],r?(q=q.replace(/^[a-z]{1}/g,function(a){return a.toUpperCase()}),p.name="PivotStyle"+q):(p.name=q,w=o.bdK(n),w&&w.length>0&&(x={n_:"tableStyle",name:q,table:0,count:w.length,c_:w},n.addTableStyle(x)))),ma.options.showRowHeader&&(p.showRowHeaders="1"),ma.options.showColumnHeader&&(p.showColHeaders="1"),p.showRowStripes=u(ma.options.bandRows,1),p.showColStripes=u(ma.options.bandColumns,1),m.push(p)):m.push({n_:"pivotTableStyleInfo",showRowStripes:"1",showColStripes:"1"}),ma.options.displayFieldsInPageFilterArea===h.DisplayFields.overThenDown&&(e.pageOverThenDown="1"),ma.options.reportFilterFieldsPerColumn>0&&(e.pageWrap=""+ma.options.reportFilterFieldsPerColumn),ma.options.showMissing===!1&&(e.showMissing="0"),D(ma.options.missingCaption)||(e.missingCaption=ma.options.missingCaption),!D(ma.options.rowLabelIndent)&&2!==ma.options.rowLabelIndent&&ma.options.rowLabelIndent-1>=0&&(e.indent=""+(ma.options.rowLabelIndent-1)),ma.options.printDrill&&(e.printDrill="1"),ma.options.itemPrintTitles&&(e.itemPrintTitles="1"),ma.options.fieldPrintTitles&&(e.fieldPrintTitles="1"),ma.options.mergeItem&&(e.mergeItem="1"),D(ma.options.grandTotalPosition)||(y=ma.options.grandTotalPosition,y!==h.GrandTotalPosition.none&&y!==h.GrandTotalPosition.col||(e.colGrandTotals="0"),y!==h.GrandTotalPosition.none&&y!==h.GrandTotalPosition.row||(e.rowGrandTotals="0")),D(ma.dataCaption)?e.dataCaption="Values":e.dataCaption=ma.dataCaption,D(ma.options.errorValueInfo)||(e.errorCaption=ma.options.errorValueInfo),ma.options.isShowErrorValue&&(e.showError="1"),ma.options.showHeaders===!1&&(e.showHeaders="0"),D(ma.options.colHeaderCaption)||(e.colHeaderCaption=ma.options.colHeaderCaption),D(ma.options.rowHeaderCaption)||(e.rowHeaderCaption=ma.options.rowHeaderCaption),D(e.createdVersion)&&(e.createdVersion="7"),D(e.updatedVersion)&&(e.updatedVersion="7"),ma.options.showToolTip===!1&&(e.showDataTips="0"),ma.options.showFilter===!1&&(e.showHeaders="0"),ma.options.showDrill===!1&&(e.showDrill="0"),e.lossless={},D(ma.options.fillDownLabels)||(e.lossless.fillDownLabels=ma.options.fillDownLabels),D(ma.options.enableDataValueEditing)||(e.lossless.enableDataValueEditing=ma.options.enableDataValueEditing),D(ma.views)||(e.lossless.views=ma.views.toJson()),z=ma.ys&&ma.ys.szc&&ma.ys.szc&&ma.ys.szc[4]&&ma.ys.szc[4].nU||0,A=ma.ys&&ma.ys.szc&&ma.ys.szc&&ma.ys.szc[4]&&ma.ys.szc[4].hF||0,B=ma.Bzc()&&ma.Bzc().length>0||ma.Dzc()&&ma.Dzc().length>0||ma.Czc()&&ma.Czc().length>0?1:0,F=ma.Vyc.lyc&&ma.Vyc.lyc.length,G=!D(ma.options.reportFilterFieldsPerColumn),ma.options.displayFieldsInPageFilterArea===h.DisplayFields.overThenDown?0===ma.options.reportFilterFieldsPerColumn?(C=1,E=F):(C=G?Math.ceil(F/ma.options.reportFilterFieldsPerColumn):1,E=G?Math.min(ma.options.reportFilterFieldsPerColumn,F):F):0===ma.options.reportFilterFieldsPerColumn?(C=F,E=1):(C=F?Math.min(ma.options.reportFilterFieldsPerColumn,F):F,E=F?Math.ceil(F/ma.options.reportFilterFieldsPerColumn):1),H={n_:"location",ref:k.rangesToFormula([pa],0,0,15,!1)},z>=0&&(H.firstDataRow=""+z),A>=0&&(H.firstDataCol=""+A),B>=0&&(H.firstHeaderRow=""+B),C>0&&(H.rowPageCount=""+C),E>0&&(H.colPageCount=""+E),m.push(H),d.GDc(),ma.SNc&&ma.SNc.length>0){for(I=[],J=0;J<ma.SNc.length;J++)if(L=ma.SNc[J],M=L.pivotArea,N=L.style,!oa(N)&&!L.isFakeStyle&&(P=n.getDxfIndex(N),P!==K&&I.push({n_:"format",dxfId:P,c_:[ma.sheetPivotAreaToSJSPivotArea(M,!0)]}),M.references&&1===M.references.length&&L.style&&!D(L.style.formatter)))if(Q=ma.Vyc,M.references[0].fieldName===O().Values){for(R=Q.myc,S=R.length,T={},U=0;U<S;U++)T[R[U].Cj]=U;if(V=M.references[0].items,!V)for(V=[],W=0;W<S;W++)V.push(R[W].Cj);for(W=0;W<V.length;W++)D(T[V[W]])||(R[T[V[W]]].nBJ=L.style.formatter)}else!M.labelOnly||M.dataOnly||M.references[0].items&&0!==M.references[0].items.length||(X=Q.oBJ(M.fieldName),X&&(X.nBJ=L.style.formatter));Y=ma.TNc,Z=ma.NJJ,I.length&&($={n_:"formats",c_:I},$.count=""+I.length,m.push($));for(_ in Y)if(Y.hasOwnProperty(_)){aa=Y[_];for(ba in aa)aa.hasOwnProperty(ba)&&(D(a[_])&&(a[_]={}),D(a[_][ba])&&(a[_][ba]={}),N=la(ma.LBJ[aa[ba]]),ca=Z[_]&&Z[_][ba],ca&&N.Yo(ca),a[_][ba].style&&N.Yo(a[_][ba].style),a[_][ba].s=n.getStyleIndex(N))}}if(d.bdK(ma,e),ma.U5.AW&&ma.U5.AW.length>0){for(da=[],J=0;J<ma.U5.AW.length;J++){for(ea=ma.U5.AW[J],fa=ea.pivotAreas,ga=[],W=0;W<fa.length;W++)ga.push(ma.sheetPivotAreaToSJSPivotArea(fa[W],!1,b.styleManager));ha={n_:"conditionalFormat",c_:[{n_:"pivotAreas",count:""+ga.length,c_:ga}]},na(ea.conditionalRule,ha),da.push(ha)}m.push({n_:"conditionalFormats",count:""+da.length,c_:da})}return ia=ma.qjK(!0),ia&&ia.length>0&&m.push({n_:"rowItems",c_:ia,count:ia.length}),ja=ma.qjK(!1),ja&&ja.length>0&&m.push({n_:"colItems",c_:ja,count:ja.length}),ka=[{n_:"x14:pivotTableDefinition",r_:[2]}],ma.DBJ&&(ka[0].altText=ma.DBJ),ma.EBJ&&(ka[0].altTextSummary=ma.EBJ),e.c_.push({n_:"extLst",c_:[{n_:"ext",r_:[49,1],c_:ka},{n_:"ext",r_:[51,52],c_:[{n_:"xpdl:pivotTableDefinition16"}]}]}),v(e,["location","pivotFields","rowFields","rowItems","colFields","colItems","pageFields","dataFields","formats","conditionalFormats","pivotTableStyleInfo","filters","extLst"]),e},c.prototype.sheetPivotAreaToExcelPivotArea=function(a){var b,c,d,e,f,g,i,j,k,l,m,n,o,p,q,r,s=this,t={},u=s.Vyc;if(t.type=ia(a.type),t.offset=a.offset,b=u.oBJ(a.fieldName))for(t.field=b.mi,c=s.Vyc.oyc[a.fieldName],d=[],0===c?(t.axis="axisPage",d=s.Vyc.lyc):1===c?(t.axis="axisRow",d=s.Vyc.jyc):2===c&&(t.axis="axisCol",d=s.Vyc.kyc),e=0;e<d.length;e++)d[e]&&d[e].Cj===a.fieldName&&(t.fieldPosition=e);if(t.dataOnly=a.dataOnly,t.labelOnly=a.labelOnly,a.labelOnly===!0&&t.dataOnly===K&&(t.dataOnly=!1),a.labelOnly===!0&&t.dataOnly===!0&&(t.dataOnly=!1,t.labelOnly=!1),t.grandRow=a.grandRow,t.grandCol=a.grandCol,D(a.axis)||(t.axis=a.axis===h.PivotAreaAxisType.row?"axisRow":"axisCol"),a.references&&a.references.length>0){for(f=[],g=0;g<a.references.length;g++){if(i={},j=a.references[g],k=void 0,j.fieldName===O().Values){for(i.field=S,l=u.myc,m=l.length,n={},o=0;o<m;o++)n[l[o].Cj]=o;if(j.items&&j.items.length>0){for(p=[],o=0;o<j.items.length;o++)p.push(n[j.items[o]]);i.indexes=p}}else{if(k=u.oBJ(j.fieldName),D(k))continue;if(q=k.LJJ(u),i.field=k.mi,j.items&&j.items.length>0){for(p=[],o=0;o<j.items.length;o++)r=k.KJJ(j.items[o],q),D(r)||p.push(r);i.indexes=p}}i.defaultSubtotal=j.subtotal,f.push(i)}f.length>0&&(t.references=f)}return t},c.prototype.sheetPivotAreaToSJSPivotArea=function(a,b,c){var d,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t,v,w=this,x={n_:"pivotArea"},y=w.Vyc,z=ia(a.type);if(z&&"normal"!==z&&(x.type=z),x.offset=a.offset,d=y.oBJ(a.fieldName))for(d.mi!==-1&&(x.field=""+d.mi),e=w.Vyc.oyc[a.fieldName],f=[],b&&(0===e?(x.axis="axisPage",f=w.Vyc.lyc):1===e?(x.axis="axisRow",f=w.Vyc.jyc):2===e&&(x.axis="axisCol",f=w.Vyc.kyc)),g=0;g<f.length;g++)f[g]&&f[g].Cj===a.fieldName&&(x.fieldPosition=""+g);if(i=a.dataOnly,j=a.labelOnly,j===!0&&i===K&&(i=!1),j===!0&&i===!0&&(i=!1,j=!1),x.dataOnly=u(i,K),j===!0&&(x.labelOnly="1"),a.grandRow===!0&&(x.grandRow="1"),a.grandCol===!0&&(x.grandCol="1"),D(a.axis)||(x.axis=a.axis===h.PivotAreaAxisType.row?"axisRow":"axisCol"),a.references&&a.references.length>0){for(k=[],l=0;l<a.references.length;l++){if(m={n_:"reference"},n=a.references[l],o=void 0,n.fieldName===O().Values){for(m.field=S,p=y.myc,q=p.length,r={},s=0;s<q;s++)r[p[s].Cj]=s;if(n.items&&n.items.length>0)for(m.count=""+n.items.length,m.c_=[],s=0;s<n.items.length;s++)m.c_.push({n_:"x",v:r[n.items[s]]})}else{if(o=y.oBJ(n.fieldName),D(o))continue;if(t=o.LJJ(y),m.field=o.mi,n.items&&n.items.length>0){for(m.c_=[],s=0;s<n.items.length;s++)v=o.KJJ(n.items[s],t),D(v)||m.c_.push({n_:"x",v:v+""});m.count=""+m.c_.length}else m.count="0"}n.subtotal===!0&&(m.defaultSubtotal="1"),k.push(m)}k.length>0&&(x.c_=[{n_:"references",count:k.length+"",c_:k}])}return x},c.prototype.xAc=function(a){var b,c,d,e,f,i,j,k,l,m,n,o,p=this;if(p.iT())return[];if(b=p.ys.szc,c=a?b[3].lzc:b[2].mzc,d=[],e=[],f=p.Vyc,i=p.layoutType()===h.PivotTableLayoutType.tabular,j=p.options.subtotalsPosition===h.SubtotalsPosition.top,a&&0===f.jyc.length||!a&&0===f.kyc.length){for(k=0;k<c.length;k++)l={pivotItemIndexes:[]},l.pivotItemIndexes.push(k),d.push(l);return d}for(k=0;k<c.length;k++)if(l={},m=c[k],!D(m)){for(n=m.path.split(g.Separator),l.pivotItemIndexes=[],o=0;o<n.length;o++)n[o]===e[o]?l.repeatCount=l.repeatCount?l.repeatCount+1:1:l.pivotItemIndexes.push(+n[o]);e=n,0===m.grandTotalLevel?l.type="grand":a&&m.isBlankRow?(l.type="blank",delete l.repeatCount):!m.isSubtotal||0===m.collapseIndex||j&&!i||(l.type="default"),m.valueFieldName&&(l.dataFieldIndex=f.Uyc(m.valueFieldName)),d.push(l)}return d},c.prototype.qjK=function(a){var b,c,d,e,f,i,j,k,l,m,n,o,p,q,r,s=this;if(!s.iT()){if(b=s.ys.szc,c=a?b[3].lzc:b[2].mzc,d=[],e=s.Vyc,f=s.layoutType()===h.PivotTableLayoutType.tabular,i=s.options.subtotalsPosition===h.SubtotalsPosition.top,j=[],a&&0===e.jyc.length||!a&&0===e.kyc.length){for(k=0;k<c.length;k++)l={n_:"x"},0===k&&(l.v=k),j.push({n_:"i",c_:[l]});return j}for(k=0;k<c.length;k++)if(m={n_:"i"},n=c[k],!D(n)){for(o=n.path.split(g.Separator),m.c_=[],p=void 0,q=0;q<o.length;q++)o[q]===d[q]?p=p?p+1:1:+o[q]>0&&m.c_.push({n_:"x",v:o[q]});d=o,m.r=p>0?p:K,0===n.grandTotalLevel?m.t="grand":a&&n.isBlankRow?(m.t="blank",delete m.r):!n.isSubtotal||0===n.collapseIndex||i&&!f||(m.t="default"),n.valueFieldName&&(r=e.Uyc(n.valueFieldName),r>0&&(m.i=""+r)),j.push(m)}return j}},c.prototype.HUJ=function(){var a={},b=this.Vyc.Dyc();return g.Yxc(b,function(b,c){var d=b.Cj;a[d]=c}),a},c.prototype.evaluateGetPivotDataFunction=function(a,b){var c,d,e,h,i,j,k,l,m,n,o,p,r,s,t,u,v,w,x,y,z,A,B,C,E,F,G,H=this,I=[],J=H.qMc,L=H.HUJ(),M=H.Vyc,N=M.getSigmaValuePosition().positionType,O=M.jyc.length,P=M.myc.length;for(c=0;c<b.length;c++){if(d=b[c],e=d.fieldName,h=d.itemName,i=L[e],D(i))return q.Errors.Reference;if(j=void 0,!J[e])return q.Errors.Reference;if(k=M.HLc(e),h instanceof Date&&(h=f.formatDateToString(h)),2===k.ny&&k.HSJ()&&"number"==typeof h?(l=k.dCc,j=l===g.DateGroupType.years?k.aGc&&k.aGc[h]:h):j=J[e].indexOf(h),j<0)return q.Errors.Reference;I[i]=j}for(m=I.slice(0,O),c=m.length-1;c>=0&&m[c]===K;c--)m.pop();for(n=m.join(g.Separator),o=I.slice(O),c=o.length-1;c>=0&&o[c]===K;c--)o.pop();for(p=o.join(g.Separator),r={},s={},t=H.ys.szc[3].lzc,u=H.ys.szc[2].mzc,v=H.ys.szc[4].dataTable,c=0;c<t.length;c++)w=t[c],x=w.path,y=w.valueFieldName,0===N&&P>1?(D(r[x])&&(r[x]={}),r[x][y]=c):r[x]=c;for(c=0;c<u.length;c++)z=u[c],x=z.path,A=z.valueFieldName,1===N&&P>1?(D(s[x])&&(s[x]={}),s[x][A]=c):s[x]=c;if(M.myc.length>0&&(B=M.ADc(a),C=M.getFieldInfoByName(a),a=B&&B.Cj||C&&C.Cj),D(a))return q.Errors.Reference;if(E=r[n]instanceof Object?r[n][a]:r[n],F=s[p]instanceof Object?s[p][a]:s[p],D(E)||D(F))return q.Errors.Reference;try{G=v[E][F],H.options.showMissing&&D(G)&&(G={value:H.options.missingCaption})}catch(a){return q.Errors.Reference}return G&&G.value},c.prototype.UNc=function(){var a,b,c=this,d=c.SNc.concat([]);for(c.TNc={},c.NJJ=[],c.SNc=[],c.LBJ={},a=0,b=d.length;a<b;a++)c.XNc(d[a].pivotArea,d[a].style,K,d[a].isFakeStyle)},c.prototype.getAllFields=function(a){return this.Vyc.getAllFieldNameListWithoutCalcField(a)},c.prototype.YIJ=function(){var a=this,b=a.getFieldsByArea();g.Yxc(b,function(b){var c,d=b.fieldName,e=a.Vyc.getFilterInfo(d);a.Vyc.isFilter(b.sourceName)&&(c=0,e.labelFilter.condition&&(c+=1),e.labelFilter.textItem&&(c+=1),e.valueFilter&&(c+=1),c>1&&a.Vyc.clearFilterInfo(b.sourceName,0))})},c.prototype.dispose=function(){a.prototype.dispose.call(this);var b=this;b.qo=L,b.ys=L,b.SNc=L,b.NJJ=L,b.TNc=L,b.LBJ=L,b.options=L,b.rAc=L,b.sAc=L,b.uNb=L,b.vNb=L,b.qMc=L,b.MLc=L,b.QLc=L,b.Zaa=L,b.kBJ=L,D(b.U5)||(b.U5.no(),b.U5=L),D(b.views)||(b.views.no(),b.views=L)},c}(i.PivotView),b.PivotTable=V;function wa(a,b,c){var d=!1;return b&&(d=a.intersect(b.row,b.col,b.rowCount,b.colCount)),d||a.intersect(c.row,c.col,c.rowCount,c.colCount)}function xa(a,b){return b.font&&(a.font&&b.font.compose(a.font),a.font=b.font),b.border&&(a.border&&b.border.compose(a.border),a.border=b.border),b.fill&&(a.fill&&b.fill.compose(a.fill),a.fill=b.fill),b.numberFormat&&(a.numberFormat&&b.numberFormat.compose(a.numberFormat),a.numberFormat=b.numberFormat),a}function ya(a){if(a){var b={};return a.font&&(b.font=a.font.clone()),a.border&&(b.border=a.border.clone()),a.fill&&(b.fill=a.fill.clone()),a.numberFormat&&(b.numberFormat=a.numberFormat.clone()),b}}},"./dist/plugins/pivot/pivot-ui/dropdown-list.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("./dist/plugins/pivot/pivot.ns.js"),f=c("Core"),g=c("Pivot"),h=new d.Common.ResourceManager(e.SR,"PivotTables"),i=h.getResource.bind(h),j="gc-drop-down-list",k=j+"-link-hover",l=j+"-item-noHover",m=j+"-block",n=j+"-item",o=j+"-icon",p=j+"-link",q=n+" "+l,r=j+"-span",s=n+" "+k,t="icon-Move-Report",u="icon-Move-Row",v="icon-Move-Col",w="icon-Move-Value",x="icon-Move-Remove",y="icon-Move-Setting",z="icon-Be-Used",A="clear-filter-icon-default",B="clear-filter-icon",C="label-of-string",D="valueFilter",E="label-of-number",F="label-of-date",G="sub-label-of-date",H="all-date",I=null,J=void 0,K={dropDownListOfField:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_Up,command:"moveUp",class:s,iconClass:o,linkClass:p},{text:i().PivotPanel_DropDownList_Down,command:"moveDown",class:s,iconClass:o,linkClass:p},{text:i().PivotPanel_DropDownList_Beginning,command:"moveBeginning",class:s,iconClass:o,linkClass:p},{text:i().PivotPanel_DropDownList_End,command:"moveEnd",class:s,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_ReportFilter,command:"moveReportFilter",class:s,iconClass:o+" "+t,linkClass:p},{text:i().PivotPanel_DropDownList_Row,command:"moveRow",class:s,iconClass:o+" "+u,linkClass:p},{text:i().PivotPanel_DropDownList_Col,command:"moveCol",class:s,iconClass:o+" "+v,linkClass:p},{text:i().PivotPanel_DropDownList_Values,command:"moveValue",class:s,iconClass:o+" "+w,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_Remove,command:"removeField",class:s,iconClass:o+" "+x,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_DropDownList_Set,command:"fieldSet",class:s,iconClass:o+" "+y,linkClass:p}]}]},pivotCacheFieldsData:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_Fields_MoveTo_ReportField,command:"AddToReportField",class:s,iconClass:o+" "+t,linkClass:p},{text:i().PivotPanel_Fields_MoveTo_RowLabel,command:"AddToRowLabel",class:s,iconClass:o+" "+u,linkClass:p},{text:i().PivotPanel_Fields_MoveTo_ColLabel,command:"AddToColLabel",class:s,iconClass:o+" "+v,linkClass:p},{text:i().PivotPanel_Fields_MoveTo_Value,command:"AddToValue",class:s,iconClass:o+" "+w,linkClass:p}]}]},dataOfString:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+C,iconClass:A+" "+o,
linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotCaptionFilterOperator.equalsTo,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEqual,command:g.PivotCaptionFilterOperator.notEqualsTo,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:g.PivotCaptionFilterOperator.beginsWith,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBegin,command:g.PivotCaptionFilterOperator.doesNotBeginWith,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_End,command:g.PivotCaptionFilterOperator.endsWith,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEndWith,command:g.PivotCaptionFilterOperator.doesNotEndWith,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Contain,command:g.PivotCaptionFilterOperator.contains,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotContain,command:g.PivotCaptionFilterOperator.doesNotContain,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_GreaterThan,command:g.PivotCaptionFilterOperator.greaterThan,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:g.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessThan,command:g.PivotCaptionFilterOperator.lessThan,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessOrTo,command:g.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:s+" "+C,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotCaptionFilterOperator.between,class:s+" "+C,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBetween,command:g.PivotCaptionFilterOperator.notBetween,class:s+" "+C,iconClass:o,linkClass:p}]}]},dataOfDate:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+F,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotDateFilterOperator.equalsTo,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Before,command:g.PivotDateFilterOperator.before,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_After,command:g.PivotDateFilterOperator.after,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotDateFilterOperator.Between,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Tomorrow,command:g.PivotDateFilterOperator.tomorrow,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_Today,command:g.PivotDateFilterOperator.today,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_Yesterday,command:g.PivotDateFilterOperator.yesterday,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextWeek,command:g.PivotDateFilterOperator.nextWeek,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisWeek,command:g.PivotDateFilterOperator.thisWeek,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastWeek,command:g.PivotDateFilterOperator.lastWeek,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextMonth,command:g.PivotDateFilterOperator.nextMonth,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisMonth,command:g.PivotDateFilterOperator.thisMonth,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastMonth,command:g.PivotDateFilterOperator.lastMonth,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextQuarter,command:g.PivotDateFilterOperator.nextQuarter,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisQuarter,command:g.PivotDateFilterOperator.thisQuarter,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastQuarter,command:g.PivotDateFilterOperator.lastQuarter,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_NextYear,command:g.PivotDateFilterOperator.nextYear,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ThisYear,command:g.PivotDateFilterOperator.thisYear,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LastYear,command:g.PivotDateFilterOperator.lastYear,class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_YearToDate,command:g.PivotDateFilterOperator.yearToDate,class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_QuarterToDate,command:g.PivotDateFilterOperator.dateToDate+"-1",class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_MonthToDate,command:g.PivotDateFilterOperator.dateToDate+"-2",class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ParallelYearToDate,command:g.PivotDateFilterOperator.dateToDate+"-3",class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate,command:g.PivotDateFilterOperator.dateToDate+"-4",class:s+" "+F,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_ParallelMonthToDate,command:g.PivotDateFilterOperator.dateToDate+"-5",class:s+" "+F,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_AllDates,command:"all Dates",class:s+" "+H,iconClass:o,linkClass:p}]}]},dataOfNumber:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+E,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotCaptionFilterOperator.equalsTo,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEqual,command:g.PivotCaptionFilterOperator.notEqualsTo,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:g.PivotCaptionFilterOperator.beginsWith,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBegin,command:g.PivotCaptionFilterOperator.doesNotBeginWith,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_End,command:g.PivotCaptionFilterOperator.endsWith,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEndWith,command:g.PivotCaptionFilterOperator.doesNotEndWith,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Contain,command:g.PivotCaptionFilterOperator.contains,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotContain,command:g.PivotCaptionFilterOperator.doesNotContain,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_GreaterThan,command:g.PivotCaptionFilterOperator.greaterThan,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:g.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessThan,command:g.PivotCaptionFilterOperator.lessThan,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessOrTo,command:g.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:s+" "+E,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotCaptionFilterOperator.between,class:s+" "+E,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBetween,command:g.PivotCaptionFilterOperator.notBetween,class:s+" "+E,iconClass:o,linkClass:p}]}]},dataOfValueFilter:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:s+" "+D,iconClass:A+" "+o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Equals,command:g.PivotValueFilterOperator.equalsTo,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotEqual,command:g.PivotValueFilterOperator.notEqualsTo,class:s+" "+D,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_GreaterThan,command:g.PivotValueFilterOperator.greaterThan,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:g.PivotValueFilterOperator.greaterThanOrEqualsTo,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessThan,command:g.PivotValueFilterOperator.lessThan,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_LessOrTo,command:g.PivotValueFilterOperator.lessThanOrEqualsTo,class:s+" "+D,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilterOrLabel_Between,command:g.PivotValueFilterOperator.between,class:s+" "+D,iconClass:o,linkClass:p},{text:i().PivotPanel_ValueFilterOrLabel_NotBetween,command:g.PivotValueFilterOperator.notBetween,class:s+" "+D,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().PivotPanel_ValueFilter_Top10,command:"Top10",class:s+" "+D,iconClass:o,linkClass:p}]}]},dataOfDateSecondary:function(){return[{disAble:!1,className:m,ListSpan:r,child:[{text:i().Q1,command:g.PivotDateFilterOperator.Q1,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Q2,command:g.PivotDateFilterOperator.Q2,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Q3,command:g.PivotDateFilterOperator.Q3,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Q4,command:g.PivotDateFilterOperator.Q4,class:s+" "+G,iconClass:o,linkClass:p}]},{disAble:!1,className:m,ListSpan:r,child:[{text:i().Jan,command:g.PivotDateFilterOperator.M1,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Feb,command:g.PivotDateFilterOperator.M2,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Mar,command:g.PivotDateFilterOperator.M3,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Apr,command:g.PivotDateFilterOperator.M4,class:s+" "+G,iconClass:o,linkClass:p},{text:i().May,command:g.PivotDateFilterOperator.M5,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Jun,command:g.PivotDateFilterOperator.M6,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Jul,command:g.PivotDateFilterOperator.M7,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Aug,command:g.PivotDateFilterOperator.M8,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Sep,command:g.PivotDateFilterOperator.M9,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Oct,command:g.PivotDateFilterOperator.M10,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Nov,command:g.PivotDateFilterOperator.M11,class:s+" "+G,iconClass:o,linkClass:p},{text:i().Dec,command:g.PivotDateFilterOperator.M12,class:s+" "+G,iconClass:o,linkClass:p}]}]}},function(a){a[a.teamLeader=1]="teamLeader",a[a.teamMiddle=2]="teamMiddle",a[a.teamTail=3]="teamTail"}(L||(L={})),function(a){a[a.filters=0]="filters",a[a.rows=1]="rows",a[a.columns=2]="columns",a[a.values=3]="values"}(M||(M={})),function(a){a[a.string=1]="string",a[a.number=2]="number",a[a.date=3]="date"}(N||(N={})),O=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,0)||this;return i.Vyc=c,i.yzc=d,i.xzc=e,i.yAc=f,i.zAc=g,i.GZ=h,i}return b.prototype.OT=function(a,b){var c,d=this;d.SH=a,d.i6=b,c=d.Sla(a.x,a.y),c.html(this.AAc(this.OY(b))),this.Ao()},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.eEc(),this.QQ(),this.M1J()&&this.Eo()},b.prototype.M1J=function(){return!1},b.prototype.Sla=function(a,b){var c=this.yo();return c.css(["left","top","height"],[a,b,this.BAc]),c.addClass(j+" gc-no-user-select"),c},b.prototype.eEc=function(){var a,b,c,d,e,g,h,i,j,k,l,m,n=this,o=n.xo,p=f.GC$(n.qo);p.hasClass("filter-condition")&&(a=f.GC$(n.GZ.zo()).offset(),b=f.GC$(n.GZ.xo),c=p.position(),d=b.position(),e=f.GC$(o).width(),g=f.GC$(o).height(),h=document.documentElement,i=h.clientWidth,j=h.clientHeight,k=p.width(),l=c.top,a.left+k+d.left+e>=i?n.SH.x=-e:n.SH.x=k,a.top+l+d.top+g>=j?(n.SH.y=b.height()-g,Math.abs(b.height()-g)>d.top&&(m=n.yo(),m.css(["height","overflow-y","overflow-x"],[b.height()+"px","scroll","hidden"]),n.SH.y=0)):n.SH.y=l,n.Sla(n.SH.x,n.SH.y))},b.prototype.close=function(){this.Tla(),this.hyc(),a.prototype.close.call(this)},b.prototype.hyc=function(){this.yzc=J,this.xzc=J,this.yAc=J,this.zAc=J,this.GZ=I,this.qo=I,this.Vyc=I},b}(f.Go),P=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.xBJ=h,i.BAc="244px",i}return b.prototype.AAc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.OY=function(a){return this.xf=f.GC$.extend(!0,[],K.dropDownListOfField()),this.initSeatData(a,this.xf[0].child),this.initAreaData(a,this.xf[1].child),this.initSettingData(a,this.xf[3].child),this.xf},b.prototype.QQ=function(){var a=this;f.GC$("."+n).bind("click",function(b){f.GC$(this).hasClass(l)||(a.Eo(),a.sendCommand(this),a.close())})},b.prototype.Tla=function(){f.GC$("."+n).unbind("click")},b.prototype.sendCommand=function(a){var b=this,c=b.yAc,d=b.zAc,e=b.Vyc,g=f.GC$(a).attr("command");switch(g){case"moveUp":g="moveField",d--;break;case"moveDown":g="moveField",d++;break;case"moveBeginning":g="moveField",d=0;break;case"moveEnd":g="moveField",d=Z(c,e)+1;break;case"moveReportFilter":g="moveField",c=0,d=Z(c,e);break;case"moveRow":g="moveField",c=1,d=Z(c,e);break;case"moveCol":g="moveField",c=2,d=Z(c,e);break;case"moveValue":g="moveField",c=3,d=Z(c,e);break;case"removeField":break;case"fieldSet":}b.Vyc.Oyc({cmd:g,sheetName:"",cmdOption:{fieldName:b.xzc,targetArea:c,targetIndex:d,pivotName:b.yzc,isSusPaint:b.xBJ}})},b.prototype.initSeatData=function(a,b){if(a.isAlone)for(var c=0;c<b.length;c++)b[c].class=q;else{if(a.location===L.teamMiddle)return;a.location===L.teamLeader?(b[0].class=q,b[2].class=q):(b[1].class=q,b[3].class=q)}},b.prototype.initAreaData=function(a,b){switch(a.area){case 0:b[0].class=q;break;case 1:b[1].class=q;break;case 2:b[2].class=q;break;case 3:b[3].class=q}a.isSigma&&(b[0].class=q,b[3].class=q)},b.prototype.initSettingData=function(a,b){3===a.area&&(b[0].text=i().PivotPanel_DropDownList_ValueSet,b[0].command="openValueFieldSettingDialogCmd",b[0].class=s),a.isSigma&&(b[0].class=q)},b}(O),b.PivotDropDown=P,Q=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.BAc="95px",i.xBJ=h,i}return b.prototype.AAc=function(a){return X(a[0])},b.prototype.OY=function(){return this.xf=f.GC$.extend(!0,[],K.pivotCacheFieldsData()),this.xf},b.prototype.QQ=function(){var a=this;f.GC$("."+k).bind("click",function(b){a.sendCommand(this),a.close()})},b.prototype.Tla=function(){f.GC$("."+k).unbind("click")},b.prototype.sendCommand=function(a){var b=this,c=b.yAc||-1,d=f.GC$(a).attr("command");switch(d){case"AddToReportField":c=0;break;case"AddToRowLabel":c=1;break;case"AddToColLabel":c=2;break;case"AddToValue":c=3}b.Vyc.Oyc({cmd:"AddField",sheetName:"",cmdOption:{fieldName:b.xzc,targetArea:c,pivotName:b.yzc,isSusPaint:b.xBJ}})},b}(O),b.PivotCacheFieldsDropdownDialog=Q,R=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.AAc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.M1J=function(){return!0},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],K.dataOfValueFilter()),a.existed&&0!==a.existed.length?this.xf[0].child[0].iconClass=B+" "+o:this.xf[0].child[0].class=q,b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c],d=1;d<this.xf.length;d++){if(!(b>=this.xf[d].child.length)){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+D).bind("click",function(b){var c,d=a.Vyc,e=a.xzc,g=this,h=a.yzc,j=f.GC$(this).attr("command");return"ClearFilter"===j?(d.Oyc({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:h,command:j,clearType:2}}),a.GZ.close(),void a.close()):isNaN(+j)&&"Top10"!==j?(a.GZ.close(),void a.close()):(c=i().getValueFilterItemText(),a.GZ.close(),a.close(),void d.Oyc({cmd:"createDialogForValueFilter",sheetName:"",cmdOption:{fieldName:e,pivotName:h,host:g,content:c,command:j}}))})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+D).unbind("click")},b.prototype.sendCommand=function(){},b}(O),b.PivotValuesDialog=R,S=function(a){W(b,a);function b(b,c,d,e,f,g,h){return a.call(this,b,c,d,e,f,g,h)||this}return b.prototype.AAc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.M1J=function(){return!0},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],K.dataOfString()),a.existed&&0!==a.existed.length?this.xf[0].child[0].iconClass=B+" "+o:this.xf[0].child[0].class=q,b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c],d=1;d<this.xf.length;d++){if(!(b>=this.xf[d].child.length)){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$("."+C).bind("click",function(b){$(this,a)}),f.GC$(a.qo).bind("mouseleave",function(b){a.close()})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+C).unbind("click")},b.prototype.sendCommand=function(){},b}(O),b.PivotStringFilterDialog=S,T=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.AAc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.M1J=function(){return!0},b.prototype.OY=function(a){var b,c,d,e,h,i,j;for(this.xf=f.GC$.extend(!0,[],K.dataOfDate()),b=a.existed,c=this.xf,b&&0!==b.length?this.xf[0].child[0].iconClass=B+" "+o:c[0].child[0].class=q,h=1;h<c.length;h++)for(e=c[h].child,i=0;i<e.length;i++)for(d=+e[i].command,j=0;j<b.length;j++)if(b[j]>g.PivotDateFilterOperator.Q1&&b[j]<=g.PivotDateFilterOperator.M12&&(c[9].child[0].iconClass=o+" "+z),b[j]===d){c[h].child[i].iconClass+=" "+z,b.splice(j,1);break}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+F).bind("click",function(b){var c=i().getDateLabelFilterItemText(),d=a.Vyc,e=a.xzc,g=document.body,h=a.yzc,j=f.GC$(this).attr("command");return"ClearFilter"===j?(d.Oyc({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:h,clearType:1}}),a.GZ.close(),void a.close()):(a.GZ.close(),a.close(),void d.Oyc({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:e,pivotName:h,host:g,command:j,dateLabel:c,isWholeDay:!1}}))}),f.GC$("."+H).bind("mouseenter",function(b){var c,d,e,g=this,h=a.Vyc,i=a.yzc,j=a.xzc,k=a.i6,l=[];k.existed.forEach(function(a){a>=24&&a<=39&&l.push(a)}),c=new U(g,h,i,j,I,I,a),d=g.getBoundingClientRect(),e={x:0,y:0},c.OT(e,{existed:l,dataType:2}),c.xo.css(["position","left","top"],["fixed",d.right+"px",d.bottom-f.GC$(c.xo).height()+"px"])})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+F).unbind("click"),f.GC$("."+H).unbind("mouseenter")},b.prototype.sendCommand=function(){},b}(O),b.PivotDateFilterDialog=T,U=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.AAc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.M1J=function(){return!0},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],K.dataOfDateSecondary()),b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c]-24,d=0;d<this.xf.length;d++){if(this.xf[d].child[b]){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+G).bind("click",function(b){var c=a.Vyc,d=a.xzc,e=this,g=a.yzc,h=f.GC$(this).attr("command"),i=a.GZ;i.GZ.close(),i.close(),a.close(),c.Oyc({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:d,pivotName:g,host:e,command:h,isWholeDay:!1}})})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+G).unbind("click")},b.prototype.sendCommand=function(){},b}(O),b.PivotDateSecondaryFilterDialog=U,V=function(a){W(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this,b,c,d,e,f,g)||this;return i.GZ=h,i}return b.prototype.AAc=function(a){var b,c="";for(b=0;b<a.length;b++)c+=X(a[b]);return c},b.prototype.M1J=function(){return!0},b.prototype.OY=function(a){var b,c,d;for(this.xf=f.GC$.extend(!0,[],K.dataOfNumber()),a.existed&&0!==a.existed.length?this.xf[0].child[0].iconClass=B+" "+o:this.xf[0].child[0].class=q,b=0,c=0;c<a.existed.length;c++)for(b=a.existed[c],d=1;d<this.xf.length;d++){if(!(b>=this.xf[d].child.length)){this.xf[d].child[b].iconClass+=" "+z;break}b-=this.xf[d].child.length}return this.xf},b.prototype.QQ=function(){var a=this;f.GC$(a.qo).bind("mouseleave",function(b){a.close()}),f.GC$("."+E).bind("click",function(b){$(this,a)})},b.prototype.Tla=function(){f.GC$(this.qo).unbind("mouseleave"),f.GC$("."+E).unbind("click")},b.prototype.sendCommand=function(){},b}(O),b.PivotNumberFilter=V;function X(a){var b,c="";for(b=0;b<a.child.length;b++)c+=Y(a.child[b]);return'<div class="'+a.className+'" height="21px">\n            '+c+'\n            <span class="'+a.ListSpan+'"></span>\n            </div>'}function Y(a){return'<div class="'+a.class+'" command="'+a.command+'">\n                <div class="'+a.iconClass+'"></div>\n                <div class="'+a.linkClass+'">'+a.text+"</div>\n            </div>"}function Z(a,b){var c,d,e=0;switch(a){case 0:e=b.lyc.length;break;case 1:e=b.jyc.length;break;case 2:e=b.kyc.length;break;case 3:e=b.myc.length;break;default:return 0}return c=0,d=b.getSigmaValuePosition(),d.display&&d.positionType===a-1&&c++,e+c}function $(a,b){var c=b.Vyc,d=b.xzc,e=b,g=b.yzc,h=f.GC$(a).attr("command");return"ClearFilter"===h?(c.Oyc({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:d,pivotName:g,command:h,clearType:1}}),b.GZ.close(),void b.close()):isNaN(+h)?(b.GZ.close(),void b.close()):(b.GZ.close(),b.close(),void c.Oyc({cmd:"createDialogForLabelFilter",sheetName:"",cmdOption:{fieldName:d,pivotName:g,host:e,command:h}}))}},"./dist/plugins/pivot/pivot-ui/filter-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("./dist/plugins/pivot/pivot.ns.js"),f=c("Core"),g=c("Pivot"),h=new d.Common.ResourceManager(e.SR,"PivotTables"),i=d.Common.u.Ob,j=h.getResource.bind(h),k=d.Formatter.GeneralFormatter,l="filter-dialog-container",m="label-title-class",n="label-filter-body",o="label-title",p="cancel-icon",q="cancel-class",r="label-show",s="split-line",t="prompt-info",u="ok-label",v="filter-confirm",w="label-select",x="label-input",y="confirm-class",z="label_input",A="input-between-container",B="input-between",C="and-joiner",D="top-ten-content",E="filter-value-dialog-container",F="value-title-class",G="split-line-class",H="value-filter-body",I="value-select",J="field-value",K="value-filter",L="filter-top-ten-container",M="top-ten-filter-body",N="split-line-of-top-ten",O="value-of-top-ten",P="top-ten-select",Q="top-ten-title-class",R="close-dialog",S="by-joiner-class",T="top-ten",U="filter-date-dialog-container",V="date-title-class",W="date-filter-body",X="date-split-line",Y="date-select",Z="is-whole-days",$=null,_=void 0,aa=function(a){da(b,a);function b(b,c,d,e,f,g){var h=a.call(this,b,2e3,!0)||this;return h.CAc=c,h.Vyc=d,h.xzc=e,h.yzc=f,h.XIc=g,h.Eo(),h.Ao(),h}return b.prototype.Ao=function(){var b=this;b.xo.html(b.EAc()),a.prototype.Ao.call(this),b.BPa(),b.QQ(),b.YIc()},b.prototype.WT=function(){this.Tla(),this.hyc(),a.prototype.close.call(this)},b.prototype.hyc=function(){this.CAc=$,this.xzc=_,this.yzc=_,this.XIc=_,this.qo=$,this.Vyc=$},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.EAc=function(){var a,b,c,d="",e=this.CAc,f=this.XIc;for(b=0;b<e.length;b++)d+=this.Ql(e[b],b);return a=ea(f>=g.PivotCaptionFilterOperator.between?!0:!1),c=i(this.xzc),'<div class="'+l+'">\n                    <div class="'+m+'">\n                        <span class="'+o+'">'+(j().Label_Title+"("+c+")")+'</span>\n                        <span class="'+(q+" "+p)+'">\xd7</span>\n                    </div>\n                    <div class="'+n+'">\n                        <div class="'+y+'">\n                            <span class="'+r+'">'+j().Label_Show+'</span>\n                            <span class="'+s+'"></span>\n                        </div>\n                        <div class="'+y+'">\n                            <select class="'+w+'">'+d+'</select>\n                            <div class="'+A+'">\n                                '+a+'\n                            </div>\n                        </div>\n                        <div class="'+y+'">\n                            <span class="'+t+'">'+j().Use_Single_Character+'</span>\n                            <span class="'+t+'">'+j().Use_Series_Characters+'</span>\n                        </div>\n                        <div>\n                            <span class="'+(q+" "+v)+'">'+j().Cancel+'</span>\n                            <span class="'+(u+" "+v)+'">'+j().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.Ql=function(a,b){var c="";return b===this.XIc&&(c="selected"),'<option command="'+b+'" '+c+">"+a+"</option>"},b.prototype.QQ=function(){var a=this;f.GC$("."+q).bind("click",function(b){a.WT()}),f.GC$("."+u).bind("click",function(b){var c,d,e,g,h,i,j=f.GC$("."+x)[0],k=$,l=f.GC$("."+B);l.length>0&&(j=l[0],k=l[1]),c=j?j.value:$,d=k?k.value:$,e=a.XIc,g=a.Vyc,h=a.xzc,i=a.yzc,g.Oyc({cmd:"updateCondition",sheetName:"",cmdOption:{fieldsModel:g,fieldName:h,pivotName:i,selectValue:e,inputValue:c,inputValueEnd:d}}),a.WT()}),f.GC$("."+w).bind("change",function(b){var c=f.GC$(this.options[this.selectedIndex]).attr("command");a.ZIc(c)})},b.prototype.Tla=function(){f.GC$("."+q).unbind("click"),f.GC$("."+u).unbind("click"),f.GC$("."+w).unbind("change")},b.prototype.ZIc=function(a){var b=this,c=+a,d;(c>=g.PivotCaptionFilterOperator.between&&b.XIc<g.PivotCaptionFilterOperator.between||c<g.PivotCaptionFilterOperator.between&&b.XIc>=g.PivotCaptionFilterOperator.between)&&(d=ea(c>=g.PivotCaptionFilterOperator.between?!0:!1),f.GC$("."+A).html(d)),b.XIc=c},b.prototype.YIc=function(){var a,b,c,d,e,g,h,i,j=this,k=j.Vyc,l=j.xzc,m=j.XIc,n=k.getFilterInfo(k.getSourceNameByFieldName(l));n&&n.labelFilter&&n.labelFilter.condition&&(a=n.labelFilter.condition.toJSON(),b=a.val,c=a.operator,d=b[0],e=b[1],c===m&&(g=f.GC$("."+z),h=g[0],i=g[1],h.value=d,i&&(i.value=e)))},b}(f.Go),b.LabelFilter=aa,ba=function(a){da(b,a);function b(b,c,d,e,f,g,h,i){var j=a.call(this,b,2e3,!0)||this;return j.$Ic=c,j.Vyc=e,j.xzc=f,j.yzc=g,j.FAc=d,j.XIc=h,j.kHJ=i,j.Eo(),j.Ao(),j}return b.prototype.Ao=function(){var b=this;b.xo.html(this.EAc()),a.prototype.Ao.call(this),b.BPa(),b.QQ(),b._Ic()},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.WT=function(){this.Tla(),this.hyc(),a.prototype.close.call(this)},b.prototype.hyc=function(){this.$Ic=$,this.xzc=_,this.yzc=_,this.XIc=_,this.qo=$,this.Vyc=$},b.prototype._Ic=function(){var a=this;a.kHJ?a.aJc():a.YIc()},b.prototype.EAc=function(){return this.kHJ?this.GAc():this.HAc()},b.prototype.GAc=function(){var a,b,c="",d=this.FAc;for(a=0;a<d.length;a++)c+=this.Ql(d[a],a);return b=i(this.xzc),'<div class="'+L+'">\n                    <div class="'+Q+'">\n                        <span class="'+o+'">'+(j().Top_Ten_Filter+"("+b+")")+'</span>\n                        <span class="'+(q+" "+p)+'">\xd7</span>\n                    </div>\n                    <div class="'+M+'">\n                        <div class="'+y+'">\n                            <span class="'+r+'">'+j().TopTenShow+'</span>\n                            <span class="'+N+'"></span>\n                        </div>\n                        <div class="'+(y+" "+D)+'">\n                            <select class="'+P+'">\n                                <option>'+j().Top+"</option>\n                                <option>"+j().Bottom+'</option>\n                            </select>\n                            <input class="'+O+'" type="number" value=10 min=1></input>\n                            <select class="'+P+'">\n                                <option>'+j().Top_Item+"</option>\n                                <option>"+j().Top_Percent+"</option>\n                                <option>"+j().Top_Sum+'</option>\n                            </select>\n                            <div class="'+S+'">'+j().ByJoiner+'</div>\n                            <select class="'+P+'">'+c+'</select>\n                        </div>\n                        <div class="'+R+'">\n                            <span class="'+(q+" "+v)+'">'+j().Cancel+'</span>\n                            <span class="'+(u+" "+v+" "+T)+'">'+j().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.HAc=function(){var a,b,c,d,e,f="",h=this.$Ic,k=this.XIc;for(b=0;b<h.length;b++)f+=this.Ql(h[b],b);for(c="",d=this.FAc,b=0;b<d.length;b++)c+=this.Ql(d[b],b);return a=k===g.PivotValueFilterOperator.between||k===g.PivotValueFilterOperator.notBetween?ea(!0,!0):ea(!1,!0),e=i(this.xzc),'<div class="'+E+'">\n                    <div class="'+F+'">\n                        <span class="'+o+'">'+(j().Value_Title+"("+e+")")+'</span>\n                        <span class="'+(q+" "+p)+'">\xd7</span>\n                    </div>\n                    <div class="'+H+'">\n                        <div class="'+y+'">\n                            <span class="'+r+'">'+j().Value_Show+'</span>\n                            <span class="'+G+'"></span>\n                        </div>\n                        <div class="'+y+'">\n                            <select class="'+I+'">'+c+'</select>\n                            <select class="'+(I+" "+J)+'">'+f+'</select>\n                            <div class="'+A+'">\n                                '+a+'\n                            </div>\n                        </div>\n                        <div>\n                            <span class="'+(q+" "+v)+'">'+j().Cancel+'</span>\n                            <span class="'+(u+" "+v)+'">'+j().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.Ql=function(a,b){var c="";
return b===this.XIc&&(c="selected"),'<option command="'+b+'" '+c+">"+a+"</option>"},b.prototype.QQ=function(){var a=this;f.GC$("."+q).bind("click",function(b){a.WT()}),f.GC$("."+u).bind("click",function(b){f.GC$(this).hasClass(T)?a.IAc():a.JAc(),a.WT()}),f.GC$("."+J).bind("change",function(b){var c=f.GC$(this.options[this.selectedIndex]).attr("command");a.ZIc(c)})},b.prototype.aJc=function(){var a,b,c,d,e,h=this,i=h.FAc,j=h.Vyc,k=h.xzc,l=j.getFilterInfo(j.getSourceNameByFieldName(k));l&&l.valueFilter&&l.valueFilter.conditionByName&&(a=l.valueFilter.condition,a.getConditionType()===g.PivotConditionType.top10&&(b=a.toJSON(),c=b.val,d=b.type,e=b.operator,f.GC$("."+P)[2].selectedIndex=i.indexOf(l.valueFilter.conditionByName),f.GC$("."+P)[0].selectedIndex=e>0?0:1,f.GC$("."+P)[1].selectedIndex=d,f.GC$("."+O).attr("value",c)))},b.prototype.ZIc=function(a){var b=this,c=+a,d;(c>=g.PivotValueFilterOperator.between&&b.XIc<g.PivotValueFilterOperator.between||c<g.PivotValueFilterOperator.between&&b.XIc>=g.PivotValueFilterOperator.between)&&(d=c>=g.PivotValueFilterOperator.between?ea(!0,!0):ea(!1,!0),f.GC$("."+A).html(d)),b.XIc=c},b.prototype.YIc=function(){var a,b,c,d,e,g,h,i,j=this,k=j.Vyc,l=j.xzc,m=j.XIc,n=k.getFilterInfo(k.getSourceNameByFieldName(l));n&&n.valueFilter&&n.valueFilter.condition&&(a=n.valueFilter.condition.toJSON(),b=a.val,c=a.operator,d=b[0],e=b[1],c===m&&(g=f.GC$("."+z),h=g[0],i=g[1],h.value=d,i&&(i.value=e)))},b.prototype.Tla=function(){f.GC$("."+q).unbind("click"),f.GC$("."+u).unbind("click"),f.GC$("."+J).unbind("change")},b.prototype.JAc=function(){var a,b,c,d,e,g,h,i=this,j=f.GC$("."+I),k=j[0],l=j[1],m=f.GC$("."+x)[0],n=$,o=f.GC$("."+B);o.length>0&&(m=o[0],n=o[1]),a=f.GC$(k.options[k.selectedIndex]).text(),b=f.GC$(l.options[l.selectedIndex]).attr("command"),c=m?m.value:$,d=n?n.value:$,e=i.Vyc,g=i.xzc,h=i.yzc,e.Oyc({cmd:"updateValueCondition",sheetName:"",cmdOption:{fieldsModel:e,fieldName:g,pivotName:h,valueOfField:a,valueOfFieldValue:b,inputValue:c,inputValueEnd:d}})},b.prototype.IAc=function(){var a=this,b=a.Vyc,c=a.yzc,d=f.GC$("."+P),e=d[0],g=f.GC$("."+O)[0],h=d[1],i=d[2],j=f.GC$(e.options[e.selectedIndex]).text(),k=g.value,l=f.GC$(h.options[h.selectedIndex]).text(),m=f.GC$(i.options[i.selectedIndex]).text();b.Oyc({cmd:"TopTenCondition",sheetName:"",cmdOption:{fieldsModel:b,fieldName:a.xzc,valueFieldName:m,pivotName:c,TopOrBottomValue:j,inputValue:k,selectTypeValue:l}})},b}(f.Go),b.ValueFilter=ba,ca=function(a){da(b,a);function b(b,c,d,e,f,g){var h=a.call(this,b,2e3,!0)||this;return h.CAc=c,h.Vyc=d,h.xzc=e,h.yzc=f,h.XIc=g,h.Eo(),h.Ao(),h}return b.prototype.Ao=function(){var b=this;b.xo.html(this.EAc()),a.prototype.Ao.call(this),b.BPa(),b.QQ(),b.YIc()},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top"],["absolute",(d-b)/2+"px",(e-c)/2+"px"])},b.prototype.WT=function(){this.Tla(),this.hyc(),a.prototype.close.call(this)},b.prototype.hyc=function(){this.xzc=_,this.yzc=_,this.XIc=_,this.CAc=$,this.qo=$,this.Vyc=$},b.prototype.EAc=function(){var a,b,c,d="",e=this.CAc;for(b=0;b<e.length;b++)d+=this.Ql(e[b],b);return a=ea(this.XIc>=g.PivotDateFilterOperator.Between?!0:!1),c=i(this.xzc),'<div class="'+U+'">\n                    <div class="'+V+'">\n                        <span class="'+o+'">'+(j().DateFilterTitle+"("+c+")")+'</span>\n                        <span class="'+(q+" "+p)+'">\xd7</span>\n                    </div>\n                    <div class="'+W+'">\n                        <div class="'+y+'">\n                            <span class="'+r+'">'+j().DateShow+'</span>\n                            <span class="'+X+'"></span>\n                        </div>\n                        <div class="'+y+'">\n                            <select class="'+Y+'">'+d+'</select>\n                            <div class="'+A+'">\n                                '+a+'\n                            </div>\n                        </div>\n                        <div class="'+y+'">\n                            <input type="checkbox" id="WholeDays" name="WholeDays" class="'+Z+'">\n                            <label for="WholeDays">'+j().WholeDays+'</label>\n                        </div>\n                        <div>\n                            <span class="'+(q+" "+v)+'">'+j().Cancel+'</span>\n                            <span class="'+(u+" "+v)+'">'+j().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.Ql=function(a,b){var c="";return b===this.XIc&&(c="selected"),'<option command="'+b+'" '+c+">"+a+"</option>"},b.prototype.QQ=function(){var a=this;f.GC$("."+q).bind("click",function(b){a.WT()}),f.GC$("."+u).bind("click",function(b){var c,d,e,g,h,i,j=f.GC$("."+Y)[0],k=f.GC$("."+x)[0],l=$,m=f.GC$("."+B),n=f.GC$("."+Z)[0].checked;m.length>0&&(k=m[0],l=m[1]),c=f.GC$(j.options[j.selectedIndex]).attr("command"),d=k?k.value:$,e=l?l.value:$,g=a.Vyc,h=a.xzc,i=a.yzc,g.Oyc({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:h,pivotName:i,command:c,isWholeDay:n,value1:d,value2:e}}),a.WT()}),f.GC$("."+Y).bind("change",function(b){var c=f.GC$(this.options[this.selectedIndex]).attr("command");a.ZIc(c)})},b.prototype.ZIc=function(a){var b=this,c=+a,d;(c>=g.PivotDateFilterOperator.Between&&b.XIc<g.PivotDateFilterOperator.Between||c<g.PivotDateFilterOperator.Between&&b.XIc>=g.PivotDateFilterOperator.Between)&&(d=ea(c>=g.PivotDateFilterOperator.Between?!0:!1),f.GC$("."+A).html(d)),b.XIc=c},b.prototype.YIc=function(){var a,b,c,d,e,g,h,i,j,k,l,m=this,n=m.Vyc,o=m.xzc,p=m.XIc,q=n.getFilterInfo(n.getSourceNameByFieldName(o));q&&q.labelFilter&&q.labelFilter.condition&&(a=q.labelFilter.condition.toJSON(),b=a.isWholeDay,c=a.operator,d=a.val,c===p&&(e=d[0],g=d[1],h=m.formatDate(e,g),e=h.value1,g=h.value2,i=f.GC$("."+z),j=f.GC$("#WholeDays"),k=i[0],l=i[1],k.value=e,l&&g&&g.length>0&&(l.value=g),j.attr("checked",b)))},b.prototype.formatDate=function(a,b){var c=new k,d=c.getPreferredEditingFormatter(a),e=c.getPreferredEditingFormatter(b);return{value1:d.format(a),value2:e.format(b)}},b.prototype.Tla=function(){f.GC$("."+q).unbind("click"),f.GC$("."+u).unbind("click"),f.GC$("."+Y).unbind("change")},b}(f.Go),b.DateFilterDialog=ca;function ea(a,b){var c="",d="";return b&&(c="type = 'number'",d=K),a?'<input class="'+(B+" "+z+" "+d)+'" '+c+' width=100px></input>\n                    <div class="'+C+'">'+j().AndJoiner+'</div>\n                <input class="'+(B+" "+z+" "+d)+'" '+c+" width=100px></input>":'<input class="'+(x+" "+z+" "+d)+'" '+c+"></input>"}},"./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new e.Common.ResourceManager(g.SR,"PivotTables"),i=h.getResource.bind(h),j=d.Ul.Nl,k="cancel-icon",l="cancel-class",m="ok-label",n="filter-confirm",o="date-group-startingAt-isActive",p="date-group-startingAt-value",q="date-group-endingAt-isActive",r="date-group-endingAt-value",s="date-group-by-value",t="date-group-dialog-sub-container",u="date_group_dialog_group-by-subContainer",v="date-group-by",w="date-group-by-selected",x="click",y="change",z=function(a){A(b,a);function b(b,c,e,f,g,h,i,j,k,l,m){var n,o;return void 0===m&&(m="m/d/yyyy"),n=a.call(this,b,0,!0)||this,o=n,o.dIJ=c,o.xzc=e,o.Vyc=f,o.bCc=h&&d.mn.un(h,m)||"",o.MIJ=g&&d.mn.un(g,m),o.eIJ=o.MIJ===o.bCc,o.cCc=j&&d.mn.un(j,m)||"",o.NIJ=i&&d.mn.un(i,m),o.fIJ=o.NIJ===o.cCc,o.gIJ=k,o.lNc=l,o.Eo(),n}return b.prototype.Ao=function(){this.Bla(),a.prototype.Ao.call(this),this.BPa(),this.LXa()},b.prototype.Bla=function(){var a=d.GC$(j("div"));a[0].innerHTML=this.CHJ(),this.xo.append(a)},b.prototype.LXa=function(){var a=this;d.GC$("."+l).bind(x,function(b){a.WT()}),d.GC$("."+m).bind(x,function(b){var c=a.dIJ,e=a.xzc,g=d.GC$("."+p).val().trim(),h=d.GC$("."+r).val().trim(),i=a.gIJ;a.Vyc.Oyc({cmd:"pivotTableGroup",cmdOption:{dataType:f.PivotDataType.date,fieldName:e,pivotName:c,startingAtValue:g,endingAtValue:h,groupByValueArray:i,selections:a.lNc}}),a.WT()}),d.GC$("."+v).bind(x,function(b){var c=parseInt(d.GC$(this).attr("value"),10);a.gIJ.indexOf(c)>-1?(d.GC$("."+v).css("border","initial"),d.GC$(this).removeClass(w),a.gIJ.splice(a.gIJ.indexOf(c),1)):(d.GC$("."+v).css("border","initial"),d.GC$(this).addClass(w),d.GC$(this).css("border","1px dotted rgb(255,135,34)"),a.gIJ.push(c))}),d.GC$("."+p).bind(y,function(b){a.eIJ=!1,d.GC$("."+o)[0].checked=!1}),d.GC$("."+r).bind(y,function(b){a.fIJ=!1,d.GC$("."+q)[0].checked=!1}),d.GC$("."+o).bind(x,function(b){this.checked&&d.GC$("."+p).val(a.MIJ)}),d.GC$("."+q).bind(x,function(b){this.checked&&d.GC$("."+r).val(a.NIJ)})},b.prototype.CHJ=function(){var a=v+(this.gIJ.indexOf(f.DateGroupType.seconds)>-1?" "+w:""),b=v+(this.gIJ.indexOf(f.DateGroupType.minutes)>-1?" "+w:""),c=v+(this.gIJ.indexOf(f.DateGroupType.hours)>-1?" "+w:""),d=v+(this.gIJ.indexOf(f.DateGroupType.days)>-1?" "+w:""),e=v+(this.gIJ.indexOf(f.DateGroupType.months)>-1?" "+w:""),g=v+(this.gIJ.indexOf(f.DateGroupType.quarters)>-1?" "+w:""),h=v+(this.gIJ.indexOf(f.DateGroupType.years)>-1?" "+w:"");return'<div class="date-group-dialog-container">\n                    <div class="date-group-dialog-header">\n                        <span class="date-group-dialog-header-title">'+i().grouping+'</span>\n                        <span class="'+(l+" "+k)+'">\xd7</span>\n                    </div>\n                    <div class="date-group-dialog-content">\n                        <div class="date-group-dialog-content-header">\n                            <span>'+i().auto+'</span>\n                            <span class="date-group--header-horizontal-auto-line"></span>\n                        </div>\n                        <div class="'+t+'">\n                            <input type="checkbox" class="'+o+'" '+(this.eIJ?"checked":"unchecked")+">\n                            <span>"+i().startingAt+'</span>\n                            <input class="'+p+'" value = "'+this.bCc+'"></input>\n                        </div>\n                        <div class="'+t+'">\n                            <input type="checkbox" class="'+q+'" '+(this.eIJ?"checked":"unchecked")+">\n                            <span>"+i().endingAt+'</span>\n                            <input class="'+r+'" value = "'+this.cCc+'"></input>\n                        </div>\n                        <div class="'+t+'">\n                            <span style = "display: inline-block;">'+i().groupBy+'</span>\n                            <span class="date-group--header-horizontal-group-line"></span>\n                            <div class="'+u+'">\n                                <span value = '+f.DateGroupType.seconds+' class="'+a+'">'+i().seconds+"</span>\n                                <span value = "+f.DateGroupType.minutes+' class="'+b+'">'+i().minutes+"</span>\n                                <span value = "+f.DateGroupType.hours+' class="'+c+'">'+i().hours+"</span>\n                                <span value = "+f.DateGroupType.days+' class="'+d+'">'+i().days+"</span>\n                                <span value = "+f.DateGroupType.months+' class="'+e+'">'+i().months+"</span>\n                                <span value = "+f.DateGroupType.quarters+' class="'+g+'">'+i().quarters+"</span>\n                                <span value = "+f.DateGroupType.years+' class="'+h+'">'+i().years+'</span>\n                            </div>\n                        </div>\n                        <div class="date-group-dialog-bottom-confirm">\n                            <span class="'+(l+" "+n)+'">'+i().Cancel+'</span>\n                            <span class="'+(m+" "+n)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top","z-index"],["absolute",(d-b)/2+"px",(e-c)/2+"px",1001])},b.prototype.hyc=function(){this.Vyc=null},b.prototype.Tla=function(){d.GC$("."+l).unbind(x),d.GC$("."+m).unbind(x)},b.prototype.WT=function(){this.hyc(),this.Tla(),a.prototype.close.call(this)},b}(d.Go),b.PivotDateGroupDialog=z},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Pivot"),f=c("@grapecity/js-sheets-common"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=c("./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js"),i=new f.Common.ResourceManager(g.SR,"PivotTables"),j=f.Common.u.Ob,k=i.getResource.bind(i),l=d.Ul.Nl,m=".pivot-field-content-base-field-item.active",n=".pivot-field-content-base-item-item.active",o="pivot-field-content-hide",p="pivot-field-content-base-item-item",q=".pivot-field-show-value-as-content-base-item",r=".pivot-field-show-value-as-content-base-field",s=".pivot-field-show-value-as-content-type-list",t=".pivot-field-setting-control-format",u=".pivot-field-setting-control-ok",v=".pivot-field-setting-control-cancel",w=".gc-filter-dialog-close",x=".pivot-field-custom-name",y="gc-sjs-field-settings-layout-showNoData",z="click",A="change",B="active",C="disable",D="pivot-field-content-item",E="pivot-field-summarize-item",F="pivot-field-summarize-content";function L(a){var b=a,c=new h.PivotFieldSettingNumberFormatDialog(b,b.WHJ,b.XHJ,b.nBJ);return c.Ao(),c}G=function(){return'\n        <div class="pivot-field-summarize-header">\n            <div id="SummarizeValue" class="'+E+" "+B+'">'+k().SummarizeValue+'</div>\n            <div id="ShowValueAs" class="'+E+'">'+k().ShowValueAs+"</div>\n        </div>\n    "},H=function(a){K(b,a);function b(b,c,d,e,f){var g,h=a.call(this,document.body,999,!0)||this;return h.Vo=374,h._v=317.5,h.$l=!1,h.nBJ="",h.eJJ=[],h.fJJ=c,h.Vyc=b,h.xzc=d,h.LAc=d,h.yzc=e,h.Wqa=f,g=h.Vyc.getFieldInfoByName(d),h._X=g.Zxc,h.lIJ=g.getSubTotalType(),h.VHJ(f),h.Eo(),h}return b.prototype.VHJ=function(a){var b,c,d,e,f,g,h,i,j=this;if(a)for(b=0;b<a.length;b++)if(c=a[b]&&a[b].pivotArea,c&&(d=c.references))for(e=0;e<d.length;e++)if(f=d[e],g=f.items,h=f.fieldName,g&&g.indexOf(j.xzc)>-1||h===j.xzc){i=a[b].style,i&&i.formatter&&(j.nBJ=i.formatter);break}},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.BPa()},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.WHJ=(d-b)/2+"px",this.XHJ=(e-c)/2+"px",this.xo.css(["position","left","top","z-index"],["absolute",this.WHJ,this.XHJ,1001])},b.prototype.dialogHeader=function(a){return'\n            <div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;">\n                <span style="float: left; height: 34px; line-height: 34px; display: inline-block;">\n                    '+a+'\n                </span>\n                <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span>\n            </div>\n        '},b.prototype.dialogFieldNameArea=function(a,b){var c="pivot-field-row-wrap";return a=j(a),b=j(b),'\n            <div class ="pivot-field-setting-name-area">\n                <div class='+c+">\n                    <label>"+k().SourceName+" </label> <span>"+a+"</span>\n                </div>\n                <div class="+c+">\n                    <label>"+k().CustomName+' </label> <span><input class="pivot-field-custom-name" type="text" value="'+b+'"></span>\n                </div>\n            </div>\n        '},b.prototype.dialogFooter=function(a){var b=a===e.PivotDataType.number||a===e.PivotDataType.date?k().NumberFormat:k().LabelFormat;return'\n            <div class="pivot-field-setting-footer">\n                <div class="pivot-field-setting-control-wrap-left">\n                    <input class= "pivot-field-setting-control-format" type ="button" value= "'+b+'">\n                </div>\n                <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-control-ok" type ="button" value= "'+k().Ok+'">\n                    <input class= "pivot-field-setting-control pivot-field-setting-control-cancel" type ="button" value= "'+k().Cancel+'">\n                </div>\n            </div>\n        '},b.prototype.yl=function(){var a=d.GC$(l("div"));a.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),a[0].innerHTML=this.dialogHeader(this.fJJ)+'\n                <div class="gc-pivot-field-setting-content">\n                    '+this.dialogFieldNameArea(this._X,this.xzc)+"\n                    "+this.eJJ.join("\n")+"\n                </div>\n            "+this.dialogFooter(this.Vyc.bGc(this.xzc)),this.xo.append(a),d.GC$(".pivot-field-content-item[data-subtype='"+this.lIJ+"']",this.xo[0]).addClass(B),this.xo.width(this.Vo),this.xo.height(this._v)},b.prototype.hyc=function(){this.Vyc=null,this.xzc=void 0},b.prototype.WT=function(){this.hyc(),a.prototype.close.call(this)},b.prototype.KZJ=function(b){var c=this.xo&&a.prototype.OZJ.call(this,this.xo.get(0),b);return!!c||this.N1J&&a.prototype.OZJ.call(this,this.N1J.get(0),b)},b}(d.Go),b.PivotSettingBaseDialog=H,I=function(a){K(b,a);function b(b,c,d,e){var f=a.call(this,b,k().ValueSetting,c,d,e)||this;return f.gJJ(),f.yl(),f.hJJ(),f.LXa(),f}return b.prototype.gJJ=function(){this.PAc()},b.prototype.hJJ=function(){var a,b,c,e,f=this,g=this.Vyc.getFieldInfoByName(f.xzc).xFJ;if(g&&(f.MFJ=g.showDataAs,f._JJ=g.baseFieldName,f.aKJ=g.baseFieldItem,a=g.showDataAs+"",d.GC$(s,this.xo[0]).value=a,["4","7","8","9","10","11","12","13"].indexOf(a)>-1)){for(d.GC$(r).removeClass(C),b=f.Vyc.ryc(1).concat(f.Vyc.ryc(2)),c=0;c<b.length;c++)if(b[c].Cj===g.baseFieldName){f.KFJ=c;break}if(["4","8","9"].indexOf(a)>-1)if(d.GC$(q).removeClass(C),1===g.baseFieldItemType)f.LFJ=1,f.bKJ=1,f.aKJ=k().BaseItemNext;else if(2===g.baseFieldItemType)f.LFJ=0,f.bKJ=0,f.aKJ=k().BaseItemPrevious;else for(e=f.Vyc.cGc(g.baseFieldName).slice(),c=0;c<e.length;c++)if(e[c]+""===g.baseFieldItem){f.LFJ=c+2;break}}},b.prototype.PAc=function(){var a=this.RAc(),b=this.SAc(),c=this.OFJ();this.eJJ.push('\n            <div class="pivot-field-summarize-area">\n            '+a+"\n            "+b+"\n            "+c+"\n            </div>\n        ")},b.prototype.RAc=function(){return G()},b.prototype.SAc=function(){return'\n        <div class="'+F+'">\n            <div class="'+F+'-header">'+k().SummarizeValueField+'</div>\n            <div class="'+F+'-desc">'+k().ChooseType+'</div>\n            <ul class="'+F+'-list">\n                <li data-subtype="8" class="'+D+'">'+k().Sum+'</li>\n                <li data-subtype="1" class="'+D+'">'+k().Count+'</li>\n                <li data-subtype="0" class="'+D+'">'+k().Average+'</li>\n                <li data-subtype="3" class="'+D+'">'+k().Max+'</li>\n                <li data-subtype="4" class="'+D+'">'+k().Min+'</li>\n                <li data-subtype="5" class="'+D+'">'+k().Product+'</li>\n                <li data-subtype="2" class="'+D+'">'+k().CountNumbers+'</li>\n                <li data-subtype="6" class="'+D+'">'+k().StdDev+'</li>\n                <li data-subtype="7" class="'+D+'">'+k().StdDevp+'</li>\n                <li data-subtype="9" class="'+D+'">'+k().Var+'</li>\n                <li data-subtype="10" class="'+D+'">'+k().Varp+"</li>\n            </ul>\n        </div>\n        "},b.prototype.OFJ=function(){return'\n        <div class="pivot-field-show-value-as-content pivot-field-content-hide">\n            <div class="pivot-field-show-value-as-content-header">'+k().ShowValueAsField+'</div>\n            <select name="list" class="pivot-field-show-value-as-content-type-list">\n                <option value="0">'+k().noCalculation+'</option>\n                <option value="1">'+k().percentGrandTotal+'</option>\n                <option value="3">'+k().percentColumnTotal+'</option>\n                <option value="2">'+k().percentRowTotal+'</option>\n                <option value="4">'+k().percentEllipsis+'</option>\n                <option value="5">'+k().percentParentRowTotal+'</option>\n                <option value="6">'+k().percentParentColumnTotal+'</option>\n                <option value="7">'+k().percentParentTotal+'</option>\n                <option value="8">'+k().difference+'</option>\n                <option value="9">'+k().percentDifference+'</option>\n                <option value="10">'+k().runningTotal+'</option>\n                <option value="11">'+k().percentRunningTotal+'</option>\n                <option value="12">'+k().rankSmallestLargest+'</option>\n                <option value="13">'+k().rankLargestSmallest+'</option>\n                <option value="14">'+k().index+'</option>\n            </select>\n            <div class="pivot-field-show-value-as-content-base-field-list">\n                <div>'+k().baseField+'</div>\n                <ul class="pivot-field-show-value-as-content-base-field '+C+'">\n                </ul>\n            </div>\n            <div class="pivot-field-show-value-as-content-base-item-list">\n                <div>'+k().baseItem+'</div>\n                <ul class="pivot-field-show-value-as-content-base-item  '+C+'">\n                </ul>\n            </div>\n        </div>\n        '},b.prototype.LXa=function(){var a=this;d.GC$(w,this.xo[0]).bind(z,function(){a.WT()}),d.GC$(v,this.xo[0]).bind(z,function(){a.WT()}),d.GC$(x,this.xo[0]).bind(A,function(){a.$l=!0,a.xzc=d.GC$(this).val()}),d.GC$("."+D,this.xo[0]).bind(z,function(){d.GC$("."+D+"."+B).removeClass(B),a.$l=!0,a.lIJ=+d.GC$(this).addClass(B).attr("data-subtype");var b=a.Vyc.getFieldInfoByName(a.LAc).Zxc,c=a.Vyc.OIJ(b,b,a.lIJ);d.GC$(x).val(c),a.xzc=c}),d.GC$(u,this.xo[0]).bind(z,function(){var b=e.Fa(a.MFJ)?"0":a.MFJ+"",c,d=a._JJ,f=a.aKJ,g=a.bKJ;["4","7","8","9","10","11","12","13"].indexOf(b)>-1&&["4","8","9"].indexOf(b)>-1&&(c={value:f,index:g}),a.Vyc.Oyc({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{pivotName:a.yzc,oldFieldName:a.LAc,subtotalType:a.lIJ,fieldName:a.xzc,showValueAsType:parseInt(b,10),baseField:d,baseItem:c},formatter:a.nBJ}),a.nBJ="",a.WT()}),d.GC$("."+E,this.xo[0]).bind(z,function(){var b,c;d.GC$("."+E+"."+B).removeClass(B),d.GC$(".pivot-field-content-hide").removeClass(o),d.GC$(this).addClass(B),d.GC$(r).empty(),"SummarizeValue"===this.id?d.GC$(".pivot-field-show-value-as-content").addClass(o):(a.MFJ>-1&&(d.GC$(s)[0].value=a.MFJ,a.KFJ>-1&&(d.GC$(r).removeClass(C),a.LFJ>-1&&d.GC$(q).removeClass(C))),d.GC$("."+F).addClass(o),a.NFJ=a.Vyc.ryc(1).concat(a.Vyc.ryc(2)),a.NFJ.forEach(function(b,c){var e=document.createElement("li");e.className="pivot-field-content-base-field-item",e.value=c,a.KFJ>-1&&a.KFJ===c&&e.classList.add(B),e.innerText=b.Cj,d.GC$(r)[0].appendChild(e)}),a.LFJ>-1&&(b=a.Vyc.getFieldInfoByName(a.xzc).xFJ,c=a.Vyc.cGc(b.baseFieldName).slice(),c.unshift(k().BaseItemNext),c.unshift(k().BaseItemPrevious),c.forEach(function(b,c){var e=document.createElement("li");e.className=p,e.value=c,e.innerText=b,c===a.LFJ&&e.classList.add(B),d.GC$(q)[0].appendChild(e)})))}),d.GC$(r,this.xo[0]).bind(z,function(b){var c,e;this.classList.contains(C)||"LI"!==b.target.tagName||(d.GC$(m).removeClass(B),d.GC$(q).empty(),b.target.classList.add(B),c=b.target.textContent,a._JJ=c,["4","8","9"].indexOf(a.MFJ+"")<0||(e=a.Vyc.cGc(c).slice(),e.unshift(k().BaseItemNext),e.unshift(k().BaseItemPrevious),e.forEach(function(a,b){var c=document.createElement("li");c.className=p,c.value=b,c.innerText=a,0===b&&c.classList.add(B),d.GC$(q)[0].appendChild(c)})))}),d.GC$(q,this.xo[0]).bind(z,function(b){this.classList.contains(C)||"LI"!==b.target.tagName||(d.GC$(n).removeClass(B),b.target.classList.add(B),a.aKJ=b.target.textContent,a.bKJ=b.target.value)}),d.GC$(s,this.xo[0]).bind(A,function(b){var c,e,f=b.target.value;d.GC$(q).empty(),a.nBJ=void 0,a.MFJ=parseInt(f,10),["4","7","8","9","10","11","12","13"].indexOf(f)>-1?(d.GC$(r).removeClass(C),d.GC$(".pivot-field-content-base-field-item").length>0&&(d.GC$(".pivot-field-content-base-field-item")[0].classList.add(B),c=a.NFJ[0].Cj,a._JJ=c,["4","8","9"].indexOf(f)>-1&&(d.GC$(q).removeClass(C),e=a.Vyc.cGc(c).slice(),e.unshift(k().BaseItemNext),e.unshift(k().BaseItemPrevious),e.forEach(function(b,c){var e=document.createElement("li");e.className=p,e.value=c,0===c&&(e.classList.add(B),a.bKJ=0),e.innerText=b,d.GC$(q)[0].appendChild(e)})))):(d.GC$(q).addClass(C),d.GC$(r).addClass(C),d.GC$(m).removeClass(B),d.GC$(n).removeClass(B))}),d.GC$(t,this.xo[0]).bind(z,function(){var b=L(a);a.N1J=b.yo()})},b.prototype.Tla=function(){d.GC$(w).unbind(z),d.GC$(r).unbind(z),d.GC$(q).unbind(z),d.GC$(s).unbind(A),d.GC$(t).unbind(z)},b.prototype.WT=function(){this.Tla(),a.prototype.WT.call(this)},b}(H),b.PivotValuesFieldSettingDialog=I,J=function(a){K(b,a);function b(b,c,d,e,f){var g=a.call(this,b,k().FieldSetting,c,d,e)||this;return g.yYJ=f,g.gJJ(),g.yl(),g.LXa(),g}return b.prototype.gJJ=function(){this.PAc()},b.prototype.iJJ=function(){return G()},b.prototype.zYJ=function(){return'\n        <div class="field-settings-layout-container">\n                <span class="gc-sjs-field-settings-layout-style">'+k().Layout+'</span>\n                <div class="gc-sjs-field-settings-layout-line"></div>\n                <div class="gc-sjs-field-settings-layout-showNoData-container">\n                    <input type="checkbox" '+(this.yYJ?"checked":"")+" class="+y+'>\n                    <span class="gc-sjs-field-settings-layout-showNoData-label">'+k().showNoData+"</span>\n                </div>\n        </div>"},b.prototype.PAc=function(){var a=this.zYJ();this.eJJ.push('\n            <div class="pivot-field-summarize-area">\n                '+a+"\n            </div>\n        ")},b.prototype.LXa=function(){var a=this;d.GC$(w,this.xo[0]).bind(z,function(){a.WT()}),d.GC$(v,this.xo[0]).bind(z,function(){a.WT()}),d.GC$(x,this.xo[0]).bind(A,function(){a.$l=!0,a.xzc=d.GC$(this).val()}),d.GC$("."+y,this.xo[0]).bind(z,function(){a.yYJ=this.checked}),d.GC$(t,this.xo[0]).bind(z,function(){var b=L(a);a.N1J=b.yo()}),d.GC$(u,this.xo[0]).bind(z,function(){a.Vyc.Oyc({cmd:"UpdatePivotFieldCmd",sheetName:"",cmdOption:{pivotName:a.yzc,oldFieldName:a.LAc,fieldName:a.xzc,showNoData:a.yYJ},formatter:a.nBJ}),a.nBJ="",a.WT()})},b.prototype.Tla=function(){d.GC$(w).unbind(z),d.GC$(v).unbind(z),d.GC$(x).unbind(A),d.GC$(t).unbind(z),d.GC$(u).unbind(z)},b.prototype.WT=function(){this.Tla(),a.prototype.WT.call(this)},b}(H),b.PivotDimFieldSettingDialog=J},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.Ul.Nl,f=c("@grapecity/js-sheets-common"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new f.Common.ResourceManager(g.SR,"PivotTables"),i=h.getResource.bind(h),j=".pivot-field-number-format-show-value",k=".pivot-field-number-format-sample-value",l=d.Ul.lHb,m=null,n=void 0,o="click",p="active",q=function(a){r(b,a);function b(b,c,d,e){var f=a.call(this,null,1e4)||this;return f.zWa=!0,f.FB=d,f.EB=c,f.YHJ=b,f.nBJ=e,f.Bla(),f}return b.prototype.BPa=function(){this.xo.css(["position","left","top"],["absolute",this.EB,this.FB])},b.prototype.hyc=function(){this.YHJ=m,this.nBJ=n},b.prototype.WT=function(){this.Tla(),this.hyc(),a.prototype.close.call(this)},b.prototype.Tla=function(){d.GC$(".pivot-field-content-number-format-item").unbind(o),d.GC$(".pivot-field-setting-number-format-control-ok").unbind(o),d.GC$(".gc-filter-dialog-close",this.xo[0]).unbind(o),d.GC$(".pivot-field-setting-number-format-control-cancel").unbind(o),d.GC$(j).unbind(o)},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.ZHJ(),this.LXa(),this.BPa()},b.prototype.LXa=function(){var a=this;d.GC$(".pivot-field-content-number-format-item",this.xo[0]).bind(o,function(a){d.GC$(".pivot-field-content-number-format-item.active").removeClass(p),this.classList.add(p),d.GC$(j)[0].value=this.innerText,l(this.innerText)||(d.GC$(k)[0].value=d.mn.un(12345,this.innerText))}),d.GC$(".pivot-field-setting-number-format-control-ok",this.xo[0]).bind(o,function(){var b=d.GC$(j)[0].value,c=i().CustomFormats;c.indexOf(b)<0&&c.push(b),a.YHJ.nBJ=d.GC$(j)[0].value,a.WT()}),d.GC$(".gc-filter-dialog-close",this.xo[0]).bind(o,function(){a.WT()}),d.GC$(".pivot-field-setting-number-format-control-cancel",this.xo[0]).bind(o,function(){a.WT()}),d.GC$(j,this.xo[0]).bind("input",function(){if(!l(this.value))try{d.GC$(k)[0].value=d.mn.un(12345,this.value)}catch(a){}})},b.prototype.Bla=function(){var a=d.GC$(e("div"));a.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),a[0].innerHTML=this.NAc()+'<div class="gc-pivot-field-setting-content">'+this.$HJ()+"</div>"+this.QAc(),this.xo.append(a)},b.prototype.NAc=function(){return'<div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;"><span style="float: left; height: 34px; line-height: 34px; display: inline-block;">'+i().FormatCells+'</span>\n        <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span></div>'},b.prototype.QAc=function(){return'<div class="pivot-field-setting-footer">\n        <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-number-format-control-ok" type ="button" value= "'+i().Ok+'">\n            <input class= "pivot-field-setting-control pivot-field-setting-number-format-control-cancel" type ="button" value= "'+i().Cancel+'">\n            </div>\n        </div>'},b.prototype.$HJ=function(){var a=this._HJ();return'\n        <div class="pivot-field-number-format-area">\n            <div class="pivot-field-summarize-header">\n                <div style="margin-top: 6px" id="SummarizeValue" class="pivot-field-summarize-item active">'+i().Number+"</div>\n            </div>\n            "+a+"\n        </div>\n        "},b.prototype._HJ=function(){return'\n            <div style="background: white; padding-bottom: 10px;" class="gc-pivot-field-setting-content">\n                <div class="pivot-field-summarize-area">\n                    <div class="pivot-field-show-value-as-content-header">'+i().Sample+'</div>\n                    <input class="pivot-field-number-format-sample-value" value="12345" disabled="disabled" />\n                    <div class="pivot-field-show-value-as-content-header">'+i().Type+'</div>\n                    <input class="pivot-field-number-format-show-value" />\n                    <ul class="pivot-field-number-format-content-list">\n                    </ul>\n                </div>\n            </div>\n        ';
},b.prototype.ZHJ=function(){var a,b=i().CustomFormats,c=this;c.nBJ&&b.indexOf(c.nBJ)<0&&b.push(c.nBJ),a=null,b.forEach(function(b,e){var f=document.createElement("li");f.className="pivot-field-content-number-format-item",f.value=e,f.innerText=b,c.nBJ||0!==e?c.nBJ===b&&(f.classList.add(p),d.GC$(j)[0].value=b,l(b)||(d.GC$(k)[0].value=d.mn.un(12345,b),a=f)):(f.classList.add(p),d.GC$(j)[0].value=b),d.GC$(".pivot-field-number-format-content-list")[0].appendChild(f)}),a&&a.scrollIntoView()},b}(d.Go),b.PivotFieldSettingNumberFormatDialog=q},"./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("./dist/plugins/pivot/pivot.ns.js"),f=c("Core"),g=c("CellTypes"),h=c("Pivot"),i=new d.Common.ResourceManager(e.SR,"PivotTables"),j=d.Common.u.Ob,k=i.getResource.bind(i),l=f.Ul.Nl,m=d.Common.q,n="gc-Filter-list",o="gc-Filter-list-block",p="gc-Filter-list-select-block",q="gc-Filter-list-icon",r="gc-Filter-list-link",s="gc-Filter-list-item",t="gc-Filter-list-link-arrow",u="gc-Filter-list-sort-item",v="gc-Filter-list-icon-selected",w="item-hover",x="item-noHover",y="clear-filter-icon-default",z="clear-filter-icon",A="gc-Filter-list-span",B="filter-list-box",C="filter-confirm",D="filter-dialog-confirm",E="filter-confirm-enable",F="filter-bottom-line",G="filter-sort-icon-one",H="filter-sort-icon-two",I="filter-list-box-icon",J="filter-list-box-container",K="filter-search",L="filter-list-box-host",M="filter-search-input",N="filter-select-all-container",O="filter-select-icon",P="filter-select-all-link",Q="filter-check-all-icon",R="filter-uncheck-all-icon",S="check-all",T="uncheck-all",U="gc-Filter-list-icon-selected",V="select-class",W="ok-class",X="cancel-class",Y="filter-sort",Z="filter-condition",$="gc-pivot-search-box",_="gc-pivot-search-box-input-container",aa="gc-pivot-search-box-input",ba="gc-pivot-search-box-icon",ca="gc-pivot-search-box-icon-background-clear",da=null,ea=void 0,fa=function(){return{type:2,child:[{text:k().PivotPanel_Sort_A_Z,className:u+" "+Y,iconClass:q+" "+G,commandName:"asc"},{text:k().PivotPanel_Sort_Z_A,className:u+" "+Y,iconClass:q+" "+H,commandName:"desc"}]}},ga=function(){return{type:3,child:[{text:k().PivotPanel_Filter_Clear,className:u+" "+Z,iconClass:q+" "+y,commandName:"ClearFilter"},{text:k().PivotPanel_Filter_Label,className:u+" "+w+" "+Z,iconClass:q,commandName:"LabelFilter",rightArrow:!0},{text:k().PivotPanel_Filter_Value,className:u+" "+w+" "+Z,iconClass:q,commandName:"ValueFilter",rightArrow:!0}]}},ha=function(){return{type:5,child:[{text:k().Cancel,className:D+" "+E,commandName:"Cancel"},{text:k().Ok,className:D+" "+E,commandName:"OK"}]}},function(a){a[a.selectFields=1]="selectFields",a[a.sortArea=2]="sortArea",a[a.filters=3]="filters",a[a.listBox=4]="listBox",a[a.confirmButton=5]="confirmButton"}(ia||(ia={})),ja=function(){function a(){}return a.getData=function(b,c,d){return a.getDataModel(b,c,d)},a.getDataModel=function(b,c,d){var e=[];return 1&b&&e.push(a.getSelectData(d)),2&b&&e.push(a.getSortSData(d)),4&b&&e.push(a.getFilterData(d,c)),8&b&&e.push(a.getListBoxData(d)),16&b&&e.push(a.getConfirmData()),e},a.getSelectData=function(a){var b,c={type:1,child:[]};if(a.areaFieldName)for(b=0;b<a.areaFieldName.length;b++)c.child.push({text:""}),c.child[b].text=a.areaFieldName[b];return c},a.getSortSData=function(a){var b,c=f.GC$.extend(!0,{},fa());return a.fieldIsNumber&&(c.child[0].text=k().PivotPanel_Sort_Smallest_Largest,c.child[1].text=k().PivotPanel_Sort_Largest_Smallest),a.isColOrRow?(c.child[0].className+=" "+w,c.child[1].className+=" "+w):(c.child[0].className+=" "+x,c.child[1].className+=" "+x),h.Fa(a.sortInfo)||(b=c.child[a.sortInfo],h.Fa(b)||(~b.iconClass.indexOf(G)?b.iconClass=b.iconClass.replace(G,v):~b.iconClass.indexOf(H)&&(b.iconClass=b.iconClass.replace(H,v)))),c},a.getFilterData=function(a,b){var c=f.GC$.extend(!0,{},ga());return c.child[0].text=c.child[0].text.replace("{0}",'"'+b+'"'),a.hasLabelCondition||a.hasValueCondition||a.hasLabelManual?c.child[0].className+=" "+w:c.child[0].className+=" "+x,a.hasLabelCondition&&(c.child[1].iconClass+=" "+U,c.child[0].iconClass=q+" "+z),a.isDateType&&(c.child[1].text=k().PivotPanel_Date_Filter),a.hasValueCondition&&(c.child[2].iconClass+=" "+U,c.child[0].iconClass=q+" "+z),c},a.getListBoxData=function(a){var b={type:4,child:[]};return b.child=a.fields,b},a.updateListBoxData=function(a,b,c){var d,e;if(a&&0!==a.child.length){if(d=a.child,0===b)for(e=0;e<d.length;e++)d[e].status=c;else d[b].status=c;return a}},a.getConfirmData=function(){return f.GC$.extend(!0,{},ha())},a}(),ka=function(a){la(b,a);function b(b,c,d){var e=a.call(this,b,1e3)||this;return e.Vyc=c,e.yzc=d,e}return b.prototype.init=function(b,c,d,e){this.hZ(),this.xzc=c,this.TAc=b,this.SH=d,this.i6=e,this.qVJ=!1,this.zVJ=0,this.rVJ=!1,this.sVJ="",a.prototype.ad.call(this),this.Vyc.getFieldInfoByName(c)?e.isDateType=2===this.Vyc.getFieldInfoByName(c).ny:e.isDateType=2===this.Vyc.lBJ(c);var f=ja.getData(b,c,e);this.open(f,d)},b.prototype.hZ=function(){this.OC&&(this.OC.no(),this.OC=null)},b.prototype.open=function(a,b){var c,d,e,f="";for(c=0;c<a.length;c++)switch(a[c].type){case 1:f+=this.renderSelectField(a[c]);break;case 2:f+=this.renderSort(a[c]);break;case 3:f+=this.renderFilters(a[c]);break;case 4:f+=this.renderListBox(a[c]);break;case 5:f+=this.renderConfirm(a[c])}d=this.Sla(b.x,b.y),d.html(f),e=this.cXa(),this.Ao(),e&&window.Yl.Hm(),this.UAc()},b.prototype.Sla=function(a,b){var c=this.yo();return c.css(["left","top"],[a,b]),c.addClass(n),c},b.prototype.Ao=function(){a.prototype.Ao.call(this),this.Do()},b.prototype.close=function(){this.Tla(),this.hyc(),a.prototype.close.call(this)},b.prototype.hyc=function(){this.VAc=da,this.YAc=da,this.Vyc=da,this.SH=da,this.i6=da,this.OC=da},b.prototype.QQ=function(a){var b=this,c=this;a.bind(f.Events.CellClick,function(a,d){var e,f=b.VAc,g=d.sheet;g.CH&&g.m_a("transparent"),d.row>=f.length||(0===d.row?(c.rVJ=!c.rVJ,g.setValue(0,0,c.rVJ)):(e=g.getValue(d.row,0),g.setValue(d.row,0,!e),e?c.zVJ--:c.zVJ++),c.tVJ())}),a.bind(f.Events.TouchToolStripOpening,function(a,b){b.handled=!0}),a.bind(f.Events.ButtonClicked,function(a,d){var e,f=b.VAc,g=d.sheet;d.row>=f.length||(0===d.row?(c.rVJ=!c.rVJ,g.setValue(0,0,c.rVJ)):(e=g.getValue(d.row,0),g.setValue(d.row,0,!e),e?c.zVJ--:c.zVJ++),c.tVJ())}),f.GC$("."+S).bind("click",function(d){var e,g,h=b.VAc,i=a&&f.UCJ(a);if(!(h.length<=0)){if(i){for(i.suspendPaint(),e=0,g=1;g<h.length;g++)i.getRowVisible(g)&&(i.setValue(g,0,!0),e++);i.resumePaint(),c.zVJ=e}f.GC$("."+W).addClass(E)}}),f.GC$("."+T).bind("click",function(d){var e,g=b.VAc,h=a&&f.UCJ(a);if(!(g.length<=0)){if(h){for(h.suspendPaint(),e=1;e<g.length;e++)h.getRowVisible(e)&&h.setValue(e,0,!1);h.resumePaint(),c.zVJ=0}f.GC$("."+W).removeClass(E)}}),f.GC$("."+V).bind("change",function(a){var b=this.options[this.selectedIndex].value,d=c.Vyc,e=c.yzc,f=c.SH,g=c.TAc;d.Oyc({cmd:"updateListBox",sheetName:"",cmdOption:{fieldName:b,pivotName:e,configurationNumber:g,position:f,filterDialog:c}})}),f.GC$("."+W).bind("click",function(a){var b,d,e,g;f.GC$(this).hasClass(E)&&(b=c.xzc,d=c.Vyc,e=c.yzc,g=c.uVJ(),d.Oyc({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:b,pivotName:e,dataOfListBox:g}}),c.close())}),f.GC$("."+X).bind("click",function(a){c.close()}),f.GC$("."+Y).bind("click",function(a){var b,d,e,g;f.GC$(this).hasClass(x)||(b=f.GC$(this).attr("command"),d=c.Vyc,e=c.xzc,g=c.yzc,d.Oyc({cmd:"pivotSort",sheetName:"",cmdOption:{fieldName:e,pivotName:g,commandName:b}}),c.close())}),f.GC$("."+Z).bind("click",function(a){var b,d,e,g=f.GC$(this).attr("command");f.GC$(this).hasClass(x)||"ClearFilter"!==g||(b=c.Vyc,d=c.xzc,e=c.yzc,b.Oyc({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:d,pivotName:e,commandName:g,clearType:0}}),c.close())}),f.GC$("."+Z).bind("mouseenter",function(a){var b,d,e,g,h,i=f.GC$(this),j=i.attr("command");i.hasClass(x)||"ClearFilter"===i.attr("command")||(b=c.Vyc,d=c.xzc,e=c.yzc,g=this,h={x:c.SH.x,y:c.SH.y},b.Oyc({cmd:"createFilterSecondaryMenu",sheetName:"",cmdOption:{fieldName:d,pivotName:e,commandName:j,host:g,position:h,filterDialog:c}}))}),f.GC$("."+aa).bind("input",function(a){c.qVJ=!0,c.sVJ=this.value.toLocaleLowerCase(),c.vVJ()}),f.GC$("."+ba).bind("click",function(a){f.GC$("."+aa).val(""),c.qVJ=!1,c.sVJ="",c.vVJ()})},b.prototype.Tla=function(){f.GC$("."+S).unbind("click"),f.GC$("."+T).unbind("click"),f.GC$("."+V).unbind("change"),f.GC$("."+W).unbind("click"),f.GC$("."+X).unbind("click"),f.GC$("."+Y).unbind("click"),f.GC$("."+Z).unbind("click"),f.GC$("."+Z).unbind("mouseenter"),f.GC$("."+M).unbind("change"),f.GC$("."+aa).unbind("input"),f.GC$("."+ba).unbind("click")},b.prototype.renderSelectField=function(a){var b,c='<select class="'+V+'" style="width:100%">';for(b=0;b<a.child.length;b++)c+=this.renderDropDown(a.child[b].text);return"<div class='"+p+"'>\n                    <div class='"+s+"'>\n                    "+k().Select_Field+"\n                    </div>\n                    <div class='"+s+"'>\n                        "+c+"\n                        </select>\n                    </div>\n                </div>"},b.prototype.renderSort=function(a){var b,c="";for(b=0;b<a.child.length;b++)c+=this.createItem(a.child[b]);return'<div class="'+o+'">\n                    '+c+'\n                    <div class="'+A+'"></div>\n                </div>'},b.prototype.renderFilters=function(a){var b,c="";for(b=0;b<a.child.length;b++)c+=this.createItem(a.child[b]);return'<div class="'+o+'">\n                    '+c+'\n                    <div class="'+A+'"></div>\n                </div>'},b.prototype.renderListBox=function(a){var b,c,d,e,f;for(this.YAc=J,this.VAc=a.child,b="",c=a.child,d=0;d<c.length;d++)if(c[d].status===!1){b=v+" "+q;break}return e=this.wVJ(),f=this.ZAc(),'<div class="'+B+'">\n                    '+e+"\n                    "+f+'\n                    <div class="'+L+'">\n                    <div class="'+I+'">\n                        <div class="'+b+'"></div>\n                    </div>\n                    <div class="'+J+'"></div>\n                    </div>\n                <div>'},b.prototype.renderConfirm=function(a){return'<div class="'+o+'">\n                    <div class="'+u+'">\n                        <div class="'+(a.child[0].className+" "+X)+'" command="'+a.child[0].commandName+'">'+a.child[0].text+'</div>\n                        <div class="'+(a.child[1].className+" "+W)+'" command="'+a.child[1].commandName+'">'+a.child[1].text+'</div>\n                    </div>\n                    <div class="'+F+'"></div>\n                </div>'},b.prototype.renderDropDown=function(a){return a=j(a),"<option>"+a+"</option>"},b.prototype.createItem=function(a){return a.rightArrow?'<div class="'+a.className+'" command="'+a.commandName+'">\n                        <div class="'+a.iconClass+'"></div>\n                        <div class="'+r+'">'+a.text+'</div>\n                        <div class="'+t+'"></div>\n                    </div>':'<div class="'+a.className+'" command="'+a.commandName+'">\n                        <div class="'+a.iconClass+'"></div>\n                        <div class="'+r+'">'+a.text+"</div>\n                    </div>"},b.prototype.UAc=function(a){var b,c,d,e,g;a||(a=this.VAc),b=this.YAc,c=new f.Workbook(document.getElementsByClassName(b)[0],{sheetCount:1}),c.EDc=!0,c.options.scrollByPixel=!0,this.OC=c,d=c.sheets[0],c.suspendEvent(),d.suspendPaint(),e=c.options,g=d.options,e.allowContextMenu=!1,e.showHorizontalScrollbar=!1,e.showVerticalScrollbar=!1,e.scrollbarMaxAlign=!0,e.tabStripVisible=!1,e.allowUserResize=!1,e.allowUserDragDrop=!1,e.allowUserDragFill=!1,e.allowUserZoom=!1,e.grayAreaBackColor="white",g.colHeaderVisible=!1,g.rowHeaderVisible=!1,g.selectionBackColor="transparent",g.selectionBorderColor="transparent",g.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},g.isProtected=!0,d.defaults.rowHeight=21,d.defaults.colWidth=23,a.unshift({value:k().AddSearchResult,status:this.rVJ,text:k().AddSearchResult}),this.xVJ(),d.resumePaint(),c.resumeEvent(),this.QQ(c)},b.prototype.kWJ=function(){var a=this,b=a.OC,c=a.zVJ,d=a.qVJ;h.Fa(b)||(d&&c++,c>8?b.options.showVerticalScrollbar=!0:b.options.showVerticalScrollbar=!1)},b.prototype.fXa=function(a){var b,c,d,e=this,g=e.OC,i=e.zVJ,j=e.qVJ;h.Fa(g)||(b=f.UCJ(g),c=g.options.showVerticalScrollbar,j&&i&&a<f.Vn.Xn(k().AddSearchResult)&&(a=f.Vn.Xn(k().AddSearchResult)),d=170,c&&(d-=20),d<a?(g.options.showHorizontalScrollbar=!0,b.autoFitColumn(1)):(g.options.showHorizontalScrollbar=!1,b.setColumnWidth(1,500)))},b.prototype.uVJ=function(){var a,b,c,d,e,g,i=this,j=i.qVJ,k=i.rVJ,l=i.VAc,m=i.OC,n=m&&f.UCJ(m),o={},p=!0;if(h.Fa(n))return l;if(j)if(k){for(b=1;b<l.length;b++)n.getRowVisible(b)&&(a=n.getValue(b,0),a&&(p=!1),o[b]=l[b].status,l[b].status=a);if(p)for(c=Object.keys(o),d=0,e=c;d<e.length;d++)g=e[d],l[g].status=o[g]}else for(b=1;b<l.length;b++)n.getRowVisible(b)&&n.getValue(b,0)?l[b].status=!0:l[b].status=!1;else for(b=1;b<l.length;b++)n.getValue(b,0)?l[b].status=!0:l[b].status=!1;return l.shift(),l},b.prototype.tVJ=function(){var a=this;a.rVJ||a.zVJ?f.GC$("."+W).addClass(E):f.GC$("."+W).removeClass(E)},b.prototype.vVJ=function(){var a,b,c,d,e,g,i=this,j=i.VAc,k=i.sVJ;if(i.yVJ(),h.Fa(k)||k.length<1)return i.qVJ=!1,void i.xVJ();if(a=i.OC,b=a&&f.UCJ(a)){for(b.suspendPaint(),b.setRowVisible(0,!0),i.zVJ=0,c=void 0,d=0,e=i.BVJ(),g=1;g<j.length;g++)c=j[g],c.text&&e(c.text)?(b.setRowVisible(g,!0),b.setValue(g,0,!0),i.zVJ++,d=c.textLength>d?c.textLength:d):b.setRowVisible(g,!1);0===i.zVJ&&b.setRowVisible(0,!1),i.kWJ(),i.fXa(d),b.resumePaint()}},b.prototype.BVJ=function(){var a,b,c=this,d=c.sVJ,e=m.ub(d);return e?(a=m.sb(e),function(c){return b=a.exec(c),a.lastIndex=0,b&&0===b.index}):function(a){return a.toLocaleLowerCase().indexOf(d)>-1}},b.prototype.yVJ=function(){var a=this,b=a.sVJ,c=f.GC$("."+ba);b?c.css("display","block"):c.css("display","none")},b.prototype.xVJ=function(){var a,b,c,d,e=this,i=e.OC,j=i&&f.UCJ(i),k=e.VAc,l=f.GC$.extend(!0,[],k);for(j.suspendPaint(),e.zVJ=0,j.setRowVisible(0,!1),a=0,c=1;c<l.length;c++)b=l[c],b.status&&e.zVJ++,j.setRowVisible(c,!0),h.Fa(b.textLength)&&(k[c].textLength=f.Vn.Xn(b.text)),a=b.textLength>a?b.textLength:a;j.setDataSource(l),j.bindColumns([{name:"status",cellType:new g.CheckBox},{name:"text"}]),d=j.getActualStyle(-1,2),d.hAlign=0,j.setStyle(-1,2,d),e.kWJ(),e.fXa(a),j.resumePaint()},b.prototype.wVJ=function(){return"<div class = '"+$+"'>\n            <div class = '"+_+"'>\n                <input class = '"+aa+"' placeholder=\""+k().search+"\"/>\n                <div class = '"+ba+"'>\n                    <div class = '"+ca+"'></div>\n                </div>\n            </div>\n        </div>"},b.prototype.ZAc=function(){var a=O+" "+Q,b=O+" "+R,c=P+" "+S,d=P+" "+T;return'<div class="'+N+'">\n                    <a class="'+c+'">\n                        <span class="'+a+'"></span>\n                        <span>'+k().PivotPanel_Filter_SelectAll+'</span>\n                    </a>\n                    <a class="'+d+'">\n                        <span class="'+b+'"></span>\n                        <span>'+k().PivotPanel_Filter_NoSelectAll+"</span>\n                    </a>\n                </div>"},b.prototype.Do=function(){var a,b,c,d,e,g,h,i,j,k,l,m=f.GC$(this.xo[0]),n=this.zo();0!==m.length&&(a=f.GC$(n).offset(),b=parseInt(m.css("left"),10)+a.left,c=parseInt(m.css("top"),10)+a.top,d=m.width(),e=m.height(),isNaN(b)||isNaN(c)||isNaN(d)||isNaN(e)||(g=0,h=0,i=document.documentElement,j=i.clientWidth,k=i.clientHeight,l=m[0].getBoundingClientRect(),l.left+d>j&&(h=l.left+d-j),l.top+e>k&&(g=l.top+e-k),(b<0||c<0||g>0||h>0)&&(b-=h,c-=g,b<0&&(b=0),c<0&&(c=0),m.css({left:b-a.left+"px",top:c-a.top+"px"}))))},b}(f.Go),b.PivotFilterDialog=ka},"./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("./dist/plugins/pivot/pivot.ns.js"),g=c("Pivot"),h=new e.Common.ResourceManager(f.SR,"PivotTables"),i=h.getResource.bind(h),j=e.Common.u,k=d.Ul.Nl,l="cancel-icon",m="cancel-class",n="ok-label",o="filter-confirm",p="number-group-startingAt-isActive",q="number-group-startingAt-value",r="number-group-endingAt-isActive",s="number-group-endingAt-value",t="number-group-by-value",u="number-group-dialog-sub-container",v=function(a){w(b,a);function b(b,c,d,e,f,g,h,i,j){var k=a.call(this,b,0,!0)||this;return k.dIJ=c,k.xzc=d,k.Vyc=e,k.bCc=g||0,k.MIJ=f,k.eIJ=f===k.bCc,k.cCc=i||0,k.NIJ=h,k.fIJ=h===k.cCc,k.hIJ=j,k.Eo(),k}return b.prototype.Ao=function(){this.Bla(),a.prototype.Ao.call(this),this.BPa(),this.LXa()},b.prototype.Bla=function(){var a=d.GC$(k("div"));a[0].innerHTML=this.CHJ(),this.xo.append(a)},b.prototype.LXa=function(){var a=this;d.GC$("."+m).bind("click",function(b){a.WT()}),d.GC$("."+n).bind("click",function(b){var c=a.dIJ,e=a.xzc,f=parseInt(d.GC$("."+q).val().trim(),10),h=parseInt(d.GC$("."+s).val().trim(),10),i=parseInt(d.GC$("."+t).val().trim(),10);a.Vyc.Oyc({cmd:"pivotTableGroup",cmdOption:{dataType:g.PivotDataType.number,fieldName:e,pivotName:c,startingAtValue:f,endingAtValue:h,groupByValue:i}}),a.WT()}),d.GC$("."+q).bind("change",function(b){a.eIJ=!1,d.GC$("."+p)[0].checked=!1}),d.GC$("."+s).bind("change",function(b){a.fIJ=!1,d.GC$("."+r)[0].checked=!1}),d.GC$("."+p).bind("click",function(b){this.checked&&d.GC$("."+q).val(a.MIJ)}),d.GC$("."+r).bind("click",function(b){this.checked&&d.GC$("."+s).val(a.NIJ)})},b.prototype.CHJ=function(){return'<div class="number-group-dialog-container">\n                 <div class="number-group-dialog-header">\n                     <span class="date-group-dialog-header-title">'+i().grouping+'</span>\n                      <span class="'+(m+" "+l)+'">\xd7</span>\n                  </div>\n                  <div class="number-group-dialog-content">\n                        <div class="number-group-dialog-content-header">\n                            <span>'+i().auto+'</span>\n                            <span class="number-group--header-horizontal-line"></span>\n                        </div>\n                        <div class="'+u+'">\n                            <input type="checkbox" class="'+p+'" '+(this.eIJ?"checked":"unchecked")+">\n                            <span>"+i().startingAt+'</span>\n                            <input class="'+q+'" value = '+this.bCc+'></input>\n                        </div>\n                        <div class="'+u+'">\n                            <input type="checkbox" class="'+r+'" '+(this.eIJ?"checked":"unchecked")+">\n                            <span>"+i().endingAt+'</span>\n                            <input class="'+s+'" value = '+this.cCc+'></input>\n                        </div>\n                        <div class="'+u+'">\n                            <span style = "margin-left: 24px">'+i().groupBy+'</span>\n                            <input class="'+t+'" value= '+this.hIJ+'></input>\n                        </div>\n                        <div class="number-group-dialog-bottom-confirm">\n                            <span class="'+(m+" "+o)+'">'+i().Cancel+'</span>\n                            <span class="'+(n+" "+o)+'">'+i().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top","z-index"],["absolute",(d-b)/2+"px",(e-c)/2+"px",1001])},b.prototype.hyc=function(){this.Vyc=null},b.prototype.Tla=function(){d.GC$("."+m).unbind("click"),d.GC$("."+n).unbind("click")},b.prototype.WT=function(){this.hyc(),this.Tla(),a.prototype.close.call(this)},b}(d.Go),b.PivotNumberGroupDialog=v},"./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Pivot"),f=c("@grapecity/js-sheets-common"),g=c("./dist/plugins/pivot/pivot.ns.js"),h=new f.Common.ResourceManager(g.SR,"PivotTables"),i=f.Common.u.Ob,j=h.getResource.bind(h),k=f.Common.u,l=d.Ul.Nl,m="show-value-as-dialog-container",n="show-value-as-dialog-header",o="show-value-as-dialog-content",p="cancel-icon",q="cancel-class",r="ok-label",s="filter-confirm",t="show-value-as-dialog-content-item",u="show-value-as-dialog-content-select",v=".baseFieldList",w=".baseFieldItem",x=function(a){y(b,a);function b(b,c,d,e,f,g){var h,i,k,l,m,n,o,p=a.call(this,b,0,!0)||this;if(p.Vyc=c,p.xzc=d,p.hi=g,p.yzc=e,f){if(p.LDc=f.valueFieldName,h=void 0,i=p.Vyc.jyc,k=p.Vyc.kyc,4===f.menuArea)if(4===f.area){for(l=f.rowInfos&&f.rowInfos.length-1;l>=0;l--)if(f.rowInfos[l].fieldName!==j().sigmaValue){h=f.rowInfos[l];break}}else 3===f.area?(m=f.activeRowFieldInfo&&f.activeRowFieldInfo.index,0===m?m+=1:m===f.rowInfos&&f.rowInfos.length-1?m=f.rowInfos.length-2:m-=1,h=f.rowInfos[m]):2===f.area&&(n=void 0,o=void 0,i[0]?(n=i[0]&&i[0].Cj,o=i[0]._items[0].value):k[0]&&(n=k&&k[0].Cj,o=k[0]._items[0].value),h={fieldNameTemp:n,itemNameTemp:o});p.zHJ=h.fieldName,p.AHJ=h.itemName}return p.Eo(),p.Ao(),p}return b.prototype.Ao=function(){this.Bla(this.hi,this.LDc,this.BHJ()),a.prototype.Ao.call(this),this.BPa(),this.LXa()},b.prototype.BHJ=function(){return this.Vyc.ryc(1).concat(this.Vyc.ryc(2))},b.prototype.getBaseItemList=function(a){return this.Vyc.cGc(a).slice()},b.prototype.Bla=function(a,b,c){var e=d.GC$(l("div"));e[0].innerHTML=this.CHJ(a,b,c),this.xo.append(e)},b.prototype.Ql=function(a,b,c){var d="";return c&&(d="selected"),'<option value="'+b+'" '+d+">"+i(a)+"</option>"},b.prototype.LXa=function(){var a=this;d.GC$("."+q).bind("click",function(b){a.WT()}),d.GC$("."+r).bind("click",function(b){var c,e=a.Vyc,f=d.GC$(v)[0],g=d.GC$(w)[0],h=f&&f.options[f.selectedIndex].text;g&&(c={index:g.selectedIndex,value:g.options[g.selectedIndex].text}),e.Oyc({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{showValueAsType:a.hi,pivotName:a.yzc,fieldName:a.xzc,baseField:h,baseItem:c}}),a.WT()}),d.GC$(v).bind("change",function(b){var c,f,g,h;if(!e.Fa(d.GC$(w)[0])){for(c=d.GC$(this.options[this.selectedIndex]).text(),f=a.Vyc.cGc(c).slice(),g="",f&&f.length>0&&(f.unshift(j().BaseItemNext),f.unshift(j().BaseItemPrevious)),h=0;h<f.length;h++)g+=a.Ql(f[h],h);d.GC$(w)[0].innerHTML=g}})},b.prototype.CHJ=function(a,b,c){var d,e,f,g,h,k,l,v,w,x,y=[4,8,9],z="",A="",B=this.Vyc.getFieldInfoByName(this.LDc).xFJ;for(B&&(e=B.showDataAs,f=B.baseFieldName,g=B.baseFieldItem,h=B.baseFieldItemType),k=a===e&&f||this.zHJ,l=0;l<c.length;l++)d=k===c[l].Cj,z+=this.Ql(c[l].Cj,l,d);if(v=this.getBaseItemList(k),v&&v.length>0)for(v.unshift(j().BaseItemNext),v.unshift(j().BaseItemPrevious),w=this.oWJ(v,g,h),l=0;l<v.length;l++)A+=this.Ql(v[l],l,w===l);return x=y.indexOf(a)>-1?' <div class="'+t+'">\n                <span>'+j().BaseItemForDialog+'</span>\n                <select class="'+u+' baseFieldItem">'+A+"</select>\n               </div>":"",'<div class="'+m+'">\n                    <div class="'+n+'">\n                        <span>'+(j().ShowValueAs+"("+i(b)+")")+'</span>\n                        <span class="'+(q+" "+p)+'">\xd7</span>\n                    </div>\n                    <div class="'+o+'">\n                        <div>\n                            <span>'+j().CalculationForDialog+"</span>\n                            <span>"+j().showValueAsDialog[a]+'</span>\n                        </div>\n\n                        <div class="'+t+'">\n                            <span>'+j().BaseFieldForDialog+'</span>\n                            <select class="'+u+' baseFieldList">'+z+"</select>\n                        </div>\n                        "+x+'\n                        <div class="show-value-as-dialog-bottom-confirm">\n                            <span class="'+(q+" "+s)+'">'+j().Cancel+'</span>\n                            <span class="'+(r+" "+s)+'">'+j().Ok+"</span>\n                        </div>\n                    </div>\n                </div>"},b.prototype.oWJ=function(a,b,c){var d,f,g=this,h=g.AHJ;if(c===e.PivotShowDataAsBaseItemType.previous)return 0;if(c===e.PivotShowDataAsBaseItemType.next)return 1;if(d=0,!e.Fa(b)||!e.Fa(h))for(f=2;f<a.length;f++){if(b===a[f])return f;a[f]===h&&(d=f)}return d},b.prototype.BPa=function(){var a=this,b=a.xo.width(),c=a.xo.height(),d=a.AWa.width(),e=a.AWa.height();this.xo.css(["position","left","top","z-index"],["absolute",(d-b)/2+"px",(e-c)/2+"px",1001])},b.prototype.hyc=function(){this.Vyc=null},b.prototype.Tla=function(){d.GC$("."+q).unbind("click"),d.GC$("."+r).unbind("click"),d.GC$(v).unbind("change")},b.prototype.WT=function(){this.hyc(),this.Tla(),a.prototype.close.call(this)},b}(d.Go),b.PivotShowValueAsDialog=x},"./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Pivot"),f=c("@grapecity/js-sheets-common"),g="gc-panel-button-delete",h="gc-panel-view-name",i="gc-panel-selected-view",j=f.Common.u.Ob,k=function(a){l(b,a);function b(b,c,d){var e=a.call(this,b,0)||this;return e.views=c,e.currentViewName="",e.width=d,e}return b.prototype.init=function(b){a.prototype.ad.call(this),this.open(b)},b.prototype.open=function(a){var b,c,d,f="<ul>";e.Yxc(this.views.all(),function(a){f+='<li>\n                        <span class="'+h+'">'+j(a.name)+'</span>\n                        <input type="button" class="gc-panel-button '+g+'" value="\xd7"/>\n                    </li>'}),f+="</ul>",b=this.width||250,c='\n                <div class="gc-panel-viewList" style="width: '+b+'px"">\n                    '+f+"\n                </div>\n                ",d=this.Sla(a.x,a.y),d.html(c),this.Ao(),this.QQ()},b.prototype.Sla=function(a,b){var c=this.yo();return c.css(["left","top"],[a,b]),c},b.prototype.Ao=function(){a.prototype.Ao.call(this)},b.prototype.close=function(){this.Tla(),this.hyc(),a.prototype.close.call(this)},b.prototype.hyc=function(){this.qo=null,this.views=null},b.prototype.Do=function(){var a,b,c,e,f,g,h=d.GC$(this.xo.get(0).firstElementChild),i=d.GC$(this.xo);0!==h.length&&(a=h.width(),b=parseInt(i.css("left"),10),isNaN(b)||isNaN(a)||(c=0,e=document.documentElement,f=e.clientWidth,g=h[0].getBoundingClientRect(),g.left+a>f&&(c=g.left+a-f),(b<0||c>0)&&(b-=c,b<0&&(b=0),i.css({left:b+"px"}))))},b.prototype.QQ=function(){var a=this;d.GC$("."+g).bind("click",function(b){var c=b.target.previousElementSibling.textContent,d=b.target.parentElement;a.views.remove(c),d.remove()}),d.GC$("."+h).bind("click",function(b){var c=b.target.textContent;d.GC$("#"+i).val(c),a.close()})},b.prototype.Tla=function(){d.GC$("."+g).unbind("click"),d.GC$("."+h).unbind("click")},b}(d.Go),b.PivotViewListDialog=k},"./dist/plugins/pivot/pivot-util.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),d=c("@grapecity/js-sheets-common"),e=c("Core"),f=c("./dist/plugins/pivot/pivot.ns.js"),g=c("Pivot"),h=c("SheetsCalc"),i=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],j=d.Common.j.Fa,k=d.Common.CultureManager,l=d.Common.l,m=d.Common.D,n=l.Ra,o=new d.Common.ResourceManager(f.SR,"PivotTables"),p=o.getResource.bind(o),b.GC_EMPTY_VALUE="gc-empty-value";function q(a,b,c){var d=a[b];return d&&d.length>0?d[c]:c}b.Kzc=q;function r(a){var b,c,d=Array.isArray(a),e="[object Object]"===Object.prototype.toString.call(a);if(d){for(b=[],c=0;c<a.length;c++)b[c]=r(a[c]);return b}if(e){b=void 0;for(c in a)j(a[c])||(void 0===b&&(b={}),b[c]=r(a[c]));return b}return a}b._AJ=r;function s(a){return j(a)||""===a}b.bJc=s;function t(a,b,c){var d,e={_ps:{}};for(d in a)m(a,d)&&(u(e,d,b,c),e[d]=a[d]);return e}b.Ql=t;function u(a,b,c,d){Object.defineProperty(a,b,{get:function(){var a,d;return"calcItemAggregation"===b?(a=c.Vyc,d=a.FSJ(),d=d?0:1,this._ps[b]=d,d):this._ps[b]},set:function(a){var e,f,g,h=this._ps[b];h!==a&&(c.RVa({pivotTable:this,pn:b,old:h,value:a,type:"options"}),this._ps[b]=a,"calcItemAggregation"===b&&(e=c.Vyc,e.FSJ(a)),"subTotalsPosition"===b&&(f="subtotalsPosition",this._ps[f]=a),"subtotalsPosition"===b&&(f="subTotalsPosition",this._ps[f]=a)),"missingCaption"!==b||j(a)||(g=(a+"").toUpperCase(),"TRUE"!==g&&"FALSE"!==g||(this._ps.missingCaption="'"+a)),"allowMultipleFiltersPerField"===b&&(!!h==!0&&!!a==!1&&c.YIJ(),c.Vyc&&c.Vyc.XIJ(!!a)),"printDrill"!==b&&"itemPrintTitles"!==b&&"fieldPrintTitles"!==b&&"function"==typeof d&&d()},enumerable:!0})}b.nameSeparator="_";function v(a,c){var d,e=a.split(b.nameSeparator);return isNaN(parseInt(e[e.length-1],10))?a+=b.nameSeparator+"1":(d=e[e.length-1],e.splice(e.length-1,1,b.nameSeparator+(parseInt(d,10)+1)),a=e.join("")),c.uAc[a]&&(a=v(a,c)),a}b.iua=v;function w(a,b){var c,d,e,f,g,h,i,j,k,l=[];if(!b)return l;for(c=a.pivotTables.all(),d=0;d<c.length;d++)e=c[d],f=e.getRange(),g=f.page,h=f.content,i=g?g.union(h):h,j=b.row===-1?i.row:i.row-b.row,k=b.col===-1?i.col:i.col-b.col,b.containsRange(i)&&l.push({name:e.Cj,sheetName:a.name(),startPoint:[j,k]});return l}b.uCJ=w;function x(a,b){var c=a.pivotTables.all(),d=[];return g.Yxc(c,function(a){var c,e,f,g,h;a.iT()||(c=a.getRange(),e=c.page,f=c.content,e&&(g=e.intersect(b.row,b.col,b.rowCount,b.colCount),g&&(d[a.Cj]?d[a.Cj].push(b.getIntersect(e,0,0)):d[a.Cj]=[b.getIntersect(e,0,0)])),h=f.intersect(b.row,b.col,b.rowCount,b.colCount),h&&(d[a.Cj]?d[a.Cj].push(b.getIntersect(f,0,0)):d[a.Cj]=[b.getIntersect(f,0,0)]))}),d}b.rHJ=x;function y(a){return[g.PivotShowDataAs.percentOfTotal,g.PivotShowDataAs.percentOfRow,g.PivotShowDataAs.percentOfCol,g.PivotShowDataAs.percent,g.PivotShowDataAs.percentOfParentRow,g.PivotShowDataAs.percentOfParentCol,g.PivotShowDataAs.percentOfParent,g.PivotShowDataAs.percentDiff,g.PivotShowDataAs.percentOfRunningTotal].indexOf(a)>-1}function z(a){var b,c,d;for(b=0,c=i;b<c.length;b++)if(d=c[b],!j(a[d]))return!1;return!0}b.dJJ=z;function A(a,b){
if(j(a)||j(b)||""===b||!a[b])return b;for(var c=2;a[b+c];)c++;return b+c}b.PIJ=A,b.applyShowDataAsStyle=function(a,b,c,d){var f,g={dataOnly:!0,references:[{fieldName:p().Values,items:[b]}]},h=a.getStyle(g);h&&(f=r(h)),f||(f=new e.Style),d?f.formatter=d:y(c)?f.formatter="0.00%":(delete f.formatter,z(f)&&(f=null)),a.setStyle(g,f)},b.GJJ=function(a,b,c){var d,e={dataOnly:!0,references:[{fieldName:p().Values,items:[b]}]},f=a.getStyle(e);f&&(d=r(f)),d&&"0.00%"===d.formatter&&y(c)&&(delete d.formatter,a.setStyle(e,d))};function B(a){var b=k.q4(k.culture()).DateTimeFormat,c=b.shortDatePattern;return 0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()||(c=b.defaultDatePattern),l.Vb(a,c)}b.formatDateToString=B;function C(a){return h.jma(a.split(""),!1)?a:"'"+a.replace(/'/g,"''")+"'"}b.getSheetNameForFormula=C;function D(a){var b,c,d,e;if(!j(a.compareType))return b={filterType:4},b.filter1={},c=a.compareType,d=void 0,e=void 0,6===c?(d=5,e=3,b.and=!0):(d=c,e=c),b.filter1.operator=d,a.item1&&!j(a.item1.expected)&&(b.filter1.value=a.item1.expected),a.item2&&!j(a.item2.expected)&&(b.filter2={},b.filter2.operator=e,b.filter2.value=a.item2.expected),b}function E(a){var b,c,d,e,f,g,h=new Date,i=h.getDay(),j=h.getDate(),k=new Date(h),l=new Date(h);switch(a){case 11:k.setDate(j-6);break;case 9:k.setDate(j-1);break;case 8:break;case 10:k.setDate(j+1);break;case 16:k.setDate(j-i-7),l.setDate(j-i-1);break;case 15:k.setDate(j-i),l.setDate(j-i+6);break;case 17:k.setDate(j-i+7),l.setDate(j-i+13);break;case 13:k.setDate(1),k.setMonth(k.getMonth()-1),l.setDate(0);break;case 12:k.setDate(1),l.setMonth(l.getMonth()+1),l.setDate(0);break;case 14:k.setDate(1),k.setMonth(k.getMonth()+1),l.setMonth(l.getMonth()+2),l.setDate(0);break;case 18:b=k.getMonth()-k.getMonth()%3+1+3,c=b+3+3,k.setDate(1),k.setMonth(b),l.setMonth(c),l.setDate(0);break;case 19:d=k.getMonth()-k.getMonth()%3+1,e=d+3,k.setDate(1),k.setMonth(d),l.setMonth(e),l.setDate(0);break;case 20:f=k.getMonth()-k.getMonth()%3+1-3,g=d+3-3,k.setDate(1),k.setMonth(f),l.setMonth(g),l.setDate(0);break;case 21:k.setDate(1),k.setMonth(1),k.setFullYear(k.getFullYear()+1),l.setFullYear(l.getFullYear()+2),l.setMonth(0),l.setDate(0);break;case 22:k.setDate(1),k.setMonth(1),l.setFullYear(l.getFullYear()+1),l.setMonth(0),l.setDate(0);break;case 23:k.setDate(1),k.setMonth(1),k.setMonth(k.getFullYear()-1),l.setMonth(0),l.setDate(0);break;case 40:k.setMonth(0,1),k.setHours(0,0,0,0),l.setHours(23,59,59,999)}return k.setHours(0),k.setMinutes(0),k.setSeconds(0),l.setHours(23),l.setMinutes(59),l.setSeconds(59),{from:n(k),to:n(l)}}function F(a,b){var c,d,e=j(a.compareType)?a.QBc:a.compareType;if(e>=8&&e<=23||40===e)c={filterType:2,type:b},d=E(e),d.from&&d.to&&(c.value=d.from,c.maxValue=d.to);else if(e>=24&&e<=39)c={filterType:2,type:b};else if(e>=0&&e<=7)return D(a);return c}b.getPivotDateFilter=F,b.PivotComparisonOperators={"-1":"none",0:"equal",4:"lessThan",5:"lessThanOrEqual",1:"notEqual",2:"greaterThan",3:"greaterThanOrEqual"};function G(a){var b,c=a.type;if(!j(c))return b={},c&&"null"!==c?b.type=c:b.type="null",j(a.value)||(b.val=a.value),j(a.maxValue)||(b.maxVal=a.maxValue),b}b.writePivotDynamicFilter=G;function H(a,b){var c,d,e,f,g,h,i,k,l;if(!j(a.filter1)||!j(a.filter2))return c={},c.customFilters={},a.and&&(c.customFilters.and="1"),d=a.filter1,e=a.filter2,h=!j(d),i=!j(e),h&&(k=b[d.operator],f="none"!==k?{operator:k,val:d.value}:{val:d.value}),i&&(l=b[d.operator],g="none"!==l?{operator:l,val:e.value}:{val:e.value}),h&&i?c.customFilters.result.customFilter=[f,g]:h?c.customFilters.result.customFilter=f:i&&(c.customFilters.result.customFilter=g),c}b.writeCustomFilters=H},"./dist/plugins/pivot/pivot.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/pivot/pivot.res.en.js");b.SR={en:d}},"./dist/plugins/pivot/pivot.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.RepeatName="Repeat Name",b.NotExist="Not Exist",b.SubtotalType_Prefix_0="Average of ",b.SubtotalType_Prefix_1="Count of ",b.SubtotalType_Prefix_2="CountNums of ",b.SubtotalType_Prefix_3="Max of ",b.SubtotalType_Prefix_4="Min of ",b.SubtotalType_Prefix_5="Product of ",b.SubtotalType_Prefix_6="StdDev of ",b.SubtotalType_Prefix_7="StdDevp of ",b.SubtotalType_Prefix_8="Sum of ",b.SubtotalType_Prefix_9="Var of ",b.SubtotalType_Prefix_10="Varp of ",b.ColumnLabels="Column Labels",b.Total=" Total",b.All="All",b.MultipleItems="Multiple Items",b.RowLabels="Row Labels",b.GrandTotal="Grand Total",b.Values="Values",b.PivotPanel_Title="PivotTable Fields",b.PivotPanel_ReportText="Choose fields to add to report",b.PivotPanel_SearchPlaceholder="Search",b.PivotPanel_FieldAreaText="Drag fields between areas below:",b.PivotPanel_FiltersItemsTitle="Filters",b.PivotPanel_RowsItemsTitle="Rows",b.PivotPanel_ColumnsItemsTitle="Columns",b.PivotPanel_ValuesItemsTitle="Values",b.PivotPanel_DeferUpdateText="Defer Layout Update",b.EmptyPivotTable_PromptMessage1="Click in this area to work with the PivotTable report",b.EmptyPivotTable_PromptMessage2="Turn on the PivotTable Field List to work with the PivotTable",b.PivotPanel_Update="Update",b.PivotPanel_DropDownList_Up="Move Up",b.PivotPanel_DropDownList_Down="Move Down",b.PivotPanel_DropDownList_Beginning="Move to Beginning",b.PivotPanel_DropDownList_End="Move to End",b.PivotPanel_DropDownList_ReportFilter="Move to Report Filter",b.PivotPanel_DropDownList_Row="Move to Row Labels",b.PivotPanel_DropDownList_Col="Move to Column Labels",b.PivotPanel_DropDownList_Values="Move to Values",b.PivotPanel_DropDownList_Remove="Remove Field",b.PivotPanel_DropDownList_Set="Field Settings...",b.PivotPanel_DropDownList_ValueSet="Value Field Settings...",b.PivotPanel_Fields_MoveTo_ReportField="Add to Report Filter",b.PivotPanel_Fields_MoveTo_RowLabel="Add to Row Labels",b.PivotPanel_Fields_MoveTo_ColLabel="Add to Column Labels",b.PivotPanel_Fields_MoveTo_Value="Add to Values",b.PivotPanel_LabelOrValue_ClearFilter="Clear Filter",b.PivotPanel_ValueFilterOrLabel_Equals="Equals...",b.PivotPanel_ValueFilterOrLabel_NotEqual="Does Not Equal...",b.PivotPanel_ValueFilterOrLabel_GreaterThan="Greater Than...",b.PivotPanel_ValueFilterOrLabel_GreaterOrTo="Greater Than Or Equal To...",b.PivotPanel_ValueFilterOrLabel_LessThan="Less Than...",b.PivotPanel_ValueFilterOrLabel_LessOrTo="Less Than Or Equal To...",b.PivotPanel_ValueFilterOrLabel_Between="Between...",b.PivotPanel_ValueFilterOrLabel_NotBetween="Not Between...",b.PivotPanel_ValueFilter_Top10="Top 10...",b.PivotPanel_ValueFilterOrLabel_IsBeginWith="Begins With...",b.PivotPanel_ValueFilterOrLabel_NotBegin="Does Not Begin With...",b.PivotPanel_ValueFilterOrLabel_End="Ends With...",b.PivotPanel_ValueFilterOrLabel_NotEndWith="Does Not End With...",b.PivotPanel_ValueFilterOrLabel_Contain="Contains...",b.PivotPanel_ValueFilterOrLabel_NotContain="Does Not Contain...",b.ValueFilterOrLabel_Equals="equals",b.ValueFilterOrLabel_NotEqual="does not equal",b.ValueFilterOrLabel_GreaterThan="greater than",b.ValueFilterOrLabel_GreaterOrTo="greater than or equal to",b.ValueFilterOrLabel_LessThan="less than",b.ValueFilterOrLabel_LessOrTo="less than or equal to",b.ValueFilterOrLabel_Between="between",b.ValueFilterOrLabel_NotBetween="not between",b.ValueFilterOrLabelSelect_GreaterThan="is greater than",b.ValueFilterOrLabelSelect_GreaterOrTo="is greater than or equal to",b.ValueFilterOrLabelSelect_LessThan="is less than",b.ValueFilterOrLabelSelect_LessOrTo="is less than or equal to",b.ValueFilterOrLabelSelect_Between="is between",b.ValueFilterOrLabelSelect_NotBetween="is not between",b.ValueFilterOrLabel_IsBeginWith="begins with",b.ValueFilterOrLabel_NotBegin="does not begin with",b.ValueFilterOrLabel_End="ends with",b.ValueFilterOrLabel_NotEndWith="does not end with",b.ValueFilterOrLabel_Contain="contains",b.ValueFilterOrLabel_NotContain="does not contain",b.PivotPanel_ValueFilterOrLabel_Before="Before...",b.PivotPanel_ValueFilterOrLabel_After="After...",b.PivotPanel_ValueFilterOrLabel_Tomorrow="Tomorrow",b.PivotPanel_ValueFilterOrLabel_Today="Today",b.PivotPanel_ValueFilterOrLabel_Yesterday="Yesterday",b.PivotPanel_ValueFilterOrLabel_NextWeek="Next Week",b.PivotPanel_ValueFilterOrLabel_ThisWeek="This Week",b.PivotPanel_ValueFilterOrLabel_LastWeek="Last Week",b.PivotPanel_ValueFilterOrLabel_NextMonth="Next Month",b.PivotPanel_ValueFilterOrLabel_ThisMonth="This Month",b.PivotPanel_ValueFilterOrLabel_LastMonth="Last Month",b.PivotPanel_ValueFilterOrLabel_NextQuarter="Next Quarter",b.PivotPanel_ValueFilterOrLabel_ThisQuarter="This Quarter",b.PivotPanel_ValueFilterOrLabel_LastQuarter="Last Quarter",b.PivotPanel_ValueFilterOrLabel_NextYear="Next Year",b.PivotPanel_ValueFilterOrLabel_ThisYear="This Year",b.PivotPanel_ValueFilterOrLabel_LastYear="Last Year",b.PivotPanel_ValueFilterOrLabel_YearToDate="Year to Date",b.PivotPanel_ValueFilterOrLabel_MonthToDate="Month to Date",b.PivotPanel_ValueFilterOrLabel_QuarterToDate="Quarter to Date",b.PivotPanel_ValueFilterOrLabel_ParallelYearToDate="Parallel Year to Date",b.PivotPanel_ValueFilterOrLabel_ParallelMonthToDate="Parallel Month to Date",b.PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate="Parallel Quarter to Date",b.PivotPanel_ValueFilterOrLabel_AllDates="All Dates in Period",b.PivotPanel_ValueFilterOrLabel_Custom="Custom Filter...",b.PivotPanel_Sort_A_Z="Sort A to Z",b.PivotPanel_Sort_Z_A="Sort Z to A",b.PivotPanel_Sort_Smallest_Largest="Sort Smallest to Largest",b.PivotPanel_Sort_Largest_Smallest="Sort Largest to Smallest",b.PivotPanel_Sort_More="More Sort Options...",b.PivotPanel_Filter_Clear="Clear Filter From {0}",b.PivotPanel_Filter_Label="Label Filters",b.PivotPanel_Filter_Value="Value Filters",b.PivotPanel_Date_Filter="Date Filters",b.Ok="OK",b.Cancel="Cancel",b.NumberFormat="Number Format",b.LabelFormat="Label Format",b.Number="Number",b.FormatCells="Format Cells",b.Sample="Sample",b.Type="Type",b.CustomFormats=["General","0","0.00","#,##0","#,##0.00","#,##0;(#,##0)","#,##0;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)","$#,##0;($#,##0)","$#,##0;[Red]($#,##0)","$#,##0.00;($#,##0.00)","$#,##0.00;[Red]($#,##0.00)","0%","0.00%","0.00E+00","##0.0E+0","# ?/?","# ??/??","m/d/yyyy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","hh:mm","hh:mm:ss","m/d/yyyy hh:mm","mm:ss","mm:ss.0","@","[h]:mm:ss",'$ #,##0;$ (#,##0);$ "-";@',' #,##0; (#,##0); "-";@','$ #,##0.00;$ (#,##0.00);$ "-"??;@',' #,##0.00; (#,##0.00); "-"??;@',"hh:mm:ss","00000","# ???/???","000-00-0000","dddd, mmmm dd, yyyy","m/d;@","[<=9999999]###-####;(###) ###-####","# ?/8"],b.Select_Field="Select field",b.PivotPanel_Filter_SelectAll="Check All",b.PivotPanel_Filter_NoSelectAll="Uncheck All",b.PivotPanel_Filter_Search="search",b.Label_Title="Label Filter",b.Label_Show="Show items for which the label",b.Use_Single_Character="Use ? to represent any single character",b.Use_Series_Characters="Use * to represent any series characters",b.Value_Show="Show items for which",b.Value_Title="Value Filter",b.Top_Ten_Filter="Top 10 Filter ",b.TopTenShow="show",b.Top="Top",b.Bottom="Bottom",b.Top_Item="Items",b.Top_Percent="Percent",b.Top_Sum="Sum",b.ByJoiner="by",b.AndJoiner="and",b.Q1="Quarter 1",b.Q2="Quarter 2",b.Q3="Quarter 3",b.Q4="Quarter 4",b.Jan="January",b.Feb="February",b.Mar="March",b.Apr="April",b.May="May",b.Jun="June",b.Jul="July",b.Aug="August",b.Sep="September",b.Oct="October",b.Nov="November",b.Dec="December",b.IsBefore="is before",b.IsBeforeOrEqual="is before or equal to",b.IsAfter="is after",b.IsAfterOrEqual="is after or equal to",b.IsBetween="is between",b.IsNotBetween="is not between",b.DateFilterTitle="Date Filter",b.DateShow="Show items for which the date",b.WholeDays="Whole Days",b.wmk1="4164642d6f6e73204e6f7420456e61626c65643a205069766f745461626c65",b.wmk2="4164642d6f6e7320456e61626c65643a205069766f745461626c65",b.FieldSetting="Field Settings",b.ValueSetting="Value Field Settings",b.SourceName="Source Name:",b.CustomName="Custom Name:",b.SummarizeValue="Summarize Values By",b.ShowValueAs="Show Value As",b.CalculationForDialog="Calculation: ",b.BaseFieldForDialog="Base Field: ",b.BaseItemForDialog="Base Item: ",b.BaseItemNext="(next)",b.BaseItemPrevious="(previous)",b.SummarizeValueField="Summarize values field by",b.ShowValueAsField="Show value as",b.ChooseType="Choose the type of calculation that you want to use to summarize data from the selected field",b.Sum="Sum",b.Count="Count",b.Average="Average",b.Max="Max",b.Min="Min",b.Product="Product",b.CountNumbers="Count Numbers",b.StdDev="StdDev",b.StdDevp="StdDevp",b.Var="Var",b.Varp="Varp",b.sigmaValue="\u2211 Values",b.sigmaValueTemp="Values";b.DateFormatError="This isn't a valid date";b.noCalculation="No Calculation",b.percentGrandTotal="% of Grand Total",b.percentColumnTotal="% of Column Total",b.percentRowTotal="% of Row Total",b.percentEllipsis="% Of ...",b.percentParentRowTotal="% of Parent Row Total",b.percentParentColumnTotal="% of Parent Column Total",b.percentParentTotal="% of Parent Total ...",b.difference="Difference From ...",b.percentDifference="% Difference From ...",b.runningTotal="Running Total In ...",b.percentRunningTotal="% Running Total In ...",b.rankSmallestLargest="Rank Smallest to Largest ...",b.rankLargestSmallest="Rank Largest to Smallest ...",b.index="Index",b.showValueAsDialog=["","","","","% Of ","","","% of Parent Total ","Difference From ","% Difference From ","Running Total In ","% Running Total In ","Rank Smallest to Largest ","Rank Largest to Smallest ",""],b.baseField="Base field:",b.baseItem="Base item:",b.grouping="Grouping",b.auto="Auto",b.startingAt="Starting at:",b.endingAt="Ending at:",b.groupBy="By:",b.seconds="Seconds",b.minutes="Minutes",b.hours="Hours",b.days="Days",b.months="Months",b.quarters="Quarters",b.years="Years",b.numberOfDays="Number of days",b.NoHaveSpread="workbook exception",b.SourceError="Source data exception, cannot create PivotTable report",b.SourceNotIsTableNameOrFormula="source data not is table name and formula",b.SourceDataOnlyOne="This command requires at least two rows of source data. You cannot use the command on a selection in only row",b.FieldAreaLimited="The field you are moving cannot be placed in that area of the report.",b.Views="Views",b.Group="Group",b.param_error="the param is null or undefine",b.EmptyValueFieldError="You need at least one field in the Values area in order to apply a value filter",b.DefaultPivotTableViewName="PivotView",b.toolTipContent_Row="Row: ",b.toolTipContent_Column="Column: ",b.toolTipContent_Value="Value: ",b.toolTipContent_NoValue="No value",b.deferLayoutUpdate="Defer Layout Update";function d(){return[b.ValueFilterOrLabel_Equals,b.ValueFilterOrLabel_NotEqual,b.ValueFilterOrLabel_IsBeginWith,b.ValueFilterOrLabel_NotBegin,b.ValueFilterOrLabel_End,b.ValueFilterOrLabel_NotEndWith,b.ValueFilterOrLabel_Contain,b.ValueFilterOrLabel_NotContain,b.ValueFilterOrLabelSelect_GreaterThan,b.ValueFilterOrLabelSelect_GreaterOrTo,b.ValueFilterOrLabelSelect_LessThan,b.ValueFilterOrLabelSelect_LessOrTo,b.ValueFilterOrLabelSelect_Between,b.ValueFilterOrLabelSelect_NotBetween]}b.getStringLabelFilterItemText=d;function e(){return[b.ValueFilterOrLabel_Equals,b.ValueFilterOrLabel_NotEqual,b.IsBefore,b.IsBeforeOrEqual,b.IsAfter,b.IsAfterOrEqual,b.IsBetween,b.IsNotBetween]}b.getDateLabelFilterItemText=e;function f(){return[b.ValueFilterOrLabel_Equals,b.ValueFilterOrLabel_NotEqual,b.ValueFilterOrLabelSelect_GreaterThan,b.ValueFilterOrLabelSelect_GreaterOrTo,b.ValueFilterOrLabelSelect_LessThan,b.ValueFilterOrLabelSelect_LessOrTo,b.ValueFilterOrLabelSelect_Between,b.ValueFilterOrLabelSelect_NotBetween]}b.getValueFilterItemText=f,b.PivotTableErrorMessage_ShowDetail="Cannot show or hide detail for this selection",b.PivotTableErrorMessage_MakeChange="We can't make this change for the selected cells because it will affect a PivotTable. Use the field list to change the report. If you are trying to insert or delete cells, move the PivotTable and try again.",b.PivotTableErrorMessage_ExistData="There's already data in {}. Do you want to replace it?",b.PivotTableErrorMessage_EditWhenDefer="The PivotTable report cannot be edited with the Defer Layout Update check box selected. To edit the report, clear the Defer Layout Update check box at the bottom of the PivotTable Field List.",b.PivotTableErrorMessage_DuplicatedFieldName="PivotTable field name already exists.",b.PivotTableErrorMessage_EmptyFieldName="Cannot enter a null value as an item or field name in a PivotTable report.",b.PivotTableErrorMessage_Protect="That command cannot be performed while a protected sheet contains another PivotTable report based on the same source data. To remove protection from the sheet that has the other report, click the sheet tab, and then click Unprotect Sheet(Review tab, Changes group). Then try the command again.",b.PivotTableErrorMessage_EmptySourceFieldName="The PivotTable field name is not valid. To create a PivotTable report, you must use data that is organized as a list with labeled columns. If you are changing the name of a PivotTable field, you must type a new name for the field.",b.PivotTableErrorMessage_Overlap="A PivotTable report cannot overlap another PivotTable report.",b.PivotTableErrorMessage_InvalidChange="We can't change this part of the PivotTable.",b.PivotTableErrorMessage_InvalidGroup="Cannot group that selection.",b.PivotTableErrorMessage_InvalidReference="Reference isn't valid.",b.PivotTableForAccessibility="PivotTable: \r\nPivotTable Name: ",b.PivotTableCalcItemHasTowCacheField="If one or more fields in the PivotTable have calculated items, no fields can be used in the data area two or more times, or in the data area and another area at the same time. If you are trying to add a field, remove the calculated items and add the field again. If you are trying to add a calculated item, change the PivotTable report so that no field is used more than once and then add the calculated item.",b.PivotTableHasNumberOrDateGroup="This PivotTable report field is grouped, You cannot add a calculated item to a grouped field. To ungroup the field, make sure it is in the row or column area, select one of the items of the grouped field, click the Ungroup button in the Group group on the Analyze tab, and then insert the calculated item. After inserted, you can group the items of the field again.",b.PivotTableSubtotalType="Averages, standard deviations, and variances are not supported when a PivotTable report has calculated items.",b.PivotTableHasSameItemName="Calculated item or field could not be created because another item or field of the same name exists.",b.PivotTableCalcItemHasMultipleDataField="Multiple data Fields of the same field are not supported when a PivotTable report has calculated items.",b.PivotTableMoveCalcItemFieldToReport="This field cannot be placed in the report filter because it contains calculated items.To place this field in the report filter,first delete the calculated items.",b.PivotTableErrorFormula="An item name cannot be found. Check that you've typed the name correctly and the item is present in the PivotTable report.",b.SlicerNameInFormula="Slicer",b.search="Search",b.AddSearchResult="Add current selection to filter",b.Layout="Layout",b.showNoData="Show items with no data",b.TIMELINE_PLACE_HOLDER="{TL}",b.ALL_DATES_IN="All dates in ",b.ALL_PERIODS="All Periods",b.INVALID_DATE_SELECTION="Invalid Date Selection!",b.QUARTER_MAP=["","Q1","Q2","Q3","Q4"],b.DateNotEqual="Not "+b.TIMELINE_PLACE_HOLDER,b.DateNewerThan="After "+b.TIMELINE_PLACE_HOLDER,b.DateNewerThanOrEqual="After or on "+b.TIMELINE_PLACE_HOLDER,b.DateOlderThan="Before "+b.TIMELINE_PLACE_HOLDER,b.DateOlderThanOrEqual="Before or on"+b.TIMELINE_PLACE_HOLDER,b.DateNotBetween="Not Between "+b.TIMELINE_PLACE_HOLDER,b.AllDatesIn_Quarter1=b.ALL_DATES_IN+b.QUARTER_MAP[1],b.AllDatesIn_Quarter2=b.ALL_DATES_IN+b.QUARTER_MAP[2],b.AllDatesIn_Quarter3=b.ALL_DATES_IN+b.QUARTER_MAP[3],b.AllDatesIn_Quarter4=b.ALL_DATES_IN+b.QUARTER_MAP[4],b.AllDatesIn_January=b.ALL_DATES_IN+b.Jan,b.AllDatesIn_February=b.ALL_DATES_IN+b.Feb,b.AllDatesIn_March=b.ALL_DATES_IN+b.Mar,b.AllDatesIn_April=b.ALL_DATES_IN+b.Apr,b.AllDatesIn_May=b.ALL_DATES_IN+b.May,b.AllDatesIn_June=b.ALL_DATES_IN+b.Jun,b.AllDatesIn_July=b.ALL_DATES_IN+b.Jul,b.AllDatesIn_August=b.ALL_DATES_IN+b.Aug,b.AllDatesIn_September=b.ALL_DATES_IN+b.Sep,b.AllDatesIn_October=b.ALL_DATES_IN+b.Oct,b.AllDatesIn_November=b.ALL_DATES_IN+b.Nov,b.AllDatesIn_December=b.ALL_DATES_IN+b.Dec,b.TIME_LEVEL_YEARS="YEARS",b.TIME_LEVEL_QUARTERS="QUARTERS",b.TIME_LEVEL_MONTHS="MONTHS",b.TIME_LEVEL_DAYS="DAYS",b.PivotTableErrorMessage_ExistTable="A PivotTable report cannot overlap a table."},"./dist/plugins/pivot/sheet-range-to-pivot-area.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("@grapecity/js-sheets-common"),f=c("Pivot"),g=c("SheetsCalc"),h=c("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),i=c("./dist/plugins/pivot/pivot-util.js"),j=c("./dist/plugins/pivot/pivot.ns.js"),k=new e.Common.ResourceManager(j.SR,"PivotTables"),l=k.getResource.bind(k),m="__RangeFormula__",n="__FieldName__",o="__ColInfo__",p="__RowInfo__",q="__Values__",r="__TopRight__",s=null,t=[{row:-1,rowCount:1,colCount:1},{}],u=[{type:h.PivotAreaType.button,labelOnly:!0,fieldName:n},{type:h.PivotAreaType.corner,labelOnly:!0}],v=[{row:0,col:r,rowCount:1,colCount:1},{colCount:1,needGrandCol:!0,nullValue:!1},{row:0,rowCount:1,colCount:1,nullValue:!1},{rowCount:1,nullValue:!1}],w=[{labelOnly:!0,type:h.PivotAreaType.topRight},{labelOnly:!0,grandCol:!0},{type:h.PivotAreaType.button,labelOnly:!0,fieldName:n},{labelOnly:!0,references:o}],x=[{rowCount:1,needGrandRow:!0,nullValue:!1},{colCount:1,nullValue:!1}],y=[{labelOnly:!0,grandRow:!0},{labelOnly:!0,references:p}],z=[{rowCount:1,colCount:1,row:0,col:0,nullInfo:!0},{nullValue:!1,needGrandRow:!0,needGrandCol:!0},{nullValue:!1,rowCount:1,needGrandRow:!0},{nullValue:!1,colCount:1,needGrandCol:!0},{}],A=[{dataOnly:!0,references:q},{grandRow:!0,grandCol:!0,references:p+o},{grandRow:!0,references:p+o},{grandCol:!0,references:p+o},{references:p+o}];function C(a,b,c){return a.getPivotInfoImp(b,c)}function D(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(a&&b){for(c=b.row,d=b.col,e=b.rowCount,f=b.colCount,g=C(a,c,d),h=C(a,c+e-1,d+f-1),i=g.area,j=h.area,k=N(i,j),l=[],k.indexOf(0)!==-1&&(m=O(0,a),n=b.getIntersect(m,0,0),l=I(a,n)),o=1;o<5;o++)k.indexOf(o)!==-1&&(m=O(o,a),n=b.getIntersect(m,0,0),p=[],n&&E(n,n.row,n.col,a,p,a.ys.szc[o]),l=l.concat(H(p,o,a)));return l}}b.rangeToAreas=D;function E(a,b,c,e,f,g){var h,i,j=b,k=c,l=C(e,b,c),m=F(l),n=g.ILa;if(1===n||2===n&&0===l.relativeRow)(1===n&&!l.cornerFieldInfo||2===n&&!l.colHeadFieldInfo)&&(k=a.col+a.colCount-1,1===n&&b===a.row&&(j=a.row+a.rowCount-(1===a.rowCount?1:2)));else{for(i=c+1;i<c+a.colCount;i++){if(h=l,l=C(e,j,i),G(h,l,j,i,a,m,g,!1)){k=i-1;break}i===c+a.colCount-1&&(k=i)}for(i=b+1;i<b+a.rowCount;i++){if(l&&(h=l),l=C(e,i,k),G(h,l,i,k,a,m,g,!0)){j=i-1;break}i===b+a.rowCount-1&&(j=i)}}f.push(new d.Range(b,c,j-b+1,k-c+1)),j===a.row+a.rowCount-1&&k===a.col+a.colCount-1||(k===a.col+a.colCount-1?E(a,j+1,a.col,e,f,g):E(a,b,k+1,e,f,g))}!function(a){a[a.none=0]="none",a[a.row=1]="row",a[a.col=2]="col"}(B||(B={}));function F(a,b,c){var d,e=a.rowInfos,f=a.colInfos,g=B.none;if(e&&!c)for(d=0;d<e.length;d++)(e[d].isSubtotal||e[d].isGrandTotal)&&(g+=B.row);if(f&&!b)for(d=0;d<f.length;d++)(f[d].isSubtotal||f[d].isGrandTotal)&&(g+=B.col);return g}function G(a,b,c,d,e,f,g,h){var i,j,k,l,m,n=g.ILa;if(c>e.row+e.rowCount-1||d>e.col+e.colCount-1)return!0;if(a&&b)if(h){if(3===g.ILa){if(i=g.lzc,i&&(j=i[a.relativeRow],k=i[b.relativeRow],j&&k&&j.aN!==k.aN))return!0}else if(a.rowInfos&&b.rowInfos&&a.rowInfos.length!==b.rowInfos.length)return!0}else if(a.colInfos&&b.colInfos&&a.colInfos.length!==b.colInfos.length)return!0;if(4===n&&f){if(h&&f===B.col&&F(b,!0))return!0;if(!h&&f===B.row&&F(b,void 0,!0))return!0}else if(F(b))return!0;if(3===n&&!f&&!h)return!0;if(2===n&&!f&&h)return!0;if(f)if(3===n&&h){if(l=g.lzc[b.relativeRow],m=g.lzc[b.relativeRow-1],l.path!==m.path)return!0}else if(2!==n||h){if(4===n&&(f&B.row&&h||f&B.col&&!h))return!0}else if(l=g.mzc[b.relativeColumn],m=g.mzc[b.relativeColumn-1],l.path!==m.path)return!0;return!1}function H(a,b,c){switch(b){case 1:return J(c,a);case 2:return K(c,a);case 3:return L(c,a);case 4:return M(c,a)}}function I(a,b){var c,d,e,f=[];for(c=b.row;c<b.row+b.rowCount;c++)for(d=b.col;d<b.col+b.colCount;d++)e=C(a,c,d),e.relativeColumn%3===1?f.push({labelOnly:!0,references:[{fieldName:e.pageFieldInfo.fieldName}]}):e.relativeColumn%3===0&&f.push({labelOnly:!0,type:h.PivotAreaType.button,fieldName:e.pageFieldInfo.fieldName});return f}function J(a,b){var c=[],d=a.ys.szc[1].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.Yxc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=P(t,u,k,b,d,a,1);l!==s&&c.push(l)}),c}function K(a,b){var c=[],d=a.ys.szc[2].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.Yxc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=P(v,w,k,b,d,a,2);l!==s&&c.push(l)}),c}function L(a,b){var c=[],d=a.ys.szc[3].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.Yxc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=P(x,y,k,b,d,a,3);l!==s&&c.push(l)}),c}function M(a,b){var c=[],d=a.ys.szc[4].getRange(),e=a.getRange().content,g=e.row,h=e.col;return f.Yxc(b,function(b){var e=b.row,f=b.col,i=b.rowCount,j=b.colCount,k={row:e-d.row-g,col:f-d.col-h,rowCount:i,colCount:j},l=P(z,A,k,b,d,a,3);l!==s&&c.push(l)}),c}function N(a,b){if(0===b)return[0];if(1===b)return[1];if(3===b)return 1===a?[1,3]:[3];if(2===b)return 1===a?[1,2]:[2];if(4===b){if(1===a)return[1,2,3,4];if(2===a)return[2,4];if(3===a)return[3,4];if(4===a)return[4]}}function O(a,b){var c,d;return b.iT()||f.Fa(a)?s:0===a?b.getRange().page:(c=b.ys.szc,d=c[a].getRange(),d.row+=b.rAc.row,d.col+=b.rAc.col,d)}function P(a,b,c,d,e,f,g){var h,i,j;for(h=0;h<a.length;h++)if(i=Q(a[h],e,f),j=C(f,d.row,d.col),X(i,c,j,f))return S(b[h],c,d,j,f,g);return s}function Q(a,b,c){var d=i._AJ(a)||{};return a.row===-1&&(d.row=b.rowCount-1),a.col===-1&&(d.col=b.colCount-1),a.col===r&&(d.col=c.ys.szc[2].kzc.length),d}function R(a){return a===l().sigmaValue?l().Values:a}function S(a,b,c,d,e,f){var h,j=i._AJ(a)||{};if(a.offset===m&&(j.offset=g.rangeToFormula(b,0,0,g.RangeReferenceRelative.allRelative,!1)),a.fieldName===n){if(h=T(d,c,f),!h)return s;j.fieldName=R(h)}return a.references===o&&(j.references=U(c,e)),a.references===p&&(j.references=V(c,e)),a.references===p+o&&(j.references=W(c,e)),a.references===q&&(j.references=[{fieldName:l().Values}]),j}function T(a,b,c){var d;switch(c){case 1:return d=a.cornerFieldInfo,d.fieldName||s;case 2:if(d=a.colHeadFieldInfo)return d.fieldName;d=a.activeColFieldInfo;break;case 3:d=a.activeRowFieldInfo}return d?d.name:s}function U(a,b){var c,d,e=[],g=a.row,h=function(c){var d,h=C(b,g,c);return h.value===s?"break":(d=h.colInfos,void(d&&f.Yxc(d,function(b,f){if(c===a.col){var g={fieldName:R(b.fieldName),items:[b.itemName]};b.isSubtotal&&(g.subtotal=!0),e[f]=g}else f===d.length-1&&e[f].items.push(b.itemName)})))};for(c=a.col;c<a.col+a.colCount&&(d=h(c),"break"!==d);c++);return e}function V(a,b){var c,d,e=[],g=a.col,h=function(c){var d,h=C(b,c,g);return h.value===s?"break":(d=h.rowInfos,void(d&&f.Yxc(d,function(b,f){if(c===a.row){var g={fieldName:R(b.fieldName),items:[b.itemName]};b.isSubtotal&&(g.subtotal=!0),e[f]=g}else f===d.length-1&&e[f].items.push(b.itemName)})))};for(c=a.row;c<a.row+a.rowCount&&(d=h(c),"break"!==d);c++);return e}function W(a,b){var c,d,e=[],g=[],h=a.row,i=a.col,j=function(c){var d,g=C(b,c,i),h=g.rowInfos;h&&(d=0,f.Yxc(h,function(b){if(c===a.row){if(b.fieldName&&b.itemName){var g={fieldName:R(b.fieldName),items:[b.itemName]};b.isSubtotal&&(g.subtotal=!0),e[d]&&(d+=1),e[d]=g}}else d!==h.length-1||f.Fa(b.itemName)||(e[d].items?e[d].items.push(b.itemName):e[d].items=[b.itemName]),d+=1}))};for(c=a.row;c<a.row+a.rowCount;c++)j(c);for(d=function(c){var d,e=C(b,h,c),i=e.colInfos;i&&(d=0,f.Yxc(i,function(b){if(c===a.col){if(b.fieldName&&b.itemName){var e={fieldName:R(b.fieldName),items:[b.itemName]};b.isSubtotal&&(e.subtotal=!0),g[d]&&(d+=1),g[d]=e}}else d!==i.length-1||f.Fa(b.itemName)||(g[d].items?g[d].items.push(b.itemName):g[d].items=[b.itemName]),d+=1}))},c=a.col;c<a.col+a.colCount;c++)d(c);return e.concat(g)}function X(a,b,c,d){var e=a.row,f=a.col,g=a.rowCount,h=a.colCount,i=a.nullValue;if(void 0!==a.nullInfo){if(c.rowInfos&&c.rowInfos.length>0)return!1;if(c.colInfos&&c.colInfos.length>0)return!1}return(void 0===e||b.row===e)&&((void 0===f||b.col===f)&&((void 0===g||b.rowCount===g)&&((void 0===h||b.colCount===h)&&((void 0===i||!(i&&c.value!==s||!i&&c.value===s))&&(!(a.needGrandCol&&!Y(c,!1,!0))&&!(a.needGrandRow&&!Y(c,!0,!1)))))))}function Y(a,b,c){var d=a.rowInfos,e=a.colInfos,g=!1;return b&&d&&d.length>0&&f.Yxc(d,function(a){a.isGrandTotal&&(g=!0)}),c&&e&&e.length>0&&f.Yxc(e,function(a){a.isGrandTotal&&(g=!0)}),g}},"./node_modules_local/@grapecity/js-pivot/dist/gc.pivot.js":function(a,b,c){var d,e,f="object"==typeof f?f:{};f.Pivot=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s="./pivot-entry.ts")}({"./pivot-entry.ts":function(a,b,c){"use strict";var d,e;function f(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivotEngine.res.en.ts"),b.SR={en:d.resource},f(c("./src/pivot-interface.ts")),f(c("./src/pivot-util.ts")),f(c("./src/pivot-condition.ts")),f(c("./src/pivot-cache.ts")),f(c("./src/data-analyzer.ts")),f(c("./src/pivot-engine.ts")),f(c("./src/pivot-calc-engine.ts")),e=c("./src/pivot-sort.ts"),b.ZGJ=e.ZGJ},"./src/data-analyzer.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=this&&this.__assign||function(){return H=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},H.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivot-interface.ts"),e=c("./src/pivot-util.ts"),f=c("CalcEngine"),g=c("Common"),h=c("./src/pivot-cache.ts"),i=null,j=Math.min,k=Math.max,l=Math.sqrt,m=isNaN,b.Separator="-&-",b.EmptyValue=f.Errors.Null,n="gc-empty-value",o=[0,1,32,61,92,122,153,183,214,245,275,306,336,367,368],b.ErrorsMap={100:f.Errors.Calc,7:f.Errors.DivideByZero,29:f.Errors.Name,42:f.Errors.NotAvailable,0:f.Errors.Null,36:f.Errors.Number,23:f.Errors.Reference,99:f.Errors.Spill,15:f.Errors.Value},p=14;function I(a,b,c){if(e.Fa(a)&&e.Fa(b))return i;if(e.Fa(a))return b;if(e.Fa(b)&&4!==c)return a;if(a instanceof f.CalcError)return a;if(b instanceof f.CalcError)return b;switch(c){case 0:return g.Common.o.Lma(a+b,p);case 1:return g.Common.o.Lma(a-b,p);case 2:if(0===a||0===b)return 0;
var d=a*b;return 0*d!==0?f.Errors.Number:d;case 3:return 0===b?f.Errors.DivideByZero:a/b;case 5:return k(a,b);case 6:return j(a,b);case 4:return l(a)}}b.$Ac=function(a,b){var c,d,f,g,h,i,j,k=b.calc;!e.Fa(a)&&e.Da(a)?(c=k.count,d=k.sum,f=k.max,g=k.min,h=k.sumx2,i=k.product,j=k.len,c=I(c,1,0),d=I(d,a,0),f=I(f,a,5),g=I(g,a,6),h=I(h,I(a,a,2),0),i=I(i,a,2),j=I(j,1,0),b.calc={count:c,sum:d,max:f,min:g,sumx2:h,product:i,len:j}):b.calc.len=I(b.calc.len,1,0)},b.uWJ=function(){return{calc:{len:i,count:i,sum:i,max:i,min:i,sumx2:i,product:i}}},b._Ac=function(a){return e.Fa(a)?{calc:{len:1,sum:0,count:0,max:-(1/0),min:1/0,sumx2:0,product:1}}:e.Da(a)?{calc:{len:1,count:1,sum:a,max:a,min:a,sumx2:a*a,product:a}}:a instanceof f.CalcError?{calc:{len:1,count:0,sum:a,max:a,min:a,sumx2:a,product:a}}:{calc:{len:1,count:0,sum:0,max:0,min:0,sumx2:0,product:0}}},q=function(a,b){var c=b.calc,d=c.sum,e=c.count,f=c.max,g=c.min,h=c.sumx2,i=c.product,j=c.len;return a({sum:d,count:e,max:f,min:g,sumx2:h,product:i,len:j})},b.aBc=function(a){switch(a){case d.SubtotalType.average:return function(a){var b=a.sum,c=a.count;return b instanceof f.CalcError?b:I(b,c,3)};case d.SubtotalType.count:return function(a){var b=a.len;return b};case d.SubtotalType.countNums:return function(a){var b=a.count;return b};case d.SubtotalType.max:return function(a){var b=a.max;return b};case d.SubtotalType.min:return function(a){var b=a.min;return b};case d.SubtotalType.product:return function(a){var b=a.product;return b};case d.SubtotalType.stdDev:return function(a){var b,c,d,f=a.count,g=a.sumx2,h=a.sum;return e.Fa(f)||0===f?null:(b=I(I(f,g,2),I(h,h,2),1),c=I(f,I(f,1,1),2),d=I(0,I(b,c,3),5),I(d,null,4))};case d.SubtotalType.stdDevp:return function(a){var b=a.count,c=a.sumx2,d=a.sum,e=I(I(b,c,2),I(d,d,2),1),f=I(b,b,2),g=I(0,I(e,f,3),5);return I(g,null,4)};case d.SubtotalType.sum:return function(a){return a&&a.sum};case d.SubtotalType.varr:return function(a){var b,c,d=a.count,f=a.sumx2,g=a.sum;return e.Fa(d)||0===d?null:(b=I(I(d,f,2),I(g,g,2),1),c=I(d,I(d,1,1),2),I(0,I(b,c,3),5))};case d.SubtotalType.varp:return function(a){var b,c,d=a.count,f=a.sumx2,g=a.sum;return e.Fa(d)||0===d?null:(b=I(I(d,f,2),I(g,g,2),1),c=I(d,d,2),I(0,I(b,c,3),5))}}},r=function(a,b){return b(a)},s=function(a,b,c,f,g,h){var i,j,k=a.showDataAs,l=h.baseMinorPath,m=h.baseMajorPath,n=h.percentOfBasePath,o=h.baseIndex;switch(k){case d.PivotShowDataAs.normal:return{baseIndex:-1};case d.PivotShowDataAs.percentOfTotal:return{baseIndex:c.PFJ};case d.PivotShowDataAs.percentOfRow:return b.Yzc?{baseIndex:c.PFJ}:{baseIndex:c.HFJ(b.EFJ,!1)};case d.PivotShowDataAs.percentOfCol:return b.Yzc?{baseIndex:c.PFJ}:{baseIndex:c.HFJ(b.IFJ,!0)};case d.PivotShowDataAs.percent:case d.PivotShowDataAs.difference:case d.PivotShowDataAs.percentDiff:return{baseMinorPath:l,baseMajorPath:m};case d.PivotShowDataAs.percentOfParentRow:return{parentPath:g,minorPath:b.IFJ};case d.PivotShowDataAs.percentOfParentCol:return{baseIndex:b.aN>f?b.QFJ:b.GFJ};case d.PivotShowDataAs.percentOfParent:return a.baseRootLevel>-1?{percentOfBasePath:n,minorPath:b.IFJ}:{baseIndex:o,percentOfBasePath:n};case d.PivotShowDataAs.runTotal:case d.PivotShowDataAs.percentOfRunningTotal:case d.PivotShowDataAs.rankAscending:case d.PivotShowDataAs.rankDescending:return{baseMinorPath:l,baseMajorPath:m};case d.PivotShowDataAs.index:return i=void 0,j=void 0,b.Yzc?(i=c.PFJ,j=c.PFJ):(i=c.HFJ(b.EFJ,!1),j=c.HFJ(b.IFJ,!0),e.Fa(i)&&(i=c.PFJ),e.Fa(j)&&(j=c.PFJ)),{rowTotalIndex:i,colTotalIndex:j}}},t=function(a,c,g,h,i,j,k){var l,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,K,L,M,N,O,P,Q,R,S,T,U,V,W,X=i.indexInfo,Y=a.zFJ[k];if(X&&(l=X.baseIndex,o=X.parentPath,p=X.minorPath,q=X.rowTotalIndex,r=X.colTotalIndex,s=X.baseMinorPath,t=X.baseMajorPath,u=X.percentOfBasePath,v=!1,Y))switch(w=Y.showDataAs,x=void 0,y=void 0,w){case d.PivotShowDataAs.normal:return a.RFJ(g,c,h);case d.PivotShowDataAs.percentOfTotal:return x=a.RFJ(g,c,h),y=a.RFJ(a.PFJ,c,h),m(+x)?x:m(+y)?y:0===y?f.Errors.DivideByZero:x/y;case d.PivotShowDataAs.percentOfRow:case d.PivotShowDataAs.percentOfCol:return x=a.RFJ(g,c,h),y=a.RFJ(l,c,h),e.Fa(x)&&(x=0),e.Fa(y)||0===y?f.Errors.DivideByZero:m(+x)?x:m(+y)?y:x/y;case d.PivotShowDataAs.percentOfParentCol:return x=a.RFJ(g,c,h),y=a.RFJ(l,c,h),m(+x)?f.Errors.Value:m(+y)?y:0===y?f.Errors.DivideByZero:x/y;case d.PivotShowDataAs.percent:return e.Fa(a.kGJ[a.zFJ[k].baseFieldName])?f.Errors.NotAvailable:(z=void 0,A=!0,B=!0,Y.baseRootLevel>j?n:(C=a.DFJ(s))?0===C.level&&Y.isHeaderOfPercentOrDiff?n:(z=C.indexList[t],x=a.RFJ(g,c,h),J(x)?x:(v=e.Fa(x),z===g?v?n:1:(v&&(A=!1),e.Fa(z)?b.EmptyValue:!Y.isNextOrPrevious&&a.RJJ(z,c)?f.Errors.NotAvailable:(y=a.RFJ(z,c,h),J(y)?y:(e.Fa(y)&&(B=!1),A?B?0===y?f.Errors.DivideByZero:x/y:n:b.EmptyValue))))):f.Errors.NotAvailable);case d.PivotShowDataAs.percentOfParentRow:return D=a.DFJ(p).indexList[o],x=a.RFJ(g,c,h)||0,y=a.RFJ(D,c,h),J(x)||J(y)?f.Errors.Value:e.Fa(y)?n:0===y?f.Errors.DivideByZero:x/y;case d.PivotShowDataAs.percentOfParent:if(e.Fa(a.kGJ[a.zFJ[k].baseFieldName]))return f.Errors.NotAvailable;if(Y.baseRootLevel>-1){if(E=a.DFJ(p),!E)return f.Errors.NotAvailable;if(F=E.indexList[u],x=a.RFJ(g,c,h),J(x))return x;if(Y.baseRootLevel+1>=j)return e.Fa(x)?n:1;if(y=a.RFJ(F,c,h),J(y))return f.Errors.Value;if(e.Fa(y))return n}else if(x=a.RFJ(g,c,h),y=a.RFJ(l,c,h),e.Fa(l))return m(+y)?n:f.Errors.Value;return 0===y?f.Errors.DivideByZero:x/y;case d.PivotShowDataAs.difference:return e.Fa(a.kGJ[a.zFJ[k].baseFieldName])?f.Errors.NotAvailable:(G=void 0,Y.baseRootLevel>j?n:(H=a.DFJ(s))?0===H.level&&Y.isHeaderOfPercentOrDiff?n:(G=H.indexList[t],x=a.RFJ(g,c,h),x instanceof f.CalcError?x:e.Fa(G)?f.Errors.NotAvailable:(I=a.RJJ(G,c),I&&!Y.isNextOrPrevious?f.Errors.NotAvailable:(y=a.RFJ(G,c,h),y instanceof f.CalcError?y:(0*x!==0&&(x=0),0*y!==0&&(y=0),x-y)))):f.Errors.NotAvailable);case d.PivotShowDataAs.percentDiff:return e.Fa(a.kGJ[a.zFJ[k].baseFieldName])?f.Errors.NotAvailable:(K=void 0,Y.baseRootLevel>j?n:(L=a.DFJ(s))?0===L.level&&Y.isHeaderOfPercentOrDiff?n:(K=L.indexList[t],K===g?n:(x=a.RFJ(g,c,h),J(x)?x:e.Fa(x)?b.EmptyValue:e.Fa(K)?f.Errors.NotAvailable:!Y.isNextOrPrevious&&a.RJJ(K,c)?f.Errors.NotAvailable:(y=a.RFJ(K,c,h),J(y)?y:e.Fa(y)?n:0===y?f.Errors.DivideByZero:(x-y)/y))):f.Errors.NotAvailable);case d.PivotShowDataAs.runTotal:if(e.Fa(a.kGJ[a.zFJ[k].baseFieldName]))return f.Errors.NotAvailable;if(x=a.RFJ(g,c,h),Y.baseRootLevel>-1){if(j<Y.baseRootLevel+1)return n}else if(M=a.DFJ(p),M.level>Y.baseHeaderLevel+1)return x;return e.Fa(x)&&(x=0),y=a.SFJ(k,t,s),m(+y)?y:(m(+x)?y=x:y+=x,a.TFJ(k,t,s,y),y);case d.PivotShowDataAs.percentOfRunningTotal:return e.Fa(a.kGJ[a.zFJ[k].baseFieldName])?f.Errors.NotAvailable:Y.baseRootLevel>-1&&j<Y.baseRootLevel+1?n:(x=a.RFJ(g,c,h),e.Fa(x)&&(x=0),y=a.SFJ(k,t,s),m(+y)?y:(m(+x)?y=x:y+=x,a.TFJ(k,t,s,y),N=a.UFJ(k,t,s),0===N||m(+N)?(a.TFJ(k,t,s,f.Errors.DivideByZero),f.Errors.DivideByZero):y/N));case d.PivotShowDataAs.rankAscending:return e.Fa(a.kGJ[a.zFJ[k].baseFieldName])?f.Errors.NotAvailable:Y.baseRootLevel>-1&&j<Y.baseRootLevel+1?n:(O=a.RFJ(g,c,h),P=a.VFJ(k,t,s),P?P[O]:n);case d.PivotShowDataAs.rankDescending:return e.Fa(a.kGJ[a.zFJ[k].baseFieldName])?f.Errors.NotAvailable:Y.baseRootLevel>-1&&j<Y.baseRootLevel+1?n:(Q=a.RFJ(g,c,h),R=a.VFJ(k,t,s),R?R[Q]:n);case d.PivotShowDataAs.index:return x=a.RFJ(g,c,h),S=a.RFJ(a.PFJ,c,h),T=a.RFJ(q,c,h),U=a.RFJ(r,c,h),0===x?0:m(+x)?x:m(+S)?S:m(+T)?T:m(+U)?U:(V=x*S,W=T*U,0===W?f.Errors.DivideByZero:V/W)}};function J(a){return!e.Fa(a)&&m(+a)}b.tBc=function(a,c){var f={};return e.Yxc(c,function(c){f[d.SubtotalType[c]]=b.aBc(c)(a)}),f},u=function(a){return a===d.PivotShowDataAs.percentOfRunningTotal||a===d.PivotShowDataAs.rankAscending||a===d.PivotShowDataAs.rankDescending},v=function(a,c,d,f,g){var h,i,j,k;if(void 0===g&&(g=""),h=a.Pzc,i=a.nodeName,j=g,d||(""!==j&&(j+=b.Separator),j+=i),e.Yxc(h,function(a){v(a,c,!1,f,j)}),c[j]=a.GFJ,!a.K0b&&f.WFJ&&a.CFJ)for(k in a.CFJ)u(f.zFJ[k].showDataAs)&&f.XFJ(k,j,a.CFJ[k].baseMinorPath)},w=function(a,b,c){var d,e,f,g,h,i=[];if(a.aN<b&&a.Pzc.length>0)for(d=0,e=a.Pzc;d<e.length;d++)f=e[d],g=w(f,b,c).slice(0),i.push.apply(i,g);else if(a.aN===b)return h={},v(a,h,!0,c),[h];return i},x=function(a,b,c,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=a.YFJ;for(h in s)if(s.hasOwnProperty(h)){i=a.zFJ[h],j=i.cacheName,k=i.subtotalText,l=i.showDataAs,m=s[h],n=f?c:m;for(o in n)n.hasOwnProperty(o)&&(p=void 0,q=b[h].baseMajorPath,p=f?m[o]||o:m[o],r=c[o],e.Fa(r)||(l===d.PivotShowDataAs.percentOfRunningTotal?a.ZFJ(h,p,q,r,j,k):a.$FJ(h,p,q,r,j,k)))}},y=function(a,c,d,f,g,h,i,j,k){var l,m,n,o,p,q,r,s,t,u,v,y,z,A,B,C,D,E,F,G,H,J,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga=w(c,d,a),ha=a.WFJ;if(ga&&1===ga.length){if(k)for(l=K(a,c.EFJ,ga[0],j),m=0,n=f;m<n.length;m++)for(o=n[m],p=o.subTotalTypes,q=0,r=p;q<r.length;q++)for(s=r[q],t=0,u=l;t<u.length;t++)v=u[t],y={fieldInfos:v.fieldInfos,valueInfo:{sourceName:o.cacheName,subtotalType:s}},z=i.Q1J(y),A=a.aGJ(v.calcIndex),e.Fa(z)||(c.P1J(s,A[o.cacheName].calc,z),c.P1J(s,A[o.cacheName].calcResult,z));return a._FJ(c.EFJ,{indexList:ga[0],level:c.aN,visible:c.bz,collapse:c.SJJ,baseSubtotalInfo:c.CFJ,parentPath:g}),void(ha&&x(a,c.CFJ,ga[0],!1,!1))}for(B={},E=[],F={},e.Yxc(f,function(a){E.push(a.cacheName),F[a.cacheName]=a.isCalculatedField}),G=0,H=ga;G<H.length;G++){J=H[G];for(L in J)if(J.hasOwnProperty(L))for(B[L]||(B[L]={}),M=0,N=E;M<N.length;M++)O=N[M],P=a.aGJ(B[L]),P||(P={}),C=P[O],D=a.aGJ(J[L])&&a.aGJ(J[L])[O],C||(C={}),D&&D.calc&&(C.calc?F[O]?(h.GHJ(i,P,O),C.calc=P[O].calc):(Q=C.calc,R=D.calc,C.calc={count:I(Q.count,R.count,0),sum:I(Q.sum,R.sum,0),max:I(Q.max,R.max,5),min:I(Q.min,R.min,6),sumx2:I(Q.sumx2,R.sumx2,0),product:I(Q.product,R.product,2),len:I(Q.len,R.len,0)}):C.calc=D.calc),S=a.bGJ(),B[L]=S,P[O]=C,a.cGJ(S,c.EFJ,P)}if(k)for(l=K(a,c.EFJ,B,j),T=0,U=f;T<U.length;T++)for(V=U[T],W=V.subTotalTypes,O=V.cacheName,X=0,Y=W;X<Y.length;X++)for(s=Y[X],Z=0,$=l;Z<$.length;Z++)v=$[Z],y={fieldInfos:v.fieldInfos,valueInfo:{sourceName:O,subtotalType:s}},z=i.Q1J(y),A=a.aGJ(v.calcIndex),e.Fa(z)||c.P1J(s,A[O].calc,z);for(L in B)if(B.hasOwnProperty(L))for(_=0,aa=f;_<aa.length;_++)ba=aa[_],W=ba.subTotalTypes,O=ba.cacheName,ca=a.aGJ(B[L]),ca||(ca={}),da=ca[O],da.collapse=a.RJJ(a.dGJ[L],O),da.calcResult=b.tBc(da.calc,W),da.hasEffectChild=!0;ha&&x(a,c.CFJ,B,!0,c.Yzc),ea=c.bz,fa=c.SJJ,a._FJ(c.EFJ,{indexList:B,level:c.aN,visible:ea,collapse:fa,baseSubtotalInfo:c.CFJ,parentPath:g})};function K(a,c,d,e){var f,g,h,i,j,k,l=[],m=[],n=[],o=0;for(""!==c&&(f=c.split(b.Separator),o=f.length,l=l.concat(f)),g=Object.keys(d),h=0,i=g;h<i.length;h++)j=i[h],m.push({fieldInfo:""===j?l:l.concat(j.split(b.Separator)),calcIndex:d[j]});return k=a.kGJ,e.forEach(function(a,b){n[b]=k[a]}),n=n.splice(a.GGJ,o).concat(n.splice(0,a.GGJ)),L(a,m,n)}function L(a,b,c){var d,e,f,g=a.nLc,h=[],i=function(a){var b={fieldInfos:[],calcIndex:a.calcIndex};a.fieldInfo.forEach(function(a,d){var e=g.getField(c[d]);b.fieldInfos.push({fieldName:c[d],fieldItem:e.getFieldsItemList()[a]})}),h.push(b)};for(d=0,e=b;d<e.length;d++)f=e[d],i(f);return h}z=function(){function a(a,b){this.dGJ={},this.eGJ={},this.fGJ={},this.zFJ={},this.gGJ={},this.hGJ={},this.iGJ={},this.WFJ=!1,this.FP=[],this.Jb=a,this.nLc=b}return a.prototype.getFieldCalcItem=function(a,b,c,d,f,g){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=this,I=H.fieldNameOrders;if(!H.checkCalcInfo(a,c))throw Error();for(k={},l=0,m=H.nLc,n=Object.keys(c),p=0,q=[],r=H.KTJ,s=0,t=n;s<t.length;s++)u=t[s],k[u]=c[u],j=c[u],i=m.getField(r[u]),e.Fa(a[r[u]])?i.HSJ()&&(v=i.SDc,q.push({groupName:u,originName:v})):j=i.LTJ(a[r[u]]),i.MTJ[j]&&(l++,H.fieldLabelItems[r[u]]&&!H.fieldLabelItems[r[u]][j]&&i.MTJ[j]>p&&(o=i.xSJ[a[r[u]]].calcExpression,p=i.MTJ[j])),k[u]=j;for(w=0,x=q;w<x.length;w++)y=x[w],z=y.groupName,A=y.originName,B=m.getField(A),C=void 0,i=m.getField(z),C=e.Fa(k[r[A]])?a[A]:B.BBc()[k[r[A]]],k[z]=i.aGc[i.EBc[C]];return o?(D=m.aCc,E=D.calcService,F=D.calcSource,F.setCalcInfo(d,H,k,f,o,g),E.lh.evaluateExpression(o,F.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1)):(G=H.getCalcValueImp(k,d,f))?G:l>0&&h.getPathStr(c,I)!==h.getPathStr(k,I)?void H.nLc.setUntreatedNodeInfo(k,c,H.fieldNameOrders,b,g):0},a.prototype.checkCalcInfo=function(a,b){var c,d,f,g,h,i,j,k=this,l=Object.keys(a),m=this.KTJ,n=Object.keys(b),o=k.nLc,p={};for(c=0,d=n;c<d.length;c++)f=d[c],g=o.getField(m[f]),g&&!e.Fa(g.SDc)&&(p[g.SDc]=!0);for(h=0,i=l;h<i.length;h++)if(j=i[h],e.Fa(b[m[j]])&&e.Fa(p[j]))return!1;return!0},a.prototype.getCalcValueImp=function(a,c,f){var g,i,j,k,l,m,n,o,p,q,r,s=this,t=s.fieldNameOrders,u=h.getPathStr(a,t),v=s.pathPool[u];return e.Fa(v)?(i=s.NTJ,j=s.OTJ,v=i[u],e.Fa(v)?void 0:(k=j[v].subtotal[f].calc,l=k.count,m=k.sum,n=k.max,o=k.min,p=k.sumx2,q=k.product,r=k.len,j[v].subtotal[f].calcResult=b.tBc({count:l,sum:m,max:n,min:o,sumx2:p,product:q,len:r},[d.SubtotalType[c]]),j[v].subtotal[f].calcResult[c])):(g=s.FP[v]&&s.FP[v][f],g&&g.calcResult[c])},a.prototype.buildCalcItemInfo=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this;for(N(t,b),t.pathPool=H({},a.cAc),t.NTJ=a.NTJ,t.OTJ=a.OTJ,f=t.IXJ||{},g=[],h=0,i=0,j=e;i<j.length;i++)k=j[i],g[k]=c[h],h++;for(t.fieldNameOrders=g,t.originOrders=c.slice(),t.nLc.PTJ={},t.fieldLabelItems={},t.KTJ={},l=0,m=d;l<m.length;l++)if(n=m[l],t.KTJ[n.displayName]=n.sourceName,t.KTJ[n.sourceName]=n.displayName,f[n.sourceName]=!n.isHeader,!n.isALL){for(o=n.items,p={},q=0,r=o;q<r.length;q++)s=r[q],p[s]=!0;t.fieldLabelItems[n.sourceName]=p}t.IXJ=f},a.prototype.destroyCalcItemInfo=function(){var a=this;a.pathPool=null,a.NTJ=null,a.OTJ=null,a.fieldNameOrders=null,a.originOrders=null,a.fieldLabelItems=null,a.nLc.PTJ=null},a.prototype.jGJ=function(a,b){var c=this.kGJ[a]||a,d=b&&b[c];return d||this.nLc.LSb(c).jGJ()},a.prototype.lGJ=function(a,b,c){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=!1,F=[],G={},H={},I=0;for(f=0,g=a;f<g.length;f++)h=g[f],i=!1,j=void 0,k=-1,l=h.showDataAs,m=h.baseFieldItemType,n=h.baseFieldName,o=h.baseFieldItem,p=h.baseFieldItemShared,q=h.fieldName,r=h.cacheName,s=h.subtotalType,E=!0,t=c.indexOf(n),u=b.indexOf(n),n&&(j=u>-1,k=c.concat(b).indexOf(n)+1),i=i||this.mGJ(h),v=d.SubtotalType[s],w=l===d.PivotShowDataAs.percentOfParent,x=l===d.PivotShowDataAs.rankAscending||l===d.PivotShowDataAs.rankDescending,y=l===d.PivotShowDataAs.runTotal||l===d.PivotShowDataAs.percentOfRunningTotal,z=y||x,A=this.nGJ(l,m),B=l===d.PivotShowDataAs.difference||l===d.PivotShowDataAs.percentDiff||l===d.PivotShowDataAs.percent,C=Math.pow(2,I),D={showDataAsIndex:C,needBuildBasePath:i,showDataAs:l,baseFieldItemType:m,isNextOrPrevious:A,baseFieldName:n,baseFieldItem:o,baseFieldItemShared:p,isDifferenceOrPercent:B,isRankShowDataAs:x,cacheName:r,isHeaderOfPercentOrDiff:j,subtotalText:v,baseRootLevel:t,baseHeaderLevel:u,fieldName:q,needBuildPercentOfPath:w,actualBaseLevel:k,needBuildRunningTotalOrRankPath:z},F.push(D),this.zFJ[q]=D,y&&(this.gGJ[q]={}),x&&(this.WFJ=!0,this.YFJ||(this.YFJ={}),this.YFJ[q]={},this.iGJ[q]={},H[r]||(H[r]=[]),H[r].push(q)),A&&(e.Fa(this.oGJ)&&(this.oGJ=[]),this.oGJ.push(q)),l===d.PivotShowDataAs.percentOfRunningTotal&&(this.YFJ||(this.YFJ={}),this.YFJ[q]={},this.hGJ[q]={},this.WFJ=!0,H[r]||(H[r]=[]),H[r].push(q));return this.pGJ=G,this.qGJ=H,this.rGJ=E,F},a.prototype.nGJ=function(a,b){var c=a===d.PivotShowDataAs.difference||a===d.PivotShowDataAs.percentDiff||a===d.PivotShowDataAs.percent;return!(!c||b===d.PivotShowDataAsBaseItemType.item)},a.prototype.XFJ=function(a,b,c){this.YFJ[a][b]=c},a.prototype.SFJ=function(a,b,c){var d=this.gGJ[a],e=b+"||"+c;return d[e]||(d[e]={val:0}),d[e].val||0},a.prototype.UFJ=function(a,b,c){var d=b+"||"+c;return this.hGJ[a][d].cursor},a.prototype.ZFJ=function(a,b,c,d,e,f){var g,h;this.RJJ(d,e)||(g=this.RFJ(d,e,f),h=b+"||"+c,this.hGJ[a][h]||(this.hGJ[a][h]={cursor:0}),this.hGJ[a][h].cursor+=g)},a.prototype.TFJ=function(a,b,c,d){var e=b+"||"+c;this.gGJ[a][e].val=d},a.prototype.VFJ=function(a,b,c){var d=b+"||"+c,e=this.iGJ[a];return e[d]||(e[d]=0),e[d]},a.prototype.$FJ=function(a,b,c,d,e,f){var g,h;this.RJJ(d,e)||(g=this.RFJ(d,e,f),h=b+"||"+c,this.iGJ[a][h]||(this.iGJ[a][h]={}),this.iGJ[a][h][g]=1)},a.prototype.sGJ=function(){var a,b,c,f,g;for(a in this.iGJ)if(this.iGJ.hasOwnProperty(a)){b=this.iGJ[a],c=this.zFJ[a].showDataAs,f=c===d.PivotShowDataAs.rankAscending?1:-1;for(g in b)b.hasOwnProperty(g)&&(b[g]=e.tGJ(b[g],f))}},a.prototype.mGJ=function(a){var b=a.showDataAs,c=a.baseFieldItemType,e=!1;return b!==d.PivotShowDataAs.percent&&b!==d.PivotShowDataAs.difference&&b!==d.PivotShowDataAs.percentDiff||(e=c===d.PivotShowDataAsBaseItemType.item),e},a.prototype.uGJ=function(a){this.al=a,this.PFJ=a.GFJ,a.QFJ=a.GFJ},a.prototype.vGJ=function(){return this.al},a.prototype.wGJ=function(a){this.KW=a,this.xGJ=a.GFJ,a.QFJ=a.GFJ},a.prototype._FJ=function(a,b){this.fGJ[a]=b},a.prototype.AYJ=function(a,b,c){var f,g,h,i=this;if(i.BYJ={columnNodeInfo:null,rowNodeInfo:null},!e.Fa(b)&&Object.keys(b).length>0||c)return i.BYJ.columnNodeInfo={},void(i.BYJ.rowNodeInfo={});if(!e.Fa(a)&&a.length>0)for(f=0,g=a;f<g.length;f++)if(h=g[f],h.showDataAs!==d.PivotShowDataAs.normal)return i.BYJ.columnNodeInfo={},void(i.BYJ.rowNodeInfo={})},a.prototype.DFJ=function(a){return this.fGJ[a]},a.prototype.yGJ=function(){return this.KW},a.prototype.bGJ=function(){var a=this.Jb;return this.Jb=a+1,a},a.prototype.zGJ=function(a){return this.rGJ[a]},a.prototype.aGJ=function(a){return this.FP[a]},a.prototype.RFJ=function(a,b,c){return this.aGJ(a)&&this.aGJ(a)[b].calcResult&&this.aGJ(a)[b].calcResult[c]},a.prototype.RJJ=function(a,b){return this.aGJ(a)&&this.aGJ(a)[b].collapse},a.prototype.yFJ=function(a,b,c,d,e,f){var g;return g=this.zFJ[f]?t(this,b,a,c,d,e,f):this.RFJ(a,b,c)},a.prototype.HFJ=function(a,b){return b?this.eGJ[a]:this.dGJ[a]},a.prototype.AGJ=function(a,b,c,d){d?this.cGJ(a,b,c):this.BGJ(a,b,c)},a.prototype.BGJ=function(a,b,c){this.FP[a]=c,this.dGJ[b]=a},a.prototype.CGJ=function(a,b){this.FP[a]=b},a.prototype.cGJ=function(a,b,c){this.FP[a]=c,this.eGJ[b]=a},a.prototype.no=function(){var a=this;a.FP=i,a.Jb=0,a.dGJ=i,a.eGJ=i,a.al=i,a.KW=i,a.zFJ=i,a.nLc=i,a.rGJ=!1,a.DGJ=i,a.kGJ=i,a.gGJ=i,a.hGJ=i,a.iGJ=i,a.pGJ=i,a.oGJ=i,a.qGJ=i,a.EGJ=i,a.FGJ=i,a.YFJ=i},a}(),b.PivotSubtotalManager=z;function M(a,b){var c=b.getField(a);return!(!c||e.Fa(c.Yw))}A=function(){function a(a,b,c,d,f){var g,h;this.bBc={},this.lGc={},g=this,h=[],e.Yxc(a,function(a,b){var c=a.index,d=a.displayName,e=a.isDim,f=a.isGroupField,i=a.getGroupItem,j=a.databaseField,k=a.dataFieldIndex;e&&(h.push({index:c,fieldName:d,isGroupField:f,getGroupItem:i,databaseField:j,dataFieldIndex:k}),g.bBc[d]=b,g.lGc[d]=b)}),g.cBc=h,g.SIa=g.HHJ(b,c),g.RFc=g.IHJ(g.SIa),g.JHJ=g.HHJ(d,c),g.KHJ=g.HHJ(f,c,!0),g.cAc={},g.NTJ={},g.Iyc=[],g.OTJ=[]}return a.prototype.HHJ=function(a,b,c){var f,g={},h=[];e.Yxc(a,function(a,f){var h,i=a.cacheName,j=a.index,k=a.subTotalType;M(i,b)&&(k=d.SubtotalType.sum),g[j]?g[j].subTotalTypes.push(k):(g[j]={cacheName:i,index:j,subTotalTypes:[k],isCalculatedField:c},h=b.HL[i]&&!e.isEmptyObject(b.HL[i].Eyc)&&b.HL[i].vzc&&b.HL[i].vzc.length>0,h&&(g[j].itemsKeyList=b.HL[i].vzc))});for(f in g)g.hasOwnProperty(f)&&h.push(g[f]);return h},a.prototype.IHJ=function(a){var b,c,d={};for(b=0,c=a.length;b<c;b++)d[a[b].cacheName]=b;return d},a.prototype.no=function(){var a=this;a.cAc=i,a.SIa=i,a.RFc=i,a.JHJ=i,a.KHJ=i,a.Iyc=i,a.cBc=i,a.bBc=i,a.lGc=i},a.prototype.dBc=function(a,c,d,e,f){var g,h,i,j,k,l,m,n=this.JHJ,o={};for(g=0,h=n;g<h.length;g++)i=h[g],j=i.cacheName,k=i.index,l=i.itemsKeyList,o[j]||(o[j]=f?b.uWJ():b._Ac(l?l[a[k]]:a[k]));return m=[d],e?this.OTJ.push({path:c,indexes:m,subtotal:o})-1:this.Iyc.push({path:c,indexes:m,subtotal:o})-1},a.prototype.addItem=function(a,c,d,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t=this.cBc,u=f&&f.sWJ||{},v=[],w=[],x=d?this.NTJ:this.cAc;for(g=0,h=t;g<h.length;g++)i=h[g],j=i.fieldName,k=i.index,l=i.isGroupField,m=i.getGroupItem,n=i.databaseField,o=i.dataFieldIndex,p=n===!1?a[o]:a[k],l&&(p=m(p)),v.push(j+"&"+p),w.push(p);q=v.join(b.Separator),r=x[q],s=!!u[c],e.Fa(r)?x[q]=this.dBc(a,w,c,d,s):this.eBc(r,a,c,d,s)},a.prototype.eBc=function(a,c,d,e,f){var g,h,i,j,k,l,m,n=e?this.OTJ:this.Iyc,o=n[a];if(o.indexes.push(d),g=this.JHJ,!f)for(h=0,i=g;h<i.length;h++)j=i[h],k=j.cacheName,l=j.index,m=j.itemsKeyList,b.$Ac(m?m[c[l]]:c[l],o.subtotal[k])},a.prototype.fBc=function(a){var b,c,d,f=this.lGc,g=[];for(b=0,c=a.length;b<c;b++)d=a[b],e.Fa(f[d])||g.push(f[d]);return g},a.prototype.gBc=function(a,b){var c=this;return a.map(function(a){return{pathStr:b[a],dimName:c.cBc[a].fieldName}})},a.prototype.MFc=function(a,b,c,f,g,h,j,k,l,m,n,o,p){var q,r,s,t,u,v,w,x,y,A,B,C,D,E,F,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W=this,Z=new z(this.Iyc.length,a),$=a.O1J&&!a.O1J.isEmpty(),aa=new G("","",Z,(!1),"","",""),ba=new G("","",Z,(!1),"","","");if(Z.uGJ(aa),Z.wGJ(ba),Z.AYJ(m,p,$),Z.collapseItems=j,q=Z.lGJ(m,c,f),r=f.length,Z.GGJ=r,ba.aN=0,aa.aN=0,aa.Yzc=!0,aa.bz=!1,ba.bz=!1,ba.Yzc=!0,m&&m.length>0&&aa.HGJ(Z,q,r,"",{},0),s=this.fBc(b),t=this.fBc(c.concat(f)),u=h.valuePositionInfo,v=h.insertBlankLineAfterEachItem,w=h.grandTotalPosition,x=h.subTotalsPosition,y=h.valueFieldLength,h=i,A=u.positionIndex,B=u.positionType,C=u.display,D=-1,E=-1,F=this.SIa.length,(F>1||1===F&&this.SIa[0].subTotalTypes.length>1)&&C&&(B===d.DataPosition.col&&(E=A,0===A&&(ba.Zzc=!0)),B===d.DataPosition.row&&(D=A,0===A&&(aa.Zzc=!0))),this.SFc(aa,ba,s,t,g,D,E,Z,r,q,j),H=W.JHJ.concat(W.KHJ),Z.nLc.hasCalcItem(g)&&(Z.buildCalcItemInfo(this,H,b,g,s),_(Z,g,{rootPosition:D,headerPosition:E},q,r,H,ia(g)),Z.destroyCalcItemInfo()),H.length>0&&(p&&Object.keys(p).length>0&&this.CYJ(Z,g,ia(g),p,q,{rootPosition:D,headerPosition:E},t.length,H),(X(m)||$)&&Y(Z,g,ia(g),q,{rootPosition:D,headerPosition:E},t.length,H)),I=this.RFc,J={},K=!1,L={},M={},N={},e.Yxc(g,function(a){var b,c,d,e=a.displayName,f=a.sourceName,g=a.valueFilter,h=a.sortInfo;g&&(b=g.conditionBySourceName,c=g.condition,d=k[g.conditionByName],J[e]={valueFieldName:b,condition:c,subTotalType:d},K=!0),h&&h.sortValueFieldName&&(L[e]={subtotalText:h.sortValueSubtotalText,cacheName:h.cacheName}),M[e]=f,N[f]=e}),g=i,Z.DGJ=L,Z.kGJ=M,Z.EGJ=n,Z.FGJ=o,O={},K)for(P=void 0,Q=void 0,R=0,S=l;R<S.length;R++)T=S[R],Q=N[T],U=J[Q],V=this.SIa[I[U&&U.valueFieldName]],e.Fa(V)||(P=c.indexOf(Q),P>-1?ba.TFc(V,Q,U,O,P,Z):(P=f.indexOf(Q),aa.TFc(V,Q,U,O,P,Z)));return aa.hBc(H,O,Z,!1,r,"",W,a,$?{}:i),ba.hBc(H,O,Z,!0,c.length,"",W,a,$?{}:i,b),Z.sGJ(),ba.UFc(c.length,{},{insertBlankLineAfterEachItem:v,grandTotalPosition:w,subTotalsPosition:x,valueFieldLength:y,valuePosition:E},!0,j,Z),0===c.length&&(ba.Uzc=0,ba.Vzc=E!==-1?y:1,ba.iAc=0,ba.jAc=E!==-1?y:1,ba.kEc=E!==-1?y:1,ba.iOc=E!==-1?y:1),ba.Tzc=c.length,aa.UFc(s.length-c.length,{},{insertBlankLineAfterEachItem:v,grandTotalPosition:w,subTotalsPosition:x,valueFieldLength:y,valuePosition:D},!1,j,Z),s.length-c.length===0&&(aa.Uzc=0,aa.Vzc=D!==-1?y:0,aa.iAc=D!==-1?y:1,aa.jAc=D!==-1?y:0,aa.kEc=D!==-1?y:0,aa.iOc=D!==-1?y:1,0===y&&(aa.iOc=0,aa.iAc=0)),Z},a.prototype.SFc=function(a,b,c,d,f,g,h,i,j,k,l){var m,n=this,o=this.SIa.length,p=this.Iyc,q=Math.max(d.length-j,0),r=i.BYJ;o>0?(m=this.JHJ.concat(this.KHJ),e.Yxc(p,function(e,l){var o,p,s,t,u,v,w;for(o=0,p=m;o<p.length;o++)s=p[o].cacheName,t=e.path,u=e.subtotal,v=u[s],w=n.gBc(d,t),b.addChildItem(w,v,l,i,s,f,h,q,!0,"",!1,0,b.CFJ,k,!1,r.columnNodeInfo),a.addChildItem(n.gBc(c,t),v,l,i,s,f,g,j,!1,"",!1,0,a.CFJ,k,!1,r.rowNodeInfo)})):e.Yxc(p,function(e,k){var l=e.path;b.addChildItem(n.gBc(d,l),null,k,i,void 0,f,h,q,!0,"",!1,0),a.addChildItem(n.gBc(c,l),null,k,i,void 0,f,g,j,!1,"",!1,0)})},a.prototype.CYJ=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o=a.al,p=a.BYJ,q=a.GGJ>0?p.rowNodeInfo:p.columnNodeInfo,r=[],s=[];for(i=0,j=b;i<j.length;i++)k=j[i],s.push(k.sourceName);for(l=0,m=h;l<m.length;l++)n=m[l],O(o,a,b,c,q,r,g,d,e,f,s,n.cacheName)},a.prototype.LHJ=function(a,b){var c,d,e,f,g=this,h=g.Iyc;for(c=0,d=h.length;c<d;c++)e=h[c],f=e.subtotal,g.MHJ(a,f,b)},a.prototype.MHJ=function(a,b,c){var d,e,f=this;for(d=0,e=c.length;d<e;d++)f.GHJ(a,b,c[d].cacheName)},a.prototype.GHJ=function(a,b,c){var d,e,g,h=a.aCc,i=h.calcService,j=h.calcSource;j.setMeasureNode(b),d=a.LSb(c),e=d.X$b;try{g=i.lh.evaluateExpression(e,j.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1)}catch(a){g=f.Errors.Reference}b[d.Cj]={calc:{sum:g},calcResult:g}},a}(),b.PivotQueryList=A;function N(a,c){if(!(e.Fa(c)||c.length<1)){var d=a.FP;e.Yxc(c,function(a){var c,e,f,g,h,i,j,k,l,m,n,o=a.cacheName,p=a.subTotalTypes,q=a.isCalculatedField;for(c=0,e=d;c<e.length;c++)f=e[c],g=f[o].calc,h=g.count,i=g.sum,j=g.max,k=g.min,l=g.sumx2,m=g.product,n=g.len,f[o].calcResult=b.tBc({count:h,sum:i,max:j,min:k,sumx2:l,product:m,len:n},p)})}}function O(a,b,c,d,f,g,h,i,j,k,l,m){var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;if(!(a.aN>=h||0===a.Pzc.length)){if(n=b.nLc,o=a.Pzc,p=o[0].xzc,q=c[a.aN].sourceName,r={},s=b.GGJ,i[p])for(t=void 0,a.aN<s&&(t=b.BYJ.columnNodeInfo),u=Q(n,q,g,l,d,s),v=0,w=u;v<w.length;v++)x=w[v],f.itemKeys&&e.Fa(f.itemKeys[x])&&e.Fa(r[x])&&(g.push({pathStr:x,dimName:p}),r[x]=1,P(b,c,d,g,h,a.aN<b.GGJ,t,j,k,l,m),g.pop());for(y=0,z=o;y<z.length;y++)A=z[y],B=void 0,e.Fa(r[A.pathStr])&&(g.push({pathStr:A.pathStr,dimName:A.xzc}),B=A.aN===b.GGJ?b.BYJ.columnNodeInfo:f.itemKeys[A.pathStr],O(A,b,c,d,B,g,h,i,j,k,l,m),g.pop())}}function P(a,c,d,f,g,h,i,j,k,l,m){var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=f.length,F=a.nLc;if(E<g){if(n=c[E].sourceName,o=c[E].displayName,p=a.GGJ,h===E<a.GGJ)for(q=Q(F,n,f,l,d,p),r=0,s=q;r<s.length;r++)t=s[r],f.push({pathStr:t,dimName:o}),P(a,c,d,f,g,h,i,j,k,l,m),f.pop();else if(u=i&&i.itemKeys,!e.Fa(u))for(v=Object.keys(u),w=0,x=v;w<x.length;w++)t=x[w],f.push({pathStr:t,dimName:o}),P(a,c,d,f,g,h,i.itemKeys[t],j,k,l,m),f.pop()}else y=a.al,z=a.KW,A=b.uWJ(),B=a.bGJ(),C=g-a.GGJ,D=a.BYJ,y.addChildItem(f,A,B,a,m,c,k.rootPosition,a.GGJ,!1,"",!1,0,y.CFJ,j,!1,D.rowNodeInfo),z.addChildItem(da(f,a.GGJ),A,B,a,m,c,k.headerPosition,C,!0,"",!1,0,z.CFJ,j,!1,D.columnNodeInfo)}function Q(a,b,c,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=a.getField(b),K=J.SDc||b,L=c.length,M=L<h,N=M?0:h,O=g[b];for(k=L-1;k>=N;k--)if(j=a.getField(f[k]),i=j.SDc||f[k],K===i){if(l=c[k].pathStr,m=j.dCc,n=J.dCc,o={3:d.DateGroupType.days,4:d.DateGroupType.months,5:d.DateGroupType.quarters},p=void 0,!e.Fa(n)&&!e.Fa(m)&&o[n]&&o[m])p=R(m,n,l);else if(e.Fa(n)&&e.Fa(m))p=W(a,b,f[k],l,g[b]);else if(0===l)p=[0];else if(j.BBc().length-1===l)p=[J.BBc().length-1];else{for(q=J.BBc(),r=J.dGc(),s=[],t=0,u=q;t<u.length;t++)v=u[t],s.push(r[v]);s.pop(),s.shift(),p=s}if(O.isAll)return p;for(w=O.items,x={},y=[],z=0,A=w;z<A.length;z++)v=A[z],x[v]=!0;for(B=0,C=p;B<C.length;B++)D=C[B],x[D]&&y.push(D);return y}if(O.isAll){for(q=J.BBc(),r=J.dGc(),p=[],E=0,F=q;E<F.length;E++)v=F[E],p.push(r[v]);return p}if(G=Object.keys(O.items),J.HSJ()){for(r=[],H=0,I=G;H<I.length;H++)v=I[H],r.push(J.aGc[v]);return r}return G}function R(a,b,c){var e,f,g,h,i;if(a>b){if(a===d.DateGroupType.quarters){if(e=V(c),b===d.DateGroupType.days){for(f=[],g=0,h=e;g<h.length;g++)i=h[g],f=f.concat(U(i));return f}return e}return U(c)}return a===d.DateGroupType.days?(i=S(c),b===d.DateGroupType.quarters?T(i[0]):i):T(c)}function S(a){var b,c=o.length;for(b=0;b<c;b++)if(o[b]<=a&&o[b+1]>a)return[b]}function T(a){return 0===a?[0]:13===a?[5]:[Math.floor((a-1)/3)+1]}function U(a){var b,c,d=[];for(e.Fa(o[a])||(b=o[a],c=o[a+1]),b;b<c;b++)d.push(b);return d}function V(a){var b,c,d=[],f=[0,1,4,7,10,13,14];for(e.Fa(f[a])||(b=f[a],c=f[a+1]);b<c;b++)d.push(b);return d}function W(a,b,c,d,f){var g,h,i,j,k,l,m,n,o,p,q,r,s=a.getField(b),t=a.getField(c),u=[];if(s.HSJ())h=t.BBc()[+d],i=s.EBc,j=s.aGc,g=i&&j&&j[i[h]],e.Fa(g)||u.push(g);else for(k=t.tnb,l=t.kBc,m=l[+d],n=k[m],o=s.Eyc,p=0,q=n;p<q.length;p++)r=q[p],g=o[r],u.push(g);return u}function X(a){var b,c,f;if(!e.Fa(a))for(b=0,c=a;b<c.length;b++)if(f=c[b],f.showDataAs!==d.PivotShowDataAs.normal)return!0;return!1}function Y(a,b,c,d,e,f,g){var h,i,j,k,l=a.al,m=a.GGJ;if(0!==m&&f-m!==0)for(h=[],i=0,j=g;i<j.length;i++)k=j[i],Z(l,a,b,c,h,f,d,e,k.cacheName)}function Z(a,b,c,d,e,f,g,h,i){var j,k,l,m,n;for(a.aN===b.GGJ&&(j=b.BYJ.columnNodeInfo.itemKeys,$(a,b,c,d,j,e,f,g,h,!1,i)),k=a.Pzc,l=0,m=k;l<m.length;l++)n=m[l],e.push({pathStr:n.pathStr,dimName:n.xzc}),Z(n,b,c,d,e,f,g,h,i),e.pop()}function $(a,c,d,f,g,h,i,j,k,l,m){var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=h.length;if(H<i)if(n=Object.keys(g),l)for(o=d[H],p=0,q=n;p<q.length;p++)r=q[p],h.push({pathStr:r,dimName:o.displayName}),$(null,c,d,f,g[r].itemKeys,h,i,j,k,l,m),h.pop();else{for(s=a.Pzc,t={},u=s[0].xzc,v=s[0].K0b,w=0,x=s;w<x.length;w++)y=x[w],t[y.pathStr]=1,v||(h.push({pathStr:y.pathStr,dimName:u}),$(y,c,d,f,g[y.pathStr].itemKeys,h,i,j,k,l,m),h.pop());for(z=0,A=n;z<A.length;z++)r=A[z],e.Fa(t[r])&&(h.push({pathStr:r,dimName:u}),$(a,c,d,f,g[r].itemKeys,h,i,j,k,!0,m),h.pop())}else B=c.al,C=c.KW,D=b.uWJ(),E=c.bGJ(),F=i-c.GGJ,G=c.BYJ,B.addChildItem(h,D,E,c,m,d,k.rootPosition,c.GGJ,!1,"",!1,0,B.CFJ,j,!1,G.rowNodeInfo),C.addChildItem(da(h,c.GGJ),D,E,c,m,d,k.headerPosition,F,!0,"",!1,0,C.CFJ,j,!1,G.columnNodeInfo)}function _(a,b,c,d,e,f,g){var h,i,j,k={subtotalManager:a,queryItems:b,positionInfo:c,contextList:d,rowDeep:e,pathInfo:[],cacheName:null,itemsMap:g,measure:null,currentNode:a.vGJ(),level:0,parentField:{}};for(h=0,i=f;h<i.length;h++)j=i[h],k.cacheName=j.cacheName,k.measure=j,k.level=0,aa(k)}function aa(a){var b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=a.subtotalManager,K=a.currentNode,L=a.queryItems,M=a.positionInfo,N=a.contextList,O=a.rowDeep,P=a.pathInfo,Q=a.cacheName,R=a.itemsMap,S=a.measure,T=a.level,U=a.parentField,V=J.vGJ(),W=K&&K.Pzc||[],X=J.nLc,Y=!0;if(!(T>=J.fieldNameOrders.length)){if(c=J.originOrders[T],g=J.KTJ,h=g[c],d=X.getField(h),d.HSJ()){if(b=d.SDc,j=J.originOrders.indexOf(g[b]),J.originOrders.indexOf(c)>j&&j>=0)return;for(k=X.getField(b),i=k.GSJ,l=0;l<W.length;)f=W[l],U[b]=d.BBc()[f.pathStr],P.push({pathStr:f.pathStr,dimName:c}),a.currentNode=f,a.level=T+1,aa(a),delete U[b],P.pop(),l++;for(m=0,n=i;m<n.length;m++)if(o=n[m],p=d.aGc[d.EBc[o]],!e.Fa(p)){if(!R[h].isAll&&!R[h].items[p])continue;U[b]=o,P.push({pathStr:p,dimName:c}),ba(V,T+1,L,J,P,Q,M,N,O,R,{fieldName:b,calcItem:o,calcLevel:k.MTJ[k.dGc()[o]]},S,U),P.pop()}}else for(i=d.GSJ,l=0;l<W.length;)if(f=W[l],!f.QTJ||Y){if(i&&i.length>0&&Y){for(q=0,r=i;q<r.length;q++)o=r[q],s=d.dGc()[o],!R[h].isAll&&!R[h].items[s]||U[h]&&U[h].indexOf(o)<0||(P.push({pathStr:s,dimName:c}),ba(V,f.aN,L,J,P,Q,M,N,O,R,{fieldName:h,calcItem:o,calcLevel:d.MTJ[s]},S,U),P.pop());Y=!1}P.push({pathStr:f.pathStr,dimName:c}),a.currentNode=f,a.level=T+1,aa(a),P.pop(),l++}else l+=1;if(!W.length){for(t=0,u=i;t<u.length;t++)o=u[t],v=d.dGc()[o],(R[h].isAll||R[h].items[v])&&(P.push({pathStr:v,dimName:c}),ba(V,T+1,L,J,P,Q,M,N,O,R,{fieldName:h,calcItem:o,calcLevel:d.MTJ[v]},S,U),P.pop());if(s=[],R[h].isAll)for(w=d.BBc(),x=d.dGc(),y=0,z=w;y<z.length;y++)A=z[y],s.push(x[A]);else s=s.concat(Object.keys(R[h].items));for(B=0,C=s;B<C.length;B++){if(v=C[B],P.push({pathStr:v,dimName:c}),a.currentNode=null,a.level=T+1,d.HSJ()&&(b=d.SDc,D=d.kBc[v],p=d.aGc[D],!e.Fa(p)))for(U[b]=[],E=d.EBc,F=Object.keys(E),G=0,H=F;G<H.length;G++)I=H[G],E[I]===D&&U[b].push(I);aa(a),delete U[b],P.pop()}}delete U[b]}}function ba(a,c,f,g,i,j,k,l,m,n,o,p,q){var r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X=g.nLc,Y=g.KTJ;if(c<f.length){if(r=f[c],!r.isDim)return void ba(a,c+1,f,g,i,j,k,l,m,n,o,p,q);if(s=r.sourceName,t=r.displayName,u=void 0,v=void 0,w=X.getField(s),x=w.BBc(),y=!1,w.HSJ()){for(u=w.SDc,z=X.getField(u),A=0,B=i;A<B.length;A++)if(C=B[A],Y[C.dimName]===u){v=z.vzc[C.pathStr],y=!0;break}y?(q[u]=v,x=[w.EBc[v]]):x=w.BBc()}else if(e.Fa(q[s])){for(D=void 0,E=0,F=i;E<F.length;E++)if(C=F[E],D=X.getField(g.KTJ[C.dimName]),D.HSJ()&&D.SDc===s){x=D.tnb[D.kBc[C.pathStr]].slice();break}}else x=[q[s]];for(G=void 0,H=0,I=x;H<I.length;H++)J=I[H],K=w.dGc()[J],(n[s].isAll||n[s].items[K])&&(w.MTJ[K]&&w.MTJ[K]>o.calcLevel&&(G={fieldName:s,calcItem:J,calcLevel:w.MTJ[K]}),i.push({pathStr:K,dimName:t
}),ba(a,c+1,f,g,i,j,k,l,m,n,G||o,p,q),G=void 0,i.pop());delete q[u]}else{if(L=g.yGJ(),M=i.length-m,N=g.bGJ(),O=ha(i),K=h.getPathStr(O,g.fieldNameOrders),P=void 0,Q=ea(g,O,o,p,N),R=Q.value,P=b._Ac(0),fa(P.calc,R),P.calcResult=Q.calcResult,!e.Fa(g.pathPool[K])&&(N=g.pathPool[K],!e.Fa(g.FP[N][j]))){for(ca(g.FP[N][j],P.calc,p.subTotalTypes),S=0,T=p.subTotalTypes;S<T.length;S++)U=T[S],ga(g,O,d.SubtotalType[U],p.cacheName);return}for(a.addChildItem(i,P,N,g,j,f,k.rootPosition,m,!1,"",!1,0,a.CFJ,l,!0),L.addChildItem(da(i,m),P,N,g,j,f,k.headerPosition,M,!0,"",!1,0,L.CFJ,l,!0),g.pathPool[K]=N,g.FP[N][j]=P,V=0,W=p.subTotalTypes;V<W.length;V++)U=W[V],ga(g,O,d.SubtotalType[U],p.cacheName)}}function ca(a,c,d){var e=a.calc,f=e.count,g=e.sum,h=e.product,i=e.max,j=e.min,k=e.sumx2,l=e.len;f=I(f,c.count,0),g=I(g,c.sum,0),h=I(h,c.product,2),i=I(i,c.max,5),j=I(j,c.min,6),k=I(k,c.sumx2,0),l=I(l,c.len,0),a.calc={count:f,sum:g,max:i,min:j,sumx2:k,product:h,len:l},a.calcResult=b.tBc(a.calc,d)}function da(a,b){var c=a.slice(),d=c.splice(0,b);return c.push.apply(c,d),c}function ea(a,b,c,e,g){var h,i,j,k,l=a.nLc,m=c.fieldName,n=c.calcItem,o={},p={},q=l.aCc,r=q.calcService,s=q.calcSource,t=l.LSb(m),u=t.xSJ[n].calcExpression;for(j=0,k=e.subTotalTypes;j<k.length;j++){h=k[j];try{i=d.SubtotalType[h],s.setCalcInfo(i,a,b,e.cacheName,u,g),p[i]=r.lh.evaluateExpression(u,s.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1),isNaN(+p[i])&&(p[i]=0)}catch(a){p[i]=f.Errors.Reference}finally{o[i]=p[i]}}return{calcResult:o,value:p}}function fa(a,b){a&&(a.count=b.countNums,a.len=b.count,a.max=b.max,a.min=b.min,a.product=b.product,a.sum=b.sum,a.sumx2=b.sum2)}function ga(a,b,c,d){var e,f,g,i,j,k,l=a.nLc,m=a.fieldNameOrders,n=h.getPathStr(b,m),o=l.PTJ,p=o[n];p&&(g=l.aCc,i=g.calcService,j=g.calcSource,j.setCalcInfo(c,a,p.pathInfo,d,p.expression),f=i.lh.evaluateExpression(p.expression,j.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1),isNaN(+f)&&(f=0),k=a.FP[p.calcResultIndex],k&&k[d]&&(a.FP[p.calcResultIndex][d].calcResult[c]=f,fa(a.FP[p.calcResultIndex][d].calc,(e={},e[c]=f,e))),ga(a,p.pathInfo,c,d))}function ha(a){var b,c,d,e={};for(b=0,c=a;b<c.length;b++)d=c[b],e[d.dimName]=d.pathStr;return e}function ia(a){var b,c,d,e,f,g,h,i,j={};for(d=0,e=a;d<e.length;d++)if(f=e[d],b=f.isALL)j[f.sourceName]={isAll:f.isALL,items:null};else{for(c={},g=0,h=f.items;g<h.length;g++)i=h[g],c[i]=1;j[f.sourceName]={isAll:f.isALL,items:c}}return j}function ja(a,b){e.Yxc(b,function(b){var c,d=a.HL[b.sourceName],f=d;d.YFc===!1&&(b.databaseField=!1,b.dataFieldIndex=d.$Fc,f=a._Fc(d.$Fc)),d.kBc&&(b.isGroupField=!0,c=e.isEmptyObject(f.Eyc),b.getGroupItem=function(a){var b=c?a:f.vzc[a];return d.aGc[d.lBc(b)]})})}function ka(a,b){var c,d,f,g=[],h=a.HL;for(c=0,d=b.length;c<d;c++)f=h[b[c].sourceName],f&&e.Fa(f.Eyc)&&g.push(f.Cj);a.IGJ(g)}B=function(){function a(a,b){this.nTJ={},this.RTJ=a,this.mi=b,this.nTJ={}}return a.prototype.mL=function(a){var b=this.nTJ;e.Fa(b[a])&&(b[a]=1)},a.prototype.destroy=function(){this.nTJ=null},a}(),b.PivotSlicerCache=B,C=function(){function a(){}return a.prototype.Ha=function(a,b,c){var d,f=!0,g=[],h=[];return e.Yxc(b,function(b){var d,i=!b.isALL;f&&i&&(f=!1),i&&(Array.isArray(b.items[0])?(d=[],e.Yxc(b.items,function(a){d=d.concat(a)}),g.push(d)):(g.push(a.LSb(b.sourceName).getIndexesList(b.items)),c&&h.push(a.LSb(b.sourceName).getFilterIndexesList())))}),d=e.Lyc(g),h=e.Lyc(h),{isALL:f,indexes:d,filterIndexes:h}},a.prototype.mBc=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s=b.isALL,t=b.indexes,u=b.filterIndexes;if(ka(a,c),ja(a,c),f=a.NHJ(d),g=f.normalFieldsInfos,h=f.calcFieldsInfos,i=[],j=new A(c,d,a,g,h),e.Yxc(d,function(a){var b=a.index;i.indexOf(b)===-1&&i.push(b)}),k=a.nBc,l=k.length,s)for(m=0;m<l;m++)j.addItem(k[m],m,!1,a);else{for(n=0,o=t;n<o.length;n++)p=o[n],j.addItem(k[p],p,!1,a);if(u&&u.length>0)for(q=0,r=u;q<r.length;q++)p=r[q],j.addItem(k[p],p,!0,a)}return h.length>0&&j.LHJ(a,h),j},a.prototype.oTJ=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=b.isALL,p=b.indexes,q=a.getField(c),r=a.nBc,s=r.length,t=q.mi,u=q.HSJ();if(u&&(e=this.TUJ(q.Cj,a),t=a.getField(q.SDc).mi),f=new B(c,t),o)for(g=0;g<s;g++)d=u?q.aGc[e[g+""]]:r[g][t],f.mL(d);else for(h=0,i=p;h<i.length;h++)j=i[h],d=u?q.aGc[e[j+""]]:r[j][t],f.mL(d);if(k=a.getCalcItems(c),k.length>0)for(l=0,m=k;l<m.length;l++)n=m[l],j=q.Eyc[n.calcItemName],f.mL(j);return f},a.prototype.TUJ=function(a,b){var c,d,f,g,h,i,j,k,l={},m=b.getField(a),n=m.DBc;if(e.Fa(n))return l;for(c=Object.keys(n),d=0,f=c;d<f.length;d++)for(g=f[d],h=n[g],i=0,j=h;i<j.length;i++)k=j[i],l[k+""]=m.tnb?m.kBc[+g]:g;return l},a}(),b.DataAnalyzer=C,D=function(a,b){for(var c=b+1;c<a.length;c++)if(!a[c].SJJ)return a[c];return i},E=function(a,b){for(var c=b-1;c<b&&c>=0;c--)if(!a[c].SJJ)return a[c];return i},F=function(a){var b,c,d=[],e=[],f=a.length,g=i,h=i;for(b=0,c=f-1;b<f;b++,c--)e[b]=g,g=a[b].SJJ?g:b,d[c]=h,h=a[c].SJJ?h:c;return{preMap:e,nextMap:d}},G=function(){function a(a,b,c,d,e,f,g,h){this.TJJ=0,this.gKJ=0,this.cAc={},this.Pzc=[],this.$zc=b,this.nodeName=a,this.xzc=g,this.EFJ=e,this.IFJ=f,this.QTJ=h,d||(this.GFJ=c.bGJ())}return a.prototype.JGJ=function(a,c){if(this.aN+1<=a){var d=this.EFJ;return""!==d&&(d+=b.Separator),d+c||""}return this.EFJ},a.prototype.KGJ=function(a,c){if(this.aN+1>a){var d=this.IFJ;return""!==d&&(d+=b.Separator),d+c||""}return this.IFJ},a.prototype.LGJ=function(a,c,d,f,g,h){var i,j=this.nodeName;return e.Fa(g.baseFieldName)||this.xzc!==g.baseFieldName||(j=h?this.xzc:g.baseFieldItemShared),i=f&&f.baseMajorPath?f.baseMajorPath:"",this.aN<=d?(""!==i&&(i+=b.Separator),i+j||""):i},a.prototype.UJJ=function(a,c,d,e,f){var g,h,i,j,k=this.aN,l=this.xzc;return e&&(j=e.childMajorPath||"",i=e.baseMajorPath||""),k<=d?(j&&""!==j?j+=b.Separator:j="",this.xzc!==f.baseFieldName&&(l=this.nodeName),k>f.baseRootLevel?(g=j+l,h=j+this.xzc):(g=j+l,h=j+l),{currentMajorPath:g,childMajorPath:h}):{currentMajorPath:i,childMajorPath:j}},a.prototype.MGJ=function(a,b){var c;return c=b&&b.baseMajorPathList?[].concat(b.baseMajorPathList):[],this.aN<=a&&""!==this.nodeName&&c.push(this.nodeName),c},a.prototype.NGJ=function(a,c,d){return!e.Fa(c)&&a.length>=d&&(a[d]=c),a.join(b.Separator)},a.prototype.OGJ=function(a,c,d){return!e.Fa(c)&&a.length>=d&&(a[d]=c),a.join(b.Separator)},a.prototype.PGJ=function(a,b,c){var d,e,f,g;return b.baseRootLevel>-1?(d=b.baseRootLevel+1,this.aN<=d?this.EFJ:a.percentOfBasePath):(e=b.baseHeaderLevel+1,f=void 0,g=void 0,f=this.aN<=e+c?this.GFJ:a.baseIndex,g=this.aN<=e?this.EFJ:a.percentOfBasePath,{baseIndex:f,percentOfBasePath:g})},a.prototype.QGJ=function(a,c,d,f,g,h){var i,j=this.nodeName;return e.Fa(g.baseFieldName)||this.xzc!==g.baseFieldName||(j=h?this.xzc:g.baseFieldItemShared),i=f&&f.baseMinorPath?f.baseMinorPath:"",this.aN>d?(""!==i&&(i+=b.Separator),i+j||""):i},a.prototype.VJJ=function(a,c,d,e,f){var g,h,i,j,k=this.aN,l=this.xzc;return e&&(j=e.childMinorPath||"",i=e.baseMinorPath||""),k>d?(j&&""!==j?j+=b.Separator:j="",this.xzc!==f.baseFieldName&&(l=this.nodeName),k>f.baseHeaderLevel?(g=j+l,h=j+this.xzc):(g=j+l,h=j+l),{currentMinorPath:g,childMinorPath:h}):{currentMinorPath:i,childMinorPath:j}},a.prototype.RGJ=function(a,b){var c;return c=b&&b.baseMinorPathList?[].concat(b.baseMinorPathList):[],this.aN>a&&""!==this.nodeName&&c.push(this.nodeName),c},a.prototype.addChildItem=function(a,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r){var s,t,u,v,w,x,y,z,A,B,C,D;a.length>0?(s=a[0],t=a.slice(1),u=s.pathStr,v=s.dimName,w=0===t.length,x=l,y=void 0,e.Fa(this.cAc[u])&&(z=this.$zc,""!==z&&(z+=b.Separator),this.cAc[u]=this.d3a(u,z+u,f,w,j,u,k,v,q)),y=this.Pzc[this.cAc[u]],y.pathStr=u,y.QFJ=this.GFJ,r&&y.aN<=j&&(e.Fa(r.fieldName)&&(r.fieldName=y.xzc,r.level=y.aN),r.itemKeys=r.itemKeys||{},A=r.itemKeys,e.Fa(A[u])&&(A[u]={}),r=A[u]),y.aN===i&&(y.Zzc=!0),y.bz=m,y.SJJ=y.WJJ(f.collapseItems,m),w?(y.K0b=!0,y.GFJ=d,c&&void 0!==g&&(B=f.aGJ(y.GFJ),e.Fa(B)&&(B={}),e.Fa(B[g])&&(B[g]={calc:H({},c.calc),calcResult:c.calcResult},f.CGJ(y.GFJ,B))),y.oBc=d,p&&p.length>0&&(C=void 0,C=y.aN<j||y.aN===j&&(!y.Pzc||y.Pzc.length<1)?this.EFJ:l,this.nIJ(f,j,p,k),y.nIJ(f,j,p,k),k?y.SGJ(f,p,j,C,o,this.TJJ):y.HGJ(f,p,j,C,o,this.TJJ))):(this.nIJ(f,j,p,k),y.nIJ(f,j,p,k),k||this.aN<j&&(x=this.EFJ),!k&&p?(this.HGJ(f,p,j,l,o,n),y.HGJ(f,p,j,x,o,this.TJJ)):p&&k&&(this.SGJ(f,p,j,l,o,n),y.SGJ(f,p,j,x,o,this.TJJ)),y.addChildItem(t,c,d,f,g,h,i,j,k,x,y.aN!==j&&y.WJJ(f.collapseItems,m),this.TJJ,y.CFJ,p,q,r))):(this.K0b=!0,c&&void 0!==g&&(D=f.aGJ(d),e.Fa(D)&&(D={}),this.oBc=d,D[g]={calc:c.calc,calcResult:c.calcResult},f.AGJ(d,this.EFJ,D,k)),this.oBc=d,this.GFJ=d),p&&p.length>0&&(k?this.SGJ(f,p,j,l,o,n):this.HGJ(f,p,j,l,o,n))},a.prototype.nIJ=function(a,b,c,d){c&&c.length&&this.aN<=b&&(d?a.eGJ[this.EFJ]=this.GFJ:a.dGJ[this.EFJ]=this.GFJ)},a.prototype.HGJ=function(a,b,c,f,g,h){var i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,A,B;if(!this.CFJ)for(this.CFJ={},i=0,j=b;i<j.length;i++)k=j[i],l=k.fieldName,m=k.needBuildBasePath,n=k.needBuildPercentOfPath,o=k.needBuildRunningTotalOrRankPath,p=k.isNextOrPrevious,this.CFJ[l]||(this.CFJ[l]={}),q=this.CFJ[l],r=g?g[l]:{},m&&(q.baseMajorPath=this.LGJ(a,l,c,r,k),q.baseMinorPath=this.QGJ(a,l,c,r,k),e.Fa(k.baseFieldName)||this.xzc!==k.baseFieldName||k.baseFieldItemShared!==this.nodeName?this.TJJ=this.TJJ|h:this.TJJ=this.TJJ|k.showDataAsIndex),p&&(q.baseMajorPathList=this.MGJ(c,r),q.baseMinorPathList=this.RGJ(c,r)),n&&(k.baseRootLevel>-1?q.percentOfBasePath=this.PGJ(r,k,c):(t=this.PGJ(r,k,c),u=t.percentOfBasePath,v=t.baseIndex,q.baseIndex=v,q.percentOfBasePath=u)),o&&(k.showDataAs===d.PivotShowDataAs.rankAscending||k.showDataAs===d.PivotShowDataAs.rankDescending?(w=this.UJJ(a,l,c,r,k),x=w.currentMajorPath,y=w.childMajorPath,q.baseMajorPath=x,q.childMajorPath=y,z=this.VJJ(a,l,c,r,k),A=z.currentMinorPath,B=z.childMinorPath,q.baseMinorPath=A,q.childMinorPath=B):(q.baseMinorPath=this.QGJ(a,l,c,r,k,!0),q.baseMajorPath=this.LGJ(a,l,c,r,k,!0))),p||(q.indexInfo=s(k,this,a,c,f,q))},a.prototype.WJJ=function(a,b){if(b)return!0;var c=this;return!!(a&&a[c.xzc]&&a[c.xzc][c.nodeName])},a.prototype.SGJ=function(a,b,c,d,f,g){var h,i,j,k,l,m,n,o,p,q,r,t,u;if(!this.CFJ)for(this.CFJ={},h=0,i=b;h<i.length;h++)j=i[h],k=j.fieldName,l=j.needBuildRunningTotalOrRankPath,m=j.needBuildPercentOfPath,n=j.isNextOrPrevious,o=j.needBuildBasePath,this.CFJ[k]||(this.CFJ[k]={}),p=this.CFJ[k],q=f?f[k]:{},o&&(p.baseMajorPath=this.LGJ(a,k,c,q,j),p.baseMinorPath=this.QGJ(a,k,c,q,j),e.Fa(j.baseFieldName)||this.xzc!==j.baseFieldName||j.baseFieldItemShared!==this.nodeName?this.TJJ=this.TJJ|g:this.TJJ=this.TJJ|j.showDataAsIndex),l&&(this.CFJ[k].baseMajorPath=this.LGJ(a,k,c,q,j,!0),this.CFJ[k].baseMinorPath=this.QGJ(a,k,c,q,j,!0)),n&&(this.CFJ[k].baseMajorPathList=this.MGJ(c,q),this.CFJ[k].baseMinorPathList=this.RGJ(c,q)),m&&(j.baseRootLevel>-1?this.CFJ[k].percentOfBasePath=this.PGJ(q,j,c):(r=this.PGJ(q,j,c),t=r.percentOfBasePath,u=r.baseIndex,this.CFJ[k].baseIndex=u,this.CFJ[k].percentOfBasePath=t)),n||(this.CFJ[k].indexInfo=s(j,this,a,c,d,this.CFJ[k]))},a.prototype.UFc=function(a,b,c,d,f,g,h,j,k,l,m,n){var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,G,H,I,J,K,L,M,N,O,P=this,Q=c.valuePosition,R=c.valueFieldLength;if(Q===-1&&(R=1),P.iHJ(g),o=this.TGJ(g,d,h,j,k,l,m,n||0),P.Pzc.length>0){for(p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=P.Pzc,y=F(P.Pzc),z=y.preMap,A=y.nextMap,B=x.length-1;B>=0;B--)C=x[z[B]],D=x[A[B]],E=P.Pzc[B],G=E.UFc(a,b,c,d,f,g,C,D,P.Pzc[B-1]||null,P.Pzc[B+1]||null,o,this.TJJ),e.Fa(G)||(H=G.volume,I=G.subtotalVolume,J=G.blankRowVolume,K=G.topBlankRowVolume,L=G.titleRowCount,M=G.topSubtotalVolume,N=G.tabularSubtotalVolume,O=G.tabularTitleRowCount,p+=H,q+=I,r+=J,s+=K,t+=L,u+=M,v+=N,w+=O,G=i);P.aN===a?(P.Vzc=0,P.jAc=0,P.mKJ=0,P.lKJ=0,P.Zzc?(P.Uzc=R,P.iAc=1,P.mKJ=1,P.lKJ=1):(P.Yzc?P.Uzc=0:P.Uzc=1,P.iAc=0,P.kEc=0,P.iOc=0)):P.Zzc?(P.jAc=R,P.Uzc=p*R,P.Vzc=(q+1)*R,P.mKJ=(0===r?1:r)*R+(P.Yzc?0:1),P.lKJ=(0===s?1:s)*R,P.iOc=w*R,P.kEc=(v+1)*R,P.iAc=(t+1)*R+(P.Yzc?0:1)):Q>P.aN?(P.Uzc=p,P.iOc=w,P.jAc=u+R,P.Vzc=q+R,P.mKJ=r+(P.Yzc?0:1),P.lKJ=s,P.kEc=v+R,P.iAc=t+(P.Yzc?0:1)):(P.Uzc=p,P.Vzc=q+1,P.iOc=w,P.kEc=v+1,P.iAc=t+(P.Yzc?0:1),P.mKJ=r+(P.Yzc?0:1),P.aN===a-1?P.lKJ=s+(P.Yzc?0:1):P.lKJ=s,Q===-1&&P.Yzc?P.jAc=u+1:P.jAc=0)}else P.Yzc?P.Uzc=0:Q===a?(P.Uzc=R,P.iAc=1):0===R?P.Uzc=0:P.Uzc=1,P.Vzc=0,P.mKJ=P.Zzc?1:0,P.lKJ=P.Zzc?1:0,P.kEc=0,P.iAc=P.iAc||0,P.iOc=0,P.jAc=0;return f&&f[P.xzc]&&f[P.xzc][this.nodeName]&&(P.Uzc=0,P.Vzc=0,P.mKJ=a>Q&&P.aN<=Q?R:1,P.lKJ=a>Q&&P.aN<=Q?R:1,P.iOc=P.aN<=Q?R:1,P.iAc=P.aN<=Q?R+1:1,P.jAc=0,P.kEc=0),{volume:P.Uzc||0,subtotalVolume:P.Vzc,blankRowVolume:P.mKJ,topBlankRowVolume:P.lKJ||0,titleRowCount:P.iAc||0,topSubtotalVolume:P.jAc||0,tabularSubtotalVolume:P.kEc||0,tabularTitleRowCount:P.iOc||0}},a.prototype.d3a=function(b,c,d,e,f,g,h,i,j){var k=this.JGJ(f,g),l=this.KGJ(f,g),m=new a(b,c,d,e,k,l,i,j);return m.aN=this.aN+1,this.Pzc.push(m)-1},a.prototype.P1J=function(a,b,c){switch(a){case d.SubtotalType.sum:b.sum=c;break;case d.SubtotalType.count:b.len=c;break;case d.SubtotalType.countNums:b.count=c;break;case d.SubtotalType.min:b.min=c;break;case d.SubtotalType.max:b.max=c}},a.prototype.hBc=function(a,c,f,g,h,i,j,k,l,m){var n=this,o=this,p=f.aGJ(o.GFJ);return o.qBc?p:(p||(p={}),e.Yxc(a,function(i){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,J,K,L,M,N,O,P,Q,R,S,T=i.cacheName,U=i.subTotalTypes,V=i.isCalculatedField,W=o.rBc(T,o.$zc,f,g).calc,X={};if(l)for(q=0,r=U;q<r.length;q++){for(s=r[q],t=[],u=0,v=Object.keys(l);u<v.length;u++)w=v[u],t.push({fieldName:w,fieldItem:l[w]});x={fieldInfos:t,valueInfo:{sourceName:T,subtotalType:s}},y=k.Q1J(x),e.Fa(y)||(X[s]=y,o.P1J(s,W,y))}if(z=W.count,A=W.sum,B=W.max,C=W.min,D=W.sumx2,E=W.product,F=W.len,o.Pzc.length>0){if(G=!1,V)j.GHJ(k,p,T),G=!!o.K0b,A=p[T].calc.sum;else{for(H=f.kGJ[o.Pzc[0].xzc],J=o.Pzc.length-1;J>-1;J--)K=o.Pzc[J],K.sBc=J,K.K0b&&1===c[K.oBc]?o.Pzc.splice(J,1):(l&&(l[H]=k.getField(H).BBc()[+K.pathStr]),L=K.hBc(a,c,f,g,h,o.$zc,j,k,l,m)[T],M=L.calc,N=L.hasEffectChild,G=G||N,!M||K.QTJ&&!k.aggregateCalcItem()||(z=I(z,M.count,0),A=I(A,M.sum,0),E=I(E,M.product,2),B=I(B,M.max,5),C=I(C,M.min,6),D=I(D,M.sumx2,0),F=I(F,M.len,0)));l&&delete l[H]}if(n.jHJ(T,f),g||n.VGJ(f,T,h,o.Pzc),O=b.tBc({count:z,sum:A,max:B,min:C,sumx2:D,product:E,len:F},U),Object.keys(X).length>0)for(P=0,Q=Object.keys(X);P<Q.length;P++){switch(w=Q[P],y=X[w],o.P1J(+w,W,y),+w){case d.SubtotalType.sum:A=y;break;case d.SubtotalType.count:F=y;break;case d.SubtotalType.countNums:z=y;break;case d.SubtotalType.min:C=y;break;case d.SubtotalType.max:B=y}O[d.SubtotalType[+w]]=y}p[T]={collapse:n.bz,hasEffectChild:G,calcResult:O,calc:{count:z,sum:A,max:B,min:C,sumx2:D,product:E,len:F}}}else{if(p[T]=p[T]?p[T]:{},p[T].collapse=n.bz,O=b.tBc({count:z,sum:A,max:B,min:C,sumx2:D,product:E,len:F},U),Object.keys(X).length>0)for(R=0,S=Object.keys(X);R<S.length;R++)w=S[R],O[d.SubtotalType[+w]]=X[w];p[T].calcResult=O,p[T].hasEffectChild=!!o.K0b}f.AGJ(o.GFJ,o.$zc,p,g)}),g&&this.aN<=h&&y(f,o,h,a,i,j,k,m,!!l),o.qBc=!0,p)},a.prototype.VGJ=function(a,b,c,d){d.length>0&&this.WGJ(a,b,d)},a.prototype.TGJ=function(a,b,c,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;if(a){if(k=a.oGJ){for(l={},m=0,n=k;m<n.length;m++)o=n[m],p=a.zFJ[o],q=p.baseFieldItemType,r=p.baseHeaderLevel,s=p.baseRootLevel,t=p.actualBaseLevel,q!==d.PivotShowDataAsBaseItemType.item&&(u=q===d.PivotShowDataAsBaseItemType.next,v=void 0,w=void 0,x=b?r:t,b&&r+1===this.aN||!b&&t===this.aN?(u?(v=f&&f.nodeName,w=h&&h.nodeName,f?this.TJJ=this.TJJ|j:(this.TJJ=this.TJJ|p.showDataAsIndex,this.gKJ=this.gKJ|p.showDataAsIndex)):(v=c&&c.nodeName,w=g&&g.nodeName,c?this.TJJ=this.TJJ|j:(this.TJJ=this.TJJ|p.showDataAsIndex,this.gKJ=this.gKJ|p.showDataAsIndex)),l[o]=v):x<this.aN&&i&&(v=i[o],l=i,this.TJJ=this.TJJ|j),y=v,e.Fa(w)||(y=w),z=this.NGJ(this.CFJ[o].baseMajorPathList||[],y,b?r:s),A=this.OGJ(this.CFJ[o].baseMinorPathList||[],y,b?s:r),this.CFJ[o].baseMajorPath=z,this.CFJ[o].baseMinorPath=A,delete this.CFJ[o].baseMajorPathList,delete this.CFJ[o].baseMajorPathList,this.CFJ[o].indexInfo={baseMajorPath:z,baseMinorPath:A});return l}return i}},a.prototype.XGJ=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=a.pGJ[b];if(n)for(d=0,e=n;d<e.length;d++)for(f=e[d],g=a.zFJ[f].subtotalText,h=0,i=c;h<i.length;h++)j=i[h],k=j.CFJ[f],l=k.baseMinorPath,m=k.baseMajorPath,a.$FJ(f,m,l,j.GFJ,b,g)},a.prototype.WGJ=function(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(0!==c.length&&(e=c[0].K0b,f=a.qGJ[b]))for(g=0,h=f;g<h.length;g++)if(i=h[g],j=a.zFJ[i],k=j.subtotalText,l=j.baseHeaderLevel,m=j.showDataAs,(e||!(l>-1))&&!(c[0].aN<a.GGJ))for(n=0,o=c;n<o.length;n++)p=o[n],q=p.CFJ[i],r=q.baseMajorPath,s=q.baseMinorPath,m===d.PivotShowDataAs.percentOfRunningTotal?a.ZFJ(i,r,s,p.GFJ,b,k):a.$FJ(i,r,s,p.GFJ,b,k)},a.prototype.iHJ=function(a){var b,c,d,e,f,g,h,i,j,k,l;if(this.cAc&&0!==this.Pzc.length){if(b=[],c=this.Pzc[0].xzc,d=a.EGJ,e=a.FGJ,f=a.jGJ(c,d),g=a.kGJ[c]||c,h=e[g],f){for(i=0,j=this.Pzc;i<j.length;i++)k=j[i],l=k.nodeName,b[f[l]]=k;return 1===h&&b.reverse(),this.Pzc=b.filter(function(a){return a}),b=null,delete this.cAc,!0}return!1}},a.prototype.jHJ=function(a,b){if(this.cAc&&0!==this.Pzc.length){var c;return b.DGJ&&b.DGJ[this.xzc]&&(c=b.DGJ[this.xzc].subtotalText),!(!c||a!==b.DGJ[this.xzc].cacheName)&&(this.Pzc.sort(function(d,e){return b.aGJ(d.GFJ)[a].calcResult[c]-b.aGJ(e.GFJ)[a].calcResult[c]}),delete this.cAc,!0)}},a.prototype.TFc=function(a,c,f,g,h,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this,F=null,G=!1,H=a.cacheName,J=0,K=0,L=[],M=0,N=-(1/0),O=1/0,P=0,Q=1;if(E.Pzc.length>0)if(E.Pzc[0].xzc===c&&(k=f,F=k.condition,l=k.subTotalType,G=F.uBc===d.PivotConditionType.top10),G){for(m=[],n=void 0,o=[],e.Yxc(E.Pzc,function(e,k){var n,p,q=e.TFc(a,c,f,g,h,j),r=q.calc,s=q.indexList;o.push({calc:r,indexList:s}),n=b.tBc(r,[l]),p=n[d.SubtotalType[l]],m.push({index:k,value:p}),n=i}),n=F.evaluate(m),p=E.Pzc.length-1;p>-1;p--)if(n[p])q=o[p].calc,J+=q.count,M=I(M,q.sum,0),Q=I(Q,q.product,2),N=I(N,q.max,5),O=I(O,q.min,6),P=I(P,q.sumx2,0),K+=q.len;else{for(r=0,s=o[p].indexList;r<s.length;r++)t=s[r],g[t]=1;E.Pzc.splice(p,1)}o=i}else for(p=E.Pzc.length-1;p>-1;p--)if(u=E.Pzc[p],u.K0b&&1===g[u.oBc])E.Pzc.splice(p,1);else if(v=u.TFc(a,c,f,g,h,j),q=v.calc,w=v.indexList,0!==u.Pzc.length||u.K0b){if(!(E.aN<h)&&w&&q){if(x=!0,F&&(y=b.tBc(q,[l]),z=y[d.SubtotalType[l]],x=k.condition.evaluate(z),y=i),x)J+=q.count,M=I(M,q.sum,0),Q=I(Q,q.product,2),N=I(N,q.max,5),O=I(O,q.min,6),P=I(P,q.sumx2,0),K+=q.len,L=L.concat(w);else{for(A=0,B=w;A<B.length;A++)t=B[A],g[t]=1;E.Pzc.splice(p,1)}w=i,q=i}}else E.Pzc.splice(p,1);else if(E.K0b)return C=j.aGJ(E.GFJ)[H].calc,D=!0,F&&(y=b.tBc(C,[l]),z=y[d.SubtotalType[l]],D=k.condition.evaluate(z),y=i),D?{calc:C,indexList:[E.oBc]}:(g[E.oBc]=1,i);return{calc:{count:J,sum:M,product:Q,max:N,min:O,sumx2:P,len:K},indexList:L}},a.prototype.rBc=function(a,b,c,d){var e,f,g,h,j,k,l,m=c.aGJ(this.GFJ);return m||(m={}),m[a]&&this.K0b||(e=i,f=i,g=i,h=i,j=i,k=i,l=i,m[a]={calc:{count:f,sum:h,max:j,min:k,sumx2:l,product:e,len:g}}),c.AGJ(this.GFJ,b,m,d),m[a]},a.prototype.WDc=function(a,b,c){var d,e,f,g=i,h=b[a.xzc];return h&&(d=h.conditionBySourceName,e=h.condition,f=c[h.conditionByName],g={valueFieldName:d,condition:e,subTotalType:f}),g},a.prototype.VDc=function(){var a={};e.Yxc(this.Pzc,function(b,c){a[b.nodeName]=c}),this.cAc=a},a}(),b.QueryNode=G},"./src/overwrite-list.ts":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./pivot-entry.ts"),e=function(){function a(){var a=this;a.R1J=[],a.S1J=[]}return a.prototype.setOverwriteNode=function(a,b){var c,e,f=this;"number"==typeof b&&(c=f.getOverwriteNode(a),d.Fa(c)?(f.R1J.push(d._AJ(a)),f.S1J.push(b)):(e=f.R1J.indexOf(c),f.S1J[e]=b))},a.prototype.getOverwriteValue=function(a){var b,c=this,e=a.fieldInfos,f=a.valueInfo;return d.Yxc(c.R1J,function(a,d){if(c.T1J(e,a.fieldInfos)&&c.U1J(f,a.valueInfo))return b=c.S1J[d],!0}),b},a.prototype.getOverwriteNode=function(a){var b,c=this,e=a.fieldInfos,f=a.valueInfo;return d.Yxc(c.R1J,function(a){if(c.T1J(e,a.fieldInfos)&&c.U1J(f,a.valueInfo))return b=a,!0}),b},a.prototype.removeOverwriteNode=function(a){var b,c=this,e=c.getOverwriteNode(a);d.Fa(e)||(b=c.R1J.indexOf(e),c.R1J.splice(b,1),c.S1J.splice(b,1))},a.prototype.getOverwriteList=function(){var a,b,c=this,e=[],f=c.R1J;for(a=0;a<f.length;a++)b=d._AJ(f[a]),e.push({fieldInfos:b.fieldInfos,valueInfo:b.valueInfo,value:c.S1J[a]});return e},a.prototype.toJSON=function(){return this.isEmpty()?null:this.getOverwriteList()},a.prototype.fromJSON=function(a){var b=this;b.reset(),a&&a.length>0&&d.Yxc(a,function(a){var c=a.fieldInfos,d=a.valueInfo,e=a.value;b.setOverwriteNode({fieldInfos:c,valueInfo:d},e)})},a.prototype.isEmpty=function(){return!this.S1J||0===this.S1J.length},a.prototype.reset=function(){this.R1J=[],this.S1J=[]},a.prototype.dispose=function(){this.R1J=null,this.S1J=null},a.prototype._3J=function(a){return a&&a.sort(function(a,b){return a.fieldName===b.fieldName?a.fieldItem>b.fieldItem?1:-1:a.fieldName>b.fieldName?1:-1})},a.prototype.T1J=function(a,b){var c,d,e,f=this._3J(a),g=this._3J(b);if(!f||!g||f.length!==g.length)return!1;for(c=0;c<f.length;c++)if(d=f[c],e=g[c],d.fieldName!==e.fieldName||d.fieldItem!==e.fieldItem)return!1;return!0},a.prototype.U1J=function(a,b){return a&&b&&a.sourceName===b.sourceName&&a.subtotalType===b.subtotalType},a}(),b.OverwriteList=e},"./src/pivot-cache.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./pivot-entry.ts"),e=c("Common"),f=c("./src/pivot-interface.ts"),g=c("./src/pivot-util.ts"),h=c("./src/pivot-sort.ts"),i=c("./src/pivot-calc-engine.ts"),j=c("./src/overwrite-list.ts"),k=c("./src/pivot-util.ts"),l=null,m=new e.Common.ResourceManager(d.SR),n=m.getResource.bind(m),o=e.Common.CultureManager;function t(a){return a instanceof Date?g.formatDateToString(a):isNaN(a)?a:""+a}p=e.Common.D;function u(a,b){var c;switch(a){case"b":c=b?"1":"0";break;case"d":c=g.AIc(new Date(b));break;case"e":c=b._calcError;break;default:c=b}return g.xmlEncode(c)}q=function(){function a(a){var b=this;b.ny=a.dataType,b.Cj=t(a.name),b.vBc={},b.ny!==f.PivotDataType.number&&(b.Eyc={}),b.GSJ=[],b.STJ={},b.xSJ={},b.vzc=[],b.mi=a.index,b.MTJ={},b.KiK={}}return a.prototype.addCalcItem=function(a,b){var c,d,e=this,f=e.vzc,g=f.indexOf(a);g<0&&(g=f.push(a)-1),c=e.vBc,c[g]=[],d=e.Eyc,d[a]=g,e.MTJ[g]=b,e.YGJ()},a.prototype.hasCalcItem=function(){return!!this.GSJ.length},a.prototype.HSJ=function(){return!!this.SDc},a.prototype.zSJ=function(){return this.GSJ.concat()},a.prototype.removeCalcItem=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=o.vzc,q=p.indexOf(a);if(!(q<0)){for(p.splice(q,1),b=o.vBc,delete b[q],c=Object.keys(b),d=0,e=c;d<e.length;d++)f=e[d],g=+f,g>q&&(b[g-1]=b[f]);for(h=o.MTJ,delete h[q],i=Object.keys(h),k=0,l=i;k<l.length;k++)m=l[k],j=+m,j>q&&(h[j-1]=h[j],delete h[j]);for(n=o.Eyc,delete n[a],q;q<p.length;q++)n[p[q]]--;o.YGJ()}},a.prototype.LTJ=function(a){var b=this,c=b.Eyc;return c[a]},a.prototype.wBc=function(a){return this.ny!==f.PivotDataType.date||g.Fa(a)?a:g.AIc(a)+""},a.prototype.xBc=function(a,b){var c=this;return c.ny!==f.PivotDataType.number?c.zBc(a,b):void c.yBc(a,b)},a.prototype.EMJ=function(a){return g.Fa(a)||a===n().blank},a.prototype.iDc=function(a,b){var c,d,e,h,i=this,j=i.ny,k=i.vzc,l=i.Eyc,m=l&&l.length>0,o=n().blank;if(k&&k.length>0){for(d=i.EMJ(k[0]),e=0;e<k.length;e++)h=m?l[k[e]]:k[e],"number"==typeof h?(a.containsNumber=!0,isFinite(h)&&Math.floor(h)===h||(c=!1),g.Fa(a.minValue)?a.minValue=h:a.minValue=Math.min(h,a.minValue),g.Fa(a.maxValue)?a.maxValue=h:a.maxValue=Math.max(h,a.maxValue)):j===f.PivotDataType.date?"string"!=typeof h||isNaN(Date.parse(h))?g.Fa(h)||h===o||(a.containsNonDate=!0):(a.containsDate=!0,g.Fa(a.minDate)?a.minDate=h:a.minDate=Date.parse(h)<Date.parse(a.minDate)?h:a.minDate,g.Fa(a.maxDate)?a.maxDate=h:a.maxDate=Date.parse(h)>Date.parse(a.minDate)?h:a.maxDate):"string"==typeof h&&h!==o&&(a.containsString=!0),(g.Fa(h)||h===o)&&(a.containsBlank=!0);a.containsNumber===!0&&c!==!1&&(a.containsInteger=!0),(j!==f.PivotDataType.string||d)&&g.Fa(a.containsString)&&(a.containsString=!1),j===f.PivotDataType.date&&g.Fa(a.containsNonDate)&&(a.containsNonDate=!1)}},a.prototype.xjK=function(a,b){var c=this,d=b.containsString,e=b.containsNumber,g=b.containsDate,h=b.containsBlank,i=0;d&&i++,e&&i++,g&&i++,i>1&&(a.containsMixedTypes="1"),d&&a.containsMixedTypes||c.ny===f.PivotDataType.string||h||(a.containsSemiMixedTypes="0")},a.prototype.yjK=function(a){var b,c,d,e,h,i,j,k,l,m,o,p,q,r=this,s=r.ny,t=r.vzc,u=r.Eyc,v=u&&u.length>0,w=n().blank,x={};if(t&&t.length>0){for(b=void 0,c=void 0,d=void 0,e=void 0,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,m=void 0,o=r.EMJ(t[0]),p=0;p<t.length;p++)q=v?u[t[p]]:t[p],"number"==typeof q?(j=!0,isFinite(q)&&Math.floor(q)===q||(k=!1),l=g.Fa(l)?q:Math.min(q,l),m=g.Fa(m)?q:Math.max(q,m)):s===f.PivotDataType.date?"string"!=typeof q||isNaN(Date.parse(q))?g.Fa(q)||q===w||(d=!0):(e=!0,h=g.Fa(h)?q:Date.parse(q)<Date.parse(h)?q:h,i=g.Fa(i)?q:Date.parse(q)>Date.parse(i)?q:i):"string"==typeof q&&q!==w&&(c=!0),(g.Fa(q)||q===w)&&(b=!0);j===!0&&k!==!1&&(k=!0),(s!==f.PivotDataType.string||o)&&g.Fa(c)&&(c=!1),s===f.PivotDataType.date&&g.Fa(d)&&(d=!1),a.count=t.length+"",e&&(a.containsDate="1"),d===!1&&(a.containsNonDate="0"),c===!1&&(a.containsString="0"),b&&(a.containsBlank="1"),j&&!e&&(a.containsNumber="1"),k&&!e&&(a.containsInteger="1"),e?(a.minDate=g.AIc(new Date(h)),a.maxDate=g.AIc(new Date(i))):(j||k)&&(a.minValue=l,a.maxValue=m),x={containsString:c,containsNumber:j,containsDate:e,containsBlank:b}}return x},a.prototype.jDc=function(a){var b=this,c=a.containsString,d=a.containsNumber,e=a.containsDate,g=a.containsBlank,h=0;c&&h++,d&&h++,e&&h++,h>1&&(a.containsMixedTypes=!0),a.containsString&&a.containsMixedTypes?a.containsSemiMixedTypes=!0:b.ny===f.PivotDataType.string||g||(a.containsSemiMixedTypes=!1)},a.prototype.yBc=function(a,b){var c=this,d=c.vBc,e=c.wBc(a),f=c.vzc;g.Fa(c.cCc)&&(c.cCc=a),g.Fa(c.bCc)&&(c.bCc=a),c.cCc=c.cCc<a?a:c.cCc,c.bCc=c.bCc>a?a:c.bCc,d[e]||(d[e]=[],f.push(e)),d[e].push(b)},a.prototype.zBc=function(a,b,c){var d,e,f,h=this,i=h.vBc,j=h.Eyc,l=h.vzc,m=h.KiK;if(c&&2===h.ny&&(a=k.MlK(a)),d=a,g.Fa(a))d=n().blank;else if(2===h.ny){if("object"==typeof d)try{h.cCc=h.cCc<a?a:h.cCc,h.bCc=h.bCc>a?a:h.bCc,d=g.formatDateToString(a)}catch(b){d=a}}else d=h.wBc(a);return g.Fa(d)&&(d=n().blank),f=j[d],g.Fa(f)&&(f=m[(d+"").toLowerCase()]),g.Fa(f)?(e=l.push(d)-1,j[d]=e,m[(d+"").toLowerCase()]=e):e=f,g.Fa(i[e])&&(i[e]=[]),i[e].push(b),e},a.prototype.ABc=function(a,b){var c=this,d=c.vBc;d[a]||(d[a]=[]),d[a].push(b)},a.prototype.tHJ=function(){for(var a,b,c=this,e=c.vzc,f=0,g=e[f],h=e.length;f<h&&(!g||isNaN(Date.parse(g)));)f++,g=e[f];for(a=d.parseStringToDate(g),b=d.parseStringToDate(g);f<h;f++)g=d.parseStringToDate(e[f]+""),a=g<a?g:a,b=g>b?g:b;c.bCc=a,c.cCc=b},a.prototype.dWJ=function(){for(var a,b,c=this,d=c.vzc,e=0,f=d[e],h=d.length-1;e<h&&(g.Fa(f)||isNaN(+f));)e++,f=d[e];for(a=f,b=f;e<d.length;e++)f=d[e],a=f<a?f:a,b=f>b?f:b;c.bCc=a,c.cCc=b},a.prototype.getFieldsItemList=function(){return this.BBc().concat()},a.prototype.getIndexesList=function(a){var b,c,d,e=this.CBc(),f=[];for(b=0,c=a;b<c.length;b++)d=c[b],g.Fa(e[d])||(f=f.concat(e[d]));return f},a.prototype.getFilterIndexesList=function(){var a,b,c,d=this.CBc(),e=[],f=Object.keys(d);for(a=0,b=f;a<b.length;a++)c=b[a],g.Fa(d[c])||(e=e.concat(d[c]));return e},a.prototype.BBc=function(){return[].concat(this.kBc?this.kBc:this.vzc)},a.prototype.CBc=function(){return this.DBc?this.DBc:this.vBc},a.prototype.dGc=function(){return this.aGc?this.aGc:this.Eyc},a.prototype.lBc=function(a){var b=this,c=b.ny;return b.EBc?b.EBc[a]:c===f.PivotDataType.number?g.getNumberGroupItemKey(b,a):c===f.PivotDataType.date?g.getDateGroupItemKey(b,a):void 0},a.prototype.FBc=function(a,b){var c,d=this;d.tnb=a,c=d.EBc={},g.Yxc(Object.keys(a),function(b){g.Yxc(a[b],function(a){c[a]=b})}),g.Yxc(b,function(a){g.Fa(c[a])&&(c[a]=a)})},a.prototype.iGc=function(){var a=this;delete a.bCc,delete a.cCc,delete a.dCc,delete a.SDc,delete a.kBc,delete a.DBc,delete a.aGc,delete a.YFc,delete a.$Fc,delete a.jGc},a.prototype.YGJ=function(){var a,b,c,d=this,e={},i=d.ny,j=d.BBc(),k=d.dGc();if(a=j.length>1e3&&!d.needSort?j.concat():h.ZGJ(j.concat(),{sortType:f.SortType.asc,isDate:i===f.PivotDataType.date,isNumberGroup:i===f.PivotDataType.number&&!g.Fa(d.kBc),by:d.dCc}),a&&a.length>0){for(b=0,c=a.length;b<c;b++)e[k[a[b]]]=b;d.$GJ=e}else d.$GJ=l},a.prototype.dispose=function(){var a=this;a.vBc=l,a.vzc=l,a.$GJ=l,a.Eyc=l,a.kBc=l,a.DBc=l,a.aGc=l,a.EBc=l,a.wBc=l,a.HJJ=l,a.Lqa=l,a.TjK=l,a.tnb=l,a.jGc=l,a.PHJ=l},a.prototype.fromJson=function(a,b){var c,e,f,h,i=this;if(g.Fa(a.name)||(i.Cj=a.name),g.Fa(i.ny)&&!g.Fa(b)&&(i.ny=E(b.type)),c=a.entities,c&&c.length>0)for(i.Eyc||(i.Eyc={}),i.vzc=[],e=n().blank,f=void 0,h=0;h<c.length;h++)c[h].isUnusedItem||(f=c[h].value,g.Fa(f)&&(f=e),2!==i.ny||isNaN(Date.parse(f))||(f=g.formatDateToString(new Date(f))),"object"!=typeof f||g.Fa(f._error)&&g.Fa(f._calcError)||(f=d.ErrorsMap[f._code]||d.ErrorsMap[0]),i.vzc.push(f),i.Eyc[f]=h)},a.prototype.cdK=function(a,b){var c,e,f,h,i,j=this;if(g.Fa(a.name)||(j.Cj=a.name),g.Fa(j.ny)&&!g.Fa(b)&&(j.ny=E(b.n_)),c=g.JcK(a,"sharedItems"),e=c&&c.c_,e&&e.length>0)for(j.Eyc||(j.Eyc={}),j.vzc=[],f=n().blank,h=void 0,i=0;i<e.length;i++)e[i].u||(h=X(e[i].n_,e[i].v),g.Fa(h)&&(h=f),2!==j.ny||isNaN(Date.parse(h))||(h=g.formatDateToString(new Date(h))),"object"!=typeof h||g.Fa(h._error)&&g.Fa(h._calcError)||(h=d.ErrorsMap[h._code]||d.ErrorsMap[0]),j.vzc.push(h),j.Eyc[h]=i)},a.prototype.toJson=function(a){var b,c,d,e,h,i,j,k,l,m,o,p,q=this,r=g.Fa(q.Lqa)?{}:q.Lqa,s=n().blank;if(g.Fa(q.Cj)||(r.name=q.Cj),g.Fa(q.mi)||(r.mi=q.mi),g.Fa(q.Yw)||(r.formula=q.Yw,r.databaseField=!1),q.YFc===!1&&(r.databaseField=!1),q.hasCalcItem()&&q.ny===f.PivotDataType.date&&(r.containsMixedTypes=!0,r.containsString=!0),r.databaseField!==!1&&(q.iDc(r,a),q.jDc(r)),g.isEmptyObject(q.Eyc))r.entities=[];else if(b=r.entities=[],c=q.vzc,c&&c.length>0){for(d=G(q.ny),e={},h=!1,i=0;i<c.length;i++)j=c[i],k=H(j,d),"e"===k?j=j&&j.toJSON&&j.toJSON()||j._error:h=!0,l=(j+"").toLowerCase(),e[l]||(g.Fa(j)||j===s?b.push({type:"m"}):b.push({type:k,value:j,isCalculatedItem:!!q.xSJ[j]}),e[l]=!0);h||(r.entities=[])}return m=a&&a.getField(q.SDc),o=m&&m.mi,q.kBc&&(g.Fa(q.bCc)?g.isEmptyObject(q.tnb)||(r.fieldGroup={base:o},x(q,m,r)):"number"==typeof q.bCc?(r.fieldGroup={startNum:q.bCc,endNum:q.cCc,groupInterval:q.dCc,base:o,hasRangeGroup:!0},r.fieldGroup.groupItems=v(q.bCc,q.cCc,q.dCc)):q.bCc instanceof Date&&(r.fieldGroup={startDate:q.bCc.getTime(),endDate:q.cCc.getTime(),groupBy:U(q.dCc),base:o,hasRangeGroup:!0},q.kBc&&(p=q.kBc.concat(),p=w(q.bCc,q.cCc,p,r.fieldGroup),r.fieldGroup.groupItems=p))),r},a.prototype.bdK=function(a){var b,c,e,h,i,j,k,l,m,o,p,q,r,s,t,v,w,x,B,C,D=this,E=g.Fa(D.TjK)?{n_:"cacheField",c_:[]}:D.TjK,F=n().blank,I={n_:"sharedItems"};if(g.Fa(D.mi)||(E.mi=D.mi),g.Fa(D.Cj)||(E.name=g.xmlEncode(D.Cj)),g.Fa(D.Yw)||(E.formula=g.xmlEncode(D.Yw),E.databaseField="0"),D.YFc===!1&&(E.databaseField="0"),D.hasCalcItem()&&D.ny===f.PivotDataType.date&&(I.containsMixedTypes=1,I.containsString=1),"0"!==E.databaseField&&(b=D.yjK(I),D.xjK(I,b)),c=[],!g.isEmptyObject(D.Eyc)&&(e=D.vzc,e&&e.length>0)){for(h=G(D.ny),i={},j=!1,k=0;k<e.length;k++)l=e[k],m=H(l,h),"e"===m?l=l&&l.toJSON&&l.toJSON()||l._error:j=!0,o=(l+"").toLowerCase(),i[o]||(g.Fa(l)||l===F?c.push({n_:"m"}):(p={n_:m,v:u(m,l)},D.xSJ[l]&&(p.f=1),c.push(p)),i[o]=!0);j||(c=[])}return c.length>0&&(I.c_=c,I.count=c.length,E.c_.push(I)),q=a&&a.getField(D.SDc),r=q&&q.mi,D.kBc&&(t={n_:"fieldGroup",base:r,c_:[]},g.Fa(D.bCc)?g.isEmptyObject(D.tnb)||(x=A(D,q),B=x.discretePrs,C=x.discreteGroup,t.c_.push({n_:"groupItems",count:C.length,c_:C}),t.c_.push({n_:"discretePr",count:B.length,c_:B})):"number"==typeof D.bCc?(v={n_:"rangePr",groupInterval:D.dCc+"",startNum:D.bCc+"",endNum:D.cCc+""},s=y(D.bCc,D.cCc,D.dCc),w={n_:"groupItems",c_:s,count:s.length},t.c_.push(v),t.c_.push(w)):D.bCc instanceof Date&&(v={n_:"rangePr",groupBy:U(D.dCc),
startDate:g.AIc(D.bCc),endDate:g.AIc(D.cCc)},s=D.kBc.concat(),s=z(D.bCc,D.cCc,s,v),w={n_:"groupItems",c_:s,count:s.length},t.c_.push(v),t.c_.push(w)),d.NcK(t,["rangePr","discretePr","groupItems"]),E.c_.push(t)),d.NcK(E,["sharedItems","fieldGroup"]),E},a.prototype.jGJ=function(){return this.$GJ},a}(),b.PivotCacheField=q;function v(a,b,c){var d=[];for(d.push({type:"s",value:"&lt;"+a});a-1+c<=b;)d.push({type:"s",value:a+g.NUMBER_GROUP_SEPARATOR+(a-1+c)}),a+=c;return d.push({type:"s",value:a+g.NUMBER_GROUP_SEPARATOR+(a-1+c)}),a+=c,d.push({type:"s",value:"&gt;"+a}),d}function w(a,b,c,e){var f,h;for(c&&c[0]===d.LESS+g.formatDateToString(a)?(c[0]="&lt;"+g.formatDateToString(a),e.autoStart=!1):c.unshift("&lt;"+g.formatDateToString(a)),c&&c[c.length-1]===d.MORE+g.formatDateToString(b)?(c[c.length-1]="&gt;"+g.formatDateToString(b),e.autoEnd=!1):c.push("&gt;"+g.formatDateToString(b)),f=[],h=0;h<c.length;h++)f.push({type:"s",value:c[h]});return f}function x(a,b,c){var d,e,f,g=a.tnb,h=c.fieldGroup.groupItems=[],i={},j=c.fieldGroup.discreteGroup=[];for(d in g)g.hasOwnProperty(d)&&(h.push({type:"s",value:d}),i[d]=h.length-1);for(e=0;e<b.vzc.length;e++)f=b.vzc[e],j.push(i[a.EBc[f]])}function y(a,b,c){var d=[];for(d.push({n_:"s",v:"&lt;"+a});a-1+c<=b;)d.push({n_:"s",v:a+g.NUMBER_GROUP_SEPARATOR+(a-1+c)}),a+=c;return d.push({n_:"s",v:a+g.NUMBER_GROUP_SEPARATOR+(a-1+c)}),a+=c,d.push({n_:"s",v:"&gt;"+a}),d}function z(a,b,c,e){var f,h;for(c&&c[0]===d.LESS+g.formatDateToString(a)?(c[0]="&lt;"+g.formatDateToString(a),e.autoStart="0"):c.unshift("&lt;"+g.formatDateToString(a)),c&&c[c.length-1]===d.MORE+g.formatDateToString(b)?(c[c.length-1]="&gt;"+g.formatDateToString(b),e.autoEnd="0"):c.push("&gt;"+g.formatDateToString(b)),f=[],h=0;h<c.length;h++)f.push({n_:"s",v:c[h]});return f}function A(a,b){var c,d,e,f=a.tnb,g=[],h={},i=[];for(c in f)f.hasOwnProperty(c)&&(i.push({n_:"s",v:c}),h[c]=i.length-1);for(d=0;d<b.vzc.length;d++)e=b.vzc[d],g.push({n_:"x",v:h[a.EBc[e]]});return{discreteGroup:i,discretePrs:g}}function B(a,b,c,d){if(g.Fa(d[b.Cj+c])){var e=a.push({cacheName:b.Cj,index:b.mi,dataFieldIndex:b.$Fc,subTotalType:c})-1;d[b.Cj+c]=e}}r=function(){function a(a,b,c,d){var e,f=this;f.nBc=c?Array(c.length):[],f.Cj=a,f.GBc=b,f.HL={},f.ZFc=0,f.XDc=d,f.TTJ=0,f.FSJ=!0,b&&c&&(e=b.map(function(a){return f.HBc(a)}),f.zY(e,c)),f.ev()}return a.prototype.hasCalcItem=function(a){var b,c,d,e,f=this;for(c=0,d=a;c<d.length;c++)if(e=d[c],e.isDim&&(b=f.getField(e.sourceName),b.HSJ()&&(b=f.getField(b.SDc)),b.GSJ.length>0))return!0;return!1},a.prototype.aggregateCalcItem=function(a){var b=this;return g.Fa(a)?b.FSJ:void(b.FSJ=!!a)},a.prototype.setUntreatedNodeInfo=function(a,b,c,d,e){var f=this,g=J(a,c);f.PTJ||(f.PTJ={}),f.PTJ[g]={calcResultIndex:e,expression:d,pathInfo:b}},a.prototype.getPivotCalcService=function(){var a=this;return a.aCc},a.prototype.ev=function(){var a=this;a.aCc=new i.PivotCalcService,a.vDJ=new i.PivotCalcSource(a.aCc),a.vDJ.setPivotCache(a),a.aCc.OHJ(a.vDJ)},a.prototype.getDataRefer=function(){return this.XDc},a.prototype.getHeaderList=function(){var a,b,c,d=this,e=d.HL,h=[];for(c in e)p(e,c)&&(a=e[c],b={name:a.Cj,dataType:a.ny,index:a.mi},g.Fa(a.Yw)||(b.fieldType=f.PivotSourceFieldType.isCalcField),g.Fa(a.SDc)||(b.fieldType=f.PivotSourceFieldType.isGroupField),h[a.mi]=b);return h.slice()},a.prototype.EHJ=function(){var a,b,c,d,e=this;if(g.Fa(e.GBc)){b=e.HL,c=void 0,a=[];for(d in b)p(b,d)&&(c=b[d],a[c.mi]={name:c.Cj,dataType:c.ny,index:c.mi});e.GBc=a}},a.prototype.XLc=function(a,b){var c,d,e,f,h,i,j,k,l,m,o,p,q,r,s,t=this,u=[],v=[],w=t.getHeaderList(),x=t.nBc,y=[],z=t.HL,A=[],B=[],C=n().blank;for(j=0,k=w;j<k.length;j++)l=k[j],i=z[l.name],i.HSJ()&&l.name!==i.SDc||!g.Fa(i.Yw)?v.push(l.index):y.push(l.name),A.push(i.vzc),h=i.Eyc,h&&Object.keys(h).length>0?B.push(1):B.push(0);if(u.push(y),y=[],b)for(m=0,o=x;m<o.length;m++){for(l=o[m],d=l.slice(0),e=d.length,c=0,p=0;p<e;p++)v.indexOf(p)>-1||(B[p]?(f=A[p][d[p]],f===C&&(f=null),y[c]=f):y[c]=d[p]===C?null:d[p],c++);u.push(y),y=[]}else for(q=0,r=a;q<r.length;q++){for(s=r[q],d=x[s].slice(),e=d.length,c=0,p=0;p<e;p++)v.indexOf(p)>-1||(B[p]?(f=A[p][d[p]],f===C&&(f=null),y[c]=f):y[c]=d[p]===C?null:d[p],c++);u.push(y),y=[]}return u},a.prototype.qLc=function(a,b){var c,d,e,h,i,j,k,m,n,o,p,q,r,s=this,t=s.rLc,u=s.hNc(),v=s.getCalcItems();for(v.sort(function(a,b){return a.priority-b.priority}),c=[],d=0;d<u.length;d++)u[d]&&c.push({name:u[d].Cj,formula:u[d].Yw});if(e=s.aCc,h=s.XDc,s.dispose(),s.aCc=e,s.XDc=h,s.nBc=[],s.GBc=a,s.ZFc=0,s.TTJ=0,s.O1J&&s.O1J.dispose(),s.O1J=l,a&&b&&(i=a.map(function(a){return s.HBc(a)}),s.zY(i,b)),s.ev(),g.Fa(t)||s.sLc(t),c.length>0)for(d=0;d<c.length;d++)s.addCalcField(c[d].name,c[d].formula);for(k={},m=0,n=v;m<n.length;m++)o=n[m],j=s.getField(o.sourceName),j.ny===f.PivotDataType.number&&(k[o.sourceName]=!0);Object.keys(k).length>0&&D(s,k);try{for(p=0,q=v;p<q.length;p++)r=q[p],s.QUJ(r.sourceName,r.calcItemName,r.formula,s.UTJ())}catch(a){}},a.prototype.sLc=function(a){var b,c=this;for(b in a)p(a,b)&&c.UCc(a[b])},a.prototype.dDc=function(a){return this.XDc===a},a.prototype.getName=function(){return this.Cj},a.prototype.getAllFieldsNames=function(){var a,b=[],c=this.HL;for(a in c)c.hasOwnProperty(a)&&(b[c[a].mi]=c[a].Cj);return b},a.prototype.zY=function(a,b){var c,d,e=this,h=n().blank,i=b.length||0;g.Yxc(a,function(a,c){var d,e;if(a.ny===f.PivotDataType.number||a.ny===f.PivotDataType.date){for(d=a.ny===f.PivotDataType.number?function(a){return"number"==typeof a}:function(a){return a instanceof Date},e=0;(!b[e]||g.Fa(b[e][c])||!d(b[e][c]))&&e<i;)e++;a.bCc=b[e][c],a.cCc=b[e][c]}}),g.Yxc(b,function(b,f){g.Yxc(a,function(a,e){d=b[e],(g.Fa(d)||""===d)&&(b[e]=h),c=a.xBc(d,f),g.Fa(c)||(b[e]=c)}),e.nBc[f]=b}),g.Yxc(a,function(a){a.ny!==f.PivotDataType.string&&a.ny!==f.PivotDataType.date||a.YGJ()}),this.tWJ()},a.prototype.IBc=function(a,b){var c,e,h=this,i=b.pivotCacheRecords;i&&i.length>0&&(c=i[0],e=n().blank,g.Yxc(i,function(b,i){var j=[];g.Yxc(a,function(a,h){var k,l=b[h]&&b[h].value;g.Fa(l)&&(l=e),k=c[h]&&c[h].type||E(a.ny),"object"!=typeof l||g.Fa(l._error)||(l=d.ErrorsMap[l._code]||d.ErrorsMap[0]),"x"===k?a.ABc(l,i):"m"===k||g.Fa(k)?(g.Fa(l)||(a.ny=f.PivotDataType.string),l=a.zBc(l,i,!0)):"n"!==k?l=a.zBc(l,i,!0):a.yBc(l,i),j[h]=l}),h.nBc.push(j)}),g.Yxc(a,function(a){a.ny===f.PivotDataType.date&&a.tHJ(),a.ny===f.PivotDataType.number&&g.Fa(a.bCc)&&a.dWJ(),(a.ny===f.PivotDataType.string||a.ny===f.PivotDataType.date||a.ny===f.PivotDataType.number&&!g.Fa(a.Eyc))&&a.YGJ()}))},a.prototype.zjK=function(a,b){var c,e,h=this,i=b&&b.c_;i&&i.length>0&&(c=i[0],e=n().blank,g.Yxc(i,function(b,i){var j=[];g.Yxc(a,function(a,h){var k,l=b.c_&&b.c_[h],m=X(l&&l.n_,l&&l.v);g.Fa(m)&&(m=e),k=c.c_[h]&&c.c_[h].n_||E(a.ny),"object"!=typeof m||g.Fa(m._error)||(m=d.ErrorsMap[m._code]||d.ErrorsMap[0]),"x"===k?a.ABc(m,i):"m"===k||g.Fa(k)?(g.Fa(m)||(a.ny=f.PivotDataType.string),m=a.zBc(m,i,!0)):"n"!==k?m=a.zBc(m,i,!0):a.yBc(m,i),j[h]=m}),h.nBc.push(j)}),g.Yxc(a,function(a){a.ny===f.PivotDataType.date&&a.tHJ(),a.ny===f.PivotDataType.number&&g.Fa(a.bCc)&&a.dWJ(),(a.ny===f.PivotDataType.string||a.ny===f.PivotDataType.date||a.ny===f.PivotDataType.number&&!g.Fa(a.Eyc))&&a.YGJ()}))},a.prototype.tWJ=function(){var a,b,c,d,e,f,h,i,j,k,l,m,o,p=this,q=p.nBc,r=p.sWJ={},s=n().blank;if(!g.Fa(q)){for(a=q.length,e=p.HL,f=p.GBc,h=[],j=0,k=f;j<k.length;j++)l=k[j],g.Fa(l)||g.Fa(e[l.name])||(i=e[l.name],i.Eyc&&Object.keys(i.Eyc).length>0?h[i.mi]=g.Fa(i.Eyc[s])?-1:i.Eyc[s]:h[i.mi]=s);for(m=0;m<a;m++)if(b=q[m]){for(c=b.length,d=!0,o=0;o<c;o++)if(b[o]!==h[o]){d=!1;break}d&&(r[m]=1)}}},a.prototype.getField=function(a){return this.HL[a]},a.prototype.HBc=function(a){var b,c=this,d=new q(a);return g.Fa(d.mi)&&(d.mi=c.ZFc),b=d.Cj,g.Fa(c.HL[b])&&c.ZFc++,c.HL[b]=d,d},a.prototype.LSb=function(a){return this.HL[a]},a.prototype.kDc=function(){var a,b=[],c=this.HL;for(a in c)c.hasOwnProperty(a)&&b.push(c[a]);return b},a.prototype.KhK=function(a,b){var c=this.HL[a];return b.reduce(function(a,b){return a.concat(c.vBc[b]||[])},[])},a.prototype.KBc=function(a){var b=this,c=a.map(function(a){var c=a.sourceName,d=a.items,e=b.LSb(c);return e?e.getIndexesList(d):[]});return this.LBc(g.Lyc(c))},a.prototype.LBc=function(a){var b,c,d,e=[];for(b=0,c=a;b<c.length;b++)d=c[b],e.push(this.nBc[d]);return e},a.prototype.addField=function(a){var b,c=this;a&&!g.Fa(a.Cj)&&(b=a.Cj,g.Fa(c.HL[b])?(g.Fa(a.mi)&&(a.mi=c.ZFc),g.Fa(c.HL[b])&&c.ZFc++):a.mi=c.HL[b].mi,c.HL[b]=a)},a.prototype.removeField=function(a){var b=this;!a||g.Fa(a.Cj)||g.Fa(b.HL[a.Cj])||(g.Fa(a.mi)||b.kGc(a.mi),delete b.HL[a.Cj],b.ZFc--)},a.prototype.removeCalcField=function(a){var b=this,c=b.getField(a);c&&!g.Fa(c.Yw)&&b.removeField(c)},a.prototype.kGc=function(a){var b,c,d=this,e=d.HL;for(b in e)e.hasOwnProperty(b)&&(c=e[b],c&&!g.Fa(c.mi)&&c.mi>a&&c.mi--)},a.prototype.dispose=function(){var a,b=this;b.nBc=l,b.aCc=l,b.vDJ=l;for(a in b.HL)b.HL.hasOwnProperty(a)&&(b.HL[a].dispose(),delete b.HL[a]);b.GBc=l,b.XDc=l,b.Lqa=l,b.TjK=l,b.rLc=l,b.O1J=l},a.prototype.MBc=function(a){var b,c,d=this,e=[];for(b=0;b<a.length;b++)e.push(d.HL[a[b].fieldName].vBc[a[b].item]);return c=g.Lyc(e),d.LBc(c)},a.prototype.Myc=function(a){var b,c,d,e,f,h,i=this,j=[];for(b=0;b<a.length;b++)if(c=i.HL[a[b].fieldName],g.Fa(c.HJJ))j.push(c.vBc[a[b].item]);else{for(d=c.HJJ[a[b].item],e=!1,f=c._baseFieldName,h=0;h<a.length;h++)f===a[h].fieldName&&g.NBc(d,a[h].item)&&(e=!0);if(!e)return[]}return g.Lyc(j)},a.prototype.Nyc=function(a){var b,c,d=this,e=[];for(b=0;b<a.length;b++)c=d.LSb(a[b].sourceName),c&&e.push(c.getIndexesList(a[b].items));return g.Lyc(e)},a.prototype.OBc=function(a){var b=this;return!!b.HL[a]},a.prototype._Fc=function(a){var b,c=this.HL;for(b in c)if(c.hasOwnProperty(b)&&c[b].mi===a)return c[b]},a.prototype.PBc=function(a){this.HL[a.Cj]=a},a.prototype.UCc=function(a){var b,c,e,h,i,j,k,l=this;return g.Fa(l.rLc)&&(l.rLc={}),b=l.rLc,c=d._AJ(a),e=l.getField(a.originFieldName),!g.Fa(e)&&(b[a.originFieldName]=c,h=a.textGroup,h?(i=h.groupItems,j=new q({dataType:e.ny,name:h.fieldName,index:e.mi}),I(i,e.vzc),j.kBc=[],j.DBc={},j.aGc={},g.Yxc(Object.keys(i),function(a,b){j.kBc.push(a),j.aGc[a]=b,j.DBc[b]=[],g.Yxc(i[a],function(a){j.DBc[b]=g.GIc(j.DBc[b],e.vBc[e.Eyc[a]])})}),j.FBc(i,e.vzc),j.tnb=i,j.SDc=e.Cj,j.YFc=!1,j.$Fc=e.mi,delete j.mi,j.YGJ(),l.addField(j)):e.ny!==f.PivotDataType.number||g.Fa(a.numberGroup)?e.ny===f.PivotDataType.date&&S(l,e,a.dateGroups):(k=a.numberGroup,M(e,k.start,k.end,k.by)),!0)},a.prototype.AJJ=function(a,b,c){var d,e,f,h,i=this;return!g.Fa(c)&&(d=c.textGroup,e=c.numberGroup,f=c.dateGroups,!(!d||d.fieldName!==a)||(!(!e||c.originFieldName!==a)||!(!f||(h=i.LSb(a),h.SDc!==b))))},a.prototype.hGc=function(a){var b,c,d,e,f,h,i,j,k,l=this,m=l.rLc;if(!g.Fa(m))for(b in m)if(p(m,b)&&(c=m[b],l.AJJ(a,b,c))){delete m[b];break}if(d=l.getField(a),e=[],g.Fa(d.DBc))return e;if(d.tnb)e.push(d.Cj),l.removeField(d);else if("number"==typeof d.bCc)d.iGc(),d.YGJ();else if(d.bCc instanceof Date){for(f=d,!g.Fa(d.$Fc)&&g.Fa(d.jGc)&&(f=l._Fc(d.$Fc)),h=f.jGc,i=0,j=h.length;i<j;i++)k=l.getField(h[i]),l.removeField(k);delete m[f.Cj],e=e.concat(h),f.iGc(),f.YGJ()}return e},a.prototype.nGc=function(a){var b,c,d,e,f=this,h=f.getField(a),i=[];if(!g.Fa(h)&&(b=h,g.Fa(b.SDc)||(b=f.getField(b.SDc)),!g.Fa(b)&&!g.Fa(b.jGc)&&b.jGc.length>0))for(i.push(b),c=b.jGc,d=0,e=c.length;d<e;d++)i.push(f.getField(c[d]));return i},a.prototype.hNc=function(){var a,b=this.HL,c=[];for(a in b)b.hasOwnProperty(a)&&!g.Fa(b[a].Yw)&&c.push(b[a]);return c},a.prototype.addCalcField=function(a,b){var c,d,e=this,g=new q({dataType:f.PivotDataType.number,name:a});g.Yw=b,g.YFc=!1,c=e.aCc,d=e.vDJ,g.PHJ=c.parseFormulaToCalcRelatedFieldNames(b),g.X$b=c.calcService.parse(d,b,0,0),e.addField(g)},a.prototype.checkFieldNameAndItems=function(a,b){var c,d,e,f,h,i,j,k,l,m,n,o,p,q=Object.keys(a),r={};if(!g.Fa(b)){for(e=0,f=b;e<f.length;e++)h=f[e],r[h]=!0;for(i=0,j=q;i<j.length;i++)if(k=j[i],!r[k])return!1}for(l=0,m=q;l<m.length;l++){if(k=m[l],d=this.getField(k),g.Fa(d))return!1;for(c=d.Eyc,n=0,o=a[k];n<o.length;n++)if(p=o[n],g.Fa(c[p]))return!1}return!0},a.prototype.setSortInfo=function(a,b){var c=this,d=c.getField(a);if(!g.Fa(d)){if(g.Fa(b))return void(d.needSort=null);d.needSort=b,d.YGJ()}},a.prototype.addCalcItem=function(a,b,c,d){var e=this,f=e.aCc,g=f.parseFormulaToCalcRelatedFieldItemMap(c);return!!e.checkFieldNameAndItems(g,d)&&this.QUJ(a,b,c,e.UTJ())},a.prototype.QUJ=function(a,b,c,d){var e,f=this,h=f.aCc,i=f.vDJ,j=f.getField(a),k=h.calcService.parse(i,c,0,0);if(j.xSJ[b]={calcItemFormula:c,calcExpression:k},e=j.GSJ.indexOf(b),e<0)return j.GSJ.push(b),j.addCalcItem(b,g.Fa(d)?f.UTJ():d),!0},a.prototype.getCalcItems=function(a){var b,c,d,e,f,h,i,j,k,l,m,n=this,o=[];for(b=g.Fa(a)?n.kDc():[n.getField(a)],c=0,d=b;c<d.length;c++)for(e=d[c],f=e.GSJ,h=e.xSJ,i=e.MTJ,j=e.dGc(),k=0,l=f;k<l.length;k++)m=l[k],o.push({sourceName:e.Cj,formula:h[m].calcItemFormula,calcItemName:m,priority:i[j[m]]});return o},a.prototype.updateCalcItem=function(a,b,c,d,e){var f,h,i,j,k=this,l=k.aCc,m=k.vDJ,n=k.getField(a);if(g.Fa(n))return!1;if(f=n.GSJ.indexOf(b),f<0)return!1;if(h=!1,c!==n.xSJ[b].calcItemFormula&&!g.Fa(c)){if(i=l.parseFormulaToCalcRelatedFieldItemMap(c),!k.checkFieldNameAndItems(i,e))return!1;j=l.calcService.parse(m,c,0,0),n.STJ[b]=i,n.xSJ[b]={calcItemFormula:c,calcExpression:j},h=!0}return g.Fa(d)||(h=k.updateCalcItemPriority(a,b,d)||h),h},a.prototype.updateCalcItemPriority=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,r=this,s=r.getField(a);if(g.Fa(s)||s.GSJ.indexOf(b)<0)return!1;if(d=s.MTJ[s.dGc()[b]],c<1?c=1:c>r.TTJ&&(c=r.TTJ),c===d)return!1;for(e=r.kDc(),f=c<d?1:-1,h=Math.min(c,d),i=Math.max(c,d),j=0,k=e;j<k.length;j++)if(l=k[j],l.hasCalcItem())for(m=l.MTJ,n=Object.keys(m),o=0,p=n;o<p.length;o++)q=p[o],m[q]!==d?m[q]>=h&&m[q]<=i&&(m[q]+=f):m[q]=c;return!0},a.prototype.removeCalcItem=function(a,b){var c,d,e,f,h,i,j=this,k=[],l=j.getField(a),m=[b];if(l)for(g.Fa(b)&&(m=l.GSJ.slice()),c=0,d=m;c<d.length;c++)e=d[c],f=l.vzc.indexOf(e),f<0||(h=l.MTJ[f],l.removeCalcItem(e),k.push({formula:l.xSJ[e].calcItemFormula,calcItemName:e}),delete l.STJ[e],delete l.xSJ[e],i=l.GSJ.indexOf(e),i>=0&&l.GSJ.splice(i,1),g.Fa(h)||j.VTJ(h));return k},a.prototype.VTJ=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.kDc();for(b=0,c=k;b<c.length;b++)if(d=c[b],e=d.MTJ)for(f=Object.keys(e),g=0,h=f;g<h.length;g++)i=h[g],e[i]>a&&e[i]--;j.TTJ--},a.prototype.UTJ=function(){return this.TTJ+=1,this.TTJ},a.prototype.NHJ=function(a){var b,c,d,e,h,i,j,k=this,l=[],m={},n=[],o={},p=[],q=[],r={normalFieldsInfos:l,calcFieldsInfos:n};for(b=0,c=a.length;b<c;b++)d=k.getField(a[b].cacheName),g.Fa(d.Yw)?B(l,d,a[b].subTotalType,m):k.QHJ(d.Cj,p,q);for(e=0,h=p.length;e<h;e++)i=k.getField(p[e]),B(l,i,f.SubtotalType.sum,m);for(e=0,h=q.length;e<h;e++)j=k.getField(q[e]),B(n,j,f.SubtotalType.sum,o);return r},a.prototype.RHJ=function(a){var b,c,d,e=this,f=[];for(b=0,c=a.length;b<c;b++)d=e.getField(a[b].cacheName),g.Fa(d.Yw)||f.push(d);return f},a.prototype.QHJ=function(a,b,c){var e,f,h,i,j=this,k=j.getField(a),l=k.PHJ;for(e=0,f=l.length;e<f;e++)h=d.oKJ(l[e]),i=j.getField(h),g.Fa(i.Yw)?b.push(h):j.QHJ(h,b,c);c.push(k.Cj)},a.prototype.IGJ=function(a){var b,c=this,d=c.HL,e=[];g.Yxc(a,function(a){var b=d[a];b&&(g.Fa(b.Eyc)||0===Object.keys(b.Eyc).length)&&(b.vBc={},b.Eyc={},b.vzc=[],b.HSJ()||e.push(b))}),b=c.nBc,g.Yxc(b,function(a,b){g.Yxc(e,function(c){var d=c.mi;a[d]=c.zBc(a[d],b,!1)})}),g.Yxc(e,function(a){a.YGJ()})},a.prototype.AjK=function(a){var b=!1,c=F(a);return c!==f.PivotDataType.noValue&&c!==f.PivotDataType.errorValue?c:(c===f.PivotDataType.errorValue&&(b=!0),b?f.PivotDataType.errorValue:f.PivotDataType.noValue)},a.prototype.DMJ=function(a){var b,c,d=!1;for(b=0;b<a.length;b++){if(c=E(a[b].type),c!==f.PivotDataType.noValue&&c!==f.PivotDataType.errorValue)return c;c===f.PivotDataType.errorValue&&(d=!0)}return d?f.PivotDataType.errorValue:f.PivotDataType.noValue},a.prototype.fromJson=function(a,b,c){var e,f,h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,D,E,F,G,H,I,J,K,L,M,N=this;if(N.Lqa=b,g.Fa(b.name)?N.Cj=a:N.Cj=b.name,g.Fa(a)||(N.yEc=+a),g.Fa(b.pivotCacheId)||(N.cTJ=+b.pivotCacheId),g.Fa(b.recordCount)||(N.recordCount=b.recordCount),g.Fa(b.sourceType)||(N.sourceType=b.sourceType,N.XDc="",g.Fa(b.sheet)||(N.XDc=b.sheet,N.sheet=b.sheet,g.Fa(b.ref)||(N.XDc=N.XDc+"!"+b.ref,N.ref=b.ref)),g.Fa(b.sourceName)||(N.XDc=b.sourceName,N.sourceName=b.sourceName)),e=d._AJ(b.fields),f=[],h=[],i=[],e&&e.length>0)for(k=0;k<e.length;k++){if(l=e[k],m=l.fieldGroup,l.mi=k,m){if(!g.Fa(m.base)&&(g.Fa(l.entities)||0===l.entities.length)&&!g.Fa(m.startDate)){g.Fa(e[m.base])||g.Fa(e[m.base].fieldGroup)||!g.Fa(e[m.base].fieldGroup.TDc)||(e[m.base].fieldGroup.TDc=[]),e[m.base].fieldGroup.TDc.push(l);continue}if(h.push(l),!g.Fa(m.discreteGroup))continue}if(g.Fa(l.formula)){if(n=l.entities,o={},o.name=l.name,o.index=k,n&&n.length>0)o.dataType=N.DMJ(n);else if(b.GBc)for(p=0,q=b.GBc;p<q.length;p++)r=q[p],r.name===o.name&&(o.dataType=r.dataType);s=N.HBc(o),s.fromJson(l,b.pivotCacheRecords&&b.pivotCacheRecords[0]&&b.pivotCacheRecords[0][k]),f.push(s)}else i.push(l)}for(N.IBc(f,b),t=b.calculatedItems||[],x=0,y=t;x<y.length;x++)z=y[x],v=z.pivotArea,g.Fa(v.outline)||(u=z.formula,A=v.references[0],s=b.fields[A.field],w=s.entities[A.indexes[0]]&&s.entities[A.indexes[0]].value,w&&N.addCalcItem(s.name,w,u));if(h.length>0)for(k=0;k<h.length;k++)if(l=h[k],m=l.fieldGroup,m&&(B=g.Fa(m.base)?l:e[m.base]))if(D={},D.originFieldName=B.name,g.Fa(m.groupInterval))if(g.Fa(m.groupBy)){if(g.Fa(m.parent)){if(I=m.discreteGroup,J=m.groupItems,I&&I.length>0&&J&&J.length>0)for(D.textGroup={fieldName:l.name,groupItems:{}},K=D.textGroup.groupItems,G=0;G<I.length;G++)L=!g.Fa(I[G])&&J[I[G]]&&J[I[G]].value,g.Fa(L)||(g.Fa(K[L])&&(K[L]=[]),K[L].push(B.entities[G]&&B.entities[G].value));N.UCc(D)}}else{if(E=[{start:new Date(m.startDate),end:new Date(m.endDate),by:T(m.groupBy)}],F=m.TDc,F&&F.length>0)for(G=0;G<F.length;G++)H=F[G].fieldGroup,E.push({start:new Date(H.startDate),end:new Date(H.endDate),by:T(H.groupBy)});D.dateGroups=E,N.UCc(D)}else D.numberGroup={start:m.startNum,end:m.endNum,by:m.groupInterval},N.UCc(D);if(i.length>0)for(k=0;k<i.length;k++)M=i[k],N.addCalcField(M.name,M.formula);g.Fa(b.overwriteList)||(g.Fa(N.O1J)&&(N.O1J=new j.OverwriteList),N.O1J.fromJSON(b.overwriteList)),C(e,N.HL),N.EHJ(),N.tWJ()},a.prototype.cdK=function(a,b,c){var e,f,h,i,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja=this;if(ja.TjK=a,e=a.lossless,g.Fa(a.name)?g.Fa(e&&e.cacheName)?ja.Cj=b:ja.Cj=a.lossless.cacheName:ja.Cj=a.name,g.Fa(b)||(ja.yEc=+b),f=g.JcK(a,"extLst"),h=f&&g.JcK(f,"ext"),i=h&&g.JcK(h,"pivotCacheDefinition"),l=i&&i.pivotCacheId,g.Fa(l)||(ja.cTJ=+l),g.Fa(e&&e.overwriteList)||(g.Fa(ja.O1J)&&(ja.O1J=new j.OverwriteList),ja.O1J.fromJSON(e.overwriteList)),g.Fa(a.recordCount)||(ja.recordCount=+a.recordCount),m=g.JcK(a,"cacheSource"),g.Fa(m)||(ja.sourceType=m.type,ja.XDc="",n=g.JcK(m,"worksheetSource"),o=n&&n.sheet,g.Fa(o)||(ja.XDc=o,ja.sheet=o,g.Fa(n.ref)||(ja.XDc=ja.XDc+"!"+n.ref,ja.ref=n.ref)),p=n.name,g.Fa(p)||(ja.XDc=p,ja.sourceName=p)),q=g.JcK(a,"cacheFields"),r=d._AJ(q.c_),s=[],t=[],u=[],r&&r.length>0)for(v=0;v<r.length;v++){if(w=r[v],x=g.JcK(w,"fieldGroup"),w.mi=v,y=g.JcK(w,"sharedItems"),x){if(z=+x.base,A=g.JcK(x,"rangePr"),B=g.JcK(x,"discretePr"),!g.Fa(x.base)&&(g.Fa(y)||y.c_&&0===y.c_.length)&&!g.Fa(A&&A.startDate)){D=g.JcK(r[z],"fieldGroup"),g.Fa(r[z])||!g.Fa(D)&&g.Fa(D.TDc)&&(D.TDc=[]),D.TDc.push(w);continue}if(t.push(w),!g.Fa(B))continue}if(g.Fa(w.formula)){if(E={},E.name=w.name,E.index=v,F=y&&y.c_&&y.c_.length>0,g.Fa(F)){if(a.lossless&&a.lossless.GBc)for(G=0,H=a.lossless.GBc;G<H.length;G++)I=H[G],I.name===E.name&&(E.dataType=I.dataType)}else E.dataType=ja.AjK(y.c_[0]);J=ja.HBc(E),J.cdK(w,c&&c.c_&&c.c_[0]&&c.c_[0].c_[v]),s.push(J)}else u.push(w)}for(ja.zjK(s,c),K=g.JcK(a,"calculatedItems"),L=K&&K.c_||[],P=0,Q=L;P<Q.length;P++)R=Q[P],N=g.JcK(R,"pivotArea"),g.Fa(N.outline)||(M=R.formula,S=g.JcK(N,"references"),U=S.c_[0],V=g.JcK(U,"x"),J=q.c_[+U.field],W=g.JcK(J,"sharedItems").c_,X=W[+V.v],O=X&&X.v,O&&ja.addCalcItem(J.name,O,M));if(t.length>0)for(v=0;v<t.length;v++)if(w=t[v],x=g.JcK(w,"fieldGroup"),x&&(Y=g.Fa(x.base)?w:r[+x.base]))if(Z={},Z.originFieldName=Y.name,A=g.JcK(x,"rangePr"),g.Fa(A&&A.groupInterval))if(g.Fa(A&&A.groupBy)){if(g.Fa(x.par)&&(B=g.JcK(x,"discretePr"),da=B&&B.c_,ea=g.JcK(x,"groupItems"),fa=ea&&ea.c_,!g.Fa(da))){if(da&&da.length>0&&fa&&fa.length>0)for(Z.textGroup={fieldName:w.name,groupItems:{}},ga=Z.textGroup.groupItems,aa=0;aa<da.length;aa++)ha=!g.Fa(da[aa])&&fa[+da[aa].v]&&fa[+da[aa].v].v,g.Fa(ha)||(g.Fa(ga[ha])&&(ga[ha]=[]),W=g.JcK(Y,"sharedItems"),ga[ha].push(W.c_[aa]&&W.c_[aa].v));ja.UCc(Z)}}else{if($=[{start:new Date(Date.parse(A.startDate)),end:new Date(Date.parse(A.endDate)),by:T(A.groupBy)}],_=x.TDc,_&&_.length>0)for(aa=0;aa<_.length;aa++)ba=g.JcK(_[aa],"fieldGroup"),ca=g.JcK(ba,"rangePr"),$.push({start:new Date(Date.parse(ca.startDate)),end:new Date(Date.parse(ca.endDate)),by:T(ca.groupBy)});Z.dateGroups=$,ja.UCc(Z)}else Z.numberGroup={start:parseFloat(A.startNum),end:parseFloat(A.endNum),by:parseFloat(A.groupInterval)},ja.UCc(Z);if(u.length>0)for(v=0;v<u.length;v++)ia=u[v],ja.addCalcField(ia.name,k.xmlDecode(ia.formula));C(r,ja.HL),ja.EHJ(),ja.tWJ()},a.prototype.toJson=function(a){var b,c,d,e,f,h,i,j,k,l,m=this,n=g.Fa(m.Lqa)?{}:m.Lqa;if(g.Fa(m.yEc)||(n.cacheId=m.yEc),g.Fa(m.cTJ)?n.pivotCacheId=m.yEc:n.pivotCacheId=m.cTJ,g.Fa(m.Cj)||(n.name=m.Cj),g.Fa(m.recordCount)||(n.recordCount=m.nBc&&m.nBc.length),g.Fa(m.XDc)||(n.XDc=m.XDc),g.Fa(m.sourceType)||(n.sourceType=m.sourceType,g.Fa(m.sheet)||(n.sheet=m.sheet),g.Fa(m.ref)||(n.ref=m.ref),g.Fa(m.sourceName)||(n.sourceName=m.sourceName)),n.calcItemCount=m.TTJ||0,m.TTJ>0&&(n.calculatedItems=m.WTJ()),m.HL&&!g.isEmptyObject(m.HL)){b=[];for(c in a)a.hasOwnProperty(c)&&b.push(c);m.IGJ(b),D(m,a),d=n.fields=[],e={};for(f in m.HL)m.HL.hasOwnProperty(f)&&d.push(m.HL[f].toJson(m));for(d.sort(function(a,b){return a.mi-b.mi}),h=[],i=0;i<d.length;i++)d[i].entities&&d[i].entities.length>0?h.push("x"):g.Fa(d[i].type)?h.push("n"):h.push(d[i].type),g.Fa(d[i].formula)||(e[i]=!0);for(j=[],i=0;i<m.nBc.length;i++){for(k=[],l=0;l<m.nBc[i].length;l++)e[l]!==!0&&k.push({type:h[l],value:m.nBc[i][l]});j.push(k)}n.pivotCacheRecords=j,n.GBc=m.GBc}return m.O1J&&!m.O1J.isEmpty()&&(n.overwriteList=m.O1J.toJSON()),n},a.prototype.BjK=function(a,b){return{n_:"pivotArea",outline:"0",c_:[{n_:"references",count:"1",c_:[{n_:"reference",field:a+"",count:"1",c_:[{n_:"x",v:b+""}]}]}]}},a.prototype.CjK=function(){var a,b,c,d,e,f,g,h,i,j=this,k=[],l=j.kDc();for(a=0,b=l;a<b.length;a++)if(c=b[a],d=c.GSJ,d&&d.length>0)for(e=0,f=d;e<f.length;e++)g=f[e],h=j.BjK(c.mi,c.Eyc[g]),i=c.MTJ[c.Eyc[g]]-1,k[i]={n_:"calculatedItem",formula:c.xSJ[g].calcItemFormula,c_:[h]};return k},a.prototype.bdK=function(a){var b,c,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this,w=v.nBc,x=w&&w.length;if(!(x<=0)){if(b=g.Fa(v.TjK)?{}:v.TjK,g.Fa(b.pivotCacheDefinition)&&(b.pivotCacheDefinition={n_:"pivotCacheDefinition",r_:[13,14,8,16,15],"r:id":"rId1"}),c=b.pivotCacheDefinition,g.Fa(v.yEc)||(b.cacheId=v.yEc+""),g.Fa(v.recordCount)||(c.recordCount=x+""),g.Fa(c.createdVersion)&&(c.createdVersion="7"),g.Fa(c.refreshedVersion)&&(c.refreshedVersion="7"),g.Fa(c.refreshOnLoad)&&(c.refreshOnLoad="1"),c.c_=[{n_:"extLst",c_:[{n_:"ext",r_:[53,1],c_:[{n_:"pivotCacheDefinition",pivotCacheId:v.cTJ+""}]}]}],e={n_:"cacheSource",type:v.sourceType},"worksheet"===v.sourceType&&(f={n_:"worksheetSource"},g.Fa(v.sourceName)||(f.name=v.sourceName),g.Fa(v.ref)||(f.ref=v.ref),g.Fa(v.sheet)||(f.sheet=v.sheet),e.c_=[f]),c.c_.push(e),v.TTJ>0&&(h=v.CjK(),c.c_.push({n_:"calculatedItems",count:h.length+"",c_:h})),v.HL&&!g.isEmptyObject(v.HL)){i=[];for(j in a)a.hasOwnProperty(j)&&i.push(j);v.IGJ(i),k=[],l={};for(m in v.HL)v.HL.hasOwnProperty(m)&&k.push(v.HL[m].bdK(v));for(k.sort(function(a,b){return a.mi-b.mi}),k.forEach(function(a){delete a.mi}),c.c_.push({n_:"cacheFields",count:k.length+"",c_:k}),d.NcK(c,["cacheSource","cacheFields","calculatedItems","extLst"]),n=[],o=0;o<k.length;o++)p=g.JcK(k[o],"sharedItems"),q=p&&p.c_,q&&q.length>0?n.push("x"):g.Fa(k[o].type)?n.push("n"):n.push(k[o].type),g.Fa(k[o].formula)||(l[o]=!0);for(r=[],o=0;o<v.nBc.length;o++){for(s=[],t=0;t<v.nBc[o].length;t++)l[t]!==!0&&s.push({n_:n[t],v:v.nBc[o][t]});u={n_:"r",c_:s},r.push(u)}b.pivotCacheRecords={n_:"pivotCacheRecords",r_:[13,14,8,16,15],count:w.length,c_:r}}return c.lossless={cacheName:v.Cj},c.lossless.GBc=v.GBc,v.O1J&&!v.O1J.isEmpty()&&(c.lossless.overwriteList=v.O1J.toJSON()),b}},a.prototype.WTJ=function(){var a,b,c,d,e,f,g,h,i=this,j=[],k=i.kDc();for(a=0,b=k;a<b.length;a++)if(c=b[a],d=c.GSJ,d&&d.length>0)for(e=0,f=d;e<f.length;e++)g=f[e],h={formula:c.xSJ[g].calcItemFormula,pivotArea:null},h.pivotArea=i.XTJ(c.mi,c.Eyc[g]),j[c.MTJ[c.Eyc[g]]-1]=h;return j},a.prototype.XTJ=function(a,b){var c={};return c.references=[{field:a,indexes:[b]}],c.outline=!0,c},a.prototype.u1J=function(a,b){var c=this;g.Fa(c.O1J)&&(c.O1J=new j.OverwriteList),c.O1J.setOverwriteNode(a,b)},a.prototype.Q1J=function(a){return this.O1J&&this.O1J.getOverwriteValue(a)},a.prototype.w1J=function(a){this.O1J&&this.O1J.removeOverwriteNode(a)},a.prototype.x1J=function(){return this.O1J&&this.O1J.getOverwriteList()},a.prototype.y1J=function(){this.O1J&&this.O1J.reset()},a}(),b.PivotCache=r;function C(a,b){var c,d,e,f,h,i,j,k;if(a){for(c=0,d=a;c<d.length;c++)e=d[c],g.Fa(e.name)||!b[e.name]||g.Fa(e.mi)||(b[e.name].mi=e.mi);for(f=Object.keys(b),h=[],i=0,j=f;i<j.length;i++)k=j[i],h.push(b[k]);h.sort(function(a,b){return a.mi-b.mi}),h.forEach(function(a,b){a.mi=b})}}function D(a,b){var c,d,e,f,h,i=a.HL;for(c in b)if(b.hasOwnProperty(c)&&i[c]&&(d=i[c],d&&g.Fa(d.Eyc)))for(d.vBc={},d.Eyc={},d.vzc=[],e=a.nBc,f=d.mi,h=0;h<e.length;h++)e[h][f]=d.zBc(e[h][f],h,!1)}function E(a){switch(a){case"b":return f.PivotDataType.boolean;case"d":return f.PivotDataType.date;case"e":return f.PivotDataType.errorValue;case"m":return f.PivotDataType.noValue;case"n":return f.PivotDataType.number;case"s":return f.PivotDataType.string;default:return}}function F(a){var b=a.n_;return"s"===b?f.PivotDataType.string:"n"===b?f.PivotDataType.number:"d"===b?f.PivotDataType.date:"b"===b?f.PivotDataType.boolean:"e"===b?f.PivotDataType.errorValue:"m"===b?f.PivotDataType.noValue:void 0}function G(a){switch(a){case f.PivotDataType.boolean:return"b";case f.PivotDataType.date:return"d";case f.PivotDataType.errorValue:return"e";case f.PivotDataType.noValue:return"m";case f.PivotDataType.number:return"n";case f.PivotDataType.string:return"s";default:return"n"}}function H(a,b){var c=typeof a;return void 0===a?"m":"boolean"===c?"b":"number"===c?"n":"string"===c?"d"!==b||isNaN(Date.parse(a))?"s":"d":"e"}function I(a,b){var c,d={};for(g.Yxc(Object.keys(a),function(b){for(var c=0;c<a[b].length;c++)d[a[b][c]]=1}),c=0;c<b.length;c++)g.Fa(d[b[c]])&&(a[b[c]]=[b[c]])}s=function(){function a(a,b,c,d){var e=this;e.bCc=a,e.cCc=b,e.groupItemsIndexMap={},e.groupItemsKeyIndexes={},"number"===d?(g.Fa(a)||g.Fa(c)?e.aCJ=b:e.aCJ=a+Math.ceil((b-a)/c)*c,L(e,c,a,e.aCJ)):K(e,c,a,b),e.dCc=c,e.type=d,e.name=this.getName(c)}return a.prototype.getName=function(a){var b=n().dateResource;switch(a){case f.DateGroupType.seconds:return b.Seconds;case f.DateGroupType.minutes:return b.Minutes;case f.DateGroupType.hours:return b.Hours;case f.DateGroupType.days:return b.Days;case f.DateGroupType.months:return b.Months;case f.DateGroupType.quarters:return b.Quarters;case f.DateGroupType.years:return b.Years}},a.prototype.insertIndexToIndexMap=function(a,b){var c,d=this,e=d.groupItemsKeyList,f=d.groupItemsIndexMap,h=d.groupItemsKeyIndexes;c="number"===d.type?g.getNumberGroupItemKey(d,a):g.getDateGroupItemKey(d,a),g.Fa(f[c])&&(f[c]=[],e.push(c),h[c]=e.length-1),f[c]=g.GIc(f[c],b)},a}();function J(a,b){var c,d,e,f="";for(c=0,d=b;c<d.length;c++)e=d[c],f&&(f+="-&-"),f+=e,f+="&",f+=a[e];return f}b.getPathStr=J;function K(a,b,c,e){var h,i,j,k,l,m=n().dateResource,o=m.HOUR_GROUP_ITEMS.slice(),p=m.MINUTE_GROUP_ITEMS.slice(),q=m.SECOND_GROUP_ITEMS.slice();switch(b){case f.DateGroupType.seconds:a.groupItemsKeyList=q;break;case f.DateGroupType.minutes:a.groupItemsKeyList=p;break;case f.DateGroupType.hours:a.groupItemsKeyList=o;break;case f.DateGroupType.days:a.groupItemsKeyList=g.HIc();break;case f.DateGroupType.months:a.groupItemsKeyList=g.IIc();break;case f.DateGroupType.quarters:a.groupItemsKeyList=g.JIc();break;case f.DateGroupType.years:if(c&&e){for(h=[],i=c.getFullYear(),j=e.getFullYear(),k=i;k<=j;k++)h.push(d.ckK(k));a.groupItemsKeyList=h}break;default:a.groupItemsKeyList=[]}for(c&&a.groupItemsKeyList.unshift(d.LESS+g.formatDateToString(c)),e&&a.groupItemsKeyList.push(d.MORE+g.formatDateToString(e)),k=0;k<a.groupItemsKeyList.length;k++)l=a.groupItemsKeyList[k],a.groupItemsIndexMap[l]=[],a.groupItemsKeyIndexes[l]=k}function L(a,b,c,e){var f,g,h;for(a.groupItemsKeyList=[],a.groupItemsKeyList.push(d.LESS+c),f=c;f<e;)a.groupItemsKeyList.push(f+"-"+(f+b-1)),f+=b;for(a.groupItemsKeyList.push(d.MORE+e),g=0;g<a.groupItemsKeyList.length;g++)h=a.groupItemsKeyList[g],a.groupItemsIndexMap[h]=[],a.groupItemsKeyIndexes[h]=g}function M(a,b,c,d){var e,f,h,i,j;if(!(c-b<=0)&&d>0){for(e=a.vBc,f=a.vzc,h=a.Eyc,g.Fa(b)&&(b=a.bCc||N(a.vzc)),g.Fa(c)&&(c=a.cCc||O(a.vzc)),a.bCc=b,a.cCc=c,a.dCc=d,a.SDc=a.Cj,i=new s(b,c,d,"number"),a.aCJ=i.aCJ,j=0;j<f.length;j++)i.insertIndexToIndexMap(f[j],e[g.isEmptyObject(h)?""+f[j]:h[""+f[j]]]);a.kBc=i.groupItemsKeyList,a.DBc=i.groupItemsIndexMap,a.aGc=i.groupItemsKeyIndexes,a.YGJ()}}function N(a){var b,c,d=+a[0];for(b=1,c=a.length;b<c;b++)d=Math.min(d,+a[b]);return d}function O(a){var b,c,d=+a[0];for(b=1,c=a.length;b<c;b++)d=Math.max(d,+a[b]);return d}function P(a){var b,c,d=a[0];for(b=1,c=a.length;b<c;b++)d=d<a[b]?d:a[b];return new Date(d)}function Q(a){var b,c,d=a[0];for(b=1,c=a.length;b<c;b++)d=d>a[b]?d:a[b];return new Date(d)}function R(a,b,c){return g.Fa(c)?(c=1,a.LSb(b)?a.LSb(b+c)?void 0:b+c:b):R(a,b,c+1)}function S(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,r,t;if(c){for(c.sort(function(a,b){return a.by-b.by}),d=[],h=0;h<c.length;h++){if(i=c[h].start,j=c[h].end,k=c[h].by,g.Fa(i)&&(i=g.Fa(e)?e=b.bCc||P(b.vzc):e),g.Fa(j)&&(j=g.Fa(f)?f=b.cCc||Q(b.vzc):f),j<=i)return;d.push(new s(i,j,k,"date"))}for(l=b.vBc,m=b.vzc,n=b.Eyc,o=0,p=b.vzc.length;o<p;o++)for(r=0;r<d.length;r++)d[r].insertIndexToIndexMap(b.vzc[o],l[n[m[o]]]);for(b.kBc=d[0].groupItemsKeyList,b.DBc=d[0].groupItemsIndexMap,b.aGc=d[0].groupItemsKeyIndexes,b.bCc=d[0].bCc,b.cCc=d[0].cCc,b.dCc=d[0].dCc,b.SDc=b.Cj,b.YGJ(),b.jGc=[],r=1;r<d.length;r++)t=new q({dataType:b.ny,name:R(a,d[r].name)}),t.kBc=d[r].groupItemsKeyList,t.DBc=d[r].groupItemsIndexMap,t.aGc=d[r].groupItemsKeyIndexes,t.bCc=d[r].bCc,t.cCc=d[r].cCc,t.dCc=d[r].dCc,t.SDc=b.Cj,t.YFc=!1,t.$Fc=b.mi,t.YGJ(),b.jGc.push(t.Cj),a.addField(t)}}function T(a){switch(a){case"seconds":return f.DateGroupType.seconds;case"minutes":return f.DateGroupType.minutes;case"hours":return f.DateGroupType.hours;case"days":return f.DateGroupType.days;case"months":return f.DateGroupType.months;case"quarters":return f.DateGroupType.quarters;case"years":return f.DateGroupType.years}}function U(a){switch(a){case f.DateGroupType.seconds:return"seconds";case f.DateGroupType.minutes:return"minutes";case f.DateGroupType.hours:return"hours";case f.DateGroupType.days:return"days";case f.DateGroupType.months:return"months";case f.DateGroupType.quarters:return"quarters";case f.DateGroupType.years:return"years"}}function V(a){var b,c=/_x00[0-1][0-9A-Fa-f]_/;return g.Fa(a)||a.match(c)===l?a:(b=/(_x005[fF])?_x00([0-1][0-9A-Fa-f])_/g,a.replace(b,function(a,b,c){var d=0;return c&&(d=parseInt(c,16)),b?"_x00"+c+"_":String.fromCharCode(d)}).replace(/(\r)+\n/g,"\r\n"))}function W(a){var b=l;switch(a){case"#DIV/0!":b=7;break;case"#N/A":b=42;break;case"#NAME?":b=29;break;case"#NULL!":b=0;break;case"#NUM!":b=36;break;case"#REF!":b=23;
break;case"#VALUE!":b=15;break;case"#SPILL!":b=99}return b!==l?{_error:a,_code:b}:l}function X(a,b){if("s"===a||"string"===a)return V(b);if("n"===a||"number"===a)return parseFloat(b);if("d"===a||"date"===a)return V(b);if("b"===a||"boolean"===a){if("1"===b||"t"===b)return!0;if("0"===b||"f"===b)return!1}return"e"===a||"errorValue"===a?W(b):"m"===a||"noValue"===a?null:"x"===a?parseInt(b,10):b}},"./src/pivot-calc-engine.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("CalcEngine"),e=c("./src/pivot-util.ts"),f=c("./src/pivot-interface.ts"),g=function(a){j(b,a);function b(b){return a.call(this,b)||this}return b.prototype.setPivotCache=function(a){this.pivotCache=a},b.prototype.resolveToken=function(a,b,c,f,g){for(var h,i,j,l,m,n=this,o=n.pivotCache,p=o.HL,q="";f<c.length&&(h=c[f],0===h.Nc);f++)q+=h.ni;return q.length>0&&(j=k(p,q),!e.Fa(j)&&Object.keys(j).length>0)?(i=new d.Expression(15),i.value=j,{expr:i,index:f}):p[q]?(i=new d.Expression(14),i.value=q,{expr:i,index:f}):(l=q,m=l.length-1,"'"===l.charAt(0)&&"'"===l.charAt(m)&&(l=l.substring(1,m)),p[l]?(i=new d.Expression(14),i.value=l,{expr:i,index:f}):void 0)},b}(d.TokenResolver);function k(a,b){var c,d,g,h,i,j,k,l,m,n,o,p,q,r;for(b=b.trim(),c={},d=0,g=b.length,h=0,i=0,j=/^('|")([\d\D]*)\1$/g,k=/'{2,2}/g,b=b.replace(k,"'");i<g;){if(h=b.indexOf("[",i),h<0)return;if(l=b.slice(d,h),j.lastIndex=0,j.test(l)&&(l=l.slice(1,l.length-1)),m=a[l],i=h+1,!e.Fa(m)){for(;e.Fa(c[l]);){if(n=b.indexOf("]",i),o=b.slice(h+1,n),p=m.ny,q=o,r=m.vzc,e.Fa(o)||o.length<=0||n<0)return;j.lastIndex=0,j.test(o)&&(q=o.slice(1,o.length-1),p!==f.PivotDataType.number||isNaN(+q)||(r.indexOf(q)>=0?c[l]=q:r.indexOf(+q)>=0&&(c[l]=+q))),r.indexOf(q)>=0&&(c[l]=q),i=n+1}d=i}}return c}h=function(a){j(b,a);function b(b){var c=a.call(this,b)||this;return c.resolvers=[new d.DefaultTokenResolver(5e3)],c}return b.prototype.setPivotCache=function(a){this.pivotCache=a;var b=new g(6e3);b.setPivotCache(a),this.resolvers.unshift(b)},b.prototype.getResolver=function(){return this.resolvers},b.prototype.getField=function(a){var b=this.measureNode;if(!e.Fa(b))return b[a]&&b[a].calc&&b[a].calc.sum},b.prototype.setContext=function(a){this.xc=a},b.prototype.getFieldItem=function(){var a=this,b=arguments[0],c=a.expression,d=a.calcType,e=a.cacheName,f=a.pathInfo,g=a.resultIndex;return a.subtotalManager.getFieldCalcItem(b,c,f,d,e,g)},b.prototype.setCalcInfo=function(a,b,c,d,e,f){var g=this;g.calcType=a,g.subtotalManager=b,g.pathInfo=c,g.cacheName=d,g.expression=e,g.resultIndex=f},b.prototype.setMeasureNode=function(a){this.measureNode=a},b}(d.CalcSource),b.PivotCalcSource=h;function l(a,b){var c,e,f,g,h;if(14===a.type)b.push(a.value);else if(a.value instanceof d.Expression)l(a.value,b);else if(Array.isArray(a.value))for(c=0,e=a.value;c<e.length;c++)f=e[c],f instanceof d.Expression&&l(f,b);else if(Array.isArray(a.arguments))for(g=0,h=a.arguments;g<h.length;g++)f=h[g],f instanceof d.Expression&&l(f,b)}function m(a,b){var c,e,f,g,h,i,j,k,m,n,o;if(8===a.type)throw Error();if(15===a.type)for(c={},e=a.value,f=Object.keys(e),g=0,h=f;g<h.length;g++)i=h[g],c.field=i,c.item=e[i],b.push(c);else if(a.value instanceof d.Expression)l(a.value,b);else if(Array.isArray(a.value))for(j=0,k=a.value;j<k.length;j++)m=k[j],m instanceof d.Expression&&l(m,b);else if(Array.isArray(a.arguments))for(n=0,o=a.arguments;n<o.length;n++)m=o[n],m instanceof d.Expression&&l(m,b)}function n(a){var b,c,d,f,g,h={};if(e.Fa(a))return h;for(b=0,c=a;b<c.length;b++)d=c[b],f=d.field,g=d.item,e.Fa(f)||(h[f]?h[f].push(g):h[f]=[g]);return h}i=function(){function a(){this.calcService=new d.CalcService}return a.prototype.OHJ=function(a){this.calcSource=a},a.prototype.parseFormulaToCalcRelatedFieldNames=function(a){var b,c,d,e,f,g,h,i=this,j=i.calcService,k=i.calcSource,m=j.getParserContext(k);for(m.useR1C1=j.useR1C1,m.row=0,m.column=0,b=j.kh,c=a.split(""),d=b.parseToTokens(m,c,!0),e=b.ii(m,d,!0),f=[],g=0,h=e.length;g<h;g++)l(e[g],f);return f},a.prototype.parseFormulaToCalcRelatedFieldItemMap=function(a){var b,c,d,e,f,g,h,i=this,j=i.calcService,k=i.calcSource,l=j.getParserContext(k);for(l.useR1C1=j.useR1C1,l.row=0,l.column=0,b=j.kh,c=a.split(""),d=b.parseToTokens(l,c,!0),e=b.ii(l,d,!0),f=[],g=0,h=e.length;g<h;g++)m(e[g],f);return n(f)},a.prototype.getResolvers=function(){return this.calcSource.getResolver()},a.prototype.getGlobalSourceModel=function(a){return this.calcService.getGlobalSourceModel(a)},a}(),b.PivotCalcService=i},"./src/pivot-condition.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivot-interface.ts"),e=c("./src/pivot-util.ts"),f=void 0;function k(a,b,c){switch(a){case d.PivotValueFilterOperator.equalsTo:return function(a){return b===+a};case d.PivotValueFilterOperator.notEqualsTo:return function(a){return b!==+a};case d.PivotValueFilterOperator.greaterThan:return function(a){return+a>b};case d.PivotValueFilterOperator.greaterThanOrEqualsTo:return function(a){return+a>=b};case d.PivotValueFilterOperator.lessThan:return function(a){return+a<b};case d.PivotValueFilterOperator.lessThanOrEqualsTo:return function(a){return+a<=b};case d.PivotValueFilterOperator.between:return function(a){return+a>=b&&+a<=c};case d.PivotValueFilterOperator.notBetween:return function(a){return+a<b||+a>c}}}g=function(){function a(a,b,c){var g,h,i;this.uBc=d.PivotConditionType.value,g=this,g.QBc=a,h=isNaN(+b)?NaN:+b,e.Fa(c)?(g.aRa=f,g._Qa=h):(i=isNaN(+c)?NaN:+c,g._Qa=Math.min(h,i),g.aRa=Math.max(h,i)),g.evaluate=k(a,g._Qa,g.aRa)}return a.prototype.getConditionType=function(){return this.uBc},a.prototype.toJSON=function(){var a=this,b=a.QBc,c;return c=a.QBc===d.PivotValueFilterOperator.between||d.PivotValueFilterOperator.notBetween?[a._Qa,a.aRa]:[a._Qa],{conType:d.PivotConditionType.value,val:c,operator:b}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=this;d.QBc=c,b instanceof Array?(d._Qa=b[0],d.aRa=b[1]):(d._Qa=b,d.aRa=f),d.evaluate=k(d.QBc,d._Qa,d.aRa)},a}(),b.PivotFilterValueCondition=g;function l(a){var b,c,f,g,h,i,j,k,l,m=this.QBc,n=this.Nc,o=this.RBc;if(a){if(a.sort(function(a,b){return a.value-b.value}),b=a.length,c=void 0,f=0,g=m===d.PivotTop10FilterOperator.top,n===d.PivotTop10FilterType.count)f=o;else if(n===d.PivotTop10FilterType.sum||n===d.PivotTop10FilterType.percent){for(h=b-1,i=a[g?b-1:0].value,j=0,k=function(){var b,c;if(n===d.PivotTop10FilterType.sum)return function(){return i<o};for(b=0;b<=h;b++)j+=a[b].value;return c=o/100,function(){return i/j<c}}();k();)f++,i+=a[g?h-f:f].value;f++}return c=g?a.slice(-1*f):a.slice(0,f),l={},e.Yxc(c,function(a){l[a.index]=!0}),l}}h=function(){function a(a,b,c){this.uBc=d.PivotConditionType.top10;var e=this;e.QBc=a,e.Nc=b,e.RBc=c,e.evaluate=l}return a.prototype.getConditionType=function(){return this.uBc},a.prototype.toJSON=function(){var a=this,b=a.QBc,c=a.RBc,e=a.Nc;return{conType:d.PivotConditionType.top10,val:c,type:e,operator:b}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=a.type,e=this;e.QBc=c,e.Nc=d,e.RBc=b},a}(),b.PivotFilterTop10Condition=h;function m(a,b,c){switch(a){case d.PivotCaptionFilterOperator.equalsTo:return function(a){return e.lEc(b,a)};case d.PivotCaptionFilterOperator.notEqualsTo:return function(a){return!e.lEc(b,a)};case d.PivotCaptionFilterOperator.beginsWith:return function(a){return e.SBc(b,a)};case d.PivotCaptionFilterOperator.doesNotBeginWith:return function(a){return!e.SBc(b,a)};case d.PivotCaptionFilterOperator.endsWith:return function(a){return e.TBc(b,a)};case d.PivotCaptionFilterOperator.doesNotEndWith:return function(a){return!e.TBc(b,a)};case d.PivotCaptionFilterOperator.contains:return function(a){return e.UBc(b,a)};case d.PivotCaptionFilterOperator.doesNotContain:return function(a){return!e.UBc(b,a)};case d.PivotCaptionFilterOperator.greaterThan:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})>0};case d.PivotCaptionFilterOperator.greaterThanOrEqualsTo:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})>=0};case d.PivotCaptionFilterOperator.lessThan:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})<0};case d.PivotCaptionFilterOperator.lessThanOrEqualsTo:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})<=0};case d.PivotCaptionFilterOperator.between:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})>=0&&(a+"").localeCompare(c,"kn",{numeric:!0})<=0};case d.PivotCaptionFilterOperator.notBetween:return function(a){return(a+"").localeCompare(b,"kn",{numeric:!0})<0||(a+"").localeCompare(c,"kn",{numeric:!0})>0}}}i=function(){function a(a,b,c){this.uBc=d.PivotConditionType.caption;var f=this;this.QBc=a,f._Qa=e.Fa(b)?b:b+"",f.aRa=e.Fa(c)?c:c+"",f.evaluate=m(a,f._Qa,f.aRa)}return a.prototype.getConditionType=function(){return this.uBc},a.prototype.toJSON=function(){var a=this,b=a.QBc,c=e.Fa(a.aRa)?[a._Qa]:[a._Qa,a.aRa];return{conType:d.PivotConditionType.caption,val:c,operator:b}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=this;d.QBc=c,d._Qa=b[0],d.aRa=b[1],d.evaluate=m(d.QBc,d._Qa,d.aRa)},a}(),b.PivotFilterCaptionCondition=i;function n(a,b){var c;return c=e.Fa(b)?new Date:new Date(b),a?e.VBc(c).getTime():c.getTime?c.getTime():b}b.BZJ=n;function o(a,b){var c;return c=e.Fa(b)?new Date:new Date(b),a?e.VBc(c):c}b.CZJ=o;function p(a,b,c,d){return n(d,a)>=n(d,b)&&n(d,a)<=n(d,c)}function q(a){if(a%100===0){if(a%400===0)return!0}else if(a%4===0)return!0;return!1}function r(a,b,c){var d,e,f=b.getFullYear(),g=c.getFullYear();for(d=f;d<=g;d++)if(e=s(a,d),e>=b&&e<=c)return!0;return!1}function s(a,b){var c=new Date(a.valueOf()),d=c.getFullYear(),e=c.getMonth(),f=c.getDate();return q(d)&&1===e&&29===f&&!q(b)?c.setFullYear(b,1,28):!q(d)&&1===e&&28===f&&q(b)?c.setFullYear(b,1,29):c.setFullYear(b),c}function t(a,b,c){var d,e=new Date(a.valueOf()),f=e.getMonth(),g=e.getDate(),h=[0,2,4,6,7,9,11],i=[3,5,8,10],j=q(b)?29:28;return h.indexOf(f)>-1&&31===g?i.indexOf(c)>-1?e.setMonth(c,30):1===c?e.setMonth(c,j):e.setMonth(c):i.indexOf(f)>-1&&30===g?h.indexOf(c)>-1?e.setMonth(c,31):1===c?e.setMonth(c,j):e.setMonth(c):1===f&&g===j?h.indexOf(c)>-1?e.setMonth(c,31):i.indexOf(c)>-1?e.setMonth(c,30):e.setMonth(c):(d=new Date(b,c+1,0).getDate(),g>d?e.setMonth(c,d):e.setMonth(c)),e}function u(a,b,c,d){var e=new Date(a.valueOf());return e=t(e,b,3*c+d)}function v(a,b,c){var d,e,f,g=b.getFullYear(),h=Math.floor(b.getMonth()/3),i=c.getFullYear(),j=Math.floor(c.getMonth()/3),k=a.getMonth()%3;for(d=g;d<=i;d++)for(e=s(a,d),d!==g&&(h=0),d!==i&&(j=3),f=h;f<=j;f++)if(e=u(e,d,f,k),e>=b&&e<=c)return!0;return!1}function w(a,b,c){var d,e,f,g=b.getFullYear(),h=b.getMonth(),i=c.getFullYear(),j=c.getMonth();for(d=g;d<=i;d++)for(e=s(a,d),d!==g&&(h=0),d!==i&&(j=11),f=h;f<=j;f++)if(e=t(e,d,f),e>=b&&e<=c)return!0;return!1}function x(a,b,c,f,g,h,i){var j,k;if(a<=d.PivotDateFilterOperator.notBetween)switch(a){case d.PivotDateFilterOperator.equalsTo:return function(a){return n(f,b)===n(f,a)};case d.PivotDateFilterOperator.notEqualsTo:return function(a){return n(f,b)!==n(f,a)};case d.PivotDateFilterOperator.before:return function(a){return n(f,b)>n(f,a)};case d.PivotDateFilterOperator.beforeEqualsTo:return function(a){return n(f,b)>=n(f,a)};case d.PivotDateFilterOperator.after:return function(a){return n(f,b)<n(f,a)};case d.PivotDateFilterOperator.afterEqualsTo:return function(a){return n(f,b)<=n(f,a)};case d.PivotDateFilterOperator.Between:return function(a){return p(a,b,c,f)};case d.PivotDateFilterOperator.notBetween:return function(a){return n(f,a)<n(f,b)||n(f,a)>n(f,c)}}if(a>=8&&a<=23)switch(a){case d.PivotDateFilterOperator.today:return function(a){return n(f)===n(f,a)};case d.PivotDateFilterOperator.yesterday:return function(a){return n(f)-e.PRE_DAY===n(f,a)};case d.PivotDateFilterOperator.tomorrow:return function(a){return n(f)+e.PRE_DAY===n(f,a)};case d.PivotDateFilterOperator.last7Days:return function(a){var b=n(f),c=n(f,a);return b-7*e.PRE_DAY<=c&&c<b};case d.PivotDateFilterOperator.thisMonth:return function(a){var b=new Date;return b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()};case d.PivotDateFilterOperator.lastMonth:return function(a){var b=new Date;return b.setMonth(b.getMonth()-1),b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()};case d.PivotDateFilterOperator.nextMonth:return function(a){var b=new Date;return b.setMonth(b.getMonth()+1),b.getFullYear()===a.getFullYear()&&b.getMonth()===a.getMonth()};case d.PivotDateFilterOperator.thisWeek:return function(a){var b=e.VBc(new Date),c=e.VBc(new Date);return b.setDate(b.getDate()-b.getDay()),c.setDate(c.getDate()-c.getDay()+6),a>=b&&a<=c};case d.PivotDateFilterOperator.lastWeek:return function(a){var b=e.VBc(new Date),c=e.VBc(new Date);return b.setDate(b.getDate()-b.getDay()-7),c.setDate(c.getDate()-c.getDay()),a>=b&&a<=c};case d.PivotDateFilterOperator.nextWeek:return function(a){var b=e.VBc(new Date),c=e.VBc(new Date);return b.setDate(b.getDate()-b.getDay()+7),c.setDate(c.getDate()-c.getDay()+14),a>=b&&a<=c};case d.PivotDateFilterOperator.nextQuarter:return function(a){var b,c,d=e.VBc(new Date),f=d.getMonth(),g=f%3;return d.setDate(1),d.setMonth(f-g+3),b=e.VBc(new Date),b.setMonth(f-g+6),c=2===b.getMonth()||11===b.getMonth()?31:30,b.setDate(c+1),a>=e.VBc(d)&&a<e.VBc(b)};case d.PivotDateFilterOperator.thisQuarter:return function(a){var b,c,d=e.VBc(new Date),f=d.getMonth(),g=f%3;return d.setDate(1),d.setMonth(f-g),b=e.VBc(new Date),b.setMonth(f-g+3),c=2===b.getMonth()||11===b.getMonth()?31:30,b.setDate(c+1),a>=e.VBc(d)&&a<=e.VBc(b)};case d.PivotDateFilterOperator.lastQuarter:return function(a){var b,c,d=e.VBc(new Date),f=d.getMonth(),g=f%3;return d.setDate(1),d.setMonth(f-g-3),b=e.VBc(new Date),b.setMonth(f-g),c=2===b.getMonth()||11===b.getMonth()?31:30,b.setDate(c+1),a>=e.VBc(d)&&a<e.VBc(b)};case d.PivotDateFilterOperator.nextYear:return function(a){var b=e.VBc(new Date);return b.getFullYear()+1===a.getFullYear()};case d.PivotDateFilterOperator.thisYear:return function(a){var b=e.VBc(new Date);return b.getFullYear()===a.getFullYear()};case d.PivotDateFilterOperator.lastYear:return function(a){var b=e.VBc(new Date);return b.getFullYear()-1===a.getFullYear()}}if(a>=d.PivotDateFilterOperator.Q1&&a<=d.PivotDateFilterOperator.Q4)return function(b){return a-d.PivotDateFilterOperator.Q1===Math.floor(b.getMonth()/3)};if(a>=d.PivotDateFilterOperator.M1&&a<=d.PivotDateFilterOperator.M12)return function(b){return a-d.PivotDateFilterOperator.M1===b.getMonth()};if(a===d.PivotDateFilterOperator.yearToDate)return function(a){var b=new Date,c=new Date;return b.setMonth(0,1),b.setHours(0,0,0,0),c.setHours(23,59,59),a>=b&&a<=c};if(a===d.PivotDateFilterOperator.dateToDate){if(j=o(f,b),k=g?o(f):o(f,c),!h)return function(a){return n(f,a)>=n(f,j)&&n(f,a)<=n(f,k)};if(i===d.PivotAdvancedDateFilterBy.year)return function(a){return r(o(f,a),j,k)};if(i===d.PivotAdvancedDateFilterBy.quarter)return function(a){return v(o(f,a),j,k)};if(i===d.PivotAdvancedDateFilterBy.month)return function(a){return w(o(f,a),j,k)}}}j=function(){function a(a,b,c,e,f,g,h){this.uBc=d.PivotConditionType.date;var i=this;i.QBc=a,i._Qa=c,i.aRa=e,i.WBc=b,i.NMJ=f,i.dCc=h,i.OMJ=g,i.evaluate=x(a,i._Qa,i.aRa,b,f,g,h)}return a.prototype.getConditionType=function(){return this.uBc},a.prototype.toJSON=function(){var a=this,b=a.QBc,c=a.WBc,f;return f=e.Fa(a.aRa)?[a._Qa]:[a._Qa,a.aRa],{conType:d.PivotConditionType.date,val:f,operator:b,isWholeDay:c,isDynamicEndDate:a.NMJ,isParallel:a.OMJ,by:a.dCc}},a.prototype.fromJSON=function(a){var b=a.val,c=a.operator,d=a.isWholeDay,e=a.isDynamicEndDate,g=a.isParallel,h=a.by,i=this;i.QBc=c,i.WBc=d,i.NMJ=e,i.dCc=h,i.OMJ=g,b instanceof Array?(i._Qa=b[0],i.aRa=b[1]):(i._Qa=b,i.aRa=f),i.evaluate=x(i.QBc,i._Qa,i.aRa,d,i.NMJ,i.OMJ,i.dCc)},a}(),b.PivotFilterDateCondition=j},"./src/pivot-engine.ts":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/pivot-cache.ts"),e=c("./src/data-analyzer.ts"),f=c("./src/pivot-util.ts");function h(a,b){var c,d=b[0].length;for(c=0;c<b.length;c++)b[c][d]=a.getValue(c,0);return b}g=function(){function a(){var a=this;a.ZBc={},a.resetDataAnalyzer(),a.uYJ=1,a.zEc=1e8}return a.prototype.hasPivotCache=function(a){return!!this.ZBc[a]},a.prototype.addPivotCache=function(a){var b=this,c;return b.ZBc[a.getName()]=a,c=f.Fa(a.yEc)?i(b.uYJ,b.ZBc):i(a.yEc,b.ZBc),b.uYJ=c+1,a.yEc=c,f.Fa(a.cTJ)?(a.cTJ=b.zEc,b.zEc++):a.cTJ>b.zEc&&(b.zEc=a.cTJ+1),a},a.prototype.getPivotCacheByName=function(a){return this.ZBc[a]},a.prototype.getPivotCacheByCacheId=function(a){var b,c=this,d=c.ZBc;for(b in d)if(d.hasOwnProperty(b)&&d[b].yEc===a)return d[b]},a.prototype.getPivotCacheByPivotCacheId=function(a){var b,c=this,d=c.ZBc;for(b in d)if(d.hasOwnProperty(b)&&d[b].cTJ===a)return d[b]},a.prototype.cDc=function(a){var b,c=this;for(b in c.ZBc)if(c.ZBc.hasOwnProperty(b)&&c.ZBc[b].dDc(a))return c.ZBc[b];return null},a.prototype.dispose=function(){var a,b=this;for(a in b.ZBc)b.ZBc.hasOwnProperty(a)&&b.ZBc[a].dispose();b.ZBc={},b._Bc=null},a.prototype.reset=function(){this.ZBc={}},a.prototype.update=function(){},a.prototype.queryItem=function(a,b,c){var d,e,f,g,h=this.getPivotCacheByName(a),i=!1;for(d=0,e=b;d<e.length;d++)if(f=e[d],g=h.getField(f.sourceName),g.HSJ()&&(g=h.getField(g.SDc)),g.GSJ&&g.GSJ.length>0){i=!0;break}return this._Bc.mBc(h,this._Bc.Ha(h,b,i),b,c)},a.prototype.oTJ=function(a,b,c){var d=this.getPivotCacheByName(a);return this._Bc.oTJ(d,this._Bc.Ha(d,b),c)},a.prototype.getCalcFields=function(a){var b=this.getPivotCacheByName(a);return b?b.hNc():[]},a.prototype.addGroup=function(a,b){var c=this.getPivotCacheByName(a);return!!c&&c.UCc(b)},a.prototype.fromJson=function(a){var b,c,e=this;this.resetDataAnalyzer();for(b in a)a.hasOwnProperty(b)&&(c=new d.PivotCache,c.fromJson(b,a[b],e),e.addPivotCache(c))},a.prototype.toJson=function(a,b){var c,d,e,g,h=this.ZBc,i={};for(c=0,d=b;c<d.length;c++)e=d[c],g=h[e],f.Fa(g)||(i[g.yEc]=g.toJson(a[e]));return i},a.prototype.cdK=function(a,b,c){var e,f=this;this.resetDataAnalyzer(),e=new d.PivotCache,e.cdK(a,b,c),f.addPivotCache(e)},a.prototype.bdK=function(a,b){var c,d,e,g,h=this.ZBc,i={};for(c=0,d=b;c<d.length;c++)e=d[c],g=h[e],f.Fa(g)||(i[g.Cj]=g.bdK(a[e]));return i},a.prototype.resetDataAnalyzer=function(){this._Bc=new e.DataAnalyzer},a}(),b.PivotEngine=g;function i(a,b){var c,d,e,f={};for(c=0,d=b;c<d.length;c++)e=d[c],f[e.yEc]=1;for(;f[a];)a++;return a}},"./src/pivot-interface.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.item=0]="item",a[a.next=1]="next",a[a.previous=2]="previous"}(d=b.PivotShowDataAsBaseItemType||(b.PivotShowDataAsBaseItemType={})),function(a){a[a.isCalcField=0]="isCalcField",a[a.isGroupField=1]="isGroupField"}(e=b.PivotSourceFieldType||(b.PivotSourceFieldType={})),function(a){a[a.average=0]="average",a[a.count=1]="count",a[a.countNums=2]="countNums",a[a.max=3]="max",a[a.min=4]="min",a[a.product=5]="product",a[a.stdDev=6]="stdDev",a[a.stdDevp=7]="stdDevp",a[a.sum=8]="sum",a[a.varr=9]="varr",a[a.varp=10]="varp"}(f=b.SubtotalType||(b.SubtotalType={})),function(a){a[a.number=0]="number",a[a.string=1]="string",a[a.date=2]="date",a[a.boolean=3]="boolean",a[a.errorValue=4]="errorValue",a[a.noValue=5]="noValue"}(g=b.PivotDataType||(b.PivotDataType={})),function(a){a[a.caption=0]="caption",a[a.date=1]="date",a[a.value=2]="value",a[a.top10=3]="top10"}(h=b.PivotConditionType||(b.PivotConditionType={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.greaterThan=2]="greaterThan",a[a.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",a[a.lessThan=4]="lessThan",a[a.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",a[a.between=6]="between",a[a.notBetween=7]="notBetween"}(i=b.PivotValueFilterOperator||(b.PivotValueFilterOperator={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.beginsWith=2]="beginsWith",a[a.doesNotBeginWith=3]="doesNotBeginWith",a[a.endsWith=4]="endsWith",a[a.doesNotEndWith=5]="doesNotEndWith",a[a.contains=6]="contains",a[a.doesNotContain=7]="doesNotContain",a[a.greaterThan=8]="greaterThan",a[a.greaterThanOrEqualsTo=9]="greaterThanOrEqualsTo",a[a.lessThan=10]="lessThan",a[a.lessThanOrEqualsTo=11]="lessThanOrEqualsTo",a[a.between=12]="between",a[a.notBetween=13]="notBetween"}(j=b.PivotCaptionFilterOperator||(b.PivotCaptionFilterOperator={})),function(a){a[a.equalsTo=0]="equalsTo",a[a.notEqualsTo=1]="notEqualsTo",a[a.before=2]="before",a[a.beforeEqualsTo=3]="beforeEqualsTo",a[a.after=4]="after",a[a.afterEqualsTo=5]="afterEqualsTo",a[a.Between=6]="Between",a[a.notBetween=7]="notBetween",a[a.today=8]="today",a[a.yesterday=9]="yesterday",a[a.tomorrow=10]="tomorrow",a[a.last7Days=11]="last7Days",a[a.thisMonth=12]="thisMonth",a[a.lastMonth=13]="lastMonth",a[a.nextMonth=14]="nextMonth",a[a.thisWeek=15]="thisWeek",a[a.lastWeek=16]="lastWeek",a[a.nextWeek=17]="nextWeek",a[a.nextQuarter=18]="nextQuarter",a[a.thisQuarter=19]="thisQuarter",a[a.lastQuarter=20]="lastQuarter",a[a.nextYear=21]="nextYear",a[a.thisYear=22]="thisYear",a[a.lastYear=23]="lastYear",a[a.Q1=24]="Q1",a[a.Q2=25]="Q2",a[a.Q3=26]="Q3",a[a.Q4=27]="Q4",a[a.M1=28]="M1",a[a.M2=29]="M2",a[a.M3=30]="M3",a[a.M4=31]="M4",a[a.M5=32]="M5",a[a.M6=33]="M6",a[a.M7=34]="M7",a[a.M8=35]="M8",a[a.M9=36]="M9",a[a.M10=37]="M10",a[a.M11=38]="M11",a[a.M12=39]="M12",a[a.yearToDate=40]="yearToDate",a[a.dateToDate=41]="dateToDate"}(k=b.PivotDateFilterOperator||(b.PivotDateFilterOperator={})),function(a){a[a.month=1]="month",a[a.quarter=2]="quarter",a[a.year=3]="year"}(l=b.PivotAdvancedDateFilterBy||(b.PivotAdvancedDateFilterBy={})),function(a){a[a.count=0]="count",a[a.percent=1]="percent",a[a.sum=2]="sum"}(m=b.PivotTop10FilterType||(b.PivotTop10FilterType={})),function(a){a[a.top=1]="top",a[a.bottom=-1]="bottom"}(n=b.PivotTop10FilterOperator||(b.PivotTop10FilterOperator={})),function(a){a[a.row=0]="row",a[a.col=1]="col",a[a.none=2]="none"}(o=b.DataPosition||(b.DataPosition={})),function(a){a[a.seconds=0]="seconds",a[a.minutes=1]="minutes",a[a.hours=2]="hours",a[a.days=3]="days",a[a.months=4]="months",a[a.quarters=5]="quarters",a[a.years=6]="years"}(p=b.DateGroupType||(b.DateGroupType={})),function(a){a[a.normal=0]="normal",a[a.percentOfTotal=1]="percentOfTotal",a[a.percentOfRow=2]="percentOfRow",a[a.percentOfCol=3]="percentOfCol",a[a.percent=4]="percent",a[a.percentOfParentRow=5]="percentOfParentRow",a[a.percentOfParentCol=6]="percentOfParentCol",a[a.percentOfParent=7]="percentOfParent",a[a.difference=8]="difference",a[a.percentDiff=9]="percentDiff",a[a.runTotal=10]="runTotal",a[a.percentOfRunningTotal=11]="percentOfRunningTotal",a[a.rankAscending=12]="rankAscending",a[a.rankDescending=13]="rankDescending",a[a.index=14]="index"}(q=b.PivotShowDataAs||(b.PivotShowDataAs={})),function(a){a[a.asc=0]="asc",a[a.desc=1]="desc",a[a.custom=2]="custom"}(r=b.SortType||(b.SortType={}))},"./src/pivot-sort.ts":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/pivot-interface.ts"),f=c("./src/pivot-util.ts"),g=c("./pivot-entry.ts"),h=new d.Common.ResourceManager(g.SR),i=h.getResource.bind(h),b._GJ=function(a,b){var c,d;return a===b?0:(c=+a,d=+b,d&&c?c>d?1:-1:(""+a).localeCompare(b+""))},b.aHJ=function(a,b){return a>=b?1:-1},b.bHJ=function(a,b){return a.getMonth()>=b.getMonth()?1:-1},b.cHJ=function(a,b){return Math.floor(a.getMonth()/3)>=Math.floor(b.getMonth()/3)?1:-1},b.dHJ=function(a,b){return a>=b?1:-1},b.FIJ=function(a,c){var d,g,h,k,l,m,n,o=i().blank;for(c===e.DateGroupType.years?(a.sort(b._GJ),d=a):(g=j(c),d=g.concat([])),l=0,m=!1,n=0;n<a.length;n++)a[n]&&a[n]!==o?a[n].indexOf(f.LESS)>-1?(h=a[n],l++):a[n].indexOf(f.MORE)>-1&&(k=a[n],l++):m=!0;return c===e.DateGroupType.years&&(d=d.splice(l)),h&&d.unshift(h),k&&d.push(k),m&&d.unshift(o),d},b.mJJ=function(a){var c,d,e,g,h=[],i={},j=[];for(c=0,d=a.length;c<d;c++)e=void 0,a[c].indexOf(f.LESS)>-1?e=f.LESS:a[c].indexOf(f.MORE)>-1?e=f.MORE:a[c].indexOf(f.NUMBER_GROUP_SEPARATOR)>-1&&(e=f.NUMBER_GROUP_SEPARATOR),g=e?a[c].split(e)[1]:a[c],h.push(g),i[g]=c;for(h.sort(b._GJ),c=0,d=h.length;c<d;c++)j.push(a[i[h[c]]]);return j};function j(a){var b,c,d=[],h=i().dateResource,j=h.HOUR_GROUP_ITEMS.slice(),k=h.MINUTE_GROUP_ITEMS.slice(),l=h.SECOND_GROUP_ITEMS.slice();switch(a){case e.DateGroupType.quarters:for(b=0;b<f.quartersGroupItemsKey.length;b++)d.push(h[f.quartersGroupItemsKey[b]]);break;case e.DateGroupType.months:for(b=0;b<f.monthsGroupItemsKey.length;b++)d.push(h[f.monthsGroupItemsKey[b]]);break;case e.DateGroupType.days:for(b=0;b<f.monthsGroupItemsKey.length;b++)for(c=1;c<=f.dayCountPerMonth[b];c++)d.push(g.dkK(h[f.monthsGroupItemsKey[b]],c));break;case e.DateGroupType.hours:for(b=0;b<j.length;b++)d.push(j[b]);break;case e.DateGroupType.minutes:for(b=0;b<k.length;b++)d.push(k[b]);break;case e.DateGroupType.seconds:for(b=0;b<l.length;b++)d.push(l[b])}return d}b.ZGJ=function(a,c){var d,e,h,j;if(c.isDate)f.Fa(c.by)?a.sort(function(a,b){return new Date(a)>new Date(b)?1:-1}):a=b.FIJ(a,c.by);else if(c.isNumberGroup)a=b.mJJ(a);else{for(d=[],e=[],h=[],j=0;j<a.length;j++)a[j]!==i().blank?"number"==typeof a[j]?d.push(a[j]):"string"==typeof a[j]?e.push(a[j]):"object"==typeof a[j]&&e.push(a[j]._error?a[j]._error:a[j]+""):h.push(a[j]);d.length>1&&d.sort(function(a,b){return a-b}),e.length>1&&e.sort(function(a,b){return g.JJJ(a,b)}),a=d.concat(e,h)}return a}},"./src/pivot-util.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/pivot-interface.ts"),f=c("./pivot-entry.ts"),g=Math.min,h=Math.max,i=Math.abs,j=Math.pow,k=Math.sqrt,l=Math.floor,m=Math.ceil,n=!0,o=new d.Common.ResourceManager(f.SR,"PivotEngine"),b.getSR=o.getResource.bind(o),p=d.Formatter&&d.Formatter.GeneralFormatter,q=void 0,b.monthsGroupItemsKey=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],b.dayCountPerMonth=[31,29,31,30,31,30,31,31,30,31,30,31],b.quartersGroupItemsKey=["Qtr1","Qtr2","Qtr3","Qtr4"],r=d.Common.CultureManager,s=d.Common.l,b.LESS="<",b.MORE=">",b.NUMBER_GROUP_SEPARATOR="-",t="string",b.XFileConstants={b9:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",i9:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",c9:"http://schemas.openxmlformats.org/markup-compatibility/2006",TbK:"xr",ccK:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision"},u=function(){function a(){}return a.qb=function(b){var c=a.rb[b];return c||(c=a.rb[b]=RegExp(b,"g")),c.lastIndex=0,c},a.ub=function(b,c,d){var e,f,g,h,i,j;if(a.vb[b])return a.wb[b];if(e="[~?*]+",a.qb(e).test(b)){for(f=[],g=b.split(""),h=void 0,i={".":n,"+":n,$:n,"^":n,"[":n,"]":n,"(":n,")":n,"{":n,"}":n,"|":n,"/":n},j=0;j<g.length;j++)h=g[j],"~"===h&&j<g.length-1?(j++,h=g[j],"*"===h||"?"===h?f.push("\\"):c&&f.push("~"),f.push(h)):"?"===h?f.push("."):"*"===h?(f.push("[\\s\\S]"),d?f.push("+"):f.push("*")):i[h]?(f.push("\\"),f.push(h)):f.push(h);return f.join("")}return null},a.zb=function(b,c,d){var e=a.ub(b,c,d);return e&&(e="^"+e+"$"),e},a.Ab=function(a){return a.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},a.rb={},a.vb={},a.wb={},a}(),b.mEc=u;function x(a,b,c,d,e){var f=u.ub(b);return f?(f=c+f+d,u.qb(f).test(a)):e()}function y(a,b){return a&&b?(a.splice.apply(a,[a.length,b.length].concat(b)),a.sort(function(a,b){return a-b}),a):a||b||[]}b.GIc=y;function z(a){var b,c,d,e,f,g;if(!a||a&&0===a.length)return[];for(b=a[0],c=a.length,d={},D(b,function(a){d[a]=1}),e=function(b){var c={},e=!0;if(D(a[b],function(a){d[a]&&(c[a]=1,e=!1)}),d=c,e)return{value:[]}},f=1;f<c;f++)if(g=e(f),"object"==typeof g)return g.value;return Object.keys(d)}b.Lyc=z;function A(a,b){var c,d=[],e=0;for(c=0;c<a.length;c++)for(;e<b.length;){if(!(a[c]>b[e])){if(a[c]===b[e]){d.push(a[c]);break}break}e++}return d}function B(a){var b,c,d=a[0];for(b=1,c=a.length;b<c&&(d=A(d,a[b]),0!==d.length);b++);return d}function C(a,b){var c,d,e=!1;for(c=0,d=a.length;c<d;c++)b===a[c]&&(e=!0);return e}b.NBc=C;function D(a,b){var c,d,e=a.length;for(c=0;c<e&&!(d=b(a[c],c));c++);}b.Yxc=D;function E(a){var b,c=[];for(b=0;b<a.length;b++)c=c.concat(a[b]);return c}b.eCc=E;function F(a){return void 0===a||null===a}b.Fa=F;function G(a){return"string"==typeof a}b.jk=G;function H(a){return!F(a)&&(G(a)&&(a=parseFloat(a)),a===a&&isFinite(a))}b.Da=H;function I(a){return a<10?"0"+a:a+""}function J(a){var b;try{b=a.getFullYear()+"-"+I(a.getMonth()+1)+"-"+I(a.getDate())+"T"+I(a.getHours())+":"+I(a.getMinutes())+":"+I(a.getSeconds())}catch(a){}return b}b.AIc=J;function K(a){return a.getUTCFullYear()+"/"+I(a.getUTCMonth()+1)+"/"+I(a.getUTCDate())}b.BIc=K;function L(a,b){return b.slice(0,a.length).toLowerCase()===a.toLowerCase()}b.nEc=L;function M(a,b){return x(a,b,"^","",function(){return L(a,b)})}b.SBc=M;function N(a,b){return b.slice(-a.length).toLowerCase()===a.toLowerCase()}b.oEc=N;function O(a,b){return x(a,b,"","$",function(){return N(a,b)})}b.TBc=O;function P(a,b){return""===b||a.toLowerCase().indexOf(b.toLowerCase())>=0}b.pEc=P;function Q(a,b){return x(a,b,"","",function(){return P(b,F(a)?"":a)})}b.UBc=Q;function R(a,b){return a.toLowerCase()===b.toLowerCase()}b.qEc=R;function S(a,b){return x(b,a,"","",function(){return R(b,F(a)?"":a)})}b.lEc=S,b.PRE_DAY=864e5;function T(a){var b,c,d;return a&&a instanceof Date?(b=a.getFullYear(),c=a.getMonth(),d=a.getDate(),new Date(b,c,d)):a}b.VBc=T;function U(a){return"string"==typeof a}b.isString=U;function V(a){var c=b.getSR().dateResource;return c[b.monthsGroupItemsKey[a.getMonth()]]}function W(a){var c=b.getSR().dateResource.HOUR_GROUP_ITEMS;return c[a.getHours()]}function X(a){var c=b.getSR().dateResource.MINUTE_GROUP_ITEMS;return c[a.getMinutes()]}function Y(a){var c=b.getSR().dateResource.SECOND_GROUP_ITEMS;return c[a.getSeconds()]}function Z(a){var c=b.getSR().dateResource;return c[b.quartersGroupItemsKey[Math.floor(a.getMonth()/3)]]}function $(){var a,c,d=[],e=b.getSR().dateResource;for(a=0,c=b.monthsGroupItemsKey.length;a<c;a++)d.push(e[b.monthsGroupItemsKey[a]]);return d}b.IIc=$;function _(a){var b=r.q4(r.culture()),c=b.TimelineDateSuffix;return a+(c&&c.year||"")}b.ckK=_;function aa(a,b){var c=r.q4(r.culture()),d=c.TimelineDateSuffix;return d&&d.date?a+b+d.date:b+"-"+a}b.dkK=aa;function ba(){var a,c,d,e,f=[],g=b.getSR().dateResource;for(a=0,c=b.monthsGroupItemsKey.length;a<c;a++)for(d=0,e=b.dayCountPerMonth[a];d<e;d++)f.push(aa(g[b.monthsGroupItemsKey[a]],d+1));return f}b.HIc=ba;function ca(){var a,c,d=[],e=b.getSR().dateResource;for(a=0,c=b.quartersGroupItemsKey.length;a<c;a++)d.push(e[b.quartersGroupItemsKey[a]]);return d}b.JIc=ca;function da(a){return a&&a[0]===a[a.length-1]&&"'"===a[0]&&(a=a.substring(1,a.length-1)),a}b.oKJ=da;function ea(a){if("number"==typeof a)return a;var b=Date.parse(a);return isNaN(b)?(b=new Date(a),isNaN(b)?a:b):new Date(a)}b.MlK=ea;function fa(a,c){var d,e,f,g;return F(c)||c===b.getSR().blank?b.getSR().blank:(d=a.bCc,e=a.aCJ,f=a.dCc,c<d?b.LESS+d:c>=e?b.MORE+e:(g=d+Math.floor((c-d)/f)*f,g+"-"+(g+f-1)))}b.getNumberGroupItemKey=fa;function ga(a,b){switch(a){case e.DateGroupType.seconds:return Y(b);case e.DateGroupType.minutes:return X(b);case e.DateGroupType.hours:return W(b);case e.DateGroupType.days:return aa(V(b),b.getDate());case e.DateGroupType.months:return V(b);case e.DateGroupType.quarters:return Z(b);case e.DateGroupType.years:return _(b.getFullYear());default:return J(b)}}function ha(a){var b=r.q4(r.culture()).DateTimeFormat,c=b.shortDatePattern;return 0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()||(c=b.defaultDatePattern),
s.Vb(a,c)}b.formatDateToString=ha;function ia(a,c){if(F(c)||c===b.getSR().blank)return b.getSR().blank;var d=a.bCc,e=a.cCc,f=a.dCc,g;if("string"==typeof c&&ma(c))g=ma(c);else{if(!Date.parse(c))return q;g=new Date(c)}return g<d?"<"+ha(d):g>e?">"+ha(e):ga(f,g)}b.getDateGroupItemKey=ia;function ja(a){if(!a||"object"!=typeof a)return!0;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}b.isEmptyObject=ja,b.tGJ=function(a,b){var c,d,e,f,g;if(!a)return a;c=[];for(d in a)a.hasOwnProperty(d)&&c.push(+d);for(c.sort(function(a,c){return(a-c)*b}),e={},f=0,g=c.length;f<g;f++)e[c[f]]=f+1;return e};function ka(a){var b,c,d=Array.isArray(a),e="[object Object]"===Object.prototype.toString.call(a);if(d){for(b=[],c=0;c<a.length;c++)b[c]=ka(a[c]);return b}if(e){b=void 0;for(c in a)F(a[c])||(b===q&&(b={}),b[c]=ka(a[c]));return b}return a}b._AJ=ka;function la(a,b){var c,e;try{e=d.Common.CultureManager.getCultureInfo(),c=e.localeCompare?e.localeCompare(a,b):a.localeCompare(b,"en")}catch(d){c=a.localeCompare(b)}return c}b.JJJ=la;function ma(a){var b,c;if(!F(a)&&""!==a&&"string"==typeof a)return b=new p,c=b.parse(a),c instanceof Date?c:void 0}b.parseStringToDate=ma;function na(a,b){return F(a)?a:(b=b||/(&)|(<)|(>)|(")|(')/g,typeof a===t?a.replace(b,function(a){switch(a){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;"}}):""+a)}b.xmlEncode=na,v=/&#(\d+);/g,w=/&#x([0-9A-F]+);/gi;function oa(a){return function(b,c){return String.fromCharCode(parseInt(c,a))}}function pa(a,b){var c,d;return F(a)?a:(c=typeof a===t,c?a.indexOf("&")===-1?""+a:(d=/(&amp;)|(&gt;)|(&lt;)|(&quot;)|(&apos;)/g,a.indexOf("&#")!==-1&&(a=a.replace(v,oa(10)).replace(w,oa(16))),a.replace(d,function(a){switch(a){case"&amp;":return"&";case"&gt;":return">";case"&lt;":return"<";case"&quot;":return'"';case"&apos;":return"'"}})):""+a)}b.xmlDecode=pa;function qa(a,b){var c,d,e,f,g,h=b.split("&");for(c=0,d=h.length;c<d;c++){if(e=h[c].split("."),f=e[0],g=e[1],!a)return;a=ra(a,f,g)}return a}b.IcK=qa;function ra(a,b,c){var d,e,f,g;if(!a||!a.c_)return q;for(c=c?+c:0,d=a.c_,e=0,f=d.length;e<f;e++)if(g=d[e],g&&g.n_===b){if(0===c)return g;c--}}b.JcK=ra;function sa(a,b){var c,d,e,f,g;if(!a||!a.c_)return q;for(c=a.c_,d=[],e=0,f=c.length;e<f;e++)g=c[e],g&&g.n_===b&&d.push(g);return d}function ta(a,b){var c,d,e,f,g;if(a&&a.c_){for(c=[],d=0,e=b.length;d<e;d++)f=b[d],g=sa(a,f),g&&g.length>0&&(c=c.concat(g));a.c_=c}}b.NcK=ta},"./src/pivotEngine.res.en.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.resource={dateResource:{Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",May:"May",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",Qtr1:"Qtr1",Qtr2:"Qtr2",Qtr3:"Qtr3",Qtr4:"Qtr4",Seconds:"Seconds",Minutes:"Minutes",Hours:"Hours",Days:"Days",Months:"Months",Quarters:"Quarters",Years:"Years",SECOND_GROUP_ITEMS:[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23",":24",":25",":26",":27",":28",":29",":30",":31",":32",":33",":34",":35",":36",":37",":38",":39",":40",":41",":42",":43",":44",":45",":46",":47",":48",":49",":50",":51",":52",":53",":54",":55",":56",":57",":58",":59"],MINUTE_GROUP_ITEMS:[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23",":24",":25",":26",":27",":28",":29",":30",":31",":32",":33",":34",":35",":36",":37",":38",":39",":40",":41",":42",":43",":44",":45",":46",":47",":48",":49",":50",":51",":52",":53",":54",":55",":56",":57",":58",":59"],HOUR_GROUP_ITEMS:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]},Exp_NoItemParseError:"An item name cannot be found. Check that you've typed the name correctly and the item is present in the PivotTable report.",Exp_UnsupportedCalcItemType:"References, names, and arrays are not supported in PivotTable formulas.",blank:"(blank)"}},CalcEngine:function(a,b){a.exports=c("@grapecity/js-calc")},Common:function(a,b){a.exports=c("@grapecity/js-sheets-common")}}),function(c){"object"==typeof a.exports?a.exports=c.Pivot:(d=[],e=function(){return c.Pivot}.apply(b,d),!(void 0!==e&&(a.exports=e)))}(f||{})},"@grapecity/js-calc":function(b,c){b.exports=a.Spread.CalcEngine},"@grapecity/js-sheets-common":function(b,c){b.exports=a.Spread},CellTypes:function(b,c){b.exports=a.Spread.Sheets.CellTypes},ConditionalFormatting:function(b,c){b.exports=a.Spread.Sheets.ConditionalFormatting},Core:function(b,c){b.exports=a.Spread.Sheets},Pivot:function(b,c){b.exports=a.Pivot},Shapes:function(b,c){b.exports=a.Spread.Sheets.Shapes},SheetsCalc:function(b,c){b.exports=a.Spread.Sheets.CalcEngine},Slicers:function(b,c){b.exports=a.Spread.Sheets.Slicers},Tables:function(b,c){b.exports=a.Spread.Sheets.Tables}})});