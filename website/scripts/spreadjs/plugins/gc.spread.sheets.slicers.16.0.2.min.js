/*!
 * 
 * SpreadJS Library 16.0.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
!function(a){"object"==typeof module&&"object"==typeof module.exports?module.exports=a(require("@grapecity/spread-sheets")):"function"==typeof define&&define.amd?define(["@grapecity/spread-sheets"],a):"object"==typeof exports?exports.Spread=a(require("@grapecity/spread-sheets")):a(GC)}(function(a){a="object"==typeof a?a:{},a.Spread=a.Spread||{},a.Spread.Sheets=a.Spread.Sheets||{},a.Spread.Sheets.Slicers=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/slicer/slicer.entry.js")}({"./dist/plugins/slicer/slicer-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.Commands.ActionBase;function m(a){if(a.canUndo()){var b=a.kj,c=d.Commands.bWa(b.name()),e=a.VQ[c];return a.Lz(b,!0),b.ITa.undo(e),a.Mz(b,!0),!0}return!1}function n(a,b,c){var d,e,f=a.parent,g=a.slicers.get(c);f&&b.xC&&g&&(d=g.startRow(),e=g.startColumn(),f.changeSelectionInCommandExecuting(b,d,e,[],[g]))}function o(a,b){for(var c=0;c<a.length;c++)if(a[c].columnName===b)return a[c]._ps&&a[c]._ps.name}f=function(a){l(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!!this.VQ.slicerData},b.prototype.execute=function(){var a,b,c,e=this,f=e.VQ;return!!e.canExecute()&&(a=e.kj,b=o(f.slicerData.Ze,f.columnName),n(a,f,b),a.ITa.startTransaction(),e.Lz(a,!0),f.slicerData.doFilter(f.columnName,{exclusiveRowIndexes:f.newValue}),e.Mz(a,!0),c=d.Commands.bWa(a.name()),e.VQ[c]=a.ITa.endTransaction(),!0)},b.prototype.canUndo=function(){return!!this.VQ.slicerData},b.prototype.undo=function(){return m(this)},b}(e),g=function(a){l(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!!this.VQ.slicerData},b.prototype.execute=function(){var a,b,c,e=this,f=e.VQ;return!!e.canExecute()&&(a=e.kj,b=o(f.slicerData.Ze,f.columnName),n(a,f,b),a.ITa.startTransaction(),e.Lz(a,!0),f.slicerData.doUnfilter(f.columnName),e.Mz(a,!0),c=d.Commands.bWa(a.name()),e.VQ[c]=a.ITa.endTransaction(),!0)},b.prototype.canUndo=function(){return!!this.VQ.slicerData},b.prototype.undo=function(){return m(this)},b}(e),h=function(a){l(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!!this.VQ.slicer},b.prototype.execute=function(){var a,b,c=this,d=c.VQ;return!!c.canExecute()&&(a=c.kj,b=o(d.slicerData.Ze,d.columnName),n(a,d,b),c.Lz(a,!0),d.slicer[d.propertyName](d.newValue),c.Mz(a,!0),!0)},b.prototype.canUndo=function(){return!!this.VQ.slicer},b.prototype.undo=function(){var a,b=this,c=b.VQ;return!!b.canUndo()&&(a=b.kj,b.Lz(a,!0),c.slicer[c.propertyName](c.oldValue),b.Mz(a,!0),!0)},b}(e),i=d.Commands.h4,d.Commands.filterSlicer={canUndo:!0,execute:function(a,b,c){return i(a,f,b,c)}},d.Commands.unfilterSlicer={canUndo:!0,execute:function(a,b,c){return i(a,g,b,c)}},d.Commands.changeSlicerProperty={canUndo:!0,execute:function(a,b,c){return i(a,h,b,c)}},d.Commands.unfilterSlicerByKey={canUndo:!1,execute:function(a,b){var c,e,f,g=d.Commands.bT(a,b),h=g.slicers.UX();if(1===h.length&&(c=h[0],e=c.YX()))return f=e.getFilteredIndexes(c.columnName()),g.wu().execute({cmd:"unfilterSlicer",sheetName:g.name(),slicerData:e,columnName:c.columnName(),value:f})}},j="deleteSlicers",k=function(a){l(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){return!0},b.prototype.execute=function(){var a,b=this,c=!1,e=b.kj,f=b.VQ,g=f.slicerNames;return b.canExecute()&&d.GC$.isArray(g)&&(e.ITa.startTransaction(),b.Lz(e,!0),g.forEach(function(a){e.slicers.vV(a)}),b.Mz(e,!0),a=d.Commands.bWa(e.name()),f[a]=e.ITa.endTransaction(),c=g.length>0),c},b.prototype.undo=function(){var a,b=this,c=b.VQ,e=b.kj;return!!b.canUndo()&&(b.Lz(e,!0),a=d.Commands.bWa(e.name()),e.ITa.undo(c[a]),b.Mz(e,!0),!0)},b}(e),b.DeleteSlicerUndoAction=k,d.Commands[j]={canUndo:!0,execute:function(a,b,c){return c||b.cmd||(b.cmd=j),b.slicerNames.length>0&&i(a,k,b,c)}}},"./dist/plugins/slicer/slicer-base/slicer-base.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Shapes"),f=c("./dist/plugins/slicer/slicer.js"),g=c("./dist/plugins/slicer/slicer-style.js"),h=c("./dist/plugins/slicer/slicer-ui/diagram-util.js"),i=c("./dist/plugins/slicer/slicer-ui/slicer-button.js"),j=d.util.naa,k=d.util.oaa,l=d.Util.Sha,m=d.ExcelHelper.pixelToEMU,n=null,o=void 0,p=1,q="name",r="black",s="white",t="normal 11pt calibri",u="bold 11pt calibri",v=d.Ul.hZa,w=d.Ul.Pl,x=e&&e.SJS_True,y=e&&e.SJS_False;function H(a){return a===o||a===n}b.Fa=H,b.SlicerBaseProperties=[["name","",function(a,b,c){var d=this;d.kj&&(d.kj.slicers.U3(c,b),L.call(d,a,c))}],["captionName","",K],["disableResizingAndMoving",!1,function(a,b,c){var d,e=this;e.allowMove(!b),e.allowResize(!b),K.call(e,"disableResizingAndMoving",b,c),d=e.sheet(),d&&d.$p()}],["showHeader",!0,K]],b.SlicerShapeProperties=["isSelected","isVisible","isLocked","dynamicMove","dynamicSize","x","y","height","width","startRow","startColumn","endRow","endColumn","startRowOffset","startColumnOffset","endRowOffset","endColumnOffset","allowResize","allowMove"],b.ItemSlicerProperties=[["columnCount",1,K,I],["itemHeight",21,K,I],["multiSelect",!1,K]];function I(a){return"number"==typeof a&&a>0}z="i",A="b",B={columnCount:z,multiSelect:A,showHeader:A,showHorizontalScrollbar:A,showSelectionLabel:A,showTimeLevel:A};function J(a,b){return b===z?~~a:b===A?!!a:a}b.ItemSlicerCacheProperties=["showNoDataItems","showNoDataItemsInLast","visuallyNoDataItems","sortState"];function K(a,b,c){var d=this;d[a]&&(H(B[a])||(b=J(b,B[a])),d[a](b),d.refresh()),L.call(d,a,c)}b.onPropertyChanged=K;function L(a,b){var c=this,d=c.sheet();d&&(d.ITa.xVa(c,a,b),c.Wq({sheet:d,sheetName:d.name(),slicer:c,propertyName:a}))}b.afterPropertyChanged=L;function M(a,b,c,d){return w(a,b,function(b,d){c.call(this,a,b,d)},d)}b.defSlicerProperty=M,function(a){a[a.header=1]="header",a[a.captionName=2]="captionName",a[a.clearFilter=3]="clearFilter",a[a.multiSelect=4]="multiSelect",a[a.item=5]="item",a[a.scrollBar=6]="scrollBar"}(C=b.SlicerUIType||(b.SlicerUIType={}));function N(a){var b,c,d;return a.dynamicMove()?a.dynamicSize()||(b="oneCell"):b="absolute",c="timeline"===a.l8,d={editAs:b,from:{col:{v_:a.startColumn()},colOff:{v_:m(a.startColumnOffset())},row:{v_:a.startRow()},rowOff:{v_:m(a.startRowOffset())}},to:{col:{v_:a.endColumn()},colOff:{v_:m(a.endColumnOffset())},row:{v_:a.endRow()},rowOff:{v_:m(a.endRowOffset())}},AlternateContent:{r_:[29],Choice:{r_:c?[36,37]:[34,35],graphicFrame:{macro:"",nvGraphicFramePr:{cNvPr:{id:c?"8":"2",name:j(l(a.name(),"\n","&#xA;"))},cNvGraphicFramePr:{graphicFrameLocks:a.disableResizingAndMoving()?{noMove:x,noResize:x}:{}}},xfrm:{off:{x:0,y:0},ext:{cx:0,cy:0}},graphic:{graphicData:{uri:c?"http://schemas.microsoft.com/office/drawing/2012/timeslicer":"http://schemas.microsoft.com/office/drawing/2010/slicer"}}}},Fallback:{xmlns:"",sp:{macro:"",textlink:"",nvSpPr:{cNvPr:{id:"0",name:""},cNvSpPr:{spLocks:{noTextEdit:x}}},spPr:{xfrm:{off:{x:5486400,y:942975},ext:{cx:1828800,cy:2524125}},prstGeom:{prst:"rect",avLst:{}},solidFill:{prstClr:{val:"white"}},ln:{w:1,solidFill:{prstClr:{val:"green"}}}},txBody:{bodyPr:{vertOverflow:"clip",horzOverflow:"clip"},lstStyle:{},p:[{n_:"p",c_:[{r:{rPr:{lang:"en-US",sz:"1100"},t:{v_:c?"Timeline: Works in Excel 2013 or higher. Do not move or resize.":"This shape represents a table slicer. Table slicers are supported in Excel or later.    If the shape was modified in an earlier version of Excel, or if the workbook was saved in Excel 2007 or earlier, the slicer can't be used."}}}]}]}}}},clientData:{}},c?(d.AlternateContent.Choice.graphicFrame.nvGraphicFramePr.cNvPr.extLst={ext:{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}",creationId:{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{729A7851-DBA1-4F10-BB7B-BEC1E3EEDA64}"}}},d.AlternateContent.Choice.graphicFrame.graphic.graphicData.timeslicer={r_:[36],name:j(l(a.name(),"\n","&#xA;"))}):d.AlternateContent.Choice.graphicFrame.graphic.graphicData.slicer={r_:[38],name:j(l(a.name(),"\n","&#xA;"))},d}b.getSlicerDrawing=N,e&&(D=function(){function a(a,b,c){this.kj=b,this.XXJ=c,this.name(a),this.captionName(this.sourceName())}return a.prototype.init=function(){var a=this;a.initSlicerUI(),a.paintSlicerUI()},a.prototype.setFilter=function(){this.XXJ.setFilter()},a.prototype.clearFilter=function(){this.XXJ.clearFilter()},a.prototype.filterCleared=function(){return this.XXJ.filterCleared()},a.prototype.initSlicerUI=function(){},a.prototype.paintSlicerUI=function(){this.SSJ&&this.SSJ.refresh()},a.prototype.refresh=function(){this.paintSlicerUI()},a.prototype.no=function(){var a=this;a.SSJ.dispose(),a.SSJ=n,a.kj=n,a.XXJ=n,a.Wqa=n},a.prototype.sheet=function(){return this.kj},a.prototype.sourceName=function(){return this.XXJ.sourceName},a.prototype.nameInFormula=function(a){var b=this;return 0===arguments.length?b.XXJ.name:void(b.XXJ.name=a)},a.prototype.position=function(a){var b=this;return 0===arguments.length?new d.Point(b.x(),b.y()):(b.x(a.x||h.DEFAULT_LEFT),b.y(a.y||h.DEFAULT_TOP),b)},a.prototype.style=function(a){var b,c=this;return 0===arguments.length?c.Wqa:void(c.Wqa!==a&&(b=new g.SlicerStyle,b.fromJSON(c.Wqa.toJSONInternal()),c.Wqa.fromJSON(a.toJSONInternal()),c.SSJ.setStyle(c.Wqa),c.refresh(),L.call(c,"style",b)))},a.prototype.Wq=function(a){var b=this.sheet();b&&b.Wq(d.Events.SlicerChanged,a)},a.prototype.cOJ=function(a){for(var b=1,c=this,d=a,e=c.sheet().parent;f.vSJ(e,d);)d=a+b,b++;return d},a.prototype.toJSON=function(a){var c,d=this,e={},g=d.XXJ;return e.type=d.l8,e.slicerCacheName=g.name,d.style()&&(e.style=d.style().toJSON()),d.l8===f.SlicerType.table&&(c=g._getTable(),c&&c.fOJ&&(e.newTableName=c.fOJ,e.sourceName=d.sourceName())),b.SlicerBaseProperties.forEach(function(b){var c=b[0];c===q?H(a)?e[q]=d.name():e[q]=d.cOJ(d.name()):e[c]=d[c]()}),b.SlicerShapeProperties.forEach(function(a){d[a]&&(e[a]=d[a]())}),e.nameInFormula=d.nameInFormula(),e},a.prototype.fromJSON=function(a){var c=this;b.SlicerBaseProperties.forEach(function(b){var d=b[0];a[d]!==o&&c[d](a[d])}),b.SlicerShapeProperties.forEach(function(b){c[b]&&a[b]!==o&&c[b](a[b])}),c.style().fromJSON(a.style)},a.prototype.getSlicerUIRect=function(a,b){if(this.SSJ)return this.SSJ.W4J(a,b)},a.prototype.cdK=function(a,b,c,d,e){var f,h,i=this,j=a.name;j!==o&&i.name(k(l(j,"_x000a_","\n"))),a.caption!==o&&i.captionName(k(a.caption)),a.showCaption!==o&&i.showHeader("1"===a.showCaption),a.lockedPosition!==o&&i.disableResizingAndMoving("1"===a.lockedPosition),j!==o&&b!==o&&i.SSJ!==o&&i.SSJ.cdK(b,j,d,e),f=a.style||c.getDefaultStyleName("defaultSlicerStyle"),f&&(g.isBuildInSlicerStyle(f)?i.style(g.SlicerStyles[f.substring(11).toLowerCase()]()):(h=c.getSlicerStyle(f),h&&i.style(h)))},a}(),b.SlicerBaseProperties.forEach(function(a){D.prototype[a[0]]=M(a[0],a[1],a[2],a[3])}),b.SlicerShapeProperties.forEach(function(a){D.prototype[a]=function(b){var c=this;return 0===arguments.length?this.SSJ&&this.SSJ.getProperty(a):(c.SSJ.setProperty(a,b),"isLocked"===a&&c.refresh(),this)}}),D.prototype.getShapePoints=function(){return this.SSJ&&this.SSJ.jxa&&this.SSJ.jxa.shape.getShapePoints()},E=function(){function a(a,b,c){this.XSJ={},this.YSJ=!1,this.kj=a,this.updateOptionsCallback=b,this.updateValuesCallback=c,this.ZSJ()}return a.prototype.ZSJ=function(){},a.prototype.bind=function(a,b){this.XSJ||(this.XSJ={}),this.XSJ[a]||(this.XSJ[a]=[]),this.XSJ[a].push(b)},a.prototype.Wq=function(a,b){var c=this.XSJ[a];c&&c.length>0&&c.forEach(function(a){a(b)})},a.prototype.getProperty=function(a){var b=this;if(b.nSa[a])return b.nSa[a]()},a.prototype.setProperty=function(a,b){var c=this;if(c.nSa[a])return c.nSa[a](b)},a.prototype.refreshFormControl=function(){var a=this,b=a.jxa;b.options=a.updateOptionsCallback()},a.prototype.setStyle=function(a){this.jxa.setStyle(a)},a.prototype.refresh=function(){var a=this;a.refreshFormControl()},a.prototype.cdK=function(a,b,c,e){var f,g,h=this,i=d.Util.eiK(a,"twoCellAnchor.AlternateContent.Choice.graphicFrame.graphic.graphicData.slicer.name",b);i&&(f=i.AlternateContent.Choice.graphicFrame.nvGraphicFramePr.cNvPr,d.Util.alK(c)&&d.Util.clK(h.kj,i,o,e),g={nvSpPr:{cNvPr:f},spPr:{prstGeom:{prst:"rect"}}},i.sp=g,i.anchorType=0,h.jxa.cdK(g,i),delete i.sp)},a.prototype.dispose=function(){this.jxa&&(this.jxa.dispose(),this.jxa=n),this.YSJ||(this.YSJ=!0,this.kj.shapes.remove(this.nSa.name())),this.XSJ=n,this.nSa=n},a.prototype.W4J=function(a,b){var c;return this.jxa&&(c=this.jxa.W4J(a,b)),c},a}(),F=function(a){G(b,a);function b(){var b=null!==a&&a.apply(this,arguments)||this;return b.YTJ={},b.OG=!1,b}return b.prototype.isInternalUseForUIDisplay=function(){return!0},b.prototype.onMouseDown=function(a){return!!this.shouldProcessMouseDownEvt(a)&&void(this.doMouseDown(a.evt)&&(this.OG=!0,a.cancelDefault=!0))},b.prototype.onMouseMove=function(a){this.doMouseMove(a.evt),this.OG&&(a.cancelDefault=!0);var b=this.sheet;H(b)||H(b.QAJ)||(clearTimeout(b.QAJ),delete b.QAJ)},b.prototype.onMouseUp=function(a){this.doMouseUp(a.evt),this.OG&&(a.cancelDefault=!0,this.OG=!1)},b.prototype.z1J=function(){var a=this.sheet.options,b=this.i6;return!a.isProtected||!b.isLocked||a.protectionOptions.allowEditObjects},b.prototype.shouldProcessMouseEvt=function(a){var b=a.canvas.getPointer(a.evt);return this.z1J()&&this.hitTest(b)},b.prototype.shouldProcessMouseDownEvt=function(a){return this.shouldProcessMouseEvt(a)&&0===a.evt.button},b.prototype.doMouseDown=function(a){return!1},b.prototype.doMouseMove=function(a){},b.prototype.doMouseUp=function(a){this.tTJ.onMouseUp(a)},b.prototype.onClearFilterButtonClick=function(){this.triggerEvent("clearFilter"),this.onClearFilter(),this.refresh()},b.prototype.onClearFilter=function(){},b.prototype.addEventListener=function(a,b){var c=this,d=c.YTJ[a]||[];d.push(b),c.YTJ[a]=d},b.prototype.removeEventListener=function(a,b){var c=this,d=c.YTJ[a]||[],e=d.indexOf(b);e!==-1&&d.splice(e,1)},b.prototype.fireEvent=function(a,b){var c=this,d=c.YTJ[a]||[];d.forEach(function(a){return a(c.shape,b)})},b.prototype.dispose=function(){this.tTJ.dispose(),this.tTJ=null,this.YTJ=null,a.prototype.dispose.call(this)},b.prototype.getButtonBGStyle=function(){var a=this.getHeaderStyle(),b=this.getWholeStyle();return{headerStyle:a,wholeStyle:b}},b.prototype.initClearFilterButton=function(){var a=new i.SlicerButton,b=a.props;b.contentType="callback",b.containerSize={w:20,h:18},b.renderCallBack=O,b.onButtonClick=this.onClearFilterButtonClick.bind(this),b.getPointerRelativeControl=this.getPointerRelativeControl.bind(this),b.refresh=this.refresh.bind(this),b.setCursor=this.setCursor.bind(this),b.getBackColor=this.getButtonBGStyle.bind(this),b.getThemeColor=this.getThemeColor.bind(this),a.props=b,this.tTJ=a},b.prototype.onWindowMouseMove=function(a){this.tTJ.onWindowMouseMove(a)},b.prototype.getWholeStyle=function(){return this.Wqa.wholeSlicerStyle()},b.prototype.getHeaderStyle=function(){return this.Wqa.headerStyle()},b.prototype.getThemeColor=function(a){return this.shape.kj.currentTheme().getColor(a)},b.prototype.triggerEvent=function(a,b){this.fireEvent(a,b)},b.prototype.setCursor=function(a){var b=this.shape.kj.Ws();b&&(b.style.cursor=a)},b.prototype.setStyle=function(a){this.Wqa=a},b.prototype.X4J=function(a){return 0===arguments.length?this.Y4J:void(this.Y4J=!!a)},b.prototype.W4J=function(a,b){var c,e=this,f=e.i6.showHeader,g=e.width,h=e.height;switch(a){case C.header:c=f?new d.Rect(0,0,g,Math.min(h,25)):n;break;case C.captionName:c=f?new d.Rect(10,10,g-60,Math.min(h,10)):n;break;case C.clearFilter:c=f?new d.Rect(g-30,5,16,16):n;break;case C.multiSelect:c=f?new d.Rect(g-55,5,16,16):n}return b||(b={}),b.left=10,b.top=f?30:5,{rect:c,args:b}},b.prototype.render=function(a,b){var c,d,e,f,g=this;if(g.Wqa)return c=-g.width/2,d=-g.height/2,e=g.width-20,f=g.height-40,a.textAlign="left",a.textBaseline="middle",g.paintBody(a,c,d,e,f),g.i6.showHeader?g.paintHeader(a,c,d,e,f):f+=30,g.X4J()&&g.Z4J(a,c,d,e,f),{left:c,top:d,w:e,h:f}},b.prototype.paintBody=function(a,b,c,e,f){var g,i,j,k,l=this,m=l.getWholeStyle();for(a.save(),g=new d.Rect(b,c,l.width,l.height),i=0;i<4;i++)j=h.Border_Names[i],k=m[j](),k&&h.paintBorder(a,i,g,k,this.getThemeColor.bind(this));h.appendBackColorStyle(a,b,c,l.width,l.height,m,m,this.getThemeColor.bind(this)),a.fillRect(g.x,g.y,g.width,g.height),a.restore()},b.prototype.paintHeader=function(a,b,c,e,f){var g,i,j,k,l,m,n,o,p,q,t,u=this;for(a.save(),g=new d.Rect(b,c,u.width,Math.min(u.height,25)),a.rect(g.x,g.y,g.width,g.height),a.clip(),a.beginPath(),i=u.getHeaderStyle(),j=u.getWholeStyle(),i&&i.backColor()||j&&j.backColor()?h.appendBackColorStyle(a,b,c,g.width,g.height,i,j,this.getThemeColor.bind(this)):a.fillStyle=s,a.fillRect(g.x,g.y,g.width,g.height),k=u.i6.captionName||"",a.font=v(u.jWJ(i,j)),l=i&&i.foreColor()||j&&j.foreColor()||r,a.fillStyle=u.getThemeColor(l),a.fillText(h.getEllipsisText(a,k,e-50),b+10,c+15),m=!1,!u.yTJ(i.borderBottom())&&u.yTJ(i.borderRight())&&u.yTJ(i.borderLeft())&&u.yTJ(i.borderTop())&&(m=!0),n=0;n<4;n++)o=h.Border_Names[n],p=i[o](),p&&(2===n&&m&&(g.width-=20,g.x+=10),h.paintBorder(a,n,g,p,this.getThemeColor.bind(this)),2===n&&m&&(g.width+=20,g.x-=10));q=u.tTJ,t=u.filterCleared(),a.translate(.5*e-20,c+5),q.props.offset=u.LZJ(),q.props.enabled=!t,q.render(a),a.restore()},b.prototype.Z4J=function(a,b,c,d,e){var f=b,g=c;for(a.save(),a.beginPath(),a.fillStyle="red";f<d+b;)a.fillRect(f,c,1,e),f+=10;for(a.fillStyle="lightblue";g<e+c;)a.fillRect(b,g,d,1),g+=10;a.restore()},b.prototype.filterCleared=function(){return!0},b.prototype.LZJ=function(){var a=this;return{top:-5,left:-a.width+30}},b.prototype.yTJ=function(a){return!(a&&a.borderColor()&&a.borderStyle()&&a.borderWidth())},b.prototype.jWJ=function(a,b){return a&&a.font()?a.font():b&&b.font()&&b.font()!==t?b.font():u},b.prototype.isNeedControlCursorBySelf=function(){return!0},b.prototype.isNeedControlCommandBySelf=function(){return!0},b.prototype.cdK=function(a,b){this.shape.cdK(a,b),this.shape.dob(!0)},b}(e.BaseFormControl),b.SlicerBase=D,b.SlicerViewModelBase=E,b.SlicerViewBase=F);function O(a,b){a.save(),a.strokeStyle="#000000",a.miterLimit=4,a.fillStyle=b?"#FFFFFF":"#DCDCDC",a.font="15px",a.beginPath(),a.moveTo(0,0),a.lineTo(14,0),a.lineTo(14,3),a.lineTo(9,9),a.lineTo(9,14),a.lineTo(5,14),a.lineTo(5,9),a.lineTo(0,3),a.lineTo(0,0),a.stroke(),a.beginPath(),a.moveTo(0,0),a.lineTo(14,0),a.lineTo(14,3),a.lineTo(9,9),a.lineTo(9,14),a.lineTo(5,14),a.lineTo(5,9),a.lineTo(0,3),a.lineTo(0,0),a.fill(),a.restore(),a.save(),a.fillStyle=b?"#E65249":"#C4C4C4",a.font="15px",a.beginPath(),a.moveTo(16,10.75),a.lineTo(15.25,10),a.lineTo(13,12.25),a.lineTo(10.75,10),a.lineTo(10,10.75),a.lineTo(12.25,13),a.lineTo(10,15.25),a.lineTo(10.75,16),a.lineTo(13,13.75),a.lineTo(15.25,16),a.lineTo(16,15.25),a.lineTo(13.75,13),a.lineTo(16,10.75),a.fill(),a.restore()}},"./dist/plugins/slicer/slicer-base/slicer-cache-base.js":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.pivotSlicer=1]="pivotSlicer",a[a.pivotTimeline=2]="pivotTimeline",a[a.tableSlicer=3]="tableSlicer"}(d=b.SlicerCacheType||(b.SlicerCacheType={})),e=function(){function a(a,b){this.name=a,this.sourceName=b,this.eTJ=[],this.Lia=!1}return a.prototype.filterCleared=function(){return!0},a.prototype.suspendUpdate=function(){this.Lia=!0},a.prototype.resumeUpdate=function(){this.Lia=!1,this.updateCache()},a.prototype.canUpdate=function(){return!this.Lia},a.prototype._XJ=function(){return null},a.prototype.beforeSetFilter=function(){var a=this,b=a._XJ();a.suspendUpdate(),b.suspendPaint(),b.suspendCalcService()},a.prototype.afterSetFilter=function(){var a=this,b=a._XJ();b.resumeCalcService(!1),b.resumePaint(),a.resumeUpdate()},a.prototype.add=function(a,b){return null},a.prototype.get=function(a){var b,c=this;return c.eTJ.forEach(function(c){if(c.name()===a)return b=c,!0}),b},a.prototype.remove=function(a){var b=this;b.Q4J||b.eTJ.forEach(function(c,d){if(c.name()===a)return b.eTJ.splice(d,1),c.no(),!0})},a.prototype.updateCache=function(){},a.prototype.onWorkSheetDisposing=function(a){var b,c,d=this;for(b=d.eTJ.length-1;b>-1;b--)c=d.eTJ[b],c.sheet()&&c.sheet().name()!==a||d.eTJ.splice(b,1)},a.prototype.setFilter=function(){},a.prototype.clearFilter=function(){},a.prototype.refreshSlicers=function(){this.eTJ.forEach(function(a){a.refresh()})},a.prototype.toJSON=function(){},a.prototype.fromJSON=function(a){var b=this;b.disposeAllSlicers(),b.eTJ=[],b.name=a.name},a.prototype.disposeAllSlicers=function(){var a=this;a.Q4J=!0,a.eTJ.forEach(function(a){a.no()}),a.Q4J=!1},a.prototype.dispose=function(){var a=this;a.disposeAllSlicers(),a.eTJ=null},a}(),b.SlicerCacheBase=e},"./dist/plugins/slicer/slicer-style.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/slicer/slicer-base/slicer-base.js"),g=d.Ul.Pl,h=d.Ul.Ol,i=e.Common.k.ac,j=null,k=void 0,l="normal 11pt calibri",m={wholeSlicerStyle:"wholeTable",headerStyle:"headerRow"},n={XYJ:"Style",YYJ:"Color",ZYJ:"Width",Gcc:"border",Lcc:"top",Occ:"header",Qcc:"body",$YJ:"periodLabel",_YJ:"selectedTimeBlock",Hcc:"WithDataStyle",Icc:"WithNoDataStyle",Jcc:"electedItem",Kcc:"hovered",Mcc:"gc-slicer-",Ncc:"container",Pcc:"clearfilter",Rcc:"itemscontainer",Scc:"item"},o="name",p="light",q="dark",r="white",s="black",t="thin",u="font",v="setBorders",w="back"+n.YYJ,x="fore"+n.YYJ,y=n.Gcc+"Width",z=n.Gcc+n.XYJ,A=n.Gcc+n.YYJ,B=n.Gcc+"Left",C=n.Gcc+"Top",D=n.Gcc+"Right",E=n.Gcc+"Bottom",F="textDecoration",G="wholeSlicer"+n.XYJ,H="header"+n.XYJ,I="s"+n.Jcc+n.Hcc,J="s"+n.Jcc+n.Icc,K="unS"+n.Jcc+n.Hcc,L="unS"+n.Jcc+n.Icc,M=n.Kcc+"S"+n.Jcc+n.Hcc,N=n.Kcc+"S"+n.Jcc+n.Icc,O=n.Kcc+"UnS"+n.Jcc+n.Hcc,P=n.Kcc+"UnS"+n.Jcc+n.Icc,Q="selectionLabel"+n.XYJ,R="timeLevel"+n.XYJ,S=n.$YJ+"1"+n.XYJ,T=n.$YJ+"2"+n.XYJ,U=n._YJ+n.XYJ,V="un"+n._YJ+n.XYJ,W=n._YJ+"Space"+n.XYJ,X="Accent ",Y="Slicer"+n.XYJ,Z="Time"+Y,$="#999999",_="#828282",aa="#CCCCCC",ba=" 40",ca=" 60",da=" 80",ea=" -25",fa=" -50",ga="bold 11pt calibri",ha="normal 10pt calibri",ia="normal 9pt calibri",ja="Text 1 50",ka="Background 1 -15",la=["empty","thin","medium","dashed","dotted","thick","double","hair","mediumDashed","dashDot","mediumDashDot","dashDotDot","mediumDashDotDot","slantedDashDot"],ma={selectedItemWithData:"selectedItemWithDataStyle",selectedItemWithNoData:"selectedItemWithNoDataStyle",unselectedItemWithData:"unSelectedItemWithDataStyle",unselectedItemWithNoData:"unSelectedItemWithNoDataStyle",hoveredSelectedItemWithData:"hoveredSelectedItemWithDataStyle",hoveredSelectedItemWithNoData:"hoveredSelectedItemWithNoDataStyle",hoveredUnselectedItemWithData:"hoveredUnSelectedItemWithDataStyle",hoveredUnselectedItemWithNoData:"hoveredUnSelectedItemWithNoDataStyle",wholeTable:"wholeSlicerStyle",headerRow:"headerStyle"},na={selectionLabel:"selectionLabelStyle",timeLevel:"timeLevelStyle",periodLabel1:"periodLabel1Style",periodLabel2:"periodLabel2Style",selectedTimeBlock:"selectedTimeBlockStyle",unselectedTimeBlock:"unselectedTimeBlockStyle",selectedTimeBlockSpace:"selectedTimeBlockSpaceStyle",wholeTable:"wholeSlicerStyle",headerRow:"headerStyle"},oa={selectedItemWithDataStyle:"selectedItemWithData",selectedItemWithNoDataStyle:"selectedItemWithNoData",unSelectedItemWithDataStyle:"unselectedItemWithData",unSelectedItemWithNoDataStyle:"unselectedItemWithNoData",hoveredSelectedItemWithDataStyle:"hoveredSelectedItemWithData",hoveredSelectedItemWithNoDataStyle:"hoveredSelectedItemWithNoData",hoveredUnSelectedItemWithDataStyle:"hoveredUnselectedItemWithData",hoveredUnSelectedItemWithNoDataStyle:"hoveredUnselectedItemWithNoData"},pa={selectionLabelStyle:"selectionLabel",timeLevelStyle:"timeLevel",periodLabel1Style:"periodLabel1",periodLabel2Style:"periodLabel2",selectedTimeBlockStyle:"selectedTimeBlock",unselectedTimeBlockStyle:"unselectedTimeBlock",selectedTimeBlockSpaceStyle:"selectedTimeBlockSpace"},qa={empty:0,thin:1,medium:2,dashed:3,dotted:4,thick:5,double:6,hair:7,mediumDashed:8,dashDot:9,mediumDashDot:10,dashDotDot:11,mediumDashDotDot:12,slantedDashDot:13},ra={9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3};function Ha(a,b){return!!(a&&a.length>0&&a.filter(function(a){return a.name===b}).length>0)}function Ia(a,b,c,d){var e,g,h,i=[],j={n_:"tableStyle",c_:i,name:a};if(!(d?Oa(a):Pa(a)))for(e in c)if(c.hasOwnProperty(e)&&"name"!==e&&!f.Fa(c[e]))switch(e){case"headerStyle":case"wholeSlicerStyle":cb(c[e]),g=b.getDxfIndex(c[e]),g!==k&&(h={n_:"tableStyleElement",type:m[e],dxfId:g},i.push(h))}j.pivot=0,j.count=i.length,0===i.length&&delete j.c_,b.addTableStyle(j)}function Ja(a){var b,c,e;return a.N9?(e=a.N9,c=d.NodeHelper.pca(e.dxfId,0),b=e.type):(c=a.dxfId,b=a.type),{type:b,dxfId:c}}for(sa=function(){function a(){var a=this;a[o]("",!1),a[G](Na(),!1)}return a.prototype.fromJSON=function(b){var c,e,f,g;if(b&&!d.GC$.isEmptyObject(b))return c=this,e=b.name,h(e)&&(c.name(e),Oa(e))?(f=e.toLocaleLowerCase().replace("slicerstyle","").replace(" ",""),g=Ka(f),void a.properties.forEach(function(a){c[a](g[a](),!1)})):void a.properties.forEach(function(a){var d,e=b[a];a!==o&&(d=Ka(),h(e)&&d.fromJSON(e),c[a](d,!1))})},a.prototype.toJSON=function(){var a,b,c,e=this;a=Oa(e.name())?{name:e.name()}:e.toJSONInternal(),b={};for(c in a)a[c]===j||a[c]===k||d.GC$.isEmptyObject(a[c])||(b[c]=a[c]);return b},a.prototype.toJSONInternal=function(){var b,c,d,e=this,f={},g="toJSON";for(f[o]=e.name(),b=1,c=i(a.properties);b<c;b++)d=a.properties[b],f[d]=e[d]()?e[d]()[g]():j;return f},a.prototype.bdK=function(a,b,c,d){var e,g,h,i,j,l,m=this,n=m.toJSON();if(a&&Ia(m.name(),c,n,!0),b){if(e=d.dxfsRecords,g=d.slicerStyleNodes,Ha(g,m.name()))return;if(!Oa(m.name())){h=[];for(i in n)if(n.hasOwnProperty(i)&&"name"!==i&&!f.Fa(n[i]))switch(i){case"selectedItemWithDataStyle":case"selectedItemWithNoDataStyle":case"unSelectedItemWithDataStyle":case"unSelectedItemWithNoDataStyle":case"hoveredSelectedItemWithDataStyle":case"hoveredSelectedItemWithNoDataStyle":case"hoveredUnSelectedItemWithDataStyle":case"hoveredUnSelectedItemWithNoDataStyle":cb(n[i]),j=e.FdK(n[i]),j!==k&&(l={n_:"slicerStyleElement",type:oa[i],dxfId:j},h.push(l))}g.push({name:m.name(),styleElements:h})}}},a.prototype.cdK=function(a,b,c,d,e){var f,g,h,i,j,k,l,o,p,q,r,s,t,u=this;if(u.name(a),d&&d.length>0)for(f=0,g=d;f<g.length;f++)h=g[f],i=Ja(h),j=i.type,k=i.dxfId,l=ma[j],"function"==typeof u[l]&&(o=new ua,p=c.GdK(k),bb(p),o.fromJSON(p),u[l](o));if(e&&e.length>0)for(q=0,r=e;q<r.length;q++)h=r[q],l=ma[h.type],s=b.getTableTheme(a),s&&(p=new ua,t=s[m[l]+n.XYJ](),bb(t),p.fromJSON(t),u[l](p));b.addSlicerStyle(u)},a.properties=[o,G,H,I,J,K,L,M,N,O,P],a}(),b.SlicerStyle=sa,ta=function(){function a(){var a=this;a[o]("",!1),a[G](Na(),!1)}return a.prototype.fromJSON=function(b){var c,e,f,g;if(b&&!d.GC$.isEmptyObject(b))return c=this,e=b.name,h(e)&&(c.name(e),Pa(e))?(f=e.toLocaleLowerCase().replace("timeslicerstyle","").replace(" ",""),g=La(f),void a.properties.forEach(function(a){c[a](g[a](),!1)})):void a.properties.forEach(function(a){var d,e=b[a];a!==o&&(d=La(),h(e)&&d.fromJSON(e),c[a](d,!1))})},a.prototype.toJSON=function(){var a,b,c,e=this;a=Pa(e.name())?{name:e.name()}:e.toJSONInternal(),b={};for(c in a)a[c]===j||a[c]===k||d.GC$.isEmptyObject(a[c])||(b[c]=a[c]);return b},a.prototype.toJSONInternal=function(){var b,c,d,e=this,f={},g="toJSON";for(f[o]=e.name(),b=1,c=i(a.properties);b<c;b++)d=a.properties[b],f[d]=e[d]()?e[d]()[g]():j;return f},a.prototype.bdK=function(a,b,c,d){var e,g,h,i,j,l,m=this,n=m.toJSON();if(a&&Ia(m.name(),c,n,!1),b){if(e=d.x15dxfsRecords,g=d.timelineStyleNodes,Ha(g,m.name()))return;if(!Pa(m.name())){h=[];for(i in n)if(n.hasOwnProperty(i)&&"name"!==i&&!f.Fa(n[i]))switch(i){case"selectionLabelStyle":case"timeLevelStyle":case"periodLabel1Style":case"periodLabel2Style":case"selectedTimeBlockStyle":case"unselectedTimeBlockStyle":case"selectedTimeBlockSpaceStyle":cb(n[i]),j=e.FdK(n[i]),j!==k&&(l={n_:"timelineStyleElement",type:pa[i],dxfId:j},h.push(l))}g.push({name:m.name(),styleElements:h})}}},a.prototype.cdK=function(a,b,c,d,e){var f,g,h,i,j,k,l,o,p,q,r,s,t,u=this;if(u.name(a),d&&d.length>0)for(f=0,g=d;f<g.length;f++)h=g[f],i=Ja(h),j=i.type,k=i.dxfId,l=na[j],"function"==typeof u[l]&&(o=new ua,p=c.GdK(k),bb(p),o.fromJSON(p),u[l](o));if(e&&e.length>0)for(q=0,r=e;q<r.length;q++)h=r[q],l=na[h.type],s=b.getTableTheme(a),s&&(p=new ua,t=s[m[l]+n.XYJ](),bb(t),p.fromJSON(t),u[l](p));b.addTimelineStyle(u)},a.properties=[o,G,H,Q,R,S,T,U,V,W],a}(),b.TimelineStyle=ta,ua=function(){function a(b,c,d,e,f,g,h,j){for(var k=0,l=i(a.properties);k<l;k++)this[a.properties[k]](arguments[k])}return a.prototype.setBorders=function(a){var b=this;b[B](a)[C](a)[D](a)[E](a)},a.prototype.fromJSON=function(b){if(b&&!d.GC$.isEmptyObject(b)){var c=this;a.properties.forEach(function(a){var d,e=b[a];h(e)&&(a.indexOf(n.Gcc)>=0?(d=Ma(),d.fromJSON(e),c[a](d,!1)):c[a](e,!1))})}},a.prototype.toJSON=function(){var b=this,c={};return a.properties.forEach(function(a){var d=b[a]();b[a].isDefault(d)||(c[a]=d&&d.toJSON?d.toJSON():d)}),c},a.properties=[w,x,u,B,C,D,E,F],a}(),b.SlicerStyleInfo=ua,va=0,wa=i(ua.properties);va<wa;va++)ua.prototype[ua.properties[va]]=g(ua.properties[va]);function Ka(a){var b,c;return a&&0!==i(a)?0===a.indexOf(p)?(c=parseInt(a.replace(p,""),10),b=Ea[p+c]()):0===a.indexOf(q)?(c=parseInt(a.replace(q,""),10),b=Ea[q+c]()):Ea[a]&&(b=Ea[a]()):b=new ua,b}function La(a){var b,c;return a&&0!==i(a)?0===a.indexOf(p)?(c=parseInt(a.replace(p,""),10),b=Fa[p+c]()):0===a.indexOf(q)?(c=parseInt(a.replace(q,""),10),b=Fa[q+c]()):Fa[a]&&(b=Fa[a]()):b=new ua,b}for(xa=function(){function a(b,c,d){for(var e=0;e<a.properties.length;e++)this[a.properties[e]](arguments[e])}return a.prototype.fromJSON=function(b){var c,e,f;if(b&&!d.GC$.isEmptyObject(b))for(c=0;c<a.properties.length;c++)e=a.properties[c],f=b[e],h(f)&&(e!==z||""===f||Qa(f)||(f=t),this[e](f,!1))},a.prototype.toJSON=function(){var b,c,d,e={};for(b=0;b<a.properties.length;b++)e[a.properties[b]]=this[a.properties[b]]();c={};for(d in e)e[d]!==k&&e[d]!==j&&(c[d]=e[d]);return c},a.properties=[y,z,A],a}(),b.SlicerBorder=xa,ya=function(a,b,c){
return g(a,b,c,function(b){var c=typeof b;return a===y?"number"===c&&b>=0:"string"===c})},va=0;va<xa.properties.length;va++)xa.prototype[xa.properties[va]]=ya(xa.properties[va],k,k);function Ma(a,b,c){return new xa(a,b,c)}function Na(){var a=new xa(0,"",""),b=new ua(r,s,l);return b.setBorders(a),b}function Oa(a){var b=0,c=17,d=16,e=17;return a.indexOf(Y+"Light")>-1&&i(a)===c&&(b=parseInt(a[c-1],10)),a.indexOf(Y+"Dark")>-1&&i(a)===d&&(b=parseInt(a[d-1],10)),a.indexOf(Y+"Other")>-1&&i(a)===e?(b=parseInt(a[e-1],10),b>=1&&b<=2):b>=1&&b<=6}b.isBuildInSlicerStyle=Oa;function Pa(a){var b=0,c=21,d=20;return a.indexOf(Z+"Light")>-1&&i(a)===c&&(b=parseInt(a[c-1],10)),a.indexOf(Z+"Dark")>-1&&i(a)===d&&(b=parseInt(a[d-1],10)),b>=1&&b<=6}b.isBuildInTimelineStyle=Pa;function Qa(a){return la.indexOf(a)>-1}for(za=function(a,b,c,d){return g(a,b,c,d)},va=1,Aa=i(sa.properties);va<Aa;va++)sa.prototype[sa.properties[va]]=za(sa.properties[va]);for(va=1,Ba=i(ta.properties);va<Ba;va++)ta.prototype[ta.properties[va]]=za(ta.properties[va]);sa.prototype.name=za(o,""),ta.prototype.name=za(o,"");function Ra(){return new sa}function Sa(){return new ta}Ca=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,p,q,r,s,t,u,v,w){var x,y,z=Ra(),A=Y+a+b;return z[o](A),x=Ka(),x.font(c),x.backColor(d),x.setBorders(e),z.wholeSlicerStyle(x),y=Ka(),y.borderLeft(f),y.borderTop(f),y.borderRight(f),y.borderBottom(g),z.headerStyle(y),z[I](Ua(h,i,j)),z[J](Ua(k,l,m)),z[K](Ua(n,p,q)),z[L](Ua(r,s,t)),Ta(z,Ua(u,v,w)),z},Da=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,p,q=Sa(),s=Z+a+b;return q[o](s),g=La(),g.backColor(r),g.setBorders(c),q.wholeSlicerStyle(g),h=La(),h.font(ga),q.headerStyle(h),i=La(),i.font(ha),i.foreColor(d),q[Q](i),j=La(),j.foreColor(ja),j.font(ia),q[R](j),k=La(),k.foreColor(ja),k.font(ia),q[S](k),l=La(),l.foreColor(ja),l.font(ia),q[T](l),m=La(),m.backColor(e),q[U](m),n=La(),n.backColor(ka),q[V](n),p=La(),p.backColor(f),q[W](p),q};function Ta(a,b){a[M](b)[N](b)[O](b)[P](b)}function Ua(a,b,c){var d=Ka();return d[x](a)[w](b)[v](c),d}function Va(a,b){return{degree:90,stops:[{position:0,color:a},{position:1,color:b}]}}function Wa(){return Va("#F8E162","#FCF7F4")}function Xa(){return Va("#A3BBDF","#CADEF6")}function Ya(){return Va("#E8EBEE","#F8F8FA")}function Za(a){var b=X+a;return Ca("Light",a,l,r,Ma(1,t,b),Ma(0,"",""),Ma(1,t,b),s,b+ca,Ma(1,t,$),_,b+da,Ma(1,t,aa),s,r,Ma(1,t,aa),_,r,Ma(1,t,"#E0E0E0"),s,Wa(),Ma(1,t,$))}function $a(a){var b=X+a;return Ca("Dark",a,l,r,Ma(1,t,b),Ma(0,"",""),Ma(1,t,b),r,b,Ma(1,t,b),b+ea,b+ca,Ma(1,t,b+ca),s,"#C0C0C0",Ma(1,t,"#C0C0C0"),"#959595","#DFDFDF",Ma(1,t,"#DFDFDF"),s,Wa(),Ma(1,t,$))}function _a(a,b){var c=X+b,d="Light"===a?Va(c+ca,c):Va(c,c+fa);return Da(a,b,Ma(1,t,c),c+ea,d,c+ba)}function ab(a){return a.color===s&&0===a.style&&a.level===k}function bb(a){var b,c,d,e,g;if(!f.Fa(a))for(b=0,c=Object.keys(a);b<c.length;b++)if(d=c[b],a.hasOwnProperty(d)&&!f.Fa(a[d])&&d.indexOf(n.Gcc)!==-1){if(e=a[d],ab(e)){a[d]=k;continue}g=e.style||1,a[d]={borderWidth:ra[g],borderStyle:la[g],borderColor:e.color}}}function cb(a){var b,c,e,g;if(!f.Fa(a))for(b=0,c=Object.keys(a);b<c.length;b++)e=c[b],a.hasOwnProperty(e)&&!f.Fa(a[e])&&e.indexOf(n.Gcc)!==-1&&(g=a[e],a[e]=new d.LineBorder(g.borderColor,qa[g.borderStyle],k))}for(Ea=function(){function a(){}return a}(),b.SlicerStyles=Ea,Fa=function(){function a(){}return a}(),b.TimelineStyles=Fa,Ga=1;Ga<=6;Ga++)Ea["light"+Ga]=function(a){return function(){return Za(a)}}(Ga),Ea["dark"+Ga]=function(a){return function(){return $a(a)}}(Ga),Fa["light"+Ga]=function(a){return function(){return _a("Light",a)}}(Ga),Fa["dark"+Ga]=function(a){return function(){return _a("Dark",a)}}(Ga);Ea.other1=function(){return Ca("Other",1,l,r,Ma(1,t,"#808080"),Ma(0,"",""),Ma(1,t,"#A6A6A6"),s,"#BFBFBF",Ma(1,t,$),s,"#D9D9D9",Ma(1,t,aa),s,r,Ma(1,t,aa),"#959595",r,Ma(1,t,"#E0E0E0"),s,Wa(),Ma(1,t,$))},Ea.other2=function(){return Ca("Other",2,l,r,Ma(1,t,"#4F81BD"),Ma(0,"",""),Ma(1,t,"#4F81BD"),s,Xa(),Ma(1,t,$),_,Xa(),Ma(1,t,aa),s,Ya(),Ma(1,t,aa),_,Ya(),Ma(1,t,"#E0E0E0"),s,Wa(),Ma(1,t,$))},d.GC$.extend(d.StyleManager.prototype,{addSlicerStyle:function(a){var b=this,c=b.kiK;c||(c=b.kiK={}),c[a.name()]=a},getSlicerStyle:function(a){var b,c,e,f=this,g=f.kiK;return g||(g=f.kiK={}),Oa[a.toUpperCase()]?(b=a.substr(11).toLowerCase(),g[b]?g[b]:(c=new sa,e=Ea[b],c.name(e.name()),d.GC$.each(sa.properties,function(a,b){c[b](e[b]())}),f.addSlicerStyle(c),c)):g[a]},addTimelineStyle:function(a){var b=this,c=b.liK;c||(c=b.liK={}),c[a.name()]=a},getTimelineStyle:function(a){var b,c,e,f=this,g=f.liK;return g||(g=f.liK={}),Pa[a.toUpperCase()]?(b=a.substr(13).toLowerCase(),g[b]?g[b]:(c=new ta,e=g[b],c.name(e.name()),d.GC$.each(ta.properties,function(a,b){c[b](e[b]())}),f.addTimelineStyle(c),c)):g[a]}})},"./dist/plugins/slicer/slicer-ui/diagram-util.js":function(a,b,c){"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),b.Border_Names=["borderTop","borderRight","borderBottom","borderLeft"],b.ELLIPSIS="...";function g(a,b,c,d,f,g,h,i){var j,k,l,m=g&&g.backColor()||h&&h.backColor()||"white";if("string"==typeof m)a.fillStyle=i(m);else if("object"==typeof m){if(j=m.stops,j&&j.length>0)for(k=0;k<j.length;k++)l=j[k],l.color=i(l.color);e.To.setFillStyleGradient(a,m,b,c,d,f,function(){})}}b.appendBackColorStyle=g,f={solid:[],dashed:[3,1],dashDot:[8,2,2,2],dotted:[2],dashDotDot:[9,3,3,3,3,3],mediumDashDot:[9,3,3,3],mediumDashDotDot:[9,3,3,3,3,3],mediumDashed:[9,3],hair:[1]};function h(a){return f[a]||f.solid}function i(a,b,c,d,e,f){var g,i,j,k,l;if(d&&d.borderColor()&&d.borderWidth()&&d.borderStyle()){switch(f=f||0,a.beginPath(),g=[c.x,c.y],i=[c.x,c.y+c.height],j=[c.x+c.width,c.y],k=[c.x+c.width,c.y+c.height],l=Math.PI,b){case 0:a.moveTo(g[0]+f,g[1]),a.lineTo(j[0]-f,j[1]),a.arc(j[0]-f,j[1]+f,f,1.5*l,0);break;case 1:a.moveTo(j[0],j[1]+f),a.lineTo(k[0],k[1]-f),a.arc(k[0]-f,k[1]-f,f,0,.5*l);break;case 2:a.moveTo(k[0]-f,k[1]),a.lineTo(i[0]+f,i[1]),a.arc(i[0]+f,i[1]-f,f,.5*l,l);break;case 3:a.moveTo(i[0],i[1]-f),a.lineTo(g[0],g[1]+f),a.arc(g[0]+f,g[1]+f,f,l,1.5*l);break;default:return}a.lineWidth=d.borderWidth()||1,a.strokeStyle=e(d.borderColor()),a.setLineDash(h(d.borderStyle())),a.stroke()}}b.paintBorder=i;function j(a,c,e){var f,g,h,i;if(c=d.Common.j.Fa(c)?"":c,f=a.measureText(c).width,g=c,f>e){for(h="",i=0;i<c.length&&!(a.measureText(h+c[i]+b.ELLIPSIS).width>e);i++)h+=c[i];g=h+b.ELLIPSIS}return g}b.getEllipsisText=j;function k(a,b,c,d,e,f,g){var h=5;a.fillStyle=e,a.fillText(b,h+c,d+f/2,g-h)}b.fillText=k,b.DEFAULT_LEFT=50,b.DEFAULT_TOP=250,b.SLICER_WIDTH=186,b.TIMELINE_WIDTH=345,b.SLICER_HEIGHT=258,b.TIMELINE_HEIGHT=145;function l(a,c){var d,e=b.DEFAULT_LEFT,f=b.DEFAULT_TOP,g=c?b.SLICER_WIDTH:b.TIMELINE_WIDTH,h=c?b.SLICER_HEIGHT:b.TIMELINE_HEIGHT,i=a.getRowCount(),j=a.getColumnCount(),k=0,l=0,m=0,n=0,o=0,p=0;for(d=0;d<i;d++)l+=+a.getRowHeight(d);for(d=0;d<j;d++)k+=+a.getColumnWidth(d);return l<h?(p=l,n=0):l<f+h?(p=h,n=l-p):(p=h,n=f),k<g?(o=k,m=0):k<e+g?(o=g,m=k-o):(o=g,m=e),{left:m,top:n,width:o,height:p}}b.getSlicerSizePosInfo=l},"./dist/plugins/slicer/slicer-ui/item-slicer-view.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Shapes"),e=c("Core"),f=c("./dist/plugins/slicer/slicer-ui/slicer-listbox.js"),g=c("./dist/plugins/slicer/slicer-base/slicer-base.js"),h=c("./dist/plugins/slicer/slicer-ui/slicer-button.js"),b.ItemSlicerFormControl="itemSlicer",d&&(i=function(a){j(b,a);function b(){return null!==a&&a.apply(this,arguments)||this}return b.prototype.init=function(b){a.prototype.init.call(this,b),this.Qb={items:[]},this.i6={},this.initMultiButton(),this.initClearFilterButton(),this.initListBox()},b.prototype.dispose=function(){this.sTJ.dispose(),this.uTJ.dispose(),this.sTJ=null,this.uTJ=null,this.Wqa=null,window.removeEventListener("mousemove",this.onWindowMouseMove),window.removeEventListener("mouseup",this.onWindowMouseUp),window.removeEventListener("keyup",this.onWindowKeyUp),window.removeEventListener("mousewheel",this.onWindowMouseWheel),a.prototype.dispose.call(this)},b.prototype.initMultiButton=function(){var a=new h.SlicerButton,b=a.props;b.type="status",b.contentType="callback",b.containerSize={w:20,h:18},b.renderCallBack=k,b.onButtonClick=this.onMultiButtonClick.bind(this),b.getPointerRelativeControl=this.getPointerRelativeControl.bind(this),b.refresh=this.refresh.bind(this),b.setCursor=this.setCursor.bind(this),b.getBackColor=this.getButtonBGStyle.bind(this),b.getThemeColor=this.getThemeColor.bind(this),a.props=b,this.sTJ=a},b.prototype.initListBox=function(){this.uTJ=new f.ItemSlicerListBox;var a=this.uTJ.props;a.selType=f.ItemSlicerSelectionType.single,a.selIndex=[],a.itemHeight=23,a.offset={top:-30,left:-10},this.uTJ.props=a,this.uTJ.props.onSelIndexChange=this.onSelIndexChange.bind(this),this.uTJ.props.getPointerRelativeControl=this.getPointerRelativeControl.bind(this),this.uTJ.props.refresh=this.refresh.bind(this),this.uTJ.props.getWholeStyle=this.getWholeStyle.bind(this),this.uTJ.props.getItemStyle=this.getItemStyle.bind(this),this.uTJ.props.getThemeColor=this.getThemeColor.bind(this),this.uTJ.props.setCursor=this.setCursor.bind(this),this.onWindowMouseMove=this.onWindowMouseMove.bind(this),this.onWindowMouseUp=this.onWindowMouseUp.bind(this),this.onWindowKeyUp=this.onWindowKeyUp.bind(this),this.onWindowMouseWheel=this.onWindowMouseWheel.bind(this),window.addEventListener("mousemove",this.onWindowMouseMove),window.addEventListener("mouseup",this.onWindowMouseUp),window.addEventListener("keyup",this.onWindowKeyUp),window.addEventListener("mousewheel",this.onWindowMouseWheel)},b.prototype.setItems=function(a){this.Qb.items=a;var b=this.uTJ.props;b.items=a.map(function(a){return a.text}),b.selIndex=this.Qb.items.map(function(a,b){if(a.selected)return b}).filter(function(a){return void 0!==a}),this.refresh()},b.prototype.vTJ=function(){var a,b,c,d,e=this,f=e.Qb.items,g=[],h=e.i6,i=h.sortState,j=h.showNoDataItems,k=h.showNoDataItemsInLast,l=e.uTJ,m=[];return l.items.forEach(function(a,b){l.isSelectedItem(b)&&m.push(a)}),a=!1,j?k?(b=[],c=[],f.forEach(function(a){a.noData?c.push(a.text):b.push(a.text)}),b=e.S4a(b,i),c=e.S4a(c,i),g=b.concat(c),a=!0):g=f.map(function(a){return a.text}):f.forEach(function(a){a.noData||g.push(a.text)}),a||(g=e.S4a(g,i)),d=[],m.forEach(function(a){d.push(g.indexOf(a))}),l.selIndex.join(" ")!==d.join(" ")&&(l.selIndex=d,l.wTJ=void 0),g},b.prototype.S4a=function(a,b){return b===e.SortState.descending?a.reverse():a},b.prototype.xTJ=function(a,b){var c=this,d=c.vTJ(),e=c.uTJ.props;e.containerSize={w:a,h:b},e.items=d,e.columnCount=~~c.columnCount<1?1:~~c.columnCount,e.itemHeight=~~c.i6.itemHeight<1?4:~~(c.i6.itemHeight+3),e.selType=c.i6.multiSelect?f.ItemSlicerSelectionType.multi:f.ItemSlicerSelectionType.single},b.prototype.W4J=function(b,c){var d,e,f,h,i,j=this,k=a.prototype.W4J.call(this,b,c);if(k.rect)return k.rect;switch(b){case g.SlicerUIType.scrollBar:e=j.uTJ.$4J(c),d={rect:e};break;case g.SlicerUIType.item:f=c.index,h=c.displayIndex,i=c.text,g.Fa(f)?g.Fa(h)?g.Fa(i)||(d=j.uTJ.L9J(i)):d=j.uTJ._4J(h+j.uTJ.scrollRowCount*j.uTJ.columnCount):d=j.uTJ._4J(f)}return d&&(d.rect.x+=k.args.left,d.rect.y+=k.args.top),d},b.prototype.render=function(b,c){var d,e,f,g,h,i=a.prototype.render.call(this,b,c);if(i)return d=i.left,e=i.top,f=i.w,g=i.h,h=this,h.paintListBox(b,d,e,f,g),{left:d,top:e,w:f,h:g}},b.prototype.paintHeader=function(b,c,d,f,g){var h,i,j;a.prototype.paintHeader.call(this,b,c,d,f,g),h=this,i=h.sTJ,b.save(),j=new e.Rect(c,d,h.width,Math.min(h.height,25)),b.rect(j.x,j.y,j.width,j.height),b.clip(),b.translate(.5*f-45,d+5),i.props.offset={top:-5,left:-h.width+55},i.props.selected=!!h.i6.multiSelect,i.render(b),b.restore()},b.prototype.paintListBox=function(a,b,c,d,e){var f,g,h=this;a.save(),f=-d/2,g=-e/2,h.i6.showHeader?(g+=10,h.uTJ.props.offset.top=-30):h.uTJ.props.offset.top=-7,a.rect(f,g,d,e),a.clip(),a.beginPath(),a.translate(f,g),h.xTJ(d,e),h.uTJ.render(a),a.restore()},b.prototype.filterCleared=function(){return this.i6.filterCleared},b.prototype.getItemStyle=function(a){var b,c=this.Qb.items.filter(function(b){return b.text===a.itemText})[0];return c?(b=a.hover?"hovered":"",b+=a.selected?a.hover?"Selected":"selected":a.hover?"UnSelected":"unSelected",b+=c.noData&&this.i6.visuallyNoDataItems?"ItemWithNoDataStyle":"ItemWithDataStyle",this.Wqa[b]()):null},b.prototype.onMultiButtonClick=function(a){this.uTJ.props.selType=a?f.ItemSlicerSelectionType.multi:f.ItemSlicerSelectionType.single,this.triggerEvent("propertyChanged",{propName:"multiSelect",value:!!a})},b.prototype.onClearFilter=function(){this.uTJ.onClearFilter()},b.prototype.onSelIndexChange=function(a){this.triggerEvent("valueChanged",a)},b.prototype.onWindowMouseMove=function(b){a.prototype.onWindowMouseMove.call(this,b),this.uTJ.onWindowMouseMove(b),this.sTJ.onWindowMouseMove(b)},b.prototype.onWindowMouseUp=function(a){this.uTJ.onWindowMouseUp(a)},b.prototype.onWindowKeyUp=function(a){this.uTJ.onWindowKeyUp(a)},b.prototype.doMouseDown=function(a){return this.uTJ.onMouseDown(a)},b.prototype.doMouseMove=function(b){this.uTJ.onMouseMove(b),a.prototype.doMouseMove.call(this,b)},b.prototype.doMouseUp=function(b){this.uTJ.onMouseUp(b),this.sTJ.onMouseUp(b),a.prototype.doMouseUp.call(this,b)},b.prototype.onWindowMouseWheel=function(a){this.uTJ.onWindowMouseWheel(a)},Object.defineProperty(b.prototype,"columnCount",{get:function(){return this.i6.columnCount||1},enumerable:!0,configurable:!0}),b}(g.SlicerViewBase),d.registerCustomFormControl(b.ItemSlicerFormControl,i),b.ItemSlicerView=i);function k(a){a.save(),a.strokeStyle="rgba(0,0,0,0)",a.miterLimit=4,a.font="15px",a.fillStyle="#666666",a.beginPath(),a.moveTo(2.71986,5),a.lineTo(7,.674096),a.lineTo(6.24114,0),a.lineTo(2.71986,3.55893),a.lineTo(.758858,1.57697),a.lineTo(0,2.25106),a.lineTo(2.71986,5),a.closePath(),a.moveTo(2.71986,10),a.lineTo(7,5.6741),a.lineTo(6.24114,5),a.lineTo(2.71986,8.55893),a.lineTo(.758858,6.57697),a.lineTo(0,7.25106),a.lineTo(2.71986,10),a.closePath(),a.moveTo(7,10.6741),a.lineTo(2.71986,15),a.lineTo(0,12.2511),a.lineTo(.758858,11.577),a.lineTo(2.71986,13.5589),a.lineTo(6.24114,10),a.lineTo(7,10.6741),a.closePath(),a.moveTo(16,3),a.lineTo(8,3),a.lineTo(8,4),a.lineTo(16,4),a.lineTo(16,3),a.closePath(),a.moveTo(8,8),a.lineTo(16,8),a.lineTo(16,9),a.lineTo(8,9),a.lineTo(8,8),a.closePath(),a.moveTo(16,13),a.lineTo(8,13),a.lineTo(8,14),a.lineTo(16,14),a.lineTo(16,13),a.closePath(),a.fill("evenodd"),a.stroke(),a.restore()}},"./dist/plugins/slicer/slicer-ui/slicer-button.js":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Shapes"),e=c("./dist/plugins/slicer/slicer-ui/diagram-util.js"),f=c("Core"),d&&(g=function(){function a(){var a=this;this.bt=new f.oo(function(){}),this.qTJ={type:"click",enabled:!0,containerSize:{w:30,h:30},offset:{top:0,left:0},content:"",contentType:"text",selected:!1,onButtonClick:function(a){},getBackColor:function(){},getThemeColor:function(a){return""},refresh:function(){},setCursor:function(){},onWindowMouseMove:function(){},getPointerRelativeControl:function(a){return{x:0,y:0}},renderCallBack:function(a,b){}},this.bt.do=function(){a.fR=a.bt.lo(a.qTJ.content)}}return a.prototype.setBackGroundImage=function(){var a=this.bt,b=this.qTJ.content;a.fo(b)},Object.defineProperty(a.prototype,"props",{get:function(){return this.qTJ},set:function(a){this.qTJ=a,"image"===a.contentType&&this.setBackGroundImage()},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this.qTJ=null,this.fR=null,this.bt.no()},a.prototype.render=function(a){var b,c,d,f,g,h,i,j=this,k=j.qTJ;switch(a.save(),b=k.containerSize,c=b.w,d=b.h,h=k.getBackColor(),h&&(f=h.headerStyle,g=h.wholeStyle),e.appendBackColorStyle(a,0,0,c,d,f,g,k.getThemeColor),a.fillRect(0,0,c,d),k.enabled&&j.rTJ&&k.setCursor("pointer"),(j.rTJ||k.selected)&&(i=a.createLinearGradient(0,0,0,d),i.addColorStop(0,"rgb(248, 226, 102)"),i.addColorStop(1,"rgb(255, 255, 255)"),a.fillStyle=i),k.contentType){case"image":j.fR&&a.drawImage(j.fR,0,0);break;case"text":a.fillRect(0,0,c,d),a.textAlign="center",a.font="16px Calibri",a.fillStyle="black",a.fillText(k.content,c/2,d/2,c);break;case"callback":a.fillRect(0,0,c,d),k.renderCallBack(a,k.enabled)}a.restore()},a.prototype.onMouseUp=function(a){var b=this.getPointerRelativeControl(a);this.hitTest(b.x,b.y)&&("click"===this.qTJ.type?this.qTJ.onButtonClick():(this.qTJ.selected=!this.qTJ.selected,this.props.onButtonClick(this.qTJ.selected)))},a.prototype.onWindowMouseMove=function(a){var b=this.getPointerRelativeControl(a);this.rTJ=this.hitTest(b.x,b.y)},a.prototype.refresh=function(){this.qTJ.refresh()},a.prototype.hitTest=function(a,b){var c,d,e,f;return!!this.qTJ.enabled&&(c=this.props.containerSize,d=c.w,e=c.h,f=function(){return a>=0&&a<=d&&b>=0&&b<e},!!f())},a.prototype.getPointerRelativeControl=function(a){var b=this.props.getPointerRelativeControl(a);return b.x+=this.props.offset.left,b.y+=this.props.offset.top,b},a}(),b.SlicerButton=g)},"./dist/plugins/slicer/slicer-ui/slicer-listbox.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Shapes"),f=c("./dist/plugins/slicer/slicer-ui/diagram-util.js"),g=c("./dist/plugins/slicer/slicer-ui/slicer-scrollbar.js"),h=d.Ul.sl,i=d.Ul.hZa,j=3,function(a){a.single="single",a.multi="multi"}(k=b.ItemSlicerSelectionType||(b.ItemSlicerSelectionType={})),l=18,m=4,n="black",o="normal 11pt calibri",e&&(p=function(){function a(){var a,b=this;this.zTJ=!1,this.ATJ=-1,this.li=-1,this.g_=-1,this.BTJ=!1,this.CTJ=!1,this.UUJ=!1,this.VUJ=!1,this.wTJ="",this.DTJ="",this.qTJ={containerSize:{w:300,h:100},selIndex:[],items:[],scrollCount:0,itemHeight:19,columnCount:1,offset:{top:0,left:0},selType:k.single,onSelIndexChange:function(){},onItemClick:function(){},getItemStyle:function(){return null},getWholeStyle:function(){return null},getThemeColor:function(){return""},refresh:function(){},setCursor:function(){},getPointerRelativeControl:function(a){return{x:0,y:0}}},a=new g.SlicerScrollBar,a.props.syncSliderHeightWithPageStep=!0,a.refresh=this.refresh.bind(this),a.getPointerRelativeControl=function(a){var c=b.getPointerRelativeControl(a),d=c.x,e=c.y;return{x:d-b.scrollBarLeftOffset,y:e}},a.setCursor=this.setCursor.bind(this),a.props.onScroll=this.onScrollBarChange.bind(this),this.ETJ=a}return Object.defineProperty(a.prototype,"props",{get:function(){return this.qTJ},set:function(a){this.qTJ=a},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this.ETJ.dispose(),this.wTJ=null,this.selIndex=null,this.qTJ=null},a.prototype.hitTest=function(a,b){var c,d,e,f=this,g=this.height,h=function(){return a>=0&&a<=(f.needHiddenScrollBar?f.itemsAreaWidth:f.scrollBarLeftOffset)&&b>=0&&b<g},i=function(){return a>=f.scrollBarLeftOffset&&a<=f.width&&b>=0&&b<g};return h()?(e=this.getClickItemIndex(a,b),e!==-1&&(c="item",d=e)):i()&&(c="scrollBar"),{target:c,data:d}},a.prototype.onMouseDown=function(a){var b=this,c=b.getPointerRelativeControl(a),d=b.hitTest(c.x,c.y),e=d.target,f=d.data;return"item"===e?(a.shiftKey||(b.g_=f),(h()?a.metaKey:a.ctrlKey)&&(b.DTJ="ctrl",b.UUJ||(b.UUJ=!0)),a.shiftKey&&(b.DTJ="shift",b.VUJ||(b.UUJ=!1,b.VUJ=!0)),b.li=f,b.CTJ=!0,b.zTJ=!0,b.changeSelIndex(),!0):"scrollBar"===e?(b.ETJ.onMouseDown(a),b.zTJ=!0,!0):void 0},a.prototype.onClearFilter=function(){this.wTJ=null},a.prototype.onMouseMove=function(a){var b,c,d,e,f=this;return f.ETJ.onMouseMove(a),b=f.getPointerRelativeControl(a),c=f.hitTest(b.x,b.y),d=c.target,e=c.data,"item"===d?(f.CTJ?f.li!==e&&(f.BTJ=!0,f.li=e,f.changeSelIndex()):f.ATJ=e,f.setCursor("default")):f.ATJ=-1,f.refresh(),!0},a.prototype.onWindowMouseMove=function(a){var b,c;if(this.scrollRowCount>this.maxScrollCount&&(this.scrollRowCount=this.maxScrollCount,this.refresh()),b=this.getPointerRelativeControl(a),c=this.hitTest(b.x,b.y).target,this.mouseDownItemIndexIsValid){if("item"===c)this.stopScrollInterval();else{if(void 0!==this.FTJ)return;b.y<0?this.startScrollInterval(-1):b.y>this.height&&this.startScrollInterval(1)}this.refresh()}void 0===c&&this.ATJ!==-1&&(this.ATJ=-1,this.refresh())},a.prototype.onMouseUp=function(a){var b,c,d=this;return d.ETJ.onMouseUp(a),b=d.getPointerRelativeControl(a),c=d.hitTest(b.x,b.y).target,"item"!==c&&(this.ATJ=-1,this.refresh()),!!d.zTJ&&(d.zTJ=!1,!0)},a.prototype.onWindowMouseUp=function(a){var b,c,d,e,f=this;f.ETJ.onWindowMouseUp(a),f.mouseDownItemIndexIsValid&&(b=f.getPointerRelativeControl(a),c=f.hitTest(b.x,b.y),d=c.target,e=c.data,"item"===d&&f.BTJ&&(f.BTJ=!1,f.li=e),0===f.selIndex.length&&f.setSelIndexRange(0,f.items.length-1),f.VUJ||f.UUJ||f.endSelectOperation()),this.clearState()},a.prototype.endSelectOperation=function(){var a,b,c=this;c.selIndex.sort(function(a,b){return a-b}),a=c.selIndex.join(" "),c.wTJ!==a&&(b=c.selIndex.map(function(a){return c.items[+a]}),c.props.onSelIndexChange(b),c.wTJ=a)},a.prototype.onWindowKeyUp=function(a){var b=this,c=a.keyCode;b.VUJ&&16===c?(b.endSelectOperation(),b.UUJ=!1,b.VUJ=!1):b.UUJ&&(h()?91===c:17===c)&&(b.endSelectOperation(),b.UUJ=!1)},a.prototype.onWindowMouseWheel=function(a){this.ETJ.onWindowMouseWheel(a)},a.prototype.onScrollBarChange=function(){this.scrollRowCount=this.ETJ.props.value},a.prototype.changeSelIndex=function(){var a=this,b=a.g_,c=a.li,d=a.BTJ,e="ctrl"===a.DTJ,f="shift"===a.DTJ;a.isSingleSelType?e?d?c!==b&&a.setCounterSelIndex(c):a.setCounterSelIndex(c):(a.selIndex=[],a.setSelIndexRange(b,c)):a.isMultiSelType&&(f?a.setSelIndexRange(b,c,!0):a.setCounterSelIndex(c))},a.prototype.clearState=function(){var a=!1;this.zTJ&&(this.zTJ=!1,a=!0),this.mouseDownItemIndexIsValid&&(this.ATJ=-1,this.CTJ=!1,this.DTJ="",this.li=-1,a=!0),this.stopScrollInterval(),a&&this.refresh()},a.prototype.$4J=function(a){var b,c,e,f,g,h,i,j=this;if(j.needHiddenScrollBar)return null;switch(b=j.ETJ,c=b.scrollBtnLen,e=j.scrollBarLeftOffset,f=j.scrollBarWidth,g=b.height,h=b.scrollSliderOffset,i=b.scrollSliderLen,a.type){case 1:return new d.Rect(e,0,f,g);case 2:return new d.Rect(e,0,f,c);case 3:return new d.Rect(e,g-c,f,c);case 4:return new d.Rect(e,g-c,f,b.scrollTrackViewLen);case 5:return new d.Rect(e,h,f,i);case 6:return new d.Rect(e,c,f,h-c);case 7:return new d.Rect(e,h+i,f,g-i-2*c)}},a.prototype.render=function(a){a.save(),this.renderItems(a),this.renderScrollBar(a),a.restore()},a.prototype.renderItems=function(a){var b,c,d,e,f,g=this.items,h=this.currentPageDisplayRowCount,i=this.columnCount;for(a.textBaseline="middle",b=this.scrollRowCount*this.columnCount,c=0;c<h;c++)for(d=0;d<i;d++,b++){if(b>=g.length)return;e=d,f=g[b],a.beginPath(),this.paintItem(a,f,c,e,b)}},a.prototype.renderScrollBar=function(a){var b,c,d;this.needHiddenScrollBar||(b=this.height,c=this.scrollBarLeftOffset,d=this.scrollBarWidth,a.save(),a.translate(c,0),this.ETJ.props.containerSize={w:d,h:b},this.ETJ.props.max=this.maxScrollCount,this.ETJ.props.value=this.scrollRowCount,this.ETJ.props.pageStep=this.onePageCanDisplayRowCount,this.ETJ.render(a),a.restore())},Object.defineProperty(a.prototype,"width",{get:function(){return this.props.containerSize.w},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.props.containerSize.h},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selIndex",{get:function(){return this.props.selIndex},set:function(a){this.props.selIndex=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"selType",{get:function(){return this.props.selType},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"items",{get:function(){return this.props.items},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isSingleSelType",{get:function(){return this.selType===k.single},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isMultiSelType",{get:function(){return this.selType===k.multi},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemsAreaWidth",{get:function(){var a=this.width;return this.needHiddenScrollBar||(a-=this.scrollBarWidth),a-.5},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"needHiddenScrollBar",{get:function(){return(this.onePageCanCompletelyDisplayRowCount>=this.rowCount||this.height<=this.itemHeight)&&(this.onePageCanCompletelyDisplayRowCount>=this.rowCount&&(this.scrollRowCount=0),!0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollBarWidth",{get:function(){return Math.min(l,this.width)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollBarLeftOffset",{get:function(){return this.width-this.scrollBarWidth},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemsCount",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"columnCount",{get:function(){return this.props.columnCount},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"rowCount",{get:function(){return Math.ceil(this.items.length/this.columnCount)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemWidth",{get:function(){return this.itemsAreaWidth/this.columnCount},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"itemHeight",{get:function(){return this.props.itemHeight},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollRowCount",{get:function(){return this.props.scrollCount},set:function(a){this.props.scrollCount=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"maxScrollCount",{get:function(){return Math.max(0,this.rowCount-this.onePageCanCompletelyDisplayRowCount)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onePageCanDisplayRowCount",{get:function(){return Math.ceil(this.height/(this.itemHeight+m))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onePageCanCompletelyDisplayRowCount",{get:function(){return Math.floor((this.height+m)/(this.itemHeight+m))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"currentPageDisplayRowCount",{get:function(){var a=this.onePageCanDisplayRowCount,b=this.rowCount-this.scrollRowCount;return Math.min(a,b)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"mouseDownItemIndexIsValid",{get:function(){return this.li!==-1},enumerable:!0,configurable:!0}),a.prototype.scroll=function(a){this.scrollTo(this.scrollRowCount+a)},a.prototype.scrollTo=function(a){var b=0,c=this.maxScrollCount;a=Math.min(a,c),a=Math.max(a,b),this.scrollRowCount=a},a.prototype.setIndexSelected=function(a){this.selIndex.indexOf(a)===-1&&this.selIndex.push(a)},a.prototype.setCounterSelIndex=function(a){var b=this.selIndex,c=b.indexOf(a);c!==-1?b.splice(c,1):b.push(a)},a.prototype.setSelIndexRange=function(a,b,c){var d,e,f;for(a>b&&(d=[b,a],a=d[0],b=d[1]),e=c?this.selIndex:[],f=a;f<=b;f++)e.push(f);this.selIndex=e},a.prototype.setCounterSelIndexRange=function(a,b){var c,d,e,f;for(a>b&&(c=[b,a],a=c[0],b=c[1]),d=this.selIndex,e=a;e<=b;e++)f=d.indexOf(e),f===-1?d.push(e):d.splice(f,1)},a.prototype.getClickItemIndex=function(a,b){var c,d=this.itemWidth,e=this.itemHeight+m,f=Math.floor(b/e)+this.scrollRowCount,g=Math.floor(a/d);return f>=this.rowCount?-1:(c=f*this.columnCount+g,c>=this.items.length?-1:c)},a.prototype._4J=function(a){var b=this,c=~~(a/b.columnCount)-b.scrollRowCount,e=a%b.columnCount,f=b.itemWidth,g=b.itemHeight+m;return{rect:new d.Rect(e*f,c*g,f,b.itemHeight),text:b.items[a],index:a,displayIndex:a-b.scrollRowCount*b.columnCount}},a.prototype.L9J=function(a){var b=this.items.indexOf(a);return b===-1?null:this._4J(b)},a.prototype.startScrollInterval=function(a){var b=this,c=80,d=function(){b.scroll(a),a<0?b.ATJ=b.scrollRowCount+1:b.ATJ=b.scrollRowCount+b.currentPageDisplayRowCount,b.refresh(),b.FTJ=window.setTimeout(d,c)};this.FTJ=window.setTimeout(d,0)},a.prototype.stopScrollInterval=function(){void 0!==this.FTJ&&(window.clearTimeout(this.FTJ),this.FTJ=void 0)},a.prototype.isSelectedItem=function(a){return this.selIndex.indexOf(a)!==-1},a.prototype.paintItem=function(a,b,c,g,h){var k,l,p,q,r,s,t,u=this,v=u.itemWidth-m,w=u.itemHeight,x=u.props,y=g*(v+m),z=c*(w+m),A=u.getItemStyle({hover:u.ATJ===h,selected:u.isSelectedItem(h),itemText:u.items[h]});if(!(v<=0||w<=0))for(k=u.getWholeStyle(),l=new d.Rect(y,z,v,w),f.appendBackColorStyle(a,y,z,v,w,A,k,x.getThemeColor),e.drawRoundedRect(new d.Rect(y,z,v,w),j,a),p=A&&A.foreColor()||k&&k.foreColor()||n,q=i(A&&A.font()||k&&k.font()||o),a.fillStyle=x.getThemeColor(p),a.font=q,f.fillText(a,f.getEllipsisText(a,b,v),y,z,p,w,v),0===l.x&&(l.x+=.5,l.width-=.1),0===l.y&&(l.y+=.5,l.height-=.1),r=0;r<4;r++)s=f.Border_Names[r],t=A&&A[s]()||k&&k[s](),t&&f.paintBorder(a,r,l,t,x.getThemeColor,j)},a.prototype.setCursor=function(a){this.props.setCursor(a)},a.prototype.getItemStyle=function(a){return this.props.getItemStyle(a)},a.prototype.getWholeStyle=function(){return this.props.getWholeStyle()},a.prototype.getPointerRelativeControl=function(a){var b=this.props.getPointerRelativeControl(a);return b.x+=this.props.offset.left,b.y+=this.props.offset.top,b},a.prototype.refresh=function(){this.props.refresh()},a}(),b.ItemSlicerListBox=p)},"./dist/plugins/slicer/slicer-ui/slicer-scrollbar.js":function(a,b,c){"use strict";var d,e,f=this&&this.__assign||function(){return f=Object.assign||function(a){var b,c,d,e;for(c=1,d=arguments.length;c<d;c++){b=arguments[c];for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e])}return a},f.apply(this,arguments)};Object.defineProperty(b,"__esModule",{value:!0}),d=c("Shapes"),d&&(e=function(){function a(){this.zTJ=!1,this.GTJ=!1,this.A1J=!1,this.HTJ=0,this.ITJ="",this.qTJ={containerSize:{w:0,h:0},value:0,min:0,max:100,step:1,pageStep:10,sliderHeight:10,syncSliderHeightWithPageStep:!1,direction:"vertical",showButton:!0,renderTrack:!0,sliderColor:null,onScroll:function(){},finishScroll:function(){},refresh:function(){},setCursor:function(){},getPointerRelativeControl:function(a){return{x:0,y:0}}}}return Object.defineProperty(a.prototype,"props",{get:function(){return this.qTJ},set:function(a){this.qTJ=a},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this.qTJ=null},a.prototype.hitTest=function(a,b){var c,d,e,f,g,h,i,j,k,l,m="horizontal"===this.direction,n=m?a:b;return this.isInBounding(a,b)?(e=m?this.width:this.height,f=this.scrollBtnLen,g=this.scrollSliderOffset,h=this.scrollSliderLen,i=this.showScrollButton,i&&(n<=f||n>=e-f)?n<=f?c="scroll_up_btn":n>=e-f&&(c="scroll_down_btn"):n>=g&&n<=g+h?c="scroll_slider":(c="scroll_track",d=n<g?"up":"down"),j=n-g,k=n,l=n-(i?f:0),{target:c,data:d,offsetWithSlider:j,offsetWithTrack:l,actualPos:k}):this.GTJ?{actualPos:m?a:b}:{target:void 0}},a.prototype.onMouseDown=function(a){var b=this.getPointerRelativeControl(a),c=this.hitTest(b.x,b.y),d=c.target,e=c.data,f=c.actualPos,g=this.step,h=this.pageStep;return"scroll_up_btn"===d?(this.scroll(-g),this.startScrollInterval(-g),this.ITJ="scroll_up_btn"):"scroll_down_btn"===d?(this.scroll(g),this.startScrollInterval(g),this.ITJ="scroll_down_btn"):"scroll_slider"===d?(this.GTJ=!0,this.HTJ=f):"scroll_track"===d&&(this.A1J=!0,this.scroll("up"===e?-h:h)),this.zTJ=!0,this.refresh(),!0},a.prototype.onMouseMove=function(a){var b,c,d,e,f=this.getPointerRelativeControl(a),g=this.hitTest(f.x,f.y),h=g.target,i=g.actualPos;return(h||this.GTJ)&&this.setCursor("default"),this.GTJ&&(b=this.scrollTrackLen/this.max,c=0,d=i>this.HTJ,e=i<this.HTJ,e?c=Math.ceil((i-this.HTJ)/b):d&&(c=Math.floor((i-this.HTJ)/b)),c&&(this.scroll(c),e?this.HTJ=Math.max(0,i):this.HTJ=Math.min(this.isHorizontalDirection?this.width:this.height,i)),this.refresh()),
!0},a.prototype.onMouseUp=function(a){return!!this.zTJ&&(this.zTJ=!1,!0)},a.prototype.onWindowMouseWheel=function(a){},a.prototype.onWindowMouseUp=function(a){var b=!1;this.zTJ&&(this.zTJ=!1,b=!0),this.GTJ&&(this.GTJ=!1,this.HTJ=0,b=!0),this.ITJ&&(this.ITJ="",b=!0),this.A1J&&(this.A1J=!1,b=!0),this.stopScrollInterval(),b&&(this.refresh(),this.qTJ.finishScroll())},a.prototype.render=function(a){var b=this,c=this.width,d=this.height,e=this.isHorizontalDirection,f=this.scrollUpBtnRect,g=this.scrollDownBtnRect,h=this.scrollSliderRect,i=this.scrollArrowLen,j=this.ITJ,k=this.showScrollButton,l=function(b,c,d,e){d&&(a.beginPath(),a.rect(b.x,b.y,b.w,b.h),e&&(a.lineWidth=e),a.strokeStyle=d,a.stroke()),c&&(a.beginPath(),a.rect(b.x,b.y,b.w,b.h),a.fillStyle=c,a.fill())},m=function(b,c){var d=c?f:g,h=b?"rgb(96, 96, 96)":"rgb(240, 240, 240)",j=b?"white":"rgb(96, 96, 96)",k=function(){a.save(),a.translate(d.x,d.y),a.translate((d.w-2*i)/2,(d.h-i)/2),a.beginPath();var b=0;b=c?e?-90:0:e?90:180,b&&(a.translate(i,i/2),a.rotate(b/180*Math.PI),a.translate(-i,-i/2)),a.moveTo(0,i),a.lineTo(i,0),a.lineTo(2*i,i),a.strokeStyle=j,a.lineWidth=2,a.stroke(),a.restore()};a.beginPath(),l(d,h),k()},n=function(){a.beginPath(),l(h,b.qTJ.sliderColor||"rgb(205,205,205)","rgb(135, 135, 135)")};a.save(),a.beginPath(),this.qTJ.renderTrack&&l({x:0,y:0,w:c,h:d},"rgb(240, 240, 240)"),k&&m("scroll_up_btn"===j,!0),n(),k&&m("scroll_down_btn"===j,!1),a.restore()},Object.defineProperty(a.prototype,"width",{get:function(){return this.props.containerSize.w},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.props.containerSize.h},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"length",{get:function(){return this.isHorizontalDirection?this.width:this.height},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showScrollButton",{get:function(){return this.qTJ.showButton},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollBtnLen",{get:function(){var a=this.isHorizontalDirection?this.height:this.width;return Math.min(this.length/2,a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollSliderLen",{get:function(){var a,b=this.props.sliderHeight;return this.syncSliderHeightWithPageStep&&(a=this.pageStep/(this.max-this.min+this.pageStep),b=Math.max(b,this.scrollTrackViewLen*a)),Math.min(b,this.scrollTrackViewLen)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollSliderOffset",{get:function(){return(this.showScrollButton?this.scrollBtnLen:0)+this.scrollSliderOffsetWithTrack},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollSliderOffsetWithTrack",{get:function(){var a=0;return this.max!==this.min&&(a=(this.value-this.min)/(this.max-this.min)),this.scrollTrackLen*a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollTrackLen",{get:function(){return this.scrollTrackViewLen-this.scrollSliderLen},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollTrackViewLen",{get:function(){return Math.max(this.length-2*(this.showScrollButton?this.scrollBtnLen:0),0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"value",{get:function(){return this.qTJ.value},set:function(a){this.qTJ.value=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"min",{get:function(){return this.qTJ.min},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"max",{get:function(){return this.qTJ.max},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"step",{get:function(){return this.qTJ.step},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"pageStep",{get:function(){return this.qTJ.pageStep},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"syncSliderHeightWithPageStep",{get:function(){return this.qTJ.syncSliderHeightWithPageStep},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"direction",{get:function(){return this.qTJ.direction},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isHorizontalDirection",{get:function(){return"horizontal"===this.direction},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollArrowLen",{get:function(){var a=this.scrollBtnSize.w,b=this.scrollBtnSize.h,c=Math.min(.25*a,.5*b);return Math.min(c,5)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollBtnSize",{get:function(){return this.isHorizontalDirection?{w:this.scrollBtnLen,h:this.height}:{w:this.width,h:this.scrollBtnLen}},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollUpBtnRect",{get:function(){var a=this.scrollBtnSize;return f({x:0,y:0},a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollDownBtnRect",{get:function(){var a=this.scrollBtnSize,b=this.length-this.scrollBtnLen;return this.isHorizontalDirection?f({x:b,y:0},a):f({x:0,y:b},a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"scrollSliderRect",{get:function(){var a=this.scrollSliderOffset;return this.isHorizontalDirection?{x:a,y:0,w:this.scrollSliderLen,h:this.height-1}:{x:0,y:a,w:this.width-1,h:this.scrollSliderLen}},enumerable:!0,configurable:!0}),a.prototype.scroll=function(a){this.scrollTo(this.value+a)},a.prototype.scrollTo=function(a){var b=this.min,c=this.max;a=Math.min(a,c),a=Math.max(a,b),this.value!==a&&(this.value=a,this.props.onScroll())},a.prototype.isInBounding=function(a,b){var c=this.width,d=this.height;return a>=0&&a<=c&&b>=0&&b<=d},a.prototype.startScrollInterval=function(a){var b=this,c=80,d=260,e=function(){b.scroll(a),b.refresh(),b.FTJ=window.setTimeout(e,c)};this.FTJ=window.setTimeout(e,d)},a.prototype.stopScrollInterval=function(){void 0!==this.FTJ&&(window.clearTimeout(this.FTJ),this.FTJ=void 0)},a.prototype.setCursor=function(a){this.props.setCursor(a)},a.prototype.getPointerRelativeControl=function(a){return this.props.getPointerRelativeControl(a)},a.prototype.refresh=function(){this.props.refresh()},a}(),b.SlicerScrollBar=e)},"./dist/plugins/slicer/slicer.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/slicer/slicer.ns.js")),c("./dist/plugins/slicer/slicer-actions.js"),d(c("./dist/plugins/slicer/slicer.js")),d(c("./dist/plugins/slicer/table-slicer.js")),d(c("./dist/plugins/slicer/slicer-style.js")),d(c("./dist/plugins/slicer/slicer-base/slicer-cache-base.js")),d(c("./dist/plugins/slicer/slicer-base/slicer-base.js")),d(c("./dist/plugins/slicer/table-item-slicer/table-slicer-cache.js")),d(c("./dist/plugins/slicer/table-item-slicer/table-item-slicer.js")),d(c("./dist/plugins/slicer/slicer-ui/diagram-util.js")),d(c("./dist/plugins/slicer/slicer-ui/slicer-button.js")),d(c("./dist/plugins/slicer/slicer-ui/slicer-listbox.js")),d(c("./dist/plugins/slicer/slicer-ui/slicer-scrollbar.js")),d(c("./dist/plugins/slicer/slicer-ui/item-slicer-view.js"))},"./dist/plugins/slicer/slicer.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/slicer/slicer.ns.js"),g=new e.Common.ResourceManager(f.SR,"Slicer"),h=g.getResource.bind(g),i=e.Common.D,j=e.Common.j,k=j.Fa,l=e.Common.k,m=l.ac,n=null,o=void 0,b.UNDOADD="undoAdd",b.UNDOREMOVE="undoRemove",b.UNDOFILTER="undoFilter",b.UNDO_UPDATE_TABLE_SLICER="undoUpdateTableSlicer",p=d.UsedRangeUtil.SZJ,function(a){a.table="table",a.pivotTable="pivot",a.pivotTimeline="timeline"}(q=b.SlicerType||(b.SlicerType={})),function(a){a[a.years=1]="years",a[a.quarters=2]="quarters",a[a.months=3]="months",a[a.days=4]="days"}(r=b.TimelineLevel||(b.TimelineLevel={}));function w(a){var b=a;return k(a)||0===a?b=q.table:1===a&&(b=q.pivotTable),b}s=function(){function a(a){var b=this;b.kj=a,b.VX=[],b.WX={}}return a.prototype.getUsedRange=function(){var a,b,c,d,e,f,g,h=this,i=h.all(),j={};if(i)for(a=void 0,b=void 0,c=void 0,d=void 0,e=0,f=i;e<f.length;e++)g=f[e],a=g.startRow(),b=g.startColumn(),c=g.endRow(),d=g.endColumn(),p(j,{minRow:a,minCol:b,maxRow:c,maxCol:d});return j},a.prototype.no=function(){var a=this;a.WX&&(d.GC$.each(a.WX,function(a,b){b.no()}),a.WX=n),a.VX=[],a.kj=n},a.prototype.add=function(a,b,c,e,f){var g,h,i,j=this,k=j.kj,l={};if(!y(j,a,l))throw l.error;return k.suspendPaint(),f=w(f),g={slicer:n,slicerName:a,targetName:b,itemName:c,sheet:k,type:f},d.Worksheet.ao(k,"slicerAdding",g),(h=g.slicer)?(e&&h.style(e),j.Cz(h),i={slicer:h},d.Worksheet.ao(k,"slicerAdded",i),k.resumePaint(),h):void k.resumePaint()},a.prototype.Cz=function(a){var c=this,d=c.kj;a&&(c.WX[a.name()]=a,d.ITa.xVa(c,b.UNDOADD,a.name(),a))},a.prototype.get=function(a){return a===n||a===o?n:this.WX[a]},a.prototype.remove=function(a){var b=this;b.vV(a)},a.prototype.vV=function(a,b){var c,e=this,f=e.kj,g=e.WX,h=e.get(a);h&&i(g,a)&&(c={slicer:h,ignoreModel:b},d.Worksheet.ao(f,"slicerRemoved",c),delete e.WX[a])},a.prototype.U3=function(a,b){var c,e,f=this,g=f.kj,h={};if(!y(f,b,h))throw h.error;c=f.WX[a],c&&(delete f.WX[a],f.WX[b]=c,e={oldName:a,newName:b,slicer:c},d.Worksheet.ao(g,"slicerRenamed",e))},a.prototype.clear=function(){var a=this,b=a.kj;b.suspendPaint(),d.GC$.each(this.WX,function(b,c){a.remove(c.name())}),b.resumePaint()},a.prototype.all=function(a,b){var c={targetName:a,itemName:b,slicers:[]};return d.Worksheet.ao(this.kj,"getAllSlicers",c),c.slicers},a.prototype.XX=function(){return this.WX},a.prototype.HS=function(a){var b,c,d,e=x(this);if(e.indexOf(a)===-1)return a;for(b=1,c=" ",d=a.split(c)[0];e.indexOf(d+c+b)!==-1;)b++;return d+c+b},a.prototype.UX=function(){var a,b,c,e=this,f=e.WX;if(!f||d.GC$.isEmptyObject(f))return[];a=[];for(b in f)i(f,b)&&(c=f[b],c&&c.isSelected()&&a.push(c));return a},a.prototype.W3=function(a){var b,c,d=this,e=d.UX();if(1!==m(e))return!1;if(b=e,m(b)>0){for(c=0;c<m(b);c++)b[c].Rw&&b[c].Rw(a);return!0}return!1},a.prototype.toJSON=function(a){var b,c=this,e=[],f=c.WX;if(f&&!d.GC$.isEmptyObject(f))for(b in f)i(f,b)&&e.push(f[b].toJSON(a));return e},a.prototype.fromJSON=function(a){var b,c,e,f;if(a&&0!==m(a))for(b=this,c=b.kj,b.WX={},e=0;e<m(a);e++)f=a[e],f.type=w(f.type),d.Worksheet.ao(c,"slicerFromJson",{slicerJSON:f,sheetName:c.name()})},a}(),b.SlicerCollection=s;function x(a){var b,c,d,e,f,g=a.kj,h=[],j=g&&g.parent&&g.parent.sheets,k=g&&g.shapes;if(j)for(b=0;b<m(j);b++){c=j[b].slicers.XX();for(d in c)i(c,d)&&h.push(d);if(k){e=j[b].shapes.hta;for(f in e)i(e,f)&&h.indexOf(f)===-1&&h.push(f)}}return h}function y(a,b,c){var d;return b?x(a).indexOf(b)!==-1&&(d=h().Exp_SlicerNameExist):d=h().Exp_SlicerNameInvalid,d&&c&&(c.error=Error(d)),!d}function z(a){var b,c,d,e,f;if(!a)return!1;if(b=this,c=b.ZX,a===b.name())return!1;if(c&&(d=c.OW(),e=d&&d.slicers,e&&(f={},!y(e,a,f))))throw f.error;return!0}b.checkSlicerName=z;function A(a,b){var c,d,e,f,g,h,i,j=a.sheets;for(d=0,e=j;d<e.length;d++)for(f=e[d],c=f.slicers.all(),g=0,h=c;g<h.length;g++)if(i=h[g],i.name().toLowerCase()===b.toLowerCase())return!0;return!1}b.vSJ=A;function B(a){var b,c,d,e=a.tables.all();for(b=0,c=e;b<c.length;b++)d=c[b],d.fOJ=n}function C(a){var b,c,d,e;if(a.pivotTables)for(b=a.pivotTables.all(),c=0,d=b;c<d.length;c++)e=d[c],e.IVJ=n}t={priority:900,init:function(){var a=this;a.slicers=new s(a)},dispose:function(a){a.clearCache!==!1&&(this.slicers&&(this.slicers.no(),this.slicers=n),this.unbind("tableRemoved"))},getUsedRange:function(a){var b,c,e;a.type&d.UsedRangeType.slicer&&(b=this,c=b.slicers,e=c.getUsedRange(),p(a.range,e))},toJson:function(a,b){var c,d=b&&b.ignoreStyle,e=b&&b.newWorkSheetName;d||(c=this.slicers.toJSON(e),c.length>0&&(a.slicers=c)),B(this),C(this)},fromJson:function(a,b,c,d,e){var f,g,h,i,j=c&&c.ignoreStyle;if(!j&&(f=this,g=f.parent,!k(g)&&!e&&(h=a&&a.slicers,h&&h.length>0))){if(i=h[0].name,A(g,i))return;f.slicers.fromJSON(h)}},preProcessMouseWheel:function(a){var b=this.slicers;b&&b.W3(a.e)&&(a.r=!0)}},d.Worksheet.$n("slicer",t),u=function(a){var b="unfilterSlicerByKey",c="filterSlicer",e="unfilterSlicer",f="changeSlicerProperty",g="deleteSlicers";a.register(b,d.Commands[b],67,!1,!1,!0,!1),a.register(c,d.Commands[c]),a.register(e,d.Commands[e]),a.register(f,d.Commands[f]),a.register(g,d.Commands[g])},v={init:function(){u(this.commandManager()),this.nameInFormulas={}},fromJson:function(a,b,c){var d,e,f,g,h,i,j=c&&c.ignoreStyle;if(!j)for(d=this,e=0,f=d.getSheetCount();e<f;e++)g=d.getSheet(e),h=a.sheets&&a.sheets[g.name()],i=h&&h.slicers,i&&g.slicers.fromJSON(i)},onCommandExecuting:function(a){var b=a.slicers.all();b.forEach(function(a){a.isSelected(!1)})},dispose:function(){this.nameInFormulas=n}},d.Workbook.$n("slicer",v),d.GC$.extend(d.Workbook.prototype,{JVJ:function(a,b){var c=h().SlicerNameInFormula+"_"+a;return this.nameInFormulas[c]&&this.nameInFormulas[c]!==b?this.JVJ(a+"1",b):(this.nameInFormulas[c]=b,c)},KVJ:function(a,b){return this.nameInFormulas[a]&&this.nameInFormulas[a]!==b}});function D(a,b){var c,d;return"Object"===b.constructor.name?(c=b.name||b._ps.name,d=a.slicers.get(c),d||(d=a.slicers.add(c,b.tableName,b.columnName),d.fromJSON(b)),d):b}d.GC$.extend(d.lUa.prototype,{xVa:function(a,b,c,d){var e,f=this.zTa;f&&(e=f.slicerChanges,e||(e=f.slicerChanges=[]),e.push({slicerItem:a,name:b,value:c,newValue:d}))},yVa:function(a,c){var e,f,g,h,i,j,k,l,m,n,o,p;if(a)for(e=a.length-1;e>=0;e--)if(f=a[e],g=f.slicerItem,h=f.name,i=f.value,h===b.UNDOFILTER)j=i.columnName,k=i.oldValue,g.doFilter(j,{exclusiveRowIndexes:k});else if(h===b.UNDOADD)g.vV(i);else if(h===b.UNDOREMOVE){if(!i)return;i.g3?(g.Cz(i),l=i.ZX.MX,l&&(m=l.indexOf(i),m>=0&&l.splice(m,1))):(n=this.kj,o=i.slicerJSON,p=i.cacheJSON,o.type=w(o.type),d.Worksheet.ao(n,"slicerFromJson",{slicerJSON:o,cacheJSON:p,sheetName:n.name()}))}else if(h===b.UNDO_UPDATE_TABLE_SLICER){if(!i)return;this.kj.t4(i.row,i.col,i.rowCount,i.colCount,i.sheetArea)}else g[h](i);else for(e=a.length-1;e>=0;e--)f=a[e],this.DgK(f)},DgK:function(a,c){var e,f,g,h,i,j,k,l,m,o,p=a.slicerItem,q=a.name,r=c?a.newValue:a.value;if(q===b.UNDOFILTER&&p)e=r.columnName,f=r.oldValue,"Object"===p.constructor.name?(g=this.kj.tables.findByName(p.sj.name).getSlicerData(),g.doFilter(e,{exclusiveRowIndexes:f})):p.doFilter(e,{exclusiveRowIndexes:f});else if(q===b.UNDOADD)p=D(this.kj,r),c||this.kj.slicers.vV(p);else if(q===b.UNDOREMOVE){if(!r)return;r.g3?(p=D(this.kj,r),c?this.kj.slicers.vV(p.name()):(h=r.ZX.MX,h&&(i=h.indexOf(r),i>=0&&h.splice(i,1)))):(j=this.kj,k=r.slicerJSON,l=r.cacheJSON,m={slicer:n,slicerName:k.name,sheet:j,type:k.type,cacheJSON:l},d.Worksheet.ao(j,"slicerAdding",m),o=m.slicer,o&&(k.type=w(k.type),d.Worksheet.ao(j,"slicerFromJson",{data:k,sheetName:j.name()})))}else if(q===b.UNDO_UPDATE_TABLE_SLICER){if(!r)return;this.kj.t4(r.row,r.col,r.rowCount,r.colCount,r.sheetArea)}else p&&"Object"===p.constructor.name&&(p=this.kj.slicers.get(p.name||p._ps&&p._ps.name)),p&&p[q](r)}}),d.lUa.$n("SLICER_PROPERTYCHANGE",{priority:5500,applyChanges:function(a){var b=a.changes,c=a.isUndo,d=b&&b.slicerChanges;d&&this.yVa(d,!c)},undo:function(a){var b=a.slicerChanges;b&&this.yVa(b)}})},"./dist/plugins/slicer/slicer.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/slicer/slicer.res.en.js");b.SR={en:d}},"./dist/plugins/slicer/slicer.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Blank="(blank)",b.Exp_SlicerNameInvalid="The slicer name is not valid.",b.Exp_SlicerNameExist="The slicer name is already in use; please enter a unique name.",b.SlicerNameInFormula="Slicer"},"./dist/plugins/slicer/table-item-slicer/table-item-slicer-view-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Shapes"),e=c("./dist/plugins/slicer/slicer-base/slicer-base.js"),f=c("./dist/plugins/slicer/slicer-ui/diagram-util.js"),g=c("./dist/plugins/slicer/slicer-ui/item-slicer-view.js"),d&&(h=function(a){i(b,a);function b(b,c,d){return a.call(this,b,c,d)||this}return b.prototype.ZSJ=function(){var a,b,c,d,e,h,i,j=this,k=this,l=k.kj;l.shapes&&(a=k.updateOptionsCallback(),b=f.getSlicerSizePosInfo(l,!0),c=b.left,d=b.top,e=b.width,h=b.height,i=l.shapes.addFormControl(a.name,g.ItemSlicerFormControl,c,d,e,h),i.allowResize(!0),i.allowMove(!0),i.dynamicSize(!1),i.dynamicMove(!1),i.drawingType="Slicer",k.jxa=i.$SJ,k.nSa=i,k.refreshFormControl(),k.jxa.addEventListener("valueChanged",function(a,b){var c=j.updateValuesCallback();c.forEach(function(a){return a.selected=b.indexOf(a.text)!==-1}),j.Wq("valueChanged",c)}),k.jxa.addEventListener("clearFilter",function(a,b){j.Wq("clearFilter",{})}),k.jxa.addEventListener("propertyChanged",function(a,b){j.Wq("propertyChanged",b)}))},b.prototype.refreshFormControl=function(){var b,c;a.prototype.refreshFormControl.call(this),b=this,c=b.jxa,c.setItems(b.updateValuesCallback())},b}(e.SlicerViewModelBase),b.TableItemSlicerViewModel=h)},"./dist/plugins/slicer/table-item-slicer/table-item-slicer.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Shapes"),f=c("./dist/plugins/slicer/slicer.js"),g=c("./dist/plugins/slicer/slicer-base/slicer-base.js"),h=c("./dist/plugins/slicer/slicer-style.js"),i=c("./dist/plugins/slicer/table-item-slicer/table-item-slicer-view-model.js"),j=d.Util._kK,k=d.util.naa,l=d.Util.Sha,e&&(m=function(a){n(b,a);function b(b,c,d){var e,g=a.call(this,b,c,d)||this;return g.l8=f.SlicerType.table,e=g,e.Wqa=h.SlicerStyles.light1(),g}return b.prototype.getItems=function(){return this.XXJ.items},b.prototype.getOptionsSet=function(){var a=this;return{nameInFormula:a.nameInFormula(),sourceName:a.sourceName(),name:a.name(),captionName:a.captionName(),showNoDataItems:a.showNoDataItems(),showNoDataItemsInLast:a.showNoDataItemsInLast(),visuallyNoDataItems:a.visuallyNoDataItems(),showHeader:a.showHeader(),sortState:a.sortState(),columnCount:a.columnCount(),multiSelect:a.multiSelect(),itemHeight:a.itemHeight(),filterCleared:a.filterCleared(),isLocked:a.isLocked()}},b.prototype.columnName=function(){return this.sourceName()},b.prototype.sortState=function(a){var b,c=this;return 0===arguments.length?c.XXJ.sortState():(b=c.XXJ.sortState(),void(a!==b&&(c.XXJ.sortState(a),g.afterPropertyChanged.call(c,"sortState",b))))},b.prototype.showNoDataItems=function(a){var b,c=this;return 0===arguments.length?c.XXJ.showNoDataItems():(a=!!a,b=c.XXJ.showNoDataItems(),void(a!==b&&(c.XXJ.showNoDataItems(a),g.afterPropertyChanged.call(c,"showNoDataItems",b))))},b.prototype.showNoDataItemsInLast=function(a){var b,c=this;return 0===arguments.length?c.XXJ.showNoDataItemsInLast():(a=!!a,b=c.XXJ.showNoDataItemsInLast(),void(a!==b&&(c.XXJ.showNoDataItemsInLast(a),g.afterPropertyChanged.call(c,"showNoDataItemsInLast",b))))},b.prototype.visuallyNoDataItems=function(a){var b,c=this;return 0===arguments.length?c.XXJ.visuallyNoDataItems():(a=!!a,b=c.XXJ.visuallyNoDataItems(),void(a!==b&&(c.XXJ.visuallyNoDataItems(a),g.afterPropertyChanged.call(c,"visuallyNoDataItems",b))))},b.prototype._SJ=function(){var a=this;a.XXJ.buildItems()},b.prototype.YX=function(){return this.XXJ.ZX},b.prototype.setFilterWithItems=function(a){var b=this;b.XXJ.setFilter(a)},b.prototype.initSlicerUI=function(){var a=this;a.SSJ=new i.TableItemSlicerViewModel(a.kj,a.getOptionsSet.bind(a),a.getItems.bind(a)),a.SSJ.setStyle(a.Wqa),a.SSJ.bind("valueChanged",function(b){a.setFilterWithItems(b)}),a.SSJ.bind("clearFilter",function(){a.clearFilter()}),a.SSJ.bind("propertyChanged",function(b){var c=b.propName,d=b.value;a[c]&&a[c](d)})},b.prototype.fromJSON=function(b){if(b){a.prototype.fromJSON.call(this,b);var c=this;g.ItemSlicerProperties.forEach(function(a){var d=a[0];void 0!==b[d]&&c[d](b[d])})}},b.prototype.cdK=function(b,c,e,f){if(b){a.prototype.cdK.call(this,b,c,e,f);var g=this;void 0!==b.rowHeight&&g.itemHeight(d.ExcelHelper.emuToPixles(+b.rowHeight)-4),b.lossless&&void 0!==b.lossless.multiSelect&&g.multiSelect(b.lossless.multiSelect),void 0!==b.columnCount&&g.columnCount(+b.columnCount)}},b.prototype.toJSON=function(b){var c=this,d=a.prototype.toJSON.call(this,b);return g.ItemSlicerProperties.forEach(function(a){var b=a[0];d[b]=c[b]()}),d},b.prototype.bdK=function(a,b,c){var f,h=this,i={name:k(l(h.name(),"\n","_x000a_")),cache:k(h.XXJ.name),caption:k(h.captionName()),columnCount:h.columnCount(),style:k(h.Wqa.name()),rowHeight:d.ExcelHelper.pixelToEMU(h.itemHeight()+4),lossless:{multiSelect:h.multiSelect()}};h.showHeader()||(i.showCaption=e.SJS_False),h.disableResizingAndMoving()&&(i.lockedPosition=e.SJS_True),a.push(i),f={twoCellAnchor:g.getSlicerDrawing(h)},b.push(f)},b}(g.SlicerBase),g.ItemSlicerProperties.forEach(function(a){m.prototype[a[0]]=g.defSlicerProperty(a[0],a[1],a[2],a[3])}),d.Worksheet.$n("ItemSlicer",{slicerAdding:function(a){var b,c,d,e,g,h,i,j,k,l=this;a.type===f.SlicerType.table&&(b=l.parent&&l.parent.R4J,b&&(c=a.slicerName,d=a.targetName,e=a.itemName,g=a.sheet,h=a.slicerCacheName,h?i=b.get(h):(j=l.parent.jga(d),i=b.add(j,e,f.SlicerType.table)),k=i.add(g,c),k.init(),a.slicer=k))},slicerRemoved:function(a){var b,c=this.parent,d=a.slicer.name(),e=o(c,d);if(e){if(e.isSelected(!1),b=c.R4J.removeSlicer(d),e.SSJ){if(e.SSJ.YSJ)return;e.SSJ.YSJ=!0}this.ITa.xVa(self,"undoRemove",b)}},slicerRenamed:function(a){var b=a.newName,c=a.slicer;p(c)&&c.name(b)},getAllSlicers:function(a){var b=this,c=a.slicers,e=a.targetName,f=a.itemName;d.GC$.each(b.slicers.WX,function(a,b){p(b)&&(e&&(q(b).name()!==e||f&&b.sourceName()!==f)||c.push(b))})},slicerFromJson:function(a){var b,c,d,e,h,i,j,k,l,m,n=a.slicerJSON,o=a.cacheJSON;if(n.type!==f.SlicerType.pivotTable&&n.type!==f.SlicerType.pivotTimeline&&this.parent&&(b=n.tableName,c=n.sourceName,d=n.slicerCacheName,e=a.sheetName,h=this.parent,h&&(i=h.getSheetFromName(e)))){if(j=h.R4J,g.Fa(b)){if(!d)return;n.newTableName?k=j.Lla(n.newTableName,n.sourceName):o?(k=j.Lla(o.tableName,o.sourceName),k.fromJSON(o)):k=j.get(d)}else{if(l=this.parent.jga(b),!l)return;if(l.getSlicerData().columnNames.indexOf(c)===-1)return;k=j.add(l,c),g.ItemSlicerCacheProperties.forEach(function(a){g.Fa(n[a])||(k["_"+a]=n[a])})}k&&(m=k.get(n.name),m||(m=k.add(i,n.name)),m.init(),m.fromJSON(n),this.slicers.Cz(m))}},bdK:function(a,b,c){var d,e,g,h,i,k=this,l=k.slicers.all();if(!(l.length<=0)){for(d=!1,e=!1,g=!1,h=0;h<l.length&&(i=l[h],i.l8===f.SlicerType.pivotTimeline?g=!0:i.l8===f.SlicerType.table?d=!0:e=!0,!(g&&e&&d));h++);j(a,k.parent.kkK),(d||e)&&s(a,k,d,e),g&&v(a,k)}}}),d.GC$.extend(d.Worksheet.prototype,{t4:function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o;if(void 0===e&&(e=3),g=this,h=g.tables){for(i=0;i<c;i++)for(j=0;j<d;j++)k=i+a,l=j+b,m=h.find(k,l),3===e&&m&&m.Aq()&&(n=m.dataRange(),n.contains(k,l)&&(o=m.getSlicerData(),o&&o.onDataChanged([{columnName:m.getColumnName(l-n.col),row:k-n.row,data:{value:g.getValue(k,l),text:g.getText(k,l)}}])));g.ITa.xVa(null,f.UNDO_UPDATE_TABLE_SLICER,{row:a,col:b,rowCount:c,colCount:d,sheetArea:e})}}}),e.ShapeBase.$n("TableSlicer",{fireEvents:function(a){var b,c,d,e=a.sheet,f=a.sheetName,g=a.propertyName,h=a.shape,i=e.slicers.all();for(b=0;b<i.length;b++)if(c=i[b],p(c)&&(d=c.SSJ,d&&d.nSa===h&&d.nSa[g])){a.stopThisFire=!0,c.Wq({sheet:e,sheetName:f,slicer:c,propertyName:g});break}},ShapeCopingOrCutting:function(a){var b,c,d=a.sheet,e=a.shape,f=d&&d.parent,g=r(f,e);g&&(b=g.slicer,c={slicerJSON:b.toJSON(),slicerName:b.name(),sourceName:b.sourceName(),slicerCacheName:b.XXJ.name,shapeName:e.name(),cacheJSON:null},a.isCutting&&(c.cacheJSON=b.XXJ.toJSON()),a.drawingData=c)},FormControlShapePasting:function(a){var b,c,d,e,h,i,j,k,l,m=a.sheet,n=a.fromSheetName,o=a.toSheetName,q=a.name,r=a.drawingData,s=a.isCutting,t=m.parent,u=t.getSheetFromName(n);if(r&&u&&u.slicers){if(b=r.slicerJSON,c=r.slicerName,d=r.slicerCacheName,e=r.cacheJSON,b.type!==f.SlicerType.table)return;s||(c=u.slicers.HS(q)),h=t.R4J,i=h.get(d),!i&&e&&(i=h.Lla(e.tableName,e.sourceName),i.fromJSON(e)),j=i.add(m,c),m.slicers.Cz(j),g.SlicerBaseProperties.forEach(function(a){var c=a[0];"name"!==c&&void 0!==b[c]&&j[c](b[c])}),p(j)&&g.ItemSlicerProperties.forEach(function(a){var c=a[0];void 0!==b[c]&&j[c](b[c])}),j.style().fromJSON(b.style),j.init(),k=j.SSJ.nSa,n!==o&&(k.kj=m,l=k.name(),m.oob(l)||k.name(l&&m.oob(l)||m.oob("FormControl ",!0))),a.shape=k}},ShapeRemoving:function(a){var b,c,d,e,f,g=a.sheet,h=a.shape,i=a.isGroup,j=a.ignoreModel;i||(b=g.parent,c=r(b,h),c&&(d=c.slicer,e=c.sheetIndex,f=b.sheets[e],d.SSJ.YSJ=!0,f.slicers.vV(d.name(),j),a.cancelEvent=!0))}}),b.TableItemSlicer=m),b.Slicer=b.TableItemSlicer;function o(a,b){return a.R4J.getSlicer(b)}function p(a){return a&&a.l8===f.SlicerType.table}function q(a){return a.XXJ._getTable()}function r(a,b){var c,d,e,f,g=a.sheets;for(c=0;c<g.length;c++)if(d=g[c].slicers&&g[c].slicers.all())for(e=0;e<d.length;e++)if(f=d[e],p(f)&&f.SSJ.nSa===b)return{sheetIndex:c,slicer:f};return null}function s(a,b,c,e){var f,g,h,i=a.rels;d.util.JcK(a,d.XFileConstants.T8)||(f=b.parent,c&&(g=t(f,i,a)),e&&(h=t(f,i,a)),u(a,g,h,c,e))}function t(a,b,c){var e,f=d.Util.XaK(b),g=d.XFileConstants.abK+f;return a.kkK.slicer+=1,e=d.XFileConstants.T8+a.kkK.slicer,b.c_.push({n_:d.XFileConstants.dbK,Id:g,Type:d.RelationshipConstants.I7,Target:"../slicers/"+e+"."+d.XFileConstants.r8}),c.c_||(c.c_=[]),c.c_.push({n_:d.XFileConstants.T8,"r:id":g}),g}function u(a,b,c,e,f){var h,i=d.util.JcK(a,d.XFileConstants.Xkb);g.Fa(i)&&(i={n_:d.XFileConstants.Xkb,c_:[]},a.c_.push(i)),h=i.c_,e&&h.push({n_:"ext",r_:[48,44],c_:[{n_:"slicerList",r_:[1],c_:[{n_:"slicer","r:id":b}]}]}),f&&h.push({n_:"ext",r_:[61,55],c_:[{n_:"slicerList",c_:[{n_:"slicer","r:id":c}]}]})}function v(a,b){var c,e,f,g=a.rels;d.util.JcK(a,d.XFileConstants.hjK)||(c=d.Util.XaK(g),e=d.XFileConstants.abK+c,b.parent.kkK.timeline+=1,f=d.XFileConstants.hjK+b.parent.kkK.timeline,g.c_.push({n_:d.XFileConstants.dbK,Id:e,Type:d.RelationshipConstants.XgK,Target:"../timelines/"+f+"."+d.XFileConstants.r8}),a.c_||(a.c_=[]),a.c_.push({n_:d.XFileConstants.T8,"r:id":e}),w(a,e))}function w(a,b){var c,e=d.util.JcK(a,d.XFileConstants.Xkb);g.Fa(e)&&(e={n_:d.XFileConstants.Xkb,c_:[]},a.c_.push(e)),c=e.c_,c.push({n_:"ext",r_:[62,44],c_:[{n_:"timelineRefs",c_:[{n_:"timelineRef","r:id":b}]}]})}},"./dist/plugins/slicer/table-item-slicer/table-slicer-cache.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=c("Tables"),g=c("./dist/plugins/slicer/slicer-base/slicer-base.js"),h=c("./dist/plugins/slicer/slicer-base/slicer-cache-base.js"),i=c("./dist/plugins/slicer/slicer.ns.js"),j=c("./dist/plugins/slicer/table-item-slicer/table-item-slicer.js"),k=c("./dist/plugins/slicer/slicer-style.js"),l=null,m=void 0,n="TableSlicer_",o=e.Util.XaK,p=e.Util.YaK,q=e.Util.xiK,r=e.Util.$kK,s=e.util.naa,t=e.util.oaa,u=new d.Common.ResourceManager(i.SR,"Slicer"),v=u.getResource.bind(u);function z(a){return a.replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+$/g,"").replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+/g,"_")}function A(a){return g.Fa(a)||""===a}function B(a){return A(a)?v().Blank:a+""}w=function(a){y(b,a);function b(b,c,d,f){var g=a.call(this,c,f)||this;return g.slicerCacheType=h.SlicerCacheType.tableSlicer,g.bYJ=e.SortState.ascending,g.L4J=!0,g.M4J=!0,g.N4J=!0,g.qo=b,g.tableName=d,g.ad(d),g}return b.prototype.ad=function(a){var b=this.qo._XJ().jga(a);b&&(this.ZX=b.getSlicerData(),this.attachSlicerData(),this.items=this.initItems())},b.prototype._XJ=function(){return this.qo._XJ()},b.prototype.attachSlicerData=function(){var a=this,b=a.ZX;b.attachListener(a)},b.prototype.detachSlicerData=function(){var a=this,b=a.ZX;b&&b.detachListener(a)},b.prototype.filterCleared=function(){var a,b=this;for(a=0;a<b.items.length;a++)if(b.items[a].selected===!1)return!1;return!0},b.prototype._getTable=function(){var a=this;return a.ZX||a.ad(a.tableName),a.ZX.getTable()},b.prototype.add=function(a,b){var c,d=this,e=d._getTable();if(e)return c=new j.TableItemSlicer(b,a,d),d.eTJ.push(c),c},b.prototype.sortState=function(a){var b=this;return 0===arguments.length?b.bYJ:void(g.Fa(a)||a===b.bYJ||(b.bYJ=a,b.refreshSlicers()))},b.prototype.showNoDataItems=function(a){var b=this;return 0===arguments.length?b.L4J:(a=!!a,void(a!==b.L4J&&(b.L4J=a,b.refreshSlicers())))},b.prototype.showNoDataItemsInLast=function(a){var b=this;return 0===arguments.length?b.M4J:(a=!!a,void(a!==b.M4J&&(b.M4J=a,b.refreshSlicers())))},b.prototype.visuallyNoDataItems=function(a){var b=this;return 0===arguments.length?b.N4J:(a=!!a,void(a!==b.N4J&&(b.N4J=a,b.refreshSlicers())))},b.prototype.initItems=function(){var a,b,c,e,f,g,h,i=this,j=i.ZX,k=i.sourceName,l=j.getExclusiveData(k),m=j.getFilteredOutIndexes(k,1),n=j.getFilteredOutIndexes(k,2),o=[];for(a=0;a<l.length;a++)o.push({text:l[a],selected:m.indexOf(a)===-1,noData:n.indexOf(a)!==-1});for(b=d.Slicers.jf.quickSort(o.map(function(a){return a.text})),c=[],a=0;a<b.length;a++)e=b[a],f=e.index,g=e.value,h=o[f],c.push({text:B(g),selected:h.selected,noData:h.noData});return c},b.prototype.buildItems=function(){return this.initItems()},b.prototype.clearSelfFilter=function(){},b.prototype.clearFilter=function(a,b){var c,d=this;!d.canUpdate()||!b&&d.filterCleared()||(d.clearSelfFilter(),d.beforeSetFilter(),a||(a=d._XJ().getActiveSheet()),c=d.ZX.getFilteredIndexes(d.sourceName),a.wu().execute({cmd:"unfilterSlicer",sheetName:a.name(),slicerData:d.ZX,columnName:d.sourceName,value:c}),d.afterSetFilter())},b.prototype.setFilter=function(a){var b,c,d,f,g,h,i,j,k,m=this,n=m.ZX;if(m.canUpdate()&&(a||!m.filterCleared())&&(a=a||m.items,a&&0!==a.length)){for(b=[],c=n.getExclusiveData(m.sourceName),d=0;d<c.length;d++)for(f=c[d],g=0;g<a.length;g++)if(h=a[g].text===v().Blank?"":a[g].text,h===f&&a[g].selected){b.push(d);break}if(b.length===a.length)return void m.clearFilter(l,!0);m.beforeSetFilter(),i=m._XJ().getActiveSheet(),i.wu().execute({cmd:"filterSlicer",sheetName:i.name(),slicerData:n,columnName:m.sourceName,oldValue:n.getFilteredIndexes(m.sourceName),newValue:b}),j=n.getTable(),j&&(k={sheet:i,sheetName:i.name(),table:j,tableCol:n.getColumnIndex(m.sourceName),filterValues:a.map(function(a){return{text:a,value:a,type:"string"}})},i.Wq(e.Events.TableFiltered,k)),m.afterSetFilter()}},b.prototype.onFiltered=function(){this.updateCache()},b.prototype.onSlicerDataChanged=function(){this.qo.O5J||this.qo.qlK||this.updateCache()},b.prototype.onDataChanged=function(){this.onSlicerDataChanged()},b.prototype.onRowsChanged=function(){this.onSlicerDataChanged()},b.prototype.onColumnNameChanged=function(a,b){this.sourceName===a&&(this.sourceName=b,this.eTJ.forEach(function(c){c.captionName()===a&&c.captionName(b)}))},b.prototype.onColumnRemoved=function(a){var b,c,d,e;if(a===this.sourceName)for(b=this.eTJ,c=b.length-1;c>-1;c--)d=b[c],e=d.sheet(),e.slicers.remove(d.name())},b.prototype.S4J=function(a){var b,c,d,e;if(void 0===a&&(a=!1),b=this,
c=b.T4J){if(d=b._XJ(),e=d.jga(c),!e)return!1;a=!0,b.ad(c)}return b.T4J=l,a&&b.updateCache(),!0},b.prototype.updateItems=function(){this.items=this.buildItems()},b.prototype.updateCache=function(){this.canUpdate()&&(this.updateItems(),this.refreshSlicers())},b.prototype.toJSON=function(){var a,b=this,c=b._getTable(),d={name:b.name,sourceName:b.sourceName,tableName:b._getTable().name(),columnName:b.sourceName,sortOrder:b.bYJ===e.SortState.descending?e.SortState.descending:e.SortState.ascending,showNoDataItems:b.L4J,showNoDataItemsInLast:b.M4J,visuallyNoDataItems:b.N4J};return a=g.Fa(c.fOJ)?c.tableName():c.fOJ,a&&(d.tableName=a),d},b.prototype.bdK=function(){var a=this,b=a._getTable(),c={r_:[42,14,30,43],name:s(a.name),sourceName:s(a.sourceName),extLst:{ext:[{r_:[31,44],tableSlicerCache:{tableId:b._id+"",column:D(b,a.sourceName)+""}}]}};return a.bYJ===e.SortState.descending&&(c.extLst.ext[0].tableSlicerCache.sortOrder="descending"),a.N4J===!1?c.extLst.ext[0].tableSlicerCache.crossFilter="none":a.M4J===!1&&(c.extLst.ext[0].tableSlicerCache.crossFilter="showItemsWithNoData"),a.L4J===!1&&c.extLst.ext.push({r_:[33,32],slicerCacheHideItemsWithNoData:{}}),c},b.prototype.fromJSON=function(b){var c,d,e=this;a.prototype.fromJSON.call(this,b),e.detachSlicerData(),e.sourceName=b.columnName,c=b.tableName,d=this.qo._XJ().jga(c),d?e.ad(c):e.T4J=c,g.Fa(b.sortOrder)||(e.bYJ=b.sortOrder),g.Fa(b.showNoDataItems)||(e.L4J=b.showNoDataItems),g.Fa(b.showNoDataItemsInLast)||(e.M4J=b.showNoDataItemsInLast),g.Fa(b.visuallyNoDataItems)||(e.N4J=b.visuallyNoDataItems)},b.prototype.preFromSJSFormat=function(a,b){var c,d,f,h,i,j,k=this;k.disposeAllSlicers(),k.eTJ=[],k.name=t(a.name),k.detachSlicerData(),k.sourceName=t(a.sourceName),c=t(b),d=this.qo._XJ().jga(c),d?k.ad(c):k.T4J=c,f=a.extLst.ext,Array.isArray(f)?(h=f.filter(function(a){return a.tableSlicerCache})[0].tableSlicerCache,i=f.filter(function(a){return a.slicerCacheHideItemsWithNoData}).length>0):(h=f.tableSlicerCache,i=!1),g.Fa(h.sortOrder)||(k.bYJ="descending"===h.sortOrder?e.SortState.descending:e.SortState.ascending),i&&(k.L4J=!1),j=h.crossFilter,"none"===j?k.N4J=!1:"showItemsWithNoData"===j&&(k.M4J=!1)},b.prototype.cdK=function(a){},b.prototype.dispose=function(){var b=this;a.prototype.dispose.call(this),b.detachSlicerData(),b.ZX=l,b.qo=l,b.items=l},b}(h.SlicerCacheBase),b.TableItemSlicerCache=w,x=function(){function a(a){this.Qu=a,this.WXJ=[]}return a.prototype.q7J=function(a){var b,c,d,e=this,f=e.Qu;if(e.get(a)||f.getCustomName(a))return!1;for(b=f.sheets,c=0;c<b.length;c++)if(d=b[c],d.getCustomName(a))return!1;return!0},a.prototype.dYJ=function(a,b){var c,d=this,e=a+z(b);if(d.q7J(e))return e;for(c=1;!d.q7J(e+c);)c+=1;return e+c},a.prototype._XJ=function(){return this.Qu},a.prototype.getSlicerCachesByTableName=function(a){var b,c,d=this,e=[];for(b=0;b<d.WXJ.length;b++)c=d.WXJ[b],c._getTable().name()===a&&e.push(c);return e},a.prototype.getExistedSlicerCache=function(a,b){var c,d,e=this;for(c=0;c<e.WXJ.length;c++)if(d=e.WXJ[c],d.sourceName===b&&d._getTable().name()===a)return d},a.prototype.get=function(a){var b,c,d=this;for(b=0;b<d.WXJ.length;b++)if(c=d.WXJ[b],c.name===a)return c;return m},a.prototype.add=function(a,b){var c=this;return c.getExistedSlicerCache(a.name(),b)||c.Lla(a.name(),b)},a.prototype.Lla=function(a,b){var c=this,d=new w(c,c.dYJ(n,b),a,b);return c.WXJ.push(d),d},a.prototype.remove=function(a){var b,c,d=this;for(b=0;b<d.WXJ.length;b++)if(c=d.WXJ[b],c.name===a){c.dispose(),d.WXJ.splice(b,1);break}},a.prototype.getSlicer=function(a){var b,c,d,e=this;for(b=0;b<e.WXJ.length;b++)if(c=e.WXJ[b],d=c.get(a))return d},a.prototype.getAllSlicers=function(a){var b=this,c=[];return b.WXJ.forEach(function(b){b.eTJ.forEach(function(b){(a!==l&&a!==m||b.sheet().name()===a)&&c.push(b)})}),c},a.prototype.removeSlicer=function(a){var b,c,d,e,f=this;for(c=0;c<f.WXJ.length;c++)if(d=f.WXJ[c],e=d.get(a)){b={},b.slicerJSON=e.toJSON(),d.remove(a),0===d.eTJ.length&&(b.cacheJSON=d.toJSON(),f.remove(d.name));break}return b},a.prototype.onWorksheetDisposing=function(a){var b,c,d=this,e=d.WXJ;for(b=e.length-1;b>-1;b--)c=e[b],c.onWorkSheetDisposing(a),0===c.eTJ.length&&d.remove(c.name)},a.prototype.updateSlicerCaches=function(a){var b,c,d=this,e=d.WXJ;for(b=0;b<e.length;b++)c=e[b],a&&c._getTable()!==a||c.updateCache()},a.prototype.updateSlicerCacheAfterLazyLoad=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.WXJ,l=[];for(b=0;b<k.length;b++)if(c=k[b],d=c._getTable(),e=c.ZX,d&&e&&l.indexOf(d.name())===-1){if(f=d.kj.name(),g=j.Qu.NjK,!g.sheetsState[f]&&!g.refSheetsState[f])return a||(a=j.Qu.getActiveSheet()),h=a.yj(),void h.addReferenceSheetName(f);e.refresh(),l.push(d.name()),i=d.xr,i&&(e.suspendFilteredEvents(),i.reFilter(),e.resumeFilteredEvents())}},a.prototype.U4J=function(a){var b,c;void 0===a&&(a=!1),b=this,c=[],b.WXJ.forEach(function(b){b.S4J(a)||c.push(b.name)}),c.forEach(function(a){b.remove(a)})},a.prototype.toJSON=function(){var a=this,b=[];return a.WXJ.forEach(function(a){b.push(a.toJSON())}),b},a.prototype.fromJSON=function(a){var b=this;a.length>0&&(b.WXJ.forEach(function(a){a.dispose()}),b.WXJ=[],a.forEach(function(a){var c=b.Lla(a.tableName,a.sourceName);c.fromJSON(a)}))},a.prototype.preFromSJSFormat=function(a,b,c){var d,f,g,h,i,j,l,m,n,o,p,q,r,s,t,u,v,w,x=this;if(x.WXJ.forEach(function(a){a.dispose()}),x.WXJ=[],d=a.slicerCaches,f=b.tables,e.GC$.each(d,function(a,b){var c,d,e=b.slicerCacheDefinition;e.pivotTables||(c=E(f,e.extLst),d=x.Lla(c,e.sourceName),d.preFromSJSFormat(e,c))}),g=c&&c.includeStyles===!1,!g&&(h=a.styles,i=h.extLst,j=e.NodeHelper.rca(h.tableStyles&&h.tableStyles.c_),i)){if(l=i.dxfsRecords,m=i.slicerStylesNode,n=i.slicerStyleNodes,o=i.slicerSharedColors,p=i.slicerCommonSharedStrings,!m&&!n)return;for(q=void 0,r=void 0,s=void 0,m?(q=!0,r=e.NodeHelper.rca(m.slicerStyle),s=m.N9&&m.N9.defaultSlicerStyle||"SlicerStyleLight1"):(q=!1,r=n,s="SlicerStyleLight1",o=new e.SimpleSharedStrings(o),p=new e.SimpleSharedStrings(p)),t=b.styleManager,u=new e.SharedDxfs(o,p),u.vlK(l),t.addDefaultStyleName("defaultSlicerStyle",s),v=function(a){var b,c,d,f,g,h=r[a];return h?(b=q?h.N9&&h.N9.name:h.name,c=q?e.NodeHelper.sca(h,"slicerStyleElements.slicerStyleElement"):h.styleElements,d=void 0,j&&(f=j.filter(function(a){return a.name===b})[0],d=f&&e.NodeHelper.sca(f,"c_")),g=new k.SlicerStyle,void g.cdK(b,t,u,c,d)):"continue"},w=0;w<r.length;w++)v(w)}},a.prototype.cdK=function(a,b,c,d,f){var g=this,h=!!f,i=f||a.slicers,j=a.drawings,k=a.styleManager;e.GC$.each(i,function(f,i){var m,n,o,p=i.c_||i.slicers&&i.slicers.slicer;d||(m=c&&c.sheets,n=e.Util.ciK(m,f),o=n&&e.Util.diK(n,c.workbook),d=o&&g._XJ().getSheetFromName(o)),d&&(e.GC$.each(p,function(c,e){var f,h,i=t(e.cache),l=g.get(i);l&&(f=t(e.name),h=l.get(f),h||(h=l.add(d,f)),h.init(),h.cdK(e,j,k,b,a),d.slicers.Cz(h))}),h||(d=l))})},a.prototype.dispose=function(){this.WXJ.forEach(function(a){a.dispose()}),this.WXJ=l,this.Qu=l},a}(),b.TableSlicerCacheManager=x,e.Workbook.$n("TableSlicerCaches",{init:function(){var a=this;this.R4J=new x(a)},dispose:function(){var a=this;a.R4J&&(a.R4J.dispose(),a.R4J=m)},preFromJson:function(a,b,c){var d=this;d.R4J&&d.R4J.dispose(),d.R4J=new x(d),a.tableSlicerCaches&&0!==a.tableSlicerCaches.length&&(d.R4J.O5J=!0,d.R4J.fromJSON(a.tableSlicerCaches))},fromJson:function(a,b,c){var d=this;a.tableSlicerCaches&&0!==a.tableSlicerCaches.length&&(d.R4J.U4J(!1),d.R4J.updateSlicerCaches())},preFromSJSFormat:function(a,b,c){var d=this;d.R4J.dispose(),d.R4J=new x(d),a.slicerCaches&&0!==a.slicerCaches.length&&(d.R4J.qlK=!0,d.R4J.preFromSJSFormat(a,b,c))},cdK:function(a,b,c){var d,f,g,h,i,j,k=this;a.slicerCaches&&0!==a.slicerCaches.length&&(e.Util.lkK(c,k.NjK)?(d=k.getActiveSheet(),f=d.name(),g=d.yj(),h=b.sheetRelsMap,i=F(h,b,f),e.GC$.each(i,function(a,b){g.addReferenceSheetName(b)})):(j=k.R4J,j.U4J(!1),j.cdK(b,c,a),j.updateSlicerCaches()))},toJson:function(a,b){var c=this,d=c.R4J.toJSON();d&&d.length>0&&(a.tableSlicerCaches=d)},bdK:function(a,b){var c,d=this,e=b.styleManager,f=d.R4J;f&&(c=f.WXJ,c&&0!==c.length&&(K(a,c,M),a.slicers||(a.slicers={}),O(a,c,d.sheets,e,"table",h.SlicerCacheType.tableSlicer)))}}),e.Worksheet.$n("TableSlicerCaches",{priority:1800,dispose:function(a){a.clearCache!==!1&&this.parent&&this.parent.R4J.onWorksheetDisposing(this.name())},cdK:function(a,b,c){var d,f,g,h,i=this.parent;c&&e.Util.lkK(c,i.NjK)&&(d=b.slicers,f=b.sheetRelsMap&&b.sheetRelsMap[this.name()].filter(function(a){return a.Type===e.RelationshipConstants.I7}).map(function(a){return e.Util.LhK(a.Target)}),g={},e.GC$.each(f,function(a,b){g[b]=d[b]}),h=i.R4J,h.U4J(!1),h.cdK(b,l,c,this,g),(this.tables.all().length>0||this.slicers.all().length>0)&&this.parent.R4J.updateSlicerCacheAfterLazyLoad(this))},fromJsonAfterSJSFormula:function(a,b,c){var d,f=this.parent;f&&!e.Util.lkK(c,f.NjK)&&(d=f.getSheetCount()-1,d===f.getSheetIndex(this.name())&&(f.R4J.qlK=!1,f.R4J.updateSlicerCaches()))},fromJsonAfterFormula:function(a){var b,c=this.parent;c&&(b=c.getSheetCount()-1,b===c.getSheetIndex(this.name())&&(c.R4J.O5J=!1,c.R4J.updateSlicerCaches()))},afterRefSheetLazyLoaded:function(a){(this.tables.all().length>0||this.slicers.all().length>0)&&(this.parent.R4J.qlK=!1,this.parent.R4J.updateSlicerCacheAfterLazyLoad())}});function C(a,b){var c=a.R4J;return c.getSlicerCachesByTableName(b)}f.Table.$n("TableSlicer",{tableNameChanged:function(a){var b,c=a.oldName,d=a.newName,e=this.kj;e&&(b=C(e.parent,c),b.forEach(function(a){a.tableName=d}))}});function D(a,b){var c=null;return a.Nz.forEach(function(a){a.name()===b&&(c=a.id())}),c}function E(a,b){if(!b||0===Object.keys(b).length)return null;var c,d;return e.GC$.each(b,function(a,b){var c;if(Array.isArray(b)?(c=b.filter(function(a){return!g.Fa(a.tableSlicerCache)}),c.length>0&&(c=c[0].tableSlicerCache)):c=b.tableSlicerCache,c)return d=c.tableId,!1}),g.Fa(d)?null:(e.GC$.each(a,function(a,b){if(b.id===d)return c=b.name,!1}),c)}function F(a,b,c){var d,e,f,g=b.slicers,h=b.slicerCaches,i=b.tables;if(g&&0!==g.length&&(d=a&&G(a[c],g)))return e=H(h,d),f=I(i,e),J(a,c,f)}function G(a,b){var c=[];return a&&a.length>0&&e.GC$.each(a,function(a,d){var f,g;if(d.Type===e.RelationshipConstants.I7){if(f=e.Util.LhK(d.Target),g=b[f],!g)return;e.GC$.each(g.c_,function(a,b){c.indexOf(b.cache)===-1&&c.push(b.cache)})}}),c}function H(a,b){var c=[];return e.GC$.each(a,function(a,d){var f=d.slicerCacheDefinition,g=f.name,h=e.NodeHelper.sca(f,"extLst.ext.tableSlicerCache.tableId");h!==m&&c.indexOf(h)===-1&&b.indexOf(g)!==-1&&c.push(h)}),c}function I(a,b){var c=[];return e.GC$.each(a,function(a,d){c.indexOf(a)===-1&&b.indexOf(d.id)!==-1&&c.push(a)}),c}function J(a,b,c){var d=[];return e.GC$.each(a,function(a,f){var g,h;if(a!==b&&f&&0!==f.length)for(g=0;g<f.length;g++)if(h=f[g],h.Type===e.RelationshipConstants.B7&&c.indexOf(e.Util.LhK(h.Target))!==-1)return void d.push(a)}),d}function K(a,b,c){var d,f,g,i,j,k,l,m,n=a.slicerCaches,q=0;for(n?q=Object.keys(n).length:n=a.slicerCaches={},d=[],f=a.workbook.rels,g=0,i=b;g<i.length;g++)j=i[g],j.slicerCacheType!==h.SlicerCacheType.pivotTimeline&&(q+=1,k=q,l=o(f),m="rId"+l,f.c_.push({n_:"Relationship",Id:m,Type:e.RelationshipConstants.J7,Target:p("slicerCaches/slicerCache"+k)}),n[e.XFileConstants.U8+k]={slicerCacheDefinition:j.bdK()},d.push(m));c(a,d)}b.KjK=K;function L(a,b,c){var d,f,h,i,j=e.util.JcK(a.workbook,"definedNames");for(g.Fa(j)&&(j={n_:"definedNames",c_:[]},a.workbook.c_.push(j)),d=j.c_,f=0,h=b;f<h.length;f++)i=h[f],i.slicerCacheType===c&&d.push({n_:"definedName",name:i.name,c_:["#N/A"]})}b.LjK=L;function M(a,b){var c,d,f,h,i,j,k,l=e.util.JcK(a.workbook,e.XFileConstants.Xkb);for(g.Fa(l)&&(l={n_:e.XFileConstants.Xkb,c_:[]},a.workbook.c_.push(l)),c=[],d=0,f=b;d<f.length;d++)h=f[d],c.push({n_:"x14:slicerCache","r:id":h});i=l.c_,i.push({n_:"ext",r_:[45,44],c_:[{n_:"x15:slicerCaches",r_:[1],c_:c}]}),j="xcalcf:feature",k="microsoft.com:",i.push({n_:"ext",r_:[46,47],c_:[{n_:"xcalcf:calcFeatures",c_:[{n_:j,name:k+"RD"},{n_:j,name:k+"Single"},{n_:j,name:k+"FV"},{n_:j,name:k+"CNMTM"},{n_:j,name:k+"LET_WF"}]}]})}function N(a,b,c){var d,f,g,h,i,j,k,l=b.styles,n=l.extLst,o=n&&n.slicerStyleNodes||[],p=new e.SimpleSharedStrings,q=new e.SimpleSharedStrings,r=new e.SharedDxfs(p,q);for(n&&n.dxfsRecords&&(r.vlK(n.dxfsRecords),p.cdK(n.slicerSharedColors),q.cdK(n.slicerCommonSharedStrings)),d=0,f=a;d<f.length;d++)for(g=f[d],h=g.slicers.all().filter(function(a){return a.l8===c}),i=0,j=h;i<j.length;i++)k=j[i],k.style().bdK(!1,!0,m,{dxfsRecords:r,slicerStyleNodes:o});n||(n=l.extLst={}),e.GC$.extend(n,{dxfsRecords:r.ulK(),slicerSharedColors:p.bdK(),slicerCommonSharedStrings:q.bdK(),slicerStyleNodes:o})}function O(a,b,c,d,f,g){var h,i,j,k,l,m,n,o,p,s,t=a.slicers,u=Object.keys(t).length;for(h=0,i=c;h<i.length;h++)if(j=i[h],k=j.slicers.all().filter(function(a){return a.l8===f}),k.length>0)for(u+=1,l=t[e.XFileConstants.T8+u]={slicers:{r_:[42,14,30,43],slicer:[]}},a.drawings||(a.drawings={}),m=0,n=k;m<n.length;m++)o=n[m],p=r(a,q(a,j.name())),s=p.c_,o.bdK(l.slicers.slicer,s,d),o.style().bdK(!0,!1,d);L(a,b,g),N(c,a,f)}b.MjK=O},"./dist/plugins/slicer/table-slicer.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("FloatingObject"),g=c("ConditionalFormatting"),h=c("Tables"),i=c("./dist/plugins/slicer/slicer.ns.js"),j=c("./dist/plugins/slicer/slicer.js"),k=c("./dist/plugins/slicer/slicer-style.js"),l=new e.Common.ResourceManager(i.SR,"Slicer"),m=l.getResource.bind(l),n=e.Common.D,o=e.Common.j,p=o.Fa,q=e.Common.k,r=d.Ul.Nl,s=d.Ul.Pl,t=q.ac,u=d.Ul.hZa,v=d.GC$.isArray,w=d.GC$.extend,x=document,y=void 0,z=null,A="normal 11pt calibri",B=parseFloat,C=".slicer",D="mouse",E="wheel",F="DOMMouseScroll",G=e.Slicers.GeneralSlicerData,function(a){a[a.CONTAINER=0]="CONTAINER",a[a.H_SPACE=1]="H_SPACE",a[a.H_CAPTION=2]="H_CAPTION",a[a.H_SPLITLINE=3]="H_SPLITLINE",a[a.H_CLEARFILTER=4]="H_CLEARFILTER",a[a.B_ITEM=5]="B_ITEM",a[a.B_ITEMSPACER=6]="B_ITEMSPACER",a[a.B_TAIL=7]="B_TAIL",a[a.B_SCROLLBAR=8]="B_SCROLLBAR"}(H||(H={})),function(a){a[a.HOVERED=1]="HOVERED",a[a.SELECTED=2]="SELECTED",a[a.UNSELECTED=4]="UNSELECTED",a[a.HASDATA=8]="HASDATA",a[a.NODATA=16]="NODATA"}(I||(I={})),function(a){a[a.NORMAL=0]="NORMAL",a[a.ACTIVE=1]="ACTIVE",a[a.HOVERED=2]="HOVERED"}(J||(J={})),K={Dcc:"Style",Ecc:"Color",Fcc:"Width",Gcc:"border",Hcc:"WithDataStyle",Icc:"WithNoDataStyle",Jcc:"electedItem",Kcc:"hovered",Lcc:"top",Mcc:"gc-slicer-",Ncc:"container",Occ:"header",Pcc:"clearfilter",Qcc:"body",Rcc:"itemscontainer",Scc:"item"},L="name",M="style",N="white",O="black",P="solid",Q="color",R="background-color",S="width",T="height",U="font",V="back"+K.Ecc,W="fore"+K.Ecc,X=K.Gcc+"Width",Y=K.Gcc+K.Dcc,Z=K.Gcc+K.Ecc,$=K.Gcc+"Left",_=K.Gcc+"Top",aa=K.Gcc+"Right",ba=K.Gcc+"Bottom",ca="textDecoration",da="wholeSlicer"+K.Dcc,ea="header"+K.Dcc,fa="s"+K.Jcc+K.Hcc,ga="s"+K.Jcc+K.Icc,ha="unS"+K.Jcc+K.Hcc,ia="unS"+K.Jcc+K.Icc,ja=K.Kcc+"S"+K.Jcc+K.Hcc,ka=K.Kcc+"S"+K.Jcc+K.Icc,la=K.Kcc+"UnS"+K.Jcc+K.Hcc,ma=K.Kcc+"UnS"+K.Jcc+K.Icc,na="undoFilter",oa="div",pa="px",qa="default",ra="cursor",sa="position",ta="absolute",ua="padding",va="margin-"+K.Lcc,wa="left",xa="right",ya="text-align",za="overflow",Aa="hidden",Ba="auto",Ca="text-overflow",Da="ellipsis",Ea="white-space",Fa="nowrap",Ga="unselectable",Ha="on",Ia="font-weight",Ja="font-size",Ka="border-radius",La="box-sizing",Ma="content-box",Na="button",Oa="\u2717",Pa="mark",Qa="itemValue",Ra=K.Mcc+K.Ncc,Sa=K.Mcc+K.Occ,Ta=K.Mcc+"header-borderDiv",Ua=K.Mcc+"caption",Va=K.Mcc+K.Pcc,Wa=K.Mcc+K.Qcc,Xa=K.Mcc+"table",Ya=K.Mcc+"tr",Za=K.Mcc+"td1",$a=K.Mcc+"td2",_a=K.Mcc+K.Rcc,ab=K.Mcc+K.Scc,bb="gc-no-user-select";function Hb(a,b){var c,d,e,f,g,h,i=a.KW,j=a._caption,k=Lb(a.slicerData),l=a.zoomFactor();if(b){b[da]&&(Ob(a.xo,b[da],k,j,l),lc(a,K.Ncc)),c=a.LW,d=Jb(b[da],b[ea]),Pb(b)?(e=d[ba],f=e&&e[X]||0,c[M][T]=(a.MW-f)*Qb(b)*l+pa,Nb(c,e,k,ba),d[$]=d[_]=d[aa]=d[ba]=z):(c[M][ba+S]=0+pa,c[M][T]=i[M][T]),Ob(i,d,k,j,l),lc(a,K.Occ);for(g in a.NW)n(a.NW,g)&&(h=parseInt(g,10),ic(a,h))}}function Ib(a,b,c){var e,f,g={};if(b&&c&&t(b)===t(c)){for(e=0,f=t(b);e<f;e++)g[b[e]]=c[e];d.GC$(a).css(g)}}function Jb(a,b){var c={},d;if(b)for(d in b)n(b,d)&&(c[d]=b[d]);if(a)for(d in a)c[d]===y&&a[d]!==y&&(c[d]=a[d]);return c}function Kb(a,b){var c;if("string"==typeof a){if(!b)return a;a&&b.getColor&&(c=b.getColor(a))}else"object"==typeof a&&(c=b.getColor(a.stops[0].color));return c}function Lb(a){var b=a&&a.OW&&a.OW();return b&&b.currentTheme()}function Mb(a){switch(a){case"double":return"double";case"dashDot":case"dashDotDot":case"dotted":case"slantedDashDot":case"mediumDashDot":case"mediumDashDotDot":return"dotted";case"medium":case"dashed":case"mediumDashed":return"dashed";default:return"solid"}}function Nb(a,b,c,d){if(a){var e=b&&b[X]||0,f=b&&b[Y]||"",g=b&&b[Z]||"";a[M][d+K.Fcc]=e+pa,a[M][d+K.Dcc]=Mb(f),a[M][d+K.Ecc]=Kb(g,c)}}function Ob(a,b,c,f,g){var h,i,j,k;a&&b&&(h=b[W]||O,i=b[V]||N,j=b[U]||A,a[M][R]=Kb(i,c),a[M][Q]=Kb(h,c),a[M][U]=u(d.To.No(j,g)[U]),Nb(a,b[$],c,$),Nb(a,b[_],c,_),Nb(a,b[aa],c,aa),Nb(a,b[ba],c,ba),k=d.To.So(b[ca]),e.Common.u.Bb(a.className,Sa)?f[M][ca]=k:e.Common.u.Bb(a.className,ab)&&(a[M][ca]=k))}function Pb(a){var b,c=a[ea];return!c||!(c[$]||c[_]||c[aa]||c[aa])||(b=Jb(a[da],c),!(!(b[ba]&&b[ba][X]>0)||b[$]&&0!==b[$][X]||b[_]&&0!==b[_][X]||b[aa]&&0!==b[aa][X]))}function Qb(a){var b,c,e,f,g,h,i,j,k;return a?(b=Jb(a[da],a[ea]),b&&b[U]?(c=b[U],e=1,f=d.To.Ko,g=d.To.Jo,h=f(g(A)).fontSize,i=f(g(c)).fontSize,h&&i&&(j=B(h),k=B(i),isNaN(k)||(e=k/j)),e):1):1}function Rb(a){var b,c,d,e,f,g=0,h=0;return a&&(b=a[M],c=b[$+K.Fcc],d=b[_+K.Fcc],e=b[aa+K.Fcc],f=b[ba+K.Fcc],c&&(g+=B(c)),d&&(h+=B(d)),e&&(g+=B(e)),f&&(h+=B(f))),{widthOffset:g,heightOffset:h}}function Sb(a){var b,c,d=[];if(a)for(c=0;c<t(a);c++)b=a[c]===y||a[c]===z||""===a[c]?m().Blank:a[c]+"",d.push(b);return d}function Tb(a){var b=r(oa);return Ib(b,[sa,ua,La,za],[ta,6*a.zoomFactor(),Ma,Aa]),d.GC$(b).addClass(Ra),lc(a,K.Ncc),d.GC$(b).append(Ub(a)).append(Vb(a)),b}function Ub(a){var b,c,e,f,g,h,i,j,k=r(oa),l=r(oa),m=r("span"),n=r(oa),o=a.zoomFactor(),p=a.style();return Ib(k,[S,sa,K.Lcc,wa,xa,La,za],[Ba,ta,0,0,0,Ma,Aa]),d.GC$(k).addClass(Sa),a.KW=k,b=a.PW*o,Ib(l,[S,sa,wa,xa,La,za],[Ba,ta,b,b,Ma,Aa]),d.GC$(l).addClass(Ta),a.LW=l,d.GC$(k).append(l),c=a.QW*Qb(p)*o,e=Yb(a)*o,Ib(m,[La,sa,K.Lcc,za,S,Ca,Ea],[Ma,ta,c,Aa,e,Da,Fa]),d.GC$(m).text(a.captionName()).attr(Ga,Ha).addClass(Ua+" "+bb),a._caption=m,f=a.RW*o,g=a.SW*o,h=a.TW*Qb(p)*o,i=a.UW*o,j=a.VW*o+pa,Ib(n,[S,T,ra,sa,K.Lcc,xa,ya,La,Ia,Ka,za,Ja],[f,g,qa,ta,h,i,"center",Ma,"normal",2,Aa,j]),d.GC$(n).attr("title","Clear Filter (Alt+C)").attr(Ga,Ha).text(Oa).addClass(Va+" "+bb),a.WW=n,lc(a,K.Occ),d.GC$(l).append(m).append(n),k}function Vb(a){var b,c=r(oa),e=r("table"),f=r("tr"),g=r("td"),h=r("td"),i=(a.MW-a.PW+a.XW)*Qb(a.style())*a.zoomFactor();return Ib(c,[S,za,va,La],[Ba,Aa,i,Ma]),d.GC$(c).attr(Ga,Ha).addClass(Wa+" "+bb),a.YW=c,Ib(e,[La,"border-spacing"],[Ma,0+pa]),d.GC$(e).attr(Ga,Ha).addClass(Xa+" "+bb),a.ZW=e,d.GC$(f).css(La,Ma).addClass(Ya),a.$W=f,Ib(g,[ua,La],[0,Ma]),d.GC$(g).addClass(Za),a._W=g,Ib(h,[ua,La,ra],[0,Ma,qa]),d.GC$(h).addClass($a),a.aX=h,d.GC$(g).append(Wb(a)),b=cc(a),d.GC$(h).append(b),a.bX=b,d.GC$(f).append(g).append(h),d.GC$(e).append(f),d.GC$(c).append(e),c}function Wb(a){var b,c,e,f,g,h,i,j=r(oa),k=a.zoomFactor();for(a.cX=j,c=Zb(a),a.dX=c,b=$b(a),a.eX=b,Ib(j,[S,T,Ja],[b*k,c*k,a.VW*k+pa]),d.GC$(j).attr(Ga,Ha).addClass(_a+" "+bb),e=bc(a),a.fX=e,f=Math.min(ac(a),t(e)),g=0;g<f;g++)h=e[g],i=Xb(a,h,g),d.GC$(j).append(i),a._items.push(i),a.NW[a.gX.indexOf(h)]=i;return j}function Xb(a,b,c){var e,f,g=b,h=r(Na),i=a.zoomFactor(),j=a.hX*i+pa;return Ib(h,[ya,Ea,va,ra,La,Ka,ua,za,Ca,R],[wa,Fa,j,qa,Ma,5,"1px 6px",Aa,Da,N]),d.GC$(h).attr("type",Na).attr(Ga,Ha).text(g).addClass(ab+" "+bb),e=a.slicerData.kj,e&&(f=e.parent),f&&f.options.enableAccessibility&&d.GC$(h).attr("tabindex",-1),(c+1)%a.columnCount()!==0&&d.GC$(h).css("margin-right",a.hX*i+pa),lc(a,K.Scc,h),h}function Yb(a){var b,c,d=a.xo,e=a.KW,f=1,g=1,h=0,i=0,j=function(a){return a?B(a):0},k=K.Gcc+"Left"+K.Fcc,l=K.Gcc+"Right"+K.Fcc;return d&&(b=d.style,f=j(b[k]),g=j(b[l])),e&&(c=e.style,h=j(c[k]),i=j(c[l])),a.width()-(f+g)-2*a.PW-(h+i)-a.RW}function Zb(a){var b=Rb(a.xo),c=a.height()-2*a.PW-b.heightOffset;return a.showHeader()?c-a.MW*Qb(a.style())-a.XW:c}function $b(a){var b=Rb(a.xo),c=a.width()-2*a.PW-b.widthOffset-1;return a.iX()?c-a.jX:c}function _b(a,b){var c=a.columnCount();return(b-(c-1)*a.hX)/c}function ac(a){return Math.ceil(a.dX/(a.itemHeight()+2*(a.kX+a.lX)+a.hX))*a.columnCount()}function bc(a){var b,c,d,e,f,g,h=a.gX,i=a.mX(h.slice(0),a.sortState()),j=a.slicerData.getFilteredOutIndexes(a.columnName,2);if(a.showNoDataItems()){if(a.visuallyNoDataItems()&&a.showNoDataItemsInLast()){for(b=[],d=t(i),e=void 0,f=void 0,e=0;e<d;e++)f=i[e],q.Bb(j,h.indexOf(f))||b.push(f);for(e=0;e<d;e++)f=i[e],q.Bb(j,h.indexOf(f))&&b.push(f);i=b}}else for(b=i.concat(),c=0;c<t(b);c++)q.Bb(j,h.indexOf(b[c]))&&q.Fb(i,b[c]);return g=m().Blank,q.Bb(i,g)&&(q.Fb(i,g),i.push(g)),i}function cc(a){var b,c=new d.hv((!1));return a.nX=c,b=c.Bv(),d.GC$(b).bind("scroll.gcScrollbar",function(b,c){var d,e=c.scrollEventType,f=c.scrollOrientation;b.data=a,1===f&&(d=[0,1,2,3,5],d.indexOf(e)>=0&&a.Bw(b,c))}),b}function dc(a){var b=a.slicerData;a.data=b.getData(a.columnName),a.exclusiveDatas=b.getExclusiveData(a.columnName),a.oX=Sb(a.data),a.gX=Sb(a.exclusiveDatas),a.fX=bc(a),kc(a),hc(a)}function ec(a,b){var c,e=a.style(),f=a.xo;f&&(b!==y&&b!==a.zoomFactor()&&(a.zoomFactor(b),Hb(a,e)),d.GC$(f).css(ua,6*b),lc(a,K.Ncc),fc(a),c=a.showHeader()?(a.MW+a.XW-a.PW)*Qb(e)*b:0,d.GC$(a.YW).css(va,c),gc(a),kc(a))}function fc(a){var b,c,e,f,g,h,i,j,k,l,m=a.zoomFactor(),n=a.KW,o=a.YW,p=a._caption,q=a.WW,r=a.style();a.showHeader()?(a.xo.firstChild!==n&&(d.GC$(n).insertBefore(o),d.GC$(o).css(va,(a.MW+a.XW)*Qb(r)*m)),d.GC$(n).css(T,a.MW*Qb(r)*m),b=a.PW*m,Ib(a.LW,[wa,xa],[b,b]),p.innerHTML!==a.captionName()&&d.GC$(p).text(a.captionName()),c=a.QW*Qb(r)*m,e=Yb(a)*m,Ib(p,[K.Lcc,S,Ia],[c,e,"bold"]),f=a.pX,g=f&&t(f)>0?1:0,tc(a,g),h=a.RW*m,i=h,j=a.TW*Qb(r)*m,k=a.UW*m,l=a.VW*m+pa,Ib(q,[S,T,K.Lcc,xa,Ja],[h,i,j,k,l]),lc(a,K.Occ)):d.GC$(n).remove()}function gc(a){var b,c=a.zoomFactor(),d=Zb(a);a.dX=d,b=$b(a),a.eX=b,Ib(a.cX,[S,T,Ja],[b*c,d*c,a.VW*c]),hc(a)}function hc(a){var b,c,e,f,g,h,i,j,k=a.fX;if(k){for(b=a._items,b&&t(b)>0&&d.GC$(b).remove(),a._items=[],b=a._items,a.NW={},c=Math.min(ac(a),t(k)),e=a.iX()?a.nX.value()*a.columnCount():0,f=Math.min(e+c,t(k)),g=e;g<f;g++)h=k[g],i=Xb(a,h,g),d.GC$(a.cX).append(i),b.push(i),a.NW[a.gX.indexOf(h)]=i;if(0!==t(b))for(j in a.NW)n(a.NW,j)&&ic(a,parseInt(j,10))}}function ic(a,b){var c=a.qX,d=c?a.gX.indexOf(c[Qa]):-1,e=a.pX,f=a.rX,g=a.NW[b],h=0;b===d&&(h|=1),h|=q.Bb(e,b)?4:2,h|=q.Bb(f,b)&&a.visuallyNoDataItems()?16:8,jc(a,g,h)}function jc(a,b,c){var d=a.style(),e;if(b&&d){switch(c){case 10:e=fa;break;case 18:e=ga;break;case 12:e=ha;break;case 20:e=ia;break;case 11:e=ja;break;case 19:e=ka;break;case 13:e=la;break;case 21:e=ma}Ob(b,Jb(d[da],d[e]),Lb(a.slicerData),a._caption,a.zoomFactor()),lc(a,K.Scc,b)}}function kc(a){var b,c,e,f,g,h=a.bX,i=a.aX;a.iX()?(h||(h=cc(a)),i.firstChild!==h&&(d.GC$(i).append(h),gc(a)),b=a.zoomFactor(),c=a.dX,e=Math.floor(c/(a.itemHeight()+2*a.kX+a.hX)),f=a.nX,f.value(a.sX),f.Vo(a.jX*b,!1),f._v(c*b,!1),f.bw(0),f.cw(Math.ceil(t(a.gX)/a.columnCount())-e),f.dw(e),f.qB(1),f.rB(e-1),f.ew()):(i.firstChild===h&&(g=h.parentElement,g&&g.removeChild(h),gc(a)),a.sX=0)}function lc(a,b,c){var e,f,g,h,i,j,k,l,m,n,o=a.zoomFactor();switch(b){case K.Ncc:h=a.xo,i=Rb(h),j=a.PW,e=(a.width()-2*j)*o-i.widthOffset,f=(a.height()-2*j)*o-i.heightOffset,g=h;break;case K.Occ:k=a.KW,l=Rb(k),m=a.MW*Qb(a.style())*o-l.heightOffset,d.GC$(k).css(T,m),e=a.RW*o,f=a.SW*o,g=a.WW;break;case K.Scc:n=Rb(c),e=_b(a,a.eX)*o-2*a.tX-n.widthOffset,f=a.itemHeight()*o-n.heightOffset,g=c}Ib(g,[S,T],[e,f])}function mc(a,b){var c,d,e,f=a.exclusiveDatas,g=a.pX,h=qc(a,b[Qa]),i=a.vX,j=a.wX;for(q.Bb(i,h)?q.Fb(i,h):i.push(h),c=0;c<t(f);c++)q.Bb(g,c)||j.push(c);for(d=0;d<t(i);d++)q.Bb(j,i[d])?q.Fb(j,i[d]):j.push(i[d]);if(0===t(j))for(e=0;e<t(a.gX);e++)j.push(e);a.xX=h}function nc(a,b){var c,d,e,f,g,h,i,j,k=a.fX,l=a.gX,m=l[a.xX];for(pc(a),c=k.indexOf(m),d=k.indexOf(b[Qa]),e=Math.min(c,d),f=Math.max(c,d),g=e;g<=f;g++)h=l.indexOf(k[g]),i=a.vX,j=a.wX,i.indexOf(h)===-1&&i.push(h),j.indexOf(h)===-1&&j.push(h)}function oc(a,b){pc(a);var c=qc(a,b[Qa]);ic(a,c),a.vX.push(c),a.wX.push(c),a.xX=c}function pc(a){var b,c,d,e,f,g,h=a._items;if(h&&0!==t(h))for(b=a.rX,c=0,d=t(h);c<d;c++)e=h[c],f=a.gX.indexOf(h[c].innerHTML),g=q.Bb(b,f)?20:12,jc(a,e,g)}function qc(a,b){var c,d,e=a.gX;if(e)for(c=0,d=t(e);c<d;c++)if(e[c]===b)return c;return-1}function rc(a,b){var c,d,e=a.pX,f=a.rX;for(c=0;c<t(b);c++)d=0,d|=a.yX?q.Bb(e,b[c])?2:4:2,d|=q.Bb(f,b[c])&&a.visuallyNoDataItems()?16:8,jc(a,a.NW[b[c]],d)}function sc(a,b){var c=a.qX;a.CD(b),c=c?new gb(c[Pa],c[Qa]):z,a.qX=z,uc(a,c)}function tc(a,b){var c,e,f,g=a.WW;if(g)switch(c=a.style(),e=Jb(c[da],c[ea]),f=e&&e[V],f||(f=N),a.zX=f,b){case 0:a.AX=!1,Ib(g,[Q,R],[a.BX,f]);break;case 1:a.AX=!0,Ib(g,[Q,R],[a.CX,f]);break;case 2:d.GC$(g).css(R,a.DX)}}function uc(a,b){var c,d;if(b)switch(c=a.vX,b[Pa]){case 4:if(!a.WW)return;a.AX?tc(a,1):tc(a,0);break;case 5:d=a.gX.indexOf(b[Qa]),c&&q.Bb(c,d)?rc(a,c):ic(a,d)}}function vc(a,b){if(b)switch(b[Pa]){case 4:if(!a.WW||!a.AX)return;tc(a,2);break;case 5:var c=a.gX.indexOf(b[Qa]);ic(a,c);break;case 6:a.cX.style.cursor=qa}}function wc(a,b){var c,d,e=a._items;if(e&&b!==z)for(c=0;c<t(e);c++)if(d=e[c],d.innerHTML.toLowerCase()===b.toLowerCase())return d;return z}function xc(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=yc(a,K.Ncc),o=z,p=z;if(!n)return z;if(c=b.pageX,d=b.pageY,e=yc(a,K.Occ),f=yc(a,K.Pcc),g=yc(a,K.Qcc),h=yc(a,K.Rcc),e&&e.contains(c,d))o=f&&f.contains(c,d)?4:1;else if(g&&g.contains(c,d))if(i=a._items,h&&h.contains(c,d)&&i){for(j=void 0,j=0;j<t(i);j++)if(k=yc(a,K.Scc,j),k&&k.contains(c,d)){o=5;for(l in a.NW)if(a.NW[l]===i[j]){p=a.gX[l];break}break}j>=t(i)&&(m=yc(a,K.Scc,t(i)-1),o=m&&d<m.y+a.itemHeight()*a.zoomFactor()?6:7)}else o=8;else o=0;return new gb(o,p)}function yc(a,b,c){var e,f,g,h,i,j,k,l,m,n,o,p=b===K.Ncc?y:yc(a,K.Ncc),q=a.xo,r=a.EX,s=a.PW,u=a.zoomFactor(),v=a.style(),w=a.showHeader(),x=a.MW,A=a.RW,B=a.gX;switch(b){case K.Ncc:e=0,f=0,g=q.offsetWidth,h=q.offsetHeight;do e+=q.offsetLeft,f+=q.offsetTop,q=q.offsetParent;while(q);break;case K.Occ:if(!p||!w)return z;e=p.x+r*u,f=p.y+r*u,g=a.width()*u,h=x*Qb(v)*u;break;case K.Pcc:if(!p||!w)return z;e=p.x+p.width-(r+s+A)*u,f=p.y+r+a.QW*Qb(v)*u,g=A*u,h=a.SW*u;break;case K.Qcc:if(!p)return z;i=r+s,j=0,k=x*Qb(v)+a.XW,e=p.x+i*u,f=p.y+j*u+(w?k*u:0),g=(a.width()-2*i)*u,h=p.height-2*j*u-(w?k*u:0);break;case K.Rcc:if(l=yc(a,K.Qcc),!l)return z;if(!a.iX())return l;e=l.x,f=l.y,g=l.width-a.jX*a.zoomFactor(),h=l.height;break;case K.Scc:if(!p||0===t(B)||c>=t(B))return z;if(m=yc(a,K.Rcc),!m)return z;n=a.columnCount(),o=a.hX,g=(m.width-(n-2)*o*u)/n,h=a.itemHeight()*u+2*a.lX,e=m.x+c%n*(g+o*u),f=m.y+Math.floor(c/n)*(h+o*u)}return new d.Rect(e,f,g,h)}function zc(a){return a>0}cb=function(){function a(a,b,c){var d=this;d.name(a,!1),d.xo=z,d.PW=6,d.EX=1,d.VW=14,d.KW=z,d.MW=27,d.XW=5,d._caption=z,d.WW=z,d.RW=28,d.SW=25,d.TW=3,d.UW=0,d.AX=!1,d.QW=3,d.YW=z,d.ZW=z,d.$W=z,d._W=z,d.aX=z,d.cX=z,d.eX=0,d.dX=0,d.bX=z,d.FX=2,d._items=[],d.NW={},d.lX=1,d.kX=1,d.tX=6,d.hX=2,d.jX=17,d.sX=0,d.zX=N,d.DX="#F9E578",d.CX="red",d.BX="#B0ADB0",d.GX=!1,d.HX=!1,d.vX=[],d.wX=[],d.xX=0,d.fX=[],d.pX=[],d.rX=[],d.gX=[],d.oX=[],d.slicerData=b,d.columnName=c,d.data=b.getData(c),d.exclusiveDatas=b.getExclusiveData(c),d.slicerData.attachListener(d),d.IX()}return a.getDefaultStyle=function(){var a=function(a,b,c,d,e,f,g,h){var i={};return i[V]=a,i[W]=b,i[U]=c,i[$]=d,i[_]=e,i[aa]=f,i[ba]=g,i[ca]=h,i},b=function(a,b,c){var d={};return d[X]=a,d[Y]=b,d[Z]=c,d},c=b(1,P,"#808080"),d=b(0,"",""),e=b(1,P,"#999999"),f=b(1,P,"#CCCCCC"),g=b(1,P,"#E0E0E0"),h=a("#F9E36F",O,A,e,e,e,e),i={};return i[da]=a(N,O,A,c,c,c,c),i[ea]=a(N,O,"bold 11pt calibri",d,d,d,b(1,P,"#A6A6A6")),i[fa]=a("#BFBFBF",O,A,e,e,e,e),i[ga]=a("#D9D9D9",O,A,f,f,f,f),i[ha]=a(N,O,A,f,f,f,f),i[ia]=a(N,"#959595",A,g,g,g,g),i[ja]=h,i[ka]=h,i[la]=h,i[ma]=h,i},a.prototype.IX=function(){var a=this;a.oX=Sb(a.data),a.gX=Sb(a.exclusiveDatas),a.xo=Tb(a),a.captionName(a.columnName,!1),a.attachEvents(),a.onFiltered(),Hb(a,a.style()),ec(a)},a.prototype.attachEvents=function(){var a,b=this,c=b.xo;c&&(d.GC$(c).bind(D+"down"+C,function(a){b.AD(a)}).bind(D+"move"+C,function(a){b.BD(a)}).bind(D+"out"+C,function(a){b.uX()}),d.GC$(x).bind(D+"up"+C,function(a){sc(b,a)}).bind("keydown"+C,function(a){b.nm(a)}).bind("keyup"+C,function(a){b.om(a)}),b.Rw=b.Rw.bind(b),a={capture:!1,passive:!1},c.addEventListener(D+E,b.Rw,a),c.addEventListener(F,b.Rw,a),x.addEventListener(D+E,b.Rw,a),x.addEventListener(F,b.Rw,a))},a.prototype.detachEvents=function(){var a=this,b=a.xo;b&&(d.GC$(b).unbind(C),d.GC$(x).unbind(C),b.removeEventListener(D+E,a.Rw),b.removeEventListener(F,a.Rw),x.removeEventListener(D+E,a.Rw),x.removeEventListener(F,a.Rw))},a.prototype.no=function(){var a=this;a.detachEvents(),d.GC$(a.xo).remove(),a.xo=z},a.prototype.getDOMElement=function(){return this.xo},a.prototype.mX=function(a,b){var c,d,f=[];if(0!==b){for(c=e.Slicers.jf.quickSort(a),d=0;d<t(c);d++)f[d]=c[d].value;return 2===b&&f.reverse(),f}},a.prototype.iX=function(){var a=this,b=a.gX,c=a.showNoDataItems()?t(b):t(b)-t(a.rX),d=Math.ceil(c/a.columnCount())*(a.itemHeight()+2*(a.lX+a.kX)+a.hX);return d>a.dX},a.prototype.Bw=function(a,b){this.JX(a,b)},a.prototype.JX=function(a,b){var c=this,d=b.newValue;d!==c.sX&&d<=c.nX.cw()&&(c.sX=d,kc(c),hc(c))},a.prototype.onDataChanged=function(){dc(this)},a.prototype.onRowsChanged=function(){dc(this)},a.prototype.onColumnNameChanged=function(a,b){var c=this;c.columnName===a&&c._caption&&(c.columnName=b,c.captionName(b,!1),d.GC$(c._caption).text(b))},a.prototype.onColumnRemoved=function(a){var b=this;a===b.columnName&&(b.slicerData.doUnfilter(a),b.detachEvents(),d.GC$(b.xo).remove(),b.xo=z)},a.prototype.onFiltered=function(){var a=this,b=a.slicerData,c=a.columnName;a.fX=bc(a),a.rX=b.getFilteredOutIndexes(c,2),a.pX=b.getFilteredOutIndexes(c,1),ec(a)},a.prototype.xmb=function(a){var b,c=xc(this,a);return!!c&&(b=c.mark,5===b||6===b||8===b||4===b)},a.prototype.AD=function(a){var b=this,c=xc(b,a);c&&(8===c[Pa]&&(b.HX=!0),5===c[Pa]&&(b.wX=[],b.GX=!0,a.ctrlKey?mc(b,c):a.shiftKey?nc(b,c):oc(b,c)),rc(b,b.vX),(5===c[Pa]||6===c[Pa]||8===c[Pa]||4===c[Pa]&&b.AX)&&a.stopPropagation())},a.prototype.CD=function(a){var b,c,d,e=this,f=xc(e,a);f&&(b=e.slicerData,c=e.vX,d=!1,4===f[Pa]?e.AX&&(b.doUnfilter(e.columnName),tc(e,0),d=!0):c&&t(c)>0&&!e.yX&&!e.KX&&(b.doFilter(e.columnName,{exclusiveRowIndexes:e.wX}),d=!0),e.GX=!1,e.HX=!1,d&&(e.vX=[],e.wX=[]))},a.prototype.BD=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=o.qX,r=p?new gb(p[Pa],p[Qa]):z,s=xc(o,a),u=o.gX,v=o.wX;if(s&&(!r||r[Pa]!==s[Pa]||5===r[Pa]&&r[Qa]!==s[Qa])){if(!o.GX)return o.qX=s,uc(o,r),void vc(o,s);if(5===s[Pa])if(b=u.indexOf(s[Qa]),c=o.rX,d=void 0,e=void 0,f=void 0,q.Bb(v,b)){for(g=o.fX,h=g.indexOf(u[o.xX]),i=g.indexOf(s[Qa]),j=Math.min(h,i),k=Math.max(h,i),l=[],m=t(v),d=0;d<m;d++)n=v[d],e=g.indexOf(u[n]),(e>k||e<j)&&l.push(n);for(m=t(l),d=0;d<m;d++)e=l[d],
f=wc(o,u[e]),q.Bb(c,e)?jc(o,f,20):jc(o,f,12),q.Fb(v,e)}else f=wc(o,u[b]),q.Bb(c,b)?jc(o,f,18):jc(o,f,10),q.Sb(v,b);o.qX=s}},a.prototype.uX=function(){var a=this,b=a.qX,c=b?new gb(b[Pa],b[Qa]):z;a.qX=z,uc(a,c)},a.prototype.Rw=function(a){var b=xc(this,a);return 8===b[Pa]&&(a.stopPropagation(),!0)},a.prototype.nm=function(a){var b=this;17!==a.keyCode||b.yX||(b.yX=!0),16!==a.keyCode||b.KX||(b.KX=!0)},a.prototype.om=function(a){var b=this,c=b.slicerData;17===a.keyCode&&b.yX&&(b.yX=!1),16===a.keyCode&&b.KX&&(b.KX=!1),!b.yX&&!b.KX&&t(b.vX)>0&&(c.doFilter(b.columnName,{exclusiveRowIndexes:b.wX}),b.vX=[],b.wX=[])},a.prototype.onPropertyChanged=function(a,b,c){var d,e=this;e.slicerData.OW&&(d=e.slicerData.OW(),d.ITa.xVa(e,a,c,b))},a}(),b.ItemSlicer=cb;function Ac(a){return function(b,c){ec(this),this.onPropertyChanged(a,b,c)}}function Bc(a){return function(b,c){var d=this;d.fX=bc(d),ec(d),d.onPropertyChanged(a,b,c)}}function Cc(a,b,c,e){return c||(c=Ac(a)),d.Ul.Pl(a,b,c,e)}for(db=[[L],[S,180],[T,210],["captionName",""],["columnCount",1,z,zc],["itemHeight",21,z,zc],["showHeader",!0],["sortState",1,Bc("sortState")],["showNoDataItems",!0,Bc("showNoDataItems")],["showNoDataItemsInLast",!0,Bc("showNoDataItemsInLast")],["visuallyNoDataItems",!0,Bc("visuallyNoDataItems")],[M,cb.getDefaultStyle(),function(a,b){Hb(this,a),ec(this),this.onPropertyChanged("visuallyNoDataItems",a,b)}],["zoomFactor",1,z,zc],["isLocked"],["disableResizingAndMoving"]],eb=0,fb=t(db);eb<fb;eb++)cb.prototype[db[eb][0]]=Cc(db[eb][0],db[eb][1],db[eb][2],db[eb][3]);gb=function(){function a(a,b){var c=this;c[Pa]=a===y?z:a,c[Qa]=b===y?z:b}return a}();function Dc(a,b,c){var d,e,f,g,h=a.kj,i=a.dataRange(),j=i.row+i.rowCount-1,k=i.col+i.colCount-1;for(d=i.row;d<=j;d++)for(e=[],b.push(e),f=i.col;f<=k;f++)e.push({value:h.getValue(d,f),text:h.getText(d,f)});for(f=0;f<i.colCount;f++)g=a.getColumnName(f)||"",c.push(g)}function Ec(a,b){var c,d,e=a.kj,f=a.sj.rowFilter();for(e.suspendPaint(),c=f&&f.Je||[],d=0;d<t(c);d++)Fc(a,b,[c[d]]);e.resumePaint()}function Fc(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,r,s,u;for(d=0;d<c.length;d++){if(e=a.sj,f=a.xr,g=c[d]-e.range().col,h=e.dataRange(),i=g+h.col,j=a.columnNames[g],k=[],l={},q.Bb(f.Je,i)){for(m=[],n=h.row;n<h.row+h.rowCount;n++)f.R8J(n,i)||m.push(n);for(o=0;o<t(m);o++)p=m[o]-h.row,r=a.getExclusiveRowIndex(j,p),l[r]||(l[r]=!0,k.push(r))}else for(s=t(a.getExclusiveData(j)),u=0;u<s;u++)k.push(u);Gc(Hc(a,j),k)||(b.prototype.doFilter.call(a,j,{exclusiveRowIndexes:k}),a.onFiltered(),a.kj.$p())}}function Gc(a,b){if(p(a)&&p(b))return!0;if(p(a)&&!p(b)||!p(a)&&p(b)||!p(a)&&!p(b)&&(!v(a)||!v(b))||a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function Hc(a,b){var c,d=a.getExclusiveData(b),e=a.getFilteredOutIndexes(b,1),f=[];for(c=0;c<t(d);c++)q.Bb(e,c)&&f.push(c);return f}hb=function(a){Gb(b,a);function b(b){var c,d=this,e=[],f=[],g=b.rowFilter();return Dc(b,e,f),d=a.call(this,e,f)||this,c=d,c.sj=b,c.kj=b.kj,c.xr=g,c.MX=z,Ec(c,G),g&&(g.filterHandler=function(a){Fc(c,G,a.columns)}),d}return b.prototype.no=function(){var a=this;a.MX=z,a.sj=z,a.xr&&(a.xr.filterHandler=z,a.xr=z),a.kj=z},b.prototype.OW=function(){return this.kj},b.prototype.getTable=function(){return this.sj},b.prototype.doFilter=function(b,c,d){var e,f,h,i,j,k,l,m,n,o,p,q,r,s,u,v=this,w=v.kj,x=v.sj,z=v.xr,A=c.ranges,B=c.exclusiveRowIndexes,C=!!B,D={columnName:b,oldValue:v.getFilteredIndexes(b)},E=v.getColumnIndex(b);if(!(E<0||!C&&!A)){if(d)a.prototype.doFilter.call(this,b,c,d);else{if(e=C?v.getExclusiveData(b):v.getData(b),f=[],C)f=B;else for(h=v.ef(),i=v.ff(),h[E]||v.We(E),j=h[E],k=0;k<t(A);k++)for(l=A[k],m=v.Xe(j,l),n=m.start;n<=m.end;n++)f.push(i[E][n]);if(w.suspendPaint(),o=x.startColumn()+E,z&&z.removeFilterItems(o,!0),w.AR(),g.$V){for(p=[],q=0;q<t(f);q++)r=g.$V(2,0,e[f[q]]),r.useWildCards(!1),p.push(r);z&&z.addFilterItem(o,p)}a.prototype.hf.call(this,b,c),s=[],u={},v.gf(b,s,u),z&&(z.filter(o,!0),z.onFilter(z.SX(0,[o])),w.ITa.gVa(z,7,y,!0)),v.onFiltered(),w.resumePaint()}w.ITa.xVa(v,na,D,{columnName:b,oldValue:v.getFilteredIndexes(b)})}},b.prototype.doUnfilter=function(b){var c,d,e=this,f=e.kj,g=e.sj,h=e.getColumnIndex(b),i=e.xr;h!==-1&&(c={columnName:b,oldValue:e.getFilteredIndexes(b)},d=g.startColumn()+h,i.removeFilterItems(d),a.prototype.if.call(this,b),i.unfilter(d,!0),i.onFilter(i.SX(0,[d])),e.onFiltered(),e.kj.$p(),f.ITa.xVa(e,na,c,{columnName:b,oldValue:e.getFilteredIndexes(b)}))},b.prototype.refresh=function(){var a=this,b=[],c=[];Dc(a.sj,b,c),a.bf(b,c)},b.prototype.onColumnNameChanged=function(b,c){var d,e,f=this;a.prototype.onColumnNameChanged.call(this,b,c),d=f.kj.parent,e=d&&d.sheets||[f.kj],e.forEach(function(a){a.slicers.all().forEach(function(a){a.ZX===f&&a.columnName()===b&&a.columnName(c)})})},b.prototype.onRowsAdded=function(b,c){var d,e,f=this,g=f.kj,h=f.sj,i=h.dataRange();for(a.prototype.onRowsAdded.call(this,b,c,!0),d=b;d<b+c;d++)for(e=0;e<t(f.columnNames);e++)f.data[d][e]={value:g.getValue(i.row+d,i.col+e),text:g.getText(i.row+d,i.col+e)};f.bf(f.data,f.columnNames),f.cf("onRowsChanged",b,c,!0)},b.prototype.onRowsRemoved=function(b,c){a.prototype.df.call(this,b,c,!1)},b.prototype.onColumnsAdded=function(a,b){var c,d,e,f,g=this,h=g.kj,i=g.sj,j=i.dataRange(),k=g.data,l=g.columnNames;for(c=0;c<t(k);c++)for(d=a;d<a+b;d++)k[c].splice(d,0,{value:h.getValue(j.row+c,j.col+d),text:h.getText(j.row+c,j.col+d)});for(e=a;e<a+b;e++)f=i.getColumnName(e)||"",l.splice(e,0,f);g.bf(k,l)},b.prototype.onColumnsRemoved=function(b,c){var d,e,f=this,g=f.kj,h=f.sj.name(),i=f.columnNames,j=[];for(d=b;d<b+c;d++)i[d]&&j.push(i[d]);a.prototype.onColumnsRemoved.call(this,b,c),e=g&&g.slicers,j.forEach(function(a){e.all(h,a).forEach(function(a){e.remove(a.name())})})},b.prototype.onTableRemoved=function(a){var b,c,d,e=this;a&&a===e.sj&&(e.MX=[],b=e.kj,c=b.slicers,d=a.name(),c.all(d).forEach(function(a){e.MX.push(a),c.remove(a.name())}),c&&Kc(c,e),e.Ze=[])},b.prototype.onTableAdded=function(a){var b,c=this,d=c.kj,e=d.slicers;e&&a&&a.Aq()&&Jc(e,a.getSlicerData()),b=c.MX||[],b.forEach(function(a){var b=a.name(),c=a.ZX.sj.name(),d=a.columnName(),f=a.style();e.add(b,c,d,f)})},b}(G),b.TableSlicerData=hb,h.Table&&d.GC$.extend(h.Table.prototype,{getSlicerData:function(){var a=this;return a.ZX||(a.ZX=new hb(a)),a.ZX}});function Ic(a){var b=a.sj,c,d;return b&&(c=b.kj,d=b.rowFilter()),c&&(!c.options.isProtected||d&&d.TX(c))}ib=function(a){Gb(b,a);function b(b,c,d){var e=a.call(this,b,c,d)||this;return e.isSelected(!1),e}return b.prototype.no=function(){var b=this;b.sj=z,b.slicer(z),b.sheet(z),a.prototype.no.call(this)},b.prototype.IX=function(){var b=this,c=b.slicerData;c&&c instanceof hb&&(b.sheet(c.OW()),b.sj=c.getTable()),a.prototype.IX.call(this)},b.prototype.onColumnRemoved=function(a){var b,c=this,d=c.sheet(),e=c.sj,f=c.slicerData;a===c.columnName&&(b=f.getFilteredOutIndexes(a,1),0!==t(b)&&f.doUnfilter(a),d&&e&&d.wr.Fb(c.name()))},b.prototype.mX=function(a,b){var c,d,f,g,h,i,j=this,k=j.slicerData,l=k.getColumnIndex(j.columnName),m=j.sj,n=m.dataRange(),o=[];if(0===b)return a;for(c=[],d=k.OW(),f=0;f<t(a);f++)g=k.getRowIndexes(j.columnName,f),c.push(d.getValue(n.row+g[0],n.col+l));for(h=e.Slicers.jf.quickSort(c),i=0;i<t(h);i++)o[i]=a[h[i].index];return 2===b&&o.reverse(),o},b.prototype.Bw=function(b,c){var d,e,f=this,g=f.sheet(),h=f.slicer();for(h&&g.ER(h)||(c.newValue=c.oldValue),d=Qc(h),e=0;e<t(d);e++)a.prototype.JX.call(this,b,c)},b.prototype.AD=function(b){var c,d,e,f=this,g=f.sheet(),h=f.slicer();if(h&&g.ER(h)){if(c=xc(f,b),!Ic(f)&&(5===c[Pa]||6===c[Pa]||8===c[Pa]))return void b.stopPropagation();for(d=Qc(h),e=0;e<t(d);e++)a.prototype.AD.call(this,b)}},b.prototype.CD=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=p.sheet(),r=p.slicer();if(r&&q.ER(r)&&Ic(p)&&(b=xc(p,a))){for(c=p.slicerData,d=p.vX,e=p.wX,f=c.getExclusiveData(p.columnName),g=!1,h=z,4===b[Pa]||5===b[Pa]&&t(e)===t(f)&&!p.yX&&!p.KX?(i=c.getFilteredIndexes(p.columnName),h=q.wu().execute({cmd:"unfilterSlicer",sheetName:q.name(),slicerData:c,columnName:p.columnName,value:i}),g=!0):d&&t(d)>0&&!p.yX&&!p.KX&&(j=c.getFilteredIndexes(p.columnName),k=e.concat(),h=q.wu().execute({cmd:"filterSlicer",sheetName:q.name(),slicerData:c,columnName:p.columnName,oldValue:j,newValue:k}),g=!0),l=Qc(r),m=0,n=t(l);m<n;m++)o=l[m],o.GX=!1,o.HX=!1,g&&(o.vX=[],o.wX=[]);return!!h}},b.prototype.BD=function(b){var c,d,e=this,f=e.sheet(),g=e.slicer();if(g&&!e.HX&&f.ER(g))for(c=Qc(g),d=0;d<t(c);d++)a.prototype.BD.call(this,b)},b.prototype.uX=function(){var b,c,d=this,e=d.sheet(),f=d.slicer();if(f&&e.ER(f))for(b=Qc(f),c=0;c<t(b);c++)a.prototype.uX.call(this)},b.prototype.Rw=function(b){var c,d,e,f,g=this;return!!a.prototype.Rw.call(this,b)||(!(c=g.sheet())||(d=c.slicers,e=d&&d.UX(),f=g.nX,!!(e&&1===t(e)&&g.isSelected()&&g.iX()&&f)&&(f.sC(b),b.stopPropagation(),!0)))},b.prototype.om=function(a){var b,c,d,e,f=this,g=f.slicerData,h=f.sheet(),i=f.wX;17===a.keyCode&&f.yX&&(f.yX=!1),16===a.keyCode&&f.KX&&(f.KX=!1),!f.yX&&!f.KX&&t(f.vX)>0&&(b=t(g.getExclusiveData(f.columnName)),t(i)===b?(c=g.getFilteredIndexes(f.columnName),h.wu().execute({cmd:"unfilterSlicer",sheetName:h.name(),slicerData:g,columnName:f.columnName,value:c})):(d=g.getFilteredIndexes(f.columnName),e=i.concat(),h.wu().execute({cmd:"filterSlicer",sheetName:h.name(),slicerData:g,columnName:f.columnName,oldValue:d,newValue:e})),f.vX=[],f.wX=[])},b.prototype.toJSON=function(){return{slicerName:this.name(),columnName:this.columnName}},b}(cb),ib.prototype.isSelected=s("isSelected",!1),ib.prototype.sheet=s("sheet"),ib.prototype.slicer=s("slicer");function Jc(a,b){var c,d,e=a.VX;if(b){for(c=b.getTable(),d=0;d<t(e);d++)if(e[d].getTable()===c)return;e.push(b)}}function Kc(a,b){q.Fb(a.VX,b)}function Lc(a,b){var c,d,e,f=a.VX;for(c=0;c<t(f);c++)if(d=f[c],e=d.getTable(),d&&e&&e.tableName()===b)return d;return z}jb="nameInFormula",kb="captionName",lb="columnCount",mb="columnName",nb="itemHeight",ob="showHeader",pb="sortState",qb="disableResizingAndMoving",rb="showNoDataItems",sb="showNoDataItemsInLast",tb="visuallyNoDataItems",ub="isSelected",vb="dynamicMove",wb="dynamicSize",xb="tableName",yb="Slicer",zb=100,Ab=100,Bb=192,Cb=250,Db=[];function Mc(a,b,c){var d,e,f=a.ZX;f&&(d=f.OW(),e=d.slicers,e.all().forEach(function(d){d===a&&(e.U3(b,c),a.onPropertyChanged(L,c,b))}))}for(Eb=function(a){Gb(b,a);function b(b,c,d){var e,f,g,h,i=a.call(this,b,zb,Ab,Bb,Cb)||this;return i.l8=j.SlicerType.table,e=i,e.typeName=yb,e.g3=yb,c&&(f=c.kj,e.sheet(f),c.NVJ&&(c.a$(),c.NVJ=!1),g=Lc(f.slicers,c.tableName())),g||(g=c.getSlicerData()),e.ZX=g,e[mb](d),e.$X=[],e._X=d,h=yb+"_"+d,e.sheet()&&e.sheet().parent&&(h=e.sheet().parent.JVJ(d,e.l8)),e[jb](h),e[kb](d),e[wb](!1),e[vb](!1),i}return b.prototype.no=function(a){if(a!==!1){var b=this;b.$X&&(b.$X.forEach(function(a){a.no()}),b.$X=z),b.ZX&&(b.ZX.no(),b.ZX=z),b.sheet(z)}},b.prototype.sourceName=function(){return this._X},b.prototype.cloneContent=function(){var a=this,b=a.sheet(),c=a.ZX,d=new ib(a.name(),c,a.columnName());return d.width(a.width(),!1),d.height(a.height(),!1),d.captionName(a.captionName()),d.columnCount(a.columnCount()),d.itemHeight(a.itemHeight()),d.showHeader(a.showHeader()),d.sortState(a.sortState()),d.isLocked(a.isLocked()),d.disableResizingAndMoving(a.disableResizingAndMoving()),d.showNoDataItems(a.showNoDataItems()),d.showNoDataItemsInLast(a.showNoDataItemsInLast()),d.visuallyNoDataItems(a.visuallyNoDataItems()),d.style(a.style().toJSONInternal()),d.zoomFactor(b.zoom()),d.isSelected(a.isSelected()),d.slicer(a),d.sheet()!==b&&d.sheet(b),a.$X.push(d),d.getDOMElement()},b.prototype.YX=function(){return this.ZX},b.prototype.hga=function(){return!1},b.prototype.cOJ=function(a){for(var b=1,c=this,d=a,e=c.sheet().parent;j.vSJ(e,d);)d=a+b,b++;return d},b.prototype.refresh=function(a){var b,c=this.$X;for(b=0;b<t(c);b++)ec(c[b],a)},b.prototype.refreshContent=function(a){var b=this,c=b.sheet().zoom();c!==b.MP&&(b.MP=c,b.refresh(c))},b.prototype.clone=function(a){var c,d=this;return!d.sheet()&&a&&d.sheet(a,!1),c=new b(d.name(),Pc(d),d.columnName()),c.sheet(d.sheet(),!1),c.fromJSON(d.toJSON(),!1,d.ZX),c},b.prototype.fromJSON=function(b,c,e){var f,g,h,i,j,l,m,n,o,p,q;b&&(f=this,g=b.tableName,h=b[mb],g&&h&&(a.prototype.fromJSON.call(this,b),i=f.sheet(),j=i.slicers,l=i.parent,m=e?e:Lc(j,g),m||(n=l.jga(g),m=n.getSlicerData(),Jc(j,m)),f.ZX=m,f[mb](h),o=b.x!==y?b.x:zb,p=b.y!==y?b.y:Ab,f.position(new d.Point(o,p)),f[S](b[S]!==y?b[S]:Bb,!1),f[T](b[T]!==y?b[T]:Cb,!1),b.sourceName!==y&&(f._X=b.sourceName),Db.forEach(function(a){var c,d=b[a];d!==y&&(f[a](d,!1),a===qb&&(c=f[a](),f.allowMove(!c,!1),f.allowResize(!c,!1)))}),b.style!==y&&(q=new k.SlicerStyle,q.fromJSON(b.style),f.style(q,!1))))},b.prototype.toJSON=function(a){var b,c,d,e,f,g=this,h={};return h.type=g.l8,b=["x","y",S,T,vb,wb,"isLocked","fixedPosition"],b.forEach(function(a){var b=g[a]();g[a].isDefault(b)&&a!==vb&&a!==wb||(h[a]=b)}),c=g._X,c&&(h.sourceName=c),g[M]()&&(h[M]=g[M]().toJSON()),d=g.ZX,e=d.getTable(),f=p(e.fOJ)?e[xb]():e.fOJ,p(a)?h[L]=g.name():h[L]=g.cOJ(g.name()),e[xb]&&(h[xb]=f),Db.forEach(function(a){var b=g[a]();a===M||g[a].isDefault(b)||a!==L&&(h[a]=b)}),h},b.prototype.Wq=function(a){var b=this.sheet();b&&b.Wq(d.Events.SlicerChanged,a)},b}(f.FloatingObject),b.DOMTableSlicer=Eb,Fb=[["name","",function(a,b,c){Mc(this,c,b)},j.checkSlicerName],[kb,"",Oc],[lb,1,Oc,zc],[nb,21,Oc,zc],[ob,!0,Oc],[pb,1,Oc],[qb,!1,function(a,b,c){var d,e=this;e.allowMove(!b,!1),e.allowResize(!b,!1),Oc.call(e,qb,b,c),d=e.sheet(),d&&d.$p()}],[rb,!0,Oc],[sb,!0,Oc],[tb,!0,Oc],[M,k.SlicerStyles.light1(),Oc],[mb,"",function(a,b,c){var d,e=this;e._X=b,e.captionName(b,!1),d=e.sheet(),d.ITa.xVa(e,a,c,b)}]],eb=0,fb=t(Fb);eb<fb;eb++)Eb.prototype[Fb[eb][0]]=Nc(Fb[eb][0],Fb[eb][1],Fb[eb][2],Fb[eb][3]);function Nc(a,b,c,d){return Db.push(a),s(a,b,function(b,d){c.call(this,a,b,d)},d)}function Oc(a,b,c){var d,e,f=this,g=f.$X||[];for(d=0;d<t(g);d++)g[d][a]&&("style"===a?g[d][a](b.toJSONInternal()):g[d][a](b));e=f.sheet(),e&&(e.ITa.xVa(f,a,c,b),f.Wq({sheet:e,sheetName:e.name(),slicer:f,propertyName:a}))}function Pc(a){return a.ZX.getTable()}function Qc(a){return a.$X}Eb.prototype.nameInFormula=Nc(jb,"",Oc,function(a){var b=this,c=b.sheet()&&b.sheet().parent;return!c||!c.KVJ(a,b.l8)}),Eb.prototype.onPropertyChanged=Oc},Common:function(b,c){b.exports=a.Spread},ConditionalFormatting:function(b,c){b.exports=a.Spread.Sheets.ConditionalFormatting},Core:function(b,c){b.exports=a.Spread.Sheets},FloatingObject:function(b,c){b.exports=a.Spread.Sheets.FloatingObjects},Shapes:function(b,c){b.exports=a.Spread.Sheets.Shapes},Tables:function(b,c){b.exports=a.Spread.Sheets.Tables}})});