/*!
 * 
 * SpreadJS Library 16.0.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.ContextMenu=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/contextMenu/context-menu.entry.js")}({"./dist/plugins/contextMenu/context-menu-dialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=d.Ul.vl,f=d.Go,g=d.GC$,h="gc.command.executed",i="insertComment",j="editComment",k="gc.spread.",l="left",m="top",n=function(a){o(b,a);function b(b,c){var d=a.call(this,b,e(b))||this,f=d;return f.Eu=c,d}return b.prototype.Qla=function(a,b,c){var d=this,e=a[0];d.kma&&d.kma.ai&&d.kma.ai(e,b,c,d.Eu)},b.prototype.OT=function(a,b,c,d,e){var f=this,g=f.Sla(c,d);f.kma=a,f.Qla(g,b,e)},b.prototype.Sla=function(b,c){var d=this,e=d.yo();return e.css([l,m],[b,c]),e.empty(),a.prototype.Ao.call(this),d.QQ(),e},b.prototype.Loa=function(a){var b,c,d,e=this,f=e.yo();return"block"!==f.css("display")||(b=f.offset(),b.top+=document.body.clientTop||0,b.left+=document.body.clientLeft||0,c=a.x,d=a.y,c<b.left||c>f.width()+b.left||d<b.top||d>f.height()+b.top)},b.prototype.QQ=function(){var a=this;a.Eu.bind(h,function(){a.close()})},b.prototype.Tla=function(){var a=this;a.Eu.unbind(h)},b.prototype.close=function(){var b,c,d,e=this,f=e.kma;f&&f.xc&&(b=[k+i,k+j],c=f.ZPa,(!c||b.indexOf(c.name)<0)&&(d=f.xc.getActiveSheet(),d&&d.mm&&d.mm.Qq()),e.kma.no()),e.Tla(),e.vo(e.Cj)&&g("#"+e.Cj).remove(),a.prototype.close.call(this)},b}(f),b.ContextMenuViewDialog=n},"./dist/plugins/contextMenu/context-menu.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/plugins/contextMenu/context-menu.js")),d(c("./dist/plugins/contextMenu/menu-view.js")),d(c("./dist/plugins/contextMenu/context-menu.ns.js"));var e=c("./dist/plugins/contextMenu/context-menu-dialog.js");b.Cyb=e.ContextMenuViewDialog},"./dist/plugins/contextMenu/context-menu.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib,Jb,Kb,Lb,Mb,Nb,Ob,Pb,Qb,Rb,Sb,Tb,Ub,Vb,Wb,Xb,Yb,Zb,$b,_b,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/plugins/contextMenu/context-menu-dialog.js"),f=c("./dist/plugins/contextMenu/menu-view.js"),g=c("Core"),h=c("./dist/plugins/contextMenu/context-menu.ns.js"),i=g.GC$,j=d.Common.j.Fa,k=d.Common.j.za,l=g.Ul.nl,m="gc.spread.contextMenu.",n="gc.spread.",o="gc-spread-",p="gc.spread.pivot",q="gc-spread-pivot-selected",r="viewport",s="colHeader",t="rowHeader",u="slicer",v="timeline",w="sheetTab",x="corner",y="pivotPageFilter",z="pivotTopLeft",A="pivotHeader",B="pivotEmptyLabel",C="pivotContent",D="pivotGrandTotal",E="FieldName",F="SortType",G="pivotSummarizeValuesBy",H="pivotExpandOrCollapse",I="pivotTableGroup",J="OpenPivotGroupDialog",K="pivotTableUnGroup",L="pivotShowValueAs",M="pivotShowDetails",N="pivotRefresh",O="removeField",P="pivotTable",Q="removePivotGrandTotal",R="openValueFieldSettingDialogCmd",S="pivotSum",T="UpdatePivotValueFieldCmd",U="pivotCount",V="pivotAverage",W="pivotMax",X="pivotMin",Y="pivotProduct",Z="pivotNoCalculation",$="pivotGrandtotal",_="pivotColumnTotal",aa="pivotRowTotal",ba="pivotOf",ca="pivotParentRowTotal",da="pivotDifferenceFrom",ea="pivotPercentDifferenceFro",fa="pivotRunningTotalIn",ga="pivotPercentRunningTotalIn",ha="pivotRankSmallestToLargest",ia="pivotOfParentTotal",ja="pivotParentColumnTotal",ka="pivotRankLargestToSmallest",la="pivotIndex",ma="pivotMoreOptions",na="pivotFilter",oa="pivotClearFilterFrom",pa="pivotKeepOnlySelectedItems",qa="pivotHideSelectedItems",ra="pivotTop10",sa="pivotLabelFilters",ta="pivotValueFilters",ua="pivotExpand",va="pivotCollapse",wa="pivotExpandEntireField",xa="pivotCollapseEntireField",ya="createDialogForValueFilter",za="createDialogForLabelFilter",Aa="OpenPivotShowValueAsDialog",Ba="filterFieldLabelValue",Ca="ClearCommand",Da="pivotSort",Ea="removeSlicer",Fa="toggleComment",Ga="deleteComment",Ha="editComment",Ia="unhideSheet",Ja="hideSheet",Ka="unhideRows",La="unhideColumns",Ma="hideRows",Na="pinRows",Oa="pinColumns",Pa="promote",Qa="demote",Ra="addAfter",Sa="addBefore",Ta="addAbove",Ua="addBelow",Va="moveUp",Wa="moveDown",Xa="expandAllLevels",Ya="collapseAllLevels",Za="expandLevel",$a="expandLevel1",_a="expandLevel2",ab="expandLevel3",bb="expandLevel4",cb="expandLevel5",db="expandLevel6",eb="expandLevel7",fb="expandLevel8",gb="expandLevel9",hb="hideColumns",ib="sortAscend",jb="sortDescend",kb="sort",lb="filter",mb="insertComment",nb="deleteSheet",ob="insertNote",pb="replyComment",qb="insertSheet",rb="insertRows",sb="insertColumns",tb="deleteRows",ub="deleteColumns",vb="clearContents",wb="paste",xb="pasteOptions",yb="pasteFormatting",zb="pasteValues",Ab="pasteFormula",Bb="pasteAll",Cb="cut",Db="copy",Eb="pasteValuesFormatting",Fb="pasteFormulaFormatting",Gb="separator",Hb="groupHeader",Ib="slicerSortAscend",Jb="slicerSortDescend",Kb="table",Lb="tableInsert",Mb="tableDelete",Nb="tableInsertRowsAbove",Ob="tableInsertRowsBelow",Pb="tableInsertColumnsLeft",Qb="tableInsertColumnsRight",Rb="tableInsertRows",Sb="tableInsertColumns",Tb="tableDeleteRows",Ub="tableDeleteColumns",Vb="insertCopiedCells",Wb="insertCutCells",Xb="shiftCellsDown",Yb="shiftCellsRight",Zb="allSheets",$b="tableInsertRowsAboveForContextMenu",_b="tableInsertRowsBelowForContextMenu",ac="tableDeleteRowsForContextMenu",bc="tableInsertColumnsLeftForContextMenu",cc="tableInsertColumnsRightForContextMenu",dc="tableDeleteColumnsForContextMenu",ec="row",fc="col",gc=void 0,hc=new d.Common.ResourceManager(h.SR,"ContextMenu"),ic=hc.getResource.bind(hc),jc={sheetTab:function(a,b,c){return RegExp("sheetTab","i").test(c.workArea)&&a.tabStripHitInfo&&a.tabStripHitInfo.sheetTab&&"newSheet"!==a.tabStripHitInfo.sheetTab.sheetName&&"allSheets"!==a.tabStripHitInfo.sheetTab.sheetName},outline:function(a,b,c){return!!(RegExp("outline","i").test(c.workArea)&&a.worksheetHitInfo&&a.worksheetHitInfo.outlineHitInfo)},viewport:function(a,b,c){if(RegExp("viewport","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&!a.worksheetHitInfo.floatingObjectHitInfo&&!a.worksheetHitInfo.shapeHitInfo&&!a.worksheetHitInfo.pivotTableInfo&&!a.worksheetHitInfo.commentHitInfo)return rc(b,c)&&sc(b,c)&&vc(b,c)&&yc(b,c)&&zc(b,c)&&Ac(b,c)},rowHeader:function(a,b,c){if(RegExp("rowHeader","i").test(c.workArea)&&a.worksheetHitInfo&&2===a.worksheetHitInfo.hitTestType)return rc(b,c)&&sc(b,c)&&tc(b,c)&&uc(b,c)&&Fc(b,c)&&Cc(b,c)},colHeader:function(a,b,c){var d,e,f,h=a.worksheetHitInfo;if(RegExp("colHeader","i").test(c.workArea)&&h&&1===h.hitTestType&&(d=g.UCJ(b),e=d&&d.ITa.getFreeAreaRowCount(1),f=h.row<e,!f))return rc(b,c)&&sc(b,c)&&tc(b,c)&&uc(b,c)&&Gc(b,c)&&Dc(b,c,a)},corner:function(a,b,c){if(RegExp("corner","i").test(c.workArea)&&a.worksheetHitInfo&&0===a.worksheetHitInfo.hitTestType)return rc(b,c)&&sc(b,c)&&vc(b,c)&&yc(b,c)},slicer:function(a,b,c){return RegExp("slicer","i").test(c.workArea)&&a.worksheetHitInfo&&a.worksheetHitInfo.shapeHitInfo&&a.worksheetHitInfo.shapeHitInfo.shape&&"Slicer"===a.worksheetHitInfo.shapeHitInfo.shape.drawingType},timeline:function(a,b,c){var d=RegExp("timeline","i").test(c.workArea),e=a.worksheetHitInfo&&a.worksheetHitInfo.shapeHitInfo&&a.worksheetHitInfo.shapeHitInfo.shape&&"Timeline"===a.worksheetHitInfo.shapeHitInfo.shape.drawingType;return d&&e},chart:function(a,b,c){return RegExp("chart","i").test(c.workArea)&&a.worksheetHitInfo&&a.worksheetHitInfo.floatingObjectHitInfo&&a.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"2"===a.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},shape:function(a,b,c){return RegExp("shape","i").test(c.workArea)&&a.worksheetHitInfo&&a.worksheetHitInfo.shapeHitInfo},table:function(a,b,c){var d=g.UCJ(b),e=d&&d.tables;return RegExp("table","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&!a.worksheetHitInfo.floatingObjectHitInfo&&!a.worksheetHitInfo.shapeHitInfo&&!a.worksheetHitInfo.pivotTableInfo&&!a.worksheetHitInfo.commentHitInfo&&e&&e.wKb()},vpWithoutTb:function(a,b,c){if(RegExp("vpWithoutTb","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&!a.worksheetHitInfo.floatingObjectHitInfo&&!a.worksheetHitInfo.shapeHitInfo&&!a.worksheetHitInfo.pivotTableInfo&&!a.worksheetHitInfo.commentHitInfo){var d=g.UCJ(b),e=d.tables,f=e&&e.wKb();return!f&&rc(b,c)&&sc(b,c)&&vc(b,c)&&yc(b,c)}},pivotTablePageFilterArea:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotPageFilter","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo&&0===a.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableCornerArea:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotTopLeft","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo&&1===a.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableEmptyLabelArea:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotEmptyLabel","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo&&3===a.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableHeaderArea:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotHeader","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo&&2===a.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableGrandTotalArea:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotGrandTotal","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo&&5===a.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTableContentArea:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotContent","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo&&4===a.worksheetHitInfo.pivotTableCellInfo.menuArea},pivotTable:function(a,b,c){var d=g.UCJ(b),e=d&&d.pivotTables;return RegExp("pivotTable","i").test(c.workArea)&&a.worksheetHitInfo&&3===a.worksheetHitInfo.hitTestType&&e&&a.worksheetHitInfo.pivotTableCellInfo}},kc=[];function mc(a){var b,c;if(a.slicers){if(b=a.slicers.all(),!b||k(b))return null;for(c in b)if(b[c].isSelected())return!0;return!1}}function nc(a,b,c){var d,e,f,g,h=b===ec?"rowCount":"colCount";for(d=0;d<a.length;d++)for(e=a[d],f=e[b]===-1?0:e[b],g=0;g<e[h];g++)c(f+g)}function oc(a,b){var c=[],d=-1,e;for(e=a.row;e<a.row+a.rowCount;e++)b[e]!==!1&&d===-1&&(d=e),b[e]===!1&&d!==-1&&(c.push([d,e-d]),d=-1);return d!==-1&&c.push([d,e-d]),c}function pc(a,b){var c,d,e,f;if(1===b.colCount&&b.row===-1){if(c=b.col,c===a.$q()&&(d=c-1,d>=0&&!a.getColumnVisible(d)))return!0}else if(1===b.rowCount&&b.col===-1&&(e=b.row,e===a.ar()&&(f=e-1,f>=0&&!a.getRowVisible(f))))return!0}function qc(a){var b,c,d;if(a.slicers){if(b=a.slicers.all(),!b||k(b))return null;c=[];for(d in b)b[d].isSelected()&&c.push(b[d]);return c}}function rc(a,b){var c,d=b.name,e=b.group;if([n+Db,n+Cb,n+xb].indexOf(d)<0&&n+xb!==e)return!0;if(c=g.UCJ(a),c&&c.ODJ&&(n+xb===d||n+xb===e))return!1;switch(d){case n+Ab:case n+yb:case n+Fb:case n+zb:case n+Eb:if(c&&c.tu().G4===!0)return!1}return!0}function sc(a,b){if([n+vb].indexOf(b.name)<0)return!0;var c=g.UCJ(a);return!c||!c.ODJ}function tc(a,b){if([n+sb,n+ub,n+rb,n+tb].indexOf(b.name)<0)return!0;var c=g.UCJ(a);return!c||!c.ODJ}function uc(a,b){var c,d=b.name;return[n+hb,n+La,n+Ma,n+Ka].indexOf(d)<0||(c=g.UCJ(a),!c||!c.ODJ||d!==n+Ma&&d!==n+Ka)}function vc(a,b){var c,d,e,f,h,i,j,k=[n+mb,n+Ha,n+Fa,n+Ga],l=b.name;if(k.indexOf(l)<0)return!0;if(c=g.UCJ(a),d=c.getActiveRowIndex(),e=c.getActiveColumnIndex(),c&&c.comments){if(f=c.comments.get(d,e))return l!==n+mb;if(l===n+Ha||l===n+Fa)return!1;if(l===n+mb)return!0;for(h=c.getSelections(),i=0;i<h.length;i++)if(j=h[i],xc(j,c))return!0;return!1}}function wc(a,b){var c,d,e,f,g,h;if(b.comments)for(c=b.comments.all(),d=void 0,e=void 0,f=0;f<a.length;f++)for(g=a[f],h=0;h<c.length;h++)if(!c[h].locked()&&(e=c[h].nT,d=c[h].oT,e>=g.row&&e<g.row+g.rowCount&&d>=g.col&&d<g.col+g.colCount))return!0;return!1}function xc(a,b){var c,d,e,f;if(b.comments)for(c=b.comments.all(),d=void 0,e=void 0,f=0;f<c.length;f++)if(e=c[f].nT,d=c[f].oT,e>=a.row&&e<a.row+a.rowCount&&d>=a.col&&d<a.col+a.colCount)return!0;return!1}function yc(a,b){var c,d,e,f,h;return[n+kb,n+lb].indexOf(b.name)<0||(c=g.UCJ(a),(!c||!c.ODJ)&&(d=c.getSelections(),!(!d||1!==d.length)&&(e=d[0],f=Hc(c,e),!(f&&(h=f.range(),e.row<h.row||e.col<h.col||e.row+e.rowCount>h.row+h.rowCount||e.col+e.colCount>h.col+h.colCount)))))}function zc(a,b){var c,d;return[n+Vb].indexOf(b.name)<0||(c=g.UCJ(a),d=c&&c.tu(),d&&!d.G4&&d.n5&&1===d.n5.length&&1===c.getSelections().length&&Bc(c))}function Ac(a,b){var c,d;return[n+Wb].indexOf(b.name)<0||(c=g.UCJ(a),d=c&&c.tu(),d&&d.G4&&d.n5&&1===d.n5.length&&1===c.getSelections().length&&Bc(c))}function Bc(a){var b,c,d,e,f,g;if(a.ODJ)return!1;if(b=a.getActiveRowIndex(),c=a.getActiveColumnIndex(),d=a.tu(),!d.YHb)return!1;if(a.tables&&a.tables.find(b,c))return!1;for(e=a.ITa.getSpans(),f=0;f<e.length;f++)if(g=e[f],b>=g.row&&b<g.row+g.rowCount&&c>=g.col&&c<g.col+g.colCount)return!1;return!0}function Cc(a,b){var c,d,e,f,h,i=g.UCJ(a),j=[n+t+Pa,n+t+Qa].indexOf(b.name),k=[n+t+Ta,n+t+Ra,n+t+Sa,n+t+Ua,n+t+Va,n+t+Wa].indexOf(b.name),l=j>-1,m=k>-1;return i&&i.ODJ&&(c=i.ODJ,l||m)?(d=c.u7J(),d&&(e=c.options.menuItemVisibility,f=[e.promoteMenuItemVisible,e.demoteMenuItemVisible],h=[e.addAboveMenuItemVisible,e.addAfterMenuItemVisible,e.addBeforeMenuItemVisible,e.addBelowMenuItemVisible,e.moveUpMenuItemVisible,e.moveDownMenuItemVisible],d=l&&f[j],!d&&c.C7J()&&(d=m&&h[k])),d):!(l||m)}function Dc(a,b,c){var d,e,f,h,i,j=g.UCJ(a),k=9,l=n+s,m=[Xa,Ya].map(function(a){return l+a}).indexOf(b.name),o=Ec(k,function(a){return l+Za+(a+1)}).indexOf(b.name),p=m>-1,q=o>-1;return j&&j.ODJ&&(d=j.ODJ,d.u7J()&&(q||p))?(e=d.options.menuItemVisibility,f=[e.expandAllLevelMenuItemVisible,e.collapseAllLevelMenuItemVisible],q?(h=c.ZL=c.ZL?c.ZL:d.x7J()+1,i=parseInt(b.name.charAt((l+Za).length),10),i<=Math.min(k,h)&&e.expandToLevelMenuItemVisible):p&&f[m]):!(q||p)}function Ec(a,b){var c,d=[];for(c=0;c<a;c++)d.push(b(c,d));return d}function Fc(a,b){var c,d,e,f,h,i,j,k;if([n+t+Vb,n+t+Wb].indexOf(b.name)<0)return!0;if(c=g.UCJ(a),c&&c.ODJ)return!1;if(d=c.tu(),e=c.getActiveRowIndex(),c.tables)for(f=c.tables.all(),h=0;h<f.length;h++)if(i=f[h],e>i.cj&&e<i.cj+i.Xj)return!1;for(j=c.ITa.getSpans(),h=0;h<j.length;h++)if(k=j[h],e>k.row&&e<k.row+k.rowCount)return!1;if(!d.YHb||d.n5&&1!==d.n5.length||1!==c.getSelections().length)return!1;if(b.name===n+t+Wb){if(d.G4&&d.n5&&c.getColumnCount()%d.n5[0].colCount===0)return!0}else if(b.name===n+t+Vb&&!d.G4&&d.n5&&c.getColumnCount()%d.n5[0].colCount===0)return!0;return!1}function Gc(a,b){var c,d,e,f,h,i,j,k;if([n+s+Vb,n+s+Wb].indexOf(b.name)<0)return!0;if(c=g.UCJ(a),c&&c.ODJ)return!1;if(d=c.tu(),e=c.getActiveColumnIndex(),c.tables)for(f=c.tables.all(),h=0;h<f.length;h++)if(i=f[h],e>i.dj&&e<i.dj+i.OZ)return!1;for(j=c.ITa.getSpans(),h=0;h<j.length;h++)if(k=j[h],e>k.col&&e<k.col+k.colCount)return!1;if(!d.YHb||d.n5&&1!==d.n5.length||1!==c.getSelections().length)return!1;if(b.name===n+s+Vb){if(!d.G4&&d.n5&&c.getRowCount()%d.n5[0].rowCount===0)return!0}else if(b.name===n+s+Wb&&d.G4&&d.n5&&c.getRowCount()%d.n5[0].rowCount===0)return!0;return!1}function Hc(a,b){var c,d,e;if(!b)return null;for(g.Ul.FLJ(b,a.getRowCount(),a.getColumnCount()),c=b.row;c<b.row+b.rowCount;c++)for(d=b.col;d<b.col+b.colCount;d++)if(a.tables&&(e=a.tables.find(c,d)))return e;return null}function Ic(a,b,c,d){var e,f;for(e=0;e<b.length;e++)f=b[e],f.UIb(c,d,!0,gc,f.xKb())}function Jc(a){var b,c,d,e=a;for(b=0;b<e.length-1;b++)for(c=b+1;c<e.length;c++)e[b].row<e[c].row&&(d=e[b],e[b]=e[c],e[c]=d);return e}function Kc(a){var b,c,d,e=a;for(b=0;b<e.length-1;b++)for(c=b+1;c<e.length;c++)e[b].col<e[c].col&&(d=e[b],e[b]=e[c],e[c]=d);return e}function Lc(a,b,c,d){var e=a.ITa.getSpans(gc,3);b>=0?(Nc(a,e,b,d,3),Nc(a,a.ITa.getSpans(gc,2),b,d,2)):c>=0&&(Mc(a,e,c,d,3),Mc(a,a.ITa.getSpans(gc,1),c,d,1))}function Mc(a,b,c,d,e){var f,g,h,i,j,k,l,m;for(f=0,g=b.length;f<g;f++)if(h=b[f],c>h.col&&c<h.col+h.colCount)for(i=a.getStyle(h.row,h.col,e),j=c;j<c+d;j++)for(k=h.row;k<h.row+h.rowCount;k++)a.setStyle(k,j,i,e),k===h.row+h.rowCount-1&&(l=a.getCell(h.row+h.rowCount-1,h.col),m=l.borderBottom(),m&&a.getCell(k,j).borderBottom(m))}function Nc(a,b,c,d,e){var f,g,h,i,j,k,l,m;for(f=0,g=b.length;f<g;f++)if(h=b[f],c>=h.row&&c<=h.row+h.rowCount)for(i=a.getStyle(h.row,h.col,e),j=c;j<c+d;j++)for(k=h.col;k<h.col+h.colCount;k++)a.setStyle(j,k,i,e),k===h.col+h.colCount-1&&(l=a.getCell(h.row,h.col+h.colCount-1),m=l.borderRight(),m&&a.getCell(j,k).borderRight(m))}function Oc(a,b,c,d,e,f){var h,i,j,k,l,m,n=g.VCJ(a,b.sheetName);return!!n&&(h=b.considerAllSheets,i=a.LVJ(),n.suspendPaint(),j=g.Commands.bWa(n.name()),c?(l=void 0,e&&(l=e(n,b)),l&&l.cancel||(h?g.Commands._xb(i,b):n.ITa.undo(b[j]),f&&f(n,b,l))):(h?g.Commands.Zxb(i):n.ITa.startTransaction(),k=d(n,b),h?g.Commands.$xb(i,b):b[j]=n.ITa.endTransaction()),n.resumePaint(),h&&(m=g.UCJ(a),m&&n!==m&&m.repaint()),k)}function Pc(a,b,c){var d;if(c>0){for(d=b+1;d<a.getRowCount();d++)if(c-=a.getRowHeight(d),c<=0)return d-b}else if(c<0)for(d=b-1;d>=0;d--)if(c+=a.getRowHeight(d),c>=0)return d-b;return 0}function Qc(a,b,c){var d;if(c>0){for(d=b+1;d<a.getColumnCount();d++)if(c-=a.getColumnWidth(d),c<=0)return d-b}else if(c<0)for(d=b-1;d>=0;d--)if(c+=a.getColumnWidth(d),c>=0)return d-b;return 0}function Rc(a,b,c,d){var e=g.VCJ(a,b.sheetName);e&&c.execute({cmd:wb,sheetName:e.name(),pasteOption:d})}function Sc(a,b,c,d){return Oc(a,b,c,function(c){var e,f=qc(c);if(f&&0!==f.length){for(e in f)f.hasOwnProperty(e)&&f[e].sortState(d);a.changeSelectionInCommandExecuting(b,null,null,[],f)}})}function Tc(a){a.Os(8,ic().hideSheetFailureInfo)}function Uc(a,b){var c=b.name(),d=a.getSheetIndex(c),e={sheetName:c,propertyName:"isVisible",cancel:!1,sheetIndex:d,oldValue:!1,newValue:!0};return a.Wq(g.Events.SheetChanging,e),!e.cancel&&(b.visible(!0),void a.Wq(g.Events.SheetChanged,{sheetName:c,propertyName:"isVisible",sheetIndex:d,oldValue:!1,newValue:!0}))}function Vc(a,b,c){var d,e={oldSheet:b,newSheet:c,cancel:!1};return a.Wq(g.Events.ActiveSheetChanging,e),!e.cancel&&(d={oldValue:!0,newValue:!1,sheetName:b.name(),propertyName:"isSelected",cancel:!1,sheetIndex:a.getSheetIndex(b.name())},a.Wq(g.Events.SheetChanging,d),!d.cancel&&(d={oldValue:!1,newValue:!0,sheetName:c.name(),propertyName:"isSelected",cancel:!1,sheetIndex:a.getSheetIndex(c.name())},a.Wq(g.Events.SheetChanging,d),!d.cancel&&void 0))}function Wc(a,b){var c,d=g.UCJ(a);a.Wq(g.Events.ActiveSheetChanged,{oldSheet:b,newSheet:d}),c={oldValue:!0,newValue:!1,sheetName:b.name(),propertyName:"isSelected",sheetIndex:a.getSheetIndex(b.name())},a.Wq(g.Events.SheetChanged,c),c={oldValue:!1,newValue:!0,sheetName:d.name(),propertyName:"isSelected",sheetIndex:a.getSheetIndex(d.name())},a.Wq(g.Events.SheetChanged,c)}lc=function(){function a(){var a=this;a.menuView=new f.MenuView,a.menuData=a.BRJ()}return a.prototype.BRJ=function(){return[{text:ic().copy,name:n+Db,command:m+Db,iconClass:o+Db,workArea:r+s+t+u+x+P+v},{text:ic().cut,name:n+Cb,command:m+Cb,iconClass:o+Cb,workArea:r+s+t+u+x+v},{text:ic().pasteOptions,name:n+xb,iconClass:o+xb,type:Hb,workArea:r+s+t+u+x+v},{command:m+Bb,name:n+Bb,iconClass:o+Bb,group:n+xb,text:ic().pasteAll,workArea:r+s+t+u+x+v},{command:m+Ab,name:n+Ab,iconClass:o+Ab,group:n+xb,text:ic().pasteFormula,workArea:r+s+t+x},{command:m+zb,name:n+zb,iconClass:o+zb,group:n+xb,text:ic().pasteValues,workArea:r+s+t+x},{command:m+yb,name:n+yb,iconClass:o+yb,group:n+xb,text:ic().pasteFormatting,workArea:r+s+t+x},{command:m+Eb,name:n+Eb,iconClass:o+Eb,group:n+xb,text:ic().pasteValuesFormatting,workArea:r+s+t+x},{command:m+Fb,name:n+Fb,iconClass:o+Fb,group:n+xb,text:ic().pasteFormulaFormatting,workArea:r+s+t+x},{text:ic().paste,name:n+wb,command:m+zb,iconClass:o+xb,workArea:r+s+t+x},{type:Gb},{text:ic().pinRows,name:n+Na,command:m+Na,workArea:t},{text:ic().pinColumns,name:n+Oa,command:m+Oa,workArea:s},{type:Gb},{text:ic().promote,name:n+t+Pa,command:m+Pa,workArea:t},{text:ic().demote,name:n+t+Qa,command:m+Qa,workArea:t},{type:Gb},{text:ic().moveUp,name:n+t+Va,command:m+Va,workArea:t},{text:ic().moveDown,name:n+t+Wa,command:m+Wa,workArea:t},{type:Gb},{text:ic().addAfter,name:n+t+Ra,command:m+Ra,workArea:t},{text:ic().addBefore,name:n+t+Sa,command:m+Sa,workArea:t},{text:ic().addAbove,name:n+t+Ta,command:m+Ta,workArea:t},{text:ic().addBelow,name:n+t+Ua,command:m+Ua,workArea:t},{type:Gb},{text:ic().expandAllLevels,name:n+s+Xa,command:m+Xa,workArea:s},{text:ic().collapseAllLevels,name:n+s+Ya,command:m+Ya,workArea:s},{text:ic().expandLevel1,name:n+s+$a,command:m+$a,workArea:s},{text:ic().expandLevel2,name:n+s+_a,command:m+_a,workArea:s},{text:ic().expandLevel3,name:n+s+ab,command:m+ab,workArea:s},{text:ic().expandLevel4,name:n+s+bb,command:m+bb,workArea:s},{text:ic().expandLevel5,name:n+s+cb,command:m+cb,workArea:s},{text:ic().expandLevel6,name:n+s+db,command:m+db,workArea:s},{text:ic().expandLevel7,name:n+s+eb,command:m+eb,workArea:s},{text:ic().expandLevel8,name:n+s+fb,command:m+fb,workArea:s},{text:ic().expandLevel9,name:n+s+gb,command:m+gb,workArea:s},{type:Gb},{text:ic().clearContents,command:m+vb,name:n+vb,workArea:r+s+t+x},{type:Gb},{text:ic().headerInsertCopiedCells,name:n+t+Vb,command:m+t+Vb,workArea:t},{text:ic().headerInsertCutCells,name:n+t+Wb,command:m+t+Wb,workArea:t},{text:ic().headerInsertCopiedCells,name:n+s+Vb,command:m+s+Vb,workArea:s},{text:ic().headerInsertCutCells,name:n+s+Wb,command:m+s+Wb,workArea:s},{text:ic().insertCopiedCells,name:n+Vb,subMenu:[{text:ic().shiftCellsRight,name:n+Vb+Yb,command:m+Vb+Yb,iconClass:o+Yb},{text:ic().shiftCellsDown,name:n+Vb+Xb,command:m+Vb+Xb,iconClass:o+Xb}],workArea:r},{text:ic().insertCutCells,name:n+Wb,subMenu:[{text:ic().shiftCellsRight,name:n+Wb+Yb,command:m+Wb+Yb,iconClass:o+Yb},{text:ic().shiftCellsDown,name:n+Wb+Xb,command:m+Wb+Xb,iconClass:o+Xb}],workArea:r},{text:ic().insertRows,name:n+rb,command:m+rb,workArea:t},{text:ic().insertColumns,name:n+sb,command:m+sb,workArea:s},{text:ic().deleteRows,name:n+tb,command:m+tb,workArea:t},{text:ic().deleteColumns,name:n+ub,command:m+ub,workArea:s},{type:Gb},{text:ic().tableInsert,name:n+Lb,subMenu:[{text:ic().tableInsertColumnsLeft,name:n+Pb,command:bc,iconClass:o+Pb},{text:ic().tableInsertColumnsRight,name:n+Qb,command:cc,iconClass:o+Qb},{text:ic().tableInsertRowsAbove,name:n+Nb,command:$b,iconClass:o+Nb},{text:ic().tableInsertRowsBelow,name:n+Ob,command:_b,iconClass:o+Ob}],workArea:Kb},{text:ic().tableDelete,name:n+Mb,subMenu:[{text:ic().tableDeleteColumns,name:n+Ub,command:dc,iconClass:o+Ub},{text:ic().tableDeleteRows,name:n+Tb,command:ac,iconClass:o+Tb}],workArea:Kb},{type:Gb},{text:ic().insertSheet,name:n+qb,command:m+qb,workArea:w},{text:ic().deleteSheet,name:n+nb,command:m+nb,workArea:w},{type:Gb},{text:ic().filter,name:n+lb,command:m+lb,workArea:r+x},{text:ic().sort,name:n+kb,subMenu:[{text:ic().sortAscend,name:n+ib,command:m+ib,iconClass:o+ib},{text:ic().sortDescend,name:n+jb,command:m+jb,iconClass:o+jb}],workArea:r+x},{text:ic().slicerSortAscend,name:n+Ib,command:m+Ib,iconClass:o+ib,workArea:u},{text:ic().slicerSortDescend,name:n+Jb,command:m+Jb,iconClass:o+jb,workArea:u},{type:Gb},{text:ic().insertComment,name:n+mb,command:m+mb,iconClass:o+mb,workArea:r+x},{text:ic().editComment,name:n+Ha,command:m+Ha,iconClass:o+Ha,workArea:r+x},{text:ic().deleteComment,name:n+Ga,command:m+Ga,iconClass:o+Ga,workArea:r+x},{text:ic().toggleComment,name:n+Fa,command:m+Fa,workArea:r+x},{type:Gb},{text:ic().hideRows,name:n+Ma,command:m+Ma,workArea:t},{text:ic().unhideRows,name:n+Ka,command:m+Ka,workArea:t},{text:ic().hideColumns,name:n+hb,command:m+hb,workArea:s},{text:ic().unhideColumns,name:n+La,command:m+La,workArea:s},{type:Gb},{text:ic().hideSheet,name:n+Ja,command:m+Ja,workArea:w},{text:ic().unhideSheet,name:n+Ia,command:m+Ia,workArea:w},{type:Gb},{text:ic().removeSlicer,name:n+Ea,command:m+Ea,workArea:u+v},{type:Gb},{text:ic().sort,name:n+kb,subMenu:[{text:ic().sortAscend,name:n+ib,command:Da,iconClass:o+ib,commandOptions:{subType:0},placeholder:F},{text:ic().sortDescend,name:n+jb,command:Da,iconClass:o+jb,commandOptions:{subType:1},placeholder:F}],workArea:A},{text:ic().pivotTableRefresh,name:p+N,command:N,iconClass:o+N,workArea:y+z+C+A+D+B},{text:ic().pivotTableRemove_,name:p+O,command:O,iconClass:o+O,workArea:y+z+C+A,placeholder:E},{text:ic().pivotTableRemoveGrandTotal,name:p+Q,command:Q,workArea:D},{text:ic().pivotTableSummarizeValuesBy,name:p+G,subMenu:[{text:ic().pivotTableSum,name:n+S,command:T,commandOptions:{subTotalType:8}},{text:ic().pivotTableCount,name:n+U,command:T,commandOptions:{subTotalType:1}},{text:ic().pivotTableAverage,name:n+V,command:T,commandOptions:{subTotalType:0}},{text:ic().pivotTableMax,name:n+W,command:T,commandOptions:{subTotalType:3}},{text:ic().pivotTableMin,name:n+X,command:T,commandOptions:{subTotalType:4}},{text:ic().pivotTableProduct,name:n+Y,command:T,commandOptions:{subTotalType:5}}],workArea:z+C+D},{text:ic().pivotTableShowValueAs,name:p+L,subMenu:[{text:ic().pivotTableNoCalculation,name:n+Z,command:T,commandOptions:{showValueAsType:0}},{text:ic().pivotTableGrandTotal,name:n+$,command:T,commandOptions:{showValueAsType:1}},{text:ic().pivotTableColumnTotal,name:n+_,command:T,commandOptions:{showValueAsType:3}},{text:ic().pivotTableRowTotal,name:n+aa,command:T,commandOptions:{showValueAsType:2}},{text:ic().pivotTableOf,name:n+ba,command:Aa,commandOptions:{showValueAsType:4}},{text:ic().pivotTableParentRowTotal,name:n+ca,command:T,commandOptions:{showValueAsType:5}},{text:ic().pivotTableParentColumnTotal,name:n+ja,command:T,commandOptions:{showValueAsType:6}},{text:ic().pivotTableOfParentTotal,name:n+ia,command:Aa,commandOptions:{showValueAsType:7}},{text:ic().pivotTableDifferenceFrom,name:n+da,command:Aa,commandOptions:{showValueAsType:8}},{text:ic().pivotTablePercentDifferenceFrom,name:n+ea,command:Aa,commandOptions:{showValueAsType:9}},{text:ic().pivotTableRunningTotalIN,name:n+fa,command:Aa,commandOptions:{showValueAsType:10}},{text:ic().pivotTablePercentRunningTotalIn,name:n+ga,command:Aa,commandOptions:{showValueAsType:11}},{text:ic().pivotTableRankSmallestToLargest,name:n+ha,command:Aa,commandOptions:{showValueAsType:12}},{text:ic().pivotTableRankLargestToSmallest,name:n+ka,command:Aa,commandOptions:{showValueAsType:13}},{text:ic().pivotTableIndex,name:n+la,command:T,commandOptions:{showValueAsType:14}}],workArea:z+C},{text:ic().pivotTableFilter,name:p+na,iconClass:o+na,subMenu:[{text:ic().pivotTableClearFilterFrom_,name:n+oa,command:Ca,iconClass:o+oa,placeholder:E,commandOptions:{clearType:0}},{text:ic().pivotTableKeepOnlySelectedItems,name:n+pa,command:Ba,commandOptions:{subType:1}},{text:ic().pivotTableHideSelectedItems,name:n+qa,command:Ba,commandOptions:{subType:2}},{text:ic().pivotTableTop10,name:n+ra,command:ya,commandOptions:{isTop10:!0}},{text:ic().pivotTableLabelFilters,name:n+sa,command:za},{text:ic().pivotTableValueFilters,name:n+ta,command:ya}],workArea:A},{text:ic().pivotTableExpandOrCollapse,name:p+H,subMenu:[{text:ic().pivotTableExpand,name:n+ua,command:ua,iconClass:o+ua},{text:ic().pivotTableCollapse,name:n+va,command:va,iconClass:o+va},{text:ic().pivotTableExpandEntireField,name:n+wa,command:wa,iconClass:o+wa},{text:ic().pivotTableCollapseEntireField,name:n+xa,command:xa,iconClass:o+xa}],workArea:A},{text:ic().pivotTableGroup,name:p+I,command:J,iconClass:o+I,workArea:A},{text:ic().pivotTableUnGroup,name:p+K,command:K,iconClass:o+K,workArea:A},{text:ic().pivotTableShowDetails,name:p+M,command:M,iconClass:o+M,workArea:C},{text:ic().pivotTableValueFieldSettings,name:p+R,command:R,iconClass:o+R,workArea:z+C+D}]},a.prototype.ad=function(a){var b=this;b.Mma||(b.wu=a.commandManager(),j(b.Ela)&&(b.Ela=new e.ContextMenuViewDialog(a.pZJ(),i(a.sv))),b.nla(a),b.kTa={filter:{menuDataDict:[n+lb],checkFunction:function(a){if(a&&a.rowFilter)return!0}},comments:{menuDataDict:[n+mb,n+Ha,n+Ga,n+Fa],checkFunction:function(a){if(a&&a.comments)return!0}},slicer:{menuDataDict:[n+Ib,n+Jb,n+Ea],checkFunction:function(a){if(a&&a.slicers)return!0}},floatingObject:{menuDataDict:[n+zb,n+yb,n+Ab],checkFunction:function(a){var b,c,d;return!a||!a.BR||(b=a.BR(),c=b.fromSheet,d=c&&c.CR,!d||void 0)}},table:{menuDataDict:[n+Lb,n+Mb],checkFunction:function(a){if(a&&a.tables)return!0}},tableSheet:{menuDataDict:[n+wb,n+Na,n+Oa,n+Pa,n+Qa,n+Ta,n+Ra,n+Sa,n+Ua,n+Va,n+Wa,n+Xa,n+Ya,n+$a,n+_a,n+ab,n+bb,n+cb,n+db,n+eb,n+fb,n+gb],checkFunction:function(a){if(a&&a.ODJ)return!0}}},b.Mma=!0)},a.prototype.ola=function(a,b){var c,d,e,f,h,i,k,m,n=this;return b.focus(),c=n.pla(a,b),j(c)?void l(a):(d=g.UCJ(b),void(d&&(e={row:d.getActiveRowIndex(),col:d.getActiveColumnIndex()},d.isEditing()&&c.worksheetHitInfo&&c.worksheetHitInfo.col===e.col&&c.worksheetHitInfo.row===e.row||b.getTab()&&b.getTab().FD)||(n.ad(b),n.qla(c,b),d=g.UCJ(b),d&&(f=d.getSelections()[0],j(f)||j(d.pivotTables)||(h=d.pivotTables.findPivotTable(f.row,f.col),!j(h)&&c.worksheetHitInfo&&(c.worksheetHitInfo.pivotTableInfo=h,i=h.getPivotInfoImp(f.row,f.col,!1,!1,!0),j(i)||(c.worksheetHitInfo.pivotTableCellInfo=i)))),k=n.Fla(n.menuData,c,b),m=n.onOpenMenu(n.menuData,k,c,b),m||(l(a),k.length&&n.jla(k,c,b),n.onMenuOpened()))))},a.prototype.qla=function(a,b){var c=this;c.Ela.Loa(a)&&c.sla(a,b)},a.prototype.sla=function(a,b){var c=this,d=g.UCJ(b);d&&d.isEditing()&&d.endEdit(),c.tla(a)?c.ula(a,b):c.vla(a)&&c.wla(a,b)},a.prototype.vla=function(a){return!!a.worksheetHitInfo},a.prototype.xla=function(a,b,c,d){var e=!0,f,g;if(1===d){for(f=0;f<a.length;f++)g=a[f],g.row===-1&&c>=g.col&&c<g.col+g.colCount&&(e=!1);return e}if(2===d){for(f=0;f<a.length;f++)g=a[f],g.col===-1&&b>=g.row&&b<g.row+g.rowCount&&(e=!1);return e}for(f=0;f<a.length;f++)if(g=a[f],g.contains(b,c))return!1;return!0},a.prototype.tla=function(a){return!(!a.tabStripHitInfo||!a.tabStripHitInfo.sheetTab)},a.prototype.yla=function(a){return a.tabStripHitInfo.sheetTab.sheetName},a.prototype.iDJ=function(a){return a.tabStripHitInfo.sheetTab.sheetIndex},a.prototype.wla=function(a,b){var c=this,d=g.UCJ(b),e=a.worksheetHitInfo;
e.floatingObjectHitInfo||e.commentHitInfo||e.shapeHitInfo||(c.Ala(d,e),c.aPa(d))},a.prototype.aPa=function(a){var b,c=a.getActiveRowIndex(),d=a.getActiveColumnIndex(),e=a.comments;e&&(b=e.get(c,d),b&&e.bU===b&&e.hT(b))},a.prototype.zla=function(a){return 3===a.hitTestType},a.prototype.cs=function(a,b,c){a.cs&&a.cs(b,c)},a.prototype.Ala=function(a,b){var c,d,e,f,g=this,h=a.ITa.getSelections(),i=b.row,j=b.col;a.Qs(b.rowViewportIndex<0?-1:b.row,b.colViewportIndex<0?-1:b.col)&&(c=!1,g.xla(h,i,j,b.hitTestType)?c=!0:(d=a.shapes&&a.shapes.all()||[],e=d.filter(function(a){return a.isSelected()}),e.length>0&&(e.forEach(function(a){return a.isSelected(!1)}),c=!0)),c&&(f=a.mm,f.Ala(a,b,i,j),f.hH()))},a.prototype.ula=function(a,b){var c,d=this.iDJ(a),e=b.ACJ(d);e&&(e.HHb()||(c=b.xCJ(),c.forEach(function(a){a.HHb()&&a.HHb(!1,!0)}),e.HHb(!0,!0)),b.BCJ(d,2,!1,!0),this.$Oa(this.menuData,a,b))},a.prototype.pla=function(a,b){var c=b.oia(),d=a.pageX-c.left,e=a.pageY-c.top;return d=d>=0?d:1,e=e>=0?e:1,b.hitTest(d,e,!0)},a.prototype.onOpenMenu=function(a,b,c,d){},a.prototype.onMenuOpened=function(){},a.prototype.jla=function(a,b,c){var d=this;d.Ela.Loa(b)&&(d.Cla(),c.xw(),d.Dla(a,b,c))},a.prototype.Cla=function(){this.Ela.close()},a.prototype.Dla=function(a,b,c){var d=this,e=c.uXJ(),f=b.x,g=b.y;f-=e.left,g-=e.top,d.Ela.OT(d.menuView,a,f,g,c)},a.prototype.Fla=function(a,b,c){var d,e=this,f={};return i.extend(!0,f,a),d=e.I8J(f,b,c),e.J$a(d,b),e.lTa(d,c),e.yKb(d,c),e.UZa(d,c),e.RZa(d),d=e.Bma(d),e.zKb(d),d},a.prototype.I8J=function(a,b,c){var d=this,e=[],f=Object.keys(jc);return i.each(a,function(a,g){var h,i,k,l;if(!j(g))for(g.type===Gb&&e.push(g),h=0;h<f.length;h++)if(i=f[h],k=jc[i],k(b,c,g)&&(l=d.nMc(g,b)))return void e.push(g)}),e},a.prototype.oMc=function(a,b,c){var d,e,f,g,h,i,k=c.placeholder,l=c.name,m=b.area,o=b.value,p=b.menuArea,q=b.colHeadFieldInfo,r=b.rowInfos,s=b.colInfos,t=b.cornerFieldInfo,u=b.activeRowFieldInfo,v=b.activeColFieldInfo;if(j(k))l===n+sa&&(g=u&&u.name||v&&v.name||q&&q.fieldName||t&&t.fieldName,h=a.Vyc,i=g&&h.getFieldInfoByName(g)&&2===h.getFieldInfoByName(g).ny,i&&(c.text=ic().pivotTableLabelFilters_Date));else if(k===E){if(d=void 0,0===p)d=b.pageFieldInfo.fieldName;else if(2===m&&2===p){if(q)d=q.fieldName;else if(d=v&&v.name,j(d)){for(e=v.index;e>=0&&s[e]&&j(s[e].itemName);)e-=1;d=s[e].fieldName}}else if(3===m&&2===p){if(d=u&&u.name,j(d)){for(e=u.index;e>=0&&r[e]&&j(r[e].itemName);)e-=1;d=r[e].fieldName}}else 1===m?1===p?d=b.value:2===p&&t&&(d=t.fieldName):4===p&&(d=b.valueFieldName,2===m?d=v&&v.name||o:3===m&&(d=u&&u.name||o));c.text=c.text.replace("{0}",'"'+d+'"')}else k===F&&4===p&&(d=void 0,f=c.commandOptions.subType,0===f?d=ic().pivotTableSortAscend:1===f&&(d=ic().pivotTableSortDescend),c.text=d);j(c.commandOptions)&&(c.commandOptions={}),c.commandOptions.pivotTableName=a.name(),c.commandOptions.pivotTableCellInfo=b},a.prototype.zKb=function(a){var b,c,d=0,e=!1;for(b=0;b<a.length&&(c=a[b].name,c!==n+t+Vb&&c!==n+t+Wb&&c!==n+s+Vb&&c!==n+s+Wb||(e=!0),c!==n+rb&&c!==n+sb||(d=b,!e));b++);e&&a.splice(d,1)},a.prototype.J$a=function(a,b){var c=b.worksheetHitInfo,d=c&&(c.row===gc||c.col===gc);d&&a.splice(0,a.length)},a.prototype.lTa=function(a,b){var c=this,d=g.UCJ(b),e=c.kTa;return i.each(e,function(b,e){var f,g,h;if(!e.checkFunction(d))for(f=e.menuDataDict,g=0,h=f.length;g<h;g++)c.hma(a,f[g],function(a,b){a[b]=null})}),a},a.prototype.nMc=function(a,b){var c,d,e,f,g,h,i,k,l,m,n,o,q,r,s,t=this,u=b.worksheetHitInfo&&b.worksheetHitInfo.pivotTableInfo;if(u&&(c=b.worksheetHitInfo&&b.worksheetHitInfo.pivotTableCellInfo)){if(d=u.options.subtotalsPosition,e=c.value,f=c.area,g=c.menuArea,h=c.cornerFieldInfo,i=c.colHeadFieldInfo,k=c.activeRowFieldInfo,l=c.activeColFieldInfo,m=c.rowInfos,n=c.colInfos,o=c.valueFieldName,q=[p+H,p+na,p+M],q.indexOf(a.name)>-1&&((2===f||3===f)&&4===g||(!j(h)||!j(i))&&e===ic().sigmaValueTemp||3===f&&k&&m[k.index].isSubtotal&&void 0===m[k.index].collapseIndex&&1!==d||2===f&&l&&n[l.index].isSubtotal&&void 0===n[l.index].collapseIndex&&1!==d))return!1;if(r=[p+I,p+K],r.indexOf(a.name)>-1&&(!j(h)||!j(i)))return!1;if(s=[p+R,p+O,p+G,p+L],s.indexOf(a.name)>-1&&j(o)&&4===g&&4===f)return!1;a&&a.subMenu?a.subMenu.forEach(function(a){t.oMc(u,c,a),t.J8J(u,c,a)}):t.oMc(u,c,a)}return!0},a.prototype.J8J=function(a,b,c){var d,e,f,g,h,i,k,l=b.activeRowFieldInfo,m=b.activeColFieldInfo,o=b.cornerFieldInfo,p=b.colHeadFieldInfo,r=b.valueFieldName,s=l&&l.name||m&&m.name||p&&p.fieldName||o&&o.fieldName||r,t=a.Vyc,u=s&&t.getFieldInfoByName(s),v=t.IUJ;switch(c.commandOptions&&u&&(d=c.commandOptions.showValueAsType,e=c.commandOptions.subTotalType,j(d)||(f=u.xFJ&&u.xFJ.showDataAs||0,f===d&&(c.iconClass=q)),j(e)||(g=u.getSubTotalType(),g===e&&(c.iconClass=q))),c.name){case n+oa:h=v.HL[u.Zxc],i=!1,h&&h.cyc()&&(i=!0),k=!!h&&h.dyc(),i||k||(c.disable=!0);break;case n+pa:case n+qa:j(o)&&j(p)||(c.disable=!0)}},a.prototype.yKb=function(a,b){var c,d,e,f=g.UCJ(b),h=f&&f.getSelections();h&&h.length>0&&(c=Hc(f,h[0]),d=f.getActiveRowIndex(),e=f.getActiveColumnIndex(),c&&i.each(a,function(a,b){if(!j(b)&&b.name===n+Lb){var f=b.subMenu;c.checkTableLastRow(d)&&f.splice(3,1),c.checkTableLastCol(e)&&f.splice(1,1)}}))},a.prototype.RZa=function(a){var b,c=this,d=a.length;for(b=d-1;b>=0;b--)a[b]?a[b].subMenu&&c.RZa(a[b].subMenu):a.splice(b,1);return a},a.prototype.Bma=function(a){var b,c,d,e,f,g=[],h=a.length;for(b=0;b<h;b++)a[b]&&a[b].type===Gb&&a[b+1]&&a[b+1].type===Gb||g.push(a[b]);for(h=g.length,c=0,d=0,e=!0,f=!0,b=0;b<h&&(e&&g[b].type===Gb?c++:e=!1,f&&g[h-1-b].type===Gb?d++:f=!1,e||f);b++);return g.splice(h-d,d),g.splice(0,c),g},a.prototype.UZa=function(a,b){var c=this;c.VZa(a,b),c.QZa(a,b)},a.prototype.VZa=function(a,b){var c,d=this,e=g.UCJ(b),f=e&&e.tables,h=e&&e.ODJ;for(c=0;c<a.length;c++)if(a[c]){switch(a[c].name){case n+rb:e.ZZa()||(a[c].disable=!0);break;case n+tb:(!e.ZZa()||f&&f.containTableHeaderTotalRowForSheet())&&(a[c].disable=!0);break;case n+sb:case n+ub:e.$Za()||(a[c].disable=!0);break;case n+Nb:f&&(f.isAcrossTables()||f.containTableHeader()||f.noRoomToInsertRow())&&(a[c].disable=!0);break;case n+Ob:f&&(f.isAcrossTables()||f.noRoomToInsertRow())&&(a[c].disable=!0);break;case n+Tb:f&&(f.checkTableRow()||f.isAcrossTables()||f.containTableHeaderTotalRow())&&(a[c].disable=!0);break;case n+Pb:case n+Qb:f&&(f.isAcrossTables()||f.noRoomToInsertColumn())&&(a[c].disable=!0);break;case n+Ub:f&&(f.checkTableCol()||f.isAcrossTables()||f.isWholeTableCol())&&(a[c].disable=!0);break;case n+Oa:h&&(a[c].disable=!h.enablePinColumn());break;case n+Na:h&&(a[c].disable=!h.enablePinRow())}a[c]&&a[c].subMenu&&d.VZa(a[c].subMenu,b)}},a.prototype.QZa=function(a,b){var c,d,e,f,h=this,i=g.UCJ(b),j=i&&i.options.isProtected,k=i&&i.options.protectionOptions;if(j&&k)for(c=void 0,d=0;d<a.length;d++)if(a[d]){switch(a[d].name){case n+rb:k.allowInsertRows||(a[d].disable=!0);break;case n+sb:k.allowInsertColumns||(a[d].disable=!0);break;case n+tb:k.allowDeleteRows||(a[d].disable=!0);break;case n+ub:k.allowDeleteColumns||(a[d].disable=!0);break;case n+lb:k.allowFilter||(a[d].disable=!0);break;case n+ib:case n+jb:k.allowSort||(a[d].disable=!0);break;case n+Ma:case n+Ka:case n+hb:case n+La:i.ODJ||(a[d].disable=!0);break;case n+Ib:case n+Jb:k.allowEditObjects||a.splice(0,a.length);break;case n+mb:k.allowEditObjects||(a[d]=null);break;case n+Ha:e=void 0,i.comments&&(c=i.comments.get(i.getActiveRowIndex(),i.getActiveColumnIndex()),e=c&&c.lockText()),!k.allowEditObjects&&e&&(a[d]=null);break;case n+Ga:f=void 0,i.comments&&(f=!wc(i.getSelections(),i)),!k.allowEditObjects&&f&&(a[d]=null);break;case n+Nb:case n+Ob:case n+Pb:case n+Qb:case n+Tb:case n+Ub:a[d].disable=!0}a[d]&&a[d].subMenu&&h.QZa(a[d].subMenu,b)}},a.prototype.$Oa=function(a,b,c){var d,e,f,h;if(b.tabStripHitInfo&&(d=this,e=c.xCJ(),f=d.RS(n+Ia))){for(h=0;h<e.length;h++)if(e[h].visible()===g.SheetTabVisible.hidden)return void(f.disable=!1);f.disable=!0}},a.prototype.RS=function(a){var b=this;return b.gma(b.menuData,a)},a.prototype.gma=function(a,b){var c,d=this;return d.hma(a,b,function(a,b){c=a[b]}),c},a.prototype.hma=function(a,b,c){for(var d=this,e=a.length,f=0;f<e;f++)if(!j(a[f])){if(b===a[f].name)return void c(a,f);a[f].subMenu&&d.hma(a[f].subMenu,b,c)}},a.prototype.CRJ=function(a,b){for(var c,d=this,e=a.length,f=0;f<e;f++)c=a[f],j(c)||(b(c),c.subMenu&&d.CRJ(c.subMenu,b))},a.prototype.nla=function(a){var b,c,d,e,f,h,i,l,n,o,p,q,r,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa;function ba(a,b,c){var d,e;for(d=0;d<c;d++)e=b+d,a.indexOf(e)===-1&&a.push(e);return a}this.p5J||(b=a.commandManager(),c={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&(mc(d)?b.execute({cmd:"copyFloatingObjects",sheetName:d.name()}):b.execute({cmd:Db,sheetName:d.name(),ignoreClipboard:!0}))}},b.register(m+Db,c,null,!1,!1,!1,!1),d={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&(mc(d)?b.execute({cmd:"cutFloatingObjects",sheetName:d.name()}):b.execute({cmd:Cb,sheetName:d.name(),ignoreClipboard:!0}))}},b.register(m+Cb,d,null,!1,!1,!1,!1),e={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&(d.isPasteFloatingObject&&d.isPasteFloatingObject()?b.execute({cmd:"pasteFloatingObjects",sheetName:d.name()}):d.isPasteShapes&&d.isPasteShapes()?b.execute({cmd:"pasteShapes",sheetName:d.name()}):b.execute({cmd:wb,sheetName:d.name(),pasteOption:0}))}},b.register(m+Bb,e,null,!1,!1,!1,!1),f={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&b.execute({cmd:wb,sheetName:d.name(),pasteOption:0,shiftCells:g.InsertShiftCell.right})}},b.register(m+Vb+Yb,f,null,!1,!1,!1,!1),b.register(m+Wb+Yb,f,null,!1,!1,!1,!1),b.register(m+s+Vb,f,null,!1,!1,!1,!1),b.register(m+s+Wb,f,null,!1,!1,!1,!1),h={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&b.execute({cmd:wb,sheetName:d.name(),pasteOption:0,shiftCells:g.InsertShiftCell.down})}},b.register(m+Vb+Xb,h,null,!1,!1,!1,!1),b.register(m+Wb+Xb,h,null,!1,!1,!1,!1),b.register(m+t+Vb,h,null,!1,!1,!1,!1),b.register(m+t+Wb,h,null,!1,!1,!1,!1),i={canUndo:!1,execute:function(a,c){var d=3;Rc(a,c,b,d)}},b.register(m+Ab,i,null,!1,!1,!1,!1),l={canUndo:!1,execute:function(a,c){var d=1;Rc(a,c,b,d)}},b.register(m+zb,l,null,!1,!1,!1,!1),n={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&b.execute({cmd:wb,sheetName:d.name(),pasteOption:2})}},b.register(m+yb,n,null,!1,!1,!1,!1),o={canUndo:!1,execute:function(a,c){var d=4;Rc(a,c,b,d)}},b.register(m+Eb,o,null,!1,!1,!1,!1),p={canUndo:!1,execute:function(a,c){var d=5;Rc(a,c,b,d)}},b.register(m+Fb,p,null,!1,!1,!1,!1),q={canUndo:!1,execute:function(a,c){var d=g.VCJ(a,c.sheetName);d&&b.execute({cmd:"clear",sheetName:d.name()})}},b.register(m+vb,q,null,!1,!1,!1,!1),r={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=c.commentState||2,r=c.displayMode,s=c.activeRow,t=c.activeCol,u=b.comments.add(s,t,"");u&&(u.commentState(q),r&&u.displayMode(r),d=b.Er(s),e=b.Fr(t),f=b.getCellRect(s,t,d,e),g=b.am(),h=g.Ft(d,e),i=u.location(),j=u.width(),k=u.height(),l=void 0,m=void 0,n=void 0,o=void 0,p=a.ku,f.y+i.y<h.y?(n=Pc(b,s,f.y+i.y-h.y),l=p.ms(b,n),p.ju(b,l.cj,0),b.os()):f.y+i.y+k>h.y+h.height&&(n=Pc(b,s,f.y+i.y+k-(h.y+h.height)),l=p.ms(b,n),p.ju(b,l.cj,0),b.os()),f.x+i.x+j>h.x+h.width&&(o=Qc(b,t,f.x+i.x+j-(h.x+h.width)),m=p.Sw(b,o),p.lu(b,m.dj,0),b.qs()))},function(a,b){var c,d=b.activeRow,e=b.activeCol,f=a.comments.get(d,e);if(f)return b.displayMode=f.displayMode(),b.commentState=f.commentState(),c={sheet:a,sheetName:a.name(),comment:f,cancel:!1},a.Wq(g.Events.CommentRemoving,c),{cancel:c.cancel,comment:f}},function(a,b,c){a.Wq(g.Events.CommentRemoved,{sheet:a,sheetName:a.name(),comment:c.comment})})}},b.register(m+mb,r,null,!1,!1,!1,!1),u={canUndo:!1,execute:function(a,b){var c,d,e,f=g.VCJ(a,b.sheetName);f&&(c=b.activeRow,d=b.activeCol,e=f.comments.get(c,d),e&&e.commentState(2,!0))}},b.register(m+Ha,u,null,!1,!1,!1,!1),v={canUndo:!0,execute:function(a,c,d){return Oc(a,c,d,function(a){var d,e,f,g,h,i=c.selections,j=i.length;if(!(j<=0))for(d=0;d<j;d++)for(e=i[d],f=e.row;f<e.row+e.rowCount;f++)for(g=e.col;g<e.col+e.colCount;g++)h=a.comments.get(f,g),!h||a.options.isProtected&&!a.options.protectionOptions.allowEditObjects&&h.locked()||b.execute({cmd:Ga,sheetName:a.name(),row:h.nT,col:h.oT})})}},b.register(m+Ga,v,null,!1,!1,!1,!1),w={canUndo:!1,execute:function(a,b){var c,d,e,f=g.VCJ(a,b.sheetName);f&&(c=b.activeRow,d=b.activeCol,e=f.comments.get(c,d),e&&(2===e.displayMode()?e.displayMode(1):e.displayMode(2)))}},b.register(m+Fa,w,null,!1,!1,!1,!1),x={canUndo:!0,execute:function(a,b,c){return b.considerAllSheets=!0,Oc(a,b,c,function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o=Jc(b.selections);for(d=0;d<o.length;d++){for(c=o[d],e=a.getRange(c.row-1,0,1,c.colCount),f=[],g=0;g<e.colCount;g++)a.getCell(e.row,g).locked()||f.push(g);for(h=c.row,i=c.rowCount,a.addRows(h,i),j=0;j<f.length;j++)for(k=o[d].row;k<o[d].row+o[d].rowCount;k++)a.getCell(k,f[j]).locked(!1);if(a.tables&&i>0)for(l=a.tables.s$(h,-1,i,-1),m=0;m<l.length;m++)n=l[m],n.UIb(h,i,!1,!1);Lc(a,h,-1,i)}})}},b.register(m+rb,x,null,!1,!1,!1,!1),y={canUndo:!0,execute:function(a,b,c){return b.considerAllSheets=!0,Oc(a,b,c,function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o=Kc(b.selections);for(d=0;d<o.length;d++){for(c=o[d],e=a.getRange(0,c.col-1,c.rowCount,1),f=[],g=0;g<e.rowCount;g++)a.getCell(g,e.col).locked()||f.push(g);for(h=c.col,i=c.colCount,a.addColumns(h,i),j=0;j<f.length;j++)for(k=h;k<h+i;k++)a.getCell(f[j],k).locked(!1);if(a.tables&&i>0)for(l=a.tables.s$(-1,h,-1,i),m=0;m<l.length;m++)n=l[m],n.VIb(h,i,!1,!1);Lc(a,-1,h,i)}})}},b.register(m+sb,y,null,!1,!1,!1,!1),z={canUndo:!0,execute:function(a,b,c){return b.considerAllSheets=!0,Oc(a,b,c,function(a){var c,d,e,f,g,h,i,j,k=Jc(b.selections),l=a.filterRowsVisibleInfo&&a.filterRowsVisibleInfo.rowsVisibleInfo,m=l&&Object.keys(l).length>0;for(c=0;c<k.length;c++)if(d=k[c],e=d.row,f=d.rowCount,g=a.getRowCount(),m)for(h=oc(d,l),i=h.length-1;i>=0;i--)e=h[i][0],f=h[i][1],j=a.tables&&a.tables.s$(e,-1,f,-1),a.deleteRows(e,f),j.length>0&&g-a.getRowCount()>0&&(g=a.getRowCount(),Ic(a,j,e,f));else j=a.tables&&a.tables.s$(e,-1,f,-1),a.deleteRows(e,f),j.length>0&&g-a.getRowCount()>0&&Ic(a,j,e,f)})}},b.register(m+tb,z,null,!1,!1,!1,!1),A={canUndo:!0,execute:function(a,b,c){return b.considerAllSheets=!0,Oc(a,b,c,function(a){var c,d,e,f,g,h,i,j=Kc(b.selections);for(c=0;c<j.length;c++)if(d=a.getColumnCount(),e=j[c].col,f=j[c].colCount,g=void 0,a.tables&&(g=a.tables.s$(-1,e,-1,f)),a.deleteColumns(e,f),a.tables&&d-a.getColumnCount()>0)for(h=0;h<g.length;h++)i=g[h],i.VIb(e,f,!0)})}},b.register(m+ub,A,null,!1,!1,!1,!1),B={canUndo:!1,execute:function(a){var b,c,d,e,f=a.getActiveSheetIndex(),h=a.getActiveSheetTabIndex(),i=[],j=g.UCJ(a);b=h>=0?a.SCJ("",g.SheetType.tableSheet):a.vv(a.wv(f)),c=a.xCJ(),c.forEach(function(a){a.HHb()&&i.push(a)}),i.forEach(function(a){a.HHb(!1,!0)}),d={sheetName:b.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:f},a.Wq(g.Events.SheetChanging,d),d.cancel||(e={oldSheet:j,newSheet:b},a.Wq(g.Events.ActiveSheetChanging,e),h>=0?a.QCJ(h,2,b):a.ow(Math.max(0,f),2,b),b.HHb(!0,!0),a.Wq(g.Events.SheetChanged,{sheetName:b.name(),propertyName:"insertSheet",sheetIndex:f}),a.Wq(g.Events.ActiveSheetChanged,{oldSheet:j,newSheet:b}))}},b.register(m+qb,B,null,!1,!1,!1,!1),C={canUndo:!1,execute:function(a,b){var c,d,e,f,h,i,k=g.UCJ(a),l=a.xCJ();l.length>1?(c=[],d=[],l.forEach(function(a,b){if(a.HHb()){var e=a.name();c.push(e),d.push(b)}}),c.length!==l.length?c.length>=1&&(e={oldSheet:k,cancel:!1},f=a.sheets,a.options&&a.options.saveChangesForSheet&&g.Commands.Zxb(f),h=[],c.forEach(function(b,c){var f,i,l=d[c],m=g.VCJ(a,b),n={sheetName:b,propertyName:"deleteSheet",cancel:!1,sheetIndex:l};m===k&&a.Wq(g.Events.ActiveSheetChanging,e),a.Wq(g.Events.SheetChanging,n),e.cancel||n.cancel||(f=a.getSheetIndex(b),!j(f)&&f>=0?(a.removeSheet(f),a.getActiveSheetIndex()===-1&&a.setActiveSheetTab(0)):(f=a.getSheetTabIndex(b),!j(f)&&f>=0&&(a.removeSheetTab(f),a.getActiveSheetTabIndex()===-1&&a.setActiveSheetIndex(0))),h.push(b),a.Wq(g.Events.SheetChanged,{sheetName:b,propertyName:"deleteSheet",sheetIndex:l}),i=g.UCJ(a),m===k&&a.Wq(g.Events.ActiveSheetChanged,{oldSheet:m,newSheet:i}))}),b.deletedSheets=h,a.options&&a.options.saveChangesForSheet&&g.Commands.$xb(f,b),i=g.UCJ(a),i&&!i.isSelected()&&i.HHb(!0,!0)):Tc(k)):Tc(k),a.undoManager().clear()}},b.register(m+nb,C,null,!1,!1,!1,!1),D={canUndo:!0,execute:function(a,c,d){return Oc(a,c,d,function(a){var d,e,f=c.selections,g=f[0],h=Hc(a,g),i=c.activeRow,j=c.activeCol;h?(d=h.range(),d.contains(i,j,1,1)&&(e=h.name(),b.execute({cmd:"contextmenuFilterForTable",sheetName:a.name(),cmdOption:{tableName:e,activeRow:i,activeCol:j,expectedText:a.getText(i,j)}}))):a.rowFilter&&b.execute({cmd:"contextmenuFilterForSheet",sheetName:a.name(),cmdOption:{activeRow:i,activeCol:j,selection:g,expectedText:a.getText(i,j)}})})}},b.register(m+lb,D,null,!1,!1,!1,!1),E={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){var c=b.activeCol,d=b.selections,e=Hc(a,d[0]),f=e?e.dataRange():d[0],h=a.kJb(f,!0,null),i={sheet:a,sheetName:a.name(),col:c,ascending:!0,range:f,compareFunction:gc,groupSort:h.groupSort,ignoreHidden:h.ignoreHidden,cancel:!1};a.Wq(g.Events.RangeSorting,i),i.cancel===!1&&(a.sortRange(f.row,f.col,f.rowCount,f.colCount,!0,[{index:c,ascending:!0,compareFunction:i.compareFunction}],{groupSort:i.groupSort,ignoreHidden:i.ignoreHidden},gc,!!e),a.Wq(g.Events.RangeSorted,i))})}},b.register(m+ib,E,null,!1,!1,!1,!1),F={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){var c=b.activeCol,d=b.selections,e=Hc(a,d[0]),f=e?e.dataRange():d[0],h=a.kJb(f,!0,null),i={sheet:a,sheetName:a.name(),col:c,ascending:!1,range:f,compareFunction:gc,groupSort:h.groupSort,ignoreHidden:h.ignoreHidden,cancel:!1};a.Wq(g.Events.RangeSorting,i),i.cancel===!1&&(a.sortRange(f.row,f.col,f.rowCount,f.colCount,!0,[{index:c,ascending:!1,compareFunction:i.compareFunction}],{groupSort:i.groupSort,ignoreHidden:i.ignoreHidden},gc,!!e),a.Wq(g.Events.RangeSorted,i))})}},b.register(m+jb,F,null,!1,!1,!1,!1),G={canUndo:!0,execute:function(a,b,c){return Sc(a,b,c,1)}},b.register(m+Ib,G,null,!1,!1,!1,!1),H={canUndo:!0,execute:function(a,b,c){return Sc(a,b,c,2)}},b.register(m+Jb,H,null,!1,!1,!1,!1),I={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){var c,d,e,f,g=b.selections;if(g.length>0){for(c=[],d=0,e=g;d<e.length;d++)f=e[d],ba(c,f.row,f.rowCount);try{a.ODJ.togglePinnedRows(c)}catch(a){return!1}}})}},b.register(m+Na,I,null,!1,!1,!1,!1),J={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){var c,d,e,f,g=b.selections;if(g.length>0){for(c=[],d=0,e=g;d<e.length;d++)f=e[d],ba(c,f.col,f.colCount);try{a.ODJ.togglePinnedColumns(c)}catch(a){return!1}}})}},b.register(m+Oa,J,null,!1,!1,!1,!1),K={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.promoteHierarchyLevel(b.activeRow)}catch(a){return!1}})}},b.register(m+Pa,K,null,!1,!1,!1,!1),L={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.demoteHierarchyLevel(b.activeRow)}catch(a){return!1}})}},b.register(m+Qa,L,null,!1,!1,!1,!1),M={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.addHierarchyItemAfter(b.activeRow)}catch(a){return!1}})}},b.register(m+Ra,M,null,!1,!1,!1,!1),N={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.addHierarchyItemBefore(b.activeRow)}catch(a){return!1}})}},b.register(m+Sa,N,null,!1,!1,!1,!1),O={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.addHierarchyItemAbove(b.activeRow)}catch(a){return!1}})}},b.register(m+Ta,O,null,!1,!1,!1,!1),P={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.addHierarchyItemBelow(b.activeRow)}catch(a){return!1}})}},b.register(m+Ua,P,null,!1,!1,!1,!1),Q={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.moveUp(b.activeRow)}catch(a){return!1}})}},b.register(m+Va,Q,null,!1,!1,!1,!1),R={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.moveDown(b.activeRow)}catch(a){return!1}})}},b.register(m+Wa,R,null,!1,!1,!1,!1),S={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.expandAllHierarchyLevels()}catch(a){return!1}})}},b.register(m+Xa,S,null,!1,!1,!1,!1),T={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{a.ODJ.collapseAllHierarchyLevels()}catch(a){return!1}})}},b.register(m+Ya,T,null,!1,!1,!1,!1),U={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(a){try{var c=parseInt(b.cmd.charAt((m+Za).length),10)-1;a.ODJ.expandHierarchyLevel(c)}catch(a){return!1}})}},Ec(9,function(a){b.register(m+Za+(a+1),U,null,!1,!1,!1,!1)}),V={canUndo:!1,execute:function(a,b){var c,d=b.itemName.substr(10),e=a.TCJ(),f=a.getSheetIndex(d);j(f)&&(f=a.sheets.length+a.getSheetTabIndex(d)),a.MJc.iw(f),c=a.getTab(),c.VMJ(e,f)}},b.register(m+Zb,V,null,!1,!1,!1,!1),W={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(c){a.suspendCalcService(),nc(b.selections,ec,function(a){c.setRowVisible(a,!1)}),a.resumeCalcService()})}},b.register(m+Ma,W,null,!1,!1,!1,!1),X={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(c){a.suspendCalcService(),nc(b.selections,fc,function(a){c.setColumnVisible(a,!1)}),a.resumeCalcService()})}},b.register(m+hb,X,null,!1,!1,!1,!1),Y={canUndo:!1,execute:function(a){var b,c,d,e,f,h,i,j,k,l,m,n,o,p,q=0,r=a.xCJ();if(r.forEach(function(a){a.visible()===g.SheetTabVisible.visible&&(q+=1)}),b=g.UCJ(a),q<=1)return void Tc(b);if(d=[],r.forEach(function(a){a.HHb()&&d.push(a)}),q!==d.length){for(e=0;e<d.length;e++)f=d[e],h=f.name(),i=a.getSheetIndex(h),j={sheetName:h,propertyName:"isVisible",cancel:!1,sheetIndex:i,oldValue:!0,newValue:!1},a.Wq(g.Events.SheetChanging,j),k={cancel:!1,oldSheet:f},h===b.name()&&a.Wq(g.Events.ActiveSheetChanging,k),j.cancel||k.cancel||(f.HHb(!1,!0),kc.push(f),f.visible(!1),l=g.UCJ(a),e===d.length-1&&l&&!l.isSelected()&&(m=l.name(),c={oldValue:!1,newValue:!0,sheetName:m,propertyName:"isSelected",cancel:!1,sheetIndex:a.getSheetIndex(m)},a.Wq(g.Events.SheetChanging,c)),a.Wq(g.Events.SheetChanged,{sheetName:h,propertyName:"isVisible",sheetIndex:i,oldValue:!0,newValue:!1}));n=g.UCJ(a),o=n&&n.name(),c&&(c.cancel?n.ITa.GHb(!1):(n.ITa.GHb(!0),a&&a.MJc&&a.MJc.repaint(),p={oldValue:!1,newValue:!0,sheetName:o,propertyName:"isSelected",sheetIndex:a.getSheetIndex(o)},a.Wq(g.Events.SheetChanged,p))),b!==n&&a.Wq(g.Events.ActiveSheetChanged,{oldSheet:b,newSheet:n})}else Tc(b);a.undoManager().clear()}},b.register(m+Ja,Y,null,!1,!1,!1,!1),Z={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(c){var d=b.selections,e=b.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;j(e)&&(e=b.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=pc(c,d[0])),1===d.length&&e?(c.setRowVisible(d[0].row-1,!0),c.mq(d[0].row-1)):(a.suspendCalcService(),nc(d,ec,function(a){c.setRowVisible(a,!0),a===c._t()&&(c.lq=0,c.os())}),a.resumeCalcService())})}},b.register(m+Ka,Z,null,!1,!1,!1,!1),$={canUndo:!0,execute:function(a,b,c){return Oc(a,b,c,function(c){var d=b.selections,e=b.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;j(e)&&(e=b.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=pc(c,d[0])),1===d.length&&e?(c.setColumnVisible(d[0].col-1,!0),c.rq(d[0].col-1)):(a.suspendCalcService(),nc(d,fc,function(a){c.setColumnVisible(a,!0),a===c.$t()&&(c.qq=0,c.qs())}),a.resumeCalcService())})}},b.register(m+La,$,null,!1,!1,!1,!1),_={canUndo:!1,execute:function(a,b){var c,d,e,f,h,i,k,l=a.xCJ();if(0===kc.length)for(c=0;c<l.length;c++)l[c].visible()===g.SheetTabVisible.hidden&&(kc.push(l[c]),l[c].HHb(!1));if(d=g.UCJ(a),kc.length>0){if(l.forEach(function(a){a!==d&&a.HHb(!1,!0)}),e=void 0,f=void 0,b&&!j(b.activeSheetIndex)&&(e=l[b.activeSheetIndex]),b&&b.unhideSheetIndexes&&b.unhideSheetIndexes.length>0&&(i=b.unhideSheetIndexes,i.forEach(function(b){var c,d=l[b];h=Uc(a,d),h!==!1&&(c=kc.indexOf(l[b]),c>-1&&kc.splice(c,1))}),e||(e=l[i[i.length-1]])),!e){if(e=kc.pop(),!e)return;if(h=Uc(a,e),h===!1)return}if(!e)return;if(k=Vc(a,d,e),k===!1)return;a.setActiveSheet(e.name())}g.UCJ(a)!==d&&Wc(a,d)}},b.register(m+Ia,_,null,!1,!1,!1,!1),aa={canUndo:!1,execute:function(a,c){var d,e,f,h,i=g.VCJ(a,c.sheetName);if(i&&(a.suspendPaint(),d=[],e=i.slicers.all(),e&&!k(e))){for(f in e)e.hasOwnProperty(f)&&(h=e[f],h.isSelected()&&d.push(h.name()));b.execute({cmd:"deleteSlicers",sheetName:i.name(),slicerNames:d}),a.resumePaint()}}},b.register(m+Ea,aa,null,!1,!1,!1,!1),this.p5J=!0)},a.prototype.openAllSheetsListContextMenu=function(a,b,c,d){var e,f=this.menuView.maxHeight();(j(f)||f===-1)&&this.menuView.maxHeight(400),e=this.OYJ(b,c),this.ad(b),this.qla(e,b),this.jla(a,e,b),j(f)?this.menuView.maxHeight(-1):this.menuView.maxHeight(f),this.menuView.EKJ.lL(d)},a.prototype.OYJ=function(a,b){var c=this.pla(b,a),d=2;return 0===a.options.tabStripPosition&&(c.x=c.x+d,c.y=c.y-d),c},a}(),b.ContextMenu=lc,g.Workbook.$n("contextmenu",{init:function(){var a=this;a.contextMenu||(a.contextMenu=new lc),a.contextMenu.nla(this)},setHost:function(){var a=this,b=a.qo;a.contextMenu||(a.contextMenu=new lc),i(b).bind("contextmenu.gcSheet",function(b){if(a.options.allowContextMenu)return a.contextMenu.ola(b,a)})},dispose:function(){i(this.qo).unbind("contextmenu.gcSheet")},onCultureChanged:function(){var a,b,c,d=this.contextMenu;d&&(a=d.menuData,b=d.BRJ(),c={},d.CRJ(b,function(a){j(a.name)||(c[a.name]=a.text)}),d.CRJ(a,function(a){j(a.name)||j(c[a.name])||(a.text=c[a.name])}))},fromJson:function(a){var b=this.contextMenu&&this.contextMenu.menuView,c=a.contextMenu;b&&!j(c)&&(b.ysb=a.scrollable,b.CKJ=a.maxHeight)},toJson:function(a){var b=this.contextMenu&&this.contextMenu.menuView;!b||j(b.ysb)&&j(b.CKJ)||(a.contextMenu={},a.contextMenu.scrollable=b.ysb,a.contextMenu.maxHeight=b.CKJ)}})},"./dist/plugins/contextMenu/context-menu.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/plugins/contextMenu/context-menu.res.en.js");b.SR={en:d}},"./dist/plugins/contextMenu/context-menu.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.copy="Copy",b.cut="Cut",b.pasteOptions="Paste Options:",b.pasteAll="All",b.pasteFormula="Formulas",b.pasteValues="Values",b.pasteFormatting="Formatting",b.pasteValuesFormatting="Values&Formatting",b.pasteFormulaFormatting="Formula&Formatting",b.clearContents="Clear Contents",b.insertRows="Insert",b.insertColumns="Insert",b.deleteRows="Delete",b.deleteColumns="Delete",b.insertSheet="Insert",b.deleteSheet="Delete",b.insertComment="Insert Comment",b.filter="Filter",b.sort="Sort",b.insertCopiedCells="Insert Copied Cells...",b.insertCutCells="Insert Cut Cells...",b.shiftCellsRight="Shift Cells Right",b.shiftCellsDown="Shift Cells Down",b.headerInsertCopiedCells="Insert Copied Cells",b.headerInsertCutCells="Insert Cut Cells",b.slicerSortAscend="Sort A to Z",b.slicerSortDescend="Sort Z to A",b.sortAscend="Sort A to Z",b.sortDescend="Sort Z to A",b.hideRows="Hide",b.hideColumns="Hide",b.hideSheet="Hide",b.unhideSheet="Unhide",b.unhideColumns="Unhide",b.unhideRows="Unhide",b.editComment="Edit Comment",b.deleteComment="Delete Comment",b.toggleComment="Show/Hide Comment",b.removeSlicer="Remove",b.removeFloatingObject="Remove",b.tableInsert="Insert",b.tableInsertRowsAbove="Table Rows Above",b.tableInsertRowsBelow="Table Row Below",b.tableInsertColumnsLeft="Table Columns to the Left",b.tableInsertColumnsRight="Table Columns to the Right",b.tableDelete="Delete",b.tableDeleteRows="Table Rows",b.tableDeleteColumns="Table Columns",b.hideSheetFailureInfo="A workbook must contain at least one visible worksheet.\nTo hide, delete or move the selected sheet(s), you must first insert a new sheet or unhide a sheet that is already hidden.",b.pivotTableRefresh="Refresh",b.pivotTableMove="Move",b.pivotTableRemove_="Remove {0}",b.pivotTableRemoveGrandTotal="Remove GrandTotal",b.pivotTableValueFieldSettings="Value Field Settings...",b.pivotTableOptions="PivotTable Options...",b.pivotTableNumberFormat="Number Format...",b.pivotTableSort="Sort",b.pivotTableSummarizeValuesBy="Summarize Values By",b.pivotTableSum="Sum",b.pivotTableCount="Count",b.pivotTableAverage="Average",b.pivotTableMax="Max",b.pivotTableMin="Min",b.pivotTableProduct="Product",b.pivotTableDistinctCount="Distinct Count",b.pivotTableMoreOptions="More Options",b.pivotTableShowValueAs="Show Value As",b.pivotTableNoCalculation="No Calculation",b.pivotTableGrandTotal="% of Grand Total",b.pivotTableColumnTotal="% of Column Total",b.pivotTableRowTotal="% of Row Total",b.pivotTableOf="% Of...",b.pivotTableParentRowTotal="% of Parent Row Total",b.pivotTableParentColumnTotal="% of Parent Column Total",b.pivotTableOfParentTotal="% of Parent Total...",b.pivotTableDifferenceFrom="Difference From...",b.pivotTablePercentDifferenceFrom="% Difference From...",b.pivotTableRunningTotalIN="Running Total In...",b.pivotTablePercentRunningTotalIn="% Running Total In...",b.pivotTableRankSmallestToLargest="Rank Smallest to Largest...",b.pivotTableRankLargestToSmallest="Rank Largest to Smallest...",b.pivotTableIndex="Index",b.pivotTableShowDetails="Show Details",b.pivotTableGroup="Group...",b.pivotTableUnGroup="Ungroup...",b.pivotTableExpandOrCollapse="Expand/Collapse",b.pivotTableFilter="Filter",b.pivotTableSubtotal_="Subtotal {0}",b.pivotTableHideFieldList="Hide Field List",b.pivotTableFieldSettings="Field Settings...",b.pivotTableClearFilterFrom_="Clear Filter From {0}",b.pivotTableKeepOnlySelectedItems="Keep Only Selected Items",b.pivotTableHideSelectedItems="Hide Selected Items",b.pivotTableTop10="Top 10...",b.pivotTableLabelFilters="Label Filters...",b.pivotTableLabelFilters_Date="Date Filters...",b.pivotTableValueFilters="Value Filters...",b.pivotTableExpand="Expand",b.pivotTableCollapse="Collapse",b.pivotTableExpandEntireField="Expand Entire Field",b.pivotTableCollapseEntireField="Collapse Entire Field",b.pivotTableCollapseTo_="Collapse to {0}",b.pivotTableExpandTo_="Expand to {0}",b.pivotTableMove_ToBeginning="Move {0} to Beginning",b.pivotTableMove_Up="Move {0} Up",b.pivotTableMove_Down="Move {0} Down",b.pivotTableMove_ToEnd="Move {0} to end",b.pivotTableMove_ToLeft="Move {0} to left",b.pivotTableMove_ToRight="Move {0} to Right",b.pivotTableMove_ToColumns="Move {0} to columns",b.sigmaValue="\u2211 Values",b.sigmaValueTemp="Values",b.pivotTableSortAscend="Sort Smallest to Largest",b.pivotTableSortDescend="Sort Largest to Smallest",b.pinRows="Pin/Unpin Rows",b.pinColumns="Pin/Unpin Columns",b.promote="Promote",b.demote="Demote",b.moveUp="Move Up",b.moveDown="Move Down",b.addAfter="Add After",b.addBefore="Add Before",b.addAbove="Add Above",b.addBelow="Add Below",b.expandAllLevels="Expand All Levels",b.collapseAllLevels="Collapse All Levels",b.expandLevel1="Expand to Level 1",b.expandLevel2="Expand to Level 2",b.expandLevel3="Expand to Level 3",b.expandLevel4="Expand to Level 4",b.expandLevel5="Expand to Level 5",b.expandLevel6="Expand to Level 6",b.expandLevel7="Expand to Level 7",b.expandLevel8="Expand to Level 8",b.expandLevel9="Expand to Level 9",b.paste="Paste"},"./dist/plugins/contextMenu/menu-view.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("Core"),f=e.GC$,g=e.Ul.Nl,h=d.Common.j,i=h.Fa,j=h.Aa,k=h.C4,l=void 0,m=null,n=document,o=window,p=Math.max,q=Math.min,r=Math.floor,s={AKb:"mouseenter",BKb:"mouseleave",CKb:"click",mHc:"mousewheel",qGc:"DOMMouseScroll",DKb:"gc.command.executed",EKb:".",FKb:"gc-ui-contextmenu",sKJ:".gcScrollWrapper",GKb:"-",HKb:"container",IKb:"hover",JKb:"disable-hover",KKb:"text",LKb:"icon",MKb:"menuitem",NKb:"nonselective-menuitem",OKb:"menuitem-content",PKb:"sup-container",QKb:"separator",RKb:"sup-indicator",SKb:"subitems-container",TKb:"group-container",UKb:"title",VKb:"group-header",WKb:"groupitems-container",XKb:"groupitem",YKb:"nonexecutable",ZKb:"executable",$Kb:"disable",NKJ:"gcUIElement",OKJ:"gcContextMenu",_Kb:"gc-statusbar-contextmenu",
aLb:" ui-widget",bLb:" ui-state-hover",cLb:" ui-icon ui-icon-triangle-1-e",dLb:"DIV",eLb:"SPAN",fLb:"keydown.ctx.gcSheet",gLb:"none",hLb:"inline-block",iLb:"visible",jLb:"hidden",tKJ:"block",uKJ:"none",KKJ:"overflow"},t=s.FKb+s.GKb+s.IKb,u=s.FKb+s.GKb+s.MKb,v=s.FKb+s.GKb+s.NKb,w=s.FKb+s.GKb+s.OKb,x=s.FKb+s.GKb+s.ZKb,y=s.FKb+s.GKb+s.PKb,z=s.FKb+s.GKb+s.SKb,A=s._Kb+s.GKb+"check",B=s._Kb+s.GKb+"check-container",C=s._Kb+s.GKb+"content",D=s._Kb+s.GKb+"status",E=12;function I(a){if(a instanceof Object)return!0}!function(a){a[a.up=0]="up",a[a.down=1]="down"}(F||(F={})),G=function(){function a(a,b,c){var d=this;d.qo=a,d.Uc=b,d.vKJ(a,b,c)}return a.prototype.vKJ=function(a,b,c){var d=this,e=d.Ana=f(document.createElement("DIV")),g=d.wKJ=document.createElement("DIV"),h=d.xKJ=document.createElement("DIV");e[0].className="gc-ui-contextmenu-scroll-wrapper",g.className="gc-ui-contextmenu-scroll-indicator",g.innerText=String.fromCharCode(708),h.className="gc-ui-contextmenu-scroll-indicator",h.innerText=String.fromCharCode(709),a.append(f(g)),a.append(e),e.append(b),e.height(c.height-12),a.append(f(h)),d.yKJ=e.height()+E,d.r3=d.iZJ(b),d.hT(F.up),d.QQ()},a.prototype.iZJ=function(a){var b=0;return a[0].childNodes.forEach(function(a){b+=a.offsetHeight}),b},a.prototype.zKJ=function(){return this.Ana},a.prototype.AKJ=function(a){var b=this;return i(a)?b.Ana.scrollTop():(b.Ana.scrollTop(a),void b.BKJ(a))},a.prototype.lL=function(a){var b,c=this.Uc[0],d=c.childNodes,e=0;for(b=0;b<a;b++)e+=d[b].offsetHeight;this.AKJ(e-E)},a.prototype.QQ=function(){var a=this,b=a.wKJ,c=a.xKJ,d=a.Ana,e=a.yKJ,g=a.r3;f(b).bind(s.AKb+s.sKJ,function(){a.Jw=o.setInterval(function(){var b=d.scrollTop(),c=b<=10?0:b-10;a.AKJ(r(c))},100)}),f(b).bind(s.BKb+s.sKJ,function(){o.clearInterval(a.Jw)}),f(b).bind(s.CKb+s.sKJ,function(){a.AKJ(0)}),f(c).bind(s.AKb+s.sKJ,function(){a.Jw=o.setInterval(function(){var b=d.scrollTop(),c=b>=g-e-10?g-e+2:b+10;a.AKJ(c)},100)}),f(c).bind(s.BKb+s.sKJ,function(){o.clearInterval(a.Jw)}),f(c).bind(s.CKb+s.sKJ,function(){a.AKJ(g-e)}),d.bind(s.mHc+s.sKJ,function(b){a.BKJ(d.scrollTop()+(b.deltaY||-b.wheelDelta||0))}).bind(s.qGc+s.sKJ,function(b){a.BKJ(d.scrollTop()+(b.deltaY||-b.wheelDelta||0))})},a.prototype.Tla=function(){var a=this,b=a.wKJ,c=a.xKJ,d=a.Ana;f(b).unbind(s.sKJ),f(c).unbind(s.sKJ),d.unbind(s.sKJ)},a.prototype.hyc=function(){var a=this;a.Tla(),a.qo.append(a.Uc),f(a.Ana).remove(),f(a.wKJ).remove(),f(a.xKJ).remove(),a.qo=l,a.Uc=l,a.Ana=l,a.wKJ=l,a.xKJ=l},a.prototype.Ao=function(a){switch(a){case F.up:this.wKJ.style.display=s.tKJ;break;case F.down:this.xKJ.style.display=s.tKJ}},a.prototype.hT=function(a){switch(a){case F.up:this.wKJ.style.display=s.uKJ;break;case F.down:this.xKJ.style.display=s.uKJ}},a.prototype.BKJ=function(a){var b=this,c=b.yKJ,d=b.r3;a<1?(b.Ao(F.down),b.hT(F.up),b.WRJ(!0)):a>d-c-1?(b.Ao(F.up),b.hT(F.down),b.WRJ(!1)):(b.Ao(F.up),b.Ao(F.down),b.WRJ(!0))},a.prototype.WRJ=function(a){var b=this,c=b.Ana,d=b.yKJ;a&&(d-=E),c.height(d)},a}(),H=function(){function a(){}return a.prototype.ai=function(a,b,c,d){var e=this;e.qo=f(a),e.lla=k(b),e.wu=c.commandManager(),e.xc=c,e.Eu=d,e.LQ=[],e.YPa={},e.rQa=[],e.LKJ={},e.ZPa=m,e.lma()},a.prototype.mma=function(){var a,b,c,d,e,f,g,h,j,k,l,n,o,p,r,t,u,v,w,x,y,z,A,B,C=this,D=C.w_,E=C.qo,F=C.hostInfo;D[0].style.maxHeight="",a=parseInt(E.css("left"),10),b=parseInt(E.css("top"),10),c=E.width(),d=E.height(),e=C.DKJ(d),e&&(f=C.EKJ=C.FKJ(E,D),d=C.GKJ()),"number"==typeof C.CKJ&&(e?(g=f.zKJ(),g[0].style.maxHeight=C.CKJ+"px",D.css(s.KKJ,m)):(D[0].style.maxHeight=C.CKJ+"px",D.css(s.KKJ,s.jLb),d=D.height()+2)),h=C.FXJ(),j=h.windowTop,k=h.windowLeft,l=h.windowWidth,n=h.windowHeight,i(F)?(t=C.EXJ(),u=t.contextTop,v=t.contextLeft,w=t.contextWidth,x=t.contextHeight,y=u+b-Math.max(j,u),z=q(j+n,u+x)-(u+b),A=j+n-u+b,B=q(k+l,v+w)-(v+a),a+c>w?(a=a-c>0?a-c:a,E.css("left",a)):c>B&&E.css("left",a-c),d>z&&(d<=y?E.css("top",b-d):y+z>=d?E.css("top",b+z-d):A<d?E.css("top",j+n-u-d):E.css("top",u>j?0:j-u))):(F.left+a+c>k+l&&(a=a-c>0?a-c:a,E.css("left",a)),o=C.xc&&C.xc.getHost(),p=(o&&o.getBoundingClientRect().top)<F.top,r=F.top,p?r+b>=d?E.css("top",b-d):E.css("top",-r):n-r-b<d&&E.css("top",n-r-d))},a.prototype.FXJ=function(){return{windowTop:o.scrollY||o.pageYOffset,windowLeft:o.scrollX||o.pageXOffset,windowWidth:o.clientWidth||o.innerWidth,windowHeight:o.clientHeight||o.innerHeight}},a.prototype.EXJ=function(){var a,b,c,d,e,g,h=this;return h.xc&&(e=f(h.xc.getHost()),g=e.offset(),a=g.top,b=g.left,c=e.width(),d=e.height()),{contextTop:a,contextLeft:b,contextWidth:c,contextHeight:d}},a.prototype.FKJ=function(a,b){return new G(a,b,{height:this.GKJ()})},a.prototype.jZJ=function(){var a=this,b=a.w_;"number"==typeof a.CKJ&&(b[0].style.maxHeight=a.CKJ+"px",b.css(s.KKJ,s.jLb))},a.prototype.lma=function(){var a,b,c,d=this,e=d.lla;i(e)||!I(e)||e.length<1||(e instanceof Array||(e=[e]),a="menuView",b=d.nma(a,e),d.YPa.menuView=b,c=d.oma(d.lla),d.w_=c,d.jZJ(),c.appendTo(d.qo),d.mma(),d.QQ(),d.rQa.push({name:a,menuView:c}))},a.prototype.nma=function(a,b){for(var c,d=this,e=b.length,f=0,g=[];f<e;f++)c=b[f],i(c)||"separator"===c.type||(c.subMenu?d.YPa[c.name]=d.nma(c.name,c.subMenu):"groupHeader"===c.type&&(d.pma(c,b),d.YPa[c.name]=d.nma(a,c.groups)),g.push(d.qma(a,c)));return g},a.prototype.qma=function(a,b){var c,d,e,g=this;if(c="groupHeader"===b.type?g.$Pa():g.rma(),d=g.createMenuItemElement(b),!i(d))return d instanceof HTMLElement&&(d=f(d)),i(b.itemClass)||c.addClass(b.itemClass),i(b.title)||c.attr("title",b.title),d.appendTo(c),e={name:b.name,host:c,menuItemData:b,menuName:a},this.SpreadJSDesignerAutoTest&&this.SpreadJSDesignerAutoTest(e.host,e.menuItemData),g.LQ.push(e),e},a.prototype.rma=function(){var a=f(g(s.dLb));return a.addClass(u),a},a.prototype.$Pa=function(){var a=f(g(s.dLb));return a.addClass(v),a},a.prototype.createMenuItemElement=function(a){var b,c=this,d=a.type;return b="groupHeader"===d?c.tma(a):"groupItem"===d?c.uma(a):"statusBar"===d?c.Eyb(a):a.subMenu?c.vma(a):c.wma(a)},a.prototype.wma=function(a){var b,c,e=f(g(s.dLb)).addClass(w);return a.command?a.disable?e.addClass(s.FKb+s.GKb+s.$Kb):e.addClass(x):e.addClass(s.FKb+s.GKb+s.YKb),b=f(g(s.eLb)).addClass(s.FKb+s.GKb+s.LKb),a.iconClass&&b.addClass(a.iconClass),b.appendTo(e),a.text&&(c=f(g(s.eLb)).addClass(s.FKb+s.GKb+s.KKb),c[0].innerHTML=d.Common.u.Ob(a.text),c.appendTo(e)),e},a.prototype.sma=function(a){return f(g(s.dLb)).addClass(s.FKb+s.GKb+s.QKb)},a.prototype.tma=function(a){var b,c,d,e,h,i,j,k=this,l=f(g(s.dLb)).addClass(s.FKb+s.GKb+s.TKb);if(a.groups.length<=0)return l;for(b=k.wma(a),b.addClass(s.FKb+s.GKb+s.VKb),b.appendTo(l),c=f(g(s.dLb)).addClass(s.FKb+s.GKb+s.WKb),d=a.groups,e=d.length,h=0;h<e;h++)i=k.xma("name",d[h].name),j=i.host,j.addClass(s.FKb+s.GKb+s.XKb),j.appendTo(c);return c.appendTo(l),l},a.prototype.uma=function(a){var b=this,c=b.wma(a),d=c.find(s.EKb+s.FKb+s.GKb+s.KKb);return d.remove(),c.attr(s.UKb,a.text),c},a.prototype.Eyb=function(a){var b,c,d,e=g("div"),h=f(e).addClass(w),i=a.visible,j=a.menuContent,k=a.status,l=g("div");return f(l).addClass(A),b=g("div"),f(b).addClass(B),b.appendChild(l),b.style.visibility=i?s.iLb:s.jLb,c=g("div"),c.innerText=j,f(c).addClass(C),d=g("div"),f(d).addClass(D),k?(d.innerText=k,d.style.display=s.hLb):d.style.display=s.gLb,e.appendChild(b),e.appendChild(c),e.appendChild(d),h},a.prototype.vma=function(a){var b,c,d,e=this,h=f(g(s.dLb)).addClass(y),i=e.wma(a);return a.subMenu.length>0&&(b=f(g(s.eLb)).addClass(s.FKb+s.GKb+s.RKb+s.cLb),b.appendTo(i),c=e.oma(a.subMenu),d=f(g(s.dLb)).addClass(z),c.appendTo(d),d.appendTo(e.qo),e.LKJ[a.name]=d),i.appendTo(h),h},a.prototype.oma=function(a){for(var b,c,d,e,h=this,j=f(g(s.dLb)).addClass(s.FKb+s.GKb+s.HKb+s.aLb),k=a.length,l=0;l<k;l++)i(a[l])||(b=a[l].name,i(b)?"separator"===a[l].type&&(d=h.$Pa(),e=h.sma(a[l]),e.appendTo(d),d.appendTo(j)):(c=h.xma("name",b),i(c)||c.host.appendTo(j)));return j},a.prototype.xma=function(a,b){for(var c=this,d=c.LQ,e=d.length,g=0;g<e;g++)if(b instanceof f?b[0]===d[g][a][0]:d[g][a]===b)return d[g]},a.prototype.pma=function(a,b){var c,d,e;for(a.groups=[],c=b.length,d=0;d<c;d++)e=b[d],e&&e.group&&e.group===a.name&&(e.type="groupItem",a.groups.push(e),b.splice(d,1),d--)},a.prototype.QQ=function(){var a=this;f(s.EKb+u).bind(s.AKb,function(){var b,c,d,e=f(this),g=a.xma("host",e);for(a.ZPa=g,b=a.rQa,c=0,d=b.length;c<d&&g.menuName!==a.rQa[d-c-1].name;c++)a.Ooa();a._Pa(),a.cQa(!1)}).bind(s.BKb,function(){a.ZPa=m,a._Pa()}).bind(s.CKb,function(b){var c,d=f(this),e=a.xma("host",d);a.ZPa=e,c=a.aQa(!1,b),c&&a.WT()}),f(n).bind(s.fLb,function(b){var c,d,e;if(!b.target||f(b.target).attr(s.NKJ)!==s.OKJ){switch(b.keyCode){case 27:c=a.Ooa(),c||a.WT();break;case 32:case 13:c=a.aQa(!0,b),c&&a.WT();break;case 9:b.shiftKey?a.bQa(!1,!0):a.bQa(!0,!0);break;case 37:d=a.Ooa(),e=a.xma("name",d),e&&(a.ZPa=e),a.ZPa&&a.ZPa.menuItemData.group&&a.bQa(!1,!0);break;case 38:a.bQa(!1,!1);break;case 39:a.ZPa&&a.ZPa.menuItemData.group&&a.bQa(!0,!0),a.cQa(!0);break;case 40:a.bQa(!0,!1)}b.preventDefault?b.preventDefault():b.returnValue=!1}})},a.prototype.Noa=function(a,b){var c,d,e,g,h,i,j,k,l,m,n,o,p,r=this,t=r.EXJ(),u=t.contextTop,v=t.contextLeft,w=t.contextWidth,x=t.contextHeight,y=r.FXJ(),z=y.windowTop,A=y.windowLeft,B=y.windowWidth,C=y.windowHeight,D=b.parentRelatedLeft,E=b.parentRelatedTop,F=b.parentAbsoluteLeft,G=b.parentWidth;return a.css("top",E+2),c=a.width(),d=a.height(),e=a.position(),g=a.offset(),h=g.top,i=e.top,F+G+c>q(A+B,v+w)?a.css("left",D-c-1):a.css("left",D+G),k=r.MKJ(),l=r.DKJ(d),l&&(m=f(a[0].firstChild),j=r.FKJ(a,m),d=r.GKJ()),"number"==typeof r.CKJ&&(l?(n=j.zKJ(),n[0].style.maxHeight=r.CKJ+"px"):(a[0].style.maxHeight=r.CKJ+"px",a.css(s.KKJ,s.jLb),d=a.height())),o=q(z+C,u+x),p=o-h,d>p&&(d>k?a.css("top",u>z?0:z-u):a.css("top",i+o-h-d)),j},a.prototype.zma=function(a){return a.command},a.prototype.getCommandOptions=function(a,b,c){},a.prototype.aQa=function(a,b){var c,d=this,e=d.ZPa;if(e&&!e.menuItemData.disable)return c=e.menuItemData,c.subMenu?void(c.subMenu.length>0&&d.cQa(a)):(d.h4(b),!0)},a.prototype.h4=function(a){var b,c,d,f,g,h,k,l,m=this,n=m.ZPa,o=m.zma(n.menuItemData);i(o)||(b=m.getCommandOptions(n.menuItemData,n.host[0],a),c=m.wu,j(o)?o(m.xc,b):(d=e.UCJ(m.xc),f=d&&d.getActiveColumnIndex(),g=d&&d.getActiveRowIndex(),h=d&&d.tables&&d.tables.find(g,f),k=d&&d.pivotTables&&d.pivotTables.findPivotTable(g,f),i(k)?c.execute({cmd:o,sheetName:d&&d.name(),selections:d&&d.getSelections(),activeRow:g,activeCol:f,commandOptions:b,tableName:h?h.name():"",itemName:n.menuItemData.name}):(l=n.menuItemData.commandOptions,i(l)&&(l={}),i(l.pivotTableName)&&(l.pivotTableName=k.name()),i(l.pivotTableCellInfo)&&(l.pivotTableCellInfo=k.getPivotInfoImp(g,f,!1,!1,!0)),c.execute({cmd:o,sheetName:d.name(),selections:d.getSelections(),activeRow:g,activeCol:f,commandOptions:l,itemName:n.menuItemData.name}))))},a.prototype.Tla=function(){f(s.EKb+u).unbind(s.AKb).unbind(s.BKb).unbind(s.CKb),f(n).unbind(s.fLb)},a.prototype.no=function(){var a=this;a.qo=m,a.lla=m,a.wu=m,a.xc=m,a.Eu=m,a.LQ=m,a.YPa=m,a.ZPa=m,a.w_=m,a.LKJ=m,a.EKJ&&(a.EKJ.hyc(),a.EKJ=l),a.Tla()},a.prototype.Ooa=function(){var a,b,c,d=this;if(d.rQa.length>1)return a=d.rQa.pop(),b=a.menuView,c=b.find(s.EKb+u),c.removeClass(t+s.bLb),a.menuView.hide(),a.subMenuWrapper&&(a.subMenuWrapper.hyc(),a.subMenuWrapper=l),a.name},a.prototype._Pa=function(){var a,b,c,d=this,e=d.dQa(!0);if(e){for(a=0,b=e.length;a<b;a++)e[a].host.removeClass(t+s.bLb);d.ZPa&&(c=d.ZPa.menuItemData,c.disable?d.ZPa.host.addClass(s.FKb+s.GKb+s.JKb+s.bLb):d.ZPa.host.addClass(t+s.bLb))}},a.prototype.WT=function(){var a=this;a.Eu.trigger(s.DKb),a.no()},a.prototype.bQa=function(a,b){var c,d,e,f,g,h,i,j,k,m,n=this,o=n.dQa(b);n.ZPa&&(c=n.eQa(n.ZPa,o),c||(d=n.YPa[n.ZPa.menuItemData.group],d&&(e=d[0],c=n.eQa(e,o)))),a?(c!==l&&c!==o.length-1||(c=-1),c="number"==typeof c?c+1:0):(c!==l&&0!==c||(c=o.length),c="number"==typeof c?c-1:0),n.ZPa=o[c],n._Pa(),f=n.rQa[n.rQa.length-1],g=o.length,h=f&&("menuView"===f.name?n.EKJ:f.subMenuWrapper),h&&(i=h.AKJ(),j=i+n.ZPa.host.position().top,k=j+o[c].host.height()+2,m=h.zKJ().height(),j<i+E?0===c?h.AKJ(0):h.AKJ(j-E):k>i+m&&(c===g-1?h.AKJ(h.zKJ().height()):h.AKJ(j-E),h.AKJ(k-m)))},a.prototype.dQa=function(a){for(var b,c,d,e=this,f=e.rQa[e.rQa.length-1].name,g=e.YPa[f],h=0,i=g.length,j=[];h<i;h++)if("groupHeader"!==g[h].menuItemData.type)j.push(g[h]);else if(b=e.YPa[g[h].menuItemData.name],a)for(c=0,d=b.length;c<d;c++)j.push(b[c]);else j.push(b[0]);return j},a.prototype.eQa=function(a,b){var c,d=b.length;for(c=0;c<d;c++)if(a.name===b[c].name)return c},a.prototype.cQa=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.ZPa;k&&(b=k.menuItemData,b.subMenu&&b.subMenu.length>0&&(b.name!==j.rQa[j.rQa.length-1].name&&(c=j.LKJ[b.name],c.show(),d=k.host,e=j.LKJ[k.menuName],f=d.offset(),g=d.position(),h=e&&e.position(),i=j.Noa(c,{parentRelatedLeft:h?h.left:g.left,parentRelatedTop:h?g.top+h.top:g.top,parentAbsoluteLeft:f.left,parentWidth:e?e.width():d.width()+3}),j.rQa.push({name:b.name,menuView:c,subMenuWrapper:i})),j.ZPa=m,a&&j.bQa(!0,!1)))},a.prototype.GKJ=function(){var a=this,b=a.MKJ();return"number"==typeof a.CKJ&&a.ysb!==!1&&(b=q(b,a.CKJ)),b},a.prototype.MKJ=function(){var a=this,b=a.hostInfo,c=a.EXJ(),d=c.contextTop,e=c.contextHeight,f=a.FXJ(),g=f.windowTop,h=f.windowHeight;return b?h:q(g+h,d+e)-p(g,d)},a.prototype.DKJ=function(a){var b,c=this;return c.ysb!==!1&&(b=c.GKJ(),a>b||void 0)},a.prototype.scrollable=function(a){var b=this;return i(a)?b.ysb:void(b.ysb=a)},a.prototype.maxHeight=function(a){var b=this;return i(a)?b.CKJ:(b.CKJ=a,void(a<0&&(b.CKJ=void 0)))},a.prototype.getHost=function(){return this.qo},a}(),b.MenuView=H},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets}});