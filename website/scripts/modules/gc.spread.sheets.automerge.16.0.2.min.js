/*!
 * 
 * SpreadJS Library 16.0.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.AutoMerge=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/autoMerge/autoMerge.js")}({"./dist/plugins/autoMerge/autoMerge.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/autoMerge/autoMerge.res.en.js"),b.SR={en:f},g=d.util.JcK,h=d.range_parser.EcK,i=d.XFileConstants.BbK,j=new e.Common.ResourceManager(b.SR,"AutoMerge"),k=j.getResource.bind(j),function(a){a[a.free=0]="free",a[a.restricted=1]="restricted"}(l=b.AutoMergeMode||(b.AutoMergeMode={})),function(a){a[a.none=0]="none",a[a.column=1]="column",a[a.row=2]="row",a[a.columnRow=3]="columnRow",a[a.rowColumn=4]="rowColumn"}(m=b.AutoMergeDirection||(b.AutoMergeDirection={})),function(a){a[a.source=0]="source",a[a.merged=1]="merged"}(n=b.SelectionMode||(b.SelectionMode={})),o=function(a){t(b,a);function b(b,c){var d=a.call(this,b.row,b.col,b.rowCount,b.colCount)||this;return d.sheetArea=c,d.isAutoMerge=!0,d}return b}(d.Range),p=void 0,q=null;function u(a,b,c){return c+"_"+a+"_"+b}function v(a,b,c){return b===a||(b===d.SheetArea.viewport?c&&a===d.SheetArea.rowHeader||!c&&a===d.SheetArea.colHeader:b===d.SheetArea.rowHeader?c&&a===d.SheetArea.viewport:b===d.SheetArea.colHeader&&(!c&&a===d.SheetArea.viewport))}function w(a,b,c){a.clearSpan(b.row,b.col,b.rowCount,b.colCount,c)}function x(a,b,c){var e,f,g,h,i,j,k,l,m,n;return c===d.SheetArea.viewport&&!a.options.allowCellOverflow&&(e=b.row,f=b.col,g=b.rowCount,h=b.colCount,i=a.frozenRowCount(),j=a.frozenColumnCount(),k=a.frozenTrailingRowCount(),l=a.frozenTrailingColumnCount(),m=a.getRowCount(),n=a.getColumnCount(),(0===i||e!==-1&&i<=e)&&(0===j||f!==-1&&j<=f)&&(0===k||e!==-1&&e+g<=m-k)&&(0===l||f!==-1&&f+h<=n-l))?((f===-1||0===f&&h===n)&&(f=a.getViewportLeftColumn(1),h=a.getViewportRightColumn(1)-f+1),(e===-1||0===e&&g===m)&&(e=a.getViewportTopRow(1),g=a.getViewportBottomRow(1)-e+1),d.kf(e,f,g,h)):a.Tq(b,c)}r=function(){function a(a){this.kj=a,this.AJb=[],this.xn={},this.Ny=[]}return a.prototype.no=function(){this.kj=q},a.prototype.add=function(a,b,c,e,f){var g,h,i,j;for(void 0===e&&(e=d.SheetArea.viewport),void 0===f&&(f=n.source),g=this.all(),h=0,i=g;h<i.length;h++)if(j=i[h],j.sheetArea===e&&j.range.intersect(a.row,a.col,a.rowCount,a.colCount))throw Error(k().Exp_RangeIsIntersected);this.AJb.push({range:a,direction:b,mode:c,sheetArea:e,selectionMode:f})},a.prototype.remove=function(a,b){var c,e,f,g;for(void 0===b&&(b=d.SheetArea.viewport),c=this.AJb,e=this.kj.ITa,f=0;f<c.length;f++)if(g=c[f],g.sheetArea===b&&g.range.equals(a)){w(e,a,b),c.splice(f,1);break}},a.prototype.clear=function(a){var b,c,d,e,f,g,h,i,j,k=this.AJb,l=this.kj.ITa;for(b=0;b<k.length;b++)c=k[b],a!==p&&a!==c.sheetArea||w(l,c.range,c.sheetArea);if(a===p)this.AJb=[],this.xn={},this.Ny=[];else{for(d=this.AJb,b=d.length-1;b>=0;b--)d[b].sheetArea===a&&d.splice(b,1);e=this.xn,f=[];for(g in e)e[g].sheetArea===a&&f.push(g);for(h=0,i=f;h<i.length;h++)g=i[h],delete e[g];for(j=this.Ny,b=j.length-1;b>=0;b--)j[b].sheetArea===a&&j.splice(b,1)}},a.prototype.all=function(){return this.AJb},a.prototype.ICc=function(a){return this.AJb.some(function(b){return b.range.containsRange(a)})},a.prototype.RUa=function(a){this.AJb=a,this.BJb()},a.prototype.zJb=function(a,b,c){void 0===c&&(c=d.SheetArea.viewport);var e=this.xn[u(a,b,c)];return e?d.kf(e.row,e.col,e.rowCount,e.colCount):q},a.prototype.yJb=function(a){return void 0===a&&(a=d.SheetArea.viewport),this.Ny.filter(function(b){return b.sheetArea===a})},a.prototype.BJb=function(a,b){var c,e,f,g,h,i,j,k;for(this.xn={},this.Ny=[],c=this.AJb,e=this.kj,f=e.ITa,g=function(c){var g,i=c.direction,j=c.mode,k=c.sheetArea,l=b?e.Tq(c.range,k):x(e,c.range,k),o=c.selectionMode===n.merged;(o||a)&&w(f,l,k),g=void 0,i===m.column?g=A(e,j,l,k):i===m.row?g=C(e,j,l,k):i===m.columnRow?g=F(e,j,l,k):i===m.rowColumn&&(g=I(e,j,l,k)),g&&(d.GC$.extend(h.xn,g.cache),h.Ny=h.Ny.concat(g.spans),o&&g.spans.forEach(function(a){f.addSpan(a,k)}))},h=this,i=0,j=c;i<j.length;i++)k=j[i],g(k)},a.prototype.rI=function(a,b,c){var e,f,g,h,i,j;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0))for(e=this.AJb,f=0,g=e;f<g.length;f++)h=g[f],v(h.sheetArea,c,!0)&&(i=h.range,j=i.row,a<=j?i.row+=b:j<a&&a<j+i.rowCount&&(i.rowCount+=b))},a.prototype.tI=function(a,b,c){var e,f,g,h,i,j;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0))for(e=this.AJb,f=0,g=e;f<g.length;f++)h=g[f],v(h.sheetArea,c,!1)&&(i=h.range,j=i.col,a<=j?i.col+=b:j<a&&a<j+i.colCount&&(i.colCount+=b))},a.prototype.GR=function(a,b,c){var e,f,g,h,i,j,k,l,m;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0)){for(e=this.AJb,f=[],g=0;g<e.length;g++)h=e[g],v(h.sheetArea,c,!0)&&(i=h.range,j=i.row,k=i.rowCount,a<j?(l=a+b-j,l<=0?j-=b:(j-=l,i.rowCount-=l),j<0&&(i.rowCount+=j,j=0),i.row=j):j<=a&&a<j+k&&(i.rowCount-=Math.min(b,j+k-a)),0===i.rowCount&&f.push(g));for(m=f.length-1;m>=0;m--)e.splice(f[m],1)}},a.prototype.HR=function(a,b,c){var e,f,g,h,i,j,k,l,m;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0)){for(e=this.AJb,f=[],g=0;g<e.length;g++)h=e[g],v(h.sheetArea,c,!1)&&(i=h.range,j=i.col,k=i.colCount,a<j?(l=a+b-j,l<=0?j-=b:(j-=l,i.colCount-=l),j<0&&(i.colCount+=j,j=0),i.col=j):j<=a&&a<j+k&&(i.colCount-=Math.min(b,j+k-a)),0===i.colCount&&f.push(g));for(m=f.length-1;m>=0;m--)e.splice(f[m],1)}},a.prototype.CJb=function(a,b){var c,e,f;for(void 0===b&&(b=d.SheetArea.viewport),c=this.AJb,e=c.length-1;e>=0;e--)f=c[e].range,f.row!==-1&&v(c[e].sheetArea,b,!0)&&(f.row>a-1?c.splice(e,1):f.row+f.rowCount-1>a-1&&(f.rowCount=a-1-f.row+1))},a.prototype.DJb=function(a,b){var c,e,f;for(void 0===b&&(b=d.SheetArea.viewport),c=this.AJb,e=c.length-1;e>=0;e--)f=c[e].range,f.col!==-1&&v(c[e].sheetArea,b,!1)&&(f.col>a-1?c.splice(e,1):f.col+f.colCount-1>a-1&&(f.colCount=a-1-f.col+1))},a.prototype.toJSON=function(){return this.AJb.map(function(a){var b=a.range;return{range:{row:b.row,col:b.col,rowCount:b.rowCount,colCount:b.colCount},direction:a.direction,mode:a.mode,sheetArea:a.sheetArea,selectionMode:a.selectionMode}})},a.prototype.fromJSON=function(a){var b,c,e,f,g,h;if(a)for(b=this.AJb,c=0,e=a;c<e.length;c++)f=e[c],g=f.range,h=f.selectionMode,h===p&&(h=n.source),b.push({range:d.kf(g.row,g.col,g.rowCount,g.colCount),direction:f.direction,mode:f.mode,sheetArea:f.sheetArea,selectionMode:h})},a}(),d.GC$.extend(d.lUa.prototype,{EJb:function(a){var b,c=this,e=c.zTa;!e||!a&&e.originalAutoMerge||(b=c.xJb.all().map(function(a){var b=a.range;return{range:d.kf(b.row,b.col,b.rowCount,b.colCount),direction:a.direction,mode:a.mode,sheetArea:a.sheetArea,selectionMode:a.selectionMode}}),a?e.currentAutoMerge=b:e.originalAutoMerge=b)},GJb:function(a){a&&this.xJb.RUa(a)},HJb:function(a,b){this.EJb(),this.xJb.rI(a,b),this.EJb(!0)},IJb:function(a,b){this.EJb(),this.xJb.GR(a,b),this.EJb(!0)},JJb:function(a,b){this.EJb(),this.xJb.tI(a,b),this.EJb(!0)},KJb:function(a,b){this.EJb(),this.xJb.HR(a,b),this.EJb(!0)},LJb:function(a,b){this.EJb(),this.xJb.CJb(a,b),this.EJb(!0)},MJb:function(a,b){this.EJb(),this.xJb.DJb(a,b),this.EJb(!0)}}),s="autoMerge",d.lUa.$n(s,{init:function(){this.xJb=new r(this.kj)},applyChanges:function(a){var b,c=a.changes,d=a.isUndo;c&&(b=d?c.originalAutoMerge:c.currentAutoMerge,b&&this.GJb(b))},undo:function(a){var b=a.originalAutoMerge;b&&this.GJb(b)},dispose:function(a){var b=this,c=a&&a.clearCache;c!==!1&&b.xJb&&(b.xJb.no(),b.xJb=q)}});function y(a,b){var c,e,f,j=[],k=a.spans;if(k)for(c=0;c<k.length;c++)e=k[c],e&&j.push({n_:d.XFileConstants.CbK,ref:h(e)});f=g(b,i),j.length>0&&(f?f.c_=f.c_.concat(j):(b.c_.push({n_:i,c_:j}),d.util.NcK(b,[d.XFileConstants.AbK,d.XFileConstants.o7a,d.XFileConstants.EbK,d.XFileConstants.FbK,d.XFileConstants.GbK,d.XFileConstants.HbK,"sheetProtection","autoFilter",i,d.XFileConstants.IbK,d.XFileConstants.JbK,d.XFileConstants.uLc,"printOptions","pageMargins","pageSetup","headerFooter","rowBreaks","colBreaks","picture","drawing","legacyDrawing",d.XFileConstants.AiK,d.XFileConstants.yiK,d.XFileConstants.LbK,d.XFileConstants.Xkb])))}function z(a,b){var c,e,f=a.yJb(d.SheetArea.viewport);f.length>0&&(b.spans?b.spans=b.spans.concat(f):b.spans=f),c=a.yJb(d.SheetArea.rowHeader),c.length>0&&(b.rowHeaderSpan?b.rowHeaderSpan=b.rowHeaderSpan.concat(c):b.rowHeaderSpan=c),e=a.yJb(d.SheetArea.colHeader),e.length>0&&(b.colHeaderSpan?b.colHeaderSpan=b.colHeaderSpan.concat(e):b.colHeaderSpan=e)}d.Worksheet.$n(s,{init:function(){var a=this,b=a.xJb=a.ITa.xJb;a.unbind(d.Events.TopRowChanged+"."+s),a.unbind(d.Events.LeftColumnChanged+"."+s),a.bind(d.Events.TopRowChanged+"."+s,function(){var c,e,f,g,h,i,j,k,l=b.all();if(l.length>0)for(c=a.frozenColumnCount(),e=a.getColumnCount()-a.frozenTrailingColumnCount()-1,f=0,g=l;f<g.length;f++)h=g[f],i=h.sheetArea,j=h.range,i===d.SheetArea.viewport?((j.col===-1||j.col<c)&&a.repaint(a.getRangeRect(1,0,j)),(j.col===-1||j.col<=e&&j.col+j.colCount>=c)&&a.repaint(a.getRangeRect(1,1,j)),(j.col===-1||j.col+j.colCount>e)&&a.repaint(a.getRangeRect(1,2,j))):i===d.SheetArea.rowHeader&&(k=a.am(),a.repaint(k.fm(1)))}),a.bind(d.Events.LeftColumnChanged+"."+s,function(){var c,e,f,g,h,i,j,k,l=b.all();if(l.length>0)for(c=a.frozenRowCount(),e=a.getRowCount()-a.frozenTrailingRowCount()-1,f=0,g=l;f<g.length;f++)h=g[f],i=h.sheetArea,j=h.range,i===d.SheetArea.viewport?((j.row===-1||j.row<c)&&a.repaint(a.getRangeRect(0,1,j)),(j.row===-1||j.row<=e&&j.row+j.rowCount>=c)&&a.repaint(a.getRangeRect(1,1,j)),(j.row===-1||j.row+j.rowCount>e)&&a.repaint(a.getRangeRect(2,1,j))):i===d.SheetArea.colHeader&&(k=a.am(),a.repaint(k.gm(1)))})},dispose:function(a){a.clearCache!==!1&&(this.xJb=q,this.unbind(d.Events.TopRowChanged+"."+s),this.unbind(d.Events.LeftColumnChanged+"."+s))},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=a.rowCount,e=a.col,f=a.colCount,g=a.sheetArea,h=this.ITa;"addRows"===b?h.HJb(c,d):"deleteRows"===b?h.IJb(c,d):"addColumns"===b?h.JJb(e,f):"deleteColumns"===b?h.KJb(e,f):"setRowCount"===b?h.LJb(d,g):"setColumnCount"===b&&h.MJb(f,g),"invalidateLayout"===b&&this.Xq<=0&&this.xJb.BJb()},toJson:function(a,b){var c,d=b&&b.ignoreStyle;d||(c=this.xJb,a.autoMergeRangeInfos=c.toJSON(),b&&b.includeAutoMergedCells&&(c.BJb(!0,!0),z(c,a)))},fromJson:function(a,b,c){var d=c&&c.ignoreStyle;d||this.xJb.fromJSON(a.autoMergeRangeInfos)},bdK:function(a,b,c){var d,e,f,g=c&&c.includeStyles===!1;g||(a.lossless.autoMerge={},d=this.xJb,a.lossless.autoMerge.autoMergeRangeInfos=d.toJSON(),e=d.kj.ODJ,c&&c.includeAutoMergedCells&&!e&&(f={},d.BJb(!0,!0),z(d,f),y(f,a)))},cdK:function(a,b,c){var d=c&&c.includeStyles===!1;!d&&a.lossless&&a.lossless.autoMerge&&this.xJb.fromJSON(a.lossless.autoMerge.autoMergeRangeInfos)}}),d.Workbook.$n(s,{onCultureChanged:function(){k()}}),d.GC$.extend(d.Worksheet.prototype,{autoMerge:function(a,b,c,e,f){void 0===b&&(b=m.column),void 0===c&&(c=l.free),void 0===e&&(e=d.SheetArea.viewport),void 0===f&&(f=n.source);var g=this.xJb;return 0===arguments.length?g.all():void(a&&(this.ITa.EJb(),b===m.none?g.remove(a,e):g.add(a,b,c,e,f),this.$p()))}});function A(a,b,c,e){var f,g,h,i,j,k,m,n,r={},s=[],t=c.row,u=c.row+c.rowCount-1,v=c.col,w=c.col+c.colCount-1;for(f=v;f<=w;f++)if(a.getColumnVisible(f,e)&&!(a.getColumnWidth(f,e)<=0)){for(g=b===l.restricted,h=g&&f>v,i=void 0,j=t;j<=u;)if(!a.getRowVisible(j,e)||a.getRowHeight(j,e)<=0)j++;else{if(k=a._q(j,e,!0),k===q||k>u)break;if(E(a,j,f,k,f,e)){if(h&&!B(a,r,j,f,k,f,e)){i&&(m=new o(i,e),s.push(m),H(r,i,m),i=p),j=k;continue}n=k-j+1,i?i.rowCount+=n-1:i=d.kf(j,f,n,1)}else i&&(m=new o(i,e),s.push(m),H(r,i,m),i=p);j=k}i&&(m=new o(i,e),s.push(m),H(r,i,m),i=p)}return{cache:r,spans:s}}function B(a,b,c,d,e,f,g){var h=a.br(d,g,!0),i=b[u(c,h,g)];return i&&i.sheetArea===g&&i.row<=c&&e<=i.row+i.rowCount-1}function C(a,b,c,e){var f,g,h,i,j,k,m,n,r={},s=[],t=c.row,u=c.row+c.rowCount-1,v=c.col,w=c.col+c.colCount-1;for(f=t;f<=u;f++)if(a.getRowVisible(f,e)&&!(a.getRowHeight(f,e)<=0)){for(g=b===l.restricted,h=g&&f>t,i=void 0,j=v;j<=w;)if(!a.getColumnVisible(j,e)||a.getColumnWidth(j,e)<=0)j++;else{if(k=a.Zq(j,e,!0),k===q||k>w)break;if(E(a,f,j,f,k,e)){if(h&&!D(a,r,f,j,f,k,e)){i&&(m=new o(i,e),s.push(m),H(r,i,m),i=p),j=k;continue}n=k-j+1,i?i.colCount+=n-1:i=d.kf(f,j,1,n)}else i&&(m=new o(i,e),s.push(m),H(r,i,m),i=p);j=k}i&&(m=new o(i,e),s.push(m),H(r,i,m),i=p)}return{cache:r,spans:s}}function D(a,b,c,d,e,f,g){var h=a.gr(c,g,!0),i=b[u(h,d,g)];return i&&i.sheetArea===g&&i.col<=d&&f<=i.col+i.colCount-1}function E(a,b,c,d,e,f){var g=a.ITa,h=a.getText(b,c,f),i=a.getText(d,e,f),j="[object Object]",k=""===h&&""===i&&!a.ODJ,l=h===j&&i===j;return!k&&!l&&(h===i&&(!g.findSpan(b,c,f)&&!g.findSpan(d,e,f)))}function F(a,b,c,e){var f,g,h,i,j,k,l,m=A(a,b,c,e),n=m.cache,p=m.spans,r=c.row,s=c.row+c.rowCount-1,t=c.col,v=c.col+c.colCount-1;for(f=r;f<=s;f++)if(a.getRowVisible(f,e)&&!(a.getRowHeight(f,e)<=0))for(g=t;g<=v;g++)if(a.getColumnVisible(g,e)&&!(a.getColumnWidth(g,e)<=0)){if(h=a.Zq(g,e,!0),h===q||h>v)break;E(a,f,g,f,h,e)&&(i=n[u(f,g,e)],j=n[u(f,h,e)],i&&j?i.row===f&&j.row===f&&i.rowCount===j.rowCount&&(i.colCount+=h-g,G(p,j),H(n,j,i)):i?1===i.rowCount&&(i.colCount+=h-g,H(n,new d.Range(f,h,1,1),i)):j?1===j.rowCount&&(j.col=g,j.colCount+=h-g,H(n,new d.Range(f,g,1,1),j)):(k=new d.Range(f,g,1,h-g+1),l=new o(k,e),p.push(l),H(n,k,l)))}return{cache:n,spans:p}}function G(a,b){var c,d;for(c=0;c<a.length;c++)if(d=a[c],d.sheetArea===b.sheetArea&&d.equals(b)){a.splice(c,1);break}}function H(a,b,c){var d,e,f=c.sheetArea;for(d=0;d<b.rowCount;d++)for(e=0;e<b.colCount;e++)a[u(b.row+d,b.col+e,f)]=c}function I(a,b,c,e){var f,g,h,i,j,k,l,m=C(a,b,c,e),n=m.cache,p=m.spans,r=c.row,s=c.row+c.rowCount-1,t=c.col,v=c.col+c.colCount-1;for(f=t;f<=v;f++)if(a.getColumnVisible(f,e)&&!(a.getColumnWidth(f,e)<=0))for(g=r;g<=s;g++)if(a.getRowVisible(g,e)&&!(a.getRowHeight(g,e)<=0)){if(h=a._q(g,e,!0),h===q||h>s)break;E(a,g,f,h,f,e)&&(i=n[u(g,f,e)],j=n[u(h,f,e)],i&&j?i.col===f&&j.col===f&&i.colCount===j.colCount&&(i.rowCount+=h-g,G(p,j),H(n,j,i)):i?1===i.colCount&&(i.rowCount+=h-g,H(n,new d.Range(h,f,1,1),i)):j?1===j.colCount&&(j.row=g,j.rowCount+=h-g,H(n,new d.Range(g,f,1,1),j)):(k=new d.Range(g,f,h-g+1,1),l=new o(k,e),p.push(l),H(n,k,l)))}return{cache:n,spans:p}}},"./dist/plugins/autoMerge/autoMerge.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_RangeIsIntersected="The range should not intersect with exsit ranges."},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets}});