/*!
 * 
 * SpreadJS Library 16.0.2
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Sparklines=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/sparkline/sparkline-wrapper.entry.js")}({"./dist/plugins/sparkline/functions-sparkline.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("CalcEngine"),e=c("Core"),f=c("Common"),g=c("./dist/plugins/sparkline/sparkline-wrapper.js"),k=d.Convert.Fh,l=d.Convert.Ca,m=d.Functions&&d.Functions.Function,n=d.Functions&&d.Functions.bi,o=f.Common.j.Fa,p=f.Common.j.jk,q=e.GC$,r=q.inherit,s=q.extend,t=f.Sparklines.SparklineRender,u=f.Sparklines.SparklineExRenders,v=d.Errors.Value,w=e.util.fp,x=e.Vn.Xn,y=e.To.No,z=Math.floor,A=Math.min,B=null,C=void 0,D=isNaN,E=parseFloat,F=NaN,G="12px Calibri",H="PIESPARKLINE",I="AREASPARKLINE",J="SCATTERSPARKLINE",K="BULLETSPARKLINE",L="SPREADSPARKLINE",M="STACKEDSPARKLINE",N="HBARSPARKLINE",O="VBARSPARKLINE",P="VARISPARKLINE",Q="BOXPLOTSPARKLINE",R="CASCADESPARKLINE",S="PARETOSPARKLINE",T="MONTHSPARKLINE",U="YEARSPARKLINE",V="LINESPARKLINE",W="COLUMNSPARKLINE",X="WINLOSSSPARKLINE",Y="RANGEBLOCKSPARKLINE",Z="GAUGEKPISPARKLINE",$="HISTOGRAMSPARKLINE",_="IMAGE",function(a){a[a.fit=1]="fit",a[a.entireFit=2]="entireFit",a[a.originFit=3]="originFit",a[a.custom=4]="custom"}(aa||(aa={}));function Aa(a){return 0===a}function Ba(a){return 0===a||2===a}function Ca(a){return Ba(a)||8===a}function Da(a){return 0===a||1===a}function Ea(a){return 0<=a&&a<=2}function Fa(a){return 2===a||3===a}function Ga(a){return 1===a||2===a}function Ha(a,b){var c,d,e,f,g,h,i,j,m,n,o=[];if(k(a))for(c=0,d=a.getRangeCount();c<d;c++)for(e=a.getRowCount(c),f=a.getColumnCount(c),g=0;g<e;g++)for(h=0;h<f;h++)o.push(a.getValue(c,g,h));else if(b&&l(a))for(i=a.getRowCount(),j=a.getColumnCount(),m=0;m<i;m++)for(n=0;n<j;n++)o.push(a.getValue(m,n));return o}function Ia(a,b,c){var d,e,f,g,h,i,j,m,n,o=[];if(k(a)){if(d=a.getRangeCount(),d>b)for(e=a.getRowCount(b),f=a.getColumnCount(b),g=0;g<e;g++)for(o[g]=[],h=0;h<f;h++)o[g].push(a.getValue(b,g,h))}else if(c&&l(a))for(i=a.getRowCount(),j=a.getColumnCount(),m=0;m<i;m++)for(o[m]=[],n=0;n<j;n++)o[m][n]=a.getValue(m,n);return o}function Ja(a){var b;return k(a)?b=a.getValue(0,0,0):o(a)||(b=a),b}ba=function(){function a(a,b){this.name=a,this.value=b,this.typeName="SparklineExValue"}return a.prototype.toString=function(){return""},a}(),b.SparklineExValue=ba,ca=function(){function a(){var a,b,c=this.createFunction();c&&(a=c.name,b=c.evaluate,c.evaluate=function(){var c=b.call(this,arguments);return c instanceof d.CalcError?c:c?new ba(a,c):B},this.Cj=a,a&&!d.Functions.findGlobalFunction(a)&&(d.Functions.ci[a]=c)),this.typeName=""}return a.prototype.name=function(){return this.Cj},a.prototype.createFunction=function(){return B},a.prototype.paint=function(a,b,c,d,e,f,g){},a.prototype.toJSON=function(){var a,b={};for(a in this)this.hasOwnProperty(a)&&(b[a]=this[a]);return b},a.prototype.fromJSON=function(a){if(a)for(var b in a)o(a[b])||(this[b]=a[b])},a}(),b.SparklineEx=ca,da=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.PieSparkline=da,s(da.prototype,{createFunction:function(){var a=new m(H,1,255);return a.evaluate=function(a){var b=a[0],c=Ha(b,!0);return c.length<=0&&!o(b)&&c.push(b),{values:c,colors:Array.prototype.slice.call(a,1)}},a.acceptsReference=Aa,a.acceptsArray=Aa,a},paint:u[H]}),ea=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.AreaSparkline=ea,s(ea.prototype,{createFunction:function(){var a=new m(I,1,7);return a.evaluate=function(a){return{points:Ha(a[0],!0),mini:a[1],maxi:a[2],line1:a[3],line2:a[4],colorPositive:a[5],colorNegative:a[6]}},a.acceptsReference=Aa,a.acceptsArray=Aa,a},paint:u[I]}),fa=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.ScatterSparkline=fa,s(fa.prototype,{createFunction:function(){var a=new m(J,1,18);return a.evaluate=function(a){var b=Ia(a[0],0,!0),c=Ia(a[1],0,!0);return{points1:b,points2:c,minX:a[2],maxX:a[3],minY:a[4],maxY:a[5],hLine:a[6],vLine:a[7],xMinZone:a[8],xMaxZone:a[9],yMinZone:a[10],yMaxZone:a[11],tags:a[12],drawSymbol:a[13],drawLines:a[14],color1:a[15],color2:a[16],dash:a[17]}},a.acceptsReference=Da,a.acceptsArray=Da,a},paint:u[J]}),ga=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.BulletSparkline=ga,s(ga.prototype,{createFunction:function(){var a=new m(K,3,17);return a.evaluate=function(a){return{measure:Ja(a[0]),target:Ja(a[1]),maxi:Ja(a[2]),good:Ja(a[3]),bad:Ja(a[4]),forecast:Ja(a[5]),tickUnit:Ja(a[6]),colorScheme:a[7],vertical:a[8],measureColor:a[9],targetColor:a[10],maxiColor:a[11],goodColor:a[12],badColor:a[13],forecastColor:a[14],allowMeasureOverMaxi:a[15],barSize:a[16]}},a.acceptsReference=function(a){return 0<=a&&a<=6},a},paint:u[K]}),ha=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.SpreadSparkline=ha,s(ha.prototype,{createFunction:function(){function a(a){var b,c,d,e,f=[];for(c=0,d=0,e=a.length;c<e;c++)b=E(a[c]),!D(b)&&isFinite(b)&&(f[d]=b,d++);return f}function b(a){var b,c,d,e,f,g={};for(b=0,c=void 0,d=a.length;b<d;b++)c=a[b],g[c]?g[c]++:g[c]=1;e=[];for(f in g)g.hasOwnProperty(f)&&e.push({key:E(f),value:g[f]});return e.sort(function(a,b){return a.key-b.key})}var c=new m(L,1,7);return c.evaluate=function(c){var d,e,f,g,h,i,j,k,l=Ha(c[0],!0),m=[];if(!o(l)&&(l=a(l),m=b(l),d=c[4],3===d))for(e=0,f=m.length;e<f;e++){for(g=m[e],h=g.value,i=[],j=Math.max(100,10*h),k=0;k<j+h-1;k++)i.push(Math.random());g.randomNumbers=i}return{spreadData:m,showAverage:c[1],scaleStart:c[2],scaleEnd:c[3],style:d,colorScheme:c[5],vertical:c[6]}},c.acceptsReference=Aa,c.acceptsArray=Aa,c},paint:u[L]}),ia=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.StackedSparkline=ia,s(ia.prototype,{createFunction:function(){var a=new m(M,1,13);return a.evaluate=function(a){return{points:Ha(a[0],!0),colorRange:Ha(a[1],!0),labelRange:Ha(a[2],!0),maximum:a[3],targetRed:a[4],targetGreen:a[5],targetBlue:a[6],targetYellow:a[7],color:a[8],highlightPosition:a[9],vertical:a[10],textOrientation:a[11],textSize:a[12]}},a.acceptsReference=Ea,a.acceptsArray=Ea,a},paint:u[M]}),ja=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.HBarSparkline=ja,s(ja.prototype,{createFunction:function(){var a=new m(N,1,4);return a.evaluate=function(a){return{value:Ja(a[0]),colorScheme:a[1],axisVisible:a[2],barHeight:a[3]}},a.acceptsReference=Aa,a},paint:u[N]}),ka=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.VBarSparkline=ka,s(ka.prototype,{createFunction:function(){var a=new m(O,1,4);return a.evaluate=function(a){return{value:Ja(a[0]),colorScheme:a[1],axisVisible:a[2],barWidth:a[3]}},a.acceptsReference=Aa,a},paint:u[O]}),la=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.VariSparkline=la,s(la.prototype,{createFunction:function(){var a=new m(P,1,10);return a.evaluate=function(a){return{variance:Ja(a[0]),reference:Ja(a[1]),mini:Ja(a[2]),maxi:Ja(a[3]),mark:Ja(a[4]),tickUnit:Ja(a[5]),legend:a[6],colorPositive:a[7],colorNegative:a[8],vertical:a[9]}},a.acceptsReference=function(a){return 0<=a&&a<=5},a},paint:u[P]}),ma=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.BoxPlotSparkline=ma,s(ma.prototype,{createFunction:function(){function a(a,b){return k(a)&&!D(b)&&0<=b&&b<=100?n.PERCENTILE.evaluate(a,b/100):F}function b(a){return k(a)?n.STDEVP.evaluate(a):F}var c=new m(Q,1,10);return c.evaluate=function(c){var d=c[0];return{points:Ha(d,!0),boxPlotClass:c[1],showAverage:c[2],scaleStart:Ja(c[3]),scaleEnd:Ja(c[4]),acceptableStart:Ja(c[5]),acceptableEnd:Ja(c[6]),colorScheme:c[7],style:c[8],vertical:c[9],perc02:a(d,2),perc09:a(d,9),perc10:a(d,10),perc90:a(d,90),perc91:a(d,91),perc98:a(d,98),q1:a(d,25),q3:a(d,75),median:a(d,50),stDev:b(d)}},c.acceptsReference=Aa,c.acceptsArray=Aa,c},paint:u[Q]}),na=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.CascadeSparkline=na,s(na.prototype,{createFunction:function(){var a=new m(R,1,10);return a.evaluate=function(a){return{points:Ha(a[0],!0),pointIndex:Ja(a[1]),labels:Ha(a[2],!0),minimum:Ja(a[3]),maximum:Ja(a[4]),colorPositive:a[5],colorNegative:a[6],vertical:a[7],itemTypeRange:Ha(a[8],!0),colorTotal:a[9]}},a.acceptsReference=Ca,a.acceptsArray=Ca,a},paint:u[R]}),oa=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.ParetoSparkline=oa,s(oa.prototype,{createFunction:function(){var a=new m(S,2,12);return a.evaluate=function(a){return{points:Ha(a[0],!0),pointIndex:Ja(a[1]),colorRange:Ha(a[2],!0),target:Ja(a[3]),target2:Ja(a[4]),highlightPosition:Ja(a[5]),label:a[6],vertical:a[7],targetColor:a[8],target2Color:a[9],labelColor:a[10],barSize:a[11]}},a.acceptsReference=Ba,a.acceptsArray=Ba,a},paint:u[S]}),pa=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.MonthSparkline=pa,s(pa.prototype,{createFunction:function(){var a=new m(T,3,7);return a.evaluate=function(a){var b,c,d,e,f,g,h,i,j,m=a[0],n=a[1],o=a[2],p=o;for((k(o)||l(o))&&(p=Ia(o,0,!0)),b=a[3],c=[],(k(b)||l(b))&&(c=Ia(b,0,!0)),d=[],e=[],f=0,g=p.length;f<g;f++)h=p[f],h&&(i=h[0],"string"==typeof i&&(i=new Date(i)),i&&i.getFullYear()===m&&i.getMonth()+1===n&&(j=i.getDate()-1,d[j]=h[1],c.length>0&&(e[j]=c[f][0])));return c.length>0?{year:m,month:n,values:d,colors:e}:{year:m,month:n,values:d,emptyColor:b,startColor:a[4],middleColor:a[5],endColor:a[6]}},a.acceptsReference=Fa,a.acceptsArray=Fa,a},paint:u[T]}),qa=function(a){za(b,a);function b(){return a.call(this)||this}return b.daysOfMonth=function(a,b){switch(b){case 2:var c=a%4===0&&a%100!==0||a%400===0;return c?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},b.dayInYear=function(a){var c,d=a.getFullYear(),e=a.getMonth(),f=a.getDate();for(c=1;c<e+1;c++)f+=b.daysOfMonth(d,c);return f},b}(ca),b.YearSparkline=qa,s(qa.prototype,{createFunction:function(){var a=new m(U,2,6);return a.evaluate=function(a){var b,c,d,e,f,g,h,i,j,m=a[0],n=a[1],o=n;for((k(n)||l(n))&&(o=Ia(n,0,!0)),b=a[2],c=[],(k(b)||l(b))&&(c=Ia(b,0,!0)),d=[],e=[],f=0,g=o.length;f<g;f++)h=o[f],h&&(i=h[0],"string"==typeof i&&(i=new Date(i)),i&&i.getFullYear()===m&&(j=qa.dayInYear(i)-1,d[j]=h[1],c.length>0&&(e[j]=c[f][0])));return c.length>0?{year:m,values:d,colors:e}:{year:m,values:d,emptyColor:b,startColor:a[3],middleColor:a[4],endColor:a[5]}},a.acceptsReference=Ga,a.acceptsArray=Ga,a},paint:u[U]}),ra=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.HistogramSparkline=ra,s(ra.prototype,{createFunction:function(){var a=this,b=new m($,1,9);return b.acceptsArray=function(){return!0},b.evaluate=function(b){var c,e,f,g,h,i,j,k,l,m=b[0],n=[];if(!(m instanceof d.CalcArray||m instanceof d.CalcReference))throw d.CalcError;if(n=a.OIc(m),c=b[1],o(c)&&(c=!0),e=b[2]===!0,f=b[3],o(f)&&(f=1),f<=0)throw d.CalcError;if(g=b[4],o(g)&&(g=1),g>1||g<=0)throw d.CalcError;return h=b[5]||"#5B9BD5",i=b[6],j=b[7]||"#000000",k=b[8]||"#C0C0C0",l=c?a.PIc(n,f):a.QIc(n),{values:l,continuous:c,paintLabel:e,barWidth:g,barColor:h,labelFontStyle:i,labelColor:j,edgeColor:k}},b.acceptsReference=function(a){return 0===a},b},OIc:function(a){var b,c,e=[];if(a instanceof d.CalcArray)for(b=a.toArray(1),c=0;c<b.length;c++)e.push(b[c]);else b=Ia(a,0),b.forEach(function(a){a.forEach(function(a){o(a)||"number"!=typeof a||isNaN(a)||e.push(a)})});return e},PIc:function(a,b){var c,d,e,g,h,i,j,k=[],l=0,m=this;for(a.forEach(function(a){k[l]=a,l++}),c=[],d=g=k[0],k.forEach(function(a){d=Math.min(a,d),g=Math.max(a,g)}),e=z(d/b)*b,h=Math.ceil(g/b)*b,i=1!==k.length?Math.round((h-e)/b):1,l=0;l<i;l++)c[l]=f.Common.o.Lma(l*b+e,15);for(g>=c[l-1]&&(c[l]=c[l-1]+b),j=[],l=0,i=c.length-1;l<i;l++)j[l]={value:0};for(j.length>0&&(j[0].axis="["+c[0]+","+c[1]+"]"),l=1;l<c.length-1;l++)o(c[l+1])?j[l].axis="("+c[l]+","+(c[l]+b)+"]":j[l].axis="("+c[l]+","+c[l+1]+"]";return k.forEach(function(a){var b=m.RIc(c,a);j[b].value++}),j.length>0&&0===j[0].value&&j.splice(0,1),j},QIc:function(a){var b,c,d,e,f=this,g={};for(b=0,c=a.length;b<c;++b)d=a[b],void 0===g[d]?g[d]=1:g[d]++;return e=f.SIc(g),e.sort(function(a,b){return a-b}),e.map(function(a){return{axis:a,value:g[a]}})},SIc:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&void 0!==a[b]&&null!==a[b]&&c.push(b);return c},RIc:function(a,b){var c,d,e,f,g=a.length;if(a[0]===b)return 0;if(0===g)return 0;c=0,d=g-1,e=z(d/2);do{if(f=e,b>a[e]&&b<=a[e+1])return e;b<=a[e]?(d=e,e=z((d+c)/2)):b>a[e+1]&&(c=e,e=z((e+d)/2))}while(f!==e)},paint:function(a,b,c,d,f,g,h){var i,j,k=b.labelFontStyle,l=h.zoomFactor;o(k)&&(k=a.font),i=e.To.No(k,l),j=e.To.Ko(i.font),b.afterZoomFontStyle={fontStyle:j.fontStyle,fontFamily:j.fontFamily,fontSize:j.fontSize,fontWeight:j.fontWeight,fontPixelSize:i.fontSize},u[$](a,b,c,d,f,g,h)}}),sa=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.ImageSparkline=sa,s(sa.prototype,{createFunction:function(){var a=new m(_,1,10);return a.evaluate=function(a){var b=a[0],c=a[1]||aa.fit,f=a[2],g=a[3],h=a[4]||0,i=a[5]||0,j=a[6],k=a[7],l=a[8],m=a[9];if([0,1,2].indexOf(l)===-1&&(l=e.VerticalAlign.center),[0,1,2].indexOf(m)===-1&&(m=e.HorizontalAlign.center),c===aa.custom&&(f===C||g===C))throw d.CalcError;return f=f<0?0:f,g=g<0?0:g,i=i<0?0:i,h=h<0?0:h,j=j<0?0:j,k=k<0?0:k,[1,2,3,4].indexOf(c)===-1&&(c=1),{url:b,drawType:c,height:f,width:g,clipY:h,clipX:i,clipWidth:k,clipHeight:j,vAlign:l,hAlign:m}},a},FBJ:function(a,b,c,d,f){var g,h,i,j,k,l,m,n,o=a.width,p=a.height,q=a.x,r=a.y,s=b.width,t=b.height,u={clipX:0,clipY:0,clipHeight:t,clipWidth:s,paintX:0,paintY:0,paintHeight:0,paintWidth:0};if(u=this.MBJ(u,b,c),g=o/p,h=u.clipWidth/u.clipHeight,g<h)switch(i=d.vAlign,u.paintWidth=o,j=o/h,u.paintHeight=j,u.paintX=q,i){case e.VerticalAlign.top:u.paintY=r;break;case e.VerticalAlign.center:k=p-j,u.paintY=r+k/2;break;case e.VerticalAlign.bottom:u.paintY=r+p-j}else switch(l=d.hAlign,u.paintHeight=p,m=p*h,u.paintWidth=m,u.paintY=r,l){case e.HorizontalAlign.left:u.paintX=q;break;case e.HorizontalAlign.center:n=o-m,u.paintX=q+n/2;break;case e.HorizontalAlign.right:u.paintX=q+o-m}return u},GBJ:function(a,b,c,d,e){var f={cutX:0,cutY:0,cutHeight:b.width,cutWidth:b.height,paintX:a.x,paintY:a.y,paintHeight:a.height,paintWidth:a.width};return this.MBJ(f,b,c)},MBJ:function(a,b,c){var d=b.width,e=b.height,f=c.clipX||0,g=c.clipY||0;return o(c.clipX)||(a.clipX=A(c.clipX,d)),o(c.clipY)||(a.clipY=A(c.clipY,e)),o(c.clipWidth)?a.clipWidth=d-a.clipX:a.clipWidth=c.clipWidth+f>d?d-f:c.clipWidth,o(c.clipHeight)?a.clipHeight=e-a.clipY:a.clipHeight=c.clipHeight+g>e?e-g:c.clipHeight,a},HBJ:function(a,b,c,d,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t=a.width,u=a.height,v=a.x,w=a.y,x={imgWidth:b.width,imgHeight:b.height,offsetX:0,offsetY:0};if(x=this.NBJ(x,b,c),g=x.imgWidth,h=x.imgHeight,i=x.offsetX,j=x.offsetY,k=g*f,l=h*f,m={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},n=d.hAlign,o=d.vAlign,k>t){switch(m.paintWidth=t,m.paintX=v,p=(k-t)/k*g,n){case e.HorizontalAlign.left:m.clipX=x.offsetX;break;case e.HorizontalAlign.center:m.clipX=x.offsetX+p/2;break;case e.HorizontalAlign.right:m.clipX=x.offsetX+p}m.clipWidth=t}else{switch(m.clipWidth=g,m.clipX=0,m.paintWidth=k,q=t-k,n){case e.HorizontalAlign.general:case e.HorizontalAlign.left:m.paintX=v;break;case e.HorizontalAlign.center:m.paintX=v+q/2;break;case e.HorizontalAlign.right:m.paintX=v+q}m.clipX+=i}if(l>u){switch(m.paintY=w,m.paintHeight=u,r=(l-u)/l*h,o){case e.VerticalAlign.top:m.clipY=x.offsetY;break;case e.VerticalAlign.center:m.clipY=x.offsetY+r/2;break;case e.VerticalAlign.bottom:m.clipY=x.offsetY+r}m.clipHeight=u}else{switch(m.clipHeight=h,m.clipY=0,m.paintHeight=l,s=u-l,o){case e.VerticalAlign.top:m.paintY=w;break;case e.VerticalAlign.center:m.paintY=w+s/2;break;case e.VerticalAlign.bottom:m.paintY=w+s}m.clipY+=j}return m},IBJ:function(a,b,c,d,f){var g,h,i,j,k,l,m,n,p,q,r,s,t,u,v,w,x,y={clipX:0,clipY:0,clipHeight:0,clipWidth:0,paintX:0,paintY:0,paintHeight:0,paintWidth:0},z=b.customWidth*f,A=b.customHeight*f;if(null===z||z<0||null===A||z<0)return y;if(g=a.width,h=a.height,i=a.x,j=a.y,k={imgWidth:b.width,imgHeight:b.height,offsetX:0,offsetY:0},k=this.NBJ(k,b,c),l=k.imgWidth,m=k.imgHeight,n=k.offsetX,p=k.offsetY,q=d.hAlign,r=d.vAlign,z>g){switch(y.paintWidth=g,y.paintX=i,s=(z-g)/z,t=s*l,q){case e.HorizontalAlign.left:y.clipX=k.offsetX;break;case e.HorizontalAlign.center:y.clipX=k.offsetX+t/2;break;case e.HorizontalAlign.right:y.clipX=k.offsetX+t}y.clipWidth=k.imgWidth*(1-s)}else{switch(y.clipWidth=l,y.clipX=0,y.paintWidth=z,u=g-z,q){case e.HorizontalAlign.general:case e.HorizontalAlign.left:y.paintX=i;break;case e.HorizontalAlign.center:y.paintX=i+u/2;break;case e.HorizontalAlign.right:y.paintX=i+u}y.clipX+=n}if(A>h){switch(y.paintY=j,y.paintHeight=h,v=(A-h)/A,w=v*m,r){case e.VerticalAlign.top:y.clipY=k.offsetY;break;case e.VerticalAlign.center:y.clipY=k.offsetY+w/2;break;case e.VerticalAlign.bottom:y.clipY=k.offsetY+w}y.clipHeight=k.imgHeight*(1-v)}else{switch(y.clipHeight=o(c.clipHeight)?m:k.imgHeight,y.clipY=0,y.paintHeight=A,x=h-A,r){case e.VerticalAlign.top:y.paintY=j;break;case e.VerticalAlign.center:y.paintY=j+x/2;break;case e.VerticalAlign.bottom:y.paintY=j+x}y.clipY+=p}return y},NBJ:function(a,b,c){var d=b.width,e=b.height;return o(c.clipX)||(a.offsetX=A(d,c.clipX)),o(c.clipY)||(a.offsetY=A(e,c.clipY)),o(c.clipWidth)?a.imgWidth=d-a.offsetX:a.imgWidth=c.clipWidth+a.offsetX>d?d-a.offsetX:c.clipWidth,o(c.clipHeight)?a.imgHeight=e-a.offsetY:a.imgHeight=c.clipHeight+a.offsetY>e?e-a.offsetY:c.clipHeight,a},paint:function(a,b,c,d,e,f,g){var h,i,j,k,l;if(!o(b)&&!o(b.url)&&p(b.url)&&""!==b.url.trim()){h=this,i=g.sheet,j={x:c,y:d,width:e,height:f},k=i.vu();try{l=b.url,k.ko(l)?h.JBJ(a,b,j,g):k.fo(l)}catch(a){}}},JBJ:function(a,b,c,d){var e,f,g,h,i,j,k,l=this,m=b.url,n=d.sheet,o=b.drawType,p=n.bt;if(m&&"string"==typeof m&&p.CHb(m)){switch(e=p.lo(m),f={width:e.width,height:e.height},g={clipY:b.clipY,clipX:b.clipX,clipWidth:b.clipWidth,clipHeight:b.clipHeight},h={vAlign:b.vAlign,hAlign:b.hAlign},j=d.zoomFactor,o){case aa.fit:i=l.FBJ(c,f,g,h,j);break;case aa.entireFit:i=l.GBJ(c,f,g,h,j);break;case aa.originFit:i=l.HBJ(c,f,g,h,j);break;case aa.custom:f.customWidth=b.width,f.customHeight=b.height,i=l.IBJ(c,f,g,h,j)}i.img=e,k="IMAGESPARKLINE",u[k](a,i,c.x,c.y,c.width,c.height,d)}}});function Ka(a,b){function c(a){var b,c,d,e,f,g={},h=!1,i=!0,j="",k="";if(a){for(a=a.substr(1,a.length-2),b=0,c=a.length;b<c;b++)d=a.charAt(b),":"===d?i=!1:","!==d||h?"'"===d||'"'===d||("("===d?h=!0:")"===d&&(h=!1),i?j+=d:k+=d):(g[j]=k,j="",k="",i=!0);j&&(g[j]=k);for(e in g)g.hasOwnProperty(e)&&(f=g[e],o(f)||("TRUE"===f.toUpperCase()?g[e]=!0:"FALSE"===f.toUpperCase()?g[e]=!1:!D(f)&&isFinite(f)&&(g[e]=E(f))))}return g}function d(a){return new e.Range(a.getRow(0),a.getColumn(0),a.getRowCount(0),a.getColumnCount(0))}function f(a){return new e.Range(0,0,a.getRowCount(),a.getColumnCount())}var h=new m(a,2,5);return h.evaluate=function(a){var e,h,i,j,m,n,p,q,r,s,t,u,v,w,x=a[0],y=l(x);if((k(x)||y)&&(e=y?1:x.getRangeCount(),e>0)){h=y?f(x):d(x),i=y?"":x.getSource().getSheet().name(),j=a[1],m=a[2],n=void 0,p=void 0,q=void 0,r=l(m),(k(m)||r)&&(q=r?"":m.getSource().getSheet().name(),e=r?1:m.getRangeCount(),e>0&&(n=r?f(m):d(m),p=a[3])),s=c(a[4]||"{}"),t={ac:"axisColor",fmc:"firstMarkerColor",hmc:"highMarkerColor",lastmc:"lastMarkerColor",lowmc:"lowMarkerColor",mc:"markersColor",nc:"negativeColor",sc:"seriesColor",deca:"displayEmptyCellsAs",rtl:"rightToLeft",dh:"displayHidden",dxa:"displayXAxis",sf:"showFirst",sh:"showHigh",slast:"showLast",slow:"showLow",sn:"showNegative",sm:"showMarkers",mmax:"manualMax",mmin:"manualMin",maxat:"maxAxisType",minat:"minAxisType",lw:"lineWeight"};for(u in t)t.hasOwnProperty(u)&&s.hasOwnProperty(u)&&(s[t[u]]=s[u]);return v=new g.SparklineSetting(s),w=v.options,1===w.maxAxisType&&(w.maxAxisType=0),1===w.minAxisType&&(w.minAxisType=0),{data:h,dataSheetName:i,dataOrientation:j,dateAxisData:n,dateAxisDataSheetName:q,dateAxisOrientation:p,sparklineType:b,displayDateAxis:n&&!o(p),setting:v,values:Ia(x,0,!0),dateValues:Ia(m,0,!0)}}},h.acceptsReference=Ba,h.acceptsArray=Ba,h}function La(a,b,c,d,f,h,i){var j,k,l=g.Sparkline.cT,m=i.sheet,n=m.parent.getSheetFromName(b.dataSheetName),o=m.parent.getSheetFromName(b.dateAxisDataSheetName),p=b.setting;p&&p.options||(p=new g.SparklineSetting(p)),j=p.options.displayHidden,k={sparklineType:b.sparklineType,displayDateAxis:b.displayDateAxis,zoomFactor:i.zoomFactor,values:l(b.values,n||m,j,b.data,b.dataOrientation),dateValues:l(b.dateValues,o||m,j,b.dateAxisData,b.dateAxisOrientation,!0),settings:p,getColor:function(a){if(m&&a){var b=e.Rm.Om(m,a);if(b)return b}return a}},(new t).paint(a,k,c,d,f,h)}ta=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.LineSparkline=ta,s(ta.prototype,{createFunction:function(){return Ka(V,0)},paint:La}),ua=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.ColumnSparkline=ua,s(ua.prototype,{createFunction:function(){return Ka(W,1)},paint:La}),va=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.WinlossSparkline=va,s(va.prototype,{createFunction:function(){return Ka(X,2)},paint:La}),wa=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.RangeBlockSparkline=wa,s(wa.prototype,{createFunction:function(){var a=new m(Y,2,2);return a.evaluate=function(a){var b=a[0],c=b.source.getSheet(),f=a[1],g=0,h=f.getSource().getSheet(),i=f.getRow(g),j=f.getColumn(g),k=f.getRowCount(g),l=f.getColumnCount(g),m=new e.Range(b.row,b.column,1,1),n=new e.Range(i,j,k,l);if(c.name()===h.name()&&n.containsRange(m))throw d.CalcError;return{templateSheetName:h.name(),templateRange:{row:i,col:j,rowCount:k,colCount:l},bindingObject:a[2]}},a.isContextSensitive=function(){return!0},a.acceptsReference=Aa,a},paint:function(a,b,d,e,f,g,k){var l,m,n,o,p,q,r=b.templateSheetName,s=b.templateRange;r&&(l=k.sheet,m=l.parent,n=m&&m.getSheetFromName(r),n&&(i||(o=c("CellTypes"),i=o.RCc,h=o.QCc,j=o.paintRangeTemplate),p=(new i).YE(n,s),q=(new h).YE(n,s),j(a,{x:d,y:e,width:f,height:g},b.bindingObject,k,p,q.XJb)))}}),xa=function(a){za(b,a);function b(){return a.call(this)||this}return b}(ca),b.GaugeKPISparkline=xa;function Ma(a,b,c,d,e,f,g,h){if(o(a)||o(b)||o(c)||o(d))return!1;if(D(a)||D(b)||D(c)||D(d))return!1;if(c>=d||b<c||b>d||a<c||a>d)return!1;if(!o(g)&&0!==g&&1!==g&&2!==g)return!1;if(0===g||o(g)){if(!o(e)&&!o(f)&&(D(f)||D(e)||e>=f||e<-180||f>180))return!1;if(!o(h)&&(D(h)||h>1||h<0))return!1}return!0}function Na(a,b,c){return{value:a,font:b,label:c,normalFontHeight:w(b),normalFontWidth:x(c,b),fontAfterZoom:null}}s(xa.prototype,{createFunction:function(){var a=new m(Z,4,255);return a.evaluate=function(a){var b,c,e,f,g,h,i,j,k,l,m,n=[],p=a.length,q=Ja(a[0]),r=Ja(a[1]),s=Ja(a[2]),t=Ja(a[3]),u=Ja(a[5]),w=Ja(a[6]),x=Ja(a[7]),y=Ja(a[8]),z=Ja(a[10]),A=Ja(a[11]),B=Ja(a[12]),C=a[4],E=a[13];if(!Ma(q,r,s,t,z,A,E,B))return v;for(a[9]instanceof d.CalcArray&&(j=a[9].toArray(2),c=j[0],e=j[1],f=j[2],g=j[3]),c=c||"16px Calibri",e=e||"bold 22px Calibri",f=f||G,g=g||G,u=o(u)?q:u,w=o(w)?r:w,x=o(x)?s:x,y=o(y)?t:y,k={minAngle:o(z)?-90:z,maxAngle:o(A)?90:A,radiusRatio:o(B)?0:B,targetValueOption:Na(q,c,u),currentValueOption:Na(r,e,w),minValueOption:Na(s,f,x),maxValueOption:Na(t,g,y),gaugeType:o(E)?0:E,ranges:void 0,showLabel:!!o(C)||!!C},l=14;l<p;l++)if(m=a[l],m instanceof d.CalcArray){if(b=m.toArray(0),h=b[0],i=b[1],o(h)||o(i)||D(h)||D(i)||h>i||h<s||h>t||i>t||i<s)return v;n.push({start:h,end:i,color:b[2]})}return k.ranges=n,k},a.acceptsArray=function(a){return 9===a||a>=14},a.acceptsReference=function(a){return a<=3&&a>=0||a>=5&&a<=8||a>=10&&a<=12},a},paint:function(a,b,c,d,e,f,g){var h=g.zoomFactor;b.currentValueOption.fontAfterZoom=y(b.currentValueOption.font,h).font,b.targetValueOption.fontAfterZoom=y(b.targetValueOption.font,h).font,b.minValueOption.fontAfterZoom=y(b.minValueOption.font,h).font,b.maxValueOption.fontAfterZoom=y(b.maxValueOption.font,h).font,u[Z](a,b,c,d,e,f,g)}}),ya={},b.w_a=ya;function Oa(a){a&&(ya[a.name()]=a)}m&&(Oa(new da),Oa(new ea),Oa(new fa),Oa(new ga),Oa(new ha),Oa(new ia),Oa(new ja),Oa(new ka),Oa(new la),Oa(new ma),Oa(new na),Oa(new oa),Oa(new pa),Oa(new qa),Oa(new ta),Oa(new ua),Oa(new va),Oa(new wa),Oa(new xa),Oa(new ra),Oa(new sa)),s(e.Workbook.prototype,{addSparklineEx:function(a){this.dT||(this.dT={});var b=this.dT;a&&(b[a.name()]=a)},getSparklineEx:function(a){var b,c=ya[a];return c?c:(b=this.dT,b&&b[a])},removeSparklineEx:function(a){var b=this.dT;b&&(b[a]=void 0)}}),e.Workbook.$n("sparklineEx",{toJson:function(a){var b,c,d,e=this.dT,f=[];if(e){for(b in e)e.hasOwnProperty(b)&&(c=e[b],d=c.toJSON(),d&&d.typeName&&f.push(d));f.length>0&&(a.sparklineExs=f)}},fromJson:function(a){var b,c,d,f,g=a.sparklineExs;if(g)for(b=0;b<g.length;b++)c=g[b],d=e.getTypeFromString(c.typeName),d&&(f=new d,f.fromJSON(c),this.addSparklineEx(f))},bdK:function(a,b,c){var d,e,f,g=this.dT,h=[];if(g){for(d in g)g.hasOwnProperty(d)&&(e=g[d],f=e.toJSON(),f&&f.typeName&&h.push(f));h.length>0&&(a.workbook.lossless.sparklineExs=h)}},cdK:function(a,b,c){var d,f,g,h,i=a.workbook.lossless,j=i&&i.sparklineExs;if(j)for(d=0;d<j.length;d++)f=j[d],g=e.getTypeFromString(f.typeName),g&&(h=new g,h.fromJSON(f),this.addSparklineEx(h))}})},"./dist/plugins/sparkline/sparkline-wrapper.entry.js":function(a,b,c){"use strict";var d,e;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/plugins/sparkline/functions-sparkline.js"),b.w_a=d.w_a,b.PieSparkline=d.PieSparkline,b.AreaSparkline=d.AreaSparkline,b.ScatterSparkline=d.ScatterSparkline,b.BulletSparkline=d.BulletSparkline,b.SpreadSparkline=d.SpreadSparkline,b.StackedSparkline=d.StackedSparkline,b.HBarSparkline=d.HBarSparkline,b.VBarSparkline=d.VBarSparkline,b.VariSparkline=d.VariSparkline,b.BoxPlotSparkline=d.BoxPlotSparkline,b.CascadeSparkline=d.CascadeSparkline,b.ParetoSparkline=d.ParetoSparkline,b.MonthSparkline=d.MonthSparkline,b.YearSparkline=d.YearSparkline,b.LineSparkline=d.LineSparkline,b.ColumnSparkline=d.ColumnSparkline,b.WinlossSparkline=d.WinlossSparkline,b.RangeBlockSparkline=d.RangeBlockSparkline,b.GaugeKPISparkline=d.GaugeKPISparkline,b.SparklineEx=d.SparklineEx,b.SparklineExValue=d.SparklineExValue,b.HistogramSparkline=d.HistogramSparkline,b.ImageSparkline=d.ImageSparkline,e=c("./dist/plugins/sparkline/sparkline-wrapper.js"),b.EmptyValueStyle=e.EmptyValueStyle,b.SparklineAxisMinMax=e.SparklineAxisMinMax,b.SparklineSetting=e.SparklineSetting,b.SparklineType=e.SparklineType,b.DataOrientation=e.DataOrientation,b.Sparkline=e.Sparkline},"./dist/plugins/sparkline/sparkline-wrapper.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("CalcEngine"),g=c("SheetsCalc"),h=d.Ul,i=h.JcK,j=h.IcK,k=d.range_parser.CcK,l=d.NodeHelper.qca,m=d.NodeHelper.oca,n=h.QcK,o=h.PcK,p=d.range_parser.FcK,q=d.GC$.isEmptyObject,r=d.kf,s=e.Common.j.Fa,t=e.Common.k,u=t.Fb,v=t.ac,w=t.Bb,x=e.Sparklines.Vd,y=e.Sparklines.SparklineRender,z=null,A=void 0,B=Math.max,C=Number.MAX_VALUE,D=d.UsedRangeUtil.SZJ,function(a){a[a.line=0]="line",a[a.column=1]="column",a[a.stacked=2]="stacked"}(E||(E={})),function(a){a[a.span=2]="span",a[a.gap=0]="gap",a[a.zero=1]="zero"}(F||(F={})),function(a){a[a.individual=0]="individual",a[a.group=1]="group",a[a.custom=2]="custom"}(G||(G={})),d.GC$.extend(d.lUa.prototype,{FUa:function(a){var b,c,d,e=this,f=e.zTa,g=arguments[1];if(f){switch(f.originalSparklines||(f.originalSparklines=[]),b={type:a},a){case 0:c=g,d=void 0,d=c&&c.sparkline?c.sparkline:z,b.changeInfo={row:c.row,col:c.col,sparkline:d};break;case 12:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:b.changeInfo=g}f.originalSparklines.push(b)}},IUa:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=a.changeInfo;switch(a.type){case 12:p.sparkline?(p.sparkline.row=p.row,p.sparkline.column=p.col,o.ZA.JUa(p.row,p.col,p.sparkline)):o.ZA.JUa(p.row,p.col,z);break;case 0:o.ZA.JUa(p.row,p.col,p.sparkline),p.sparkline&&!o.ZA.contains(p.sparkline.group())&&o.ZA.add(p.sparkline.group());break;case 1:for(c=void 0,d=void 0,e=void 0,f=v(p),g=0;g<f;g++)c=p[g].row,d=p[g].col,e=o.ZA.KUa(c,d),0===g&&e.cb.count()===f&&o.ZA.remove(e.cb),this.ZA.add(e.group(p[g].group).cb);break;case 2:for(h=[],i=0;i<v(p);i++)h.push(o.ZA.KUa(p[i].row,p[i].col));o.ZA.kj.groupSparkline(h);break;case 3:b=o.ZA.KUa(p.row,p.col),b.sparklineType(p.sparklineType);break;case 4:b=o.ZA.KUa(p.row,p.col),b.setting(p.setting);break;case 5:p.sparkline.data(p.data);break;case 15:b=o.ZA.KUa(p.row,p.col),b.dataSheetName(p.dataSheetName);break;case 6:b=o.ZA.KUa(p.row,p.col),b.dataOrientation(p.dataOrientation);break;case 7:b=o.ZA.KUa(p.row,p.col),b.displayDateAxis(p.displayDateAxis);break;case 8:j=void 0,k=p.rangeInfo,j=k?r(k.row,k.col,k.rowCount,k.colCount):k,p.group.dateAxisData(j);break;case 16:p.group.dateAxisDataSheetName(p.dateAxisDataSheetName);break;case 9:p.group.dateAxisOrientation(p.dateAxisOrientation);break;case 10:for(l=p.group.PS,l.forEach(function(a){o.ZA.vZa(a)}),p.group.PS=p.innerList,m=p.group.PS,n=0;n<v(m);n++)m[n].group(p.group);m.forEach(function(a){o.ZA.tZa(a)});break;case 11:b=o.ZA.KUa(p.row,p.col),b.group(p.group);break;case 13:u(o.ZA.groups(),p),o.ZA.yZa(p);break;case 14:o.ZA.groups().push(p),o.ZA.zZa(p)}},LUa:function(a){var b,c=v(a);for(b=c-1;b>=0;b--)this.IUa(a[b])},MUa:function(a,b){this.ZA.rI(a,b)},NUa:function(a,b){this.ZA.GR(a,b)},OUa:function(a,b){this.ZA.tI(a,b)},PUa:function(a,b){this.ZA.HR(a,b)},QUa:function(a,b,c,d){this.ZA.clear(a,b,c,d)},wZa:function(){var a=this.zTa;return a?(a.xZa||(a.xZa=[]),a.xZa):z}}),d.lUa.$n("sparkline",{init:function(){var a=this.kj;this.ZA=new J(a)},undo:function(a){var b,c,d=a.originalSparklines;d&&this.LUa(d),b=this.kj,c=a.xZa,c&&c.forEach(function(a){var c=b.parent.getSheetFromName(a.sheetName).ITa;c.undo(a.changes)})}}),H={init:function(){this.ZA=this.ITa.ZA},getUsedRange:function(a){var b,c,e;a.type&d.UsedRangeType.sparkLine&&(b=this,c=b.ZA,e=c.getUsedRange(),D(a.range,e))},dispose:function(a){if(a.clearCache!==!1){var b=this;b.ZA&&(b.ZA.kj=z,b.ZA.evaluator=z,b.ZA=z),b.ITa&&(b.ITa.ZA=z)}},onLayoutChanged:function(a){var b,c=a.changeType,d=a.row,e=a.rowCount,f=a.col,g=a.colCount,h=this.ITa;"addRows"===c?h.MUa(d,e):"deleteRows"===c?h.NUa(d,e):"addColumns"===c?h.OUa(f,g):"deleteColumns"===c?h.PUa(f,g):"clear"===c&&(b=a.type,3===a.sheetArea&&16===(16&b)&&h.QUa(d,f,e,g))},
toJson:function(a,b){var c=b&&b.ignoreStyle;c||(a.sparklineGroups=this.ZA.toJSON())},bdK:function(a,b,c){var e,f,g=!c||c.includeStyles!==!1;g&&(e=this.ZA.bdK(),f=i(a,d.XFileConstants.Xkb),e.c_.length>0&&f.c_.push({n_:"ext",c_:[e],r_:[0,1]}))},fromJson:function(a,b,c){var d=c&&c.ignoreStyle,e=this,f=e.ZA,g=a.sparklineGroupManager,h=b?g&&g.groups:a.sparklineGroups;h&&!d&&f.RUa(h,b)},cdK:function(a,b,c){var d=c&&c.includeStyles===!1,e=this,f=e.ZA,g=j(a,"extLst&ext&sparklineGroups"),h=g&&g.c_;h&&!d&&(f.EeK(h,c),f.groups().forEach(function(a){a.PS.forEach(function(a){f.SUa(a)})}))},setName:function(a){var b=a.oldName,c=a.newName;this.ZA.jOa(b,c)}},d.Worksheet.$n("sparkline",H);function U(a,b,c,d){var e=g.formulaToRanges(a,b,c,d),f=e[0],h=f&&f.ranges&&f.ranges[0];return h?{range:h,sheetName:f.sheetName}:z}I={getSparkline:function(a,b){return this.ZA?this.ZA.KUa(a,b):z},setSparkline:function(a,b,c,d,e,f,h,i){var j,k,l,m,n,o,p,q,r,t,u,v,w,x=this,y=x.ZA;if(!y)return z;if("string"==typeof c&&(l=U(x,c,a,b),m=x.getCustomName(c)||x.parent.getCustomName(c),n=void 0,s(m)||(n=g.formulaToRanges(x,g.expressionToFormula(x,m.getExpression(),a,b,1===x.parent.options.referenceStyle))),n?(k=c,o=ia(n),p=o.ranges,q=o.sheetName,c=p,j=q):l&&(c=l.range,j=l.sheetName),!l&&!n))return z;if(r=new T(a,b,c,d,e,f,k),j&&j!==x.name()&&r.dataSheetName(j),h&&!s(i)){if(t=void 0,"string"==typeof h&&(u=U(x,h,a,b),m=x.getCustomName(h)||x.parent.getCustomName(h),n=void 0,s(m)||(n=g.formulaToRanges(x,g.expressionToFormula(x,m.getExpression(),a,b,1===x.parent.options.referenceStyle))),n?(r.group().T$J=h,v=ia(n),p=v.ranges,q=v.sheetName,h=p,t=q):u&&(h=u.range,t=u.sheetName),!u&&!n))return z;r.dateAxisData(h),t&&t!==x.name()&&r.dateAxisDataSheetName(t),r.dateAxisOrientation(i),r.group().displayDateAxis=!0}return w=x.getSparkline(a,b),x.removeSparkline(a,b),V.call(x,a,b,w,r),x.$p(),r},ZLb:function(a,b,c){var d=this,e=d.getSparkline(a,b);V.call(this,a,b,e,c)},removeSparkline:function(a,b){var c,d,e,f=this,g=f.ZA;g&&(c=f.getSparkline(a,b),d={row:a,col:b,sparkline:c},f.ITa.FUa(0,d),c&&(e=c.group(),e.remove(c),e.count()<=0&&g.remove(e),V.call(f,a,b,c,z)),f.$p())},groupSparkline:function(a){var b,c,d,e,f,g,h=this,i=h.ZA;if(!i)return z;for(b=z,c=[],d=h.ITa.zTa!==A,e=0;e<a.length;e++)f=a[e],f&&(d&&c.push({group:f.group().clone(),row:f.row,col:f.column}),b?(g=f.group(),g.remove(f),b.add(f),g.count()<=0&&i.remove(g)):b=f.group());return h.$p(),h.ITa.FUa(1,c),b},ungroupSparkline:function(a){var b,c,d,e,f,g,h=this,i=h.ZA;if(i&&a){for(b=[],c=[],d=h.ITa.zTa!==A,b=b.concat(a.PS),e=0;e<b.length;e++)f=b[e],f&&(d&&c.push({row:f.row,col:f.column}),a.remove(f),g=a.clone(),g.add(f),i.add(g));i.remove(a),h.ITa.FUa(2,c),h.$p()}}};function V(a,b,c,e){var f=this,g=f.ZA;g.JUa(a,b,e),e&&g.add(e.group()),f.Bq("sparkline",a,b,3,c,e),f.Wq(d.Events.WorksheetDataChanged,{type:"sparkline"})}d.GC$.extend(d.Worksheet.prototype,I),J=function(){function a(a){this.Ub=[],this.kj=a,this.xn={},this.qZa=[],this.rZa=[]}return a.prototype.getUsedRange=function(){var a,b,c,d,e,f,g,h=this,i=h.xn,j={};if(i)for(a=Object.keys(i),b=void 0,c=void 0,d=void 0,e=0,f=a;e<f.length;e++)g=f[e],b=i[g],c=b.row,d=b.column,D(j,{minRow:c,minCol:d,maxRow:c,maxCol:d});return j},a.prototype.RUa=function(a,b){var c=this;c.fromJSON(a,b),c.groups().forEach(function(a){a.PS.forEach(function(a){c.SUa(a)})})},a.prototype.EeK=function(a,b){var c=this,d=c.kj;c.cdK(a,b),c.groups().forEach(function(a){a.PS.forEach(function(a){c.SUa(a),a.row>=d.getRowCount()&&d.setRowCount(a.row+1),a.column>=d.getColumnCount()&&d.setColumnCount(a.column+1)})})},a.prototype.SUa=function(a){a&&this.JUa(a.row,a.column,a)},a.prototype.JUa=function(a,b,c){if(this.kj.ITa.zTa){var d={row:a,col:b,sparkline:this.KUa(a,b),newSparkline:c};this.kj.ITa.FUa(12,d)}c?this.xn[W(a,b)]=c:delete this.xn[W(a,b)]},a.prototype.KUa=function(a,b){return this.xn[W(a,b)]||z},a.prototype.groups=function(a){return 0===arguments.length?this.Ub:void(this.Ub=a)},a.prototype.add=function(a){var b=this;b.kj.ITa.FUa(13,a),b.groups().push(a),a.ZA=b,a.QS(),b.zZa(a)},a.prototype.zZa=function(a){var b=this;b.sZa(a),a.all().forEach(function(a){b.tZa(a)})},a.prototype.remove=function(a){var b=this;b.kj.ITa.FUa(14,a),u(b.groups(),a),b.yZa(a)},a.prototype.yZa=function(a){var b=this;b.uZa(a),a.all().forEach(function(a){b.vZa(a)})},a.prototype.contains=function(a){return w(this.groups(),a)},a.prototype.count=function(){return this.groups().length},a.prototype.rI=function(a,b){Z(this.Ub,a,b,!0,this),$(a,b,!0,this.rZa,this.qZa,this.kj.ITa.wZa())},a.prototype.tI=function(a,b){Z(this.Ub,a,b,!1,this),$(a,b,!1,this.rZa,this.qZa,this.kj.ITa.wZa())},a.prototype.GR=function(a,b){da(this.Ub,a,b,!0,this),fa(a,b,!0,this.rZa,this.qZa,this.kj.ITa.wZa())},a.prototype.HR=function(a,b){da(this.Ub,a,b,!1,this),fa(a,b,!1,this.rZa,this.qZa,this.kj.ITa.wZa())},a.prototype.jOa=function(a,b){this.rZa.forEach(function(c){c.dateAxisDataSheetName()===a&&c.dateAxisDataSheetName(b)}),this.qZa.forEach(function(c){c.dataSheetName()===a&&c.dataSheetName(b)})},a.prototype.tZa=function(a){var b,c,d=this.kj,e=a.dataSheetName();e&&e!==d.name()&&(b=d.parent.getSheetFromName(e),b&&(c=b.ZA.qZa,c.indexOf(a)<0&&c.push(a)))},a.prototype.vZa=function(a){var b,c,d,e=a.dataSheetName();e&&(b=this.kj.parent.getSheetFromName(e),b&&(c=b.ZA.qZa,d=c.indexOf(a),d>=0&&c.splice(d,1)))},a.prototype.sZa=function(a){var b,c,d=this.kj,e=a.dateAxisDataSheetName();e&&e!==d.name()&&(b=d.parent.getSheetFromName(e),b&&(c=b.ZA.rZa,c.indexOf(a)<0&&c.push(a)))},a.prototype.uZa=function(a){var b,c,d,e=a.dateAxisDataSheetName();e&&(b=this.kj.parent.getSheetFromName(e),b&&(c=b.ZA.rZa,d=c.indexOf(a),d>=0&&c.splice(d,1)))},a.prototype.clear=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n=this;if(0===arguments.length){for(e=n.Ub,f=v(e)-1;f>-1;f--)if(g=e[f]){for(h=g.count()-1;h>-1;h--)i=g.PS[h],n.JUa(i.row,i.column,z),g.remove(i);n.remove(g)}}else for(j=a;j<a+c;j++)for(k=b;k<b+d;k++)l=n.RS(j,k),l&&(n.JUa(l.row,l.column,z),m=l.group(),m.remove(l),0===m.count()&&n.remove(m))},a.prototype.RS=function(a,b){var c,d,e,f,g=this.Ub;for(c=0;c<g.length;c++)for(d=g[c],e=0;e<d.count();e++)if(f=d.PS[e],f&&f.row===a&&f.column===b)return f;return z},a.prototype.Zz=function(a,b,c,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,z,A,B=this,C=B.kj;if(C){for(j=new d.KTa,k=c-a,l=e-b,o=C.getRowCount(),p=C.getColumnCount(),t=f,u=g,v=C.ZA,w=!i&&C.CMc(),m=0,q=0;m<f&&c+m<o;m++)if(w&&0===C.getRowHeight(c+m))f++;else if(h&&C.Ps&&C.Ps(c+m))q++;else{for(n=0,r=0,g=u;n<g&&e+n<p;n++)w&&0===C.getColumnWidth(e+n)?g++:(x=C.getSparkline(a+q,b+r),x&&(y=x.clone(),y.row=c+m,y.column=e+n,s(y.dateAxisData())&&y.dateAxisData(y.group().T$J),z=y.dateAxisData(),w&&(k=c-a+m-q,l=e-b+n-r),!s(z)&&B.SS(z,k,l,o,p)&&s(y.group().customName)&&y.dateAxisData(z.offset(l,k)),s(y.data())&&y.data(y.a$J),A=y.data(),!s(A)&&B.SS(A,k,l,o,p)&&s(y.a$J)&&y.data(A.offset(l,k)),B.add(y.group()),j.set(m,n,y)),r++);q++}for(m=0,f=t;m<f&&c+m<o;m++)if(w&&0===C.getRowHeight(c+m))f++;else if(!(h&&C.Ps&&C.Ps(c+m)))for(n=0,g=u;n<g&&e+n<p;n++)w&&0===C.getColumnWidth(e+n)?g++:v.JUa(c+m,e+n,j.get(m,n))}},a.prototype.SS=function(a,b,c,d,e){var f,g,h,i,j=this.TS(a);return!!j&&(f=B(j.row,0),g=B(j.col,0),h=j.row<0?d:j.rowCount,i=j.col<0?e:j.colCount,!(f+b<0||g+c<0||f+h+b>d||g+i+c>e))},a.prototype.aB=function(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t=this.kj;if(t){for(j=t.CMc(),k=g,l=f,this.US(a,b,c,e,f,g),m=t.ZA,n=new d.KTa,q=t.getRowCount(),r=t.getColumnCount(),o=0,h=0;o<f&&o+c<q;o++)if(j&&0===t.getRowHeight(c+o))f++;else{for(p=0,i=0,g=k;p<g&&e+p<r;p++)j&&0===t.getColumnWidth(e+p)?g++:(s=t.getSparkline(a+h,b+i),s&&(s.row=c+o,s.column=e+p,n.set(h,i,s)),m.JUa(a+h,b+i,z),i++);h++}for(o=0,h=0,f=l;o<f&&o+c<q;o++)if(j&&0===t.getRowHeight(c+o))f++;else{for(p=0,i=0,g=k;p<g&&e+p<r;p++)j&&0===t.getColumnWidth(e+p)?g++:(t.removeSparkline(c+o,e+p),m.JUa(c+o,e+p,n.get(h,i)),i++);h++}}},a.prototype.US=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,z,A,B,C=this;if(g&&(C=g),h=C.kj,i=h.CMc(),j=r(a,b,e,f),m=f,s=h.getRowCount(),t=h.getColumnCount(),u=C.Ub,i)for(o=0,q=0;o<e&&o+c<s;o++)if(0!==h.getRowHeight(c+o)){for(n=0,p=0,f=m;n<f&&n+d<t;n++)if(0!==h.getColumnWidth(d+n)){if(v=h.getSparkline(a+q,b+p))for(k=c-a+o-q,l=d-b+n-p,w=v.cb,x=w.PS,y=0;y<x.length;y++)z=x[y],z&&C.HMc(z,k,l,j);p++}else f++;q++}else e++;else for(k=c-a,l=d-b,y=0;y<u.length;y++)for(A=u[y],x=A.PS,B=0;B<x.length;B++)v=x[B],v&&C.HMc(v,k,l,j)},a.prototype.HMc=function(a,b,c,d){var e,f,g,h,i=this;s(a.dateAxisData())&&a.dateAxisData(a.group().T$J),e=a.dateAxisData(),f=i.TS(e),f&&d.containsRange(f)&&d.contains(a.row,a.column)&&a.dateAxisData(e.offset(c,b)),s(a.data())&&a.data(a.a$J),g=a.data(),h=i.TS(g),h&&d.containsRange(h)&&d.contains(a.row,a.column)&&a.data(g.offset(c,b))},a.prototype.TS=function(a){return a},a.prototype._A=function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,t,u,v,w,x,y,A=this,B=A.kj;if(B){if(a===B)return void A.Zz(b,c,d,e,f,g);for(j=d-b,k=e-c,l=B.ZA,m=!i&&B.CMc(),n=B.getRowCount(),o=B.getColumnCount(),p=g,q=0,t=0;q<f&&d+q<n;q++)if(m&&0===B.getRowHeight(d+q))f++;else if(h&&B.Ps&&B.Ps(d+q))t++;else{for(r=0,u=0,g=p;r<g&&e+r<o;r++)m&&0===B.getColumnWidth(e+r)?g++:(v=a.getSparkline(b+t,c+u),v?(w=v.clone(),w.row=d+q,w.column=e+r,s(w.dateAxisData())&&w.dateAxisData(w.group().T$J),x=w.dateAxisData(),m&&(j=d+q-b-t,k=e-c+r-u),!s(x)&&A.SS(x,j,k,n,o)&&w.dateAxisData(x.offset(k,j)),s(w.data())&&w.data(w.a$J),y=w.data(),!s(y)&&A.SS(y,j,k,n,o)&&w.data(y.offset(k,j)),A.add(w.group()),l.JUa(d+q,e+r,w)):l.JUa(d+q,e+r,z),u++);t++}}},a.prototype.$A=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u=this,v=u.kj;if(v){if(a===v)return void u.aB(b,c,d,e,f,g);for(h=v.CMc(),i=g,j=a.ZA,k=v.ZA,p=v.getRowCount(),q=v.getColumnCount(),u.VS(a,b,c,d,e,f,g),l=0,n=0;l<f&&d+l<p;l++)if(h&&0===v.getRowHeight(d+l))f++;else for(m=0,o=0,g=i;m<g&&e+m<q;m++)h&&0===v.getColumnWidth(e+m)?g++:(r=a.getSparkline(b+n,c+o),r?(r.row=d+l,r.column=e+m,s=r.group(),t=s.clone(),s.remove(r),s.count()<=0&&j.remove(s),t.add(r),u.add(t),k.JUa(d+l,e+m,r)):k.JUa(d+l,e+m,z),j.JUa(b+n,c+o,z))}},a.prototype.VS=function(a,b,c,d,e,f,g){var h=this,i=h.kj;a&&i&&h.US(b,c,d,e,f,g,a.ZA)},a.prototype.toJSON=function(){var a,b=this.Ub,c=[];for(a=0;b&&a<b.length;a++)c.push(b[a].toJSON());return 0===c.length?A:c},a.prototype.bdK=function(){var a,b,c,d=this.Ub,e={n_:"sparklineGroups",c_:[],r_:[2]};for(a=0;d&&a<d.length;a++)b=d[a],c=b.bdK(),e.c_.push(c);return e},a.prototype.fromJSON=function(a,b){var c,d,e;for(this.Ub.length=0,this.xn={},c=0;a&&c<a.length;c++)d=a[c],e=new S,e.fromJSON(d,b),this.add(e)},a.prototype.cdK=function(a,b){var c,d,e;for(this.Ub.length=0,this.xn={},c=0;a&&c<a.length;c++)d=a[c],e=new S,e.cdK(d,b),this.add(e)},a}();function W(a,b){return a+"_"+b}function X(a,b,c){return c?a>c.row+c.rowCount-1?c:a>c.row?r(c.row,c.col,c.rowCount+b,c.colCount):r(c.row+b,c.col,c.rowCount,c.colCount):z}function Y(a,b,c){return c?a>c.col+c.colCount-1?c:a>c.col?r(c.row,c.col,c.rowCount,c.colCount+b):r(c.row,c.col+b,c.rowCount,c.colCount):z}function Z(a,b,c,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,t,u,v=new d.KTa;for(g=0;g<a.length;g++){if(h=a[g],i=h.PS,h.displayDateAxis){if(s(h.dateAxisData())&&h.dateAxisData(h.T$J),j=void 0,k=h.dateAxisData(),k instanceof d.Range)j=_(b,c,e,k);else for(l=0;l<k.length;l++)j.push.apply(j,_(b,c,e,k[l]));h.dateAxisData(j)}for(l=0;l<i.length;l++)m=i[l],n=e?m.row:m.column,b<=n&&(v.set(g,l,m),f.JUa(m.row,m.column,z),e?m.row+=c:m.column+=c),s(m.data())&&m.data(m.a$J),o=void 0,p=m.data(),p instanceof d.Range?(o=_(b,c,e,p),m.data(o)):m.data(m.a$J)}for(q=0;q<a.length;q++)for(r=a[q],t=r.PS,u=0;u<t.length;u++)f.SUa(v.get(q,u))}function $(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,t,u,v;for(h=0;h<e.length;h++)if(i=e[h],i.displayDateAxis){if(j=i.OW(),k=j.ITa,l=!1,g&&!k.zTa&&(k.zTa=[],l=!0),s(i.dateAxisData())&&i.dateAxisData(i.T$J),m=void 0,n=i.dateAxisData(),n instanceof d.Range)m=_(a,b,c,n);else for(o=0;o<n.length;o++)m.push.apply(m,_(a,b,c,n[o]));i.dateAxisData(m),l&&(g.push({sheetName:j.name(),changes:k.zTa}),k.zTa=A)}for(o=0;o<f.length;o++)p=f[o],q=p.bT(),r=q.ITa,t=!1,g&&!r.zTa&&(r.zTa=[],t=!0),s(p.data())&&p.data(p.a$J),u=void 0,v=p.data(),v instanceof d.Range?(u=_(a,b,c,v),p.data(u)):p.data(p.a$J),t&&(g.push({sheetName:q.name(),changes:r.zTa}),r.zTa=A)}function _(a,b,c,d){var e;return e=c?X(a,b,d):Y(a,b,d)}function aa(a,b,c){var d=ca(c.col,c.col+c.colCount-1,a,a+b-1);return d?r(c.row,d.start,c.rowCount,d.end-d.start+1):z}function ba(a,b,c){var d=ca(c.row,c.row+c.rowCount-1,a,a+b-1);return d?r(d.start,c.col,d.end-d.start+1,c.colCount):z}function ca(a,b,c,d){var e,f,g,h,i,j,k=-1;if(d<a)return g=d-c+1,k=a-g,e=b-g,{start:k,end:e};if(c>b)return k=a,e=b,{start:k,end:e};if(c<=a){for(h=b-a+1,i=0,f=a;f<=d&&f<=b;f++)i++;return k=c,e=k+h-i-1,{start:k,end:e}}for(j=0,f=a;f<=b;f++)k===-1&&(f<c||f>d)&&(k=f),(f<c||f>d)&&j++;return k!==-1&&j>0?(e=k+j-1,{start:k,end:e}):z}function da(a,b,c,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,t,u,w=new d.KTa,x=a.length,y=0;for(g=x-1;g>-1;g--){if(h=a[g],h.displayDateAxis){if(s(h.dateAxisData())&&h.dateAxisData(h.T$J),i=void 0,j=h.dateAxisData(),j instanceof d.Range)i=ea(b,c,e,j);else for(k=0;k<j.length;k++)i.push.apply(i,ea(b,c,e,j[k]));if(s(i)){h.clear(),f.remove(h);continue}h.dateAxisData(i)}for(l=[],l=l.concat(h.PS),m=v(l),y=B(m,y),k=m-1;k>-1;k--)n=l[k],o=e?n.row:n.column,o>=b&&o<b+c&&s(n.a$J)?(h.remove(n),f.JUa(n.row,n.column,z)):(b<=o&&(f.JUa(n.row,n.column,z),e?n.row-=c:n.column-=c,w.set(g,k,n)),s(n.data())&&n.data(n.a$J),p=void 0,q=n.data(),q instanceof d.Range?p=ea(b,c,e,q):(n.data(n.a$J),p=n.data()),s(p)?h.remove(n):n.data(p));h.count()<=0&&f.remove(h)}for(t=0;t<x;t++)for(u=0;u<y;u++)r=w.get(t,u),r&&f.SUa(r)}function ea(a,b,c,d){var e;return e=c?ba(a,b,d):aa(a,b,d)}function fa(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,t,u,v,w,x,y=e.length;for(h=y-1;h>-1;h--)if(i=e[h],i.displayDateAxis){if(j=i.OW(),k=j.ITa,l=!1,g&&!k.zTa&&(k.zTa=[],l=!0),s(i.dateAxisData())&&i.dateAxisData(i.T$J),m=void 0,n=i.dateAxisData(),n instanceof d.Range)m=ea(a,b,c,n);else for(o=0;o<n.length;o++)m.push.apply(m,ea(a,b,c,n[o]));s(m)?(i.clear(),i.ZA.remove(i)):i.dateAxisData(m),l&&(g.push({sheetName:j.name(),changes:k.zTa}),k.zTa=A)}for(p=f.length,o=p-1;o>-1;o--)q=f[o],r=q.bT(),t=r.ITa,u=!1,g&&!t.zTa&&(t.zTa=[],u=!0),s(q.data())&&q.data(q.a$J),v=void 0,w=q.data(),w instanceof d.Range?v=ea(a,b,c,w):(q.data(q.a$J),v=q.data()),s(v)?(x=q.group(),x.remove(q),x.count()<=0&&x.ZA.remove(x)):q.data(v),u&&(g.push({sheetName:r.name(),changes:t.zTa}),t.zTa=A)}!function(a){a[a.gaps=0]="gaps",a[a.zero=1]="zero",a[a.connect=2]="connect"}(K=b.EmptyValueStyle||(b.EmptyValueStyle={})),function(a){a[a.individual=0]="individual",a[a.group=1]="group",a[a.custom=2]="custom"}(L=b.SparklineAxisMinMax||(b.SparklineAxisMinMax={})),M=e.Common.pc.bc(255,149,179,215),N=e.Common.pc.bc(255,36,64,98),O={axisColor:"black",firstMarkerColor:M,highMarkerColor:"Blue",lastMarkerColor:M,lowMarkerColor:"Blue",markersColor:N,negativeColor:"Brown",seriesColor:N,displayEmptyCellsAs:0,rightToLeft:!1,displayHidden:!1,displayXAxis:!1,showFirst:!1,showHigh:!1,showLast:!1,showLow:!1,showNegative:!1,showMarkers:!1,manualMax:0,manualMin:0,maxAxisType:0,minAxisType:0,lineWeight:1},P=function(){function a(a){var b,c=this;c.options={};for(b in O)O.hasOwnProperty(b)&&(c.options[b]=a&&a[b]?a[b]:O[b]);c.WS=z}return a.prototype.clone=function(){return new a(this.options)},a.prototype.toJSON=function(){var a,b=this,c=b.options,d={};for(a in c)O[a]!==c[a]&&(d[a]=c[a]);return q(d)?A:d},a}(),b.SparklineSetting=P,function(a){a[a.line=0]="line",a[a.column=1]="column",a[a.winloss=2]="winloss"}(Q=b.SparklineType||(b.SparklineType={})),function(a){a[a.vertical=0]="vertical",a[a.horizontal=1]="horizontal"}(R=b.DataOrientation||(b.DataOrientation={})),S=function(){function a(a,b){var c=this;c.displayDateAxis=!1,c.ZA=z,c.PS=[],c.XS=z,c.YS=1,c.T$J=z,c.setting=b,c.sparklineType=a}return a.prototype.OW=function(){var a=this,b;return a.ZA&&(b=a.ZA.kj),b},a.prototype.TUa=function(){var a,b=this,c=b.OW();c&&c.ITa.zTa&&(a={group:b,innerList:b.PS.concat()},c.ITa.FUa(10,a))},a.prototype.add=function(a){var b,c=this;a&&(c.TUa(),c.PS.push(a),a.group(c),c.QS(),b=c.ZA,b&&b.tZa(a),c.onGroupChanged())},a.prototype.clear=function(){this.TUa();var a=this.ZA;a&&this.PS.forEach(function(b){a.vZa(b)}),this.PS=[]},a.prototype.all=function(){return this.PS},a.prototype.remove=function(a){var b,c=this,d=c.PS;return c.TUa(),u(d,a),a.onSparklineChanged(),a.cb=c.clone(),c.QS(),b=c.ZA,b&&b.vZa(a),c.onGroupChanged(),d},a.prototype.contains=function(a){return w(this.PS,a)},a.prototype.onGroupChanged=function(){var a,b,c=this.PS;if(c)for(a=0;a<c.length;a++)b=c[a],b&&b.onSparklineChanged()},a.prototype.clone=function(){var b=this,c=b.setting?b.setting.clone():z,d=new a(b.sparklineType,c);return d.displayDateAxis=b.displayDateAxis,d.T$J=b.T$J,d.XS=b.XS,d.nZa=b.nZa,d.YS=b.YS,d},a.prototype.dateAxisData=function(a){var b,c,d,e,f,h,i,j,k,l,m=this;if(s(m.T$J)||m.U$J(),0===arguments.length)return m.XS;if(b=m.OW(),b&&b.ITa.zTa){if("string"==typeof a){if(c=b.getCustomName(a)||b.parent.getCustomName(a),s(c))return m.XS;d=g.formulaToRanges(b,g.expressionToFormula(b,c.getExpression()),0,0,1===m.OW().parent.options.referenceStyle),m.T$J=a,e=ia(d),f=e.ranges,h=e.sheetName,a=f,m.nZa=h}i=void 0,j=void 0,i=m.XS?{row:m.XS.row,col:m.XS.col,rowCount:m.XS.rowCount,colCount:m.XS.colCount}:z,j=a?{row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount}:z,k={group:m,rangeInfo:i,newRangeInfo:j},b.ITa.FUa(8,k)}l=m.XS,m.XS=a,l!==a&&m.onGroupChanged()},a.prototype.U$J=function(){var a,b,c,d,e=this;s(e.OW())||(a=ha(e.OW(),e.T$J),s(a)||(b=ia(a),c=b.ranges,d=b.sheetName,e.XS=c,e.nZa=d))},a.prototype.dateAxisDataSheetName=function(a){var b,c,d,e=this;return 0===arguments.length?e.nZa:(b=e.nZa,c=e.OW(),c&&c.ITa.zTa&&(d={group:e,dateAxisDataSheetName:b,newDateAxisDataSheetName:a},c.ITa.FUa(16,d)),b!==a&&(b&&c&&c.ZA.uZa(e),e.nZa=a,a&&c&&c.ZA.sZa(e),e.onGroupChanged()),e)},a.prototype.dateAxisOrientation=function(a){var b,c,d,e=this;return 0===arguments.length?e.YS:(b=e.OW(),b&&b.ITa.zTa&&(c={group:e,dateAxisOrientation:e.YS,newDateAxisOrientation:a},b.ITa.FUa(9,c)),d=e.YS,e.YS=a,void(d!==a&&e.onGroupChanged()))},a.prototype.count=function(){return this.PS.length},a.prototype.QS=function(){var a,b,c,d,e,f,g,h,i=this,j=i.setting,k=i.PS;if(j&&(a=j.options,a.groupMaxValue=-C,a.groupMinValue=C,b=1===a.maxAxisType,c=1===a.minAxisType,b||c))for(d=0;d<k.length;d++)e=k[d],f=i.ZS(e),g=f.min,h=f.max,b&&a.groupMaxValue<h&&(a.groupMaxValue=h),c&&a.groupMinValue>g&&(a.groupMinValue=g)},a.prototype.ZS=function(a){var b,c,d,e,f,g,h,i=-C,j=C;if(s(a.data())&&a.data(a.a$J),b=a.data())for(c=a.bT(),d=c&&c.parent.getSheetFromName(a.dataSheetName()),e=a.$S(b,a.dataOrientation(),!1,d||c),f=0;f<e.length;f++)g=e[f],g===x&&(g=0),"number"==typeof g&&(h=g,i=i<h?h:i,j=j>h?h:j);return{min:j,max:i}},a.prototype.toJSON=function(){var a,b,c,d=this,e={setting:d.setting?d.setting.toJSON():z,displayDateAxis:d.displayDateAxis,sparklineType:d.sparklineType,axisOrientation:d.YS,sparklines:d.PS.map(function(a){return a.toJSON()})},f=d.XS,g=d.T$J;g?e.axisReference=g:f&&(e.axisReference={row:f.row,col:f.col,rowCount:f.rowCount,colCount:f.colCount,sheetName:d.nZa}),a={};for(b in e)e.hasOwnProperty(b)&&(c=e[b],ga(b,c)||(a[b]=c));return q(a)?A:a},a.prototype.bdK=function(){var a,b,c,e={n_:"sparklineGroup"},f=this,g=f.OW();return s(f.sparklineType)||(e.type=E[f.sparklineType]),f.displayDateAxis&&(e.dateAxis="1"),a=f.setting.options,!s(a.lineWeight)&&3*(""+a.lineWeight)/4-.75>.001&&(e.lineWeight=3*(""+a.lineWeight)/4),a.displayEmptyCellsAs?e.displayEmptyCellsAs=F[a.displayEmptyCellsAs]:e.displayEmptyCellsAs=F[0],a.showMarkers&&(e.markers="1"),a.showHigh&&(e.high="1"),a.showLow&&(e.low="1"),a.showFirst&&(e.first="1"),a.showLast&&(e.last="1"),a.showNegative&&(e.negative="1"),a.displayXAxis&&(e.displayXAxis="1"),a.displayHidden&&(e.displayHidden="1"),a.rightToLeft&&(e.rightToLeft="1"),a.minAxisType&&(e.minAxisType=G[a.minAxisType]),a.maxAxisType&&(e.maxAxisType=G[a.maxAxisType]),a.manualMin&&(e.manualMin=a.manualMin),a.manualMax&&(e.manualMax=a.manualMax),e.c_=[o(a.seriesColor||"rgba(36,64,98,1.0)",!1,"colorSeries"),o(a.negativeColor||"brown",!1,"colorNegative"),o(a.axisColor||"black",!1,"colorAxis"),o(a.markersColor||"rgba(36,64,98,1.0)",!1,"colorMarkers"),o(a.firstMarkerColor||"rgba(149,179,215,1.0)",!1,"colorFirst"),o(a.lastMarkerColor||"rgba(149,179,215,1.0)",!1,"colorLast"),o(a.highMarkerColor||"blue",!1,"colorHigh"),o(a.lowMarkerColor||"blue",!1,"colorLow")],b=f.XS,b&&e.c_.push({n_:"f",c_:[(f.nZa?d.IndexHelper.Wfa(f.nZa):g.name())+"!"+p([r(b.row,b.col,b.rowCount,b.colCount)])]}),c={n_:"sparklines",c_:f.PS.map(function(a){return a.bdK()})},e.c_.push(c),e},a.prototype.fromJSON=function(a,b){var c,d,e,f,g,h,i,j,k;if(a&&(c=this,d=a.displayDateAxis,e=a.sparklineType,f=a.axisReference,g=a.axisOrientation,h=a.sparklines,c.setting=new P(a.setting),s(d)||(c.displayDateAxis=d),s(e)||(c.sparklineType=e),s(f)||("string"==typeof f?c.T$J=f:(c.XS=r(f.row,f.col,f.rowCount,f.colCount),c.nZa=f.sheetName)),s(g)||(c.YS=g),h))for(c.PS=[],i=0,j=h.length;i<j;i++)k=new T,k.fromJSON(h[i]),c.add(k)},a.prototype.cdK=function(a,b){var c,d,e,f,g,h,j,l,m=this,n=m.FeK(a);m.setting=new P(n),c="1"===a.dateAxis,d=E[a.type]||0,s(c)||(m.displayDateAxis=c),s(d)||(m.sparklineType=d),e=i(a,"f"),e&&(f=e.c_&&e.c_[0],g=f&&f.split("!"),g&&(h=k(g[1])[0]||z,s(h)||(m.XS=r(h.row,h.col,h.rowCount,h.colCount)),j=1===h.rowCount?1:0,s(j)||(m.YS=j))),l=i(a,"sparklines"),l&&(m.PS=[],l.c_.forEach(function(a){var c=new T;c.cdK(a,b),m.add(c)}))},a.prototype.FeK=function(a){var b={};return s(a.manualMax)||(b.manualMax=l(a.manualMax,0)),s(a.manualMin)||(b.manualMin=l(a.manualMin,0)),s(a.lineWeight)||(b.lineWeight=4*l(a.lineWeight,1)/3),s(a.displayEmptyCellsAs)||(b.displayEmptyCellsAs=F[a.displayEmptyCellsAs]||0),s(a.markers)||(b.showMarkers=m(a.markers,!1)),s(a.high)||(b.showHigh=m(a.high,!1)),s(a.low)||(b.showLow=m(a.low,!1)),s(a.first)||(b.showFirst=m(a.first,!1)),s(a.last)||(b.showLast=m(a.last,!1)),s(a.negative)||(b.showNegative=m(a.negative,!1)),s(a.displayXAxis)||(b.displayXAxis=m(a.displayXAxis,!1)),s(a.displayHidden)||(b.displayHidden=m(a.displayHidden,!1)),s(a.rightToLeft)||(b.rightToLeft=m(a.rightToLeft,!1)),s(a.minAxisType)||(b.minAxisType=G[a.minAxisType]||0),s(a.maxAxisType)||(b.maxAxisType=G[a.maxAxisType]||0),a.c_.forEach(function(a){"colorSeries"===a.n_&&(b.seriesColor=n(a)||"rgba(36,64,98,255)"),"colorNegative"===a.n_&&(b.negativeColor=n(a)||"Brown"),"colorAxis"===a.n_&&(b.axisColor=n(a)||"Black"),"colorMarkers"===a.n_&&(b.markersColor=n(a)||"rgba(36,64,98,255)"),"colorFirst"===a.n_&&(b.firstMarkerColor=n(a)||"rgba(149,179,215,255)"),"colorLast"===a.n_&&(b.lastMarkerColor=n(a)||"rgba(149,179,215,255)"),"colorHigh"===a.n_&&(b.highMarkerColor=n(a)||"Blue"),"colorLow"===a.n_&&(b.lowMarkerColor=n(a)||"Blue")}),b},a}();function ga(a,b){var c=!1;return"setting"===a||"axisReference"===a?c=b===z:"displayDateAxis"===a?c=b===!1:"axisOrientation"===a?c=1===b:"sparklines"===a&&(c=0===b.length),c}T=function(){function a(a,b,c,d,e,f,g){var h=this;h.row=a,h.column=b,h._S=d,h._data=c,h.cb=new S(e,f),h.cb.add(h),h.a$J=g}return a.prototype.group=function(a){var b,c,d,e,f=this;return 0===arguments.length?(b=f.cb,b||(b=new S,b.add(f),f.cb=b),b):(c=f.cb,d=f.bT(),d&&d.ITa.zTa&&(e={row:f.row,col:f.column,group:c,newGroup:a},d.ITa.FUa(11,e)),a!==c&&(c&&c.remove(f),f.cb=a,a&&!a.contains(f)&&a.add(f),f.onSparklineChanged()),d&&d.$p(),f)},a.prototype.sparklineType=function(a){var b,c,d,e,f=this;return 0===arguments.length?f.group().sparklineType:(b=f.group(),c=b.sparklineType,c!==a&&(b.sparklineType=a,d=f.bT(),d&&d.ITa.zTa&&(e={row:f.row,col:f.column,sparklineType:c,newSparklineType:a},d.ITa.FUa(3,e)),f.onSparklineChanged(),d&&d.$p()),f)},a.prototype.onSparklineChanged=function(){var a=this,b=a.bT();b&&b.Wq(d.Events.SparklineChanged,{sheet:b,sheetName:b.name(),sparkline:a})},a.prototype.setting=function(a){var b,c,e=this,f=e.group(),g=e.bT(),h=g&&g.ITa.zTa;return 0===arguments.length?(b=void 0,b=h?d.GC$.extend(!0,{},f.setting):f.setting):(h&&(c={row:e.row,col:e.column,setting:d.GC$.extend(!0,{},f.setting),newSetting:d.GC$.extend(!0,{},a)},g.ITa.FUa(4,c)),f.setting=a,g&&g.$p(),e)},a.prototype.data=function(a){var b,c,e,f,h,i,j,k=this;if(s(k.a$J)||k.V$J(),b=k.bT(),0===arguments.length)return s(k.a$J)?k._data:s(b)?[]:(c=b.getCustomName(k.a$J)||b.parent.getCustomName(k.a$J),s(c)?[]:(e=g.formulaToRanges(b,g.expressionToFormula(b,c.getExpression()),k.row,k.column,1===b.parent.options.referenceStyle),e[0]&&k._data!==e[0].ranges&&(k._data=e[0].ranges,k.onSparklineChanged()),k._data));if("string"==typeof a){if(k.a$J=a,!b)return k;if(c=b.getCustomName(a)||b.parent.getCustomName(a),e=void 0,s(c))return k;e=g.formulaToRanges(b,g.expressionToFormula(b,c.getExpression()),k.row,k.column,1===b.parent.options.referenceStyle),f=ia(e),h=f.ranges,i=f.sheetName,a=h,k.oZa=i}return b&&b.ITa.zTa&&(j={row:k.row,col:k.column,sparkline:k,data:d.GC$.extend(!0,{},k._data),newData:d.GC$.extend(!0,{},a)},b.ITa.FUa(5,j)),k._data!==a&&(k._data=a,k.onSparklineChanged()),b&&b.$p(),k},a.prototype.dataSheetName=function(a){var b,c,d,e=this;return 0===arguments.length?e.oZa:(b=e.oZa,c=e.bT(),c&&c.ITa.zTa&&(d={row:e.row,col:e.column,dataSheetName:b,newDataSheetName:a},c.ITa.FUa(15,d)),b!==a&&(b&&c&&c.ZA.vZa(e),e.oZa=a,a&&c&&c.ZA.tZa(e),e.onSparklineChanged()),e)},a.prototype.dataOrientation=function(a){var b,c,d=this;return 0===arguments.length?d._S:(b=d.bT(),b&&b.ITa.zTa&&(c={row:d.row,col:d.column,dataOrientation:d._S,newDataOrientation:a},b.ITa.FUa(6,c)),d._S!==a&&(d._S=a,d.onSparklineChanged()),b&&b.$p(),d)},a.prototype.dateAxisData=function(a){var b=this,c=b.group();return 0===arguments.length?(s(c.dateAxisData())&&c.dateAxisData(c.T$J),c.dateAxisData()):(c.dateAxisData(a),b)},a.prototype.dateAxisDataSheetName=function(a){var b=this,c=b.group();return 0===arguments.length?c.dateAxisDataSheetName():(c.dateAxisDataSheetName(a),b)},a.prototype.dateAxisOrientation=function(a){var b=this,c=b.group();return 0===arguments.length?c.dateAxisOrientation():(c.dateAxisOrientation(a),b)},a.prototype.displayDateAxis=function(a){var b,c,d=this,e=d.group();return 0===arguments.length?e.displayDateAxis:(b=d.bT(),b&&b.ITa.zTa&&(c={row:d.row,col:d.column,displayDateAxis:e.displayDateAxis,newDisplayDateAxis:a},b.ITa.FUa(7,c)),e.displayDateAxis=a,d)},a.prototype.clone=function(){var b=this,c=new a;return c.row=b.row,c.column=b.column,s(b.a$J)?c.data(b.data()):c.a$J=b.a$J,c.dataSheetName(b.dataSheetName()),c.dataOrientation(b.dataOrientation()),c.group(b.group().clone()),c},a.prototype.paintSparkline=function(a,b,c,e,f){var g,h,i,j,k,l=this,m=l.bT();this.vKb&&(m=this.vKb),s(l.data())&&l.data(l.a$J),s(l.dateAxisData())&&l.dateAxisData(l.group().T$J),i=l.W$J(!0),j=l.W$J(!1),k={sparklineType:l.sparklineType(),displayDateAxis:l.displayDateAxis(),zoomFactor:m.zoom(),values:i,dateValues:j,settings:l.setting(),getColor:function(a){if(m&&a){var b=d.Rm.Om(m,a);if(b)return b}return a}},(new y).paint(a,k,b,c,e,f)},a.prototype.W$J=function(a){var b,c,d,e,f,g=this,h=[],i=a?g.dataSheetName():g.dateAxisDataSheetName(),j=a?g.rKb:g.tKb,k=a?g.dataOrientation():g.dateAxisOrientation(),l=a?g.data():g.dateAxisData(),m=g.bT();if(this.vKb&&(m=this.vKb),j)h=j;else if("string"==typeof i)c=g.X$J(m,i),h=g.$S(l,k,!a,c||m);else if("object"==typeof i)for(d=i,e=0;e<d.length;e++)c=g.X$J(m,d[e]),f=g.$S(l[e],k,!a,c||m),h=h.concat(f);else s(i)&&(h=g.$S(l,k,!a,m));return h},a.prototype.X$J=function(a,b){var c,d,e=/^\[\d+\].+/g;return c=a.parent.getSheetFromName(b),d=a.parent.G$J,e.test(b)&&d&&(c=d.parseSource(b,!0)),c},a.prototype.sKb=function(a){var b=this;return s(b.data())&&b.data(b.a$J),b.$S(b.data(),b.dataOrientation(),!1,a)},a.prototype.uKb=function(a){var b=this;return s(b.dateAxisData())&&b.dateAxisData(b.group().T$J),b.$S(b.dateAxisData(),b.dateAxisOrientation(),!0,a)},a.prototype.$S=function(b,c,d,e){var f=this,g=f.setting().options.displayHidden;return a.cT(A,e,g,b,c,d)},a.prototype.bT=function(){var a=this.group(),b=a&&a.ZA;return b?b.kj:z},a.prototype.toJSON=function(){var a,b=this;return s(b.a$J)?(b._data=b._data,a={row:b._data.row,rowCount:b._data.rowCount,col:b._data.col,colCount:b._data.colCount,sheetName:b.oZa}):a=b.a$J,{row:b.row,col:b.column,orientation:b._S,data:a}},a.prototype.bdK=function(){var a,b=this,c=b.bT(),e=b._data;return a=s(b.a$J)?(b.oZa?d.IndexHelper.Wfa(b.oZa):c.name())+"!"+p([r(e.row,e.col,e.rowCount,e.colCount)]):b.a$J,{n_:"sparkline",c_:[{n_:"f",c_:[a]},{n_:"sqref",c_:[p([r(b.row,b.column,1,1)])]}],lossless:{_S:b._S}}},a.prototype.fromJSON=function(a){var b,c,d,e,f,g;a&&(b=this,c=a.row,d=a.col,e=a.orientation,f=a.data,s(c)||(b.row=c),s(d)||(b.column=d),s(e)||(b._S=e),f&&("string"==typeof f?b.a$J=f:(g=f,b._data=r(g.row,g.col,g.rowCount,g.colCount),b.oZa=g.sheetName)))},a.prototype.cdK=function(a,b){var c,e,f,g=this,h=d.Util.KlK(b)?void 0:1;a.c_.forEach(function(a){"f"===a.n_&&(f=a.c_[0].split("!"),1===f.length?g.a$J=f[0]:c=k(f[1])[0]||z),"sqref"===a.n_&&(e=k(a.c_[0])[0]||z)}),s(e)||(s(e.row)||(g.row=e.row),s(e.col)||(g.column=e.col),c&&(h=1===c.rowCount?1:0,g._data=r(c.row,c.col,c.rowCount,c.colCount),g.oZa=f[0])),s(h)||(g._S=h),a.lossless&&(g._S=a.lossless._S)},a.prototype.V$J=function(){var a,b,c,d,e=this;s(e.bT())||(a=ha(e.bT(),e.a$J),s(a)||(b=ia(a),c=b.ranges,d=b.sheetName,e._data=c,e.oZa=d))},a.cT=function(b,c,d,e,f,g){var h,i=[];if(s(e))return i;if(!(e instanceof Array))return a.Y$J(b,c,d,e,f,g);for(e=e,h=0;h<e.length;h++)i.push.apply(i,a.Y$J(b,c,d,e[h],f,g,!0));return i},a.Y$J=function(b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p=[],q=1===f;if(c&&e)for(i=0,j=h?q?e.rowCount:e.colCount:1;i<j;i++)for(k=0,l=q?e.colCount:e.rowCount;k<l;k++)m=q?i:k,n=q?k:i,o=b?b[m][n]:c.getValue(e.row+m,e.col+n),o=a.Z$J(c,o,e,m,n,d,g),p.push(o);return p},a.Z$J=function(a,b,c,d,g,h,i){var j="number";return b instanceof f.CalcError?A:(!h&&a.getRowHeight&&(a.getRowHeight(c.row+d)<=0||a.getColumnWidth(c.col+g)<=0)?b=NaN:s(b)||(i?b=typeof b===j?e.Common.l.Xb(b):Date.parse(b):typeof b!==j&&(b=x)),b)},a}(),b.Sparkline=T;function ha(a,b){var c=a.parent,d=a.getCustomName(b)||c.getCustomName(b);if(!s(d))return g.formulaToRanges(a,g.expressionToFormula(a,d.getExpression()),0,0,1===c.options.referenceStyle)}function ia(a){var b=[],c=[];return a.forEach(function(a){b=b.concat(a.ranges);for(var d=0;d<a.ranges.length;d++)c.push(a.sheetName)}),{ranges:b,sheetName:c}}},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},CellTypes:function(a,b){a.exports=GC.Spread.Sheets.CellTypes},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets},SheetsCalc:function(a,b){a.exports=GC.Spread.Sheets.CalcEngine}});